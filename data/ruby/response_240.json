[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 1, "creation_date": 1565824866, "post_id": 57503132, "comment_id": 101475120, "body": "Hi Max. You haven&#39;t asked a question or demonstrated a problem. If you&#39;d like to chat about an assignment or homework you might want to see if a <a href=\"https://chat.stackoverflow.com/\">chat room</a> is a more appropriate place."}, {"owner": {"reputation": 37, "user_id": 11929203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VDqtZyI9S7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIsCHAJgXAwOmCgjg2x7RV8tlpuQ/photo.jpg?sz=128", "display_name": "max mitch", "link": "https://stackoverflow.com/users/11929203/max-mitch"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1565825258, "post_id": 57503132, "comment_id": 101475186, "body": "@coreyward how should I use a chat room  for any queries to be asked"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1565835449, "post_id": 57503132, "comment_id": 101476843, "body": "max, I would encourage you to edit the question, addressing concerns that have been expressed. If you do there&#39;s a good chance the hold would be lifted. Note that many questions on SO are homework problems. There&#39;s no prohibition on that, but when the question is a homework problem the asker is expected to describe efforts they have made to solve the problem (with or without code). That&#39;s not an issue here; even if you are working on a homework problem you certainly have demonstrated that you have tried to solve it."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1565830832, "last_edit_date": 1565830832, "creation_date": 1565829307, "answer_id": 57503598, "question_id": 57503132, "link": "https://stackoverflow.com/questions/57503132/how-to-calculate-percentage-of-sum-hash-value-in-ruby/57503598#57503598", "title": "How to calculate percentage of sum hash value in ruby", "body": "<p><strong>Data</strong></p>\n\n<pre><code>double_quote_rate = 0.1\nsingle_quote_rate = [0.3, 0.25, 0.2]\nrequest = {:curtains=&gt;20, :tables=&gt;30, :windows=&gt;50}\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<p>The key is to create a hash that maps sets of products into their computed values.</p>\n\n<p>The first step is to create the key-value pairs where the key is a set containing a single product:</p>\n\n<pre><code>require 'set'\n\nh = single_quote_rate.zip(request.sort_by(&amp;:last)).\n      each_with_object({}) { |(rate, (product, score)),h|\n        h[[product].to_set] = rate*score }\n  #=&gt; {#&lt;Set: {:curtains}&gt;=&gt;6.0, #&lt;Set: {:tables}&gt;=&gt;7.5,\n  #    #&lt;Set: {:windows}&gt;=&gt;10.0} \n</code></pre>\n\n<p>Note that the values in <code>single_quote_rate</code> are ordered largest to smallest. The intermediate calculation is as follows:</p>\n\n<pre><code>single_quote_rate.zip(request.sort_by(&amp;:last))\n  #=&gt; [[0.3, [:curtains, 20]], [0.25, [:tables, 30]],\n  #    [0.2, [:windows, 50]]] \n</code></pre>\n\n<p>Now add all combinations of two products:</p>\n\n<pre><code>request.to_a.combination(2).each { |(product1, score1),(product2,score2)|\n  h[[product1,product2].to_set] = double_quote_rate*(score1+score2) }\n\nh #=&gt; {#&lt;Set: {:curtains}&gt;=&gt;6.0,\n  #    #&lt;Set: {:tables}&gt;=&gt;7.5,\n  #    #&lt;Set: {:windows}&gt;=&gt;10.0,\n  #    #&lt;Set: {:curtains, :tables}&gt;=&gt;5.0,\n  #    #&lt;Set: {:curtains, :windows}&gt;=&gt;7.0,\n  #    #&lt;Set: {:tables, :windows}&gt;=&gt;8.0} \n</code></pre>\n\n<p>Here the first calculation is as follows:</p>\n\n<pre><code>enum = request.to_a.combination(2)\n  #=&gt; #&lt;Enumerator: [[:curtains, 20], [:tables, 30],\n  #                  [:windows, 50]]:combination(2)&gt; \n</code></pre>\n\n<p>We can convert this enumerator to an array to see the three elements (arrays) that will be passed to the block.</p>\n\n<pre><code>enum.to_a\n  #=&gt; [[[:curtains, 20], [:tables, 30]],\n  #    [[:curtains, 20], [:windows, 50]],\n  #    [[:tables, 30], [:windows, 50]]] \n</code></pre>\n\n<p>The block variables are assigned as follows:</p>\n\n<pre><code>(product1, score1),(product2,score2) = enum.next\n  #=&gt; [[:curtains, 20], [:tables, 30]] \nproduct1\n  #=&gt; :curtains \nscore1\n  #=&gt; 20 \nproduct2\n  #=&gt; :tables \nscore2\n  #=&gt; 30 \n</code></pre>\n\n<p>Breaking up arrays into their component elements is called <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decompostion</a>.</p>\n\n<p>For convenience assign the keys of <code>request</code> to a variable:</p>\n\n<pre><code>keys = request.keys\n  #=&gt; [:curtains, :tables, :windows]\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>hash = { \"homes\": { \"person_a\": \"windows+tables\",\n                    \"person_b\": \"lights+tables\",\n                    \"person_c\": \"doors+curtains\" } }\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>hash[:\"homes\"].transform_values do |s|\n  h[s.split('+').map(&amp;:to_sym).select { |s| keys.include?(s) }.to_set]\nend\n  #=&gt; {:person_a=&gt;8.0, :person_b=&gt;7.5, :person_c=&gt;6.0}\n</code></pre>\n\n<p>An example calculation of the key to use to obtain the desired value of <code>h</code> is as follows:</p>\n\n<pre><code>s = \"lights+tables\"\na = s.split('+')\n  #=&gt; [\"lights\", \"tables\"] \nb = a.map(&amp;:to_sym)\n  #=&gt; [:lights, :tables] \nc = b.select { |s| keys.include?(s) }\n  #=&gt; [:tables] \nd = c.to_set\n  #=&gt; #&lt;Set: {:tables}&gt; \nh[d]\n  #=&gt; 7.5 \n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11929203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VDqtZyI9S7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIsCHAJgXAwOmCgjg2x7RV8tlpuQ/photo.jpg?sz=128", "display_name": "max mitch", "link": "https://stackoverflow.com/users/11929203/max-mitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1565834091, "answer_count": 1, "score": -1, "last_activity_date": 1565831670, "creation_date": 1565824425, "last_edit_date": 1565831670, "question_id": 57503132, "link": "https://stackoverflow.com/questions/57503132/how-to-calculate-percentage-of-sum-hash-value-in-ruby", "closed_reason": "Not suitable for this site", "title": "How to calculate percentage of sum hash value in ruby", "body": "<p>I have static json file which contains:</p>\n\n<pre><code>{\n  \"homes\": {\n    \"person_a\": \"windows+tables\",\n    \"person_b\": \"lights+tables\",\n    \"person_c\": \"doors+curtains\"\n }\n}\n</code></pre>\n\n<p>The application should, for each request, calculate quotes for the 3 insurers. The business requirement is as follows:</p>\n\n<p>The quote is a 10% of the rate if 2 covers are matched or 20% if just 1 cover is matched and that is the biggest requested, 25% if it is the second biggest or 30% if is the third.</p>\n\n<p>the request from user is as follow</p>\n\n<pre><code>{:curtains=&gt;20, :tables=&gt;30, :windows=&gt;50}\n</code></pre>\n\n<p>The system should not return a quote if the value is zero(0)</p>\n\n<p>The application will then calculate the following quotes:</p>\n\n<pre><code>person_a: 8 (10% of 80 (two matches on windows and tables))\nperson_b: 7.5 (25% of 30 (one match on contents, the 2nd biggest cover))\ninsurer_c: 6 (30% of 20 (one match on curtains, the 3rd biggest cover)\n</code></pre>\n\n<p>This is my solution:</p>\n\n<pre><code>\nrequire_relative './rules'\n\nmodule Coverage\n  class CalculateQuotes\n    def initialize(quotes)\n      @quotes = quotes\n    end\n\n    def get_rates\n      result = []\n      @insurer = Coverage::Rules.parse_file ## which will give {\n                                        #\"insurer_rates\": {\n                                       #\"person_a\": \"windows+tables\",\n                                       # \"person_b\": \"lights+tables\",\n                                       #\"person_c\": \"doors+curtains\"\n                                      # }}\n      @insurer[:insurer_rates].each do |k, v|\n        @match_covers = match_cover(v.split(\"+\"))\n        result &lt;&lt; [k, calculate_rate ]\n      end\n    end\n\n    def match_cover(covers)\n      covers = covers.map { |x| x.to_sym }\n      @quotes.select { |k,v| covers.include?(k) }\n    end\n\n    def calculate_rate\n      premium    = 0.0\n      persentage = get_percentage_by_match_covers\n      @match_covers.values.each do |v|\n        premium += v * persentage\n      end\n      premium == 0 ? nil : premium\n    end\n\n    def get_percentage_by_match_covers\n      if @match_covers.size == 2\n        0.1\n      elsif @match_covers.size == 1\n        only_1_match_covers\n      else\n        0\n      end\n    end\n\n    def only_1_match_covers\n      index = position_of_customer_request\n      case index\n      when 0\n        0.2\n      when 1\n        0.25\n      when 2\n        0.3\n      else\n        raise StandardError\n      end\n    end\n\n    def position_of_customer_request\n      (@quotes.to_a.reverse).index(@match_covers.to_a.flatten)\n    end\n  end\nend\n\n\nrequest = {:windows=&gt;50, :contents=&gt;30, :engine=&gt;20}\n\nCoverage::CalculateQuotes.new(request).get_rates\n</code></pre>\n\n<p>Please help me on How can I make it better calculation and code with SOLID ruby principles?? </p>\n"}, {"tags": ["ruby", "mongodb", "kubernetes", "amazon-eks"], "answers": [{"tags": [], "owner": {"reputation": 2059, "user_id": 11207414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8d2b0efd28e43f5580e7546cf912f5?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11207414/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1565974105, "creation_date": 1565974105, "answer_id": 57528366, "question_id": 57502949, "link": "https://stackoverflow.com/questions/57502949/mongodb-atlas-ruby-connection-not-working-inside-kubernetes/57528366#57528366", "title": "MongoDB Atlas - Ruby connection not working inside Kubernetes", "body": "<p>What i have found:</p>\n\n<ul>\n<li><a href=\"https://docs.atlas.mongodb.com/security-add-mongodb-users/\" rel=\"nofollow noreferrer\">Configure MongoDB Users</a></li>\n<li>Click Security > <a href=\"https://www.guru99.com/mongodb-atlas-cloud.html\" rel=\"nofollow noreferrer\">Add new use</a>  </li>\n</ul>\n\n<p>It looks like users permissions miss configuration:</p>\n\n<p>As per documentation:\n<a href=\"https://docs.atlas.mongodb.com/getting-started/#create-a-mongodb-user-for-your-cluster\" rel=\"nofollow noreferrer\">Create a MongoDB User for Your Cluster</a>.</p>\n\n<blockquote>\n  <p>You must create a MongoDB user to access your deployment. For security purposes, Atlas requires clients to authenticate as MongoDB users to access clusters.</p>\n  \n  <p>MongoDB users are separate from Atlas users:</p>\n  \n  <p>MongoDB users can access databases hosted in Atlas.\n  Atlas users can log into Atlas but do not have access to MongoDB databases.</p>\n</blockquote>\n\n<p>Hope this help.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11574781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573c8837c93eacdadb5555150edb0714?s=128&d=identicon&r=PG&f=1", "display_name": "xorb", "link": "https://stackoverflow.com/users/11574781/xorb"}, "is_accepted": false, "score": 1, "last_activity_date": 1572294773, "creation_date": 1572294773, "answer_id": 58598006, "question_id": 57502949, "link": "https://stackoverflow.com/questions/57502949/mongodb-atlas-ruby-connection-not-working-inside-kubernetes/58598006#58598006", "title": "MongoDB Atlas - Ruby connection not working inside Kubernetes", "body": "<p>Solved by adding <code>&amp;authSource=admin</code> to the connection string.</p>\n"}], "owner": {"reputation": 11, "user_id": 11574781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573c8837c93eacdadb5555150edb0714?s=128&d=identicon&r=PG&f=1", "display_name": "xorb", "link": "https://stackoverflow.com/users/11574781/xorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572294773, "creation_date": 1565822641, "question_id": 57502949, "link": "https://stackoverflow.com/questions/57502949/mongodb-atlas-ruby-connection-not-working-inside-kubernetes", "title": "MongoDB Atlas - Ruby connection not working inside Kubernetes", "body": "<p>I have a Ruby script that connects to MongoDB Atlas for getting some data. It does work perfectly if I:</p>\n\n<ol>\n<li>Run the script locally</li>\n<li>Run the script locally with docker</li>\n<li>Run the script in a separated AWS EC2 Instance</li>\n<li>Run the script in docker inside a seperated AWS EC2 instance</li>\n<li>Run the script inside local cluster with minikube.</li>\n</ol>\n\n<p>However it doesn't work inside kubernetes, I am using EKS.</p>\n\n<p>I have tried all items listed before and make sure the user exists on MongoDB Atlas.</p>\n\n<p>This is pretty much the output that I receive:</p>\n\n<pre><code>User moon (mechanism: scram) is not authorized to access test (used mechanism: SCRAM-SHA-1) (Mongo::Auth::Unauthorized)\n</code></pre>\n\n<p>I'd appreciate any input.</p>\n"}, {"tags": ["ruby", "syntax", "parameters", "constants"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565819369, "post_id": 57502414, "comment_id": 101473961, "body": "Yes, the error is, &quot;formal argument cannot be a constant&quot;, but you have not explained why arguments are not permitted to be constants. I assume it is because the constant lookup may be unsuccessful, depending on scope, but you probably can explain it better than I."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565819541, "post_id": 57502414, "comment_id": 101474005, "body": "There&#39;s really no such thing as a &quot;constant parameter name&quot;. If you want a constant, define a constant. Parameters (method arguments) are for things that change, that&#39;s why they&#39;re there. If this method is within a module or class, that&#39;s where you put the constant."}, {"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1565819615, "post_id": 57502414, "comment_id": 101474025, "body": "true, but they don&#39;t have to change inside the function"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565819638, "post_id": 57502414, "comment_id": 101474030, "body": "You&#39;re sort of right in that they take up less memory. It&#39;s mostly that a constant is declared once and once only, it persists for the lifespan of the process, so they <i>can</i> be more memory efficient. They can also be less efficient because they stick around forever, so it&#39;s not without tradeoffs. It really depends on what kind of a constant you&#39;re declaring, and the cost of retaining it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565819706, "post_id": 57502414, "comment_id": 101474044, "body": "An unchanging argument is not the same as a constant. In Ruby there&#39;s no equivalent to C++ <code>const</code> arguments for example, it&#39;s up to the caller to lock down any values supplied, like with <code>freeze</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565819708, "post_id": 57502414, "comment_id": 101474045, "body": "Raphael, why do you not want to simply reference a constant defined outside your method? Note that you cannot define or change a constant within a method either, as <i>dynamic constant definitions</i> are not permitted."}, {"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1565820100, "post_id": 57502414, "comment_id": 101474149, "body": "I want it to have the advantage of a, constant, taking less memory, since the parameters don&#39;t have to change inside the function, but since parameters of a function are the same variables, they just change when you call it the function again. :-("}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1565820197, "post_id": 57502414, "comment_id": 101474174, "body": "This sounds like an <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">XY Problem</a> and probably premature optimization. Unless you&#39;re having <i>measurable</i> memory problems, don&#39;t stress about this. Do the simplest thing that works, and if you have problems you can measure, fix those."}, {"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1565823008, "post_id": 57502414, "comment_id": 101474794, "body": "Not really, there are lot of times where memory and speed matters in programming, I just first encountered that in a specific case."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1565884829, "post_id": 57502414, "comment_id": 101493301, "body": "Given that computers today are really fast and have tons of memory, the number of times is actually fairly small. Ruby isn&#39;t especially memory efficient or fast, it&#39;s just very easy to work with, so you&#39;ve already made some trade-offs just using Ruby."}, {"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1569152727, "post_id": 57502414, "comment_id": 102496389, "body": "they&#39;re very fast with very <i>small</i> programs, but I realized that recursion and loops slow it down, <i>a lot</i>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1569248839, "post_id": 57502414, "comment_id": 102525591, "body": "The number one thing you can do to speed up code is to pick the correct algorithm. The second thing is to implement it efficiently in whatever language you&#39;ve chosen. The third is to port to a different language if you <i>must</i>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1565818758, "creation_date": 1565818758, "answer_id": 57502414, "question_id": 57502383, "link": "https://stackoverflow.com/questions/57502383/ive-tried-defining-a-function-in-ruby-with-constant-parameter-names-why-does-i/57502414#57502414", "title": "Iv&#39;e tried defining a function in ruby with constant parameter names, why does it throw an error?", "body": "<p>Ruby is an unusually case-sensitive language so you can't do certain things because capital letters have syntactical meaning. Other languages don't care, but Ruby does.</p>\n\n<p>For example your method arguments <em>must</em> be variables. You cannot define constants here. Capital letters at the beginning indicate a constant, no exceptions.</p>\n\n<p>You should define this as:</p>\n\n<pre><code>def foo(const1, const2)\n  # ..\nend\n</code></pre>\n\n<p>Some rules:</p>\n\n<ul>\n<li>Method names, variables and arguments are <code>lower_case</code>.</li>\n<li>Classes and modules follow <code>ClassName</code> and <code>ModuleName</code> respectively. These are technically constants.</li>\n<li>Other constants are defined as <code>CONSTANT_NAME</code></li>\n</ul>\n\n<p>I'm not sure what you're trying to achieve by defining \"constant parameter names\", so if you could explain maybe there's a better answer here.</p>\n"}], "owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 57502414, "answer_count": 1, "score": 1, "last_activity_date": 1586100906, "creation_date": 1565818535, "last_edit_date": 1586100906, "question_id": 57502383, "link": "https://stackoverflow.com/questions/57502383/ive-tried-defining-a-function-in-ruby-with-constant-parameter-names-why-does-i", "title": "Iv&#39;e tried defining a function in ruby with constant parameter names, why does it throw an error?", "body": "<p>whenever I try doing <code>def foo(CONST1, CONST2)</code>..., it always gives an error, even if only the function name is a constant.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\n# Error!\ndef foo (BAR, BAZ)\n   puts BAR + BAZ\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "decimal", "currency"], "comments": [{"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1565819090, "post_id": 57501982, "comment_id": 101473866, "body": "What database server are you using?"}, {"owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1565819153, "post_id": 57501982, "comment_id": 101473894, "body": "default one, sqlite3"}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1565822274, "post_id": 57501982, "comment_id": 101474644, "body": "sqlite3 has no decimal datatype. That would explain somewhat your problem. If you&#39;re storing money, how about storing as an integer and mutiply by 100. EG: store the number in cents."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1565846934, "post_id": 57501982, "comment_id": 101478612, "body": "@Rots by <i>100</i>? Won&#39;t work in Japan, Oman, Qatar..."}], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": true, "score": 3, "last_activity_date": 1565835048, "creation_date": 1565835048, "answer_id": 57504091, "question_id": 57501982, "link": "https://stackoverflow.com/questions/57501982/why-decimal-holding-value-like-0-219e3-instead-of-219-0-which-i-want/57504091#57504091", "title": "Why decimal holding value like 0.219e3 instead of 219.0 which I want", "body": "<p>When the column type is Decimal, the adapter is probably converting the value to a BigDecimal object on ruby.</p>\n\n<pre><code>require 'bigdecimal'\n\nBigDecimal(219)\n=&gt; 0.219e3\n</code></pre>\n\n<p>The number is actually \"219\", it's just cientific notation (0.219 x 10^3).</p>\n\n<pre><code>BigDecimal(219) == 219\n=&gt; true\n\nBigDecimal(219).to_f\n=&gt; 219.0\n</code></pre>\n"}], "owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 57504091, "answer_count": 1, "score": 1, "last_activity_date": 1565835048, "creation_date": 1565816425, "question_id": 57501982, "link": "https://stackoverflow.com/questions/57501982/why-decimal-holding-value-like-0-219e3-instead-of-219-0-which-i-want", "title": "Why decimal holding value like 0.219e3 instead of 219.0 which I want", "body": "<p>I am using Ubuntu 18.04.2 LTS and ruby 2.5.1p57 and rails 5.2.3</p>\n\n<p>I have model like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CreatePriceLists &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :price_lists do |t|\n      t.integer :number_of_pallets\n      t.decimal :net_rabate, precision: 5, scale: 2\n      t.decimal :net_logistic, precision: 5, scale: 2\n\n      t.timestamps\n    end\n  end\nend\n\n</code></pre>\n\n<p>and in my seeds I am trying to seed my database with :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> CreatePriceLists.create([\n{\n    number_of_pallets: 2,\n    net_rabate: 23.00,\n    net_logistic: 25.00\n}, {\n    number_of_pallets: 5,\n    net_rabate: 21.00,\n    net_logistic: 35.00   \n}\n</code></pre>\n\n<p>and when I am calling <code>rails db:seed</code> in database I can see CreatePriceList objects like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#&lt;CreatePriceLists id: 10, number_of_pallets: 2 net_rabate: 0.209e3, net_logistic: 0.29e3, created_at: \"2019-08-14 20:36:50\", updated_at: \"2019-08-14 20:36:50\"&gt;\n</code></pre>\n\n<p>I was looking for examples how to store price/money/currency in database and all examples saying that I have to use <code>decimal</code></p>\n\n<p>So, right now I change column type to <code>float</code> and everything works like it should, but I would like to change to <code>decimal</code> if that is the best option, but need to know what is going on.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "link-to", "nested-resources"], "comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565817628, "post_id": 57501946, "comment_id": 101473433, "body": "You want a link to a new book form? Or do you want a book link from the comment?"}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565818013, "post_id": 57501946, "comment_id": 101473539, "body": "@demir So the book list lives in new_book_path (confusing, sorry). On that url is a list of books already created. I want to go there by clicking on this user&#39;s name on this user&#39;s comment."}, {"owner": {"reputation": 805, "user_id": 4544219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CLo94.jpg?s=128&g=1", "display_name": "Mosaaleb", "link": "https://stackoverflow.com/users/4544219/mosaaleb"}, "edited": false, "score": 0, "creation_date": 1565818538, "post_id": 57501946, "comment_id": 101473701, "body": "Can you show your controller for this view?"}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "reply_to_user": {"reputation": 805, "user_id": 4544219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CLo94.jpg?s=128&g=1", "display_name": "Mosaaleb", "link": "https://stackoverflow.com/users/4544219/mosaaleb"}, "edited": false, "score": 0, "creation_date": 1565818773, "post_id": 57501946, "comment_id": 101473772, "body": "@Mosaaleb Sure, thank you. This particular view is index for posts: <code>@posts = Post.all</code> and <code>@comment = Comment.new</code>. The url I&#39;m trying to get to is new for book: <code>@user = current_user &#47;&#47; @book = Book.new</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565819235, "post_id": 57502440, "comment_id": 101473924, "body": "If it doesn&#39;t work, can you share the related models and views?"}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565821396, "post_id": 57502440, "comment_id": 101474471, "body": "Thank you for this. To clarify, I am trying to go from (A) a user&#39;s comment on another user&#39;s (or this user&#39;s) post (on index.html.erb of Posts controller) to (B) that user&#39;s list of books (on new.html.erb of Books controller). On each book show.html is a list of posts with comments on each post. The url is /books/new (using devise). Perhaps that&#39;s where the trouble is? There is no difference between users in their urls, because it&#39;s all books/new."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565822544, "post_id": 57502440, "comment_id": 101474695, "body": "It is correct to use <b>index</b> action to list books. Using <b>new</b> action for listing is not correct. And can you show the book model?"}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565822663, "post_id": 57502440, "comment_id": 101474719, "body": "I see, thank you. Sure: <code>belongs_to :user</code> <code>has_many :posts, dependent: :destroy</code>"}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565822718, "post_id": 57502440, "comment_id": 101474729, "body": "And each comment is related to user. <code>belongs_to :user</code> <code>belongs_to :post</code>"}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565827426, "post_id": 57502440, "comment_id": 101475552, "body": "Thank you so much! I will try later today."}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565981901, "post_id": 57502440, "comment_id": 101525629, "body": "Doesn&#39;t work, but thank you again. I will try some new stuff... will update."}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1565983618, "post_id": 57502440, "comment_id": 101526222, "body": "I got some of it to work, but one thing stands in the way. I&#39;d appreciate it if you could help with how to write this in the routes.rb: <code>books_path(user_id: current_user)</code>. This is necessary to show books on books/index, because following your suggestion (which worked after I changed some code; I will write what those are by editing your answer later), all my books there disappeared. So I have to change the url to <code>http:&#47;&#47;localhost:3000&#47;books?user_id=1</code>"}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 0, "last_activity_date": 1565823677, "last_edit_date": 1565823677, "creation_date": 1565818964, "answer_id": 57502440, "question_id": 57501946, "link": "https://stackoverflow.com/questions/57501946/how-to-link-to-users-particular-page-nested-resources/57502440#57502440", "title": "How to link_to user&#39;s particular page - nested resources", "body": "<p>1) in <strong>comment</strong>:</p>\n\n<pre><code>&lt;%= link_to comment.user.name, books_list_path(user_id: comment.user.id)\n</code></pre>\n\n<p><em>books_list_path</em> is path where books are listed</p>\n\n<p>2) in action where books are listed (<strong>index</strong> or <strong>new</strong> action):</p>\n\n<pre><code>class BooksController &lt; ApplicationController\n  ..\n  def index\n    @books = Book.where(user: params[:user_id])\n  end\n  ..\nend\n</code></pre>\n\n<p>3) in <strong>books/index.html.erb</strong></p>\n\n<pre><code>&lt;% @books.each do |book| %&gt;\n  &lt;%= book.name %&gt;&lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565823677, "creation_date": 1565816260, "last_edit_date": 1565822956, "question_id": 57501946, "link": "https://stackoverflow.com/questions/57501946/how-to-link-to-users-particular-page-nested-resources", "title": "How to link_to user&#39;s particular page - nested resources", "body": "<p>I have the following code:</p>\n\n<pre><code>&lt;%= link_to new_book_path(controller: :books, action: 'new', id: comment) %&gt;\n\n#also tried:\n\n&lt;%= link_to new_book_path(comment.user.id) %&gt;\n#outputs: undefined id\n\n&lt;%= link_to new_book_path(comment.user_id) %&gt;\n#leads to my (logged-in user) book list, not this user's\n\n&lt;%= link_to new_book_path(comment.user) %&gt;\n#same\n\n&lt;%= link_to new_book_path(comment) do %&gt;\n#same. comment.post.book.user.id also same.\n</code></pre>\n\n<p>I was wondering how I can get to this particular user's book list through link_to from this user's comment. I keep going to my own. </p>\n\n<p>My routes are:</p>\n\n<pre><code>resources :books do\n  resources :posts, shallow: true\nend\n\nresources :posts do\n  resources :comments, shallow: true\nend\n\nresources :users do\n  resources :comments, shallow: true \nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565815964, "post_id": 57501855, "comment_id": 101472969, "body": "It&#39;s not very SOLID if this thing takes in JSON, parses it, and then does a bunch of other magical things, all because you called <code>call</code>. Try and break that down a bit more. Consider using <code>extend self</code> at the end in preference to stuffing everything inside <code>class &lt;&lt; self</code>, or even using <code>def self.call</code> instead. Also prefer <code>array.to_h</code> in preference to the old-style <code>Hash[array]</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1565816047, "post_id": 57501855, "comment_id": 101472995, "body": "Hint: <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-max_by\" rel=\"nofollow noreferrer\"><code>max_by</code></a> can give you the top three if you tell it what &quot;top&quot; means."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565818145, "post_id": 57501855, "comment_id": 101473580, "body": "Does this have anything to do with json? You have a hash held by a variable <code>json</code> and wish to derive another hash from it."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11929203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VDqtZyI9S7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIsCHAJgXAwOmCgjg2x7RV8tlpuQ/photo.jpg?sz=128", "display_name": "max mitch", "link": "https://stackoverflow.com/users/11929203/max-mitch"}, "edited": false, "score": 0, "creation_date": 1565818451, "post_id": 57502027, "comment_id": 101473676, "body": "@user6500179 Thanks for the help. Also, I need how would I make my class definition better so that it follows SOLID principles in ruby"}, {"owner": {"reputation": 139, "user_id": 6500179, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/20bc7d28d1d8f95e9b8e09dde2be4500?s=128&d=identicon&r=PG&f=1", "display_name": "user6500179", "link": "https://stackoverflow.com/users/6500179/user6500179"}, "reply_to_user": {"reputation": 37, "user_id": 11929203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VDqtZyI9S7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIsCHAJgXAwOmCgjg2x7RV8tlpuQ/photo.jpg?sz=128", "display_name": "max mitch", "link": "https://stackoverflow.com/users/11929203/max-mitch"}, "edited": false, "score": 0, "creation_date": 1565820264, "post_id": 57502027, "comment_id": 101474199, "body": "@maxmitch I would put that in one class method and have optional arguments if that makes sense for your use case. See edited answer"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1565859213, "post_id": 57502027, "comment_id": 101482237, "body": "<code>max_by(limit, &amp;:last)</code> for a slightly more obscure approach. :)"}], "tags": [], "owner": {"reputation": 139, "user_id": 6500179, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/20bc7d28d1d8f95e9b8e09dde2be4500?s=128&d=identicon&r=PG&f=1", "display_name": "user6500179", "link": "https://stackoverflow.com/users/6500179/user6500179"}, "is_accepted": false, "score": 5, "last_activity_date": 1565820472, "last_edit_date": 1565820472, "creation_date": 1565816622, "answer_id": 57502027, "question_id": 57501855, "link": "https://stackoverflow.com/questions/57501855/calculate-highest-maximum-3-values-in-hash/57502027#57502027", "title": "Calculate highest maximum 3 values in hash", "body": "<p>This should work</p>\n\n<pre><code>  module UserRequest\n    class &lt;&lt; self\n      def call(json:, key: 'val', limit: 3)\n        json[key].max_by(limit){|_,v| v}.to_h\n      end\n    end\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1565858962, "creation_date": 1565858962, "answer_id": 57507129, "question_id": 57501855, "link": "https://stackoverflow.com/questions/57501855/calculate-highest-maximum-3-values-in-hash/57507129#57507129", "title": "Calculate highest maximum 3 values in hash", "body": "<p>Other option, given the input json:</p>\n\n<pre><code>json = \"{\\\"val1\\\":{\\\"a\\\":10,\\\"b\\\":50,\\\"c\\\":20,\\\"d\\\":30,\\\"e\\\":15}, \\\"val2\\\":{\\\"z\\\":100,\\\"x\\\":50,\\\"w\\\":200,\\\"y\\\":30,\\\"v\\\":150}}\"\n</code></pre>\n\n<p>You could sort on the fly while parsing to Hash, this applies to any key:</p>\n\n<pre><code>require 'json'\nh = JSON.parse(json).transform_values { |v| v.sort_by { |_, v| -v } }\n</code></pre>\n\n<p>So you can define some methods in your class or module:</p>\n\n<pre><code>h['val1'].first(3).to_h #=&gt; {\"b\"=&gt;50, \"d\"=&gt;30, \"c\"=&gt;20}\nh['val2'].last(3).to_h #=&gt; {\"z\"=&gt;100, \"x\"=&gt;50, \"y\"=&gt;30}\n</code></pre>\n\n<p>Or use <code>to_json</code> instead of <code>to_h</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 11929203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VDqtZyI9S7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIsCHAJgXAwOmCgjg2x7RV8tlpuQ/photo.jpg?sz=128", "display_name": "max mitch", "link": "https://stackoverflow.com/users/11929203/max-mitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1565858962, "creation_date": 1565815697, "last_edit_date": 1565816132, "question_id": 57501855, "link": "https://stackoverflow.com/questions/57501855/calculate-highest-maximum-3-values-in-hash", "title": "Calculate highest maximum 3 values in hash", "body": "<p>I have a class which will take user request as json\nshown below:</p>\n\n<pre><code>   json = { \"val\": { \"a\": 10, \"b\": 50, \"c\": 20, \"d\": 30, \"e\": 15 } \n   }\n</code></pre>\n\n<p>and return max 3 of hash value:</p>\n\n<p>for eg:</p>\n\n<p>It should return:</p>\n\n<pre><code>\n{\n\"b\": 50\n\"d\": 30\n\"c\": 20\n}\n</code></pre>\n\n<p>This is my approach:</p>\n\n<pre><code>\nrequire 'json'\n\nmodule UserRequest\n  class &lt;&lt; self\n    def call(json)\n      original = JSON.parse(json)\n      covers   = original[\"covers\"]\n      calculate_max(covers, 3)\n    end\n\n    def calculate_max(covers, max_num)\n      sorted = covers.sort_by { |k, v| v }\n      Hash[max_array(sorted, max_num)]\n    end\n\n    def max_array(array, max_num)\n      size = array.size\n      array.slice(size-max_num..last)\n    end\n  end\nend\n\nUserRequest.call(json)\n\n</code></pre>\n\n<p>Is there any better way to do this. Please help. Should follow SOLID ruby principles</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-s3", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": false, "score": 0, "last_activity_date": 1565816675, "creation_date": 1565816675, "answer_id": 57502039, "question_id": 57501597, "link": "https://stackoverflow.com/questions/57501597/aws-s3-errors-when-trying-to-authenticate-with-rails-application-credentials/57502039#57502039", "title": "AWS S3 Errors when trying to authenticate with rails.application.credentials", "body": "<p>This doesn't look like a AWS bucket issue. I'll paste the stack trace you've provided and highlight the key point:</p>\n\n<p>app/models/item.rb:45:in <code>feature_thumb' &lt;----------------This is the key line\napp/views/pages/home.html.erb:15:in</code>block (2 levels) in _app_views_pages_home_html_erb__4520288450801053047_70162336881260'\napp/views/pages/home.html.erb:13:in <code>block in _app_views_pages_home_html_erb__4520288450801053047_70162336881260'\napp/views/pages/home.html.erb:12:in</code>_app_views_pages_home_html_erb__4520288450801053047_70162336881260'\nStarted PUT \"/__web_console/repl_sessions/bfa895913555c494e18f3b259169a041\" for ::1 at 2019-08-14 20:39:17 +0100</p>\n\n<p><strong>NoMethodError: undefined method `map' for nil:NilClass</strong>  &lt;----- this the key line.</p>\n\n<p>This means that you are using the <code>map</code> method somewhere in your <code>feature_thumb</code> method. Except that the object you are calling it on is <code>nil</code>. You will need to make sure that the map method is called only if the object is not nil.</p>\n"}], "owner": {"reputation": 259, "user_id": 2047491, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ae132acebec8231e9a2a08af8f2e6bb1?s=128&d=identicon&r=PG", "display_name": "old_no_7uk", "link": "https://stackoverflow.com/users/2047491/old-no-7uk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565816675, "creation_date": 1565814468, "question_id": 57501597, "link": "https://stackoverflow.com/questions/57501597/aws-s3-errors-when-trying-to-authenticate-with-rails-application-credentials", "title": "AWS S3 Errors when trying to authenticate with rails.application.credentials", "body": "<p>I've set up an S3 bucket and an using it in my Rails development environment to store my active storage files.</p>\n\n<p>It works fine when I have the following in my storage.yml file:</p>\n\n<pre><code>aws:\n  service: S3\n  access_key_id: myaccesskeyid\n  secret_access_key: mysecretaccesskey\n  region: eu-west-2\n  bucket: bucketname\n</code></pre>\n\n<p>But when I try to set the access_key_id and secret_access_key via my credentials.yml using <code>EDITOR=\"mate --wait\" bin/rails credentials:edit</code>, I get the following error:</p>\n\n<pre><code>Aws::S3::Errors::Forbidden in Pages#home\n\nCompleted 500 Internal Server Error in 311ms (ActiveRecord: 13.6ms)\n\nActionView::Template::Error ():\n    12:     &lt;% @items.each do |item| %&gt;\n    13:         &lt;%= link_to item, class: 'col-6 col-md-4 col-lg-3 home_items__item' do %&gt;\n    14:             &lt;div class=\"item-preview\"&gt;\n    15:                 &lt;%= image_tag(item.feature_thumb, class:\"img-fluid\")%&gt;\n    16:                 &lt;div class=\"item-preview__title\"&gt;\n    17:                     &lt;%= item.title %&gt;\n    18:                 &lt;/div&gt;\n\napp/models/item.rb:45:in `feature_thumb'\napp/views/pages/home.html.erb:15:in `block (2 levels) in _app_views_pages_home_html_erb__4520288450801053047_70162336881260'\napp/views/pages/home.html.erb:13:in `block in _app_views_pages_home_html_erb__4520288450801053047_70162336881260'\napp/views/pages/home.html.erb:12:in `_app_views_pages_home_html_erb__4520288450801053047_70162336881260'\nStarted PUT \"/__web_console/repl_sessions/bfa895913555c494e18f3b259169a041\" for ::1 at 2019-08-14 20:39:17 +0100\n\nNoMethodError: undefined method `map' for nil:NilClass\n</code></pre>\n\n<p>My credentials.yml looks like this:</p>\n\n<pre><code>aws:\n  access_key_id: myaccesskeyid\n  secret_access_key: mysecretaccesskey\n</code></pre>\n\n<p>My Amended storage.yml looks like this:</p>\n\n<pre><code>aws:\n  service: S3\n  access_key_id: Rails.application.credentials.aws[:access_key_id]\n  secret_access_key: Rails.application.credentials.aws[:secret_access_key]\n  region: eu-west-2\n  bucket: bucketname\n</code></pre>\n\n<p>and calling those credentials from the console on the errored browser window returns the correct credentials:</p>\n\n<pre><code>&gt; Rails.application.credentials.aws[:access_key_id]\n&gt; \"myaccesskeyid\"\n&gt;  Rails.application.credentials.aws[:secret_access_key]\n&gt; \"mysecretaccesskey\"\n</code></pre>\n\n<p>Any ideas about what i'm doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11928942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e2746194b9a7c97f621d6a8df89927?s=128&d=identicon&r=PG&f=1", "display_name": "b3nis", "link": "https://stackoverflow.com/users/11928942/b3nis"}, "edited": false, "score": 0, "creation_date": 1565884502, "post_id": 57501803, "comment_id": 101493142, "body": "Thanks @demir! We are getting closer - but now I got a new error. Yeah, I am not great at this."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 11, "user_id": 11928942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e2746194b9a7c97f621d6a8df89927?s=128&d=identicon&r=PG&f=1", "display_name": "b3nis", "link": "https://stackoverflow.com/users/11928942/b3nis"}, "edited": false, "score": 0, "creation_date": 1565942139, "post_id": 57501803, "comment_id": 101508663, "body": "@b3nis If I helped solve this problem, would you please mark my answer as an answer? You can also do upvote :)"}, {"owner": {"reputation": 11, "user_id": 11928942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e2746194b9a7c97f621d6a8df89927?s=128&d=identicon&r=PG&f=1", "display_name": "b3nis", "link": "https://stackoverflow.com/users/11928942/b3nis"}, "edited": false, "score": 0, "creation_date": 1565969124, "post_id": 57501803, "comment_id": 101520811, "body": "Of course, but we still have some issues. See above."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 1, "last_activity_date": 1566079150, "last_edit_date": 1566079150, "creation_date": 1565815464, "answer_id": 57501803, "question_id": 57500932, "link": "https://stackoverflow.com/questions/57500932/trying-to-start-rails-app-get-a-lot-of-errors-i-dont-understand/57501803#57501803", "title": "Trying to start Rails app - get a lot of errors I don&#39;t understand", "body": "<p>This is <strong>ssl</strong> error.</p>\n\n<p>From <a href=\"https://github.com/cvincent/umessage/#desktop-notifications\" rel=\"nofollow noreferrer\">README</a>:</p>\n\n<blockquote>\n  <p>To support desktop notifications, you'll need a self-signed SSL\n  certificate in config/ssl</p>\n</blockquote>\n\n<p>The developer's guide suggestion will help you.</p>\n\n<blockquote>\n  <p><a href=\"https://rossta.net/blog/local-ssl-for-rails-5.html\" rel=\"nofollow noreferrer\">Here's a good guide</a> to setting it up</p>\n</blockquote>\n\n<p><strong>Update for new error</strong></p>\n\n<p><code>ulimit -n 8192</code> command may fix your problem.</p>\n\n<p>Related links:</p>\n\n<ol>\n<li><p><a href=\"https://stackoverflow.com/a/40617673/2190621\">https://stackoverflow.com/a/40617673/2190621</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/a/16759947/2190621\">https://stackoverflow.com/a/16759947/2190621</a></p></li>\n<li><p><a href=\"https://github.com/envygeeks/jekyll-assets/issues/339#issuecomment-251295630\" rel=\"nofollow noreferrer\">https://github.com/envygeeks/jekyll-assets/issues/339#issuecomment-251295630</a></p></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 11928942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e2746194b9a7c97f621d6a8df89927?s=128&d=identicon&r=PG&f=1", "display_name": "b3nis", "link": "https://stackoverflow.com/users/11928942/b3nis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566079150, "creation_date": 1565811127, "last_edit_date": 1565884468, "question_id": 57500932, "link": "https://stackoverflow.com/questions/57500932/trying-to-start-rails-app-get-a-lot-of-errors-i-dont-understand", "title": "Trying to start Rails app - get a lot of errors I don&#39;t understand", "body": "<p>Cannot start Ruby on Rails application - getting a lot of errors (sorry, cannot really describe it better).</p>\n\n<p>OS: Mac OS X High Sierra (latest). Trying to install umessages (github link: <a href=\"https://github.com/cvincent/umessage/\" rel=\"nofollow noreferrer\">https://github.com/cvincent/umessage/</a> ). I have tried to update Ruby on Rails and install all Gems available. I have ran into a lot of issues but I might have resolved some of them - but now I am stuck.</p>\n\n<p>I am more than happy for any help.</p>\n\n<p>Here is error message when trying to run the app:</p>\n\n<pre><code>bmini:umessage-master benjamin$ foreman start\n20:55:23 server.1       | started with pid 48006\n20:55:23 chat_polling.1 | started with pid 48007\n20:55:28 server.1       | =&gt; Booting Puma\n20:55:28 server.1       | =&gt; Rails 5.2.1 application starting in development \n20:55:28 server.1       | =&gt; Run `rails server -h` for more startup options\n20:55:28 server.1       | Puma starting in single mode...\n20:55:28 server.1       | * Version 3.12.0 (ruby 2.4.0-p0), codename: Llamas in Pajamas\n20:55:28 server.1       | * Min threads: 5, max threads: 5\n20:55:28 server.1       | * Environment: development\n20:55:28 server.1       | Exiting\n20:55:28 server.1       | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/minissl.rb:202:in `key=': No such key file 'config/ssl/umessage.local.key' (ArgumentError)\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/binder.rb:171:in `block in parse'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/binder.rb:88:in `each'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/binder.rb:88:in `parse'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/runner.rb:151:in `load_and_bind'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/single.rb:96:in `run'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/launcher.rb:184:in `run'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/rack/handler/puma.rb:70:in `run'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/rack-2.0.5/lib/rack/server.rb:297:in `start'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:53:in `start'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:147:in `block in perform'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:142:in `tap'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:142:in `perform'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/command/base.rb:65:in `perform'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/command.rb:46:in `invoke'\n20:55:28 server.1       |   from /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n20:55:28 server.1       |   from bin/rails:4:in `require'\n20:55:28 server.1       |   from bin/rails:4:in `&lt;main&gt;'\n20:55:28 server.1       | exited with code 1\n20:55:28 system         | sending SIGTERM to all processes\n20:55:28 chat_polling.1 | rake aborted!\n20:55:28 chat_polling.1 | SignalException: SIGTERM\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `block in require'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:253:in `load_dependency'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activerecord-5.2.1/lib/active_record/base.rb:317:in `&lt;class:Base&gt;'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activerecord-5.2.1/lib/active_record/base.rb:277:in `&lt;module:ActiveRecord&gt;'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activerecord-5.2.1/lib/active_record/base.rb:27:in `&lt;top (required)&gt;'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `block in require'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:253:in `load_dependency'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n20:55:28 chat_polling.1 | /Users/benjamin/umessage-master/lib/tasks/messages.rake:9:in `block (2 levels) in &lt;top (required)&gt;'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/rake-11.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/bin/ruby_executable_hooks:24:in `eval'\n20:55:28 chat_polling.1 | /Users/benjamin/.rvm/gems/ruby-2.4.0/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\n20:55:28 chat_polling.1 | Tasks: TOP =&gt; messages:poll\n20:55:28 chat_polling.1 | (See full trace by running task with --trace)\n20:55:28 chat_polling.1 | exited with code 1\n</code></pre>\n\n<p>Update:\nWe are getting closer but I got a new error now - hum, what does this mean?</p>\n\n<pre><code>17:48:40 server.1       |   Rendered collection of chats/_chat.html.erb [2380 times] (1674.0ms)\n17:48:40 server.1       |   Rendered chats/show.html.erb within layouts/application (4687.9ms)\n17:48:40 server.1       | Completed 500 Internal Server Error in 5056ms (ActiveRecord: 1791.9ms)\n17:48:40 server.1       | \n17:48:40 server.1       | \n17:48:40 server.1       |   \n17:48:40 server.1       | LoadError (cannot load such file -- action_view/template/error):\n17:48:40 server.1       |   \n17:48:40 server.1       | app/views/chats/show.html.erb:5:in `_app_views_chats_show_html_erb__3258259636189740739_70108826272000'\n17:48:40 server.1       | app/controllers/chats_controller.rb:7:in `index'\n17:48:40 server.1       | Error during failsafe response: Too many open files @ rb_sysopen - /Users/benjamin/umessage-master/public/500.html\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/public_exceptions.rb:51:in `read'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/public_exceptions.rb:51:in `render_html'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/public_exceptions.rb:37:in `render'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/public_exceptions.rb:27:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/show_exceptions.rb:51:in `render_exception'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/show_exceptions.rb:36:in `rescue in call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/rack/logger.rb:38:in `call_app'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/rack/logger.rb:26:in `block in call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/tagged_logging.rb:71:in `block in tagged'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/tagged_logging.rb:28:in `tagged'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/tagged_logging.rb:71:in `tagged'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/rack/logger.rb:26:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/sprockets-rails-3.2.1/lib/sprockets/rails/quiet_assets.rb:13:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/request_id.rb:27:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/rack-2.0.5/lib/rack/method_override.rb:22:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/rack-2.0.5/lib/rack/runtime.rb:22:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/activesupport-5.2.1/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/executor.rb:14:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/actionpack-5.2.1/lib/action_dispatch/middleware/static.rb:127:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/rack-2.0.5/lib/rack/sendfile.rb:111:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/railties-5.2.1/lib/rails/engine.rb:524:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/configuration.rb:225:in `call'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/server.rb:658:in `handle_request'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/server.rb:472:in `process_client'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/server.rb:332:in `block in run'\n17:48:40 server.1       |   /Users/benjamin/.rvm/gems/ruby-2.4.0/gems/puma-3.12.0/lib/puma/thread_pool.rb:133:in `block in spawn_thread'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1566567456, "post_id": 57500766, "comment_id": 101708441, "body": "Do you compile this on your local machine? I was under the impression that you&#39;d need to compile the bundle on the machine you which to use it (e.g. can&#39;t compile on a mac, include, and deploy to heroku)"}, {"owner": {"reputation": 3267, "user_id": 2547753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AODE2.png?s=128&g=1", "display_name": "Ezequiel", "link": "https://stackoverflow.com/users/2547753/ezequiel"}, "edited": false, "score": 0, "creation_date": 1566833726, "post_id": 57500766, "comment_id": 101771009, "body": "Run this on your Docker image to check which is the path of the library inside the image <code>docker run -it YOUR_IMAGE find . my_library</code>"}], "answers": [{"comments": [{"owner": {"reputation": 10268, "user_id": 1292230, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e6c83cbfefd3ecaa1971c48d24ef589?s=128&d=identicon&r=PG", "display_name": "RileyE", "link": "https://stackoverflow.com/users/1292230/rileye"}, "edited": false, "score": 0, "creation_date": 1566509825, "post_id": 57601188, "comment_id": 101689538, "body": "Thanks for the answer. The error I snagged was from Heroku, so that&#39;s the correct path. As for <code>autoload_paths</code>, I&#39;ve double checked, but every directory under <code>&#47;app</code> is included."}], "tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": false, "score": 0, "last_activity_date": 1566439752, "creation_date": 1566439752, "answer_id": 57601188, "question_id": 57500766, "link": "https://stackoverflow.com/questions/57500766/heroku-deploy-fails-to-load-custom-bundle-file/57601188#57601188", "title": "Heroku deploy fails to load custom .bundle file", "body": "<p>According to the error that you posted, it seems that Docker doesn't point to the correct path <code>cannot load such file -- /app/app/helpers/my_library</code>. If that is correct, you should explicitly specify the working directory in your Dockerfile.</p>\n\n<p><code>WORKDIR /path/to/project</code></p>\n\n<p>After that, just rebuild the image.</p>\n\n<p>Now, if this doesn't work, you can check <code>autoload_paths</code> in your project or customize bootsnap to avoid error in autoloading paths.</p>\n"}, {"tags": [], "owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "is_accepted": false, "score": 0, "last_activity_date": 1566889643, "creation_date": 1566889643, "answer_id": 57669340, "question_id": 57500766, "link": "https://stackoverflow.com/questions/57500766/heroku-deploy-fails-to-load-custom-bundle-file/57669340#57669340", "title": "Heroku deploy fails to load custom .bundle file", "body": "<p>What you can do is have the entire <code>my_library</code> as a <em>local gem</em> and point your Gemfile to it.\nRoughly, the outline would be as follows:</p>\n\n<ol>\n<li>Place the entire code for <code>my_library</code> in  directory within your app, say <code>fixtures</code> (which is at the same level as your Gemfile.)\n\n<pre><code>app/\n  ...\nfixtures/\n  my_library/\n    ext/\n      ...\n    lib/\n      ...\n    my_library.gemspec\n    Rakefile\nGemfile\n</code></pre></li>\n<li>Point your Gemfile to the <code>my_library</code> gem:\n\n<pre><code>gem 'my_library', path: 'fixtures/my_library'\n</code></pre></li>\n<li>Then simply update your <code>Gemfile.lock</code> by running\n\n<pre><code>bundle update\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 10268, "user_id": 1292230, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e6c83cbfefd3ecaa1971c48d24ef589?s=128&d=identicon&r=PG", "display_name": "RileyE", "link": "https://stackoverflow.com/users/1292230/rileye"}, "is_accepted": false, "score": 0, "last_activity_date": 1567004735, "creation_date": 1567004735, "answer_id": 57695364, "question_id": 57500766, "link": "https://stackoverflow.com/questions/57500766/heroku-deploy-fails-to-load-custom-bundle-file/57695364#57695364", "title": "Heroku deploy fails to load custom .bundle file", "body": "<p>As @jay-dorsey mentioned, the bundle did need to be compiled on the server that was deploying the application in order to be used. Both of the guides that I followed to create the gem had some misinformation.</p>\n\n<ol>\n<li>The gem should contain only the source files, no compiled source files</li>\n<li>The rakefile should reference <code>ext.lib_dir = \"lib/my_library\"</code> instead of the <code>ext</code> directory</li>\n<li>The gemspec should add the <code>rake-compiler</code> development dependency BEFORE the other dependencies</li>\n<li>The version files should NOT try to load the extension, as it's being used in the gemspec, which is called before the gem has a chance to be compiled by rake / bundler</li>\n<li><code>.bundle</code> files can't be read on linux machines</li>\n</ol>\n"}], "owner": {"reputation": 10268, "user_id": 1292230, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0e6c83cbfefd3ecaa1971c48d24ef589?s=128&d=identicon&r=PG", "display_name": "RileyE", "link": "https://stackoverflow.com/users/1292230/rileye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1567004735, "creation_date": 1565810242, "last_edit_date": 1566340324, "question_id": 57500766, "link": "https://stackoverflow.com/questions/57500766/heroku-deploy-fails-to-load-custom-bundle-file", "title": "Heroku deploy fails to load custom .bundle file", "body": "<p>I'm having a lot of trouble googling this issue, as <code>bundler</code> keeps coming up. However, my issue is with a c library that I've bundled using <code>mkmf</code> and the <a href=\"https://silverhammermba.github.io/emberb/c/\" rel=\"nofollow noreferrer\">ruby c api</a>. I've compiled my c code into a file (e.g. <code>my_library.bundle</code>) and I've required it inside a helper with <code>require_relative \"my_library\"</code> without a problem.</p>\n\n<p>The problem arrises when I deploy to heroku and I get the error:</p>\n\n<pre><code>2019-08-14T19:09:15.452530+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require': cannot load such file -- /app/app/helpers/my_library (LoadError)\n</code></pre>\n\n<p>I can run <code>ls</code> and <code>cat</code> on my heroku app to verify the file is there and the contents match. When I run the application locally with <code>RAILS_ENV=production</code>, I also don't run into any issues. Also, running <code>heroku local web</code> runs fine on my machine.</p>\n\n<p>Does this have something to do with my configs <code>autoload_paths</code>? My main issue is that I can't seem to debug this locally.</p>\n\n<p><strong>EDIT:</strong>\nI've noticed that this problem arrises in dockerized instances, as well. It seems that something about containerization seems to be the problem. I've even tried creating a gem to contain the bundle following <a href=\"https://github.com/andremedeiros/ruby-c-cheat-sheet\" rel=\"nofollow noreferrer\">this guide</a>, which works locally, but again has the same issue finding the file, but this time the path is relative to the gem, not my project. I'm still stumped on what is causing this issue.</p>\n"}, {"tags": ["json", "ruby", "ruby-on-rails-3", "serialization", "activerecord"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565809457, "post_id": 57500381, "comment_id": 101470619, "body": "isn&#39;t order <code>OrderProductSerializer</code> pulling attributes from <code>OrderProduct</code> model?  can&#39;t you just add those fields to the serializer?  Can you give sample of the output you want?"}], "owner": {"reputation": 53, "user_id": 11865623, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001153112221/picture?type=large", "display_name": "Jcsreisjr", "link": "https://stackoverflow.com/users/11865623/jcsreisjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565808292, "creation_date": 1565808292, "question_id": 57500381, "link": "https://stackoverflow.com/questions/57500381/how-to-return-in-serializer-custom-fields-in-relation-to-ruby-on-rails", "title": "How to return in serializer custom fields in relation to ruby \u200bon rails?", "body": "<p>How do I add the unit_total, price fields of a relation (orders_products) to my return in products json?</p>\n\n<p><strong>Database</strong></p>\n\n<p>orders (id, user_id, ...)</p>\n\n<p>products (id, name ..)</p>\n\n<p>orders_products (product_id, order_id, unit_total, price)</p>\n\n<p><strong>order_serializer.rb</strong></p>\n\n<pre><code>class OrderSerializer &lt; ActiveModel::Serializer\n  attributes :id, :item_total, :payment_total, :quotas, :shipment_total, :additional_tax_total, :total_discount, :ip_address, :origin\n  has_one :user\n  has_one :address\n  has_one :shipping_method\n  has_many :products, serializer: OrderProductSerializer\nend\n</code></pre>\n\n<p><strong>order_product_serializer.rb</strong></p>\n\n<pre><code>class OrderProductSerializer &lt; ActiveModel::Serializer\n  attributes :id, :name, :SKU, :weight, :width, :height, :depth\n\nend\n</code></pre>\n\n<p><strong>models/order.rb</strong></p>\n\n<pre><code>class Order &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :address\n  belongs_to :shipping_method\n  has_and_belongs_to_many :products\n\n  [...]\n\nend\n</code></pre>\n\n<p><strong>models/product.rb</strong></p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  belongs_to :brand, optional: true\n  has_and_belongs_to_many :category\n  has_and_belongs_to_many :order\n\n  [...]\nend\n</code></pre>\n\n<p>Return </p>\n\n<pre><code>{\n    \"orders\": [\n        {\n            \"id\": 1500,\n            [...],\n            \"user\": {\n                [...]\n            },\n            \"address\": {\n                [..]\n            },\n            \"shipping_method\": {\n                [...]\n            },\n            \"products\": [\n                {\n                    \"id\": 12,\n                    \"name\": \"Heavy Duty Rubber Bench\",\n                    \"SKU\": \"B0002BWS1G\",\n                    \"weight\": 35.0,\n                    \"width\": 30.0,\n                    \"height\": 20.0,\n                    \"depth\": 100.0\n                },\n                {\n                    \"id\": 10,\n                    \"name\": \"Heavy Duty Steel Wallet\",\n                    \"SKU\": \"B000KJW2JS\",\n                    \"weight\": 35.0,\n                    \"width\": 30.0,\n                    \"height\": 20.0,\n                    \"depth\": 100.0\n                },\n                {\n                    \"id\": 10,\n                    \"name\": \"Heavy Duty Steel Wallet\",\n                    \"SKU\": \"B000KJW2JS\",\n                    \"weight\": 35.0,\n                    \"width\": 30.0,\n                    \"height\": 20.0,\n                    \"depth\": 100.0\n                }\n            ]\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ftp", "chilkat"], "answers": [{"tags": [], "owner": {"reputation": 1100, "user_id": 1722983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d54dcc6d4bef86fd7ee62a7cf6334a?s=128&d=identicon&r=PG", "display_name": "Chilkat Software", "link": "https://stackoverflow.com/users/1722983/chilkat-software"}, "is_accepted": true, "score": 1, "last_activity_date": 1566052273, "creation_date": 1566052273, "answer_id": 57537192, "question_id": 57499927, "link": "https://stackoverflow.com/questions/57499927/failed-to-make-a-directory-using-chilkat-lib/57537192#57537192", "title": "Failed to make a directory using Chilkat lib", "body": "<p>Try \"a/b\" instead of \"/a/b\".   When you say \"/a/b\" you're passing an absolute path, and therefore trying to create directory \"a\" in the root of the hard drive.  You want to create a directory relative to the HOME directory of your SSH account.</p>\n"}], "owner": {"reputation": 63, "user_id": 9223163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c0a244b0f04806bc70050fbaba78a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Sharma", "link": "https://stackoverflow.com/users/9223163/sumit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 57537192, "answer_count": 1, "score": 0, "last_activity_date": 1566052273, "creation_date": 1565806035, "question_id": 57499927, "link": "https://stackoverflow.com/questions/57499927/failed-to-make-a-directory-using-chilkat-lib", "title": "Failed to make a directory using Chilkat lib", "body": "<p>I am using the Chilkat gem version 9.5.0.65. and When I try to create a folder using sftp credentials it return false, while when I use Net::SFTP it creates the folder.</p>\n\n<p>As the chilkat library is compiled so I am unable to debug the issue. Can anyone suggest me what can be the issue.</p>\n\n<p>I have tried with other library with which  I am able to do. But I want to use chilkat</p>\n\n<pre><code>ftp = Chilkat::CkSFtp.new()\nmake ftp connection\nftp.CreateDir(\"/a/b\")\n#this is returing false\n</code></pre>\n\n<p>I want to know the reason behind it.</p>\n"}, {"tags": ["ruby", "xpath", "curb"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565805384, "post_id": 57499687, "comment_id": 101469033, "body": "A) Use <code>curb</code> instead of <code>open-uri</code>. B) Put these into an array. Hint: Use <code>map</code> instead of <code>each</code>, that yields what you need."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8925106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KmiF9stMVvU/AAAAAAAAAAI/AAAAAAAAAFw/KFABjCWUjfU/photo.jpg?sz=128", "display_name": "PTaHHHa", "link": "https://stackoverflow.com/users/8925106/ptahhha"}, "edited": false, "score": 0, "creation_date": 1565815430, "post_id": 57501715, "comment_id": 101472813, "body": "very comprehensive answer. Thank you,sir :)"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 57, "user_id": 8925106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KmiF9stMVvU/AAAAAAAAAAI/AAAAAAAAAFw/KFABjCWUjfU/photo.jpg?sz=128", "display_name": "PTaHHHa", "link": "https://stackoverflow.com/users/8925106/ptahhha"}, "edited": false, "score": 0, "creation_date": 1565815533, "post_id": 57501715, "comment_id": 101472858, "body": "@PTaHHHa thanks but see updated version.  I checked on the link and should be about 26 urls.  We don&#39;t need <code>&quot;|&#39;</code> in the regex so I removed it."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1565815624, "last_edit_date": 1565815624, "creation_date": 1565814981, "answer_id": 57501715, "question_id": 57499687, "link": "https://stackoverflow.com/questions/57499687/how-to-go-through-array-of-urls-using-curb/57501715#57501715", "title": "How to go through array of URLs using Curb", "body": "<p>You can use the <a href=\"https://github.com/taf2/curb\" rel=\"nofollow noreferrer\">curb gem</a></p>\n\n<pre><code>gem install curb\n</code></pre>\n\n<p>Then in your ruby script</p>\n\n<pre><code>require 'curb'\npage = \"https://www.petsonic.com/snacks-huesos-para-perros/\"\nstr = Curl.get(page).body\nlinks = str.scan(/&lt;a(.*?)&lt;\\/a\\&gt;/).flatten.select{|l| l[/class\\=\\\"product-name/]}\ninner_text_of_links = links.map{|l| l[/(?&lt;=&gt;).*/]}\nputs inner_text_of_links\n</code></pre>\n\n<p>The hard part of this was the regex let's break it down. To get the links we just scan the string for <code>&lt;a&gt;</code> tags, then get those into an array and flatten them into one array.</p>\n\n<pre><code>str.scan(/&lt;a(.*?)&lt;\\/a\\&gt;/)\n</code></pre>\n\n<p>Then we select the items which match our pattern.  We are looking for the class you specified.  </p>\n\n<pre><code>.select{|l| l[/class\\=\\\"product-name/]}\n</code></pre>\n\n<p>Now to get the innertext of the tag we just map it using a look behind regex</p>\n\n<pre><code>inner_text_of_links = links.map{|l| l[/(?&lt;=&gt;).*/]}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8925106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KmiF9stMVvU/AAAAAAAAAAI/AAAAAAAAAFw/KFABjCWUjfU/photo.jpg?sz=128", "display_name": "PTaHHHa", "link": "https://stackoverflow.com/users/8925106/ptahhha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 57501715, "answer_count": 1, "score": 1, "last_activity_date": 1565815624, "creation_date": 1565804846, "last_edit_date": 1565805345, "question_id": 57499687, "link": "https://stackoverflow.com/questions/57499687/how-to-go-through-array-of-urls-using-curb", "title": "How to go through array of URLs using Curb", "body": "<p>I need to parse this page <a href=\"https://www.petsonic.com/snacks-huesos-para-perros/\" rel=\"nofollow noreferrer\">https://www.petsonic.com/snacks-huesos-para-perros/</a> and recieve information from every item(name,price,image,etc.). The problem is that i don't know how to parse array of URL. If i were using 'open-uri' i would do something like this</p>\n\n<pre><code>require 'nokogiri'\nrequire 'open-uri'\n\n\npage=\"https://www.petsonic.com/snacks-huesos-para-perros/\"\n\n\ndoc=Nokogiri::HTML(open(page))\nlinks=doc.xpath('//a[@class=\"product-name\"]/@href')\n\nlinks.to_a.each do|url|\n  doc2=Nokogiri::HTML(open(url))\n  text=doc2.xpath('//a[@class=\"product-name\"]').text\n  puts text\nend\n</code></pre>\n\n<p>However, i am only allowed to use 'Curb' and that's making me confused</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 2, "creation_date": 1565803090, "post_id": 57499272, "comment_id": 101468120, "body": "<code>attr_reader :driver</code> means that <code>@driver</code> is accessible as <code>driver</code>"}, {"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "reply_to_user": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1565803221, "post_id": 57499272, "comment_id": 101468175, "body": "@khelwood without the <code>attr_reader</code> would I be able to just use <code>@driver</code> without needing that?"}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1565803271, "post_id": 57499272, "comment_id": 101468194, "body": "You can use <code>@driver</code> within the class if you prefer, with or without the <code>attr_reader</code> declaration."}, {"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1565803354, "post_id": 57499272, "comment_id": 101468224, "body": "It has an instance variable and an accessor. Good Ruby style."}], "answers": [{"comments": [{"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1565803500, "post_id": 57499350, "comment_id": 101468277, "body": "So I guess what advantage does this give us outside of not having to see the @ sign everywhere?"}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "reply_to_user": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 1, "creation_date": 1565803702, "post_id": 57499350, "comment_id": 101468349, "body": "It makes <code>driver</code> accessible for reading from outside the class, via <code>instance.driver</code>. It allows you to replace <code>driver</code> with an explicit method if your requirements change (without changing all the code referencing <code>driver</code>). It follows normal ruby conventions about having accessors for private instance variables. Same as writing a getter in most object-oriented languages."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1565809077, "post_id": 57499350, "comment_id": 101470491, "body": "Object-oriented programming is based on message send. A variable dereference is not a message send. You can&#39;t override a variable in a subclass. So, the question should not be &quot;why use a method&quot;, but rather &quot;why use a variable&quot;?"}], "tags": [], "owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "is_accepted": false, "score": 2, "last_activity_date": 1565803352, "creation_date": 1565803352, "answer_id": 57499350, "question_id": 57499272, "link": "https://stackoverflow.com/questions/57499272/ruby-instance-variables-within-class/57499350#57499350", "title": "Ruby instance variables within class?", "body": "<p><code>attr_reader :driver</code> means that <code>@driver</code> is accessible as <code>driver</code>. When the code refers to <code>driver</code>, it is getting <code>@driver</code>.</p>\n\n<p>You can use <code>@driver</code> within the class if you prefer, with or without the <code>attr_reader</code> declaration.</p>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 3, "last_activity_date": 1565804100, "creation_date": 1565804100, "answer_id": 57499516, "question_id": 57499272, "link": "https://stackoverflow.com/questions/57499272/ruby-instance-variables-within-class/57499516#57499516", "title": "Ruby instance variables within class?", "body": "<p><code>attr_reader :driver</code> is just a helper (macro) that defines following method:</p>\n\n<pre><code>def driver\n  @driver\nend\n</code></pre>\n\n<p>While <code>attr_writer :driver</code> would define the following:</p>\n\n<pre><code>def driver=(value)\n  @driver = value\nend\n</code></pre>\n\n<p>and <code>attr_accessor :driver</code> would define both, a reader and writer method.</p>\n\n<p>So whenever you see <code>driver</code> it calls the method that accesses <code>@driver</code>. It is good practice to access instance variable via a getter. Makes the code easier to refactor.</p>\n\n<p>Assuming you want to raise an exception if <code>driver</code> is unset, you can remove the <code>attr_reader</code> and add your own definition of <code>driver</code> without changing the rest of the code:</p>\n\n<pre><code>def driver\n  raise \"no driver set\" if !@driver\n  @driver\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1565804113, "creation_date": 1565804113, "answer_id": 57499520, "question_id": 57499272, "link": "https://stackoverflow.com/questions/57499272/ruby-instance-variables-within-class/57499520#57499520", "title": "Ruby instance variables within class?", "body": "<p>There is this line <code>attr_reader :driver</code> at the top of the class which is a macro for:</p>\n\n<pre><code>def driver\n  @driver\nend\n</code></pre>\n\n<p>The advantage to prefer this getter methods over direct @driver calls is that it makes future refactorings easier.</p>\n"}], "owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57499516, "answer_count": 3, "score": -1, "last_activity_date": 1565804113, "creation_date": 1565802968, "question_id": 57499272, "link": "https://stackoverflow.com/questions/57499272/ruby-instance-variables-within-class", "title": "Ruby instance variables within class?", "body": "<p>So I was looking over page objects for Ruby testing here:\n<a href=\"http://elementalselenium.com/tips/7-use-a-page-object\" rel=\"nofollow noreferrer\">http://elementalselenium.com/tips/7-use-a-page-object</a></p>\n\n<p>And down on the page within this bit of code:</p>\n\n<pre><code>class GoogleSearch\n\n  SEARCH_BOX        = { id: 'gbqfq'     }\n  SEARCH_BOX_SUBMIT = { id: 'gbqfb'     }\n  TOP_SEARCH_RESULT = { css: '#rso .g'  }\n\n  attr_reader :driver\n\n  def initialize(driver)\n    @driver = driver\n    visit\n    verify_page\n  end\n\n  def visit\n    driver.get ENV['base_url']\n  end\n\n  def search_for(search_term)\n    driver.find_element(SEARCH_BOX).clear\n    driver.find_element(SEARCH_BOX).send_keys search_term\n    driver.find_element(SEARCH_BOX_SUBMIT).click\n  end\n\n  def search_result_present?(search_result)\n    wait_for { displayed?(TOP_SEARCH_RESULT) }\n    driver.find_element(TOP_SEARCH_RESULT).text.include? search_result\n  end\n\n  private\n\n    def verify_page\n      driver.title.include?('Google').should == true\n    end\n\n    def wait_for(seconds=5)\n      Selenium::WebDriver::Wait.new(:timeout =&gt; seconds).until { yield }\n    end\n\n    def displayed?(locator)\n      driver.find_element(locator).displayed?\n      true\n      rescue Selenium::WebDriver::Error::NoSuchElementError\n        false\n    end\n\nend\n</code></pre>\n\n<p>It defines <code>@driver = driver</code>, but then in all the other methods it uses just <code>driver</code>. Shouldn't all the other methods be using the initialized variable <code>@driver</code>? Or is this just simply a case of mis-documentation?</p>\n\n<p>I mean after all what was the point of declaring <code>@driver</code> if we never use it again?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1565802763, "post_id": 57499200, "comment_id": 101467993, "body": "Those IDs are the record IDs. You&#39;ll need to fetch them back or use a <code>pluck()</code> that&#39;s more specific."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565805621, "post_id": 57499200, "comment_id": 101469131, "body": "What level of data do you actually want is just name =&gt; value acceptable or are you looking for formal objects"}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565862292, "post_id": 57499200, "comment_id": 101483383, "body": "@engineersmnky: Sorry for the late reply. I actually need a hash in the format <code>{name =&gt; value, name =&gt; value}</code> to create a chart powered by Chart.js. Thanks for your answers so far, I am still trying to figure out which one is the best."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565863658, "post_id": 57499200, "comment_id": 101483896, "body": "That is going to be tricky unless you can guarantee that the person&#39;s name will always be unique."}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565885043, "post_id": 57499200, "comment_id": 101493414, "body": "@engineersmnky: I can <i>almost</i> guarantee that! What would happen if there are two people with the same name (which is very unlikely...)?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565887269, "post_id": 57499200, "comment_id": 101494335, "body": "The key for a Hash must be unique so one of 2 things could happen depending on how the Hash is constructed 1) the second key would overwrite the first 2) they would be summed together under a single key and you would lose the record for one person while compounding the payments of another"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1565806244, "post_id": 57499591, "comment_id": 101469365, "body": "In this case it seems like it would be easier to go the other way e.g. <code>Person.joins(:payments).select(&#39;people.*, SUM(payments.amount) as total_payments&#39;).group(:id)</code> then these a formal <code>Person</code> objects with a virtual attribute of <code>total_payments</code> and just since I abhor raw SQL I would use <code>select(Person.arel_attribute(Arel.star), Payment.arel_attribute(:amount).sum.as(&#39;total_payments&#39;))</code>"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1565804431, "creation_date": 1565804431, "answer_id": 57499591, "question_id": 57499200, "link": "https://stackoverflow.com/questions/57499200/how-to-group-and-sum-by-foreign-key/57499591#57499591", "title": "How to group and sum by foreign key?", "body": "<p>Just be a bit more specific:</p>\n\n<pre><code>Payment.select('people.name, SUM(payments.amount)').joins(:person).group(:person_id)\n</code></pre>\n\n<p>Assuming that the <em>persons</em> table is named <code>people</code> in your application.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1565805486, "post_id": 57499602, "comment_id": 101469078, "body": "And assuming that a persons name is unique for all records"}, {"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565806046, "post_id": 57499602, "comment_id": 101469289, "body": "oh, yeah) need some changes to be done, you are right)"}, {"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565807824, "post_id": 57499602, "comment_id": 101470025, "body": "@engineersmnky, looks like you are right, and it&#39;s easier to take result from <code>Person</code> model, added the query that return relation to work with, and the initial code maybe can help somebody to group by email or other unique field)"}], "tags": [], "owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "is_accepted": false, "score": 2, "last_activity_date": 1566030516, "last_edit_date": 1566030516, "creation_date": 1565804487, "answer_id": 57499602, "question_id": 57499200, "link": "https://stackoverflow.com/questions/57499200/how-to-group-and-sum-by-foreign-key/57499602#57499602", "title": "How to group and sum by foreign key?", "body": "<p>This will return the ActiveRecord::Relation that you can work with:</p>\n\n<pre><code>Person.joins(:payments).group('persons.id').select(\"persons.id, persons.name, sum(payments.amount) as amounts_summ\")\n</code></pre>\n\n<p><strong>Only</strong> for unique <code>name</code> fields:\nAssuming you have <code>name</code> property for Person model, solution can be like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Payment.joins(:person).group(:name).order('sum_amount DESC').sum(:amount)\n</code></pre>\n\n<p>It generates query </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT SUM(\"payments\".\"amount\") AS sum_amount, \"name\" AS name FROM \"payments\" INNER JOIN \"persons\" ON \"persons\".\"id\" = \"payments\".\"persons_id\" GROUP BY \"name\" ORDER BY sum_amount DESC\n</code></pre>\n\n<p>and return hash like this:</p>\n\n<pre><code>=&gt; {\"Mike\"=&gt;22333.0, \"John\"=&gt;5676.0, \"Alex\"=&gt;2000.0, \"Carol\"=&gt;2000.0}\n</code></pre>\n"}], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566030516, "creation_date": 1565802643, "question_id": 57499200, "link": "https://stackoverflow.com/questions/57499200/how-to-group-and-sum-by-foreign-key", "title": "How to group and sum by foreign key?", "body": "<p>I have these two models in my Rails app:</p>\n\n<pre><code>class Person &lt; ApplicationRecord\n\n  has_many :payments\n\nend\n</code></pre>\n\n<hr>\n\n<pre><code>class Payment &lt; ApplicationRecord\n\n  belongs_to :person\n\nend\n</code></pre>\n\n<hr>\n\n<p>How can I group the <code>payments</code> by <code>person</code> and order them by <code>amount</code>?</p>\n\n<p>Right now I have...</p>\n\n<pre><code>Payment.group(:person_id).sum(\"amount\")\n</code></pre>\n\n<p>...which works but doesn't include the persons' names. It returns something like this:</p>\n\n<pre><code>{ 1 =&gt; 1200.00, 2 =&gt; 2500.00 }\n</code></pre>\n\n<p>How can I replace the <code>IDs</code> / integers with the persons' names and also sort the whole thing by <code>amount</code>?</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 0, "creation_date": 1565798764, "post_id": 57498167, "comment_id": 101466319, "body": "Have you looked into or are you aware of nested attributes? <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "reply_to_user": {"reputation": 2553, "user_id": 1706831, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/34b7c15de97dd917f6159feb72a3a5a8?s=128&d=identicon&r=PG", "display_name": "Kori John Roys", "link": "https://stackoverflow.com/users/1706831/kori-john-roys"}, "edited": false, "score": 0, "creation_date": 1565800071, "post_id": 57498167, "comment_id": 101466944, "body": "Hey Kori, yes, I&#39;m aware, I&#39;ve simply forgot to include in this post."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "edited": false, "score": 0, "creation_date": 1565818950, "post_id": 57498842, "comment_id": 101473822, "body": "It worked @jvillian, thank you very much. Now for update, I have to use same controller method?"}, {"owner": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "edited": false, "score": 0, "creation_date": 1565823041, "post_id": 57498842, "comment_id": 101474799, "body": "Ok, I understand now."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "edited": false, "score": 1, "creation_date": 1565823202, "post_id": 57498842, "comment_id": 101474821, "body": "That was a total bonus answer. U owe me a beer, k?"}, {"owner": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "edited": false, "score": 0, "creation_date": 1565823219, "post_id": 57498842, "comment_id": 101474825, "body": "But let`s say, that I have another many to many interaction, between users and lawsuits called &quot;passives&quot;, this method will not work, right?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "edited": false, "score": 0, "creation_date": 1565823280, "post_id": 57498842, "comment_id": 101474837, "body": "Now, THAT&#39;s a whole different question. Pose it as such and I&#39;ll take a look. You&#39;ll need to give some info about what a &quot;passive&quot; is. And, maybe, how a User is different than a Contact as it relates to actives and passives. But, yeah, it probably would need to be modified to work."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 4, "last_activity_date": 1565822314, "last_edit_date": 1565822314, "creation_date": 1565800862, "answer_id": 57498842, "question_id": 57498167, "link": "https://stackoverflow.com/questions/57498167/multiple-select-many-to-many-ruby-on-rails-not-creating-associative-records/57498842#57498842", "title": "Multiple Select many to many Ruby on Rails not creating associative records", "body": "<p>It seems to me that <code>Active</code> is a icky name for your model. Why not call it <code>LawsuitContact</code>? And then do: </p>\n\n<pre><code># == Schema Information\n#\n# Table name: lawsuit_contacts\n#\n#  id                :integer          not null, primary key\n#  lawsuit_id        :integer\n#  contact_id        :integer\n#  appointment_date  :datetime\n#  created_at        :datetime         not null\n#  updated_at        :datetime         not null\n#\nclass LawsuitContact &lt; ActiveRecord::Base\n  belongs_to :lawsuit\n  belongs_to :contact\nend\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>class Contact &lt; ActiveRecord::Base\n  has_many :lawsuit_contacts\n  has_many :lawsuits, through: :lawsuit_contacts\nend\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>class Lawsuit &lt; ActiveRecord::Base\n  has_many :lawsuit_contacts\n  has_many :contacts, through: :lawsuit_contacts\nend\n</code></pre>\n\n<p>Given that your <code>params</code> look something like:</p>\n\n<pre><code>{\n  \"lawsuit\"=&gt;{\n    \"autos\"=&gt;\"\", \n    \"forum_id\"=&gt;\"1\", \n    \"lawyer_id\"=&gt;\"4\", \n    \"conciliation_date\"=&gt;\"\", \n    \"instruction_date\"=&gt;\"\", \n    \"fees\"=&gt;\"\",\n    \"actives_attributes\"=&gt;{\n      \"0\"=&gt;{\n        \"contact_id\"=&gt;[\"\", \"2\", \"7\", \"9\"]\n      }\n    }\n  }, \n  \"commit\"=&gt;\"Create Lawsuit\"\n}\n</code></pre>\n\n<p>...in your controller you could do something like:</p>\n\n<pre><code>def create\n  @lawsuit = Lawsuit.new(lawsuit_params)\n\n  respond_to do |format|\n    if @lawsuit.save\n      @lawsuit.contacts &lt;&lt; Contact.where(id: contact_ids)\n      format.html { redirect_to @lawsuit, notice: 'Lawsuit was successfully created.' }\n      format.json { render :show, status: :created, location: @lawsuit }\n    else\n      format.html { render :new }\n      format.json { render json: @lawsuit.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\ndef update\n  @lawsuit = Lawsuit.find_by(id: params[:id])\n\n  respond_to do |format|\n    if @lawsuit.update(lawsuit_params)\n\n      # Assuming the user can remove a contact from a lawsuit, you'll want to \n      # 'unlink' the lawsuit and the contact by destroying all the relevant\n      # LawsuitContact join models:\n      @lawsuit.lawsuit_contacts.where.not(contact_id: contact_ids).destroy_all\n\n      # Then, you'll want to add any new contacts that the user might have\n      # added:\n      @lawsuit.contacts &lt;&lt; Contact.where(id: contact_ids)\n\n      format.html { redirect_to @lawsuit, notice: 'Lawsuit was successfully updated.' }\n      format.json { render :show, status: :created, location: @lawsuit }\n    else\n      format.html { render :edit }\n      format.json { render json: @lawsuit.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\nprivate\n\ndef lawsuit_params\n  params.require(:lawsuit).permit(\n    :autos, \n    :forum_id,\n    :lawyer_id,\n    :conciliation_date,\n    :instruction_date,\n    :fees\n  )\nend\n\ndef contact_ids\n  params[:lawsuit][:actives_attributes].try(:[], '0').try(:[], :contact_id)\nend\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10090966, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBwAApv1pB8/AAAAAAAAAAI/AAAAAAAAAKs/wa0JfDjFPl8/photo.jpg?sz=128", "display_name": "Alexandre Hansen", "link": "https://stackoverflow.com/users/10090966/alexandre-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 57498842, "answer_count": 1, "score": 0, "last_activity_date": 1565822314, "creation_date": 1565798056, "last_edit_date": 1565800147, "question_id": 57498167, "link": "https://stackoverflow.com/questions/57498167/multiple-select-many-to-many-ruby-on-rails-not-creating-associative-records", "title": "Multiple Select many to many Ruby on Rails not creating associative records", "body": "<p>Well, I have a many to many association between Contacts and Lawsuits on a table named Actives. In this case, I'm trying to add many contacts to a lawsuit. The problem is: the actives not saving in lawsuits if select is multiple, only if multiple: false.</p>\n\n<p>Here's the models:</p>\n\n<pre><code>    #contact.rb\n    class Contact &lt; ActiveRecord::Base\n    ...\n    has_many :actives\n    has_many :lawsuits, through: :actives\n\n    #lawsuit.rb\n    class Lawsuit &lt; ActiveRecord::Base\n    ...\n    has_many :actives\n    has_many :contacts, through: :actives\n\n    accepts_nested_attributes_for :actives, allow_destroy: true\n\n    #active.rb\n    class Active &lt; ActiveRecord::Base\n    ...\n    belongs_to :lawsuit\n    belongs_to :contact\n</code></pre>\n\n<p>And Here's the migration table:</p>\n\n<pre><code>    class CreateActives &lt; ActiveRecord::Migration\n     def change\n      create_table :actives do |t|\n       t.belongs_to :contact, index: true\n       t.belongs_to :lawsuit, index: true\n       t.datetime :appointment_date\n       t.timestamps\n      end\n     end\n    end\n</code></pre>\n\n<p>The controller:</p>\n\n<pre><code>    #controller/lawsuit.rb\n    #create method\n\n    def create\n      @lawsuit = Lawsuit.new(lawsuit_params)\n\n      respond_to do |format|\n        if @lawsuit.save\n          format.html { redirect_to @lawsuit, notice: 'Lawsuit was successfully created.' }\n          format.json { render :show, status: :created, location: @lawsuit }\n        else\n          format.html { render :new }\n          format.json { render json: @lawsuit.errors, status: :unprocessable_entity }\n        end\n      end\n    end\n\n    #require params\n    params.require(:contact).permit(:name, :lastname, :cpf, :rg, :birthdate, :profession_id, :marital_status_id, :address,\n                                    :zipcode, :city, :state, :district, :number, :actives)\n</code></pre>\n\n<p>The view and output params:</p>\n\n<pre><code>    #/views/lawsuits/_form.html.erb\n    &lt;%= form_for @lawsuit, html: {class: \"ui form\"} do |f| %&gt;\n    ...\n    &lt;%= f.fields_for :actives do |w| %&gt;\n      &lt;%= w.select(:contact_id, Contact.all.pluck(:name,:id), {}, {class:\"selectize-generic\", multiple: true})  %&gt;\n    &lt;% end %&gt;\n    &lt;%= f.submit %&gt;\n\n    #Params:\n    Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"9dpRjs0e2iQXgYzNqObSyzuvEnVdQYVHos922hbu0UptxiVeZfJgxgbfgFGKOUR16119VFLOfheNGogAOwez/w==\", \n    \"lawsuit\"=&gt;{\"autos\"=&gt;\"\", \"forum_id\"=&gt;\"1\", \"lawyer_id\"=&gt;\"4\", \"conciliation_date\"=&gt;\"\", \"instruction_date\"=&gt;\"\", \"fees\"=&gt;\"\",\n    \"actives_attributes\"=&gt;{\"0\"=&gt;{\"contact_id\"=&gt;[\"\", \"2\", \"7\", \"9\"]}}}, \"commit\"=&gt;\"Create Lawsuit\"}\n</code></pre>\n\n<p>In last saved Lawsuit:</p>\n\n<pre><code>    rails c\n    x = Lawsuit.last\n    =&gt; #&lt;Lawsuit id: 17, forum_id: 1, lawyer_id: 4, fees: nil, autos: \"\", conciliation_date: \"\", instruction_date: \"\", created_at: \"2019-08-14 15:43:18\", updated_at: \"2019-08-14 15:43:18\"&gt;\n    x.actives\n    =&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Active id: 9, contact_id: nil, lawsuit_id: 17, appointment_date: nil, created_at: \"2019-08-14 15:43:18\", updated_at: \"2019-08-14 15:43:18\"&gt;]&gt;\n</code></pre>\n\n<p>I've been wasting a lot of time on this, I've already try everything, recreate models, tried simple_form gem, change in params, etc. I'm lost.\nAnyone can help?</p>\n\n<p>GitHub for the project: \n<a href=\"https://github.com/killerowns/lawsuit-manager-rails\" rel=\"nofollow noreferrer\">https://github.com/killerowns/lawsuit-manager-rails</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 2, "creation_date": 1565797503, "post_id": 57497978, "comment_id": 101465718, "body": "cause emails += 120 and that counts to 120, 240, 360, 480, 600 etc"}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 1, "creation_date": 1565797513, "post_id": 57497978, "comment_id": 101465720, "body": "Can you see <code>500</code> in the list of values printed by <code>puts emails</code>? <code>until emails == 500</code> stops when <code>emails</code> is exactly <code>500</code>, no more, no less."}], "answers": [{"tags": [], "owner": {"reputation": 24667, "user_id": 797303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DahZJ.jpg?s=128&g=1", "display_name": "Maxim Krizhanovsky", "link": "https://stackoverflow.com/users/797303/maxim-krizhanovsky"}, "is_accepted": false, "score": 3, "last_activity_date": 1565797534, "creation_date": 1565797534, "answer_id": 57498026, "question_id": 57497978, "link": "https://stackoverflow.com/questions/57497978/why-is-my-loop-continuing-past-its-limit/57498026#57498026", "title": "Why is my loop continuing past it&#39;s limit?", "body": "<p>Your condition is <code>emails == 500</code>. This means that any number different than 500 will continue the loop. What you're trying to achieve however is <code>until emails &gt;= 500</code></p>\n"}], "owner": {"reputation": 139, "user_id": 11733988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aadab9637e9ff4b33c2da17b2acb05a5?s=128&d=identicon&r=PG&f=1", "display_name": "marcus", "link": "https://stackoverflow.com/users/11733988/marcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1565797534, "creation_date": 1565797361, "question_id": 57497978, "link": "https://stackoverflow.com/questions/57497978/why-is-my-loop-continuing-past-its-limit", "title": "Why is my loop continuing past it&#39;s limit?", "body": "<p>The inner loop seems to be working fine, but the outer loop goes past the 500 limit. Why is this?</p>\n\n<pre><code>Given(\"I save all emails\") do\n  emails = 0\n  i = 1\n  until emails == 500\n      until i == 120\n          fetch_emails(i, emails)\n          i += 1\n      end\n      click_next_button\n      emails += 120\n      puts emails\n      i = 1\n      puts i\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "capybara", "pageobjects"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565799897, "post_id": 57497883, "comment_id": 101466856, "body": "Trying to understand your question ... so currently the &#39;browser&#39; is some invisible global (that&#39;s why you call <code>visit</code> without a caller) but you want to instead have it be a variable you can pass around?"}, {"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565800242, "post_id": 57497883, "comment_id": 101467017, "body": "Basically, as thats how I see people do method chaining returning page objects. I&#39;d assume maybe i&#39;d call an instance of <code>@browser</code> possibly in the constructor perhaps?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1565805230, "post_id": 57497883, "comment_id": 101468969, "body": "Well, you can return <code>self</code> from methods such as <code>visit_url</code> which would make it chainable"}], "answers": [{"comments": [{"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1565895469, "post_id": 57513264, "comment_id": 101497639, "body": "Where would be the appropriate places to store those global settings (This isn&#39;t a rails repository fwiw). And you say &quot;If instead you store a reference to the session you want the object to use in each object&quot;. Im a bit confused at what you mean or an example of this and what specifically I did that causes this issue?  And im not sure what code would be changing the current session? (I&#39;ve been using this example with no problems so far, but it didn&#39;t &#39;feel&#39; right."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1565897164, "post_id": 57513264, "comment_id": 101498277, "body": "@msmith1114 The current session can be changed anywhere by using <code>using_session</code>, changing the current driver, calling <code>session_name=</code> or setting <code>Capybara.app</code> - Generally you wouldn&#39;t want that changing the session used by existing page objects.  As for the global settings - generally they would be set one time wherever you&#39;re doing the initial setup for your app."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1565897556, "post_id": 57513264, "comment_id": 101498398, "body": "@msmith1114 For the instance of the session - if in your initialize method you set <code>@session = Capybara.current_session</code> and then called all capybara methods on @session (@session.visit, @session.find, etc) you would no longer have the issue of the session potentially being changed.  Each object would store the current session at the time the object was created.  The better option is to pass in the session when creating the objects - where you could initially pass in <code>Capybara.current_session</code> when creating the main Page - and then it could pass that on when creating the child objects"}, {"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1565898170, "post_id": 57513264, "comment_id": 101498626, "body": "So maybe just in each page object I can have an initialize method that takes a variable and stores that in an <code>@browser</code> or <code>@session</code> variable (used in that page object). I guess in the test script (using rspec) I can just create this @session variable to pass within the <code>let</code> before each describe scenario.  In this case I need to remove the Capybara::DSL call i&#39;d assume in the beginning? Just trying to think of where exactly the best place to register my driver is. Since this isn&#39;t a rails setup (but just a ruby one)"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1565888006, "creation_date": 1565888006, "answer_id": 57513264, "question_id": 57497883, "link": "https://stackoverflow.com/questions/57497883/capybara-instance-of-browser-for-page-object-model/57513264#57513264", "title": "Capybara instance of &quot;browser&quot; for Page Object Model?", "body": "<p>You don't want to be registering your drivers in the initialize for the base PageObject since that means every object created will be registering new driver configs - which isn't desirable.</p>\n\n<p>When you include Capybara::DSL into your class you're including methods that end up calling methods on <code>Capybara.current_session</code>. ie <code>visit</code> => <code>Capybara.current_session.visit</code>.  The result of <code>Capybara.current_session</code> is the \"@browser\" instance you're asking about since it encapsulates the driver/browser instance. The issue with the way you've currently implemented that is that if any code changes the current session then all your objects will suddenly refer to the new session. If instead you store a reference to the session you want the object to use in each object and call the Capybara methods on that session rather than using Capybara::DSL (<code>@session.visit ...</code>) then you can be sure the session an object is using doesn't change unexpectedly.</p>\n\n<p>Also note that things like <code>Capybara.default_max_wait_time</code>, `Capybara.current_driver', etc are global settings so setting them inside your PageObject class isn't a great idea.</p>\n"}], "owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 57513264, "answer_count": 1, "score": 0, "last_activity_date": 1565888006, "creation_date": 1565797042, "question_id": 57497883, "link": "https://stackoverflow.com/questions/57497883/capybara-instance-of-browser-for-page-object-model", "title": "Capybara instance of &quot;browser&quot; for Page Object Model?", "body": "<p>Im writing a framework using Capybara and the Page Object Model for a web application. It's my first time writing my own framework and using PoM for automation.</p>\n\n<p>My base \"Page Object\" essentially initializes the driver and is used in every other page object child class (for the individual pages)</p>\n\n<pre><code>class PageObject\n    include Capybara::DSL\n    BASE_URL = 'https://www.atesturl.com'\n    Capybara.default_max_wait_time = 5\n\n    def initialize\n\n        Capybara.register_driver :selenium_chrome do |app|\n            Capybara::Selenium::Driver.load_selenium\n            browser_options = ::Selenium::WebDriver::Chrome::Options.new.tap do |opts|\n              # Workaround https://bugs.chromium.org/p/chromedriver/issues/detail?id=2650&amp;q=load&amp;sort=-id&amp;colspec=ID%20Status%20Pri%20Owner%20Summary\n              opts.args &lt;&lt; '--disable-site-isolation-trials'\n            end\n            Capybara::Selenium::Driver.new(app, browser: :chrome, options: browser_options)\n          end\n\n        Capybara.register_driver :selenium_chrome_headless do |app|\n            Capybara::Selenium::Driver.load_selenium\n            browser_options = ::Selenium::WebDriver::Chrome::Options.new.tap do |opts|\n              opts.args &lt;&lt; '--headless'\n              opts.args &lt;&lt; 'window-size=2880,1800'\n              opts.args &lt;&lt; '--disable-gpu' if Gem.win_platform?\n              #opts.args &lt;&lt; '--remote-debugging-port=9222'\n              # Workaround https://bugs.chromium.org/p/chromedriver/issues/detail?id=2650&amp;q=load&amp;sort=-id&amp;colspec=ID%20Status%20Pri%20Owner%20Summary\n              opts.args &lt;&lt; '--disable-site-isolation-trials'\n            end\n            Capybara::Selenium::Driver.new(app, browser: :chrome, options: browser_options)\n          end\n\n        Capybara.current_driver = :selenium_chrome\n    end\n\n    def visit_url\n        visit BASE_URL\n    end\n\n  end\n</code></pre>\n\n<p>In most examples of PoM I see the methods returning an instance of that page object, but generally they use some <code>@browser</code> instance variable that is passed around. Within my test scripts I simple call an instance of the Base page object class via <code>let(:p) {PageObject.new}</code> and then <code>p.visit_url</code> then make new instances of the other page objects via <code>new</code>....but this seems like the wrong way to do it.</p>\n\n<p>How exactly do I return a instance of the <code>@browser</code> or driver that I can pass around? And how should I be calling it in my spec?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "acts-as-tenant"], "comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1565804487, "post_id": 57497431, "comment_id": 101468645, "body": "What is the <code>t = Tenant.new..</code> class you are initializing on <code>create_tenant</code>?"}, {"owner": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "reply_to_user": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1565804561, "post_id": 57497431, "comment_id": 101468679, "body": "That is the new tenant that we need to set as current tenant and ensure the new user and new organization gets associated with as well."}, {"owner": {"reputation": 522, "user_id": 4693218, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7acbd56750d6214a787638e1e5fb605c?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Smith", "link": "https://stackoverflow.com/users/4693218/travis-smith"}, "edited": false, "score": 0, "creation_date": 1582757527, "post_id": 57497431, "comment_id": 106891747, "body": "Did you figure this out? I&#39;m not sure your Tenant model is necessary, so I&#39;d love to see your solution."}], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565805439, "post_id": 57499651, "comment_id": 101469056, "body": "This is helping.. although our Organizations are tenanted too. Also, what is the correct way to associate my user to a new organization because I can&#39;t save the user or the organization until my tenant is set"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565806219, "post_id": 57499651, "comment_id": 101469356, "body": "What do you mean organizations are tenanted too? To what model? There is always one model that does not have the <code>acts_as_tenant</code> because it IS the tenant, in your case sounds like <code>organization</code> is that model"}, {"owner": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565806320, "post_id": 57499651, "comment_id": 101469400, "body": "Tenant is that model in our case"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565806353, "post_id": 57499651, "comment_id": 101469409, "body": "Okay so you are missing code on your post. Please include the <code>Tenant</code> model and the relation that the class <code>user</code> or <code>organization</code> has with that class."}, {"owner": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565806549, "post_id": 57499651, "comment_id": 101469487, "body": "the User and Organization model are simply acts_as_tenant(:tenant) the tenant model is just: class Tenant &lt; ActiveRecord::Base     acts_as_paranoid    include TenantHelper     has_many :system_properties     class &lt;&lt; self      def find!(tenant_id)       find(tenant_id).as_current_tenant!     end    end  end"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "reply_to_user": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565806653, "post_id": 57499651, "comment_id": 101469529, "body": "But does <code>user</code> or <code>organization</code> <code>belong_to :tenant</code> ? Else it won&#39;t work!"}, {"owner": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "edited": false, "score": 0, "creation_date": 1565807195, "post_id": 57499651, "comment_id": 101469772, "body": "No, that&#39;s not true because the belongs_to gets set within the acts_as_tenant gem.."}], "tags": [], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "is_accepted": false, "score": 0, "last_activity_date": 1565806734, "last_edit_date": 1565806734, "creation_date": 1565804713, "answer_id": 57499651, "question_id": 57497431, "link": "https://stackoverflow.com/questions/57497431/rails-devise-and-acts-as-tenant-registration-process/57499651#57499651", "title": "Rails: Devise and acts_as_tenant registration process", "body": "<p>I don't know your business logic but in order to do\n<code>acts_as_tenant(:tenant)</code> your model has to have a relation defined to <code>tenant</code>, which you don't seem to have. \nI think what you want to do (common use case) is:</p>\n\n<pre><code>class User &lt; ActionController::Base\n  belongs_to :organization\n  acts_as_tenant(:organization)\nend\n\nclass Organization &lt; ActionController::Base\n  self.primary_key = :uuid\n  has_many :users\n  # and nothing else\nend\n</code></pre>\n\n<p>You don't set the current tenant on the model. That is not correct. You do that on the Application Controller, by doing <code>set_current_tenant(current_user.organization)</code> and nothing else</p>\n\n<p>UPDATE: You mentionew a Tenant class now. </p>\n\n<p>So now your organization class should define that relation</p>\n\n<pre><code>class Organization &lt; ApplicationRecord\n  acts_as_tenant(:tenant)\n  self.primary_key = :uuid\n  has_many :users\n  belongs_to :tenant\n\n  before_validation :create_tenant\n\n  def create_tenant\n    puts 'making new tenant'\n    self.tenant ||= Tenant.create!(:short_name =&gt; self.name)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 2048210, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ed145758b4749ecc6ecd49a56277824b?s=128&d=identicon&r=PG", "display_name": "justin henricks", "link": "https://stackoverflow.com/users/2048210/justin-henricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565806734, "creation_date": 1565795254, "question_id": 57497431, "link": "https://stackoverflow.com/questions/57497431/rails-devise-and-acts-as-tenant-registration-process", "title": "Rails: Devise and acts_as_tenant registration process", "body": "<p>I am using acts_as_tenant gem to manage a multi-tenant platform while using devise to manage users. A User in our system acts_as_tenant and belongs_to Organization. Organization acts_as_tenant and has_many Users. </p>\n\n<p>We are having trouble understanding what the best way to ensure that upon sign up a User gets created, an Organization gets created, a Tenant gets created (based on the Org), and the current tenant gets saved subsequently setting the correct tenant_id on the User and Org model. </p>\n\n<p>The problem is in order for a User to be valid it must have an organization and a tenant. So before validation happens we must create the org and the tenant, we are trying to do so with below code:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable, :confirmable\n\n  acts_as_tenant(:tenant)\n  acts_as_paranoid\n  belongs_to :organization\n\n  before_validation :create_organization\n\n  def create_organization\n    if self.organization_id.nil?\n      org = Organization.new(name: self.email)\n      org.uuid = UUIDTools::UUID.random_create.to_s\n      self.organization_id = org.uuid\n    end\n  end\nend\n</code></pre>\n\n<pre><code>class Organization &lt; ApplicationRecord\n  acts_as_tenant(:tenant)\n  self.primary_key = :uuid\n  has_many :users\n\n  before_validation :create_tenant\n\n  def create_tenant\n    puts 'making new tenant'\n    t = Tenant.new(:short_name =&gt; self.name)\n  end\nend\n</code></pre>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  set_current_tenant_through_filter\n  before_action :find_current_tenant\n  def find_current_tenant\n    unless current_user.nil?\n      set_current_tenant(current_user.organization.tenant)\n    end\n  end\nend\n</code></pre>\n\n<p>But the users org and tenant are not being created before validation causing validation errors 'tenant must exist', 'org must exist'.</p>\n\n<p>Any help on best practices here?</p>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "webpack", "ruby-on-rails-6"], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 6877447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b3ceb5f269d4929385b863047eb8c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi S", "link": "https://stackoverflow.com/users/6877447/rishi-s"}, "is_accepted": true, "score": 4, "last_activity_date": 1565794750, "creation_date": 1565794750, "answer_id": 57497264, "question_id": 57496670, "link": "https://stackoverflow.com/questions/57496670/ruby-on-rails-6-how-to-reference-images-from-asset-pipeline-for-css/57497264#57497264", "title": "Ruby on Rails 6 how to reference images from asset pipeline for css", "body": "<p>A quick fix solution that should work:</p>\n\n<ol>\n<li>Rename the css file to use .scss (SASS extension)</li>\n<li>Then use image-url</li>\n</ol>\n\n<p>This should work without fault and will allow you to use the rails helper functions.</p>\n"}], "owner": {"reputation": 133, "user_id": 7753227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e26816e32b0483c425b0939dc8db80?s=128&d=identicon&r=PG&f=1", "display_name": "Rs Graphics", "link": "https://stackoverflow.com/users/7753227/rs-graphics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2500, "favorite_count": 0, "accepted_answer_id": 57497264, "answer_count": 1, "score": 1, "last_activity_date": 1565794750, "creation_date": 1565792823, "question_id": 57496670, "link": "https://stackoverflow.com/questions/57496670/ruby-on-rails-6-how-to-reference-images-from-asset-pipeline-for-css", "title": "Ruby on Rails 6 how to reference images from asset pipeline for css", "body": "<p>I am trying to create a rails 6 application. In rails 5 while sass was still applicable I would use image-url(xxx.png) to reference images within the asset pipeline. However, in rails 6 this is no longer applicable with web pack. I cannot seem to load up the image.</p>\n\n<p>I have tried using different tags like asset-url, adjusting the url for a direct path but with no luck.</p>\n\n<p>.banner {\n  background-image: url(asset_path('home/head-banner.png'));\n  ...\n}</p>\n\n<p>.banner {\n  background-image: image-url('home/head-banner.png');\n  ...\n}</p>\n\n<p>The expected result is the fully hashed url for the image.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1565788024, "post_id": 57495131, "comment_id": 101460299, "body": "My controller inherits <code>ApplicationController</code>. If that&#39;s the case should my presenter class extend something?"}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "reply_to_user": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1565788826, "post_id": 57495131, "comment_id": 101460803, "body": "Can you add the ApplicationController code to the answer?"}, {"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1565790404, "post_id": 57495131, "comment_id": 101461780, "body": "I&#39;ve added it to the bottom of the original post."}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "reply_to_user": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1565791390, "post_id": 57495131, "comment_id": 101462343, "body": "Try this:   in application_controller.rb  <code>class ApplicationController &lt; ActionController::Base   protect_from_forgery with: :exception end</code>"}, {"owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 0, "creation_date": 1565792572, "post_id": 57495131, "comment_id": 101462989, "body": "Still results in the same error. Even after restarting the Rails server."}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "reply_to_user": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "edited": false, "score": 1, "creation_date": 1565794470, "post_id": 57495131, "comment_id": 101464024, "body": "Sorry, I don&#39;t have more info. Maybe because Rails 6 is only in release candidate could have some bugs. Try looking your issue in github/rails or report it if you don&#39;t see it."}], "tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": false, "score": 0, "last_activity_date": 1565787214, "creation_date": 1565787214, "answer_id": 57495131, "question_id": 57494138, "link": "https://stackoverflow.com/questions/57494138/rails-6-how-can-i-use-button-to-in-a-presenter-class/57495131#57495131", "title": "Rails 6: How can I use `button_to` in a presenter class?", "body": "<p>This seems unrelated to button. <code>protect_against_forgery?</code> is a method that enable security for CSRF attacks. Usually, this error appears when using Rails as API mode, because Controllers does not extend from ApplicationController but ActionController. Check if this is your case.</p>\n"}], "owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565790377, "creation_date": 1565783401, "last_edit_date": 1565790377, "question_id": 57494138, "link": "https://stackoverflow.com/questions/57494138/rails-6-how-can-i-use-button-to-in-a-presenter-class", "title": "Rails 6: How can I use `button_to` in a presenter class?", "body": "<p>I have a presenter:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class PresentedOrderService\n  include Rails.application.routes.url_helpers\n\n  attr_reader :service, :order\n  delegate :date, to: :service\n\n  def initialize(service, order)\n    @service = service\n    @order = order\n  end\n\n  def order?\n    service.date == order.delivery_date\n  end\n\n  def confirmation_text\n    'Click ok to confirm your order.'\n  end\nend\n</code></pre>\n\n<p>I have a view which shows a button conditionally:</p>\n\n<pre><code>&lt;% if service.order? %&gt;\n  &lt;div class=\"badge badge-success\"&gt;Your order is booked for this date&lt;/div&gt;\n&lt;% else %&gt;\n  &lt;%= button_to service.button_text,\n      arrange_delivery_path(\n          id: service.order.id,\n          date: service.date,\n        ),\n      data: {\n              confirm: service.confirmation_text\n            }\n  %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>As a refactoring step, I want to move the button into the presenter:</p>\n\n<pre><code>&lt;% if service.order? %&gt;\n  &lt;div class=\"badge badge-success\"&gt;Your order is booked for this date&lt;/div&gt;\n&lt;% else %&gt;\n  &lt;%= service.button %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class PresentedOrderService\n#...\n  def button\n    helpers.button_to(\n      button_text,\n      arrange_delivery_path(\n        id: order.id,\n        date: date,\n      ),\n      data: { confirm: confirmation_text }\n    )\n  end\n</code></pre>\n\n<p>However, this doesn't work. I get this error error in the console:</p>\n\n<pre><code>ActionView::Template::Error (undefined method `protect_against_forgery?' for nil:NilClass):\n    18:               &lt;% if service.order? %&gt;\n    19:                 &lt;div class=\"badge badge-success\"&gt;Your order is booked for this date&lt;/div&gt;\n    20:               &lt;% else %&gt;\n    21:                 &lt;%= service.button\n    22:                 %&gt;\n    23:               &lt;% end %&gt;\n    24:             &lt;/div&gt;\n\napp/controllers/orders_controller.rb:21:in `button'\napp/views/orders/edit.html.erb:21\n</code></pre>\n\n<p>I can see that the problem comes from using the <code>button_to</code> method because I see the same error when I change my code to:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def button\n    helpers.button_to 'Home', Rails.application.routes.url_helpers.root_path\n  end\n</code></pre>\n\n<p>I'm not sure what the error is referring to when it says <code>nil:NilClass</code>. Where does that come from?</p>\n\n<p>What steps do I need to take to enable <code>button_to</code> to work in the presenter. Is it possible?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's the controller:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class OrdersController &lt; ApplicationController\n  def edit\n    @order = Order.find(params[:id])\n    @services = ServiceDate.all.map { |service| PresentedOrderService.new(service, @order) }\n  end\n\n  def update\n    if @order.update(delivery_date: params[:date])\n      flash[:success] = 'Your delivery has been booked'\n      redirect_to root_path\n    else\n      flash.now[:warning] = 'Error. Please try again or contact support'\n      render 'edit'\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "sass"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565780807, "post_id": 57493347, "comment_id": 101456648, "body": "It sounds like you&#39;re trying to use per-page-CSS, but are actually loading all CSS on all pages."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565780855, "post_id": 57493347, "comment_id": 101456669, "body": "My advice would be to look at <code>webpacker</code>, and configure your views to only load the desired pack(s), rather than always loading everything."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11831257"}, "is_accepted": true, "score": 3, "last_activity_date": 1565782248, "creation_date": 1565782248, "answer_id": 57493838, "question_id": 57493347, "link": "https://stackoverflow.com/questions/57493347/problem-with-scss-files-affecting-more-than-one-view/57493838#57493838", "title": "Problem with scss files affecting more than one view", "body": "<p>This is because rails(or asset pipeline to be precise) will include all your <code>.scss</code> files in every page in development environment. Right click on your HTML page -> click \"View Page source\" and you can see all <code>.scss</code> files.</p>\n\n<p>Rails gives you structure of files like <code>news.scss</code> or <code>leaderboard.scss</code> in <code>css</code> folder so that you can organize your controller specific code to make your code life productive. Rails will then bundle and minimize/optimize all of these files in to one file <code>application.scss</code> in production environment.</p>\n\n<blockquote>\n  <p>When I change the background color of a table (or anything else) for the stats page to red(just a random color) in stats.scss, both the news and leaderboard views are also affected and change their colors to red, even if I had set them to a different color in their own scss files(like blue and green).</p>\n</blockquote>\n\n<p>This is because your <code>leaderboard</code> and <code>news.scss</code> is loaded first and then <code>stats.scss</code> is loaded. Rails asset pipeline will load the CSS files in Ascending order when you use <code>require tree .</code> in <code>application.scss</code>. Thus, the color values of <code>leaderboard.scss</code> and <code>news.scss</code> don't apply as <code>stats.scss</code> is inluded at the last.</p>\n\n<p>You should consider using different classes or make global background class colors. Ex:</p>\n\n<pre><code>// news.scss\n.news-table{\n  background: \"yellow\";\n}\n\n// stats.scss\n.stats-table{\n  background: \"red\";\n}\n</code></pre>\n\n<p>Then in your <code>news.html.erb</code> file you can use:</p>\n\n<pre><code>&lt;table class=\"news-table\"&gt;...&lt;/table&gt;\n</code></pre>\n\n<hr>\n\n<p>Or you can do this the global way:</p>\n\n<pre><code>// application.scss\n.red-bg{\n  background: red;\n}\n\n.yellow-bg{\n  background: yellow;\n}\n</code></pre>\n\n<p>Then in your <code>news.html.erb</code> and <code>stats.scss</code> files:</p>\n\n<pre><code>// news.html.erb\n&lt;table class=\"red-bg\"&gt;...&lt;/table&gt;\n\n// stats.html.erb\n&lt;table class=\"yellow-bg\"&gt;...&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8967101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61862ba796919506c61306ab8c9eaa0c?s=128&d=identicon&r=PG&f=1", "display_name": "Arturo Medina", "link": "https://stackoverflow.com/users/8967101/arturo-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57493838, "answer_count": 1, "score": 1, "last_activity_date": 1565782248, "creation_date": 1565780251, "question_id": 57493347, "link": "https://stackoverflow.com/questions/57493347/problem-with-scss-files-affecting-more-than-one-view", "title": "Problem with scss files affecting more than one view", "body": "<p>I'm building a football league web page with ruby on rails. I have three pages(scaffolds) created: news, stats and leaderboard. Each one of them has a scss file and is also affected by <code>application.scss</code> and <code>scaffolds.scss</code>.</p>\n\n<p>When I change the background color of a table (or anything else) for the stats page to red(just a random color) in <code>stats.scss</code>, both the news and leaderboard views are also affected and change their colors to red, even if I had set them to a different color in their own scss files(like blue and green).</p>\n\n<p>I don't understand why this is happening. Isn't the <code>stats.scss</code> file supposed to affect only the stats view?</p>\n\n<p>The colors aren't set in the <code>application.scss</code> or <code>scaffolds.scss</code> files either, so I don't know why every view is being affected by the <code>stats.scss</code> file.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11926677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a9c774dc51671af55413e979026deed?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11926677/chris"}, "edited": false, "score": 0, "creation_date": 1565809487, "post_id": 57495880, "comment_id": 101470632, "body": "Thanks Luke. I&#39;m usin Rails and a DB. The catch is how to reward the users who referred the ones who referred others by half depending on the referal degree. So A refers B, B refers C, C refers D. Upon D signup A gets 1 + 0.5 + 0.25 (if B &amp; C signed up too)"}], "tags": [], "owner": {"reputation": 11, "user_id": 11923117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9fjO-MabixQ/AAAAAAAAAAI/AAAAAAAAD28/39-KXbkvXDU/photo.jpg?sz=128", "display_name": "Luke Weaver", "link": "https://stackoverflow.com/users/11923117/luke-weaver"}, "is_accepted": false, "score": 0, "last_activity_date": 1565822524, "last_edit_date": 1565822524, "creation_date": 1565789824, "answer_id": 57495880, "question_id": 57492748, "link": "https://stackoverflow.com/questions/57492748/keep-track-of-rewards-for-refered-users/57495880#57495880", "title": "Keep track of rewards for refered users", "body": "<p>I think this works out!</p>\n\n<p><strong>What if you made a table in the database called referrals that basically stores one column, a json hash with each value being an array, that keeps a record of all of the referrals and users. So for example, <code>{A: [B, E], B: [C], C: [D], D: [] E: []}</code> Then when calculating points parse it by taking all of the points that the person they referred has and multiply it by half. So A would get 1 point for referring B but it would also be plus the .75 because B would have referred C who referred D. So if you trace that back, C = 1 + ((D's referrals, 0)/2), and B = 1 + ((C's referrals, 1)/2), and A = 1 + ((B's referrals, 1.5)/2) and then A is equal to 1.75, however since I also added E, it would be another 1 point.</strong></p>\n\n<p>I hope this is what you are looking for! If not let me know!</p>\n\n<p>C = 1, B = 1 + (1/2), A = 2 + (1.5/2)</p>\n"}], "owner": {"reputation": 25, "user_id": 11926677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a9c774dc51671af55413e979026deed?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11926677/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565822524, "creation_date": 1565777899, "question_id": 57492748, "link": "https://stackoverflow.com/questions/57492748/keep-track-of-rewards-for-refered-users", "title": "Keep track of rewards for refered users", "body": "<p>I'm trying to reward users based on referals. The catch is that the new registered users will hopefully reward the referer of its referer too (by half the reward).</p>\n\n<p>Lets say A refers B (B signs up), A gets 1 point. B refers C (C signs up), B gets 1 point and A gets 0.5 points (because B was refered by A). \nSo: A gets 1 + 0.5 points, B gets 1 point (for refering C).</p>\n\n<p>B refers D, C refers D (D signs up)\nB gets 1 point (C gets no points because B refered D first)</p>\n\n<p>and so on ...</p>\n\n<p>I think of tracking it like this:</p>\n\n<pre><code>class User\n  def initialize\n    refered_by = nil\n    refered = []\n    points = nil\n  end\nend\n</code></pre>\n\n<p>For the example the referals would be saved like this:</p>\n\n<pre><code>A.refered_by = nil\nA.refered = [B]\nB.refered_by = A\nB.refered = [C,D]\nC.refered_by = B\nD.refered_by = B\n</code></pre>\n\n<p>Of course, no sign up gives no points.</p>\n\n<p>Something like this to calculate the points:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def points\n  direct_refs = User.where(refered_by: self.id)\n  total_points = direct_refs.count\n  direct_refs.each do |i|\n    next_level_refs = User.where(refered_by: i)\n    total_points += next_level_refs.count / 2\n  end\n  # this should go deep until the user gets all the earned points\n  return total_points\nend\n</code></pre>\n\n<p>Upon signup, calculating points for the example would be like this:</p>\n\n<pre><code>A.points -&gt; 1 + 0.5 + 0.5  (1 for B, 0.5 for C, 0.5 for D)\nB.points -&gt; 1 + 1  (1 for C, 1 for D)\n</code></pre>\n\n<p>I also thought about using trees, but couldn't figure out how.</p>\n\n<p>Any insight, or documentation I could read is very much appreciated.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "redis", "sidekiq"], "comments": [{"owner": {"reputation": 2223, "user_id": 325564, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0631b3d2f7af26b9e00c9c2f76171096?s=128&d=identicon&r=PG", "display_name": "Tadas T", "link": "https://stackoverflow.com/users/325564/tadas-t"}, "edited": false, "score": 0, "creation_date": 1565777770, "post_id": 57491735, "comment_id": 101455126, "body": "The issue was a new service that was accidentally sharing the same redis connection with the service in question (configuration copy-pasta). I would have been clearer if I had custom queue names instead of just leaving <code>default</code> everywhere.   I will leave this question open in case folks have insights on how to debug this by inspecting the network or redis connections."}], "answers": [{"tags": [], "owner": {"reputation": 364, "user_id": 5431951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4788fc8596724d6d84f3ecbd88e43591?s=128&d=identicon&r=PG&f=1", "display_name": "Jeechu Deka", "link": "https://stackoverflow.com/users/5431951/jeechu-deka"}, "is_accepted": false, "score": 1, "last_activity_date": 1565808457, "creation_date": 1565808457, "answer_id": 57500412, "question_id": 57491735, "link": "https://stackoverflow.com/questions/57491735/tracing-the-source-of-unknown-sidekiq-processes/57500412#57500412", "title": "Tracing the source of unknown Sidekiq processes", "body": "<p>Two ways which might help -</p>\n\n<ol>\n<li><p>Redis client list - You could list all clients connected to the redis and filter by name, pid, age, db etc to get the IP address from where the connection was initiated.\n<code>redis-cli -h &lt;redis-host&gt; client list</code> and apply filters.</p></li>\n<li><p>Logs - Sidekiq logs the process hostname (eg, <code>bc2e797afd0c</code>) and pid in logs. You could trace the log back to it's host using other identifiers like IP, container ID etc. which might be logged as well.</p></li>\n</ol>\n"}], "owner": {"reputation": 2223, "user_id": 325564, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0631b3d2f7af26b9e00c9c2f76171096?s=128&d=identicon&r=PG", "display_name": "Tadas T", "link": "https://stackoverflow.com/users/325564/tadas-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565808457, "creation_date": 1565774347, "question_id": 57491735, "link": "https://stackoverflow.com/questions/57491735/tracing-the-source-of-unknown-sidekiq-processes", "title": "Tracing the source of unknown Sidekiq processes", "body": "<p>I have a service in production, hosted on AWS, that is supposed to run 2 Sidekiq processes: 1 on each of the two load-balanced machines. However, there seem to be 2 extra processes that I can't trace back to where they're originating from. I've tried rebooting both of the machines hoping it would kill any of the ghost processes, but the two unknown processes have remained alive, while the other two have restarted, so they are probably running somewhere else.</p>\n\n<p><a href=\"https://i.stack.imgur.com/iB3kr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iB3kr.png\" alt=\"enter image description here\"></a></p>\n\n<p>The ghost processes are causing issues raising 'Uninitialized constant: ', so it makes me think they do not have the application code and are connected by mistake. I've made them quiet for now.</p>\n\n<p>How do I trace the source of these two processes? As you can see from the image, the host description is not very useful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redmine", "ubuntu-18.04", "plesk-onyx"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1565776828, "post_id": 57490779, "comment_id": 101454653, "body": "A corrupt file perhaps?"}, {"owner": {"reputation": 2453, "user_id": 800965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fMjbN.jpg?s=128&g=1", "display_name": "Aleksandar Pavi\u0107", "link": "https://stackoverflow.com/users/800965/aleksandar-pavi%c4%87"}, "edited": false, "score": 0, "creation_date": 1565810051, "post_id": 57490779, "comment_id": 101470846, "body": "As I can see, on the Plesk tutorial it says Redmine 3.4 not Redmine 4.x, please retry with Redmine 3.4..."}, {"owner": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 0, "creation_date": 1565848508, "post_id": 57490779, "comment_id": 101478900, "body": "Double check the file <code>database.yml</code> you&#39;ve edited on Step 8. Download it and make sure there&#39;s no suspicious <i>null bytes</i>"}, {"owner": {"reputation": 9, "user_id": 5820320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/31A4T.jpg?s=128&g=1", "display_name": "Benjamin Wiens", "link": "https://stackoverflow.com/users/5820320/benjamin-wiens"}, "reply_to_user": {"reputation": 2453, "user_id": 800965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fMjbN.jpg?s=128&g=1", "display_name": "Aleksandar Pavi\u0107", "link": "https://stackoverflow.com/users/800965/aleksandar-pavi%c4%87"}, "edited": false, "score": 0, "creation_date": 1565869503, "post_id": 57490779, "comment_id": 101485894, "body": "@AleksandarPavi\u0107 That&#39;s exactly what it was. With v3.4 it works according to instructions \u2014 Thank you so much!"}, {"owner": {"reputation": 9, "user_id": 5820320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/31A4T.jpg?s=128&g=1", "display_name": "Benjamin Wiens", "link": "https://stackoverflow.com/users/5820320/benjamin-wiens"}, "reply_to_user": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1565869513, "post_id": 57490779, "comment_id": 101485898, "body": "@Eyeslandic i don&#39;t think so. I can open the file without any problems"}, {"owner": {"reputation": 9, "user_id": 5820320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/31A4T.jpg?s=128&g=1", "display_name": "Benjamin Wiens", "link": "https://stackoverflow.com/users/5820320/benjamin-wiens"}, "reply_to_user": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 0, "creation_date": 1565869516, "post_id": 57490779, "comment_id": 101485899, "body": "@LyzardKyng Ive checked it. Nothing to see there..."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 5820320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/31A4T.jpg?s=128&g=1", "display_name": "Benjamin Wiens", "link": "https://stackoverflow.com/users/5820320/benjamin-wiens"}, "is_accepted": false, "score": -1, "last_activity_date": 1565869721, "creation_date": 1565869721, "answer_id": 57509192, "question_id": 57490779, "link": "https://stackoverflow.com/questions/57490779/deploy-redmine-4-x-on-plesk-server-argumenterror-string-contains-null-byte/57509192#57509192", "title": "Deploy Redmine 4.x on Plesk-Server: ArgumentError: string contains null byte", "body": "<h2><strong>Aleksandar Pavi\u0107</strong> was right:</h2>\n\n<blockquote>\n  <p>As I can see, on the Plesk tutorial it says Redmine 3.4 not Redmine\n  4.x, please retry with Redmine 3.4...</p>\n</blockquote>\n\n<hr>\n\n<p>With Redmine 3.4.X it worked! Thank you a lot! \ud83d\udc4c</p>\n"}], "owner": {"reputation": 9, "user_id": 5820320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/31A4T.jpg?s=128&g=1", "display_name": "Benjamin Wiens", "link": "https://stackoverflow.com/users/5820320/benjamin-wiens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565869721, "creation_date": 1565770546, "question_id": 57490779, "link": "https://stackoverflow.com/questions/57490779/deploy-redmine-4-x-on-plesk-server-argumenterror-string-contains-null-byte", "title": "Deploy Redmine 4.x on Plesk-Server: ArgumentError: string contains null byte", "body": "<p>Im following this Tutorial to Deploy a Redmine Instance on my vServer: <a href=\"https://support.plesk.com/hc/en-us/articles/115001670625\" rel=\"nofollow noreferrer\">https://support.plesk.com/hc/en-us/articles/115001670625</a></p>\n\n<p>I get an Error at Point 14.2 \"Insert RAILS_ENV=production db:migrate to the Task parameters field and click Run.\"</p>\n\n<p>Redmine-Version: 4.0.4\nRuby Version: 2.6.3-p62</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>** Invoke db:migrate (first_time)\n** Invoke db:load_config (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Execute db:load_config\n** Execute db:migrate\nrake aborted!\nArgumentError: string contains null byte\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/mysql2-0.5.2/lib/mysql2/client.rb:90:in `connect'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/mysql2-0.5.2/lib/mysql2/client.rb:90:in `initialize'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/mysql2_adapter.rb:22:in `new'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/mysql2_adapter.rb:22:in `mysql2_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:811:in `new_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:855:in `checkout_new_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:834:in `try_to_checkout_new_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:795:in `acquire_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:523:in `checkout'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:1014:in `retrieve_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_handling.rb:118:in `retrieve_connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_handling.rb:90:in `connection'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/tasks/database_tasks.rb:172:in `migrate'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/activerecord-5.2.3/lib/active_record/railties/databases.rake:60:in `block (2 levels) in '\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/task.rb:273:in `block in execute'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/task.rb:273:in `each'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/task.rb:273:in `execute'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/task.rb:214:in `block in invoke_with_call_chain'\n/opt/plesk/ruby/2.6.3/lib/x86_64-linux-gnu/ruby/2.6.0/monitor.rb:230:in `mon_synchronize'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/task.rb:194:in `invoke_with_call_chain'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/task.rb:183:in `invoke'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:160:in `invoke_task'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:116:in `block (2 levels) in top_level'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:116:in `each'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:116:in `block in top_level'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:125:in `run_with_threads'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:110:in `top_level'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:83:in `block in run'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:186:in `standard_exception_handling'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/lib/rake/application.rb:80:in `run'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/gems/rake-12.3.3/exe/rake:27:in `'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/bin/rake:23:in `load'\n/var/www/vhosts/redmine.domain/vendor/bundle/ruby/2.6.0/bin/rake:23:in `\n'\nTasks: TOP =&gt; db:migrate\n</code></pre>\n\n<p>I don't know what else to do. In the forum of Plesk and Redmine nobody could help me so far...</p>\n"}, {"tags": ["ruby", "kubernetes"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1565774615, "post_id": 57489873, "comment_id": 101453537, "body": "I&#39;m not sure if kubeclient gem supports server addresses with paths (<code>MY_HOST&#47;k8s&#47;clusters&#47;c-h4mdn&#47;api&#47;v1</code> instead of <code>MY_HOST&#47;api&#47;v1</code>). k8s-client gem does (disclaimer: am one of the authors)"}, {"owner": {"reputation": 11, "user_id": 7893062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ffcb693837b1af24bf40073d014932?s=128&d=identicon&r=PG&f=1", "display_name": "PaulChan", "link": "https://stackoverflow.com/users/7893062/paulchan"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1565830264, "post_id": 57489873, "comment_id": 101475968, "body": "@Kimmo Lehto Thank you for your answer, I can actually GET the results when I use the GET method to request the same path, but the POST method doesn&#39;t work"}], "owner": {"reputation": 11, "user_id": 7893062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21ffcb693837b1af24bf40073d014932?s=128&d=identicon&r=PG&f=1", "display_name": "PaulChan", "link": "https://stackoverflow.com/users/7893062/paulchan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565769571, "creation_date": 1565767118, "last_edit_date": 1565769571, "question_id": 57489873, "link": "https://stackoverflow.com/questions/57489873/k8s-api-request-with-kubeclient-ruby-gem-returns-bad-request-400", "title": "K8s API request with kubeclient ruby gem returns bad-request (400)", "body": "<p>I'm making a K8s API request with <a href=\"https://github.com/abonas/kubeclient\" rel=\"nofollow noreferrer\"><code>kubeclient</code> ruby gem</a> and it returns bad-request (400)</p>\n\n<pre><code>ruby: 2.5.0\nk8s client version: 1.13.4\nk8s server version: 1.14.5\nkubeclient: 4.4.0\n</code></pre>\n\n<p>My code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'kubeclient'\nrequire 'json'\nrequire 'open3'\n\ncontent = File.open(\"nginx.yaml\").read\n\np suffix_name = File.extname(\"nginx.yaml\")\n\ncase suffix_name\nwhen '.yaml' then\n    hash = YAML.safe_load(content)\n    p \"yaml content is:#{hash}\"\nwhen '.json' then\n    hash = JSON.parse(content)\n    p \"json content is:#{hash}\"\nend\n\nhash.each do |key, value|\n    puts \"#{key} is: #{value}\"\n    if key == \"kind\"\n    @kind = value.to_s.downcase\n    end\nend\n\nconfig = Kubeclient::Config.read(\"rancher_kube_config.kubeconfig\")\n\nkubeconfig_text = File.read(\"rancher_kube_config.kubeconfig\")\nconfig_context = Kubeclient::Config.new(YAML.safe_load(kubeconfig_text), nil)\n@config = config_context.instance_eval { @kcfg }\nconfig = @config\ndeployment = Kubeclient::Resource.new(hash)\ncert_store = OpenSSL::X509::Store.new\nssl_options = {\n    cert_store: cert_store,\n    verify_ssl: OpenSSL::SSL::VERIFY_NONE\n}\ncontext = config_context.context\nauth_options = {\n        bearer_token: context.auth_options[:bearer_token]\n}\nclient = Kubeclient::Client.new('https://{my_host}/k8s/clusters/c-h4mdn/api', auth_options: auth_options, ssl_options: ssl_options)\n\nbegin\n  @create_entity = client.send(\"create_#{@kind}\", deployment)\nrescue Kubeclient::HttpError =&gt; e\n    p e\n    @error_code = e.error_code\n    @message = e.message\nend\n\nif @create_entity.nil?\n    p \"false\"\nelse\n    p \"success\"\nend\n\n</code></pre>\n\n<p>The contents of <code>config.kubeconfig</code>:</p>\n\n<pre><code>apiVersion: v1\nkind: Config\nclusters:\n- name: \"k8s\"\n  cluster:\n    server: \"https://MY_HOST/k8s/clusters/c-h4mdn\"\n    certificate-authority-data: ...\n- name: \"k8s-k8smaster\"\n  cluster:\n    server: \"https://MY_HOST:6443\"\n    certificate-authority-data: ...\n\nusers:\n- name: \"user-8lhbv\"\n  user:\n    token: my_token\n\ncontexts:\n- name: \"k8s\"\n  context:\n    user: \"user-8lhbv\"\n    cluster: \"k8s\"\n- name: \"k8s-k8smaster\"\n  context:\n    user: \"user-8lhbv\"\n    cluster: \"k8s-k8smaster\"\n\ncurrent-context: \"k8s\"\n</code></pre>\n\n<p>The contents of <code>nginx.yaml</code>:</p>\n\n<pre><code>apiVersion: apps/v1\nkind: Pod\nmetadata:\n  name: nginx-test2\n  labels:\n     app: nginx\n  namespace: default\nspec:\n     containers:\n        - name: nginx\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          ports:\n          - containerPort: 80\n     restartPolicy: Always\n</code></pre>\n\n<p>The error I'm getting is this, and I think it maybe the <code>apiVersion</code> is wrong:</p>\n\n<pre><code>#&lt;Kubeclient::HttpError: HTTP status code 400, Pod in version \"v1\" cannot be handled as a Pod: no kind \"Pod\" is registered for version \"clusters/v1\" in scheme \"k8s.io/kubernetes/pkg/api/legacyscheme/scheme.go:29\" for POST https://MY_HOST/k8s/clusters/c-h4mdn/api/v1/namespaces/default/pods&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "oop"], "comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1565767193, "post_id": 57489766, "comment_id": 101450009, "body": "Do you need the list to be dynamic?"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1565779214, "post_id": 57489766, "comment_id": 101455867, "body": "Have you taken a look at the <code>dry-rb</code> ecosystem, especially the <code>dry-validation</code> gem <a href=\"https://dry-rb.org/gems/dry-validation/1.0/\" rel=\"nofollow noreferrer\">dry-rb.org/gems/dry-validation/1.0</a> <a href=\"https://dry-rb.org/gems/dry-schema/\" rel=\"nofollow noreferrer\">dry-rb.org/gems/dry-schema</a> It does maybe something similar and is a heavily maintained gem, just a suggestion"}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565768018, "post_id": 57489936, "comment_id": 101450334, "body": "Wouldn&#39;t it be a little easier to do <code>def initialize(options = [])</code>? (The OP doesn&#39;t seem to indicate that anything other than the <code>array_of_attribute_names</code> will be passed in.) If sticking with the hash being passed in, wouldn&#39;t you be able to do <code>if options[:array_of_attribute_names]</code> - which would be nil or not? If going with an array passed in, wouldn&#39;t you be able to do away with the <code>if</code> condition altogether?"}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1565768519, "post_id": 57489936, "comment_id": 101450563, "body": "That would work as well. I&#39;m just going with the options hash convention. I just figured OP could use that key and pass an array as the value."}, {"owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "edited": false, "score": 0, "creation_date": 1565769833, "post_id": 57489936, "comment_id": 101451193, "body": "Thank you for answering, unfortunately this does not work\u2014see my comment on jvillian&#39;s answer."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1565767408, "creation_date": 1565767408, "answer_id": 57489936, "question_id": 57489766, "link": "https://stackoverflow.com/questions/57489766/accessing-a-variable-in-the-body-of-a-class/57489936#57489936", "title": "Accessing a variable in the body of a class", "body": "<p>You could overload the initialize method. Something like this should work, but you might have to tweak the argument structure to accommodate the  <code>Muffin</code> base class:</p>\n\n<pre><code>class MyForm &lt; Muffin::Base\n  def initialize(options = {})\n    if options[:array_of_attribute_names].present?\n      options[:array_of_attribute_names].each do |attribute_name|\n        attribute attribute_name\n      end\n    end\n    super\n  end\nend\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>@form = MyForm.new(array_of_attribute_names: array_of_attribute_names)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "edited": false, "score": 0, "creation_date": 1565769715, "post_id": 57490178, "comment_id": 101451124, "body": "Thank you for answering. Unfortunately, I get a <code>undefined method &#39;attribute&#39; for #&lt;MyForm:0x00007f9f88550530&gt;</code> error when I try this. I <i>think</i> that&#39;s because <code>#attribute</code> is <a href=\"https://github.com/nerdgeschoss/muffin/blob/5c055d5a668506ab41a869e5ca9d6031d32dc2cb/lib/muffin/frostings/attributes.rb#L9\" rel=\"nofollow noreferrer\">defined</a> as a class method, which makes it available on <code>MyForm</code> (an instance of <code>Class</code>), but not on any instance of <code>MyForm</code>. Can I somehow access this method in this context?"}, {"owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "edited": false, "score": 0, "creation_date": 1565771668, "post_id": 57490178, "comment_id": 101452112, "body": "I&#39;m afraid using <code>class_eval</code> means I&#39;m back to square one, as I can now access the method, but I no longer have the <code>options</code> hash at my disposal."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "edited": false, "score": 0, "creation_date": 1565793205, "post_id": 57490178, "comment_id": 101463334, "body": "I don&#39;t know what &#39;no longer have the options hash at my disposal&#39; means. Say more, please. You can, after all, simply assign it to an instance variable and be on your way. What, exactly, is it you wish to do with the options other than what describe in your original question?"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1565770000, "last_edit_date": 1565770000, "creation_date": 1565768396, "answer_id": 57490178, "question_id": 57489766, "link": "https://stackoverflow.com/questions/57489766/accessing-a-variable-in-the-body-of-a-class/57490178#57490178", "title": "Accessing a variable in the body of a class", "body": "<p>Just to riff on the answer provided by NM Pennypacker...</p>\n\n<p>If you want to do:</p>\n\n<pre><code>@form = MyForm.new(array_of_attribute_names: array_of_attribute_names)\n</code></pre>\n\n<p>Then it seems like you could do: </p>\n\n<pre><code>class MyForm &lt; Muffin::Base\n  def initialize(options={})\n    class_eval do \n      options[:array_of_attribute_names].each do |attribute_name|\n        attribute attribute_name\n      end if options[:array_of_attribute_names]\n    end\n    super\n  end\nend\n</code></pre>\n\n<p>If you want to stick with the way you outline in your question: </p>\n\n<pre><code>@form = MyForm.new(array_of_attribute_names)\n</code></pre>\n\n<p>Then it seems like you could do: </p>\n\n<pre><code>class MyForm &lt; Muffin::Base\n  def initialize(options=[])\n    class_eval do \n      options.each do |attribute_name|\n        attribute attribute_name\n      end\n    end\n    super\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1565770000, "creation_date": 1565766692, "question_id": 57489766, "link": "https://stackoverflow.com/questions/57489766/accessing-a-variable-in-the-body-of-a-class", "title": "Accessing a variable in the body of a class", "body": "<p>I'm trying to implement form objects in my application, using <a href=\"https://github.com/nerdgeschoss/muffin\" rel=\"nofollow noreferrer\">Muffin</a>.</p>\n\n<p>In my controller, I do this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyController &lt; ApplicationController\n  def new\n    @form = MyForm.new\n  end\nend\n</code></pre>\n\n<p>Where <code>MyForm</code> is a form object, like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyForm &lt; Muffin::Base\n  attribute :my_attribute\nend\n</code></pre>\n\n<p>What I would like to do is essentially this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyController &lt; ApplicationController\n  def new\n    @form = MyForm.new(array_of_attribute_names)\n  end\nend\n</code></pre>\n\n<p>So that when instantiating <code>MyForm</code>, I could do something along the lines of:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyForm &lt; Muffin::Base\n  array_of_attribute_names.each do |name|\n    attribute name\n  end\nend\n</code></pre>\n\n<p>I know that the above does not work and that it betrays a lack of understanding of Ruby's OO model. Is there a way I can achieve an equivalent effect?</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "watir", "page-object-gem"], "answers": [{"tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1565788139, "creation_date": 1565788139, "answer_id": 57495389, "question_id": 57489201, "link": "https://stackoverflow.com/questions/57489201/how-to-navigate-to-a-link-using-page-object-gem/57495389#57495389", "title": "How to navigate to a link using page object gem?", "body": "<p>You cannot call <code>#navigate_to</code> within <code>#navigate_to</code> as it will go into an infinite loop. There are a couple ways to solve this.</p>\n\n<p>The easiest approach is to name your method differently. Part of the benefit is that it's clear that this page's <code>#navigate_to</code> is different than other pages.</p>\n\n<pre><code>def navigate_or_click(link)\n    if link == 'Test'\n        create\n    else\n        navigate_to \"http://test.jprr.w3test/#{link}\"\n    end\nend\n</code></pre>\n\n<p>If you want to stick with the <code>#navigate_to</code> method name, you just need to call the appropriate browser method instead:</p>\n\n<pre><code>def navigate_or_click(link)\n    if link == 'Test'\n        create\n    else\n        browser.goto \"http://test.jprr.w3test/#{link}\" # or platform.navigate_to\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 2775990, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/q0b2b.jpg?s=128&g=1", "display_name": "spectator", "link": "https://stackoverflow.com/users/2775990/spectator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 57495389, "answer_count": 1, "score": 1, "last_activity_date": 1565788139, "creation_date": 1565764153, "question_id": 57489201, "link": "https://stackoverflow.com/questions/57489201/how-to-navigate-to-a-link-using-page-object-gem", "title": "How to navigate to a link using page object gem?", "body": "<p>How to navigate to a page using page-object gem when am calling in a method?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class SidePage\n include PageObject\n\nlink(:create, text: /Create/)\n\ndef navigate_to(link)\n  if link == 'Test'\n    create\n  else\n    navigate_to \"http://test.jprr.w3test/#{link}\" # --&gt; here i need to navigate on else condition.\n  end\nend\n</code></pre>\n\n<p>I need to navigate to the given link dynamically in else condition based on the #{link} text.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "is_accepted": true, "score": 3, "last_activity_date": 1565767166, "last_edit_date": 1565767166, "creation_date": 1565765657, "answer_id": 57489532, "question_id": 57489057, "link": "https://stackoverflow.com/questions/57489057/difference-between-def-setup-and-setup-do-in-minitest/57489532#57489532", "title": "Difference between &quot;def setup&quot; and &quot;setup do&quot; in Minitest?", "body": "<p>There was another test file with the class defined as <code>class FooTest &lt; ActiveSupport::TestCase</code>. I imagine someone created it by copying the original <code>FooTest</code> file, and forgot to change the name.</p>\n\n<p>In short, the other <code>FooTest</code>'s setup method had been getting called instead of this one. Coincidentally, the other <code>FooTest</code> had also been calling the same <code>create_three_users</code> in the setup, which was why I didn't realise this till I tried and failed to assign an instance variable.</p>\n\n<p>I couldn't find much info on the actual difference between <code>def setup</code> and <code>setup do</code>, but one <a href=\"http://docs.komagata.org/5203\" rel=\"nofollow noreferrer\">blog</a> (you'll have to take my word because it's written in Japanese) writes that <code>setup do</code> calls the setup process for not only that class but also the its parent class, which might explain why my tests worked using <code>setup do</code> (maybe it called the <code>setup</code> for both <code>FooTest</code>s).</p>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 57489532, "answer_count": 1, "score": 5, "last_activity_date": 1601486042, "creation_date": 1565763443, "last_edit_date": 1565763780, "question_id": 57489057, "link": "https://stackoverflow.com/questions/57489057/difference-between-def-setup-and-setup-do-in-minitest", "title": "Difference between &quot;def setup&quot; and &quot;setup do&quot; in Minitest?", "body": "<p>Are there any differences at all between calling <code>def setup</code> and <code>setup do</code> in Rails Minitests? I had been using <code>def setup</code> this whole time, but I suddenly found that my <code>setup</code> for a particular test file was not being called. When I changed it to <code>setup do</code>, it suddenly worked again (without changing anything else). But I find this very peculiar, and I'd rather stick to <code>def setup</code> for everything if possible, for consistency. Any advice is appreciated.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'test_helper'\nrequire_relative '../../helpers/user_helper'\n\nclass FooTest &lt; ActiveSupport::TestCase\n  include UserHelper\n\n  # This method doesn't get called as-is.\n  # But it does get called if I change the below to `setup do`.\n  def setup\n    # create_three_users is a UserHelper method.\n    create_three_users\n    @test_user = User.first\n  end\n\n\n  test 'should abc' do\n    # Trying to call @test_user here returned nil.\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "class"], "comments": [{"owner": {"reputation": 1013, "user_id": 2137237, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/QIfio.jpg?s=128&g=1", "display_name": "Markus Deibel", "link": "https://stackoverflow.com/users/2137237/markus-deibel"}, "edited": false, "score": 0, "creation_date": 1565762892, "post_id": 57488937, "comment_id": 101448333, "body": "What error do you get?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1565763230, "post_id": 57488937, "comment_id": 101448438, "body": "<code>case pr</code> \u2192 <code>case</code> and <code>&amp;</code> \u2192 <code>&amp;&amp;</code> in both places."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1565775932, "post_id": 57488937, "comment_id": 101454173, "body": "<code>pr.between?(40, 60)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11925680, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Sp0aYNbL_l8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRNRvKcGdwsyIMFX_X2EMIf5OcDg/photo.jpg?sz=128", "display_name": "Nirmal Bhakat", "link": "https://stackoverflow.com/users/11925680/nirmal-bhakat"}, "edited": false, "score": 0, "creation_date": 1565764021, "post_id": 57489111, "comment_id": 101448727, "body": "Yup i got that ...  Thanks anyways"}], "tags": [], "owner": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "is_accepted": true, "score": 0, "last_activity_date": 1565763693, "creation_date": 1565763693, "answer_id": 57489111, "question_id": 57488937, "link": "https://stackoverflow.com/questions/57488937/undefined-method-for-truetrueclass-nomethoderror/57489111#57489111", "title": "undefined method `&lt;&#39; for true:TrueClass (NoMethodError)", "body": "<p>Your error sounds give you your answer.</p>\n\n<p>The <code>undefined method</code> is <code>&lt;</code>, so your value go inside your first case. It seems your value is a <code>boolean</code> which is equal to <code>true</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1565765755, "creation_date": 1565765755, "answer_id": 57489548, "question_id": 57488937, "link": "https://stackoverflow.com/questions/57488937/undefined-method-for-truetrueclass-nomethoderror/57489548#57489548", "title": "undefined method `&lt;&#39; for true:TrueClass (NoMethodError)", "body": "<p>I don't understand why you use <code>&amp;</code> for <em>and</em>-ing instead of <code>&amp;&amp;</code>, but in this case, operator precedence kills your. While</p>\n\n<pre><code> a &gt; b &amp;&amp; c &lt; d\n</code></pre>\n\n<p>is interpreted as</p>\n\n<pre><code>(a &gt; b) &amp;&amp; (c &lt; d)\n</code></pre>\n\n<p>the expression</p>\n\n<pre><code>a &gt; b &amp; c &lt; d\n</code></pre>\n\n<p>is taken as </p>\n\n<pre><code>(a &gt; (b &amp; c)) &lt; d\n</code></pre>\n\n<p>which means:</p>\n\n<ul>\n<li>calculate first the binary <em>and</em> of b and c (which already doesn't make that much sense in your case), yielding some integer.</li>\n<li>see wheather a is greater than this, yielding a bool.</li>\n<li>see wheather this bool is larger than d, which yields an exception.</li>\n</ul>\n\n<p>Have a look at <a href=\"https://www.techotopia.com/index.php/Ruby_Operator_Precedence\" rel=\"nofollow noreferrer\">the operator precedence table</a> for Ruby.</p>\n"}], "owner": {"reputation": 23, "user_id": 11925680, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Sp0aYNbL_l8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRNRvKcGdwsyIMFX_X2EMIf5OcDg/photo.jpg?sz=128", "display_name": "Nirmal Bhakat", "link": "https://stackoverflow.com/users/11925680/nirmal-bhakat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 57489111, "answer_count": 2, "score": 1, "last_activity_date": 1565765755, "creation_date": 1565762687, "last_edit_date": 1565763034, "question_id": 57488937, "link": "https://stackoverflow.com/questions/57488937/undefined-method-for-truetrueclass-nomethoderror", "title": "undefined method `&lt;&#39; for true:TrueClass (NoMethodError)", "body": "<p>I have just started learning Ruby and while doing a switch case problem i encountered this error.</p>\n\n<pre><code>puts \"Enter your percentage\"\npr = gets.to_i\ncase pr\n    when (pr &lt; 40)\n        puts \"He gets a D\"\n    when (pr &gt;= 40 &amp; pr &lt; 60)\n        puts \"He gets a C\"\n    when (pr &gt;=60 &amp; pr&lt;80)\n        puts \"He gets a B\"\n    when (pr &gt;= 80)\n        puts \"He gets an A\"\n    else\n        puts \"he gets an A\"\nend\n</code></pre>\n\n<p>When i input 85 i got that error. Can anyone suggest me some change.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1565758809, "post_id": 57488374, "comment_id": 101447234, "body": "Try <code>total_hours = @payload[:activities].sum{|activity| activity[:hours].to_f}</code>"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565759088, "post_id": 57488374, "comment_id": 101447308, "body": "@jvillian Thank you so much it worked!! Can you say what was i doing wrong"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565759201, "post_id": 57488374, "comment_id": 101447333, "body": "Yes, adding as an answer right now."}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1565759370, "post_id": 57488374, "comment_id": 101447372, "body": "You have targeted object instead of array. thats the reason <code>[:activities]</code> is array of obj."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1565759537, "post_id": 57488374, "comment_id": 101447411, "body": "Oh my bad, Thank you. Can you add this as an answer so i can choose it as my answer so it would be helpful to others too."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1565759985, "post_id": 57488374, "comment_id": 101447510, "body": "<code>@payload</code> is an object (an instance of the class <code>Hash</code>, which is also an object). <code>@payload[:activities]</code> is also an object (an instance of the class <code>Array</code>, which is also an object). And, each element of <code>@payload[:activities]</code> is also an object (each an instance of the class <code>Hash</code>). In Rubyland, everything is an object. So, it&#39;s not about &quot;targeting object instead of array&quot;, really."}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1565759471, "creation_date": 1565759471, "answer_id": 57488461, "question_id": 57488374, "link": "https://stackoverflow.com/questions/57488374/how-to-calculate-the-sum-of-array-inside-hash-ruby/57488461#57488461", "title": "How to calculate the sum of array inside hash ruby", "body": "<p>You should use: </p>\n\n<pre><code>total_hours = @payload[:activities].sum{|activity| activity[:hours].to_f}\n</code></pre>\n\n<p>You see, what you're wanting to do is, essentially: </p>\n\n<pre><code>[\n  {\n    :project=&gt;1,\n    :activity=&gt;\"my activity\",\n    :hours=&gt;0.2e1,\n    :date=&gt;Sat, 10 Aug 2019 00:00:00 UTC +00:00\n  },\n  {\n    :project=&gt;2,\n    :activity=&gt;\"Tester\",\n    :hours=&gt;0.2e1,\n    :date=&gt;Thu, 01 Aug 2019 00:00:00 UTC +00:00\n  },\n  {\n    :project=&gt;2,\n    :activity=&gt;\"Tester\",\n    :hours=&gt;0.3e1,\n    :date=&gt;Thu, 01 Aug 2019 00:00:00 UTC +00:00\n  }\n].sum{|activity| activity[:hours].to_f}\n</code></pre>\n\n<p>But, you're calling <code>.sum</code> on the <code>@payload</code> variable, which is a hash. What you want is the value of the hash that is associated with the key <code>:activities</code>. Thus, you need to call <code>.sum</code> on <code>@payload[:activities]</code> where <code>@payload[:activities]</code> returns the array above.</p>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1566139378, "post_id": 57495463, "comment_id": 101554351, "body": "<code>@payload[:activities].sum(:hours)</code> will work and is shorter."}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "edited": false, "score": 0, "creation_date": 1566230787, "post_id": 57495463, "comment_id": 101582392, "body": "No, you&#39;ll have an undefined method + for :hours Symbol. Check it."}], "tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": false, "score": 2, "last_activity_date": 1566139346, "last_edit_date": 1566139346, "creation_date": 1565788377, "answer_id": 57495463, "question_id": 57488374, "link": "https://stackoverflow.com/questions/57488374/how-to-calculate-the-sum-of-array-inside-hash-ruby/57495463#57495463", "title": "How to calculate the sum of array inside hash ruby", "body": "<p>If you are using Rails, here is a short way:</p>\n\n<pre><code>@payload[:activities].pluck(:hours).reduce(:+)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57488461, "answer_count": 2, "score": 1, "last_activity_date": 1566139346, "creation_date": 1565758641, "last_edit_date": 1565759149, "question_id": 57488374, "link": "https://stackoverflow.com/questions/57488374/how-to-calculate-the-sum-of-array-inside-hash-ruby", "title": "How to calculate the sum of array inside hash ruby", "body": "<p>Hai i am creating a json file with my data and i need to calculate the hours before i save it into the database </p>\n\n<p>I am assigning that hash into a variable payload and tried doing this but it returns me an error TypeError (no implicit conversion of Symbol into Integer):</p>\n\n<pre><code>total_hours = @payload.sum{|activity| activity[:hours].to_f}\n</code></pre>\n\n<p><em>Hash before converting to json</em></p>\n\n<pre><code>{:activities=&gt;\n  [{:project=&gt;1,\n    :activity=&gt;\"my activity\",\n    :hours=&gt;0.2e1,\n    :date=&gt;Sat, 10 Aug 2019 00:00:00 UTC +00:00},\n   {:project=&gt;2,\n    :activity=&gt;\"Tester\",\n    :hours=&gt;0.2e1,\n    :date=&gt;Thu, 01 Aug 2019 00:00:00 UTC +00:00},\n   {:project=&gt;2,\n    :activity=&gt;\"Tester\",\n    :hours=&gt;0.3e1,\n    :date=&gt;Thu, 01 Aug 2019 00:00:00 UTC +00:00}]}\n\n</code></pre>\n\n<p>I need to sum the hours of my array which is inside the hash. Thanks</p>\n"}, {"tags": ["ruby", "reactjs", "selenium", "selenium-webdriver", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1565764159, "post_id": 57487929, "comment_id": 101448774, "body": "This is with ruby but not watir? You should post some code,"}, {"owner": {"reputation": 21, "user_id": 10505289, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KrFOp2iCkDA/AAAAAAAAAAI/AAAAAAAAALQ/U2u1Y2jqIYA/photo.jpg?sz=128", "display_name": "Naresh Sekar", "link": "https://stackoverflow.com/users/10505289/naresh-sekar"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1566214893, "post_id": 57487929, "comment_id": 101573733, "body": "@pguardiario i am just trying to click a button. <code>driver.find_element(:css,&#39;div button&#39;).click</code>. Only difference i see here is that the button is present in react.js popup."}], "owner": {"reputation": 21, "user_id": 10505289, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KrFOp2iCkDA/AAAAAAAAAAI/AAAAAAAAALQ/U2u1Y2jqIYA/photo.jpg?sz=128", "display_name": "Naresh Sekar", "link": "https://stackoverflow.com/users/10505289/naresh-sekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565754613, "creation_date": 1565754613, "question_id": 57487929, "link": "https://stackoverflow.com/questions/57487929/selenium-chrome-click-action-takes-infinite-time-to-complete", "title": "Selenium Chrome, &#39;click&#39; action takes infinite time to complete", "body": "<p>I am performing a click action on an element which is not available in web (chrome) browser.</p>\n\n<p>Expectation is to throw <code>element not found</code> exception and fail the test, but selenium driver is waiting indefinitely(more than 10 hours) for the element to load and the test got hanged in middle. </p>\n\n<p>Note: I also set the implicit_time wait for the webdriver as 10 seconds.\nIf some other element is not found in the web page, driver is throwing the <code>element not found</code> exception as expected, but only on clicking an element in the <code>react.js popup</code> this scenario happens.</p>\n\n<p>Does any one faced same situation like above?</p>\n\n<p>Application Frontend : react.js </p>\n\n<p>Chrome version : 76.0.3809.100</p>\n\n<p>Chrome driver version : 76.0.3809.68/chromedriver_mac64.zip</p>\n\n<p>The test gets hanged only on the click action. When we try to assert whether the element is <code>displayed?</code> we are getting <code>false</code> immediately. Changed the code to click on the element only if it is displayed. I this case the scenario doesn't hang.</p>\n\n<p>Literally there is no error message from chrome or selenium or chrome driver.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "selenium", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 1, "creation_date": 1565962892, "post_id": 57487802, "comment_id": 101517816, "body": "I don&#39;t think you&#39;ll have a lot of luck doing this with Watir or Selenium as they aren&#39;t built for this. They allow injecting scripts afterwards, but they don&#39;t provide much control over the initial loading. The best I can think of is to create a proxy that manipulates the response before it gets back to the browser."}, {"owner": {"reputation": 2773, "user_id": 2505904, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dfbdb599d48dd7b6dba638bf0549599a?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/2505904/matrix"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1565997829, "post_id": 57487802, "comment_id": 101530018, "body": "@JustinKo Good idea but you know a method to make a proxy like this? I have no idea how can that be functioned ... :s"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1566178562, "post_id": 57487802, "comment_id": 101561954, "body": "You could try the Ruby gem Webrick. I&#39;ve heard to people using it before, but unfortunately, cannot say I&#39;ve done it myself."}], "owner": {"reputation": 2773, "user_id": 2505904, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dfbdb599d48dd7b6dba638bf0549599a?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/2505904/matrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565768581, "creation_date": 1565753182, "question_id": 57487802, "link": "https://stackoverflow.com/questions/57487802/watir-equivalent-to-evaluateonnewdocument", "title": "watir equivalent to &quot;evaluateOnNewDocument&quot;", "body": "<p>How can we execute custom javascript before execution of javascript on page where we <code>.goto</code>  like <code>evaluateOnNewDocument</code> in Puppeteer ?</p>\n\n<p>Another way can be : inject  (or file) to execute it before native script of page, but I don't know how to do this with Watir (&amp; Ruby on Rails 5) ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "one-to-many", "form-for"], "comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 1, "creation_date": 1565747562, "post_id": 57487201, "comment_id": 101445281, "body": "In your controller, add <code>@last_3_sigs = Sigs.last(3)</code> and use where needed. Your view is actually going through each oferta before requesting 3 last sigs (of each)"}, {"owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1565748571, "post_id": 57487201, "comment_id": 101445445, "body": "Thanks for your answer. where to write in the form?"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1565748784, "post_id": 57487201, "comment_id": 101445487, "body": "I don&#39;t see any form in your index.erb"}, {"owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1565748924, "post_id": 57487201, "comment_id": 101445515, "body": "Here how I used it  &lt;% for item in o.sigs.order(&quot;created_at asc&quot;).last(3).each %&gt;"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 1, "creation_date": 1565749110, "post_id": 57487201, "comment_id": 101445546, "body": "If you just want to show these three sigs, scrap the three first lines and 2 of the 3 last <code>&lt;% end %&gt;</code> and add first line <code>&lt;% @last_3_sigs.each do |item| %&gt;</code>"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 1, "creation_date": 1565755743, "post_id": 57487201, "comment_id": 101446645, "body": "write this code in your controller action <code>@sighs = Sig.joins(:ofertum).limit(3).order(created_at: :desc)</code>"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565756617, "post_id": 57487201, "comment_id": 101446786, "body": "with my comment answer?"}, {"owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "edited": false, "score": 0, "creation_date": 1565756804, "post_id": 57487201, "comment_id": 101446824, "body": "Both of them work"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565756908, "post_id": 57487201, "comment_id": 101446843, "body": "@nour Okay, i thought i will put it in answer and you will upvote and accept it :D"}, {"owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "edited": false, "score": 0, "creation_date": 1565756930, "post_id": 57487201, "comment_id": 101446847, "body": "You can add it as answer so I can give you credit"}, {"owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "edited": false, "score": 0, "creation_date": 1565757020, "post_id": 57487201, "comment_id": 101446868, "body": "I have different question do you think you can answer it? <a href=\"https://stackoverflow.com/questions/57460334/displaynone-change-the-width/57460856#57460856\" title=\"displaynone change the width\">stackoverflow.com/questions/57460334/&hellip;</a>"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1565761130, "post_id": 57487201, "comment_id": 101447804, "body": "Commented over there, try to mention me in comment so i can get notification"}], "answers": [{"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": true, "score": 3, "last_activity_date": 1565760914, "creation_date": 1565760914, "answer_id": 57488653, "question_id": 57487201, "link": "https://stackoverflow.com/questions/57487201/one-to-many-relationship-fom-for-take-the-last-3-from-all-the-model-attributes/57488653#57488653", "title": "One to many relationship fom_for take the last 3 from all the model attributes", "body": "<p>You can do it in both ways,</p>\n\n<pre><code>@last_3_sigs = Sigs.last(3)\n</code></pre>\n\n<p>for getting latest records first use this</p>\n\n<pre><code>@last_3_sigs = Sig.order(created_at: :desc).limit(3)\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 57488653, "answer_count": 1, "score": 0, "last_activity_date": 1565768901, "creation_date": 1565747161, "last_edit_date": 1565768901, "question_id": 57487201, "link": "https://stackoverflow.com/questions/57487201/one-to-many-relationship-fom-for-take-the-last-3-from-all-the-model-attributes", "title": "One to many relationship fom_for take the last 3 from all the model attributes", "body": "<p>I have one to many relationship(oferta have many sigs) and I want to show the last three sigs from all the oferta</p>\n\n<p>I tried this code but it show the last 3 sigs from each oferta</p>\n\n<p>In home index.erb</p>\n\n<pre><code>&lt;% @oferta.each do |o| %&gt;\n  &lt;% if o.sigs.exists? %&gt;\n    &lt;% for item in o.sigs.order(\"created_at asc\").last(3).each %&gt;\n      &lt;div class=\"col-md-4 col-sm-4\"&gt;\n        &lt;div class=\"coll\"&gt;\n          &lt;br&gt;\n          &lt;%= link_to item do %&gt;\n            &lt;%= image_tag item.image.url(), skip_pipeline: true ,id: \"img\",height: \"200px\"%&gt;\n          &lt;% end %&gt;\n          &lt;h4&gt;&lt;%=link_to item.name,item %&gt;&lt;/h4&gt;\n          &lt;p id=\"comment\"&gt;&lt;%= item.comment %&gt;&lt;/p&gt;\n          &lt;%= link_to \"read more..\", item %&gt; \n          &lt;p id=\"price\"&gt;&lt;%= item.price %&gt;&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In the controller</p>\n\n<pre><code>def index\n  @oferta = Ofertum.unscoped.first(3)\nend\n</code></pre>\n\n<p>In ofertum model</p>\n\n<pre><code>has_many :sigs\n</code></pre>\n\n<p>In sig model</p>\n\n<pre><code>belongs_to :ofertum\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-ec2", "capistrano", "circleci"], "answers": [{"comments": [{"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1565803902, "post_id": 57487951, "comment_id": 101468420, "body": "following up on this, I have the keys setup but I think it is getting blocked at the IP firewall <a href=\"https://snag.gy/X03dUC.jpg\" rel=\"nofollow noreferrer\">snag.gy/X03dUC.jpg</a> - thoughts on this?"}], "tags": [], "owner": {"reputation": 1950, "user_id": 339614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b87153d4e4878925e362546c4f55b92?s=128&d=identicon&r=PG", "display_name": "prater", "link": "https://stackoverflow.com/users/339614/prater"}, "is_accepted": true, "score": 0, "last_activity_date": 1565806825, "last_edit_date": 1565806825, "creation_date": 1565754815, "answer_id": 57487951, "question_id": 57486869, "link": "https://stackoverflow.com/questions/57486869/aws-inbound-ip-ssh-ranges-to-allow-capistrano-deploy-via-circle-ci/57487951#57487951", "title": "AWS Inbound IP SSH Ranges to allow Capistrano deploy via Circle CI", "body": "<p>I think the better approach is probably to give CircleCI it's own private key, and add that public key to the authorized keys on the server, then you can just leave port 22 open for SSH (or really any port, and just have SSH listen on that port)</p>\n\n<p>AFAIK - a 2048 byte RSA key is still effectively invincible to cracking, so as long as your private key doesn't fall into the wrong hands, it's fine.  If you're really concerned about it, you can give the deploy user limited permissions so that all they're really able to do is deploy.</p>\n\n<p>In AWS your inbound security groups should allow traffic from <code>0.0.0.0</code> on port 22, which will allow SSH connections from arbitrary IP addresses.</p>\n"}], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 57487951, "answer_count": 1, "score": 1, "last_activity_date": 1565806825, "creation_date": 1565743373, "question_id": 57486869, "link": "https://stackoverflow.com/questions/57486869/aws-inbound-ip-ssh-ranges-to-allow-capistrano-deploy-via-circle-ci", "title": "AWS Inbound IP SSH Ranges to allow Capistrano deploy via Circle CI", "body": "<p>When deploying to AWS EC2 what are the ranges you setup for the inbound approved IPs for ssh? I am trying to capistrano deploy from Circle CI after a successful github PR merge.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 1, "last_activity_date": 1565751274, "creation_date": 1565751274, "answer_id": 57487614, "question_id": 57486800, "link": "https://stackoverflow.com/questions/57486800/how-to-create-mock-for-hash-in-rspec/57487614#57487614", "title": "How to create mock for hash in Rspec", "body": "<p>The issue is that <code>let</code> doesn't create <em>instance variables</em>.</p>\n\n<p>your <code>let</code> lines create <em>methods</em> named <code>rank</code> and <code>rank_id</code> that are available in your tests:</p>\n\n<pre><code>RSpec.describe \"let behavior\" do\n  let(:rank){{ 1 =&gt; 'S', 2 =&gt; 'A', 3 =&gt; 'B' }}\n  let(:rank_id){2}\n\n  it \"defines a method not an instance variable\" do\n    expect(@rank).to be_nil\n    expect(rank).to be_a Hash\n  end\nend\n</code></pre>\n\n<p>So in other words, don't use <code>@rank</code> or <code>@rank_id</code> in your tests unless you define them. Use <code>rank</code> and <code>rank_id</code> instead</p>\n\n<p>Instance variables in Ruby are nil if they are not declared. That's why it doesn't raise an error to call <code>@rank</code>, even though it's actually undefined.</p>\n"}], "owner": {"reputation": 1, "user_id": 11924833, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-waCbP90Mv5U/AAAAAAAAAAI/AAAAAAAASbU/Ruuo09Rf6QM/photo.jpg?sz=128", "display_name": "kodai", "link": "https://stackoverflow.com/users/11924833/kodai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565751274, "creation_date": 1565742560, "question_id": 57486800, "link": "https://stackoverflow.com/questions/57486800/how-to-create-mock-for-hash-in-rspec", "title": "How to create mock for hash in Rspec", "body": "<p>I'm Japanese.Excuse me in ugly English.</p>\n\n<p>I want to create hash mock.</p>\n\n<p>so, I try this code,</p>\n\n<p>but error occured</p>\n\n<pre><code>To allow expectations on `nil` and suppress this message, set `RSpec::Mocks.configuration.allow_message_expectations_on_nil` to `true`. To disallow expectations on `nil`, set `RSpec::Mocks.configuration.allow_message_expectations_on_nil` to `false`. \n</code></pre>\n\n<p>Is there any other way of writing?\nPlease teach me.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>AppointmentRank.new(\n            id: appointment.id,\n            name: @rank[appointment.rank_id]\n          )\n</code></pre>\n\n<p><code>@rank</code> is hash.</p>\n\n<p>rspec</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>let(:rank){{ 1 =&gt; 'S', 2 =&gt; 'A', 3 =&gt; 'B' }}\nlet(:rank_id){2}\n\nallow(@rank).to receive(:[]).with(rank_id).and_return('A')\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake-task"], "answers": [{"comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1565776746, "post_id": 57486557, "comment_id": 101454609, "body": "<code>task send_monthly_reports: :environment do</code> is the modern ruby style"}], "tags": [], "owner": {"reputation": 147, "user_id": 3624321, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1390780727/picture?type=large", "display_name": "Alvaro Alday", "link": "https://stackoverflow.com/users/3624321/alvaro-alday"}, "is_accepted": true, "score": 0, "last_activity_date": 1565797145, "last_edit_date": 1565797145, "creation_date": 1565739957, "answer_id": 57486557, "question_id": 57486338, "link": "https://stackoverflow.com/questions/57486338/rails-5-why-am-i-getting-undefined-constant-when-calling-a-class-in-a-rake-task/57486557#57486557", "title": "Rails 5, Why am I getting undefined constant when calling a class in a rake task?", "body": "<p>Turns out I wasn't loading My app's environment when running my rake task:</p>\n\n<p>Here's the fix:</p>\n\n<pre><code>namespace :reports do\n  desc \"Send monthly reports to elite organizations\"\n  task send_monthly_reports: :environment do \n    ReportHandler.queue_reports\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 3624321, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1390780727/picture?type=large", "display_name": "Alvaro Alday", "link": "https://stackoverflow.com/users/3624321/alvaro-alday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 57486557, "answer_count": 1, "score": -2, "last_activity_date": 1565797145, "creation_date": 1565737782, "question_id": 57486338, "link": "https://stackoverflow.com/questions/57486338/rails-5-why-am-i-getting-undefined-constant-when-calling-a-class-in-a-rake-task", "title": "Rails 5, Why am I getting undefined constant when calling a class in a rake task?", "body": "<p>I'm using Ruby on Rails 5.1.4, to make a little reporting system. </p>\n\n<p>I'm using a Handler class like the following:</p>\n\n<pre><code># app/handlers/report_handler.rb\nclass ReportHandler \n  ROLES = %w[admin staff]\n\n  def self.queue_reports\n    tennants = Tennant.elite\n\n    tennants.each do |tennant|\n      users = tennant.users.where(role: ROLES)\n      users.each { |user| ReportMailer.monthly_report(user).deliver_later }\n    end\n  end\nend\n</code></pre>\n\n<p>When using RSpec to test the class all my tests run green. but when I run my rake task it displays this error:</p>\n\n<pre><code>*** NameError Exception: uninitialized constant ReportHandler::Tennant\n</code></pre>\n\n<p>This is what my rake task looks like:</p>\n\n<pre><code># lib/tasks/reports.rake\nrequire './app/handlers/report_handler'\n\nnamespace :reports do\n  # rake reports:send_monthly_reports\n  desc \"Send monthly reports to elite tennants\"\n  task :send_monthly_reports do\n    ReportHandler.queue_reports\n  end\nend\n</code></pre>\n\n<p>I have no clue why my reports work when I call it from the my specs &amp; console, but not from my rake task.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth", "shopify", "pundit"], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "edited": false, "score": 0, "creation_date": 1565800885, "post_id": 57498139, "comment_id": 101467254, "body": "i can refactor the logic and put it there, i&#39;m just trying to get the handshake to work first before i bother with clean code. my routes are probably wrong. i have that route defined, but it&#39;s not doing what i want it to do. how do you send a post to a third party using <code>button_to</code> ?"}, {"owner": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "edited": false, "score": 0, "creation_date": 1565800991, "post_id": 57498139, "comment_id": 101467288, "body": "<code>shopify_auth_url</code> is what rails told me i might be wanting the <code>button_to</code> to route to, but it makes a post onto the actual app itself and not shopify. i don&#39;t know how to make rails send a post outside of the app"}, {"owner": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "edited": false, "score": 0, "creation_date": 1565801092, "post_id": 57498139, "comment_id": 101467316, "body": "what&#39;s the rails equivalent to the javascript fetch?"}, {"owner": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "edited": false, "score": 0, "creation_date": 1565801173, "post_id": 57498139, "comment_id": 101467353, "body": "also, how do you have a session persist across actions?"}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "edited": false, "score": 0, "creation_date": 1565813189, "post_id": 57498139, "comment_id": 101471961, "body": "Check out this on how rails routing works - <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html</a> - you&#39;ll need to have a route defined in your routes.rb that you can then use on the button. It could also be an href and doesn&#39;t have to be a button."}], "tags": [], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1565797977, "creation_date": 1565797977, "answer_id": 57498139, "question_id": 57486150, "link": "https://stackoverflow.com/questions/57486150/oauth-install-how-to-create-a-session-that-persists-across-requests/57498139#57498139", "title": "OAuth install - how to create a session that persists across requests?", "body": "<p>I think the problem is that you might want this Shopify auth logic in your ApplicationController so that it can be shared across all controllers.</p>\n\n<p>Also, not sure what you're doing with <code>shopify_auth_url</code>. Have you defined that route?</p>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "is_accepted": false, "score": 0, "last_activity_date": 1568213097, "last_edit_date": 1568213097, "creation_date": 1568211589, "answer_id": 57891236, "question_id": 57486150, "link": "https://stackoverflow.com/questions/57486150/oauth-install-how-to-create-a-session-that-persists-across-requests/57891236#57891236", "title": "OAuth install - how to create a session that persists across requests?", "body": "<p>If anybody is struggling with implementing OAuth in Shopify, or attempting to work with outbound HTTP requests in Rails and happen to read this...</p>\n\n<p>My lack of Rails knowledge was causing the problem. Turns out that I've been stuck on this for a month and a half, and it's been working the entire time. I was looking in my server logs and the network requests via my browser dev tools, expecting to find my app POST to Shopify. However, that POST is an outbound HTTP request and Rails only logs inbound requests. Additionally, the client's browser doesn't process that request, because the request is in the background, server-to-server (correct me if I'm wrong?).</p>\n\n<p>I realized this by adding <code>puts token</code> after <code>token = @shopify_session.request_token(request.params)</code>, and discovered that I've been receiving the token this entire time. I should've done that at the very beginning -- a careless mishap and painful lesson learned. I used a gem called http_logger, which logs any outbound HTTP requests. If anybody knows a better way to access the outbound HTTP requests within a Rails controller (or anywhere), please let me know! Thanks.</p>\n\n<p>ps, here is more succinct version of my question: <a href=\"https://github.com/Shopify/shopify_api/issues/619\" rel=\"nofollow noreferrer\">https://github.com/Shopify/shopify_api/issues/619</a></p>\n"}], "owner": {"reputation": 385, "user_id": 9645918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c79ed71421451ef6c9dc3f70de1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "greenie-beans", "link": "https://stackoverflow.com/users/9645918/greenie-beans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1568213097, "creation_date": 1565736092, "last_edit_date": 1565742112, "question_id": 57486150, "link": "https://stackoverflow.com/questions/57486150/oauth-install-how-to-create-a-session-that-persists-across-requests", "title": "OAuth install - how to create a session that persists across requests?", "body": "<p>I'm trying to implement the OAuth protocol so I can access the Shopify API as a third party API service in my Rails 6 app. </p>\n\n<p>I'm able to get 3/4ths of the way through the OAuth process, but I can't seem to make the POST request to send from my Rails app to Shopify. I'm new to Rails and backend development, so there could be a number of issues happening.</p>\n\n<p>Right now, the code uses the <code>shopify_api</code> gem to do it all. I'm not sure how to instantiate the session so that it's referencing the same session across actions. I have a <code>before_action</code>, which gets called each time that controller is used, regardless of action. So whenever it's a new action, it creates a new session (I think that's what is happening - I'm not sure if I'm using the correct language to describe this). I don't know where to define the <code>shopify_session</code> variable so that it's valid across each action. Here is the code:</p>\n\n<pre><code>class ShopifyController &lt; ApplicationController\n  before_action :shopify_session\n\n  def install\n    scope = [\"write_orders,read_customers\"]\n\n    permission_url = @shopify_session.create_permission_url(scope, \"https://#{APP_URL}/shopify/auth\")\n\n    redirect_to permission_url\n  end\n\n  def auth\n    token = @shopify_session.request_token(request.params)\n  end\n\nprivate\n  def shopify_session\n    ShopifyAPI::Session.setup(api_key: API_KEY, secret: API_SECRET)\n\n    shop = request.params['shop']\n\n    @shopify_session = ShopifyAPI::Session.new(domain: \"#{shop}\", api_version: \"2019-07\", token: nil)\n  end\nend\n</code></pre>\n\n<p>The code above returns:</p>\n\n<pre><code>ShopifyAPI::ValidationException in ShopifyController#auth\nInvalid Signature: Possible malicious login\n</code></pre>\n\n<p>My ngrok log says:</p>\n\n<pre><code>POST /shopify/auth             500 Internal Server Error                        \nGET  /shopify/auth             200 OK                                           \nGET  /shopify/install          302 Found\n</code></pre>\n\n<p>There might also be a CORS error. Browser header inspection says:\n<code>Referrer Policy: strict-origin-when-cross-origin</code></p>\n\n<p>Additionally, it seems that it might be POSTing to itself, instead of sending the request to Shopify. I think that's because in my view, I have the following code:</p>\n\n<pre><code>&lt;%= button_to 'Confirm Account', shopify_auth_url %&gt;\n</code></pre>\n\n<p>I don't know how to trigger the POST request to send to Shopify...again, I'm new at Rails and backend -- I mostly know frontend.</p>\n"}, {"tags": ["javascript", "ruby", "web-scraping", "mechanize", "watir"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 11924554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L1Dh7cHAh_w/AAAAAAAAAAI/AAAAAAAABko/S4r_WMPyRcs/photo.jpg?sz=128", "display_name": "rcarette", "link": "https://stackoverflow.com/users/11924554/rcarette"}, "edited": false, "score": 0, "creation_date": 1565772476, "post_id": 57486487, "comment_id": 101452472, "body": "Thanks ! I work well. I just want to get sell &amp; buy numbers for each period to decide if it is a good opportunity to buy/sell it and estimates how many times to keep the stock."}], "tags": [], "owner": {"reputation": 501, "user_id": 3533906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d9c055b52b568e9021c6623e6d9b87b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3533906/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1565739092, "creation_date": 1565739092, "answer_id": 57486487, "question_id": 57486127, "link": "https://stackoverflow.com/questions/57486127/how-to-scrape-the-website-investing-to-get-every-technical-analysis-for-a-stock/57486487#57486487", "title": "How to scrape the website investing to get every technical analysis for a stock", "body": "<p>I don't think it's exactly what you're looking for, but it may get you a little closer.</p>\n\n<p>Using an HTTP sniffer, found that the link you're trying to click makes a POST.  The response of that POST can be obtained with:</p>\n\n<pre><code>def mechanize_poster(url)\n  agent = Mechanize.new\n  headers = {\n    'X-Requested-With' =&gt; 'XMLHttpRequest',\n    'User-Agent' =&gt; 'Mac Safari',\n    'Content-Type' =&gt; 'application/x-www-form-urlencoded',\n    'Referer' =&gt; 'https://www.investing.com/equities/credit-agricole-technical'\n  }\n  fields = {\n    period: 'week',\n    viewType: 'normal',\n    pairID: '407'\n  }\n  page = agent.post(url, fields, headers)\n  p page\nend\n</code></pre>\n\n<p>I think you'll need to use some Nokogiri to get at the data values.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1565768428, "last_edit_date": 1565768428, "creation_date": 1565768063, "answer_id": 57490089, "question_id": 57486127, "link": "https://stackoverflow.com/questions/57486127/how-to-scrape-the-website-investing-to-get-every-technical-analysis-for-a-stock/57490089#57490089", "title": "How to scrape the website investing to get every technical analysis for a stock", "body": "<p>You can do this just with requests and bs4 using POST. Same idea as in other answer I see but use a loop to provide for all values requested. I simply used dev tools to monitor web traffic when clicking 5hr, Daily etc then observed the xhr calls.</p>\n\n<pre><code>import requests\nfrom bs4 import BeautifulSoup as bs\n\nheaders = { 'User-Agent': 'Mozilla/5.0',\n            'Content-Type': 'application/x-www-form-urlencoded',\n            'Referer': 'https://www.investing.com/equities/credit-agricole-technical',\n            'X-Requested-With': 'XMLHttpRequest'}\n\nbody = {'pairID' : 407, 'period': '', 'viewType' : 'normal'}\nperiods = {'5hr': 18000, 'Daily': 86400, 'Weekly': 'week'}\n\nwith requests.Session() as s:\n    for k, v in periods.items():\n        body['period'] = v\n        r = s.post('https://www.investing.com/instruments/Service/GetTechincalData', data = body, headers = headers)\n        soup = bs(r.content, 'lxml')\n        for i in soup.select('#techStudiesInnerWrap .summaryTableLine'):\n            print(k, ' : ' , ' '.join([j.text for j in i.select('span')]))\n</code></pre>\n\n<hr>\n\n<p><strong>Output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/yXzvm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yXzvm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "is_accepted": false, "score": 0, "last_activity_date": 1565838356, "creation_date": 1565838356, "answer_id": 57504411, "question_id": 57486127, "link": "https://stackoverflow.com/questions/57486127/how-to-scrape-the-website-investing-to-get-every-technical-analysis-for-a-stock/57504411#57504411", "title": "How to scrape the website investing to get every technical analysis for a stock", "body": "<p>The error you are seeing in Watir is coming from webdriver and indicates that if a human tried to click that link, some other element on the page would get clicked instead (because that other element overlaps the link.</p>\n\n<p>Likely the default browser size is small and you are dealing with a 'reactive' design that doesn't scale down well below a given size (common issue)</p>\n\n<p>Try setting the screen size first, to be similar to what you would be using (e.g. 1024x768 or larger) <code>@browser.window.resize_to(1920, 1080)</code></p>\n"}], "owner": {"reputation": 71, "user_id": 11924554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L1Dh7cHAh_w/AAAAAAAAAAI/AAAAAAAABko/S4r_WMPyRcs/photo.jpg?sz=128", "display_name": "rcarette", "link": "https://stackoverflow.com/users/11924554/rcarette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1603, "favorite_count": 0, "accepted_answer_id": 57486487, "answer_count": 3, "score": 0, "last_activity_date": 1590839686, "creation_date": 1565735915, "last_edit_date": 1565775053, "question_id": 57486127, "link": "https://stackoverflow.com/questions/57486127/how-to-scrape-the-website-investing-to-get-every-technical-analysis-for-a-stock", "title": "How to scrape the website investing to get every technical analysis for a stock", "body": "<p>I am trying to scrape the website <a href=\"https://investing.com/\" rel=\"nofollow noreferrer\">https://investing.com/</a> to get technical data for any stocks. I would like to get for \"Moving Averages:\" &amp; \"Technical Indicators:\" how many buys and how many sells with different periods :</p>\n\n<ul>\n<li>5 hours</li>\n<li>Daily</li>\n<li>Weekly</li>\n</ul>\n\n<p>Here is an image to see data I want to get : \n<a href=\"https://i.ibb.co/mHpM0Yw/Capture-d-e-cran-2019-08-14-a-00-15-45.png\" rel=\"nofollow noreferrer\">https://i.ibb.co/mHpM0Yw/Capture-d-e-cran-2019-08-14-a-00-15-45.png</a></p>\n\n<p>the url is <a href=\"https://investing.com/equities/credit-agricole-technical\" rel=\"nofollow noreferrer\">https://investing.com/equities/credit-agricole-technical</a></p>\n\n<p>When you navigate to the browser, the period is set to \"hourly\" and you have to click an another period to get the correct data. The DOM is update after an XML request. </p>\n\n<p>I would like to scrape the page after DOM updated. </p>\n\n<h2>Mechanize</h2>\n\n<p>I have try to scrap with Mechanize and click on \"weekly\" and get the DOM to scrape it but i got an error </p>\n\n<p>here is my code :</p>\n\n<pre><code>    def mechanize_scraper(url)\n      agent = Mechanize.new\n      puts agent.user_agent_alias = 'Mac Safari'\n      page = agent.get(url)\n      link = page.link_with(text: 'Weekly')\n      new_page = link.click\n    end\n\n\n    url = \"https://investing.com/equities/credit-agricole-technical\"\n    mechanize_scraper(url)\n</code></pre>\n\n<p>here is the error : </p>\n\n<blockquote>\n  <p>Mechanize::UnsupportedSchemeError (Mechanize::UnsupportedSchemeError)</p>\n</blockquote>\n\n<p>When we inspect the DOM, the  link has an its attributes \"href\" = javascript(void); </p>\n\n<pre><code>    &lt;li pairid=\"407\" data-period=\"week\" class=\"\"&gt;\n      &lt;a href=\"javascript:void(0);\"&gt;Weekly&lt;/a&gt;\n    &lt;/li&gt;\n</code></pre>\n\n<p>So after some tries and lots of google search, I move on \"Watir\" to try to scrape. </p>\n\n<h2>Watir</h2>\n\n<p>here is my code : </p>\n\n<pre><code>    def watir_scraper(url)\n      Watir.default_timeout = 10\n      browser = Watir::Browser.new\n      browser.goto(url)       \n      link = browser.link(text: /weekly/).click\n      pp link\n    end\n\n    url = \"https://investing.com/equities/credit-agricole-technical\"\n    watir_scraper(url)\n</code></pre>\n\n<p>here is the error : </p>\n\n<blockquote>\n  <p>40: from app.rb:47:in `'</p>\n  \n  <p>39: from app.rb:32:in `watir_scraper'</p>\n  \n  <p>38: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/watir-6.16.5/lib/watir/elements/element.rb:145:in `click'</p>\n  \n  <p>37: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/watir-6.16.5/lib/watir/elements/element.rb:789:in `element_call'</p>\n  \n  <p>36: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/watir-6.16.5/lib/watir/elements/element.rb:154:in `block in click'</p>\n  \n  <p>35: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/common/element.rb:74:in `click'</p>\n  \n  <p>34: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/w3c/bridge.rb:371:in `click_element'</p>\n  \n  <p>33: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/w3c/bridge.rb:567:in `execute'</p>\n  \n  <p>32: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/bridge.rb:167:in `execute'</p>\n  \n  <p>31: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/http/common.rb:64:in `call'</p>\n  \n  <p>30: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/http/default.rb:114:in `request'</p>\n  \n  <p>29: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/http/common.rb:88:in `create_response'</p>\n  \n  <p>28: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/http/common.rb:88:in `new'</p>\n  \n  <p>27: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/response.rb:34:in `initialize'</p>\n  \n  <p>26: from /Users/remicarette/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/selenium-webdriver-3.142.3/lib/selenium/webdriver/remote/response.rb:72:in `assert_ok'</p>\n  \n  <p>25: from 25  libsystem_pthread.dylib             0x00007fff5aaa440d thread_start + 13</p>\n  \n  <p>24: from 24  libsystem_pthread.dylib             0x00007fff5aaa8249 _pthread_start + 66</p>\n  \n  <p>23: from 23  libsystem_pthread.dylib             0x00007fff5aaa52eb _pthread_body + 126</p>\n  \n  <p>22: from 22  chromedriver                        0x000000010b434e67 chromedriver + 3673703</p>\n  \n  <p>21: from 21  chromedriver                        0x000000010b416014 chromedriver + 3547156</p>\n  \n  <p>20: from 20  chromedriver                        0x000000010b3e0f07 chromedriver + 3329799</p>\n  \n  <p>19: from 19  chromedriver                        0x000000010b3f91b8 chromedriver + 3428792</p>\n  \n  <p>18: from 18  chromedriver                        0x000000010b3cd069 chromedriver + 3248233</p>\n  \n  <p>17: from 17  chromedriver                        0x000000010b3f86d8 chromedriver + 3426008</p>\n  \n  <p>16: from 16  chromedriver                        0x000000010b3f8940 chromedriver + 3426624</p>\n  \n  <p>15: from 15  chromedriver                        0x000000010b3ecc1f chromedriver + 3378207</p>\n  \n  <p>14: from 14  chromedriver                        0x000000010b0ce8a5 chromedriver + 108709</p>\n  \n  <p>13: from 13  chromedriver                        0x000000010b0cd7e2 chromedriver + 104418</p>\n  \n  <p>12: from 12  chromedriver                        0x000000010b0f1bf3 chromedriver + 252915</p>\n  \n  <p>11: from 11  chromedriver                        0x000000010b0fba37 chromedriver + 293431</p>\n  \n  <p>10: from 10  chromedriver                        0x000000010b0f1c4e chromedriver + 253006</p>\n  \n  <p>9: from 9   chromedriver                        0x000000010b0cfa66 chromedriver + 113254</p>\n  \n  <p>8: from 8   chromedriver                        0x000000010b0f1a72 chromedriver + 252530</p>\n  \n  <p>7: from 7   chromedriver                        0x000000010b0cfe66 chromedriver + 114278</p>\n  \n  <p>6: from 6   chromedriver                        0x000000010b0d63fb chromedriver + 140283</p>\n  \n  <p>5: from 5   chromedriver                        0x000000010b0d71a9 chromedriver + 143785</p>\n  \n  <p>4: from 4   chromedriver                        0x000000010b0d8d19 chromedriver + 150809</p>\n  \n  <p>3: from 3   chromedriver                        0x000000010b0da569 chromedriver + 157033</p>\n  \n  <p>2: from 2   chromedriver                        0x000000010b15fcef chromedriver + 703727</p>\n  \n  <p>1: from 1   chromedriver                        0x000000010b3bf133 chromedriver + 3191091\n  0x000000010b42f129 chromedriver + 3649833: element click intercepted: Element ... is not clickable at point (544, 704). Other element would receive the click: ... (Selenium::WebDriver::Error::ElementClickInterceptedError)\n    (Session info: chrome=76.0.3809.100)</p>\n</blockquote>\n\n<p>I hope everything can help you to understand my issue. I would like to know if I can scrape datas with Mechanize or Watir. If not, which tools can do the job ?</p>\n\n<p>Thanks a lot !</p>\n"}, {"tags": ["javascript", "regex", "ruby"], "comments": [{"owner": {"reputation": 6624, "user_id": 4896493, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/197888927236621/picture?type=large", "display_name": "Sergey Mell", "link": "https://stackoverflow.com/users/4896493/sergey-mell"}, "edited": false, "score": 1, "creation_date": 1565733843, "post_id": 57485798, "comment_id": 101442739, "body": "The regex seems to be valid for JavaScript either. Could you provide an example of which text is supposed to be valid, and which is not?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1565734020, "post_id": 57485798, "comment_id": 101442784, "body": "The <code>&#47;\\b[1-7]\\b&#47;</code> should do, because <code>\\b</code> is more generic than <code>,</code> and <code>^</code>/<code>$</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1565745657, "post_id": 57485798, "comment_id": 101444927, "body": "<code>\\b</code> covers all cases of <code>^</code> or <code>,</code>  behind and <code>$</code> or <code>,</code> ahead. So, use <code>&#47;\\b[1-7]\\b&#47;</code> However, it is equivalent  to this as well <code>(?:^|,|\\b)[1-7](?=$|,|\\b)</code> which is <i>verbose</i> and overstated in the form of <code>^$</code> and <code>,</code>"}, {"owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 1, "creation_date": 1565746889, "post_id": 57485798, "comment_id": 101445164, "body": "Positive lookbehind is not supported in Mozila and some other browsers too, so you need that to change to normal regex"}, {"owner": {"reputation": 1, "user_id": 11924557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ywbm7ASk-7Q/AAAAAAAAAAI/AAAAAAAAClo/diAkwtWIsek/photo.jpg?sz=128", "display_name": "Edgar Lugo", "link": "https://stackoverflow.com/users/11924557/edgar-lugo"}, "edited": false, "score": 0, "creation_date": 1565789322, "post_id": 57485798, "comment_id": 101461141, "body": "the text must be one o more digits separated by comma, ex: 1|1,2|1,2,3"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1566082359, "post_id": 57485798, "comment_id": 101545144, "body": "Ok, try <code>&#47;(?:^|,)[1-7](?:,|$)&#47;</code>, why use <code>\\b</code>? If you are checking against a string, why use lookarounds?"}, {"owner": {"reputation": 1, "user_id": 11924557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ywbm7ASk-7Q/AAAAAAAAAAI/AAAAAAAAClo/diAkwtWIsek/photo.jpg?sz=128", "display_name": "Edgar Lugo", "link": "https://stackoverflow.com/users/11924557/edgar-lugo"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1566333932, "post_id": 57485798, "comment_id": 101622036, "body": "@WiktorStribi\u017cew thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 481, "user_id": 8807682, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zhGg6arUEVo/AAAAAAAAAAI/AAAAAAAAAA0/fpq6TX1FQEI/photo.jpg?sz=128", "display_name": "YOGO", "link": "https://stackoverflow.com/users/8807682/yogo"}, "is_accepted": true, "score": 0, "last_activity_date": 1565780446, "creation_date": 1565780446, "answer_id": 57493403, "question_id": 57485798, "link": "https://stackoverflow.com/questions/57485798/how-to-translate-ruby-regex-to-javascript-regex/57493403#57493403", "title": "How to translate ruby regex to javascript regex?", "body": "<p>As @wiktor said you should use </p>\n\n<pre><code>\\b[1-7]\\b\n</code></pre>\n\n<p>As \\b only asserts positions, you don't need to worry about matching more than [1-7].</p>\n\n<p>@Code Maniac correctly stated that look behind is not supported in Mozilla and many others, so about it. <a href=\"https://caniuse.com/#search=regular\" rel=\"nofollow noreferrer\">see</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11924557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ywbm7ASk-7Q/AAAAAAAAAAI/AAAAAAAAClo/diAkwtWIsek/photo.jpg?sz=128", "display_name": "Edgar Lugo", "link": "https://stackoverflow.com/users/11924557/edgar-lugo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "closed_date": 1566335182, "accepted_answer_id": 57493403, "answer_count": 1, "score": -1, "last_activity_date": 1565800659, "creation_date": 1565733477, "last_edit_date": 1565800659, "question_id": 57485798, "link": "https://stackoverflow.com/questions/57485798/how-to-translate-ruby-regex-to-javascript-regex", "closed_reason": "Duplicate", "title": "How to translate ruby regex to javascript regex?", "body": "<p>Im using validates_format_of method to check a input text\nJavascript cant read this regex. How or where I can change this regex to be as original: </p>\n\n<pre><code>(?&lt;=^|,|\\b)[1-7](?=$|,|\\b)\n</code></pre>\n\n<p>Thanks</p>\n\n<p>UPDATE:\nthe input text must be one o more digits separated by comma, ex: 1|1,2|1,2,3</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "rails-activestorage"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 4, "creation_date": 1565733402, "post_id": 57485054, "comment_id": 101442632, "body": "you&#39;re expecting a passed param to be an object that has a path method which is why you&#39;re getting the error. <code>params</code> is a hash of objects \u2014 none of which should respond to <code>path</code>."}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1565737200, "post_id": 57485054, "comment_id": 101443479, "body": "You are definitely on to something. I updated my answer. I just added <code>puts &quot;params etc.</code> to look at the output and it is just blank on the third element."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1565903559, "post_id": 57485054, "comment_id": 101500478, "body": "This <code>params[image[:report_image]]</code> is difficult to understand, are you trying to access a key on params? wouldn&#39;t it be <code>params[:image][:report_image]</code>?"}, {"owner": {"reputation": 830, "user_id": 5136200, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gBAqD.jpg?s=128&g=1", "display_name": "Archer", "link": "https://stackoverflow.com/users/5136200/archer"}, "edited": false, "score": 1, "creation_date": 1565904573, "post_id": 57485054, "comment_id": 101500789, "body": "Could you also show the complete output from <code>params</code>?  It&#39;s also not easy to follow your log, when you can&#39;t see how the log was created."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 1, "creation_date": 1565905342, "post_id": 57485054, "comment_id": 101501042, "body": "For some files, ActionDispatch::Http::UploadedFile object could not be created. Application gives error because ActionDispatch::Http::UploadedFile does not exist. The problem seems to be in the file upload phase. Could it be because the file sizes are large?"}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "edited": false, "score": 1, "creation_date": 1565905707, "post_id": 57485054, "comment_id": 101501131, "body": "I don&#39;t have any validations for file size"}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "edited": false, "score": 0, "creation_date": 1565906153, "post_id": 57485054, "comment_id": 101501245, "body": "Maybe the real question is just how to get the path of the images. If I have the path of the image, then I can run this:  @message.image.attach(io: File.open(&#39;/path/to/file&#39;), filename: &#39;file.pdf&#39;, content_type: &#39;application/pdf&#39;)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1565938419, "post_id": 57485054, "comment_id": 101507382, "body": "Add your models and controller, all code involved to try to recreate this scenario."}, {"owner": {"reputation": 553, "user_id": 11814519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dBeFD9r200A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoJYCFLas6-rxLovGx-E3EF_3XQA/photo.jpg?sz=128", "display_name": "Mig", "link": "https://stackoverflow.com/users/11814519/mig"}, "edited": false, "score": 0, "creation_date": 1565944243, "post_id": 57485054, "comment_id": 101509465, "body": "It definitely seems to be on your form side. I assume that you have a multipart and that images are sent at the same time, and you use the filename as the &quot;name&quot; property. Pardon the question, but why don&#39;t you put files under an array input name like <code>report_images[]</code>? That way you get an array of temp files which includes their filenames and you don&#39;t have to reconcile these from 2 different places. At least you&#39;ll see if images are not uploaded because of size or anything. And if your XML carries more info, then fine but don&#39;t use it to process the file, only after to add info."}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "edited": false, "score": 0, "creation_date": 1565982774, "post_id": 57485054, "comment_id": 101525916, "body": "I&#39;m not saving them with a form. They are coming into the app from a POST method  and request format is XML. The images come in like the first code snippet with &quot;image_group&quot;=&gt;..."}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "edited": false, "score": 0, "creation_date": 1565983346, "post_id": 57485054, "comment_id": 101526115, "body": "I don&#39;t understand why it works for the first two or three images, but then stops and returns nil because an object couldn&#39;t be created for the third or fourth image"}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "edited": false, "score": 0, "creation_date": 1565985328, "post_id": 57485054, "comment_id": 101526854, "body": "It just started working. I just reviewed my code and made sure this line was right: a.attendance_page_images.attach(io: File.open(&quot;#{params[image[:attendance_page_image]].path}&quot;), filename: &quot;#{image[:attendance_page_image]}&quot;)"}, {"owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "reply_to_user": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 1, "creation_date": 1566072224, "post_id": 57485054, "comment_id": 101543271, "body": "@demir you were right it was the file size. you can answer the question about the file size with your comment. I will mark it correct."}], "answers": [{"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 1, "last_activity_date": 1566076660, "creation_date": 1566076660, "answer_id": 57539996, "question_id": 57485054, "link": "https://stackoverflow.com/questions/57485054/how-to-loop-through-an-array-of-images-and-save-each-with-active-storage/57539996#57539996", "title": "How to loop through an array of images and save each with Active Storage?", "body": "<p><code>ActionDispatch::Http::UploadedFile</code> object could not be created for some images. Application gives error because <code>ActionDispatch::Http::UploadedFile</code> does not exist. The problem seems to be in the file upload phase. Images with a large file size may cause this error.</p>\n"}], "owner": {"reputation": 592, "user_id": 3154739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d97daffaa6bbae78c66c7d431bf6dcf?s=128&d=identicon&r=PG&f=1", "display_name": "don_Bigote", "link": "https://stackoverflow.com/users/3154739/don-bigote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 57539996, "answer_count": 1, "score": 2, "last_activity_date": 1566076660, "creation_date": 1565728933, "last_edit_date": 1565985487, "question_id": 57485054, "link": "https://stackoverflow.com/questions/57485054/how-to-loop-through-an-array-of-images-and-save-each-with-active-storage", "title": "How to loop through an array of images and save each with Active Storage?", "body": "<p>Rails 5.2 app</p>\n\n<p>I am saving multiple images via a POST from a an XML object sent from a mobile app.</p>\n\n<p>The images look like this when they are received:</p>\n\n<pre><code>\"image_group\"=&gt;\n[\n  {\"report_image\"=&gt;\"1565721255925.jpg\"}, \n  {\"report_image\"=&gt;\"1565721267236.jpg\"}, \n  {\"report_image\"=&gt;\"1565721279636.jpg\"}, \n  {\"report_image\"=&gt;\"1565721292231.jpg\"}\n]\n</code></pre>\n\n<p>So, these images belong to a report. I am saving the report with the images in a controller that handles the POST.</p>\n\n<p>I am saving the images to report with the following block:</p>\n\n<pre><code>r = Report.new()\n\n  image_arr = record[:image_group]\n\n  image_arr.each do |image|\n    r.images.attach(io: File.open(\"#{params[image[:report_image]].path}\"), filename: \"#{image[:report_image]}\")\n  end\n\nr\n</code></pre>\n\n<p>This works when there are 1 or 2 images. However, when I do 3 or more the last report_image does not come with a path.</p>\n\n<p>Here is the error:</p>\n\n<pre><code>NoMethodError (undefined method `path' for nil:NilClass):\n</code></pre>\n\n<p>How do I resolve the issue and save ALL of the images?</p>\n\n<p>Here is the entire output from the rails server. *Some of the labels are changed in the following output. The important thing to see here is that the last image does not have a path.</p>\n\n<pre><code>financial_image_arr ======== [{\"financial_page_image\"=&gt;\"1565721255925.jpg\"}, {\"financial_page_image\"=&gt;\"1565721267236.jpg\"}, {\"financial_page_image\"=&gt;\"1565721279636.jpg\"}, {\"financial_page_image\"=&gt;\"1565721292231.jpg\"}]\nimage  ================ {\"financial_page_image\"=&gt;\"1565721255925.jpg\"}\npath  ================ /var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190813-79202-sfqs4i.jpg\n  Disk Storage (13.7ms) Uploaded file to key: 65GicEnFZ7868efthA3VaZHs (checksum: l+IKb1kWR786TDXTtZPShw==)\n   (0.7ms)  BEGIN\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\n  ActiveStorage::Blob Create (1.3ms)  INSERT INTO \"active_storage_blobs\" (\"key\", \"filename\", \"content_type\", \"metadata\", \"byte_size\", \"checksum\", \"created_at\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"  [[\"key\", \"65GicEnFZ7868efthA3VaZHs\"], [\"filename\", \"1565721255925.jpg\"], [\"content_type\", \"image/jpeg\"], [\"metadata\", \"{\\\"identified\\\":true}\"], [\"byte_size\", 2558086], [\"checksum\", \"l+IKb1kWR786TDXTtZPShw==\"], [\"created_at\", \"2019-08-13 20:37:55.864812\"]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\n   (43.7ms)  COMMIT\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\nimage  ================ {\"financial_page_image\"=&gt;\"1565721267236.jpg\"}\npath  ================ /var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190813-79202-1ulro7l.jpg\n  Disk Storage (15.3ms) Uploaded file to key: Dc8kVypDbmkKfC9wWiVKrQiP (checksum: ZdzLsDJlDRFcLtdUCTrOng==)\n   (0.9ms)  BEGIN\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\n  ActiveStorage::Blob Create (1.0ms)  INSERT INTO \"active_storage_blobs\" (\"key\", \"filename\", \"content_type\", \"metadata\", \"byte_size\", \"checksum\", \"created_at\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"  [[\"key\", \"Dc8kVypDbmkKfC9wWiVKrQiP\"], [\"filename\", \"1565721267236.jpg\"], [\"content_type\", \"image/jpeg\"], [\"metadata\", \"{\\\"identified\\\":true}\"], [\"byte_size\", 3038981], [\"checksum\", \"ZdzLsDJlDRFcLtdUCTrOng==\"], [\"created_at\", \"2019-08-13 20:37:55.949371\"]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\n   (41.7ms)  COMMIT\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\nimage  ================ {\"financial_page_image\"=&gt;\"1565721279636.jpg\"}\npath  ================ /var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190813-79202-19wtddw.jpg\n  Disk Storage (15.3ms) Uploaded file to key: SXdChJUgv6KP5AimKsi51m1y (checksum: k2vsaTsVXn+P/E7uUNj0wg==)\n   (0.7ms)  BEGIN\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\n  ActiveStorage::Blob Create (1.2ms)  INSERT INTO \"active_storage_blobs\" (\"key\", \"filename\", \"content_type\", \"metadata\", \"byte_size\", \"checksum\", \"created_at\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"  [[\"key\", \"SXdChJUgv6KP5AimKsi51m1y\"], [\"filename\", \"1565721279636.jpg\"], [\"content_type\", \"image/jpeg\"], [\"metadata\", \"{\\\"identified\\\":true}\"], [\"byte_size\", 2931139], [\"checksum\", \"k2vsaTsVXn+P/E7uUNj0wg==\"], [\"created_at\", \"2019-08-13 20:37:56.045458\"]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\n   (41.5ms)  COMMIT\n  \u21b3 app/controllers/skooter/odk_controller.rb:255\nimage  ================ {\"financial_page_image\"=&gt;\"1565721292231.jpg\"}\nCompleted 500 Internal Server Error in 518ms (ActiveRecord: 171.8ms)\n\n\n\nNoMethodError (undefined method `path' for nil:NilClass):\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here is the output when I add:</p>\n\n<p><code>puts \"params  ================ #{params[image[:financial_page_image]]}\"</code></p>\n\n<pre><code>financial_image_arr ======== [{\"financial_page_image\"=&gt;\"1565733645208.jpg\"}, {\"financial_page_image\"=&gt;\"1565733658237.jpg\"}, {\"financial_page_image\"=&gt;\"1565733673964.jpg\"}, {\"financial_page_image\"=&gt;\"1565733688371.jpg\"}]\nparams  ================ #&lt;ActionDispatch::Http::UploadedFile:0x00007ffca0f4b290&gt;\nimage  ================ {\"financial_page_image\"=&gt;\"1565733645208.jpg\"}\npath  ================ /var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190813-85337-ffz5sv.jpg\nparams  ================ #&lt;ActionDispatch::Http::UploadedFile:0x00007ffca0f4b218&gt;\nimage  ================ {\"financial_page_image\"=&gt;\"1565733658237.jpg\"}\npath  ================ /var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190813-85337-1fs8j1i.jpg\nparams  ================\nimage  ================ {\"financial_page_image\"=&gt;\"1565733673964.jpg\"}\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Here is the entire output.\n*Some of the labels have changed here, but everything else is the same and in the same order.</p>\n\n<pre><code>=======================XML Object=======================\n### XML Object: {\"has_assignment_card\"=&gt;\"no\", \"assignment_name\"=&gt;\"Pqpqpq\", \"set_assignment_id\"=&gt;\"1\", \"has_organization_card\"=&gt;\"no\", \"organization_name\"=&gt;\"Pqpqpq\", \"set_organization_id\"=&gt;\"1\", \"attendance_page_yes_no\"=&gt;\"yes\", \"attendance_page_group\"=&gt;[{\"attendance_page_image\"=&gt;\"1565900276910.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900288347.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900306471.jpg\"}], \"attendance_data_yes_no\"=&gt;\"no\", \"start\"=&gt;\"2019-08-15T14:17:28.668-06:00\", \"end\"=&gt;\"2019-08-15T14:18:32.940-06:00\", \"today\"=&gt;\"2019-08-15\", \"deviceid\"=&gt;\"353325097059590\", \"subscriberid\"=&gt;\"706010493091431\", \"simserial\"=&gt;\"8950301218077912618\", \"username\"=&gt;\"peru_collector@test.com\", \"phonenumber\"=&gt;nil, \"meta\"=&gt;{\"instanceID\"=&gt;\"uuid:e291337f-2da5-45e1-8990-c23a1f3adb5e\", \"instanceName\"=&gt;\"Activity:  2019-08-15\"}, \"id\"=&gt;\"activity\", \"xmlns:ev\"=&gt;\"http://www.w3.org/2001/xml-events\", \"xmlns:orx\"=&gt;\"http://openrosa.org/xforms\", \"xmlns:xsd\"=&gt;\"http://www.w3.org/2001/XMLSchema\", \"xmlns:odk\"=&gt;\"http://www.opendatakit.org/xforms\", \"xmlns:jr\"=&gt;\"http://openrosa.org/javarosa\", \"xmlns:h\"=&gt;\"http://www.w3.org/1999/xhtml\"}\n=======================XML Object=======================\n  User Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"email\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"email\", \"peru_collector@test.com\"], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:31\n  Program Load (0.7ms)  SELECT  \"programs\".* FROM \"programs\" WHERE \"programs\".\"id\" = $1 LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:31\nimage_arr ======== [{\"attendance_page_image\"=&gt;\"1565900276910.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900288347.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900306471.jpg\"}]\nputs \"params[image[:attendance_page_image]]  ================ #&lt;ActionDispatch::Http::UploadedFile:0x00007faa5bdd5560&gt;\nputs \"params[image[:attendance_page_image]]  ================ #&lt;ActionDispatch::Http::UploadedFile:0x00007faa5bdd44a8&gt;\nputs \"params[image[:attendance_page_image]]  ================\n  Rendering /Users/jefferson/.rbenv/versions/2.4.3/lib/ruby/gems/2.4.0/bundler/gems/skooter-5bc83089cbef/app/views/skooter/odk/submissions.xml.erb\n  Rendered /Users/jefferson/.rbenv/versions/2.4.3/lib/ruby/gems/2.4.0/bundler/gems/skooter-5bc83089cbef/app/views/skooter/odk/submissions.xml.erb (0.5ms)\nCompleted 200 OK in 211ms (Views: 33.7ms | ActiveRecord: 11.1ms)\n</code></pre>\n\n<p>So, you can see that the first two images come with params and let me upload using .path, but the last one does not have params. It is nil.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here is the output when I add .inspect to the params:</p>\n\n<pre><code>=======================XML Object=======================\n### XML Object: {\"has_assignment_card\"=&gt;\"no\", \"assignment_name\"=&gt;\"Pqpqpq\", \"set_assignment_id\"=&gt;\"1\", \"has_organization_card\"=&gt;\"no\", \"organization_name\"=&gt;\"Pqpqpq\", \"set_organization_id\"=&gt;\"1\", \"attendance_page_yes_no\"=&gt;\"yes\", \"attendance_page_group\"=&gt;[{\"attendance_page_image\"=&gt;\"1565900276910.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900288347.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900306471.jpg\"}], \"attendance_data_yes_no\"=&gt;\"no\", \"start\"=&gt;\"2019-08-15T14:17:28.668-06:00\", \"end\"=&gt;\"2019-08-15T14:18:32.940-06:00\", \"today\"=&gt;\"2019-08-15\", \"deviceid\"=&gt;\"353325097059590\", \"subscriberid\"=&gt;\"706010493091431\", \"simserial\"=&gt;\"8950301218077912618\", \"username\"=&gt;\"peru_collector@test.com\", \"phonenumber\"=&gt;nil, \"meta\"=&gt;{\"instanceID\"=&gt;\"uuid:e291337f-2da5-45e1-8990-c23a1f3adb5e\", \"instanceName\"=&gt;\"Activity:  2019-08-15\"}, \"id\"=&gt;\"activity\", \"xmlns:ev\"=&gt;\"http://www.w3.org/2001/xml-events\", \"xmlns:orx\"=&gt;\"http://openrosa.org/xforms\", \"xmlns:xsd\"=&gt;\"http://www.w3.org/2001/XMLSchema\", \"xmlns:odk\"=&gt;\"http://www.opendatakit.org/xforms\", \"xmlns:jr\"=&gt;\"http://openrosa.org/javarosa\", \"xmlns:h\"=&gt;\"http://www.w3.org/1999/xhtml\"}\n=======================XML Object=======================\n  User Load (3.5ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"email\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"email\", \"peru_collector@test.com\"], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:31\n  Program Load (2.0ms)  SELECT  \"programs\".* FROM \"programs\" WHERE \"programs\".\"id\" = $1 LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/skooter/odk_controller.rb:31\nimage_arr ======== [{\"attendance_page_image\"=&gt;\"1565900276910.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900288347.jpg\"}, {\"attendance_page_image\"=&gt;\"1565900306471.jpg\"}]\nparams[image[:attendance_page_image]] ================ #&lt;ActionDispatch::Http::UploadedFile:0x00007faa61f88d20 @tempfile=#&lt;Tempfile:/var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190815-11949-hqxxbg.jpg&gt;, @original_filename=\"1565900276910.jpg\", @content_type=\"image/jpeg\", @headers=\"Content-Disposition: form-data; name=\\\"1565900276910.jpg\\\"; filename=\\\"1565900276910.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\nContent-Length: 2768335\\r\\n\"&gt;\nparams[image[:attendance_page_image]] ================ #&lt;ActionDispatch::Http::UploadedFile:0x00007faa61f887a8 @tempfile=#&lt;Tempfile:/var/folders/zp/w8d7c5bs3glbprv_hs22m2k80000gn/T/RackMultipart20190815-11949-l9mkv.jpg&gt;, @original_filename=\"1565900288347.jpg\", @content_type=\"image/jpeg\", @headers=\"Content-Disposition: form-data; name=\\\"1565900288347.jpg\\\"; filename=\\\"1565900288347.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\nContent-Length: 3848689\\r\\n\"&gt;\nparams[image[:attendance_page_image]] ================ nil\n  Rendering /Users/jefferson/.rbenv/versions/2.4.3/lib/ruby/gems/2.4.0/bundler/gems/skooter-5bc83089cbef/app/views/skooter/odk/submissions.xml.erb\n  Rendered /Users/jefferson/.rbenv/versions/2.4.3/lib/ruby/gems/2.4.0/bundler/gems/skooter-5bc83089cbef/app/views/skooter/odk/submissions.xml.erb (0.4ms)\nCompleted 200 OK in 277ms (Views: 40.2ms | ActiveRecord: 19.4ms)\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>I just reviewed my code and it started working. Here is the block that is working saving all of the images:\nI am open to suggestions to improve this.</p>\n\n<pre><code>if record[:attendance_page_yes_no].eql?('yes')\n  image_arr = record[:attendance_page_group]\n  if image_arr.length &gt; 1\n    puts \"image_arr ======== #{image_arr}\"\n    image_arr.each do |image|\n\n      #puts \"path ================ #{params[image[:attendance_page_image]].inspect}\"\n      #puts \"name ================ #{image[:attendance_page_image]}\"\n\n      a.attendance_page_images.attach(io: File.open(\"#{params[image[:attendance_page_image]].path}\"), filename: \"#{image[:attendance_page_image]}\")\n\n    end if !image_arr.empty?\n  else \n    a.attendance_page_images.attach(io: File.open(\"#{params[record[:attendance_page_group][:attendance_page_image]].path}\"), filename: \"#{record[:attendance_page_group][:attendance_page_image]}\")\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-2.0", "ruby-2.2", "ruby-2.3.1"], "comments": [{"owner": {"reputation": 798, "user_id": 2699253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/954236abb0d238d574bb1ca452406eb6?s=128&d=identicon&r=PG&f=1", "display_name": "cyborg", "link": "https://stackoverflow.com/users/2699253/cyborg"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565758816, "post_id": 57484210, "comment_id": 101447237, "body": "ok Sure for letting me know, my intention was to reach wider audience"}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565730829, "post_id": 57484486, "comment_id": 101441853, "body": "a benchmark test on both ways (minus the puts) with a 3k line random text file, without regex way is about 4x faster."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565734296, "post_id": 57484486, "comment_id": 101442842, "body": "yeah not sure. I tried on a 3 versions of ruby and it&#39;s still between 3 to 4 times faster."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1565726591, "last_edit_date": 1565726591, "creation_date": 1565726009, "answer_id": 57484486, "question_id": 57484210, "link": "https://stackoverflow.com/questions/57484210/selection-of-line-based-on-the-pattern-using-ruby-2-2/57484486#57484486", "title": "selection of line based on the pattern using ruby 2.2", "body": "<p>A quick fix would be as follows:</p>\n\n<pre><code># Need to declare the variables outside the block,\n# so they are not trapped in that scope\nvalue1 = nil\nvalue2 = nil\n\nFile.readlines(\"regional.txt\").each do |line|\n  # NOTE: added trailing space here:\n  if line.include?(\"shell.SetMyFile \")\n    value1 = line.split(\" \")[1] \n  end\n  if line.include?(\"shell.SetMyErrorFile \")\n    value2 = line.split(\" \")[1] \n  end\nend\n\nputs value1, value2\n# =&gt; \"Ranger\"\n# =&gt; \"Discovery\"\n</code></pre>\n\n<p>You could do it with regex as well:</p>\n\n<pre><code>key_vals = File.\n  read(\"regional.txt\").\n  scan(/\\w+\\.(\\w+)[^\\w]+(\\w+)/).\n  to_h\n\nvalue1 = key_vals[\"SetMyFile\"]\n# =&gt; \"Ranger\"\n\nvalue2 = key_vals[\"SetMyErrorFile\"]\n# =&gt; \"Discovery\"\n</code></pre>\n\n<p>To explain the regex, consider <code>shell.SetMyFile \"Ranger\"</code>:</p>\n\n<ul>\n<li><code>\\w+</code>: any number of alphaneumeric chars, matches the prefix e.g. <em>shell</em></li>\n<li><code>\\.</code>: a literal period</li>\n<li><code>(\\w+)</code>: match group 1, any number of alphaneumeric chars, matches the suffix e.g. <em>SetMyFile</em></li>\n<li><code>[^\\w]+</code> any number of non-alphaneumeric chars, matches whitespace as well as quotation</li>\n<li><code>(\\w+)</code> match group 2, any number of alphaneumeric chars. matches the value string e.g. <em>Ranger</em></li>\n</ul>\n\n<p>After calling <code>scan</code> you are left with a nested array:</p>\n\n<pre><code>File.read(\"regional.txt\").scan(/\\w+\\.(\\w+) \\\"?(\\w+)/)\n# =&gt; [\n#   [\"SetMyFile\", \"Ranger\"],\n#   [\"SetMyErrorFile\", \"Discovery\"], \n#   [\"SetMyFileEnabled\", \"1\"],\n#   [\"SetMyLogFileEnabled\", \"1\"]\n# ]\n</code></pre>\n\n<p>You can call <code>to_h</code> on this to turn it into a hash, for easy lookup by key:</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1565739146, "creation_date": 1565739146, "answer_id": 57486493, "question_id": 57484210, "link": "https://stackoverflow.com/questions/57484210/selection-of-line-based-on-the-pattern-using-ruby-2-2/57486493#57486493", "title": "selection of line based on the pattern using ruby 2.2", "body": "<p>Let's create your file.</p>\n\n<pre><code>FName = \"regional.txt\"\n\nFile.write FName, &lt;&lt;~END\nshell.SetMyFile \"Ranger\" \nshell.SetMyErrorFile \"Discovery\"\nshell.SetMyFileEnabled 1 \nshell.SetMyLogFileEnabled 1\nEND\n  #=&gt; 113\n</code></pre>\n\n<p>We are given:</p>\n\n<pre><code>desired_lines = [\"shell.SetMyFile\", \"shell.SetMyErrorFile\"]\n</code></pre>\n\n<p>I understand you wish to print certain information from the file. In general it's preferable to extract the desired information into a Ruby object then print the information of interest. That way, if you wish to manipulate the resulting object in your code you will not have to change that part of the code.</p>\n\n<p>One could read the lines of the file into an array, select the elements of interest then extract the information of interest. It's more efficient, however, to read the file line-by-line and save the information of interest from those lines that begin with an element of <code>desired_lines</code>, which requires only a single pass through the file and avoids the need to construct an intermediate array. You can do that with the methods <a href=\"https://ruby-doc.org//core-2.6.3/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a> and <a href=\"https://ruby-doc.org//core-2.6.3/Enumerator.html#method-i-with_object\" rel=\"nofollow noreferrer\">Enumerator#with_object</a>: </p>\n\n<pre><code>a = IO.foreach(FName).with_object([]) do |line,arr|\n  label, value = line.chomp.delete('\"').split\n  arr &lt;&lt; value if desired_lines.include?(label)\nend\n  #=&gt; [\"Ranger\", \"Discovery\"] \n</code></pre>\n\n<p>Alternatively, if you wish tie <code>\"Ranger\"</code> and <code>\"Discovery\"</code> to their corresponding lines, you could substitute:</p>\n\n<pre><code>arr &lt;&lt; [label, value]\n</code></pre>\n\n<p>for</p>\n\n<pre><code>arr &lt;&lt; value\n</code></pre>\n\n<p>in which case the return value would be:</p>\n\n<pre><code>[[\"shell.SetMyFile\", \"Ranger\"], [\"shell.SetMyErrorFile\", \"Discovery\"]] \n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 2699253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/954236abb0d238d574bb1ca452406eb6?s=128&d=identicon&r=PG&f=1", "display_name": "cyborg", "link": "https://stackoverflow.com/users/2699253/cyborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1565739146, "creation_date": 1565724577, "last_edit_date": 1565724996, "question_id": 57484210, "link": "https://stackoverflow.com/questions/57484210/selection-of-line-based-on-the-pattern-using-ruby-2-2", "title": "selection of line based on the pattern using ruby 2.2", "body": "<p>I have file called <strong>regional.txt</strong> and it has data as below :</p>\n\n<pre><code>shell.SetMyFile \"Ranger\" \nshell.SetMyErrorFile \"Discovery\"\nshell.SetMyFileEnabled 1 \nshell.SetMyLogFileEnabled 1\n</code></pre>\n\n<p>Now I am reading this file using ruby and trying to filter the text from <strong>\"shell.SetMyFile\"</strong> and <strong>\"shell.SetMyErrorFile\"</strong> as <strong>Ranger</strong> and <strong>Discovery</strong>:</p>\n\n<pre><code>File.readlines(\"regional.txt\").each do |line|\n      value1 = line.split(\" \")[1] if line.include?(\"shell.SetMyFile\")\n      value2 = line.split(\" \")[1] if line.include?(\"shell.SetMyErrorFile \")\n      puts value1, value2\nend\n</code></pre>\n\n<p>My result is <strong>1</strong> ,<strong>1</strong> rather than <strong>Ranger</strong> and <strong>Discovery</strong>. This is because include? method considering the  <strong>\"shell.SetMyFileEnabled\"</strong> and <strong>\"shell.SetMyLogFileEnabled\"</strong>. How can I filter it to the desired result ?</p>\n"}, {"tags": ["ruby", "chart.js", "chartkick"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1565723163, "post_id": 57483813, "comment_id": 101439138, "body": "how does it now look like? any screenshot?"}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1565724752, "post_id": 57483813, "comment_id": 101439739, "body": "@ArupRakshit: Just added one above."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1565725032, "post_id": 57483813, "comment_id": 101439843, "body": "I&#39;ll check tomorrow.. Got late tonight.."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1565727151, "post_id": 57483813, "comment_id": 101440614, "body": "Can you just add a background color? e.g. <code>backgroundColor: &quot;rgba(151,187,205,0.2)&quot;</code>"}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1565766948, "post_id": 57483813, "comment_id": 101449906, "body": "@SaraTibbetts: Only when I add it like this: <code>:dataset =&gt; {:backgroundColor: &quot;rgba(151,187,205,0.2)&quot;}</code> And it&#39;s still transparent when I do that."}, {"owner": {"reputation": 761, "user_id": 6923146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PBi3.jpg?s=128&g=1", "display_name": "Hardik Masalawala", "link": "https://stackoverflow.com/users/6923146/hardik-masalawala"}, "edited": false, "score": 1, "creation_date": 1565776031, "post_id": 57483813, "comment_id": 101454232, "body": "@Tintin81, Please check my answer <a href=\"https://stackoverflow.com/a/57489898/6923146\">stackoverflow.com/a/57489898/6923146</a>"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 1, "creation_date": 1565776282, "post_id": 57483813, "comment_id": 101454375, "body": "@Tintin81 What you add as background color IS transparent. When you set the last value to 1.0 it should be totally opaque."}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "edited": false, "score": 0, "creation_date": 1565796350, "post_id": 57483813, "comment_id": 101465130, "body": "OK, using <code>:dataset =&gt; {:backgroundColor: &quot;rgba(0,0,0,1)&quot;}</code> makes all bars black, so that works! Problem remains that it affects <i>all</i> bars and that I somehow have to convert hex values like <code>#000000</code> to RGB values like <code>rgba(0,0,0,1)</code> now. Not sure if that can be done."}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 6923146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9PBi3.jpg?s=128&g=1", "display_name": "Hardik Masalawala", "link": "https://stackoverflow.com/users/6923146/hardik-masalawala"}, "is_accepted": false, "score": 1, "last_activity_date": 1565870130, "creation_date": 1565870130, "answer_id": 57509269, "question_id": 57483813, "link": "https://stackoverflow.com/questions/57483813/how-to-remove-transparency-from-bar-charts/57509269#57509269", "title": "How to remove transparency from bar charts?", "body": "<p>For two different color with two data-set for proper data comparison Check code snippet</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code> //START Common for all chart\r\n var legend = {\r\n     display: true,\r\n     position: 'bottom',\r\n     labels: {\r\n         fontColor: '#000'\r\n     }\r\n };\r\n //END Common for all chart\r\n\r\n //Dataset\r\n var data1 = {\r\n     label: 'Dataset 1',\r\n     data: [4, 6, 3, 5, 2, 3],\r\n     backgroundColor: 'rgba(255, 99, 132, 1)', //Set 1 for remove transparency\r\n     borderColor: 'rgba(255, 99, 132, 1)',\r\n     borderWidth: 1\r\n };\r\n var data2 = {\r\n     label: 'Dataset 2',\r\n     data: [5, 2, 3, 4, 6, 3],\r\n     backgroundColor: 'rgba(54, 162, 235, 1)', //Set 1 for remove transparency\r\n     borderColor: 'rgba(54, 162, 235, 1)',\r\n     borderWidth: 1\r\n };\r\n var Dataset = [data1, data2]\r\n // Dataset\r\n //START Bar chart\r\n\r\n\r\n var option = {\r\n     scales: {\r\n         yAxes: [{\r\n             gridLines: {\r\n                 offsetGridLines: true\r\n             },\r\n             categorySpacing: 5,\r\n             ticks: {\r\n                 beginAtZero: true\r\n             }\r\n         }]\r\n     },\r\n     responsive: true,\r\n     //maintainAspectRatio: false,\r\n     legend: legend,\r\n     //onClick: LoadDataInDetails\r\n }\r\n var ctx = document.getElementById('myChart').getContext('2d');\r\n var myChart = new Chart(ctx, {\r\n     type: 'bar',\r\n     data: {\r\n         labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],\r\n         datasets: Dataset\r\n     },\r\n     options: option\r\n });</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdn.jsdelivr.net/npm/chart.js\"&gt;&lt;/script&gt;\r\n&lt;canvas id=\"myChart\"&gt;&lt;/canvas&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "is_accepted": false, "score": 0, "last_activity_date": 1566723200, "creation_date": 1566723200, "answer_id": 57644598, "question_id": 57483813, "link": "https://stackoverflow.com/questions/57483813/how-to-remove-transparency-from-bar-charts/57644598#57644598", "title": "How to remove transparency from bar charts?", "body": "<p>OK, it seems that only RGB colours can be passed into <code>column_chart()</code> (correct me if I'm wrong). This is what I ended up with:</p>\n\n<pre><code>&lt;%=\n  column_chart(\n    [\n      {:data =&gt; @invoices},\n      {:data =&gt; @payments}\n    ],\n    :id =&gt; \"chart\",\n    :stacked =&gt; true,\n    :colors =&gt; [to_rgba(\"#E91E63\"), to_rgba(\"#003366\")],\n    :legend =&gt; false,\n    :dataset =&gt; {:borderWidth =&gt; 0}\n  )\n%&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>module ColorHelper\n\n  def to_rgba(hex_value)\n    opacity = 1\n    hex_value = hex_value.gsub('#', '')\n    rgb_values = hex_value.scan(/../).map{ |x| x.hex }\n    rgb_values &lt;&lt; opacity\n    \"rgba(#{rgb_values.join(',')})\"\n  end\n\nend\n</code></pre>\n\n<p>Not perfect, but it gets the job done.</p>\n"}], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566723200, "creation_date": 1565722481, "last_edit_date": 1565724734, "question_id": 57483813, "link": "https://stackoverflow.com/questions/57483813/how-to-remove-transparency-from-bar-charts", "title": "How to remove transparency from bar charts?", "body": "<p>I wonder if there's any way to remove opacity from bar charts built with Chartkick in combination with ChartJS? They always appear semi-transparent, no matter what I do.</p>\n\n<p>This is what I've got so far:</p>\n\n<pre><code>&lt;%=\n  column_chart(\n    [\n      {:data =&gt; @invoices},\n      {:data =&gt; @payments}\n    ],\n    :id =&gt; \"chart\",\n    :stacked =&gt; true,\n    :colors =&gt; [\"#E91E63\", \"#003366\"],\n    :legend =&gt; false,\n    :dataset =&gt; {:borderWidth =&gt; 0}\n  )\n%&gt;\n</code></pre>\n\n<p>Thanks for any help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9We8y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9We8y.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "regex", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565720904, "post_id": 57483342, "comment_id": 101438195, "body": "Any reason that <code>Hello &lt;%= link_to @username, &quot;mysite.com&#47;#{@username}&quot; %&gt; this is your page</code> is not a viable option?"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565720785, "post_id": 57483387, "comment_id": 101438146, "body": "While <code>gsub</code> would still be my recommendation I have to assume the OP was looking for <code>my_string.gsub(&#47;(@\\w+)&#47;,&quot;@username&quot; =&gt; &quot;&lt;a href=\\&#39;mysite.com&#47;#{@username}\\&#39;&gt;#{@username}&lt;&#47;a&gt;&quot;)</code> so as to substitute in the instance variable"}, {"owner": {"reputation": 351, "user_id": 3878329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EHSxC.png?s=128&g=1", "display_name": "Peter Zhu", "link": "https://stackoverflow.com/users/3878329/peter-zhu"}, "edited": false, "score": 3, "creation_date": 1565720886, "post_id": 57483387, "comment_id": 101438184, "body": "Note that this solution is vulnerable to XSS, so make sure to either properly escape the username or don&#39;t render this string as HTML."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1565720440, "creation_date": 1565720440, "answer_id": 57483387, "question_id": 57483342, "link": "https://stackoverflow.com/questions/57483342/how-to-find-a-string-contains-specific-character-and-replace-it-with-a-html-tag/57483387#57483387", "title": "How to find a string contains specific character and replace it with a HTML tag", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-gsub\" rel=\"nofollow noreferrer\"><code>String#gsub</code></a> with a regex:</p>\n\n<pre><code>my_string = 'Hello @username this is your page'\nmy_string.gsub(/@(\\w+)/,'&lt;a href=\\'mysite.com/\\1\\'&gt;@\\1&lt;/a&gt;' )\n#=&gt; \"Hello &lt;a href='mysite.com/username'&gt;@username&lt;/a&gt; this is your page\"\n</code></pre>\n\n<p>Regex explanation:</p>\n\n<ul>\n<li><code>@\\w+</code> in regex means <code>@</code> and one or more word characters (<code>\\w</code> stands for alphanumerical characters or an underscore)</li>\n<li><code>(...)</code> in regex catches the username in a capturing group, that can be used later in replacements</li>\n<li><code>\\1</code> in a second <code>gsub</code> argument instructs <code>gsub</code> to put contents of the first capturing group to this place of the string - in this case, the username</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "is_accepted": false, "score": 1, "last_activity_date": 1565726794, "creation_date": 1565726794, "answer_id": 57484634, "question_id": 57483342, "link": "https://stackoverflow.com/questions/57483342/how-to-find-a-string-contains-specific-character-and-replace-it-with-a-html-tag/57484634#57484634", "title": "How to find a string contains specific character and replace it with a HTML tag", "body": "<p>The answer of mrazza is doing very well the job. But if you want to avoid using regex I guess it could be helpful.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>result = []\nsplitted_string = 'Hello @username this is your page'.split\n\nsplitted_string.each_with_index do |a, i|\n  result &lt;&lt; a\n  if a.include? '@'\n    result.insert(i, \"&lt;a href='mysite.com/username' &gt;\", a, \"&lt;/a&gt;\")\n          .delete_at(i + 3)\n  end\nend\np result.join(' ')\n#=&gt; \"Hello &lt;a href='mysite.com/username'&gt;@username&lt;/a&gt; this is your page\"\n</code></pre>\n\n<p>Basically you split your string to get an array, you iterate over it and if you find an <code>@</code> you add the element you want between it by using index. </p>\n\n<p>If you don't want to delete an element which can be tricky, you can write the following line between your statement:</p>\n\n<pre><code>result.insert(i, \"&lt;a href='mysite.com/username' &gt;\")\nresult.insert(i + 2, \"&lt;/a&gt;\")\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57483387, "answer_count": 2, "score": 0, "last_activity_date": 1565726794, "creation_date": 1565720206, "last_edit_date": 1565721300, "question_id": 57483342, "link": "https://stackoverflow.com/questions/57483342/how-to-find-a-string-contains-specific-character-and-replace-it-with-a-html-tag", "title": "How to find a string contains specific character and replace it with a HTML tag", "body": "<p>I want to find all words that starts <code>@</code> the character in a string and change it to the <code>&lt;a&gt;</code> HTML tag.</p>\n\n<p>For example:</p>\n\n<pre><code>my_string = 'Hello @username this is your page'\n# in my_string i want replace @username like:\n@username =&gt; &lt;a href='mysite.com/username'&gt;@username&lt;/a&gt;\n# expected output =&gt; \nHello &lt;a href='mysite.com/username' &gt;@username&lt;/a&gt; this is your page\n</code></pre>\n\n<p>Thoughts?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565715283, "post_id": 57482146, "comment_id": 101435801, "body": "<code>hash1.transform_values { |v| v.values.sum }</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1565720244, "post_id": 57482146, "comment_id": 101437907, "body": "@AlekseiMatiushkin works only on ruby version &gt;= 2.4"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565759325, "post_id": 57482146, "comment_id": 101447363, "body": "@lacostenycoder it\u2019s 2019 all around; if somebody asks such question it clearly means they do not support legacy behemoth and can have the up-to-date ruby version installed."}, {"owner": {"reputation": 17, "user_id": 11103168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRG3o.jpg?s=128&g=1", "display_name": "7KAG7", "link": "https://stackoverflow.com/users/11103168/7kag7"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1565828958, "post_id": 57482146, "comment_id": 101475790, "body": "@AlekseiMatiushkin, its true, im up-to-date"}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565719850, "post_id": 57482570, "comment_id": 101437727, "body": "@3limin4t0r tried that and got <code>NoMethodError: undefined method </code>sum&#39; for [435, 3264]:Array` on ruby 2.0.0.  Same on version 2.3.6"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565720083, "post_id": 57482570, "comment_id": 101437826, "body": "@3limin4t0r your last comment doesn&#39;t work either, are you testing this before commenting?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565720862, "post_id": 57482570, "comment_id": 101438173, "body": "Also keep in mind that your <code>.inject(&amp;:+)</code> returns <code>nil</code> and not <code>0</code> for empty arrays."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565720917, "post_id": 57482570, "comment_id": 101438199, "body": "@3limin4t0r <code>NoMethodError: undefined method </code>to_h&#39; for [[:a, 3699], [:b, 47686], [:c, 8887]]:Array` for your previous comment in ruby 2.0.0"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565721029, "post_id": 57482570, "comment_id": 101438243, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/197889/discussion-between-lacostenycoder-and-3limin4t0r\">continue this discussion in chat</a>."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1565721332, "post_id": 57482570, "comment_id": 101438369, "body": "For older versions I&#39;d use <code>Hash[hash1.map { |k, v| [k, v.values.reduce(0, :+)] }]</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565759450, "post_id": 57482570, "comment_id": 101447394, "body": "@3limin4t0r <code>hash1.each_with_object({}) { |(k, v), h| h[k] = v.values.reduce(0, &amp;:+) }</code>is way cleaner."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565787006, "post_id": 57482570, "comment_id": 101459741, "body": "@AlekseiMatiushkin let&#39;s clean it up more even more <code>hash1.each_with_object({}) { |(k, v), h| h[k] = v.values.reduce(:+) }</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565787716, "post_id": 57482570, "comment_id": 101460121, "body": "@engineersmnky <a href=\"https://stackoverflow.com/questions/57441885/requesting-an-insight-on-reduce-ruby-code/57442702?noredirect=1#comment101447426_57442702\" title=\"requesting an insight on reduce ruby code\">stackoverflow.com/questions/57441885/&hellip;</a> \u2014 I do always explicitly specify the initial value <i>and</i> the ampersand to clarify the intent (passing block.) <code>reduce</code> and <code>inject</code> accepting a symbol is plain wrong."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1565789318, "post_id": 57482570, "comment_id": 101461138, "body": "@AlekseiMatiushkin while I can concede to the fact that passing a symbol to <code>reduce</code> does leave one feeling kind of dirty :).  All of the answers are already founded on the basis of the given structure so IMO the initial value is neither here nor there. What if <code>v</code> was not a <code>Hash</code> then the result of the <code>values</code> message is indeterminate and <code>sum</code> or <code>reduce</code> even more so . For example should <code>values</code> actually result in an <code>Array&lt;String&gt;</code> or <code>Array&lt;Array&gt;</code> then <code>reduce(0,&amp;:+)</code> will raise <code>TypeError</code> (as would <code>sum</code>) but <code>reduce(&amp;:+)</code> would not."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565789774, "post_id": 57482570, "comment_id": 101461395, "body": "@engineersmnky I agree with both sides of the debate here. Sometimes the flexibility in ruby leads to these interesting conversations. On one side we have &quot;when in doubt, leave it out&quot; the other,  &quot;to begin, leave it in&quot;.  In this example we are operating on a specific value where the hash structure is known, so we often look for the shortest solution.  Does the 2.4 + version introduce any of this discussion?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565790423, "post_id": 57482570, "comment_id": 101461790, "body": "@lacostenycoder it operates on the same assumptions with less flexibility. <code>sum</code> assumes <code>Integer</code> and will require an initial value unless the <code>obj.all?(Numeric)</code>. This means that to leverage sum with something other than numbers you most know what that something is and/or pass a block to convert that something (essentially <code>map(&amp;method).sum(initial)</code>) for instance <code>{foo: 1, bar: 2}.sum(&amp;:pop) #=&gt; 3</code> however  <code>{foo: 1, bar: 2}.sum(&quot;&quot;,&amp;:to_s) #=&gt;  &quot;[:foo, 1][:bar, 2]&quot;</code> or <code>{foo: 1, bar: 2}.sum([]) #=&gt; [:foo,1,:bar,2]</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1565791089, "post_id": 57482570, "comment_id": 101462165, "body": "Additionally <code>reduce</code> can form any kind of reduction where as <code>sum</code>(by virtue of its name) is specific to <code>+</code> meaning that each return must <code>respond_to?(:+)</code> and accept <code>enum.next</code> as a valid argument to <code>+</code> and return an object that does the same until such point as <code>enum.next</code> raises <code>StopIteration</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565808606, "post_id": 57482570, "comment_id": 101470314, "body": "@engineersmnky wow, I had no idea about <code>{foo: 1, bar: 2}.sum(&amp;:pop)</code> or that <code>.sum</code> could be called on <code>Hash</code> but since it is a kind of <code>Array</code> that makes sense. That is very interesting. I have learned a lot by having had the good fortune of testing Aleksei Matiushkin &#39;s comment in an older version of Ruby.  Thanks!"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1565789351, "last_edit_date": 1565789351, "creation_date": 1565716996, "answer_id": 57482570, "question_id": 57482146, "link": "https://stackoverflow.com/questions/57482146/fill-hash-values-with-another-hash/57482570#57482570", "title": "fill hash values with another hash", "body": "<p>If you are on Ruby version >= 2.4 you can do</p>\n\n<pre><code>hash2 = hash1.transform_values { |v| v.values.sum }\n=&gt;{:a=&gt;3699, :b=&gt;47686, :c=&gt;8887}\n</code></pre>\n\n<p>UPDATED thanks to @3limin4t0r, and @Aleksei Matiushkin for a cleaner way for Ruby version &lt; 2.4 see comment</p>\n\n<pre><code>hash2 = Hash[hash1.map { |k, v| [k, v.values.reduce(0, &amp;:+)] }]\n=&gt; {:a=&gt;3699, :b=&gt;47686, :c=&gt;8887}\n# or if your prefer each_with_object\nhash1.each_with_object({}) { |(k, v), h| h[k] = v.values.reduce(0, &amp;:+) }\n=&gt; {:a=&gt;3699, :b=&gt;47686, :c=&gt;8887}\n</code></pre>\n\n<p>Original left here for conversation  </p>\n\n<p>Otherwise you can do this, there's probably a quicker way but it works</p>\n\n<pre><code>hash2 = {}\nsum_vals = hash1.values.map{|h| h.values.inject(&amp;:+)}\nhash1.keys.each_with_index{|key, i| hash2[key] = sum_vals[i] }\nhash2\n=&gt;{:a=&gt;3699, :b=&gt;47686, :c=&gt;8887}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565719283, "post_id": 57482923, "comment_id": 101437494, "body": "Nice but it is not supported in Ruby version &lt; 2.4"}], "tags": [], "owner": {"reputation": 11, "user_id": 11923117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9fjO-MabixQ/AAAAAAAAAAI/AAAAAAAAD28/39-KXbkvXDU/photo.jpg?sz=128", "display_name": "Luke Weaver", "link": "https://stackoverflow.com/users/11923117/luke-weaver"}, "is_accepted": false, "score": 0, "last_activity_date": 1565718421, "creation_date": 1565718421, "answer_id": 57482923, "question_id": 57482146, "link": "https://stackoverflow.com/questions/57482146/fill-hash-values-with-another-hash/57482923#57482923", "title": "fill hash values with another hash", "body": "<p>Yea Aleksei Matiushkin is completely right. <code>transform_values</code> has a destructive version as well as a non destructive version. The destructive version has what is called a bang, or an exclamation point, so this: <code>transform_values!</code> is read as transform values bang, and it will alter your original hash. On the other hand <code>transform_values</code> returns a new array without altering the original, hence, non destructive. From what I can tell you want to deal with the non destructive version. </p>\n\n<p>In this case you can run a <code>hash1.transform_values { |values| values.values.sum }</code> which will return the new hash, however, because this is nondestructive, <code>hash1</code> will still be equal to your original <code>hash1</code>. Because of this you want to set <code>hash2</code> equal to the transform values. </p>\n\n<p>Basically what is happening is the hash is running through all the values associated with the keys and taking those keys values (due to you having a multidimensional hash) and adding them together. </p>\n\n<p>Here is a great link for you to take a look at! <a href=\"https://blog.bigbinary.com/2017/06/14/ruby-2-4-added-hash-transform-values-and-its-destructive-version-from-active-support.html\" rel=\"nofollow noreferrer\">https://blog.bigbinary.com/2017/06/14/ruby-2-4-added-hash-transform-values-and-its-destructive-version-from-active-support.html</a></p>\n"}], "owner": {"reputation": 17, "user_id": 11103168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRG3o.jpg?s=128&g=1", "display_name": "7KAG7", "link": "https://stackoverflow.com/users/11103168/7kag7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1565789351, "creation_date": 1565714966, "last_edit_date": 1565718874, "question_id": 57482146, "link": "https://stackoverflow.com/questions/57482146/fill-hash-values-with-another-hash", "title": "fill hash values with another hash", "body": "<p>I have a hash with values with more values: </p>\n\n<pre><code>hash1 = {\n  :a =&gt; {\n    :foo =&gt; 435,\n    :bar =&gt; 3264\n  },\n  :b =&gt; {\n    :foo =&gt; 45234,\n    :bar =&gt; 2452\n  },\n  :c =&gt; {\n    :foo =&gt; 4352,\n    :bar =&gt; 4535\n  }\n}\n</code></pre>\n\n<p>and I need to add the sum of a, b, and c to new array</p>\n\n<pre><code>\nhash2 = {\n  :a =&gt; total,\n  :b =&gt; total,\n  :c =&gt; total\n}\n</code></pre>\n\n<p>my attempt so far is something like:\n    <code>hash2.each {|e,v| v = hash1[0]}</code></p>\n\n<p>struggling so I need some help! thanks!</p>\n"}, {"tags": ["ruby", "bundler"], "comments": [{"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 4, "creation_date": 1565710213, "post_id": 57480944, "comment_id": 101433518, "body": "Use RVM or rbenv and forget sudo with <code>bundler</code>/<code>gem</code>."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565715329, "post_id": 57480944, "comment_id": 101435829, "body": "can you please update your question to include the output of <code>gem env</code> ? But perhaps also see my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1565715386, "creation_date": 1565715386, "answer_id": 57482244, "question_id": 57480944, "link": "https://stackoverflow.com/questions/57480944/during-gem-update-i-get-permissions-error-for-usr-bin-directory/57482244#57482244", "title": "During gem update I get permissions error for /usr/bin directory", "body": "<p>It is highly recommended to use a ruby version manager so you never have to mess with trying to update system ruby i.e. avoid <code>sudo gem update</code></p>\n\n<p>These are widely used in the ruby community.</p>\n\n<p><a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">https://rvm.io/rvm/install</a></p>\n\n<p><a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">https://github.com/rbenv/rbenv</a></p>\n\n<p>If you have installed a version manager, than it's likely something wrong with your $PATH variable.  See my comment on your question.</p>\n"}], "owner": {"reputation": 81, "user_id": 2445505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19d000960e4427c707ff43bb4f70967?s=128&d=identicon&r=PG", "display_name": "jmanpa", "link": "https://stackoverflow.com/users/2445505/jmanpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 57482244, "answer_count": 1, "score": 2, "last_activity_date": 1565715386, "creation_date": 1565709961, "last_edit_date": 1565710105, "question_id": 57480944, "link": "https://stackoverflow.com/questions/57480944/during-gem-update-i-get-permissions-error-for-usr-bin-directory", "title": "During gem update I get permissions error for /usr/bin directory", "body": "<p>I get the following when executing sudo gem update:</p>\n\n<pre><code>Updating installed gems\nUpdating actioncable\nFetching actioncable-5.2.3.gem\nFetching actionview-5.2.3.gem\nFetching activesupport-5.2.3.gem\nFetching actionpack-5.2.3.gem\nSuccessfully installed activesupport-5.2.3\nSuccessfully installed actionview-5.2.3\nSuccessfully installed actionpack-5.2.3\nSuccessfully installed actioncable-5.2.3\nParsing documentation for activesupport-5.2.3\nInstalling ri documentation for activesupport-5.2.3\nInstalling darkfish documentation for activesupport-5.2.3\nParsing documentation for actionview-5.2.3\nInstalling ri documentation for actionview-5.2.3\nInstalling darkfish documentation for actionview-5.2.3\n\n..... many more successful lines ......\n\nFetching bundler-2.0.2.gem\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /usr/bin directory.\n</code></pre>\n\n<p>Not sure what else to try except the sudo that I am using.</p>\n\n<p>I expect the update to complete without failing.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565708003, "post_id": 57480277, "comment_id": 101432274, "body": "Have an inner loop that will iterate keys of the hash and match each key against your regex (or do a simpler check, like <code>start_with?</code>)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1565709090, "post_id": 57480277, "comment_id": 101432924, "body": "@SergioTulentsev I use <code>grep</code> whenever possible only for its name :) (also it\u2019s faster than an iteration, but that\u2019s not as important as the name.)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565709493, "post_id": 57480277, "comment_id": 101433133, "body": "@AlekseiMatiushkin: performance claim needs to be backed by hard numbers :) I have a feeling that string prefix is faster than regex-powered grep. The latter does look nicer, of course."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1565712733, "post_id": 57480277, "comment_id": 101434769, "body": "In Ruby we don&#39;t call them a dictionary, we call them a hash. People will still understand what you mean, but for example the class name is <a href=\"https://ruby-doc.org/core-2.5.1/Hash.html\" rel=\"nofollow noreferrer\"><code>Hash</code></a>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565717110, "post_id": 57480277, "comment_id": 101436535, "body": "@AlekseiMatiushkin: <a href=\"https://pastebin.com/nSb1ABP4\" rel=\"nofollow noreferrer\">10x difference</a>, this is hard to throw away :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565759813, "post_id": 57480277, "comment_id": 101447473, "body": "@SergioTulentsev ok, ok, you\u2019ve got me. I love how you optimized yours to avoid string interpolation unless strictly necessary to get to 10&#215; :)))"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565773980, "post_id": 57480277, "comment_id": 101453187, "body": "@AlekseiMatiushkin: without the opto it&#39;s <i>only</i> 8x &#175;\\_(\u30c4)_/&#175;"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1565711202, "last_edit_date": 1565711202, "creation_date": 1565709012, "answer_id": 57480688, "question_id": 57480277, "link": "https://stackoverflow.com/questions/57480277/find-element-dict-based-on-elements-of-a-list/57480688#57480688", "title": "Find element dict based on elements of a list", "body": "<pre><code>input['services'].reject do |x|\n  input.keys.grep(/\\A#{x}_limit_/).empty?\nend\n#\u21d2 [\"foo\", \"test\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565717839, "post_id": 57480713, "comment_id": 101436816, "body": "&quot;more performant&quot; is an understatement :) <a href=\"https://pastebin.com/UH3vEBTH\" rel=\"nofollow noreferrer\">pastebin.com/UH3vEBTH</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565737981, "post_id": 57480713, "comment_id": 101443651, "body": "Could you rerun the benchmarks until my solution is fastest?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565738309, "post_id": 57480713, "comment_id": 101443729, "body": "@CarySwoveland of course. <i>Change your solution</i> :)"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1565732080, "last_edit_date": 1565732080, "creation_date": 1565709117, "answer_id": 57480713, "question_id": 57480277, "link": "https://stackoverflow.com/questions/57480277/find-element-dict-based-on-elements-of-a-list/57480713#57480713", "title": "Find element dict based on elements of a list", "body": "<p>I would go about it like this </p>\n\n<pre><code>dict['services'] &amp; dict.keys.flat_map {|k| k.scan(/\\w+(?=_limit_)/)}\n</code></pre>\n\n<p>Here we use <code>Array#&amp;</code> (intersection) between the <code>dict['services']</code> and the keys that match the given pattern.  </p>\n\n<pre><code>dict.keys.flat_map {|k| k.scan(/\\w+(?=_limit_)/)}\n#=&gt; [\"foo\", \"test\"]\n</code></pre>\n\n<p>Another as suggested by <a href=\"https://stackoverflow.com/questions/57480277/find-element-dict-based-on-elements-of-a-list/57480713#comment101432274_57480277\">@SergioTulentsev</a> (which is far more performant) is </p>\n\n<pre><code>dict['services'].select {|s| dict.any? {|k,_| k.start_with?(s)}}\n</code></pre>\n\n<p><a href=\"https://pastebin.com/UH3vEBTH\" rel=\"nofollow noreferrer\">Benchmarks Provided By @SergioTulentsev</a></p>\n\n<pre><code># &gt;&gt; Warming up --------------------------------------\n# &gt;&gt;               sergio    54.608k i/100ms\n# &gt;&gt;              aleksei     6.257k i/100ms\n# &gt;&gt;                 cary    40.951k i/100ms\n# &gt;&gt;        engineersmnky    16.093k i/100ms\n# &gt;&gt; Calculating -------------------------------------\n# &gt;&gt;               sergio    663.692k (\u00b1 3.5%) i/s -      3.331M in   5.025472s\n# &gt;&gt;              aleksei     64.006k (\u00b1 2.9%) i/s -    325.364k in   5.087717s\n# &gt;&gt;                 cary    472.838k (\u00b1 3.1%) i/s -      2.375M in   5.028133s\n# &gt;&gt;        engineersmnky    167.907k (\u00b1 2.0%) i/s -    852.929k in   5.081762s\n# &gt;&gt;\n# &gt;&gt; Comparison:\n# &gt;&gt;               sergio:   663691.8 i/s\n# &gt;&gt;                 cary:   472838.2 i/s - 1.40x  slower\n# &gt;&gt;        engineersmnky:   167906.6 i/s - 3.95x  slower\n# &gt;&gt;              aleksei:    64005.5 i/s - 10.37x  slower\n# &gt;&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565737451, "post_id": 57481737, "comment_id": 101443532, "body": "What I meant was in this case there would be no difference between <code>.+?</code> and <code>.*</code> unless you are assuming there is a service of <code>&quot;&quot;</code> that should be excluded for some reason"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565737803, "post_id": 57481737, "comment_id": 101443611, "body": "@engineersmnky, yes. I was just worried that a key might be changed to <code>&quot;foo_limit_limit_max&quot;</code> sometime in future. &#175;\\_(\u30c4)_/&#175; (I shouldn&#39;t have deleted my first comment as I mashed the context.)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565738256, "post_id": 57481737, "comment_id": 101443716, "body": "Well now at least I understand your thought process although who knows maybe <code>foo_limit</code> is a valid service. Either way it is better than <code>flat_map {...scan}</code> (what idiot thought that was a good idea :))"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1565713127, "creation_date": 1565713127, "answer_id": 57481737, "question_id": 57480277, "link": "https://stackoverflow.com/questions/57480277/find-element-dict-based-on-elements-of-a-list/57481737#57481737", "title": "Find element dict based on elements of a list", "body": "<pre><code>h = {\"services\"=&gt;[\"foo\", \"bar\", \"test\"], \"foo_limit_max\"=&gt;2, \"test_limit_min\"=&gt;6}\n</code></pre>\n\n<h1><p><p></h1>\n\n<pre><code>h[\"services\"] &amp; h.keys.map { |k| k[/.+?(?=_limit_)/] }\n  #=&gt; [\"foo\", \"test\"]\n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>h.keys.map { |k| k[/.+?(?=_limit_)/] }\n  #=&gt; [nil, \"foo\", \"test\"]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org//core-2.6.3/Array.html#method-i-26\" rel=\"nofollow noreferrer\">Array#&amp;</a>, which includes the sentence, \"The order is preserved from the original array.\".</p>\n"}], "owner": {"reputation": 3647, "user_id": 4093955, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/bjZjz.jpg?s=128&g=1", "display_name": "Ay0", "link": "https://stackoverflow.com/users/4093955/ay0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 57480688, "answer_count": 3, "score": 0, "last_activity_date": 1565732080, "creation_date": 1565707748, "last_edit_date": 1565707894, "question_id": 57480277, "link": "https://stackoverflow.com/questions/57480277/find-element-dict-based-on-elements-of-a-list", "title": "Find element dict based on elements of a list", "body": "<p>I have a dict similar to:</p>\n\n<pre><code>{\"services\"=&gt;[\"foo\", \"bar\", \"test\"], \"foo_limit_max\"=&gt;2, \"test_limit_min\"=&gt;6}\n</code></pre>\n\n<p>I want to extract from the list of <code>services</code> all of those services that have a key following <code>servicename_limit_*</code></p>\n\n<p>I tried the following <code>dict['services'].select { |x| dict.key?(/#{x}_limit_*/)}</code> but it's not returning anything.</p>\n\n<p>Expected output would be <code>['foo', 'test']</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "activemodel"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 1, "creation_date": 1565724880, "post_id": 57479383, "comment_id": 101439786, "body": "There are a near infinite number of real-world examples. These kinds of open-ended questions are not suitable for Stack Overflow. You can check Github for uses of <code>ActiveModel::Validator</code> if you want to find projects making use of it."}], "answers": [{"tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 2, "last_activity_date": 1565708341, "last_edit_date": 1565708341, "creation_date": 1565706561, "answer_id": 57479925, "question_id": 57479383, "link": "https://stackoverflow.com/questions/57479383/rails-validations-use-case/57479925#57479925", "title": "Rails validations use-case", "body": "<p>These are not equivalent, each exists for a reason, which is described in the documentation.</p>\n\n<blockquote>\n  <ol>\n  <li>Custom validator inheriting from <code>ActiveModel::Validator</code></li>\n  </ol>\n</blockquote>\n\n<p>This option provides a way to define <strong>reusable</strong> custom validation that applies to a whole record, not to a specific property. You can define custom validators that test complex state, and apply them to multiple models.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Custom validator inheriting from <code>ActiveModel::EachValidator</code></li>\n  </ol>\n</blockquote>\n\n<p>This option provides a way of defining <strong>reusable</strong> custom validation that applies to specific fields on a model. You can reuse this validation against a single field, but across many models.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Custom methods - no parameters <code>validate :name_of_method</code></li>\n  </ol>\n</blockquote>\n\n<p>This option provides a <strong>non-reusable</strong> custom validation that applies to one specific model. You can use this for one-off logic that is \"private\" to a specific model, and doesn't need to be reusable.</p>\n\n<p>For example, given a <code>Post</code> model...</p>\n\n<pre><code>\nclass Post &lt; ActiveRecord::Base\n\n  # Expects MyCustomPostValidator to inhert from ActiveModel::Validator\n  # This validator receives the entire post instance, and can validate\n  # the whole post based on any criteria\n  validates_with :my_custom_post_validator\n\n  # Expects MyCustomTitleValidator to inhert from ActiveModel::EachValidator\n  # This validator receives the post and the attribute `:title`, and the\n  # current value of post.title.\n  # It should be limited to testing the validity of title in isolation\n  validates :title, my_custom_title_validator: true\n\n  validate :post_is_valid\n\n  private\n\n  def post_is_valid\n    # This method should contain complex logic that cannot be expressed\n    # through validating individual fields, and which is specific to\n    # Posts and not worth distilling out a reusable external validator class\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11923117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9fjO-MabixQ/AAAAAAAAAAI/AAAAAAAAD28/39-KXbkvXDU/photo.jpg?sz=128", "display_name": "Luke Weaver", "link": "https://stackoverflow.com/users/11923117/luke-weaver"}, "is_accepted": false, "score": 1, "last_activity_date": 1565708760, "creation_date": 1565708760, "answer_id": 57480604, "question_id": 57479383, "link": "https://stackoverflow.com/questions/57479383/rails-validations-use-case/57480604#57480604", "title": "Rails validations use-case", "body": "<p>1) Using a custom validator class is often very helpful when you have an attribute that needs the same kinds of validations across different classes, especially when the validations required are instance methods. That way you cannot call that class and stick these different attributes in it and bam they are validated without you having to have the same type of validations written for each attribute.</p>\n\n<p>2) An each validator is very helpful for an attribute that fits into a pseudo bucket that must meet a certain requirement. So for example, email makes sense in this case because each email must meet certain requirements, so although each email is different there are standards that they must all meet. </p>\n\n<p>3) A block validator can be used when an attribute needs a validation that is not met by Active Record's built in validation cases, for example <code>length: { maximum: 6, message: 'cannot be empty' }</code>. An example of one of these instances would be validating a json hash with a set kind of keys and values. </p>\n\n<p>Here is a super helpful article explaining Active Record's different validation techniques and what they are used for: <a href=\"https://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_validations.html</a></p>\n"}], "owner": {"reputation": 189, "user_id": 4555842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5wCq.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4555842/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "closed_date": 1565724574, "answer_count": 2, "score": -2, "last_activity_date": 1565724678, "creation_date": 1565704726, "last_edit_date": 1565724678, "question_id": 57479383, "link": "https://stackoverflow.com/questions/57479383/rails-validations-use-case", "closed_reason": "Needs more focus", "title": "Rails validations use-case", "body": "<p>Reading the <a href=\"https://guides.rubyonrails.org/active_record_validations.html#custom-validators\" rel=\"nofollow noreferrer\">documentation</a> of rails about custom validation I see 3 way of doing this :</p>\n\n<ol>\n<li>Custom validator inheriting from <code>ActiveModel::Validator</code> -> prototype : <code>def validate(record)</code> we use it with <code>validate_with</code></li>\n<li>Custom validator inheriting from <code>ActiveModel::EachValidator</code> -> prototype <code>def validate_each(record, attribute, value)</code>, we use it when we do <code>validates :email, unique: true</code> e.g</li>\n<li>Custom methods - no parameters <code>valide :name_of_method</code></li>\n</ol>\n\n<p>Now what I'd like to understand is: Why is there 3 choices of accomplish this ? Which scenario make you choose which options ? I mean we probably can code everything with only one of the option. Just curious about the use-case you're using one of the option in. Are you following any convention ?</p>\n\n<p>Edit : I believe I wasn't clear enough, I am looking for real and concrete example about the usage of those custom validations, which kind of design could involve having <code>ActiveModel::Validator</code> e.g ? On my end I found this afternoon a pretty good usage for custom methods : </p>\n\n<pre><code>validate :validate_client_id_not_changed, on: :update\n\n\ndef validate_client_id_not_changed\n  errors.add :client_id, :changed if client_id_changed?\nend\n</code></pre>\n\n<p>I am looking for concrete example running on production, like the example above, not generic one.</p>\n"}, {"tags": ["javascript", "arrays", "ruby", "enumerator", "equivalent"], "comments": [{"owner": {"reputation": 319259, "user_id": 1447675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziYmO.gif?s=128&g=1", "display_name": "Nina Scholz", "link": "https://stackoverflow.com/users/1447675/nina-scholz"}, "edited": false, "score": 4, "creation_date": 1565701641, "post_id": 57477912, "comment_id": 101428444, "body": "your second example needs <code>each_cons(3)</code>, because you have three elements in the result items."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 319259, "user_id": 1447675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziYmO.gif?s=128&g=1", "display_name": "Nina Scholz", "link": "https://stackoverflow.com/users/1447675/nina-scholz"}, "edited": false, "score": 0, "creation_date": 1565703429, "post_id": 57477912, "comment_id": 101429462, "body": "And also <code>(0..5)</code> instead of <code>(0..9)</code>, those copy/paste can be the roots of al evil! Thanks @NinaScholz."}], "answers": [{"comments": [{"owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 2, "creation_date": 1565701001, "post_id": 57477913, "comment_id": 101428103, "body": "Alternate syntax for Array.from using internal mapper argument <code>Array.from({length:array.length - num + 1},               (_, i) =&gt; array.slice(i, i + num))</code>"}, {"owner": {"reputation": 1040, "user_id": 9758920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5397a7b84da492865cb4443b7389b0f6?s=128&d=identicon&r=PG&f=1", "display_name": "claasic", "link": "https://stackoverflow.com/users/9758920/claasic"}, "edited": false, "score": 1, "creation_date": 1565702520, "post_id": 57477913, "comment_id": 101428923, "body": "@UlysseBN, you can exclude your <code>map</code> completely and use the internal mapper itself, in case you didn&#39;t notice. There is definitely a performance increase in comparison to the solution you have right now mixed together."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 1040, "user_id": 9758920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5397a7b84da492865cb4443b7389b0f6?s=128&d=identicon&r=PG&f=1", "display_name": "claasic", "link": "https://stackoverflow.com/users/9758920/claasic"}, "edited": false, "score": 1, "creation_date": 1565703702, "post_id": 57477913, "comment_id": 101429627, "body": "@assoron - edited. I&#39;m soo glad I posted this Q&amp;A, it keeps getting better every minute."}], "tags": [], "owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "is_accepted": true, "score": 4, "last_activity_date": 1565704036, "last_edit_date": 1565704036, "creation_date": 1565699990, "answer_id": 57477913, "question_id": 57477912, "link": "https://stackoverflow.com/questions/57477912/equivalent-of-rubys-each-cons-in-javascript/57477913#57477913", "title": "Equivalent of Ruby&#39;s each_cons in JavaScript", "body": "<p>Here is a function that will do it (ES6+):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>// functional approach\r\nconst eachCons = (array, num) =&gt; {\r\n    return Array.from({ length: array.length - num + 1 },\r\n                      (_, i) =&gt; array.slice(i, i + num))\r\n}\r\n\r\n// prototype overriding approach\r\nArray.prototype.eachCons = function(num) {\r\n  return Array.from({ length: this.length - num + 1 },\r\n                    (_, i) =&gt; this.slice(i, i + num))\r\n}\r\n\r\n\r\nconst array = [0,1,2,3,4,5]\r\nconst log = data =&gt; console.log(JSON.stringify(data))\r\n\r\nlog(eachCons(array, 2))\r\nlog(eachCons(array, 3))\r\n\r\nlog(array.eachCons(2))\r\nlog(array.eachCons(3))</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>You have to guess the length of the resulting array (<code>n = length - num + 1</code>), and then you can take advantage of JavaScript's <a href=\"https://devdocs.io/javascript/global_objects/array/slice\" rel=\"nofollow noreferrer\"><code>array.slice</code></a> To get the chunks you need, iterating <code>n</code> times.</p>\n"}, {"comments": [{"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1565700863, "post_id": 57478063, "comment_id": 101428031, "body": "I like this a lot! However, I&#39;d rather use a solution that gives back an array depending on the situation. For instance, the generator solution doesn&#39;t allow <code>eachCons([1,2,3,3], 3).map((a) =&gt; a[0] + a[1])</code>. +1 however, for the versatility and cleverness of that solution.  I wouldn&#39;t use the prototype solution, but I know some would so..."}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1565701118, "post_id": 57478063, "comment_id": 101428172, "body": "@UlysseBN Well, you could use: <code>Array.from</code> but you&#39;re right, that&#39;s a &quot;downside&quot; of generators :P"}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1565701210, "post_id": 57478063, "comment_id": 101428227, "body": "@UlysseBN perhaps it would make sense to don&#39;t return the generator on the prototype but, to rather return an array, though this would bring to confusion and inconsistency, but still, that would solve the issue (and would make sense if used against an array)."}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 1, "creation_date": 1565701837, "post_id": 57478063, "comment_id": 101428543, "body": "@UlysseBN as a side note, I&#39;ve just noticed now that <code>to_a</code> is invoked in ruby, hence it&#39;s probably returning an iterator in ruby as well, but I&#39;m not exactly sure."}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "reply_to_user": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1565702858, "post_id": 57478063, "comment_id": 101429121, "body": "@charlietfl you&#39;re right, indeed, that&#39;s a bit too much. Let me edit that :)."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1565703566, "post_id": 57478063, "comment_id": 101429540, "body": "@briosheje it is returning an <code>Enumerator</code> in ruby. Which has access to the whole <code>Enumerable</code> interface. So not an <code>Iterator</code> js way, but not an <code>Array</code> either. I guess it really depends on the situation."}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1565704451, "post_id": 57478063, "comment_id": 101430080, "body": "@UlysseBN I think a ruby <code>Enumerator</code> is actually quite similar to a javascript iterator, they should be quite similar as far as I can tell, and they should be similar to python&#39;s iterators and generators"}], "tags": [], "owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "is_accepted": false, "score": 1, "last_activity_date": 1565702886, "last_edit_date": 1565702886, "creation_date": 1565700491, "answer_id": 57478063, "question_id": 57477912, "link": "https://stackoverflow.com/questions/57477912/equivalent-of-rubys-each-cons-in-javascript/57478063#57478063", "title": "Equivalent of Ruby&#39;s each_cons in JavaScript", "body": "<p>Here is a single line solution relying on function generators. Perhaps slightly different, but still worth to try out.</p>\n\n<p>I've also added to the prototype, not sure why you would do that, but still..</p>\n\n<p>This solution doesn't require ES6, it can be used with ES5 as well, with a bit of care for IE that doesn't support function generators at all.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function* eachCons(arr, num) {\r\n  for (let counter = 0; counter &lt;= arr.length - num; counter++) yield arr.slice(counter, counter + num);\r\n}\r\n\r\nArray.prototype.eachCons = function* (num) {\r\n  for (let counter = 0; counter &lt;= this.length - num; counter++) yield this.slice(counter, counter + num);\r\n}\r\n\r\nconst array = [0,1,2,3,4,5];\r\nconst log = data =&gt; console.log(JSON.stringify(data))\r\nlog([...eachCons(array, 2)]);\r\nlog([...eachCons(array, 3)]);\r\n\r\n// Iterable way\r\nfor (let [...pack] of eachCons(array, 2)) {\r\n  console.log('pack is', pack);\r\n}\r\n// Prototype...\r\nfor (let [...pack] of array.eachCons(2)) {\r\n  console.log('pack is', pack);\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "edited": false, "score": 1, "creation_date": 1565703037, "post_id": 57478560, "comment_id": 101429240, "body": "That [Symbol.iterator] over <code>Number</code> is definitely an interesting approach, I didn&#39;t know it would actually work."}, {"owner": {"reputation": 6538, "user_id": 2275797, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lg0K6.jpg?s=128&g=1", "display_name": "briosheje", "link": "https://stackoverflow.com/users/2275797/briosheje"}, "edited": false, "score": 0, "creation_date": 1565710465, "post_id": 57478560, "comment_id": 101433642, "body": "(just a side note, it should be <code>&lt;= this</code> in the Number iterator, since (0..5) actually is [0,1,2,3,4,5])."}], "tags": [], "owner": {"reputation": 319259, "user_id": 1447675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziYmO.gif?s=128&g=1", "display_name": "Nina Scholz", "link": "https://stackoverflow.com/users/1447675/nina-scholz"}, "is_accepted": false, "score": 2, "last_activity_date": 1565702162, "creation_date": 1565702162, "answer_id": 57478560, "question_id": 57477912, "link": "https://stackoverflow.com/questions/57477912/equivalent-of-rubys-each-cons-in-javascript/57478560#57478560", "title": "Equivalent of Ruby&#39;s each_cons in JavaScript", "body": "<p>You could take the length, build a new array and map the sliced array with <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from\" rel=\"nofollow noreferrer\"><code>Array.from</code></a> and the build in mapper.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Number.prototype[Symbol.iterator] = function* () {\r\n    for (var i = 0; i &lt; this; i++) yield i;\r\n};\r\n\r\nArray.prototype.eachCons = function (n) {\r\n    return Array.from({ length: this.length - n + 1}, (_, i) =&gt; this.slice(i, i + n));\r\n}\r\n\r\nconsole.log([...10].eachCons(2));\r\nconsole.log([...10].eachCons(3));</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.as-console-wrapper { max-height: 100% !important; top: 0; }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 1, "accepted_answer_id": 57477913, "answer_count": 3, "score": 2, "last_activity_date": 1565719845, "creation_date": 1565699990, "last_edit_date": 1565703385, "question_id": 57477912, "link": "https://stackoverflow.com/questions/57477912/equivalent-of-rubys-each-cons-in-javascript", "title": "Equivalent of Ruby&#39;s each_cons in JavaScript", "body": "<p>The question has been asked for many languages, yet not for javascript.</p>\n\n<p>Ruby has the method <a href=\"https://devdocs.io/ruby~2.5/enumerable#method-i-each_cons\" rel=\"nofollow noreferrer\"><code>Enumerable#each_cons</code></a> which look like that:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>puts (0..5).each_cons(2).to_a\n# [[0, 1], [1, 2], [2, 3], [3, 4], [4, 5]]\nputs (0..5).each_cons(3).to_a\n# [[1, 2, 3], [2, 3, 4], [3, 4, 5]]\n</code></pre>\n\n<p>How could I have a similar method in javascript for <code>Array</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "edited": false, "score": 0, "creation_date": 1565698957, "post_id": 57477587, "comment_id": 101427046, "body": "Post your models too. May be the issue is there"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1565699050, "post_id": 57477587, "comment_id": 101427106, "body": "What is the exact error message including the stack trace (find it in the log file)?"}, {"owner": {"reputation": 1056, "user_id": 272596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa6e65b91b46f3317c3d3e94e9255f2?s=128&d=identicon&r=PG", "display_name": "Gregory Witek", "link": "https://stackoverflow.com/users/272596/gregory-witek"}, "edited": false, "score": 2, "creation_date": 1565699098, "post_id": 57477587, "comment_id": 101427131, "body": "I think the problem is that you cannot just call <code>@users.businesses</code>, you would need to call <code>@users.map(&amp;:businesses)</code>. The reason is that <code>businesses</code> relation is for a single user, while you call this method on <code>@users</code> which represents a list"}], "answers": [{"tags": [], "owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "is_accepted": false, "score": 0, "last_activity_date": 1565699333, "creation_date": 1565699333, "answer_id": 57477756, "question_id": 57477587, "link": "https://stackoverflow.com/questions/57477587/how-to-access-certain-database-tables-in-rails-controller/57477756#57477756", "title": "How to access certain database tables in Rails controller?", "body": "<p>Can you try this? \nBecause of the <code>@user</code> is an array. so the error will occuring. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code># city.rb\r\nclass City &lt; ApplicationRecord\r\n  has_many :users\r\nend\r\n\r\n#user.rb\r\n\r\nclass User &lt; ApplicationRecord\r\n  belongs_to :invoice\r\n  has_many :businesses\r\nend\r\n\r\n#business.rb\r\n\r\nclass Business &lt; ApplicationRecord\r\n  belongs_to :user\r\nend\r\n\r\n\r\n# your controller\r\n\r\ndef get_business\r\n  @city = City.find(params[:id])\r\n  @business = @city.users.includes(:business)\r\n  render json: @business\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "is_accepted": false, "score": 0, "last_activity_date": 1565746227, "creation_date": 1565746227, "answer_id": 57487100, "question_id": 57477587, "link": "https://stackoverflow.com/questions/57477587/how-to-access-certain-database-tables-in-rails-controller/57487100#57487100", "title": "How to access certain database tables in Rails controller?", "body": "<p>Add a new relationship to your City model:\n<code>has_many businesses, through: users</code></p>\n\n<p>Then when you have a specific city you can get all businesses:\n<code>@city.businesses</code></p>\n"}, {"tags": [], "owner": {"reputation": 679, "user_id": 1391598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884f2cefcf98aa542f22a6870c8de9e2?s=128&d=identicon&r=PG", "display_name": "Yoav Epstein", "link": "https://stackoverflow.com/users/1391598/yoav-epstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1565767145, "creation_date": 1565767145, "answer_id": 57489877, "question_id": 57477587, "link": "https://stackoverflow.com/questions/57477587/how-to-access-certain-database-tables-in-rails-controller/57489877#57489877", "title": "How to access certain database tables in Rails controller?", "body": "<p>You might also want to try starting with the Business model to make the query.</p>\n\n<pre><code>Business.joins(user: :city).where(cities: { id: params[:city_id] })\n</code></pre>\n\n<p><code>joins</code> uses the association names</p>\n\n<p><code>where</code> uses the table names</p>\n"}], "owner": {"reputation": 1, "user_id": 11922279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd1ccbb79007903f570ceedcee875a1?s=128&d=identicon&r=PG&f=1", "display_name": "mattfast", "link": "https://stackoverflow.com/users/11922279/mattfast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1565767145, "creation_date": 1565698673, "question_id": 57477587, "link": "https://stackoverflow.com/questions/57477587/how-to-access-certain-database-tables-in-rails-controller", "title": "How to access certain database tables in Rails controller?", "body": "<p>I am using Rails as a JSON API. My database has the following structure: the City model has_many Users, which in turn has_many Businesses.</p>\n\n<p>When I send a GET request to businesses#index, I want Rails to return all the businesses in a given city, not just for a given user. What's the best way to do this?</p>\n\n<p>I've already tried the given code below as a first pass, which is returning an internal server error (500).</p>\n\n<pre><code>def index\n    @city = City.find(params[:city_id])\n\n    @users = @city.users\n    @businesses = @users.businesses\n\n    render json: @businesses\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin", "rails-i18n", "formtastic"], "comments": [{"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1565705546, "post_id": 57477358, "comment_id": 101430809, "body": "did you try restarting the app after changing the config"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1565707926, "post_id": 57477358, "comment_id": 101432214, "body": "yes...................."}, {"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1565726694, "post_id": 57477358, "comment_id": 101440473, "body": "can you run a pry session in your request response cycle(or rails console), and get the value of <code>Formtastic::FormBuilder.i18n_lookups_by_default</code> ? This is just to make sure if the value is not being set from somewhere else."}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565701919, "creation_date": 1565697757, "last_edit_date": 1565701919, "question_id": 57477358, "link": "https://stackoverflow.com/questions/57477358/how-to-disable-i18n-lookups-of-formtastic-in-activeadmin-rails", "title": "How to disable I18n lookups of Formtastic in activeadmin rails", "body": "<p>Using <strong>activeadmin</strong> in my app which by default uses <code>formtastic</code>, everything works</p>\n\n<p>But the issue I am facing is that in activeadmin page take too much time to load and when I see logs it query on translation table for every label ,helper,hint, placeholder etc</p>\n\n<p>Let say in edit form </p>\n\n<pre><code>f.input :place_id\n</code></pre>\n\n<p>then for this attribute there are 4 queries (I18n lookups)</p>\n\n<pre><code>SELECT COUNT(*) FROM `translations` WHERE `translations`.`locale` = 'en' AND (`key` IN ('formtastic.labels.used_car.edit.price') OR `key` LIKE 'formtastic.labels.used_car.edit.price.%')\n\nSELECT COUNT(*) FROM `translations` WHERE `translations`.`locale` = 'en' AND (`key` IN ('formtastic.labels.used_car.price') OR `key` LIKE 'formtastic.labels.used_car.price.%')\n\nSELECT COUNT(*) FROM `translations` WHERE `translations`.`locale` = 'en' AND (`key` IN ('helpers.label.used_car.edit.price') OR `key` LIKE 'helpers.label.used_car.edit.price.%')\n\nSELECT COUNT(*) FROM `translations` WHERE `translations`.`locale` = 'en' AND (`key` IN ('helpers.label.used_car.price') OR `key` LIKE 'helpers.label.used_car.price.%')\n</code></pre>\n\n<p>I want to remove all formtastic lookups so page load with speed.</p>\n\n<p>I tried <code>Formtastic::FormBuilder.i18n_lookups_by_default = false\n</code> but nothing happens</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "rubygems"], "comments": [{"owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 0, "creation_date": 1565698966, "post_id": 57477276, "comment_id": 101427051, "body": "Check config/database.yml there should be configuration of your database"}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "reply_to_user": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 0, "creation_date": 1565699146, "post_id": 57477276, "comment_id": 101427154, "body": "Hi @noname, the configuration in the <code>config&#47;database.yml</code> file uses <code>password</code> for the postgres user password. I&#39;m trying to change this password, but I have no idea how. When I change the password from the command line and within postgresql, the new password doesn&#39;t work when I try to check the database from within rails."}, {"owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 0, "creation_date": 1565699414, "post_id": 57477276, "comment_id": 101427299, "body": "so make sure that, your credentials in configurations and in database are the same. When you changing it for database you have to change for config as well, cause your rails app do not know how to login if you not change password for app."}, {"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "reply_to_user": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 0, "creation_date": 1565699514, "post_id": 57477276, "comment_id": 101427366, "body": "@noname that&#39;s exactly what I&#39;m doing. I&#39;m changing the password on both the CLI, the database, and the database.yml file, all matching. I&#39;m simply even trying changing the password to just <code>password1</code> just for testing and it still says authentication failed."}, {"owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 0, "creation_date": 1565699609, "post_id": 57477276, "comment_id": 101427409, "body": "In here you have answer <a href=\"https://stackoverflow.com/questions/18664074/getting-error-peer-authentication-failed-for-user-postgres-when-trying-to-ge\" title=\"getting error peer authentication failed for user postgres when trying to ge\">stackoverflow.com/questions/18664074/&hellip;</a>"}, {"owner": {"reputation": 553, "user_id": 4742218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0wBoIjPuArI/AAAAAAAAAAI/AAAAAAAAAF8/gmwCNq5bAX8/photo.jpg?sz=128", "display_name": "noname", "link": "https://stackoverflow.com/users/4742218/noname"}, "edited": false, "score": 1, "creation_date": 1565699762, "post_id": 57477276, "comment_id": 101427492, "body": "I am glad I could help."}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565697494, "creation_date": 1565697494, "question_id": 57477276, "link": "https://stackoverflow.com/questions/57477276/peer-authentication-failure-with-postgres-cant-figure-out-where-the-password", "title": "Peer authentication failure with postgres - can&#39;t figure out where the password is set", "body": "<p>I have tried to set the postgresql username from both the linux console as well as within Postgresql using the <code>\\password</code> command. However, in my rails database, the only password that is working is <code>password</code> and I'm not sure where this is set up.</p>\n\n<p>Prior to making this new server available on the Internet, I just wanted to change a working password to one that is more complicated. Not quite sure what's going on here though.</p>\n\n<p>Here's what happens when I run <code>rake db:migrate:status</code></p>\n\n<pre><code># rake db:migrate:status\nrake aborted!\nPG::ConnectionBad: FATAL:  Peer authentication failed for user \"postgres\"\n/usr/local/rvm/gems/ruby-2.5.1/gems/pg-1.1.4/lib/pg.rb:56:in `initialize'\n/usr/local/rvm/gems/ruby-2.5.1/gems/pg-1.1.4/lib/pg.rb:56:in `new'\n/usr/local/rvm/gems/ruby-2.5.1/gems/pg-1.1.4/lib/pg.rb:56:in `connect'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:692:in `connect'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:223:in `initialize'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `new'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `postgresql_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:811:in `new_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:855:in `checkout_new_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:834:in `try_to_checkout_new_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:795:in `acquire_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:523:in `checkout'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:1014:in `retrieve_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_handling.rb:118:in `retrieve_connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/connection_handling.rb:90:in `connection'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/schema_migration.rb:22:in `table_exists?'\n/usr/local/rvm/gems/ruby-2.5.1/gems/activerecord-5.2.3/lib/active_record/railties/databases.rake:124:in `block (3 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.5.1/gems/rake-12.3.3/exe/rake:27:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.5.1/bin/ruby_executable_hooks:24:in `eval'\n/usr/local/rvm/gems/ruby-2.5.1/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate:status\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Again, I have changed the password in postgresql as well from what I can see:</p>\n\n<pre><code># su postgres\npostgres@a17924e746f0:/$ psql\npsql (10.7 (Ubuntu 10.7-0ubuntu0.18.04.1))\nType \"help\" for help.\n\npostgres=# \\quit\npostgres@a17924e746f0:/$ psql postgres postgres\npsql (10.7 (Ubuntu 10.7-0ubuntu0.18.04.1))\nType \"help\" for help.\n\npostgres=# \\password\nEnter new password:\nEnter it again:\npostgres=# \\quit\n</code></pre>\n\n<p>and changed it from within Linux too:</p>\n\n<pre><code># passwd postgres\nEnter new UNIX password:\nRetype new UNIX password:\npasswd: password updated successfully\n</code></pre>\n\n<p>Any suggestions would be greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 2, "creation_date": 1565694352, "post_id": 57476432, "comment_id": 101424682, "body": "What is in <code>@xtandups</code>, looks like it is an Integer not an Array (or other Enumerable)"}, {"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1565694509, "post_id": 57476432, "comment_id": 101424785, "body": "@Kris Yes its some enumerable"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1565694568, "post_id": 57476432, "comment_id": 101424822, "body": "@bottles: no, it&#39;s not. Evidently."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1565694682, "post_id": 57476432, "comment_id": 101424887, "body": "Also, there&#39;s problem of square brackets, but you&#39;ll get to it later."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1565694918, "post_id": 57476432, "comment_id": 101425005, "body": "Do <code>@standups.inspect</code> to see what it is."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1565696453, "post_id": 57476432, "comment_id": 101425828, "body": "show us the code where you do &#180;@standups = xxx&#180;, also square brackets are wrong."}, {"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "edited": false, "score": 0, "creation_date": 1565696703, "post_id": 57476432, "comment_id": 101425941, "body": "@standups.inspect returned nil"}, {"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "edited": false, "score": 0, "creation_date": 1565698097, "post_id": 57476432, "comment_id": 101426618, "body": "@standups =  current_user.standups                    .includes(:dids, :todos, :   blockers)                    .references(:tasks).order(&#39;standup_date   DESC&#39;).page(1).total_pages"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "edited": false, "score": 0, "creation_date": 1565700968, "post_id": 57477495, "comment_id": 101428087, "body": "i can never thank you much.This did the magic. Thanks to everyone."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1565701142, "post_id": 57477495, "comment_id": 101428188, "body": "<code>each_slice</code> takes an argument e.g. <code>each_slice(3)</code> whereas <code>each_slice[3]</code> will raise an <code>ArgumentError</code>"}], "tags": [], "owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "is_accepted": true, "score": 1, "last_activity_date": 1565701221, "last_edit_date": 1565701221, "creation_date": 1565698334, "answer_id": 57477495, "question_id": 57476432, "link": "https://stackoverflow.com/questions/57476432/undefined-method-each-slice-for-0integer/57477495#57477495", "title": "undefined method `each_slice&#39; for 0:Integer", "body": "<p>In your controller you want to only to the query: <code>@standups = current_user.standups.includes(:dids, :todos, :blockers).references(:tasks).order('standup_date DESC')</code>.</p>\n\n<p>Currently you are doing the query, getting the result, and assigning the count of results to the @standups variable. This is causing the error.</p>\n\n<p>It looks like you are using the kaminari gem to do pagination. If so you can still do that by adding it to the query (I split out out into multiple lines to be a little more readable):</p>\n\n<pre><code>def index\n    ... # other code\n    @standups = current_user.standups\n    @standups = @standups.includes(:dids, :todos, :blockers).references(:tasks).order('standup_date DESC')\n    @standups = @standups.page params[:page] # kaminari pagination\nend\n</code></pre>\n\n<p>And in your view, you can show the total pages and your pagination: </p>\n\n<pre><code>content-header\n    h2 My Activity\n.content\n    div #{@standups.total_pages} Pages\n    - @standups.each_slice(3) do |standups|\n        .row\n            ... \n= paginate @standups\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "closed_date": 1565700678, "accepted_answer_id": 57477495, "answer_count": 1, "score": -5, "last_activity_date": 1565701221, "creation_date": 1565694295, "last_edit_date": 1565695937, "question_id": 57476432, "link": "https://stackoverflow.com/questions/57476432/undefined-method-each-slice-for-0integer", "closed_reason": "Not suitable for this site", "title": "undefined method `each_slice&#39; for 0:Integer", "body": "<p>Please i implemented a code in my view file and i am getting an error that i have no idea.</p>\n\n<blockquote>\n  <p>undefined method `each_slice' for 0:Integer</p>\n</blockquote>\n\n<p>And the error highlights this snippet</p>\n\n<pre><code>- @standups.each_slice[3] do |standups|\n</code></pre>\n\n<blockquote>\n  <p>the view</p>\n</blockquote>\n\n<pre><code>content-header\n  h2 My Activity\n.content\n  - @standups.each_slice[3] do |standups|\n    .row\n      - standups.each do |standup|\n       -cache standup do\n          .col-sm-4\n            .box.box-primary\n........\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ssl", "openssl", "hsm"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 11822923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PRb4R.jpg?s=128&g=1", "display_name": "Amin Khoshnood", "link": "https://stackoverflow.com/users/11822923/amin-khoshnood"}, "is_accepted": true, "score": 2, "last_activity_date": 1570961373, "creation_date": 1570961373, "answer_id": 58362555, "question_id": 57475901, "link": "https://stackoverflow.com/questions/57475901/how-to-use-cloudhsm-to-implement-mutual-tls-client-side-in-ruby/58362555#58362555", "title": "How to use CloudHSM to implement mutual TLS ( client side ) in Ruby", "body": "<p>To anyone who see this question later, here is a sample Ruby code works with Amazon CloudHSM:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'openssl'\nrequire 'base64'\n\nFAKE_KEY = \"/root/ruby/ruby_key_inside_hsm/ruby_hsm_fake_private.key\"\nREAL_KEY = \"/root/ruby/ruby_key_inside_hsm/ruby_hsm_real_private_exported.key\"\nPUB_KEY = \"/root/ruby/ruby_key_inside_hsm/pubkey.pem\"\n\nSTR = \"test string\"\n\ndef encrypt(str)\n  pubkey = OpenSSL::PKey::RSA.new(File.read(PUB_KEY))\n  Base64.encode64(pubkey.public_encrypt(str))\nend\n\ndef decrypt(str, key)\n  OpenSSL::Engine.load\n  privkey = OpenSSL::PKey::RSA.new(File.read(key))\n  privkey.private_decrypt(Base64.decode64(str))\nend\n\n\ndef estr\n  encrypt(STR)\nend\n\ndef real_dec\n  decrypt(estr, REAL_KEY)\nend\n\ndef hsm_dec\n  OpenSSL::Engine.load\n  OpenSSL::Engine.by_id('cloudhsm')\n  decrypt(estr, FAKE_KEY)\nend\n\n</code></pre>\n\n<p>Right now we are working on it to add it to the production environment.</p>\n"}], "owner": {"reputation": 81, "user_id": 11822923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PRb4R.jpg?s=128&g=1", "display_name": "Amin Khoshnood", "link": "https://stackoverflow.com/users/11822923/amin-khoshnood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 2, "accepted_answer_id": 58362555, "answer_count": 1, "score": 3, "last_activity_date": 1570961373, "creation_date": 1565692249, "last_edit_date": 1565694841, "question_id": 57475901, "link": "https://stackoverflow.com/questions/57475901/how-to-use-cloudhsm-to-implement-mutual-tls-client-side-in-ruby", "title": "How to use CloudHSM to implement mutual TLS ( client side ) in Ruby", "body": "<p>I'm asking this question after reading all of CloudHSM topics on StackOverflow, Cryptography, Information Security and CloudHSM forum but couldn't find anything helpful. Any idea or code snippet is helpful.</p>\n\n<p>We have a Ruby application that is requesting to a web server via X.509 certificates and we should generate/host private key inside CloudHSM.</p>\n\n<p>I followed <a href=\"https://docs.aws.amazon.com/cloudhsm/latest/userguide/introduction.html\" rel=\"nofollow noreferrer\">CloudHSM documentation</a> step by step and configured <a href=\"https://docs.aws.amazon.com/cloudhsm/latest/userguide/ssl-offload.html\" rel=\"nofollow noreferrer\">TLS offloading via NGINX and Apache HTTPD</a> to understand how it is working, now I'm working on mutual TLS with CloudHSM.</p>\n\n<p>My web server requires client certificate, I can validate that via cURL:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl --cert app-selfsigned.crt --key app-selfsigned.key  -k https://127.0.0.1/index.html\n</code></pre>\n\n<p>Also I can use this Ruby code to authenticate via certifications on disk:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'faraday'\nrequire 'openssl'\n\ndef ssl_options\n  cert_file = File.read \"app-selfsigned.crt\"\n  key_file = File.read \"app-selfsigned.key\"\n  ssl_options = {\n    verify: false,\n    client_cert: OpenSSL::X509::Certificate.new(cert_file),\n    client_key: OpenSSL::PKey::RSA.new(key_file)\n  }\nend\n\ndef connection\n  dest = \"https://127.0.0.1/\"\n  connection = Faraday::Connection.new(dest, ssl: ssl_options)\n  connection.get\nend\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>irb -I . -r rubytest.rb\nconnection\n</code></pre>\n\n<p>cURL and Ruby test via certification on disk:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PSti6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PSti6.png\" alt=\"Check this photo, cURL and Ruby test via certification on disk\"></a></p>\n\n<h2>I need to host <code>app-selfsigned.key</code> key inside the CloudHSM, how can I do that?</h2>\n\n<p>1) Can I do that via <a href=\"https://docs.aws.amazon.com/cloudhsm/latest/userguide/openssl-library.html\" rel=\"nofollow noreferrer\">CloudHSM OpenSSL Dynamic Engine</a>? if yes, even after cloudhsm engine installation(<code>/opt/cloudhsm/lib/libcloudhsm_openssl.so</code>), should I load and install engine every time in my code?</p>\n\n<p>2) Or should I use PKCS#11 via <code>p11-kit or pkcs11-openssl</code> packages and <code>p11tool</code> command or Ruby PKCS#11?</p>\n\n<p>3) Should I add anything related to <code>n3fips_password</code> inside my Ruby application?</p>\n\n<p>Here is Ruby code that I'm trying to use CloudHSM with it (I'm using FAKE PEM key instead of real private key to point to real private key with label <code>nginx-selfsigned_imported_key</code> inside CloudHSM):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'faraday'\nrequire 'openssl'\n\ndef initialize_openssl\n  key_label = \"nginx-selfsigned_imported_key\"\n  # OpenSSL Engine:\n  OpenSSL::Engine.load\n  e = OpenSSL::Engine.by_id('cloudhsm')\n  e.ctrl_cmd(\"SO_PATH\", \"/opt/cloudhsm/lib/libcloudhsm_openssl.so\")\n  e.ctrl_cmd(\"ID\", \"cloudhsm\")\n  e.ctrl_cmd(\"LOAD\")\n  e.load_private_key(\"CKA_LABEL=#{ key_label }\")\nend\n\ndef ssl_options\n  cert_file = File.read \"app-selfsigned.crt\"\n  key_file = File.read \"app-selfsigned_fake_PEM.key\"\n  {\n    verify: false,\n    client_cert: OpenSSL::X509::Certificate.new(cert_file),\n    client_key: OpenSSL::PKey::RSA.new(key_file)\n  }\nend\n\ndef connection\n  dest = \"https://127.0.0.1/\"\n  Faraday::Connection.new(dest, ssl: ssl_options)\nend\n\ndef connect\n  initialize_openssl\n  c = connection\n  c.get\nend\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>irb -I . -r rubytest_cloudhsm.rb\ninitialize_openssl\n</code></pre>\n\n<p>but I get this error:</p>\n\n<pre><code>OpenSSL::Engine::EngineError: invalid cmd name\nfrom /root/self-signed/app-selfsigned/rubytest_cloudhsm.rb:9:in `ctrl_cmd'\nfrom /root/self-signed/app-selfsigned/rubytest_cloudhsm.rb:9:in `initialize_openssl'\nfrom (irb):1\nfrom /bin/irb:12:in `&lt;main&gt;'\n</code></pre>\n\n<p>Adding them line by line:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Yfq1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Yfq1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Ruby error with CloudHSM:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nzhc8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nzhc8.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Debug logs</h3>\n\n<p>OpenSSL Dynamic Engine has been installed sucessfuly:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>export n3fips_password=&lt;Crypto User Username&gt;:&lt;CU Password&gt;\nopenssl engine -tt cloudhsm\n# (cloudhsm) CloudHSM hardware engine support\n#       SDK Version: 2.03\n# [ available ]\nopenssl engine -vvvv dynamic -pre SO_PATH:/opt/cloudhsm/lib/libcloudhsm_openssl.so -pre ID:cloudhsm -pre LOAD\n# (dynamic) Dynamic engine loading support\n# [Success]: SO_PATH:/opt/cloudhsm/lib/libcloudhsm_openssl.so\n# [Success]: ID:cloudhsm\n# [Success]: LOAD\n# Loaded: (cloudhsm) CloudHSM hardware engine support\nopenssl speed -engine cloudhsm\n# SDK Version: 2.03\n# engine \"cloudhsm\" set.\n# Doing md2 for 3s on 16 size blocks:\n# 557992 md2's in 2.99s\nopenssl version\n# OpenSSL 1.0.2k-fips  26 Jan 2017\nrpm -qa | grep -i openssl\n# openssl-1.0.2k-16.amzn2.1.1.x86_64\n# openssl-libs-1.0.2k-16.amzn2.1.1.x86_64\n</code></pre>\n\n<p>OpenSSL CloudHSM Dynamic Engine shared object is in the correct place:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ls -ltrha /usr/lib64/openssl/engines/libcloudhsm.so\nlrwxrwxrwx 1 root root 40 Aug  7 09:56 /usr/lib64/openssl/engines/libcloudhsm.so -&gt; /opt/cloudhsm/lib/libcloudhsm_openssl.so\n</code></pre>\n\n<p>libcloudhsm_openssl.so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R6ITS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R6ITS.png\" alt=\"enter image description here\"></a></p>\n\n<p>OS:</p>\n\n<pre><code>cat /etc/os-release\n# NAME=\"Amazon Linux\"\n# VERSION=\"2\"\n# ID=\"amzn\"\n# ID_LIKE=\"centos rhel fedora\"\n# VERSION_ID=\"2\"\n# PRETTY_NAME=\"Amazon Linux 2\"\n# ANSI_COLOR=\"0;33\"\n# CPE_NAME=\"cpe:2.3:o:amazon:amazon_linux:2\"\n# HOME_URL=\"https://amazonlinux.com/\"\nuname -a\n# Linux hsm.example.net 4.14.133-113.112.amzn2.x86_64 #1 SMP Tue Jul 30 18:29:50 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<pre><code>rpm -qa | grep -i cloudhsm-client\n# cloudhsm-client-2.0.3-3.el7.x86_64\n# cloudhsm-client-dyn-2.0.3-3.el6.x86_64\n</code></pre>\n\n<p>I can check private and public key with or without CloudHSM engines:</p>\n\n<pre><code>app-selfsigned.crt: Public Key\napp-selfsigned.key: Private key has been exported from CloudHSM \napp-selfsigned_fake_PEM.key: Fake private key pointing to real private key inside CloudHSM generated by getCaviumPrivKey -k 14 -out app-selfsigned_fake_PEM.key\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code># Test without CloudHSM:\nopenssl s_server -cert app-selfsigned.crt -key app-selfsigned.key\n# Using default temp DH parameters\n# ACCEPT\nopenssl s_server -cert app-selfsigned.crt -key app-selfsigned_fake_PEM.key\n# Using default temp DH parameters\n# ACCEPT\n\n\n# Test with CloudHSM engine\nopenssl s_server -cert app-selfsigned.crt -key app-selfsigned.key -engine cloudhsm\n# SDK Version: 2.03\n# engine \"cloudhsm\" set.\n# Using default temp DH parameters\n# ACCEPT\nopenssl s_server -cert app-selfsigned.crt -key app-selfsigned_fake_PEM.key -engine cloudhsm\n# SDK Version: 2.03\n# engine \"cloudhsm\" set.\n# Using default temp DH parameters\n# ACCEPT\n</code></pre>\n\n<h3>To make sure I'm requesting the correct key inside CloudHSM, I configured <code>app-selfsigned.crt</code> and <code>app-selfsigned_fake_PEM.key</code> for TLS offloading via NGINX:</h3>\n\n<p>/etc/nginx/nginx.conf:</p>\n\n<pre><code>ssl_engine cloudhsm;\nssl_certificate \"/etc/pki/nginx/app-selfsigned.crt\";\nssl_certificate_key \"/etc/pki/nginx/private/app-selfsigned_fake_PEM.key\";\n</code></pre>\n\n<pre><code>nginx -t\n# SDK Version: 2.03\n# nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\n# nginx: configuration file /etc/nginx/nginx.conf test is successful\nsystemctl start nginx &amp;&amp; systemctl status nginx\n# Aug 13 11:21:33 hsm.example.net nginx[13046]: SDK Version: 2.03\n</code></pre>\n\n<p>Check cert file via OpenSSL:</p>\n\n<pre><code>openssl x509 -in app-selfsigned.crt -text -noout\n# Serial Number: c7:c4:07:a6:78:22:2e:ff\n# Subject: C=AA, ST=AA, L=AA, O=AA, OU=AA, CN=a.com/emailAddress=a@a.com\n</code></pre>\n\n<p>Certificate check via Firefox:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dD8FH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dD8FH.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Checking private key inside CloudHSM via key_mgmt_util and cloudhsm_mgmt_util:</h3>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/opt/cloudhsm/bin/key_mgmt_util\nloginHSM -u CU -s CUADMIN -p CUPASSWORD\nfindSingleKey -k 14\n# Cfm3FindSingleKey returned: 0x00 : HSM Return: SUCCESS\ngetKeyInfo -k 14\n# Cfm3GetKey returned: 0x00 : HSM Return: SUCCESS\n# Owned by user: 6\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/opt/cloudhsm/bin/cloudhsm_mgmt_util /opt/cloudhsm/etc/cloudhsm_mgmt_util.cfg\nenable_e2e\nloginHSM CU CUADMIN CUPASSWORD\n\ngetAttribute 14 0\n# OBJ_ATTR_CLASS\n# 0x00000003\n# 3: Private key in a public\u2013private key pair. \ngetAttribute 14 2\n# OBJ_ATTR_PRIVATE\n# 0x00000001\n# 1: True. This attribute indicates whether unauthenticated users can list the attributes of the key. Since the CloudHSM PKCS#11 provider currently does not support public sessions, all keys (including public keys in a public-private key pair) have this attribute set to 1.\ngetAttribute 14 3\n# OBJ_ATTR_LABEL\n# nginx-selfsigned_imported_key\ngetAttribute 14 256\n# OBJ_ATTR_KEY_TYPE\n# 0x00000000\n# 0: RSA. \n</code></pre>\n\n<p>If you are using CloudHSM mutual TLS in another language please paste your code here so I can get the idea and implement it in Ruby.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1565794008, "post_id": 57475843, "comment_id": 101463757, "body": "Note that when installing gems with <a href=\"https://bundler.io\" rel=\"nofollow noreferrer\">bundler</a> no documentation is installed by default."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 19, "last_activity_date": 1589838916, "last_edit_date": 1589838916, "creation_date": 1565692051, "answer_id": 57475843, "question_id": 57475842, "link": "https://stackoverflow.com/questions/57475842/what-to-use-instead-of-no-ri-for-gem-install/57475843#57475843", "title": "What to use instead of --no-ri for gem install?", "body": "<p>The <a href=\"https://guides.rubygems.org/command-reference/#installupdate-options-2\" rel=\"noreferrer\">new option</a> is <code>--no-document</code> or <code>-N</code>.</p>\n\n<p>From <code>gem help install</code>:</p>\n\n<pre><code>  Deprecated Options:\n        --[no-]rdoc                  Generate RDoc for installed gems\n                                     Use --document instead\n        --[no-]ri                    Generate ri data for installed gems.\n                                     Use --document instead\n</code></pre>\n"}], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4753, "favorite_count": 1, "accepted_answer_id": 57475843, "answer_count": 1, "score": 10, "last_activity_date": 1589838916, "creation_date": 1565692051, "question_id": 57475842, "link": "https://stackoverflow.com/questions/57475842/what-to-use-instead-of-no-ri-for-gem-install", "title": "What to use instead of --no-ri for gem install?", "body": "<pre><code>gem update --system\ngem install xxxx --no-ri --no-rdoc\n</code></pre>\n\n<p>gives: <code>invalid option: --no-ri</code> and <code>invalid option: --no-rdoc</code>, what is the new command line option?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 392, "user_id": 9910110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTTsN.jpg?s=128&g=1", "display_name": "Sandra", "link": "https://stackoverflow.com/users/9910110/sandra"}, "edited": false, "score": 0, "creation_date": 1565698684, "post_id": 57475666, "comment_id": 101426900, "body": "why use <code>eq([order])</code> instead of <code>eq(order)</code>?"}, {"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1565705694, "post_id": 57475666, "comment_id": 101430900, "body": "Are you setting <code>@orders</code> variable in the controller?"}, {"owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "reply_to_user": {"reputation": 392, "user_id": 9910110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTTsN.jpg?s=128&g=1", "display_name": "Sandra", "link": "https://stackoverflow.com/users/9910110/sandra"}, "edited": false, "score": 0, "creation_date": 1565718627, "post_id": 57475666, "comment_id": 101437194, "body": "@Sandra results are same for both of them"}, {"owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "reply_to_user": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1565718649, "post_id": 57475666, "comment_id": 101437205, "body": "@bsvin33t yes i am setting."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565733336, "post_id": 57475666, "comment_id": 101442613, "body": "&quot;I don&#39;t understand why I get ActiveRecord::Relation [] instead of the order object&quot; - well, the answer is in your controller. You probably have something like <code>@orders = Order.all</code> there. That&#39;s a lazy query. It does not execute until you try to read from it, which you do not here. The easiest way to get past this error is to make the query eager: <code>Order.all.to_a</code>. This <i>will</i> give you an array."}], "answers": [{"comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565780370, "post_id": 57484229, "comment_id": 101456449, "body": "I have recollection of writing such code, but I haven&#39;t tested it. The examples on the relish have similar syntax - create an array and match it with a relation."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565780529, "post_id": 57484229, "comment_id": 101456532, "body": "Interesting. I don&#39;t think I ever tried it against a relation, but I have no reason not to trust the docs."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1565724704, "creation_date": 1565724704, "answer_id": 57484229, "question_id": 57475666, "link": "https://stackoverflow.com/questions/57475666/rspec-controller-test-expects-object-gots-activerecordrelation/57484229#57484229", "title": "Rspec controller test expects object gots ActiveRecord::Relation", "body": "<p>You can use <a href=\"https://relishapp.com/rspec/rspec-rails/v/3-8/docs/matchers/activerecord-relation-match-array\" rel=\"nofollow noreferrer\"><code>match_array</code></a> instead:</p>\n\n<pre><code>it \"assigns @orders\" do\n  order = Order.create(id:1)\n  get :index\n  expect(assigns(:orders)).to match_array([order])\nend\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565724729, "creation_date": 1565691365, "last_edit_date": 1565724729, "question_id": 57475666, "link": "https://stackoverflow.com/questions/57475666/rspec-controller-test-expects-object-gots-activerecordrelation", "title": "Rspec controller test expects object gots ActiveRecord::Relation", "body": "<p>I want to create a basic test for my controller using the example here: <a href=\"https://relishapp.com/rspec/rspec-rails/docs/controller-specs\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-rails/docs/controller-specs</a></p>\n\n<pre><code>describe \"GET index\" do\n    it \"assigns @orders\" do\n      order = Order.create(id:1)\n      get :index\n      expect(assigns(:orders)).to eq([order])\n    end\n  end\n</code></pre>\n\n<p>Result is :   </p>\n\n<p>Failure/Error: expect(assigns(:orders)).to eq([order])</p>\n\n<pre><code>   expected: [#&lt;Order id: 1, quantity: nil, company_id: nil, created_at: nil, updated_at: nil&gt;]\n        got: #&lt;ActiveRecord::Relation []&gt;\n</code></pre>\n\n<p>I don't understand why I get <code>ActiveRecord::Relation []</code> instead of the order object</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "edited": false, "score": 0, "creation_date": 1565700598, "post_id": 57475520, "comment_id": 101427910, "body": "Are you using the older assets pipeline (js files are in <code>app&#47;assets&#47;javascripts</code>) or the newer rails-6 webpack pipeline (files in <code>app&#47;javascript&#47;packs</code>)?"}, {"owner": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "reply_to_user": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "edited": false, "score": 0, "creation_date": 1565701308, "post_id": 57475520, "comment_id": 101428286, "body": "the older one app/assets/javascripts"}], "answers": [{"comments": [{"owner": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1565704557, "post_id": 57479230, "comment_id": 101430157, "body": "Ok, so excuse the question if it sound stupid, but I know next to nothing about javascript. So the first option, would entall downloading the files, adding them to my folders manually and then including them in the asset pipeline?"}, {"owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "reply_to_user": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1565706737, "post_id": 57479230, "comment_id": 101431575, "body": "That is correct. For Uppy specifically you can download the full package here: <a href=\"https://transloadit.edgly.net/releases/uppy/v1.3.0/uppy.min.js\" rel=\"nofollow noreferrer\">transloadit.edgly.net/releases/uppy/v1.3.0/uppy.min.js</a>. If you put that in <code>vendor&#47;assets&#47;javascipts&#47;uppy.js</code> you can add it to <code>application.js</code> with <code>&#47;&#47;= require uppy.js</code>. There are downsides to this such as larger file sizes that you can solve with more complex solutions like webpacker, but this will get you started."}, {"owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "reply_to_user": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1565706864, "post_id": 57479230, "comment_id": 101431649, "body": "Also, setting up a full featured, &quot;modern&quot; javascript environment can be very complicated. It absolutely does not sound stupid to have questions about how to go about it."}, {"owner": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1565709029, "post_id": 57479230, "comment_id": 101432896, "body": "Thanks a lot Jonathan, but one more question if I may. Any ideas if this link that you gave here has uppy-aws, and if not where can I download it separately? And thanks a lot again for the answer, ill try it and tell you :)"}, {"owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "reply_to_user": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1565711305, "post_id": 57479230, "comment_id": 101434074, "body": "It is included. You can access it via <code>Uppy.AwsS3</code>"}, {"owner": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1566193119, "post_id": 57479230, "comment_id": 101564288, "body": "Ok when I try to use smt such as const AwsS3 = require(&#39;@uppy/aws-s3&#39;) I&#39;m getting an error require not defined. Is there any alternative to this?  I mean I&#39;m using require in application.js well and good, but how can I set the variable AwsS3"}, {"owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "reply_to_user": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1566289090, "post_id": 57479230, "comment_id": 101599418, "body": "In your assets/javascript/application.js file, doing <code>&#47;&#47;= require &#39;whatever&#39;</code> is essentially copy/pasting the file inline. This is effectively the same as using a CDN, at which point you can access it via <code>Uppy.AwsS3</code>, just with the benefits of keeping your code under your control"}, {"owner": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "edited": false, "score": 0, "creation_date": 1566361523, "post_id": 57479230, "comment_id": 101627165, "body": "Thanks a lot Jonathan! :)"}], "tags": [], "owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "is_accepted": true, "score": 1, "last_activity_date": 1565704253, "creation_date": 1565704253, "answer_id": 57479230, "question_id": 57475520, "link": "https://stackoverflow.com/questions/57475520/using-javascript-plugins-in-ruby-on-rails-application/57479230#57479230", "title": "Using javascript plugins in Ruby on Rails application", "body": "<p>If you want to mimic the behaviour of the CDN, you can add javascript files to a <code>vendor/assets/javascripts</code> folder. You can then require the files manually in application.js:</p>\n\n<pre><code>//= require uppy-1.2.3.min.js\n//= require uppy-aws.js\n//= require uppy-stuff.js\n</code></pre>\n\n<p>This avoids NPM entirely.</p>\n\n<p>If you want to manage things via NPM, you would want to:</p>\n\n<ol>\n<li>run <code>npm init</code> in the root of the project</li>\n<li>add node_modules to your .git_ignore</li>\n<li>run <code>npm install --save PACKAGE_NAME</code> for all of your needed packages</li>\n<li>add <code>Rails.application.config.assets.paths &lt;&lt; Rails.root.join('node_modules')</code> to your application config, most likely in <code>app/config/initializers/assets.rb</code></li>\n<li>add the full path of required packages to application.js,ie <code>//= require @uppy/core/src/index.js</code></li>\n</ol>\n\n<p>This only work if the packages have a pre-built version packaged with the release. This is typically in a dist folder instead of a src folder</p>\n"}], "owner": {"reputation": 1368, "user_id": 3540782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/967473dab4dfed2eb086618cbd7bb3cb?s=128&d=identicon&r=PG&f=1", "display_name": "mrateb", "link": "https://stackoverflow.com/users/3540782/mrateb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 57479230, "answer_count": 1, "score": 0, "last_activity_date": 1565704253, "creation_date": 1565690785, "question_id": 57475520, "link": "https://stackoverflow.com/questions/57475520/using-javascript-plugins-in-ruby-on-rails-application", "title": "Using javascript plugins in Ruby on Rails application", "body": "<p>I'm trying to use Uppy plugin, a plugin for uploading images, in a Ruby on Rails application.</p>\n\n<p>The basic functionality works through CDN bundles, and I have no problem with that, this works fine. My problem happens when I need to use additional plugins by Uppy.</p>\n\n<p>Importing those is done through using, require. For example:</p>\n\n<pre><code>const AwsS3 = require('@uppy/aws-s3')\nconst ms = require('ms')\n</code></pre>\n\n<p>How can I include those in a Rails project?</p>\n\n<p>Answers to <a href=\"https://stackoverflow.com/questions/36602764/how-to-use-npm-packages-in-rails\">this</a> question suggest using <code>npm init</code> in a rails project, but this seems very radical. Is there an easier way to include a javascript library such as the one mentioned in a Rails project?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1565692207, "post_id": 57475356, "comment_id": 101423512, "body": "You can&#39;t put an <code>if</code> statement inside a translation; translations are just text substitutions. And I&#39;d highly discourage trying to be &quot;clever&quot; by doing anything like: <code>&quot;#{@user.persisted? ? t(&#39;.update&#39;) : t(&#39;.create_new&#39;)} #{t(&#39;.user&#39;)}&quot;</code> ... Anything like that will almost certainly fail in other languages, which have different grammar rules. Just keep it simple. Leave the <code>if</code> statement alone, and move the text, as-is, into a translation."}], "answers": [{"comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 4, "creation_date": 1565692272, "post_id": 57475602, "comment_id": 101423552, "body": "You don&#39;t need to add any gems for <code>I18n</code> in Rails"}], "tags": [], "owner": {"reputation": 188, "user_id": 7804994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592af0758de488f3d6f9ce5938dfc15b?s=128&d=identicon&r=PG&f=1", "display_name": "Hesham Youssef", "link": "https://stackoverflow.com/users/7804994/hesham-youssef"}, "is_accepted": false, "score": 3, "last_activity_date": 1565691078, "creation_date": 1565691078, "answer_id": 57475602, "question_id": 57475356, "link": "https://stackoverflow.com/questions/57475356/how-to-translate-conditional-statement-in-i18n/57475602#57475602", "title": "How to translate conditional statement in i18n", "body": "<p>Normally you should just add <code>t('.what_you_need_to_translate')</code>, so in your case it will be</p>\n\n<pre><code>h1 = @user.persisted? ? t('.update_user') : t('.create_new_user')\n</code></pre>\n\n<p>Of course that's taking into consideration that you have the <code>'rails-i18n'</code> gem and that the mentioned translations are existing in the correct files.</p>\n"}, {"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 2, "last_activity_date": 1565697651, "creation_date": 1565697651, "answer_id": 57477323, "question_id": 57475356, "link": "https://stackoverflow.com/questions/57475356/how-to-translate-conditional-statement-in-i18n/57477323#57477323", "title": "How to translate conditional statement in i18n", "body": "<p>I know Hesham already answered but you can also do in below way</p>\n\n<pre><code>@user.new_record? ? t('.update_user') : t('.create_new_user')\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 11753594, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lwKLLTUz2rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd64wEXeHHP4RgiX5HlrmI4dda6KQ/photo.jpg?sz=128", "display_name": "Shristina", "link": "https://stackoverflow.com/users/11753594/shristina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1379, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1565697651, "creation_date": 1565690251, "question_id": 57475356, "link": "https://stackoverflow.com/questions/57475356/how-to-translate-conditional-statement-in-i18n", "title": "How to translate conditional statement in i18n", "body": "<p>I'm having a hard time providing I18n support for the statement below. How do I provide i18n for 'Update User' and 'Create New User'?</p>\n\n<pre><code>h1 = @user.persisted? ? 'Update User' : 'Create New User'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "couchdb"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7973406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/61JBS.jpg?s=128&g=1", "display_name": "JohnMilo", "link": "https://stackoverflow.com/users/7973406/johnmilo"}, "edited": false, "score": 0, "creation_date": 1565695734, "post_id": 57475233, "comment_id": 101425439, "body": "I have refactored my code. I am using Ruby on Rails to create and update couchdb documents."}, {"owner": {"reputation": 2773, "user_id": 4432671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FJi5y.jpg?s=128&g=1", "display_name": "xpqz", "link": "https://stackoverflow.com/users/4432671/xpqz"}, "reply_to_user": {"reputation": 39, "user_id": 7973406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/61JBS.jpg?s=128&g=1", "display_name": "JohnMilo", "link": "https://stackoverflow.com/users/7973406/johnmilo"}, "edited": false, "score": 0, "creation_date": 1565696272, "post_id": 57475233, "comment_id": 101425720, "body": "If you rewite your question fundamentally, answers already given become much harder to read :). My advice would be to put Ruby aside for a bit, and get your CouchDB APIi queries working with curl first, from the command-line. In general, doing a PUT to create a new doc, will return the revision id in the response."}], "tags": [], "owner": {"reputation": 2773, "user_id": 4432671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FJi5y.jpg?s=128&g=1", "display_name": "xpqz", "link": "https://stackoverflow.com/users/4432671/xpqz"}, "is_accepted": false, "score": 0, "last_activity_date": 1565689830, "creation_date": 1565689830, "answer_id": 57475233, "question_id": 57473877, "link": "https://stackoverflow.com/questions/57473877/how-to-update-a-couchdb-document-with-ruby/57475233#57475233", "title": "How to update a couchdb document with Ruby", "body": "<p>It's not entirely clear to me from your code what you're trying to do, so I'll try to explain in general terms.</p>\n\n<p>In order to read a specific document revsion, you need to use the <code>rev=...</code> query parameter. This is probably not what you want. In your <code>get_couch_doc</code> you can't have a request body. It looks like you're trying to fetch a document based on specific data in the body -- for this you need to create a secondary index, known as a view in CouchDB.</p>\n\n<p>If you want to be able to query based on the <code>lanme</code> (maybe that should be <code>lname</code>?) field, you'd make a view where the map could look something like</p>\n\n<pre><code>function(doc) {\n  if (doc.lname) {\n    emit(doc.lname, null);\n  }\n}\n</code></pre>\n\n<p>If you want to <em>update</em> a document, you need to do a <code>PUT database/doc_id</code> with the <code>rev=....</code> query parameter on the URL.</p>\n\n<p>CouchDB <a href=\"https://docs.couchdb.org/en/stable/api/document/common.html\" rel=\"nofollow noreferrer\">docs</a> for the document API, and for <a href=\"https://docs.couchdb.org/en/stable/ddocs/views/index.html\" rel=\"nofollow noreferrer\">views</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 7973406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/61JBS.jpg?s=128&g=1", "display_name": "JohnMilo", "link": "https://stackoverflow.com/users/7973406/johnmilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565695617, "creation_date": 1565684745, "last_edit_date": 1565695617, "question_id": 57473877, "link": "https://stackoverflow.com/questions/57473877/how-to-update-a-couchdb-document-with-ruby", "title": "How to update a couchdb document with Ruby", "body": "<p>I have a Rails application with MYSQL backend. Upon saving data in MYSQL, it pushes some data to Couchdb using curl commands. However, I am unable to update that very same document. I dont know how query from couchdb and use _rev id to update. Here is how am creating and pushing a couchdb document.</p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\nrequire 'json'\n\ndef push_to_couchdb\n url = URI.parse(\"http://127.0.0.1:5984/m5fcash/100\")\n request = Net::HTTP::Put.new(url)\n request.body = JSON.dump({\n    \"fname\" =&gt; \"fname\",\n    \"lanme\" =&gt; \"lname\",\n    \"type\"  =&gt; \"demo\",\n    \"facility\"  =&gt; \"spectre\"\n})\nreq_options = {\n    use_ssl: url.scheme == \"https\",\n}\nresponse = Net::HTTP.start(url.hostname, url.port, req_options) do |http|\n  http.request(request)\nend\nend\n</code></pre>\n\n<p>This is how am trying to query the document and extract its _rev id</p>\n\n<pre><code>def get_couch_doc\n uri = URI.parse(\"http://127.0.0.1:5984/m5fcash/100\")\n response = Net::HTTP.get_response(uri)     \n raise response.inspect\nend\n</code></pre>\n\n<p>I expect <em>raise response.inspect</em> to gove a couchdb document from which I will exctract a _rev id. But all I get is <em>#.</em> How can I query a document in Ruby using curl??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authorization", "pundit"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565683363, "post_id": 57473245, "comment_id": 101419152, "body": "This sounds like a <a href=\"https://meta.stackexchange.com/a/66378/284887\">xy problem</a> to me. Can you please explain why you think that you need to pass the <code>session</code> to the model level? What is stored in that session an how does that relate to model authorization? What do you try to achieve?"}, {"owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565687624, "post_id": 57473245, "comment_id": 101421119, "body": "I need the parameters that are passed during that session request. I want to check if the current post is active and also if the admin sent a &quot; :status=&gt;&#39;inactivate&#39; &quot; request parameter. I don&#39;t want the admin to be allowed to re-active the post, after it has been deactivated, so if the post is inactive, and the admin again sends a :status =&gt; inactive request, i want to block that request"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565688025, "post_id": 57473245, "comment_id": 101421316, "body": "Should other roles be allowed to re-active? If not then why not just block it by checking the current model status? Or did you consider having dedicated controller routes and policies for this kind of status changes?"}, {"owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565688280, "post_id": 57473245, "comment_id": 101421440, "body": "Actually the Booking model has 4 states, such as active, cancel, checkin and checkout. Ani i don&#39;t want the admin to be able to active, or checking, or chekout the booking once, it has been canceled. And also once checkedin booking cannot be checked out or reactivated. There are some of the cases."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565689116, "post_id": 57473245, "comment_id": 101421902, "body": "That means you want admins to be allowed to update these booking but not to change the status attribute? Did you consider to use a gem like aasm or state_machine to define the states and just not to allow such backward status transitions?"}, {"owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565690288, "post_id": 57473245, "comment_id": 101422470, "body": "Yes i was thinking about using state_machines. But i wanted to solve it using Pundit, by sending in an extra parameter, that held the parameter of the request.   And then i would compare it in the policy, as in if the state of the model is already inactive, and the request param had a status =&gt; active in it, the request would be not carried out."}, {"owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1565690318, "post_id": 57473245, "comment_id": 101422483, "body": "And also thank you :)"}], "owner": {"reputation": 145, "user_id": 10546447, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BMNDe0IgPvo/AAAAAAAAAAI/AAAAAAAAAoo/hKDEMwI4ry0/photo.jpg?sz=128", "display_name": "Sheriff Hussain", "link": "https://stackoverflow.com/users/10546447/sheriff-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565682149, "creation_date": 1565682149, "question_id": 57473245, "link": "https://stackoverflow.com/questions/57473245/problem-with-adding-additional-context-in-pundit", "title": "Problem with adding Additional context in pundit", "body": "<p>I have a problem where i have to send a session object through the Authorize method in pundit, but the authorize method only supports two parameters, current_user and records</p>\n\n<p>Initially I created a new model named UserParam</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class UserParam &lt; ApplicationRecord\n  attr_reader :user, :session\n\n  def initialize(user,session)\n    @user = user\n    @session = session\n  end\nend\n</code></pre>\n\n<p>Then I permited Application Policy to accept UserParam as an attribute:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ApplicationPolicy\n  attr_reader :userParam, :user, :session, :record\n\n  def initialize(userParam, record)\n    @userParam = userParam\n    @record = record\n  end\n\n  delegate :user, to: :userParam\n  delegate :session, to: :userParam\n</code></pre>\n\n<p>Finally i overrode the user record used by pundit with an instance of UserParam class</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def pundit_user\n    UserParam.new(current_user,session)\nend\n\n</code></pre>\n\n<p>Then i called the authorize method as:</p>\n\n<p><code>authorize @booking</code></p>\n\n<p>After i run this code, i get error as: </p>\n\n<p><code>BookingsController put #update for Owner should let owner update the booking to checkin when booking is active\n     Failure/Error: UserParam.new(current_user,session)</code></p>\n\n<pre><code> ArgumentError:\n   wrong number of arguments (given 2, expected 0..1)`\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "edited": false, "score": 0, "creation_date": 1565678059, "post_id": 57472155, "comment_id": 101416828, "body": "Try <code>def render</code> to something else."}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1565691660, "post_id": 57472155, "comment_id": 101423222, "body": "You should just have a <code>before_action</code> to log this admin action, overriding Rails methods is rarely a good idea."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1565678270, "creation_date": 1565678270, "answer_id": 57472343, "question_id": 57472155, "link": "https://stackoverflow.com/questions/57472155/running-command-on-render-gives-wrong-number-of-arguments-given-1-expected-0/57472343#57472343", "title": "Running command on render gives wrong number of arguments (given 1, expected 0)", "body": "<p>You call <code>render :edit</code> in your <code>update</code> method. That means your overridden <code>render</code> needs to accept at least one argument, but <code>def render</code> does not.</p>\n\n<p>In your example, it probably makes sense that you just accept all arguments and pass them to the <code>super</code> call. That would lead your <code>render</code> method to not raise errors but <code>super</code> would if it is called with an incompatible number of arguments.</p>\n\n<pre><code>def render(*args)\n  record_current_admin_timestamp\n  super\nend\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6780066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c6ef08006356661fc28205728fe372?s=128&d=identicon&r=PG&f=1", "display_name": "Georgeheap", "link": "https://stackoverflow.com/users/6780066/georgeheap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 57472343, "answer_count": 1, "score": -1, "last_activity_date": 1565678270, "creation_date": 1565677357, "question_id": 57472155, "link": "https://stackoverflow.com/questions/57472155/running-command-on-render-gives-wrong-number-of-arguments-given-1-expected-0", "title": "Running command on render gives wrong number of arguments (given 1, expected 0)", "body": "<p>I am trying to run a command on render so have added the below code. It works most of the time except on a few pages I get the error: \n<code>wrong number of arguments (given 1, expected 0)</code></p>\n\n<p>This is the code it is failing on:</p>\n\n<pre><code>  def render\n    record_current_admin_timestamp\n    super\n  end\n</code></pre>\n\n<p>Pages that this seems to happen on are places like sign in forms and when forms fail submission. We are using unchanged devise for sign in and edit forms for admins and those are the main ones that seem to fail.</p>\n\n<p>Here is the code again that is where the issue is occurring. It stops at the beginning of render and doesn't even enter the method if I put a pry or raise in there. </p>\n\n<p>application_controller:</p>\n\n<pre><code>  def render\n    record_current_admin_timestamp\n    super\n  end\n\n  def record_current_admin_timestamp\n    PageVisit.create(admin: current_admin, url: request.url)\n  end\n</code></pre>\n\n<p>This is the type of code when it fails on the render edit. All my rspec tests that previously passed now fail when it hits the render :edit line.</p>\n\n<pre><code>def update\n   return not_found_redirect(projects_path) unless project\n\n   return redirect_success if project.update_attributes(params_project)\n\n   flash[:error] = record_not_saved\n   render :edit\n end\n</code></pre>\n\n<p>Any ideas would be appreciated as I am at a loss now. If you need any more info or code let me know.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "answers": [{"comments": [{"owner": {"reputation": 576, "user_id": 5330107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8cd3b27a1f25cc2e6e80cc0480782c?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Cui", "link": "https://stackoverflow.com/users/5330107/victor-cui"}, "edited": false, "score": 0, "creation_date": 1565679003, "post_id": 57472101, "comment_id": 101417219, "body": "thanks for the suggestion! I need the value of some of the input fields inside my |form|, how can I see those values inside <code>&#47;check_customer_status</code>?"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 576, "user_id": 5330107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8cd3b27a1f25cc2e6e80cc0480782c?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Cui", "link": "https://stackoverflow.com/users/5330107/victor-cui"}, "edited": false, "score": 0, "creation_date": 1565679335, "post_id": 57472101, "comment_id": 101417360, "body": "@VictorCui Sorry I don&#39;t get it, form_tag is another form and routes to different URL and button_to is routed to another URL if you need the value before clicking of form or anything like that can be handle by javascript/jquery."}, {"owner": {"reputation": 576, "user_id": 5330107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8cd3b27a1f25cc2e6e80cc0480782c?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Cui", "link": "https://stackoverflow.com/users/5330107/victor-cui"}, "edited": false, "score": 0, "creation_date": 1565680710, "post_id": 57472101, "comment_id": 101417972, "body": "I would read the form input values when I click the submit_button using javascript/jquery, but I need to make a backend call using the AWS SDK&#39;s for ruby when I click the <code>button_to</code>. Perhaps I can create an AJAX POST call that in turn passes the form input data to my Rails controller?"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1565677553, "last_edit_date": 1565677553, "creation_date": 1565677073, "answer_id": 57472101, "question_id": 57471840, "link": "https://stackoverflow.com/questions/57471840/match-button-click-to-new-rails-controller-method-inside-a-form-tag/57472101#57472101", "title": "Match button click to new rails controller method inside a form tag", "body": "<blockquote>\n  <p>I would like the action of clicking this button to route to a new\n  method via POST, say <code>limits#check_customer_status</code></p>\n</blockquote>\n\n<p>In order to do so, use <a href=\"https://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to\" rel=\"nofollow noreferrer\">button_to</a></p>\n\n<pre><code>= button_to \"Customer Status\", '/check_customer_status', :method =&gt; :post, :form_class =&gt; \"btn.btn-info\", id: \"customer-status\"\n</code></pre>\n\n<p>Note - Position of this button <code>(Customer Status)</code> on the page should be outside of <code>form_tag</code> scope, as <code>button_to</code> internally generates a form also, <code>form within a form</code> may not work.</p>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "is_accepted": false, "score": 0, "last_activity_date": 1565691154, "creation_date": 1565691154, "answer_id": 57475613, "question_id": 57471840, "link": "https://stackoverflow.com/questions/57471840/match-button-click-to-new-rails-controller-method-inside-a-form-tag/57475613#57475613", "title": "Match button click to new rails controller method inside a form tag", "body": "<p>According to me the best way may be to handle this in controller itself other then routes or from passing different url to form_for.</p>\n\n<pre><code>.form-group\n   =form_tag \"/set_limits\", {id: 'ec2-instance-limit-form'} do |form|\n        = submit_tag \"Increase Limits\", {class: \"btn btn-danger\", name: \"increase_limits\"}\n        = submit_tag \"Customer Status\", {class: \"btn btn-danger\", name: \"customer_suport\"}\n</code></pre>\n\n<p>Then in limits controller,</p>\n\n<pre><code>def handle_limit_request\n  if params[:increase_limits]\n    # Do stuff for first button submit\n  elsif params[:customer_suport]\n    your code for method \"check_customer_status\"\n    or \n    render check_customer_status\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 576, "user_id": 5330107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8cd3b27a1f25cc2e6e80cc0480782c?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Cui", "link": "https://stackoverflow.com/users/5330107/victor-cui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565691154, "creation_date": 1565675562, "question_id": 57471840, "link": "https://stackoverflow.com/questions/57471840/match-button-click-to-new-rails-controller-method-inside-a-form-tag", "title": "Match button click to new rails controller method inside a form tag", "body": "<p>I've got a <code>form_tag</code> and an existing submit_tag that maps to a rails controller method. My <code>.haml</code> code is shown below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> .form-group\n   =form_tag \"/set_limits\", {id: 'ec2-instance-limit-form'} do |form|\n        = submit_tag \"Increase Limits\", {class: \"btn btn-danger\"}\n</code></pre>\n\n<p>A snippet of my routes.rb file matching the url <code>/set_limits</code> to a method of a rails controller is shown below.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>match '/set_limits', to: 'limits#handle_limit_request', via: [:post]\n</code></pre>\n\n<p>I now added a button on the same page.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>%button.btn.btn-info(id=\"customer-status\" type=\"button\") Customer Status\n</code></pre>\n\n<p>However when I click this button the request still routes to the <code>handle_limit_request</code> method. I would like the action of clicking this button to route to a new method via POST, say <code>limits#check_customer_status</code>. How do I route the button click to a new controller method while ensuring that the action of clicking the <code>submit_tag</code> still routes to <code>limits#handle_limit_request</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1565676808, "post_id": 57471801, "comment_id": 101416315, "body": "if you have a model and a has_many association + has_many through instead of a has_and_belongs_to_many, then you can treat everything the same: duplicate+change foreign key."}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1565746855, "post_id": 57471801, "comment_id": 101445157, "body": "I have never been in the same situation of cloning records. But if the gem does not handle HABTM, just add a few lines of code to check the relationship and add manually the new records to your HABTM tables (as advised in the below answer)"}], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 3664194, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001800281383/picture?type=large", "display_name": "Michael Kosyk", "link": "https://stackoverflow.com/users/3664194/michael-kosyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1565676415, "creation_date": 1565676415, "answer_id": 57471966, "question_id": 57471801, "link": "https://stackoverflow.com/questions/57471801/rails-duplicate-record-some-associations-other-join-tables-only/57471966#57471966", "title": "Rails: duplicate record, some associations, other join tables only", "body": "<p>I think that you need to do it by hand. Create few services that would do the job. One for each relation.</p>\n"}], "owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565676415, "creation_date": 1565675362, "last_edit_date": 1565676201, "question_id": 57471801, "link": "https://stackoverflow.com/questions/57471801/rails-duplicate-record-some-associations-other-join-tables-only", "title": "Rails: duplicate record, some associations, other join tables only", "body": "<p>I've got a parent class with a lot of HABTM associations. I want to duplicate the parent class and its associations, alongside <em>only</em> the join tables for the HABTM associations so that <em>none</em> of those records themselves are duplicated.</p>\n\n<pre><code>class Brand &lt; ApplicationRecord\n  has_many :prices, autosave: true, dependent: :destroy\n\n  has_one :preference\n\n  has_and_belongs_to_many :introductions\n  has_and_belongs_to_many :components\n  has_and_belongs_to_many :covers\n  has_and_belongs_to_many :template_categories\nend\n</code></pre>\n\n<p>For example, it would clone all the original's <code>:prices</code>, its <code>:preference</code>, and only <em>references</em> to <code>:introductions</code>, <code>:components</code>, <code>:covers</code>, and <code>:template_categories</code>.</p>\n\n<p>First attempt was based on <a href=\"https://github.com/moiristo/deep_cloneable\" rel=\"nofollow noreferrer\">deep_cloneable</a>, but I can't address the join tables directly.</p>\n\n<pre><code>def duplicate\n  brand = deep_clone include: [\n    :prices, :preference,\n    :brands_introductions, # can't address join table\n    # ... etc\n  ]\n  brand.save!\nend\n</code></pre>\n\n<p>i.e., I want the cloned-brand to refer to the same introduction, component, etc as the original brand.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565668460, "post_id": 57470735, "comment_id": 101414229, "body": "Do you want to order by temperature, then by concentration? (If so, just sort the arrays <code>[t,c]</code>.) If not, and if the rows are already grouped by temperature (but the groups not necessarily ordered by temperature), do you only want to order the rows of each temperature group by concentration? Your question, incidentally, is very nicely laid out and written."}, {"owner": {"reputation": 235, "user_id": 11876193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8d60ef1c541d619b23743be3ba1e4?s=128&d=identicon&r=PG&f=1", "display_name": "YLim", "link": "https://stackoverflow.com/users/11876193/ylim"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1565670342, "post_id": 57470735, "comment_id": 101414625, "body": "Thank you! I would like to order the rows of each temperature group by concentration."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565670994, "post_id": 57470735, "comment_id": 101414776, "body": "Is this for a show view only? Where is each <code>form</code> defined by the time we get to the view you&#39;ve shown?  Is it a collection of <code>@forms</code> that is being looped over? That is probably where you want to do your ordering."}], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "is_accepted": true, "score": 1, "last_activity_date": 1565674740, "creation_date": 1565674740, "answer_id": 57471693, "question_id": 57470735, "link": "https://stackoverflow.com/questions/57470735/how-to-order-the-second-column-from-smallest-to-largest-if-the-first-column-is-e/57471693#57471693", "title": "How to order the second column from smallest to largest if the first column is equal rails", "body": "<p>In your outer partial you want to specify the sorting of the response forms. This can be done by ordering them and then passing them into the <code>fields_for</code>:</p>\n\n<pre><code>&lt;tbody&gt;\n    &lt;% sorted_fields = f.object.response_forms.left_join(:temperature, :concentration).order('temperatures.value', 'concentrations.value') %&gt;\n    &lt;%= form.fields_for :response_forms, sorted_fields do |f| %&gt;\n        &lt;%= render partial: 'fields', locals: {f: f} %&gt;\n    &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>If this ordering is something you will frequently use,  it would probably be worth moving into a scope in the <code>ResponseForm</code> model:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ResponseForm &lt; ApplicationModel\n\n    scope :tc_ordering, -&gt; { left_join(:temperature, :concentration).order('temperatures.value', 'concentrations.value') }\n\nend\n\n# in your partial:\n&lt;%= form.fields_for :response_forms, f.object.response_forms.tc_ordering do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 11876193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8d60ef1c541d619b23743be3ba1e4?s=128&d=identicon&r=PG&f=1", "display_name": "YLim", "link": "https://stackoverflow.com/users/11876193/ylim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57471693, "answer_count": 1, "score": 0, "last_activity_date": 1565674740, "creation_date": 1565666668, "question_id": 57470735, "link": "https://stackoverflow.com/questions/57470735/how-to-order-the-second-column-from-smallest-to-largest-if-the-first-column-is-e", "title": "How to order the second column from smallest to largest if the first column is equal rails", "body": "<p>I would like to display the concentrations in ascending order (smallest to largest) if the temperature is equalled.</p>\n\n<p>Here a table:</p>\n\n<p>| T | C |</p>\n\n<p>|     1        |      3       |</p>\n\n<p>|     1       |       2       |</p>\n\n<p>|     1        |      4       |</p>\n\n<p>Gas Analyte Model</p>\n\n<pre><code>class GasAnalyte &lt; ApplicationRecord\n    has_many :gas_groups\n    has_many :response_forms\nend\n</code></pre>\n\n<p>Gas Group Model</p>\n\n<pre><code>class GasGroup &lt; ApplicationRecord\n    belongs_to :gas_analyte\n    has_many :concentrations\n    has_many :temperatures\nend\n</code></pre>\n\n<p>Concentration Model</p>\n\n<pre><code>class Concentration &lt; ApplicationRecord\n    belongs_to :gas_group\n    has_many :response_forms\n    validates :value\nend\n</code></pre>\n\n<p>Temperature Model</p>\n\n<pre><code>class Temperature &lt; ApplicationRecord\n    belongs_to :gas_group\n    has_many :response_forms\n    validates :value\nend\n</code></pre>\n\n<p>ResponseForm Model</p>\n\n<pre><code>class ResponseForm &lt; ApplicationRecord\n    belongs_to :temperature\n    belongs_to :concentration\n    belongs_to :gas_analyte\n    belongs_to :gas_group\nend\n</code></pre>\n\n<p>View</p>\n\n<pre><code>&lt;tbody&gt;\n    &lt;%= form.fields_for :response_forms do |f| %&gt;\n        &lt;%= render partial: 'fields', locals: {f: f} %&gt;\n    &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>form is a gas analyte</p>\n\n<p>fields View</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;% res = ResponseForm.find(f.object.id) %&gt;\n    &lt;td&gt;&lt;%= Temperature.find(res.temperature.id).value %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= Concentration.find(res.concentration.id).value %&gt;&lt;/td&gt;\n&lt;tr&gt;\n</code></pre>\n\n<p>What could I do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cancan", "cancancan"], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "is_accepted": false, "score": 0, "last_activity_date": 1565671928, "last_edit_date": 1565671928, "creation_date": 1565666214, "answer_id": 57470693, "question_id": 57470388, "link": "https://stackoverflow.com/questions/57470388/cancancan-not-letting-right-users-create-update-or-delete-in-weird-ways/57470693#57470693", "title": "Cancancan not letting right users create, update, or delete -- in weird ways", "body": "<p>The solution was to replace:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>load_and_authorize_resource :post, through: :book\n</code></pre>\n\n<p>in the posts controller with:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>load_and_authorize_resource :post, through: :book, :shallow =&gt; true\n</code></pre>\n\n<p>because my nested routes for book and post (shown in my question) are shallow. </p>\n\n<p>But I can still see edit/delete on other users' posts... Any help would be appreciated. </p>\n\n<p>UPDATE:</p>\n\n<p>The solution for seeing edit/delete was to change </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;% if can? :update, Post %&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;% if can? :update, post %&gt;\n</code></pre>\n\n<p>because it is part of </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;% @book.posts.each do |post| %&gt;\n</code></pre>\n\n<p>Obvious, but should have matched the model going into can? with the model referred. </p>\n"}], "owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565671928, "creation_date": 1565663329, "question_id": 57470388, "link": "https://stackoverflow.com/questions/57470388/cancancan-not-letting-right-users-create-update-or-delete-in-weird-ways", "title": "Cancancan not letting right users create, update, or delete -- in weird ways", "body": "<p>I am using Devise and cancancan. I have Book model and Post model. After applying cancancan, in Book, limiting edit and delete to users matching user.id works fine. I can also create a book with no problem. Within each book, I can (or should be able to) create a post. Limiting edit and delete also works fine here. But when I create a post a a logged-in user who created the book for this post, it says I am not allowed to do so. </p>\n\n<p>When I get rid of \"load_and_\" below, I can create post, but so can other users who should not be able to. </p>\n\n<p>posts controller:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    load_and_authorize_resource :nested =&gt; :book\n</code></pre>\n\n<p>ability.rb (I initially had \"manage\" instead of CRUD, but in trying different things spelled out each of the CRUD; neither worked):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    if user.present?\n      can [:create, :read, :update, :destroy], Book, user_id: user.id\n      can :read, Book\n\n      can [:create, :read, :update, :destroy], Post, book: { user_id: user.id } \n      can :read, Post\n    end\n</code></pre>\n\n<p>routes.rb:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  resources :books do\n    resources :posts, shallow: true\n  end\n\n  resources :posts do\n    resources :comments, shallow: true\n  end\n\n  resources :users do\n    resources :comments, shallow: true \n  end\n</code></pre>\n\n<p>...since I'm asking a question, let me add another related one just in case someone feels like answering: </p>\n\n<p>I have the following code to show or not show edit/delete on a post. They seem to show no matter which user is looking at them. On Book list, they are hidden or shown well. Not sure why it's not working here. </p>\n\n<pre><code>    &lt;td&gt;\n        &lt;% if can? :update, Post %&gt;\n          &lt;%= link_to 'Edit', edit_post_path(post) %&gt;\n        &lt;% end %&gt;\n    &lt;/td&gt;\n    &lt;td&gt;\n        &lt;%if can? :destroy, Post %&gt;\n            &lt;%= link_to 'Destroy', {:controller =&gt; :posts,\n              :action =&gt; 'destroy', :id =&gt; post },\n              method: :delete,\n              data: { confirm: 'Are you sure?' } %&gt;\n        &lt;% end %&gt;\n    &lt;/td&gt;\n</code></pre>\n\n<p>UPDATE</p>\n\n<p>After I changed load_and_authorize_resource on posts controller to:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    load_and_authorize_resource :book\n    load_and_authorize_resource :post, through: :book\n</code></pre>\n\n<p>I can now create a post, with auth appropriately set. But now I can't edit or delete. </p>\n\n<p>...any ideas? </p>\n\n<p>The error message highlights: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>          raise AccessDenied.new(nil, authorization_action, resource_class) # maybe this should be a record not found error instead?\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 2, "creation_date": 1565666013, "post_id": 57469777, "comment_id": 101413802, "body": "You don&#39;t have a Companies table but your Company model inherits from ApplicationRecord? Can you explain why please?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565671645, "post_id": 57469777, "comment_id": 101414904, "body": "Can you update your question to include your actual model definitions?"}], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1565674633, "creation_date": 1565674633, "answer_id": 57471673, "question_id": 57469777, "link": "https://stackoverflow.com/questions/57469777/rails-active-record-find-record-from-inherited-table/57471673#57471673", "title": "rails active record find record from inherited table", "body": "<p>In my opinion, because when you call <code>all</code>, you are actually querying <code>find(:all)</code> from database. It will create a query to fetch records from tables which has the corresponding name to your model ( in this case you need table <code>companies</code> ). However, you don't have that <code>companies</code> table, you won't be able to make that query. </p>\n\n<p>The only way I can think about is to define a method to your <code>Company</code> class</p>\n\n<pre><code>class Company &lt; ApplicationRecord\n  def self.all\n    return Company::A.all + Company::B.all\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 314, "user_id": 6637390, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fDP1p.jpg?s=128&g=1", "display_name": "rail_engine", "link": "https://stackoverflow.com/users/6637390/rail-engine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1565674633, "creation_date": 1565656480, "last_edit_date": 1565657301, "question_id": 57469777, "link": "https://stackoverflow.com/questions/57469777/rails-active-record-find-record-from-inherited-table", "title": "rails active record find record from inherited table", "body": "<p>I have a table called Company &lt; ApplicationRecord and Company::A &lt; Company, Company::B &lt; Company, Company::C &lt; Company.</p>\n\n<p>How can I query all the companies like Company.all rather than queuing Company::A.all + Company::B.all </p>\n\n<p>Please note I don't have company table in DB its a model and not using STI </p>\n"}, {"tags": ["ruby", "sublimetext3", "multiline"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9921985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QQzbq.jpg?s=128&g=1", "display_name": "Leah", "link": "https://stackoverflow.com/users/9921985/leah"}, "edited": false, "score": 0, "creation_date": 1565707866, "post_id": 57470896, "comment_id": 101432189, "body": "I used the option to disable the particular snippet. This works perfectly. thank you!"}], "tags": [], "owner": {"reputation": 16941, "user_id": 814803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUo4b.png?s=128&g=1", "display_name": "OdatNurd", "link": "https://stackoverflow.com/users/814803/odatnurd"}, "is_accepted": false, "score": 2, "last_activity_date": 1565668261, "creation_date": 1565668261, "answer_id": 57470896, "question_id": 57469743, "link": "https://stackoverflow.com/questions/57469743/how-do-i-stop-unwanted-text-from-appearing-when-i-write-multi-line-comments-in-s/57470896#57470896", "title": "How do I stop unwanted text from appearing when I write multi-line comments in Sublime Text (Ruby)?", "body": "<p>The reason this happens is that the <code>Ruby</code> package that ships with Sublime includes a series of snippets and one of them inserts a <code>begin-rescue-end</code> block in response to the text <code>begin</code> followed by the autocomplete completion key. There are a couple of ways to stop this from happening that involve changing how the snippet is triggered or what the snippet contains.</p>\n\n<p>First, you can tweak the setting of <code>auto_complete_commit_on_tab</code>:</p>\n\n<pre><code>    // By default, auto complete will commit the current completion on enter.\n    // This setting can be used to make it complete on tab instead.\n    // Completing on tab is generally a superior option, as it removes\n    // ambiguity between committing the completion and inserting a newline.\n    \"auto_complete_commit_on_tab\": false,\n</code></pre>\n\n<p>As the comment describes, this setting controls whether <kbd>Enter</kbd> or <kbd>Tab</kbd> is used to select an autocomplete entry from the popup, with the default being <kbd>Enter</kbd>. </p>\n\n<p>From your problem description, you may be running with this setting set at the default; thus whenever you type <code>begin</code> the autocomplete entry for the snippet appears in the list, and pressing <kbd>Enter</kbd> selects the item and expands it.</p>\n\n<p>If that's the case, then flipping the value of the setting to <code>true</code> will stop this from happening; when you type <code>begin</code> the popup will still offer the snippet, but when you press <kbd>Enter</kbd> it will be interpreted as a \"normal\" enter, and the snippet won't expand. </p>\n\n<p>This also has the benefit that you can still utilize the snippet for it's intended purpose outside of comments to quickly set up a rescue block. Note however that if you make use of the autocomplete popup in other cases, this would require you to train your brain that you need to press <kbd>Tab</kbd> where you used to press <kbd>Enter</kbd>.</p>\n\n<p>Alternatively, you can disable the snippet or alter what it inserts to make your life a little better. To do that, you would select <code>Preferences: Browse Packages</code> from the command palette or the main menu to open the <code>Packages</code> folder.</p>\n\n<p>Inside of that folder, create a folder named <code>Ruby</code>, and then inside of that folder create a folder named <code>Snippets</code>, and inside of that folder a file named <code>Wrap-in-Begin-Rescue-End.sublime-snippet</code> (the case is important; the names should be exact for all of the files and folders here).</p>\n\n<p>If you create an empty file when you do this, then the snippet in the <code>Ruby</code> package will be complete disabled and can no longer be triggered.</p>\n\n<p>Alternately, you can instead give the file you create content that looks something like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;snippet&gt;\n    &lt;content&gt;&lt;![CDATA[\nbegin\n    $0\n=end\n]]&gt;&lt;/content&gt;\n    &lt;tabTrigger&gt;begin&lt;/tabTrigger&gt;\n    &lt;scope&gt;source.ruby - comment&lt;/scope&gt;\n    &lt;description&gt;complete block comment&lt;/description&gt;\n&lt;/snippet&gt;\n</code></pre>\n\n<p>That will make the text <code>begin</code> expand out to be the text in the snippet content area, which will add the text <code>begin</code> followed by the close of the block comment, and leave the cursor in the middle where the <code>$0</code> is located.</p>\n\n<p>You can alter that as needed, such as altering the indent or changing where the cursor is placed, etc.</p>\n"}], "owner": {"reputation": 11, "user_id": 9921985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QQzbq.jpg?s=128&g=1", "display_name": "Leah", "link": "https://stackoverflow.com/users/9921985/leah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565707148, "creation_date": 1565656084, "last_edit_date": 1565707148, "question_id": 57469743, "link": "https://stackoverflow.com/questions/57469743/how-do-i-stop-unwanted-text-from-appearing-when-i-write-multi-line-comments-in-s", "title": "How do I stop unwanted text from appearing when I write multi-line comments in Sublime Text (Ruby)?", "body": "<p>In Ruby multi-line comments are written with <code>=begin</code> and <code>=end</code>.</p>\n\n<p>When I type <code>=begin</code>, default text pops up after what I wrote regarding an error. Sublime Version 3.2.1. The automatic text that pops up is </p>\n\n<blockquote>\n  <p>rescue Exception => e</p>\n</blockquote>\n\n<p>referring to an exception in Ruby. I am looking to stop this text from appearing every time I create a multi-line comment.</p>\n\n<p>I have tried looking at the Sublime Text Preferences (version 3) and google searching for related questions, and I have reviewed Sublime documentation but I have not found anything that will help. There is a file for Ruby preferences on sublime text, but mine is empty so I am not sure what to add.</p>\n\n<pre><code>=begin\n\nrescue Exception =&gt; e\n\n=end\n</code></pre>\n"}, {"tags": ["ruby", "multithreading"], "answers": [{"comments": [{"owner": {"reputation": 765, "user_id": 233260, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/WS73l.jpg?s=128&g=1", "display_name": "sanpaco", "link": "https://stackoverflow.com/users/233260/sanpaco"}, "edited": false, "score": 0, "creation_date": 1565675480, "post_id": 57470971, "comment_id": 101415901, "body": "That makes a lot of sense. Thanks for your answer. I will try this tomorrow!"}, {"owner": {"reputation": 765, "user_id": 233260, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/WS73l.jpg?s=128&g=1", "display_name": "sanpaco", "link": "https://stackoverflow.com/users/233260/sanpaco"}, "edited": false, "score": 0, "creation_date": 1565719519, "post_id": 57470971, "comment_id": 101437594, "body": "Thank you again for the suggestion. Works perfectly! And the explanation helped me understand why it was failing in the first place."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1565669029, "creation_date": 1565669029, "answer_id": 57470971, "question_id": 57469705, "link": "https://stackoverflow.com/questions/57469705/simple-ruby-script-to-process-queue-using-multithreading-throws-deadlock-error/57470971#57470971", "title": "Simple ruby script to process queue using multithreading throws Deadlock error?", "body": "<p><code>Thread#join</code> waits till a thread exits. Your threads are all infinite loops, so your main thread's <code>join</code> would wait forever, waiting for threads to finish, and the threads would wait forever looking at the queue that will not produce any more.</p>\n\n<p>The easiest way to resolve this is for the producer to signal to the workers that no more elements would be forthcoming. For example, add this at the end of <code>Producer</code> (outside the loop):</p>\n\n<pre><code>queue &lt;&lt; nil\n</code></pre>\n\n<p>Add this after <code>row = queue.pop</code>:</p>\n\n<pre><code>queue &lt;&lt; nil and break unless row\n</code></pre>\n\n<p>The producer signals the end of data by queueing up a <code>nil</code>. The first consumer that finds <code>nil</code> will break out of its infinite loop, and exit the thread, allowing <code>.join</code> to happen, but not before it stuffs another <code>nil</code> into the queue, for the next thread to pop it. This is basically the foreman telling one worker the shift is over, then letting the news spread from neighbour to neighbour.</p>\n\n<p>(This is not the only solution; there are many ways to resolve this, when you know what the problem is.)</p>\n"}], "owner": {"reputation": 765, "user_id": 233260, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/WS73l.jpg?s=128&g=1", "display_name": "sanpaco", "link": "https://stackoverflow.com/users/233260/sanpaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57470971, "answer_count": 1, "score": 1, "last_activity_date": 1565669029, "creation_date": 1565655630, "question_id": 57469705, "link": "https://stackoverflow.com/questions/57469705/simple-ruby-script-to-process-queue-using-multithreading-throws-deadlock-error", "title": "Simple ruby script to process queue using multithreading throws Deadlock error?", "body": "<p>Before I summarize my question I want to say that I've already read all other questions regarding this error message and they all seem to apply to specific gems which I'm not working with. I'm kind of an intermediate Ruby scripter and I'm brand new to Threads so I'm having trouble understanding what this error even means let alone finding out how to fix it.</p>\n\n<p>My best guess is that the threads are being run faster than the producer can put them in the queue? But I tried to solve for that by adding a sleep interval on each set of 5 threads and it still runs into the error by the end of running.</p>\n\n<p>Here is what I'm trying to accomplish:\nI want to load a list of rows from a csv file into a queue, then process those rows from that queue using multithreading.</p>\n\n<p>Here is my code which is only printing values right now because I want to get the multithreading working properly before I attempt to actually do anything with the data.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'csv'\nrequire 'thread'\n\ncount = 0\nnum_threads = 5\nThread.abort_on_exception = true\n\nqueue = ::Queue.new\nproducer = ::Thread.new do\n    user_list = CSV.table(ARGV.first).map { |row| row.to_hash }\n    user_list.each do |row|\n        queue &lt;&lt; row\n    end\nend\n\nthreads = 1.upto(num_threads).map do\n    ::Thread.new do\n        loop do\n            row = queue.pop\n            puts \"#{row[:user_id]}\"\n            count += 1\n        end\n    end\nend\n\nproducer.join\nthreads.map(&amp;:join)\nputs \"#{count}\"\n</code></pre>\n\n<p>When I run the above code it appears to run all the threads and prints the values to the console, but then instead of printing the count it spits out the error:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>delete_threads.rb:32:in `join': No live threads left. Deadlock? (fatal)\n    from delete_threads.rb:32:in `map'\n    from delete_threads.rb:32:in `&lt;main&gt;'\n</code></pre>\n\n<p>Line 32 is <code>threads.map(&amp;:join)</code></p>\n\n<p>I don't understand what this error means and how do I fix it? I'm especially curious as to why it seems like all the threads are processing just fine and then this error only gets thrown at the end of everything running. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1565654485, "post_id": 57469568, "comment_id": 101411977, "body": "Your variable is a string, convert it to a number."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1565655371, "post_id": 57469568, "comment_id": 101412105, "body": "Try adding <code>positive_integer.class</code> after the chomp. That variable is a string, and not an Integer. Change the first line to <code>gets.chomp.to_i</code>"}, {"owner": {"reputation": 53, "user_id": 11919877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8a23b540e00ccda6f53f7e941a357f?s=128&d=identicon&r=PG&f=1", "display_name": "M_com", "link": "https://stackoverflow.com/users/11919877/m-com"}, "edited": false, "score": 0, "creation_date": 1565658415, "post_id": 57469568, "comment_id": 101412568, "body": "yes worked thank you so frigin much!"}], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 2, "creation_date": 1565696766, "post_id": 57471124, "comment_id": 101425969, "body": "Btw. you don&#39;t need to call <code>String#chomp</code> in this case."}], "tags": [], "owner": {"reputation": 702, "user_id": 2813483, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a806405fb6823e63f56544a44d1323b1?s=128&d=identicon&r=PG&f=1", "display_name": "tessie", "link": "https://stackoverflow.com/users/2813483/tessie"}, "is_accepted": false, "score": 4, "last_activity_date": 1565670577, "creation_date": 1565670577, "answer_id": 57471124, "question_id": 57469568, "link": "https://stackoverflow.com/questions/57469568/if-elsif-number-is-divisible-by-3/57471124#57471124", "title": "if/elsif number is divisible by 3", "body": "<p>your variable positive_integer is a string. convert it into integer by</p>\n\n<pre><code>  positive_integer = gets.chomp.to_i\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11919877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8a23b540e00ccda6f53f7e941a357f?s=128&d=identicon&r=PG&f=1", "display_name": "M_com", "link": "https://stackoverflow.com/users/11919877/m-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565670577, "creation_date": 1565654062, "last_edit_date": 1565654382, "question_id": 57469568, "link": "https://stackoverflow.com/questions/57469568/if-elsif-number-is-divisible-by-3", "title": "if/elsif number is divisible by 3", "body": "<p>I am asking the user to input a number and evaluate that number to see if it's divisible by 3. \nthis is my code </p>\n\n<pre><code>positive_integer = gets.chomp\nif positive_integer % 3 == 0\n  puts \"#{positive_integer} is divisible by 3\"\nelsif\n  puts \"#{positive_integer} is not divisible by 3\"\nend\n</code></pre>\n\n<p>But for some reason when I input 9, 30, or any number that IS divisible by three I get \"#{positive_integer} is not divisible by 3\" output. </p>\n\n<p>What am I doing wrong</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "carrierwave"], "comments": [{"owner": {"reputation": 24667, "user_id": 797303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DahZJ.jpg?s=128&g=1", "display_name": "Maxim Krizhanovsky", "link": "https://stackoverflow.com/users/797303/maxim-krizhanovsky"}, "edited": false, "score": 1, "creation_date": 1565688499, "post_id": 57469521, "comment_id": 101421547, "body": "Unless you <a href=\"https://stackoverflow.com/questions/11785094/carrierwave-rails-3-s3-save-the-file-size-to-the-database\">save the file size to the database</a>, there&#39;s no better option than going through records and summing the way you did"}], "answers": [{"comments": [{"owner": {"reputation": 24667, "user_id": 797303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DahZJ.jpg?s=128&g=1", "display_name": "Maxim Krizhanovsky", "link": "https://stackoverflow.com/users/797303/maxim-krizhanovsky"}, "edited": false, "score": 1, "creation_date": 1565688190, "post_id": 57469736, "comment_id": 101421392, "body": "No need to map.sum - sum also accepts a block. And to deal with nil, you can just convert it to number, which will give you 0, which won&#39;t affect the sum. So the code becomes <code>your_resource.file_attachments.sum { |fa| fa.attachment&amp;.size.to_f }</code>"}], "tags": [], "owner": {"reputation": 91, "user_id": 4117418, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000119083492/picture?type=large", "display_name": "Oskar Wr&#243;blewski", "link": "https://stackoverflow.com/users/4117418/oskar-wr%c3%b3blewski"}, "is_accepted": false, "score": 1, "last_activity_date": 1565655968, "creation_date": 1565655968, "answer_id": 57469736, "question_id": 57469521, "link": "https://stackoverflow.com/questions/57469521/how-do-i-get-the-sum-of-object-methods-in-a-rails-query/57469736#57469736", "title": "How do I get the sum of object methods in a Rails query?", "body": "<p>I am not sure if I understand your question. You would like to sum sizes of all attachments of some resource.. I am guessing that you would like to do something like: <code>your_resource.file_attachments.map{|fa| fa.attachment&amp;.size}.compact.sum</code></p>\n"}], "owner": {"reputation": 399, "user_id": 2351224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xvi2F.jpg?s=128&g=1", "display_name": "ianrandmckenzie", "link": "https://stackoverflow.com/users/2351224/ianrandmckenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565655968, "creation_date": 1565653545, "last_edit_date": 1565654660, "question_id": 57469521, "link": "https://stackoverflow.com/questions/57469521/how-do-i-get-the-sum-of-object-methods-in-a-rails-query", "title": "How do I get the sum of object methods in a Rails query?", "body": "<p>In my application, I am using CarrierWave for file attachments. I have a FileAttachment model and can get the file's size by doing:</p>\n\n<pre><code>file = FileAttachment.first\nfile.attachment.size\n</code></pre>\n\n<p>In a Rails query, you can sum columns by doing:</p>\n\n<pre><code>Model.sum(:integer_column)\n</code></pre>\n\n<p>With CarrierWave, the <code>.attachment</code> method returns on object with one of its values of <code>.size</code>.</p>\n\n<p>How can I do a <code>sum</code> query of <code>FileAttachment.attachment.size</code>?</p>\n\n<p>For now, this is my solution:</p>\n\n<pre><code>FileAttachment.sum { |file_attachment| file_attachment.attachment.size }\n</code></pre>\n\n<p>I'm wondering if there's a better way of doing this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "datetime"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565691859, "post_id": 57469149, "comment_id": 101423328, "body": "How are you setting the filter?  Is it some kind of date range picker on the front end?"}, {"owner": {"reputation": 11, "user_id": 11919715, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BGb6OxmYn_Y/AAAAAAAAAAI/AAAAAAAAAQg/FqhcMxX7o_o/photo.jpg?sz=128", "display_name": "Chaaartz", "link": "https://stackoverflow.com/users/11919715/chaaartz"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565704460, "post_id": 57469149, "comment_id": 101430088, "body": "Yes, the front-end is using a date range picker"}, {"owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "edited": false, "score": 0, "creation_date": 1566288778, "post_id": 57469149, "comment_id": 101599261, "body": "Did any of these solutions work for you or are you still running into problems? If there are more issues, you can edit you question to give us more context."}], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "is_accepted": false, "score": 0, "last_activity_date": 1565673439, "creation_date": 1565673439, "answer_id": 57471496, "question_id": 57469149, "link": "https://stackoverflow.com/questions/57469149/rails-and-postgres-problem-querying-record-that-was-stored-in-utc-app-timezone/57471496#57471496", "title": "Rails and Postgres problem querying record that was stored in UTC; app Timezone is UTC but record is not being found", "body": "<p>Unfortunately there isn't a simple way to ignore the timezone.</p>\n\n<p>If you are getting the users timezone on sign up you could add something like <code>Time.zone(current_user.timezone) if current_user</code> into a before action callback or some other initial startup sequence. The has the disadvantage of making the value mostly static, ie if they are traveling and are in a different timezone your results will still be for your \"home\" timezone unless you add that as an option in their profile etc.</p>\n\n<p>Alternatively you could set the current timezone dynamically using javascript:</p>\n\n<pre><code>window.addEventListener(\"submit\", function(event) { // listen to all submit events\n    var form = event.target.closest('form');\n    var timezoneInput = form.querySelector('input[name=timezone]');\n\n    if (timezoneInput) { \n            timezoneInput.value = moment.tz.guess(); // assuming you are using a time library\n    }  \n});\n</code></pre>\n\n<p>And handle that in your controller:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\ndef index\n    Time.use_zone(params[:timezone]) do\n        @records = Record.where(\"records.created_at BETWEEN ? AND ?\", date_filter.end_date.beginning_of_day, date_filter.end_date.end_of_day)\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "is_accepted": false, "score": 0, "last_activity_date": 1565676059, "creation_date": 1565676059, "answer_id": 57471913, "question_id": 57469149, "link": "https://stackoverflow.com/questions/57469149/rails-and-postgres-problem-querying-record-that-was-stored-in-utc-app-timezone/57471913#57471913", "title": "Rails and Postgres problem querying record that was stored in UTC; app Timezone is UTC but record is not being found", "body": "<p>For a database solution (which is commendable since you use <code>timestamp with time zone</code>), just set the <code>timezone</code> parameter for the database session to the current time zone of the user. Then everything should work as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": -1, "last_activity_date": 1565697820, "creation_date": 1565697820, "answer_id": 57477380, "question_id": 57469149, "link": "https://stackoverflow.com/questions/57469149/rails-and-postgres-problem-querying-record-that-was-stored-in-utc-app-timezone/57477380#57477380", "title": "Rails and Postgres problem querying record that was stored in UTC; app Timezone is UTC but record is not being found", "body": "<p>Whether or not you should store user's timezone in the DB depends on how often you will need to show times in a specific timezone.  Best practice is to set your application to use the time zone where <strong>most</strong> of your users are.  If you have not already, you probably want to set this application.rb for example:</p>\n\n<pre><code> config.time_zone = 'Eastern Time (US &amp; Canada)'\n</code></pre>\n\n<p>For complete list you can run <code>rake time:zones:all</code></p>\n\n<p>Now make sure you always use zone.  Anywhere in your application you will want to replace <code>Time.now</code> with <code>Time.zone.now</code>  and <code>Date.today</code> with <code>Date.current</code>  or better <code>Time.zone.now.to_date</code>.</p>\n\n<p>If in your case you just want to filter records timestamps (i.e. <code>created_at</code>) I'm guessing you use some kind of datetime picker on the front end in a form etc.  There is likely an option to add the users's browser's time offset.  Here's an example of using jQuery datetimepicker.  The additional format option is <code>O</code></p>\n\n<pre><code>$(function() {\n  $(\"#datetimepicker\").datetimepicker({\n      timepicker: true,\n      format: 'm/d/Y H:i O',\n      maxDate: '0'\n    });\n})\n</code></pre>\n\n<p>Now you will have the datetime with timezone offset value which you can use in your database query.  You'll be able to do something like this rough example.</p>\n\n<pre><code>start_time = Time.zone.parse(params[:start_time].to_s)\nend_time = Time.zone.parse(params[:end_time].to_s)\nRecord.where('created_at &gt; ? and created_at &lt; ?', start_time, end_time)\n</code></pre>\n\n<p>I would also recommend checking out this <a href=\"http://railscasts.com/episodes/106-time-zones-revised\" rel=\"nofollow noreferrer\">Railscast</a>, old but relevant.</p>\n"}], "owner": {"reputation": 11, "user_id": 11919715, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BGb6OxmYn_Y/AAAAAAAAAAI/AAAAAAAAAQg/FqhcMxX7o_o/photo.jpg?sz=128", "display_name": "Chaaartz", "link": "https://stackoverflow.com/users/11919715/chaaartz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1565697820, "creation_date": 1565650024, "question_id": 57469149, "link": "https://stackoverflow.com/questions/57469149/rails-and-postgres-problem-querying-record-that-was-stored-in-utc-app-timezone", "title": "Rails and Postgres problem querying record that was stored in UTC; app Timezone is UTC but record is not being found", "body": "<p>I have a Rails 5 app with default Timezone settings (UTC).\nI have a record that was created on <code>Thu, 08 Aug 2019 02:12:56 UTC +00:00</code> but the app is being accessed by someone located at Central Time which means the record was created for them on <code>Wed, 07 Aug 2019 20:12:56 CST -06:00</code>; The app provides a filter and this user is trying to retrieve records from <code>08/07/2019</code> and is expecting that this record would be part f the resulting set, date filter is being passed as a Date object. </p>\n\n<p>I have tried several forms to convert this Date object into a form that when passed down to the query it successfully returns the expected results. Note: <code>filter.end_date</code> is an instance of Date with value <code>\"Wed, 07 Aug 2019\"</code></p>\n\n<p>Query:</p>\n\n<p><code>Record.where(\"records.created_at BETWEEN ? AND ?\", filter.start_date.beginning_of_day, filter.end_date.end_of_day)</code></p>\n\n<p>SQL:</p>\n\n<pre><code>Record Load (4.2ms)  SELECT \"records\".* FROM \"records\" WHERE (records.created_at BETWEEN '2019-08-07 00:00:00' AND '2019-08-07 23:59:59.999999')\n</code></pre>\n\n<p>The only way that I have achieved this is when I set Timezone to central time and then pass the query:</p>\n\n<p>This is working</p>\n\n<pre><code>Time.use_zone(\"Central America\") { Record.where(\"records.created_at BETWEEN ? AND ?\", date_filter.end_date.beginning_of_day, date_filter.end_date.end_of_day) }\n</code></pre>\n\n<p>SQL:</p>\n\n<pre><code>Record Load (4.2ms)  SELECT \"records\".* FROM \"records\" WHERE (records.created_at BETWEEN '2019-08-07 06:00:00' AND '2019-08-08 05:59:59.999999')\n</code></pre>\n\n<p>I am wondering if there is a way to avoid the necessity to set a Timezone per user within the app and just do the correct conversion when passing down the date provided in the filter.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565651335, "post_id": 57469023, "comment_id": 101411494, "body": "<i>&quot;gives an error upon search&quot;</i> Can you provide the error message?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565651532, "post_id": 57469023, "comment_id": 101411531, "body": "@3limin4t0r added"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1565652101, "post_id": 57469368, "comment_id": 101411642, "body": "I&#39;m about tot try this but if it matters I am using Postgres"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1565652434, "post_id": 57469368, "comment_id": 101411693, "body": "@uno The database type shouldn&#39;t matter. I&#39;ve added the resulting generated SQL to better explain myself."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1565661139, "post_id": 57469368, "comment_id": 101413010, "body": "This seems to work only if a tracking_number is present.  For orders that don&#39;t yet have a tracking numbers, I search the address1, and the order doesn&#39;t result.  After I add tracking, i repeat and it will result under the address1 search.  Is there something making it happen this way?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1565683200, "post_id": 57469368, "comment_id": 101419085, "body": "@uno Use <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-left_joins\" rel=\"nofollow noreferrer\"><code>left_joins</code></a> instead of <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-joins\" rel=\"nofollow noreferrer\"><code>joins</code></a>."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 1, "last_activity_date": 1565652651, "last_edit_date": 1565652651, "creation_date": 1565652034, "answer_id": 57469368, "question_id": 57469023, "link": "https://stackoverflow.com/questions/57469023/searching-by-multiple-possible-attributes-for-one-search-field/57469368#57469368", "title": "Searching by multiple possible attributes for one search field", "body": "<p>Your <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-or\" rel=\"nofollow noreferrer\"><code>or</code></a> approach is a step in the right direction. The reason you get the error is because the structures are incompatible. Meaning that they should generate the same SQL <code>FROM</code> statement. Currently one query is joining <code>shipments</code> while the other is joining <code>shipping_address</code>.</p>\n\n<pre><code># statement #1 (tracking_number)\nFROM model INNER JOIN shipments ON ...\n\n# statement #2 (address1)\nFROM model INNER JOIN shipping_addresses ON ...\n</code></pre>\n\n<p>You should do the joins first. Both statements should have both joins to make them compatible.</p>\n\n<pre><code>scope = joins(:shipments).joins(:shipping_address)\ntracking_number = scope.where(shipments: { id: Shipment.where(shipping_label: ShippingLabel.where(tracking_number: \"#{search.downcase}\")) })\naddress1 = scope.where(shipping_addresses: { id: ShippingAddress.where(shipping_address_final: ShippingAddressFinal.where(address1: \"#{search.downcase}\")) })\ntracking_number.or(address1)\n</code></pre>\n\n<p>The only thing changed in the above statement is that both your queries now join both tables, making them compatible since they generate the same SQL <code>FROM</code> statement.</p>\n\n<p>Resulting in:</p>\n\n<pre><code># statement #1 (tracking_number)\nFROM model \n  INNER JOIN shipments ON ...\n  INNER JOIN shipping_addresses ON ...\n\n# statement #2 (address1)\nFROM model \n  INNER JOIN shipments ON ...\n  INNER JOIN shipping_addresses ON ...\n</code></pre>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57469368, "answer_count": 1, "score": 0, "last_activity_date": 1565652651, "creation_date": 1565648946, "last_edit_date": 1565651518, "question_id": 57469023, "link": "https://stackoverflow.com/questions/57469023/searching-by-multiple-possible-attributes-for-one-search-field", "title": "Searching by multiple possible attributes for one search field", "body": "<p>How can I have a search field that can search for multiple different attributess.  For example, be able to search for an associated models attribute and the self attribute in one search field?</p>\n\n<p>I want to allow the user to search by what they want to search by, as most websites have this feature...</p>\n\n<p><strong>I have:</strong></p>\n\n<p><strong>Model:</strong></p>\n\n<pre><code>  def self.user_search(search)\n    joins(:shipments).where(shipments: { id: Shipment.where(shipping_label: ShippingLabel.where(tracking_number: \"#{search.downcase}\")) })\n    joins(:shipping_address).where(shipping_addresses: { id: ShippingAddress.where(shipping_address_final: ShippingAddressFinal.where(address1: \"#{search.downcase}\")) })\n  end\n</code></pre>\n\n<p>This doesn't work.  each <code>joins</code> works on it's own, but together only the last one will ever work.  </p>\n\n<p>How can I combine these to work?</p>\n\n<p>Overall, I will be implementing many more possible search attributes but starting with just these 2 will lead me in the correct way.</p>\n\n<p>I have tried using <code>||</code></p>\n\n<p>This only allows the first <code>join</code> to work.</p>\n\n<p>Using:</p>\n\n<pre><code>def self.user_search(search)\n  tracking_number = joins(:shipments).where(shipments: { id: Shipment.where(shipping_label: ShippingLabel.where(tracking_number: \"#{search.downcase}\")) })\n  address1 = joins(:shipping_address).where(shipping_addresses: { id: ShippingAddress.where(shipping_address_final: ShippingAddressFinal.where(address1: \"#{search.downcase}\")) })\n  tracking_number.or(address1)\nend\n</code></pre>\n\n<p>gives an error upon search:</p>\n\n<p><code>ArgumentError (Relation passed to #or must be structurally compatible. Incompatible values: [:joins]):</code></p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1565665944, "post_id": 57469346, "comment_id": 101413785, "body": "Hi Cary. It works excellent. Very clean code and didactic solution. This time I understood almost all your code. I&#39;ll continue study your regex because the csv has other columns that I need to parse with similar format. The only thing I saw out of my knowledge was the assignment <code>(f,*,l)</code>. Additionally, if there is only one val1, val2 and date an extra <code>-</code> is added. I can remove it but which technique would you use to do that?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1565667485, "post_id": 57469346, "comment_id": 101414027, "body": "If there is just one triple, <code>val1, val2, (f,*,l) = a.transpose #=&gt; [[&quot;6845&quot;], [&quot;653&quot;], [&quot;2018-11-10 09:56:12&quot;]]</code>, with <code>f #=&gt;  &quot;2018-11-10 09:56:12&quot;</code> and <code>l #=&gt; nil</code>. Therefore, you could write <code>l.nil? ? f : &quot;%s - %s&quot; % [f,l]</code>. <code>(f,*,l)</code> is the same as <code>(f,*arr,l)</code>, where <code>*</code> and <code>*arr</code> gobble up all the date strings between the first and last, exclusive."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1565670663, "post_id": 57469346, "comment_id": 101414694, "body": "Thanks for the explanation. Very very useful. Thanks again Cary for you great and kind help!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1565659427, "last_edit_date": 1565659427, "creation_date": 1565651819, "answer_id": 57469346, "question_id": 57468646, "link": "https://stackoverflow.com/questions/57468646/how-to-sum-values-from-csv-file-with-ruby/57469346#57469346", "title": "How to sum values from csv file with Ruby", "body": "<p>The essence of this problem is extracting the desired information from the part of the string that follows <code>\"108,882,xyz, \"</code>, as opposed to how a CSV string is to be parsed, so I will confine my attention to the former.</p>\n\n<pre><code>r = /\n    Val1:\\{                      # match string\n    (\\d+)                        # match &gt; 0 digits in capture group 1 \n    \\}\\ +Val2:\\{                 # match string\n    (\\d+)                        # match &gt; 0 digits in capture group 2\n    \\}\\ +[^\\}]+\\}\\ +xTime:\\ +\\{  # match string\n    (.+?)                        # match &gt; 0 characters lazily in capture group 3\n    \\}                           # match string\n    /x                           # free-spacing regex definition mode\n</code></pre>\n\n<p>This regular expression is conventionally written as follows:</p>\n\n<pre><code>/Val1:\\{(\\d+)\\} +Val2:\\{(\\d+)\\} +[^\\}]+\\} +xTime: +\\{(.+?)\\}/\n</code></pre>\n\n<p>Notice that when using free-spacing mode space characters would be stripped out by the parser if they were not protected in some way. There are a few ways of protecting them. I have chosen to escape each space character. Free-spacing mode has the advantage that it makes the regular expression self-documenting.</p>\n\n<pre><code>a = str.scan(r)\n  #=&gt; [[\"6845\", \"653\", \"2018-11-10 09:56:12\"],\n  #    [ \"807\", \"153\", \"2018-11-10 09:59:05\"],\n  #    [ \"441\", \"875\", \"2018-11-10 10:13:12:22\"]]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>val1, val2, (f,*,l) = a.transpose\n  #=&gt; [[\"6845\", \"807\", \"441\"],\n  #    [ \"653\", \"153\", \"875\"],\n  #    [\"2018-11-10 09:56:12\", \"2018-11-10 09:59:05\", \"2018-11-10 10:13:12:22\"]]\nval1\n  #=&gt; [\"6845\", \"807\", \"441\"] \nval2\n  #=&gt; [\"653\", \"153\", \"875\"] \nf #=&gt; \"2018-11-10 09:56:12\" \nl #=&gt; \"2018-11-10 10:13:12:22\" \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def convert(arr)\n  arr.map(&amp;:to_i).sum\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>convert(val1)\n  #=&gt; 8093 \nconvert(val2)\n  #=&gt; 1681 \n\"%s - %s\" % [f,l]\n  #=&gt; \"2018-11-10 09:56:12 - 2018-11-10 10:13:12:22\"\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org//core-2.6.3/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a>.</p>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57469346, "answer_count": 1, "score": 1, "last_activity_date": 1565659427, "creation_date": 1565646421, "question_id": 57468646, "link": "https://stackoverflow.com/questions/57468646/how-to-sum-values-from-csv-file-with-ruby", "title": "How to sum values from csv file with Ruby", "body": "<p>I have a Csv file with several columns. The 4th Column has a format that I want to parse. String <code>str</code> below would be one line of the file:</p>\n\n<pre><code>str = \"108,882,xyz, { Abc:{-} Val1:{6845} Val2:{653} llsh:{0} xTime: {2018-11-10 09:56:12} Yub:{Rtv} Val1:{807} Val2:{153} llsh:{0} xTime: {2018-11-10 09:59:05}A Wbc:{57} Val1:{441} Val2:{875} llsh:{0} xTime: {2018-11-10 10:13:12:22}\"\n</code></pre>\n\n<p>For this 4th column I'd like to sum all Val1 and Val2 present within the string and show the first and last date as a new column. If Val1 and Val2 appear only once, then there is sum to do and output would be the values of Val1, Val2 and xTime.</p>\n\n<p>The output would be:</p>\n\n<pre><code>Col1, Col2, Col3, Val1,  Val2 , xTime\n108,  882,  xyz,  8093,  16821, 2018-11-10 09:56:12 - 2018-11-10 10:13:12:22\n</code></pre>\n\n<p>I'm trying with CSV.parse.</p>\n\n<pre><code>require 'csv'\n\nCSV.parse(str)\n\nFor 4th column do\n       //Parse\n</code></pre>\n\n<p>How can I do this in Ruby?</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 610, "user_id": 7438993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7hbh.jpg?s=128&g=1", "display_name": "Krupa Suthar", "link": "https://stackoverflow.com/users/7438993/krupa-suthar"}, "edited": false, "score": 0, "creation_date": 1565681271, "post_id": 57468613, "comment_id": 101418264, "body": "You might be getting store_order_id nil in this line self.class.find_by(store_order_id: store_order_id). have you checked?"}, {"owner": {"reputation": 24667, "user_id": 797303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DahZJ.jpg?s=128&g=1", "display_name": "Maxim Krizhanovsky", "link": "https://stackoverflow.com/users/797303/maxim-krizhanovsky"}, "edited": false, "score": 0, "creation_date": 1565688958, "post_id": 57468613, "comment_id": 101421821, "body": "Do you have methods <code>store_order_id</code> or <code>store_order_id=</code> defined?"}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1565701465, "post_id": 57468613, "comment_id": 101428372, "body": "Seems store_order_id is an attribute on the model."}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1565698455, "creation_date": 1565646222, "last_edit_date": 1565698455, "question_id": 57468613, "link": "https://stackoverflow.com/questions/57468613/infinite-loop-what-is-causing-this", "title": "Infinite Loop, what is causing this?", "body": "<p>In my Order model I have:</p>\n\n<pre><code>validates_uniqueness_of :store_order_id, on: :create\nbefore_validation :generate_id, on: :create if :manual_order?\n\n\ndef manual_order?\n  order_type == \"manual\"\nend\n\ndef generate_id\n  begin\n    self.store_order_id = \"M-#{(SecureRandom.random_number(9e5) + 1e5).to_i}\"\n  end while self.class.find_by(store_order_id: store_order_id)\nend\n</code></pre>\n\n<p>controller create method:</p>\n\n<pre><code> def create\n    @order = Order.new\n    @order.order_type = \"manual\"\n\n    respond_to do |format|\n      if @order.save!\n</code></pre>\n\n<p>For some reason, this is causing a loop of the <code>:generate_id</code></p>\n\n<p>What is causing this?</p>\n\n<p>I use similar code to generate a token for each order, the only difference is I don't use a <code>validates_uniquness_of</code> with it like i do for <code>:generate_id</code>.  But I don't see how this is causing this loop?</p>\n\n<p>I do need the <code>validates_uniqueness_of :store_order_id, on: :create</code> because it's also used for webhook id's in case the webhook fires twice, which is does on occasion .  I do this to avoid multiple identical records.  Because of this uniqueness validaton, when I create manual orders it won't save because the store_order_id needs to be unique.  So i created the <code>generate_id</code> method, but with issues.</p>\n\n<p>Assuming it was possible the uniquness was causing this, because there is no difference from code I have used many times, i tried:</p>\n\n<p><code>validates_uniqueness_of :store_order_id, on: :create unless :manual_order?</code></p>\n\n<p>but this didn't solve it.</p>\n"}, {"tags": ["ruby", "haml"], "answers": [{"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566509411, "creation_date": 1566509411, "answer_id": 57617289, "question_id": 57467431, "link": "https://stackoverflow.com/questions/57467431/haml-if-else-with-table-row/57617289#57617289", "title": "HAML if else with table row", "body": "<p>You need to use and compare a variable in your haml file / view which is defined in the controller.</p>\n\n<pre><code>- if @yourvariable == 0\n    %tr{:style =&gt; \"background-color: red\"}\n- else\n  ...\n</code></pre>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581308505, "creation_date": 1565639391, "last_edit_date": 1581308505, "question_id": 57467431, "link": "https://stackoverflow.com/questions/57467431/haml-if-else-with-table-row", "title": "HAML if else with table row", "body": "<p>I have the following code:</p>\n\n<pre><code>  - if 0\n    %tr{:style =&gt; \"background-color: red\"}\n  - else\n    %tr\n      %td.main= database_manager.db_old_name\n      %td= database_manager.db_type\n      %td= database_manager.server\n      %td= database_manager.instance\n      %td= database_manager.host\n      %td= database_manager.port\n      %td= database_manager.last_read.localtime.strftime('%a, %d %b %Y %H:%M:%S')\n      %td= database_manager.updated_at.localtime.strftime('%a, %d %b %Y %H:%M:%S')\n</code></pre>\n\n<p>which does not work. My intentions is to highlight the row if condition is 1 and not if 0.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 5, "creation_date": 1565638366, "post_id": 57467015, "comment_id": 101407631, "body": "<code>JSON.parse</code> seems to be what you&#39;re looking for"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1565639165, "post_id": 57467015, "comment_id": 101407936, "body": "That&#39;s a Ruby Hash being emitted raw instead of as a JSON object. Try <code>to_json</code> on it when rendering. <code>media_url</code> doesn&#39;t render, but something else does."}, {"owner": {"reputation": 73, "user_id": 10297349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfmHe.png?s=128&g=1", "display_name": "Jasterix", "link": "https://stackoverflow.com/users/10297349/jasterix"}, "edited": false, "score": 0, "creation_date": 1565639494, "post_id": 57467015, "comment_id": 101408059, "body": "I tried JSON.parse, got this kind of error:  JSON::ParserError (767: unexpected token at &#39;{&quot;screen_name&quot;=&gt;&quot;KimberlyNFoster&quot;, &quot;name&quot;=&gt;&quot;Kimberly Nicole Foster&quot;, &quot;id&quot;=&gt;142116606, &quot;id_str&quot;=&gt;&quot;142116606&quot;, &quot;indices&quot;=&gt;[0, 16]}&#39;)"}, {"owner": {"reputation": 73, "user_id": 10297349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfmHe.png?s=128&g=1", "display_name": "Jasterix", "link": "https://stackoverflow.com/users/10297349/jasterix"}, "edited": false, "score": 0, "creation_date": 1565639592, "post_id": 57467015, "comment_id": 101408102, "body": "to_json added more &quot;\\&quot;  =&gt; &quot;\\&quot;{\\\\\\&quot;screen_name\\\\\\&quot;=\\\\u003e\\\\\\&quot;KimberlyNFoster\\\\\\&quot;, \\\\\\&quot;name\\\\\\&quot;=\\\\u003e\\\\\\&quot;Kimberly Nicole Foster\\\\\\&quot;, \\\\\\&quot;id\\\\\\&quot;=\\\\u003e142116606, \\\\\\&quot;id_str\\\\\\&quot;=\\\\u003e\\\\\\&quot;142116606\\\\\\&quot;, \\\\\\&quot;indices\\\\\\&quot;=\\\\u003e[0, 16]}\\&quot;&quot;"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565642416, "post_id": 57467015, "comment_id": 101409106, "body": "How did you end up with that? The object at <code>h[:&quot;media&quot;][0]</code> is not valid json ( it looks like a <code>Hash</code> converted to a <code>String</code> via <code>to_s</code>) If you need to convert a <code>Hash</code> to JSON the method is <code>to_json</code> but you should explain how this is being generated in the first place or just use the <a href=\"https://github.com/sferik/twitter\" rel=\"nofollow noreferrer\"><code>twitter</code></a> gem and not worry as much about the implementation"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10297349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfmHe.png?s=128&g=1", "display_name": "Jasterix", "link": "https://stackoverflow.com/users/10297349/jasterix"}, "edited": false, "score": 0, "creation_date": 1565667344, "post_id": 57468012, "comment_id": 101413999, "body": "this worked perfectly! Thanks! I tried using gsub but trying to get rid of the &quot;\\\\&quot;. Yours is a much better usecase"}], "tags": [], "owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "is_accepted": true, "score": 3, "last_activity_date": 1565642612, "creation_date": 1565642612, "answer_id": 57468012, "question_id": 57467015, "link": "https://stackoverflow.com/questions/57467015/how-can-i-convert-a-string-in-my-json-file-into-a-ruby-hash/57468012#57468012", "title": "How can I convert a string in my JSON file into a Ruby hash?", "body": "<p>I think something like this would help:</p>\n\n<pre><code>def media_url\n  tweet = self.object\n  JSON.parse(tweet.media[0].gsub('=&gt;', ':'))[\"media_url\"]\nend\n</code></pre>\n\n<p>You need to replace <code>=&gt;</code> with <code>:</code> in order for <code>JSON.parse</code> to work</p>\n\n<p>Or</p>\n\n<p>To get the complete hash you can use a more generic method like <code>media</code>:</p>\n\n<pre><code>def media\n  tweet = self.object\n  JSON.parse(tweet.media[0].gsub('=&gt;', ':'))\nend\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10297349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfmHe.png?s=128&g=1", "display_name": "Jasterix", "link": "https://stackoverflow.com/users/10297349/jasterix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 57468012, "answer_count": 1, "score": 2, "last_activity_date": 1565643688, "creation_date": 1565637376, "last_edit_date": 1565640095, "question_id": 57467015, "link": "https://stackoverflow.com/questions/57467015/how-can-i-convert-a-string-in-my-json-file-into-a-ruby-hash", "title": "How can I convert a string in my JSON file into a Ruby hash?", "body": "<p>I'm working getting tweets from the Twitter API in my Rails backend. I'm able to create tweets in my db and then render the tweets as a JSON. But part of the tweet is still showing up as a string. How can I convert this specific part into a Ruby hash so that I can access the key:value pairs?</p>\n\n<ul>\n<li><p>I've tried .serializable_hash, .hash, to_json, but either the data type is wrong (needs to be an array) or it just adds more \\ characters</p></li>\n<li><p>.strip, .split, .gsub also didn't work</p></li>\n<li><p>when I puts the string, it looks like a hash, but I'm not able to save that output</p></li>\n</ul>\n\n<p>This is how the json is being rendered:</p>\n\n<pre><code>   \"media\": [\n      \"{\\\"id\\\"=&gt;1159941035461529600, \\\"id_str\\\"=&gt;\\\"1159941035461529600\\\", \\\"indices\\\"=&gt;[62, 85], \\\"media_url\\\"=&gt;\\\"http://pbs.twimg.com/media/EBjwOeMVUAAVOia.jpg\\\", \\\"media_url_https\\\"=&gt;\\\"https://pbs.twimg.com/media/EBjwOeMVUAAVOia.jpg\\\", \\\"url\\\"=&gt;\\\"https://t.asdco/mFwUSlGEpv\\\", \\\"display_url\\\"=&gt;\\\"pic.twitter.com/mFwUSlGEpv\\\", \\\"expanded_url\\\"=&gt;\\\"https://twitter.com/CommonBlackGirI/status/1159941046161170432/photo/1\\\", \\\"type\\\"=&gt;\\\"photo\\\", \\\"sizes\\\"=&gt;{\\\"thumb\\\"=&gt;{\\\"w\\\"=&gt;150, \\\"h\\\"=&gt;150, \\\"resize\\\"=&gt;\\\"crop\\\"}, \\\"medium\\\"=&gt;{\\\"w\\\"=&gt;1122, \\\"h\\\"=&gt;819, \\\"resize\\\"=&gt;\\\"fit\\\"}, \\\"large\\\"=&gt;{\\\"w\\\"=&gt;1122, \\\"h\\\"=&gt;819, \\\"resize\\\"=&gt;\\\"fit\\\"}, \\\"small\\\"=&gt;{\\\"w\\\"=&gt;680, \\\"h\\\"=&gt;496, \\\"resize\\\"=&gt;\\\"fit\\\"}}}\"\n    ]\n</code></pre>\n\n<p>I tried to create a method in the serializer file, but that didn't work because it's just string, not a traversable hash</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def media_url\n    tweet = self.object\n    tweet.media[0]\n  end\n</code></pre>\n\n<p>I'd like to convert the string above into a Ruby hash so that I can get the media_url for each tweet</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1565633869, "post_id": 57466195, "comment_id": 101405784, "body": "The first array is sort of pointless."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1565649303, "post_id": 57466195, "comment_id": 101411119, "body": "<code>(1..10).map { |n| 2*n-1 }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "edited": false, "score": 0, "creation_date": 1565634462, "post_id": 57466264, "comment_id": 101406061, "body": "Is there any way to subtract using this method? When I try doing <code>(20..3).step(-2).to_a</code>, I get an ArgumentError. Just using this problem as an abstraction for another problem I&#39;m having, and I&#39;d like to subtract as well as add from a range."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "reply_to_user": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "edited": false, "score": 1, "creation_date": 1565634685, "post_id": 57466264, "comment_id": 101406174, "body": "So in that case, if the limits are 20 and 3 you would want <code>[20, 18, 16, ...]</code>?"}, {"owner": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "edited": false, "score": 0, "creation_date": 1565634713, "post_id": 57466264, "comment_id": 101406181, "body": "Yes that&#39;d be great."}], "tags": [], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "is_accepted": true, "score": 6, "last_activity_date": 1565635169, "last_edit_date": 1565635169, "creation_date": 1565633836, "answer_id": 57466264, "question_id": 57466195, "link": "https://stackoverflow.com/questions/57466195/is-there-a-more-elegant-way-of-writing-a-while-loop-in-ruby-where-the-array-size/57466264#57466264", "title": "Is there a more elegant way of writing a while loop in Ruby where the array size is not known?", "body": "<p>Assuming your goal is to create an array of odd numbers up to a limit, you can use a range with a step. </p>\n\n<pre><code>limit = 20 \narray = (1..limit).step(2).to_a \n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you want to be able to descend as well as ascend you can use <code>step</code>. </p>\n\n<pre><code>#Ascending \nstart = 1 \nlimit = 20 \n\narray = start.step(limit, 2).to_a\n\n#Descending \nstart = 20 \nlimit = 1 \n\narray = start.step(limit, -2).to_a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1565644362, "creation_date": 1565644362, "answer_id": 57468317, "question_id": 57466195, "link": "https://stackoverflow.com/questions/57466195/is-there-a-more-elegant-way-of-writing-a-while-loop-in-ruby-where-the-array-size/57468317#57468317", "title": "Is there a more elegant way of writing a while loop in Ruby where the array size is not known?", "body": "<p>For the sake of having an alternative, you could also select (<a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-select\" rel=\"nofollow noreferrer\">Enumerable#select</a>) odds numbers (<a href=\"https://ruby-doc.org/core-2.6.3/Integer.html#method-i-odd-3F\" rel=\"nofollow noreferrer\">Integer#odds?</a>) out of your <a href=\"https://ruby-doc.org/core-2.6.3/Range.html\" rel=\"nofollow noreferrer\">Range</a>:</p>\n\n<pre><code>(1..20).select(&amp;:odd?)\n#=&gt; [1, 3, 5, 7, 9, 11, 13, 15, 17, 19]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1565644578, "last_edit_date": 1592644375, "creation_date": 1565644578, "answer_id": 57468348, "question_id": 57466195, "link": "https://stackoverflow.com/questions/57466195/is-there-a-more-elegant-way-of-writing-a-while-loop-in-ruby-where-the-array-size/57468348#57468348", "title": "Is there a more elegant way of writing a while loop in Ruby where the array size is not known?", "body": "<p>My answer is addressed to the question stated in the title, not to the particular example presenteed.</p>\n<p>Suppose the user is asked to enter a sequence of strings, with an empty string signifying that the user is finished. These strings are to be saved in an array which is to be returned.</p>\n<p>This is a typical way of writing the code using a <code>while</code> loop:</p>\n<pre><code>def gettem\n  arr = []\n  until (s = gets.chomp).empty? do\n    arr &lt;&lt; s\n  end\n  arr\nend\n</code></pre>\n<p>One could instead use <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-loop\" rel=\"nofollow noreferrer\">Kernel#loop</a> and the keyword <code>break</code>, which some (including me) prefer to <code>while</code> and <code>until</code> loops.</p>\n<pre><code>def gettem\n  arr = []\n  loop do\n    s = gets.chomp\n    break if s.empty?\n    arr &lt;&lt; s\n  end\n  arr\nend\n</code></pre>\n<p>A third way, suggested by @Aleksei Matiushkin in his answer <a href=\"https://stackoverflow.com/questions/57440279/show-a-string-of-certain-length-without-truncating/57444089#57444089\">here</a> (which I had not seen before) is the following:</p>\n<pre><code>def gettem\n  loop.with_object([]) do |_,arr|\n    s = gets.chomp\n    break arr if s.empty?\n    arr &lt;&lt; s\n  end\nend\n</code></pre>\n<p>This uses the form of <code>loop</code> that returns an enumerator (see the doc). If I run this and enter <code>&quot;dog&quot;</code>, <code>&quot;cat&quot;</code> and <code>&quot;\\n&quot;</code>, the return value is <code>[&quot;dog&quot;, &quot;cat&quot;]</code>, as desired.</p>\n<p>This approach has three of advantages over the other approaches:</p>\n<ul>\n<li>the variable <code>arr</code> is confined to the block, away from prying eyes;</li>\n<li>fewer lines of code are needed; and</li>\n<li>the return value can be chained, as illustrated below.</li>\n</ul>\n<h1><p></p></h1>\n<pre><code>def gettem\n  loop.with_object([]) do |_,arr|\n    s = gets.chomp\n    break arr if s.empty?\n    arr &lt;&lt; s\n  end.then { |arr| [arr.size, arr] }\nend\n</code></pre>\n<p>When executing this method and entering <code>&quot;dog&quot;</code>, <code>&quot;cat&quot;</code> and <code>&quot;\\n&quot;</code>, the array <code>[2, [&quot;dog&quot;, &quot;cat&quot;]]</code> is returned.</p>\n<p>I've used an underscore for the first block variable (which always has a value of <code>nil</code>) to signify that it is not used in the block calculation.</p>\n"}], "owner": {"reputation": 2157, "user_id": 6407868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5f5ea0c071e2a5adff7d131f58cc2011?s=128&d=identicon&r=PG&f=1", "display_name": "the12", "link": "https://stackoverflow.com/users/6407868/the12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 57466264, "answer_count": 3, "score": 0, "last_activity_date": 1565644578, "creation_date": 1565633551, "question_id": 57466195, "link": "https://stackoverflow.com/questions/57466195/is-there-a-more-elegant-way-of-writing-a-while-loop-in-ruby-where-the-array-size", "title": "Is there a more elegant way of writing a while loop in Ruby where the array size is not known?", "body": "<p>Using the following example:</p>\n\n<pre><code>array = [1,20]\n\nnew_array = []\ni = array[0]\n\n\nwhile i &lt; array[1]\n  new_array.push(i)\n  i+= 2\nend\n\n#new_array = [1,3,5,7,9,11,13,15,17,19]\n</code></pre>\n\n<p>Is there a more elegant way to write this loop without have to write an empty array (<code>new_array</code>) and an external variable loop counter (<code>i</code>)? I was thinking something along the lines of <code>new_array.map{|x| }</code> but instead of iterating through each element, it continually adds a number until it hits a certain limit. </p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": true, "score": 3, "last_activity_date": 1565632401, "creation_date": 1565632401, "answer_id": 57465952, "question_id": 57465951, "link": "https://stackoverflow.com/questions/57465951/why-truncate-when-we-had-to-pass-a-w-as-an-extra-parameter-to-open-in-ruby/57465952#57465952", "title": "Why truncate when we had to pass a &#39;w&#39; as an extra parameter to open in Ruby", "body": "<p>Firstly, using the <strong>'w'</strong> mode will tell Ruby to create a new file with the name you give to it, or it will completely overwrite any file that already has that name. This means it will replace everything in the existing file with whatever text that you give it.</p>\n\n<p>While you can also overwrite the contents of a file using the <strong>truncate()</strong> method, with <strong>truncate()</strong>, you can declare how much of the file you want to remove, based on where you're currently at in the file. Without parameters (<code>truncate()</code>) or with a parameter of 0 (<code>truncate(0)</code>), <strong>truncate()</strong> acts like <strong>'w'</strong>, whereas <strong>'w'</strong> always just wipes the whole file clean, <strong>truncate()</strong> helps you specify how much content of the file that you want to wipe.</p>\n\n<p>So this line of code<code>target = open(filename, 'w')</code>, reads the file with the name <code>filename</code> and writes to it as well (it completely wipes the contents of this file). Also, the line <code>target.truncate(0)</code> also wipes the contents of this file with the filename <code>filename</code>.</p>\n\n<p>In order words, the both methods <strong>'w'</strong> and <strong>truncate()</strong> are doing the same operation of wiping the whole contents of the file. But <strong>Zed Shaw</strong> intuitively used the both of them in the exercise, and asked that research be conducted about why he used the both of them the same time, so that one can understand how the both methods are used, and that both of the methods perform similar operations.</p>\n\n<p>Just to add as a form of extra knowledge, using the <strong>'a'</strong> mode will still tell Ruby to create a new file with the name you give to it if that file doesn't exist already. But unlike the <strong>'w'</strong> mode, if that file does exist, Ruby will start writing at the end of the file, so that you won't lose anything that's already there.</p>\n\n<p>That's all.</p>\n\n<p><strong>I hope this helps</strong></p>\n"}], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 57465952, "answer_count": 1, "score": 1, "last_activity_date": 1565632738, "creation_date": 1565632401, "last_edit_date": 1565632738, "question_id": 57465951, "link": "https://stackoverflow.com/questions/57465951/why-truncate-when-we-had-to-pass-a-w-as-an-extra-parameter-to-open-in-ruby", "title": "Why truncate when we had to pass a &#39;w&#39; as an extra parameter to open in Ruby", "body": "<p>I am learning Ruby using the book <strong>Learn Ruby the Hard Way</strong> by Zed Shaw. I am stuck at <strong>Exercise 16: Reading and Writing Files</strong>, because I don't understand why we had to pass a <strong>'w'</strong> as an extra parameter to <strong>open</strong> in Ruby and also called the <strong>truncate</strong> method later on the same file.</p>\n\n<p><strong>Here's the code sample</strong></p>\n\n<pre><code>puts \"Opening the file...\"\ntarget = open(filename, 'w')\n\nputs \"Truncating the file.  Goodbye!\"\ntarget.truncate(0)\n</code></pre>\n\n<p>Any form of help will be highly appreciated.</p>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 1376, "user_id": 427117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c91d05b02cc6a43fadcbe417b66bceb4?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/427117/roland"}, "is_accepted": false, "score": 1, "last_activity_date": 1565634156, "creation_date": 1565634156, "answer_id": 57466336, "question_id": 57464706, "link": "https://stackoverflow.com/questions/57464706/continue-on-mixlibshelloutcommandtimeout/57466336#57466336", "title": "Continue on Mixlib::ShellOut::CommandTimeout", "body": "<p>If the outcome of the first <code>execute</code> command doesn't really matter, you could lower the timeout and use the <a href=\"https://docs.chef.io/resource_common.html\" rel=\"nofollow noreferrer\"><code>ignore_failure</code></a> common property.</p>\n\n<p>Maybe there's also a way using windows' <code>START /B &lt;program&gt;</code> command without having to wait for a timeout.</p>\n"}], "owner": {"reputation": 16131, "user_id": 1985032, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/66248ce349dee952883fa5ff02972cef?s=128&d=identicon&r=PG", "display_name": "abc123", "link": "https://stackoverflow.com/users/1985032/abc123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565634156, "creation_date": 1565626469, "question_id": 57464706, "link": "https://stackoverflow.com/questions/57464706/continue-on-mixlibshelloutcommandtimeout", "title": "Continue on Mixlib::ShellOut::CommandTimeout", "body": "<p>how can i catch/rescue from a Mixlib::ShellOut::CommandTimeout? </p>\n\n<p>Basically I am running a command that opens a process and never returns, i want to just close the process that opens and move on with my chef recipe as it not returning doesn't really matter...</p>\n\n<hr>\n\n<p><strong>Here is the code for my attempt:</strong></p>\n\n<pre><code>begin\n    execute 'install_visual_studio_settings' do\n        command \"\\\"#{node.run_state['installed_path']}\\\\devenv.exe\\\" /ResetSettings #{node.run_state['tmp_dir']}\\\\XXXX.vssettings\"\n        timeout 80\n    end\nrescue Mixlib::ShellOut::CommandTimeout\n    execute 'kill visual studio' do\n        command \"taskkill /IM \\\"devenv.exe\\\" /F\"\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "dsl", "mail-gem"], "answers": [{"comments": [{"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1565685782, "post_id": 57464855, "comment_id": 101420315, "body": "Oh, this is what I was afraid of ) thank you for investigation! Do you recommend another library?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 0, "creation_date": 1565690503, "post_id": 57464855, "comment_id": 101422587, "body": "I have no idea. I am not a big fan of using 3rd party hems, they always have glitches. BTW, what would be wrong with the workaround I proposed? You might dig in, or even fork and modify it to support multiple retrievers; it should not be complicated or time-consuming. Simply replicate functionality it has for deliveries\u2014and voila\u0300."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1565627037, "creation_date": 1565627037, "answer_id": 57464855, "question_id": 57464594, "link": "https://stackoverflow.com/questions/57464594/how-do-i-set-retriever-method-not-in-defaults/57464855#57464855", "title": "How do I set retriever_method not in defaults?", "body": "<p>FYI: this gem is OSS.</p>\n\n<p><code>Mail#delivery_method</code> is technically an alias to <a href=\"https://github.com/mikel/mail/blob/6bc16b4bce4fe280b19523c939b14a30e32a8ba4/lib/mail/mail.rb#L103-L105\" rel=\"nofollow noreferrer\"><code>Configuration.instance.delivery_method</code></a>.</p>\n\n<p><code>Mail#retriever_method</code> in turn redirects to <code>Configuration.instance.retriever_method</code>.</p>\n\n<p>Unlike <code>Mail::deliver</code>, that <a href=\"https://github.com/mikel/mail/blob/6bc16b4bce4fe280b19523c939b14a30e32a8ba4/lib/mail/mail.rb#L131-L135\" rel=\"nofollow noreferrer\">creates a new instance</a>, <code>Mail::last</code> <a href=\"https://github.com/mikel/mail/blob/6bc16b4bce4fe280b19523c939b14a30e32a8ba4/lib/mail/mail.rb#L157-L159\" rel=\"nofollow noreferrer\">explicitly calls <code>retriever_method.last(*args, &amp;block)</code></a>.</p>\n\n<p>As one might see, <a href=\"https://github.com/mikel/mail/blob/6bc16b4bce4fe280b19523c939b14a30e32a8ba4/lib/mail/message.rb\" rel=\"nofollow noreferrer\">instance</a> allows to override <code>delivery_method</code>, but not <code>retriever_method</code>.</p>\n\n<p>So you should store <code>Configuration.instance.retriever_method</code> into intermediate variable, update it, call <code>Mail::last</code> and restore it back. Somewhat along these lines:</p>\n\n<pre><code>Configuration.instance.instance_eval do\n  generic_retriever_method = retriever_method\n  retriever_method :imap,\n    user_name: to,\n    password: password,\n    address: server,\n    port: port,\n    enable_ssl: true\n  Mail.last\n  retriever_method = generic_retriever_method\nend\n</code></pre>\n"}], "owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565627037, "creation_date": 1565625896, "question_id": 57464594, "link": "https://stackoverflow.com/questions/57464594/how-do-i-set-retriever-method-not-in-defaults", "title": "How do I set retriever_method not in defaults?", "body": "<p>Setting the <code>delivery_method</code> immediately within the <code>delivery</code> block instead of setting the <code>defaults</code> <strong>to send</strong> seems to work well with the following code:</p>\n\n<pre><code>    Mail.deliver do\n      delivery_method :smtp,\n        address: \"smtp.gmail.com\",\n        domain: \"#####\",\n        port: 587,\n        user_name: from,\n        password: \"#####\",\n        enable_starttls_auto: true\n      from     from\n      to       to\n      subject  subject\n      body     \"default body\"\n    end\n</code></pre>\n\n<p>But how do I do the same <strong>to read</strong>?</p>\n\n<pre><code>Mail.last do\n  retriever_method :imap,\n    user_name: to,\n    password: password,\n    address: server,\n    port: port,\n    enable_ssl: true\nend\n</code></pre>\n\n<p>causes</p>\n\n<pre><code>*** NoMethodError Exception: undefined method `retriever_method' for #&lt;RSpec::ExampleGroups::Nested::Nested_2::Nested::Email_2:0x00007fa246110478&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565624836, "post_id": 57464198, "comment_id": 101402120, "body": "is <code>.&#47;appname&#47;loader&#47;model_import.rb</code> start at the root of your rails project?"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565624904, "post_id": 57464198, "comment_id": 101402162, "body": "In my lib folder of my app lib/appname/loader/model_import.rb"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565626226, "post_id": 57464198, "comment_id": 101402790, "body": "What is the purpose of your namespacing?  You just writing code inside a module.  But why?"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565626376, "post_id": 57464198, "comment_id": 101402852, "body": "To help me Organize the code"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1565626419, "post_id": 57464198, "comment_id": 101402868, "body": "This is a simplified example"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565626594, "post_id": 57464198, "comment_id": 101402925, "body": "Your module doesn&#39;t make much sense, as you&#39;ve written it. It doesn&#39;t define any methods -- So what are you trying to do by <code>include</code>ing it?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1565626641, "post_id": 57464198, "comment_id": 101402939, "body": "I think what has happened is the file is being <b>evaluated immediately</b> by the <code>require_relative</code> statement. And since this happens <i>before</i> the environment is loaded, it doesn&#39;t know what <code>MyModel</code> is."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1565626756, "post_id": 57464198, "comment_id": 101402961, "body": "To summarise... In answer to the actual question you asked: You can use <code>::MyModel</code> instead of <code>MyModel</code> to explicitly say &quot;use the top level namespace&quot;. However, this won&#39;t actually solve your problem; you&#39;re asking the wrong question. What you need to do instead is ensure that the code is evaluated <b>after the environment has been loaded</b>. (For example, by actually defining a method inside the module, and invoking it inside the rake task. Or, by moving the <code>require_relative</code> to inside the take task.)"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1565629760, "post_id": 57465145, "comment_id": 101404163, "body": "While you are correct I think the issue the OP is referring to is a constant lookup issue e.g. <code>MyModel</code> vs <code>::MyModel</code> as mentioned by <a href=\"https://stackoverflow.com/questions/57464198/nameerror-uninitialized-constant-appnameloadermodelimportmymodel#comment101402961_57464198\">@TomLord</a>"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1565634881, "post_id": 57465145, "comment_id": 101406250, "body": "Good recommendation too, I did both, moved my require, and added a new method. It works now"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1565628382, "creation_date": 1565628382, "answer_id": 57465145, "question_id": 57464198, "link": "https://stackoverflow.com/questions/57464198/nameerror-uninitialized-constant-appnameloadermodelimportmymodel/57465145#57465145", "title": "NameError: uninitialized constant AppName::Loader::ModelImport::MyModel", "body": "<p>If you write a module the code inside it may automagically get executed just because you required the module.  For example:</p>\n\n<pre><code>module AppName\n  module Loader\n    module ModelImport\n      puts 'wtf' # this may get run but you won't see it\n    end\n  end\nend\n</code></pre>\n\n<p>However if you have at least method defined it can be called</p>\n\n<pre><code>module AppName\n  module Loader\n    module ModelImport\n      def self.wtf\n        puts 'wtf'\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Now if this file is saved in <code>lib/app_name/loder/model_import.rb</code> you can run it like this:</p>\n\n<pre><code>require_or_load 'lib/app_name/loader/model_import'\n# and now you can do\nAppName::Loader::ModelImport.wtf\n=&gt;wtf\n</code></pre>\n\n<p>So you need to first define a usable module, then you can require it, then you can call methods on it.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565634806, "creation_date": 1565624208, "last_edit_date": 1565634806, "question_id": 57464198, "link": "https://stackoverflow.com/questions/57464198/nameerror-uninitialized-constant-appnameloadermodelimportmymodel", "title": "NameError: uninitialized constant AppName::Loader::ModelImport::MyModel", "body": "<p>I have a namespace issue. MyModel is just a normal Rails Model. However, my code seems to be namespacing it under the namespace I created, I need a way to reference it directly without the <code>AppName::Loader::ModelImport</code> namespace.</p>\n\n<p>Error:</p>\n\n<blockquote>\n  <blockquote>\n    <p>NameError: uninitialized constant AppName::Loader::ModelImport::MyModel</p>\n  </blockquote>\n</blockquote>\n\n<p>Rake task:</p>\n\n<pre><code>require 'csv'\nrequire_relative '../appname/loader/model_import'\n\n\nnamespace :app_name do\n  namespace :loader do\n\n    desc \"Loads data into Database\"\n\n    task model_import: :environment  do\n\n      include AppName::Loader::ModelImport\n    end\n  end\nend\n</code></pre>\n\n<p>Service Object </p>\n\n<p>./appname/loader/model_import.rb</p>\n\n<pre><code>module AppName\n  module Loader\n    module ModelImport\n      record_set = []\n\n      file_name = File.join(Rails.root, 'lib','appname','loader','data' ,'data.txt')\n      CSV.open(file_name, \"r\", { :col_sep =&gt; \"\\t\", quote_char: nil, row_sep: \"\\r\\r\\n\" }).each do |row|\n        record_set &lt;&lt; MyModel.new(\n          company_name: row[1],\n          address1: row[2],\n          address2: row[3],\n          city: row[4],\n          state_code: row[5],\n          zip_code: row[6]\n          )\n      end\n\n      MyModel.import record_set\n    end\n  end\nend\n</code></pre>\n\n<p>I tried:</p>\n\n<p>::MyModel.new()</p>\n\n<p>and also got the >>NameError: uninitialized constant MyModel, so I wonder if rails is not loading properly. However, I thought <code>task model_import: :environment  do</code> loads Rails.</p>\n\n<p>My application.rb file has..</p>\n\n<pre><code>    config.eager_load_paths &lt;&lt; Rails.root.join(\"lib\")\n</code></pre>\n\n<p>If I use Pry, I can see the 'Rails' constant is loaded. However, I can not access any of my models. For example, <code>User</code> does not load, nor any other.</p>\n\n<h3>Solution per comments by Tom Lord:</h3>\n\n<p>require needed to be evaluated after the environment has been loaded.</p>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 51, "user_id": 4219131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ll5S2_aOLwk/AAAAAAAAAAI/AAAAAAAADEQ/3SZDqxHXY24/photo.jpg?sz=128", "display_name": "dismir", "link": "https://stackoverflow.com/users/4219131/dismir"}, "edited": false, "score": 0, "creation_date": 1565627068, "post_id": 57463933, "comment_id": 101403081, "body": "Can you please do <code>puts scenario.class</code> to get class name, because I suggesting that <code>Cucumber::RunningTestCase::Scenario</code> is not the class we are looking for. It can be <a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/Formatter/LegacyApi/Ast/Scenario\" rel=\"nofollow noreferrer\">rubydoc.info/gems/cucumber/Cucumber/Formatter/LegacyApi/Ast/&zwnj;&#8203;&hellip;</a> for example."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11918330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tPA8OFhtMTE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reS8JY1-yw2TWeqT5wgQImSDqs-KQ/photo.jpg?sz=128", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/11918330/shawn-s"}, "edited": false, "score": 0, "creation_date": 1565680767, "post_id": 57466088, "comment_id": 101418001, "body": "&quot;name&quot; method is defined in &quot;lib/cucumber/core/test/case.rb&quot;   <code>class Scenario &lt; SimpleDelegator       def initialize(test_case, result = Core::Test::Result::Unknown.new)         @test_case = test_case         @result = result         super test_case       end end  </code> But &quot;Scenario&quot; class is not subclass of &quot;case&quot; class, then how &quot;case&quot; class methods are available in Scenario class object?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 11, "user_id": 11918330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tPA8OFhtMTE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reS8JY1-yw2TWeqT5wgQImSDqs-KQ/photo.jpg?sz=128", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/11918330/shawn-s"}, "edited": false, "score": 0, "creation_date": 1565695531, "post_id": 57466088, "comment_id": 101425353, "body": "I don&#39;t mean to be impertinent but did you read my answer? I thought I explained this fairly well along with offering documentation you can review"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1565646152, "last_edit_date": 1565646152, "creation_date": 1565633066, "answer_id": 57466088, "question_id": 57463933, "link": "https://stackoverflow.com/questions/57463933/how-to-find-source-location-of-method-in-cucumber-ruby/57466088#57466088", "title": "How to find source location of method in cucumber-ruby?", "body": "<p><code>Scenario</code> is a <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/delegate/rdoc/SimpleDelegator.html\" rel=\"nofollow noreferrer\"><code>SimpleDelegator</code></a> which means that any method that is not defined will be passed on to the delegation object. This delegation object is set here using <code>super test_case</code>  </p>\n\n<pre><code># lib/cucumber/running_test_case.rb\ndef initialize(test_case, result = Core::Test::Result::Unknown.new)\n  @test_case = test_case\n  @result = result\n  super test_case\nend\n</code></pre>\n\n<p>Since <code>name</code> is not defined by <code>Scenario</code> it belongs to the injected object <code>test_case</code> in this instance.</p>\n\n<p>You can determine what the delegation object is by using <code>SimpleDelegator#__getobj__</code> like so </p>\n\n<pre><code>scenario.__getobj__.class \n</code></pre>\n\n<p>To determine where the <code>name</code> method comes from you can attempt to use <a href=\"https://ruby-doc.org/core-2.6.1/Method.html#method-i-source_location\" rel=\"nofollow noreferrer\"><code>Method#source_location</code></a> like so: </p>\n\n<pre><code>scenario.__getobj__.method(:name).source_location \n</code></pre>\n\n<p>However, if this method is dynamically defined (or defined in a <code>C</code> code extension) then this will simply return <code>nil</code> and you will have to look at the documentation and/or source code for the <code>scenario.__getobj__.class</code> object to determine how it defines <code>name</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 11918330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tPA8OFhtMTE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reS8JY1-yw2TWeqT5wgQImSDqs-KQ/photo.jpg?sz=128", "display_name": "Shawn S", "link": "https://stackoverflow.com/users/11918330/shawn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565646152, "creation_date": 1565623079, "last_edit_date": 1565623495, "question_id": 57463933, "link": "https://stackoverflow.com/questions/57463933/how-to-find-source-location-of-method-in-cucumber-ruby", "title": "How to find source location of method in cucumber-ruby?", "body": "<p>Not able to find the source location of the method in cucumber-ruby </p>\n\n<p>I have tried in env.rb file</p>\n\n<pre><code>Before do |scenario|\n puts scenario.name  \nend \n</code></pre>\n\n<p>I don't know where the \"name\" method defined?</p>\n\n<p>There is no method named \"name\" in <a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/RunningTestCase/Scenario\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/cucumber/Cucumber/RunningTestCase/Scenario</a></p>\n"}, {"tags": ["ruby", "icalendar", "rails-activestorage"], "comments": [{"owner": {"reputation": 15233, "user_id": 416791, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/46679faeb6780ecb1ea57527fdc66eb3?s=128&d=identicon&r=PG", "display_name": "Brandon Wamboldt", "link": "https://stackoverflow.com/users/416791/brandon-wamboldt"}, "edited": false, "score": 1, "creation_date": 1565621613, "post_id": 57462998, "comment_id": 101400477, "body": "What errors are you getting?"}], "answers": [{"tags": [], "owner": {"reputation": 1181, "user_id": 4589069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a712e21314267b02a73ad8302c0730?s=128&d=identicon&r=PG&f=1", "display_name": "MrAleister", "link": "https://stackoverflow.com/users/4589069/mraleister"}, "is_accepted": false, "score": 1, "last_activity_date": 1565621882, "creation_date": 1565621882, "answer_id": 57463610, "question_id": 57462998, "link": "https://stackoverflow.com/questions/57462998/read-file-ics-from-active-storage/57463610#57463610", "title": "Read file ics from active storage", "body": "<p>File.open gives you a file reference. You want its content (File.read):</p>\n\n<pre><code>@events = Icalendar::Event.parse(File.read(@user.calendar.service_url))\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1565621882, "creation_date": 1565619734, "question_id": 57462998, "link": "https://stackoverflow.com/questions/57462998/read-file-ics-from-active-storage", "title": "Read file ics from active storage", "body": "<p>I would like to store a file .ics (Icalendar) through active storage. To read this file, I'm using the gem <a href=\"https://github.com/icalendar/icalendar\" rel=\"nofollow noreferrer\">Icalendar</a>. Before, I was saving the file icalendar directly into my public folder like this : </p>\n\n<pre><code>require 'open-uri' \ndir = Rails.root.join('public', 'calendars')\nfile_name = \"user_\" + @user.id.to_s + \"_calendar.ics\"\nFile.write (dir+ file_name), open(@user.calendar_url).read.force_encoding(\"UTF-8\")\n</code></pre>\n\n<p>To read the saved file, I was doing that : </p>\n\n<pre><code>pathname =  dir + file_name\n@events = Icalendar::Event.parse(File.open(pathname))\n</code></pre>\n\n<p>.</p>\n\n<p><strong>Now I would like to do the same with active storage</strong></p>\n\n<p>This script was working great but I need to store this file through active_storage. For the first part (save the file), there is no problem :</p>\n\n<pre><code>@user.calendar.attach(io: open(@user.calendar_url), filename: 'calendar.ics')\n</code></pre>\n\n<p>But for the second part, read the file, I'm not able to read the file saved with active storage. I've tried many ways (like the followings) but without success </p>\n\n<pre><code>@events = Icalendar::Event.parse(@user.calendar)\n@events = Icalendar::Event.parse(File.open(@user.calendar.service_url))\n@events = Icalendar::Event.parse(File.open(Rails.application.routes.url_helpers.rails_blob_path(@user.calendar, only_path: true)))\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11647551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674fdcaf51007ae0ac108d6af9b883f4?s=128&d=identicon&r=PG&f=1", "display_name": "tom-ash", "link": "https://stackoverflow.com/users/11647551/tom-ash"}, "edited": false, "score": 0, "creation_date": 1565614981, "post_id": 57461700, "comment_id": 101396754, "body": "Would it not be the best idea to catch <code>ActionController::UnpermittedParameters exception</code> on production and response with 400?"}, {"owner": {"reputation": 6122, "user_id": 946500, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fqdcn.jpg?s=128&g=1", "display_name": "Pavel Oganesyan", "link": "https://stackoverflow.com/users/946500/pavel-oganesyan"}, "reply_to_user": {"reputation": 33, "user_id": 11647551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674fdcaf51007ae0ac108d6af9b883f4?s=128&d=identicon&r=PG&f=1", "display_name": "tom-ash", "link": "https://stackoverflow.com/users/11647551/tom-ash"}, "edited": false, "score": 0, "creation_date": 1565615560, "post_id": 57461700, "comment_id": 101397063, "body": "As default behavior - totally not ok. Imagine 3d party API to add extra parameter to POST query for some callbacks we are listening to in new release without any breaking changes - Rails app would just answer 400 to all requests. Personally, I would not like it in my app. Since they gave us <code>:raise</code> option, error handling can be done if needed."}], "tags": [], "owner": {"reputation": 6122, "user_id": 946500, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fqdcn.jpg?s=128&g=1", "display_name": "Pavel Oganesyan", "link": "https://stackoverflow.com/users/946500/pavel-oganesyan"}, "is_accepted": true, "score": 4, "last_activity_date": 1565614768, "creation_date": 1565614768, "answer_id": 57461700, "question_id": 57461284, "link": "https://stackoverflow.com/questions/57461284/action-on-unpermitted-parameters-on-production-environment/57461700#57461700", "title": "Action on Unpermitted Parameters on production environment", "body": "<p>There are three options:</p>\n\n<ul>\n<li><code>false</code> - do nothing, filter unpermitted </li>\n<li><code>:log</code>  - write a message on\nthe logger </li>\n<li><code>:raise</code> - raise an exception.</li>\n</ul>\n\n<p>So, it would be pretty bad idea to set default value to <code>:raise</code> - it would lead to crashes.\nSo, we have to choose between <code>false</code> and <code>:log</code> - lets look at <a href=\"https://github.com/rails/rails/blob/130370b1c872e9c7645e1c3cc26365d9dc4d90b1/actionpack/lib/action_controller/metal/strong_parameters.rb\" rel=\"nofollow noreferrer\">implementation</a> (starting at line 240) - log will be written with <code>debug</code> level, so it would not be visible in production with default logging level. There is just no point to store unpermitted params in production log in most cases.</p>\n"}], "owner": {"reputation": 33, "user_id": 11647551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674fdcaf51007ae0ac108d6af9b883f4?s=128&d=identicon&r=PG&f=1", "display_name": "tom-ash", "link": "https://stackoverflow.com/users/11647551/tom-ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 57461700, "answer_count": 1, "score": 2, "last_activity_date": 1565614768, "creation_date": 1565613131, "last_edit_date": 1565614079, "question_id": 57461284, "link": "https://stackoverflow.com/questions/57461284/action-on-unpermitted-parameters-on-production-environment", "title": "Action on Unpermitted Parameters on production environment", "body": "<p><a href=\"https://api.rubyonrails.org/classes/ActionController/Parameters.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActionController/Parameters.html</a></p>\n\n<p>Why <code>action_on_unpermitted_parameters</code> defaults to <code>false</code> on production environment?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "is_accepted": true, "score": 2, "last_activity_date": 1565614949, "last_edit_date": 1565614949, "creation_date": 1565611089, "answer_id": 57460772, "question_id": 57460059, "link": "https://stackoverflow.com/questions/57460059/passing-haml-partial-to-a-controller-variable/57460772#57460772", "title": "Passing haml-partial to a controller variable", "body": "<pre class=\"lang-rb prettyprint-override\"><code>Msg.create(user_id: 2420, \n           from_user_id: 2421, \n           subject: 'Finish now!', \n           content: render_to_string(partial: 'foo/bar', locals: { foo: 'bar' }))\n</code></pre>\n\n<p>This will render the partial at <code>app/foo/_bar.html.haml</code> with a local variable <code>foo</code> set to the value <code>\"bar\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "is_accepted": false, "score": 0, "last_activity_date": 1565616225, "creation_date": 1565616225, "answer_id": 57462078, "question_id": 57460059, "link": "https://stackoverflow.com/questions/57460059/passing-haml-partial-to-a-controller-variable/57462078#57462078", "title": "Passing haml-partial to a controller variable", "body": "<p>Another approach is to use <code>haml</code> directly. (Be very careful about indentation)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>engine = Haml::Engine.new(\"\n%p Haml code!\nh1 Title\n\")\n\nMsg.create(...., content: engine.render)\n</code></pre>\n\n<hr>\n\n<p><em>Obviously this is just for very simple html, and I'm perfectly well aware of the fact that mixing html in controllers violates all sorts of rules.</em></p>\n"}], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 57460772, "answer_count": 2, "score": 1, "last_activity_date": 1581308514, "creation_date": 1565608136, "last_edit_date": 1581308514, "question_id": 57460059, "link": "https://stackoverflow.com/questions/57460059/passing-haml-partial-to-a-controller-variable", "title": "Passing haml-partial to a controller variable", "body": "<p>I have a function sending messages to a user on a site.</p>\n\n<p>Function arguments: user_id, from_user_id, subject, content.\nI need to pass a haml template to the content variable that supports the link_to helper.</p>\n\n<p>Can I do something like <code>content: partial 'my_partial'</code>?</p>\n\n<p>This can be done?</p>\n\n<p>Because I\u2019m really not comfortable writing long lines in the controller:</p>\n\n<pre><code>Msg.create(user_id: 2420, \n           from_user_id: 2421, \n           subject: 'Finish now!', \n           content: \"&lt;p style='text-align: center;'&gt;User A can help!.&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;a class='match-btn-green-radius' href='#'&gt;Finish&lt;/a&gt;&lt;/p&gt;\")\n</code></pre>\n\n<p>It looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/apbYU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/apbYU.png\" alt=\"Looks like\"></a></p>\n"}, {"tags": ["ruby", "rake"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1565602056, "post_id": 57458501, "comment_id": 101390653, "body": "<code>File.open(&quot;some_file_name.txt&quot;, &quot;w&quot;) {.....}</code> will create a file <b>in the current directory</b> (assuming there&#39;s no other crucial code you&#39;ve omitted.) Which is not necessarily the same thing as the folder of the execution script. In other words, unless you&#39;re already inside the <code>bin&#47;</code> folder, it&#39;s not going to create a file inside <code>bin&#47;</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565602083, "post_id": 57458501, "comment_id": 101390668, "body": "<code>__dir__</code> is the folder from which a method is called. This is not necessarily the same as folder that the script is being executed from."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565602110, "post_id": 57458501, "comment_id": 101390687, "body": "tl;dr: Did your rake task create a file at the root of the project, rather than insider <code>bin&#47;</code>?"}, {"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565602208, "post_id": 57458501, "comment_id": 101390740, "body": "@TomLord, Probably it has created the file somewhere int FSystem but I cant find it"}, {"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565602240, "post_id": 57458501, "comment_id": 101390759, "body": "@TomLord, So how to give the file a context?"}, {"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565602481, "post_id": 57458501, "comment_id": 101390899, "body": "@TomLord   This one works <code>File.open(&quot;&#47;home&#47;csrhub&#47;v2-live-csr-api-rb&#47;bin&#47;some_file_nam&zwnj;&#8203;e.txt&quot;, &quot;w&quot;) { |file| file.puts &quot;I wrote this with ruby!&quot;}</code>I can see the file created by the task. So I beleive it has always created a file but somewhere else. `"}, {"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1565602574, "post_id": 57458501, "comment_id": 101390955, "body": "Offf. This solved the problem <code>File.open(&quot;#{__dir__}&#47;some_file_name.txt&quot;, &quot;w&quot;) { |file| file.puts &quot;I wrote this with ruby!&quot;} </code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1565607327, "post_id": 57458501, "comment_id": 101393052, "body": "Your original code was perfectly fine. If you run the rake task in <code>&#47;home&#47;csrhub&#47;v2-live-csr-api-rb</code>, then it will create a file: <code>&#47;home&#47;csrhub&#47;v2-live-csr-api-rb&#47;some_file_name.txt</code>. Without the <code>&#47;bin</code> folder. Did you check to see if the file was actually created at the root of the project?"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565634487, "creation_date": 1565601590, "last_edit_date": 1592644375, "question_id": 57458501, "link": "https://stackoverflow.com/questions/57458501/ruby-file-from-rake-task-problem-does-not-create-file", "title": "Ruby file from rake task problem - does not create file", "body": "<p>I have a rake task that loads file directories from a configuration file.</p>\n<p>For each directory I want to run a ruby script. The filepath is correct, since when I run it independently it works. But called from the rake file it doesn't work.</p>\n<p>The ruby script file content is the following:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>File.open(&quot;some_file_name.txt&quot;, &quot;w&quot;) { |file| file.puts &quot;I wrote this with ruby!&quot;}\nputs &quot;TAADAAA&quot;\nputs &quot;#{__dir__}/some_file_name.txt&quot;\n</code></pre>\n<p>When I run it from the rake task the output is:</p>\n<blockquote>\n<p>/home/csrhub/.rbenv/versions/2.3.7/bin/ruby /home/csrhub/v2-live-csr-api-rb/bin/restart</p>\n<p>TAADAAA</p>\n<p>/home/csrhub/v2-live-csr-api-rb/bin/some_file_name.txt</p>\n</blockquote>\n<p>But no file created in the directory.\nThen I copy-paste the first part of the output <code>/home/csrhub/.rbenv/versions/2.3.7/bin/ruby /home/csrhub/v2-live-csr-api-rb/bin/restart</code> and run it from the shell, I get the output file. But from the rake task the file does not appear.</p>\n"}, {"tags": ["ruby", "rspec", "matcher"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1565609835, "post_id": 57458065, "comment_id": 101394219, "body": "Isn&#39;t the description suffixed to the message? <code>expect ... to (NOT)</code> followed by the description. You should make the description universally acceptable. For example <code>have attribute &quot;name&quot; match &quot;some name value&quot;</code> resulting in the messages <code>expect ... to have attribute &quot;name&quot; match &quot;some name value&quot;</code> or in the case of negation <code>expect ... to NOT have attribute &quot;name&quot; match &quot;some name value&quot;</code>."}, {"owner": {"reputation": 343, "user_id": 682038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0d3e1cd54a505c5b2c73eb473ecbf25?s=128&d=identicon&r=PG", "display_name": "denBelg", "link": "https://stackoverflow.com/users/682038/denbelg"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1565681057, "post_id": 57458065, "comment_id": 101418153, "body": "That is possible but i do a &quot;puts &quot;Expect: #{description}&quot;&quot; at the beginning of the test. On that moment is hould know of it is a negation or not..."}], "owner": {"reputation": 343, "user_id": 682038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0d3e1cd54a505c5b2c73eb473ecbf25?s=128&d=identicon&r=PG", "display_name": "denBelg", "link": "https://stackoverflow.com/users/682038/denbelg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565599556, "creation_date": 1565599556, "question_id": 57458065, "link": "https://stackoverflow.com/questions/57458065/how-to-define-a-negated-description-for-a-custom-matcher", "title": "How to define a negated description for a custom matcher", "body": "<p>When i test stuff with rspec/ruby i use a lot of custom matchers. One of the big advandages for me it that i can create custom failure messages and descriptions. I use the descriptions to print out the expected behaviour at the bgeinning of the test. But i have a problem when a negate matchers. </p>\n\n<p>I would like to define a <em>description_when_negated</em>. Is their a way to know if a matcher is negated in the description part? Or can i know it in the match part and print out somthing different.</p>\n\n<p>Simple code example:</p>\n\n<pre><code>Spec::Matchers.define :have_value do |expected_value|\n  match do |actual|\n    puts \"Expect: #{description}\"\n\n    actual.value == expected_value\n  end\n\n  description do\n    \"Object'#{actual.id}' should have value '#{expected_value}'\"\n  end\n\n  failure_message do |actual|\n    \"Object'#{actual.id}' has value '#{actual.value}' instead of '#{expected_value}'\"\n  end\n\n  failure_message_when_negated do |actual|\n    \"Object'#{actual.id}' has value '#{actual.value}' and that was not expected\"\n  end\nend\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>expect(object1).to have_value(1235)\nexpect(object1).to have_name('test')\nexpect(object1).to_not have_description('test')\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Expect Object 1 to have value '1235'  \nExpect Object 1 to have name 'test'\nExpect Object 1 to NOT have description 'test'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1565594054, "post_id": 57456889, "comment_id": 101387731, "body": "Doesn&#39;t javascript have something like <code>foofoo.foreach(function(x) { alert(x) });</code>? That&#39;s basically the same thing."}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1565594432, "creation_date": 1565594432, "answer_id": 57457047, "question_id": 57456889, "link": "https://stackoverflow.com/questions/57456889/how-does-col-get-its-value-in-ruby-code-array-newcells-col-polarcell-new/57457047#57457047", "title": "How does col get its value in Ruby Code: Array.new(cells) { |col| PolarCell.new(row, col) }", "body": "<p><code>col</code> here is the index, you can see it as follows:</p>\n\n<pre><code>arr = Array.new(5) { |i| print \"#{i} \"; i * 2}\n# this prints the value of i each iteration:\n# =&gt; 0 1 2 3 4\n\nprint arr\n# each iteration returns i * 2 so the array ends up as:\n# =&gt; [0,2,4,6,8]\n</code></pre>\n\n<p>5 is the length of the array, and the block is called 5 times (because of zero-indexing, you get the values 0 up to 4 passed for <code>i</code>).</p>\n\n<p>In Javascript you could do it with a <code>for</code> loop, for example:</p>\n\n<pre><code>let arr = [];\nfor (let i = 0; i &lt; 5; i++) {\n  arr.push(i);\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 1, "last_activity_date": 1565595100, "last_edit_date": 1565595100, "creation_date": 1565594674, "answer_id": 57457090, "question_id": 57456889, "link": "https://stackoverflow.com/questions/57456889/how-does-col-get-its-value-in-ruby-code-array-newcells-col-polarcell-new/57457090#57457090", "title": "How does col get its value in Ruby Code: Array.new(cells) { |col| PolarCell.new(row, col) }", "body": "<p>You can create an Array with block parameter. Creating a PolarCell object as many as the number of cells in that row. PolarCell's arguments are <code>row</code> and <code>col</code>. The <code>row</code> parameter comes from each. The <code>col</code> parameter is the index of the new array created.</p>\n\n<pre><code># in javascript\nfor (col = 0; col &lt; cells.length; i++) { \n  PolarCell(row, col)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1565598201, "last_edit_date": 1565598201, "creation_date": 1565597829, "answer_id": 57457710, "question_id": 57456889, "link": "https://stackoverflow.com/questions/57456889/how-does-col-get-its-value-in-ruby-code-array-newcells-col-polarcell-new/57457710#57457710", "title": "How does col get its value in Ruby Code: Array.new(cells) { |col| PolarCell.new(row, col) }", "body": "<blockquote>\n  <p>How does col get its value in the line below???</p>\n\n<pre><code>rows[row] = Array.new(cells) { |col| PolarCell.new(row, col) } \n</code></pre>\n</blockquote>\n\n<p>This is called a <em>parameter</em> and is a very important concept in programming. A parameter is kind of a \"hole\" that is left in the definition of a subroutine. Then, when you invoke this subroutine, you can \"fill\" this hole with a concrete value, this value is called an <em>argument</em>.</p>\n\n<p>This very similar to functions in mathematics:</p>\n\n<p>In </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>f(x, y) = x + y\n</code></pre>\n\n<p><code>x</code> and <code>y</code> correspond to the programming notion of <em>parameters</em> and in </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>f(23, 42)\n</code></pre>\n\n<p><code>23</code> and <code>42</code> correspond to the programming notion of <em>arguments</em>.</p>\n\n<p>So, here <code>col</code> is a <em>parameter</em> of the block <code>{ |col| PolarCell.new(row, col) }</code> and this block will be called <code>cells</code> number of times by <code>Array::new</code>, passing first <code>0</code>, then <code>1</code>, then <code>2</code>, and so on as an <em>argument</em> to the block.</p>\n\n<blockquote>\n  <p>How to translate that to Javascript?</p>\n</blockquote>\n\n<p>JavaScript also has the concept of <em>parameters</em> and <em>arguments</em>. For example, in </p>\n\n<pre class=\"lang-ecmascript prettyprint-override\"><code>function foo(a, b) {\n    return a + b;\n}\n</code></pre>\n\n<p><code>a</code> and <code>b</code> are the <em>parameters</em>, and in </p>\n\n<pre class=\"lang-ecmascript prettyprint-override\"><code>foo(23, 42);\n</code></pre>\n\n<p><code>23</code> and <code>42</code> are the <em>arguments</em>.</p>\n"}], "owner": {"reputation": 2173, "user_id": 4333490, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/75ae669b61be57924b9b0ffceb92929a?s=128&d=identicon&r=PG&f=1", "display_name": "preston", "link": "https://stackoverflow.com/users/4333490/preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1565598201, "creation_date": 1565593474, "question_id": 57456889, "link": "https://stackoverflow.com/questions/57456889/how-does-col-get-its-value-in-ruby-code-array-newcells-col-polarcell-new", "title": "How does col get its value in Ruby Code: Array.new(cells) { |col| PolarCell.new(row, col) }", "body": "<p>I don't understand one line on the code below:</p>\n\n<pre><code>def prepare_grid\n    rows = Array.new(@rows) \n\n    row_height = 1.0 / @rows \n    rows[0] = [ PolarCell.new(0, 0) ] \n\n    (1...@rows).each do |row|\n      radius = row.to_f / @rows \n      circumference = 2 * Math::PI * radius \n\n      previous_count = rows[row - 1].length\n      estimated_cell_width = circumference / previous_count \n      ratio = (estimated_cell_width / row_height).round \n\n      cells = previous_count * ratio \n      rows[row] = Array.new(cells) { |col| PolarCell.new(row, col) } \n    end\n\n    rows\n  end\n</code></pre>\n\n<p>How does col get its value in the line below???</p>\n\n<pre><code>rows[row] = Array.new(cells) { |col| PolarCell.new(row, col) } \n</code></pre>\n\n<p>How to translate that to Javascript?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 2, "last_activity_date": 1565592292, "creation_date": 1565592292, "answer_id": 57456700, "question_id": 57456591, "link": "https://stackoverflow.com/questions/57456591/variable-ruby-exercise-from-launchschool/57456700#57456700", "title": "Variable Ruby - Exercise from Launchschool", "body": "<p>You can prints all like this:</p>\n\n<pre><code>years = [10, 20, 30, 40]\nyears.each do |year|\n  \"In #{year} years you will be: #{age + year}\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 1, "last_activity_date": 1565592341, "creation_date": 1565592341, "answer_id": 57456714, "question_id": 57456591, "link": "https://stackoverflow.com/questions/57456591/variable-ruby-exercise-from-launchschool/57456714#57456714", "title": "Variable Ruby - Exercise from Launchschool", "body": "<p>You can wrap the puts logic inside a method</p>\n\n<pre><code>def ageOld(current_age)\n  years = [10, 20, 30, 40]\n\n  years.each do |year|\n    puts \"In #{year} years you will be: #{current_age + year}\"\n  end\nend\n\nage = gets.chomp.to_i\nageOld(age)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565596080, "post_id": 57456719, "comment_id": 101388379, "body": "What would be the reason to always return <code>[nil, nil, nil, nil]</code> from this method? (Downvote is not mine since it is still printing what was expected.)"}, {"owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1565597881, "post_id": 57456719, "comment_id": 101389016, "body": "<code>puts</code> returns <code>nil</code> and as I used <code>map</code> here, it is returning the array of <code>nil</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565597943, "post_id": 57456719, "comment_id": 101389036, "body": "I understand what <code>puts</code> returns. I pointed out you abused <code>map</code> for simple iteration, there should be <code>each</code> instead."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1565598018, "post_id": 57456719, "comment_id": 101389064, "body": "I have no idea. The only glitch with this code is an improper use of <code>map</code> AFAICT."}], "tags": [], "owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "is_accepted": false, "score": 0, "last_activity_date": 1565592371, "creation_date": 1565592371, "answer_id": 57456719, "question_id": 57456591, "link": "https://stackoverflow.com/questions/57456591/variable-ruby-exercise-from-launchschool/57456719#57456719", "title": "Variable Ruby - Exercise from Launchschool", "body": "<p>You can try this.</p>\n\n<pre><code>def cal_age(current_age)\n years = [30,40, 50, 60]\n years.map {|i| puts \"In #{i} years you will be: #{current_age + i} age.\" }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1565596200, "creation_date": 1565596200, "answer_id": 57457387, "question_id": 57456591, "link": "https://stackoverflow.com/questions/57456591/variable-ruby-exercise-from-launchschool/57457387#57457387", "title": "Variable Ruby - Exercise from Launchschool", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>[10, 20, 30, 40].tap do |shift|\n  age = gets.chomp.to_i  \n  shift.each do |years|\n    puts \"In #{years} years you will be: #{age + years}\"\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1565596200, "creation_date": 1565591673, "question_id": 57456591, "link": "https://stackoverflow.com/questions/57456591/variable-ruby-exercise-from-launchschool", "title": "Variable Ruby - Exercise from Launchschool", "body": "<p>I am currently doing exercises from \n<a href=\"https://launchschool.com/books/ruby/read/variables#exercises\" rel=\"nofollow noreferrer\">https://launchschool.com/books/ruby/read/variables#exercises</a> and come across with this problem. </p>\n\n<p><strong>Write a program called age.rb that asks a user how old they are and then tells them how old they will be in 10, 20, 30 and 40 years. Below is the output for someone 20 years old.</strong></p>\n\n<p>Instead of writing puts many times, I want to write only three or four lines of code, however, my method is not working. Could you please check it? Thanks!</p>\n\n<pre><code>age = gets.chomp.to_i\nputs \"In 10 years you will be:\"\nputs age +  10\nputs \"In 20 years you will be:\"\nputs age +  20\nputs \"In 30 years you will be:\"\nputs age +  30\nputs \"In 40 years you will be:\"\nputs age +  40\n</code></pre>\n\n<pre><code>ages = [30,40, 50, 60]\n\nputs {In #{year} years you will be: #{age} age.}```\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "d3.js", "activescaffold"], "owner": {"reputation": 11, "user_id": 11870524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NknBmxSgwQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTk1GtzMgc6Yl9m-B8PEHOTXPgWQ/photo.jpg?sz=128", "display_name": "needrailshelp2019", "link": "https://stackoverflow.com/users/11870524/needrailshelp2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565571851, "creation_date": 1565571851, "question_id": 57454677, "link": "https://stackoverflow.com/questions/57454677/d3-nivo-is-unable-to-render-in-rails-application", "title": "D3/Nivo is unable to render in rails application", "body": "<p>I am working on a feature to replace a Flash dashboard with Nivo/D3. I successfully built the dashboard and have it as a React component to be imported. The react component even loads into the browser, but does not render on the page. </p>\n\n<p>I have verified that my component is built correctly, and I am able to run it in an html page by itself. The page I am trying to put it in is of file type .html.erb. I did try changing the ruby tags to HTML and that did not work. One theory is that I need to remove the JS prototype duplicate line here.</p>\n\n<pre><code>    &lt;script type=\"text/javascript\"&gt; &lt;/script&gt;\n     &lt;script src=\"/javascripts/prototype.js?1557137208\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"/javascripts/prototype.js?1557137208\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/effects.js?1557137208\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/dragdrop.js?1557137208\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/controls.js?1557137208\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/application.js?1557137208\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"/javascripts/active_scaffold/default/active_scaffold.js?1565285086\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/active_scaffold/default/dhtml_history.js?1565285086\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/active_scaffold/default/form_enhancements.js?1565285086\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/javascripts/active_scaffold/default/rico_corner.js?1565285086\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;link href=\"/stylesheets/active_scaffold/default/stylesheet.css?1565285086\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/stylesheets/active_scaffold/default/export-stylesheet.css?1565285086\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;!--[if IE]&gt;&lt;link href=\"/stylesheets/active_scaffold/default/stylesheet-ie.css?1565285086\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/stylesheets/active_scaffold/default/export-stylesheet-ie.css?1565285086\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;&lt;![endif]--&gt;\n</code></pre>\n\n<p>However, I don't know where or how that code is being generated. I think it is related to active scaffolding. Does anyone have any input on that?</p>\n\n<p>Presently, the error message I have been troubleshooting is this:</p>\n\n<pre><code>index.esm.js:214 Uncaught TypeError: h(...) is not a function\n    at Object.&lt;anonymous&gt; (index.esm.js:214)\n    at n (ResizeObserver.es.js:928)\n    at Object.&lt;anonymous&gt; (index.esm.js:214)\n    at n (ResizeObserver.es.js:928)\n    at Object.&lt;anonymous&gt; (index.esm.js:214)\n    at n (ResizeObserver.es.js:928)\n    at Object.&lt;anonymous&gt; (index.esm.js:214)\n    at n (ResizeObserver.es.js:928)\n    at Module.&lt;anonymous&gt; (index.esm.js:214)\n    at n (ResizeObserver.es.js:928)\n</code></pre>\n\n<p>but I don't think that is relevant as I have dug into it quite a bit.</p>\n\n<p>Tech stack notes (I realize I am on an old version of Ruby but upgrading is unfortunately not an option):\n* XML Version 1.0\n* Ruby version: 1.8.6\n* Ruby gems\ncgi_multipart_eof_fix (2)\ngem_plugin (0.2.3)\n* json_pure (1.7.6)\n* mongrel (1.1.5)\n* rake (0.8.7)\n* ruby-net-ldap (0.0.5)\n* Apache version: Not used yet. Eventually Odin and Sonitor will be replaced with nifi. \n* .NET version 4.0 (or 4.7)</p>\n\n<p>Does anyone have advice on how to get my React component to render?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1565570491, "post_id": 57454525, "comment_id": 101383517, "body": "Just subtract <code>Time.now</code> from <code>x</code>. The reverse of what you did to obtain <code>x</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 4, "last_activity_date": 1565593946, "creation_date": 1565593946, "answer_id": 57456961, "question_id": 57454525, "link": "https://stackoverflow.com/questions/57454525/printing-time-remaining-of-the-time-now-class-to-the-console/57456961#57456961", "title": "Printing time remaining of the Time.now class to the console", "body": "<p>For just seconds, it's easy:</p>\n\n<pre><code>end_time = Time.now + 200\nputs \"Time remaining: #{end_time - Time.now} seconds\"\n</code></pre>\n\n<p>I don't think there's a method in the standard library to pretty format durations, so you need something like this:</p>\n\n<pre><code>def time_until(end_time)\n  dt = end_time - Time.now\n\n  dt_s = dt.to_i\n  dt_m, dt_s = dt_s / 60, dt_s % 60\n  dt_h, dt_m = dt_m / 60, dt_m % 60\n  dt_d, dt_h = dt_h / 60, dt_h % 60\n\n  parts = []\n  parts &lt;&lt; \"%d days\" % dt_d if dt_d &gt; 0\n  parts &lt;&lt; \"%d hours\" % dt_h if dt_h &gt; 0\n  parts &lt;&lt; \"%d minutes\" % dt_m if dt_m &gt; 0\n  parts &lt;&lt; 'and' if !parts.empty? &amp;&amp; dt_s &gt; 0\n  parts &lt;&lt; \"%d seconds\" % dt_s\n\n  \"#{parts.join(' ')} remaining\"\nend\n</code></pre>\n\n<p>And the output:</p>\n\n<pre><code>irb(main):032:0&gt; time_until(Time.now + 20)\n=&gt; \"19 seconds remaining\"\nirb(main):028:0&gt; time_until(Time.now + 2000)\n=&gt; \"33 minutes and 19 seconds remaining\"\nirb(main):029:0&gt; time_until(Time.now + 20000)\n=&gt; \"5 hours 33 minutes and 19 seconds remaining\"\nirb(main):031:0&gt; time_until(Time.now + 2000000)\n=&gt; \"9 days 15 hours 33 minutes and 19 seconds remaining\"\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11887050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e57543929144f5ab081dcd9aa0f9f7?s=128&d=identicon&r=PG&f=1", "display_name": "gingervitiis", "link": "https://stackoverflow.com/users/11887050/gingervitiis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57456961, "answer_count": 1, "score": 2, "last_activity_date": 1566171722, "creation_date": 1565569289, "last_edit_date": 1566171722, "question_id": 57454525, "link": "https://stackoverflow.com/questions/57454525/printing-time-remaining-of-the-time-now-class-to-the-console", "title": "Printing time remaining of the Time.now class to the console", "body": "<p>In the following:</p>\n\n<pre><code>x = Time.now + 300 #output - 2019-08-11 20:26:14 -0400\n</code></pre>\n\n<p>If this timer were to be counting down is there a way I could display the seconds remaining until it the time expires?</p>\n\n<p>Example of what im attempting to do:</p>\n\n<pre><code>if thisIsTriggered\n   puts \"#{Time.secondsremaining} seconds until you can do this again\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1565564033, "post_id": 57453954, "comment_id": 101382735, "body": "You can write just <code>puts a</code> instead of <code>a.each { |a| puts a }</code>."}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 3, "creation_date": 1565565746, "post_id": 57453968, "comment_id": 101382917, "body": "&quot;will return the entire array&quot; \u2013 While this is true, this is terribly misleading. <i>All three of your examples</i> will return the entire array, because that&#39;s how <code>each</code> is defined: it performs the side-effects of the block and then returns its receiver. So, in an answer to the OP&#39;s question what the <i>difference</i> is, you mention in your first sentence the <i>one thing</i> that is the <i>same</i>."}], "tags": [], "owner": {"reputation": 379, "user_id": 2604889, "user_type": "registered", "profile_image": "https://graph.facebook.com/809550496/picture?type=large", "display_name": "Jean Meyer", "link": "https://stackoverflow.com/users/2604889/jean-meyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1565561336, "creation_date": 1565561336, "answer_id": 57453968, "question_id": 57453954, "link": "https://stackoverflow.com/questions/57453954/difference-between-puts-a-and-a-puts-a-in-ruby/57453968#57453968", "title": "Difference between {puts a} and {|a| puts a} in Ruby?", "body": "<pre><code>a.each {puts a}\n</code></pre>\n\n<p>will return the entire array</p>\n\n<p>while</p>\n\n<pre><code>a.each {|a| puts a}\n</code></pre>\n\n<p>is supposed to pass between || each item of the array. It's actually a bad practice to use the same variable in this case. Better do:</p>\n\n<pre><code>a.each {|item| puts item}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11915220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f30f282e4dcfaf20bb60c9a163bf5b?s=128&d=identicon&r=PG&f=1", "display_name": "ThePanMan321", "link": "https://stackoverflow.com/users/11915220/thepanman321"}, "edited": false, "score": 0, "creation_date": 1565652673, "post_id": 57453985, "comment_id": 101411725, "body": "ah, thanks for the insight, still a beginner to Ruby so I can be thankful people like you are around :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 13, "user_id": 11915220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f30f282e4dcfaf20bb60c9a163bf5b?s=128&d=identicon&r=PG&f=1", "display_name": "ThePanMan321", "link": "https://stackoverflow.com/users/11915220/thepanman321"}, "edited": false, "score": 0, "creation_date": 1565655179, "post_id": 57453985, "comment_id": 101412077, "body": "@ThePanMan321: glad to help and I commend the desire to play around, but maaaaaybe next time if you have a question like this, finish the book/tutorial first. Some books are presenting information in a progressively detailed manner. Chances are, the answer is two chapters away. Maybe it&#39;s just me, but I value these &quot;aha!&quot; moments, when things click into place. Having someone to hand it to me on a platter steals a part of fun. IMHO (obviously), do what works for you."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1565561609, "creation_date": 1565561609, "answer_id": 57453985, "question_id": 57453954, "link": "https://stackoverflow.com/questions/57453954/difference-between-puts-a-and-a-puts-a-in-ruby/57453985#57453985", "title": "Difference between {puts a} and {|a| puts a} in Ruby?", "body": "<pre><code>a.each {puts a}\n</code></pre>\n\n<p>This means \"for each element in array <code>a</code>, print array <code>a</code>\". If your array contains three elements, the array will be printed three times. </p>\n\n<p>This is valid ruby, but incorrect usage of <code>each</code>. It's supposed to accept current element in the block parameter (the <code>|a|</code>). Doesn't have to be called <code>a</code>, can be anything. These lines produce identical results:</p>\n\n<pre><code>a.each { |a| puts a }\na.each { |foo| puts foo }\n</code></pre>\n\n<p>In the first line block parameter <code>a</code> shadows outer array <code>a</code>. That's why two elements of the array are printed instead of the whole array being printed two times.</p>\n"}, {"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1565621782, "post_id": 57458905, "comment_id": 101400572, "body": "@SergioTulentsev : I wanted to explicitly give equivalent code, which might help the OP to understand better, what is actually going on here."}], "tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1565603131, "creation_date": 1565603131, "answer_id": 57458905, "question_id": 57453954, "link": "https://stackoverflow.com/questions/57453954/difference-between-puts-a-and-a-puts-a-in-ruby/57458905#57458905", "title": "Difference between {puts a} and {|a| puts a} in Ruby?", "body": "<p>@ThePanMan321 : The block is executed once for each array element. Hence in your case, it is executed twice. So the first case is equivalent to </p>\n\n<pre><code>a.size.times {puts a}\n</code></pre>\n\n<p>, you get twice the array being printed. </p>\n\n<p>In the second case, the second <code>a</code> is <em>shadowing</em> the outer <code>a</code> denoting the array. Really bad style. It is equivalent to</p>\n\n<pre><code>a.each {|goofy| puts goofy}\n</code></pre>\n\n<p>and hence you see each array element only once.</p>\n"}], "owner": {"reputation": 13, "user_id": 11915220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f30f282e4dcfaf20bb60c9a163bf5b?s=128&d=identicon&r=PG&f=1", "display_name": "ThePanMan321", "link": "https://stackoverflow.com/users/11915220/thepanman321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57453985, "answer_count": 3, "score": 1, "last_activity_date": 1565603131, "creation_date": 1565561142, "question_id": 57453954, "link": "https://stackoverflow.com/questions/57453954/difference-between-puts-a-and-a-puts-a-in-ruby", "title": "Difference between {puts a} and {|a| puts a} in Ruby?", "body": "<p>While I on a Ruby tutorial, i saw them use the second method of printing the whole list, |a| puts a, but i was wondering why they didn't simply type <em>puts a</em>, and trying it for myself, using <em>puts a</em> prints the list twice and i haven't found why</p>\n\n<pre><code>irb(main):001:0&gt; a = ['hello', 'hi']\n=&gt; [\"hello\", \"hi\"]\nirb(main):002:0&gt; a.each {puts a}\nhello\nhi\nhello\nhi\n=&gt; [\"hello\", \"hi\"]\nirb(main):03:0&gt; a.each {|a| puts a}\nhello\nhi\n=&gt; [\"hello\", \"hi\"]\n</code></pre>\n\n<p>Basically, what's the difference between these two. thanks in advance, and sorry if I'm being a doof</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1565583964, "post_id": 57453862, "comment_id": 101385220, "body": "<i>Sidenote:</i> you do not need <code>return</code> keyword in the last line of the method; the value is being returned automatically."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1565584093, "post_id": 57453862, "comment_id": 101385236, "body": "<i>Sidenote#2:</i> <b>Never ever</b> put spaces between the method name and the opening parentheses. It might lead to weird parsing errors."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1565584317, "post_id": 57453862, "comment_id": 101385271, "body": "<i>Sidenote#3:</i> the most recent version re-declares a method on <i>rows</i> object every time one calls <code>each</code> and then returns <code>@rows</code> as is. It\u2019 a NOOP with a side effect of re-creating a method."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1565603700, "post_id": 57453862, "comment_id": 101391508, "body": "@AidanofVT : You invoke <code>RubyCsv#each</code> with a block, but your <code>each</code> method does not use any block; hence the block won&#39;t ever be executed. Also, it doesn&#39;t make much sence to have method definitions nested (<code>def</code> inside <code>def</code>). If you really need to dynamically create methods (which is not necessary here), use <code>defmethod</code>."}, {"owner": {"reputation": 47, "user_id": 11891710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lMRD.jpg?s=128&g=1", "display_name": "AidanofVT", "link": "https://stackoverflow.com/users/11891710/aidanofvt"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1565649583, "post_id": 57453862, "comment_id": 101411184, "body": "@user1934428 Thanks. &#39;Turned out I wasn&#39;t understanding where and how to use &#39;yield.&#39; After your prompting, a quick trip to the manual solved my problem."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1565584190, "last_edit_date": 1565584190, "creation_date": 1565583755, "answer_id": 57455605, "question_id": 57453862, "link": "https://stackoverflow.com/questions/57453862/trying-to-modify-method-missing-out-of-ideas/57455605#57455605", "title": "Trying to modify method_missing, out of ideas", "body": "<p>Basically, the idea would be to lookup headers on the missing method call and if there is such a header, find the value that corresponds the index of this header in the row and return it.</p>\n\n<p>Let\u2019s start with preparing CSV.</p>\n\n<pre><code>content =\n  CSV.parse(&lt;&lt;~ROWS, headers: true)\n    one,two\n    lions,tigers\n  ROWS\n#\u21d2 #&lt;CSV::Table mode:col_or_row row_count:2&gt;\n</code></pre>\n\n<p>So far, so good. Let\u2019s monkeypatch the opened class <code>CSV::Row</code> to respond to <code>method_missing</code> in a custom way.</p>\n\n<pre><code>class CSV::Row\n  def method_missing(m, *_args, &amp;_cb)\n    (idx = headers.index(m.to_s)) ? self[idx] : super\n  end\nend\n</code></pre>\n\n<p>Here we check if there is such a header, assigning its index to the local variable if found. If not found, we fall back to the default response with <code>super</code>.</p>\n\n<p>Let\u2019s see how it works.</p>\n\n<pre><code>content.first.one\n#\u21d2 \"lions\"\ncontent.first.two\n#\u21d2 \"tigers\"\ncontent.first.three\n# NoMethodError: undefined method `three' for \n     #&lt;CSV::Row one:\"lions\" two:\"tigers\"\n</code></pre>\n\n<hr>\n\n<p>The code above monkeypatches the core ruby <code>CSV</code> class, but it should not be hard to port to any custom CSV implementation.</p>\n"}], "owner": {"reputation": 47, "user_id": 11891710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lMRD.jpg?s=128&g=1", "display_name": "AidanofVT", "link": "https://stackoverflow.com/users/11891710/aidanofvt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565584190, "creation_date": 1565560135, "question_id": 57453862, "link": "https://stackoverflow.com/questions/57453862/trying-to-modify-method-missing-out-of-ideas", "title": "Trying to modify method_missing, out of ideas", "body": "<p>Here's the assignment: </p>\n\n<blockquote>\n  <p>Modify the CSV application to support an <em>each</em> method to return a <em>CsvRow object.</em> Use <em>method_missing</em> on that CsvRow to return the value for the column for a given heading. For example, for the file:</p>\n  \n  <blockquote>\n    <p>one, two</p>\n    \n    <p>lions, tigers</p>\n  </blockquote>\n  \n  <p>allow an API that works like this:</p>\n  \n  <blockquote>\n    <p>csv = Ruby.Csv</p>\n    \n    <p>csv.each {|row| puts row.one}</p>\n  </blockquote>\n  \n  <p>This should print 'lions'.</p>\n</blockquote>\n\n<p>My attempt is shown below. No errors, it just returns... nothing. I've done my best to check the components piece by piece, and it seems like everything is behaving as expected except that last step, the method_missing method.</p>\n\n<p>I'd appreciate it if somebody could help me understand where I took a wrong turn.</p>\n\n<pre><code>module ActsAsCsv\n\n  def self.included(base)\n    base.extend ClassMethods\n  end\n\n  module ClassMethods\n    def acts_as_csv\n      include InstanceMethods\n    end\n  end\n\n  module InstanceMethods\n    attr_accessor :headers, :csv_contents\n\n    def initialize\n     read\n    end\n\n    def read\n      filename = self.class.to_s.downcase + '.txt'\n      file = File.new(filename)\n      @headers = file.gets.chomp.split(', ')\n      @csv_contents = []\n      file.each do |aRow|\n        @csv_contents &lt;&lt; aRow.chomp.split(', ')\n      end\n      i = 0\n      @rows = {}\n      @headers.each do |a|\n        column = []\n        @csv_contents.each {|b| column &lt;&lt; b[i]}\n        @rows[a] = column\n        i = i+1\n        end\n      @reader = CSVRow.new(@rows)\n      return @reader \n    end\n  end\n\n  class CSVRow\n    attr_accessor  :content\n\n    def initialize (content)\n      @content = content\n    end\n\n    def method_missing (name)\n      @content[name.to_str]\n    end\n\n  end\n\nend\n\nclass RubyCsv\n  include ActsAsCsv\n  acts_as_csv\nend\n\nm = RubyCsv.new\nputs m.headers.inspect\nm.each {|rows| puts rows.a}\n</code></pre>\n\n<p>I also wondered: why not just have the <em>each</em> method return <em>rows</em>, and modify <em>rows.missing_method</em> to return the value associated to the key of the missing method's name?. I tried to implement this various ways, none of which worked. This most recent version at least doesn't return any errors:</p>\n\n<pre><code>    def each\n      def @rows.method_missing (name)\n        return self[name.to_str]\n      end\n      return @rows\n    end\n\n</code></pre>\n"}, {"tags": ["ruby", "sorbet"], "comments": [{"owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 0, "creation_date": 1565914313, "post_id": 57453812, "comment_id": 101502896, "body": "I&#39;ve updated the docs to explain this a bit better now :) <a href=\"https://sorbet.org/docs/procs\" rel=\"nofollow noreferrer\">sorbet.org/docs/procs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 537862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2419732d3fbaf4b86de1f2bbab2931d?s=128&d=identicon&r=PG", "display_name": "user537862", "link": "https://stackoverflow.com/users/537862/user537862"}, "is_accepted": true, "score": 1, "last_activity_date": 1565628924, "creation_date": 1565628924, "answer_id": 57465282, "question_id": 57453812, "link": "https://stackoverflow.com/questions/57453812/how-to-write-a-type-signature-for-a-block-with-sorbet/57465282#57465282", "title": "How to write a type signature for a block with Sorbet?", "body": "<p>Seems like correct usage of signatures to me.</p>\n\n<p>BTW, Additions to docs are super welcome!</p>\n"}], "owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 57465282, "answer_count": 1, "score": 1, "last_activity_date": 1565628924, "creation_date": 1565559549, "question_id": 57453812, "link": "https://stackoverflow.com/questions/57453812/how-to-write-a-type-signature-for-a-block-with-sorbet", "title": "How to write a type signature for a block with Sorbet?", "body": "<p>I'm currently trying to add types to some core Rails methods, and one of them is <a href=\"https://api.rubyonrails.org/classes/ActionController/MimeResponds.html#method-i-respond_to\" rel=\"nofollow noreferrer\"><code>respond_to</code></a>. It can be used with a block, like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>respond_to do |format|\n  format.html\n  format.json { render json: @companies }\nend\n</code></pre>\n\n<p>The problem I'm having is how to type this exactly, since <a href=\"https://sorbet.org/docs/procs\" rel=\"nofollow noreferrer\">the docs on <code>T.proc</code></a> are pretty minimal. The <code>format</code> parameter is an instance of <a href=\"https://api.rubyonrails.org/classes/ActionController/MimeResponds/Collector.html\" rel=\"nofollow noreferrer\"><code>ActionController::MimeResponds::Collector</code></a>. There's no need for the block to return anything (e.g. it's not like <code>Array#select</code> where it evaluates the block and the block returns a boolean).</p>\n\n<p>I think this is the way you'd want to write the signature?:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>sig do\n  params(\n    mimes: T.nilable(Symbol),\n    block: T.proc.params(arg0: ActionController::MimeResponds::Collector).void\n  ).void\nend\ndef respond_to(*mimes, &amp;block); end\n</code></pre>\n\n<p>(We can ignore the <code>*mimes</code> argument for now, that's not important)</p>\n\n<p>It seems like this works, but I just want to make sure I'm understanding the way <code>T.proc</code> is supposed to be used.</p>\n\n<p>(Note there's <a href=\"https://github.com/sorbet/sorbet/issues/1243\" rel=\"nofollow noreferrer\">an issue with blocks that are nilable causing a regression to <code>T.untyped</code></a>, but that's not what I'm confused on at the moment)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unicorn", "monit"], "answers": [{"comments": [{"owner": {"reputation": 1388, "user_id": 2087775, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/34af15a57984ebac74f4b606b810aa69?s=128&d=identicon&r=PG&f=1", "display_name": "Remon Amin", "link": "https://stackoverflow.com/users/2087775/remon-amin"}, "edited": false, "score": 0, "creation_date": 1565704438, "post_id": 57473899, "comment_id": 101430071, "body": "I did remove the restart command , I made a swap too , will check watching the log files as well"}, {"owner": {"reputation": 1388, "user_id": 2087775, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/34af15a57984ebac74f4b606b810aa69?s=128&d=identicon&r=PG&f=1", "display_name": "Remon Amin", "link": "https://stackoverflow.com/users/2087775/remon-amin"}, "edited": false, "score": 0, "creation_date": 1566528706, "post_id": 57473899, "comment_id": 101693039, "body": "I figured it out by including the full path of unicorn and bundle and using the full command of unicorn instead of &quot;/etc/init.d/unicorn_myapp start &quot;"}], "tags": [], "owner": {"reputation": 641, "user_id": 1985204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H2IXd.png?s=128&g=1", "display_name": "boppy", "link": "https://stackoverflow.com/users/1985204/boppy"}, "is_accepted": false, "score": 1, "last_activity_date": 1565684868, "creation_date": 1565684868, "answer_id": 57473899, "question_id": 57453415, "link": "https://stackoverflow.com/questions/57453415/monit-and-unicorn-restart-command-not-working-in-rails-5-2-application/57473899#57473899", "title": "monit and unicorn restart command not working in rails 5.2 application", "body": "<p>Monit mostly uses the <strong>restart</strong> program to <strong>start</strong> a program. I do not know why this is, but I also observed this behavior.</p>\n\n<p>Just try to comment out the \"restart\" line. This should force monit to run the start script, what should not try to kill an existing process.</p>\n\n<p>You might also want to watch your log-file like</p>\n\n<pre><code>CHECK FILE unicorn_log PATH log__file__path___change_me_or_the_world_will_flatten\n    start program = \"/etc/init.d/unicorn_myapp start\"\n    stop  program = \"/etc/init.d/unicorn_myapp stop\"\n\n    # No log File entry for one hour? \n    if timestamp is older than 1 hour then restart\n\n    # Allocate Memery error?\n    if content = \"Cannot allocate memory\" then restart\n</code></pre>\n"}], "owner": {"reputation": 1388, "user_id": 2087775, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/34af15a57984ebac74f4b606b810aa69?s=128&d=identicon&r=PG&f=1", "display_name": "Remon Amin", "link": "https://stackoverflow.com/users/2087775/remon-amin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565684868, "creation_date": 1565555699, "last_edit_date": 1565556313, "question_id": 57453415, "link": "https://stackoverflow.com/questions/57453415/monit-and-unicorn-restart-command-not-working-in-rails-5-2-application", "title": "monit and unicorn restart command not working in rails 5.2 application", "body": "<p>I configured Monit to watch unicorn and restart it when the memory exceeded or the cpu increased above a certain limit ,</p>\n\n<p>how ever when it happens , monit doesn't restart unicorn , and here is the logs  I found in monit log file </p>\n\n<pre><code>\n[UTC Aug 11 20:15:41] error    : 'unicorn_myapp' failed to restart (exit status 127) -- '/etc/init.d/unicorn_myapp restart': /etc/init.d/unicorn_myapp: 27: kill: No such process\n\nCouldn't reload, starting 'cd /home/ubuntu_user/apps/myapp/current;  bundle exec unicorn -D -c /home/ubuntu_user/apps/myapp/shared/config/unicorn.rb -E pr\n[UTC Aug 11 20:16:11] error    : 'unicorn_myapp' process is not running\n[UTC Aug 11 20:16:11] info     : 'unicorn_myapp' trying to restart\n[UTC Aug 11 20:16:11] info     : 'unicorn_myapp' restart: '/etc/init.d/unicorn_myapp restart'\n[UTC Aug 11 20:16:42] error    : 'unicorn_myapp' failed to restart (exit status 127) -- '/etc/init.d/unicorn_myapp restart': /etc/init.d/unicorn_myapp: 27: kill: No such process\n\nCouldn't reload, starting 'cd /home/ubuntu_user/apps/myapp/current;  bundle exec unicorn -D -c /home/ubuntu_user/apps/myapp/shared/config/unicorn.rb -E pr\n[UTC Aug 11 20:17:12] error    : 'unicorn_myapp' process is not running\n[UTC Aug 11 20:17:12] info     : 'unicorn_myapp' trying to restart\n[UTC Aug 11 20:17:12] info     : 'unicorn_myapp' restart: '/etc/init.d/unicorn_myapp restart'\n[UTC Aug 11 20:17:42] error    : 'unicorn_myapp' failed to restart (exit status 127) -- '/etc/init.d/unicorn_myapp restart': /etc/init.d/unicorn_myapp: 27: kill: No such process\n\nCouldn't reload, starting 'cd /home/ubuntu_user/apps/myapp/current;  bundle exec unicorn -D -c /home/ubuntu_user/apps/myapp/shared/config/unicorn.rb -E pr\n[UTC Aug 11 20:18:12] error    : 'unicorn_myapp' process is not running\n\n</code></pre>\n\n<p>Here is my monit configuration under <code>/etc/monit/conf.d/</code></p>\n\n<pre><code>check process unicorn_myapp\n  with pidfile /home/ubuntu_user/apps/myapp/current/tmp/pids/unicorn.pid\n  start program = \"/etc/init.d/unicorn_myapp  start\"\n  stop program = \"/etc/init.d/unicorn_myapp  stop\"\n  restart program = \"/etc/init.d/unicorn_myapp  restart\"\n  if not exist  then restart\n  if mem is greater than 300.0 MB for 2 cycles then restart       # eating up memory?\n  if cpu is greater than 50% for 4 cycles then restart                  # send an email to admin\n  if cpu is greater than 80% for 30 cycles then restart                # hung process?\n  group unicorn\n\n</code></pre>\n\n<p>it should restart unicorn when such error happens which break the app</p>\n\n<p>from <code>unicorn.log file</code> </p>\n\n<pre><code>ERROR -- : Cannot allocate memory - fork(2) (Errno::ENOMEM)\n</code></pre>\n\n<p>when I run  <code>/etc/init.d/unicorn_myapp</code> restart  from terminal it works </p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 5259402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f3c2f0ad97df6f2c796381115c388e?s=128&d=identicon&r=PG&f=1", "display_name": "JVon", "link": "https://stackoverflow.com/users/5259402/jvon"}, "is_accepted": true, "score": 2, "last_activity_date": 1565554148, "creation_date": 1565554148, "answer_id": 57453243, "question_id": 57453210, "link": "https://stackoverflow.com/questions/57453210/wrong-number-of-arguments-error-in-ruby/57453243#57453243", "title": "&#39;Wrong number of arguments&#39; error in RUBY", "body": "<p>Given your operator</p>\n\n<pre><code>  def [](x, y)\n    @data[x][y]\n  end\n</code></pre>\n\n<p>Your map's elements should be accessed via <code>map[i,j]</code> instead of <code>map[i][j]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 213, "user_id": 4518165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde070b1e84f8b0d5d2587b85560e4bf?s=128&d=identicon&r=PG&f=1", "display_name": "castwide", "link": "https://stackoverflow.com/users/4518165/castwide"}, "is_accepted": false, "score": 0, "last_activity_date": 1565557778, "creation_date": 1565557778, "answer_id": 57453633, "question_id": 57453210, "link": "https://stackoverflow.com/questions/57453210/wrong-number-of-arguments-error-in-ruby/57453633#57453633", "title": "&#39;Wrong number of arguments&#39; error in RUBY", "body": "<p>Your definition for <code>Map#[]</code> takes two arguments, so when you call it in <code>build_map_str</code>, it should look like this:</p>\n\n<pre><code>str += case map[i, j]\n</code></pre>\n\n<p>The same will apply when you assign values:</p>\n\n<pre><code>map[0, 0] = 0\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8383688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e41bc00002e11fa0e27171d3e86091?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing_Man", "link": "https://stackoverflow.com/users/8383688/laughing-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57453243, "answer_count": 2, "score": 0, "last_activity_date": 1565557778, "creation_date": 1565553881, "question_id": 57453210, "link": "https://stackoverflow.com/questions/57453210/wrong-number-of-arguments-error-in-ruby", "title": "&#39;Wrong number of arguments&#39; error in RUBY", "body": "<p>I am trying to build custom string based on data from my class <strong>Map</strong>.</p>\n\n<pre><code>class Map\n  def initialize\n    @data = Array.new(3) { Array.new(3, 0) }\n  end\n\n  def [](x, y)\n    @data[x][y]\n  end\n\n  def []=(x, y, value)\n    @data[x][y] = value\n  end\nend\n</code></pre>\n\n<p>This is how I try to build a string:</p>\n\n<pre><code>def build_map_str(map)\n  str = ' '\n  (0..2).each do |i|\n    (0..2).each do |j|\n      str += case map[i][j]\n             when 0\n               \"\u25fb\ufe0f \"\n             when 1\n               \"\u274e \"\n             when 2\n               \"\ud83c\udd7e\ufe0f \"\n             end\n      str += '| ' if i != 2\n    end\n    str += \"\\n\"\n  end\nend\n</code></pre>\n\n<p>And this is how I call this func:</p>\n\n<pre><code>map = Map.new\nstr = build_map_str(map)\n</code></pre>\n\n<p>But I am getting <strong>in `[]': wrong number of arguments (given 1, expected 2)</strong>. How could I fix it?</p>\n"}, {"tags": ["ruby", "rubygems", "rake", "capistrano"], "comments": [{"owner": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 0, "creation_date": 1565634390, "post_id": 57452350, "comment_id": 101406017, "body": "Maybe you should rename gem&#39;s base dir from <code>capistrano-monorepo-assets</code> to <code>capistrano-monorepoassets</code>"}, {"owner": {"reputation": 5570, "user_id": 281460, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cU05x.jpg?s=128&g=1", "display_name": "jwir3", "link": "https://stackoverflow.com/users/281460/jwir3"}, "reply_to_user": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 0, "creation_date": 1565664826, "post_id": 57452350, "comment_id": 101413622, "body": "@LyzardKyng Yes, I actually did this but haven&#39;t pushed it to the github repo yet. My apologies for the stale repository."}], "answers": [{"tags": [], "owner": {"reputation": 5570, "user_id": 281460, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cU05x.jpg?s=128&g=1", "display_name": "jwir3", "link": "https://stackoverflow.com/users/281460/jwir3"}, "is_accepted": true, "score": 0, "last_activity_date": 1565664927, "creation_date": 1565664927, "answer_id": 57470559, "question_id": 57452350, "link": "https://stackoverflow.com/questions/57452350/creating-a-gem-from-a-capistrano-task/57470559#57470559", "title": "Creating a gem from a Capistrano task", "body": "<p>So this actually was happening because I didn't understand that <code>bundle install</code> doesn't support installing local gems by specifying the path in the Gemfile. <a href=\"https://stackoverflow.com/questions/15673269/loaderror-cannot-load-such-file-for-local-gem\">This question</a> actually covers the problem, and, more specifically, the <a href=\"https://stackoverflow.com/a/15690307/281460\">answer here</a> solved it for me.</p>\n"}], "owner": {"reputation": 5570, "user_id": 281460, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cU05x.jpg?s=128&g=1", "display_name": "jwir3", "link": "https://stackoverflow.com/users/281460/jwir3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57470559, "answer_count": 1, "score": 0, "last_activity_date": 1565664927, "creation_date": 1565546484, "question_id": 57452350, "link": "https://stackoverflow.com/questions/57452350/creating-a-gem-from-a-capistrano-task", "title": "Creating a gem from a Capistrano task", "body": "<p>I have a capistrano task I am trying to make into a gem so I can use it in multiple projects. The repository for this gem is located here: </p>\n\n<p><a href=\"https://github.com/FoamFactory/capistrano-monorepo-assets/tree/jwir3/initial-commit\" rel=\"nofollow noreferrer\">https://github.com/FoamFactory/capistrano-monorepo-assets/tree/jwir3/initial-commit</a></p>\n\n<p>I essentially used <a href=\"https://github.com/sheharyarn/capistrano-rake\" rel=\"nofollow noreferrer\">https://github.com/sheharyarn/capistrano-rake</a> as a basis for creating my gem.</p>\n\n<p>I've tested the actual rake script, but I'm actually not importing it into the project right now. Instead, I'm trying to get it to actually import the gem successfully. When I add the gem to my Gemfile as such:</p>\n\n<pre><code>  gem 'capistrano-monorepoassets','0.0.6', path: \"~/Source/capistrano-monorepo-assets/pkg\"\n</code></pre>\n\n<p>Run <code>bundle install</code>, then attempt to import it using the following in my <code>Capfile</code>:</p>\n\n<pre><code>require 'capistrano/monorepoassets'\n</code></pre>\n\n<p>I get an error when I run <code>cap --tasks --trace</code>:</p>\n\n<pre><code>cap aborted!\nLoadError: cannot load such file -- capistrano/monorepoassets\n/home/scottj/Source/foamfactory/designsystem/Capfile:37:in `require'\n/home/scottj/Source/foamfactory/designsystem/Capfile:37:in `&lt;top (required)&gt;'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/rake_module.rb:29:in `load'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/rake_module.rb:29:in `load_rakefile'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:703:in `raw_load_rakefile'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:104:in `block in load_rakefile'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:186:in `standard_exception_handling'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:103:in `load_rakefile'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:82:in `block in run'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:186:in `standard_exception_handling'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/rake-12.3.3/lib/rake/application.rb:80:in `run'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/capistrano-3.11.0/lib/capistrano/application.rb:14:in `run'\n/home/scottj/.rvm/gems/ruby-2.6.1/gems/capistrano-3.11.0/bin/cap:3:in `&lt;top (required)&gt;'\n/home/scottj/.rvm/gems/ruby-2.6.1/bin/cap:23:in `load'\n/home/scottj/.rvm/gems/ruby-2.6.1/bin/cap:23:in `&lt;main&gt;'\n/home/scottj/.rvm/gems/ruby-2.6.1/bin/ruby_executable_hooks:24:in `eval'\n/home/scottj/.rvm/gems/ruby-2.6.1/bin/ruby_executable_hooks:24:in `&lt;main&gt;\n</code></pre>\n\n<p>I can't seem to get it to load the module using <code>require</code>, which is where I'm stuck. Can someone tell me what I'm doing incorrectly?</p>\n"}, {"tags": ["ruby", "io", "subprocess", "pty"], "answers": [{"tags": [], "owner": {"reputation": 1155, "user_id": 869367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/51f5b50028b4d67725f4ad18170a5066?s=128&d=identicon&r=PG", "display_name": "Dan2552", "link": "https://stackoverflow.com/users/869367/dan2552"}, "is_accepted": true, "score": 1, "last_activity_date": 1566425857, "last_edit_date": 1566425857, "creation_date": 1565819664, "answer_id": 57502544, "question_id": 57451744, "link": "https://stackoverflow.com/questions/57451744/ruby-spawn-process-capturing-stdout-stderr-while-behaving-as-if-it-were-spawne/57502544#57502544", "title": "Ruby spawn process, capturing STDOUT/STDERR, while behaving as if it were spawned regularly", "body": "<p>[edited: see the bottom for the amended update]</p>\n\n<p>Figured it out :)</p>\n\n<p>To really understand the problem I read up a lot on how a PTY works. I don't think I really understood it properly until I drew it out. Basically PTY could be used for a Terminal emulator, and that was the simplest way to think of the data flow for it:</p>\n\n<pre><code>keyboard -&gt; OS -&gt; terminal -&gt; master pty -&gt; termios -&gt; slave pty -&gt; shell\n                                               |\n                                               v\n monitor &lt;- OS &lt;- terminal &lt;- master pty &lt;- termios\n</code></pre>\n\n<p>(note: this might not be <em>100%</em> correct, I'm definitely no expert on the subject, just posting it incase it helps anybody else understand it)</p>\n\n<p>So the important bit in the diagram that I hadn't really realised was that when you type, the only reason you see your input on screen is because it's passed <em>back</em> (left-wards) to the master.</p>\n\n<p>So first thing's first - this ruby script should first set the tty to raw (<code>IO.console.raw!</code>), it can restore it after execution is finished (<code>IO.console.cooked!</code>). This'll make sure the keyboard inputs aren't printed by this parent Ruby script.</p>\n\n<p>Second thing is the slave itself should not be raw, so the <code>slave.raw!</code> call is removed. To explain this, I originally added this because it removes extra return carriages from the output: running <code>echo hello</code> results in <code>\"hello\\r\\n\"</code>. What I missed was that this return carriage is a key instruction to the terminal emulator (whoops).</p>\n\n<p>Third thing, the process should only be talking to the slave. Passing <code>STDIN</code> felt convenient, but it upsets the flow shown in the diagram.</p>\n\n<p>This brings up a new problem on how to pass user input through, so I tried this. So we basically pass <code>STDIN</code> to the <code>master</code>:</p>\n\n<pre><code>  input_thread = Thread.new do\n    STDIN.each_char do |char|\n      master.putc(char) rescue nil\n    end\n  end\n</code></pre>\n\n<p>that <em>kind of</em> worked, but it has its own issues in terms of some interactive processes weren't receiving a key some of the time. Time will tell, but using <code>IO.copy_stream</code> instead appears to solve that issue (and reads much nicer of course).</p>\n\n<pre><code>input_thread = Thread.new { IO.copy_stream(STDIN, master) }\n</code></pre>\n\n<hr>\n\n<p>update 21st Aug:</p>\n\n<p>So the above example mostly worked, but for some reason keys like CTRL+c still wouldn't behave correctly. I even looked up <a href=\"https://github.com/alltom/coolterm/commit/73ff4a95359139aeb18c82be6fba844d459793be\" rel=\"nofollow noreferrer\">other people's approach</a> to see what I could be doing wrong, and effectively it seemed the same approach - as <code>IO.copy_stream(STDIN, master)</code> was successfully sending <code>3</code> to the master. None of the following seemed to help at all:</p>\n\n<pre><code>master.putc 3\nmaster.putc \"\\x03\"\nmaster.putc \"\\003\"\n</code></pre>\n\n<p>Before I went and delved into trying to achieve this in a lower level language I tried out 1 more thing - the block syntax. Apparently the block syntax magically fixes this problem. </p>\n\n<p>To prevent this answer getting a bit too verbose, the following appears to work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'pty'\nrequire 'io/console'\n\ndef run\n  output = \"\"\n\n  IO.console.raw!\n\n  input_thread = nil\n\n  PTY.spawn('bash') do |read, write, pid|\n    Signal.trap(:WINCH) { write.winsize = STDOUT.winsize }\n    input_thread = Thread.new { IO.copy_stream(STDIN, write) }\n\n    read.each_char do |char|\n      STDOUT.print char\n      output.concat(char)\n    end\n\n    Process.wait(pid)\n  end\n\n  input_thread.kill if input_thread\n\n  IO.console.cooked!\nend\n\nBundler.send(:with_env, Bundler.clean_env) do\n  run\nend\n\n</code></pre>\n"}], "owner": {"reputation": 1155, "user_id": 869367, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/51f5b50028b4d67725f4ad18170a5066?s=128&d=identicon&r=PG", "display_name": "Dan2552", "link": "https://stackoverflow.com/users/869367/dan2552"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 57502544, "answer_count": 1, "score": 1, "last_activity_date": 1566425857, "creation_date": 1565541109, "question_id": 57451744, "link": "https://stackoverflow.com/questions/57451744/ruby-spawn-process-capturing-stdout-stderr-while-behaving-as-if-it-were-spawne", "title": "Ruby spawn process, capturing STDOUT/STDERR, while behaving as if it were spawned regularly", "body": "<p>What I'm trying to achieve:</p>\n\n<ul>\n<li>From a Ruby process, spawning a subprocess</li>\n<li>The subprocess should print as normal back to the terminal. By \"normal\", I mean the process shouldn't miss out color output, or ignore user input (STDIN).</li>\n<li>For that subprocess, capturing STDOUT/STDERR (jointly) e.g. into a String variable that can be accessed after the subprocess is dead. Escape characters and all.</li>\n</ul>\n\n<p>Capturing STDOUT/STDERR is possible by passing a different IO pipe, however the subprocess can then detect that it's not in a <code>tty</code>. For example <code>git log</code> will not print characters that influence text color, nor use it's pager.</p>\n\n<p>Using a <code>pty</code> to launch the process essentially \"tricks\" the subprocess into thinking it's being launched by a user. As far as I can tell, this is exactly what I want, and the result of this essentially ticks all the boxes.</p>\n\n<p>My general tests to test if a solution fits my needs is:</p>\n\n<ul>\n<li>Does it run <code>ls -al</code> normally?</li>\n<li>Does it run <code>vim</code> normally?</li>\n<li>Does it run <code>irb</code> normally?</li>\n</ul>\n\n<p>The following Ruby code is able to check all the above:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>to_execute = \"vim\"\n\noutput = \"\"\nrequire 'pty'\nrequire 'io/console'\n\nmaster, slave = PTY.open\nslave.raw!\n\npid = ::Process.spawn(to_execute, :in =&gt; STDIN, [:out, :err] =&gt; slave)\nslave.close\nmaster.winsize = $stdout.winsize\nSignal.trap(:WINCH) { master.winsize = $stdout.winsize }\nSignal.trap(:SIGINT) { ::Process.kill(\"INT\", pid) }\n\nmaster.each_char do |char|\n  STDOUT.print char\n  output.concat(char)\nend\n\n::Process.wait(pid)\nmaster.close\n</code></pre>\n\n<p>This works for the most part but it turns out it's not perfect. For some reason, certain applications seem to fail to switch into a <code>raw</code> state. Even though <code>vim</code> works perfectly fine, it turned out neovim did not. At first I thought it was a bug in neovim but I have since been able to reproduce the problem using the Termion crate for the Rust language.</p>\n\n<p>By setting to raw manually (<code>IO.console.raw!</code>) before executing, applications like neovim behave as expected, but then applications like <code>irb</code> do not.</p>\n\n<p>Oddly spawning <em>another</em> pty in Python, <em>within this pty</em>, allows the application to work as expected (using <code>python -c 'import pty; pty.spawn(\"/usr/local/bin/nvim\")'</code>). This obviously isn't a real solution, but interesting nonetheless.</p>\n\n<p>For my actual question I guess I'm looking towards any help to resolving the weird <code>raw</code> issue or, say if I've completely misunderstood tty/pty, any different direction to where/how I should look at the problem. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 557531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c8e377abc4294c356304d1622f0ac87?s=128&d=identicon&r=PG", "display_name": "Rolando Murillo", "link": "https://stackoverflow.com/users/557531/rolando-murillo"}, "is_accepted": false, "score": 1, "last_activity_date": 1565537023, "last_edit_date": 1565537023, "creation_date": 1565536605, "answer_id": 57451199, "question_id": 57451136, "link": "https://stackoverflow.com/questions/57451136/controller-params-behaving-differently-on-test-environment-vs-development/57451199#57451199", "title": "Controller `params` behaving differently on test environment vs. development", "body": "<p>Turns out Rails allows you to omit the root element of your request when making <em>correct</em> JSON requests. In my case, my test wasn't encoding correctly as JSON, so this behavior wasn't occurring.</p>\n\n<p>More information here: <a href=\"https://edgeguides.rubyonrails.org/action_controller_overview.html#json-parameters\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/action_controller_overview.html#json-parameters</a></p>\n\n<blockquote>\n  <p>[\u2026] if you've turned on config.wrap_parameters in your initializer or called wrap_parameters in your controller, you can safely omit the root element in the JSON parameter. In this case, the parameters will be cloned and wrapped with a key chosen based on your controller's name. So the above JSON request can be written as [\u2026]</p>\n</blockquote>\n\n<p>To avoid this going forward, I plan on wrapping my params in my helper method for tests:</p>\n\n<pre><code>def json_request(params)\n  {\n    params: params.to_json,\n    headers: { 'CONTENT_TYPE' =&gt; 'application/json' }\n  }\nend\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 557531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c8e377abc4294c356304d1622f0ac87?s=128&d=identicon&r=PG", "display_name": "Rolando Murillo", "link": "https://stackoverflow.com/users/557531/rolando-murillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565537023, "creation_date": 1565536068, "question_id": 57451136, "link": "https://stackoverflow.com/questions/57451136/controller-params-behaving-differently-on-test-environment-vs-development", "title": "Controller `params` behaving differently on test environment vs. development", "body": "<p>I'm using strong parameters for my <code>ShareOptions</code> controller, like so:</p>\n\n<pre><code>def share_option_params\n  params.require(:share_option).permit(:public_read, :team_read, :team_write)\nend\n</code></pre>\n\n<p>As you can see, <code>:share_option</code> is required, so when I test PUT with the attributes directly in a JSON body like this: <code>{ public_read: true }</code>, my test correctly fails because they're not nested under <code>share_option</code>. Using <code>binding.pry</code>, this is the output of <code>share_option_params</code>:</p>\n\n<pre><code>&lt;ActionController::Parameters {\"public_read\"=&gt;\"true\", \"format\"=&gt;:json, \"controller\"=&gt;\"api/share_options\", \"action\"=&gt;\"update\", \"id\"=&gt;\"553\"} permitted: false&gt;\n</code></pre>\n\n<p>However, this is not the case with my JS frontend where the same request is successful. There, I'm sending <code>{ public_read: true }</code> directly, not nested. In this case, it appears as if <code>share_option</code> is automatically added, here the output of <code>share_options_params</code>:</p>\n\n<pre><code>&lt;ActionController::Parameters {\"public_read\"=&gt;true, \"format\"=&gt;:json, \"controller\"=&gt;\"api/share_options\", \"action\"=&gt;\"update\", \"id\"=&gt;\"332\", \"share_option\"=&gt;{\"public_read\"=&gt;true}} permitted: false&gt;\n</code></pre>\n\n<p>At this point, I'm suspecting that Rails is doing something behind the scenes. But it's not clear to me at all as to why this is happening.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1565537001, "post_id": 57451070, "comment_id": 101377376, "body": "check this links: <a href=\"https://stackoverflow.com/questions/4132525/getaddrinfo-nodename-nor-servname-provided-or-not-known\" title=\"getaddrinfo nodename nor servname provided or not known\">stackoverflow.com/questions/4132525/&hellip;</a>  <a href=\"https://stackoverflow.com/questions/28768934/rails-server-cannot-start-getaddrinfo-nodename-nor-servname-provided-or-not-k\" title=\"rails server cannot start getaddrinfo nodename nor servname provided or not k\">stackoverflow.com/questions/28768934/&hellip;</a>"}, {"owner": {"reputation": 702, "user_id": 2813483, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a806405fb6823e63f56544a44d1323b1?s=128&d=identicon&r=PG&f=1", "display_name": "tessie", "link": "https://stackoverflow.com/users/2813483/tessie"}, "edited": false, "score": 0, "creation_date": 1565540068, "post_id": 57451070, "comment_id": 101378025, "body": "What is the value of host you provided?. It looks like your host configuration is wrong."}, {"owner": {"reputation": 203, "user_id": 11769090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb45aab61b40ec221ad590a73332914?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanga", "link": "https://stackoverflow.com/users/11769090/priyanga"}, "edited": false, "score": 0, "creation_date": 1565541649, "post_id": 57451070, "comment_id": 101378407, "body": "In which file we give host configuration?"}], "owner": {"reputation": 203, "user_id": 11769090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb45aab61b40ec221ad590a73332914?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanga", "link": "https://stackoverflow.com/users/11769090/priyanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565538631, "creation_date": 1565535526, "last_edit_date": 1565538631, "question_id": 57451070, "link": "https://stackoverflow.com/questions/57451070/error-while-executing-rails-application-with-action-cable", "title": "Error while executing rails application with action cable", "body": "<p><strong>This is my error:</strong></p>\n\n<pre><code>&lt;Thread:0x00007fde3dc23378@/.rvm/gems/ruby-2.5.1/gems/actioncable-5.2.3/lib/action_cable/subscription_adapter/redis.rb:148 run&gt; terminated with exception (report_on_exception is true):\nTraceback (most recent call last):\n    26: from /.rvm/gems/ruby-2.5.1/gems/actioncable-5.2.3/lib/action_cable/subscription_adapter/redis.rb:152:in `block in ensure_listener_running'\n    25: from /.rvm/gems/ruby-2.5.1/gems/actioncable-5.2.3/lib/action_cable/subscription_adapter/redis.rb:78:in `listen'\n    24: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:70:in `without_reconnect'\n    23: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:63:in `with_reconnect'\n    22: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:58:in `synchronize'\n    21: from /.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n    20: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:58:in `block in synchronize'\n    19: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:64:in `block in with_reconnect'\n    18: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:293:in `with_reconnect'\n    17: from /.rvm/gems/ruby-2.5.1/gems/actioncable-5.2.3/lib/action_cable/subscription_adapter/redis.rb:81:in `block in listen'\n    16: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:2142:in `subscribe'\n    15: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:58:in `synchronize'\n    14: from /.rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n    13: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:58:in `block in synchronize'\n    12: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:2143:in `block in subscribe'\n    11: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis.rb:2775:in `_subscription'\n    10: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/subscribe.rb:12:in `subscribe'\n     9: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/subscribe.rb:43:in `subscription'\n     8: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:133:in `call_loop'\n     7: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:276:in `with_socket_timeout'\n     6: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:100:in `connect'\n     5: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:293:in `with_reconnect'\n     4: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:101:in `block in connect'\n     3: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/client.rb:336:in `establish_connection'\n     2: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/connection/ruby.rb:313:in `connect'\n     1: from /.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/connection/ruby.rb:229:in `connect'\n/.rvm/gems/ruby-2.5.1/gems/redis-3.3.5/lib/redis/connection/ruby.rb:229:in **`getaddrinfo': getaddrinfo: nodename nor servname provided, or not known (SocketError)**\nExiting\n</code></pre>\n\n<p>I have tried <a href=\"https://medium.com/rubyinside/action-cable-hello-world-with-rails-5-1-efc475b0208b\" rel=\"nofollow noreferrer\">https://medium.com/rubyinside/action-cable-hello-world-with-rails-5-1-efc475b0208b</a></p>\n"}, {"tags": ["ruby", "ruby-on-rails-5.2"], "answers": [{"tags": [], "owner": {"reputation": 4571, "user_id": 343759, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/N9IKE.jpg?s=128&g=1", "display_name": "rewolf", "link": "https://stackoverflow.com/users/343759/rewolf"}, "is_accepted": false, "score": 2, "last_activity_date": 1565534302, "creation_date": 1565534302, "answer_id": 57450888, "question_id": 57450814, "link": "https://stackoverflow.com/questions/57450814/loaderror-cannot-load-such-file-rake-task/57450888#57450888", "title": "LoadError: cannot load such file (Rake Task)", "body": "<p><code>require</code> is used to import a library or module that has been installed properly.\nIf you're trying to access something in the same directory or internal to a library or project, then try using <code>require_relative</code></p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565534302, "creation_date": 1565533758, "question_id": 57450814, "link": "https://stackoverflow.com/questions/57450814/loaderror-cannot-load-such-file-rake-task", "title": "LoadError: cannot load such file (Rake Task)", "body": "<p>What is the correct way to reference a <code>require</code> in Ruby on Rails?</p>\n\n<p>error: </p>\n\n<blockquote>\n  <blockquote>\n    <p>LoadError: cannot load such file 'lib/appname/loader/model_import'</p>\n  </blockquote>\n</blockquote>\n\n<p>Rake Task:</p>\n\n<pre><code>require 'csv'\nrequire 'lib/appname/loader/model_import'\n\nnamespace :app_name do\n  namespace :loader do\n\n    desc \"Loads data into Database\"\n\n    task model_import: :environment  do\n\n      include AppName::Loader::ModelImport\n    end\n  end\nend\n</code></pre>\n"}]