[{"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "edited": false, "score": 0, "creation_date": 1549226069, "post_id": 46832305, "comment_id": 95818260, "body": "I&#39;ve seen this too. I think it&#39;s just a generic sniff."}], "tags": [], "owner": {"reputation": 1122, "user_id": 2353990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af3d023b028ba0dd7118a17a67358dc6?s=128&d=identicon&r=PG", "display_name": "andiba", "link": "https://stackoverflow.com/users/2353990/andiba"}, "is_accepted": false, "score": 1, "last_activity_date": 1508423252, "creation_date": 1508423252, "answer_id": 46832305, "question_id": 46820290, "link": "https://stackoverflow.com/questions/46820290/ror-request-for-hacking-ruby-hash-u003aactiondispatch-u003a-u003arouting-u/46832305#46832305", "title": "RoR Request for Hacking. --- !ruby/hash\\u003aActionDispatch\\u003a\\u003aRouting\\u003a\\u003aRouteSet\\u003a\\u003aNamedRouteCollection", "body": "<p>hmmm, it looks like yaml serialized ruby code: Something like</p>\n\n<p>ActionDispatch::Routing::RouteSet::NamedRouteCollection 'NSFTW;sleep(25);'</p>\n\n<p><code>eval(%[c2xlZXAoMjUp].unpack(%[m0])[0])</code> run in an <code>irb</code>-session outputs\n<code>sleep(25)</code></p>\n\n<p>and finally, we have a ruby-<code>OpenStruct</code> object named <code>table</code> and a <code>defaults</code> property.</p>\n\n<p>Does that match any service your platform offers?</p>\n"}], "owner": {"reputation": 19, "user_id": 6610885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a5vLv.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/6610885/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508423252, "creation_date": 1508366229, "question_id": 46820290, "link": "https://stackoverflow.com/questions/46820290/ror-request-for-hacking-ruby-hash-u003aactiondispatch-u003a-u003arouting-u", "title": "RoR Request for Hacking. --- !ruby/hash\\u003aActionDispatch\\u003a\\u003aRouting\\u003a\\u003aRouteSet\\u003a\\u003aNamedRouteCollection", "body": "<p>Someone tried to 'check' my platform. I got this kind of request:</p>\n\n<pre><code>---- !ruby/hash\\u003aActionDispatch\\u003a\\u003aRouting\\u003a\\u003aRouteSet\\u003a\\u003aNamedRouteCollection 'NSFTW;eval(%[c2xlZXAoMjUp].unpack(%[m0])[0]);' \\u003a !ruby/object\\u003aOpenStruct table\\u003a \\u003adefaults\\u003a {}\n</code></pre>\n\n<p>The question is What he tried to do? What are the expectations after that request?</p>\n"}, {"tags": ["ruby", "pry"], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508366200, "creation_date": 1508366200, "question_id": 46820285, "link": "https://stackoverflow.com/questions/46820285/how-to-keep-time-with-pry-history", "title": "How to keep time with pry history", "body": "<p>In <code>zsh</code> I can see the time when the command is launched by <code>history -E</code>.</p>\n\n<p>Is there a similar way to show the time in pry history?</p>\n\n<p>pry's <code>hist</code> command shows without time and I couldn't find info for it.</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "cucumber"], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 8798283, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0522bfc3b8fd78d05a7d4e1bbee5188e?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/8798283/jas"}, "edited": false, "score": 0, "creation_date": 1508523674, "post_id": 46820901, "comment_id": 80657594, "body": "Thanks Kyle I found that the following worked for me:  <code>@wait.until {@driver.find_element(:css =&gt; &#39;input.ember-power-select-trigger-multiple-input&#39;).click}</code> <code>@wait.until {@driver.find_element(:css =&gt; &#39;.ember-view &gt; li &gt; .ember-view &gt; li:nth-of-type(1) &gt; .ember-view &gt; li&#39;).click}</code>"}], "tags": [], "owner": {"reputation": 2754, "user_id": 5114911, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1698453063709112/picture?type=large", "display_name": "KyleFairns", "link": "https://stackoverflow.com/users/5114911/kylefairns"}, "is_accepted": false, "score": 0, "last_activity_date": 1508371481, "last_edit_date": 1508371481, "creation_date": 1508370590, "answer_id": 46820901, "question_id": 46820127, "link": "https://stackoverflow.com/questions/46820127/how-can-i-select-the-first-option-inside-a-dropdown-menu-by-targeting-css/46820901#46820901", "title": "How can I select the first option inside a dropdown menu by targeting css?", "body": "<h2>Until</h2>\n\n<p>The \u201cuntil\u201d method within Selenium requires a \u201ctruthy\u201d response to continue with the rest of the code.</p>\n\n<p>What you could do is this:</p>\n\n<pre><code>power_select = @driver.find_element(:css =&gt; 'input.ember-power-select-trigger-multiple-input')\n@wait.until {power_select.displayed?}\npower_select.click\n</code></pre>\n\n<p>This will wait for the element to be displayed on the page, which returns a boolean, and then follow through with a click</p>\n\n<h2>Select</h2>\n\n<p>Following on from that, the methods for Selects are hidden within the library quite well, but after searching around for a bit:</p>\n\n<p>To Select by text:</p>\n\n<pre><code>Selenium::WebDriver::Support::Select.new(@driver.find_element(:css =&gt; &lt;insert_css_of_select_here&gt;)).select_by(:text, &lt;insert_option_text_here&gt;)\n</code></pre>\n\n<p>To Select by index:</p>\n\n<pre><code>Selenium::Webdriver::Support::Select.new(@driver.find_element(:css =&gt; &lt;insert_css_of_select_here&gt;)).select_by(:index, &lt;insert_index_value_here&gt;)\n</code></pre>\n\n<p>Selecting by index is what you most likely want to do here, setting the index value to 0 to select the first option.</p>\n"}, {"tags": [], "owner": {"reputation": 485, "user_id": 8798283, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0522bfc3b8fd78d05a7d4e1bbee5188e?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/8798283/jas"}, "is_accepted": false, "score": 1, "last_activity_date": 1508523829, "creation_date": 1508523829, "answer_id": 46855124, "question_id": 46820127, "link": "https://stackoverflow.com/questions/46820127/how-can-i-select-the-first-option-inside-a-dropdown-menu-by-targeting-css/46855124#46855124", "title": "How can I select the first option inside a dropdown menu by targeting css?", "body": "<pre><code>@wait.until {@driver.find_element(:css =&gt; 'input.ember-power-select-trigger-multiple-input').click}\n@wait.until {@driver.find_element(:css =&gt; '.ember-view &gt; li &gt; .ember-view &gt; li:nth-of-type(1) &gt; .ember-view &gt; li').click}\n</code></pre>\n\n<p>This worked.</p>\n"}, {"tags": [], "owner": {"reputation": 1380, "user_id": 1851294, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af532b12294b961a4c71948b186a5a97?s=128&d=identicon&r=PG", "display_name": "Sbbs", "link": "https://stackoverflow.com/users/1851294/sbbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1535990430, "creation_date": 1535990430, "answer_id": 52153100, "question_id": 46820127, "link": "https://stackoverflow.com/questions/46820127/how-can-i-select-the-first-option-inside-a-dropdown-menu-by-targeting-css/52153100#52153100", "title": "How can I select the first option inside a dropdown menu by targeting css?", "body": "<p>This will let you select required option of ember-power-select with Capybara:</p>\n\n<pre><code>find('.ember-power-select-trigger').click # Open trigger\nfind_all('ul.ember-power-select-options &gt; li')[1].click # Select 2nd option\n</code></pre>\n\n<p>Tested with latest ember-power-select.</p>\n\n<p>You might find the click be quite slow if your <code>Capybara.default_max_wait_time</code> is high, so to speed things further you can do this:</p>\n\n<pre><code>find('.ember-power-select-trigger').click # Open trigger\nCapybara.using_wait_time(0.1) do\n  find_all('ul.ember-power-select-options &gt; li')[1].click # Select 2nd option\nend\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 8798283, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0522bfc3b8fd78d05a7d4e1bbee5188e?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/8798283/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1535990430, "creation_date": 1508365176, "last_edit_date": 1508415146, "question_id": 46820127, "link": "https://stackoverflow.com/questions/46820127/how-can-i-select-the-first-option-inside-a-dropdown-menu-by-targeting-css", "title": "How can I select the first option inside a dropdown menu by targeting css?", "body": "<p>I'm currently using Cucumber / Selenium / Ruby to create my automation framework and setup my first test. The one I'm working on involves me to fill in a form in order to proceed to the next stage. The form contains a dropdown with multiple values, of which I want to select one (and any one!)</p>\n\n<p><strong>Inspect Element of the Dropdown Menu</strong></p>\n\n<pre><code>&lt;input type=\"search\" class=\"ember-power-select-trigger-multiple-input\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" id=\"ember-power-select-trigger-multiple-input-ember3325\" aria-controls=\"ember-power-select-options-ember3325\" style=\"width: 100%;\" placeholder=\"All classes\"&gt;\n</code></pre>\n\n<p>I've therefore made use of the <code>class</code> inside my step below:</p>\n\n<p><strong>My Step</strong></p>\n\n<pre><code>@wait.until {@driver.find_element(:css =&gt; 'input.ember-power-select-trigger-multiple-input').click}\n</code></pre>\n\n<p>At the moment, when I run this, it's able to find the correct dropdown option and click it. The options in the list appear, but obviously nothing happens. </p>\n\n<p>What I'd like to know is how I can extend this further so that the dropdown is selected, and that the \"first\" option is selected? I don't want to specify what it should be, but it just should randomly select the first from the list and use that. </p>\n\n<p>Any thoughts on the easiest way to achieve this?</p>\n\n<hr>\n\n<p><strong>Research Snippet</strong>\nI did some research and found the following snippet which I thought I could add to my code, however I'm unsure if it would actually work, or whether I could use this in conjunction with the <code>@wait.until</code> step that I mentioned above? </p>\n\n<pre><code>groupDropdown = @driver.find_element(:css =&gt; 'input.ember-power-select-trigger-multiple-input')\noption = groupDropdown.find_element(:css, \"option:nth-child(1)\")\noption.click\n</code></pre>\n"}, {"tags": ["ruby", "docker", "bundler", "dockerfile", "root"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508361407, "post_id": 46819364, "comment_id": 80586137, "body": "are there non-root users of the machine?"}, {"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508361506, "post_id": 46819364, "comment_id": 80586196, "body": "this is a docker container so I don&#39;t think so."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508361680, "post_id": 46819364, "comment_id": 80586303, "body": "i don&#39;t either. why not just ignore the warning?"}, {"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508361969, "post_id": 46819364, "comment_id": 80586463, "body": "The full log that comes from that container is : Don&#39;t run Bundler as root. Bundler can ask for sudo if it is needed, and installing your bundle as root will break this application for all non-root users on this machine. Could not locate Gemfile. Do you know anything about this &quot;Could not locate Gemfile&quot; ?"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508363259, "post_id": 46819364, "comment_id": 80587037, "body": "running bundle requires a gemfile in the directory, either there is no gemfile, or you are in the wrong directory"}, {"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508365105, "post_id": 46819364, "comment_id": 80587710, "body": "What can I do to work with this type of failure? ... I am not deploying any ruby app I just want ruby and bundler installed as part of this docker image and that&#39;s it ..."}], "answers": [{"comments": [{"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "edited": false, "score": 0, "creation_date": 1508372526, "post_id": 46820578, "comment_id": 80589703, "body": "I decided to build this container starting from an ubuntu image. Actually now I am only dealing with &quot;Could not locate Gemfile&quot;"}, {"owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "reply_to_user": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "edited": false, "score": 0, "creation_date": 1508373615, "post_id": 46820578, "comment_id": 80589934, "body": "The <a href=\"https://github.com/docker-library/ruby/blob/9390129c08cc19668fc482edfd7d7c5a890a80eb/2.4/stretch/Dockerfile\" rel=\"nofollow noreferrer\"><code>2.4-stretch</code></a> image will be pretty close to Ubuntu. The <code>Gemfile</code> and your app should be <code>COPY</code>d or <code>ADD</code>ed to the image before you run <code>bundle</code>"}], "tags": [], "owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "is_accepted": false, "score": 3, "last_activity_date": 1588639284, "last_edit_date": 1588639284, "creation_date": 1508368333, "answer_id": 46820578, "question_id": 46819364, "link": "https://stackoverflow.com/questions/46819364/how-to-install-ruby-and-bundler-with-dockerfile/46820578#46820578", "title": "How to install ruby and bundler with dockerfile?", "body": "<p>There are pre built <a href=\"https://hub.docker.com/_/ruby/\" rel=\"nofollow noreferrer\">ruby</a> images (e.g <a href=\"https://github.com/docker-library/ruby/blob/a564feaaee4c8647c299ab11d41498468bb9af7b/2.7/alpine3.11/Dockerfile\" rel=\"nofollow noreferrer\">Alpine 3.11 Ruby 2.7</a>) that include <code>bundler</code>. It's easier to start with them as they generally use the current \"best practices\" to build. </p>\n\n<p>Notice that they set the <a href=\"https://github.com/docker-library/ruby/blob/a564feaaee4c8647c299ab11d41498468bb9af7b/2.7/alpine3.11/Dockerfile#L122\" rel=\"nofollow noreferrer\"><code>BUNDLE_SILENCE_ROOT_WARNING</code></a> environment variable with <a href=\"https://docs.docker.com/engine/reference/builder/#env\" rel=\"nofollow noreferrer\"><code>ENV</code></a> directive in the image build to remove that <code>root</code> warning. </p>\n\n<p>You normally wouldn't run <code>bundler</code> as the <a href=\"https://docs.docker.com/engine/reference/builder/#cmd\" rel=\"nofollow noreferrer\"><code>CMD</code></a> for a container either, you might run <code>bundler</code> during a <a href=\"https://docs.docker.com/engine/reference/builder/#run\" rel=\"nofollow noreferrer\"><code>RUN</code></a> image build step though. </p>\n\n<p>Running containers as non-root users is not a bad idea in any case. Use the <a href=\"https://docs.docker.com/engine/reference/builder/#user\" rel=\"nofollow noreferrer\"><code>USER</code></a> directive to change that. </p>\n\n<pre><code>FROM ruby:2.7\nWORKDIR /app\nADD . /app/\nRUN set -uex; \\\n    bundle install; \\\n    adduser -D rubyapp; \\\n    mkdir -p /app/data; \\\n    chown rubyapp /app/data\nUSER rubyapp\nCMD [ \"ruby\", \"whatever.rb\" ]\n</code></pre>\n"}], "owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5084, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1588639284, "creation_date": 1508361304, "last_edit_date": 1508365277, "question_id": 46819364, "link": "https://stackoverflow.com/questions/46819364/how-to-install-ruby-and-bundler-with-dockerfile", "title": "How to install ruby and bundler with dockerfile?", "body": "<p>New to ruby and bundler here.\nI am installing them in a docker image with this docker file:</p>\n\n<pre><code>FROM alpine:3.5\n\n# Install Ruby, Ruby Bundler and other ruby dependencies\n\nRUN apk add --update \\\n      ruby ruby-bigdecimal ruby-bundler \\\n      ca-certificates libressl \\\n      libressl-dev build-base ruby-dev \\\n      ruby-rdoc ruby-io-console ruby-irb; \\\n\\\n    &amp;&amp; bundle config build.nokogiri --use-system-libraries; \\\n    &amp;&amp; bundle config git.allow_insecure true; \\\n\\\n    &amp;&amp; gem install json foreman --no-rdoc --no-ri; \\\n    &amp;&amp; gem cleanup; \\\n    &amp;&amp; rm -rf /usr/lib/ruby/gems/*/cache/*; \\\n    &amp;&amp; apk del libressl-dev build-base ruby-dev; \\\n    &amp;&amp; rm -rf /var/cache/apk/* /tmp;\n\nCMD [\"bundle\"]\n</code></pre>\n\n<p>When I run do a docker run I get: </p>\n\n<pre><code>Don't run Bundler as root. Bundler can ask for sudo if it is needed,\nand installing your bundle as root will break this application for all\nnon-root users on this machine.\nCould not locate Gemfile or .bundle/ directory\n</code></pre>\n\n<p>How do I resolve this? I just want to install ruby and ruby-bundle and be done with this ...</p>\n"}, {"tags": ["ruby", "methods", "programming-languages", "constants", "name-lookup"], "comments": [{"owner": {"reputation": 404, "user_id": 1888553, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WznXZ.jpg?s=128&g=1", "display_name": "Derrell Durrett", "link": "https://stackoverflow.com/users/1888553/derrell-durrett"}, "edited": false, "score": 0, "creation_date": 1508362243, "post_id": 46819199, "comment_id": 80586582, "body": "This is an incomprehensible design to me. In OOP I would never expect to be able to look for something defined in a child class except (and my understanding is there&#39;s debate on the value of this) a method whose behavior is overridden. Certainly you should never expect something defined only in a subclass to be visible to its parent."}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1508364114, "post_id": 46819199, "comment_id": 80587373, "body": "From me: version that uses method - calls constant in scope of class <code>SubClass</code> so it&#39;s work, in another one you calls <code>FOO_CONSTANT</code> and it trying to find this constant in scope of <code>MyClass</code>, to make it workable: just write <code>SubClass::FOO_CONSTANT</code>"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1508360996, "post_id": 46819200, "comment_id": 80585920, "body": "I think it can be summarized as &quot;lexically outwards, then dynamically upwards&quot;, but IIRC I found examples where that doesn&#39;t actually hold. I don&#39;t remember what they were, though. Yugui once wrote a series of articles about the various implicit contexts and lookups in Ruby, but unfortunately, while she mentioned working on an article about constant lookup, that article never appeared."}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508361112, "post_id": 46819200, "comment_id": 80585976, "body": "I was amazed how complex constant lookup is when I started digging into YARV. Ruby&#39;s slick interface is the result of some gnarly implementation! &quot;Natural, not simple.&quot;"}], "tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": true, "score": 2, "last_activity_date": 1508360596, "creation_date": 1508360596, "answer_id": 46819200, "question_id": 46819199, "link": "https://stackoverflow.com/questions/46819199/why-doesnt-ruby-find-constants-defined-in-the-callers-class/46819200#46819200", "title": "Why doesn&#39;t Ruby find constants defined in the caller&#39;s class?", "body": "<p>This was a puzzle that I encountered in real production code. I wrote up a detailed explanation of what's going on in <a href=\"https://engineering.thriveglobal.com/a-puzzle-about-ruby-constants-e958d15dbada\" rel=\"nofollow noreferrer\">this blog post</a>.</p>\n\n<p>Here's the TLDR: Ruby uses a much more complex algorithm for resolving constants than it does for methods. One phase of the constant lookup routine involves looking through the superclass chain for the definition. This phase looks very much like the method lookup routine, deepening the mystery of why methods and constants differ in the way illustrated in the question.</p>\n\n<p>The explanation is that the two superclass chain routines differ in where they <em>start</em>, i.e. which class is the root of the chain.</p>\n\n<p>Method lookup starts with <code>self</code>'s class, where <code>self</code> is the receiver of the original method call. In the example, <code>sub_class_instance</code> is the receiver and <code>SubClass</code> is where the lookup starts. <code>SubClass</code> implements <code>foo_method</code>, so all is well.</p>\n\n<p>For constants, Ruby doesn't refer to a receiver, because constant invocations aren't relative to a receiver. Instead, constant superclass lookup begins with the class that's open at the lexical scope where the constant invocation occurs. In the example, the class that's open is <code>MyClass</code>, so thats where Ruby starts to looks for the constant\u2014and never finds it.</p>\n"}], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 46819200, "answer_count": 1, "score": 1, "last_activity_date": 1508360596, "creation_date": 1508360596, "question_id": 46819199, "link": "https://stackoverflow.com/questions/46819199/why-doesnt-ruby-find-constants-defined-in-the-callers-class", "title": "Why doesn&#39;t Ruby find constants defined in the caller&#39;s class?", "body": "<p>Consider the following code:</p>\n\n<pre><code>class MyClass\n  def foo_via_method\n    foo_method\n  end\n\n  def foo_via_constant\n    FOO_CONSTANT\n  end\nend\n\nclass SubClass &lt; MyClass\n  FOO_CONSTANT = \"foo\"\n\n  def foo_method\n    FOO_CONSTANT\n  end\nend\n</code></pre>\n\n<p>The two instance methods here behave differently:</p>\n\n<pre><code>sub_class_instance = SubClass.new\n\n### THIS WORKS ###\nsub_class_instance.foo_via_method\n# =&gt; \"foo\"\n\n### THIS DOESN'T ###\nsub_class_instance.foo_via_constant\n# NameError: uninitialized constant MyClass::FOO_CONSTANT\n</code></pre>\n\n<p>The version that refers to a method in the subclass returns the desired value, but the version that refers to a constant in subclass throws an error. So the puzzle is this: Why does the version that uses a method work but the version that uses the constant fail?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-places", "rails-geocoder"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508358145, "post_id": 46818381, "comment_id": 80584509, "body": "This question is way too nebulous, it&#39;s lacking code to add important context."}, {"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1508358278, "post_id": 46818381, "comment_id": 80584578, "body": "Are you implementing an autocomplete?"}, {"owner": {"reputation": 143, "user_id": 4930434, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/880140592046671/picture?type=large", "display_name": "Lucas Oliveira", "link": "https://stackoverflow.com/users/4930434/lucas-oliveira"}, "edited": false, "score": 0, "creation_date": 1508358447, "post_id": 46818381, "comment_id": 80584676, "body": "Not at the moment"}, {"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1508359099, "post_id": 46818381, "comment_id": 80585023, "body": "Your implementation is not clear.. how do you want to search? Are you searching on client side using the places api or with a help of some gem? What for do you need the Geocoder for? Do you really need the lat and lon?"}], "owner": {"reputation": 143, "user_id": 4930434, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/880140592046671/picture?type=large", "display_name": "Lucas Oliveira", "link": "https://stackoverflow.com/users/4930434/lucas-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508358234, "creation_date": 1508357241, "last_edit_date": 1508358234, "question_id": 46818381, "link": "https://stackoverflow.com/questions/46818381/geocoder-search-only-by-city", "title": "Geocoder search only by city?", "body": "<p>I'm using Geocoder with google places API on my Ruby on Rails api,</p>\n\n<p>I would like to search locations but only if the city params match my query string.</p>\n\n<p>Eg. Searching for 'X' locations return cities called 'X', with no chance of returning a street or country also called 'X'.</p>\n\n<pre><code>Geocoder.search.city('X') #I'm aware that this doesn't work\n</code></pre>\n"}, {"tags": ["ruby", "excel", "math", "formula", "interpolation"], "comments": [{"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508358112, "post_id": 46818352, "comment_id": 80584493, "body": "Have you considered storing serialized procs in the DB?"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508358518, "post_id": 46818352, "comment_id": 80584716, "body": "That\u2019s a last resort of course. If you\u2019re able to limit the kinds of variation in the formulae, you should be able to find a more structured data model for them."}, {"owner": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "edited": false, "score": 1, "creation_date": 1508358615, "post_id": 46818352, "comment_id": 80584777, "body": "The easest way is to store it as a string and later use eval() to execute. The problem is to not evaluate a dangerouse code ;)"}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "edited": false, "score": 0, "creation_date": 1508363376, "post_id": 46818352, "comment_id": 80587085, "body": "Why don&#39;t you define a function?"}, {"owner": {"reputation": 941, "user_id": 1226999, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/R8B9m.jpg?s=128&g=1", "display_name": "Stephen Corwin", "link": "https://stackoverflow.com/users/1226999/stephen-corwin"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508365327, "post_id": 46818352, "comment_id": 80587781, "body": "@hoffm I didn&#39;t realize you <i>could</i> serialize a Proc. Interesting, but it seems like it&#39;d introduce a lot of room for trouble. Also, if the serialized procs are stored raw within the rest of the formula, I&#39;d need to write some kind of parser to find and evaluate them which opens me up to injection. Anyhow, the data people can use is quite structured, but with a lot of possibilities. For example: <code>FIELD::FIELD_ID::VALUE</code> or <code>FIELD::AVERAGE</code>"}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1511389024, "post_id": 46818352, "comment_id": 81844683, "body": "@StephenCorwin was my answer helpful?"}], "answers": [{"comments": [{"owner": {"reputation": 941, "user_id": 1226999, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/R8B9m.jpg?s=128&g=1", "display_name": "Stephen Corwin", "link": "https://stackoverflow.com/users/1226999/stephen-corwin"}, "edited": false, "score": 0, "creation_date": 1516913037, "post_id": 46911200, "comment_id": 83896091, "body": "The problem with these solutions is they don&#39;t allow for the dynamic creation of formulas <i>on the front end</i>. Basically, the application&#39;s users will be free to use a formula builder interface that I&#39;ve created to generate their own formulas based on pieces of data they&#39;ve also created. So to give a more concrete example: User creates a form that asks for &quot;number of pies&quot; and &quot;number of cakes&quot;, and then they build a formula that might say <code>({number_of_pies} + {number_of_cakes}) *5</code>"}, {"owner": {"reputation": 941, "user_id": 1226999, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/R8B9m.jpg?s=128&g=1", "display_name": "Stephen Corwin", "link": "https://stackoverflow.com/users/1226999/stephen-corwin"}, "edited": false, "score": 0, "creation_date": 1516913050, "post_id": 46911200, "comment_id": 83896095, "body": "Also sorry for the late reply, I forgot to check in on this!"}], "tags": [], "owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "is_accepted": false, "score": 0, "last_activity_date": 1508849785, "creation_date": 1508849785, "answer_id": 46911200, "question_id": 46818352, "link": "https://stackoverflow.com/questions/46818352/best-way-to-store-a-formula-with-specific-values-to-be-evaluated-later-on/46911200#46911200", "title": "Best way to store a formula with specific values to be evaluated later on", "body": "<p>I had a similar issue when I wanted to create a class to solve <a href=\"https://gist.github.com/mberlanda/b2c858fac0220861155757afe5880c18\" rel=\"nofollow noreferrer\">Riemann sum</a> of a function.</p>\n\n<p>In that case, I used Procs:</p>\n\n<pre><code>f = -&gt;(x) { -10*(x**2) + 3*x + 6 }\n</code></pre>\n\n<p>I would say that it depends on your implementation. You could actually:</p>\n\n<p><strong>Define a <code>class</code></strong> containing some formulas, passing your <code>number_of_pies_eaten</code> in the constructor and do something</p>\n\n<pre><code>class PieEater\n\n  def initialize(number_of_pies_eaten)\n    @eaten_pies = number_of_pies_eaten\n  end\n\n  def something\n    @something = 10 * (2 + @eaten_pies)\n  end\n\n  def something_else\n    @something_else = 5 * (3 + @eaten_pies)\n  end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>pe = PieEater.new(15)\npe.do_something\npe.do_something_else\n</code></pre>\n\n<p><strong>Define a <code>module</code></strong> containing some formulas to include into another class.</p>\n\n<pre><code>module PieEater\n\n  def something(x)\n    10 * (2 + x)\n  end\n\n  def something_else(x)\n    5 * (3 + x)\n  end\n\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>require 'pie_eater'\n\nclass Person\n  include PieEater\nend\n\np = Person.new\np.something(15)\n</code></pre>\n\n<p><strong>Create a <code>module</code> or a <code>class</code></strong> containing some formulas to use straight away.</p>\n\n<pre><code>module PieEater\n  extend self\n\n  def something(x)\n    10 * (2 + x)\n  end\n\n  def something_else(x)\n    5 * (3 + x)\n  end\n\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>class PieEater\n\n  class &lt;&lt; self\n    def something(x)\n      10 * (2 + x)\n    end\n\n    def something_else(x)\n      5 * (3 + x)\n    end\n  end\nend\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>PieEater.something(15)\n</code></pre>\n\n<p>If you are writing some kind of script, I would use <strong>Proc objects</strong>:</p>\n\n<pre><code>$ irb\n2.4.0 :001 &gt; eaten_pies = -&gt;(n) { 10 * (2 + n) }\n =&gt; #&lt;Proc:0x00000001ff5c70@(irb):1 (lambda)&gt; \n2.4.0 :002 &gt;   eaten_pies.call(2)\n =&gt; 40 \n# You could even use these procs as hash values\n2.4.0 :003 &gt; formulas = { a: eaten_pies, b: -&gt;(x){ x**2 } }\n =&gt; {:a=&gt;#&lt;Proc:0x00000001ff5c70@(irb):1 (lambda)&gt;, :b=&gt;#&lt;Proc:0x00000002015070@(irb):4 (lambda)&gt;} \n2.4.0 :004 &gt; formulas[:a].call(15)\n =&gt; 170 \n2.4.0 :005 &gt; formulas[:b].call(15)\n =&gt; 225 \n</code></pre>\n\n<p>This could be written as:</p>\n\n<pre><code>formulas = {\n  eaten_pies: -&gt;(x) { 10 * (2 + n) },\n  eaten_apples: -&gt;(y) { y ** 2 }\n}\n\nformulas[:eaten_pies].call(15)\n</code></pre>\n\n<p>All this possibilities are standards in Ruby, it depends on your use case and your coding style</p>\n"}], "owner": {"reputation": 941, "user_id": 1226999, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/R8B9m.jpg?s=128&g=1", "display_name": "Stephen Corwin", "link": "https://stackoverflow.com/users/1226999/stephen-corwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508849785, "creation_date": 1508357133, "last_edit_date": 1508387271, "question_id": 46818352, "link": "https://stackoverflow.com/questions/46818352/best-way-to-store-a-formula-with-specific-values-to-be-evaluated-later-on", "title": "Best way to store a formula with specific values to be evaluated later on", "body": "<p>Working on a Ruby-based application that requires custom formulas to be created, stored and evaluated at a later date. For example, I might have:</p>\n\n<pre><code>10 * (2 + number_of_pies_eaten)\n</code></pre>\n\n<p>where <code>number_of_pies_eaten</code> is currently unknown, and will be substituted into the formula when it is evaluated.</p>\n\n<p>Is there a best practices way to do this kind of thing beyond just writing my own interpolation interpreter?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1508355889, "post_id": 46817824, "comment_id": 80583392, "body": "Hint #1: &quot;Create a variable and set it equal to true.&quot;"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508356030, "post_id": 46817824, "comment_id": 80583461, "body": "Hint #2: &quot;While the variable is true&quot;. See <a href=\"https://www.tutorialspoint.com/ruby/ruby_loops.htm\" rel=\"nofollow noreferrer\">this</a> on how to properly write a while loop."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508356242, "post_id": 46817824, "comment_id": 80583567, "body": "Hint #3: Everything that is supposed to happen &quot;while the variable is true&quot; needs to go <i>inside</i> the while loop."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508356429, "post_id": 46817824, "comment_id": 80583657, "body": "Hint #4: &quot;If that text input is \u201cn\u201d then set the true variable to false.&quot; The &#39;true variable&#39; will be the variable you set in Hint #1. (Bonus points for doing this step without using an <code>if</code> statement! You&#39;re actually pretty close.)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508357444, "post_id": 46817824, "comment_id": 80584175, "body": "Note that in Ruby the style is generally <code>x = gets.chomp.to_f</code> where empty argument lists are omitted and force-casting with things like <code>Float()</code> is strongly discouraged."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508400712, "post_id": 46817824, "comment_id": 80598249, "body": "@tadman <i>&quot;force-casting with things like Float() is strongly discouraged&quot;</i> \u2013 could you elaborate, please? When would <code>Float()</code> be the right or better choice?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508429896, "post_id": 46817824, "comment_id": 80616525, "body": "@Stefan In C++, PHP and others you&#39;d write <code>(float) x</code> where that converts <code>x</code> to a <code>float</code>. Naturally some people think that the equivalent in Ruby would be <code>Float(x)</code>, since as far as syntax goes thats&#39; the closest, but it&#39;s actually <code>x.to_f</code> due to the principle of <a href=\"https://en.wikipedia.org/wiki/Duck_typing\" rel=\"nofollow noreferrer\">Duck Typing</a>. In other words, any object that can handle a <code>.to_f</code> call is an acceptable value, not necessarily one that plays nice with <code>Float</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508440821, "post_id": 46817824, "comment_id": 80622198, "body": "@tadman thank&#39;s for clarifying. I&#39;ve never thought of it that way but you are right, <code>(float) x</code> is very close to <code>Float(x)</code> syntax-wise."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508359989, "post_id": 46818628, "comment_id": 80585458, "body": "Could always <code>loop do ... end</code> and then <code>break if answer.downcase == &#39;y&#39;</code>"}, {"owner": {"reputation": 24981, "user_id": 1094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda38b3b4f0bd9b57759601a3652e520?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1094246/robert"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508371750, "post_id": 46818628, "comment_id": 80589507, "body": "True. But the requirement asks for a Boolean var."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508417825, "post_id": 46818628, "comment_id": 80608109, "body": "<code>if answer == &#39;n&#39;</code> would match the requirements more closely."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508429550, "post_id": 46818628, "comment_id": 80616327, "body": "Could do <code>again = answer == &#39;n&#39;</code> if that&#39;s the case, no need for the <code>if</code> in that case. This is an XY problem, so don&#39;t be afraid to get to the root of the issue."}, {"owner": {"reputation": 24981, "user_id": 1094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda38b3b4f0bd9b57759601a3652e520?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1094246/robert"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508429874, "post_id": 46818628, "comment_id": 80616512, "body": "@tadman, nice tip! Updated. PS: it should check for <code>!= &#39;n&#39;</code> to loop again."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508429936, "post_id": 46818628, "comment_id": 80616551, "body": "@Robert Indeed. Good that someone&#39;s paying attention to the details!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508440295, "post_id": 46818628, "comment_id": 80621940, "body": "The instructions don&#39;t say that the answer has to be stored in a variable, so you could inline that variable, i.e. <code>again = gets.chomp != &#39;n&#39;</code>"}], "tags": [], "owner": {"reputation": 24981, "user_id": 1094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda38b3b4f0bd9b57759601a3652e520?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1094246/robert"}, "is_accepted": true, "score": 1, "last_activity_date": 1508440709, "last_edit_date": 1508440709, "creation_date": 1508358209, "answer_id": 46818628, "question_id": 46817824, "link": "https://stackoverflow.com/questions/46817824/ruby-while-loop-with-math/46818628#46818628", "title": "Ruby while loop with math", "body": "<p>You need to have a boolean flag to check at while level each loop:</p>\n\n<pre><code>again = true\n\nwhile again\n  puts \"Enter a number \"\n  x = Float(gets.chomp())\n\n  product = x * 2\n  puts \"Double your number is\"\n  puts product \n\n  puts \"Go again y/n? \"\n\n  again = gets.chomp != 'n'\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8797651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944f80616d60c7df80ac9e25eb703e5b?s=128&d=identicon&r=PG&f=1", "display_name": "graysen88", "link": "https://stackoverflow.com/users/8797651/graysen88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 46818628, "answer_count": 1, "score": 1, "last_activity_date": 1508440709, "creation_date": 1508355059, "last_edit_date": 1508387529, "question_id": 46817824, "link": "https://stackoverflow.com/questions/46817824/ruby-while-loop-with-math", "title": "Ruby while loop with math", "body": "<p>I am working on a lab for class about 'while' loops. This is the goal:</p>\n\n<blockquote>\n  <ul>\n  <li>Create a variable and set it equal to true</li>\n  <li>While the variable you just created is true</li>\n  <li>Prompt user for number</li>\n  <li>Read in number</li>\n  <li>Compute double that number</li>\n  <li>Display double that number</li>\n  <li>Prompt the user if they want to go again</li>\n  <li>Read in that text</li>\n  <li>If that text input is \u201cn\u201d then set the true variable to false</li>\n  </ul>\n</blockquote>\n\n<p>This is the code I have:</p>\n\n<pre><code>puts \"Enter a number\"\nx = Float(gets.chomp())\n\nproduct = x * 2\nputs \"Double your number is\"\nputs product\n\nwhile\n  puts \"Go again   y/n?\"\n  answer = gets.chomp\n  if answer != 'y'\n  end\nend\n</code></pre>\n\n<p>The directions seem clear, but I don't understand how to turn it into code.</p>\n\n<p>Any modifications will help.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 6058, "user_id": 662425, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-JXe9IA2rZYM/AAAAAAAAAAI/AAAAAAAAGEg/RlIJwUwmP90/photo.jpg?sz=128", "display_name": "AnkitG", "link": "https://stackoverflow.com/users/662425/ankitg"}, "reply_to_user": {"reputation": 27, "user_id": 8738344, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ec53a26643c3166caf751ca581cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Gokulnath Kumar", "link": "https://stackoverflow.com/users/8738344/gokulnath-kumar"}, "edited": false, "score": 0, "creation_date": 1508641768, "post_id": 46817886, "comment_id": 80687507, "body": "@GokulnathKumar added a <code>klass</code> method this is just to decide which model to pick based on params. You can have your own logic on which model class to pick and a single method can take care of it."}], "tags": [], "owner": {"reputation": 6058, "user_id": 662425, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-JXe9IA2rZYM/AAAAAAAAAAI/AAAAAAAAGEg/RlIJwUwmP90/photo.jpg?sz=128", "display_name": "AnkitG", "link": "https://stackoverflow.com/users/662425/ankitg"}, "is_accepted": true, "score": 0, "last_activity_date": 1508641723, "last_edit_date": 1508641723, "creation_date": 1508355287, "answer_id": 46817886, "question_id": 46817771, "link": "https://stackoverflow.com/questions/46817771/how-to-execute-a-controller-private-method-after-a-model-update/46817886#46817886", "title": "How to execute a controller private method after a model update?", "body": "<p>In your models (let's say A,B) add a method that marks the instance as updated</p>\n\n<pre><code>#A\nclass A &lt; ApplicationRecord\n\n  attr_reader :updated\n  after_update :mark_updated\n\n  private\n  def mark_updated\n     @updated = true\n  end\nend\n\n#B\nclass B &lt; ApplicationRecord\n  attr_reader :updated\n  after_update :mark_updated\n\n  private\n  def mark_updated\n     @updated = true\n  end\nend\n</code></pre>\n\n<p>Consume the instance variable which has marked updated In your controller</p>\n\n<pre><code>class DummyController &lt; ApplicationController\n\n  #after the action we call the private method    \n  after_action :update_mark, only: [:your_method]\n\n  #this is the method where your update takes place\n  def your_method\n    @instance = klass.find(params[:id])\n    @instance.update\n  end\n\n  private\n\n  # this is a model decider method which can figure out which model needs to \n  # be updated\n  def klass\n     case params[:type]\n     when 'a'\n       A\n     when 'b'\n       B\n     end\n  end\n\n  def update_mark\n    if @instance.updated\n      #write code which needs to run on model update\n    end\n  end\n end\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8738344, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ec53a26643c3166caf751ca581cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Gokulnath Kumar", "link": "https://stackoverflow.com/users/8738344/gokulnath-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 46817886, "answer_count": 1, "score": 0, "last_activity_date": 1508641723, "creation_date": 1508354835, "last_edit_date": 1508356266, "question_id": 46817771, "link": "https://stackoverflow.com/questions/46817771/how-to-execute-a-controller-private-method-after-a-model-update", "title": "How to execute a controller private method after a model update?", "body": "<p>I have created a private method inside a controller.</p>\n\n<pre><code>private\ndef update_mark\n...\n...\nend\n</code></pre>\n\n<ul>\n<li>I want my private method to be called whenever record gets updated to any of the four Models we have. How can we do this ?</li>\n<li>I read \"after_save\" or \"after_commit\" can be used. But I am not sure, which one to use. </li>\n</ul>\n\n<p>Can someone provide me an example, on how we can achieve this ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1508364012, "post_id": 46817551, "comment_id": 80587331, "body": "Did not see that kind of an approach.. why do you say that many to many won&#39;t work? What did you try?"}, {"owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "reply_to_user": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1508367093, "post_id": 46817551, "comment_id": 80588293, "body": "Many-to-many won&#39;t work in this use case because each sales order needs to have exactly one primary contact, exactly one billing contact, and exactly one material contact and should not be able to have multiple contacts for any of these fields. But if there&#39;s something I&#39;m not understanding about the many_to_many relationship let me know."}, {"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1508395094, "post_id": 46817551, "comment_id": 80595278, "body": "You could have something like order_sale_contacts with unique index on the combination on [order_id, contact_id, contact_type_id]"}, {"owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "reply_to_user": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1508428468, "post_id": 46817551, "comment_id": 80615641, "body": "Ah okay. I&#39;ll definitely give that a try. Would the unique indices be in the order_sale_contacts table?"}], "owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508353890, "creation_date": 1508353890, "question_id": 46817551, "link": "https://stackoverflow.com/questions/46817551/how-to-model-has-one-of-each-type-using-enum-of-other-model", "title": "How to model has_one of each type (using enum) of other model", "body": "<p>Apologies if this question has been asked somewhere else in a different way, but I'm not 100% sure how to word it.</p>\n\n<p>I'm working with code someone else has created. They created a model in Rails called \"Contact\" (as in a contact for a company) and used enum to create 4 different types of contacts - billing, materials, primary, and other.</p>\n\n<pre><code>class Contact &lt; ActiveRecord::Base\n    ...\n    enum contact_type_id: [:Billing, :Materials, :Primary, :Other]\n    ...\nend\n</code></pre>\n\n<p>I need to create a model called \"SalesOrder\" that has 3 contacts for each record. One primary contact, one billing contact, and one materials contact. Only one contact of each kind can go on a sales order. Using a many-to-many relationship doesn't seem like it's going to work.</p>\n\n<p>The way I've been trying to do this is by creating three join tables: contact_sales_order_primary, contact_sales_order_billing, and contact_sales_order_material. That way the SalesOrder model can use has_one for each of these tables, while the Contact model can use has_many for the tables.</p>\n\n<p>This is what I've been trying, but I can't get it to work (I've also looked into STI and polymorphic associations, but those don't seem to exactly fit the bill). I can't tell if:</p>\n\n<ol>\n<li>I'm taking the right approach to this problem and I just haven't figured out how to properly execute it yet,</li>\n<li>it's overkill and I should be doing something simpler, or</li>\n<li>if there is an entirely different method that I'm overlooking</li>\n</ol>\n\n<p>And of course, I can provide any additional details you might need to help answer. Any help or advice is much appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 591, "user_id": 3755036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4feUb.jpg?s=128&g=1", "display_name": "qaispak", "link": "https://stackoverflow.com/users/3755036/qaispak"}, "edited": false, "score": 0, "creation_date": 1508354208, "post_id": 46817556, "comment_id": 80582553, "body": "Actually adding a method just like def last_name, but with first_name instead of last name, has fixed it. I don&#39;t know why though"}], "tags": [], "owner": {"reputation": 38, "user_id": 5278602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204878503588025/picture?type=large", "display_name": "Brad Hodges", "link": "https://stackoverflow.com/users/5278602/brad-hodges"}, "is_accepted": false, "score": 0, "last_activity_date": 1508353911, "creation_date": 1508353911, "answer_id": 46817556, "question_id": 46817410, "link": "https://stackoverflow.com/questions/46817410/uninitialized-method-first-name-using-fixy-gem/46817556#46817556", "title": "uninitialized method first_name using fixy gem", "body": "<p>try this:</p>\n\n<pre><code>  def initialize(fn, ln)\n    @first_name = fn\n    @last_name  = ln\n  end\n</code></pre>\n\n<p>your name for your method arguments were colliding with the instance variables possibly?</p>\n"}], "owner": {"reputation": 591, "user_id": 3755036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4feUb.jpg?s=128&g=1", "display_name": "qaispak", "link": "https://stackoverflow.com/users/3755036/qaispak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508353911, "creation_date": 1508353397, "question_id": 46817410, "link": "https://stackoverflow.com/questions/46817410/uninitialized-method-first-name-using-fixy-gem", "title": "uninitialized method first_name using fixy gem", "body": "<p>I am using this gem to help me in making fixed file formatters. I am following the documentation but getting an error </p>\n\n<pre><code>require('fixy')\nclass Record &lt; Fixy::Record\n  include Fixy::Formatter::Alphanumeric\n  # Define record length\n  set_record_length 20\n\n  # Fields Declaration:\n  # -----------------------------------------------------------\n  #       name          size      Range             Format\n  # ------------------------------------------------------------\n\n  field :first_name,     10,     '1-10' ,      :alphanumeric\n  field :last_name ,     10,     '11-20',      :alphanumeric\n\n  # Any required data for the record can be\n  # provided through the initializer\n\n  def initialize(first_name, last_name)\n    @first_name = first_name\n    @last_name  = last_name\n  end\n\n  # 2) Using a method definition.\n  #    This is most interesting when complex logic is involved.\n  def last_name\n    @last_name\n  end\nend\n\nshinken =  Reky.new('Sarah', 'Smith')\np shinken.generate\n</code></pre>\n\n<p>The last method: shinken.generate gives the error: <code>generate': undefined method</code>first_name' for # (NoMethodError)</p>\n\n<p>What may be causing this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis", "resque", "activerecord-import"], "comments": [{"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508347608, "post_id": 46815630, "comment_id": 80579003, "body": "Can you log <code>sales.count</code> in the line before each call to <code>Sale.import sales</code> to make sure you&#39;re hitting the <code>import</code> calls with data?"}, {"owner": {"reputation": 138, "user_id": 3324455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71315eef4b002b55264cceeea2c27475?s=128&d=identicon&r=PG", "display_name": "Nick Barreto", "link": "https://stackoverflow.com/users/3324455/nick-barreto"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508348220, "post_id": 46815630, "comment_id": 80579312, "body": "That&#39;s a good idea. I am really new to Resque though. Is there a way I can get that to print to the Resque log? What would the syntax of that be? Would I just use <code>logger.info &quot;Collected #{sales.count} sales to import&quot;</code> or something like that?"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508348411, "post_id": 46815630, "comment_id": 80579419, "body": "I think you&#39;ll see the output if it just gets sent to stdout, so <code>puts &quot;Collected #{sales.count} sales to import&quot;</code> should do the trick. I assume you&#39;re starting the Resque worker with <code>rake resque:work</code>?"}, {"owner": {"reputation": 138, "user_id": 3324455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71315eef4b002b55264cceeea2c27475?s=128&d=identicon&r=PG", "display_name": "Nick Barreto", "link": "https://stackoverflow.com/users/3324455/nick-barreto"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508348480, "post_id": 46815630, "comment_id": 80579455, "body": "Yeah I am starting the worker with <code>bundle exec rake environment resque:work QUEUE=default</code>"}, {"owner": {"reputation": 138, "user_id": 3324455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71315eef4b002b55264cceeea2c27475?s=128&d=identicon&r=PG", "display_name": "Nick Barreto", "link": "https://stackoverflow.com/users/3324455/nick-barreto"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508350633, "post_id": 46815630, "comment_id": 80580640, "body": "I tried both <code>logger.info</code> and <code>puts</code> in the job but when it ran I couldn&#39;t see any output anywhere; in the rails server output nor in the resque worker log output."}], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 3324455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71315eef4b002b55264cceeea2c27475?s=128&d=identicon&r=PG", "display_name": "Nick Barreto", "link": "https://stackoverflow.com/users/3324455/nick-barreto"}, "is_accepted": true, "score": 2, "last_activity_date": 1508411460, "creation_date": 1508411460, "answer_id": 46828576, "question_id": 46815630, "link": "https://stackoverflow.com/questions/46815630/railsresque-background-job-import-not-adding-anything-to-the-database/46828576#46828576", "title": "Rails+resque background job import not adding anything to the database", "body": "<p>It looks like my problem was with <code>Resque.enqueue(ExcelImportJob, @upload.id)</code>. </p>\n\n<p>I changed my code to <code>ExcelImportJob.perform_later(@upload.id)</code> and now my code actually runs! </p>\n\n<p>I also added a <code>resque.rake</code> task to <code>lib/tasks</code> as described here: <a href=\"http://bica.co/2015/01/20/active-job-resque/\" rel=\"nofollow noreferrer\">http://bica.co/2015/01/20/active-job-resque/</a>.</p>\n\n<p>That link also notes how to use <code>rails runner</code> to call the job without running the full Rails server and triggering the job, which is useful for debugging.</p>\n\n<p>Strangely, I didn't quite manage to get the job to print anything to STDOUT as suggested by @hoffm but at least it led me down a good avenue of inquiry.</p>\n\n<p>I still don't fully understand the difference between why calling Resqueue.enqueue still added my jobs to the queue and indeed seemed to run them, but the code wasn't executed, so if someone has a better grasp and an explanation, that would be much appreciated.</p>\n\n<p>TL;DR: calling <code>perform_later</code> rather than <code>Resque.enqueue</code> fixed the problem but I don't know why.</p>\n"}], "owner": {"reputation": 138, "user_id": 3324455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71315eef4b002b55264cceeea2c27475?s=128&d=identicon&r=PG", "display_name": "Nick Barreto", "link": "https://stackoverflow.com/users/3324455/nick-barreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "accepted_answer_id": 46828576, "answer_count": 1, "score": 3, "last_activity_date": 1508411460, "creation_date": 1508346553, "last_edit_date": 1508347637, "question_id": 46815630, "link": "https://stackoverflow.com/questions/46815630/railsresque-background-job-import-not-adding-anything-to-the-database", "title": "Rails+resque background job import not adding anything to the database", "body": "<p>I have an issue with importing a lot of records from a user provided excel file into a database. The logic for this is working fine, and I\u2019m using ActiveRecord-import to cut down on the number of database calls. However, when a file is too large, the processing can take too long and Heroku will return a timeout. Solution: Resque and moving the processing to a background job.</p>\n\n<p>So far, so good. I\u2019ve needed to add CarrierWave to upload the files to S3 because I can\u2019t just hold the file in memory for the background job. The upload portion is also working fine, I created a model for them and am passing the IDs through to the queued job to retrieve the file later as I understand I can\u2019t pass a whole ActiveRecord object through to the job.</p>\n\n<p>I\u2019ve installed Resque and Redis locally, and everything seems to be setup correctly in that regard. I can see the jobs I\u2019m creating being queued and then run without failing. The job seems to run fine, but no records are added to the database. If I run the code from my job line by line in the console, the records are added to the database as I would expect. But when the queued jobs I\u2019m creating run, nothing happens.</p>\n\n<p>I can\u2019t quite work out where the problem might be.</p>\n\n<p>Here\u2019s my upload controller\u2019s create action:</p>\n\n<pre><code>def create\n  @upload = Upload.new(upload_params)\n  if @upload.save\n    Resque.enqueue(ExcelImportJob, @upload.id)\n    flash[:info] = 'File uploaded.\n        Data will be processed and added to the database.'\n    redirect_to root_path\n  else\n    flash[:warning] = 'Upload failed. Please try again.'\n    render :new\n  end\nend\n</code></pre>\n\n<p>This is a simplified version of the job with fewer sheet columns for clarity:</p>\n\n<pre><code>class ExcelImportJob &lt; ApplicationJob\n  @queue = :default\n\n  def perform(upload_id)\n    file = Upload.find(upload_id).file.file.file\n    data = parse_excel(file)\n    if header_matches? data\n      # Create a database entry for each row, ignoring the first header row\n      # using activerecord-import\n      sales = []\n      data.drop(1).each_with_index do |row, index|\n        sales &lt;&lt; Sale.new(row)\n        if index % 2500 == 0\n          Sale.import sales\n          sales = []\n        end\n      end\n      Sale.import sales\n    end\n\n    def parse_excel(upload)\n      # Open the uploaded excel document\n      doc = Creek::Book.new upload\n\n      # Map rows to the hash keys from the database\n      doc.sheets.first.rows.map do |row|\n        { date: row.values[0],\n          title: row.values[1],\n          author: row.values[2],\n          isbn: row.values[3],\n          release_date: row.values[5],\n          units_sold: row.values[6],\n          units_refunded: row.values[7],\n          net_units_sold: row.values[8],\n          payment_amount: row.values[9],\n          payment_amount_currency: row.values[10] }\n      end\n    end\n\n    # Returns true if header matches the expected format\n    def header_matches?(data)\n      data.first == {:date =&gt; 'Date',\n                     :title =&gt; 'Title',\n                     :author =&gt; 'Author',\n                     :isbn =&gt; 'ISBN',\n                     :release_date =&gt; 'Release Date',\n                     :units_sold =&gt; 'Units Sold',\n                     :units_refunded =&gt; 'Units Refunded',\n                     :net_units_sold =&gt; 'Net Units Sold',\n                     :payment_amount =&gt; 'Payment Amount',\n                     :payment_amount_currency =&gt; 'Payment Amount Currency'}\n    end\n  end\nend\n</code></pre>\n\n<p>I can probably have some improved logic anyway as right now I\u2019m holding the whole file in memory, but that isn\u2019t the issue I\u2019m having \u2013 even with a small file that has only 500 or so rows, the job doesn\u2019t add anything to the database.</p>\n\n<p>Like I said my code worked fine when I wasn\u2019t using a background job, and still works if I run it in the console. But for some reason the job is doing nothing. </p>\n\n<p>This is my first time using Resque so I don\u2019t know if I\u2019m missing something obvious? I did create a worker and as I said it does seem to run the job. Here\u2019s the output from Resque\u2019s verbose formatter:</p>\n\n<pre><code>*** resque-1.27.4: Waiting for default\n*** Checking default\n*** Found job on default\n*** resque-1.27.4: Processing default since 1508342426 [ExcelImportJob]\n*** got: (Job{default} | ExcelImportJob | [15])\n*** Running before_fork hooks with [(Job{default} | ExcelImportJob | [15])]\n*** resque-1.27.4: Forked 63706 at 1508342426\n*** Running after_fork hooks with [(Job{default} | ExcelImportJob | [15])]\n*** done: (Job{default} | ExcelImportJob | [15])\n</code></pre>\n\n<p>In the Resque dashboard the jobs aren\u2019t logged as failed. They get executed and I can see an increment in the \u2018processed\u2019 jobs on the stats page. But as I say the DB remains untouched. What\u2019s going on? How can I debug the job more clearly? Is there a way to get into it with Pry?</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "edited": false, "score": 0, "creation_date": 1508347200, "post_id": 46815528, "comment_id": 80578819, "body": "does <code>console.log(&quot;Pot size: &quot; + gon.pot);</code> behave as expected by displaying the updated pot value? Also in developer console do you have any errors?"}, {"owner": {"reputation": 1910, "user_id": 5940124, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8501b1b8ebfa2217a32576f638cac885?s=128&d=identicon&r=PG", "display_name": "Rudi Thiel", "link": "https://stackoverflow.com/users/5940124/rudi-thiel"}, "reply_to_user": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "edited": false, "score": 0, "creation_date": 1508347536, "post_id": 46815528, "comment_id": 80578965, "body": "@abax no, it displays the old gon.pot (current but not updated). When the page is refreshed and the ajax request is submitted again it displays the new value. This is (i think) because gon.pot is set in the pages#home action."}, {"owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "edited": false, "score": 0, "creation_date": 1508348599, "post_id": 46815528, "comment_id": 80579516, "body": "Maybe try using <code>gon.watch</code>,<a href=\"https://github.com/gazay/gon/wiki/Usage-gon-watch\" rel=\"nofollow noreferrer\">github.com/gazay/gon/wiki/Usage-gon-watch</a>"}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1508349298, "post_id": 46815528, "comment_id": 80579884, "body": "How attached are you to <b>gon</b>? You could simply return JSON with the updated amount and read it on the success callback of your <code>$.ajax</code>."}, {"owner": {"reputation": 1910, "user_id": 5940124, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8501b1b8ebfa2217a32576f638cac885?s=128&d=identicon&r=PG", "display_name": "Rudi Thiel", "link": "https://stackoverflow.com/users/5940124/rudi-thiel"}, "reply_to_user": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1508349413, "post_id": 46815528, "comment_id": 80579952, "body": "@Leito not attached at all. Trying it because nothing else has worked for me. How would I return the JSON to the ajax callback? Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "reply_to_user": {"reputation": 1910, "user_id": 5940124, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8501b1b8ebfa2217a32576f638cac885?s=128&d=identicon&r=PG", "display_name": "Rudi Thiel", "link": "https://stackoverflow.com/users/5940124/rudi-thiel"}, "edited": false, "score": 0, "creation_date": 1508350205, "post_id": 46816431, "comment_id": 80580397, "body": "Happy to help! Consider returning the entire @jackpot (or all that its relevant to the page) and building the json object using something more robust: JBuilder, Active Model Serializers, etc."}], "tags": [], "owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "is_accepted": true, "score": 1, "last_activity_date": 1508349690, "creation_date": 1508349690, "answer_id": 46816431, "question_id": 46815528, "link": "https://stackoverflow.com/questions/46815528/gon-variable-not-passing-to-js-from-rails-controller-during-ajax-request/46816431#46816431", "title": "Gon variable not passing to js from rails controller during Ajax request", "body": "<p>In the controller, simply respond to JSON:</p>\n\n<pre><code>respond_to do |format|\n  format.json { render json: { pot: @jackpot.pot } }\nend\n</code></pre>\n\n<p>Specify the dataType when posting with <code>$.ajax</code>. Notice that the new data is bieng passed to the success function, so it's not <code>gon.pot</code>, but <code>data.pot</code>.</p>\n\n<pre><code>$.ajax({\n  dataType: \"json\",\n  url: url,\n  data: data,\n  success: function(data) {\n    console.log('pot', data.pot);\n  }\n});\n</code></pre>\n"}], "owner": {"reputation": 1910, "user_id": 5940124, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8501b1b8ebfa2217a32576f638cac885?s=128&d=identicon&r=PG", "display_name": "Rudi Thiel", "link": "https://stackoverflow.com/users/5940124/rudi-thiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 46816431, "answer_count": 1, "score": -1, "last_activity_date": 1508349690, "creation_date": 1508346125, "question_id": 46815528, "link": "https://stackoverflow.com/questions/46815528/gon-variable-not-passing-to-js-from-rails-controller-during-ajax-request", "title": "Gon variable not passing to js from rails controller during Ajax request", "body": "<p>I'm trying to create a jackpot betting site (just as a challenge). I have a method in my controller to update the pot when a user adds money to the pot. I display the pot total on the homepage and would like to update it with Ajax as soon as someone adds money to the pot. I'm using the gon gem to pass variables such as the pot total from my controller to my javascript. It works when the page is reloaded but not when the update method is called with ajax.</p>\n\n<p>Heres my PagesController:</p>\n\n<pre><code>def home\n  @jackpot = Jackpot.last\n  gon.pot = @jackpot.pot\nend\n</code></pre>\n\n<p>JackpotsController:</p>\n\n<pre><code>def update\n  @jackpot = Jackpot.find(params[:id])\n  if params.has_key?(:amount)\n    @jackpot.update(pot: @jackpot.pot + params[:amount].to_f)\n    gon.pot = @jackpot.pot\n  end\n  respond_to do |format| \n    format.js\n  end\nend\n</code></pre>\n\n<p>Javascript: (In the url the :id is hardcoded for now)</p>\n\n<pre><code>$(\"#bet-btn\").click(function() {\n   $.ajax({\n        type: \"POST\",\n        url: \"/jackpot/update/21\",\n        datatype: \"json\",\n        success: function() {\n          console.log(\"Pot size: \" + gon.pot);\n          updatePot();\n        },\n        error: function() {\n          console.log(\"error\")\n        }\n    });\n</code></pre>\n\n<p>});</p>\n\n<p>This updates the donut progress bar for the pot</p>\n\n<pre><code>function updatePot() {\n  updateDonutChart('#jackpot-donut', gon.pot , true); \n}\n</code></pre>\n\n<p>Button to place bet: (amount also hardcoded)</p>\n\n<pre><code> &lt;%= link_to \"Place Bet\", update_pot_path(@jackpot, :amount =&gt; \n 0.1), method: :post,:remote =&gt; true, id: \"bet-btn\", class: \"btn btn-info btn-lg\" %&gt;\n</code></pre>\n\n<p>I'm pretty new to rails and especially javascript/ajax so any help would be appreciated. Thanks!</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508344168, "post_id": 46814935, "comment_id": 80577278, "body": "...Or just make it two tests, not one. If <code>subject</code> is not an expensive (slow) operation, then this is the normal practice."}, {"owner": {"reputation": 330, "user_id": 4117545, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f74ae9a7105a4a1628c024fb1b947c21?s=128&d=identicon&r=PG&f=1", "display_name": "Gregy", "link": "https://stackoverflow.com/users/4117545/gregy"}, "edited": false, "score": 0, "creation_date": 1508344474, "post_id": 46814935, "comment_id": 80577449, "body": "Thank you! Haven&#39;t thought about putting it into the subject. Spent over an hour trying to solve it by the different way but it was so simple..."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508388348, "post_id": 46814935, "comment_id": 80593233, "body": "@TomLord of course one can do that, but from the question I got the impression that he want&#39;s to avoid it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508402366, "post_id": 46814935, "comment_id": 80599126, "body": "@meta I consider this to be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>.  They are providing an attempted solution, <i>not</i> the original problem. Your answer is valid and interesting, but I think it&#39;s also worth pointing out the &quot;simpler&quot;  option too!"}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": true, "score": 2, "last_activity_date": 1508344032, "creation_date": 1508344032, "answer_id": 46814935, "question_id": 46814703, "link": "https://stackoverflow.com/questions/46814703/rspec-combine-block-matcher-with-non-block-matcher/46814935#46814935", "title": "RSpec combine block matcher with non-block matcher", "body": "<p>You can define <code>subject</code> as <code>subject.call</code> and do this:</p>\n\n<pre><code>specify do\n  expect { subject }.to change { Model.count }.by(1)\n  expect(subject).to be_an_instance_of(Model)\nend\n</code></pre>\n\n<p>So if previously your subject was</p>\n\n<pre><code>subject { Foo.new }\n</code></pre>\n\n<p>make it </p>\n\n<pre><code>subject { Foo.new.call }\n</code></pre>\n\n<p><code>let</code> and <code>subject</code> calls <strong>are memoized</strong>, so it'll be only called once. </p>\n\n<p>There is only one problem: if the first expectation fails - the second will not run (and this is SomethingToAvoidInSpecs\u2122) so consider <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/aggregating-failures\" rel=\"nofollow noreferrer\">aggregating failures</a> to remedy it.</p>\n"}], "owner": {"reputation": 330, "user_id": 4117545, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f74ae9a7105a4a1628c024fb1b947c21?s=128&d=identicon&r=PG&f=1", "display_name": "Gregy", "link": "https://stackoverflow.com/users/4117545/gregy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 46814935, "answer_count": 1, "score": 0, "last_activity_date": 1508344032, "creation_date": 1508343253, "question_id": 46814703, "link": "https://stackoverflow.com/questions/46814703/rspec-combine-block-matcher-with-non-block-matcher", "title": "RSpec combine block matcher with non-block matcher", "body": "<p>I would like to check if my class is creating a new object and returning an instance of it. My idea was to combine <code>change</code> matcher with <code>be_instance_of</code> matcher but RSpec doesn't allow to do it. </p>\n\n<pre><code>expect { subject.call }.to change { Model.count }.by(1).and be_an_instance_of(Model)\n</code></pre>\n\n<p>I don't want to split it into two different <code>expects</code> with one without the block to avoid multiple invocations of the same method.</p>\n\n<p>What is the general approach to this kind of situations? How should I handle my case?</p>\n"}, {"tags": ["ruby", "apache", "rubygems", "jekyll"], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": true, "score": 1, "last_activity_date": 1508353336, "creation_date": 1508353336, "answer_id": 46817389, "question_id": 46814529, "link": "https://stackoverflow.com/questions/46814529/when-attempting-to-install-jekyll-appears-an-error/46817389#46817389", "title": "When attempting to install jekyll appears an error", "body": "<p>Such error usually means that you don't have build tools installed.\nAs far as I understood you are using linux, so you can run something like</p>\n\n<pre><code>apt-get install build-essential\n</code></pre>\n\n<p>This command is for deb-bases distros. So you can use something similar if you use a different distro.</p>\n"}, {"tags": [], "owner": {"reputation": 664, "user_id": 285039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8814af34687e80a17894e482e72b0111?s=128&d=identicon&r=PG", "display_name": "DA.", "link": "https://stackoverflow.com/users/285039/da"}, "is_accepted": false, "score": 0, "last_activity_date": 1508476543, "creation_date": 1508476543, "answer_id": 46842751, "question_id": 46814529, "link": "https://stackoverflow.com/questions/46814529/when-attempting-to-install-jekyll-appears-an-error/46842751#46842751", "title": "When attempting to install jekyll appears an error", "body": "<p>I had the same error while installing. You will have to install des Ruby dev packacke:</p>\n\n<pre><code>sudo apt-get install ruby2.4-dev\n</code></pre>\n\n<p>This will install the developement package for 2.4. You should install 2.1 as you are using this version. I had the problem, that the package could not be found in the repositories. So I used the following PPA:</p>\n\n<pre><code>$ sudo apt-add-repository ppa:brightbox/ruby-ng\n$ sudo apt-get update\n</code></pre>\n\n<p><a href=\"https://launchpad.net/~brightbox/+archive/ubuntu/ruby-ng\" rel=\"nofollow noreferrer\">https://launchpad.net/~brightbox/+archive/ubuntu/ruby-ng</a></p>\n\n<p>Version 2.1 is also available in this repository.</p>\n"}], "owner": {"reputation": 64, "user_id": 8412857, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2bu5q2mJgNo/AAAAAAAAAAI/AAAAAAAAF-c/OmCVYMWVGlc/photo.jpg?sz=128", "display_name": "Robin Seerig", "link": "https://stackoverflow.com/users/8412857/robin-seerig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 46817389, "answer_count": 2, "score": 0, "last_activity_date": 1508476543, "creation_date": 1508342625, "question_id": 46814529, "link": "https://stackoverflow.com/questions/46814529/when-attempting-to-install-jekyll-appears-an-error", "title": "When attempting to install jekyll appears an error", "body": "<p>I'm having some trouble installing jekyll. Can't quite figure out how to patch the missing link.</p>\n\n<p>Heres the full post:</p>\n\n<pre><code>root@cherob:~# gem install jekyll\nBuilding native extensions.  This could take a while...\nERROR:  Error installing jekyll:\nERROR: Failed to build gem native extension.\n\n/usr/bin/ruby2.1 extconf.rb\nchecking for ffi.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/usr/bin/ruby2.1\n        --with-ffi_c-dir\n        --without-ffi_c-dir\n        --with-ffi_c-include\n        --without-ffi_c-include=${ffi_c-dir}/include\n        --with-ffi_c-lib\n        --without-ffi_c-lib=${ffi_c-dir}/lib\n        --with-libffi-config\n        --without-libffi-config\n        --with-pkg-config\n        --without-pkg-config\n/usr/lib/ruby/2.1.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n        from /usr/lib/ruby/2.1.0/mkmf.rb:587:in `try_cpp'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:1067:in `block in have_header'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:918:in `block in checking_for'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:351:in `block (2 levels) in postpone'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:321:in `open'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:351:in `block in postpone'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:321:in `open'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:347:in `postpone'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:917:in `checking_for'\n        from /usr/lib/ruby/2.1.0/mkmf.rb:1066:in `have_header'\n        from extconf.rb:16:in `&lt;main&gt;'\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.1.0/gems/ffi-1.9.18 for inspection.\nResults logged to /var/lib/gems/2.1.0/extensions/x86_64-linux/2.1.0\n</code></pre>\n\n<p>/ffi-1.9.18/gem_make.out<strong>strong text</strong></p>\n\n<p>Ruby is installed:</p>\n\n<pre><code>root@cherob:~# ruby -v\nruby 2.1.5p273 (2014-11-13) [x86_64-linux-gnu]\n</code></pre>\n\n<p>Debain 8 is installed</p>\n\n<pre><code>-\n</code></pre>\n\n<p>Apache2 is installed:</p>\n\n<pre><code>root@cherob:~# apache2 -v\nServer version: Apache/2.4.10 (Debian)\nServer built:   Sep 20 2017 04:37:43\n</code></pre>\n\n<p>If you have an idea I would be glad if you forward me it.</p>\n\n<p>Other thanks already times in advance</p>\n\n<p>Robin</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cascade", "soft-delete"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508344558, "post_id": 46814361, "comment_id": 80577490, "body": "What&#39;s wrong with using a gem? This is a non-trivial problem, but the <a href=\"https://github.com/rubysherpas/paranoia\" rel=\"nofollow noreferrer\">paranoia</a> library is a widely used and comprehensive solution."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508344591, "post_id": 46814361, "comment_id": 80577499, "body": "I&#39;ve seen plenty of flawed attempts to re-invent this wheel over my career; my advice would be to just use a library!!"}], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508353726, "creation_date": 1508353726, "answer_id": 46817503, "question_id": 46814361, "link": "https://stackoverflow.com/questions/46814361/cascade-delete-soft-and-hard-delete-ruby/46817503#46817503", "title": "cascade delete (soft and hard delete) ruby", "body": "<p>I would recommend you to use gem, that will handle all tricky cases, that can be not covered with your own solution.</p>\n\n<p>But if you don't want to have an additional library in your project, then you can implement something similar using ActiveRecord callbacks.\nThough callbacks are often treated as bad practice, in this situation they can be helpful.</p>\n\n<p>You can use <code>before_destroy</code> callback <a href=\"http://api.rubyonrails.org/v5.1/classes/ActiveRecord/Callbacks.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/v5.1/classes/ActiveRecord/Callbacks.html</a>\nthat will be triggered before models <code>destroy</code> method is invoked.\nInside callback's body you can remove all related data.</p>\n\n<p>Also, don't forget to override <code>destroy</code> method at model definition, to mark record as removed instead of real deletion.</p>\n"}], "owner": {"reputation": 451, "user_id": 4826930, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/81017f2b7f975778b744c351f57fc227?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Bb", "link": "https://stackoverflow.com/users/4826930/nick-bb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508353726, "creation_date": 1508342078, "question_id": 46814361, "link": "https://stackoverflow.com/questions/46814361/cascade-delete-soft-and-hard-delete-ruby", "title": "cascade delete (soft and hard delete) ruby", "body": "<p>So here is the problem:\nHard delete is quite obvious that you destroyed the parent and the child should get destroyed. and using <code>dependent: :destroy</code> for it works fine and when ever parent gets destroyed the child gets destroyed.</p>\n\n<p>about confuse about soft delete. if i want to soft delete user and for that i wanted to update a field in user <code>deleted_at: Time.now</code>. its called a soft delete but i want to destroy/null all the associations/dependent of user when i update deleted_at field.</p>\n\n<p>how is it possible without using any gem.</p>\n"}, {"tags": ["ruby", "exception", "exception-handling"], "comments": [{"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508341731, "post_id": 46814080, "comment_id": 80575731, "body": "Yeah that should throw a <code>TypeError</code> with either <code>fail</code> or <code>raise</code>. Can you give more context? Any gems at play?"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508341853, "post_id": 46814080, "comment_id": 80575836, "body": "Thanks @hoffm. And yeah that&#39;s what I was thinking, posted some additional code above, essentially it&#39;s just a custom strategy for Devise"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508341990, "post_id": 46814080, "comment_id": 80575932, "body": "@hoffm looks like devise is using that syntax in some of its code as well"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508342090, "post_id": 46814080, "comment_id": 80575993, "body": "What version of Devise are you using? Looks like the latest doesn&#39;t do that <a href=\"https://github.com/plataformatec/devise/search?q=%22raise%22&amp;type=&amp;utf8=%E2%9C%93\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise/&hellip;</a>"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508342115, "post_id": 46814080, "comment_id": 80576004, "body": "@hoffm looks like it&#39;s mapped to the <a href=\"https://github.com/plataformatec/devise/blob/master/config/locales/en.yml\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise/blob/master/config/locales/&hellip;</a> file"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508342161, "post_id": 46814080, "comment_id": 80576029, "body": "@hoffm sorry, looks like they&#39;re using it with the fail method <a href=\"https://github.com/plataformatec/devise/blob/88724e10adaf9ffd1d8dbfbaadda2b9d40de756a/lib/devise/strategies/database_authenticatable.rb#L18\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise/blob/&hellip;</a>"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508342180, "post_id": 46814080, "comment_id": 80576046, "body": "Ah, so it&#39;s just an implicit localization of a string then?"}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508342239, "post_id": 46814080, "comment_id": 80576083, "body": "Must be something to that effect, but wouldn&#39;t the fail method have to be redefined somewhere to use a mapping scheme? Maybe they have their own gem at play..."}, {"owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "reply_to_user": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508342334, "post_id": 46814080, "comment_id": 80576158, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/157016/discussion-between-drew-and-hoffm\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "is_accepted": true, "score": 0, "last_activity_date": 1508428994, "creation_date": 1508428994, "answer_id": 46834190, "question_id": 46814080, "link": "https://stackoverflow.com/questions/46814080/symbol-is-passed-to-raise/46834190#46834190", "title": "Symbol is passed to &#39;raise&#39;", "body": "<p>Looks like the <code>fail</code> method being used was the warden method:</p>\n\n<p><a href=\"http://www.rubydoc.info/github/hassox/warden/Warden%2FStrategies%2FBase:fail\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/github/hassox/warden/Warden%2FStrategies%2FBase:fail</a></p>\n"}], "owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 46834190, "answer_count": 1, "score": -1, "last_activity_date": 1508428994, "creation_date": 1508341095, "last_edit_date": 1508387690, "question_id": 46814080, "link": "https://stackoverflow.com/questions/46814080/symbol-is-passed-to-raise", "title": "Symbol is passed to &#39;raise&#39;", "body": "<p>Code for context:</p>\n\n<pre><code>module Devise\n  module Strategies\n    class AuthxAuthenticatable &lt; Authenticatable\n      def valid?\n        !params[scope].nil?\n      end\n\n      def authenticate!\n        resource = mapping.to.authenticate_with_credentials(params[scope])\n        return fail(:invalid) if resource.nil?\n        success!(resource) if validate(resource)\n      end\n    end\n  end\nend\n\nWarden::Strategies.add(:authx_authenticatable, Devise::Strategies::AuthxAuthenticatable)\n</code></pre>\n\n<p>Came across some code where a symbol is passed to <code>raise</code>:</p>\n\n<pre><code>raise(:invalid)\n</code></pre>\n\n<p>Doesn't look like there's any monkey patching of <code>raise</code> to handle symbol arguments. Seems like <code>fail</code> used to be used, and the code actually works if I use <code>fail</code>.</p>\n\n<p>Isn't that just an alias for <code>raise</code>? Does this make sense in any context?</p>\n"}, {"tags": ["ruby", "calabash", "calabash-ios", "iphone-x"], "comments": [{"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 0, "creation_date": 1508353836, "post_id": 46813973, "comment_id": 80582341, "body": "Please provide some additional information related to your question. It could be a sample of code, that taps some area, cucumber logs or even a screencast where we can see what&#39;s going wrong."}, {"owner": {"reputation": 61, "user_id": 5959485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5be43b1121a01ec04162a3302d7dffbd?s=128&d=identicon&r=PG&f=1", "display_name": "chetan", "link": "https://stackoverflow.com/users/5959485/chetan"}, "reply_to_user": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 0, "creation_date": 1508420724, "post_id": 46813973, "comment_id": 80610178, "body": "i am trying to use this method  def fill_username_data(username)     fill USERNAME_FIELD, username.to_s, true   end  So its just a simple tap and fill the username data in username field."}], "owner": {"reputation": 61, "user_id": 5959485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5be43b1121a01ec04162a3302d7dffbd?s=128&d=identicon&r=PG&f=1", "display_name": "chetan", "link": "https://stackoverflow.com/users/5959485/chetan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508340778, "creation_date": 1508340778, "question_id": 46813973, "link": "https://stackoverflow.com/questions/46813973/unable-to-tap-the-correct-element-on-iphone-x-simulator-using-calabash-cucumber", "title": "unable to tap the correct element on Iphone X simulator using calabash-cucumber 0.21.1", "body": "<p>I have updated my xcode to 9 and calabash-cucumber to 0.21.1 and runloop to 2.6.1. I am trying to run my tests on IPhoneX simulator to tap on a particular element but its tapping on somewhere on the screen. It worked fine until iPhone 7. Even the irb taps on different location. Is it the problem with the scale of the device or any gem issue? Please help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1508341310, "post_id": 46813803, "comment_id": 80575423, "body": "&quot;Your first array isn&#39;t an array, it&#39;s actually a hash&quot; \u2013 It&#39;s an array with a single element which is a hash."}, {"owner": {"reputation": 15962, "user_id": 472768, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L6pgx.png?s=128&g=1", "display_name": "FeifanZ", "link": "https://stackoverflow.com/users/472768/feifanz"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508342692, "post_id": 46813803, "comment_id": 80576418, "body": "Oh wow, you&#39;re right! Didn&#39;t realize the syntax worked that way."}], "tags": [], "owner": {"reputation": 15962, "user_id": 472768, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L6pgx.png?s=128&g=1", "display_name": "FeifanZ", "link": "https://stackoverflow.com/users/472768/feifanz"}, "is_accepted": false, "score": 0, "last_activity_date": 1508340283, "creation_date": 1508340283, "answer_id": 46813803, "question_id": 46813720, "link": "https://stackoverflow.com/questions/46813720/how-to-intersect-arrays-in-ruby/46813803#46813803", "title": "How to intersect arrays in ruby?", "body": "<p>Your first array isn't an array, it's actually a hash (notice the surrounding braces, rather than brackets):</p>\n\n<pre><code>validAccountTypes = {\n    'Asset' =&gt; 'Asset',\n    'Liability' =&gt; 'Liability',\n    'Equity' =&gt; 'Equity',\n    'Income' =&gt; 'Income',\n    'CostOfSales' =&gt; 'Cost of Sales',\n    'Expense' =&gt; 'Expenses',\n    'OtherIncome' =&gt; 'Other Income',\n    'OtherExpense' =&gt; 'Other Expenses',\n}\n</code></pre>\n\n<p>You can get the keys on the hash and <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-26\" rel=\"nofollow noreferrer\">intersect it</a> with your array:</p>\n\n<pre><code>common_keys = validAccountTypes.keys &amp; types\n</code></pre>\n\n<p>Then you can select only those keys:</p>\n\n<pre><code># Hash#slice works in Rails: \nvalidAccountTypes.slice(*common_keys)\n\n# Otherwise use Hash#select:\nvalidAccountTypes.select { |key, value| common_keys.include?(key) }\n</code></pre>\n\n<p>Note that in your example, your hash keys include <code>'OtherIncome'</code> and <code>'OtherExpense'</code>, but your <code>types</code> array includes <code>'Other Income'</code> and <code>'Other Expenses'</code>. Your array values should match the keys from the hash.</p>\n"}, {"tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": false, "score": 2, "last_activity_date": 1508358578, "last_edit_date": 1508358578, "creation_date": 1508340894, "answer_id": 46814010, "question_id": 46813720, "link": "https://stackoverflow.com/questions/46813720/how-to-intersect-arrays-in-ruby/46814010#46814010", "title": "How to intersect arrays in ruby?", "body": "<p>Here's a rewrite of your variables with a few changes:</p>\n\n<ul>\n<li>Underscore variable names</li>\n<li><code>valid_account_types</code> is now a hash instead of an array containing a hash.</li>\n<li><p>Some typos corrected so that the members of <code>types</code> match keys of <code>valid_account_types</code>.</p>\n\n<pre><code>valid_account_types = {\n  'Asset' =&gt; 'Asset',\n  'Liability' =&gt; 'Liability',\n  'Equity' =&gt; 'Equity',\n  'Income' =&gt; 'Income',\n  'CostOfSales' =&gt; 'Cost of Sales',\n  'Expense' =&gt; 'Expenses',\n  'OtherIncome' =&gt; 'Other Income',\n  'OtherExpenses' =&gt; 'Other Expenses',\n}\n\ntypes = [\n  'Asset',\n  'OtherIncome',\n  'OtherExpenses',\n]\n</code></pre></li>\n</ul>\n\n<p>Given that setup, if you are using Rails, you can get the result you want using <code>Hash#slice</code>, like this:</p>\n\n<pre><code>&gt; valid_account_types.slice(*types)\n=&gt; {\"Asset\"=&gt;\"Asset\", \"OtherIncome\"=&gt;\"Other Income\", \"OtherExpenses\"=&gt;\"Other Expenses\"}\n</code></pre>\n\n<p>Note that <code>Hash#slice</code> does not exist in Ruby itself. If you want to do this in plain-old Ruby, you could check out <a href=\"https://github.com/svenfuchs/i18n/blob/6f291c427bd2df08037fbc500c529fa71b167f97/lib/i18n/core_ext/hash.rb\" rel=\"nofollow noreferrer\">the implementation in i18n</a>:</p>\n\n<pre><code>class Hash\n  def slice(*keep_keys)\n    h = self.class.new\n    keep_keys.each { |key| h[key] = fetch(key) if has_key?(key) }\n    h\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 4014086, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79abf8409de207e8718cb1ad92a0ead1?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/4014086/juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508358578, "creation_date": 1508340037, "last_edit_date": 1508340623, "question_id": 46813720, "link": "https://stackoverflow.com/questions/46813720/how-to-intersect-arrays-in-ruby", "title": "How to intersect arrays in ruby?", "body": "<p>i'm new to ruby and i want to instersect two arrays</p>\n\n<pre><code>validAccountTypes = [\n    'Asset' =&gt; 'Asset',\n    'Liability' =&gt; 'Liability',\n    'Equity' =&gt; 'Equity',\n    'Income' =&gt; 'Income',\n    'CostOfSales' =&gt; 'Cost of Sales',\n    'Expense' =&gt; 'Expenses',\n    'OtherIncome' =&gt; 'Other Income',\n    'OtherExpense' =&gt; 'Other Expenses',\n]\n\ntypes = [\n    'Asset',\n    'Other Income',\n    'Other Expenses',\n]\n</code></pre>\n\n<p>I want a result of valid Accounts with keys base on array types. The output would be</p>\n\n<pre><code>[{\"Asset\"=&gt;\"Asset\", \"OtherIncome\"=&gt;\"Other Income\", \"OtherExpense\" =&gt; \"Other Expenses\"}]\n</code></pre>\n\n<p>Is it possible without a loop?</p>\n"}, {"tags": ["ruby", "rvm", "capistrano", "bundler", "rvm-capistrano"], "answers": [{"tags": [], "owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508354135, "creation_date": 1508354135, "answer_id": 46817617, "question_id": 46813470, "link": "https://stackoverflow.com/questions/46813470/rails-app-deployment-capistrano-bundles-with-invalid-ruby-version/46817617#46817617", "title": "(Rails app deployment) capistrano bundles with invalid ruby version", "body": "<p>I believe this can happen because you have system-wide ruby 2.3.0, and capistrano uses it by default.</p>\n\n<p>You can give a try to <a href=\"https://github.com/capistrano/rvm\" rel=\"nofollow noreferrer\">https://github.com/capistrano/rvm</a> or some related, more up to date gem, that provides rvm integration with capistrano.</p>\n"}, {"tags": [], "owner": {"reputation": 447, "user_id": 3816367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ncI.jpg?s=128&g=1", "display_name": "cmramseyer", "link": "https://stackoverflow.com/users/3816367/cmramseyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1508777961, "creation_date": 1508777961, "answer_id": 46894709, "question_id": 46813470, "link": "https://stackoverflow.com/questions/46813470/rails-app-deployment-capistrano-bundles-with-invalid-ruby-version/46894709#46894709", "title": "(Rails app deployment) capistrano bundles with invalid ruby version", "body": "<p>I had a similar issue and it was like Stanislav said, it's a problem with the rvm system-wide installation. I'm sure that you have installed the Ruby on Rails One click Application. In order to solve it I created a new clean Ubuntu Droplet, and installed rvm single-user manually.</p>\n"}], "owner": {"reputation": 159, "user_id": 5991661, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3bc05383ba2afb69b58f730be78e2c?s=128&d=identicon&r=PG&f=1", "display_name": "Rafonix", "link": "https://stackoverflow.com/users/5991661/rafonix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508777961, "creation_date": 1508339258, "question_id": 46813470, "link": "https://stackoverflow.com/questions/46813470/rails-app-deployment-capistrano-bundles-with-invalid-ruby-version", "title": "(Rails app deployment) capistrano bundles with invalid ruby version", "body": "<p>I have Digital Ocean ubuntu droplet, I have installed RVM and set ruby version to 2.1.1</p>\n\n<p>On server:</p>\n\n<pre><code>&gt; env\nRUBY_VERSION=ruby-2.1.1\n</code></pre>\n\n<p><code>ruby -v</code> in my project: <code>ruby 2.1.1p76 (2014-02-24 revision 45161) [x86_64-darwin12.0]\n</code></p>\n\n<p>I've tried to deploy app with capistrano, but it failed, because of <code>bundler</code> </p>\n\n<p>command <code>cap production deploy</code> creates\n<code>/home/deploy/app_name/shared/bundle/ruby/2.3.0</code></p>\n\n<p>Where can I set a valid bundle ruby version? Why <code>cap production deploy</code> creates 2.3.0 v. directory? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 6034998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-vtaWMdlttYk/AAAAAAAAAAI/AAAAAAAAADA/nVgDy2-nrds/photo.jpg?sz=128", "display_name": "Salman", "link": "https://stackoverflow.com/users/6034998/salman"}, "edited": false, "score": 0, "creation_date": 1508400684, "post_id": 46814058, "comment_id": 80598234, "body": "Hi Rabin, Thank you for your response! I&#39;ve tried applying you&#39;re method But I keep getting the same error. It seems spree doesn&#39;t recognize the code I added to the application_helper.rb"}], "tags": [], "owner": {"reputation": 464, "user_id": 6720055, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Qor8L0OFVjU/AAAAAAAAAAI/AAAAAAAAABA/-ei57u2kNfQ/photo.jpg?sz=128", "display_name": "Rabin Poudyal", "link": "https://stackoverflow.com/users/6720055/rabin-poudyal"}, "is_accepted": true, "score": 1, "last_activity_date": 1508341030, "creation_date": 1508341030, "answer_id": 46814058, "question_id": 46813326, "link": "https://stackoverflow.com/questions/46813326/spree-active-menu/46814058#46814058", "title": "Spree active menu", "body": "<p>See the reference below. I have used activated instead of active. you can style the activated class thereafter</p>\n\n<pre><code>&lt;div class=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\"&gt;\n        &lt;ul class=\"nav navbar-nav navbar-right\" id=\"link-section\"&gt;\n            &lt;li class=\"&lt;%= 'activated' if current_page?(root_path) %&gt;\"&gt;\n                &lt;a href=\"/\"&gt;Home\n                    &lt;span class=\"sr-only\"&gt;(current)&lt;/span&gt;\n                &lt;/a&gt;\n            &lt;/li&gt;\n            &lt;li class=\"&lt;%= 'activated' if current_page?(new_user_registration_path) %&gt;\"&gt;\n                &lt;%= link_to(\"Register\", new_user_registration_path) unless user_signed_in? %&gt;\n            &lt;/li&gt;\n            &lt;li class=\"&lt;%= 'activated' if current_page?(pricing_path) %&gt;\"&gt;\n                &lt;%= link_to(\"Pricing\", pricing_path) %&gt;\n            &lt;/li&gt;\n            &lt;li class=\"\"&gt;\n                &lt;% if current_user %&gt;\n                    &lt;%= link_to(\"Store\", shop_path(current_user.shop)) if current_user.shop.present? %&gt;\n                &lt;% end %&gt;\n            &lt;/li&gt;\n            &lt;li class=\"&lt;%= 'activated' if current_page?(new_user_session_path) %&gt;\"&gt;\n                &lt;%= link_to(\"Login\", new_user_session_path) unless user_signed_in? %&gt;\n            &lt;/li&gt;\n            &lt;li class=\"&lt;%= 'activated' if current_page?(dashboard_path) %&gt;\"&gt;\n                &lt;%= link_to(\"Dashboard\", dashboard_path) if user_signed_in? %&gt;\n            &lt;/li&gt;\n            &lt;li&gt;\n\n            &lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 6034998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-vtaWMdlttYk/AAAAAAAAAAI/AAAAAAAAADA/nVgDy2-nrds/photo.jpg?sz=128", "display_name": "Salman", "link": "https://stackoverflow.com/users/6034998/salman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 46814058, "answer_count": 1, "score": 0, "last_activity_date": 1508341030, "creation_date": 1508338875, "question_id": 46813326, "link": "https://stackoverflow.com/questions/46813326/spree-active-menu", "title": "Spree active menu", "body": "<p><strong>What do i want to achieve?</strong></p>\n\n<p>I'm trying to add an active-menu (<em>highlight current page in the menu</em>) to my spree/ruby on rails application.</p>\n\n<p><strong>What have I tried?</strong></p>\n\n<p>After doing some research I've found <a href=\"https://stackoverflow.com/questions/17481812/dynamically-add-active-class-to-bootstrap-li-in-rails\">this</a> question posted very helpful, but as you might have guessed the implementation of the solution I <a href=\"https://stackoverflow.com/questions/17481812/dynamically-add-active-class-to-bootstrap-li-in-rails\">found</a> didn't get me the result I wanted.</p>\n\n<p>The solution I found was adding the following code to the:</p>\n\n<p><strong>The Code</strong></p>\n\n<p><strong><em>application_helper.rb</em></strong></p>\n\n<pre><code>module ApplicationHelper\n\n def active_class(link_path)\n  current_page?(link_path) ? \"active\" : \"\"\n end\n\nend\n</code></pre>\n\n<p><strong><em>routes.rb</em></strong></p>\n\n<pre><code>   root 'spree/home#home'\n\n   get '/specs', to: 'spree/home#specs'\n   get '/about', to: 'spree/home#about'\n   get '/purchase', to: 'spree/home#purchase'\n   get '/support', to: 'spree/home#support'\n</code></pre>\n\n<p><strong><em>nav.html.erb</em></strong></p>\n\n<pre><code>&lt;li class=\"&lt;%= active_class(root_path) %&gt;\"&gt;\n&lt;%= link_to \"Home\", root_path %&gt;\n&lt;/li&gt;\n\n&lt;li class=\"&lt;%= active_class(purchase_path) %&gt;\"&gt;\n&lt;%= link_to \"Purchase\", purchase_path %&gt;\n&lt;/li&gt;\n\n&lt;li&gt;\n&lt;%= link_to \"About\", purchase_path %&gt;\n&lt;/li&gt;\n\n&lt;li class=\"&lt;%= active_class(specs_path) %&gt;\"&gt;\n&lt;%= link_to \"Technical Details\", specs_path %&gt;\n&lt;/li&gt;\n\n&lt;li class=\"&lt;%= active_class(support_path) %&gt;\"&gt;\n&lt;%= link_to \n</code></pre>\n\n<p><strong>The Error</strong></p>\n\n<p>But now, no matter what page I go to I get the following error:</p>\n\n<pre><code>NameError in Spree::Home#purchase\nShowing /home/ubuntu/workspace/mystore/app/views/spree/shared/_nav_bar.html.erb where line #9 raised:\n\nundefined local variable or method `purchase_path' for #&lt;#&lt;Class:0x007f35a30c6b80&gt;:0x007f35a3642a00&gt;\nExtracted source (around line #9):\n\n\n&lt;/li&gt;\n\n&lt;li class=\"&lt;%= active_class(purchase_path) %&gt;\"&gt;\n&lt;%= link_to \"Purchase\", purchase_path %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>I've tried changing several variables, but to no avail</p>\n\n<p><strong>My question is</strong>:</p>\n\n<p>How do i create an active menu in Spree (since it's the root of the problem)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rubocop", "rubocop-rspec"], "comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1508339708, "post_id": 46813303, "comment_id": 80574267, "body": "Can you also share the code you&#39;re testing? Replacing bad way of mocking with just different mocking is not the best idea, Probably you should change the tested code, but it&#39;s hard to tell how without seeing it."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1508340652, "post_id": 46813303, "comment_id": 80574938, "body": "What about <code>allow(SportRateManager).to receive(:create).and_return(sport_manager)</code>? The <i>instance</i> doesn&#39;t receive create, the class does."}], "answers": [{"tags": [], "owner": {"reputation": 856, "user_id": 3755578, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmkSj.jpg?s=128&g=1", "display_name": "eudaimonia", "link": "https://stackoverflow.com/users/3755578/eudaimonia"}, "is_accepted": true, "score": 15, "last_activity_date": 1508408238, "creation_date": 1508408238, "answer_id": 46827647, "question_id": 46813303, "link": "https://stackoverflow.com/questions/46813303/rspec-avoid-using-allow-any-instance-of-to-receive/46827647#46827647", "title": "RSpec: Avoid using allow any instance of to receive", "body": "<p>The solution was almost done. You probably need to add <code>build :sport_rate</code> before create</p>\n\n<p>Sth like that </p>\n\n<pre><code>let(:sport_manager) { instance_double(SportRateManager) }\n\nbefore do\n  allow(SportRateManager).to receive(:new).and_return(sport_manager)\n  allow(sport_manager).to receive(:sport_rate).and_return(build :sport_rate)\n  allow(sport_manager).to receive(:create).and_return(true)\nend\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7190850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ca2cfb683061317aa129cab70a2e41?s=128&d=identicon&r=PG&f=1", "display_name": "Maria N", "link": "https://stackoverflow.com/users/7190850/maria-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8427, "favorite_count": 1, "accepted_answer_id": 46827647, "answer_count": 1, "score": 9, "last_activity_date": 1514563953, "creation_date": 1508338813, "last_edit_date": 1514563953, "question_id": 46813303, "link": "https://stackoverflow.com/questions/46813303/rspec-avoid-using-allow-any-instance-of-to-receive", "title": "RSpec: Avoid using allow any instance of to receive", "body": "<p>I'm working on one old part of code. </p>\n\n<pre><code>before do\n  allow_any_instance_of(SportRateManager)\n    .to receive(:create)\n    .and_return(true)\nend\n</code></pre>\n\n<p>There is Rubocop error like:</p>\n\n<blockquote>\n  <p>Avoid stubbing using 'allow_any_instance_of'</p>\n</blockquote>\n\n<p>I read about <a href=\"http://www.rubydoc.info/gems/rubocop-rspec/1.7.0/RuboCop/Cop/RSpec/AnyInstance\" rel=\"noreferrer\">RuboCop::RSpec:AnyInstance</a> and I tried to change it like bellow.</p>\n\n<p>From this</p>\n\n<pre><code>before do\n  allow_any_instance_of(SportRateManager)\n    .to receive(:create)\n    .and_return(true)\nend\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>let(:sport_manager) { instance_double(SportRateManager) }\n\nbefore do\n  allow(SportRateManager).to receive(:new).and_return(sport_manager)\n  allow(sport_manager).to receive(:create).and_return(true)\nend\n</code></pre>\n\n<p>And with full context:\n- before</p>\n\n<pre><code>describe 'POST create' do\n    let(:sport_rate) { build(:sport_rate) }\n    let(:action) { post :create, sport_rate: sport_rate.attributes }\n\n    context 'when sport rate manager created the rate successfully' do\n      before do\n        allow_any_instance_of(SportRateManager)\n          .to receive(:create)\n          .and_return(true)\n      end\n\n      it 'returns ok status' do\n        action\n        expect(response).to have_http_status(:ok)\n      end\n    end\n</code></pre>\n\n<p>... - after:</p>\n\n<pre><code>describe 'POST create' do\n    let(:sport_rate) { build(:sport_rate) }\n    let(:action) { post :create, sport_rate: sport_rate.attributes }\n    let(:sport_manager) { instance_double(SportRateManager) }\n\n    context 'when sport rate manager created the sport successfully' do\n      before do\n        allow(SportRateManager).to receive(:new).and_return(sport_manager)\n        allow(sport_manager).to receive(:create).and_return(true)\n      end\n\n      it 'returns ok status' do\n        action\n        expect(response).to have_http_status(:ok)\n      end\n    end\n</code></pre>\n\n<p>But this doesn't pass the test with error:</p>\n\n<p><code>#&lt;InstanceDouble(SportRateManager) (anonymous)&gt; received unexpected message :sport_rate with (no args)</code> </p>\n"}, {"tags": ["ruby", "rabbitmq", "bunny"], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 6103484, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66dd9f521f1f408c3cae829776ec8acc?s=128&d=identicon&r=PG", "display_name": "GPif", "link": "https://stackoverflow.com/users/6103484/gpif"}, "is_accepted": false, "score": 0, "last_activity_date": 1508491874, "creation_date": 1508491874, "answer_id": 46846210, "question_id": 46812873, "link": "https://stackoverflow.com/questions/46812873/bunnynofinalocteterror-after-some-time-without-message/46846210#46846210", "title": "Bunny::NoFinalOctetError after some time without message", "body": "<p>Turn out to be an issue on packet parsing.</p>\n\n<p>The bug can be followed <a href=\"https://github.com/ruby-amqp/bunny/issues/521#issuecomment-338022974\" rel=\"nofollow noreferrer\">her</a></p>\n"}], "owner": {"reputation": 443, "user_id": 6103484, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66dd9f521f1f408c3cae829776ec8acc?s=128&d=identicon&r=PG", "display_name": "GPif", "link": "https://stackoverflow.com/users/6103484/gpif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1508491874, "creation_date": 1508337655, "last_edit_date": 1508426709, "question_id": 46812873, "link": "https://stackoverflow.com/questions/46812873/bunnynofinalocteterror-after-some-time-without-message", "title": "Bunny::NoFinalOctetError after some time without message", "body": "<p>Using a rabbit mq installed with <a href=\"https://hub.docker.com/_/rabbitmq/\" rel=\"nofollow noreferrer\">official docker image</a> my worker fail with the exception Bunny::NoFinalOctetError after some time (around 40s) .</p>\n\n<p>My worker code is :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'bunny'\nrequire 'securerandom'\n\n#TODO set host as parameter\nrabbit_conn = Bunny.new\nrabbit_conn.start\n\nch   = rabbit_conn.create_channel\nq    = ch.queue(\"task\", :durable =&gt; true)\nch.prefetch(1)\n\nbegin\n  q.subscribe(:manual_ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|\n        pp body \n    ch.ack(delivery_info.delivery_tag)\n  end\nrescue Interrupt =&gt; _\n  rabbit_conn.close\nend\n</code></pre>\n\n<p>I send data via the following code :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"bunny\"\n\nconn = Bunny.new\nconn.start\n\nch   = conn.create_channel\nq    = ch.queue(\"task\", :durable =&gt; true)\n\n[\n    'titi',\n    'toto',\n    'tata'\n].each do |d|\n    q.publish(d, :persistent =&gt; true)\nend\n\nsleep 1.0\nconn.close\n</code></pre>\n\n<p>and after arround 40s I get the folllowing output in my worker</p>\n\n<pre><code>\"titi\"\n\"toto\"\n\"tata\"\nE, [2017-10-18T15:56:55.938661 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;: Exception in the reader loop: Bunny::NoFinalOctetError: Frame doesn't end with \ufffd as it must, which means the size is miscalculated.\nE, [2017-10-18T15:56:55.938890 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;: Backtrace: \nE, [2017-10-18T15:56:55.939037 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;:     /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/transport.rb:255:in `read_next_frame'\nE, [2017-10-18T15:56:55.939114 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;:     /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/reader_loop.rb:68:in `run_once'\nE, [2017-10-18T15:56:55.939175 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;:     /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/reader_loop.rb:35:in `block in run_loop'\nE, [2017-10-18T15:56:55.939233 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;:     /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/reader_loop.rb:32:in `loop'\nE, [2017-10-18T15:56:55.939288 #28583] ERROR -- #&lt;Bunny::Session:0x56182de41e48 guest@127.0.0.1:5672, vhost=/, addresses=[127.0.0.1:5672]&gt;:     /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/reader_loop.rb:32:in `run_loop'\nTraceback (most recent call last):\n        5: from worker2.rb:21:in `&lt;main&gt;'\n        4: from /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/queue.rb:196:in `subscribe'\n        3: from /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/consumer_work_pool.rb:77:in `join'\n        2: from /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/consumer_work_pool.rb:77:in `each'\n        1: from /home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/consumer_work_pool.rb:77:in `block in join'\n/home/gg/.rvm/gems/ruby-head/gems/bunny-2.7.1/lib/bunny/consumer_work_pool.rb:77:in `join': caught an unexpected exception in the network loop: Frame doesn't end with \ufffd as it must, which means the size is miscalculated. (Bunny::NetworkFailure)\n</code></pre>\n\n<h2>Update about the network</h2>\n\n<p>I sniffed the network as it seems to be a malformed network packet. And indeed, the error is trigger after receiving a sp\u00e9cific packet.</p>\n\n<p>Whireshark capture below, the error occur when receiving the packet 299.\n<a href=\"https://i.stack.imgur.com/frCpM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/frCpM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Yet I have no idea what this packet is, nor why it is not handled by bunny.</p>\n\n<h1>Update Github Ticket</h1>\n\n<p>I opened a ticket <a href=\"https://github.com/ruby-amqp/bunny/issues/521\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1508336765, "post_id": 46812152, "comment_id": 80572144, "body": "I don&#39;t understand this code. Why are you using a <code>Hash</code>? What is <code>regnr</code>? What is <code>name</code>? What is <code>employees.txt</code>? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of the problem, including the actual error/unexpected behaviour."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1508337535, "post_id": 46812152, "comment_id": 80572716, "body": "You&#39;re using <a href=\"http://ruby-doc.org/core/String.html#method-i-3D-7E\" rel=\"nofollow noreferrer\">=~</a> incorrectly."}], "answers": [{"tags": [], "owner": {"reputation": 1869, "user_id": 1454158, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/00c67acbbd503f63bad53da85439b3a4?s=128&d=identicon&r=PG", "display_name": "Volte", "link": "https://stackoverflow.com/users/1454158/volte"}, "is_accepted": false, "score": 0, "last_activity_date": 1508338007, "creation_date": 1508338007, "answer_id": 46813011, "question_id": 46812152, "link": "https://stackoverflow.com/questions/46812152/how-to-save-a-hash-in-a-file-and-use-it-later-in-ruby/46813011#46813011", "title": "How to save a hash in a file and use it later in ruby?", "body": "<p>I'd recommend using <code>yaml</code>. Take a look around the web for some examples on using YAML. It's a structured markup that can represent hashes. You can easily dump and load simple ruby objects like hashes and arrays.</p>\n\n<pre><code>require 'yaml'\n\nparsed = begin\n  employee_hash = YAML.load(File.open(\"employees.yml\"))\nrescue ArgumentError =&gt; e\n  puts \"Could not parse YAML: #{e.message}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8795980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1771772566228868/picture?type=large", "display_name": "Alin Chiver", "link": "https://stackoverflow.com/users/8795980/alin-chiver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508338007, "creation_date": 1508335645, "last_edit_date": 1508335857, "question_id": 46812152, "link": "https://stackoverflow.com/questions/46812152/how-to-save-a-hash-in-a-file-and-use-it-later-in-ruby", "title": "How to save a hash in a file and use it later in ruby?", "body": "<p>So i got in big troubles with this exam at university because i am stuck with a part in my ruby code. I just can't figure out how </p>\n\n<p>\" If the user presses 2 the program shall ask for an employee number and afterwards search for the employee. If the program finds it, then print and if not, print a message saying it doesn\u2019t have it.\"</p>\n\n<p>My problem is that i'm not sure that the information is saved corectly in the file. But if it is... the problem is that the hash i've made isn't taking the information that already is saved in the file and only works with the information it has received last.</p>\n\n<pre><code>puts \"Insert Registration number \\n\"\nsearch = gets.chomp\n\nhash = Hash.new()\nhash = {(regnr) =&gt; (name)}\nhash.each do |key, value|\n  puts \"#{key} \\t | \\t #{value}\"\nend\n\nsearch =~ File.new(\"employees.txt\", \"r\")\n\nif hash.has_key? (search)\n  print \"The person you were looking for is \"\n  puts hash [search]\nelse\n  puts \"He isn't one of our employees\"\nend\n</code></pre>\n\n<p>I have to tell you guys that i have only been coding for one month and the school isn't taking me easy...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "edited": false, "score": 0, "creation_date": 1508336475, "post_id": 46812274, "comment_id": 80571963, "body": "No, not gems no longer being used, but actually the new versions of gems that I don&#39;t want. Just trying to go backwards on my gem versions"}], "tags": [], "owner": {"reputation": 37836, "user_id": 24195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4bebe360045a2dce663ee875f13723?s=128&d=identicon&r=PG", "display_name": "Rob Di Marco", "link": "https://stackoverflow.com/users/24195/rob-di-marco"}, "is_accepted": false, "score": 0, "last_activity_date": 1508335938, "creation_date": 1508335938, "answer_id": 46812274, "question_id": 46811988, "link": "https://stackoverflow.com/questions/46811988/rollback-gems-according-to-version-in-gemfile-lock/46812274#46812274", "title": "Rollback gems according to version in Gemfile.lock", "body": "<p>If you would like to clean out old gems no longer in your <code>Gemfile.lock</code>, you can run <code>bundle clean</code>.</p>\n\n<p>However, even though the gems are still there, they are not being used if you run a task with <code>bundle exec</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "is_accepted": true, "score": 0, "last_activity_date": 1508336746, "creation_date": 1508336746, "answer_id": 46812546, "question_id": 46811988, "link": "https://stackoverflow.com/questions/46811988/rollback-gems-according-to-version-in-gemfile-lock/46812546#46812546", "title": "Rollback gems according to version in Gemfile.lock", "body": "<p>This is what I needed..  <code>gem uninstall &lt;gem name&gt;</code> and then if there are multiple gems you can pick which version you want to uninstall!</p>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 46812546, "answer_count": 2, "score": 1, "last_activity_date": 1508336746, "creation_date": 1508335194, "question_id": 46811988, "link": "https://stackoverflow.com/questions/46811988/rollback-gems-according-to-version-in-gemfile-lock", "title": "Rollback gems according to version in Gemfile.lock", "body": "<p>I need to revert back to an older set of gem's in my dev environment. I've replaced my <code>Gemfile.lock</code> file with the old versions I need. </p>\n\n<p>I thought I could just replace the <code>Gemfile.lock</code> and <code>bundle install</code> but that doesn't seem to work. Because when I do that and then run <code>bundle install</code> and then check the gem version number I get the same versions I had before.</p>\n\n<p>One of the gems I need to downgrade is the <code>rake</code> gem. The version I need is <code>11.1.2</code> but currently when I do <code>gem list</code> I get <code>rake (12.0.0, 11.1.2, 10.4.2)</code></p>\n\n<p>So how can I revert <code>rake</code> and all the other gems, back to their previous versions?</p>\n"}, {"tags": ["ruby", "rubygems", "tdd", "bundler", "minitest"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508334821, "post_id": 46811816, "comment_id": 80570830, "body": "How are you defining &quot;test env&quot;? If using an environmental variable for example, you could do: <code>ENV[&quot;RACK_ENV&quot;] == &quot;test&quot;</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508335070, "post_id": 46811816, "comment_id": 80571043, "body": "Your question sounds a bit dubious to be, though. You shouldn&#39;t be polluting your main code base with logic like &quot;skip this if running a test&quot;.... (Unless maybe you work for <a href=\"http://www.bbc.co.uk/news/business-34324772\" rel=\"nofollow noreferrer\">Votswagen</a>!)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508335719, "post_id": 46811816, "comment_id": 80571475, "body": "I would argue that a method that changes behavior in a test environment is untestable and that sounds like your method has design issues. Can you please explain what your method does and why you think it needs to change behavior in a test environment? Depending on your needs is mocking or stubbing the method in tests an option?"}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 1, "creation_date": 1508338445, "post_id": 46811816, "comment_id": 80573358, "body": "The reason I&#39;m &quot;bailing out&quot; is because I call a library method called <code>run_instances()</code> and when it&#39;s run, my credit card is charged a fee by a service provider."}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508338384, "creation_date": 1508334683, "last_edit_date": 1508338384, "question_id": 46811816, "link": "https://stackoverflow.com/questions/46811816/how-to-detect-test-env-during-minitest-runs-non-rails-project", "title": "How to detect test env during minitest runs (non rails project)", "body": "<p>When building a ruby application (such as a ruby gem)\nI have a method, and it needs to \"bail out\" if \"test env\" is detected.</p>\n\n<p>In a rails test, this is how I would do it</p>\n\n<p>def foo\n  return if Rails.env == \"test\"\nend</p>\n\n<p>How do you do it on a non-rails project. (I'm building a ruby gem with minitest as the test framework)</p>\n\n<p>To give some background info, this project was started using instructions at <a href=\"http://bundler.io/v1.12/guides/creating_gem.html\" rel=\"nofollow noreferrer\">http://bundler.io/v1.12/guides/creating_gem.html</a></p>\n\n<pre><code>bundle gem foodie\n</code></pre>\n"}, {"tags": ["node.js", "ruby", "image-processing", "concurrency"], "comments": [{"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1508334773, "post_id": 46811732, "comment_id": 80570780, "body": "What&#39;s the point of this: let protocol = getProtocol(req)"}, {"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1508334973, "post_id": 46811732, "comment_id": 80570963, "body": "I don&#39;t see anything wrong with your code.  If it works one image at a time or small batches, I would suspect the parser.parse.  I would try adding a log item like this:      log( req.params, resized_img, hash(data) )  before the res.write statement and see if that reveals anything"}, {"owner": {"reputation": 4429, "user_id": 102133, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/561a3a55352fe6a5343e541a6894b541?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/102133/ben"}, "reply_to_user": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1508335229, "post_id": 46811732, "comment_id": 80571153, "body": "` let protocol` was irrelevant here in the example you&#39;re right. I use <code>async.waterfall</code> in parser.parse, it only returns when the file is actually transformed and saved; i kind of trust it so far. would there be a better way to reinforce and ensure things are returned correctly for each requests ? I just don&#39;t see why at some point, it can return the same image for every requests made. thx for your hints, i will double check that way anyhow"}, {"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1508337676, "post_id": 46811732, "comment_id": 80572819, "body": "No - the only suspect would be some sort of shared memory that is getting reused at load."}, {"owner": {"reputation": 4429, "user_id": 102133, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/561a3a55352fe6a5343e541a6894b541?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/102133/ben"}, "reply_to_user": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1508408379, "post_id": 46811732, "comment_id": 80602611, "body": "solved it. using sharp, i had the <code>toFile</code> method in <code>parser.parse</code>, then using <code>readFileSync</code> to return it to the client. Taking back the <code>toFile</code> method to the main app.get() context, and using request to pipe the output (rather than using <code>readFileSync</code>), things started to work a expected. problem is, i just don&#39;t understand why the first one not working; which was more or less the bottom of my question"}], "owner": {"reputation": 4429, "user_id": 102133, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/561a3a55352fe6a5343e541a6894b541?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/102133/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508334968, "creation_date": 1508334420, "last_edit_date": 1508334968, "question_id": 46811732, "link": "https://stackoverflow.com/questions/46811732/nodejs-vs-ruby-understanding-requests-processing-order", "title": "nodejs vs. ruby / understanding requests processing order", "body": "<p>I have a simple utility that i use to size image on the fly via url params.\nHaving some troubles with the ruby image libraries (cmyk to rvb is, how to say\u2026 \"unavailable\"), i gave it a shot via nodejs, which solved the issue. </p>\n\n<p>Basically, if the image does not exists, node or ruby transforms it. Otherwise when the image has already been requested/transformed, the ruby or node processes aren't touched, the image is returned statically</p>\n\n<p>The ruby works perfectly, a bit slow if lot of transforms are requested at once, but very stable, it always go through whatever the amount (i see the images arriving one the page one after another)</p>\n\n<p>With node, it works also perfectly, but when a large amount of images are requested, for a single page load, the first images is transformed, then all the others requests returns the very same image (the last transformed one). If I refresh the page, the first images (already transformed) is returned right away, the second one is returned correctly transformed, but then all the other images returned are the same as the one just newly transformed. and it goes on the same for every refresh. not optimal , basically the resquests are \"merged\" at some point and all return the same image. for reason i don't understand</p>\n\n<p>(When using 'large amount', i mean more than 1)</p>\n\n<p>The ruby version : </p>\n\n<pre><code>get \"/:commands/*\" do |commands,remote_path|\n    path          = \"./public/#{commands}/#{remote_path}\"\n    root_domain   = request.host.split(/\\./).last(2).join(\".\")\n    url           = \"https://storage.googleapis.com/thebucket/store/#{remote_path}\"\n    img           = Dragonfly.app.fetch_url(url)\n    resized_img   = img.thumb(commands).to_response(env)\n    return resized_img\nend\n</code></pre>\n\n<p>The node js version :</p>\n\n<pre><code>app.get('/:transform/:id', function(req,res,next){\n  parser.parse(req.params,function(resized_img){\n    // the transform are done via lovell/sharp\n    // parser.parse parse the params, write the file,\n    // return the file path\n    // then :\n    fs.readFileSync(resized_img, function(error,data){\n      res.write(data)\n      res.end()\n    })\n  })\n})\n</code></pre>\n\n<p>Feels like I'm missing here a crucial point in node. I expected the same behaviour with node and ruby, but obviously the same pattern transposed in the node area just does not work as expected. Node is not waiting for a request to process, rather processes those somehow in an order that is not clear to me</p>\n\n<p>I also understand that i'm not putting the right words to describe the issue, hoping that it might speak to some experienced users, let them provide clarifiactions to get a better understanding of what happens behind the node scenes</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3309, "user_id": 3786332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R33iW.jpg?s=128&g=1", "display_name": "uzaif", "link": "https://stackoverflow.com/users/3786332/uzaif"}, "edited": false, "score": 0, "creation_date": 1508335749, "post_id": 46811686, "comment_id": 80571491, "body": "try <code>attr</code> instead of  <code>prop</code> with <code>attr(&quot;disabled&quot;,&quot;disabled&quot;)</code> when you want to add <code>disabled</code>"}], "answers": [{"tags": [], "owner": {"reputation": 223, "user_id": 7851541, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f110b8df514ad202024359afd8fc70c6?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/7851541/maxim"}, "is_accepted": true, "score": 0, "last_activity_date": 1508335610, "creation_date": 1508335610, "answer_id": 46812131, "question_id": 46811686, "link": "https://stackoverflow.com/questions/46811686/using-jquery-in-ruby-input-fields-utilising-prop-method-to-add-disbaled/46812131#46812131", "title": "using jQuery in Ruby input fields, utilising .prop() method to add disbaled", "body": "<p>There should be</p>\n\n<pre><code>$(\"#scheduled-date\").prop(\"disabled\", true);\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>$(\"#scheduled-date\").prop(\"disbaled:\", true);\n</code></pre>\n\n<p>And similarly for the next two lines</p>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 7495784, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211983730091551/picture?type=large", "display_name": "Diego Patricio Aguilef S&#225;nchez", "link": "https://stackoverflow.com/users/7495784/diego-patricio-aguilef-s%c3%a1nchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1508335653, "creation_date": 1508335653, "answer_id": 46812158, "question_id": 46811686, "link": "https://stackoverflow.com/questions/46811686/using-jquery-in-ruby-input-fields-utilising-prop-method-to-add-disbaled/46812158#46812158", "title": "using jQuery in Ruby input fields, utilising .prop() method to add disbaled", "body": "<p>look at your code. you  have set 'disbaled' instead of 'disabled'. so you can use .attr() method to define an attribute with jquery, like:</p>\n\n<p><code>$(\"#publish\").attr(\"disabled\", \"disabled\"); or $(\"#publish\").attr(\"disabled\", false);</code>.</p>\n\n<p>Disabled attr doesn't permits take the input value to send in POST method, so you have to set the 'readonly' attribute, like this: </p>\n\n<p><code>$(\"#publish\").attr(\"readonly\", \"readonly\");</code> or <code>$(\"#publish\").attr(\"readonly\", false);</code> </p>\n\n<p>or use .removeAttr() to remove attributes</p>\n"}], "owner": {"reputation": 1, "user_id": 7993848, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-OJdEluwfgjg/AAAAAAAAAAI/AAAAAAAAAAs/4ap4Hy5QiMw/photo.jpg?sz=128", "display_name": "James Clarke", "link": "https://stackoverflow.com/users/7993848/james-clarke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 46812131, "answer_count": 2, "score": -1, "last_activity_date": 1508335653, "creation_date": 1508334298, "question_id": 46811686, "link": "https://stackoverflow.com/questions/46811686/using-jquery-in-ruby-input-fields-utilising-prop-method-to-add-disbaled", "title": "using jQuery in Ruby input fields, utilising .prop() method to add disbaled", "body": "<p>I am trying to add and remove disabled attributes to input fields but am having no luck with .prop() method.</p>\n\n<p>here is the html/ruby on rails </p>\n\n<p>`</p>\n\n<pre><code>&lt;div class=\"input-group\"&gt;\n        &lt;span class=\"input-group-addon\"&gt;\n          &lt;input  id=\"scheduled-checkbox\" type=\"checkbox\"&gt;&lt;/input&gt;\n          &lt;!-- checked=\"&lt;%= !f.object.published_on.nil? %&gt;\" disabled=\"&lt;%= f.object.published? %&gt;\" --&gt;\n      &lt;/span&gt;\n      &lt;input disabled=\"\" id=\"scheduled-date\" class=\"form-control\"  type=\"date\" value=\"&lt;%= f.object.published_on %&gt;\"&gt;&lt;/input&gt;\n    &lt;%= f.input :published_on, as: :hidden, input_html: { value: f.object.published_on } %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"form-group\"&gt;\n  &lt;% if f.object.persisted? %&gt;\n    &lt;%= f.submit I18n.t(\"rag.update\"), name: :submit, value: :update,  class: \"btn_default_1 add_margin_top form-control\" %&gt;\n    &lt;%= f.submit I18n.t(\"rag.publish_now\"), name: :submit, value: :publish, class: \"btn_default_1 add_margin_top form-control\" %&gt;\n  &lt;% else %&gt;\n    &lt;%= f.submit I18n.t(\"rag.draft\"), name: :submit, value: :draft,  class: \"btn_default_1 add_margin_top form-control submit\", id: :draft %&gt;\n    &lt;%= f.submit I18n.t(\"rag.publish\"), name: :submit, value: :publish, class: \"btn_default_1 add_margin_top form-control submit\", id: :publish %&gt;\n    &lt;%= f.submit I18n.t(\"rag.schedule\"), name: :submit, value: :schedule, class: \"btn_default_1 add_margin_top form-control submit\", id: :schedule  %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>here is the JS</p>\n\n<pre><code>`$(\"#scheduled-checkbox\").change(function() {\n\n    if ($(\"#scheduled-checkbox\").is(':checked')) {\n      console.log('box is checked'); //checked means PUBLISH submit button is disabled\n      $(\"#scheduled-date\").prop(\"disbaled:\", true);\n      $(\"#schedule\").prop(\"disbaled:\", false);\n      $(\"#publish\").prop(\"disbaled:\", true);\n\n    } else {\n      console.log('box is unchecked');   //unchecked means SCHEDULE submit button is disbaled\n      $(\"#scheduled-date\").removeAttr('disabled', false);\n      $(\"#schedule\").removeAttr(\"disbaled:\");\n      $(\"#publish\").removeAttr(\"disbaled:\");\n\n      console.log($(\"#scheduled-date\").removeAttr('disabled'));\n    }`\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508334266, "post_id": 46811444, "comment_id": 80570428, "body": "You need to put <code>require &#39;spec_helper&#39;</code> at the top of each spec."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508334275, "post_id": 46811444, "comment_id": 80570437, "body": "It won&#39;t be loaded by magic!"}, {"owner": {"reputation": 1420, "user_id": 238650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QZGrg.jpg?s=128&g=1", "display_name": "Maciej Jureczko", "link": "https://stackoverflow.com/users/238650/maciej-jureczko"}, "edited": false, "score": 0, "creation_date": 1508334282, "post_id": 46811444, "comment_id": 80570439, "body": "Please do something with this formatting..."}], "answers": [{"comments": [{"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1508349489, "post_id": 46814244, "comment_id": 80579992, "body": "@Webdriver Edited, don&#39;t run from <code>spec</code>."}, {"owner": {"reputation": 23, "user_id": 4605745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a1017ca0a264cfa522b98c4d6a86c7?s=128&d=identicon&r=PG&f=1", "display_name": "Webdriver", "link": "https://stackoverflow.com/users/4605745/webdriver"}, "edited": false, "score": 0, "creation_date": 1508409228, "post_id": 46814244, "comment_id": 80603060, "body": "Thank you verry much for your input. @Tom Lord @BernardK. I did run <code>rspec</code> from <code>spec</code>"}], "tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 0, "last_activity_date": 1508349285, "last_edit_date": 1508349285, "creation_date": 1508341613, "answer_id": 46814244, "question_id": 46811444, "link": "https://stackoverflow.com/questions/46811444/rspec-the-spec-helper-rb-is-not-loaded/46814244#46814244", "title": "RSpec: The spec_helper.rb is not loaded", "body": "<p>It works for me. I never <code>require 'spec_helper'</code> as it is done automatically by the <code>.rspec</code> file. I have followed <a href=\"https://pragprog.com/book/rspec3/effective-testing-with-rspec-3\" rel=\"nofollow noreferrer\">Effective Testing with RSpec 3</a> and did <code>rspec --init</code> as you describe.</p>\n\n<p>File <code>.../spec/spec_helper.rb</code> :</p>\n\n<pre><code>puts \"this is #{File.basename(__FILE__)}\"\n# This file was generated by the `rspec --init` command.\n...\n</code></pre>\n\n<p>Test file :</p>\n\n<pre><code># file .../spec/t2_spec.rb\n\nclass XXX\nend\n\nRSpec.describe XXX do\n    describe '#xxx' do\n        it 'xxx' do\n            puts '... testing ...'\n        end\n    end\nend\n</code></pre>\n\n<p>Execution (RSpec 3.6.0.beta2 on OS X) :</p>\n\n<pre><code>$ rspec\nthis is spec_helper.rb\n\nXXX\n  #xxx\n... testing ...\n    xxx\n\nFinished in 0.001 seconds (files took 0.10816 seconds to load)\n1 example, 0 failures\n</code></pre>\n\n<blockquote>\n  <p>It generated the file \".rspec\" and \"specs\\spec_helper.rb\"</p>\n</blockquote>\n\n<p>Are you sure your specs directory is <code>spec</code> not <code>specs</code> ?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I read again your post and see :</p>\n\n<blockquote>\n  <p>1.c) I always execute my specs.rb from the folder \"specs\"</p>\n</blockquote>\n\n<p>and check if it makes a difference. It does :</p>\n\n<pre><code>$ cd spec/\n$ ls\nexamples.txt   spec_helper.rb t2_spec.rb     t_specxxx.rb\n$ rspec t2_spec.rb \n... testing ...\n.\n\nFinished in 0.00108 seconds (files took 0.10637 seconds to load)\n1 example, 0 failures\n</code></pre>\n\n<p>You can see that <code>spec_helper.rb</code> has not been processed :</p>\n\n<ul>\n<li>message not displayed</li>\n<li>single dot instead of indented documentation, meaning that this code</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>  if config.files_to_run.one?\n    # Use the documentation formatter for detailed output,\n    # unless a formatter has already been configured\n    # (e.g. via a command-line flag).\n    config.default_formatter = \"doc\"\n  end\n</code></pre>\n\n<p>has not been executed. As Tom says, run <code>rspec</code> from the parent of <code>lib</code> and <code>spec</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1508418409, "last_edit_date": 1508418409, "creation_date": 1508343713, "answer_id": 46814833, "question_id": 46811444, "link": "https://stackoverflow.com/questions/46811444/rspec-the-spec-helper-rb-is-not-loaded/46814833#46814833", "title": "RSpec: The spec_helper.rb is not loaded", "body": "<blockquote>\n  <p>I always execute my <code>specs.rb</code> from the folder \"specs\"</p>\n</blockquote>\n\n<p>Don't.</p>\n\n<p>Run your specs from the <strong>root</strong> folder, i.e. one level above.</p>\n\n<p>Your command should be:</p>\n\n<pre><code># (To run just the one file)\nrspec specs\\spec.rb\n\n# (To run the full suite)\nrspec\n</code></pre>\n\n<p>Side-note: Don't go against the conventions by naming the file <code>spec1.rb</code>. All test files should be named like: <code>&lt;something&gt;_spec.rb</code>; any other files should be used for helper methods etc.</p>\n"}], "owner": {"reputation": 23, "user_id": 4605745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a1017ca0a264cfa522b98c4d6a86c7?s=128&d=identicon&r=PG&f=1", "display_name": "Webdriver", "link": "https://stackoverflow.com/users/4605745/webdriver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3089, "favorite_count": 1, "accepted_answer_id": 46814833, "answer_count": 2, "score": 2, "last_activity_date": 1508418409, "creation_date": 1508333577, "last_edit_date": 1508341161, "question_id": 46811444, "link": "https://stackoverflow.com/questions/46811444/rspec-the-spec-helper-rb-is-not-loaded", "title": "RSpec: The spec_helper.rb is not loaded", "body": "<p>I am learning test automation (Ruby, selenium-webdriver, RSpec). But I have hit an issue and cannot resolve it by myself.</p>\n\n<p>The <code>spec_helper.rb</code> is (I think) not loaded as described <a href=\"https://relishapp.com/rspec/rspec-core/v/3-6/docs/command-line/init-option\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>1.) At first I just put a \"spec_helper.rb\" into the folder \"specs\"</p>\n\n<p>1.b) I insert in my \"spec1.rb\"</p>\n\n<pre><code>    require 'spec_helper'\n</code></pre>\n\n<p>1.c) I always execute my specs.rb from the folder \"specs\"</p>\n\n<pre><code>    rspec spec1.rb \n</code></pre>\n\n<ul>\n<li><p>This hit this Error, inspite of file is at the place:</p>\n\n<pre><code>Failure/Error: return gem_original_require(path)\n\nLoadError:\n cannot load such file -- spec_helper\n# ./spec2.rb:1:in `&lt;top (required)&gt;'\nNo examples found. \n</code></pre></li>\n</ul>\n\n<p>2.) Then I run <code>rspec --init</code> in the project-folder, as <a href=\"https://relishapp.com/rspec/rspec-core/v/3-6/docs/command-line/init-option\" rel=\"nofollow noreferrer\">described</a>.</p>\n\n<ul>\n<li>It generated the file \".rspec\" and \"specs\\spec_helper.rb\"</li>\n<li><p>In the .rspec-file is written default:</p>\n\n<pre><code>--require spec_helper\n</code></pre></li>\n</ul>\n\n<p>2.b) Then I wrote in the file \"specs\\spec_helper.rb\": <code>puts \"I am loaded\"</code></p>\n\n<ul>\n<li><p>Here is my code of the \"spec\\spec_helper.rb\":</p>\n\n<pre><code># This file was generated by the `rspec --init` command. Conventionally, all\n# specs live under a `spec` directory, which RSpec adds to the `$LOAD_PATH`.\n# The generated `.rspec` file contains `--require spec_helper` which will cause\n# this file to always be loaded, without a need to explicitly require it in any\n# files.\n\nputs \"I am loaded\"\n\nrequire 'selenium-webdriver'\nrequire 'rspec/expectations'\n</code></pre></li>\n<li><p>But nothing comes out there by run <code>rspec spec.rb</code></p></li>\n<li>my <code>specs.rb</code> are in the correct folder</li>\n<li>(Without <code>spec_helper.rb</code> my tests are running well.)</li>\n</ul>\n\n<p>3.) At the End I tried again to insert in \"specs\\spec.rb\"</p>\n\n<pre><code>    require 'spec_helper'\n</code></pre>\n\n<ul>\n<li><p>then certainly it has hit the error again:</p>\n\n<pre><code>Failure/Error: return gem_original_require(path)\n\nLoadError:\n cannot load such file -- spec_helper\n# ./spec2.rb:1:in `&lt;top (required)&gt;'\nNo examples found.\n</code></pre></li>\n</ul>\n\n<hr>\n\n<p>I installed successfully on Win10:</p>\n\n<pre><code>ruby 2.3.3\n\nLOCAL GEMS:\nbigdecimal (1.2.8)\nchildprocess (0.8.0)\ndid_you_mean (1.0.0)\ndiff-lcs (1.3)\nffi (1.9.18 x64-mingw32)\nio-console (0.4.5)\njson (2.1.0, 1.8.3)\nminitest (5.8.5)\nnet-telnet (0.1.1)\npower_assert (0.2.6)\npsych (2.1.0)\nrake (10.4.2)\nrdoc (4.2.1)\nrspec (3.6.0)\nrspec-core (3.6.0)\nrspec-expectations (3.6.0)\nrspec-mocks (3.6.0)\nrspec-support (3.6.0)\nrubyzip (1.2.1)\nselenium-webdriver (3.6.0)\ntest-unit (3.1.5)\n</code></pre>\n"}, {"tags": ["ruby", "command-line", "http-headers"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508332138, "post_id": 46810728, "comment_id": 80568979, "body": "Wouldn&#39;t it make more sense to pass the URL as a whole?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508341508, "post_id": 46810728, "comment_id": 80575569, "body": "This is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508341557, "post_id": 46810728, "comment_id": 80575599, "body": "Can you provide a <i>precise</i> specification of what it is that you want to happen, including any and all rules, exceptions from those rules, corner cases, special cases, boundary cases, and edge cases? Can you provide sample inputs and outputs demonstrating what you expect to happen, both in normal cases, and in all the exceptions, corner cases, special cases, boundary cases, and edge cases?"}], "answers": [{"tags": [], "owner": {"reputation": 429, "user_id": 5571494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5eb55bbe812f0a87904f5504c2f85b?s=128&d=identicon&r=PG&f=1", "display_name": "ruud", "link": "https://stackoverflow.com/users/5571494/ruud"}, "is_accepted": false, "score": 0, "last_activity_date": 1508331755, "creation_date": 1508331755, "answer_id": 46810841, "question_id": 46810728, "link": "https://stackoverflow.com/questions/46810728/ruby-how-to-use-argv-to-pass-url-in-command-line/46810841#46810841", "title": "Ruby how to use argv to pass url in command line?", "body": "<p>With this command line, the url is the <em>first</em> parameter.</p>\n\n<p>You can use it by accessing ARGV [0],</p>\n\n<p>for example</p>\n\n<pre><code>uri = URI.parse(ARG[0])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 745, "user_id": 1791660, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/523d71e4f3fc2caed588975caca6eb61?s=128&d=identicon&r=PG", "display_name": "Rick Baker", "link": "https://stackoverflow.com/users/1791660/rick-baker"}, "is_accepted": true, "score": 0, "last_activity_date": 1508331796, "creation_date": 1508331796, "answer_id": 46810853, "question_id": 46810728, "link": "https://stackoverflow.com/questions/46810728/ruby-how-to-use-argv-to-pass-url-in-command-line/46810853#46810853", "title": "Ruby how to use argv to pass url in command line?", "body": "<pre><code>require 'net/http'\nuri = URI.parse(ARGV[0])\nhttp=Net::HTTP.new(uri.host,uri.port)\nrequest = Net::HTTP::Get.new(ARGV[1])\nreply=http.request(request)\nputs \"#{reply.code} #{reply.message}\"\nreply.header.each_header {|key,value| puts \"#{key}\n= #{value}\" }\nputs \"#{reply.body}\"\n</code></pre>\n\n<p>And then just call it with:</p>\n\n<p>ruby test.rb <a href=\"http://www.youtypeitwepostit.com\" rel=\"nofollow noreferrer\">http://www.youtypeitwepostit.com</a> /messages</p>\n"}], "owner": {"reputation": 3, "user_id": 8795640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5eae85d73267c96252ba6ed190a2e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Trexaer", "link": "https://stackoverflow.com/users/8795640/jim-trexaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 46810853, "answer_count": 2, "score": 0, "last_activity_date": 1508353389, "creation_date": 1508331390, "last_edit_date": 1508353389, "question_id": 46810728, "link": "https://stackoverflow.com/questions/46810728/ruby-how-to-use-argv-to-pass-url-in-command-line", "title": "Ruby how to use argv to pass url in command line?", "body": "<p>Let's assume my file name is <em>test.rb</em></p>\n\n<p>I would like to use <code>argv[0]</code> to access the first parameter and <code>argv[1]</code> to access the second parameter in my code to pass the url in the command line, something like this:</p>\n\n<pre><code>ruby test.rb http://www.www.youtypeitwepostit.com /messages\n</code></pre>\n\n<p><em>test.rb</em> file contain:</p>\n\n<pre><code>require 'net/http'\nuri = URI.parse('http://www.youtypeitwepostit.com')\nhttp=Net::HTTP.new(uri.host,uri.port)\nrequest = Net::HTTP::Get.new(\"/\")\nreply=http.request(request)\nputs \"#{reply.code} #{reply.message}\"\nreply.header.each_header {|key,value| puts \"#{key}\n= #{value}\" }\nputs \"#{reply.body}\"\n</code></pre>\n\n<p>Please teach me on how to do this.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4774785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMBEc.jpg?s=128&g=1", "display_name": "Radeesh", "link": "https://stackoverflow.com/users/4774785/radeesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1508331342, "creation_date": 1508331342, "answer_id": 46810710, "question_id": 46810709, "link": "https://stackoverflow.com/questions/46810709/revealed-dependencies-not-in-the-api-during-bundle-install/46810710#46810710", "title": "&quot;revealed dependencies not in the API&quot; during bundle install", "body": "<p>Fixed this error by downgrading bundler from 1.15.4 to 1.12.5</p>\n"}], "owner": {"reputation": 41, "user_id": 4774785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMBEc.jpg?s=128&g=1", "display_name": "Radeesh", "link": "https://stackoverflow.com/users/4774785/radeesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508331342, "creation_date": 1508331342, "question_id": 46810709, "link": "https://stackoverflow.com/questions/46810709/revealed-dependencies-not-in-the-api-during-bundle-install", "title": "&quot;revealed dependencies not in the API&quot; during bundle install", "body": "<p>Getting this error during bundle install with jruby</p>\n\n<p>\"Downloading tzinfo-data-1.2013.4 revealed dependencies not in the API or the\nlockfile (tzinfo (>= 1.0.0)).\"</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6058, "user_id": 662425, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-JXe9IA2rZYM/AAAAAAAAAAI/AAAAAAAAGEg/RlIJwUwmP90/photo.jpg?sz=128", "display_name": "AnkitG", "link": "https://stackoverflow.com/users/662425/ankitg"}, "edited": false, "score": 0, "creation_date": 1508330812, "post_id": 46810144, "comment_id": 80568120, "body": "Do you want to know how much time array initialization takes? And as <code>n</code> increases what is the initialization complexity/ O(n) ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508334388, "post_id": 46810144, "comment_id": 80570521, "body": "I would be very surprised if it wasn&#39;t <code>O(n)</code>. Do you have doubts about that @LucasAlencar? Why?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508341755, "post_id": 46810144, "comment_id": 80575751, "body": "@spickermann: There is nothing in the Ruby language specification that <i>guarantees</i> it, though. In fact, neither the ISO Ruby Language Specification, nor RubySpec, nor the RDocs, nor Programming Ruby, nor The Ruby Programming Language specify <i>any</i> kind of performance. This means that it is perfectly possible for a Ruby implementation to implement it with an O(n&#178;) algorithm and be fully compliant with Ruby. Such an implementation probably wouldn&#39;t be accepted by the Ruby community, but there are <i>no guarantees</i>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508342452, "post_id": 46810144, "comment_id": 80576246, "body": "@J&#246;rgWMittag: That is true, there are no guarantees. But on the other hand, I cannot think of any naive algorithm for this simple task that wouldn&#39;t be in <code>O(n)</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508352497, "post_id": 46810144, "comment_id": 80581609, "body": "@spickermann: I can: <code>res = []; n.times { res &lt;&lt; x }}; return res</code> is O(n&#178;) and sufficiently naive that someone might write it that way. Like I said, a Ruby implementation that does this would probably not be accepted by the community, but the question is: who decides what the spec of Ruby is? Are expectations of the community part of the spec or not? It would be much easier, if such performance concerns were documented. E.g. the C++ library specification specifies performance guarantees for all library functions, and conforming implementations must meet those performance guarantees."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508353989, "post_id": 46810144, "comment_id": 80582430, "body": "@J&#246;rgWMittag Thanks. TIL that the C++ library specification places requirements on the performance of algorithms. Never read about that before. That is interesting and seems very helpful indeed."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508357134, "post_id": 46810144, "comment_id": 80584015, "body": "@spickermann: E.g. <code>sort</code> specifies: &quot;<i>Complexity</i>: <code>O(N log N)</code> comparisons, where <code>N = last - first</code>.&quot; and <code>stable_sort</code>: &quot;<i>Complexity</i>: At most <code>N log&#178;(N)</code> comparisons, where <code>N = last - first</code>, but only <code>N log N</code> comparisons if there is enough extra memory.&quot; (Interesting to note: it specifies an <i>exact</i> complexity for <code>stable_sort</code>, not merely asymptotic.)"}], "answers": [{"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 1, "last_activity_date": 1508332275, "last_edit_date": 1508332275, "creation_date": 1508331937, "answer_id": 46810903, "question_id": 46810144, "link": "https://stackoverflow.com/questions/46810144/what-is-the-complexity-of-array-newn-x-in-ruby/46810903#46810903", "title": "What is the complexity of Array.new(n,x) in Ruby?", "body": "<p>About constant for small arrays and linear after that.</p>\n\n<pre><code>require 'benchmark'\n\n0.upto(9).each do |power|\n  elements = 10 ** power\n  time = 10.times.map { Benchmark.measure { Array.new(elements, :foo) } }.sum(&amp;:real) / 10\n  p [elements, '%f' % time]\nend\n\n# [1, \"0.000001\"]\n# [10, \"0.000001\"]\n# [100, \"0.000002\"]\n# [1000, \"0.000011\"]\n# [10000, \"0.000038\"]\n# [100000, \"0.000286\"]\n# [1000000, \"0.004231\"]\n# [10000000, \"0.036348\"]\n# [100000000, \"0.404822\"]\n# [1000000000, \"8.454289\"]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5JZpL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5JZpL.png\" alt=\"enter image description here\"></a></p>\n\n<p>As for an intuitive explanation:</p>\n\n<p>It basically allocates a continual memory block (*) and writes a representation (pointer) of the object in every individual chunk of memory (one chunk being one array element). This iteration over every chunk leads to the linear complexity.</p>\n\n<hr>\n\n<p>Note that for small memory blocks there may be some optimizations to make it constant.</p>\n\n<p>(*) And for larger blocks the block may not be continual, which leads to worse performance.</p>\n\n<hr>\n\n<p>All of this is most probably more dependent on hardware/OS than Ruby's implementation itself.</p>\n"}], "owner": {"reputation": 340, "user_id": 6663684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rVdQi_qeE58/AAAAAAAAAAI/AAAAAAAAAM0/kfKM-Qitvr4/photo.jpg?sz=128", "display_name": "Lucas Alencar", "link": "https://stackoverflow.com/users/6663684/lucas-alencar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 46810903, "answer_count": 1, "score": 0, "last_activity_date": 1508332275, "creation_date": 1508329497, "question_id": 46810144, "link": "https://stackoverflow.com/questions/46810144/what-is-the-complexity-of-array-newn-x-in-ruby", "title": "What is the complexity of Array.new(n,x) in Ruby?", "body": "<p>What is the running time of declaring an array with a initial size and a default value ?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4281314, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f48150e50573c96e6bed31efda538a53?s=128&d=identicon&r=PG", "display_name": "lawrence.adu", "link": "https://stackoverflow.com/users/4281314/lawrence-adu"}, "edited": false, "score": 0, "creation_date": 1508330257, "post_id": 46810214, "comment_id": 80567816, "body": "Would this be slow if I have 1 million transactions and 1 million pairs?"}, {"owner": {"reputation": 2210, "user_id": 4082957, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c549b569c2faad6f2fad9c385527406?s=128&d=identicon&r=PG&f=1", "display_name": "geoandri", "link": "https://stackoverflow.com/users/4082957/geoandri"}, "reply_to_user": {"reputation": 89, "user_id": 4281314, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f48150e50573c96e6bed31efda538a53?s=128&d=identicon&r=PG", "display_name": "lawrence.adu", "link": "https://stackoverflow.com/users/4281314/lawrence-adu"}, "edited": false, "score": 1, "creation_date": 1508331125, "post_id": 46810214, "comment_id": 80568353, "body": "I can&#39;t imagine any shortcut on this. It&#39;s a simple join between two tables. I agree with the observations of Michael Chaney though. You should adopt all proposed changes to avoid any problems in the future."}], "tags": [], "owner": {"reputation": 2210, "user_id": 4082957, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c549b569c2faad6f2fad9c385527406?s=128&d=identicon&r=PG&f=1", "display_name": "geoandri", "link": "https://stackoverflow.com/users/4082957/geoandri"}, "is_accepted": false, "score": 1, "last_activity_date": 1508329733, "creation_date": 1508329733, "answer_id": 46810214, "question_id": 46810129, "link": "https://stackoverflow.com/questions/46810129/json-object-size-in-rails-includes/46810214#46810214", "title": "JSON object size in rails includes", "body": "<p>You can try joining the two tables. Supposing that your models are Pair and Transaction</p>\n\n<pre><code>transactions = Transaction.joins(:pair).where('json_array_length(match) &gt; 1')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 4281314, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f48150e50573c96e6bed31efda538a53?s=128&d=identicon&r=PG", "display_name": "lawrence.adu", "link": "https://stackoverflow.com/users/4281314/lawrence-adu"}, "edited": false, "score": 0, "creation_date": 1508329947, "post_id": 46810232, "comment_id": 80567626, "body": "I made a mistake when typing. It&#39;s <code>Transaction</code>"}, {"owner": {"reputation": 300, "user_id": 4055250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9917fa942f917a4994511bd5afb5e7e?s=128&d=identicon&r=PG", "display_name": "Charles Smith", "link": "https://stackoverflow.com/users/4055250/charles-smith"}, "edited": false, "score": 1, "creation_date": 1508333749, "post_id": 46810232, "comment_id": 80570045, "body": "More &quot;protected&quot; words that you should avoid in rails: <a href=\"https://stackoverflow.com/a/22287497\">stackoverflow.com/a/22287497</a>"}, {"owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "reply_to_user": {"reputation": 89, "user_id": 4281314, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f48150e50573c96e6bed31efda538a53?s=128&d=identicon&r=PG", "display_name": "lawrence.adu", "link": "https://stackoverflow.com/users/4281314/lawrence-adu"}, "edited": false, "score": 0, "creation_date": 1508420040, "post_id": 46810232, "comment_id": 80609675, "body": "@larrybuntus You don&#39;t want to use &quot;Transaction&quot; whether it&#39;s singular or plural.  You will run into weird problems - just change the name of that table/model."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1238868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9884f1eabc8587f2c9dfd2b1ccf9a6?s=128&d=identicon&r=PG", "display_name": "Michael Chaney", "link": "https://stackoverflow.com/users/1238868/michael-chaney"}, "is_accepted": false, "score": 2, "last_activity_date": 1508329768, "creation_date": 1508329768, "answer_id": 46810232, "question_id": 46810129, "link": "https://stackoverflow.com/questions/46810129/json-object-size-in-rails-includes/46810232#46810232", "title": "JSON object size in rails includes", "body": "<p>A couple of observations:</p>\n\n<ol>\n<li>The model should be \"Transaction\" (singular)</li>\n<li>You are really setting yourself up for a world of hurt by naming it \"Transaction\".  That's basically a \"reserved word\".  You don't want to use it.  You're going to have collisions with other places where there's already a method called \"transaction\" or \"transactions\"</li>\n<li>Same with having a column called \"match\". That's a really common method name in Ruby.</li>\n</ol>\n\n<p>I know I'm not answering the question, but this is too much for a comment and you need to fix these issues before going on.</p>\n"}], "owner": {"reputation": 89, "user_id": 4281314, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f48150e50573c96e6bed31efda538a53?s=128&d=identicon&r=PG", "display_name": "lawrence.adu", "link": "https://stackoverflow.com/users/4281314/lawrence-adu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508329973, "creation_date": 1508329449, "last_edit_date": 1508329973, "question_id": 46810129, "link": "https://stackoverflow.com/questions/46810129/json-object-size-in-rails-includes", "title": "JSON object size in rails includes", "body": "<p>I'm trying to get all <code>transactions</code> in a <code>postgresql db</code>, <code>transactions</code> have a one-to-one relationship with the <code>pairs</code> table. In the pairs table, there's a column called <code>match</code> with type json. I want to select all <code>transactions</code> including their <code>pair</code> whose <code>pair.match</code> count is greater than 1.</p>\n\n<p>I tried <code>pairs = Pair.where('json_array_length(match) &gt; 1')</code> which worked.</p>\n\n<p>How do I get all transactions where <code>pair.match</code> is greater than 1. Tried this -> <code>transactions = Transactions.includes(:pair).where(pairs: 'json_array_length(match) &gt; 1')</code> but didn't work.  </p>\n\n<p>Update: It's <code>Transaction</code> not <code>Transactions</code></p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "will-paginate"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508328415, "post_id": 46809415, "comment_id": 80566653, "body": "How is this question different from your previous <a href=\"https://stackoverflow.com/q/45240450/477037\">Will_paginate for includes comments</a>? I&#39;m inclined to close this one as a duplicate."}, {"owner": {"reputation": 554, "user_id": 8066456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcdc1b0ee11fa7ab705b178bd0a888da?s=128&d=identicon&r=PG&f=1", "display_name": "stig Garet", "link": "https://stackoverflow.com/users/8066456/stig-garet"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508328734, "post_id": 46809415, "comment_id": 80566852, "body": "Well, it&#39;s not exacltly the same request, the first one was to send a ajax request to load more comments, but I&#39;m not using the function .paginate. And It can be usefull to have access to this function."}, {"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508328925, "post_id": 46809415, "comment_id": 80566984, "body": "Can u elaborate with respect to view?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1508328935, "post_id": 46809415, "comment_id": 80566991, "body": "3 people favourited this question in 15 minutes?"}, {"owner": {"reputation": 554, "user_id": 8066456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcdc1b0ee11fa7ab705b178bd0a888da?s=128&d=identicon&r=PG&f=1", "display_name": "stig Garet", "link": "https://stackoverflow.com/users/8066456/stig-garet"}, "reply_to_user": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508329052, "post_id": 46809415, "comment_id": 80567068, "body": "@krishnar, what do you mean ? I don&#39;t really understand your comment"}, {"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508329183, "post_id": 46809415, "comment_id": 80567157, "body": "I mean how your pagination should work? For every post , paginated comments? Explain"}, {"owner": {"reputation": 554, "user_id": 8066456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcdc1b0ee11fa7ab705b178bd0a888da?s=128&d=identicon&r=PG&f=1", "display_name": "stig Garet", "link": "https://stackoverflow.com/users/8066456/stig-garet"}, "reply_to_user": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508329448, "post_id": 46809415, "comment_id": 80567340, "body": "@krishnar, yep exactly ! Every list of comments (one by post) will be paginated"}, {"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508330262, "post_id": 46809415, "comment_id": 80567818, "body": "Simple suggestion.. 1. Load all post within group 2.whenver user says show comments for specific post just do paginate for that post"}], "answers": [{"tags": [], "owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "is_accepted": true, "score": 3, "last_activity_date": 1524746352, "last_edit_date": 1524746352, "creation_date": 1508331849, "answer_id": 46810878, "question_id": 46809415, "link": "https://stackoverflow.com/questions/46809415/paginate-an-include-variable/46810878#46810878", "title": "Paginate an include variable", "body": "<p><strong>Issue with pagination inside controller</strong></p>\n\n<p>Since you want paginated comments associated with individual post, it's complicate to achieve in controller as you need to create N paginated comment object (say you have N posts).</p>\n\n<p><strong>What you can do</strong></p>\n\n<p>1.load posts as usual with included comments to reduce excess queries. But don't run paginate here</p>\n\n<p>2.achieve pagination inside view only</p>\n\n<pre><code>&lt;%= @posts.each do | post | %&gt;\n&lt;% comments = post.comments.paginate(page: params[:page]) %&gt;\n\n..\n...\n...\n&lt;%= will_paginate comments%&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 8066456, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcdc1b0ee11fa7ab705b178bd0a888da?s=128&d=identicon&r=PG&f=1", "display_name": "stig Garet", "link": "https://stackoverflow.com/users/8066456/stig-garet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 2, "accepted_answer_id": 46810878, "answer_count": 1, "score": 2, "last_activity_date": 1524746352, "creation_date": 1508327200, "last_edit_date": 1508327869, "question_id": 46809415, "link": "https://stackoverflow.com/questions/46809415/paginate-an-include-variable", "title": "Paginate an include variable", "body": "<p>I'm building an app which have group > posts > comments\nTo reduce the number of SQL requests, i'm using the includes method</p>\n\n<pre><code># group controller\ndef show\n  @posts = @group.posts.includes(:comments)\nend\n</code></pre>\n\n<p>Now, I would like to paginate comments. But I don't know how to use the function .paginate from the gem will_paginate</p>\n\n<p>Do you have a tips for that ?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "heroku", "deployment"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508325650, "post_id": 46808917, "comment_id": 80564901, "body": "Try comment out all assets js and css.  Then uncomment 1 file at at time and run precompile.  This should lead you to which file has compilation errors.  Then search that file for the <code>#</code>. Or in your editor full text search that assets/ path for <code>#</code> It&#39;s probably a typo somewhere.  If you&#39;re using ERB inside JS that can also cause problems."}, {"owner": {"reputation": 73, "user_id": 8281986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c736edf0ba695092165ca4052dee6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aaquib Khan", "link": "https://stackoverflow.com/users/8281986/aaquib-khan"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508328083, "post_id": 46808917, "comment_id": 80566439, "body": "as It is a demo app,it does not have much css and js. still I commented all the js and css.except the plugins but still the same error is comming and what do you mean by erb inside js?"}, {"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "edited": false, "score": 0, "creation_date": 1508328212, "post_id": 46808917, "comment_id": 80566523, "body": "Does rake assets:precompile working?"}, {"owner": {"reputation": 73, "user_id": 8281986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c736edf0ba695092165ca4052dee6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aaquib Khan", "link": "https://stackoverflow.com/users/8281986/aaquib-khan"}, "edited": false, "score": 0, "creation_date": 1508328760, "post_id": 46808917, "comment_id": 80566873, "body": "yes .see what iam getting.I, [2017-10-18T17:42:03.228754 #7221]  INFO -- : Writing /home/aaquib/Desktop/applications/Laundryapp/public/assets/b&zwnj;&#8203;ackend-14ce09d71ef06&zwnj;&#8203;bf94dcdc7b08326d779a&zwnj;&#8203;ccbacc2b41f3807d5638&zwnj;&#8203;5dcff44cac2.css"}, {"owner": {"reputation": 73, "user_id": 8281986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c736edf0ba695092165ca4052dee6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aaquib Khan", "link": "https://stackoverflow.com/users/8281986/aaquib-khan"}, "edited": false, "score": 0, "creation_date": 1508328856, "post_id": 46808917, "comment_id": 80566943, "body": "I, [2017-10-18T17:42:03.230146 #7221]  INFO -- : Writing /home/aaquib/Desktop/applications/Laundryapp/public/assets/b&zwnj;&#8203;ackend-14ce09d71ef06&zwnj;&#8203;bf94dcdc7b08326d779a&zwnj;&#8203;ccbacc2b41f3807d5638&zwnj;&#8203;5dcff44cac2.css.gz I, [2017-10-18T17:42:04.298197 #7221]  INFO -- : Writing /home/aaquib/Desktop/applications/Laundryapp/public/assets/b&zwnj;&#8203;ackend-c6ef96665dee7&zwnj;&#8203;aece8ca415215bf3d0f7&zwnj;&#8203;db2d753e6562b28bd107&zwnj;&#8203;c0cd892235e.js"}, {"owner": {"reputation": 73, "user_id": 8281986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c736edf0ba695092165ca4052dee6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aaquib Khan", "link": "https://stackoverflow.com/users/8281986/aaquib-khan"}, "edited": false, "score": 0, "creation_date": 1508328872, "post_id": 46808917, "comment_id": 80566952, "body": "I, [2017-10-18T17:42:04.298458 #7221]  INFO -- : Writing /home/aaquib/Desktop/applications/Laundryapp/public/assets/b&zwnj;&#8203;ackend-c6ef96665dee7&zwnj;&#8203;aece8ca415215bf3d0f7&zwnj;&#8203;db2d753e6562b28bd107&zwnj;&#8203;c0cd892235e.js.gz"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508338983, "post_id": 46808917, "comment_id": 80573752, "body": "If you remove all coffee script, also maybe try to remove coffee gem remove <code>gem &quot;coffee-script&quot;</code> from Gemfile or comment and run <code>bundle install</code>"}], "owner": {"reputation": 73, "user_id": 8281986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8c736edf0ba695092165ca4052dee6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aaquib Khan", "link": "https://stackoverflow.com/users/8281986/aaquib-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508329996, "creation_date": 1508325360, "last_edit_date": 1508329996, "question_id": 46808917, "link": "https://stackoverflow.com/questions/46808917/precompiling-assets-failed-while-deploying-on-heroku", "title": "Precompiling assets failed. while deploying on heroku", "body": "<p>while deploying to heroku iam getting this error.This is my first time deployement so any help is appriciated.</p>\n\n<pre><code>remote:        rake aborted!\nremote:        ExecJS::RuntimeError: SyntaxError: Unexpected character '#'\nremote:        JS_Parse_Error.Object.defineProperty.get ((execjs):3538:621)\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:47:in `rescue in block in call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:44:in `block in call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:75:in `block in lock'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:73:in `Locker'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:73:in `lock'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:43:in `call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/uglifier-3.1.9/lib/uglifier.rb:190:in `run_uglifyjs'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/uglifier-3.1.9/lib/uglifier.rb:152:in `compile'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/uglifier_compressor.rb:53:in `call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/uglifier_compressor.rb:28:in `call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:75:in `call_processor'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:57:in `block in call_processors'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `reverse_each'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `call_processors'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:134:in `load_from_unloaded'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:60:in `block in load'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:317:in `fetch_asset_from_dependency_cache'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:44:in `load'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:20:in `block in initialize'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:47:in `load'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/base.rb:66:in `find_asset'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/base.rb:73:in `find_all_linked_assets'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:134:in `block in find'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:133:in `each'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:133:in `find'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:185:in `compile'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-rails-3.2.0/lib/sprockets/rails/task.rb:68:in `block (3 levels) in define'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/rake/sprocketstask.rb:147:in `with_logger'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-rails-3.2.0/lib/sprockets/rails/task.rb:67:in `block (2 levels) in define'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\nremote:        V8::Error: Unexpected character '#'\nremote:        at js_error (&lt;eval&gt;:3623:12181)\nremote:        at parse_error (&lt;eval&gt;:3623:14198)\nremote:        at next_token (&lt;eval&gt;:3623:19758)\nremote:        at next (&lt;eval&gt;:3623:21695)\nremote:        at &lt;eval&gt;:3623:23768\nremote:        at &lt;eval&gt;:3623:22771\nremote:        at &lt;eval&gt;:3624:3495\nremote:        at parse (&lt;eval&gt;:3624:3735)\nremote:        at parse (&lt;eval&gt;:3959:22)\nremote:        at uglifier (&lt;eval&gt;:4007:13)\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:45:in `block in call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:75:in `block in lock'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:73:in `Locker'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:73:in `lock'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/execjs-2.7.0/lib/execjs/ruby_racer_runtime.rb:43:in `call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/uglifier-3.1.9/lib/uglifier.rb:190:in `run_uglifyjs'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/uglifier-3.1.9/lib/uglifier.rb:152:in `compile'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/uglifier_compressor.rb:53:in `call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/uglifier_compressor.rb:28:in `call'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:75:in `call_processor'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:57:in `block in call_processors'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `reverse_each'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `call_processors'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:134:in `load_from_unloaded'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:60:in `block in load'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:317:in `fetch_asset_from_dependency_cache'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/loader.rb:44:in `load'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:20:in `block in initialize'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:47:in `load'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/base.rb:66:in `find_asset'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/base.rb:73:in `find_all_linked_assets'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:134:in `block in find'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:133:in `each'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:133:in `find'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:185:in `compile'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-rails-3.2.0/lib/sprockets/rails/task.rb:68:in `block (3 levels) in define'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-3.7.1/lib/rake/sprocketstask.rb:147:in `with_logger'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/sprockets-rails-3.2.0/lib/sprockets/rails/task.rb:67:in `block (2 levels) in define'\nremote:        /tmp/build_0cc559ca757e781035a2d51391cb0258/vendor/bundle/ruby/2.3.0/gems/rake-12.0.0/exe/rake:27:in `&lt;top (required)&gt;'\nremote:        Tasks: TOP =&gt; assets:precompile\nremote:        (See full trace by running task with --trace)\nremote:  !\nremote:  !     Precompiling assets failed.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !   Push rejected to laundryapp-aaquib.\nremote: \nTo https://git.heroku.com/laundryapp-aaquib.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\n</code></pre>\n\n<p>I removed all the cofee script file which are created by scaffold and replaced them with \".js\" extention and also deleted which i dont needed.i also replaced my application.css to application.css.scss.I also tried\nrake assets:precompile RAILS_ENV=development and the same in production but got the same error as above.Iam also getting this when pushing to heroku\n Important: You may need to add a javascript runtime to your Gemfile in order for bootstrap's LESS files to compile to CSS.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "elasticsearch", "indexing"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1508325403, "post_id": 46808749, "comment_id": 80564747, "body": "We don&#39;t know what &quot;working properly&quot; means. Can you explain the error your getting?"}, {"owner": {"reputation": 1077, "user_id": 4269239, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/jTw9F.jpg?s=128&g=1", "display_name": "Sachin Gevariya", "link": "https://stackoverflow.com/users/4269239/sachin-gevariya"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508327209, "post_id": 46808749, "comment_id": 80565861, "body": "Right now nothing works properly. Maybe need to update controller&#39;s this query as a result."}], "owner": {"reputation": 1077, "user_id": 4269239, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/jTw9F.jpg?s=128&g=1", "display_name": "Sachin Gevariya", "link": "https://stackoverflow.com/users/4269239/sachin-gevariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508324762, "creation_date": 1508324762, "question_id": 46808749, "link": "https://stackoverflow.com/questions/46808749/nested-to-nested-elasticsearch-query-with-must-not-not-working-in-rails", "title": "nested to nested elasticsearch query with must_not not working in rails", "body": "<p>I am using this gems for elastic search:</p>\n\n<pre><code>gem 'elasticsearch-model', '0.1.9'\ngem 'elasticsearch-rails', '0.1.9'\n</code></pre>\n\n<p>I do have model A with field name id, name, price</p>\n\n<p>Model B with a_id, name, size</p>\n\n<p>Model C with b_id, name, rating(\"Low\", \"High\").</p>\n\n<p>In model A, I have added indexing like this:</p>\n\n<pre><code>def as_indexed_json(options={})\n  as_json(\n    only: [\n        :id, :name, :price\n      ],\n      include: {:b =&gt; [include: [:c =&gt; {only: [:rating]} ]}\n  )\nend\n</code></pre>\n\n<p><em>I want such record who <strong>don't</strong> have \"High\" rating</em></p>\n\n<p>I have written this method in the controller but it is not working properly.</p>\n\n<pre><code>A.search(query: \n           bool:{\n             must_not: [\n               {\n                 nested: {\n                   path: \"b\",\n                   query: {\n                      bool: {\n                        must: [\n                          {\n                            term\" =&gt; {\n                              \"b.c.rating\" =&gt; \"High\"\n                            }\n                          }\n                        ]\n                      }\n                    }\n                 }\n               }\n             ]\n           }\n         ).results\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508324782, "post_id": 46808667, "comment_id": 80564368, "body": "Not everything needs to use the same global layout... Create more than one?"}, {"owner": {"reputation": 464, "user_id": 6720055, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Qor8L0OFVjU/AAAAAAAAAAI/AAAAAAAAABA/-ei57u2kNfQ/photo.jpg?sz=128", "display_name": "Rabin Poudyal", "link": "https://stackoverflow.com/users/6720055/rabin-poudyal"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508324945, "post_id": 46808667, "comment_id": 80564454, "body": "thanks and how do I import that specific css? like this? &lt;%= stylesheet_link_tag    &#39;dashboard&#39; %&gt;"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508331991, "post_id": 46808667, "comment_id": 80568872, "body": "Yes. An application will typically use one layout for <i>most</i> of its pages, but you can choose to load a different (or no!) layout for specific controllers/actions. See: <a href=\"http://guides.rubyonrails.org/layouts_and_rendering.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/layouts_and_rendering.html</a>"}], "owner": {"reputation": 464, "user_id": 6720055, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Qor8L0OFVjU/AAAAAAAAAAI/AAAAAAAAABA/-ei57u2kNfQ/photo.jpg?sz=128", "display_name": "Rabin Poudyal", "link": "https://stackoverflow.com/users/6720055/rabin-poudyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508324503, "creation_date": 1508324503, "question_id": 46808667, "link": "https://stackoverflow.com/questions/46808667/unnecessary-styles-loaded-in-all-pages-in-rails", "title": "Unnecessary styles loaded in all pages in rails", "body": "<p>I am working in Rails 5. I have added active admin and other gems as well as styles. In the application.scss There are following statements</p>\n\n<pre><code>@import \"bootstrap-sprockets\";\n@import \"bootstrap\";\n@import \"font-awesome\";\n@import \"social-share-kit\";\n@import \"trix\";\n@import \"easy-autocomplete.min\";\n@import \"easy-autocomplete.themes.min\";\n@import \"dashboard\";\n</code></pre>\n\n<p>My dashboard.scss file has some styles that override default bootstrap styles. Now the dashboard.css has been loaded in all pages of application and there are conflicts with other styles. Also, the active admin styles are even loading in home page which does not make any sense. </p>\n\n<p>Is there some way so that I can render the styles only in that specific controller. For example dashboard.scss should only load in dashboard controller.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508322682, "post_id": 46808022, "comment_id": 80563130, "body": "Not familiar with material_chip but probably it&#39;s adding data in the front end.  Only way to get it back to rails server is via some ajax post/put request.  You&#39;ll need to write JS to send that.  Controller knows nothing of the front end as it lives on the server in ruby."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5536502, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/17d45b2c51edbdc24b7c715b242d29c7?s=128&d=identicon&r=PG", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/5536502/sarthak"}, "edited": false, "score": 1, "creation_date": 1508331929, "post_id": 46808711, "comment_id": 80568837, "body": "When i try it calling through the AJAX the other form data is send separately and the AJAX data is send separately leading to the executing the same code two times but with the incomplete data as both of them should execute same code together."}, {"owner": {"reputation": 4180, "user_id": 2649853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sO7Jq.png?s=128&g=1", "display_name": "Chirag Ravindra", "link": "https://stackoverflow.com/users/2649853/chirag-ravindra"}, "reply_to_user": {"reputation": 25, "user_id": 5536502, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/17d45b2c51edbdc24b7c715b242d29c7?s=128&d=identicon&r=PG", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/5536502/sarthak"}, "edited": false, "score": 1, "creation_date": 1508581859, "post_id": 46808711, "comment_id": 80672035, "body": "You can use the callbacks to update a hidden form element on the other form so that they get posted together as one request. You can basically use the changed values from the callback and use it as you see fit. You could even store it in a scoped variable and use it when making the AJAX requests."}], "tags": [], "owner": {"reputation": 4180, "user_id": 2649853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sO7Jq.png?s=128&g=1", "display_name": "Chirag Ravindra", "link": "https://stackoverflow.com/users/2649853/chirag-ravindra"}, "is_accepted": false, "score": 0, "last_activity_date": 1508324644, "creation_date": 1508324644, "answer_id": 46808711, "question_id": 46808022, "link": "https://stackoverflow.com/questions/46808022/accessing-materialize-chip-response-to-ruby-controller/46808711#46808711", "title": "Accessing Materialize chip response to Ruby Controller", "body": "<p>The Materialize CSS library triggers events whenever a chip is added/deleted/selected. You can trigger AJAX calls to let your Rails controller know what happened on the client.</p>\n\n<p>Or, you could wait for all interactions to happen and let the user trigger the AJAX request through a button click in one shot.</p>\n\n<p>You can learn more about chip features here:</p>\n\n<p><a href=\"http://materializecss.com/chips.html\" rel=\"nofollow noreferrer\">Materialize CSS Chips Documentation</a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code> $('.chips').on('chip.add', function(e, chip){\r\n    // you have the added chip here\r\n    //Call AJAX to talk to Rails Controller\r\n  });\r\n\r\n  $('.chips').on('chip.delete', function(e, chip){\r\n    // you have the deleted chip here\r\n    //Call AJAX to talk to Rails Controller\r\n  });\r\n\r\n  $('.chips').on('chip.select', function(e, chip){\r\n    // you have the selected chip here\r\n    //Call AJAX to talk to Rails Controller\r\n  });</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 25, "user_id": 5536502, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/17d45b2c51edbdc24b7c715b242d29c7?s=128&d=identicon&r=PG", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/5536502/sarthak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508354562, "creation_date": 1508322433, "last_edit_date": 1508354562, "question_id": 46808022, "link": "https://stackoverflow.com/questions/46808022/accessing-materialize-chip-response-to-ruby-controller", "title": "Accessing Materialize chip response to Ruby Controller", "body": "<p>I am using Materialize CSS Chips to store the tag for my video whose html goes like:   </p>\n\n<pre><code>&lt;%=simple_form_for @video do |form| %&gt;\n &lt;div id=\"spaceTags\" class=\"chips chips-placeholder\"&gt;\n &lt;div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and the JavaScript Intialization Goes like: </p>\n\n<pre><code>$('.chips').material_chip();\n$('.chips-placeholder').material_chip({\nplaceholder: 'Enter a tag',\nsecondaryPlaceholder: '+Tag',\n});\n</code></pre>\n\n<p>and my Controller Goes like:</p>\n\n<pre><code> @video = Video.new(video_params)\n@video.uploader = current_user\nrespond_to do |format|\n  if @video.save\n    format.html { redirect_to @video, notice: 'Video was successfully created.' }\n    format.json { render :show, status: :created, location: @video }\n  else\n    format.html { render :new }\n    format.json { render json: @video.errors, status: :unprocessable_entity }\n  end\nend\n</code></pre>\n\n<p>How can I retrieve the data and get access to it in my controller?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "heroku", "devise"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508320899, "post_id": 46807492, "comment_id": 80562068, "body": "<code>app&#47;models&#47;user.rb:150:in  set_pinned_posts</code> That&#39;s where your error is happening.  Maybe post your model code so we can help?"}, {"owner": {"reputation": 413, "user_id": 3385759, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6da655974e22fbe22501ee84b485b824?s=128&d=identicon&r=PG&f=1", "display_name": "OhDaeSu", "link": "https://stackoverflow.com/users/3385759/ohdaesu"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508321547, "post_id": 46807492, "comment_id": 80562467, "body": "Thanks, I&#39;ve added the method (in this method I set &quot;fake posts&quot; to pinned and change their posting time)."}], "answers": [{"tags": [], "owner": {"reputation": 464, "user_id": 6720055, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Qor8L0OFVjU/AAAAAAAAAAI/AAAAAAAAABA/-ei57u2kNfQ/photo.jpg?sz=128", "display_name": "Rabin Poudyal", "link": "https://stackoverflow.com/users/6720055/rabin-poudyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1508325580, "creation_date": 1508325580, "answer_id": 46808974, "question_id": 46807492, "link": "https://stackoverflow.com/questions/46807492/completed-500-internal-server-error-on-user-signup-with-devise-on-heroku/46808974#46808974", "title": "Completed 500 Internal Server Error on user signup with Devise on Heroku", "body": "<p>Did you try to run rake db:migrate? You can also run migrations via web dashboard. Sometimes rails db:migrate does not work in heroku. And also did you try to create a new user via console?</p>\n"}, {"comments": [{"owner": {"reputation": 413, "user_id": 3385759, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6da655974e22fbe22501ee84b485b824?s=128&d=identicon&r=PG&f=1", "display_name": "OhDaeSu", "link": "https://stackoverflow.com/users/3385759/ohdaesu"}, "edited": false, "score": 1, "creation_date": 1508330353, "post_id": 46809920, "comment_id": 80567857, "body": "Oh my god, that was it, thank you very much. I&#39;ve forgotten to seed my &quot;Fposts&quot;, therefore there were no FPosts.<code>heroku run rake db:seed</code> solved it."}], "tags": [], "owner": {"reputation": 249, "user_id": 5523744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eac4b3a8e5ae72e32083b003902a658?s=128&d=identicon&r=PG&f=1", "display_name": "Djwokian", "link": "https://stackoverflow.com/users/5523744/djwokian"}, "is_accepted": true, "score": 2, "last_activity_date": 1508328808, "creation_date": 1508328808, "answer_id": 46809920, "question_id": 46807492, "link": "https://stackoverflow.com/questions/46807492/completed-500-internal-server-error-on-user-signup-with-devise-on-heroku/46809920#46809920", "title": "Completed 500 Internal Server Error on user signup with Devise on Heroku", "body": "<p>Chances are this is the issue:</p>\n\n<pre><code>first = Fpost.where(pinned: true).first\nlast = Fpost.where(pinned: true).last\n</code></pre>\n\n<p>with first = Fpost.where(pinned: true) returning nil. (Do you have any Fpost objects connected to the user at this stage?)</p>\n\n<p>This would explain your error 'NoMethodError (undefined method `id' for nil:NilClass):' being thrown by this:</p>\n\n<pre><code>.... .where(fpost_id: first.id) ...\n</code></pre>\n\n<p>as id is being called on nil. </p>\n"}], "owner": {"reputation": 413, "user_id": 3385759, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6da655974e22fbe22501ee84b485b824?s=128&d=identicon&r=PG&f=1", "display_name": "OhDaeSu", "link": "https://stackoverflow.com/users/3385759/ohdaesu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 46809920, "answer_count": 2, "score": 0, "last_activity_date": 1508328808, "creation_date": 1508320639, "last_edit_date": 1508321310, "question_id": 46807492, "link": "https://stackoverflow.com/questions/46807492/completed-500-internal-server-error-on-user-signup-with-devise-on-heroku", "title": "Completed 500 Internal Server Error on user signup with Devise on Heroku", "body": "<p>I have copied a project I've done in Rails into another folder. When I want to create/register a new user using the Devise gem, it works locally on my computer. However, when I want to do the same on Heroku, the Heroku logs give me these errors (500 Internal Server Error and NoMethodError (undefined method `id' for nil:NilClass) for the user): </p>\n\n<pre><code>2017-10-18T09:13:44.841868+00:00 app[web.1]: D, [2017-10-18T09:13:44.841788 #4] DEBUG -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c]    (1.2ms)  ROLLBACK\n2017-10-18T09:13:44.844378+00:00 app[web.1]: I, [2017-10-18T09:13:44.844294 #4]  INFO -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c] Completed 500 Internal Server Error in 1109ms (ActiveRecord: 122.8ms)\n2017-10-18T09:13:44.845813+00:00 app[web.1]: F, [2017-10-18T09:13:44.845733 #4] FATAL -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c]   \n2017-10-18T09:13:44.845955+00:00 app[web.1]: F, [2017-10-18T09:13:44.845867 #4] FATAL -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c] NoMethodError (undefined method `id' for nil:NilClass):\n2017-10-18T09:13:44.846016+00:00 app[web.1]: F, [2017-10-18T09:13:44.845935 #4] FATAL -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c]   \n2017-10-18T09:13:44.846141+00:00 app[web.1]: F, [2017-10-18T09:13:44.846063 #4] FATAL -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c] app/models/user.rb:150:in `set_pinned_posts'\n2017-10-18T09:13:44.846302+00:00 app[web.1]: F, [2017-10-18T09:13:44.846146 #4] FATAL -- : [8944a6a0-36d4-4f3a-b4e2-967d5273ae3c] app/controllers/users/registrations_controller.rb:3:in `create'\n</code></pre>\n\n<p>The user table exists, however I cannot create a user on Heroku.</p>\n\n<p><strong>What I've done so far:</strong></p>\n\n<ul>\n<li>migrating the database with <code>heroku run rails db:migrate</code></li>\n<li>restarting the heroku server <code>heroku restart -a appname</code></li>\n<li>I'm also using AWS S3 by Amazon for the Paperclip gem and in this project I use the same keys which I also use for two other projects. The other two projects work just fine. (e.g. the keys are: AWS Access Key, AWS Region, AWS Secret Access Key, Secret Key Base). Could that be the problem? </li>\n<li>Deleted the version number of the pg gem in my gemfile and bundle installed again</li>\n<li>Similar questions on Stackoverflow showed that the problem could lie in the email confirmation after the registration. However, I did not activate email confirmation on Devise.</li>\n</ul>\n\n<p><strong>The User model method in the error message:</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  after_create :set_pinned_posts\n\n  ...\n\n  def set_pinned_posts\n    Fpost.where(pinned: true).all.each do |post|\n      self.randomized_fposts.where(fpost_id: post.id).each do |post|\n        post.set_faketime_for_pinnedposts\n      end\n    end\n\n    first = Fpost.where(pinned: true).first\n    last = Fpost.where(pinned: true).last\n\n    self.randomized_fposts.where(fpost_id: first.id).update_all(fake_time: 1.days.ago)\n    self.randomized_fposts.where(fpost_id: last.id).update_all(fake_time: 30.days.ago)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "omniauth"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508320614, "post_id": 46806910, "comment_id": 80561913, "body": "What is the error message you are getting?  Hard to help without seeing at least error message and perhaps some code."}, {"owner": {"reputation": 21, "user_id": 8794693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae3584b0ef58293652a714ef6522871?s=128&d=identicon&r=PG&f=1", "display_name": "TheOfficialMoss", "link": "https://stackoverflow.com/users/8794693/theofficialmoss"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1508321554, "post_id": 46806910, "comment_id": 80562472, "body": "&quot;Can&#39;t Load URL: The domain of this URL isn&#39;t included in the app&#39;s domains. To be able to load this URL, add all domains and subdomains of your app to the App Domains field in your app settings.&quot; - This is the error"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1508323560, "last_edit_date": 1508323560, "creation_date": 1508322096, "answer_id": 46807915, "question_id": 46806910, "link": "https://stackoverflow.com/questions/46806910/facebook-oauth-the-domain-of-this-url-isnt-included-in-the-apps-domain-with/46807915#46807915", "title": "Facebook OAuth \u201cThe domain of this URL isn&#39;t included in the app&#39;s domain\u201d with localhost:3000", "body": "<p>It might not like localhost.  Can you try to use something like <code>http://myapp.dev</code>  and forward that domain in your <code>etc/hosts</code> file?  Assuming your on *nix system add a line:</p>\n\n<pre><code>127.0.0.1   myapp.dev\n</code></pre>\n\n<p>then in the fb app settings use:</p>\n\n<pre><code>http://myapp.dev\n</code></pre>\n\n<p>But the app name should match your facebook app name.</p>\n\n<p>Also have a look here:  <a href=\"https://stackoverflow.com/questions/21295872/facebook-app-localhost-no-longer-works-as-app-domain/38173031#38173031\">Facebook App: localhost no longer works as app domain</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8794693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae3584b0ef58293652a714ef6522871?s=128&d=identicon&r=PG&f=1", "display_name": "TheOfficialMoss", "link": "https://stackoverflow.com/users/8794693/theofficialmoss"}, "is_accepted": false, "score": 0, "last_activity_date": 1508323331, "creation_date": 1508323331, "answer_id": 46808304, "question_id": 46806910, "link": "https://stackoverflow.com/questions/46806910/facebook-oauth-the-domain-of-this-url-isnt-included-in-the-apps-domain-with/46808304#46808304", "title": "Facebook OAuth \u201cThe domain of this URL isn&#39;t included in the app&#39;s domain\u201d with localhost:3000", "body": "<p>To solve ensure that Use Strict Mode for Redirect URIs is set to No.</p>\n\n<p>This is found in the Facebook Login section of the developer page.</p>\n"}], "owner": {"reputation": 21, "user_id": 8794693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae3584b0ef58293652a714ef6522871?s=128&d=identicon&r=PG&f=1", "display_name": "TheOfficialMoss", "link": "https://stackoverflow.com/users/8794693/theofficialmoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508323560, "creation_date": 1508318907, "last_edit_date": 1508321516, "question_id": 46806910, "link": "https://stackoverflow.com/questions/46806910/facebook-oauth-the-domain-of-this-url-isnt-included-in-the-apps-domain-with", "title": "Facebook OAuth \u201cThe domain of this URL isn&#39;t included in the app&#39;s domain\u201d with localhost:3000", "body": "<p>Trying to create a basic login authentication system via OmniAuth-Facebook and Ruby that uses <code>http ://localhost:3000/</code>. Already implemented this <code>(http:// localhost:3000/</code> into Site URL and Valid OAuth redirect URIs on FacebookDev. </p>\n\n<p><a href=\"https://i.stack.imgur.com/YLvf8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YLvf8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "templates", "import", "ruby-on-rails-5", "render"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1508318963, "last_edit_date": 1508318963, "creation_date": 1508318715, "answer_id": 46806847, "question_id": 46806778, "link": "https://stackoverflow.com/questions/46806778/rending-dynamic-erb-html-template-files-globally-in-rubyonrails-5-application/46806847#46806847", "title": "Rending dynamic erb.html template files globally in RubyonRails 5 application", "body": "<blockquote>\n  <p>The actual rendering is done by subclasses of\n  ActionView::TemplateHandlers. The file extension on your view controls\n  the choice of template handler. Beginning with Rails 2, the standard\n  extensions are .erb for ERB (HTML with embedded Ruby), and .builder\n  for Builder (XML generator).</p>\n</blockquote>\n\n<p>The extension is <code>name_of_file.html.erb</code>, note ERB must be specified as the \"final\" extension, as your file is named <code>_sidebox-user.erb.html</code> then is being used just as a html file.</p>\n\n<p>Rename it to <code>_sidebox-user.html.erb</code> and it should work. Note you can use just the name, the extension is infered:</p>\n\n<pre><code>&lt;%= render 'sidebox-user' %&gt;\n</code></pre>\n"}], "owner": {"reputation": 849, "user_id": 2601689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KKSIm.jpg?s=128&g=1", "display_name": "Designer", "link": "https://stackoverflow.com/users/2601689/designer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 46806847, "answer_count": 1, "score": 1, "last_activity_date": 1508318963, "creation_date": 1508318487, "question_id": 46806778, "link": "https://stackoverflow.com/questions/46806778/rending-dynamic-erb-html-template-files-globally-in-rubyonrails-5-application", "title": "Rending dynamic erb.html template files globally in RubyonRails 5 application", "body": "<p>There are some elements I use globally in different sections such as sidebar-user. So I wanted to create a separate template file for this and import into pages when I need. </p>\n\n<p>So, I created a folder <strong>views/applications</strong> and created <strong>_sidebox-user.erb.html</strong> file in it. </p>\n\n<p><a href=\"https://i.stack.imgur.com/MxBEu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MxBEu.png\" alt=\"enter image description here\"></a> </p>\n\n<p>and I used the code below to render in index.erb.html</p>\n\n<pre><code>      &lt;!-- SIGN UP/LOGIN BOX --&gt;\n      &lt;%= render 'sidebox-user.erb.html' %&gt;\n</code></pre>\n\n<p>But it renders as seen below instead of running my ruby codes in the template file \ud83e\udd26\u200d\u2642\ufe0f</p>\n\n<p><a href=\"https://i.stack.imgur.com/rvQmP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rvQmP.png\" alt=\"enter image description here\"></a></p>\n\n<p>What am I missing here? \ud83e\udd14</p>\n\n<p>Thanks a lot!!!</p>\n"}, {"tags": ["ruby", "metaprogramming", "object-model"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1508319067, "post_id": 46806660, "comment_id": 80560893, "body": "It&#39;s really simple: <code>Object</code> is a <code>Class</code> which is an <code>Object</code>. That&#39;s why it responds to <code>say_hello</code> :)"}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 5, "last_activity_date": 1508322776, "last_edit_date": 1508322776, "creation_date": 1508322452, "answer_id": 46808027, "question_id": 46806660, "link": "https://stackoverflow.com/questions/46806660/ruby-kernel-module-methods-used-as-object-class-methods/46808027#46808027", "title": "Ruby Kernel module methods used as Object class methods", "body": "<blockquote>\n  <p><code>Kernel</code> is just included in <code>Object</code> [...]</p>\n</blockquote>\n\n<p>That is correct.</p>\n\n<blockquote>\n  <p>[...] which shouldn't allow this behavior.</p>\n</blockquote>\n\n<p>You overlook that classes are objects, too.</p>\n\n<hr>\n\n<p>Let's see where the <code>say_hello</code> method comes from if <code>obj</code> is an instance of <code>Object</code>:</p>\n\n<pre><code>obj = Object.new\n\nobj.method(:say_hello)\n#=&gt; #&lt;Method: Object(Kernel)#say_hello&gt;\n</code></pre>\n\n<p>Just as expected. <code>obj</code> is an instance of <code>Object</code> and <code>Object</code> includes <code>Kernel</code>:</p>\n\n<pre><code>obj.class.include? Kernel\n#=&gt; true\n\nobj.class.ancestors\n#=&gt; [Object, Kernel, BasicObject]\n</code></pre>\n\n<hr>\n\n<p>Now let's see what happens if <code>obj</code> is the class <code>Object</code>:</p>\n\n<pre><code>obj = Object\n\nobj.method(:say_hello)\n#=&gt; #&lt;Method: Class(Kernel)#say_hello&gt;\n</code></pre>\n\n<p>This time <code>obj</code> is an instance of <code>Class</code> and <code>Class</code> also includes <code>Kernel</code>:</p>\n\n<pre><code>obj.class.include? Kernel\n#=&gt; true\n\nobj.class.ancestors\n#=&gt; [Class, Module, Object, Kernel, BasicObject]\n</code></pre>\n\n<hr>\n\n<p>Ruby's <a href=\"http://ruby-doc.org/core-2.4.2/doc/syntax/methods_rdoc.html#label-Scope\" rel=\"noreferrer\">documentation</a> notes that class methods are in fact just instance methods defined on the class object: (emphasis added)</p>\n\n<blockquote>\n<pre><code>class C\n  def self.my_method\n    # ...\n  end\nend\n</code></pre>\n  \n  <p>However, this is simply a special case of a greater syntactical power in Ruby, the ability to add methods to any object. Classes are objects, so <strong>adding class methods is simply adding methods to the Class object</strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 6329, "user_id": 178728, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WEcsM.jpg?s=128&g=1", "display_name": "kstratis", "link": "https://stackoverflow.com/users/178728/kstratis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 2, "accepted_answer_id": 46808027, "answer_count": 1, "score": 3, "last_activity_date": 1508322776, "creation_date": 1508318058, "question_id": 46806660, "link": "https://stackoverflow.com/questions/46806660/ruby-kernel-module-methods-used-as-object-class-methods", "title": "Ruby Kernel module methods used as Object class methods", "body": "<p>Say I want to patch the <code>Kernel</code> module with one method I just came up with:</p>\n\n<pre><code>module Kernel\n  def say_hello\n    puts \"hello world\"\n  end\nend\n</code></pre>\n\n<p>I can now certainly do this:</p>\n\n<pre><code>Object.new.say_hello # =&gt; hello world\n</code></pre>\n\n<p>but I can also do the following which I normally shouldn't be able to do:</p>\n\n<pre><code>Object.say_hello # =&gt; hello world\n</code></pre>\n\n<p>Since <code>Object</code> includes <code>Kernel</code> it takes its instance methods and thus all <code>Object</code> instances should respond to <code>say_hello</code>. So far so good.</p>\n\n<p>However <code>Object.say_hello</code> seems to be a class method which could only be justified if we had done something similar to this:</p>\n\n<pre><code>class &lt;&lt; Object\n  def say_hello\n    puts \"hello world\"\n  end  \nend\n</code></pre>\n\n<p>Storing <code>say_hello</code> in <code>Object</code>'s singleton class would allow us to use it as a class method but instead <code>Kernel</code> in just included in <code>Object</code> which shouldn't allow this behavior. But it does. Does anybody have a clue why?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508317543, "post_id": 46806418, "comment_id": 80559925, "body": "Would also be good to get rid of all the code not needed to reproduce the error."}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1508318158, "creation_date": 1508318158, "answer_id": 46806683, "question_id": 46806418, "link": "https://stackoverflow.com/questions/46806418/undefined-method-count-for-nilnilclass-rails/46806683#46806683", "title": "undefined method `count&#39; for nil:NilClass rails", "body": "<pre><code>&lt;% if @photos.count &gt; 0 %&gt;\n</code></pre>\n\n<p>If this fails with an error 'undefined method for nil class', then it means @photos is nil, and you therefore can't perform any methods on it. Where are you calling it? You've not included it in your code.</p>\n\n<p>When you click on the link, look at your server logs and it will tell you which controller action you are hitting. Whichever action you're hitting, is where you'll need to define @photos.</p>\n\n<p>If it is photos#create (the controller action you listed above) then it means that @room.photos is nil. That's unlikely, as it would almost certainly return an empty active record relation if anything, so your problem is not defining @photos in the controller and action you're using at that time.</p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 3, "last_activity_date": 1538149121, "last_edit_date": 1538149121, "creation_date": 1508319293, "answer_id": 46807040, "question_id": 46806418, "link": "https://stackoverflow.com/questions/46806418/undefined-method-count-for-nilnilclass-rails/46807040#46807040", "title": "undefined method `count&#39; for nil:NilClass rails", "body": "<p>You can't call <code>.count</code> on a nil.  @photos must be instantiated first.  You controller doesn't appear to instantiate <code>@photos</code> at all.  I can't see where else in your code you're calling <code>@photos</code> but where it's getting called, the instance variable has not yet be defined.  Your controller create method only shows it happens if <code>params[:images]</code> is present, if otherwise it will be nil.\nTry to instantiate @photos outside the if block.</p>\n\n<pre><code>def create\n  @room = Room.find(params[:room_id])\n  @photos = @room.photos\n  if params[:images]\n    params[:images].each do |img|\n      @room.photos.create(image: img)\n    end\n    redirect_back(fallback_location:request.referer, notice: \"Saved...\")\n  end\nend\n</code></pre>\n\n<p>UPDATE: Ruby 2.3+ you can use safe navigation with <code>&amp;</code> :</p>\n\n<pre><code>def create\n  @room = Room.find(params[:room_id])\n  params[:images]&amp;.each{|img| @room.photos.create(image: img)}\n  redirect_back(fallback_location: request.referer, notice: \"Saved...\")\nend\n</code></pre>\n\n<p>Or why bother using separate <code>@photos</code> in view when you should be able to just call  <code>@room.photos</code> in it's place.</p>\n\n<p>Instead of calling <code>.count</code> as your conditional in the view, use <code>@room.photos.present?</code>  </p>\n\n<p>One more suggestion is to prefer to use positive <code>if</code> case.  so change</p>\n\n<pre><code>if !@room.photos.blank?\n# better to use this below\nif @room.photos.present?\n</code></pre>\n\n<p>Also, one would assume before a create action, you need a new action in your controller where one would expect <code>@photos</code> to be defined if it really needs be isolated from <code>@room.photos</code>.  This is standard MVC in rails, but not sure if you've posted all of your code correctly so I'm guessing here.</p>\n"}, {"tags": [], "owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "is_accepted": false, "score": 2, "last_activity_date": 1508320628, "creation_date": 1508320628, "answer_id": 46807488, "question_id": 46806418, "link": "https://stackoverflow.com/questions/46806418/undefined-method-count-for-nilnilclass-rails/46807488#46807488", "title": "undefined method `count&#39; for nil:NilClass rails", "body": "<p>The people above have already given great explanations as to why you can't call a method on a nil class. In addition, maybe the following code will help in your situation:</p>\n\n<pre><code>&lt;% if !@photos.nil? &amp;&amp; @photos.count &gt; 0 %&gt;\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5178670, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7594cbf58dd69f7cf17a1a9241be9965?s=128&d=identicon&r=PG&f=1", "display_name": "AHmed", "link": "https://stackoverflow.com/users/5178670/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3442, "favorite_count": 0, "accepted_answer_id": 46807040, "answer_count": 3, "score": 1, "last_activity_date": 1538149121, "creation_date": 1508317320, "last_edit_date": 1508318534, "question_id": 46806418, "link": "https://stackoverflow.com/questions/46806418/undefined-method-count-for-nilnilclass-rails", "title": "undefined method `count&#39; for nil:NilClass rails", "body": "<p>I am trying to have a photo upload section in my room listing. when I try to click on the photos I get this error </p>\n\n<p><code>undefined method 'count' for nil:NilClass rails  &lt;% if @photos.count &gt; 0 %&gt;</code> . </p>\n\n<p>I have added a <code>photo_upload.html.erb</code> page and <code>a _room_menu</code> partial but still I get the error. </p>\n\n<p>here's my code:</p>\n\n<p><strong>photos_controller.rb</strong></p>\n\n<pre><code>       class PhotosController &lt; ApplicationController\n        def create\n          @room = Room.find(params[:room_id])\n          if params[:images]\n            params[:images].each do |img|\n              @room.photos.create(image:img)\n            end\n            @photos = @room.photos\n            redirect_back(fallback_location:request.referer, notice: \"Saved...\")\n        end\n      end\n\n\n    end\n\n**views/rooms/photo_upload.html.erb**\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-3\"&gt;\n    &lt;%= render 'room_menu' %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"col-md-9\"&gt;\n    &lt;div class=\"panel panel-default\"&gt;\n\n      &lt;div class=\"panel-heading\"&gt;\n        Photos\n      &lt;/div&gt;\n\n      &lt;div class=\"panel-body\"&gt;\n        &lt;div class=\"container\"&gt;\n          &lt;div class=\"row\"&gt;\n            &lt;div class=\"col-md-offset-3 col-md-6\"&gt;\n              &lt;!-- PHOTOS UPLOAD GOES HERE --&gt;\n\n              &lt;%= form_for @room, url: room_photos_path(@room), method: 'post', html: {multipart: true} do |f| %&gt;\n                &lt;div class=\"row\"&gt;\n                  &lt;div class=\"form-group\"&gt;\n                    &lt;span class=\"btn btn-default btn-file text-babu\"&gt;\n                      &lt;i class=\"fa fa-cloud-upload\" aria-hidden=\"true\"&gt;&lt;/i&gt; Select Photos\n                      &lt;%= file_field_tag \"images[]\", type: :file, multiple: true %&gt;\n                    &lt;/span&gt;\n                  &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"text-center\"&gt;\n                  &lt;%= f.submit \"Add Photos\", class: \"btn btn-form\" %&gt;\n                &lt;/div&gt;\n\n              &lt;% end %&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n\n          &lt;div id=\"photos\"&gt;&lt;%= render 'photos/photos_list' %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>views/rooms/_room_menu.html.erb</strong></p>\n\n<pre><code>&lt;ul class=\"sidebar-list\"&gt;\n  &lt;li class=\"sidebar-item\"&gt;\n    &lt;%= link_to \"Listing\", listing_room_path, class: \"sidebar-link active\" %&gt;\n    &lt;span class=\"pull-right text-babu\"&gt;&lt;i class=\"fa fa-check\"&gt;&lt;/i&gt;&lt;/span&gt;\n  &lt;/li&gt;\n  &lt;li class=\"sidebar-item\"&gt;\n    &lt;%= link_to \"Pricing\", pricing_room_path, class: \"sidebar-link active\" %&gt;\n    &lt;% if !@room.price.blank? %&gt;\n      &lt;span class=\"pull-right text-babu\"&gt;&lt;i class=\"fa fa-check\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;% end %&gt;\n  &lt;/li&gt;\n  &lt;li class=\"sidebar-item\"&gt;\n    &lt;%= link_to \"Description\", description_room_path, class: \"sidebar-link active\" %&gt;\n    &lt;% if !@room.listing_nam.blank? %&gt;\n      &lt;span class=\"pull-right text-babu\"&gt;&lt;i class=\"fa fa-check\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;% end %&gt;\n  &lt;/li&gt;\n\n    &lt;li class=\"sidebar-item\"&gt;\n    &lt;%= link_to \"Photos\", photo_upload_room_path, class: \"sidebar-link active\" %&gt;\n    &lt;% if !@room.photos.blank? %&gt;\n      &lt;span id=\"photo_check\" class=\"pull-right text-babu\"&gt;&lt;i class=\"fa fa-check\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;% end %&gt;\n  &lt;/li&gt;\n\n  &lt;li class=\"sidebar-item\"&gt;\n    &lt;%= link_to \"Amenities\", amenities_room_path, class: \"sidebar-link active\" %&gt;\n    &lt;span class=\"pull-right text-babu\"&gt;&lt;i class=\"fa fa-check\"&gt;&lt;/i&gt;&lt;/span&gt;\n  &lt;/li&gt;\n  &lt;li class=\"sidebar-item\"&gt;\n    &lt;%= link_to \"Location\", location_room_path, class: \"sidebar-link active\" %&gt;\n    &lt;% if !@room.address.blank? %&gt;\n      &lt;span class=\"pull-right text-babu\"&gt;&lt;i class=\"fa fa-check\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;% end %&gt;\n  &lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr/&gt;\n</code></pre>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508314815, "post_id": 46805338, "comment_id": 80558359, "body": "Cannot reproduce. <code>options_for_select([[&quot;Peter&quot;, 1], [&quot;John&quot;, 2], [&quot;Trish&quot;, 3]]) =&gt; &quot;&lt;option value=\\&quot;1\\&quot;&gt;Peter&lt;&#47;option&gt;\\n&lt;option value=\\&quot;2\\&quot;&gt;John&lt;&#47;option&gt;\\n&lt;option value=\\&quot;3\\&quot;&gt;Trish&lt;&#47;option&gt;&quot;</code> ... Can you please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? The example you have given above works perfectly."}, {"owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508315138, "post_id": 46805338, "comment_id": 80558553, "body": "Oh, for me its still failing, it is used in admin generated from Padrino, I will try to post more code, but it is hooked in huge project. Will post in a moment"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508316805, "post_id": 46805338, "comment_id": 80559467, "body": "What is <code>@children</code>? You haven&#39;t show where this is defined in your code. I&#39;m also confused by the line: <code>@categories = Children.all</code> -- you&#39;re not using the <code>@categories</code> variable anywhere?"}, {"owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508317050, "post_id": 46805338, "comment_id": 80559625, "body": "Sorry, its my mistake, from GIT when I copied form from another <code>@children</code> is variable which contains Children.all from model Children, where are values including name and id, so it has to be <code>@children = Children.all</code>."}, {"owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508317134, "post_id": 46805338, "comment_id": 80559685, "body": "When I call <code>@children = Children.all</code> and <code>@children.collect { |child| [child.name, child.id]})</code> over it I get result as I wrote before, but in form it fails"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508318830, "post_id": 46805338, "comment_id": 80560723, "body": "Are you sure that&#39;s the line causing the error? Because this code, in isolation, works fine. I don&#39;t know how to reproduce your problem."}, {"owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508319434, "post_id": 46805338, "comment_id": 80561144, "body": "Yes I am sure it fails exactly on this line of my form and it is error from this file  <code>2017-10-18 09:41:04 - TypeError - no implicit conversion of Array into Hash: \t&#47;usr&#47;local&#47;lib&#47;ruby&#47;gems&#47;2.4.0&#47;gems&#47;padrino-helpers-0.14.1.&zwnj;&#8203;1&#47;lib&#47;padrino-helper&zwnj;&#8203;s&#47;form_builder&#47;abstr&zwnj;&#8203;act_form_builder.rb:&zwnj;&#8203;317:in </code>update&#39;`"}, {"owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508320006, "post_id": 46805338, "comment_id": 80561547, "body": "Now I separated that form just for that one line, and it fails on the template rendering on this type"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508321567, "post_id": 46805338, "comment_id": 80562481, "body": "One last time I will say, I cannot help without a reproducible example. I don&#39;t know how that error correlates to the code above. The code: <code>@children.collect { |child| [child.name, child.id]})</code> works fine, unless <code>@children</code> is something different to what you are telling me."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "is_accepted": false, "score": 0, "last_activity_date": 1508323049, "creation_date": 1508323049, "answer_id": 46808221, "question_id": 46805338, "link": "https://stackoverflow.com/questions/46805338/erb-options-for-select-with-padrino-sinatra/46808221#46808221", "title": "ERB options_for_select with padrino/sinatra", "body": "<p>I finally solve the problem, I googled another style of usage</p>\n\n<pre><code>f.select(:state, :collection =&gt; @states, :fields =&gt; [:name, :id])\n</code></pre>\n\n<p>and I put the data from model directly into form and it works. The documentation about forms I used was constructed the other way using arrays and hashes, this is better way.</p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 87, "user_id": 2404974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506384dc15adb0897f4d5db82fd2618c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2404974/levi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508323049, "creation_date": 1508313451, "last_edit_date": 1508317201, "question_id": 46805338, "link": "https://stackoverflow.com/questions/46805338/erb-options-for-select-with-padrino-sinatra", "title": "ERB options_for_select with padrino/sinatra", "body": "<p>I am trying to make select in form, but it is not working for me, I tried</p>\n\n<pre><code>&lt;%= f.select :children, options_for_select(@children.collect { |child| [child.name, child.id]}) %&gt;\n</code></pre>\n\n<p>And </p>\n\n<pre><code>@children.collect { |child| [child.name, child.id]})\n</code></pre>\n\n<p>this is perfectly working for me in pry.</p>\n\n<pre><code>=&gt; [[\"Peter\", 1],\n [\"John\", 2],\n [\"Trish\", 3],\n</code></pre>\n\n<p>But it is still failing on </p>\n\n<pre><code>TypeError - no implicit conversion of Array into Hash:\n</code></pre>\n\n<p>I am little bit lost :(</p>\n\n<p>Have you got any tips please?</p>\n\n<p>============\nEDIT:</p>\n\n<p>It is in this form</p>\n\n<pre><code>&lt;% error = @class.errors.key?(:children) &amp;&amp; @article.errors[:children].count &gt; 0 %&gt;\n&lt;fieldset class='control-group &lt;%= error ? 'has-error' : ''%&gt;'&gt;\n  &lt;%= f.label :children, :class =&gt; 'control-label' %&gt;\n  &lt;div class='controls'&gt;\n    &lt;% @children = Children.all %&gt;\n    &lt;%= f.select :children, options_for_select(@children.collect { |child| [child.name, child.id]}) %&gt;\n    &lt;span class='help-inline'&gt;&lt;%= error ? f.error_message_on(:children) : \"Ex: Article category\" %&gt;&lt;/span&gt;\n  &lt;/div&gt;\n&lt;/fieldset&gt;\n\n&lt;% @author = session[:account_id] %&gt;\n&lt;%= f.hidden_field :author, :value =&gt; @author %&gt;\n&lt;input name=\"author\" form='article' type=\"hidden\" value=\"4\" /&gt;\n\n&lt;div class=\"form-actions\"&gt;\n  &lt;%= f.submit pat(:save), :class =&gt; 'btn btn-primary' %&gt;\n  &amp;nbsp;\n  &lt;%= f.submit pat(:save_and_continue), :class =&gt; 'btn btn-info', :name =&gt; 'save_and_continue' %&gt;\n  &amp;nbsp;\n  &lt;%= link_to pat(:cancel), url(:articles, :index), :class =&gt; 'btn btn-default' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The form is invoked by </p>\n\n<pre><code>&lt;ul class=\"nav nav-tabs\"&gt;\n  &lt;li&gt; &lt;%= link_to tag_icon(:list, pat(:list)), url(:articles, :index) %&gt;&lt;/li&gt;\n  &lt;li class=\"active\"&gt; &lt;%= link_to tag_icon(:plus, pat(:new)), url(:articles, :new) %&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;div class=\"tabs-content\"&gt;\n  &lt;% form_for :article, url(:articles, :create), :class =&gt; 'form-horizontal' do |f| %&gt;\n    &lt;%= partial 'articles/form', :locals =&gt; { :f =&gt; f } %&gt;\n &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And it is called from controller, I don't know how to put this out a little bit more, it is based on db models, they return data as I wrote, but this form is not working. I tried to write new part of the form, and yet the problem again.</p>\n\n<hr>\n\n<p>I tried to use only html form, but I cannot tell the select to send data via POST, I am very weak in webmastering, I am only programmer. Maybe that is the way, but I dont know how to make it right, when I put</p>\n\n<p> and values (there I was able to generate proper select. But it didnt sent any data.</p>\n"}, {"tags": ["ruby", "linux", "sass"], "answers": [{"comments": [{"owner": {"reputation": 1029, "user_id": 8750617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0FlWafPiEJU/AAAAAAAAAAI/AAAAAAAAAYI/NHivzGgkjnk/photo.jpg?sz=128", "display_name": "snishalaka", "link": "https://stackoverflow.com/users/8750617/snishalaka"}, "edited": false, "score": 0, "creation_date": 1508474664, "post_id": 46807737, "comment_id": 80632656, "body": "yes, I used  <code>sudo gem install sass</code>  also that displayed error in common above error."}, {"owner": {"reputation": 1029, "user_id": 8750617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0FlWafPiEJU/AAAAAAAAAAI/AAAAAAAAAYI/NHivzGgkjnk/photo.jpg?sz=128", "display_name": "snishalaka", "link": "https://stackoverflow.com/users/8750617/snishalaka"}, "edited": false, "score": 1, "creation_date": 1510548217, "post_id": 46807737, "comment_id": 81465227, "body": "the problem does resolved. my system might not have correct c libraries installed. so, after installed that, fix that issue. Thank you!"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1029, "user_id": 8750617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0FlWafPiEJU/AAAAAAAAAAI/AAAAAAAAAYI/NHivzGgkjnk/photo.jpg?sz=128", "display_name": "snishalaka", "link": "https://stackoverflow.com/users/8750617/snishalaka"}, "edited": false, "score": 0, "creation_date": 1511299904, "post_id": 46807737, "comment_id": 81800822, "body": "@snishalaka if this helped, feel free to upvote answer (karma) thanks."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1508515041, "last_edit_date": 1508515041, "creation_date": 1508321462, "answer_id": 46807737, "question_id": 46805323, "link": "https://stackoverflow.com/questions/46805323/i-am-using-deepin-linux-15-4-1-i-want-to-install-ruby-language-for-what-i-want/46807737#46807737", "title": "I am using Deepin linux 15.4.1. I want to install Ruby language for what, i want to execute Sass/SCSS. but Now I tried to do this as root user:", "body": "<p>These kinds of errors are usually system compiler errors where your system might not have the correct core c libraries installed.   Have a look at this thread for ideas on how you might fix this.</p>\n\n<p><a href=\"https://github.com/sass/sass/issues/2357\" rel=\"nofollow noreferrer\">https://github.com/sass/sass/issues/2357</a></p>\n\n<p>How is Ruby installed?  RVM, RBENV, Type this in terminal and give us outputs:</p>\n\n<pre><code>which ruby\nruby -v\n</code></pre>\n\n<p>Also did you try running <code>sudo gem install sass</code>  ?</p>\n\n<p>UPDATE:  You may need root access to where the gem is trying to install. See <a href=\"https://stackoverflow.com/questions/3952243/warning-insecure-world-writable-dir-usr-local-bin-in-path-mode-040777#3952325\">warning: Insecure world writable dir /usr/local/bin in PATH, mode 040777</a></p>\n\n<p>Also can you post output of  <code>echo $PATH</code> ?\nand also <code>ruby -v</code> and <code>which ruby</code>   Hard to see what's going on without that.</p>\n\n<p>I would also recommend you use RVM to install ruby.  Not sure if you your linux version comes with pre-installed ruby version, but you can install other Ruby versions with RVM.  </p>\n"}], "owner": {"reputation": 1029, "user_id": 8750617, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0FlWafPiEJU/AAAAAAAAAAI/AAAAAAAAAYI/NHivzGgkjnk/photo.jpg?sz=128", "display_name": "snishalaka", "link": "https://stackoverflow.com/users/8750617/snishalaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 674, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508515041, "creation_date": 1508313423, "question_id": 46805323, "link": "https://stackoverflow.com/questions/46805323/i-am-using-deepin-linux-15-4-1-i-want-to-install-ruby-language-for-what-i-want", "title": "I am using Deepin linux 15.4.1. I want to install Ruby language for what, i want to execute Sass/SCSS. but Now I tried to do this as root user:", "body": "<pre><code>gem install sass\n</code></pre>\n\n<p>But, I get this error.</p>\n\n<pre><code>Fetching: rb-fsevent-0.10.2.gem (100%)\n</code></pre>\n\n<p>Successfully installed rb-fsevent-0.10.2\nFetching: ffi-1.9.18.gem (100%)\nBuilding native extensions.  This could take a while...\n/usr/lib/ruby/2.3.0/rubygems/ext/builder.rb:76: warning: Insecure world writable dir /opt in PATH, mode 040777\nERROR:  Error installing sass:\n    ERROR: Failed to build gem native extension.</p>\n\n<pre><code>current directory: /var/lib/gems/2.3.0/gems/ffi-1.9.18/ext/ffi_c\n</code></pre>\n\n<p>/usr/bin/ruby2.3 -r ./siteconf20171018-24304-17ddhmp.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h</p>\n\n<p>extconf failed, exit code 1</p>\n\n<p>Gem files will remain installed in /var/lib/gems/2.3.0/gems/ffi-1.9.18 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/ffi-1.9.18/gem_make.out</p>\n\n<p>what's wrong here? i installed Ruby stable release Ruby 2.4.2 <a href=\"https://www.ruby-lang.org/en/downloads/\" rel=\"nofollow noreferrer\"> Ruby stable release Ruby 2.4.2</a></p>\n"}, {"tags": ["javascript", "ruby", "validation", "ruby-on-rails-4", "model-view-controller"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508306142, "post_id": 46803578, "comment_id": 80553939, "body": "Presumably your <code>balance</code> field is a number, so you&#39;ll want to verify that with numerical comparisons, not strings. Have you tried <code>in: 0..1e9</code> as an example of a good range?"}, {"owner": {"reputation": 162, "user_id": 8397782, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-WLDKa6wvBgE/AAAAAAAAAAI/AAAAAAAAA9s/kGyIlC3iKyw/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/8397782/ronak-bhatt"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508306622, "post_id": 46803578, "comment_id": 80554119, "body": "i tried rang of 1 to 9999 but it doesnt work."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 8758262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EnOvKCXg4tI/AAAAAAAAAAI/AAAAAAAAARo/4v8Ew1thr4w/photo.jpg?sz=128", "display_name": "reizist", "link": "https://stackoverflow.com/users/8758262/reizist"}, "is_accepted": false, "score": 1, "last_activity_date": 1508307210, "creation_date": 1508307210, "answer_id": 46803860, "question_id": 46803578, "link": "https://stackoverflow.com/questions/46803578/i-want-to-validate-a-textbox-to-check-negative-value-like-100/46803860#46803860", "title": "I want to validate a textbox to check negative value Like -100?", "body": "<p><code>:greater_than</code> or <code>:greater_than_or_equal_to</code> option is that.</p>\n\n<pre><code>class Hoge &lt; ApplicationRecord\n  validates :balance, numericality: { greater_than: 0 }\nend\n</code></pre>\n\n<p>it works like below:</p>\n\n<pre><code>Loading development environment (Rails 5.1.4)\n[1] pry(main)&gt; Hoge.create(balance: 1)\n   (0.6ms)  SET NAMES utf8mb4 COLLATE utf8mb4_general_ci,  @@SESSION.sql_mode = CONCAT(CONCAT(@@sql_mode, ',STRICT_ALL_TABLES'), ',NO_AUTO_VALUE_ON_ZERO'),  @@SESSION.sql_auto_is_null = 0, @@SESSION.wait_timeout = 2147483\n   (0.1ms)  BEGIN\n  SQL (12.2ms)  INSERT INTO `hoges` (`balance`, `created_at`, `updated_at`) VALUES (1, '2017-10-18 06:06:18', '2017-10-18 06:06:18')\n   (11.1ms)  COMMIT\n\n\n   [2] pry(main)&gt; Hoge.create(balance: -1)\n   (0.2ms)  BEGIN\n   (0.2ms)  ROLLBACK\n=&gt; #&lt;Hoge:0x007fa212e1cd80 id: nil, balance: -1, created_at: nil, updated_at: nil&gt;\n[4] pry(main)&gt; Hoge.create(balance: -1).errors\n   (0.3ms)  BEGIN\n   (0.2ms)  ROLLBACK\n=&gt; #&lt;ActiveModel::Errors:0x007fa20fcc37c0\n @base=#&lt;Hoge:0x007fa20f6c08f0 id: nil, balance: -1, created_at: nil, updated_at: nil&gt;,\n @details={:balance=&gt;[{:error=&gt;:greater_than, :value=&gt;-1, :count=&gt;0}]},\n @messages={:balance=&gt;[\"must be greater than 0\"]}&gt;\n</code></pre>\n\n<p>FYI: <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_validations.html</a></p>\n"}], "owner": {"reputation": 162, "user_id": 8397782, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-WLDKa6wvBgE/AAAAAAAAAAI/AAAAAAAAA9s/kGyIlC3iKyw/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/8397782/ronak-bhatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508315427, "creation_date": 1508305795, "last_edit_date": 1508315427, "question_id": 46803578, "link": "https://stackoverflow.com/questions/46803578/i-want-to-validate-a-textbox-to-check-negative-value-like-100", "title": "I want to validate a textbox to check negative value Like -100?", "body": "<p>i create a simple banking app <a href=\"https://bankmanagment.herokuapp.com/\" rel=\"nofollow noreferrer\">This is the Link</a> For study purpose. alll the function are work charming but i weant to check validation if user enter Negative value like -100 so it shows error or alert message. so how can ii implement.</p>\n\n<p>Thanks in advance :)</p>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for(@depositemoney) do |f| %&gt;\n  &lt;% if @depositemoney.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@depositemoney.errors.count, \"error\") %&gt; prohibited this depositemoney from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @depositemoney.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :balance %&gt;&lt;br&gt;\n    &lt;%= f.number_field :balance %&gt;\n  &lt;/div&gt;\n  &lt;%= f.hidden_field :u_id, :value =&gt; current_user.id %&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Model.rb</strong></p>\n\n<pre><code>class Depositemoney &lt; ActiveRecord::Base\n        # validates :balance, :numericality =&gt; {:only_integer =&gt; true}\n        # validates :balance, presence: true\n          validates :balance, presence: true\n                 # validates :balance, :inclusion =&gt; {:in =&gt; [1,2]}\n          validates :balance, format: { with: /\\A\\d+\\z/, message: \"Integer only. No sign allowed.\" }\nend\n</code></pre>\n\n<p>I tried 3 Types of validations but it does not worrk for me so any one can help me out :)</p>\n"}, {"tags": ["ruby", "string", "encoding", "utf-8", "ruby-2.0"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508308426, "post_id": 46803488, "comment_id": 80554876, "body": "If you just want to read a file with a Unicode BOM, you can pass an <a href=\"http://ruby-doc.org/core-2.4.2/IO.html#method-c-new-label-IO+Encoding\" rel=\"nofollow noreferrer\">encoding</a> of <code>&#39;BOM|UTF-8&#39;</code> and let Ruby handle it automatically."}], "answers": [{"comments": [{"owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "edited": false, "score": 0, "creation_date": 1508311081, "post_id": 46804047, "comment_id": 80556250, "body": "But it&#39;s 8 bit ascii and the characters 255 and 254 are defined. So what&#39;s up with that? <code>&quot;\\xFF\\xFE&quot;.encode(&#39;ASCII-8BIT&#39;)</code> works just fine. Is it because it&#39;s not valid UTF-8 ?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 3, "creation_date": 1508311338, "post_id": 46804047, "comment_id": 80556390, "body": "There is no such thing as &quot;8 bit ascii&quot;. ASCII is, has always been, and will always be 7 bit."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "edited": false, "score": 0, "creation_date": 1508319344, "post_id": 46804047, "comment_id": 80561072, "body": "@banister you are confusing <code>&#39;ASCII-8BIT&#39;</code> with <code>&#39;US-ASCII&#39;</code> and my answer wasn&#39;t very precise in that regard either. I&#39;ve updated it accordingly."}, {"owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1508334611, "post_id": 46804047, "comment_id": 80570666, "body": "@J&#246;rgWMittag ok then &quot;extended ascii is 8 bit&quot; is that ok? :) From wikipedia, &quot;The extended ASCII character set uses 8 bits&quot;"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "edited": false, "score": 0, "creation_date": 1508335393, "post_id": 46804047, "comment_id": 80571261, "body": "@horseyguy Wikipedia says that? &quot;extended ASCII&quot; is an umbrella term referring to any encoding built on top of ASCII. Even UTF-8 is extended ASCII."}, {"owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "edited": false, "score": 0, "creation_date": 1508336339, "post_id": 46804047, "comment_id": 80571880, "body": "@Stefan i think it&#39;s a misnomer now (and possibly then too), but in early DOS days &#39;extended ascii&#39; was generally used to refer to only one 8-bit character set possibly due to built-in dos support. I agree &#39;extended ascii&#39; doesn&#39;t appear to make sense now though, <a href=\"http://www.theasciicode.com.ar/extended-ascii-code/letter-u-with-umlaut-diaeresis-lowercase-u-umlaut-ascii-code-129.html\" rel=\"nofollow noreferrer\">theasciicode.com.ar/extended-ascii-code/&hellip;</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "edited": false, "score": 0, "creation_date": 1508337561, "post_id": 46804047, "comment_id": 80572735, "body": "@horseyguy that looks like <a href=\"https://en.wikipedia.org/wiki/Code_page_850\" rel=\"nofollow noreferrer\">code page 850</a>. I always preferred <a href=\"https://en.wikipedia.org/wiki/Code_page_437\" rel=\"nofollow noreferrer\">code page 437</a> because of the superior box drawing capabilities :-)"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1508319587, "last_edit_date": 1508319587, "creation_date": 1508308277, "answer_id": 46804047, "question_id": 46803488, "link": "https://stackoverflow.com/questions/46803488/why-is-a-utf-8-string-not-equal-to-the-equivalent-ascii-8bit-string-in-ruby-2-0/46804047#46804047", "title": "Why is a UTF-8 string not equal to the equivalent ASCII-8BIT string in Ruby 2.0?", "body": "<blockquote>\n  <p>(1) why does it return <code>false</code>?</p>\n</blockquote>\n\n<p>When comparing strings, they either have to be in the same encoding or their characters must be encodable in US-ASCII.</p>\n\n<p>Comparison works as expected if the string only contains byte values 0 to 127: (<code>0b0xxxxxxx</code>)</p>\n\n<pre><code>a = 'E'.encode('ISO8859-1')  #=&gt; \"E\"\nb = 'E'.encode('ISO8859-15') #=&gt; \"E\"\n\na.bytes #=&gt; [69]\nb.bytes #=&gt; [69]\na == b  #=&gt; true\n</code></pre>\n\n<p>And fails if it contains any byte values 128 to 255: (<code>0b1xxxxxxx</code>)</p>\n\n<pre><code>a = '\u00c9'.encode('ISO8859-1')  #=&gt; \"\\xC9\"\nb = '\u00c9'.encode('ISO8859-15') #=&gt; \"\\xC9\"\n\na.bytes #=&gt; [201]\nb.bytes #=&gt; [201]\na == b  #=&gt; false\n</code></pre>\n\n<p>Your string can't be represented in US-ASCII, because both its bytes are outside its range:</p>\n\n<pre><code>\"\\xFF\\xFE\".bytes #=&gt; [255, 254]\n</code></pre>\n\n<p>Attempting to convert it doesn't produce any meaningful result:</p>\n\n<pre><code>\"\\xFF\\xFE\".encode('US-ASCII', 'ASCII-8BIT', :undef =&gt; :replace)\n#=&gt; \"??\"\n</code></pre>\n\n<p>The string will therefore return <code>false</code> when being compared to a string in another encoding, regardless of its content.</p>\n\n<blockquote>\n  <p>(2) what is the best way to go about achieving what i want?</p>\n</blockquote>\n\n<p>You could compare your string to a string with the same encoding. <code>binread</code> returns a string in <code>ASCII-8BIT</code> encoding, so you could use <a href=\"http://ruby-doc.org/core-2.4.2/String.html#method-i-b\" rel=\"nofollow noreferrer\"><code>b</code></a> to create a compatible one:</p>\n\n<pre><code>IO.binread('your_file', 2) == \"\\xFF\\xFE\".b\n</code></pre>\n\n<p>or you could compare its <a href=\"http://ruby-doc.org/core-2.4.2/String.html#method-i-bytes\" rel=\"nofollow noreferrer\"><code>bytes</code></a>:</p>\n\n<pre><code>IO.binread('your_file', 2).bytes == [0xFF, 0xFE]\n</code></pre>\n"}], "owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 46804047, "answer_count": 1, "score": 2, "last_activity_date": 1508335258, "creation_date": 1508305337, "last_edit_date": 1508335258, "question_id": 46803488, "link": "https://stackoverflow.com/questions/46803488/why-is-a-utf-8-string-not-equal-to-the-equivalent-ascii-8bit-string-in-ruby-2-0", "title": "Why is a UTF-8 string not equal to the equivalent ASCII-8BIT string in Ruby 2.0?", "body": "<p>I am using Ruby 2.3:</p>\n\n<p>I have the following string: <code>\"\\xFF\\xFE\"</code></p>\n\n<p>I do a <code>File.binread()</code> on a file containing it, so the encoding of this string is <code>ASCII-8BIT</code>. However, in my code, i check to see whether this string was indeed read by comparing it to the literal string <code>\"\\xFF\\xFE\"</code> (which has encoding <code>UTF-8</code> as all Ruby strings have by default).</p>\n\n<p>However, the comparison returns <code>false</code>, even though both strings contain the same bytes - it just happens that one is with encoding <code>ASCII-8BIT</code> and the other is <code>UTF-8</code></p>\n\n<p>I have two questions: (1) why does it return <code>false</code> ? and (2) what is the best way to go about achieving what i want? I just want to check whether the string I read matches <code>\"\\xFF\\xFE\"</code></p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "edited": false, "score": 0, "creation_date": 1508301156, "post_id": 46802783, "comment_id": 80552317, "body": "<code>Model.create</code> will try to create a record in the database.    Better way to do it is by <code>model = Model.new(create_params)</code>. Then <code>model.save</code> makes sense."}, {"owner": {"reputation": 115, "user_id": 8518596, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ae6e753c58a8469c11e87444002683ae?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas james", "link": "https://stackoverflow.com/users/8518596/nicholas-james"}, "edited": false, "score": 0, "creation_date": 1508301389, "post_id": 46802783, "comment_id": 80552385, "body": "so if i add that validates check in model and if i add update action in controller along with create and for update all params are not necessary then would that still work?"}, {"owner": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "reply_to_user": {"reputation": 115, "user_id": 8518596, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ae6e753c58a8469c11e87444002683ae?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas james", "link": "https://stackoverflow.com/users/8518596/nicholas-james"}, "edited": false, "score": 1, "creation_date": 1508301462, "post_id": 46802783, "comment_id": 80552403, "body": "@Nicholasjames yes, this is possible: <a href=\"http://guides.rubyonrails.org/active_record_validations.html#on\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_record_validations.html#on</a>"}], "tags": [], "owner": {"reputation": 7036, "user_id": 1740079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xp2ab.png?s=128&g=1", "display_name": "nicooga", "link": "https://stackoverflow.com/users/1740079/nicooga"}, "is_accepted": true, "score": 1, "last_activity_date": 1508301052, "last_edit_date": 1508301052, "creation_date": 1508300645, "answer_id": 46802783, "question_id": 46802718, "link": "https://stackoverflow.com/questions/46802718/how-to-return-exact-error-from-create-params-if-any-missing/46802783#46802783", "title": "how to return exact error from create params if any missing", "body": "<p>Having validations at database level like <code>NOT NULL</code> is a good practice.\nBut it is not possible, or reliable, to catch an error raised by the DB.\nIf you want good error messages, do the validation at ActiveRecord's level.</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  validates :param1, :param2, :param3, :param4, :param5, presence: true\nend\n\nclass ModelsController &lt; ApplicationController\n  def create\n    model = Model.new(create_params)\n\n    if model.save # returns true or false\n      # ... do something\n    else\n      # ... model.errors is a collection that holds errors\n      model.errors\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8518596, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ae6e753c58a8469c11e87444002683ae?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas james", "link": "https://stackoverflow.com/users/8518596/nicholas-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 46802783, "answer_count": 1, "score": 0, "last_activity_date": 1508301052, "creation_date": 1508300150, "question_id": 46802718, "link": "https://stackoverflow.com/questions/46802718/how-to-return-exact-error-from-create-params-if-any-missing", "title": "how to return exact error from create params if any missing", "body": "<p>I have following create params that are passed to create!</p>\n\n<pre><code>  def create_params\n    params.permit(\n      :param1,\n      :param2,\n      :param3,\n      :param4,\n      :param5\n    )\n  end\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>  def create\n    something = Model.create!(create_params)\n  end\n</code></pre>\n\n<p>All the columns in the table are NOT NULL. So if i not pass any one of the param i get error something like below</p>\n\n<pre><code>Mysql2::Error: Field 'col5' doesn't have a default value: INSERT INTO `table` (`col1`, `col2`, `col3`, `col4`) VALUES ('value1', 'value2, 'value3', 'value4')\n</code></pre>\n\n<p>But its not giving the exact error message. How can i have it return some valid error message?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1508298904, "post_id": 46802475, "comment_id": 80551794, "body": "<code>word</code> isn\u2019t <code>nil</code>; try entering <code>word</code> at the prompt after that."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1508299101, "post_id": 46802475, "comment_id": 80551849, "body": "<code>word||=&quot;&quot; # =&gt; true</code> in the third session cannot be reproduced. And even your result <code>word||=&quot;&quot; # =&gt; &quot;&quot;</code> in the second session goes against that."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508315149, "post_id": 46802475, "comment_id": 80558560, "body": "Think about it: <code>word</code> must be <code>&quot;&quot;</code>, otherwise the <code>until</code> loop wouldn&#39;t have stopped."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1508303311, "post_id": 46802634, "comment_id": 80552926, "body": "It&#39;s like how <code>puts</code> always returns <code>nil</code> even if it does things. That&#39;s just how it works."}, {"owner": {"reputation": 7036, "user_id": 1740079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xp2ab.png?s=128&g=1", "display_name": "nicooga", "link": "https://stackoverflow.com/users/1740079/nicooga"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508303436, "post_id": 46802634, "comment_id": 80552967, "body": "Yes, more or less. The difference is that <code>puts</code> is a method that can be overwritten to return something else, while <code>until</code> is a keyword  built into the language."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508303474, "post_id": 46802634, "comment_id": 80552976, "body": "Oh, absolutely. What I mean is that the return value does not mean it didn&#39;t do anything. Some functions do tons of stuff and return <code>nil</code> to avoid clutter."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508315224, "post_id": 46802634, "comment_id": 80558596, "body": "From the <a href=\"http://ruby-doc.org/core-2.4.2/doc/syntax/control_expressions_rdoc.html#label-until+Loop\" rel=\"nofollow noreferrer\">docs</a>: <i>&quot;Like a <code>while</code> loop, the result of an <code>until</code> loop is <code>nil</code> unless <code>break</code> is used.&quot;</i>"}], "tags": [], "owner": {"reputation": 7036, "user_id": 1740079, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xp2ab.png?s=128&g=1", "display_name": "nicooga", "link": "https://stackoverflow.com/users/1740079/nicooga"}, "is_accepted": true, "score": 4, "last_activity_date": 1508299576, "creation_date": 1508299576, "answer_id": 46802634, "question_id": 46802475, "link": "https://stackoverflow.com/questions/46802475/why-does-this-until-modifier-return-nil/46802634#46802634", "title": "Why does this until modifier return nil?", "body": "<p>A language like ruby is composed of expressions. Each expression has a return value. The <code>until</code> keyword is a flow control tool that allows to execute an expression \"until\" certain condition is fulfilled. Seems like an expression of the form <code>statement until condition</code> returns <code>nil</code>, regardless of what <code>statement</code>'s return value is.</p>\n\n<p>In this particular case, that <code>nil</code> you get has nothing to do with the value assigned to <code>\u1e81ord</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6820969"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 46802634, "answer_count": 1, "score": 0, "last_activity_date": 1508315368, "creation_date": 1508298407, "last_edit_date": 1508315368, "question_id": 46802475, "link": "https://stackoverflow.com/questions/46802475/why-does-this-until-modifier-return-nil", "title": "Why does this until modifier return nil?", "body": "<p>With this IRB session:</p>\n\n<pre><code>words = []\n#=&gt; []\nword||=\"\"\n#=&gt; \"\"\nwords.push(word) until(word=gets.chomp)==\"\"\n\n#=&gt; nil\nwords\n#=&gt; []\n</code></pre>\n\n<p>I thought that <code>word</code> is set to <code>\"\"</code>, then overridden by the users input which was <kbd>enter</kbd>, resulting in <code>word</code> being set to <code>\"\"</code> again.</p>\n\n<p>What am I misunderstanding that results in <code>word</code> being <code>nil</code>? </p>\n"}, {"tags": ["c", "ruby", "inline"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508304365, "post_id": 46801990, "comment_id": 80553265, "body": "Ruby and C are two very different languages. If you&#39;re not familiar with how to use C effectively you&#39;ll need to at least understand the fundamentals. The good news is C is pretty simple as far as languages go, with a terse, minimal sort of syntax. The difficulty comes in applying concepts like pointers and pointer math effectively."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508473831, "post_id": 46801990, "comment_id": 80632463, "body": "I am much more familiar with C (sorry for the obvious oversight of modifying a constant string). The problem is, I need to know how to modify a global ruby variable but don&#39;t know how.  Thx"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508517432, "post_id": 46801990, "comment_id": 80654452, "body": "Don&#39;t let Ruby&#39;s casual style confuse your C code then. A call to <code>sprintf</code> needs to be inside a function, but it&#39;s also baffling that you&#39;re using <code>sprintf</code> at all instead of something simple like <code>strncpy</code> or in this case, given how you&#39;ve failed to initialize <code>cstr</code>, <code>memcpy</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1508298766, "post_id": 46802256, "comment_id": 80551748, "body": "Thanks @mu-is-too-short, I changed cstr to be a buffer from a pointer to constant string, I got some compile error. Care to point out what went wrong? Thx."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1508300552, "post_id": 46802256, "comment_id": 80552166, "body": "You can&#39;t call <code>sprintf</code> outside a function like that."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 2, "last_activity_date": 1508296903, "creation_date": 1508296903, "answer_id": 46802256, "question_id": 46801990, "link": "https://stackoverflow.com/questions/46801990/inline-code-causes-ruby-interpreter-to-crash/46802256#46802256", "title": "Inline code causes ruby interpreter to crash", "body": "<p>Your problem is that you're trying to modify read-only memory. If you get all the clutter out of the way, you can show this with a small C program:</p>\n\n<pre><code>int\nmain(int argc, char **argv) {\n  char *cstr = \"hi you'all, welcome\";\n  cstr[1]++;\n  return 0;\n}\n</code></pre>\n\n<p>If you compile that and run it you should get a bus error (or similar) because <code>cstr</code> is in read-only memory and <code>cstr[1]++</code> is trying to modify that read-only memory. There is some discussion on this over in <a href=\"https://stackoverflow.com/q/1011455/479863\"><strong>Is it possible to modify a string of char in C?</strong></a> and probably hundreds of other questions in the <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> tag.</p>\n\n<p>The solution is to not modify <code>cstr</code>. I don't have enough details to offer more concrete advice.</p>\n"}, {"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1508672530, "last_edit_date": 1508672530, "creation_date": 1508610742, "answer_id": 46866646, "question_id": 46801990, "link": "https://stackoverflow.com/questions/46801990/inline-code-causes-ruby-interpreter-to-crash/46866646#46866646", "title": "Inline code causes ruby interpreter to crash", "body": "<p>Watch out for how RubyInline defines your Ruby methods. If you use <code>c_raw</code> or <code>c_raw_singleton</code> then it uses <code>-1</code> as the arity in the call to <code>rb_define_method</code> or <code>rb_define_singleton_method</code>, <a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc#method-and-singleton-method-definition\" rel=\"nofollow noreferrer\">so the method is called as</a>:</p>\n\n<pre><code>VALUE func(int argc, VALUE *argv, VALUE obj)\n</code></pre>\n\n<p>So in your case your signature should be something like:</p>\n\n<pre><code>VALUE write_global(int argc, VALUE *argv, VALUE self)\n</code></pre>\n\n<p>Here\u2019s a version of your class with that change. I\u2019ve also moved the <code>cstr</code> declaration into the prefix to avoid a warning and used <code>StringValueCStr</code> instead of <code>rb_string_value_cstr</code> as it is <a href=\"https://github.com/ruby/ruby/blob/trunk/doc/extension.rdoc#data-type-conversion\" rel=\"nofollow noreferrer\">better documented</a>, but I\u2019ve omitted any error checking (which you should add as otherwise you could get further segfaults):</p>\n\n<pre><code>class Foo\n  inline :C  do |builder|\n\n    builder.prefix(\"static char cstr[] = \\\"hi you'all, welcome\\\";\")\n\n    builder.c_raw_singleton &lt;&lt;SRC\n      VALUE write_global(int argc, VALUE* argv, VALUE self){\n        rb_gv_set(StringValueCStr(argv[0]), rb_str_new_cstr(cstr));\n        cstr[1] ++;\n        return Qnil;\n      }\nSRC\n  end\nend\n</code></pre>\n\n<p>With this class, the output of your code is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>hi you'all, welcome\nhj you'all, welcome\n</code></pre>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1508672530, "creation_date": 1508294459, "last_edit_date": 1508298715, "question_id": 46801990, "link": "https://stackoverflow.com/questions/46801990/inline-code-causes-ruby-interpreter-to-crash", "title": "Inline code causes ruby interpreter to crash", "body": "<p>My ruby based data analysis project needs high performance. I plan to create an inline C function that reads a piece of data and updates some global variables, which I can do more processing in ruby.</p>\n\n<p>The following toy code:</p>\n\n<pre><code>require 'inline'\nclass Foo\n  inline :C  do |builder|\n    builder.c_raw_singleton &lt;&lt;SRC\n     static char *cstr = \"hi you'all, welcome\";\n      void write_global(VALUE self, VALUE *name){\n        rb_gv_set(rb_string_value_cstr(name), rb_str_new_cstr(cstr));\n        cstr[1] ++;\n      }\nSRC\n  end\nend\n\n\n$bar = \"\"\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\n</code></pre>\n\n<p>will cause exception on ruby interpreter.</p>\n\n<p>I wonder what the problem is.</p>\n\n<p><strong>UPDATE 1</strong></p>\n\n<p>Thanks to @mu-is-too-short who pointed out the constant string can't be modified, I changed it to be a buffer (see the following), but got compile errors like</p>\n\n<pre><code>WARNING: '&amp;cstr[0]' not understood\nWARNING: '\"%s\"' not understood\nWARNING: '\"hi you'all' not understood\nWARNING: 'welcome\"' not understood\nWARNING: Can't find signature in \"\\t static char cstr[20];static int f(&amp;cstr[0], \\\"%s\\\", \\\"hi you'all, welcome\\\");\\n      void write_global(VALUE self, VALUE *name){\\n        rb_gv_set(rb_string_value_cstr(name), rb_str_new_cstr(cstr));\\n\\t\\tcstr[1] ++;\\n      }\\n\"\ninline1a.rb:5:37: error: expected declaration specifiers or \u2018...\u2019 before \u2018&amp;\u2019 token\n     builder.c_raw_singleton &lt;&lt;SRC\n</code></pre>\n\n<p>Here is the new code that doesn't try to modify constant string.</p>\n\n<pre><code>require 'inline'\nclass Foo\n  inline :C  do |builder|\n    builder.c_raw_singleton &lt;&lt;SRC\n     static char cstr[20];\n     sprintf(&amp;cstr[0], \"%s\", \"hi you'all, welcome\");\n      void write_global(VALUE self, VALUE *name){\n        rb_gv_set(rb_string_value_cstr(name), rb_str_new_cstr(cstr));\n        cstr[1] ++;\n      }\nSRC\n  end\nend\n\n\n$bar = \"\"\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\nFoo.write_global('bar') #=&gt; 1\nputs $bar;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 417, "user_id": 4935447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d380df3a3020da7e377ab42834112db3?s=128&d=identicon&r=PG&f=1", "display_name": "drosboro", "link": "https://stackoverflow.com/users/4935447/drosboro"}, "edited": false, "score": 0, "creation_date": 1508294507, "post_id": 46801920, "comment_id": 80550752, "body": "I think you may mean <code>@date = Date.today</code> (your version says Data)."}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "edited": false, "score": 0, "creation_date": 1508295895, "post_id": 46802060, "comment_id": 80551033, "body": "Well, the reason of this is that i want to create an API which handles all the logic and i want to have a real good front-end made with Angular, Thing is, i can&#39;t use angular comfortably now, so i have to split it and use rails as front end because it matches my current experience with front end, this will be some something like testing front end not a real one, I don&#39;t want my app to be monolithic so i can make it&#39;s front-end later, Also another question is where should i put this code you wrote ? may be i have some experience with rails but no on this part."}, {"owner": {"reputation": 417, "user_id": 4935447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d380df3a3020da7e377ab42834112db3?s=128&d=identicon&r=PG&f=1", "display_name": "drosboro", "link": "https://stackoverflow.com/users/4935447/drosboro"}, "reply_to_user": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "edited": false, "score": 0, "creation_date": 1508300513, "post_id": 46802060, "comment_id": 80552161, "body": "Okay, in this case, I might suggest using the ActiveResource gem, which basically lets you build models (like normal) that are backed by an API rather than a database.  That way, your front-end app will be structured much like a &quot;normal&quot; rails app.  I&#39;ve added a section to my answer about that - but you&#39;ll want to look at the Active Resource readme carefully."}, {"owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "edited": false, "score": 0, "creation_date": 1508310750, "post_id": 46802060, "comment_id": 80556055, "body": "That&#39;s exactly what i was looking for, or at least it solved a serious problem here, I tried it and it worked, I had some struggles and had to read the documentation and it worked for indexing entries and adding new entries to db, i guess it should go the same for update and delete, Thank you very much for your help :)"}, {"owner": {"reputation": 109, "user_id": 5112762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea107a708e620eee5d5b454355a060e2?s=128&d=identicon&r=PG&f=1", "display_name": "ayinloya", "link": "https://stackoverflow.com/users/5112762/ayinloya"}, "edited": false, "score": 0, "creation_date": 1515928975, "post_id": 46802060, "comment_id": 83480613, "body": "@drosboro the approach of building one rails app that handles both api and front-end is quite compelling, I need your help to do that"}], "tags": [], "owner": {"reputation": 417, "user_id": 4935447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d380df3a3020da7e377ab42834112db3?s=128&d=identicon&r=PG&f=1", "display_name": "drosboro", "link": "https://stackoverflow.com/users/4935447/drosboro"}, "is_accepted": true, "score": 3, "last_activity_date": 1508300392, "last_edit_date": 1508300392, "creation_date": 1508295046, "answer_id": 46802060, "question_id": 46801920, "link": "https://stackoverflow.com/questions/46801920/how-to-connect-2-rails-5-apps-together-api-rails-and-front-end-rails-as-well/46802060#46802060", "title": "How to connect 2 rails 5 apps together API (rails) and front-end (rails as well)", "body": "<p>For such a simple example, you can do something as simple as:</p>\n\n<pre><code>def index\n  @date = Date.today\n  respond_to do |format|\n    format.json @date\n  end\nend\n</code></pre>\n\n<p>However, you're most likely going to want to deal with more complicated JSON responses, so before long you'll probably want to use something like the <a href=\"https://github.com/rails/jbuilder\" rel=\"nofollow noreferrer\">Jbuilder gem</a> or <a href=\"https://github.com/rails-api/active_model_serializers\" rel=\"nofollow noreferrer\">ActiveModel Serializers</a> (my preferred approach).</p>\n\n<p>On the other end, your front-end will need to make an HTTP GET request.  Lots of ways (and gems) to do this, but one common approach is just to use the built in <code>Net::HTTP</code> class.</p>\n\n<pre><code>require 'net/http'\n\nurl = URI.parse('http://backend.dev/main/index')\nrequest = Net::HTTP::Get.new(url.to_s)\nresponse = Net::HTTP.start(url.host, url.port) do |http|\n  http.request(request)\nend\n\nraise response.body.inspect\n</code></pre>\n\n<p>In your situation, a better approach might be to use the <a href=\"https://github.com/rails/activeresource\" rel=\"nofollow noreferrer\">Active Resource gem</a>.  This gem allows you to create models that are backed by a REST API rather than a database.  For example, if your API app provides basic Create-Read-Update-Destroy actions for a particular model (let's call it <code>Widget</code>) at the following URLs:</p>\n\n<pre><code>GET http://backend.dev/widget       # listing of widgets\nGET http://backend.dev/widget/1     # Read for widget id: 1\nPOST http://backend.dev/widget      # Create new widget\nUPDATE http://backend.dev/widget/1  # Update widget id: 1\nDELETE http://backend.dev/widget/1  # Destroy widget id: 1\n</code></pre>\n\n<p>then in your front-end app you could declare an Active Resource like this:</p>\n\n<pre><code>class Widget &lt; ActiveResource::Base\n  self.site = \"http://backend.dev\"\nend\n</code></pre>\n\n<p>which will auto-magically access all of those methods in your API, and behave much like a regular Active Record model.  That way, you basically design your front-end app like a \"normal\" rails app, but using ActiveResource-based models in place of ActiveRecord.</p>\n\n<p>I would note, however, that a more common thing to do these days would be to build your API in Rails, and build your front-end with client-side Javascript, using something like JQuery or Angular to make requests from the API.  I'm not sure what you're gaining by splitting API and front-end, where both of them are Rails apps - unless you've got a compelling reason, I'd just build one Rails app that handles both API and front-end, or build a Rails API + Angular (or similar) front-end.</p>\n"}], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 46802060, "answer_count": 1, "score": 2, "last_activity_date": 1508300392, "creation_date": 1508293737, "question_id": 46801920, "link": "https://stackoverflow.com/questions/46801920/how-to-connect-2-rails-5-apps-together-api-rails-and-front-end-rails-as-well", "title": "How to connect 2 rails 5 apps together API (rails) and front-end (rails as well)", "body": "<p>As i mentioned on the question title, I want to know the best approach to get this to work and i'll need and example ( very simple one as the follow: )</p>\n\n<p>Let's say i have an API which has 1 controller and 1 action for example simplicity</p>\n\n<pre><code>root 'main#index'\n</code></pre>\n\n<p>and inside the index action i have</p>\n\n<pre><code>def index\n  @date = Data.today\nend\n</code></pre>\n\n<p>Then i have another rails app which will work for front-end rendering </p>\n\n<p><br></p>\n\n<p>How can i pass this @date as JSON from the API to the other app to render it ?</p>\n\n<p>Should i have same controller on the other app ?</p>\n\n<p>How can i connect and send http request and receive response ?\n<br></p>\n\n<p><br></p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "is_accepted": true, "score": 0, "last_activity_date": 1508309021, "creation_date": 1508309021, "answer_id": 46804207, "question_id": 46801884, "link": "https://stackoverflow.com/questions/46801884/install-specific-ruby-version-into-vendor-bundle/46804207#46804207", "title": "Install specific ruby version into vendor/bundle?", "body": "<p>Bundler uses the value from <code>RbConfig::CONFIG[\"ruby_version\"]</code> to build the directory for the gems (see <a href=\"https://github.com/bundler/bundler/blob/master/lib/bundler/installer/standalone.rb#L38\" rel=\"nofollow noreferrer\">https://github.com/bundler/bundler/blob/master/lib/bundler/installer/standalone.rb#L38</a>).  </p>\n\n<p>This <code>\"ruby_version\"</code> does not care for teeny_version value and only ever outputs the Major.Minor versions.<br>\nThat leads to<br>\n2.2.x -> 2.2.0<br>\n2.3.x -> 2.3.0<br>\n2.4.x -> 2.4.0<br>\nand so on.  </p>\n\n<p>I do not now why the teeny_version does get ignored. I do know, that you could use <code>--with-ruby-version=2.4.1</code> do set the value yourself.</p>\n"}], "owner": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 46804207, "answer_count": 1, "score": 1, "last_activity_date": 1508309021, "creation_date": 1508293394, "question_id": 46801884, "link": "https://stackoverflow.com/questions/46801884/install-specific-ruby-version-into-vendor-bundle", "title": "Install specific ruby version into vendor/bundle?", "body": "<p>In my Gemfile I have specified <code>ruby 2.2.7</code> however when I do:</p>\n\n<pre><code>bundle install --path vendor/bundle\n</code></pre>\n\n<p>I can see that ruby 2.2.0 installed:</p>\n\n<p><a href=\"https://i.stack.imgur.com/V7xpc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V7xpc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Although, I also checked rvm which indicates ruby 2.2.7 selected:</p>\n\n<pre><code>rvm list                           \n\nrvm rubies\n\n * ext-ruby-2.2.1 [ missing bin/ruby ]\n   ruby-1.9.3-p551 [ x86_64 ]\n   ruby-2.1.5 [ x86_64 ]\n   ruby-2.2.2 [ x86_64 ]\n=&gt; ruby-2.2.7 [ x86_64 ]\n   ruby-2.3.1 [ x86_64 ]\n</code></pre>\n\n<p>And gemset:</p>\n\n<pre><code>rvm gemset list                    \n\ngemsets for ruby-2.2.7 (found in /Users/Apple/.rvm/gems/ruby-2.2.7)    (default)\n=&gt; myapp    global\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["css", "ruby", "sinatra"], "comments": [{"owner": {"reputation": 177, "user_id": 3016184, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029927251/picture?type=large", "display_name": "SirUncleCid", "link": "https://stackoverflow.com/users/3016184/sirunclecid"}, "edited": false, "score": 0, "creation_date": 1508291913, "post_id": 46801673, "comment_id": 80550135, "body": "The problem is that those URLs are being mapped to whatever routes are in your application.  <a href=\"https://stackoverflow.com/questions/5055489/sinatra-static-assets-are-not-found-when-using-rackup\" title=\"sinatra static assets are not found when using rackup\">stackoverflow.com/questions/5055489/&hellip;</a>  Use google before posting here.  I&#39;m surprised this even works on your local machine though."}, {"owner": {"reputation": 133, "user_id": 3597938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b004b967ebc3bb5fd7f0395153ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "user5428", "link": "https://stackoverflow.com/users/3597938/user5428"}, "reply_to_user": {"reputation": 177, "user_id": 3016184, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029927251/picture?type=large", "display_name": "SirUncleCid", "link": "https://stackoverflow.com/users/3016184/sirunclecid"}, "edited": false, "score": 0, "creation_date": 1509326313, "post_id": 46801673, "comment_id": 80960504, "body": "@SirUncleCid I added the     map &quot;/public&quot; do run Rack::Directory.new(&quot;./public&quot;) end to my config.ru but still doesn&#39;t work on Heroku :("}], "owner": {"reputation": 133, "user_id": 3597938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b004b967ebc3bb5fd7f0395153ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "user5428", "link": "https://stackoverflow.com/users/3597938/user5428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508291712, "creation_date": 1508291712, "question_id": 46801673, "link": "https://stackoverflow.com/questions/46801673/sinatra-app-doesnt-load-imges-on-heroku", "title": "Sinatra App doesnt load Imges on Heroku", "body": "<p>My Sinatra app loads the images fine on Localhost but not when I deploy it to Heroku. I have a Public folder and then an img folder under that where all the images are stored. In the erb file I have </p>\n\n<pre><code>&lt;img id=\"monkey\" src=\"/img/photo1.jpg\" alt=\"test\" &gt;\n</code></pre>\n\n<p>and in the css section on the erb file I have</p>\n\n<pre><code>background: url(/img/photo1.jpg)\n</code></pre>\n\n<p>What is wrong with this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "refactoring"], "answers": [{"tags": [], "owner": {"reputation": 452, "user_id": 6753239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lmxqq.jpg?s=128&g=1", "display_name": "mingca", "link": "https://stackoverflow.com/users/6753239/mingca"}, "is_accepted": false, "score": 0, "last_activity_date": 1508293461, "last_edit_date": 1508293461, "creation_date": 1508293072, "answer_id": 46801850, "question_id": 46801522, "link": "https://stackoverflow.com/questions/46801522/the-correct-way-to-implement-query-objects-for-similar-ar-queries/46801850#46801850", "title": "The correct way to implement Query objects for similar AR queries", "body": "<pre><code>def questions_attempted_for_query(user_id, question_group_ids)\n  UserAnswer\n          .joins('INNER JOIN question_group_questions ON user_answers.question_id = question_group_questions.question_id')\n          .group('question_group_questions.question_group_id')\n          .where(question_group_questions: { question_group_id: question_group_ids })\n          .where(user_answers: { user_id: user_id })\nend\ndef questions_mastered_for(user_id, question_group_ids)\n  res = questions_attempted_for_query(user_id, question_group_ids)\n          .joins('INNER JOIN marks ON user_answers.id = marks.user_answer_id')\n          .where(\"(marks.boolean_mark_correct = true AND marks.mark_type = 'boolean') OR (marks.fraction_numerator = marks.fraction_denominator AND marks.mark_type = 'fraction')\")\n          .pluck('question_group_questions.question_group_id', 'COUNT(DISTINCT(user_answers.question_id))')\n\n  question_group_mastery = {}\n  question_group_ids.each { |question_group_id| question_group_mastery[question_group_id] = 0 }\n  res.each { |data| question_group_mastery[data.first] = data.second }\n\n  question_group_mastery\nend\n\ndef questions_attempted_for(user_id, question_group_ids)\n  res = questions_attempted_for_query(user_id, question_group_ids)\n          .pluck('question_group_questions.question_group_id', 'COUNT(DISTINCT(user_answers.question_id))')\n\n  question_group_attempted = {}\n  question_group_ids.each { |question_group_id| question_group_attempted[question_group_id] = 0 }\n  res.each { |data| question_group_attempted[data.first] = data.second }\n\n  question_group_attempted\nend\n</code></pre>\n"}], "owner": {"reputation": 930, "user_id": 4736604, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-RU6SxgHXnz4/AAAAAAAAAAI/AAAAAAAABRU/Vz1rrCw9VMQ/photo.jpg?sz=128", "display_name": "Martin Valentino", "link": "https://stackoverflow.com/users/4736604/martin-valentino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508293461, "creation_date": 1508290318, "last_edit_date": 1508290703, "question_id": 46801522, "link": "https://stackoverflow.com/questions/46801522/the-correct-way-to-implement-query-objects-for-similar-ar-queries", "title": "The correct way to implement Query objects for similar AR queries", "body": "<p>I have two methods in my rails app model.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def questions_mastered_for(user_id, question_group_ids)\n  res = UserAnswer\n          .joins('INNER JOIN question_group_questions ON user_answers.question_id = question_group_questions.question_id')\n          .joins('INNER JOIN marks ON user_answers.id = marks.user_answer_id')\n          .group('question_group_questions.question_group_id')\n          .where(question_group_questions: { question_group_id: question_group_ids })\n          .where(user_answers: { user_id: user_id })\n          .where(\"(marks.boolean_mark_correct = true AND marks.mark_type = 'boolean') OR (marks.fraction_numerator = marks.fraction_denominator AND marks.mark_type = 'fraction')\")\n          .pluck('question_group_questions.question_group_id', 'COUNT(DISTINCT(user_answers.question_id))')\n\n  question_group_mastery = {}\n  question_group_ids.each { |question_group_id| question_group_mastery[question_group_id] = 0 }\n  res.each { |data| question_group_mastery[data.first] = data.second }\n\n  question_group_mastery\nend\n\ndef questions_attempted_for(user_id, question_group_ids)\n  res = UserAnswer\n          .joins('INNER JOIN question_group_questions ON user_answers.question_id = question_group_questions.question_id')\n          .group('question_group_questions.question_group_id')\n          .where(question_group_questions: { question_group_id: question_group_ids })\n          .where(user_answers: { user_id: user_id })\n          .pluck('question_group_questions.question_group_id', 'COUNT(DISTINCT(user_answers.question_id))')\n\n  question_group_attempted = {}\n  question_group_ids.each { |question_group_id| question_group_attempted[question_group_id] = 0 }\n  res.each { |data| question_group_attempted[data.first] = data.second }\n\n  question_group_attempted\nend\n</code></pre>\n\n<p>If we can see from above methods, both do almost similar query the only difference is in <code>questions_mastered_for</code> there is additional join and where condition to <code>marks</code> table.</p>\n\n<p>I read some articles that this particular use case usually can be resolved using Query Object, but I wonder how to implement it correctly?</p>\n\n<p>Any suggestions I kindly appreciate.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "time", "rails-activerecord"], "comments": [{"owner": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "edited": false, "score": 0, "creation_date": 1508284379, "post_id": 46800828, "comment_id": 80548477, "body": "This might be a time zone thing. Did you check the value you get against UTC timestamp ? You might be saving the time in <code>UTC</code> and retrieving it <code>GMT</code>?"}, {"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "reply_to_user": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "edited": false, "score": 0, "creation_date": 1508285074, "post_id": 46800828, "comment_id": 80548643, "body": "@Cyzanfar - See update, same thing in UTC. (Anyway, time zones differences would not affect seconds/milliseconds right?)"}, {"owner": {"reputation": 6178, "user_id": 3307520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jWlYC.jpg?s=128&g=1", "display_name": "Cyzanfar", "link": "https://stackoverflow.com/users/3307520/cyzanfar"}, "edited": false, "score": 0, "creation_date": 1508285188, "post_id": 46800828, "comment_id": 80548661, "body": "Right it shouldn\u2019t affect it... let me do some research on my end. Let me know if and when you find a solution. It\u2019s an interesting problem."}, {"owner": {"reputation": 1504, "user_id": 3536450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7d9026d96e8a5733927cb70c20010a1?s=128&d=identicon&r=PG", "display_name": "dfherr", "link": "https://stackoverflow.com/users/3536450/dfherr"}, "edited": false, "score": 0, "creation_date": 1508605356, "post_id": 46800828, "comment_id": 80678916, "body": "i tried to reproduce it on my tech stack and can tell you, this is not happening on Rails 5.1.1, ruby 2.4.1, psql 9.6.3 (all running inside docker containers)"}, {"owner": {"reputation": 740, "user_id": 5673242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd127bacb8132d2d7297989828d3086?s=128&d=identicon&r=PG&f=1", "display_name": "jpn", "link": "https://stackoverflow.com/users/5673242/jpn"}, "edited": false, "score": 0, "creation_date": 1508609389, "post_id": 46800828, "comment_id": 80680296, "body": "I also tried to reproduce this but couldn&#39;t! Maybe it&#39;d help to publish a tiny app that fully reproduces this, so people can look into it?"}, {"owner": {"reputation": 1504, "user_id": 3536450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7d9026d96e8a5733927cb70c20010a1?s=128&d=identicon&r=PG", "display_name": "dfherr", "link": "https://stackoverflow.com/users/3536450/dfherr"}, "edited": false, "score": 0, "creation_date": 1508609590, "post_id": 46800828, "comment_id": 80680368, "body": "i also couldn&#39;t reproduce this using ruby 2.3.0, rails 4.2.6 and the lowest pg gem minor version that works with this (0.15.1), though I didn&#39;t change the database from 9.6.3 to 9.5 yet. More information needed."}, {"owner": {"reputation": 1504, "user_id": 3536450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7d9026d96e8a5733927cb70c20010a1?s=128&d=identicon&r=PG", "display_name": "dfherr", "link": "https://stackoverflow.com/users/3536450/dfherr"}, "edited": false, "score": 0, "creation_date": 1508665424, "post_id": 46800828, "comment_id": 80692397, "body": "also not reproduceable with postgres 9.5.0 in ruby2.3.0 and rails 4.2.6."}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 1, "creation_date": 1508755520, "post_id": 46800828, "comment_id": 80721938, "body": "Possible some other gem used causing the issue?"}], "answers": [{"comments": [{"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 0, "creation_date": 1508602901, "post_id": 46859357, "comment_id": 80678111, "body": "This is not a time zone issue. The question is about the discrepancy in milliseconds, not hours."}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "reply_to_user": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 0, "creation_date": 1508622798, "post_id": 46859357, "comment_id": 80684185, "body": "Have you tried storing the timestamp in milliseconds (*1000) and then Time.at(ts/1000) ? I have noticed too sometimes apparently random values get rounded to integers (or, well, not so much integers considering they would still have a trailing .00001 or something when cast to_f)"}], "tags": [], "owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "is_accepted": false, "score": -2, "last_activity_date": 1508551039, "creation_date": 1508551039, "answer_id": 46859357, "question_id": 46800828, "link": "https://stackoverflow.com/questions/46800828/storing-time-with-milliseconds-in-rails/46859357#46859357", "title": "Storing time with milliseconds in Rails", "body": "<p>Check the database/table time zone vs Rails time zone vs system time zone, looks like you have a 5 hours difference between what you save and what it returns, which appears to correspond to the difference between UTC and EST.</p>\n"}, {"comments": [{"owner": {"reputation": 2366, "user_id": 2876134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b732ddf9b8ccefd8ddba85c9a33447?s=128&d=identicon&r=PG&f=1", "display_name": "Cong Chen", "link": "https://stackoverflow.com/users/2876134/cong-chen"}, "edited": false, "score": 0, "creation_date": 1508663020, "post_id": 46872174, "comment_id": 80691713, "body": "I couldn&#39;t reproduce the issue too."}, {"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 0, "creation_date": 1508701521, "post_id": 46872174, "comment_id": 80703930, "body": "@itsnikolay Sure enough, I just tried reproducing this issue in a new rails app <i>with the exact same rails/ruby/postgres versions</i> as my current app, and could not do it! Looks like I will need to dig further to try to isolate what is causing this.."}, {"owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "reply_to_user": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 0, "creation_date": 1508749932, "post_id": 46872174, "comment_id": 80718529, "body": "@Yarin try to debug, step by step by adding each gem from your app Gemfile in my example app Gemfile ^^. Because some gems can patch datetime for own purposes. If you won&#39;t be able reproduce it with the full list of gems, so you should start looking the issue in your code (start searching from config/initializers etc, down to trace)."}, {"owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "edited": false, "score": 1, "creation_date": 1508762793, "post_id": 46872174, "comment_id": 80726585, "body": "That&#39;s exactly what I did- culprit found: <a href=\"https://stackoverflow.com/a/46889747/165673\">stackoverflow.com/a/46889747/165673</a>. Thanks for your help!"}], "tags": [], "owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "is_accepted": false, "score": 2, "last_activity_date": 1508662211, "creation_date": 1508662211, "answer_id": 46872174, "question_id": 46800828, "link": "https://stackoverflow.com/questions/46800828/storing-time-with-milliseconds-in-rails/46872174#46872174", "title": "Storing time with milliseconds in Rails", "body": "<p>I couldn't reproduce the issue with Rails <code>4.2.6</code> and <code>5.0.5</code> (and Ruby <code>2.3.1</code>, Postgres <code>9.6.4</code>)</p>\n\n<pre><code># Gemfile\nruby '2.3.1'\ngem 'rails', '4.2.6'\ngem 'pg'\nrequire 'active_record'\n\n# example.rb\nclass Record &lt; ActiveRecord::Base\n  establish_connection \\\n    adapter:  'postgresql',\n    database: 'try_timestamp',\n    username: 'postgres'\n\n  connection.create_table table_name, force: true do |t|\n    t.datetime :time_stamp\n  end\nend\n\ntime_stamp = Time.utc 2017,1,1,1,1,1.35\nrecord     = Record.new time_stamp: time_stamp\n\np record.time_stamp.strftime('%H:%M:%S.%L')\np record.time_stamp.usec\np record.time_stamp.to_f\n\nrecord.save!\nrecord.reload\n\np record.time_stamp.strftime('%H:%M:%S.%L')\np record.time_stamp.usec\np record.time_stamp.to_f\n\n\n# terminal command\n\u276f createdb try_timestamp\n\u276f bundle install\n\u276f bundle exec ruby example.rb\n\"01:01:01.350\"\n350000\n1483232461.35\n\"01:01:01.350\"\n350000\n1483232461.3500001\n</code></pre>\n\n<p>Could you run this example and tell whether the issue reproduces on clear rails app?</p>\n"}, {"tags": [], "owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "is_accepted": true, "score": 1, "last_activity_date": 1508762729, "creation_date": 1508762729, "answer_id": 46889747, "question_id": 46800828, "link": "https://stackoverflow.com/questions/46800828/storing-time-with-milliseconds-in-rails/46889747#46889747", "title": "Storing time with milliseconds in Rails", "body": "<p>This was being caused by the <a href=\"https://github.com/rbur004/vincenty\" rel=\"nofollow noreferrer\">vincenty gem</a>. Caveat emptor...</p>\n"}], "owner": {"reputation": 142412, "user_id": 165673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e43e620f96a26bf6ee7fa70750c0302a?s=128&d=identicon&r=PG", "display_name": "Yarin", "link": "https://stackoverflow.com/users/165673/yarin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1887, "favorite_count": 1, "accepted_answer_id": 46889747, "answer_count": 3, "score": 4, "last_activity_date": 1508762729, "creation_date": 1508284241, "last_edit_date": 1508713723, "question_id": 46800828, "link": "https://stackoverflow.com/questions/46800828/storing-time-with-milliseconds-in-rails", "title": "Storing time with milliseconds in Rails", "body": "<p>I'm trying to store a time stamp with millisecond precision in Rails, but the value gets jacked up when I retrieve the record from the DB:</p>\n\n<pre><code>record.time_stamp = Time.utc(2017,1,1,1,1,1.35)\n</code></pre>\n\n<p>Check time before saving:</p>\n\n<pre><code>record.time_stamp.strftime('%H:%M:%S.%L')\n=&gt; \"01:01:01.350\" \nrecord.time_stamp.usec\n=&gt; 350000\nrecord.time_stamp.to_f\n=&gt; 1483232461.35\n</code></pre>\n\n<p>Save and reload:</p>\n\n<pre><code>record.save!\nrecord.reload\n</code></pre>\n\n<p>Check time after saving:</p>\n\n<pre><code>record.time_stamp.strftime('%H:%M:%S.%L')\n=&gt; \"01:01:01.006\"\nrecord.time_stamp.usec\n=&gt; 6108\nrecord.time_stamp.to_f\n=&gt; 1483232461.0061078\nrecord.read_attribute_before_type_cast(\"time_stamp\") // Read raw value before type casting\n=&gt; \"2017-01-01 01:01:01.35\"\n</code></pre>\n\n<p>Not sure what's happening here. The millisecond value stored in the DB is correct, as is the raw value before type-casting (see last line), it's just screwed up when cast back into Ruby Time.</p>\n\n<p><strong>NOTES:</strong>  </p>\n\n<ul>\n<li>I realize that <a href=\"http://blog.solanolabs.com/rails-time-comparisons-devil-details-etc/\" rel=\"nofollow noreferrer\">Ruby Time is precise to nanoseconds, while the DB is only precise to microseconds</a> - but I'm just trying to save milliseconds, so that should not be a factor.</li>\n<li>This is not a time zone issue. </li>\n</ul>\n\n<p>(<strong>Specs:</strong> Rails/ActiveRecord 4.2.6, ruby 2.3.0, Postgres 9.5.0, OSX)</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong><br>\nI just tried reproducing this issue in a new rails app with the exact same rails/ruby/postgres versions as my current app, and could not do it! And since others have also not been able to reproduce, it means this is something clearly specific to my app, and I will need to dig further to try to isolate what is causing this... Will update when I have more info.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1508282690, "post_id": 46800507, "comment_id": 80548090, "body": "When designing an interface, a private method can be used to indicate that the method is unstable and should not be used directly by an object."}, {"owner": {"reputation": 462, "user_id": 8706204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kaBHD.png?s=128&g=1", "display_name": "Pend", "link": "https://stackoverflow.com/users/8706204/pend"}, "edited": false, "score": 0, "creation_date": 1508287230, "post_id": 46800507, "comment_id": 80549116, "body": "It&#39;s doesn&#39;t maintain full use of the send method, and sets off a warning message, but here is an example of overriding the send method to prevent access to a private method: <a href=\"https://stackoverflow.com/questions/20639857/how-to-disable-a-certain-method-in-ruby-from-being-called-in-the-console\">link</a>"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508287396, "post_id": 46800507, "comment_id": 80549145, "body": "You will need to override a lot of things... <a href=\"https://stackoverflow.com/questions/5349624/how-to-call-methods-dynamically-based-on-their-name/26284769#26284769\" title=\"how to call methods dynamically based on their name\">stackoverflow.com/questions/5349624/&hellip;</a> You may be able to do a cheap check regarding the caller..."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508287483, "post_id": 46800507, "comment_id": 80549164, "body": "FWIW, you might have better luck with &quot;Is there anyway to reliably prevent objects from being able to call certain methods?&quot; as the title of the question, and edit your question to comply with the theme. Of course, then it is probably just a dupe of <a href=\"https://stackoverflow.com/questions/20639857/how-to-disable-a-certain-method-in-ruby-from-being-called-in-the-console\" title=\"how to disable a certain method in ruby from being called in the console\">stackoverflow.com/questions/20639857/&hellip;</a>. As it is right now, it is broad and opinion based..."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1508287620, "post_id": 46800507, "comment_id": 80549194, "body": "Better that they can be called, anyway, otherwise the stymied programmer will simply copy/paste the code into the new location. Then you would have two problems..."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1508293887, "creation_date": 1508293887, "answer_id": 46801931, "question_id": 46800507, "link": "https://stackoverflow.com/questions/46800507/why-can-i-call-private-methods-via-objectsend-but-not-directly-call-said-metho/46801931#46801931", "title": "Why can I call private methods via Object#send, but not directly call said methods?", "body": "<ul>\n<li>Why can I call a private method via Object#send(:private_method)?</li>\n</ul>\n\n<p>Look carefully at what you did:</p>\n\n<pre><code>me.send(:private_say_hi)\n</code></pre>\n\n<p>In nowhere the method <code>private_say_hi</code> is called in the form:</p>\n\n<pre><code>me.private_say_hi\n</code></pre>\n\n<p>That is why. Isn't is obvious?</p>\n\n<ul>\n<li>What is the purpose of Ruby's private keyword if not to prevent direct calling of certain methods?</li>\n</ul>\n\n<p>Just as the definition says. To avoid being called with an explicit receiver.</p>\n\n<ul>\n<li>Is there anyway to reliably prevent objects from being able to call certain methods?</li>\n</ul>\n\n<p>Use <code>undef</code>, <code>undef_method</code>, or <code>remove_method</code> depending on you needs.</p>\n"}], "owner": {"reputation": 139, "user_id": 4459046, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee26b9e1d691d7651567e5e5447e7edc?s=128&d=identicon&r=PG&f=1", "display_name": "avtomate", "link": "https://stackoverflow.com/users/4459046/avtomate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 46801931, "answer_count": 1, "score": 1, "last_activity_date": 1508293887, "creation_date": 1508281599, "last_edit_date": 1508282498, "question_id": 46800507, "link": "https://stackoverflow.com/questions/46800507/why-can-i-call-private-methods-via-objectsend-but-not-directly-call-said-metho", "title": "Why can I call private methods via Object#send, but not directly call said methods?", "body": "<p>Why can I call a private method via <code>Object#send(:private_method)</code>?  </p>\n\n<p>What is the purpose of Ruby's <code>private</code> keyword if not to prevent direct calling of certain methods?  </p>\n\n<p>Is there anyway to reliably prevent objects from being able to call certain methods?</p>\n\n<pre><code>class Person\n  def say_hi\n    \"hi\"\n  end\n\n  private\n  def private_say_hi\n    \"private hi\"\n  end\nend\n\nme = Person.new\nme.say_hi\n#=&gt; \"hi\"\n\nme.private_say_hi\n#Error: private method `private_say_hi' called for #&lt;Person:0x00558df4b79a08&gt;\n\nme.send(:private_say_hi)\n#=&gt; \"private hi\"\n</code></pre>\n"}, {"tags": ["ruby", "average", "reduce", "infinity"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 1, "creation_date": 1508281572, "post_id": 46800418, "comment_id": 80547801, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and let us know exactly what line the warning is happening on."}, {"owner": {"reputation": 591, "user_id": 4263666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jgHSA.png?s=128&g=1", "display_name": "forgetaboutme", "link": "https://stackoverflow.com/users/4263666/forgetaboutme"}, "reply_to_user": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1508281664, "post_id": 46800418, "comment_id": 80547820, "body": "warning happens on the following line <code>values.reduce(:+).to_f &#47; values.size</code>."}, {"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 1, "creation_date": 1508283202, "post_id": 46800418, "comment_id": 80548184, "body": "Stick a breakpoint after the <code>end</code> on line 7 and see what <code>values</code> looks like."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508303524, "post_id": 46800418, "comment_id": 80552992, "body": "Dividing by zero is a good way to break things pretty quickly. If that&#39;s an empty array..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508303565, "post_id": 46800418, "comment_id": 80553004, "body": "Pro tip: If you have an array that maps 1:1 to the arguments of a function, splat it out. <code>Stock.new(*stock)</code> is way less messy."}], "answers": [{"comments": [{"owner": {"reputation": 591, "user_id": 4263666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jgHSA.png?s=128&g=1", "display_name": "forgetaboutme", "link": "https://stackoverflow.com/users/4263666/forgetaboutme"}, "edited": false, "score": 1, "creation_date": 1508367898, "post_id": 46803278, "comment_id": 80588511, "body": "Thank you for providing a clear example. I could manage to find the error; whenever creating a new stock, the volume would be stored as a string. Using <a href=\"https://apidock.com/ruby/String/to_f\" rel=\"nofollow noreferrer\">to_f</a> on the string therefore converting it to a float fixed this issue."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1508303900, "creation_date": 1508303900, "answer_id": 46803278, "question_id": 46800418, "link": "https://stackoverflow.com/questions/46800418/infinity-is-returned-when-calculating-average-in-array/46803278#46803278", "title": "Infinity is returned when calculating average in array", "body": "<p>When writing average functions you'll want to pay close attention to the possibility of division by zero.</p>\n\n<p>Here's a fixed and more Ruby-like implementation:</p>\n\n<pre><code>def self.average_volume(stocks)\n  # No data in means no data out, can't calculate.\n  return if (stocks.empty?)\n\n  # Pick out the `volume` value from each stock, then combine\n  # those with + using 0.0 as a default. This forces all of\n  # the subsequent values to be floating-point.\n  stocks.map(&amp;:volume).reduce(0.0, &amp;:+) / values.size\nend\n</code></pre>\n\n<p>In Ruby it's strongly recommended to keep variable and method names in the <code>x_y</code> form, like <code>average_volume</code> here. Capitals have significant meaning and indicate constants like class, module and constant names.</p>\n\n<p>You can test this method using a mock Stock:</p>\n\n<pre><code>require 'ostruct'\n\nstocks = 10.times.map do |n|\n  OpenStruct.new(volume: n)\nend\n\naverage_volume(stocks)\n# =&gt; 4.5\naverage_volume([ ])\n# =&gt; nil\n</code></pre>\n\n<p>If you're still getting infinity it's probably because you have a broken value somewhere in there for <code>volume</code> which is messing things up. You can try and filter those out:</p>\n\n<pre><code>stocks.map(&amp;:value).reject(&amp;:nan?)...\n</code></pre>\n\n<p>Where testing vs. <code>nan?</code> might be what you need to strip out junk data.</p>\n"}], "owner": {"reputation": 591, "user_id": 4263666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jgHSA.png?s=128&g=1", "display_name": "forgetaboutme", "link": "https://stackoverflow.com/users/4263666/forgetaboutme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 46803278, "answer_count": 1, "score": 0, "last_activity_date": 1508303900, "creation_date": 1508280905, "last_edit_date": 1508281760, "question_id": 46800418, "link": "https://stackoverflow.com/questions/46800418/infinity-is-returned-when-calculating-average-in-array", "title": "Infinity is returned when calculating average in array", "body": "<p>Why does the following method return infinity when trying to find the average volume of a stock:</p>\n\n<pre><code>class Statistics\n\n    def self.averageVolume(stocks)\n        values = Array.new\n        stocks.each do |stock|\n            values.push(stock.volume)\n        end\n        values.reduce(:+).to_f / values.size\n    end\n\nend\n\nclass Stock\n    attr_reader :date, :open, :high, :low, :close, :adjusted_close, :volume\n    def initialize(date, open, high, low, close, adjusted_close, volume)\n        @date = date\n        @open = open\n        @high = high\n        @low = low\n        @close = close\n        @adjusted_close = adjusted_close\n        @volume = volume\n    end\n\n    def close\n        @close\n    end\n\n    def volume\n        @volume\n    end\nend\n\nCSV.foreach(fileName) do |stock|\n    entry = Stock.new(stock[0], stock[1], stock[2], stock[3], stock[4], stock[5], stock[6])\n    stocks.push(entry)\nend\n</code></pre>\n\n<p>Here is how the method is called:</p>\n\n<pre><code>Statistics.averageVolume(stocks)\n</code></pre>\n\n<p>Output to console using a file that has 251 rows:</p>\n\n<pre><code>stock.rb:32: warning: Float 23624900242507002003... out of range\nInfinity\n</code></pre>\n\n<p>Warning is called on the following line: <code>values.reduce(:+).to_f / values.size</code></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "edited": false, "score": 0, "creation_date": 1508278379, "post_id": 46799942, "comment_id": 80546917, "body": "Well I tried what you suggest but does not work. I still receive my html surrounded by a textarea (don&#39;t know where is coming from). I could not understand the different behaviour in case of success and failure. I updated the question with the output of the console.log(data)"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "edited": false, "score": 0, "creation_date": 1508279209, "post_id": 46799942, "comment_id": 80547174, "body": "I suspect the textarea is coming from a layout (since there also seems to be <code>head</code>, etc.). If you just want the partial (and nothing from a layout), you&#39;ll need to render with <code>layout: false</code>"}, {"owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "edited": false, "score": 0, "creation_date": 1508279390, "post_id": 46799942, "comment_id": 80547223, "body": "I found the problem it is related to remotipart gem, in case of success wrap the response in a text area don&#39;t know why. Here the link: <a href=\"https://github.com/JangoSteve/remotipart/issues/77#issuecomment-20843889\" rel=\"nofollow noreferrer\">github.com/JangoSteve/remotipart/issues/&hellip;</a>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "edited": false, "score": 0, "creation_date": 1508279565, "post_id": 46799942, "comment_id": 80547281, "body": "Cool. Nice sleuthing. Sorry I couldn&#39;t help."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1508277890, "creation_date": 1508277890, "answer_id": 46799942, "question_id": 46799792, "link": "https://stackoverflow.com/questions/46799792/xhr-as-string-not-object-returned-from-the-rails-controller/46799942#46799942", "title": "XHR as string not object returned from the rails controller", "body": "<p>I <em>think</em> you want that <code>.on('ajax:success'...){...}</code> to look more like:</p>\n\n<pre><code>$(document).on('ajax:success', '#upload_contract', function(evt, data, status, xhr){\n    $(\"#contract_space\").html(data);\n    console.log(data);\n    console.log(evt);\n});\n</code></pre>\n\n<p>Where <code>data</code> will be HTML from the rendered partial.</p>\n"}], "owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508279458, "creation_date": 1508277084, "last_edit_date": 1508279458, "question_id": 46799792, "link": "https://stackoverflow.com/questions/46799792/xhr-as-string-not-object-returned-from-the-rails-controller", "title": "XHR as string not object returned from the rails controller", "body": "<p>[EDIT SOLVED] I solved the problem it was an issue related to a remotipart gem. I used the following link: <a href=\"https://github.com/JangoSteve/remotipart/issues/77#issuecomment-20843889\" rel=\"nofollow noreferrer\">https://github.com/JangoSteve/remotipart/issues/77#issuecomment-20843889</a></p>\n\n<p>I have this portion of code in my controller:</p>\n\n<pre><code>    if @contract.update_attributes(contract_params)\n      Rails.logger.info(\"Contratto aggiornato con successo\")\n      respond_to do |format|\n        format.js {render partial: 'contracts/success', status: 200}\n      end\n    else\n      @errors=@contract.errors\n\n      respond_to do |format|\n        # format.js { render 'strutturas/edit' }\n        format.js {render partial: '/pages/shared/form_error', status: :unprocessable_entity, :locals =&gt; { :errors =&gt; @errors }}\n      end\n\n      Rails.logger.error(\"Problema nel salvataggio del contratto\")\n    end\n</code></pre>\n\n<p>This is the javascript:</p>\n\n<pre><code>$(document).on('ajax:error', '#upload_contract', function(evt, xhr, status, error) {\n    $(\"#form_error\").html(xhr.responseText);\n    console.log(\"Errore\");\n    console.log(xhr);\n});\n\n\n$(document).on('ajax:success', '#upload_contract', function(evt, xhr, status, error){\n    $(\"#contract_space\").html(xhr.responseText);\n    console.log(xhr);\n    console.log(evt);\n});\n</code></pre>\n\n<p>In case the update_attributes fails no problem javascript get the xhr as an object and I can use xhr.responseText to display a message.</p>\n\n<p>I don't understand why in case of ajax success the xhr is a string and not an object so xhr.responseText is undefined.</p>\n\n<p>To me the two scenarios are the same and can't understand why they are doing different things.</p>\n\n<p>The problem is obviously in case of success because the error case is working.</p>\n\n<p>This is the log of the xhr (should be an object):</p>\n\n<pre><code>&lt;head&gt;&lt;script type=\"text/javascript\"&gt;try{window.parent.document;}catch(err){document.domain=document.domain;}&lt;/script&gt; &lt;/head&gt;&lt;body&gt;&lt;textarea data-type=\"text/javascript\" data-status=\"200\" data-statustext=\"OK\"&gt;&amp;lt;div class='col-md-10 col-md-offset-1'&amp;gt;\n  &amp;lt;div class='spacer30'&amp;gt;&amp;lt;/div&amp;gt;\n  &amp;lt;div class='alert alert-success'&amp;gt;\n    &amp;lt;strong&amp;gt;\n      Il contratto \u00e8 stato caricato con successo. I nostri operatori invieranno via email le credenziali di accesso una volta verificato il documento allegato. Per qualsiasi dubbio pu\u00f2 contattare l'assistenza SHB via email:\n      &amp;lt;a href='mailto:info@shbooking.com'&amp;gt;info@shbooking.com&amp;lt;/a&amp;gt;\n    &amp;lt;/strong&amp;gt;\n  &amp;lt;/div&amp;gt;\n&amp;lt;/div&amp;gt;\n&amp;lt;spacer50&amp;gt;&amp;lt;/spacer50&amp;gt;\n&lt;/textarea&gt;&lt;/body&gt;\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 14400, "user_id": 2580302, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/db72295390541fa9df9cf434bd92937d?s=128&d=identicon&r=PG", "display_name": "zetacu", "link": "https://stackoverflow.com/users/2580302/zetacu"}, "edited": false, "score": 0, "creation_date": 1508300045, "post_id": 46800022, "comment_id": 80552049, "body": "I agree this code will replace the url with whatever you need <code>string.gsub(&#47;@font-face\\s*{([\\s\\S]*?)}&#47;){ $1.gsub(&#47;url\\(&quot;(.*?)&quot;\\)&#47;){ &quot;&lt;&lt;#{$1}&gt;&gt;&quot; } }</code>"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 14400, "user_id": 2580302, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/db72295390541fa9df9cf434bd92937d?s=128&d=identicon&r=PG", "display_name": "zetacu", "link": "https://stackoverflow.com/users/2580302/zetacu"}, "edited": false, "score": 0, "creation_date": 1508332713, "post_id": 46800022, "comment_id": 80569337, "body": "@zetacu Thank you! I&#39;ve added your code to my answer under the <b>Edit</b> section (with proper citation)."}, {"owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "reply_to_user": {"reputation": 14400, "user_id": 2580302, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/db72295390541fa9df9cf434bd92937d?s=128&d=identicon&r=PG", "display_name": "zetacu", "link": "https://stackoverflow.com/users/2580302/zetacu"}, "edited": false, "score": 0, "creation_date": 1508338595, "post_id": 46800022, "comment_id": 80573456, "body": "@ctwheels and @zetacu, thanks for the help with this! There is one portion I am still struggling with - how to make the output of the final capture group only <code>&#47;&#47;fonts.example.com&#47;</code>, without the rest of the font URL? I am looking to only replace the <code>scheme</code> (i.e., <code>&#47;&#47;</code>), and an <code>hostname</code>, (i.e. - <code>fonts.example.com</code>) to create a relative URL - not the entirety new URL. So the final output of the <code>src</code> portion should resemble <code>url(&quot;.&#47;k&#47;neuefranklin.woff2&quot;) format(&quot;woff2&quot;),url(&quot;.&#47;k&#47;neuefranklin.woff&quot;) format(&quot;woff&quot;),url(&quot;.&#47;k&#47;neuefranklin.otf&quot;) format(&quot;opentype&quot;);</code>"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 0, "creation_date": 1508338845, "post_id": 46800022, "comment_id": 80573642, "body": "Use <code>url\\(&quot;(\\&#47;\\&#47;)([^\\&#47;]*?(?=\\&#47;|&quot;)).*?&quot;\\)</code>, the first capture group is the scheme, the second is the domain"}, {"owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "edited": false, "score": 0, "creation_date": 1508339257, "post_id": 46800022, "comment_id": 80573945, "body": "It&#39;s close - but it&#39;s losing the important part of the font url. I want to keep the <code>&#47;k&#47;neuefranklin.woff2</code> portions and replace the <code>scheme</code> and <code>hostname</code> only."}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "edited": false, "score": 1, "creation_date": 1508339553, "post_id": 46800022, "comment_id": 80574160, "body": "@codeadventurer then use <code>(url\\(&quot;)\\&#47;\\&#47;[^\\&#47;]*?(?=\\&#47;|&quot;)(.*?&quot;\\))</code> and replace with <code>$1something.com$2</code> where <code>something.com</code> is obviously the replacement string"}, {"owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "edited": false, "score": 0, "creation_date": 1508353348, "post_id": 46800022, "comment_id": 80582081, "body": "@ctwheels this worked for me in conjunction with your original answer. Thank you so much for your help with this!"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "edited": false, "score": 0, "creation_date": 1508354925, "post_id": 46800022, "comment_id": 80582913, "body": "You&#39;re very welcome @codeadventurer. There is another option, but I don&#39;t think it&#39;ll work in ruby, I could, however, be wrong. I&#39;ve edited my answer to include it."}], "tags": [], "owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "is_accepted": true, "score": 2, "last_activity_date": 1508354915, "last_edit_date": 1508354915, "creation_date": 1508278320, "answer_id": 46800022, "question_id": 46799753, "link": "https://stackoverflow.com/questions/46799753/regex-for-selecting-hostname-from-css-font-face-rules/46800022#46800022", "title": "Regex for selecting hostname from CSS font-face rules", "body": "<h1>Answer</h1>\n\n<h2>Brief</h2>\n\n<p>Unfortunately, there's no direct way to do this with regex. What you can do, however, is use a workaround to determine where each <code>@font-face</code> is located and then find any urls within them.</p>\n\n<hr>\n\n<h2>Code</h2>\n\n<p><strong>Step 1:</strong> Get each <code>@font-face</code> content into capture group 1</p>\n\n<pre><code>@font-face\\s*{([\\s\\S]*?)}\n</code></pre>\n\n<p><strong>Step 2:</strong> Find urls within the content of capture group 1 from <strong>Step 1</strong></p>\n\n<pre><code>url\\(\"(.*?)\"\\)\n</code></pre>\n\n<hr>\n\n<h2>Results</h2>\n\n<h3>Step 1</h3>\n\n<p><strong>Input</strong></p>\n\n<pre><code>@font-face {\n    font-family:\"neuefranklink\";\n    src:url(\"//fonts.example.com/k/neuefranklin.woff2\") format(\"woff2\"),url(\"//fonts.example.com/k/neuefranklin.woff\") format(\"woff\"),url(\"//fonts.example.com/k/neuefranklin.otf\") format(\"opentype\");\n    font-style:normal;\n    font-weight:900;\n}\n</code></pre>\n\n<p><strong>Output</strong> - Capture group 1</p>\n\n<pre><code>font-family:\"neuefranklink\";\nsrc:url(\"//fonts.example.com/k/neuefranklin.woff2\") format(\"woff2\"),url(\"//fonts.example.com/k/neuefranklin.woff\") format(\"woff\"),url(\"//fonts.example.com/k/neuefranklin.otf\") format(\"opentype\");\nfont-style:normal;\nfont-weight:900;\n</code></pre>\n\n<h3>Step 2</h3>\n\n<p><strong>Input</strong> = <code>Step 1</code> <strong>Output</strong></p>\n\n<p><strong>Output</strong> - Capture group 1</p>\n\n<pre><code>//fonts.example.com/k/neuefranklin.woff2\n//fonts.example.com/k/neuefranklin.woff\n//fonts.example.com/k/neuefranklin.otf\n</code></pre>\n\n<hr>\n\n<h1>Edits</h1>\n\n<h2>Edit 1</h2>\n\n<p>The code below has been provided by <a href=\"https://stackoverflow.com/users/2580302/zetacu\">zetacu</a> (see comments under this answer for original post).</p>\n\n<pre><code>string.gsub(/@font-face\\s*{([\\s\\S]*?)}/){\n    $1.gsub(/url\\(\"(.*?)\"\\)/){\n        \"&lt;&lt;#{$1}&gt;&gt;\"\n    }\n}\n</code></pre>\n\n<h2>Edit 2</h2>\n\n<p>There is a possibility for using a single regular expression, although, I wouldn't necessarily suggest it. There are a few things that could break this regex, then again, the same thing would break the current regex (such as <code>content: \"}\"</code>), but, depending on its usage, it may work.</p>\n\n<p><strong>Note</strong>: This regex uses PCRE regex flavour and so may not work in most regular expression engines. You can test it on <a href=\"https://regex101.com\" rel=\"nofollow noreferrer\">regex101</a></p>\n\n<pre><code>(?:@font-face\\s*{|\\G(?!\\A))[^}]*?url\\(\"(.*?)\"\\)(?=[^{]*?})\\K\n</code></pre>\n\n<p>This is a lot more complicated to explain, so I'll let regex101 do most of the explanation (copy/paste it into the <code>REGULAR EXPRESSION</code> input box and hover the tokens). If someone does want clarification on some of the tokens used or the way they are used, however, I'll be more than happy to explain them.</p>\n"}], "owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 1, "accepted_answer_id": 46800022, "answer_count": 1, "score": 1, "last_activity_date": 1508354915, "creation_date": 1508276893, "question_id": 46799753, "link": "https://stackoverflow.com/questions/46799753/regex-for-selecting-hostname-from-css-font-face-rules", "title": "Regex for selecting hostname from CSS font-face rules", "body": "<p>I'm trying to build a regex in Ruby that selects the hostname from CSS files (in order to perform a replacement with <code>gsub</code>) but am struggling to construct one that works for this use case.</p>\n\n<p>There are other URLs in the file (some are in the comments, and some are to include other CSS files within it), so it can't be overly greedy. </p>\n\n<p>I'd like to select <em>only</em> the scheme and the hostnames in the <code>src</code> <code>urls</code> of the <code>@font-face</code> rules, not URLs that are present in the comments or otherwise in the file. (i.e., I want <code>//fonts.example.com/</code> to be selected from the example below)</p>\n\n<p>Example data that the regex will be run on:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>*/\\n/* A commented out url about copyright https://example.com/copyright */\\n/*\r\n */\\n/*{\\\"last_published\\\":\\\"2017-09-19 09:55:28 UTC\\\"}*/\\n\\n@import url(\\\"https://example.com/additional.css\");\\n\\n@font-face {\\nfont-family:\\\"neuefranklink\\\";\\nsrc:url(\\\"//fonts.example.com/k/neuefranklin.woff2\\\") format(\\\"woff2\\\"),url(\\\"//fonts.example.com/k/neuefranklin.woff\\\") format(\\\"woff\\\"),url(\\\"//fonts.example.com/k/neuefranklin.otf\\\") format(\\\"opentype\\\");\\nfont-style:normal;font-weight:900;\\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I've gotten as far as this regex: <code>/(?&lt;=url\\(\\\"\\/\\/)/</code>, but it breaks past the first backslash in the scheme. If you have any solutions for this, it would be much appreciated! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "types", "type-conversion", "proc"], "comments": [{"owner": {"reputation": 880, "user_id": 3334690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b1a9715a46ee28e3151148688c0149f9?s=128&d=identicon&r=PG&f=1", "display_name": "user3334690", "link": "https://stackoverflow.com/users/3334690/user3334690"}, "edited": false, "score": 0, "creation_date": 1508277772, "post_id": 46799719, "comment_id": 80546713, "body": "Sorry, I&#39;m a little lost as to what exactly you are expecting this to do.  Maybe a couple of example inputs/outputs might help?  Also, is there a reason you&#39;ve condensed it all down to one line?  I think the problem is definitely in your x !~/\\D/.  The <code>.to_i</code> is also going to need to be a <code>.to_f</code> from the sound of it.  I think you should check out <a href=\"http://rubular.com/\" rel=\"nofollow noreferrer\">rubular.com</a> for the regex but maybe something like <code>\\d+(?:\\.\\d+)?</code> ?"}, {"owner": {"reputation": 33, "user_id": 4207570, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1586660743/picture?type=large", "display_name": "Simon \u0160tefunko", "link": "https://stackoverflow.com/users/4207570/simon-%c5%a0tefunko"}, "reply_to_user": {"reputation": 880, "user_id": 3334690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b1a9715a46ee28e3151148688c0149f9?s=128&d=identicon&r=PG&f=1", "display_name": "user3334690", "link": "https://stackoverflow.com/users/3334690/user3334690"}, "edited": false, "score": 0, "creation_date": 1508277848, "post_id": 46799719, "comment_id": 80546736, "body": "I just need this for example"}, {"owner": {"reputation": 33, "user_id": 4207570, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1586660743/picture?type=large", "display_name": "Simon \u0160tefunko", "link": "https://stackoverflow.com/users/4207570/simon-%c5%a0tefunko"}, "reply_to_user": {"reputation": 880, "user_id": 3334690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b1a9715a46ee28e3151148688c0149f9?s=128&d=identicon&r=PG&f=1", "display_name": "user3334690", "link": "https://stackoverflow.com/users/3334690/user3334690"}, "edited": false, "score": 0, "creation_date": 1508277935, "post_id": 46799719, "comment_id": 80546776, "body": "p = make_double;;; p.call(42) -&gt; 84;;; p.call(42.0) -&gt; 84.0;;; p.call(&quot;42&quot;) -&gt; &quot;84.0&quot;;;; p.call(&quot;Universe&quot;) -&gt; &quot;Universe&quot;;;;  and It must be done with Proc"}, {"owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "edited": false, "score": 0, "creation_date": 1508278783, "post_id": 46799719, "comment_id": 80547035, "body": "You can make the proc as complex as you want. It\u2019s standard to use <code>do..end</code> syntax if you want to break the proc body across multiple lines."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508327098, "post_id": 46799719, "comment_id": 80565793, "body": "@Simon\u0160tefunko did you notice that your current implementation converts integers to strings, i.e. <code>proc.call(42)</code> returns <code>&quot;84&quot;</code>, not <code>84</code>. Maybe you should fix that bug first."}], "answers": [{"comments": [{"owner": {"reputation": 880, "user_id": 3334690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b1a9715a46ee28e3151148688c0149f9?s=128&d=identicon&r=PG&f=1", "display_name": "user3334690", "link": "https://stackoverflow.com/users/3334690/user3334690"}, "edited": false, "score": 0, "creation_date": 1508339221, "post_id": 46800705, "comment_id": 80573921, "body": "What about <code>make_double.call(&quot;42.5&quot;)</code> not sure if that case matters though.  I think you can save some time too by making everything a string first too.  Something like: <code>(x.to_s =~ &#47;\\d+(?:\\.\\d+)?&#47;) ? x.to_f*2 : x</code>"}, {"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "reply_to_user": {"reputation": 880, "user_id": 3334690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b1a9715a46ee28e3151148688c0149f9?s=128&d=identicon&r=PG&f=1", "display_name": "user3334690", "link": "https://stackoverflow.com/users/3334690/user3334690"}, "edited": false, "score": 1, "creation_date": 1508364412, "post_id": 46800705, "comment_id": 80587487, "body": "@user3334690 Right ! As the OP didn&#39;t ask, I haven&#39;t tested it, and my <code>if x =~ &#47;\\d&#47;</code> is insufficient. Added a more complete answer."}], "tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 2, "last_activity_date": 1508283114, "creation_date": 1508283114, "answer_id": 46800705, "question_id": 46799719, "link": "https://stackoverflow.com/questions/46799719/ruby-proc-that-returns-numbers-and-digit-strings-multiplied-by-2-as-unchanded-ty/46800705#46800705", "title": "Ruby Proc that returns numbers and digit strings multiplied by 2 as unchanded type and text strng just returns", "body": "<p><strong>Legible</strong></p>\n\n<pre><code>puts '-- do block --'\n\ndef make_double\n    Proc.new do | x |\n        case x\n        when Integer, Float then x * 2\n        when String\n            if x =~ /\\d/\n            then (x.to_i * 2).to_s\n            else x\n            end\n        else\n            \"Invalid class #{x.class.name} for x.\"\n        end\n    end\nend\n\nputs \"42 -&gt; #{make_double.call(42)}       #{make_double.call(42).class}\"\nputs \"42.0 -&gt; #{make_double.call(42.0)}   #{make_double.call(42.0).class}\"\nputs \"'42' -&gt; #{make_double.call('42')}     #{make_double.call('42').class}\"\nputs \"'xyz' -&gt; #{make_double.call('xyz')}   #{make_double.call('xyz').class}\"\nputs \"4..8 -&gt; #{make_double.call(4..8)}\"\n</code></pre>\n\n<p>Execution :</p>\n\n<pre><code>$ ruby -w t_a.rb \n-- do block --\n42 -&gt; 84       Integer\n42.0 -&gt; 84.0   Float\n'42' -&gt; 84     String\n'xyz' -&gt; xyz   String\n4..8 -&gt; Invalid class Range for x.\n</code></pre>\n\n<p><strong>Difficult to read</strong></p>\n\n<pre><code>puts '-- brace block --'\n\ndef make_double\n    Proc.new { | x | x.is_a?(Integer) || x.is_a?(Float) ? x * 2 : \\\n        x.is_a?(String) ? x =~ /\\d/ ? (x.to_i * 2).to_s : x : 'invalid' }\nend\n\nputs \"42 -&gt; #{make_double.call(42)}       #{make_double.call(42).class}\"\nputs \"42.0 -&gt; #{make_double.call(42.0)}   #{make_double.call(42.0).class}\"\nputs \"'42' -&gt; #{make_double.call('42')}     #{make_double.call('42').class}\"\nputs \"'xyz' -&gt; #{make_double.call('xyz')}   #{make_double.call('xyz').class}\"\nputs \"4..8 -&gt; #{make_double.call(4..8)}\"\n</code></pre>\n\n<p>Execution :</p>\n\n<pre><code>$ ruby -w t.rb \n-- brace block --\n42 -&gt; 84       Integer\n42.0 -&gt; 84.0   Float\n'42' -&gt; 84     String\n'xyz' -&gt; xyz   String\n4..8 -&gt; invalid\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 1, "last_activity_date": 1508395300, "last_edit_date": 1508395300, "creation_date": 1508364110, "answer_id": 46819951, "question_id": 46799719, "link": "https://stackoverflow.com/questions/46799719/ruby-proc-that-returns-numbers-and-digit-strings-multiplied-by-2-as-unchanded-ty/46819951#46819951", "title": "Ruby Proc that returns numbers and digit strings multiplied by 2 as unchanded type and text strng just returns", "body": "<p>This answer takes into account the comment from @user3334690, and corrects wrong results for</p>\n\n<pre><code>puts \"'42xyz' -&gt; #{make_double.call('42xyz')}   #{make_double.call('42xyz').class}\"\nputs \"'x42y' -&gt; #{make_double.call('x42y')}     #{make_double.call('x42y').class}\"\nputs \"'42.5' -&gt; #{make_double.call('42.5')}    #{make_double.call('42.5').class}\"\n</code></pre>\n\n<p>which were</p>\n\n<pre><code>'42xyz' -&gt; 84   String\n'x42y' -&gt; 0     String\n'42.5' -&gt; 84    String\n</code></pre>\n\n<p><strong>One-liner</strong></p>\n\n<pre><code>puts '-- brace block 2 --'\n\ndef make_double\n    Proc.new { | x | (x.to_s =~ /\\d+(?:\\.\\d+)?/) ? x.to_f * 2 : x rescue puts \"Error\" }\nend\n\nputs \"42 -&gt; #{make_double.call(42)}           #{make_double.call(42).class}\"\nputs \"42.0 -&gt; #{make_double.call(42.0)}         #{make_double.call(42.0).class}\"\nputs \"'42' -&gt; #{make_double.call('42')}         #{make_double.call('42').class}\"\nputs \"'42xyz' -&gt; #{make_double.call('42xyz')}      #{make_double.call('42xyz').class}\"\nputs \"'x42y' -&gt; #{make_double.call('x42y')}        #{make_double.call('x42y').class}\"\nputs \"'42.5' -&gt; #{make_double.call('42.5')}       #{make_double.call('42.5').class}\"\nputs \"'42.5xyz' -&gt; #{make_double.call('42.5xyz')}    #{make_double.call('42.5xyz').class}\"\nputs \"'xyz' -&gt; #{make_double.call('xyz')}         #{make_double.call('xyz').class}\"\nputs \"4..8 -&gt; #{make_double.call(4..8)}\"\n</code></pre>\n\n<p>Execution :</p>\n\n<pre><code>$ ruby -w t_short2.rb \n-- brace block 2 --\n42 -&gt; 84.0           Float\n42.0 -&gt; 84.0         Float\n'42' -&gt; 84.0         Float\n'42xyz' -&gt; 84.0      Float\n'x42y' -&gt; 0.0        Float\n'42.5' -&gt; 85.0       Float\n'42.5xyz' -&gt; 85.0    Float\n'xyz' -&gt; xyz         String\nError\n4..8 -&gt; \n</code></pre>\n\n<p>Note that all numbers and strings containing numbers are converted to float, and 'x42y' converted to 0.0.</p>\n\n<p><strong>Keep original class</strong></p>\n\n<p>Strings mixing numbers and letters are not converted (using anchors ^ and $ in the regexp).</p>\n\n<pre><code>puts '-- do block 2 --'\n\ndef make_double\n    Proc.new do | x |\n        case x\n        when Integer, Float then x * 2\n        when String\n            case\n            when x =~ /^\\d+\\.\\d+$/ then (x.to_f * 2).to_s\n            when x =~ /^\\d+$/      then (x.to_i * 2).to_s\n            else x\n            end\n        else\n            \"Invalid class #{x.class.name} for x.\"\n        end\n    end\nend\n\nputs \"42 -&gt; #{make_double.call(42)}             #{make_double.call(42).class}\"\nputs \"42.0 -&gt; #{make_double.call(42.0)}         #{make_double.call(42.0).class}\"\nputs \"'42' -&gt; #{make_double.call('42')}           #{make_double.call('42').class}\"\nputs \"'42xyz' -&gt; #{make_double.call('42xyz')}     #{make_double.call('42xyz').class}\"\nputs \"'x42y' -&gt; #{make_double.call('x42y')}       #{make_double.call('x42y').class}\"\nputs \"'42.5' -&gt; #{make_double.call('42.5')}       #{make_double.call('42.5').class}\"\nputs \"'42.5xyz' -&gt; #{make_double.call('42.5xyz')} #{make_double.call('42.5xyz').class}\"\nputs \"'xyz' -&gt; #{make_double.call('xyz')}         #{make_double.call('xyz').class}\"\nputs \"4..8 -&gt; #{make_double.call(4..8)}\"\n</code></pre>\n\n<p>Execution :</p>\n\n<pre><code>$ ruby -w t_b.rb \n-- do block 2 --\n42 -&gt; 84             Fixnum\n42.0 -&gt; 84.0         Float\n'42' -&gt; 84           String\n'42xyz' -&gt; 42xyz     String\n'x42y' -&gt; x42y       String\n'42.5' -&gt; 85.0       String\n'42.5xyz' -&gt; 42.5xyz String\n'xyz' -&gt; xyz         String\n4..8 -&gt; Invalid class Range for x.\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4207570, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1586660743/picture?type=large", "display_name": "Simon \u0160tefunko", "link": "https://stackoverflow.com/users/4207570/simon-%c5%a0tefunko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508395300, "creation_date": 1508276713, "question_id": 46799719, "link": "https://stackoverflow.com/questions/46799719/ruby-proc-that-returns-numbers-and-digit-strings-multiplied-by-2-as-unchanded-ty", "title": "Ruby Proc that returns numbers and digit strings multiplied by 2 as unchanded type and text strng just returns", "body": "<p>I am trying to do my homework and I would like to ask if you can help me to write a Ruby Proc that returns number(Integer,Float,...) and digit strings(\"22\") multiplied by 2 and text string (\"sos\") just return unchanged. I am trying to do that with unary operator but I doesn't work with Float.</p>\n\n<pre><code>def make_double\n   proc = Proc.new { |x| ( x.is_a? Integer or x !~ /\\D/) ? ((x.to_i)*2).to_s : x }\nend\n</code></pre>\n\n<p>Is there a possibility how to write a more complex conditions in proc? Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ransack"], "answers": [{"tags": [], "owner": {"reputation": 110, "user_id": 6438011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276000143d7e22751c1c84876aa12b63?s=128&d=identicon&r=PG&f=1", "display_name": "cm1745", "link": "https://stackoverflow.com/users/6438011/cm1745"}, "is_accepted": true, "score": 0, "last_activity_date": 1508344250, "creation_date": 1508344250, "answer_id": 46815003, "question_id": 46798165, "link": "https://stackoverflow.com/questions/46798165/how-to-use-in-predicate-in-a-select-tag-in-rails-using-the-ransack-gem/46815003#46815003", "title": "How to use *_in predicate in a select_tag in Rails using the Ransack gem?", "body": "<p>Solved by somewhat going around Ransack. I created a simple select_tag: </p>\n\n<pre><code>&lt;%= select_tag :status_not_ransack, options_for_select(Request.select_options), {class: 'form-control input-sm'} %&gt;\n</code></pre>\n\n<p>and just did the following in my controller:</p>\n\n<pre><code>if params[:status_not_ransack]\n  case params[:status_not_ransack]\n    when '0'\n      @q.status_in = [0]\n    when '1'\n      @q.status_in = [1,3,5,7]\n    when '2'\n      @q.status_in = [2,4,6,8]\n    else\n      @q.status_in = ''\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 110, "user_id": 6438011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276000143d7e22751c1c84876aa12b63?s=128&d=identicon&r=PG&f=1", "display_name": "cm1745", "link": "https://stackoverflow.com/users/6438011/cm1745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 46815003, "answer_count": 1, "score": 0, "last_activity_date": 1508344250, "creation_date": 1508270051, "question_id": 46798165, "link": "https://stackoverflow.com/questions/46798165/how-to-use-in-predicate-in-a-select-tag-in-rails-using-the-ransack-gem", "title": "How to use *_in predicate in a select_tag in Rails using the Ransack gem?", "body": "<p>I'm using the Ransack gem, and am needing to have a select option dropdown with 3 options, but each option having multiple values. I would assume I would need to use the *_in predicate but when I do the following:</p>\n\n<pre><code>&lt;%= f.select :status_in, options_for_select([['Approved', 0], ['Pending Payroll', [1,3,5,7] ], ['Denied', [2,4,6,8] ]]), {include_blank: 'Any'}, {class: 'form-control input-sm'} %&gt;\n</code></pre>\n\n<p>and select Pending Payroll or Denied, it only fetches objects with statuses of 0. The correct (I think) HTML is generated:</p>\n\n<pre><code>&lt;option value=\"0\"&gt;Approved&lt;/option&gt;\n&lt;option value=\"[1, 3, 5, 7]\"&gt;Pending Payroll&lt;/option&gt;\n&lt;option value=\"[2, 4, 6, 8]\"&gt;Denied&lt;/option&gt;\n</code></pre>\n\n<p>Any assistance would be appreciated! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 655, "user_id": 6121888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb89ce1299c42368951d69319a98d582?s=128&d=identicon&r=PG", "display_name": "Abdel P.", "link": "https://stackoverflow.com/users/6121888/abdel-p"}, "edited": false, "score": 0, "creation_date": 1508270654, "post_id": 46797811, "comment_id": 80543453, "body": "Did you use monkeypatch? How is indicated here <a href=\"https://github.com/barsoom/devbook/tree/master/deploy_without_downtime\" rel=\"nofollow noreferrer\">github.com/barsoom/devbook/tree/master/deploy_without_downti&zwnj;&#8203;me</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3013, "user_id": 667595, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4a76a2783d70e969884e80828116c0a8?s=128&d=identicon&r=PG", "display_name": "depthfirstdesigner", "link": "https://stackoverflow.com/users/667595/depthfirstdesigner"}, "is_accepted": false, "score": 4, "last_activity_date": 1508342537, "creation_date": 1508342537, "answer_id": 46814497, "question_id": 46797811, "link": "https://stackoverflow.com/questions/46797811/rails-add-index-algorithm-concurrently-still-causes-database-lock-up-during-mi/46814497#46814497", "title": "Rails add_index algorithm: :concurrently still causes database lock up during migration", "body": "<p>It turns out the issue was not related to that migration, but one prior that ran in the same batch that was adding a new column to the same table.</p>\n\n<p>Because we added a column to the table, we hit this bug in Active Record <a href=\"https://github.com/rails/rails/issues/12330\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/12330</a> which essentially causes all ActiveRecord operations in a transaction to fail due to a stale PreparedStatement until the server is restarted.</p>\n\n<p>We will use the workarounds described in that issue from now on in our migrations.</p>\n"}], "owner": {"reputation": 3013, "user_id": 667595, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4a76a2783d70e969884e80828116c0a8?s=128&d=identicon&r=PG", "display_name": "depthfirstdesigner", "link": "https://stackoverflow.com/users/667595/depthfirstdesigner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4500, "favorite_count": 3, "answer_count": 1, "score": 8, "last_activity_date": 1508342537, "creation_date": 1508268610, "question_id": 46797811, "link": "https://stackoverflow.com/questions/46797811/rails-add-index-algorithm-concurrently-still-causes-database-lock-up-during-mi", "title": "Rails add_index algorithm: :concurrently still causes database lock up during migration", "body": "<p>In order to prevent database transaction errors during our migrations to the production site, we followed the advice outlined in <a href=\"https://github.com/LendingHome/zero_downtime_migrations\" rel=\"noreferrer\">https://github.com/LendingHome/zero_downtime_migrations</a> (specifically outlined by <a href=\"https://robots.thoughtbot.com/how-to-create-postgres-indexes-concurrently-in\" rel=\"noreferrer\">https://robots.thoughtbot.com/how-to-create-postgres-indexes-concurrently-in</a>), but during the creation of an index on a particularly large table, even the \"concurrent\" method of index creation locked the table and caused any ActiveRecord creates or updates on that table caused their respective transactions to fail with <code>PG::InFailedSqlTransaction</code> exceptions.</p>\n\n<p>Here is what the migration looked like we're running Rails 4.2 (with ActiveRecord 4.2.7.1):</p>\n\n<pre><code>class AddTypeIndexToModel &lt; ActiveRecord::Migration\n  disable_ddl_transaction!\n\n  def change\n    add_index :model, :model_type_id, algorithm: :concurrently\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "shrine"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1508267668, "post_id": 46797495, "comment_id": 80541862, "body": "Welp, to start with, it seems <code>image_uploader.rb</code> defines <code>ShrineImageUploader</code>. I would think the file would be named <code>shrine_image_uploader.rb</code> or the class would be named <code>ImageUploader</code>. Otherwise, you have a naming mismatch."}, {"owner": {"reputation": 2525, "user_id": 3200391, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/dc8c798b0aaf54577e388f7bc177093c?s=128&d=identicon&r=PG", "display_name": "Charles Smith", "link": "https://stackoverflow.com/users/3200391/charles-smith"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508267908, "post_id": 46797495, "comment_id": 80542006, "body": "well, my face is red... been staring at this all morning and the obvious was right in front of me :)"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1508268183, "post_id": 46797495, "comment_id": 80542153, "body": "Happens to the best. I added as an answer in case you would like to upvote/approve."}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1508267966, "creation_date": 1508267966, "answer_id": 46797648, "question_id": 46797495, "link": "https://stackoverflow.com/questions/46797495/nameerror-uninitialized-constant-plaqueordershrineimageuploader-when-using-sh/46797648#46797648", "title": "NameError: uninitialized constant Plaqueorder::ShrineImageUploader when using Shrine 2.8 on Rails 5.1.4", "body": "<p>Welp, to start with, it seems <code>image_uploader.rb</code> defines <code>ShrineImageUploader</code>. I would think the file would be named <code>shrine_image_uploader.rb</code> or the class would be named <code>ImageUploader</code>. </p>\n\n<p>Otherwise, you have a naming mismatch.</p>\n"}], "owner": {"reputation": 2525, "user_id": 3200391, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/dc8c798b0aaf54577e388f7bc177093c?s=128&d=identicon&r=PG", "display_name": "Charles Smith", "link": "https://stackoverflow.com/users/3200391/charles-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 46797648, "answer_count": 1, "score": 1, "last_activity_date": 1508267966, "creation_date": 1508267314, "question_id": 46797495, "link": "https://stackoverflow.com/questions/46797495/nameerror-uninitialized-constant-plaqueordershrineimageuploader-when-using-sh", "title": "NameError: uninitialized constant Plaqueorder::ShrineImageUploader when using Shrine 2.8 on Rails 5.1.4", "body": "<p>I cannot get <a href=\"http://shrinerb.com/\" rel=\"nofollow noreferrer\">Shrine</a> to work no matter what I do and I am using the simplest of setups to start with. </p>\n\n<p><strong>db/schema.rb</strong></p>\n\n<pre><code>create_table \"plaqueorders\", force: :cascade do |t|\n    ...\n    t.text \"image_data\"\n    ...\n</code></pre>\n\n<p><strong>initializers/shrine.rb</strong></p>\n\n<pre><code>require 'shrine'\nrequire 'shrine/storage/file_system'\n\nShrine.storages = {\ncache: Shrine::Storage::FileSystem.new('public', prefix: 'uploads/cache'),\nstore: Shrine::Storage::FileSystem.new('public', prefix: 'uploads/store'),\n}\n\nShrine.plugin :activerecord\nShrine.plugin :cached_attachment_data # for forms\n</code></pre>\n\n<p><strong>uploaders/image_uploader.rb</strong></p>\n\n<pre><code>class ShrineImageUploader &lt; Shrine\nend\n</code></pre>\n\n<p><strong>models/plaqueorder.rb</strong></p>\n\n<pre><code>class Plaqueorder &lt; ApplicationRecord\n  belongs_to :user\n  validates :plaque_type, presence: true\n  include ShrineImageUploader[:image]\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508269647, "post_id": 46797296, "comment_id": 80542873, "body": "Which is your actual Ruby version?"}, {"owner": {"reputation": 458, "user_id": 4817209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/768416964539c4688125e6ed2b3f9f48?s=128&d=identicon&r=PG&f=1", "display_name": "Djunzu", "link": "https://stackoverflow.com/users/4817209/djunzu"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508270873, "post_id": 46797296, "comment_id": 80543569, "body": "I am currently on ruby 2.4.1"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508270933, "post_id": 46797296, "comment_id": 80543606, "body": "Well, I hope my solution can help you, I&#39;m glad to help. I tryed and it works <a href=\"https://repl.it/Mmt5/6\" rel=\"nofollow noreferrer\">repl.it/Mmt5/6</a> you can see it there"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508272581, "post_id": 46797296, "comment_id": 80544428, "body": "Djunzu, could you add the real example of the code? I need to know why are you giving &quot;a&quot; as parameter of do_stuff method? because if you check my updated answer, you will find it&#39;s not necessary"}, {"owner": {"reputation": 458, "user_id": 4817209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/768416964539c4688125e6ed2b3f9f48?s=128&d=identicon&r=PG&f=1", "display_name": "Djunzu", "link": "https://stackoverflow.com/users/4817209/djunzu"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508968349, "post_id": 46797296, "comment_id": 80832698, "body": "@DamianLattenero, sorry, can&#39;t give you the real code. <code>a</code> don&#39;t have to be a parameter;  it could be created inside the method as well. The point is &quot;only B can call me&quot;. something similar to <code>friend</code> in C++."}], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508267291, "post_id": 46797372, "comment_id": 80541657, "body": "This is a perfect explain of why... Thanks for sharing and show me my errors, you rules! is a plus one"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508268088, "post_id": 46797372, "comment_id": 80542107, "body": "Sergio, as you know a lot more about Ruby, I will really appreciate if you can check my updated answer, and comment again, thanks a lot"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1508266810, "creation_date": 1508266810, "answer_id": 46797372, "question_id": 46797296, "link": "https://stackoverflow.com/questions/46797296/how-to-allow-only-one-class-to-access-a-method-from-another-class/46797372#46797372", "title": "How to allow only one class to access a method from another class?", "body": "<p>There are no clear solutions. If B can do it, so can C. Unlike some other languages, ruby doesn't have \"internal\" or \"package\" visibility modifier, which could help you if A and B were in the same \"package\", but C was external. If the method is private, even B has to use <code>send</code>. If it's public, C can just call it. B is not a subclass of A in your example, so <code>protected</code> modifier doesn't apply.</p>\n\n<p>One dirty-dirty way would be to check <code>caller</code> in <code>only_B_can_call_me</code>. It returns the entire callstack. So you can check if it is, indeed, B or reject otherwise. But this is super-fragile and totally not recommended.</p>\n"}, {"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1508267077, "post_id": 46797430, "comment_id": 80541540, "body": "<code>self.class</code> will never be <code>B.class</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1508267094, "post_id": 46797430, "comment_id": 80541552, "body": "<code>self.class</code> is <code>C</code> and <code>B.class</code> is <code>Class</code>. They are never going to be equal."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508267128, "post_id": 46797430, "comment_id": 80541570, "body": "@DamianLattenero: yah, now try the same in <code>B</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508267241, "post_id": 46797430, "comment_id": 80541631, "body": "@SergioTulentsev I wanted to do this, but I made a huge mistake <a href=\"https://repl.it/Mmt5/1\" rel=\"nofollow noreferrer\">repl.it/Mmt5/1</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508268975, "post_id": 46797430, "comment_id": 80542523, "body": "What prevents C from calling <code>__only_B_can_call_me__</code>?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508269007, "post_id": 46797430, "comment_id": 80542539, "body": "@SergioTulentsev Nothing at all, it is just more clear that you shouldn&#39;t"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508269173, "post_id": 46797430, "comment_id": 80542607, "body": "@DamianLattenero: well, if it&#39;s just discipline, then you can list desirable collaborators in A&#39;s documentation and be done with it. There&#39;s no hard prevention, so why invent extra hoops?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508269574, "post_id": 46797430, "comment_id": 80542820, "body": "@SergioTulentsev mmmmm you made me think... that&#39;s correct again, what if you make it protected like the new update? <a href=\"https://repl.it/Mmt5/2\" rel=\"nofollow noreferrer\">repl.it/Mmt5/2</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508269821, "post_id": 46797430, "comment_id": 80542969, "body": "@DamianLattenero: in this case, <code>protected</code> does nothing. The active guard there is <code>b.class == B</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508269904, "post_id": 46797430, "comment_id": 80543027, "body": "@SergioTulentsev but if I call the protected method in C by example, or B, it Breaks, Look! <a href=\"https://repl.it/Mmt5/3\" rel=\"nofollow noreferrer\">repl.it/Mmt5/3</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1508270023, "post_id": 46797430, "comment_id": 80543121, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/156948/discussion-between-sergio-tulentsev-and-damian-lattenero\">continue this discussion in chat</a>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1508270531, "post_id": 46797430, "comment_id": 80543397, "body": "As a piece of general advice, don&#39;t say &quot;here&#39;s one solution...but here&#39;s a better one...&quot;. Just give the better one. Inferior solutions are irrelevant and mentioning them only weakens your answer."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1508270874, "post_id": 46797430, "comment_id": 80543570, "body": "@CarySwoveland I take your good advice, thanks, I erased almost all... well, long path to travel, long way to learn..."}, {"owner": {"reputation": 458, "user_id": 4817209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/768416964539c4688125e6ed2b3f9f48?s=128&d=identicon&r=PG&f=1", "display_name": "Djunzu", "link": "https://stackoverflow.com/users/4817209/djunzu"}, "edited": false, "score": 0, "creation_date": 1508967880, "post_id": 46797430, "comment_id": 80832495, "body": "Subclass is out of question. But IF I can pass the caller to the callee as an argument, this is in fact the simpler solution."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 0, "last_activity_date": 1508272674, "last_edit_date": 1508272674, "creation_date": 1508267011, "answer_id": 46797430, "question_id": 46797296, "link": "https://stackoverflow.com/questions/46797296/how-to-allow-only-one-class-to-access-a-method-from-another-class/46797430#46797430", "title": "How to allow only one class to access a method from another class?", "body": "<p>This is the best I could do with help of @Sergio Tulentsev:</p>\n\n<pre><code>class A \n  def only_B_can_call_me(b) \n    return unless b.class == B # here you are asking\n    'called_by_B' \n  end \nend\n\nclass B\n  def do_stuff(a)\n    a.only_B_can_call_me(self) # how to forbid it? ask if self is B\n  end\nend\n\nclass C\n  def do_stuff(a)\n    a.only_B_can_call_me(self) # how to forbid it? ask if self is B\n  end\nend\n</code></pre>\n\n<p>Other way is using subclass:</p>\n\n<pre><code>class A \n  def only_B_can_call_me\n    'called_by_B' \n  end \nend\n\nclass B &lt; A\n  def do_stuff\n    self.only_B_can_call_me\n  end\nend\n\nclass C\n  def do_stuff\n    self.only_B_can_call_me # how to forbid it?, like this C hasn't the method, B does\n  end\nend\n\n\n\nputs(B.new.do_stuff) # =&gt; 'called_by_B'\nputs(C.new.do_stuff) # =&gt; it should not be allowed!!! but how to do it?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "is_accepted": false, "score": 0, "last_activity_date": 1508363191, "last_edit_date": 1508363191, "creation_date": 1508362196, "answer_id": 46819566, "question_id": 46797296, "link": "https://stackoverflow.com/questions/46797296/how-to-allow-only-one-class-to-access-a-method-from-another-class/46819566#46819566", "title": "How to allow only one class to access a method from another class?", "body": "<p>Sergio's answer is correct, however if you really need a hack take a look at the code below: </p>\n\n<pre><code> class CallerClass\n  def self.get (c)\n     line = c.first.scan(/^.*:(.*):.*/).first.first.to_i\n     file = c.first.scan(/^(.*?):/).first.first\n     func = c.first.scan(/:in `(.*)?'/).first.first\n     fc = File.readlines(file)\n     caller_class = nil\n\n     caller_class = '&lt;main&gt;' if func == '&lt;main&gt;'\n\n     line.downto(0) do |it|\n       break if caller_class\n       caller_class = fc[it].scan(/^\\s*class\\s+(.*)\\s+/).first.first if fc[it] =~ /^\\s*class\\s+(.*)\\s+/\n     end\n     caller_class\n  end\n\nend\n\nclass A\n  def only_B_can_call_me\n     caller_class = CallerClass.get(caller)\n     raise \"'#{caller_class}' is not an allowed caller\" unless caller_class == 'B'\n     'called_by_B'\n  end\nend\n\nclass B\n  def do_stuff\n    A.new.only_B_can_call_me\n  end\nend\n\nclass C\n  def do_stuff\n    A.new.only_B_can_call_me\n  end\nend\n\nB.new.do_stuff #called_by_B\nC.new.do_stuff #Raises exception\n</code></pre>\n\n<p>OBS. This is a fragile parsing of ruby code using regex, It's a <strong>HACK</strong> you've been warned!!</p>\n"}], "owner": {"reputation": 458, "user_id": 4817209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/768416964539c4688125e6ed2b3f9f48?s=128&d=identicon&r=PG&f=1", "display_name": "Djunzu", "link": "https://stackoverflow.com/users/4817209/djunzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 46797372, "answer_count": 3, "score": 1, "last_activity_date": 1508363191, "creation_date": 1508266502, "last_edit_date": 1508267003, "question_id": 46797296, "link": "https://stackoverflow.com/questions/46797296/how-to-allow-only-one-class-to-access-a-method-from-another-class", "title": "How to allow only one class to access a method from another class?", "body": "<p>I would like to have something like this:</p>\n\n<pre><code>class A\n  def only_B_can_call_me\n    'called_by_B'\n  end\nend\n\nclass B\n  def do_stuff(a)\n    a.only_B_can_call_me\n  end\nend\n\nclass C\n  def do_stuff(a)\n    a.only_B_can_call_me # how to forbid it?\n  end\nend\n\nB.new.do_stuff(A.new) # =&gt; 'called_by_B'\nC.new.do_stuff(A.new) # =&gt; it should not be allowed!!! but how to do it?\n</code></pre>\n\n<p>One way to do this is to make <code>only_B_can_call_me</code> a private method and use <code>a.send(:only_B_can_call_me)</code> inside B. OK, it works. But I could be tempted in doing the same thing inside C... so, I think it is not a good approach. Is there any other way to do this? (Allow a method be accessed just by instances of a specific class.)</p>\n\n<p>(I know that ultimately it is always possible to access any method from anywhere using <code>send</code>. But I want to keep myself away from <code>send</code> in this case.)</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508265794, "post_id": 46797063, "comment_id": 80540905, "body": "Why <code>.to_enum</code> here? That seems like an odd thing to do."}, {"owner": {"reputation": 5771, "user_id": 417678, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/91b665b7261ccd0c73a987911c96d95f?s=128&d=identicon&r=PG", "display_name": "mj_", "link": "https://stackoverflow.com/users/417678/mj"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508266084, "post_id": 46797063, "comment_id": 80541052, "body": "I found that as a way to get all the MatchData objects when you want to want to apply a regex globally to a string. Otherwise it will just return the string matches with no object that gives you the string&#39;s start position."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508272212, "post_id": 46797063, "comment_id": 80544236, "body": "If you do a <code>match</code> with a <code>&#47;g</code> flag you should get all the matches."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1508265986, "creation_date": 1508265986, "answer_id": 46797152, "question_id": 46797063, "link": "https://stackoverflow.com/questions/46797063/regex-or-with-wildcard-not-matching/46797152#46797152", "title": "RegEx Or with Wildcard not matching", "body": "<p>The problem is that the <code>(\\s+|$)</code> part is consuming the spaces that subsequent matches need to identify the starting part. You're basically sabotaging your next round by gobbling up all those spaces and leaving the pointer at the <code>3</code> position at the start of <code>32.0</code>. So long as they're considered part of the first match, they won't be available for the second.</p>\n\n<p>A quick fix is:</p>\n\n<pre><code>x.scan(/\\s{2,}(-?\\d{1,2}\\.\\d)/)\n# =&gt; [[\"23.0\"], [\"32.0\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 560, "user_id": 7721999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bRWQu.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7721999/andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1508266096, "creation_date": 1508266096, "answer_id": 46797189, "question_id": 46797063, "link": "https://stackoverflow.com/questions/46797063/regex-or-with-wildcard-not-matching/46797189#46797189", "title": "RegEx Or with Wildcard not matching", "body": "<p>The best thing to do here is to use an online Regex Matcher. My favorite is <a href=\"https://regexr.com/\" rel=\"nofollow noreferrer\">RegExr</a>.</p>\n\n<p>Best I can tell from your description is you want to match numbers simular to <code>xx.y</code>, in which case</p>\n\n<pre><code>hrs_pnt_regex = /\\d{2,}\\.\\d{1,2}/\n</code></pre>\n\n<p>will match both sets, <code>23.0</code> and <code>32.0</code></p>\n"}], "owner": {"reputation": 5771, "user_id": 417678, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/91b665b7261ccd0c73a987911c96d95f?s=128&d=identicon&r=PG", "display_name": "mj_", "link": "https://stackoverflow.com/users/417678/mj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 46797152, "answer_count": 2, "score": 0, "last_activity_date": 1508266586, "creation_date": 1508265659, "question_id": 46797063, "link": "https://stackoverflow.com/questions/46797063/regex-or-with-wildcard-not-matching", "title": "RegEx Or with Wildcard not matching", "body": "<p>I'm trying to match a string like \"    23.0     32.0\". Here's my regex:</p>\n\n<pre><code>hrs_pnt_regex = /\\s{2,}-?\\d{1,2}\\.\\d(\\s+|$)/\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>x = \"    23.0     32.0\"\nx.to_enum(:scan, hrs_pnt_regex).map { Regexp.last_match }\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code> MatchData \"    23.0     \" 1:\"     \"\n</code></pre>\n\n<p>What I notice is that the \\s+ doesn't seem to work in the parens at the end. If I change it to \"\\s\\s\", it matches both numbers like so. Otherwise I get only the first one.  </p>\n\n<pre><code>&lt;MatchData \"    23.0  \" 1:\"  \"&gt;, &lt;MatchData \"   32.0\" 1:\"\"&gt;\n</code></pre>\n\n<p>Does + not work with a | after it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1508264686, "post_id": 46796707, "comment_id": 80540258, "body": "Never do <code>rescue Exception =&gt; e</code> its a really bad practice that will swallow basic errors such <code>NoMethodError</code> and syntax errors and make debugging very difficult. Use <code>if @user.save</code> and render the new view if false so that the user can correct any validation errors. Rescue should not be used for normal control flow."}, {"owner": {"reputation": 362, "user_id": 7521284, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dBvnp.jpg?s=128&g=1", "display_name": "Ulises", "link": "https://stackoverflow.com/users/7521284/ulises"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508264844, "post_id": 46796707, "comment_id": 80540353, "body": "Hi, i only try to figure out this. My user has this pass: 123 and the password on the table is : $2a$11$VKOAUk5pjILU1QHYmkpJSem9KKm70QJPS7Oj.nPM/pTuyu1tqZaQO But when i create a new user on the model the password change to:  $2a$11$drZIcAsXTHxyvtbvL3Wg5e0EPG4JJpsAlmxe78ohEjDSA3/nCzHoa Thats my question why the model doesn&#39;t use the encryption of Devise."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508264887, "post_id": 46796707, "comment_id": 80540374, "body": "Well <code>rescue Exception =&gt; e</code> does nothing except sweep the errors under the mat."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508264922, "post_id": 46796707, "comment_id": 80540396, "body": "As a note, if you&#39;re new to Ruby you may want to steer towards using the modern <code>(x: y, a: b)</code> style hash notation. <code>:x =&gt; y</code> is a relic from the Ruby 1.8 days and while still prevalent in a lot of code bases, is a lot more noisy and ugly looking than the alternative."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1508264981, "post_id": 46796707, "comment_id": 80540427, "body": "Bcrypted passwords, which is what Devise uses by default, are intended to hash differently every time. You could create a thousand hashes with the password &quot;test&quot; and they&#39;d all be different. The verification routine takes care of all this for you."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508265182, "post_id": 46796707, "comment_id": 80540548, "body": "Better yet would be to use form_for with a User instance and the whitelist the parameters with <code>params.require(:user).permit(:email, :password, :password_confirmation)</code>. If you are ever literally copying a hash key by key  you&#39;re doing it wrong."}, {"owner": {"reputation": 362, "user_id": 7521284, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dBvnp.jpg?s=128&g=1", "display_name": "Ulises", "link": "https://stackoverflow.com/users/7521284/ulises"}, "edited": false, "score": 0, "creation_date": 1508265198, "post_id": 46796707, "comment_id": 80540558, "body": "Ohhh i get it i though that was like md5/sha, thanks for the reply."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508265346, "post_id": 46796707, "comment_id": 80540640, "body": "Besides this controller is it a vanilla devise setup or have you done any monkeying with user model that might explain it?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508265437, "post_id": 46796707, "comment_id": 80540702, "body": "And is the parameter really <code>password_first</code> and not just <code>password</code>? It might help if you include the form and the input parameters."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1508265530, "creation_date": 1508265530, "answer_id": 46797031, "question_id": 46796707, "link": "https://stackoverflow.com/questions/46796707/devise-rails-password/46797031#46797031", "title": "Devise Rails Password", "body": "<p>BCrypt goes out of its way to scramble the password as much as possible to make it extremely difficult to reverse that hashing operation. For any given input string to <code>BCrypt::Password.create</code> there are around 680 trillion-trillion-trillion possible output strings (2<sup>128</sup>), so it's unlikely you'll ever get the same one twice:</p>\n\n<pre><code>hashes = 10.times.map { BCrypt::Password.create('test') }\n# =&gt; [\n#   \"$2a$10$vMrgjJHqvwnEKIs0fZ76pO3gbWL/0C3ExqK9HOpi/mHYu2.4GAO2K\",\n#   \"$2a$10$KxBOarDzRPHp7QF1GGqNnuplRs1B5rNVfp21IHx1/HzQ0YIcIkLRW\",\n#   \"$2a$10$emCdZAA.GU8GwQZkeJLfAuUTY2aEnhFmZ.GQAhDpJ.JGSh/m6s/k2\",\n#   \"$2a$10$6R6xmGyK7Tb1MKsQb00vpOJKwpi56aj98JLoBJhBN4vWSQb7zagQm\",\n#   \"$2a$10$r4qmb.C.vm88pL2nJK5TdOaWIboYaO6a1xHIRH.QDER6qYR6Ajvo.\",\n#   \"$2a$10$mlVWz4IHTgYHSf3tAgEgpenpDHtGWYev4EUENLs7hnLlm6ikPhUxy\",\n#   \"$2a$10$ixXdZZuc9rIVAozO8tyq5.wlsVOWBc6QWetNh3PvjPj2pGlqh.XOy\",\n#   \"$2a$10$zLzuevtOl.g4RbaHpdeTZ.k4qjE/1m4nh6gN4mhcIKQPSa5sBcG5u\",\n#   \"$2a$10$F/F71.DYEuzxS4W0w5m/a.IRpaVJxeh9sKUJ7DyQb5xU3SvFu1Ib.\",\n#   \"$2a$10$ILXg8R52ZtHHbQbT0FxSFOj8YNqpNLmrH.6FhM3RGMwIuBeP1YXHa\" ]\n</code></pre>\n\n<p>This is alright though since the verification routine can handle checking password:</p>\n\n<pre><code>hashes.map { |h| BCrypt::Password.new(h) == 'test' }\n# =&gt; [true, true, true, true, true, true, true, true, true, true]\n</code></pre>\n\n<p>They all match. It's important to note that verifying ten passwords does take a small but noticeable amount of time. This is what make BCrypt particularly well suited to password storage: Guessing is expensive so throwing huge dictionaries of words at a hash to see which match is extremely difficult. This is not the case with weaker hashes like MD5 or SHA1 where a million operations per second is completely feasible. BCrypt is deliberately about a half million times slower.</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1508266678, "last_edit_date": 1508266678, "creation_date": 1508266377, "answer_id": 46797263, "question_id": 46796707, "link": "https://stackoverflow.com/questions/46796707/devise-rails-password/46797263#46797263", "title": "Devise Rails Password", "body": "<p>Start with a regular decent Rails crud setup and see if the issue does not solve itself.</p>\n\n<pre><code># routes.rb\nresources :users, only: [:create, :index]\n</code></pre>\n\n<hr>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n  before_action :authenticate_user!\n\n  # GET /users\n  def index\n    @Users = User.all\n  end\n\n  # POST /users\n  def create\n    @user = User.new(user_params)\n    if @user.save\n      flash[:success] = \"Usuario creado correctamente\"\n      redirect_to action: :index\n    else\n      render :new\n    end\n  end\n\n  def user_params\n     params.require(:user)\n           .permit(:email, :password, :password_confirmation)\n  end\nend\n</code></pre>\n\n<hr>\n\n<pre><code># app/views/users/_form.html.erb\n&lt;% form_for(@user || User.new) do |f| %&gt;\n  &lt;% if f.object.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;h2&gt;&lt;%= pluralize(f.object.errors.count, \"error\") %&gt; prohibited this article from being saved:&lt;/h2&gt;\n    &lt;ul&gt;\n      &lt;% f.object.errors.errors.full_messages.each do |msg| %&gt;\n      &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :email %&gt;\n    &lt;%= f.email_field :email %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password %&gt;\n    &lt;%= f.password_field :password %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :password_confirmation %&gt;\n    &lt;%= f.password_field :password_confirmation %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<pre><code># app/views/users/new.html.erb\n&lt;%= render partial: 'form' %&gt;\n</code></pre>\n\n<p>You can embed the partial in your root view or the users index by:</p>\n\n<pre><code>&lt;%= render partial: 'users/form' %&gt;\n</code></pre>\n\n<p>Note that you should render and not redirect if the record is invalid. If you redirect the users input and any validation messages you want to show are gone.</p>\n"}], "owner": {"reputation": 362, "user_id": 7521284, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dBvnp.jpg?s=128&g=1", "display_name": "Ulises", "link": "https://stackoverflow.com/users/7521284/ulises"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 46797031, "answer_count": 2, "score": 1, "last_activity_date": 1508266678, "creation_date": 1508264393, "question_id": 46796707, "link": "https://stackoverflow.com/questions/46796707/devise-rails-password", "title": "Devise Rails Password", "body": "<p>I have a new application that the root user create another users, when i create the user with the model.</p>\n\n<pre><code> @user = User.new(:email =&gt; params[:email], :password =&gt; params[:password], :password_confirmation =&gt; params[:password_confirmation])\n @user.save!\n</code></pre>\n\n<p>The users saves \"correctly\" on the table on \"encrypted_password\" the value and the others fields too, but when i try to login i have an error\n\"Invalid Email or Password\" so when i read the record the password is.</p>\n\n<pre><code>encrypted_password: $2a$11$wFnpiA.l9HezNXfnAGkttuu2IGIXByETytLrEkdDsa8sBFrc8Bdmq\n</code></pre>\n\n<p>But i used another password the root password that actually works.\nBut on the table is :</p>\n\n<pre><code> encrypted_password: $2a$11$VKOAUk5pjILU1QHYmkpJSem9KKm70QJPS7Oj.nPM/pTuyu1tqZaQO\n</code></pre>\n\n<p>So, my model of the devise is not saving the correct encryption of the password.</p>\n\n<p>My TestController:</p>\n\n<pre><code> class UsersController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def index\n    @Users = User.all\n  end\n\n def create\n     begin\n        @user = User.new(:email =&gt; params[:email], :password =&gt; params[:password_first], :password_confirmation =&gt; params[:password_confirmation])\n        @user.save!\n        flash[:notice] = \"Usuario creado correctamente\"\n        redirect_to action: 'index'  \n     rescue Exception =&gt; e          \n          flash[:alert] = \"Error al crear al Usuario: \" + e.message\n          redirect_to action: 'index'  \n     end\n end\n\nend\n</code></pre>\n\n<p>What am i doing wrong?</p>\n\n<p>Regards</p>\n"}, {"tags": ["arrays", "ruby", "sorting", "hash-of-hashes"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1508264769, "creation_date": 1508264769, "answer_id": 46796824, "question_id": 46796690, "link": "https://stackoverflow.com/questions/46796690/trying-to-sort-a-hash-within-an-array-within-a-hash/46796824#46796824", "title": "Trying to sort a hash within an array within a hash", "body": "<p>Try this one</p>\n\n<pre><code>h.each do |k, v| \n  h[k] = v.first.sort_by { |_, person| person[:age] }.to_h\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8791735, "user_type": "registered", "profile_image": "https://graph.facebook.com/1635606293158107/picture?type=large", "display_name": "LennyFrost", "link": "https://stackoverflow.com/users/8791735/lennyfrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1508265195, "creation_date": 1508264313, "last_edit_date": 1508265195, "question_id": 46796690, "link": "https://stackoverflow.com/questions/46796690/trying-to-sort-a-hash-within-an-array-within-a-hash", "title": "Trying to sort a hash within an array within a hash", "body": "<p>This is what my awkward DB looks like atm. I want to try and sort the nested hashes based on age. I've looked around on SO and all i can find is how to sort hashes inside of hashes, but not when the nested hashes are inside of an array. Im sure there's some easy way to either change the structure or sort it the way it is.</p>\n\n<pre><code>{ :room1 =&gt; [{\n  :fred =&gt; { :name =&gt; \"Fred\", :age =&gt; 23 },\n  :joan =&gt; { :name =&gt; \"Joan\", :age =&gt; 18 },\n  :pete =&gt; { :name =&gt; \"Pete\", :age =&gt; 54 }\n}],\n:room2 =&gt; [{\n  :jan =&gt; { :name =&gt; \"jan\", :age =&gt; 2 },\n  :eric =&gt; { :name =&gt; \"eric\", :age =&gt; 3 },\n  :stan =&gt; { :name =&gt; \"stan\", :age =&gt; 1 }\n}]}\n</code></pre>\n\n<p>Thanks in advance!\nBtw, this is my first question on here. Be gentle ^^.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer", "rake-task"], "answers": [{"comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1508263952, "post_id": 46796274, "comment_id": 80539858, "body": "If you call Something by another name, the app can&#39;t find it. You set <code>@agent_card</code> in the controller then you have to use the same in the view. (It&#39;s only when dealing with models that you sometimes you pluralize like <code>@user=User.first</code> <code>@posts=@user.posts.all</code> post is pluralized here because you expect many)"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1508264260, "post_id": 46796274, "comment_id": 80540033, "body": "Actually your <code>each do</code> will probably fail unless <code>agent_card</code> you pass in the <code>not_verified_message</code> method is a collection, not a single record. Give us all your models in order to help you. If, let&#39;s say, there is an Agent which is parent of Agent_card like <code>Agent has_many agent_cards</code> then pass the agent in the method and then you can retrieve all agent cards in the view..."}], "tags": [], "owner": {"reputation": 37836, "user_id": 24195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4bebe360045a2dce663ee875f13723?s=128&d=identicon&r=PG", "display_name": "Rob Di Marco", "link": "https://stackoverflow.com/users/24195/rob-di-marco"}, "is_accepted": false, "score": 1, "last_activity_date": 1508262840, "creation_date": 1508262840, "answer_id": 46796274, "question_id": 46796238, "link": "https://stackoverflow.com/questions/46796238/issue-with-rails-mailer-and-rake-task/46796274#46796274", "title": "Issue with rails mailer and rake task", "body": "<p>Your mailer is setting the attribute <code>@agent_card</code> but the template is looking for the plural <code>@agent_cards</code></p>\n"}], "owner": {"reputation": 306, "user_id": 5007156, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lA3OI.jpg?s=128&g=1", "display_name": "Mike Wiesenhart", "link": "https://stackoverflow.com/users/5007156/mike-wiesenhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508262840, "creation_date": 1508262707, "question_id": 46796238, "link": "https://stackoverflow.com/questions/46796238/issue-with-rails-mailer-and-rake-task", "title": "Issue with rails mailer and rake task", "body": "<p>If an agent hasn't been verified, I want one email to be generated and sent to me with all of their names. Not sure where I went wrong.</p>\n\n<p>agent_card_mailer.rb</p>\n\n<pre><code>class AgentCardMailer &lt; ActionMailer::Base\n  default from: \"Help &lt;help@email.com&gt;\"\n\n  def not_verified_message(agent_card)\n    @agent_card = agent_card\n\n    mail(:to =&gt; \"me@email.com\", :subject =&gt; \"Agent License Issues\")\n  end\nend\n</code></pre>\n\n<p>not_verified_message.html.erb</p>\n\n<pre><code>Hi there,&lt;br&gt;&lt;br&gt;\n\nThese agents have not been verified.&lt;br&gt;&lt;br&gt;\n\n&lt;% @agent_cards.each do |agent_card| %&gt;\n  &lt;%= agent_card.agent.name %&gt;&lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>issue_with_license.rake</p>\n\n<pre><code>namespace :agent_cards do\n  desc 'Send out weekly email for agents with issues'\n  task remind_license_issues: :environment do\n    AgentCard.all.each do |agent_card|\n      if agent_card.verified == false\n        AgentCardMailer.not_verified_message(agent_card).deliver_now\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>ActionView::Template::Error: undefined method `each' for nil:NilClass\n</code></pre>\n"}, {"tags": ["ruby", "web", "automated-tests", "capybara"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508265147, "post_id": 46796235, "comment_id": 80540524, "body": "Yeah, that page messes with the scrolling. You won&#39;t be able to scroll it that way. Try emitting scroll wheel events, maybe it&#39;ll respond to those."}, {"owner": {"reputation": 1, "user_id": 7350822, "user_type": "registered", "profile_image": "https://graph.facebook.com/1258017767622222/picture?type=large", "display_name": "Wilson Augusto", "link": "https://stackoverflow.com/users/7350822/wilson-augusto"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508268189, "post_id": 46796235, "comment_id": 80542155, "body": "Thanks for the answer, I&#39;ve tried <code>&quot;window.WheelEvent(0,1000)&quot;</code> but it returns the message <i>unknown error: Failed to construct &#39;WheelEvent&#39;: Please use the &#39;new&#39; operator, this DOM object constructor cannot be called as a function.</i>  Did I write right? &#39;Cause I didn&#39;t find any example for scroll wheel in Ruby"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1508269054, "post_id": 46796235, "comment_id": 80542555, "body": "@WilsonAugusto What driver are you using?"}, {"owner": {"reputation": 1, "user_id": 7350822, "user_type": "registered", "profile_image": "https://graph.facebook.com/1258017767622222/picture?type=large", "display_name": "Wilson Augusto", "link": "https://stackoverflow.com/users/7350822/wilson-augusto"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1508269314, "post_id": 46796235, "comment_id": 80542677, "body": "@ThomasWalpole, I&#39;m using Selenium with Capybara and Cucumber"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1508273407, "post_id": 46796235, "comment_id": 80544866, "body": "To use WheelEvents you&#39;d need to create a wheel event and then dispatch it at the correct element on the page - something like <code>var evt = new WheelEvent(&#39;wheel&#39;, {deltaY: ??, wheelDeltaY: ??}); element.dispatchEvent(evt);</code>  I&#39;m not sure what those values should be though or which element you need to dispatch them to for the page your using, you should be able to monitor events in Chrome and see what it normally sends. - <a href=\"https://developer.mozilla.org/en-US/docs/Web/Events/wheel\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/Events/wheel</a>"}, {"owner": {"reputation": 1, "user_id": 7350822, "user_type": "registered", "profile_image": "https://graph.facebook.com/1258017767622222/picture?type=large", "display_name": "Wilson Augusto", "link": "https://stackoverflow.com/users/7350822/wilson-augusto"}, "edited": false, "score": 0, "creation_date": 1508502688, "post_id": 46796235, "comment_id": 80645543, "body": "I was not able to scroll with Chrome, so I used safaridriver and it worked, I do not know why, I&#39;m using the 2.33.506106 version of chromedriver, but thanks to everyone who helped me"}], "owner": {"reputation": 1, "user_id": 7350822, "user_type": "registered", "profile_image": "https://graph.facebook.com/1258017767622222/picture?type=large", "display_name": "Wilson Augusto", "link": "https://stackoverflow.com/users/7350822/wilson-augusto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 886, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508334113, "creation_date": 1508262703, "last_edit_date": 1508334113, "question_id": 46796235, "link": "https://stackoverflow.com/questions/46796235/im-having-trouble-to-scroll-a-page-using-capybara", "title": "I&#39;m having trouble to scroll a page using capybara", "body": "<p>I've tried to scroll a page using: </p>\n\n<pre><code>page.execute_script \"window.scrollBy(0,10000)\"\n</code></pre>\n\n<p>But the page simply doesn't scroll.\nThe url i'm trying to scroll is <a href=\"https://next.me/propostas\" rel=\"nofollow noreferrer\">https://next.me/propostas</a></p>\n\n<p>Can anyone help me? I'm newer to Ruby and Capybara, thanks</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508261409, "post_id": 46795865, "comment_id": 80538374, "body": "Ruby strongly encourages you to avoid using upper-case letters in variable and method names. Capitals indicate constants like <code>ClassName</code>, <code>ModuleName</code> and <code>CONSTANT_NAME</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1508261447, "post_id": 46795865, "comment_id": 80538399, "body": "It&#39;s also not necessary to create <code>setX</code> type methods when <code>attr_accessor :x</code> creates the proper <code>x=</code> method that&#39;s used instead."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508261492, "post_id": 46795865, "comment_id": 80538428, "body": "What do you mean &quot;won&#39;t run&quot;? Does it produce an error? This code looks incomplete and syntactically incorrect, plus the indentation isn&#39;t aligning things properly. Indentation might seem like a minor concern, but paying careful attention to that can help expose problems early, avoiding a lot of frustrating debugging."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1508261495, "post_id": 46795865, "comment_id": 80538429, "body": "What do you mean &quot;won&#39;t run it&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "is_accepted": false, "score": 0, "last_activity_date": 1508261555, "creation_date": 1508261555, "answer_id": 46795928, "question_id": 46795865, "link": "https://stackoverflow.com/questions/46795865/how-to-search-in-new-files-and-print-the-added-information/46795928#46795928", "title": "How to search in new files and print the added information?", "body": "<p>This looks incredibly similar to someone else who asked a similar question yesterday. Maybe a school project going around.  </p>\n\n<p>You might check the code here: <a href=\"https://stackoverflow.com/questions/46777799/i-trying-to-make-a-code-that-gives-the-user-a-personal-number-after-they-have-ma/46780789#46780789\">I trying to make a code that gives the user a personal number after they have made an user</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8791404, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6ZG77GLIs5g/AAAAAAAAAAI/AAAAAAAAAGo/fuJT7Dh41Zo/photo.jpg?sz=128", "display_name": "Unnur &#225;rs&#230;lsd&#243;ttir", "link": "https://stackoverflow.com/users/8791404/unnur-%c3%a1rs%c3%a6lsd%c3%b3ttir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508261555, "creation_date": 1508261338, "last_edit_date": 1508261444, "question_id": 46795865, "link": "https://stackoverflow.com/questions/46795865/how-to-search-in-new-files-and-print-the-added-information", "title": "How to search in new files and print the added information?", "body": "<p>I'm having a problem in my ruby code. My project is to:\nMake a new file and put the data inside and than search:\n1. Enter a new employee (number, name, date of birth).\n2. Search for an employee by number. (in the database) \n3. To exit press 3</p>\n\n<p>This is the code I have, but the terminal won't run it. </p>\n\n<pre><code>class Person\n\n    def setNumber(number)\n        @number=number\n    end\n\n    def setInfo(name)\n        @name=name\n    end\n\n    def getInfo()\n    return @name\n    end\n\n    def setInf(dateofBirth)\n        @dateofBirth=dateofBirth\n    end\n\n    def getInf()\n    return dateofBirth\n    end \n\n  puts \"Companies employees\"\n\n  select = 0\n\n  while(select!=3)\n\n    puts \"Press 1 to Enter information about new employee\"\n    puts \"Press 2 to Search for employee by number\"\n    puts \"Press 3 to exit\"\n\n  select=gets.chomp.to_i\n\n\n  if(select == 1)\n  f=File.new(\"Repository.txt\",\"a+\")\n\n    puts \"Please enter employee number:\"\n        number = gets.chomp.to_s\n        f.puts (number)\n        person = Person.new\n        person.setInfo(number)\n\n    puts \"Please enter the employee name:\"\n        name = gets.chomp.to_s\n        f.puts (name) \n        set_name = Person.new\n\n      set_name.setInfo(name)\n\n        puts \"Please enter the employees date of birth:\"\n            dateofBirth = gets.chomp.to_s\n            f.puts (dateofBirth)\n            dateofBirth = Person.new\n          dateofBirth.setInfo(dateofBirth)\n\n      f.close()\n\n    elsif(select==2)\n        puts \"Which employee number would you like to search for?\"\n        search = gets.chomp\n        f = File.open(\"Repository.txt\",\"r\")\n        while !(f.eof?)\n             line.include?(search)\n\n            end\n\n            f.close()\n\n\n\n          elsif(select &gt; 3)\n            puts \"Incorrect selection.\"\n\n          elsif(select == 3)\n            puts \"Goodbye!\"\n\n            end\n          end \n</code></pre>\n"}, {"tags": ["ruby", "selenium"], "comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1508287490, "post_id": 46795755, "comment_id": 80549165, "body": "Talk to Rackspace. Surely they have some reasonable way to update 3k certificates other than writing a scraping tool and dealing with their website."}, {"owner": {"reputation": 81, "user_id": 4355621, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rBrnRU0zwB0/AAAAAAAAAAI/AAAAAAAAAMA/i1NvkZrPa5U/photo.jpg?sz=128", "display_name": "Jesse Fish", "link": "https://stackoverflow.com/users/4355621/jesse-fish"}, "reply_to_user": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1508297435, "post_id": 46795755, "comment_id": 80551385, "body": "You&#39;d think so but they&#39;ve never had a customer do this before :-P"}, {"owner": {"reputation": 243, "user_id": 5093221, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4b4f3ce2c76cb1af8164e99d8141d039?s=128&d=identicon&r=PG&f=1", "display_name": "Kesh", "link": "https://stackoverflow.com/users/5093221/kesh"}, "edited": false, "score": 0, "creation_date": 1508429649, "post_id": 46795755, "comment_id": 80616382, "body": "Drag and drop one file manually and check elements again to see the changes it made.. which might help you.. but not sure."}], "owner": {"reputation": 81, "user_id": 4355621, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-rBrnRU0zwB0/AAAAAAAAAAI/AAAAAAAAAMA/i1NvkZrPa5U/photo.jpg?sz=128", "display_name": "Jesse Fish", "link": "https://stackoverflow.com/users/4355621/jesse-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508260868, "creation_date": 1508260868, "question_id": 46795755, "link": "https://stackoverflow.com/questions/46795755/ruby-selenium-webdriver-upload-file-without-send-keys-or-input-element", "title": "Ruby-Selenium Webdriver: Upload file without send_keys or input element", "body": "<p>I'm attempting to automate updating my rackspace certificates with Ruby Selenium as I have over 3k to update.</p>\n\n<p>The last step I have to automate is uploading the .zip file to rackspace. Unfortunately I can not use the often-quoted send_keys method for this because there is no \"input\" element on the page that I can find. The attachment dialog is launched from the following element:<a href=\"https://i.stack.imgur.com/8TlDN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8TlDN.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm using Ruby and I don't know how to integrate the Robot class that is the normal 2nd answer to this question within my ruby framework. </p>\n\n<p>I'm using a Mac so I can't use AutoIT to script the event, which is the normal 3rd answer to this question</p>\n\n<p>Any help doing this would be absolutely amazing. Thank you so much for any assistance you can give me regarding this situation.</p>\n"}, {"tags": ["ruby", "variables"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508261098, "post_id": 46795763, "comment_id": 80538205, "body": "Friendly advice, change your name to something in latin letters. Most users here won&#39;t be able to read your name or type it to mention you."}], "tags": [], "owner": {"reputation": 77, "user_id": 6908405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00c183db4df116bf5a41f42879acd35?s=128&d=identicon&r=PG&f=1", "display_name": "Georgiy Melnikov", "link": "https://stackoverflow.com/users/6908405/georgiy-melnikov"}, "is_accepted": false, "score": 1, "last_activity_date": 1508260881, "creation_date": 1508260881, "answer_id": 46795763, "question_id": 46795619, "link": "https://stackoverflow.com/questions/46795619/whats-wrong-with-these-ruby-variables/46795763#46795763", "title": "What&#39;s wrong with these Ruby variables?", "body": "<p>The problem is in the name of the variables. In the ruby they can not start with a digit. </p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1508261339, "post_id": 46795767, "comment_id": 80538330, "body": "Even better: <code>checkboxes[0]</code> and <code>checkboxes[1]</code> in an array."}], "tags": [], "owner": {"reputation": 1105, "user_id": 391122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/63c655bc5282d3f343574aef29de460a?s=128&d=identicon&r=PG", "display_name": "Jared", "link": "https://stackoverflow.com/users/391122/jared"}, "is_accepted": true, "score": 2, "last_activity_date": 1508260888, "creation_date": 1508260888, "answer_id": 46795767, "question_id": 46795619, "link": "https://stackoverflow.com/questions/46795619/whats-wrong-with-these-ruby-variables/46795767#46795767", "title": "What&#39;s wrong with these Ruby variables?", "body": "<p>You cannot have variables begin with a number.  Rename your variables to <code>first_excl_checkbox</code> and <code>second_excl_checkbox</code> and you'll be good to go.</p>\n"}], "owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 46795767, "answer_count": 2, "score": -2, "last_activity_date": 1508492378, "creation_date": 1508260395, "last_edit_date": 1508492378, "question_id": 46795619, "link": "https://stackoverflow.com/questions/46795619/whats-wrong-with-these-ruby-variables", "title": "What&#39;s wrong with these Ruby variables?", "body": "<p>I am trying to assign two variables and write a simple inline Ruby <code>if</code> statement within a method. I am getting an <code>unexpected tidentifier keyword_end</code>, indicating <code>^</code> at the end of the each variable names on all four lines;</p>\n\n<pre><code>1st_excl_checkbox = @browser.radio(:id =&gt; \"opt2\")\n2nd_excl_checkbox = @browser.radio(:id =&gt; \"opt1\")\n1st_excl_checkbox.set if 1st_excl_checkbox.exists?\n2nd_excl_checkbox.set if 1st_excl_checkbox.exists?\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1508255303, "post_id": 46794036, "comment_id": 80534998, "body": "<i>&quot;I can&#39;t open a text editor and smart-insert commas / square brackets before the run</i>&quot; -- You don&#39;t need to open a text editor to edit a file! Why not just run <code>sed</code> on the file?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508255664, "post_id": 46794036, "comment_id": 80535179, "body": "Are the nested hashes in the files or can assume that adding a <code>,</code> after each <code>}</code> would we a huge step forwards?"}, {"owner": {"reputation": 680, "user_id": 2970729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a4c525a91ef9d26bfb3e97233f8fda3?s=128&d=identicon&r=PG&f=1", "display_name": "DotnetProg", "link": "https://stackoverflow.com/users/2970729/dotnetprog"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508255770, "post_id": 46794036, "comment_id": 80535231, "body": "@TomLord Didn&#39;t know this command, looking into it right now.  Actually I have the option to run bash commands before the processing so it might give a proper solution to my problem, but still wondering whether there&#39;s a ruby solution to this"}, {"owner": {"reputation": 680, "user_id": 2970729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a4c525a91ef9d26bfb3e97233f8fda3?s=128&d=identicon&r=PG&f=1", "display_name": "DotnetProg", "link": "https://stackoverflow.com/users/2970729/dotnetprog"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508255799, "post_id": 46794036, "comment_id": 80535248, "body": "@spickermann my objects are not complexed and doesn&#39;t contain nested objects (currently...)"}], "answers": [{"comments": [{"owner": {"reputation": 680, "user_id": 2970729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a4c525a91ef9d26bfb3e97233f8fda3?s=128&d=identicon&r=PG&f=1", "display_name": "DotnetProg", "link": "https://stackoverflow.com/users/2970729/dotnetprog"}, "edited": false, "score": 0, "creation_date": 1508257416, "post_id": 46794550, "comment_id": 80536218, "body": "Works as expected :) Thanks a lot!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1508256464, "creation_date": 1508256464, "answer_id": 46794550, "question_id": 46794036, "link": "https://stackoverflow.com/questions/46794036/read-multiple-concatenated-json-objects-in-ruby/46794550#46794550", "title": "Read multiple concatenated json objects in Ruby", "body": "<p>As long as your file is that simple you might want to do something like this:</p>\n\n<pre><code># content = File.read(filename)\ncontent =&lt;&lt;-EOF\n  {\n    \"field\" : \"value\",\n    \"another_field\": \"another_value\"\n  } // no comma\n  { \n    \"field\" : \"value\"\n  }\nEOF\n\nrequire 'json'\n\nJSON.parse(\"[#{content.gsub(/\\}.*?\\{/m, '},{')}]\")\n#=&gt; [{\"field\"=&gt;\"value\", \"another_field\"=&gt;\"another_value\"}, {\"field\"=&gt;\"value\"}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5358, "user_id": 1173869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba740763cd173d2032c3dff634c778a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1173869/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1570067850, "last_edit_date": 1570067850, "creation_date": 1570054150, "answer_id": 58209963, "question_id": 46794036, "link": "https://stackoverflow.com/questions/46794036/read-multiple-concatenated-json-objects-in-ruby/58209963#58209963", "title": "Read multiple concatenated json objects in Ruby", "body": "<p>The <a href=\"https://github.com/brianmario/yajl-ruby\" rel=\"nofollow noreferrer\">yajl-ruby</a> gem enables processing concatenated JSON in Ruby.  The parser can read from a String or an IO.  Each complete object is yielded to a block.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'yajl'\n\nFile.open 'file.json' do |f|\n  Yajl.load f do |object|\n    # do something with object\n  end\nend\n\n</code></pre>\n\n<p>See the <a href=\"https://rdoc.info/github/brianmario/yajl-ruby/Yajl%2FParser:parse\" rel=\"nofollow noreferrer\">documentation</a> for other options (buffer size, symbolized keys, etc).</p>\n"}], "owner": {"reputation": 680, "user_id": 2970729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a4c525a91ef9d26bfb3e97233f8fda3?s=128&d=identicon&r=PG&f=1", "display_name": "DotnetProg", "link": "https://stackoverflow.com/users/2970729/dotnetprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 46794550, "answer_count": 2, "score": 0, "last_activity_date": 1570067850, "creation_date": 1508254861, "question_id": 46794036, "link": "https://stackoverflow.com/questions/46794036/read-multiple-concatenated-json-objects-in-ruby", "title": "Read multiple concatenated json objects in Ruby", "body": "<p>I have a file that contains multiple JSON objects that are not separated by comma : </p>\n\n<pre><code>{\n  \"field\" : \"value\",\n  \"another_field\": \"another_value\"\n} // no comma\n{ \n  \"field\" : \"value\"\n}\n</code></pre>\n\n<p>Each of the objects standalone is a valid json object.</p>\n\n<p><strong>Is there a way that I can process this file easily?</strong></p>\n\n<ol>\n<li>I know this is NOT a valid json, but unfortunately this file is being generated by a 3rd party tool. I have no option of changing the way the output looks like.</li>\n<li>I can't open a text editor and smart-insert commas / square brackets before the run, since this is an automated process (I also really don't want to write code that opens the file and manipulates it).</li>\n</ol>\n\n<p>In .NET there's a library that has this exact feature : \n<a href=\"https://stackoverflow.com/a/29480032/2970729\">https://stackoverflow.com/a/29480032/2970729</a>\n<a href=\"https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonReader_SupportMultipleContent.htm\" rel=\"nofollow noreferrer\">https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonReader_SupportMultipleContent.htm</a></p>\n\n<p>Is there anything equivalent in Ruby? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments", "stripe.js"], "comments": [{"owner": {"reputation": 1070, "user_id": 5915807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4095e2e965e552e521bc9d38886d77?s=128&d=identicon&r=PG", "display_name": "korben", "link": "https://stackoverflow.com/users/5915807/korben"}, "edited": false, "score": 0, "creation_date": 1508264173, "post_id": 46793910, "comment_id": 80539984, "body": "Where are you actually adding that data to your database?  I only see one entry in your <code>create</code> endpoint where you&#39;re adding parameters to your table and it&#39;s definitely not all of them.  Maybe I&#39;m missing something."}, {"owner": {"reputation": 1003, "user_id": 66493, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbd5ff0beb1fcfc28ff844110b7add06?s=128&d=identicon&r=PG", "display_name": "egyamado", "link": "https://stackoverflow.com/users/66493/egyamado"}, "reply_to_user": {"reputation": 1070, "user_id": 5915807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4095e2e965e552e521bc9d38886d77?s=128&d=identicon&r=PG", "display_name": "korben", "link": "https://stackoverflow.com/users/5915807/korben"}, "edited": false, "score": 0, "creation_date": 1508273850, "post_id": 46793910, "comment_id": 80545107, "body": "Just added <code>Registration</code> model. Thanks."}], "owner": {"reputation": 1003, "user_id": 66493, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbd5ff0beb1fcfc28ff844110b7add06?s=128&d=identicon&r=PG", "display_name": "egyamado", "link": "https://stackoverflow.com/users/66493/egyamado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1508273805, "creation_date": 1508254459, "last_edit_date": 1508273805, "question_id": 46793910, "link": "https://stackoverflow.com/questions/46793910/stripe-unpermitted-parameters-stripetokentype-and-customer-id-shows-nil", "title": "Stripe Unpermitted parameters: :stripeTokenType and customer_id: shows nil", "body": "<p>Working with Rails 5 and Strip gem. I'm using <a href=\"http://ngrok.io\" rel=\"nofollow noreferrer\">http://ngrok.io</a> in order to use Stripe Webhook. </p>\n\n<p>Here is <strong>RegistrationsController</strong>.</p>\n\n<pre><code>class RegistrationsController &lt; ApplicationController\n  before_action :set_registration, only: [:show, :edit, :update, :destroy]\n\n  def index\n    @registrations = Registration.all\n  end\n\n  def show\n  end\n\n  def new\n    @registration = Registration.new\n    @registration.subscription = Subscription.find_by id: params[\"subscription_id\"]\n  end\n\n  def create\n    @registration = Registration.new registration_params.merge(email: stripe_params[\"stripeEmail\"],\n                                                               card_token: stripe_params[\"stripeToken\"])\n    raise \"Please, check registration errors\" unless @registration.valid?\n    @registration.process_payment\n    @registration.save\n    redirect_to @registration, notice: 'Registration was successfully created. Thank you!'\n  rescue Stripe::CardError =&gt; e\n    flash[:error] = e.message\n    render :new\n  end\n\n\n  # POST /registrations/hook\n  protect_from_forgery except: :webhook\n  def webhook\n    event = Stripe::Event.retrieve(params[\"id\"])\n\n    case event.type\n      when \"invoice.payment_succeeded\" #renew subscription\n        Registration.find_by_customer_id(event.data.object.customer).renew\n    end\n    render status: :ok, json: \"success\"\n  end\n\n  private\n\n    def stripe_params\n      params.permit :stripeEmail, :stripeToken\n    end\n\n    def set_registration\n      @registration = Registration.find(params[:id])\n    end\n\n    def registration_params\n      params.require(:registration).permit(:subscription_id, :full_name, :company, :telephone, :email, :card_token, :end_date, :customer_id)\n    end\nend\n</code></pre>\n\n<p><strong>Registration model</strong>\nWhere I defined <code>process_payment</code> moethod.</p>\n\n<pre><code>class Registration &lt; ApplicationRecord\n  belongs_to :subscription\n\n  def process_payment\n    customer_data = {email: email, source: card_token}\n                    .merge((subscription.plan.blank?)? {}: {plan: subscription.plan})\n    customer = Stripe::Customer.create(customer_data)\n\n    Stripe::Charge.create customer: customer.id,\n                          amount: (subscription.price * 100).to_i,\n                          description: subscription.name,\n                          currency: 'CAD'\n    customer_id = customer.id\n  end\n\n  def renew\n    update_attibute :end_date, Date.today + 1.month\n  end\n\nend\n</code></pre>\n\n<p>And here is <strong>Registrations table</strong></p>\n\n<pre><code>create_table \"registrations\", force: :cascade do |t|\n    t.bigint \"subscription_id\", null: false\n    t.string \"full_name\"\n    t.string \"company\"\n    t.string \"email\"\n    t.string \"telephone\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"card_token\"\n    t.date \"end_date\"\n    t.string \"customer_id\"\n    t.index [\"subscription_id\"], name: \"index_registrations_on_subscription_id\"\n  end\n</code></pre>\n\n<p>while Payment goes through and Stripe reflect all correct element such as customer_id, end_dat, stripeToken,.... I have a problem on my local server where it doesn't show all customer_id and end_date.</p>\n\n<p><strong>Here is terminal output</strong></p>\n\n<pre><code>Started POST \"/registrations\" for 2607:fea8:571f:f at 2017-10-17\nCannot render console from 2607::ee6f! Allowed networks: \nProcessing by RegistrationsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"XXXXXX==\", \"registration\"=&gt;{\"subscription_id\"=&gt;\"1\", \"full_name\"=&gt;\"NAME\", \"company\"=&gt;\"COMPANY\", \"telephone\"=&gt;\"9999999\"}, \"stripeToken\"=&gt;\"tok_XXXCCCC7777777\", \"stripeTokenType\"=&gt;\"card\", \"stripeEmail\"=&gt;\"NAME@mail.com\"}\n\n\nUnpermitted parameters: :utf8, :authenticity_token, :registration, :stripeTokenType\nUnpermitted parameters: :utf8, :authenticity_token, :registration, :stripeTokenType\n\n\n  Subscription Load (0.3ms)  SELECT  \"subscriptions\".* FROM \"subscriptions\" WHERE \"subscriptions\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n   (0.2ms)  BEGIN\n  SQL (0.5ms)  INSERT INTO \"registrations\" (\"subscription_id\", \"full_name\", \"company\", \"email\", \"telephone\", \"created_at\", \"updated_at\", \"card_token\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING \"id\"  [[\"subscription_id\", 1], [\"full_name\", \"NAME\"], [\"company\", \"COMPANY\"], [\"email\", \"NAME@mail.com\"], [\"telephone\", \"9999999\"], [\"created_at\", \"2017-10-17\"], [\"updated_at\", \"2017-10-17\"], [\"card_token\", \"tok_XXXXXXXX\"]]\n   (1.2ms)  COMMIT\nRedirected to http://1fc4a17c.ngrok.io/registrations/2\nCompleted 302 Found in 2775ms (ActiveRecord: 2.2ms)\n</code></pre>\n\n<p>And what is puzzling me is <code>end_data</code> and <code>customer_id</code> are nil, while stripe process transaction successfully and shows values for each element.</p>\n\n<pre><code>&gt;&gt; @registration\n=&gt; &lt;Registration id: 2, subscription_id: 1, full_name: \"NAME\", company: \"COMPANY\", email: \"NAME@mail.com\", telephone: \"99999999\", created_at: \"2017-10-17\", updated_at: \"2017-10-17\", card_token: \"tok_xxxxxxx\", end_date: nil, customer_id: nil&gt;\n</code></pre>\n\n<p>Am I missing any thing here?</p>\n\n<p>Thanks in advanced.</p>\n"}, {"tags": ["ruby", "gtk3"], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 2371186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a14ce433b8b47ba5c6ec029d60d5f2?s=128&d=identicon&r=PG", "display_name": "ralf", "link": "https://stackoverflow.com/users/2371186/ralf"}, "is_accepted": true, "score": 2, "last_activity_date": 1509541561, "creation_date": 1509541561, "answer_id": 47055577, "question_id": 46793712, "link": "https://stackoverflow.com/questions/46793712/ruby-gtk3-gtkaccelerator-missing-how-to-bypass/47055577#47055577", "title": "Ruby gtk3 Gtk::Accelerator missing. How to bypass?", "body": "<pre><code>key, mod = Gtk::accelerator_parse(\"N\")\n</code></pre>\n"}], "owner": {"reputation": 5039, "user_id": 178925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/688a0dd1d721a6ad62b8fdc0d64a5def?s=128&d=identicon&r=PG", "display_name": "JCLL", "link": "https://stackoverflow.com/users/178925/jcll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 47055577, "answer_count": 1, "score": 0, "last_activity_date": 1509541561, "creation_date": 1508253784, "question_id": 46793712, "link": "https://stackoverflow.com/questions/46793712/ruby-gtk3-gtkaccelerator-missing-how-to-bypass", "title": "Ruby gtk3 Gtk::Accelerator missing. How to bypass?", "body": "<p>I am trying to use Ruby gtk3 gem.</p>\n\n<p>I read through Jan Bodnar <a href=\"http://zetcode.com/gui/rubygtk/menustoolbars/\" rel=\"nofollow noreferrer\">zetcode</a>, but I hit the following problem concerning <em>image menu</em> items : despite using correct 'gtk3' gem used by the author, my system (linux, with ruby 2.4.0 used with rvm) returns that :</p>\n\n<blockquote>\n  <p>gems/glib2-3.1.8/lib/glib2/deprecatable.rb:112:in `const_missing': uninitialized constant Gtk::Accelerator (NameError)</p>\n</blockquote>\n\n<p>Here is the part of the code that causes the trouble : </p>\n\n<pre><code>newi = Gtk::ImageMenuItem.new :stock_id =&gt; Gtk::Stock::NEW,:accel_group =&gt; agr\nkey, mod = Gtk::Accelerator.parse \"N\"\nnewi.add_accelerator \"activate\", agr, key, mod, Gtk::AccelFlags::VISIBLE\n</code></pre>\n\n<p>I understand this <em>Gtk::Accelerator</em> stuff may be deprecated, but I don't know Gtk enough to bypass this lacks. What kind of objects are supposed to be passed to add_accelerator method ?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "coffeescript"], "comments": [{"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1508253912, "post_id": 46793711, "comment_id": 80534124, "body": "is your ajax call wrapped inside a $(document).ready(function() {}) ?"}, {"owner": {"reputation": 304, "user_id": 2988819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/10pD5.jpg?s=128&g=1", "display_name": "Harman", "link": "https://stackoverflow.com/users/2988819/harman"}, "edited": false, "score": 0, "creation_date": 1508253963, "post_id": 46793711, "comment_id": 80534159, "body": "Can you post the response that you&#39;re getting after the ajax call? If it is in string format and in case you&#39;re handling it in JSON format you will need to parse the response."}, {"owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "reply_to_user": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1508255140, "post_id": 46793711, "comment_id": 80534885, "body": "@GabrielMesquita yes, i have $(document).ready -&gt; then the ajax call"}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "reply_to_user": {"reputation": 304, "user_id": 2988819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/10pD5.jpg?s=128&g=1", "display_name": "Harman", "link": "https://stackoverflow.com/users/2988819/harman"}, "edited": false, "score": 0, "creation_date": 1508255210, "post_id": 46793711, "comment_id": 80534930, "body": "Ok so as @Harman said, post the response for the ajax call so we can take a look"}, {"owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "reply_to_user": {"reputation": 304, "user_id": 2988819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/10pD5.jpg?s=128&g=1", "display_name": "Harman", "link": "https://stackoverflow.com/users/2988819/harman"}, "edited": false, "score": 0, "creation_date": 1508255671, "post_id": 46793711, "comment_id": 80535184, "body": "@Harman can you explain that more?"}, {"owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "reply_to_user": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1508262420, "post_id": 46793711, "comment_id": 80538964, "body": "<a href=\"https://pastebin.com/zGjed8q8\" rel=\"nofollow noreferrer\">pastebin.com/zGjed8q8</a> @GabrielMesquita here&#39;s the response"}, {"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1508263685, "post_id": 46793711, "comment_id": 80539705, "body": "have you tried to use append instead of html? With the htmlToRender?"}, {"owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "reply_to_user": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1508264452, "post_id": 46793711, "comment_id": 80540128, "body": "Yes, didn&#39;t work @GabrielMesquita"}], "owner": {"reputation": 29, "user_id": 7203387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7894d657478623505eb49188d1ae9beb?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Fernandes", "link": "https://stackoverflow.com/users/7203387/andres-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508253778, "creation_date": 1508253778, "question_id": 46793711, "link": "https://stackoverflow.com/questions/46793711/javascript-not-loading-after-render-partial-via-ajax", "title": "Javascript not loading after render partial via ajax", "body": "<p>I'm having troubles with the javascript of a partial that I'm rendering via ajax.</p>\n\n<p>The partial has an HTML table, in this file I have javascript functions to manage the interactions with the table.</p>\n\n<p>In another file, I'm rendering this partial via ajax, like this:</p>\n\n<pre><code>   $.ajax(\n    type: 'GET'\n    url: \"#{get_debts_by_guardian_services_students_path}\"\n    data: person_id: person_id)\n</code></pre>\n\n<p>The method I'm calling via ajax returns some variables that the table needs to render.</p>\n\n<p>But when the partial renders none of the javascript functions are working, I'm guessing is because the ajax call, but don't know how to solve this. </p>\n\n<p>Please help, thanks. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paperclip"], "comments": [{"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508285621, "post_id": 46793416, "comment_id": 80548753, "body": "Does <code>event_params</code> contain the image params?"}, {"owner": {"reputation": 1726, "user_id": 4890595, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-9rPtty8_fOI/AAAAAAAAAAI/AAAAAAAAA0Y/wmx2PYqTMEQ/photo.jpg?sz=128", "display_name": "Code-MonKy", "link": "https://stackoverflow.com/users/4890595/code-monky"}, "reply_to_user": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508320075, "post_id": 46793416, "comment_id": 80561587, "body": "I found some sort of a solution by adding <code>optional: true</code> after <code>belongs_to :imageable, polymorphic: true</code> in the picture model. Then altering the create action such that the picture is made before the <code>@event.save</code>. Not ideal, because the <code>:imageable</code> is not really optional, and I can&#39;t have free floating pictures."}], "owner": {"reputation": 1726, "user_id": 4890595, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-9rPtty8_fOI/AAAAAAAAAAI/AAAAAAAAA0Y/wmx2PYqTMEQ/photo.jpg?sz=128", "display_name": "Code-MonKy", "link": "https://stackoverflow.com/users/4890595/code-monky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508252841, "creation_date": 1508252841, "question_id": 46793416, "link": "https://stackoverflow.com/questions/46793416/uploading-one-image-save-polymorphic-in-rails-5-with-paperclip", "title": "Uploading one image - save polymorphic - in Rails 5 with paperclip", "body": "<h3>My issue</h3>\n\n<p>I can't figure out how to create an event that <strong>must</strong> have one picture attached with it, the picture being polymorphic (due to the rest of the app). </p>\n\n<h3>Making an event</h3>\n\n<p><em>(Stepwise what I want.)</em></p>\n\n<ol>\n<li>Fill in a form for an event.</li>\n<li>Form can have an image attached.\n\n<ol>\n<li>Image is there.\n\n<ol>\n<li>Validation success.</li>\n<li>Event is saved to db.</li>\n</ol></li>\n<li>Image has not been selected.\n\n<ol>\n<li>Validation throws out error. </li>\n<li>Event is not saved.</li>\n</ol></li>\n</ol></li>\n</ol>\n\n<h3>My code</h3>\n\n<p>Currently what I have looks like this:</p>\n\n<p><strong>picture.rb</strong></p>\n\n<pre><code>class Picture &lt; ApplicationRecord\n  acts_as_list\n  belongs_to :imageable, polymorphic: true\n\n  has_attached_file :image,\n    :storage    =&gt; :s3,\n    :bucket     =&gt; Figaro.env.s3_bucket,\n    :s3_region  =&gt; 'eu-west-1',\n    :s3_credentials =&gt; {\n      :access_key_id      =&gt; Figaro.env.aws_access_key_id,\n      :secret_access_key  =&gt; Figaro.env.aws_secret_access_key\n    }\n\n  do_not_validate_attachment_file_type :image\nend\n</code></pre>\n\n<p><strong>event.rb</strong></p>\n\n<pre><code>class Event &lt; ApplicationRecord\n  ## Associaties\n  has_many :pictures, -&gt; { order(position: :asc) }, as: :imageable, dependent: :destroy\n  ## Validaties\n  validates_presence_of :name, :description, :date, :pictures\n  validates :name, length: { maximum: 100 }\n  validates :description, length: { maximum: 500 }\n  validates :date, in_future: true\nend\n</code></pre>\n\n<p><strong>events_controller.rb</strong></p>\n\n<pre><code>def create\n  @event = Event.new(event_params)\n  authorize @event\n\n  if @event.save\n    if params[:image]\n      @event.pictures.create(image: params[:image])\n    end\n      flash[:notice] = 'Agendapunt is toegevoegd.'\n      redirect_to events_path\n  else\n    flash.now[:alert] = 'Agendapunt is niet toegevoegd.'\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>It currently keeps on giving me a \"pictures can't be blank error\". </p>\n\n<p>I remember having the inverse problem a while back, namely how to make sure an image must me uploaded. Now I can't figure out how to fix this bug of the image not going through somehow.  </p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "date"], "comments": [{"owner": {"reputation": 1768, "user_id": 7672985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6233938657e3693fca648b313da8557?s=128&d=identicon&r=PG", "display_name": "Gabriel Mesquita", "link": "https://stackoverflow.com/users/7672985/gabriel-mesquita"}, "edited": false, "score": 0, "creation_date": 1508253057, "post_id": 46793366, "comment_id": 80533564, "body": "you need to have the dates between date X and date Y in your array?"}, {"owner": {"reputation": 84, "user_id": 4830631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fIUrT.jpg?s=128&g=1", "display_name": "eezee", "link": "https://stackoverflow.com/users/4830631/eezee"}, "edited": false, "score": 0, "creation_date": 1508253438, "post_id": 46793366, "comment_id": 80533828, "body": "(Date.today..Date.today+10.days).to_a"}, {"owner": {"reputation": 38, "user_id": 2217237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c272da1f38a844e13e5a7b1b627a8255?s=128&d=identicon&r=PG", "display_name": "Enrique Florendo", "link": "https://stackoverflow.com/users/2217237/enrique-florendo"}, "edited": false, "score": 0, "creation_date": 1508255305, "post_id": 46793366, "comment_id": 80534999, "body": "In my controller I&#39;d like to write a query and pass to an instance variable. I can query Item.bookings.pluck(:start_date, :end_date) and that would give me an array of start and end dates. I need to first get the ranges including start and end date for each array then flatten the array so all the dates are just in one array as illustrated in the example. Thank you!"}, {"owner": {"reputation": 1472, "user_id": 2567424, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cf84c50fc86c32c8db69ad465fb58653?s=128&d=identicon&r=PG", "display_name": "rogelio", "link": "https://stackoverflow.com/users/2567424/rogelio"}, "edited": false, "score": 0, "creation_date": 1508259896, "post_id": 46793366, "comment_id": 80537571, "body": "<code>Item.bookings.pluck[:start_date, :end_date].flatten</code> works?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508261669, "post_id": 46793366, "comment_id": 80538524, "body": "Don&#39;t tell me you&#39;re using a string column to store dates?"}, {"owner": {"reputation": 38, "user_id": 2217237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c272da1f38a844e13e5a7b1b627a8255?s=128&d=identicon&r=PG", "display_name": "Enrique Florendo", "link": "https://stackoverflow.com/users/2217237/enrique-florendo"}, "edited": false, "score": 0, "creation_date": 1508283494, "post_id": 46793366, "comment_id": 80548263, "body": "not using a string... thought it would more readable to use those numbers in the example, I get something that looks like this: [[&quot;2017-10-17T00:00:00.000Z&quot;,&quot;2017-10-24T00:00:00.000Z&quot;],[&quot;2&zwnj;&#8203;017-11-22T00:00:00.0&zwnj;&#8203;00Z&quot;,&quot;2017-11-22T00:&zwnj;&#8203;00:00.000Z&quot;],[&quot;2017-&zwnj;&#8203;11-22T00:00:00.000Z&quot;&zwnj;&#8203;,&quot;2017-11-22T00:00:0&zwnj;&#8203;0.000Z&quot;]]"}], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 2217237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c272da1f38a844e13e5a7b1b627a8255?s=128&d=identicon&r=PG", "display_name": "Enrique Florendo", "link": "https://stackoverflow.com/users/2217237/enrique-florendo"}, "edited": false, "score": 0, "creation_date": 1508283352, "post_id": 46794537, "comment_id": 80548218, "body": "Thanks for the response. I get an error that reads: Unsupported argument type: Symbol. Construct an Arel node instead."}, {"owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "reply_to_user": {"reputation": 38, "user_id": 2217237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c272da1f38a844e13e5a7b1b627a8255?s=128&d=identicon&r=PG", "display_name": "Enrique Florendo", "link": "https://stackoverflow.com/users/2217237/enrique-florendo"}, "edited": false, "score": 0, "creation_date": 1508356156, "post_id": 46794537, "comment_id": 80583534, "body": "That sounds like <code>pluck</code> doesn&#39;t like the array of symbols as an argument? I thought that&#39;s what you were sending in your original code. The <code>pluck</code> call should look just like whatever worked for you; none of that has anything to do with my solution. None of the rest of it touches any Rails stuff; it&#39;s just pure Ruby."}], "tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": true, "score": 2, "last_activity_date": 1508266076, "last_edit_date": 1508266076, "creation_date": 1508256390, "answer_id": 46794537, "question_id": 46793366, "link": "https://stackoverflow.com/questions/46793366/ruby-on-rails-create-a-flat-array-of-dates-using-start-and-end-date-ranges/46794537#46794537", "title": "Ruby on Rails: Create a flat array of dates using start and end date ranges", "body": "<p>Well, in order to get ranges, you need actual Date objects. To get those out of strings like yours, you'll need to use <code>Date.strptime</code>. Then you can build Ranges out of the date pairs, and then convert back to strings with <code>Date#strftime</code>:</p>\n\n<pre><code>require 'date'\nformat = '%m/%d/%y' # mm/dd/yy; adjust as needed\ndates = Item.bookings.pluck(%i&lt;start_date end_date&gt;).map do |bounds|\n  Range.new(*bounds.map { |d| Date.strptime(d, format) }).map do |d|\n    d.strftime(format)\n  end\nend.flatten\n</code></pre>\n\n<p>Which with your example data set gives me this:</p>\n\n<pre><code>[\"10/01/17\", \"10/02/17\", \"10/03/17\", \"11/02/17\", \"11/03/17\", \"11/04/17\"]\n</code></pre>\n"}], "owner": {"reputation": 38, "user_id": 2217237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c272da1f38a844e13e5a7b1b627a8255?s=128&d=identicon&r=PG", "display_name": "Enrique Florendo", "link": "https://stackoverflow.com/users/2217237/enrique-florendo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 1, "accepted_answer_id": 46794537, "answer_count": 1, "score": 1, "last_activity_date": 1508266076, "creation_date": 1508252688, "last_edit_date": 1508255387, "question_id": 46793366, "link": "https://stackoverflow.com/questions/46793366/ruby-on-rails-create-a-flat-array-of-dates-using-start-and-end-date-ranges", "title": "Ruby on Rails: Create a flat array of dates using start and end date ranges", "body": "<p>I want to get a flat array of dates in a date range for Items with many Bookings. A Booking has <code>:start_date</code> and <code>:end_date</code>.</p>\n\n<p>example, Item has these bookings: </p>\n\n<pre><code>Booking A: 10/1/17 to 10/3/17\nBooking B: 11/2/17 to 11/4/17\n</code></pre>\n\n<p>I tried using pluck. <code>Item.bookings.pluck[:start_date, :end_date]</code> and it gives me an array that looks like this <code>[[\"10,01,17\", \"10,03,17\"], [\"11,02,17\" , \"11,04,17\" ]]</code></p>\n\n<p>What I need is a flat array with the date ranges like this <code>[\"10,01,17\", \"10/02/17\", \"10,03,17\", \"11,02,17\" , \"11,03,17\", \"11/04/17\"]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "wkhtmltopdf", "wicked-pdf"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8430645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dforu.jpg?s=128&g=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/8430645/ahmed"}, "edited": false, "score": 0, "creation_date": 1512043276, "post_id": 47022605, "comment_id": 82102733, "body": "Thank you so much, it worked for me, and sorry for being so late."}], "tags": [], "owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "is_accepted": true, "score": 5, "last_activity_date": 1509390605, "creation_date": 1509390605, "answer_id": 47022605, "question_id": 46793111, "link": "https://stackoverflow.com/questions/46793111/an-issue-with-the-wkhtmltopdf-binary-gem-in-the-production/47022605#47022605", "title": "an issue with the wkhtmltopdf-binary gem in the production", "body": "<p>It sounds like your production server doesn't have an xserver installed.</p>\n\n<pre><code>sudo apt-get install libxrender1\n</code></pre>\n\n<p>should work for you on Ubuntu.</p>\n"}], "owner": {"reputation": 45, "user_id": 8430645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dforu.jpg?s=128&g=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/8430645/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 0, "accepted_answer_id": 47022605, "answer_count": 1, "score": 1, "last_activity_date": 1509390605, "creation_date": 1508252010, "last_edit_date": 1508252249, "question_id": 46793111, "link": "https://stackoverflow.com/questions/46793111/an-issue-with-the-wkhtmltopdf-binary-gem-in-the-production", "title": "an issue with the wkhtmltopdf-binary gem in the production", "body": "<p>I am using the gem 'wicked_pdf' to convert html to pdf.\nIt is working fine in the development mode. but in the production it is throwing an error by nginx.This is the error log in the production:</p>\n\n<pre><code>I, [2017-10-17T12:34:09.726920 #17004]  INFO -- : [4a94b9f6-fdf6-4e55-b325-9b3096132d4e] Completed 500 Internal Server Error in 2638ms (ActiveRecord: 30.6ms)\nF, [2017-10-17T12:34:09.729566 #17004] FATAL -- : [4a94b9f6-fdf6-4e55-b325-9b3096132d4e]   \nF, [2017-10-17T12:34:09.729763 #17004] FATAL -- : [4a94b9f6-fdf6-4e55-b325-9b3096132d4e] RuntimeError (Failed to execute:\n[\"/home/deploy/phoenix/shared/bundle/ruby/2.4.0/bin/wkhtmltopdf\", \"-q\", \"file:////tmp/wicked_pdf20171017-17004-ps7ahv.html\", \"/tmp/wicked_pdf_generated_file20171017-17004-17rkfch.pdf\"]\nError: PDF could not be generated!\nCommand Error: /home/deploy/phoenix/shared/bundle/ruby/2.4.0/gems/wkhtmltopdf-binary-0.12.3.1/bin/wkhtmltopdf_linux_amd64: error while loading shared libraries: libXrender.so.1: cannot open shared object file: No such file or directory\n):\nF, [2017-10-17T12:34:09.729900 #17004] FATAL -- : [4a94b9f6-fdf6-4e55-b325-9b3096132d4e]   \nF, [2017-10-17T12:34:09.730005 #17004] FATAL -- : [4a94b9f6-fdf6-4e55-b325-9b3096132d4e] app/controllers/orders_controller.rb:16:in `block (2 levels) in show'\n[4a94b9f6-fdf6-4e55-b325-9b3096132d4e] app/controllers/orders_controller.rb:13:in `show'\n</code></pre>\n\n<p>I gussed that I have an issue with missing lib: libXrender.so.1</p>\n\n<p>I am using on the production ubuntu 16.04 ruby:2.4.1 and rails 5.1.4\nCan I get your support please?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "group-by"], "comments": [{"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508286456, "post_id": 46793096, "comment_id": 80548931, "body": "Try something like <code>hashSetPrimary = hashSetPrimary.map { |k, v| [k, v.count] }.sort_by(:last)</code>."}, {"owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "reply_to_user": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508313012, "post_id": 46793096, "comment_id": 80557349, "body": "@henrebotha it is complaining it can&#39;t find the count method <code>undefined method &#39;count&#39; for nil:NilClass (NoMethodError)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508314939, "post_id": 46805498, "comment_id": 80558438, "body": "I must be missing something here because it is complaining <code>undefined method [] for nil:NilClass (NoMethodError)</code>. I am not sure what it is referring to by [], probably one of the nodes I am trying to access? e.g. [:history] etc. Sorry I am being so daft, I started learning ruby yesterday lol..."}, {"owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508317310, "post_id": 46805498, "comment_id": 80559783, "body": "That&#39;s what I get: <code>statsTry.rb:127:in &#39;block in myMethodTest&#39;: undefined method &#39;[]&#39; for nil:NilClass (NoMethodError)         from statsTry.rb:127:in &#39;each&#39;         from statsTry.rb:127:in &#39;group_by&#39;         from statsTry.rb:127:in &#39;myMethodTest&#39;         from statsTry.rb:175:in &#39;&lt;main&gt;&#39;</code>"}, {"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "reply_to_user": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508317403, "post_id": 46805498, "comment_id": 80559836, "body": "Okay but I don&#39;t have your file in front of me, I don&#39;t know which is line 127."}, {"owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508317589, "post_id": 46805498, "comment_id": 80559957, "body": "127 is literally <code>hashSetPrimary = sourceHash.group_by{ |h| h[:history][:createdBy][:displayName] }</code>"}, {"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "reply_to_user": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508318351, "post_id": 46805498, "comment_id": 80560427, "body": "Does any of your parsed JSON lack a <code>:history</code>, <code>:createdBy</code>, or <code>:displayName</code>?"}, {"owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508318569, "post_id": 46805498, "comment_id": 80560567, "body": "Honestly I am not sure, the JSON I get from the service is kind of huge. They <i>might</i> be missing under some json objects."}, {"owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "reply_to_user": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "edited": false, "score": 0, "creation_date": 1508318772, "post_id": 46805498, "comment_id": 80560687, "body": "Updated answer."}, {"owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "reply_to_user": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "edited": false, "score": 0, "creation_date": 1508319605, "post_id": 46805498, "comment_id": 80561253, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/156989/discussion-between-michael-wayne-and-henrebotha\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1088, "user_id": 1966418, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Kp08C.jpg?s=128&g=1", "display_name": "henrebotha", "link": "https://stackoverflow.com/users/1966418/henrebotha"}, "is_accepted": false, "score": 1, "last_activity_date": 1508318755, "last_edit_date": 1508318755, "creation_date": 1508314180, "answer_id": 46805498, "question_id": 46793096, "link": "https://stackoverflow.com/questions/46793096/ruby-grouping-data-by-parsed-rest-json-result-property/46805498#46805498", "title": "RUBY Grouping data by parsed REST JSON result property", "body": "<p>Firstly, you need to look at your hash syntax. When you define a hash using <code>h = { \"foo\": \"bar\" }</code>, the key is <strong>not</strong> actually a string, but rather a symbol. Therefore accessing <code>h[\"foo\"]</code> is not going to work (it will return <code>nil</code>); you have to access it as <code>h[:foo]</code>.</p>\n\n<p>So addressing that, this does what you need:</p>\n\n<pre><code>sourceHash = @mainData[:results]\n\nhashSetPrimary = sourceHash.group_by{ |h| h.dig(:history, :createdBy, :displayName) }\n                           .map { |k, v| [k, v.count] }\n                           .sort_by(&amp;:last)\n\nreturn hashSetPrimary\n</code></pre>\n\n<p><code>Hash#dig</code> requires Ruby 2.3+. If you are running on a lower version, you can do something like this instead of <code>dig</code>:</p>\n\n<pre><code>h[:history] &amp;&amp; h[:history][:createdBy] &amp;&amp; h[:history][:createdBy][:displayName]\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 6528585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/74996e9c9e27d7c160bfd802aa2a4dbb?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wayne", "link": "https://stackoverflow.com/users/6528585/michael-wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508318755, "creation_date": 1508251960, "last_edit_date": 1508314982, "question_id": 46793096, "link": "https://stackoverflow.com/questions/46793096/ruby-grouping-data-by-parsed-rest-json-result-property", "title": "RUBY Grouping data by parsed REST JSON result property", "body": "<p>First of all, I am very new to Ruby so go easy on me! I have the parsed JSON in my sourceHash variable and I am trying to group data by the \"displayName\" property. The JSON format is something like this (I've simplified it without changing the structure):</p>\n\n<pre><code>{\n    \"results\": [\n        {\n            \"id\": \"12345\",\n            \"title\": \"my blog post\",\n            \"history\": {\n                \"createdOn\": \"2017-09-18 15:38:26\",\n                \"createdBy\": {\n                    \"userName\": \"myUserName\",\n                    \"displayName\": \"Michael W.\"\n                }\n            }\n        },\n        { ... same stuff for some other blog post ... },\n        { ... same stuff for some other blog post ... },\n        { ... same stuff for some other blog post ... }\n    ]\n}\n</code></pre>\n\n<p>Basically, there are two things I want to do.\nImagine this list as \"list of blog posts including the author data\" of them.</p>\n\n<ul>\n<li>Find the person who posted the most amount of entries</li>\n<li>Get the top 10 bloggers, ordered by their blog post count, descending</li>\n</ul>\n\n<p>So the first would look something like this:</p>\n\n<blockquote>\n  <blockquote>\n    <p>Michael W. (51 posts)</p>\n  </blockquote>\n</blockquote>\n\n<p>However, the second one would look like this:</p>\n\n<blockquote>\n  <blockquote>\n    <ul>\n    <li>Michael Wayne (51 posts)</li>\n    <li>Emilia Clarke (36 posts)</li>\n    <li>Charlize Theron (19 posts)</li>\n    <li>Scarlett Johansson (7 posts)</li>\n    </ul>\n  </blockquote>\n</blockquote>\n\n<p>I've played around these queries, trying to merge my LINQ logic into this, but I failed... (I'm a Ruby noob so be easy!)</p>\n\n<pre><code>sourceHash = @mainData[\"results\"]\n\nhashSetPrimary = sourceHash.group_by{|h| h['history']['createdBy']['displayName']}\n\nreturn hashSetPrimary\n</code></pre>\n\n<p>So long story short, I am trying to write to separate queries that would group the data by those criteria, any help is appreciated as I can't find any proper way to do it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "autocomplete", "jquery-ui-autocomplete", "cocoon-gem"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1508317216, "post_id": 46792628, "comment_id": 80559731, "body": "Your question is hard to understand, but I am guessing that is because of the language. Imho your <code>cocoon:after-insert</code> can never be triggered, so it will <i>not</i> add <code>hola</code> in the console, is that correct? You should attach the event handler to a <i>surrounding</i> element, e.g. like a div or the form itself."}, {"owner": {"reputation": 11, "user_id": 6013507, "user_type": "registered", "profile_image": "https://graph.facebook.com/969229006500464/picture?type=large", "display_name": "Loco Petirrojo", "link": "https://stackoverflow.com/users/6013507/loco-petirrojo"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1508761256, "post_id": 46792628, "comment_id": 80725567, "body": "I insert a video of my code <a href=\"https://youtu.be/dXIkxTD0zbM\" rel=\"nofollow noreferrer\">youtu.be/dXIkxTD0zbM</a>"}, {"owner": {"reputation": 11, "user_id": 6013507, "user_type": "registered", "profile_image": "https://graph.facebook.com/969229006500464/picture?type=large", "display_name": "Loco Petirrojo", "link": "https://stackoverflow.com/users/6013507/loco-petirrojo"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1508761335, "post_id": 46792628, "comment_id": 80725627, "body": "yes, my code shows hola"}], "owner": {"reputation": 11, "user_id": 6013507, "user_type": "registered", "profile_image": "https://graph.facebook.com/969229006500464/picture?type=large", "display_name": "Loco Petirrojo", "link": "https://stackoverflow.com/users/6013507/loco-petirrojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508762381, "creation_date": 1508250564, "last_edit_date": 1508762381, "question_id": 46792628, "link": "https://stackoverflow.com/questions/46792628/autocomplete-is-not-working-with-cocoon-in-rails", "title": "Autocomplete is not working with cocoon in Rails", "body": "<p>I try to use autocomplete in a form in cocoon but I can not do it, these are my codes</p>\n\n<p>In my form:</p>\n\n<pre><code>                &lt;div class=\"col l6 m6 s12\" style=\"margin-bottom:40px\"&gt;\n              &lt;%= link_to_add_association '&lt;i class=\"material-icons left\" style=\"font-size:2rem\"&gt;playlist_add&lt;/i&gt;Agregar m\u00f3dulo'.html_safe, f, :modulus, onclick:'count_modulus()' , class: 'btn waves-effect waves-light light-green z-depth-3 button-add_modulu', style:'position: absolute;', data: { association_insertion_node: '.modulu', association_insertion_method: :append } %&gt;\n            &lt;/div&gt;\n\n            &lt;div id=\"demo\" class=\"center-align\"&gt;\u00bfEsta seguro que desea eliminar este modulo?&lt;/div&gt;  \n            &lt;ul class='col s12 modulu countBody collapsible popout' data-collapsible=\"accordion\" style=\"padding: 0;\"&gt;\n              &lt;%= f.simple_fields_for :modulus do |builder| %&gt;\n                &lt;%= render 'modulu_fields', f: builder %&gt;\n              &lt;% end %&gt;\n             &lt;/ul&gt;\n</code></pre>\n\n<p>In mi nested:</p>\n\n<pre><code>&lt;li class=\"nested-fields\"&gt;\n  &lt;div class=\"input-field col s12\" &gt;\n    &lt;i class=\"material-icons prefix\"&gt;import_contacts&lt;/i&gt;\n    &lt;%= f.text_field :description, class: 'autocomplete', data: {autocomplete_source: @hola.map} %&gt;\n    &lt;%= f.label :description %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p></li></p>\n\n<p>In mi js file:</p>\n\n<pre><code>  $('.modulu').on('cocoon:after-insert', function(e, added_thing) {\n  console.log('hola')\n  added_thing.find($('input.autocomplete')).focus(function(){\n    $(this).autocomplete({\n       minLength: 2,\n       source: [\"foo\",\"foobar\",\"foobaz\"]\n        });\n});\n</code></pre>\n\n<p>});</p>\n\n<p>it looks like this, in fact it shows up the console.log</p>\n\n<p><a href=\"https://i.stack.imgur.com/f08Mn.jpg\" rel=\"nofollow noreferrer\">imagen</a>\nHelp :c</p>\n\n<p>UPDATE:\nMore simple:</p>\n\n<p>In my form:</p>\n\n<pre><code>              &lt;div class=\"row\"&gt;\n            &lt;div class=\"col l6 m6 s12\" style=\"margin-bottom:40px\"&gt;\n              &lt;%= link_to_add_association '&lt;i class=\"material-icons left\" style=\"font-size:2rem\"&gt;playlist_add&lt;/i&gt;Agregar m\u00f3dulo'.html_safe, f, :modulus, onclick:'count_modulus()' , class: 'btn waves-effect waves-light light-green z-depth-3 button-add_modulu', style:'position: absolute;', data: { association_insertion_node: '.modulu', association_insertion_method: :append } %&gt;\n            &lt;/div&gt;\n            &lt;!-- information for complete --&gt;\n            &lt;%= content_tag :div, class: \"temp_information\", data: {autocomplete_source: @programas.map} do %&gt;\n            &lt;% end %&gt;\n            &lt;!-- form --&gt;\n            &lt;div class='col s12 modulu' style=\"padding: 0;\"&gt;\n              &lt;%= f.simple_fields_for :modulus do |builder| %&gt;\n                &lt;%= render 'modulu_fields', f: builder %&gt;\n              &lt;% end %&gt;\n             &lt;/div&gt;\n          &lt;/div&gt;\n</code></pre>\n\n<p>In my nested:</p>\n\n<pre><code>&lt;div class=\"nested-fields\"&gt;\n  &lt;div class=\"input-field col s12\" &gt;\n   &lt;!-- this element I need complete --&gt;\n   &lt;i class=\"material-icons prefix\"&gt;import_contacts&lt;/i&gt;\n   &lt;%= f.text_field :name, class: 'jojo' %&gt;\n   &lt;%= f.label :name %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p>In my js:</p>\n\n<pre><code>  // my js \n  $('ul.modulu').on('cocoon:after-insert', function(e, added_thing) {\n   console.log('hola');\n   $(\".jojo\").autocomplete({ \n   source: function(request, response) {\n  var results = \n   $.ui.autocomplete.filter($('.temp_information').data('temp'), request.term);\n  response(results.slice(0, 5));\n    }\n  });\n });\n</code></pre>\n\n<p>My code in video:\n<a href=\"https://youtu.be/dXIkxTD0zbM\" rel=\"nofollow noreferrer\">https://youtu.be/dXIkxTD0zbM</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hashmap"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 3, "creation_date": 1508248975, "post_id": 46791986, "comment_id": 80530600, "body": "There is no &quot;map&quot; in Ruby, there are Hashes."}, {"owner": {"reputation": 629, "user_id": 759615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ab68e6341e562ba43a16ee7f7baf8aa?s=128&d=identicon&r=PG", "display_name": "GLaDOS", "link": "https://stackoverflow.com/users/759615/glados"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1508260834, "post_id": 46791986, "comment_id": 80538069, "body": "@meagar busted! I use groovy all day long... in which there are maps all over the place :D"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508248884, "post_id": 46792043, "comment_id": 80530532, "body": "<code>(map[key] ||= {}).store(:name, value)</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508248916, "post_id": 46792043, "comment_id": 80530558, "body": "@mudasobwa Me, I wouldn&#39;t go this far. But to each his own :)"}, {"owner": {"reputation": 629, "user_id": 759615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ab68e6341e562ba43a16ee7f7baf8aa?s=128&d=identicon&r=PG", "display_name": "GLaDOS", "link": "https://stackoverflow.com/users/759615/glados"}, "edited": false, "score": 1, "creation_date": 1508260947, "post_id": 46792043, "comment_id": 80538120, "body": "@SergioTulentsev I would go that far.  I love Ruby&#39;s elegance."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1508249029, "last_edit_date": 1508249029, "creation_date": 1508248855, "answer_id": 46792043, "question_id": 46791986, "link": "https://stackoverflow.com/questions/46791986/is-there-a-less-awkward-way-to-store-a-value-in-a-ruby-hash/46792043#46792043", "title": "Is there a less awkward way to store a value in a Ruby hash?", "body": "<blockquote>\n  <p>Is there a less awkward way?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<pre><code>map[key] ||= {}\nmap[key].store(:name, value) # or map[key][:name] = value\n</code></pre>\n\n<p>Or make use of one of Hash missing value handlers.</p>\n\n<pre><code>map = Hash.new { |hash, key| hash[key] = {} }\n# then set fearlessly, missing hashes will be auto-created.\nmap[key][:name] = value\n</code></pre>\n"}], "owner": {"reputation": 629, "user_id": 759615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ab68e6341e562ba43a16ee7f7baf8aa?s=128&d=identicon&r=PG", "display_name": "GLaDOS", "link": "https://stackoverflow.com/users/759615/glados"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 46792043, "answer_count": 1, "score": 2, "last_activity_date": 1508260780, "creation_date": 1508248687, "last_edit_date": 1508260780, "question_id": 46791986, "link": "https://stackoverflow.com/questions/46791986/is-there-a-less-awkward-way-to-store-a-value-in-a-ruby-hash", "title": "Is there a less awkward way to store a value in a Ruby hash?", "body": "<p>I have a hash of hashes in Ruby to which I'm inserting new hashes or adding values to existing hashes.\nI keep feeling like Ruby has a better way to do this:</p>\n\n<pre><code>map   # =&gt; { 1 =&gt; {:type =&gt; \"humbug\", :name =&gt; \"grinch\" }, 2 =&gt; {:type =&gt; 2 } }\n\n  if map[key]\n    map[key].store(:name, value)\n  else\n    map[key] = { name: value }\n  end\n</code></pre>\n\n<p>I want to be able to do something like </p>\n\n<pre><code>map[key].store(:name, value) || map[key] = {name: value}\n</code></pre>\n\n<p>but of course that fails if there is no <code>value</code> at <code>map[key]</code>\n... suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos"], "comments": [{"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1508248324, "post_id": 46791760, "comment_id": 80530174, "body": "How did you install 2.4.2? Did you use <code>rvm</code> for that too? Could you run <code>which rvm</code> and report back? <code>which ruby</code>?"}, {"owner": {"reputation": 21, "user_id": 8527541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w85DAdB1l3I/AAAAAAAAAAI/AAAAAAAAAAo/lgDNgUbwCK4/photo.jpg?sz=128", "display_name": "Han Zheng", "link": "https://stackoverflow.com/users/8527541/han-zheng"}, "reply_to_user": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1508255546, "post_id": 46791760, "comment_id": 80535132, "body": "yeah, and I have solved the problem, thank you very much"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8527541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w85DAdB1l3I/AAAAAAAAAAI/AAAAAAAAAAo/lgDNgUbwCK4/photo.jpg?sz=128", "display_name": "Han Zheng", "link": "https://stackoverflow.com/users/8527541/han-zheng"}, "is_accepted": false, "score": 1, "last_activity_date": 1508255934, "creation_date": 1508255934, "answer_id": 46794376, "question_id": 46791760, "link": "https://stackoverflow.com/questions/46791760/error-running-rvm-make-j8-in-macos/46794376#46794376", "title": "Error running &#39;__rvm_make -j8&#39; in MacOS", "body": "<p>I found the reason that is a bug of newest Xcode.</p>\n\n<p>Probably because the font or coding format is not compatible, so if you try</p>\n\n<pre><code>xcode-select --install\n</code></pre>\n\n<p>and continue to try your install command</p>\n\n<pre><code>rvm install 2.3.1\n</code></pre>\n\n<p>It may help you :)</p>\n"}, {"tags": [], "owner": {"reputation": 4437, "user_id": 1183098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wbe4o.png?s=128&g=1", "display_name": "user9869932", "link": "https://stackoverflow.com/users/1183098/user9869932"}, "is_accepted": false, "score": 0, "last_activity_date": 1581533608, "creation_date": 1581533608, "answer_id": 60195136, "question_id": 46791760, "link": "https://stackoverflow.com/questions/46791760/error-running-rvm-make-j8-in-macos/60195136#60195136", "title": "Error running &#39;__rvm_make -j8&#39; in MacOS", "body": "<p>Try using:</p>\n\n<pre><code>brew install openssl\nrvm install 2.3 --with-openssl-dir=/usr/local/opt/openssl\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8527541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w85DAdB1l3I/AAAAAAAAAAI/AAAAAAAAAAo/lgDNgUbwCK4/photo.jpg?sz=128", "display_name": "Han Zheng", "link": "https://stackoverflow.com/users/8527541/han-zheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1581533608, "creation_date": 1508248018, "last_edit_date": 1592644375, "question_id": 46791760, "link": "https://stackoverflow.com/questions/46791760/error-running-rvm-make-j8-in-macos", "title": "Error running &#39;__rvm_make -j8&#39; in MacOS", "body": "<p>Now my ruby version is 2.4.2p198 (2017-09-14 revision 59899) [x86_64-darwin16]</p>\n<p>But my teachers in university ask us to install 2.3.1, so I have tried <code>rvm install 2.3.1</code> but it reports</p>\n<blockquote>\n<p>Error running '__rvm_make -j8',</p>\n<p>please read /Users/mac/.rvm/log/1508247055_ruby-2.3.1/make.log There\nhas been an error while running make. Halting the installation.</p>\n</blockquote>\n<p>There is the make.log</p>\n<blockquote>\n<p>dyld: lazy symbol binding failed: Symbol not found: _utimensat<br />\nReferenced from: /Users/mac/.rvm/src/ruby-2.3.1/./miniruby   Expected\nin: /usr/lib/libSystem.B.dylib</p>\n<p>dyld: Symbol not found: _utimensat   Referenced from:\n/Users/mac/.rvm/src/ruby-2.3.1/./miniruby   Expected in:\n/usr/lib/libSystem.B.dylib</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508247538, "post_id": 46791494, "comment_id": 80529584, "body": "Did you use Rails&#39; <code>serialize :country_trips</code> or did you use your RDMS built-in system for storing arrays? (like this for postgres <a href=\"https://www.postgresql.org/docs/9.1/static/arrays.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.1/static/arrays.html</a>)"}, {"owner": {"reputation": 856, "user_id": 3755578, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmkSj.jpg?s=128&g=1", "display_name": "eudaimonia", "link": "https://stackoverflow.com/users/3755578/eudaimonia"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508247606, "post_id": 46791494, "comment_id": 80529631, "body": "I&#39;m using postgres array"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508247874, "post_id": 46791494, "comment_id": 80529838, "body": "try this <code>TravelIdea.where(&#39;country_trips = any(?)&#39;, &#39;PL&#39;)</code> (you can google <i>postgres array rails</i> and you will find useful information like this one <a href=\"https://coderwall.com/p/sud9ja/rails-4-the-postgresql-array-data-type\" rel=\"nofollow noreferrer\">coderwall.com/p/sud9ja/rails-4-the-postgresql-array-data-typ&zwnj;&#8203;e</a>)"}, {"owner": {"reputation": 856, "user_id": 3755578, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmkSj.jpg?s=128&g=1", "display_name": "eudaimonia", "link": "https://stackoverflow.com/users/3755578/eudaimonia"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1508248034, "post_id": 46791494, "comment_id": 80529946, "body": "I tried this and it returns error  output error: #&lt;ActiveRecord::StatementInvalid: PG::UndefinedObject: ERROR:  could not find array type for data type text[]"}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "is_accepted": true, "score": 1, "last_activity_date": 1508262086, "last_edit_date": 1508262086, "creation_date": 1508248004, "answer_id": 46791756, "question_id": 46791494, "link": "https://stackoverflow.com/questions/46791494/ruby-on-rails-active-record-query-return-if-field-record-with-array-not-con/46791756#46791756", "title": "Ruby on rails / Active Record Query: return if field / record with array not contains element", "body": "<p>This is more a postgres question, section <a href=\"https://www.postgresql.org/docs/9.6/static/arrays.html\" rel=\"nofollow noreferrer\">8.15.5. Searching in Arrays</a> says:</p>\n\n<pre><code>SELECT * FROM sal_emp WHERE 10000 = ANY (pay_by_quarter);\n</code></pre>\n\n<p>In your case, you could write that as a SQL segment inside the <code>.where</code> method:</p>\n\n<pre><code>TravelIdea.where(\"? = ANY (country_trips)\", country)\n</code></pre>\n"}], "owner": {"reputation": 856, "user_id": 3755578, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmkSj.jpg?s=128&g=1", "display_name": "eudaimonia", "link": "https://stackoverflow.com/users/3755578/eudaimonia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 46791756, "answer_count": 1, "score": 0, "last_activity_date": 1508262086, "creation_date": 1508247234, "question_id": 46791494, "link": "https://stackoverflow.com/questions/46791494/ruby-on-rails-active-record-query-return-if-field-record-with-array-not-con", "title": "Ruby on rails / Active Record Query: return if field / record with array not contains element", "body": "<p>I've got in my <code>TravelIdeas</code> table field <code>country_trips</code>, which includes the array of countries.</p>\n\n<pre><code>#&lt;TravelIdea:0x007faa7bec40f0&gt; {\n                      :id =&gt; 9,\n                :idea_key =&gt; \"romantic\",\n               :idea_type =&gt; nil,\n                    :cost =&gt; 2000,\n              :created_at =&gt; Mon, 10 Jul 2017 07:48:49 UTC +00:00,\n              :updated_at =&gt; Mon, 16 Oct 2017 08:10:47 UTC +00:00,\n           :country_trips =&gt; [\n                [0] \"PL\"\n               ],\n     :available_languages =&gt; [\n                [0] \"pl\"\n              ]\n}\n</code></pre>\n\n<p>Local travels has nil in <code>:country_trips</code>, so I can ignore them: </p>\n\n<p><code>idea.where.not(country_trips: nil) if country.present?</code></p>\n\n<p>I've got my user destination country, so I want to show him all travel ideas which contains his dreamed country.</p>\n\n<p>It would be sth like SQL server CONTAINS (column, 'country')</p>\n\n<p>Probably this is not about <code>LIKE</code> because this is not about matching 1 country to 1 country.</p>\n\n<p>For example\n<code>country = user.destination_country</code>\nmeans:\n<code>country = \"PL\"</code></p>\n\n<p>but </p>\n\n<pre><code>:country_trips =&gt; [\n   [0] \"PL\",\n   [1] \"DE\"\n   ],\n</code></pre>\n\n<p>I'm looking for sth like</p>\n\n<p><code>TravelIdea.where(country_trips: country)</code></p>\n\n<p>that will return all travel ideas which have this country in country_trips array :P</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1508247274, "creation_date": 1508247274, "answer_id": 46791508, "question_id": 46791449, "link": "https://stackoverflow.com/questions/46791449/understanding-get-routes-in-rails/46791508#46791508", "title": "Understanding &#39;GET&#39; routes in rails", "body": "<p>One route generated by <code>resources :cards</code> is <code>get '/cards/:id'</code>. Can you see the issue? <code>get_schema</code> is recognized as id. Try this one</p>\n\n<pre><code>resources :cards do\n  get 'get_schema', on: :collection\nend\n</code></pre>\n\n<p>Or just put that route on top</p>\n\n<pre><code>get '/cards/get_schema' =&gt; 'cards#get_schema'\nresources :cards\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6058, "user_id": 662425, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-JXe9IA2rZYM/AAAAAAAAAAI/AAAAAAAAGEg/RlIJwUwmP90/photo.jpg?sz=128", "display_name": "AnkitG", "link": "https://stackoverflow.com/users/662425/ankitg"}, "is_accepted": false, "score": 1, "last_activity_date": 1508247641, "last_edit_date": 1508247641, "creation_date": 1508247336, "answer_id": 46791529, "question_id": 46791449, "link": "https://stackoverflow.com/questions/46791449/understanding-get-routes-in-rails/46791529#46791529", "title": "Understanding &#39;GET&#39; routes in rails", "body": "<blockquote>\n  <p>It depends on the order of routes defined.</p>\n</blockquote>\n\n<p><strong>Order 1</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  resources :cards do\n  end\n\n  get '/cards/get_schema' =&gt; 'cards#get_schema'\nend\n</code></pre>\n\n<p>Running routes </p>\n\n<pre><code>rake routes\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>~/D/p/p/s/console_test&gt; rake routes\n          Prefix Verb   URI Pattern                 Controller#Action\n           cards GET    /cards(.:format)            cards#index\n                 POST   /cards(.:format)            cards#create\n        new_card GET    /cards/new(.:format)        cards#new\n       edit_card GET    /cards/:id/edit(.:format)   cards#edit\n            card GET    /cards/:id(.:format)        cards#show #&lt;======== \n                 PATCH  /cards/:id(.:format)        cards#update\n                 PUT    /cards/:id(.:format)        cards#update\n                 DELETE /cards/:id(.:format)        cards#destroy\ncards_get_schema GET    /cards/get_schema(.:format) cards#get_schema #&lt;========\n</code></pre>\n\n<p>Since show expects <code>cards/:id</code> and is above <code>/cards/get_schema</code> it gets routed to <code>cards#show</code></p>\n\n<p><strong>Order 2</strong> </p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  get '/cards/get_schema' =&gt; 'cards#get_schema'\n\n  resources :cards do\n  end\n\nend\n</code></pre>\n\n<p>Running routes </p>\n\n<pre><code>rake routes\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>  ~/D/p/p/s/console_test&gt; rake routes\n          Prefix Verb   URI Pattern                 Controller#Action\ncards_get_schema GET    /cards/get_schema(.:format) cards#get_schema #&lt;========\n           cards GET    /cards(.:format)            cards#index\n                 POST   /cards(.:format)            cards#create\n        new_card GET    /cards/new(.:format)        cards#new\n       edit_card GET    /cards/:id/edit(.:format)   cards#edit\n            card GET    /cards/:id(.:format)        cards#show #&lt;========\n                 PATCH  /cards/:id(.:format)        cards#update\n                 PUT    /cards/:id(.:format)        cards#update\n                 DELETE /cards/:id(.:format)        cards#destroy\n</code></pre>\n\n<p>In this scenario <code>/cards/get_schema</code> will be top level and won't conflict with <code>cards#show</code></p>\n"}, {"tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": false, "score": 1, "last_activity_date": 1508247380, "creation_date": 1508247380, "answer_id": 46791539, "question_id": 46791449, "link": "https://stackoverflow.com/questions/46791449/understanding-get-routes-in-rails/46791539#46791539", "title": "Understanding &#39;GET&#39; routes in rails", "body": "<p>Rails is treating <code>get_schema</code> as the id of a card. The solution is to reorder the route declarations, like so:</p>\n\n<pre><code>get '/cards/get_schema' =&gt; 'cards#get_schema'\n\nresources :cards do\nend\n</code></pre>\n\n<p>This way the <code>get_schema</code> route will be matched before the <code>show</code> route.</p>\n"}], "owner": {"reputation": 879, "user_id": 3686096, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fccaae7d8c34340d41508370ca291d0e?s=128&d=identicon&r=PG", "display_name": "Projjol", "link": "https://stackoverflow.com/users/3686096/projjol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1508247641, "creation_date": 1508247085, "question_id": 46791449, "link": "https://stackoverflow.com/questions/46791449/understanding-get-routes-in-rails", "title": "Understanding &#39;GET&#39; routes in rails", "body": "<p>In my routes file I have specified:</p>\n\n<pre><code>resources :cards do\nend\n</code></pre>\n\n<p>Apart from the basic CRUD routes I have another route which is as follows:</p>\n\n<pre><code>get '/cards/get_schema' =&gt; 'cards#get_schema'\n</code></pre>\n\n<p>When I hit this endpoint, I'm actually taken to <code>cards#show</code>. Why does this happen?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "bcrypt-ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508245704, "post_id": 46790105, "comment_id": 80528213, "body": "try <code>binding.pry</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508249632, "post_id": 46790105, "comment_id": 80531061, "body": "Did you perform the final step: <code>bundle install</code>??"}, {"owner": {"reputation": 2157, "user_id": 5849229, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/d77f7eef721220ff7fa979025e6d31b9?s=128&d=identicon&r=PG&f=1", "display_name": "gdfgdfg", "link": "https://stackoverflow.com/users/5849229/gdfgdfg"}, "edited": false, "score": 0, "creation_date": 1508250604, "post_id": 46790105, "comment_id": 80531756, "body": "Of course, and <code>Devise</code> works fine. It uses <code>BCrypt</code>"}, {"owner": {"reputation": 2157, "user_id": 5849229, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/d77f7eef721220ff7fa979025e6d31b9?s=128&d=identicon&r=PG&f=1", "display_name": "gdfgdfg", "link": "https://stackoverflow.com/users/5849229/gdfgdfg"}, "edited": false, "score": 0, "creation_date": 1508250629, "post_id": 46790105, "comment_id": 80531784, "body": "I <code>Ubuntu</code> I have no problems."}], "owner": {"reputation": 2157, "user_id": 5849229, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/d77f7eef721220ff7fa979025e6d31b9?s=128&d=identicon&r=PG&f=1", "display_name": "gdfgdfg", "link": "https://stackoverflow.com/users/5849229/gdfgdfg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508243149, "creation_date": 1508243149, "question_id": 46790105, "link": "https://stackoverflow.com/questions/46790105/nameerror-exception-uninitialized-constant-bcrypt-rails-5-windows", "title": "NameError Exception: uninitialized constant BCrypt Rails 5, Windows", "body": "<p>I am using <code>Devise</code> with <code>Rails 5</code> on <code>Windows</code>. I know about the problem with <code>Windows</code> and <code>BCrypt</code> and I am following the instructions from internet to make it work:</p>\n\n<ol>\n<li>uninstall all bcrypt gem versions with <code>gem uninstall bcrypt</code> and select option 3 (if exist);</li>\n<li><code>gem uninstall bcrypt-ruby</code> and select option 3 (if exist);</li>\n<li>install bcrypt using <code>gem install bcrypt --platform=ruby</code>;</li>\n<li>add this line <code>gem 'bcrypt', platforms: :ruby</code> to Gemfile.</li>\n</ol>\n\n<p>And I thinks it works, because <code>Devise</code> depends on <code>BCrypt</code> and <code>Devise</code> works fine. </p>\n\n<p>The problem is when I use <code>Byebug</code> and use in the console <code>BCrypt</code>, I am getting an error:</p>\n\n<blockquote>\n  <p>NameError Exception: uninitialized constant users::PasswordsController::BCrypt</p>\n</blockquote>\n\n<p>This is where it is <code>byebug</code>:</p>\n\n<pre><code>def edit\n  byebug\nend\n</code></pre>\n\n<p>It is in the controller which inherits from <code>Devise::PasswordsController</code> and it just show the view.</p>\n\n<p>For the example, if I type: <code>BCrypt::Engine.generate_salt</code>, I am getting that error.</p>\n"}, {"tags": ["ruby", "rescue"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1508242820, "post_id": 46789878, "comment_id": 80526238, "body": "Go back to your old way."}, {"owner": {"reputation": 764, "user_id": 3941583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8491782c07722842e31ab6fd3c68c12?s=128&d=identicon&r=PG", "display_name": "Peter Toth - Toma", "link": "https://stackoverflow.com/users/3941583/peter-toth-toma"}, "edited": false, "score": 0, "creation_date": 1508244700, "post_id": 46789878, "comment_id": 80527481, "body": "I agree with Sergio, clever one liners are not so readable many times. Just create some helper methods."}, {"owner": {"reputation": 4220, "user_id": 1661012, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/abc04c76810d98405fc0f27f96c6c5e5?s=128&d=identicon&r=PG", "display_name": "user137369", "link": "https://stackoverflow.com/users/1661012/user137369"}, "edited": false, "score": 0, "creation_date": 1508260612, "post_id": 46789878, "comment_id": 80537950, "body": "I think I was clear why I don\u2019t want to go back to the old way. If the only argument is \u201cgo back to the old way\u201d, might as well just stick with the new."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1508248785, "post_id": 46789965, "comment_id": 80530469, "body": "\u201cI&#39;d create some helper methods\u201d\u2014my eyes are bleeding :) Do you <i>really</i> think, that mysterious <code>safe_read_lines</code> for future readers of this code (who accomplished at least 1st level in ruby) is more readable, than <code>File.readlines(firs_file) rescue []</code>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508249398, "post_id": 46789965, "comment_id": 80530893, "body": "@mudasobwa: naming could be improved, undoubtedly. But yes, I do believe that this concept of &quot;try your best at reading this yaml file&quot; reads better when given a name. Higher level of abstraction. <code>YAML.load_file(second_file) rescue {}</code> - this is expressed with at least 4 &quot;bits&quot; of information, when in reality it&#39;s just one, &quot;read yaml file&quot;. Why compile code in your head. trying to infer the <i>meaning</i> of the code when you can avoid it? Also, read the last part :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1508249571, "post_id": 46789965, "comment_id": 80531021, "body": "@mudasobwa: also there&#39;s nothing &quot;mysterious&quot; about that method. Its definition is one keystroke away (for those with  powered editors) :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4220, "user_id": 1661012, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/abc04c76810d98405fc0f27f96c6c5e5?s=128&d=identicon&r=PG", "display_name": "user137369", "link": "https://stackoverflow.com/users/1661012/user137369"}, "edited": false, "score": 0, "creation_date": 1508260571, "post_id": 46789965, "comment_id": 80537926, "body": "@user137369 &#175;\\_(\u30c4)_/&#175;"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1508243101, "last_edit_date": 1508243101, "creation_date": 1508242669, "answer_id": 46789965, "question_id": 46789878, "link": "https://stackoverflow.com/questions/46789878/short-alternative-to-ternary-and-rescue-in-modifier-form/46789965#46789965", "title": "Short alternative to ternary and rescue in modifier form", "body": "<p>If I was <em>really</em> concerned about readability of those lines, I'd create some helper methods.</p>\n\n<pre><code>def read_with_fallback(filename, fallback)\n  File.exist?(filename) ? yield(File.open(filename)) : fallback\nend\n\ndef safe_read_lines(filename)\n  read_with_fallback(first_file, []) {|file| file.readlines }\nend\n\ndef safe_read_yaml(filename)\n  read_with_fallback(second_file, {}) {|file| YAML.parse(file.read) }\nend\n\nfirst_file = \"#{__dir__}/first_file.txt\"\nfirst_data = safe_read_lines(first_file)\n\nsecond_file = \"#{__dir__}/second_file.yaml\"\nsecond_data = safe_read_yaml(second_file)\n</code></pre>\n\n<p>But if I had just one or two of those and didn't have to repeat them in every other method, then I wouldn't bother. Your first form is \"good enough\".</p>\n"}], "owner": {"reputation": 4220, "user_id": 1661012, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/abc04c76810d98405fc0f27f96c6c5e5?s=128&d=identicon&r=PG", "display_name": "user137369", "link": "https://stackoverflow.com/users/1661012/user137369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1508243101, "creation_date": 1508242392, "last_edit_date": 1508242720, "question_id": 46789878, "link": "https://stackoverflow.com/questions/46789878/short-alternative-to-ternary-and-rescue-in-modifier-form", "title": "Short alternative to ternary and rescue in modifier form", "body": "<p>When loading files, I used to do some variant of:</p>\n\n<pre><code>first_file = \"#{__dir__}/first_file.txt\"\nfirst_data = File.exist?(first_file) ? File.readlines(first_file) : []\n\nsecond_file = \"#{__dir__}/second_file.yaml\"\nsecond_data = File.exist?(second_file) ? YAML.load_file(second_file) : {}\n</code></pre>\n\n<p>That always sat a bit wrong with me. Needing the check to see if the file exists is something that <em>needs</em> to be there, but what I really care about is what comes after.</p>\n\n<p>Eventually I discovered inline <code>rescue</code>, and started doing it like this:</p>\n\n<pre><code>first_file = \"#{__dir__}/first_file.txt\"\nfirst_data = File.readlines(firs_file) rescue []\n\nsecond_file = \"#{__dir__}/second_file.yaml\"\nsecond_data = YAML.load_file(second_file) rescue {}\n</code></pre>\n\n<p>This to me is way clearer \u2014 try to this thing you really want, and if you can\u2019t do this other thing that is exactly the fallback you want. It\u2019s both shorter and clearer than the ternary.</p>\n\n<p>But everywhere I look the same advice to <a href=\"https://stackoverflow.com/questions/41526504/why-should-we-avoid-using-rescue-in-its-modifier-form\">avoid <code>rescue</code> in modifier form</a> is repeated. I understand why that is: that it can hide errors we weren\u2019t predicting.</p>\n\n<p>If I could define <code>Errno::ENOENT</code> as the error to <code>rescue</code> from in the inline form, I would. But as far as I can tell, inline <code>rescue</code> can\u2019t specify what error to rescue from.</p>\n\n<p>So what is the alternative? What can I do that is as short and clear as the inline <code>rescue</code>, but without the disadvantage?</p>\n"}, {"tags": ["ruby", "sequel", "padrino"], "comments": [{"owner": {"reputation": 7568, "user_id": 492969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936bf1ffa62366b2c107de33361cc41?s=128&d=identicon&r=PG", "display_name": "three", "link": "https://stackoverflow.com/users/492969/three"}, "edited": false, "score": 0, "creation_date": 1508251387, "post_id": 46789685, "comment_id": 80532335, "body": "You need to allow Sequel to mass assign values on a model: <a href=\"http://sequel.jeremyevans.net/rdoc/files/doc/mass_assignment_rdoc.html\" rel=\"nofollow noreferrer\">sequel.jeremyevans.net/rdoc/files/doc/mass_assignment_rdoc.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 115, "user_id": 8774732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bDtaU.jpg?s=128&g=1", "display_name": "Mlok", "link": "https://stackoverflow.com/users/8774732/mlok"}, "reply_to_user": {"reputation": 7568, "user_id": 492969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936bf1ffa62366b2c107de33361cc41?s=128&d=identicon&r=PG", "display_name": "three", "link": "https://stackoverflow.com/users/492969/three"}, "edited": false, "score": 0, "creation_date": 1508304284, "post_id": 46789685, "comment_id": 80553230, "body": "Thanks a lot! It work! Thank You, I didn&#39;t connect it in my mind"}, {"owner": {"reputation": 7568, "user_id": 492969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936bf1ffa62366b2c107de33361cc41?s=128&d=identicon&r=PG", "display_name": "three", "link": "https://stackoverflow.com/users/492969/three"}, "edited": false, "score": 0, "creation_date": 1508308832, "post_id": 46789685, "comment_id": 80555068, "body": "Great! Sequel is a very powerful tool and it usually does everything you wioll ever need."}, {"owner": {"reputation": 115, "user_id": 8774732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bDtaU.jpg?s=128&g=1", "display_name": "Mlok", "link": "https://stackoverflow.com/users/8774732/mlok"}, "reply_to_user": {"reputation": 7568, "user_id": 492969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b936bf1ffa62366b2c107de33361cc41?s=128&d=identicon&r=PG", "display_name": "three", "link": "https://stackoverflow.com/users/492969/three"}, "edited": false, "score": 0, "creation_date": 1508311103, "post_id": 46789685, "comment_id": 80556262, "body": "Yes it is, but for me as a beginner is sometimes hard, because its a lots of docs and I start to implement something which is perfectly solved already. But everyday I learn a lots of new things."}], "owner": {"reputation": 115, "user_id": 8774732, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bDtaU.jpg?s=128&g=1", "display_name": "Mlok", "link": "https://stackoverflow.com/users/8774732/mlok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508241785, "creation_date": 1508241785, "question_id": 46789685, "link": "https://stackoverflow.com/questions/46789685/padrino-with-sequel-posting-to-multiple-models-with-one-form", "title": "padrino with sequel posting to multiple models with one form", "body": "<p>I am trying to post and save the form, which contains data for 2 models, they are connected with associations. But it fails on</p>\n\n<pre><code>Sequel::MassAssignmentRestriction\n</code></pre>\n\n<p>that the method for column from associated table does not exists. I understand the error and find the answer for rails. Which is to use </p>\n\n<pre><code>accepts_nested_attributes\n</code></pre>\n\n<p>but I am using Padrino, not rails. So I try nested_parameters but it didn't work and documentation tells just </p>\n\n<pre><code>The nested_attributes call defines a single method, association_attributes=, (e.g. albums_attributes=). So if you have an Artist instance:\n</code></pre>\n\n<p>which I understand that it is not what I need, for storing all with</p>\n\n<pre><code>@article = Article.new(params[:article])\n</code></pre>\n\n<p>and associated tables.</p>\n\n<p>Please, do You know how to use it with Padrino and what is right way</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "authorization", "google-calendar-api"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508238483, "post_id": 46787897, "comment_id": 80523471, "body": "It would be easier if you stripped the code example to the bare minimum to reproduce the error. Also the URL used by the API client would be useful."}, {"owner": {"reputation": 1726, "user_id": 4890595, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-9rPtty8_fOI/AAAAAAAAAAI/AAAAAAAAA0Y/wmx2PYqTMEQ/photo.jpg?sz=128", "display_name": "Code-MonKy", "link": "https://stackoverflow.com/users/4890595/code-monky"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508238876, "post_id": 46787897, "comment_id": 80523709, "body": "I&#39;ve added the url at the bottom. The rest is how I have implemented the Google Calendar sample ruby code."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508245549, "post_id": 46787897, "comment_id": 80528085, "body": "So the error is from the Google API? Not a Ruby exception? And if so which API call is generating the error, see my first comment, make the code example smaller, to just show relevant code."}, {"owner": {"reputation": 1726, "user_id": 4890595, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-9rPtty8_fOI/AAAAAAAAAAI/AAAAAAAAA0Y/wmx2PYqTMEQ/photo.jpg?sz=128", "display_name": "Code-MonKy", "link": "https://stackoverflow.com/users/4890595/code-monky"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508246043, "post_id": 46787897, "comment_id": 80528462, "body": "retrieve_events"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1508248025, "post_id": 46787897, "comment_id": 80529938, "body": "Can you rephrase your answer..."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 1, "creation_date": 1508248060, "post_id": 46787897, "comment_id": 80529970, "body": "Way before I was facing a similar error getting Google Analytics to work. I remember this error. I can&#39;t speak specifically for Calendar but follow <a href=\"http://blog.jieck.com/server-side-integrates-google-analytics-api-with-ruby/\" rel=\"nofollow noreferrer\">this article</a> for getting permission. It should be easy to modify it for Calendar after you get the authorization."}], "owner": {"reputation": 1726, "user_id": 4890595, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-9rPtty8_fOI/AAAAAAAAAAI/AAAAAAAAA0Y/wmx2PYqTMEQ/photo.jpg?sz=128", "display_name": "Code-MonKy", "link": "https://stackoverflow.com/users/4890595/code-monky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1508238752, "creation_date": 1508235793, "last_edit_date": 1508238752, "question_id": 46787897, "link": "https://stackoverflow.com/questions/46787897/how-to-fetch-events-from-the-google-calendar-api-with-a-rails-json-api", "title": "How to fetch events from the Google Calendar API with a Rails JSON API", "body": "<p>Right now I receive an error:</p>\n\n<p><strong>Required parameter is missing: grant_type</strong></p>\n\n<p>When using the <code>retrieve_events</code> controller action.</p>\n\n<pre><code> module Api\n  module V1\n    class EventsController &lt; ApplicationController\n\n      require 'google/apis/calendar_v3'\n      require 'googleauth'\n      require 'googleauth/stores/file_token_store'\n      require 'openssl'\n      require 'fileutils'\n\n\n      def index\n        # @events = Event.all\n        # render json: @events\n      end\n\n\n      OpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE\n\n      def retrieve_events\n        client = Signet::OAuth2::Client.new({\n          client_id: Rails.application.secrets.google_client_id,\n          client_secret: Rails.application.secrets.google_client_secret,\n          token_credential_uri: 'https://accounts.google.com/o/oauth2/token'\n        })\n\n        client.update!(session[:authorization])\n\n        service = Google::Apis::CalendarV3::CalendarService.new\n        service.authorization = client\n\n        @event_list = service.list_events(params[:calendar_id])\n        # @event_list = service.list_events(1)\n\n        @event_list.items.each do |event|\n\n          unless event.start.nil?\n            e = Event.find_or_initialize_by(title: event.summary)\n            if event.start.date\n              e.start_time = DateTime.parse(event.start.date).beginning_of_day\n              e.end_time = DateTime.parse(event.start.date).end_of_day\n            else\n              e.start_time = event.start.date_time\n              e.end_time = event.end.date_time\n            end\n            e.approved = true\n            e.save!\n          end\n        end\n        render json: @event_list\n      end\n\n      def new_event\n        client = Signet::OAuth2::Client.new({\n          client_id: Rails.application.secrets.google_client_id,\n          client_secret: Rails.application.secrets.google_client_secret,\n          token_credential_uri: 'https://accounts.google.com/o/oauth2/token'\n        })\n\n        client.update!(session[:authorization])\n\n        service = Google::Apis::CalendarV3::CalendarService.new\n        service.authorization = client\n\n        today = Date.today\n\n        event = Google::Apis::CalendarV3::Event.new({\n          start: Google::Apis::CalendarV3::EventDateTime.new(date: today),\n          end: Google::Apis::CalendarV3::EventDateTime.new(date: today + 1),\n          summary: 'New event!'\n        })\n\n        service.insert_event(params[:calendar_id], event)\n\n        redirect_to events_url(calendar_id: params[:calendar_id])\n      end\n\n      def redirect\n        client = Signet::OAuth2::Client.new({\n          client_id: Rails.application.secrets.google_client_id,\n          client_secret: Rails.application.secrets.google_client_secret,\n          authorization_uri: 'https://accounts.google.com/o/oauth2/auth',\n          scope: Google::Apis::CalendarV3::AUTH_CALENDAR,\n          redirect_uri: callback_url\n        })\n\n        redirect_to client.authorization_uri.to_s\n      end\n\n      def callback\n        client = Signet::OAuth2::Client.new({\n          client_id: Rails.application.secrets.google_client_id,\n          client_secret: Rails.application.secrets.google_client_secret,\n          token_credential_uri: 'https://accounts.google.com/o/oauth2/token',\n          redirect_uri: callback_url,\n          code: params[:code]\n        })\n\n        response = client.fetch_access_token!\n\n        session[:authorization] = response\n\n        redirect_to calendars_url\n      end\n\n      def calendars\n        client = Signet::OAuth2::Client.new({\n          client_id: Rails.application.secrets.google_client_id,\n          client_secret: Rails.application.secrets.google_client_secret,\n          token_credential_uri: 'https://accounts.google.com/o/oauth2/token'\n        })\n\n        client.update!(session[:authorization])\n\n        service = Google::Apis::CalendarV3::CalendarService.new\n        service.authorization = client\n\n        @calendar_list = service.list_calendar_lists\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the routes this goes through:</p>\n\n<pre><code>collection do\n  post :retrieve_events\nend\n</code></pre>\n\n<p>Once this worked in a rails app that was not in api mode. Then you went through a Google console and went back authorised. </p>\n\n<p>How to make this just as smooth with a JSON api visiting url:</p>\n\n<p><code>api/v1/events/retrieve_events</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm"], "owner": {"reputation": 11203, "user_id": 860967, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fae34c7d45959ea9b1ed9bf63df8c896?s=128&d=identicon&r=PG", "display_name": "Zhang", "link": "https://stackoverflow.com/users/860967/zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 5, "answer_count": 0, "score": 2, "last_activity_date": 1518428189, "creation_date": 1508235439, "question_id": 46787784, "link": "https://stackoverflow.com/questions/46787784/rails-console-warning-rvm-already-initialized-constant-railscommandhelp-mapp", "title": "Rails console warning rvm already initialized constant Rails::Command::HELP_MAPPINGS", "body": "<p>Getting a weird console warning recently, thought I'd try and clear it out.</p>\n\n<p>When I go to my rails project folder, and run the Mac Terminal command:</p>\n\n<pre><code>rails test\n</code></pre>\n\n<p>I get the following warning:</p>\n\n<pre><code>/Users/zhang/.rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/command.rb:18: warning: already initialized constant Rails::Command::HELP_MAPPINGS \n\n/Users/zhang/.rvm/gems/ruby-2.3.1@global/gems/railties-5.1.4/lib/rails/command.rb:18: warning: previous definition of HELP_MAPPINGS was here\n</code></pre>\n\n<p>I am using RVM.</p>\n\n<p>If I run <code>rvm gemset list</code> I get:</p>\n\n<pre><code>gemsets for ruby-2.3.1 (found in /Users/zhang/.rvm/gems/ruby-2.3.1)\n   (default)\n=&gt; global\n</code></pre>\n\n<p>If I run <code>rvm list</code> I get:</p>\n\n<pre><code>rvm rubies\n\n   ruby-2.3.0 [ x86_64 ]\n=* ruby-2.3.1 [ x86_64 ]\n   ruby-head [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p>The command <code>ruby --version</code> outputs:</p>\n\n<pre><code>ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-darwin15]\n</code></pre>\n\n<p>The command <code>rails --version</code> outputs:</p>\n\n<pre><code>Rails 5.1.4\n</code></pre>\n\n<p>Any ideas on how I can get rid of the warnings?</p>\n"}, {"tags": ["ruby", "linux", "ubuntu"], "owner": {"reputation": 21, "user_id": 8776139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b358e3cd3becf6059ac694f3d9b22593?s=128&d=identicon&r=PG&f=1", "display_name": "AbHi TheNua", "link": "https://stackoverflow.com/users/8776139/abhi-thenua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508232778, "creation_date": 1508232778, "question_id": 46786955, "link": "https://stackoverflow.com/questions/46786955/i-want-to-run-wpscan-on-ubuntu-vps-server-but-getting-ruby-errors", "title": "I want to run wpscan on Ubuntu vps server, but getting ruby errors", "body": "<p>Firstly i installed wpscan on ubuntu by following these methods </p>\n\n<pre><code>apt-get install git\nsudo apt-get install libcurl4-openssl-dev libxml2 libxml2-dev libxslt1-dev ruby-dev build-essential libgmp-dev zlib1g-dev\ngit clone https://github.com/wpscanteam/wpscan.git\n\ncd wpscan\n\nsudo gem install bundler &amp;&amp; bundle install --without test development\n</code></pre>\n\n<p>Then when i run it by typing ruby wpscan.rb \nit said </p>\n\n<pre><code>Could not find ffi-1.9.18 in any of the sources\nRun `bundle install` to install missing gems.\n</code></pre>\n\n<p>when i run bundle install i got that output </p>\n\n<pre><code>extconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.4.0/gems/ffi-1.9.18 for\ninspection.\nResults logged to\n/var/lib/gems/2.4.0/extensions/x86_64-linux/2.4.0/ffi-1.9.18/gem_make.out\n\nAn error occurred while installing ffi (1.9.18), and Bundler cannot\ncontinue.\nMake sure that `gem install ffi -v '1.9.18'` succeeds before bundling.\n\nIn Gemfile:\n  typhoeus was resolved to 1.3.0, which depends on\n    ethon was resolved to 0.10.1, which depends on\n</code></pre>\n\n<p>Help will be appreciated , thanks </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "html", "ruby-on-rails-4", "https"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508233142, "post_id": 46786823, "comment_id": 80520315, "body": "It appears to me that simply using another browser is the easiest option."}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508233378, "post_id": 46786823, "comment_id": 80520451, "body": "Yes I agree @Sergio Tulentsev! The only question is, will it work with safari when I deploy it?? Since I cant test it right now!"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508236114, "post_id": 46786823, "comment_id": 80522071, "body": "It depends on your operating system and setup. Especially what rails server you are using. Basically you have to create a self signed certificate (PEM) and trust it in the OS. <a href=\"https://gist.github.com/tadast/9932075\" rel=\"nofollow noreferrer\">gist.github.com/tadast/9932075</a>"}], "answers": [{"comments": [{"owner": {"reputation": 588, "user_id": 9096103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YleDA.jpg?s=128&g=1", "display_name": "Navid Khan", "link": "https://stackoverflow.com/users/9096103/navid-khan"}, "edited": false, "score": 0, "creation_date": 1601300023, "post_id": 46788022, "comment_id": 113356230, "body": "This is rather slow though, and it seems they also throttle request rates. For a page in the development env with no caching, most requests get blocked. A solution like this might work out better for some: <a href=\"https://rossta.net/blog/local-ssl-for-rails-5.html\" rel=\"nofollow noreferrer\">rossta.net/blog/local-ssl-for-rails-5.html</a>"}], "tags": [], "owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "is_accepted": false, "score": 4, "last_activity_date": 1508236223, "creation_date": 1508236223, "answer_id": 46788022, "question_id": 46786823, "link": "https://stackoverflow.com/questions/46786823/rails-change-localhost3000-to-https/46788022#46788022", "title": "Rails: change localhost:3000 to https://", "body": "<p>Easiest way to serve Rails over https will be to use <a href=\"https://ngrok.com/\" rel=\"nofollow noreferrer\">ngrok</a>. It just provides a secure tunnel to localhost. Extremely easy to use</p>\n"}, {"tags": [], "owner": {"reputation": 2904, "user_id": 2357380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d64384de6628ce31857b881d776e5c78?s=128&d=identicon&r=PG", "display_name": "Sri Harsha Kappala", "link": "https://stackoverflow.com/users/2357380/sri-harsha-kappala"}, "is_accepted": false, "score": -3, "last_activity_date": 1508241364, "creation_date": 1508241364, "answer_id": 46789553, "question_id": 46786823, "link": "https://stackoverflow.com/questions/46786823/rails-change-localhost3000-to-https/46789553#46789553", "title": "Rails: change localhost:3000 to https://", "body": "<p>You can make your Rails app to run on HTTPS by adding the below line in <code>application.rb</code></p>\n\n<pre><code> config.force_ssl = true\n</code></pre>\n\n<p>Or as Nwocha suggested you can as well use ngrok.</p>\n"}, {"tags": [], "owner": {"reputation": 1248, "user_id": 12544391, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CtaYxo9TPIE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdlgdP0oykrpPJmTWJQN9DSbVS-8w/photo.jpg?sz=128", "display_name": "Dorian", "link": "https://stackoverflow.com/users/12544391/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1615327290, "creation_date": 1615327290, "answer_id": 66555414, "question_id": 46786823, "link": "https://stackoverflow.com/questions/46786823/rails-change-localhost3000-to-https/66555414#66555414", "title": "Rails: change localhost:3000 to https://", "body": "<p>You can also use cloudflared <a href=\"https://github.com/cloudflare/cloudflared\" rel=\"nofollow noreferrer\">https://github.com/cloudflare/cloudflared</a>, it's free and doesn't have any of the limitations ngrok has like having to change the domain every so often.</p>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2276, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1615327290, "creation_date": 1508232315, "last_edit_date": 1508233207, "question_id": 46786823, "link": "https://stackoverflow.com/questions/46786823/rails-change-localhost3000-to-https", "title": "Rails: change localhost:3000 to https://", "body": "<p>I'm in development and using the <code>html5 geolocation</code> on my <code>rails 5</code> app:</p>\n\n<pre><code>function getLocation() {\n    if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(setGeoCookie);\n    } else {\n        x.innerHTML = \"Geolocation is not supported by this browser.\";\n    }\n}\n\nfunction setGeoCookie(position) {\n    var cookie_val = position.coords.latitude + \"|\" + position.coords.longitude;\n    document.cookie = \"lat_lng=\" + escape(cookie_val);\n}\n</code></pre>\n\n<p>it's working fine with <code>firefox</code> and all browsers except for <code>safari</code>. With <code>safari</code> the <code>allow pop up</code> doesn't appear. </p>\n\n<p>I did some research and found..... that safari (unlike Chrome and Firefox) does not allow access to geolocation over the HTTP protocol - only HTTPS. Even for localhost.</p>\n\n<p>The solution is to either use another browser in development or serve Rails over HTTPS. </p>\n\n<p>Can someone give me pointers on how to serve Rails over HTTPS in development?</p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508233261, "post_id": 46786653, "comment_id": 80520383, "body": "what do you mean &quot;string moves&quot;? JFYI, your code never gets to <code>name=gets.chomp</code> part. Because your thread runs an infinite loop and you   wait for it to finish (which it never does)."}, {"owner": {"reputation": 420, "user_id": 8709628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a23166ba8ad1d2d3e53b5dd543311a6?s=128&d=identicon&r=PG&f=1", "display_name": "lucaortis", "link": "https://stackoverflow.com/users/8709628/lucaortis"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1508238890, "post_id": 46786653, "comment_id": 80523721, "body": "@SergioTulentsev but I think it should be infinite if it has to keep counting the time till the main thread its done.. For example, if you run that, and u press the space key, the time string will be moved one character to the right too.. I need the time thread to keep counting the time while the main thread do his work.. Basically, I need to put a clock inside my program Sorry for my english"}], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 8709628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a23166ba8ad1d2d3e53b5dd543311a6?s=128&d=identicon&r=PG&f=1", "display_name": "lucaortis", "link": "https://stackoverflow.com/users/8709628/lucaortis"}, "edited": false, "score": 0, "creation_date": 1509167754, "post_id": 46985398, "comment_id": 80919905, "body": "thank you so much for your reply! That solved my problem! Can i just aks you to explain me the absolute position for both prompt and clock? I refer to this link for an ASCII table, but i can&#39;t find anything about the absolute position:  <a href=\"http://ascii-table.com/ansi-escape-sequences-vt-100.php\" rel=\"nofollow noreferrer\">ascii-table.com/ansi-escape-sequences-vt-100.php</a>  Thanks again!"}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 420, "user_id": 8709628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a23166ba8ad1d2d3e53b5dd543311a6?s=128&d=identicon&r=PG&f=1", "display_name": "lucaortis", "link": "https://stackoverflow.com/users/8709628/lucaortis"}, "edited": false, "score": 0, "creation_date": 1509176770, "post_id": 46985398, "comment_id": 80921664, "body": "Google &quot;vt100 escape sequences,&quot; I think you&#39;ll find it.  ESC+[{row};{column}f is the escape sequence for absolute positioning."}, {"owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "reply_to_user": {"reputation": 420, "user_id": 8709628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a23166ba8ad1d2d3e53b5dd543311a6?s=128&d=identicon&r=PG&f=1", "display_name": "lucaortis", "link": "https://stackoverflow.com/users/8709628/lucaortis"}, "edited": false, "score": 0, "creation_date": 1509176864, "post_id": 46985398, "comment_id": 80921683, "body": "It&#39;s actually in the page you linked.    Esc[Line;Columnf\tMove cursor to screen location v,h\tCUP"}], "tags": [], "owner": {"reputation": 382, "user_id": 5063336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fd0d38dd403b01722df127f7dc6807?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5063336/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1509154529, "last_edit_date": 1509154529, "creation_date": 1509153973, "answer_id": 46985398, "question_id": 46786653, "link": "https://stackoverflow.com/questions/46786653/user-input-with-multithreading-ruby/46985398#46985398", "title": "User input with multithreading Ruby", "body": "<p>First, don't call <code>Thread#join</code>, because at that point your main thread blocks and will do nothing further until the <code>thr</code> thread exits, and it never will.</p>\n\n<p>Second, the terminal doesn't know anything about threads.  You have to make your threads play nice with each other as far as cursor positioning.  The easiest way to do that is to have the one that is interrupting and seizing the cursor save the position and restore it when it has done its thing.</p>\n\n<pre><code>print \"\\033[2J\" # clear screen\nprint \"\\033[4;2fName: \" # absolute position for prompt\n\nthr = Thread.new {\n  loop {\n    print \"\\0337\" # save cursor position\n    print \"\\033[2;2f\\033[2K\" # absolution position for clock\n    print Time.now.strftime(\"Time: %H:%M:%S\") \n    print \"\\0338\" # restore cursor position\n    sleep(1)\n  }\n}\n\nname = gets.chomp\nputs \"Hello, #{name}.\"\n\nsleep # forever, because thread 'thr' will be killed when the main program exits\n</code></pre>\n"}], "owner": {"reputation": 420, "user_id": 8709628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a23166ba8ad1d2d3e53b5dd543311a6?s=128&d=identicon&r=PG&f=1", "display_name": "lucaortis", "link": "https://stackoverflow.com/users/8709628/lucaortis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 46985398, "answer_count": 1, "score": 1, "last_activity_date": 1509154529, "creation_date": 1508231883, "last_edit_date": 1508232524, "question_id": 46786653, "link": "https://stackoverflow.com/questions/46786653/user-input-with-multithreading-ruby", "title": "User input with multithreading Ruby", "body": "<p>I'm trying to make one thread display the current time while the user enters some input in the main thread.</p>\n\n<p>When I run this,</p>\n\n<pre><code>thr=Thread.new {\n  loop {\n    time = Time.now\n    puts time.strftime(\"Time: %H:%M:%S\")\n    sleep(1)\n    print\"\\033[A\",\"\\033[K\"\n  }\n}\nthr.join\nprint\"Name: \";name=gets.chomp\n</code></pre>\n\n<p>the time string moves too on the terminal, and it copies what I type in the main thread too.</p>\n\n<p>Is there a way to lock a string or divide the threads?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oop", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508231905, "post_id": 46786511, "comment_id": 80519559, "body": "What do you mean by &quot;PORO structure&quot;? Your question is about as vague as asking &quot;how do I write good code?&quot; -- This is a huge topic, of much debate, that cannot possibly be succinctly answered in a single StackOverflow post. There are thousands of books written on the topic."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508231943, "post_id": 46786511, "comment_id": 80519578, "body": "A good place to start is to read about SOLID principles: <a href=\"https://en.wikipedia.org/wiki/SOLID_(object-oriented_design)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/SOLID_(object-oriented_design)</a> -- such as the Single Responsibility Principle."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508232144, "post_id": 46786511, "comment_id": 80519704, "body": "As a somewhat vague answer to your question, the best I can say is: Your code should be &quot;clean and simple&quot;. A class should have a <b>single responsibility</b>. The primary purpose of service objects is to abstract complex logic into a customised structure of classes; so as to make it flexible, reusable and testable in isolation."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1508236960, "post_id": 46786511, "comment_id": 80522546, "body": "Model classes in ActiveRecord have tons of responsibilies even with no or very little code. They handle associations, validations, callbacks, db scopes etc. The key  point here is that its not about distributing the lines of code - its about avoiding making your models even more god-like."}], "answers": [{"tags": [], "owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "is_accepted": false, "score": 0, "last_activity_date": 1508237369, "creation_date": 1508237369, "answer_id": 46788345, "question_id": 46786511, "link": "https://stackoverflow.com/questions/46786511/rails-what-code-should-go-in-model-and-service-class-when-following-poroplain/46788345#46788345", "title": "Rails: what code should go in model and service class when following PORO(plain old ruby object) structure", "body": "<p>This article will completely answer your questions and leave you more than satisfied: <a href=\"https://www.toptal.com/ruby-on-rails/decoupling-rails-components\" rel=\"nofollow noreferrer\">Extreme Rails Decoupling with POROs</a>.</p>\n\n<p>In summary, POROs can be used in different ways in Rails:</p>\n\n<ol>\n<li>Service Objects: This are stateless objects and may have side effects on its dependencies. They are usually utilized when we need to interact with external services such as processing billing for users and then sending an email after that, or publishing to a queue etc. Their isolation allows for easy testability.</li>\n<li>Interactors: This is a technical term for the Ruby object that is used to perform a given use case. These classes usually have an actionable name(i.e a verb). Example of such class can be <code>ChargePendingUsers</code></li>\n<li>Value Objects: These are immutable objects which represents very simple entity whose equality is not based on identity. A very common example for this will be a <code>Money</code> class which can tell both its currency and then its amount.</li>\n<li>Query Objects: This just abstracts the query responsibility from the AR model, keeping your classes light. They are usually used when the underlying query logic is complex</li>\n<li>Presenters: These objects most times inherit from SimpleDelegator and help keep our views free from logic. They implement the decorator pattern and add more functionality to the underlying object.</li>\n</ol>\n"}], "owner": {"reputation": 831, "user_id": 2274074, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ba7786aa3605017e6a85f45dd0e26835?s=128&d=identicon&r=PG", "display_name": "user2274074", "link": "https://stackoverflow.com/users/2274074/user2274074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508237369, "creation_date": 1508231460, "question_id": 46786511, "link": "https://stackoverflow.com/questions/46786511/rails-what-code-should-go-in-model-and-service-class-when-following-poroplain", "title": "Rails: what code should go in model and service class when following PORO(plain old ruby object) structure", "body": "<p>I have gone through several documentations available online on PORO concepts and have understood that why we should we use PORO but what i didn't understand is that if businesses logic should go in service classes then what should go in activerecord model class??</p>\n\n<p>Also in what cases it doesn't make sense to create service class and instead should be write code in activerecord model classes??</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "best-in-place"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508231202, "post_id": 46786356, "comment_id": 80519139, "body": "What are you trying to do?, you&#39;re passing just a value that could be a placeholder."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508231736, "post_id": 46786356, "comment_id": 80519462, "body": "@Sebasti&#225;nPalma i want to be able to edit the message in place"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "edited": false, "score": 0, "creation_date": 1508237040, "post_id": 46786750, "comment_id": 80522590, "body": "it returns the error undefined method `message&#39;  it seems that :message is seen as a method ?  i placed it outside the each loop &lt;% @admin.each do |s| %&gt; &lt;%= best_in_place @admin, :message, as: :input %&gt;"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508237063, "post_id": 46786750, "comment_id": 80522597, "body": "What&#39;s the value of <code>@admin</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "edited": false, "score": 0, "creation_date": 1508237165, "post_id": 46786750, "comment_id": 80522635, "body": "@admin = Message.where(id: current_user)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508237352, "post_id": 46786750, "comment_id": 80522731, "body": "Whenever you use <code>where</code> it returns an <code>ActiveRecord_Relation</code>, that&#39;s why, that kind of object doesn&#39;t have a method called <code>message</code>, you need to access the single object, as I&#39;ve pointed <i><code>object</code> means an object or specific record</i>. To check, try using <code>Message.where(id: current_user).first</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "edited": false, "score": 0, "creation_date": 1508237642, "post_id": 46786750, "comment_id": 80522930, "body": "Last question Is there any way i can place it in an each loop ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "edited": false, "score": 0, "creation_date": 1508237802, "post_id": 46786750, "comment_id": 80523044, "body": "I placed Message.where(id: current_user).first but now I get an error ofundefined method `message_path&#39;"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508237803, "post_id": 46786750, "comment_id": 80523046, "body": "Of course yes, if you use where, it get&#39;s you a &quot;set&quot; of records which you can iterate. Something like <a href=\"https://gist.github.com/vnhnhm/aece7bd088e450d17a997d8a195f9f0e\" rel=\"nofollow noreferrer\">this</a>, of course you can adapt it to your code, and the query in the controller."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "edited": false, "score": 0, "creation_date": 1508238560, "post_id": 46786750, "comment_id": 80523517, "body": "I placed Message.where(id: current_user).first but now I get an error of undefined method `message_path problem of installation?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1508238616, "post_id": 46786750, "comment_id": 80523549, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/156907/discussion-between-sebastian-palma-and-rother-jon\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1508232120, "creation_date": 1508232120, "answer_id": 46786750, "question_id": 46786356, "link": "https://stackoverflow.com/questions/46786356/in-place-editing-rails/46786750#46786750", "title": "In place editing rails", "body": "<pre><code>best_in_place(object, field, opts = {})\n</code></pre>\n\n<p>See the arguments the <a href=\"https://github.com/bernat/best_in_place/blob/332eda290cb133683a99d43a30321bab27d85e70/lib/best_in_place/helper.rb#L3\" rel=\"nofollow noreferrer\">best_in_place</a> method expects to receive. You're passing only one.</p>\n\n<ul>\n<li><code>object</code> means an object or specific record.</li>\n<li><code>field</code> is the attribute which to edit - in your case it could be <code>message</code>.</li>\n<li><code>options</code> all the <a href=\"https://github.com/bernat/best_in_place#best_in_place\" rel=\"nofollow noreferrer\">options</a> it accepts.</li>\n</ul>\n\n<p>Most probably you need something like:</p>\n\n<pre><code>&lt;%= best_in_place @object, :message, as: :input %&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8755767"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 46786750, "answer_count": 1, "score": 1, "last_activity_date": 1508235275, "creation_date": 1508230931, "last_edit_date": 1508235275, "question_id": 46786356, "link": "https://stackoverflow.com/questions/46786356/in-place-editing-rails", "title": "In place editing rails", "body": "<p>I receive an error wrong number of arguments (given 1, expected 2..3) how can i apply it in a each loop ? I want to be able to edit it inplace in an each loop</p>\n\n<pre><code>  &lt;%= best_in_place s.message %&gt;\n</code></pre>\n\n<p><strong>application.js</strong> </p>\n\n<pre><code>//= require jquery_ujs\n//= require jquery.purr\n</code></pre>\n\n<p><strong>user.coffee</strong> </p>\n\n<pre><code>jQuery -&gt;\n $('.best_in_place').best_in_place() \n</code></pre>\n\n<p>version best_in_place 3.1.1 </p>\n\n<p>OR</p>\n\n<p>Is there a more better way of implementing an inplace editing</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508229423, "post_id": 46785086, "comment_id": 80517997, "body": "How does the generated HTML look like and what is your expected result?"}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1508228267, "post_id": 46785136, "comment_id": 80517331, "body": "This is a hack. It&#39;s not the &quot;right&quot; way to do it. Hang on, I&#39;ll give you a proper answer in a minute..."}, {"owner": {"reputation": 105, "user_id": 1279629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3ddda7699d485e8dbccd7fe591b59564?s=128&d=identicon&r=PG&f=1", "display_name": "jugglervr", "link": "https://stackoverflow.com/users/1279629/jugglervr"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1598162600, "post_id": 46785136, "comment_id": 112364379, "body": "@TomLord longest minute I&#39;ve ever heard of."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 105, "user_id": 1279629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3ddda7699d485e8dbccd7fe591b59564?s=128&d=identicon&r=PG&f=1", "display_name": "jugglervr", "link": "https://stackoverflow.com/users/1279629/jugglervr"}, "edited": false, "score": 0, "creation_date": 1598174029, "post_id": 46785136, "comment_id": 112366642, "body": "@jugglervr I posted an answer above, 3 years ago! (But OK it did take me 30 minutes, not 1.)"}], "tags": [], "owner": {"reputation": 21, "user_id": 8783506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/InOPm.jpg?s=128&g=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/8783506/muhammad-usman"}, "is_accepted": false, "score": 1, "last_activity_date": 1508226697, "creation_date": 1508226697, "answer_id": 46785136, "question_id": 46785086, "link": "https://stackoverflow.com/questions/46785086/how-to-add-white-spaces-in-haml/46785136#46785136", "title": "How to add white spaces in haml", "body": "<p>after being going through different platforms i finally found solutions see the code.</p>\n\n<pre><code>(Requested:&amp;nbsp\n                            %strong&lt;&gt;\n                              = comment.commentable.requested_check_in.present? ? comment.commentable.requested_check_in.strftime(\"%m/%d/%Y\") : \"\"\n                              &amp;nbsp-&amp;nbsp\n                              = comment.commentable.requested_check_out.present? ? comment.commentable.requested_check_out.strftime(\"%m/%d/%Y\") : \"\"\n                            , Actual:&amp;nbsp\n                            %strong&lt;&gt;\n                              = comment.commentable.actual_check_in.present? ? comment.commentable.actual_check_in.strftime(\"%m/%d/%Y\") : \"\"\n                              &amp;nbsp-&amp;nbsp\n                              = comment.commentable.actual_check_out.present? ? comment.commentable.actual_check_out.strftime(\"%m/%d/%Y\") : \"\"\n                            ).\n</code></pre>\n\n<p>you can use shortcode (&amp;nbsp) whereever you want space in haml</p>\n"}, {"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1508230228, "creation_date": 1508230228, "answer_id": 46786125, "question_id": 46785086, "link": "https://stackoverflow.com/questions/46785086/how-to-add-white-spaces-in-haml/46786125#46786125", "title": "How to add white spaces in haml", "body": "<p><a href=\"http://yesterdayishere.com/now/what-nbsp-means-and-does/\" rel=\"nofollow noreferrer\"><code>&amp;nbsp</code> stands for <strong>non-breaking space</strong></a>.</p>\n\n<p>Normally, HTML will truncate spaces in your text. If you write 10 spaces, only 1 will be displayed. <code>&amp;nbsp</code> is one way to <em>force</em> additional spaces to appear, but it is rarely the \"right\" way to do it.</p>\n\n<p>A valid use case might be: <code>Mr.&amp;nbspUsman</code> -to force the two words to appear together on the same line.</p>\n\n<p>All you need to do here is wrap the text in quotes:</p>\n\n<pre><code>= '(Requested: '\n%strong= comment.commentable.requested_check_in&amp;.strftime(\"%m/%d/%Y\")\n- if comment.commentable.requested_check_out\n  = ' - '\n  %strong= comment.commentable.requested_check_out.strftime(\"%m/%d/%Y\")\n= ')'\n= '(Actual: '\n%strong= comment.commentable.actual_check_in&amp;.strftime(\"%m/%d/%Y\")\n- if comment.commentable.actual_check_out\n  = ' - '\n  %strong= comment.commentable.actual_check_out.strftime(\"%m/%d/%Y\")\n= ')'\n</code></pre>\n\n<p>This code is very messy, however. It is not advisable to put such complex logic in a view. I would advise moving this logic out into a helper method; perhaps consider using the <a href=\"https://github.com/drapergem/draper\" rel=\"nofollow noreferrer\"><code>draper</code></a> library? Your refactored view code could end up looking something like this:</p>\n\n<pre><code>!= \"(Requested: &lt;strong&gt;#{comment.commentable.requested_check_out_range}&lt;/strong&gt;)\"\n!= \"(Actual: &lt;strong&gt;#{comment.commentable.actual_check_out_range}&lt;/strong&gt;)\"\n</code></pre>\n\n<p>...With the conditional logic moved into <code>./app/decorators/*.rb</code>.</p>\n\n<p>If you did need to format the text with <em>multiple</em>, non-truncated white-space then you should typically instead use the <a href=\"https://www.w3schools.com/cssref/pr_text_white-space.asp\" rel=\"nofollow noreferrer\"><code>white-space</code> CSS property</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 5424678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p6K3YRlSptc/AAAAAAAAAAI/AAAAAAAAC9E/fWSUVQKXbF0/photo.jpg?sz=128", "display_name": "William Romero", "link": "https://stackoverflow.com/users/5424678/william-romero"}, "is_accepted": false, "score": 0, "last_activity_date": 1604431259, "creation_date": 1604431259, "answer_id": 64669233, "question_id": 46785086, "link": "https://stackoverflow.com/questions/46785086/how-to-add-white-spaces-in-haml/64669233#64669233", "title": "How to add white spaces in haml", "body": "<p>If you need a blank space on HAML, use the following cheatcode:</p>\n<pre><code>  = parseFloat(elem.value) &gt; 1.00 ? 'X' : &quot;\\n\\b&quot;\n</code></pre>\n<p>Hope it would be useful.</p>\n"}], "owner": {"reputation": 21, "user_id": 8783506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/InOPm.jpg?s=128&g=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/8783506/muhammad-usman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2788, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1604431259, "creation_date": 1508226505, "question_id": 46785086, "link": "https://stackoverflow.com/questions/46785086/how-to-add-white-spaces-in-haml", "title": "How to add white spaces in haml", "body": "<p>I have the following lines in my haml file.</p>\n\n<pre><code>(Requested:\n                            %strong&lt;&gt;\n                              = comment.commentable.requested_check_in.present? ? comment.commentable.requested_check_in.strftime(\"%m/%d/%Y\") : \"\"\n                              =\"-\"\n                              = comment.commentable.requested_check_out.present? ? comment.commentable.requested_check_out.strftime(\"%m/%d/%Y\") : \"\"\n                            , Actual:\n                            %strong&lt;&gt;\n                              = comment.commentable.actual_check_in.present? ? comment.commentable.actual_check_in.strftime(\"%m/%d/%Y\") : \"\"\n                              =\"-\"\n                              = comment.commentable.actual_check_out.present? ? comment.commentable.actual_check_out.strftime(\"%m/%d/%Y\") : \"\"\n                            ).\n</code></pre>\n\n<p>what i want is that to have a white space after</p>\n\n<pre><code>(Requested: \" \"\n</code></pre>\n\n<p>but this line is not working.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara", "integration-testing"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5577699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418d287a56bc0d635c07a7638ed0ceae?s=128&d=identicon&r=PG&f=1", "display_name": "stooshie45", "link": "https://stackoverflow.com/users/5577699/stooshie45"}, "edited": false, "score": 0, "creation_date": 1508235865, "post_id": 46785936, "comment_id": 80521942, "body": "Urgh, completely missed that nested form. So obvious now you&#39;re pointed it out! Thanks a lot, also noted your points about feature vs request specs."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1508229563, "creation_date": 1508229563, "answer_id": 46785936, "question_id": 46784743, "link": "https://stackoverflow.com/questions/46784743/request-in-capybara-a-get-when-it-should-be-a-post/46785936#46785936", "title": "Request in Capybara a GET, when it should be a POST", "body": "<p>A couple of clarifications first. </p>\n\n<ol>\n<li>You're not writing request specs, you're writing feature specs (as evidenced by the use of <code>RSpec.feature</code> and <code>:type =&gt; :feature</code></li>\n<li>You don't need to specify <code>:type =&gt; :feature</code> when using <code>RSpec.feature</code> since that's already set.</li>\n</ol>\n\n<p>Now on to your issue.  You have nested forms in your view code since <code>form_tag</code> creates a <code>&lt;form&gt;</code>element and then you have another <code>&lt;form&gt;</code> element directly inside that (Note: it's always better to post the actual HTML rather than the erb so people can see what the actual HTML is). Combine that with the fact you appear to be using the <code>rack-test</code> driver (no <code>js: true</code> metadata) which won't behave the same way as a real browser when the HTML is invalid (which nested forms are), and you end up with your current behavior.  I would guess when you use it with a real browser the inside form element is ignored and the outer form element has a method attribute equal to \"post\" so it gets posted.  When using <code>rack-test</code> it's probably submitting the inner form element which has no <code>method</code> attribute and therefore defaults to \"get\".  Remove the extraneous <code>&lt;form class=\"m-t\" role=\"form\" action=\"/\"&gt;</code> form element from your view and things should work.</p>\n"}], "owner": {"reputation": 17, "user_id": 5577699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418d287a56bc0d635c07a7638ed0ceae?s=128&d=identicon&r=PG&f=1", "display_name": "stooshie45", "link": "https://stackoverflow.com/users/5577699/stooshie45"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 46785936, "answer_count": 1, "score": 1, "last_activity_date": 1508229563, "creation_date": 1508225425, "question_id": 46784743, "link": "https://stackoverflow.com/questions/46784743/request-in-capybara-a-get-when-it-should-be-a-post", "title": "Request in Capybara a GET, when it should be a POST", "body": "<p>So this is a pretty basic Rails 5 application using Docker, which includes some user authentication that I built from scratch (not using Devise etc). Now, I want to start learning about request specs with Capybara, but I'm hitting what seems like a pretty strange issue with it.</p>\n\n<p>Here's my login form (<code>sessions.new.erb</code>):</p>\n\n<pre><code>&lt;%= form_tag sessions_path do %&gt;\n          &lt;form class=\"m-t\" role=\"form\" action=\"/\"&gt;\n              &lt;div class=\"form-group\"&gt;\n                &lt;%= text_field_tag :email, params[:email], class: 'form-control', placeholder: \"Email Address\", required: \"\" %&gt;\n              &lt;/div&gt;\n              &lt;div class=\"form-group\"&gt;\n                &lt;%= password_field_tag(:password, nil, class: 'form-control', placeholder: \"Password\", required: \"\") %&gt;\n              &lt;/div&gt;\n              &lt;div class=\"form-group\"&gt;\n                        &lt;%= check_box_tag :remember_me, 1, params[:remember_me] %&gt;\n                        &lt;%= label_tag :remember_me %&gt;\n                      &lt;/div&gt;\n              &lt;div class=\"actions\"&gt;&lt;%= submit_tag \"Log In\", class: \"btn btn-primary block full-width m-b\" %&gt;&lt;/div&gt;\n          &lt;/form&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>And my <code>requests/sessions_spec.rb</code>:</p>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.feature \"Login\", :type =&gt; :feature do\n  scenario \"handles wrong email and password gracefully\" do\n    visit login_path\n    fill_in \"Email Address\", :with =&gt; \"something\"\n    fill_in \"Password\", :with =&gt; \"something\"\n    click_button \"Log In\"\n\n    expect(page).to have_text(\"Email or password incorrect\")\n  end\nend\n</code></pre>\n\n<p>Now, this works if you test it manually so I would presume Capybara would see the same thing. But it kept failing. I've got the application configured so that if you try and access a protected controller and you're not logged in, it redirects you to <code>/login</code> and flashes a message to say <code>Please log in to see this page</code>. The Rspec test was returning that, which was weird - that suggested that Capybara was trying to visit another page.</p>\n\n<p>So I tailed the test logs (<code>docker-compose run web tail -f log/test.log</code>)</p>\n\n<p>And what I found is puzzling me:</p>\n\n<pre><code>Started GET \"/login\" for 127.0.0.1 at 2017-10-17 06:59:26 +0000\nProcessing by SessionsController#new as HTML\n  Rendering sessions/new.html.erb within layouts/empty\n  Rendered sessions/new.html.erb within layouts/empty (1.1ms)\nCompleted 200 OK in 6ms (Views: 6.1ms | ActiveRecord: 0.0ms)\nStarted GET \"/?email=something&amp;password=[FILTERED]&amp;commit=Log+In\" for 127.0.0.1 at 2017-10-17 06:59:26 +0000\nStarted GET \"/locations\" for 127.0.0.1 at 2017-10-17 06:59:26 +0000\nProcessing by LocationsController#index as HTML\nRedirected to http://www.example.com/login\nFilter chain halted as :authenticate rendered or redirected\nCompleted 302 Found in 2ms (ActiveRecord: 0.0ms)\nStarted GET \"/login\" for 127.0.0.1 at 2017-10-17 06:59:26 +0000\nProcessing by SessionsController#new as HTML\n  Rendering sessions/new.html.erb within layouts/empty\n  Rendered sessions/new.html.erb within layouts/empty (1.1ms)\nCompleted 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.0ms)\n   (0.4ms)  ROLLBACK\n</code></pre>\n\n<p>The first bit is okay, GET Login is processed by the SessionsController#new. But then, (see line 6) for some reason Capybara tried to GET the root URL, passing the email/password params in. My root URL is mapped to the LocationsController#index, which the user isn't allowed to access, so gets redirected back to /login with the message <code>Please log in to see this page</code>. What that button actually does is send a POST to SessionsController#create. And if you watch the logs when you do it manually, that's exactly what happens:</p>\n\n<pre><code>web_1  | Started POST \"/sessions\" for 172.18.0.1 at 2017-10-17 07:02:19+0000\nweb_1  | Processing by SessionsController#create as HTML\n</code></pre>\n\n<p>I can't work out why in Capybara when you press the button it performs a completely different request to when you click the button manually.</p>\n\n<p>Help greatly appreciated!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508224679, "post_id": 46784262, "comment_id": 80515281, "body": "Note that although <code>attr_reader :all_tasks</code> looks like read-only, it allows the caller to modify <code>all_tasks</code>, e.g. <code>my_list.all_tasks &lt;&lt; &#39;another task&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1508224473, "post_id": 46784336, "comment_id": 80515173, "body": "It might be worth noting that this works because <code>puts</code> prints each element on a new line if called with an array. To have more control over the output, <code>List#show</code> should return a string."}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1508225821, "post_id": 46784336, "comment_id": 80515956, "body": "Thank you that really helped. Since I am only started to learn ruby(my second week), i would like to now, why the moment I write the def to_s, ruby doesn&#39;t display the string representing the output anymore?"}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1508225934, "post_id": 46784336, "comment_id": 80516017, "body": "@Stefan Can you please also explain what List#show is/means and how to implement it? It might be stupid question but I won&#39;t learn anything if i don&#39;t ask :-) Thank You again for your help"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1508226856, "post_id": 46784336, "comment_id": 80516545, "body": "@SebastianPeter <code>List#show</code> refers to the <code>show</code> instance method within your <code>List</code> class. It currently returns an array, whereas it probably should return a string. I&#39;ve posted an answer showing a slightly different approach."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1508225378, "last_edit_date": 1508225378, "creation_date": 1508223952, "answer_id": 46784336, "question_id": 46784262, "link": "https://stackoverflow.com/questions/46784262/how-to-display-the-attribute-of-an-object-as-a-string-in-ruby/46784336#46784336", "title": "How to display the attribute of an object as a string in Ruby", "body": "<p>Considering the code in your question, it would suffice to simply redefine method <code>to_s</code> of Task.</p>\n\n<pre><code>class Task\n    attr_reader :description\n    def initialize (description)\n      @description = description\n    end\n\n    def to_s\n      \"Task: #{description}\"\n    end\nend\n</code></pre>\n\n<h3>Output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Your task list:\nTask: Make Breakfast\nTask: Wash the dishes!\nSend Birthday Gift to Mom\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 1, "creation_date": 1508227905, "post_id": 46785077, "comment_id": 80517121, "body": "Thank You again. This is even better. I feel like i made a big jump in understanding Ruby."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1508228348, "last_edit_date": 1508228348, "creation_date": 1508226479, "answer_id": 46785077, "question_id": 46784262, "link": "https://stackoverflow.com/questions/46784262/how-to-display-the-attribute-of-an-object-as-a-string-in-ruby/46785077#46785077", "title": "How to display the attribute of an object as a string in Ruby", "body": "<p>You call <code>add</code> with <code>Task</code> instances:</p>\n\n<pre><code>my_list.add(Task.new(\"Wash the dishes!\"))\n</code></pre>\n\n<p>and with <code>String</code> instances:</p>\n\n<pre><code>my_list.add(\"Send Birthday Gift to Mom\")\n</code></pre>\n\n<p>Having a mixture of both, <code>Task</code> and <code>String</code> instance in one array makes it harder to work with. Unless you really want or need this, I would change <code>add</code>, so it converts string arguments to <code>Task</code> instances:</p>\n\n<pre><code>class List\n  # ...\n\n  def add(task)\n    task = Task.new(task) unless task.is_a? Task\n    @all_tasks &lt;&lt; task\n  end\nend\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.4.2/Object.html#method-i-is_a-3F\" rel=\"nofollow noreferrer\"><code>is_a?</code></a> checks whether <code>task</code> is (already) a <code>Task</code>. If not, it is passed as an argument to <code>Task.new</code> which returns such instance. This ensures, that <code>@all_tasks</code> only contains <code>Task</code> instances.</p>\n\n<p>Your current implementation of <code>List#show</code> simply returns <code>all_tasks</code>, i.e. an array. Although <a href=\"http://ruby-doc.org/core-2.4.2/IO.html#method-i-puts\" rel=\"nofollow noreferrer\"><code>puts</code></a> is able to print arrays ...</p>\n\n<blockquote>\n  <p>If called with an array argument, writes each element on a new line.</p>\n</blockquote>\n\n<p>... I would change <code>show</code> to return a formatted string:</p>\n\n<pre><code>class List\n  # ...\n\n  def show\n    all_tasks.map { |task| \"[ ] #{task.description}\" }.join(\"\\n\")\n  end\nend\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.4.2/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> returns a new array with a string for each task instance. Each string contains the corresponding task's <code>description</code>, prefixed by <code>[ ]</code> which should resemble a little check box. <a href=\"http://ruby-doc.org/core-2.4.2/Array.html#method-i-join\" rel=\"nofollow noreferrer\"><code>join</code></a> then concatenates these string elements using <code>\"\\n\"</code> (newline) as a separator.</p>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Your task list:\n[ ] Make Breakfast\n[ ] Wash the dishes!\n[ ] Send Birthday Gift to Mom\n</code></pre>\n"}], "owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 46785077, "answer_count": 2, "score": 2, "last_activity_date": 1508228348, "creation_date": 1508223676, "last_edit_date": 1508225201, "question_id": 46784262, "link": "https://stackoverflow.com/questions/46784262/how-to-display-the-attribute-of-an-object-as-a-string-in-ruby", "title": "How to display the attribute of an object as a string in Ruby", "body": "<p>I have two classes <code>List</code> and <code>Task</code>:</p>\n\n<pre><code>class List\n  attr_reader :all_tasks\n\n  def initialize\n    @all_tasks = []\n  end\n\n  def add (task)\n    @all_tasks &lt;&lt; task\n  end\n\n  def show\n    all_tasks\n  end\nend\n\nclass Task\n  attr_reader :description\n\n  def initialize (description)\n    @description = description\n  end\nend\n</code></pre>\n\n<p>And the following code:</p>\n\n<pre><code>breakfast = Task.new(\"Make Breakfast\")\n\nmy_list = List.new\nmy_list.add(breakfast)\nmy_list.add(Task.new(\"Wash the dishes!\"))\nmy_list.add(\"Send Birthday Gift to Mom\")\n\nputs \"Your task list:\"\nputs my_list.show\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Your task list:\n#&lt;Task:0x00007fd9e4849ed0&gt;\n#&lt;Task:0x00007fd9e4849e30&gt;\nSend Birthday Gift to Mom\n</code></pre>\n\n<p>I want to be able to show the tasks of the to-do list as a string and in the same time have the <code>Task</code> instances as objects inside the array. How do I do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller", "routes"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508286616, "post_id": 46784312, "comment_id": 80548977, "body": "Of course that would be easier - but that would change the requirements I have. There is other functionality that requires that &quot;pizza&quot; remain intact as one dish. For instance, one dish that can appear in a multisearch - so you don&#39;t get countless results for pizza when searching - you get one result in case a user wants to see all the restaurants serving pizza."}, {"owner": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508286718, "post_id": 46784312, "comment_id": 80549002, "body": "Also - my app isn&#39;t actually a restaurant/dish app - I&#39;m just using this as an example. Just imagine that all pizza is the same in every restaurant and costs the same."}, {"owner": {"reputation": 177, "user_id": 3016184, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029927251/picture?type=large", "display_name": "SirUncleCid", "link": "https://stackoverflow.com/users/3016184/sirunclecid"}, "reply_to_user": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508288743, "post_id": 46784312, "comment_id": 80549452, "body": "Perhaps have another model that belongs to the dish, the restaurant, and holds your votes."}, {"owner": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508302135, "post_id": 46784312, "comment_id": 80552600, "body": "Good point - if my version of &quot;dish_categories&quot; (using this linked example) is set up already so that it belongs to the dish and the restaurant, would that model work or do you advise just keeping that separate and using a completely new model?"}, {"owner": {"reputation": 177, "user_id": 3016184, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029927251/picture?type=large", "display_name": "SirUncleCid", "link": "https://stackoverflow.com/users/3016184/sirunclecid"}, "reply_to_user": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508312772, "post_id": 46784312, "comment_id": 80557194, "body": "Technically, yes, you can. However, it goes against some conventions. Give me a moment to edit my post for a more detailed answer that I would suggest.  Updated my post.  Let me know what you think."}, {"owner": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508518292, "post_id": 46784312, "comment_id": 80654868, "body": "I think this is going to work but I can&#39;t figure out why I&#39;m getting this error: undefined method `vote_container&#39; for #&lt;Grouping::ActiveRecord_Associations_CollectionProxy:0x007f&zwnj;&#8203;8ab552a368&gt; in my &quot;dish&quot; model whenever I am looking at a &quot;restaurant&quot; where I have a restaurant&#39;s dishes listed."}, {"owner": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "edited": false, "score": 0, "creation_date": 1508518921, "post_id": 46784312, "comment_id": 80655185, "body": "Same error when accessing the dish view with dish.votes"}], "tags": [], "owner": {"reputation": 177, "user_id": 3016184, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029927251/picture?type=large", "display_name": "SirUncleCid", "link": "https://stackoverflow.com/users/3016184/sirunclecid"}, "is_accepted": true, "score": 1, "last_activity_date": 1508312747, "last_edit_date": 1508312747, "creation_date": 1508223860, "answer_id": 46784312, "question_id": 46783983, "link": "https://stackoverflow.com/questions/46783983/voting-for-nested-objects-using-acts-as-votable-gem-in-a-has-many-through-associ/46784312#46784312", "title": "Voting for nested objects using Acts as Votable gem in a has_many through association", "body": "<p>So, after getting a bit more data together, I think I have a solution that, although seemingly complicated, it's simple really and organized.</p>\n\n<p>I would suggest that you have your Restaurant and Dish models, as well as your DishRestaurant join table (or DishCategories as you have it in your original post), and finally a VoteContainer to hold the logic for votes.</p>\n\n<pre><code>class Restaurant &lt; ApplicationRecord\n  has_many :dish_restaurants\n  has_many :dishes, through: :dish_restaurants\nend\n\nclass Dish &lt; ApplicationRecord\n  has_many :dish_restaurants\n  has_many :restaurants, through: :dish_restaurants\n\n  def votes\n    dish_restaurants.vote_container \n  end\nend\n\nclass DishRestaurant &lt; ApplicationRecord\n  belongs_to :dish\n  belongs_to :restaurant\n\n  has_one :vote_container\nend\n\nclass VoteContainer &lt; ApplicationRecord\n  act_as_votable\n  belongs_to :dish_restaurant\nend\n</code></pre>\n\n<p>I was thinking of something along these lines may work.  In theory, dish.votes should be your gateway to the logic for managing votes</p>\n\n<hr>\n\n<h2>Original Reply  (disregard)</h2>\n\n<p>So, what I'm thinking is you may have what may feel like duplicate dishes.  So, you'll create a new pizza dish for each restaurant that offers pizza.  Technically it's not a duplicate, as it has it's own vote count for that particular restaurant.  This would probably be the easiest and most sensible way from what you're currently presenting.  </p>\n\n<p>This makes sense also because not every restaurant makes pizza the same way as others.  Each pizza may have different attributes (price, ingredients, etc).  If you do it the way I've suggested, you'll be open to these p</p>\n"}], "owner": {"reputation": 105, "user_id": 1864902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/054377770b1a89ebd2b6749a5b6738b1?s=128&d=identicon&r=PG", "display_name": "dstep", "link": "https://stackoverflow.com/users/1864902/dstep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 46784312, "answer_count": 1, "score": 0, "last_activity_date": 1508312747, "creation_date": 1508222575, "question_id": 46783983, "link": "https://stackoverflow.com/questions/46783983/voting-for-nested-objects-using-acts-as-votable-gem-in-a-has-many-through-associ", "title": "Voting for nested objects using Acts as Votable gem in a has_many through association", "body": "<p>Using this answer <a href=\"https://stackoverflow.com/questions/31390120/voting-for-nested-objects-using-the-acts-as-votable-gem\">Voting for nested objects using the Acts As Votable gem</a> I was able to get voting working for my app but not exactly what I was hoping for. In Carl's example his \"dish\" model belongs_to :dish_category but my setup looks more like this:</p>\n\n<pre><code> class Dish &lt; ActiveRecord::Base\n   has_many :restaurants, through: :dish_categories\n end\n</code></pre>\n\n<p>Right now when someone votes for a dish, it counts as a vote for that dish regardless of the restaurant. I would like to figure out if it's possible for dishes to have separate voting counts based on current restaurant. So if I'm a user I can vote up pizza at one restaurant but then vote down pizza at a different restaurant.</p>\n"}, {"tags": ["ruby", "ubuntu", "redmine"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1508222684, "post_id": 46783890, "comment_id": 80514281, "body": "Perhaps it is related to this <a href=\"https://www.redmine.org/issues/24831\" rel=\"nofollow noreferrer\">issue on Redmine.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1508330115, "post_id": 46786681, "comment_id": 80567721, "body": "<code>require_sudo_mode</code> is not a gem but a method provided by Redmine. It has nothing to do with a failed database connection. Instead, it is (as @spickermann correctly identified) a reported Redmine issue which might be caused by certain environment conditions."}], "tags": [], "owner": {"reputation": 13, "user_id": 7715074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C8sf4.jpg?s=128&g=1", "display_name": "Mohammed Riyaz", "link": "https://stackoverflow.com/users/7715074/mohammed-riyaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1508231950, "creation_date": 1508231950, "answer_id": 46786681, "question_id": 46783890, "link": "https://stackoverflow.com/questions/46783890/web-application-could-not-be-started-undefined-method/46786681#46786681", "title": "Web application could not be started undefined method", "body": "<p>Please ensure you'r connected with your database and did you missing any required gem.</p>\n\n<p>require_sudo_mode. If the error comes because of this you definitely missing this gem.</p>\n\n<p>This type of error comes under database not connected issue.If you are fix that this would be start.Thanks..! </p>\n"}], "owner": {"reputation": 1, "user_id": 8775509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38e2be747d5cbbbbfa91d27d5d300ec?s=128&d=identicon&r=PG&f=1", "display_name": "sriram", "link": "https://stackoverflow.com/users/8775509/sriram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508329706, "creation_date": 1508222144, "last_edit_date": 1508329706, "question_id": 46783890, "link": "https://stackoverflow.com/questions/46783890/web-application-could-not-be-started-undefined-method", "title": "Web application could not be started undefined method", "body": "<p>When I installed redmine-3.3 &amp; 3.4 , I am not getting redmine page \nI am facing this Error </p>\n\n<pre><code>Web application could not be started\nundefined method `require_sudo_mode' for EmailAddressesController:Class (NoMethodError)\n  /usr/share/redmine/app/controllers/email_addresses_controller.rb:21:in `&lt;class:EmailAddressesController&gt;'  \n  /usr/share/redmine/app/controllers/email_addresses_controller.rb:18:in `&lt;top (required)&gt;'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:251:in `require'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:251:in `block in require'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:236:in `load_dependency'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:251:in `require'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:359:in `require_or_load'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:313:in `depend_on'  \n  /usr/lib/ruby/vendor_ruby/active_support/dependencies.rb:225:in `require_dependency'  \n  /usr/lib/ruby/vendor_ruby/rails/engine.rb:444:in `block (2 levels) in eager_load!'\n  /usr/lib/ruby/vendor_ruby/rails/engine.rb:443:in `each'\n  /usr/lib/ruby/vendor_ruby/rails/engine.rb:443:in `block in eager_load!'\n  /usr/lib/ruby/vendor_ruby/rails/engine.rb:441:in `each'\n  /usr/lib/ruby/vendor_ruby/rails/engine.rb:441:in `eager_load!'\n  /usr/lib/ruby/vendor_ruby/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'  \n  /usr/lib/ruby/vendor_ruby/rails/initializable.rb:30:in `instance_exec'\n  /usr/lib/ruby/vendor_ruby/rails/initializable.rb:30:in `run'  \n  /usr/lib/ruby/vendor_ruby/rails/initializable.rb:55:in `block in run_initializers'  \n  /usr/lib/ruby/vendor_ruby/rails/initializable.rb:54:in `each'  \n  /usr/lib/ruby/vendor_ruby/rails/initializable.rb:54:in `run_initializers'  \n  /usr/lib/ruby/vendor_ruby/rails/application.rb:136:in `initialize!'  \n  /usr/lib/ruby/vendor_ruby/rails/railtie/configurable.rb:30:in `method_missing'\n  /usr/share/redmine/config/environment.rb:14:in `&lt;top (required)&gt;'\n  config.ru:3:in `require'\n  config.ru:3:in `block in &lt;main&gt;'\n  /usr/lib/ruby/vendor_ruby/rack/builder.rb:51:in `instance_eval'\n  /usr/lib/ruby/vendor_ruby/rack/builder.rb:51:in `initialize'\n  config.ru:1:in `new'\n  config.ru:1:in `&lt;main&gt;'  \n  /usr/share/passenger/helper-scripts/rack-preloader.rb:112:in `eval'  \n  /usr/share/passenger/helper-scripts/rack-preloader.rb:112:in `preload_app'  \n  /usr/share/passenger/helper-scripts/rack-preloader.rb:158:in `&lt;module:App&gt;'  \n  /usr/share/passenger/helper-scripts/rack-preloader.rb:29:in `&lt;module:PhusionPassenger&gt;'  \n  /usr/share/passenger/helper-scripts/rack-preloader.rb:28:in `&lt;main&gt;'\nApplication root /usr/share/redmine Environment (value of RAILS_ENV, RACK_ENV, WSGI_ENV and PASSENGER_ENV) production Ruby interpreter\ncommand /usr/bin/ruby.. .... ..\n</code></pre>\n\n<p>Can you give me suggestions?</p>\n"}]