[{"tags": ["html", "ruby", "associations"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566425517, "post_id": 57599607, "comment_id": 101656722, "body": "Hey Panic, thanks for the reply. I have edited the original HTML code. I will try to understand yours as well as I am still not too sure yet."}, {"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566475361, "post_id": 57599607, "comment_id": 101673136, "body": "Hey Panic, Thank you I have fixed it now."}], "tags": [], "owner": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "is_accepted": false, "score": 0, "last_activity_date": 1566424608, "creation_date": 1566424608, "answer_id": 57599607, "question_id": 57599350, "link": "https://stackoverflow.com/questions/57599350/ruby-on-rails-how-to-display-information-from-another-table/57599607#57599607", "title": "Ruby on rails: How to display information from another table?", "body": "<p><code>exercisetype.benefits</code> is a collection:</p>\n\n<pre><code># index.html.erb\n&lt;ul&gt;\n  &lt;% exercisetype.benefits.each do |benefit| %&gt;\n    &lt;li&gt;&lt;%= benefit.name %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566466776, "post_id": 57601353, "comment_id": 101668385, "body": "Hey Gustavo, Thanks for the help I will work on it now."}, {"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566475386, "post_id": 57601353, "comment_id": 101673153, "body": "Hey Gustavo, Thanks for the explanation it is working now."}], "tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": false, "score": 0, "last_activity_date": 1566441411, "creation_date": 1566441411, "answer_id": 57601353, "question_id": 57599350, "link": "https://stackoverflow.com/questions/57599350/ruby-on-rails-how-to-display-information-from-another-table/57601353#57601353", "title": "Ruby on rails: How to display information from another table?", "body": "<p>Benefits belongs to exercisetype model, so you need to iterate over benefits to access the attributes. Check this:</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;% @exercisetypes.each do |exercisetype| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= exercisetype.name %&gt; &lt;/td&gt;\n      &lt;td&gt;\n        &lt;ul&gt;\n          &lt;% exercisetype.benefits.each do |benefit| %&gt;\n            &lt;li&gt;&lt;%= benefit.name %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n        &lt;/ul&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566466668, "post_id": 57603156, "comment_id": 101668323, "body": "Hey Saif, Thanks for the reply I will check it out now."}, {"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566470207, "post_id": 57603156, "comment_id": 101670269, "body": "Hey Saif, it is working I am getting one item from benefit. But if I select multiple items it comes up as blank. Sorry I am fairly new to this so not sure what parts I need to be looking at. Thanks"}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "reply_to_user": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566470944, "post_id": 57603156, "comment_id": 101670694, "body": "First you need to add more than multiple items in benefit. For Example from your rails c: exercisetype.benefits.create(name: &quot;Health&quot;) Then reload your page and see if you&#39;ve this benefit listed"}, {"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566471478, "post_id": 57603156, "comment_id": 101670988, "body": "Hey Saif, In my benefit Index.html I have for example Health, Leg muscles and Neck Muscles. In the Exercise type index.html it can show one of the items but when I click all 3 and save it will display a blank. I have added a picture as well just incase. Thanks for your help"}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "reply_to_user": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566471919, "post_id": 57603156, "comment_id": 101671238, "body": "Couldn&#39;t find any picture"}, {"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566472253, "post_id": 57603156, "comment_id": 101671439, "body": "Oh sorry, I put it at the top called List Display as a hyperlink."}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "reply_to_user": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566473247, "post_id": 57603156, "comment_id": 101671970, "body": "Can you please update your question with the latest code."}, {"owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566475342, "post_id": 57603156, "comment_id": 101673123, "body": "Hey saif, do not worry. I was foolish and forgot that I played around with permit forgot to change it back to normal. Thanks for your help"}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "reply_to_user": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566475348, "post_id": 57603156, "comment_id": 101673128, "body": "Hey, your code looks fine. Does it show more than one benefits for a single exercisetype ?"}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "reply_to_user": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "edited": false, "score": 0, "creation_date": 1566475575, "post_id": 57603156, "comment_id": 101673249, "body": "Cool. Good luck."}], "tags": [], "owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "is_accepted": false, "score": 0, "last_activity_date": 1566455179, "creation_date": 1566455179, "answer_id": 57603156, "question_id": 57599350, "link": "https://stackoverflow.com/questions/57599350/ruby-on-rails-how-to-display-information-from-another-table/57603156#57603156", "title": "Ruby on rails: How to display information from another table?", "body": "<p>Exercise has_many benefits which mean when you do exercise.benefits it will return a collection of benefits object so you need to iterate through it.</p>\n\n<p>Your collection will look like</p>\n\n<pre><code>`#&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Benefit id: 1,  name: \"Good Health\"&gt;, #&lt;Benefit id: 2, name: \"Blood flow\"&gt;]&gt;`\n</code></pre>\n\n<p>So you need to iterate through it like.</p>\n\n<pre><code>&lt;% exercisetype.benefits.each do |benefit| %&gt;\n    &lt;li&gt;&lt;%= benefit.name %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11959244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dccc5010a18c3e9a9250dbf023810de?s=128&d=identicon&r=PG&f=1", "display_name": "WTC", "link": "https://stackoverflow.com/users/11959244/wtc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1566475636, "creation_date": 1566422774, "last_edit_date": 1566475636, "question_id": 57599350, "link": "https://stackoverflow.com/questions/57599350/ruby-on-rails-how-to-display-information-from-another-table", "title": "Ruby on rails: How to display information from another table?", "body": "<p>Updated: 22/08/2019\nThis is working now. Thanks for feedback and help!</p>\n\n<p>Image of Benefit list: <a href=\"https://i.stack.imgur.com/V78WG.jpg\" rel=\"nofollow noreferrer\">List Display</a> &lt;-- Needed to params permit benefit_ids</p>\n\n<p>Old Version: 21/08/2019</p>\n\n<p>I have set up many to many associations but can't get the data table name. I can get the ID but it won't allow me to display the other fields information.</p>\n\n<p>I have looked in the controller and added to permit benefit_ids but not sure if I should add anything else to it. </p>\n\n<pre><code>exercisetypes(Index.html.erb)\n --- Old code (21/08/2019)\n&lt;tbody&gt;\n    &lt;% @exercisetypes.each do |exercisetype| %&gt;\n    &lt;tr&gt;\n    &lt;td&gt;&lt;%= exercisetype.name %&gt; &lt;/td&gt;\n    &lt;td&gt;&lt;%= exercisetype.benefits.name %&gt; &lt;/td&gt;\n...\n\n ---\nNew code (22/08/2019)\n    &lt;tbody&gt;\n    &lt;% @exercisetypes.each do |exercisetype| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt; &lt;%= exercisetype.name %&gt; &lt;/td&gt;\n          &lt;td&gt;\n           &lt;ul&gt;\n            &lt;% exercisetype.benefits.each do |benefit| %&gt;\n            &lt;li&gt;&lt;%= benefit.name %&gt;&lt;/li&gt;\n           &lt;% end %&gt;\n          &lt;/ul&gt;\n         &lt;/td&gt;\n    &lt;% end %&gt;\n    ...\n\n\n  _form.html.erb(Gem: simple form)\n\n  &lt;% f.association :benefits, as: :check_boxes %&gt;\n\n</code></pre>\n\n<pre><code>Models\n\nexercisetype.rb\n  has_many :exercisetype_benefits, dependent: :destroy\n  has_many :benefits, :through =&gt; :exercisetype_benefits\n\n\nbenefit.rb\n  has_many :exercisetype_benefits\n  has_many :exercisetypes, :through =&gt; :exercisetype_benefits\n\n\nexercisetype_benefit.rb\n  belongs_to :exercisetype\n  belongs_to :benefit\n</code></pre>\n\n<p>The table displays the model name Benefit. There are no error messages but I am not sure how to display the name of the benefit.</p>\n"}, {"tags": ["javascript", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566423624, "post_id": 57599348, "comment_id": 101656208, "body": "add your images to the html from your server side code and just initialize the slider why do you think you need to insert the images into the slider after the page has loaded ? are they coming from any ajax request or api ?"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566424558, "post_id": 57599348, "comment_id": 101656454, "body": "@MuhammadOmerAslam hmm well my images are uploaded by the user and the user can upload more than one image at a time. When the images are uploaded they are stored in <code>@service.images</code> so I am looking for a way to get the images from there and insert them into each slide on my carousel does that make sense?"}, {"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566424913, "post_id": 57599348, "comment_id": 101656546, "body": "yes that makes sense and that would require you to use javascript or jquery, i am more a <code>php</code> guy not familiar  with ruby so dont know if <code>@service.images</code> is a location that can be accessed via server side code? and return the urls of the images via ajax call to insert into the slider using javascript/jquery"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566425252, "post_id": 57599348, "comment_id": 101656638, "body": "@MuhammadOmerAslam ok i&#39;m glad I was on the right path. I think what I need to do is a for each loop and then for each image i need to use JavaScript or something to insert each image into the carousel slide. The problem is I am a junior coder and I&#39;m not sure how to write this yet. I&#39;ll wait for a bit longer to see if any other Rubyists know! Thank you. Also yes <code>@service.images</code> is the array that I am iterating over extract the image and display it to my FE."}, {"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566425402, "post_id": 57599348, "comment_id": 101656685, "body": "you should check if the slider api provides you any method for adding a slide on runtime? if not, you might have to add child nodes in the parent container of the slider/carousel html and <code>destroy()</code> and then <code>initialize()</code> the slider again, most of the javascript libraries do provide an option to destrory the plugin"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566476868, "post_id": 57599348, "comment_id": 101673964, "body": "hey @MuhammadOmerAslam this is way over my head as im just a beginner. Is there no easier way to do this? I will research about the slider api and see what I find!"}, {"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566480486, "post_id": 57599348, "comment_id": 101676216, "body": "which slider are you using can you provide the link ?"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566481120, "post_id": 57599348, "comment_id": 101676624, "body": "Something similar to this: <a href=\"https://getbootstrap.com/docs/4.0/components/carousel/\" rel=\"nofollow noreferrer\">getbootstrap.com/docs/4.0/components/carousel</a> the one that says &quot;with indicators&quot;"}, {"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566485533, "post_id": 57599348, "comment_id": 101679349, "body": "you just need to append the html to the <code>&lt;div class=&quot;carousel-inner&quot;&gt;</code>  and it will automatically pick it up no need to re-initialize or destroy it just prepare your html and use <code>$(&#39;.carousel-inner&#39;).append()</code> to add a new slide to the slider and it will pick it up automatically"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1566498894, "post_id": 57599348, "comment_id": 101685493, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/198327/discussion-between-angela-inniss-and-muhammad-omer-aslam\">continue this discussion in chat</a>."}], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566422752, "creation_date": 1566422752, "question_id": 57599348, "link": "https://stackoverflow.com/questions/57599348/extracting-image-index-from-array-in-order-to-insert-image-into-a-bootstrap-caro", "title": "Extracting image index from array in order to insert image into a bootstrap carousel", "body": "<p>I have an array of images which I can iterate over and display on my page however this is not what I want. I would like to find the index of each image in my array so that (on each loop) I can insert one of the images into my bootstrap carousel slides.</p>\n\n<p>Will I need Javascript to do this? I am unsure and hope someone can point me in the right direction.</p>\n\n<p>To start I tried to do a for each with index loop and extract the index but I was not able to :(</p>\n\n<p>This is the bootstrap carousel. So far you can see that I have put my iteration into the first slide which means all 3 images are showing on the first slide:</p>\n\n<pre><code>&lt;div class=\"carousel-inner\" role=\"listbox\"&gt;\n    &lt;div class=\"carousel-item active\"&gt;\n     &lt;!--  &lt;img class=\"d-block w-100\" src=\"https://mdbootstrap.com/img/Photos/Slides/img%20(88).jpg\"\n       alt=\"First slide\"&gt; --&gt;\n      &lt;!-- app/views/posts/show.html.erb --&gt;\n     &lt;% if @service.images.attached? %&gt;\n      &lt;% @service.images.each do |image| %&gt;\n        &lt;%= image_tag(image) %&gt;\n        &lt;% end %&gt;\n     &lt;% end %&gt;\n    &lt;/div&gt;\n     &lt;div class=\"carousesl-item\"&gt;\n   &lt;!--   &lt;img class=\"d-block w-100\" src=\"https://mdbootstrap.com/img/Photos/Slides/img%20(121).jpg\"\n    alt=\"Second slide\"&gt; --&gt;\n    &lt;/div&gt;\n    &lt;div class=\"carousel-item\"&gt;\n   &lt;!--    &lt;img class=\"d-block w-100\" src=\"https://mdbootstrap.com/img/Photos/Slides/img%20(31).jpg\"\n     alt=\"Third slide\"&gt; --&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;!--/.Slides--&gt;\n  &lt;!--Controls--&gt;\n  &lt;a class=\"carousel-control-prev\" href=\"#carousel-thumb\" role=\"button\" data-slide=\"prev\"&gt;\n    &lt;span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Previous&lt;/span&gt;\n  &lt;/a&gt;\n  &lt;a class=\"carousel-control-next\" href=\"#carousel-thumb\" role=\"button\" data-slide=\"next\"&gt;\n    &lt;span class=\"carousel-control-next-icon\" aria-hidden=\"true\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Next&lt;/span&gt;\n  &lt;/a&gt;\n  &lt;!--/.Controls--&gt;\n  &lt;ol class=\"carousel-indicators\"&gt;\n    &lt;li data-target=\"#carousel-thumb\" data-slide-to=\"0\" class=\"active\"&gt;\n      &lt;img src=\"https://mdbootstrap.com/img/Photos/Others/Carousel-thumbs/img%20(88).jpg\" width=\"100\"&gt;\n    &lt;/li&gt;\n    &lt;li data-target=\"#carousel-thumb\" data-slide-to=\"1\"&gt;\n      &lt;img src=\"https://mdbootstrap.com/img/Photos/Others/Carousel-thumbs/img%20(121).jpg\" width=\"100\"&gt;\n    &lt;/li&gt;\n    &lt;li data-target=\"#carousel-thumb\" data-slide-to=\"2\"&gt;\n      &lt;img src=\"https://mdbootstrap.com/img/Photos/Others/Carousel-thumbs/img%20(31).jpg\" width=\"100\"&gt;\n    &lt;/li&gt;\n  &lt;/ol&gt;\n&lt;/div&gt;\n&lt;!--/.Carousel Wrapper--&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "algorithm", "time-complexity", "big-o", "space-complexity"], "comments": [{"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566420569, "post_id": 57598930, "comment_id": 101655235, "body": "Does <code>str2.index</code> search through <code>str2</code>? If so, I think you&#39;re looking at time <code>O(n^2)</code> here... In fact, <code>slice</code> is almost certainly <code>O(n)</code> itself, so yes, this is time <code>O(n^2)</code>."}, {"owner": {"reputation": 53, "user_id": 10404505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d32bafd0c36a0b223d130ee11e8005?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/10404505/henry"}, "reply_to_user": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566420635, "post_id": 57598930, "comment_id": 101655256, "body": "My apologies, it is quadratic as you mentioned..."}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 1, "creation_date": 1566420708, "post_id": 57598930, "comment_id": 101655284, "body": "Space is at least <code>O(n)</code>, since you&#39;re modifying a copy of <code>str2</code> with the call to <code>slice</code>."}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566420808, "post_id": 57598930, "comment_id": 101655326, "body": "I can think of an <code>O(n log n)</code> time algorithm for this, also with <code>O(n)</code> space, do you can about making faster or just doing the Big-Oh analysis of this code?"}, {"owner": {"reputation": 53, "user_id": 10404505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d32bafd0c36a0b223d130ee11e8005?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/10404505/henry"}, "reply_to_user": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566420957, "post_id": 57598930, "comment_id": 101655369, "body": "I have made it faster, using a hash table data structure into which I insert the counts of each letter within a loop. That gives me O(n) time and O(1) space."}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566421124, "post_id": 57598930, "comment_id": 101655426, "body": "Yeah, the hash table is even faster than what I thought (which was basically equality of sorting the two strings by character), but I disagree with <code>O(1)</code> space: the hash table will require <code>O(n)</code> space."}, {"owner": {"reputation": 53, "user_id": 10404505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d32bafd0c36a0b223d130ee11e8005?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/10404505/henry"}, "reply_to_user": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566421184, "post_id": 57598930, "comment_id": 101655444, "body": "Does the re-assignment of <code>selected_index</code> contribute significantly to the space complexity? Or that will mainly come from the <code>.slice</code> call to the object?"}, {"owner": {"reputation": 53, "user_id": 10404505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d32bafd0c36a0b223d130ee11e8005?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/10404505/henry"}, "reply_to_user": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566421275, "post_id": 57598930, "comment_id": 101655470, "body": "I thought the hash table was <code>O(n)</code> at a first glance after implementation, but regardless of the input size there will always be a maximum of 26 characters. So it is constant."}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 1, "creation_date": 1566421277, "post_id": 57598930, "comment_id": 101655472, "body": "I would have thought <code>selected_index =</code> would take <code>O(1)</code> space per call, I don&#39;t see it being a problem."}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566421315, "post_id": 57598930, "comment_id": 101655485, "body": "Agreed, if you consider a limited alphabet, it&#39;s constant space."}, {"owner": {"reputation": 53, "user_id": 10404505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d32bafd0c36a0b223d130ee11e8005?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/10404505/henry"}, "reply_to_user": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1566421770, "post_id": 57598930, "comment_id": 101655637, "body": "Many thanks for your help!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566467229, "post_id": 57598930, "comment_id": 101668643, "body": "It doesn&#39;t make sense to talk about algorithmic complexity without specifying your machine model and cost model. What machine model are you using? What are the operations you are counting?"}], "answers": [{"tags": [], "owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "is_accepted": true, "score": 2, "last_activity_date": 1566441778, "creation_date": 1566441778, "answer_id": 57601389, "question_id": 57598930, "link": "https://stackoverflow.com/questions/57598930/time-and-space-complexity-of-ruby-anagram-algorithm/57601389#57601389", "title": "Time and space complexity of Ruby Anagram algorithm", "body": "<p>Gathering up all those comments into an answer, here is my analysis:</p>\n\n<p><strong>Time</strong></p>\n\n<p>The algorithm as presented does indeed have <code>O(n^2)</code> running time.</p>\n\n<p>The body of the loop is executed <code>n</code> times and takes linear time for <code>index</code>, linear time for <code>slice</code>, and constant time for the rest, requiring a total of <code>O(n^2)</code> time.</p>\n\n<p><strong>Space</strong></p>\n\n<p>The algoithm as presented requires linear space, because it updates a copy of <code>str2</code> at each iteration.</p>\n\n<p>The rest of the algorithm only takes constant space, unless you include the storage for the inputs themselves, which is also linear.</p>\n\n<p><strong>Faster algorithm: sort <code>str1</code> and <code>str2</code></strong></p>\n\n<p>A faster algorithm would be to do string compare <code>sort-by-character(str1)</code> and <code>sort-by-character(str2)</code>. That would take <code>O(n log n)</code> time and <code>O(n)</code> space for the sort; and linear time and constant space for the comparison, for an overall <code>O(n log n)</code> time and <code>O(n)</code> space.</p>\n\n<p><strong>Even faster algorithm: use a hash (proposed by OP in the comments)</strong></p>\n\n<p>Using hash tables to store character and then compare character counts can reduce the running time to <code>O(n)</code>, assuming standard <code>O(1)</code> insert and lookup hash operations. The space in this case is the space required for the hash tables, which is <code>O(k)</code> for a character alphabet of size <code>k</code>, which can be considered constant if <code>k</code> is fixed. Of course, the input parameters still consume their initial <code>O(n)</code> space as they are passed in or where they are originally stored; the <code>O(k)</code> reflects only the additional space required to run this algorithm.</p>\n"}], "owner": {"reputation": 53, "user_id": 10404505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d32bafd0c36a0b223d130ee11e8005?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/10404505/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 57601389, "answer_count": 1, "score": 2, "last_activity_date": 1566441778, "creation_date": 1566420028, "last_edit_date": 1566420657, "question_id": 57598930, "link": "https://stackoverflow.com/questions/57598930/time-and-space-complexity-of-ruby-anagram-algorithm", "title": "Time and space complexity of Ruby Anagram algorithm", "body": "<p>I have written this algorithm here and I am trying to evaluate its time and space complexity in terms of Big-O notation. The algorithm determines if two given strings are anagrams. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def anagram(str1, str2)\n str1.each_char do |char| \n   selected_index = str2.index(char)\n   return false if !selected_index #to handle nil index\n\n   str2.slice!(selected_index)\n end\n\n str2.empty?\nend\n</code></pre>\n\n<p>The time complexity of this function is <code>O(n^2)</code>, and the space complexity is <code>O(1)</code>? I believe I may be mistaken for the space complexity (could be <code>O(n)</code>) because the <code>selected_index</code> variable is repeatedly re-assigned which takes up memory relative to how long the <code>each_char</code> loop runs for. </p>\n\n<p>If someone could please throw some guidance that would be great :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sass", "rails-engines"], "comments": [{"owner": {"reputation": 103, "user_id": 2508184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XslYv.jpg?s=128&g=1", "display_name": "Ali Ammaar", "link": "https://stackoverflow.com/users/2508184/ali-ammaar"}, "edited": false, "score": 0, "creation_date": 1566914834, "post_id": 57598744, "comment_id": 101800028, "body": "have same error but I were not able to recognize the root cause, Unfortunately no luck to get it down yet"}, {"owner": {"reputation": 103, "user_id": 2508184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XslYv.jpg?s=128&g=1", "display_name": "Ali Ammaar", "link": "https://stackoverflow.com/users/2508184/ali-ammaar"}, "edited": false, "score": 0, "creation_date": 1566916730, "post_id": 57598744, "comment_id": 101801102, "body": "are you loading static assets, if so, can you please share the code snippet."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11979642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df7b2d4d92f0d13ae12bee754566b7f?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Walker", "link": "https://stackoverflow.com/users/11979642/jeff-walker"}, "is_accepted": false, "score": 0, "last_activity_date": 1566853162, "creation_date": 1566853162, "answer_id": 57664872, "question_id": 57598744, "link": "https://stackoverflow.com/questions/57598744/scss-import-statements-inside-rails-engine-results-in-error-aborted-core-dum/57664872#57664872", "title": "SCSS @import statements inside Rails Engine results in error: `Aborted (core dumped)`", "body": "<p>We had the same problem with one of our scss files that was still using @import \"foo.css\" syntax.  Changing syntax to @import url(foo.css) fixed it for us. </p>\n\n<p>Not clear what syntax you are using from the original question.</p>\n"}, {"tags": [], "owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "is_accepted": true, "score": 0, "last_activity_date": 1566930464, "creation_date": 1566930464, "answer_id": 57680388, "question_id": 57598744, "link": "https://stackoverflow.com/questions/57598744/scss-import-statements-inside-rails-engine-results-in-error-aborted-core-dum/57680388#57680388", "title": "SCSS @import statements inside Rails Engine results in error: `Aborted (core dumped)`", "body": "<p>The issue actually was a bug with <code>thin</code> server which I have been using in development, switching to <code>puma</code> solved this problem.</p>\n"}, {"tags": [], "owner": {"reputation": 5064, "user_id": 524740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d217125368b3d2afc1be2129674d39e2?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/524740/prem"}, "is_accepted": false, "score": 0, "last_activity_date": 1608708700, "creation_date": 1608708700, "answer_id": 65420509, "question_id": 57598744, "link": "https://stackoverflow.com/questions/57598744/scss-import-statements-inside-rails-engine-results-in-error-aborted-core-dum/65420509#65420509", "title": "SCSS @import statements inside Rails Engine results in error: `Aborted (core dumped)`", "body": "<p>I have a <code>}</code> missing in scss file and got the same error.</p>\n<p>Adding missing <code>}</code> fixed the error in my case.</p>\n<p>Please check your latest changes in scss/css files once.</p>\n"}], "owner": {"reputation": 4896, "user_id": 3068360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1As83.jpg?s=128&g=1", "display_name": "Weston Ganger", "link": "https://stackoverflow.com/users/3068360/weston-ganger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 57680388, "answer_count": 3, "score": 2, "last_activity_date": 1608708700, "creation_date": 1566418988, "question_id": 57598744, "link": "https://stackoverflow.com/questions/57598744/scss-import-statements-inside-rails-engine-results-in-error-aborted-core-dum", "title": "SCSS @import statements inside Rails Engine results in error: `Aborted (core dumped)`", "body": "<p>I am having trouble using SCSS <code>@import</code> statements within any of my Rails Engines. Can someone please help me sort this out? Here are some details:</p>\n\n<ul>\n<li>Using <code>@import</code> within any SCSS files within the Rails engine files causes the main application to crash. Here are the last two lines that the logger shows.\n\n<ul>\n<li><code>Rendered &lt;snipped&gt; (Duration: 87.4ms | Allocations: 33352)</code></li>\n<li><code>Aborted (core dumped)</code></li>\n</ul></li>\n<li>SCSS works correctly within the engine when <code>@import</code> is not used</li>\n<li>SCSS <code>@import</code> statements work correctly within my main applications asset files</li>\n<li>I am running Rails 6.0 and <code>sassc-rails</code></li>\n</ul>\n\n<p>So far I cannot find any way to get them working. Can someone please help me sort this out?</p>\n"}, {"tags": ["ruby", "activeadmin"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1566417645, "post_id": 57598274, "comment_id": 101654130, "body": "The next will probably be faster but truthfully the difference will be so minuscule you really won&#39;t notice it. They&#39;re both called after the resource is instantiated."}, {"owner": {"reputation": 10814, "user_id": 985241, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/802150025e2e8b524e4d5f01259738dc?s=128&d=identicon&r=PG", "display_name": "rmagnum2002", "link": "https://stackoverflow.com/users/985241/rmagnum2002"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1566418246, "post_id": 57598274, "comment_id": 101654344, "body": "@JoshBrody is makes sense of course, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "is_accepted": true, "score": 0, "last_activity_date": 1566562074, "creation_date": 1566562074, "answer_id": 57626049, "question_id": 57598274, "link": "https://stackoverflow.com/questions/57598274/activeadmin-skipping-action-item-with-next-versus-proc/57626049#57626049", "title": "ActiveAdmin skipping action_item with next versus proc", "body": "<p>With proc, you can delay execution to render time. If the condition to show the action_item would depend on data from the request cycle (a get parameter, a session cookie, a logged in admin_user, or perhaps an active scope in an index page), you can use proc. </p>\n\n<p>This will cause an error at server start:</p>\n\n<pre><code>action_item :user_reviewed, only: %i[show], if: params[:scope] == 'somescopename'\n</code></pre>\n\n<p>Activeadmin registers the resource at server start time, and no request-cycle data is present.  When needed you can use:</p>\n\n<pre><code>action_item :user_reviewed, only: %i[show], if: proc {params[:scope] == 'somescopename' }. \n</code></pre>\n\n<p>This is also is helpful for collection filters. Sometimes they need to be filled with data at render time, not at rails server startup time. Check <a href=\"https://activeadmin.info/3-index-pages.html\" rel=\"nofollow noreferrer\">https://activeadmin.info/3-index-pages.html</a> and search for <code>proc</code>.</p>\n"}], "owner": {"reputation": 10814, "user_id": 985241, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/802150025e2e8b524e4d5f01259738dc?s=128&d=identicon&r=PG", "display_name": "rmagnum2002", "link": "https://stackoverflow.com/users/985241/rmagnum2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57626049, "answer_count": 1, "score": 0, "last_activity_date": 1566562074, "creation_date": 1566416626, "last_edit_date": 1566417053, "question_id": 57598274, "link": "https://stackoverflow.com/questions/57598274/activeadmin-skipping-action-item-with-next-versus-proc", "title": "ActiveAdmin skipping action_item with next versus proc", "body": "<p>There are two ways of skipping an item in ActiveAdmin gem</p>\n\n<pre><code>  action_item :user_reviewed, only: %i[show] do\n    next unless resource.individual?\n    ....\n  end\n</code></pre>\n\n<p>vs documented one: </p>\n\n<pre><code>  action_item :user_reviewed, only: %i[show], if: proc{ resource.individual? } do\n    ....\n  end\n</code></pre>\n\n<p>both, proc and next would skip creating the action_item and move to next one, but from the technical point of view (not that documentation says so), which one would perform better and more important is - why?\nIn my understanding next is faster since it's just skips to the next element, compared to proc that means calling a function.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "vagrant", "vagrantfile"], "comments": [{"owner": {"reputation": 539, "user_id": 9006638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV5us.jpg?s=128&g=1", "display_name": "Michael Arkhipov", "link": "https://stackoverflow.com/users/9006638/michael-arkhipov"}, "edited": false, "score": 0, "creation_date": 1566417699, "post_id": 57598024, "comment_id": 101654153, "body": "In what environment is the application running? You originally asked about <code>test</code>."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9706080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2961a5af8044cbfe2e3a22984fa017de?s=128&d=identicon&r=PG&f=1", "display_name": "sandy", "link": "https://stackoverflow.com/users/9706080/sandy"}, "edited": false, "score": 0, "creation_date": 1566416530, "post_id": 57598094, "comment_id": 101653715, "body": "Thanks @michael - I changed the name of database in question to avoid confusion.    <code>vagrant@vagrant-ubuntu-trusty-64:&#47;vagrant$ cat &#47;home&#47;vagrant&#47;.pgpass      localhost:5432:test:postgres:xyz</code>"}, {"owner": {"reputation": 539, "user_id": 9006638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV5us.jpg?s=128&g=1", "display_name": "Michael Arkhipov", "link": "https://stackoverflow.com/users/9006638/michael-arkhipov"}, "reply_to_user": {"reputation": 73, "user_id": 9706080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2961a5af8044cbfe2e3a22984fa017de?s=128&d=identicon&r=PG&f=1", "display_name": "sandy", "link": "https://stackoverflow.com/users/9706080/sandy"}, "edited": false, "score": 0, "creation_date": 1566417043, "post_id": 57598094, "comment_id": 101653916, "body": "@sandy So, just add <code>test</code> as <code>database</code>, <code>postgres</code> as <code>username</code> and <code>xyz</code> as <code>password</code> to the yml file."}, {"owner": {"reputation": 539, "user_id": 9006638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV5us.jpg?s=128&g=1", "display_name": "Michael Arkhipov", "link": "https://stackoverflow.com/users/9006638/michael-arkhipov"}, "reply_to_user": {"reputation": 73, "user_id": 9706080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2961a5af8044cbfe2e3a22984fa017de?s=128&d=identicon&r=PG&f=1", "display_name": "sandy", "link": "https://stackoverflow.com/users/9706080/sandy"}, "edited": false, "score": 0, "creation_date": 1566417436, "post_id": 57598094, "comment_id": 101654054, "body": "@sandy Or you can use <code>my_db</code> as <code>database</code> if it exists on your machine."}, {"owner": {"reputation": 73, "user_id": 9706080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2961a5af8044cbfe2e3a22984fa017de?s=128&d=identicon&r=PG&f=1", "display_name": "sandy", "link": "https://stackoverflow.com/users/9706080/sandy"}, "edited": false, "score": 0, "creation_date": 1566417982, "post_id": 57598094, "comment_id": 101654251, "body": "Thanks. I have defined database name , user, password in <code>&#47;home&#47;vagrant&#47;.pgpass </code> and it works for another setup. The .yml file does not have any info in that setup. I need to keep this new setup same to keep consistency."}], "tags": [], "owner": {"reputation": 539, "user_id": 9006638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV5us.jpg?s=128&g=1", "display_name": "Michael Arkhipov", "link": "https://stackoverflow.com/users/9006638/michael-arkhipov"}, "is_accepted": false, "score": 0, "last_activity_date": 1566418385, "last_edit_date": 1566418385, "creation_date": 1566415718, "answer_id": 57598094, "question_id": 57598024, "link": "https://stackoverflow.com/questions/57598024/rake-aborted-pgconnectionbad-fatal-database-vagrant-does-not-exist/57598094#57598094", "title": "Rake aborted PG::ConnectionBad: FATAL: database &quot;vagrant&quot; does not exist", "body": "<p>You can set up a database configuration through <code>config/database.yml</code>. If you are going to use PG for both environments (<code>development</code> and <code>test</code>), it can look like this:</p>\n\n<pre><code>default: &amp;default\n  adapter: postgresql\n  encoding: unicode\n  host: localhost\n\ndevelopment:\n  &lt;&lt;: *default\n  database: my_db\n  username: postgres\n  password: PASSWORD\n\ntest:\n  &lt;&lt;: *default\n  database: my_db_test\n  username: postgres\n  password: PASSWORD\n</code></pre>\n\n<p>Documentation: <a href=\"https://guides.rubyonrails.org/configuring.html#configuring-a-postgresql-database\" rel=\"nofollow noreferrer\">Configuring a postgresql database</a></p>\n"}], "owner": {"reputation": 73, "user_id": 9706080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2961a5af8044cbfe2e3a22984fa017de?s=128&d=identicon&r=PG&f=1", "display_name": "sandy", "link": "https://stackoverflow.com/users/9706080/sandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566418385, "creation_date": 1566415357, "last_edit_date": 1566416786, "question_id": 57598024, "link": "https://stackoverflow.com/questions/57598024/rake-aborted-pgconnectionbad-fatal-database-vagrant-does-not-exist", "title": "Rake aborted PG::ConnectionBad: FATAL: database &quot;vagrant&quot; does not exist", "body": "<p>How to run <code>rake db:migrate</code> using <code>postgres</code> user for database <code>my_db</code>. The role <code>postgres</code> and <code>my_db</code> database are created but when try to run migrate command , it throws error. Please let me know if I am missing any step.I don't want to use <code>vagrant</code> user and <code>vagrant database</code></p>\n\n<pre><code>vagrant@vagrant-ubuntu-trusty-64:/vagrant$ vagrant ssh\nvagrant@vagrant-ubuntu-trusty-64:/vagrant$ psql -h localhost -d my_db -U postgres\nmy_db=#\\q\nvagrant@vagrant-ubuntu-trusty-64:/vagrant$ rake db:migrate\nvagrant@vagrant-ubuntu-trusty-64:/vagrant$rake db:migrate\nrake aborted!\nPG::ConnectionBad: FATAL:  database \"vagrant\" does not exist\n</code></pre>\n\n<pre><code>                         List of roles\n</code></pre>\n\n<pre><code>-----------+------------------------------------------------+----------\npostgres  | Superuser, Create role, Create DB, Replication | {}\n</code></pre>\n\n<pre><code>                    List of databases\n</code></pre>\n\n<pre><code>-----------+----------+----------+-------------+-------------+---------\n my_db      | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |\n postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1566415263, "post_id": 57597799, "comment_id": 101653137, "body": "Can you give us an overview of how your data is laid out and what you are trying to do as a whole? This query can probably be simplified."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1566415392, "post_id": 57597799, "comment_id": 101653198, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5059868/sorting-by-an-arrays-elements-properties-in-ruby\">Sorting by an array&#39;s elements properties in ruby</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1566416373, "post_id": 57597799, "comment_id": 101653649, "body": "To highlight a block of code indent it four spaces or select it and click on the {} icon above the code entry box. To highlight code that is within a sentence surround it with the backtick character (`), which often is a key below the escape key."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1566419393, "post_id": 57597799, "comment_id": 101654786, "body": "@Josh please describe what you are trying to do?"}], "answers": [{"comments": [{"owner": {"reputation": 274, "user_id": 10955127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218700697293587/picture?type=large", "display_name": "Bryan", "link": "https://stackoverflow.com/users/10955127/bryan"}, "edited": false, "score": 0, "creation_date": 1566415959, "post_id": 57598090, "comment_id": 101653438, "body": "another option from @Sara&#39;s recommendation is to use <code>cakes.sort_by { |cake| cake.description }</code>"}], "tags": [], "owner": {"reputation": 274, "user_id": 10955127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218700697293587/picture?type=large", "display_name": "Bryan", "link": "https://stackoverflow.com/users/10955127/bryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1566415692, "creation_date": 1566415692, "answer_id": 57598090, "question_id": 57597799, "link": "https://stackoverflow.com/questions/57597799/sorting-select-results/57598090#57598090", "title": "Sorting select results", "body": "<p>If I were to sort the descriptions alphabetically, I could use</p>\n\n<p><code>sorted_cakes = cakes.sort { |cake_a, cake_b| cake_a.description &lt;=&gt; cake_b.description }</code></p>\n\n<p>If you wanted them in reverse alphabetical order, you can change it to <code>cake_b.description &lt;=&gt; cake_a.description</code> </p>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 188101, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/TXzrw.jpg?s=128&g=1", "display_name": "Daniel Harvey", "link": "https://stackoverflow.com/users/188101/daniel-harvey"}, "is_accepted": true, "score": 2, "last_activity_date": 1566416794, "creation_date": 1566416794, "answer_id": 57598301, "question_id": 57597799, "link": "https://stackoverflow.com/questions/57597799/sorting-select-results/57598301#57598301", "title": "Sorting select results", "body": "<p>I don't believe the code you wrote would function if you ran it in IRB. Could we have a better example of your data structure? You probably want to stay in the database for this. It's not clear where your \"category\" variable is coming from. The internal any? followed by a map won't work (map operates on an enumerable, any? returns a boolean).</p>\n\n<p>Your pluck(:id) is an N+1 and will round-trip the to the database for every cake, not including whatever self_and_descendant_ids is doing - seems like a modeling problem since you could just associate categories with cakes and be done with any notion of descendants but this all conjecture without knowing more about your data or what you're modeling.</p>\n\n<pre><code>Categories.joins(:cakes)\n          .where(cakes: { id: cake_ids })\n          .order(description: :asc)\n          .pluck(:form_descriptor, :description)\n          .map { |id, name| { id: id, name: name } }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 5201017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8641dc53cc864e4ec596d2a15578c49e?s=128&d=identicon&r=PG", "display_name": "dmrlps", "link": "https://stackoverflow.com/users/5201017/dmrlps"}, "is_accepted": false, "score": 0, "last_activity_date": 1566456140, "creation_date": 1566456140, "answer_id": 57603389, "question_id": 57597799, "link": "https://stackoverflow.com/questions/57597799/sorting-select-results/57603389#57603389", "title": "Sorting select results", "body": "<p>Why not sort it before traversing? You can do like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>cakes.select do |cake|\n  cake.categories.order('categories.description ASC').pluck(:id).any? do |ca| \n    category.self_and_descendant_ids.include? ca\n  end.map { |c| { id: c.form_descriptor, name: \"#{c.description}\" } }\nend\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 8373073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0083749204d624fbd34abba4b208b929?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8373073/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57598301, "answer_count": 3, "score": 0, "last_activity_date": 1566456140, "creation_date": 1566414166, "last_edit_date": 1566416103, "question_id": 57597799, "link": "https://stackoverflow.com/questions/57597799/sorting-select-results", "title": "Sorting select results", "body": "<p>I'm trying to sort <code>c.description</code> alphabetically but I'm not familiar with Ruby and can't seem to get <code>.sort</code> to work.</p>\n\n<pre><code>cakes.select do |cake|\n  cake.categories.pluck(:id).any? do |ca| \n    category.self_and_descendant_ids.include? ca\n  end.map { |c| { id: c.form_descriptor, name: \"#{c.description}\" } }\nend\n</code></pre>\n"}, {"tags": ["ruby", "sorbet"], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 537862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2419732d3fbaf4b86de1f2bbab2931d?s=128&d=identicon&r=PG", "display_name": "user537862", "link": "https://stackoverflow.com/users/537862/user537862"}, "is_accepted": false, "score": 1, "last_activity_date": 1566410531, "creation_date": 1566410531, "answer_id": 57597015, "question_id": 57596887, "link": "https://stackoverflow.com/questions/57596887/how-to-solve-sorbet-strong-type-checker-error-this-code-is-untyped-in-uri-enco/57597015#57597015", "title": "How to solve sorbet strong type-checker error &quot;this code is untyped&quot; in URI.encode_www_form({&quot;q&quot;: &quot;ruby&quot;})", "body": "<p>As noted in <a href=\"https://sorbet.org/docs/static\" rel=\"nofollow noreferrer\">https://sorbet.org/docs/static</a> it's currently very hard to get files to pass under <code>strict</code> level.\nIn the case of this snippet, it's because return type of <code>encode_www_form</code> isn't specified, thus it returns <code>T.untyped</code>.\nYou'll need to specify return type of this function to make it pass in <code>strict</code></p>\n"}], "owner": {"reputation": 3, "user_id": 3594931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0029b7bcbb59b11684cecdca8cc95ee3?s=128&d=identicon&r=PG&f=1", "display_name": "udnpico", "link": "https://stackoverflow.com/users/3594931/udnpico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566410531, "creation_date": 1566410001, "question_id": 57596887, "link": "https://stackoverflow.com/questions/57596887/how-to-solve-sorbet-strong-type-checker-error-this-code-is-untyped-in-uri-enco", "title": "How to solve sorbet strong type-checker error &quot;this code is untyped&quot; in URI.encode_www_form({&quot;q&quot;: &quot;ruby&quot;})", "body": "<p>How to solve sorbet strong type-checker error \"this code is untyped\" in the code below?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>query = {\"q\": \"ruby\"}\nURI.encode_www_form(query)\n</code></pre>\n\n<p>Error message </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>This code is untyped https://srb.help/7018\n    83 |    URI.encode_www_form(query)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Thank you for the answers.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1566410021, "post_id": 57596533, "comment_id": 101650945, "body": "Have you considered converting the hash to a bunch of SQL INSERTs and bypassing ActiveRecord completely? You&#39;d want to wrap the overall INSERT in a few transactions to make it go faster and you&#39;d have manually apply any <code>User</code> hooks to the data first."}, {"owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1566466143, "post_id": 57596533, "comment_id": 101668034, "body": "@muistooshort how can I put your idea to code?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1566426104, "post_id": 57596703, "comment_id": 101656894, "body": "If you&#39;re really in a bind, never underestimate the power of direct-loading into the database. MySQL&#39;s <code>LOAD DATA INFILE</code> for example is super fast."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1566409134, "creation_date": 1566409134, "answer_id": 57596703, "question_id": 57596533, "link": "https://stackoverflow.com/questions/57596533/rails-save-massive-hash-data-to-database/57596703#57596703", "title": "Rails save massive hash data to database", "body": "<p><a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html#method-i-create\" rel=\"nofollow noreferrer\"><code>ActiveRecord.create</code></a> accepts hashes too. Therefore I would just try:</p>\n\n<pre><code>User.create(users)\n</code></pre>\n\n<p>2M might be a bit too big and you might need to work in batches. But I suggest this to be faster than one insert per record.</p>\n"}, {"comments": [{"owner": {"reputation": 352, "user_id": 3849241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X7Hpj.jpg?s=128&g=1", "display_name": "Yuri Karpovich", "link": "https://stackoverflow.com/users/3849241/yuri-karpovich"}, "edited": false, "score": 1, "creation_date": 1566468197, "post_id": 57597236, "comment_id": 101669172, "body": "<code>activerecord-import</code> gem is still better solution for this!"}], "tags": [], "owner": {"reputation": 1201, "user_id": 8785865, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5b892309a47e8d4a61140a615f2b3337?s=128&d=identicon&r=PG&f=1", "display_name": "Aarthi", "link": "https://stackoverflow.com/users/8785865/aarthi"}, "is_accepted": false, "score": 1, "last_activity_date": 1566411542, "creation_date": 1566411542, "answer_id": 57597236, "question_id": 57596533, "link": "https://stackoverflow.com/questions/57596533/rails-save-massive-hash-data-to-database/57597236#57597236", "title": "Rails save massive hash data to database", "body": "<p>Try using active record import gem(<a href=\"https://github.com/zdennis/activerecord-import#hashes\" rel=\"nofollow noreferrer\">https://github.com/zdennis/activerecord-import#hashes</a>). You can even insert records with batching(<a href=\"https://github.com/zdennis/activerecord-import#batching\" rel=\"nofollow noreferrer\">https://github.com/zdennis/activerecord-import#batching</a>)</p>\n\n<pre><code>User.import(users, batch_size: 1000)\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566411542, "creation_date": 1566408352, "question_id": 57596533, "link": "https://stackoverflow.com/questions/57596533/rails-save-massive-hash-data-to-database", "title": "Rails save massive hash data to database", "body": "<p>I have a <code>Hash</code> with 2M data. I need to transfer all data from <code>hash</code> to <code>database</code>. Hash keys fit with database columns.</p>\n\n<p>I'm not sure the way I use below is the best way.</p>\n\n<pre><code># users is a hash with 2M data.\nusers.each do |u|\n   user = User.new(u)\n   user.save!\nend\n</code></pre>\n\n<p>what is the best way to iterate through this kind of massive data with Rails?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ocr", "tesseract"], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1566411397, "creation_date": 1566411397, "answer_id": 57597209, "question_id": 57595084, "link": "https://stackoverflow.com/questions/57595084/rtesseract-not-showing-the-text-of-images-in-rails/57597209#57597209", "title": "RTesseract not showing the text of images in rails", "body": "<p>If the output is just <code>\"\\f\"</code>, that means that tesseract didn't detect any words in the image.</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566411397, "creation_date": 1566401823, "question_id": 57595084, "link": "https://stackoverflow.com/questions/57595084/rtesseract-not-showing-the-text-of-images-in-rails", "title": "RTesseract not showing the text of images in rails", "body": "<p>I install <code>RTesseract</code> in my application but the issue I face is that after reading any image it just give '/f' in output</p>\n\n<pre><code> image =  RTesseract.new('ya.png', lang: 'eng')\n image.to_s\n</code></pre>\n\n<p>Output : <code>\"\\f\"</code></p>\n\n<p>How can I fix this issue?</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1566404166, "post_id": 57594933, "comment_id": 101648550, "body": "Not sure what&#39;s causing the error but ... why do you want to <code>rewind</code> the file?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1566404377, "post_id": 57594933, "comment_id": 101648656, "body": "It seems your <code>File.new</code> code is not valid ruby code"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566411551, "post_id": 57594933, "comment_id": 101651583, "body": "Your username dredges up memories of <a href=\"https://en.wikipedia.org/wiki/Turbo_Pascal\" rel=\"nofollow noreferrer\">Turbo Pascal</a>."}], "owner": {"reputation": 11, "user_id": 2191176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d14b5ee25586f0b08be08ba4d1cf9e15?s=128&d=identicon&r=PG", "display_name": "Borland", "link": "https://stackoverflow.com/users/2191176/borland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566401270, "creation_date": 1566401270, "question_id": 57594933, "link": "https://stackoverflow.com/questions/57594933/illegal-quoting-in-line-1-csvmalformedcsverror-after-rewinding-file-with-enc", "title": "Illegal quoting in line 1 (CSV::MalformedCSVError) after rewinding file with encoding in Ruby", "body": "<p>When I read data from valid CSV file with correct encoding specified and use rewind function, then reading fails (error below is produced). Same file works fine without the rewind.</p>\n\n<p>This only happens when using CSV.new() with File.new() with encoding specified. It does not happen when using CSV.read() or CSV.new() from String object or from file where encoding is not specified (needed). It seems like during CSV.rewind (which calls IO.rewind) the file encoding information gets lost.\nIs this a bug or am I doing it wrong?\nI avoided the issue by using CSV.read, but then the whole file goes to memory and I don't want that.</p>\n\n<p>test.rb:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'csv'\ncsvdata = CSV.new(\n  File.new('test.csv', 'rb:BOM|UTF-8'),\n  :col_sep =&gt; ';', \n  :quote_char =&gt; '\"',\n  :headers =&gt; true)\ncsvdata.rewind\ncsvdata.each do |r| \n  puts r.inspect\nend\n</code></pre>\n\n<p>test.csv:</p>\n\n<pre><code>\"Col 1\";\"Col 2\";\"Col 3\"\n\"ROW1\";\"\";\"\"\n\"ROW2\";\"\";\"\"\n\"ROW3\";\"\";\"\"\n</code></pre>\n\n<p>Without rewind, everything goes OK. With rewind, following error appears:</p>\n\n<pre><code>Traceback (most recent call last):\n    9: from test.rb:9:in `&lt;main&gt;'\n    8: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv.rb:1236:in `each'\n    7: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv.rb:1236:in `each'\n    6: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:303:in `parse'\n    5: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:779:in `parse_quotable_loose'\n    4: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:28:in `each_line'\n    3: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:28:in `each_line'\n    2: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:31:in `block in each_line'\n    1: from ~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:818:in `block in parse_quotable_loose'\n~/.rbenv/versions/2.6.3/lib/ruby/2.6.0/csv/parser.rb:879:in `parse_quotable_robust': Illegal quoting in line 1. (CSV::MalformedCSVError)\n</code></pre>\n\n<p>ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin18]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566401408, "post_id": 57594688, "comment_id": 101647242, "body": "Did you try to run <code>spring stop</code> before running the generator?"}, {"owner": {"reputation": 220, "user_id": 1681709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gq5zF.jpg?s=128&g=1", "display_name": "Jason Brodie", "link": "https://stackoverflow.com/users/1681709/jason-brodie"}, "edited": false, "score": 0, "creation_date": 1566402227, "post_id": 57594688, "comment_id": 101647662, "body": "Try removing and re-installing the rails gem?  Possible corruption?"}, {"owner": {"reputation": 349, "user_id": 7915241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3903b2d1221e55e6fb21f0842390cd50?s=128&d=identicon&r=PG&f=1", "display_name": "Juanse Cora", "link": "https://stackoverflow.com/users/7915241/juanse-cora"}, "edited": false, "score": 0, "creation_date": 1566555555, "post_id": 57594688, "comment_id": 101702207, "body": "So far, I made it work removing spring libraries, but this is not a solution. It seems some problem of incompatibility with Ruby 2.6"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 7915241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3903b2d1221e55e6fb21f0842390cd50?s=128&d=identicon&r=PG&f=1", "display_name": "Juanse Cora", "link": "https://stackoverflow.com/users/7915241/juanse-cora"}, "edited": false, "score": 0, "creation_date": 1566555589, "post_id": 57595222, "comment_id": 101702226, "body": "That doesn&#39;t work. It seems a matter of incompatibilities with current version of Ruby"}], "tags": [], "owner": {"reputation": 220, "user_id": 1681709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gq5zF.jpg?s=128&g=1", "display_name": "Jason Brodie", "link": "https://stackoverflow.com/users/1681709/jason-brodie"}, "is_accepted": false, "score": 0, "last_activity_date": 1566402285, "creation_date": 1566402285, "answer_id": 57595222, "question_id": 57594688, "link": "https://stackoverflow.com/questions/57594688/rails-generate-failing/57595222#57595222", "title": "Rails generate failing", "body": "<p>You could try forcing it to use the bundle by adding <code>bundle exec</code> in front of your <code>rails g ...</code> call.</p>\n"}], "owner": {"reputation": 349, "user_id": 7915241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3903b2d1221e55e6fb21f0842390cd50?s=128&d=identicon&r=PG&f=1", "display_name": "Juanse Cora", "link": "https://stackoverflow.com/users/7915241/juanse-cora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566402285, "creation_date": 1566400495, "question_id": 57594688, "link": "https://stackoverflow.com/questions/57594688/rails-generate-failing", "title": "Rails generate failing", "body": "<p>After a while, I was in the way to implement a new functionality in my app. When I try to generate an scaffold or access the console, this is what I get back:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0QZzG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0QZzG.png\" alt=\"rails\"></a></p>\n\n<p>I have tried to stop spring, to update the bundle.. but nothing. What am I missing here?</p>\n"}, {"tags": ["ios", "ruby-on-rails", "ruby", "fastlane", "macos-catalina"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1566397452, "post_id": 57593746, "comment_id": 101645214, "body": "Your link to the docs is <code>http:&#47;&#47;sudo%20gem%20install%20-n%20&#47;usr&#47;local&#47;bin%20fastlane&zwnj;&#8203;%20--verbose</code>"}, {"owner": {"reputation": 3773, "user_id": 1364053, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/KACnF.png?s=128&g=1", "display_name": "nr5", "link": "https://stackoverflow.com/users/1364053/nr5"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1566439743, "post_id": 57593746, "comment_id": 101659352, "body": "corrected the link"}], "answers": [{"comments": [{"owner": {"reputation": 1289, "user_id": 535749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0e6a4aa881fe94a00b1c00fd29bb8f?s=128&d=identicon&r=PG", "display_name": "Oleg Shanyuk", "link": "https://stackoverflow.com/users/535749/oleg-shanyuk"}, "edited": false, "score": 1, "creation_date": 1570103005, "post_id": 57595630, "comment_id": 102812671, "body": "Please don&#39;t! It&#39;s too much for a scripting tool. Problem is in the dependency graph. And now it&#39;s becoming way more obvious \u2013 security is a thing for developers too."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1570121985, "post_id": 57595630, "comment_id": 102822765, "body": "This permits the executable that otherwise cannot be run on Catalina. It is immediately re-enabled. There&#39;s absolutely no issue here."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1566403966, "creation_date": 1566403966, "answer_id": 57595630, "question_id": 57593746, "link": "https://stackoverflow.com/questions/57593746/cant-install-fastlane-on-mac-os-catalina/57595630#57595630", "title": "Can&#39;t install fastlane on Mac OS Catalina", "body": "<p>Run this to disable Gatekeeper:</p>\n\n<pre><code>sudo spctl --master-disable\n</code></pre>\n\n<p>Then install and run fastlane. When done, run this to re-enable Gatekeeper:</p>\n\n<pre><code>sudo spctl --master-enable\n</code></pre>\n\n<p>It will remember that you have permitted the application after re-enabling Gatekeeper and you will not have to run these commands every time you use it.</p>\n"}, {"comments": [{"owner": {"reputation": 1289, "user_id": 535749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0e6a4aa881fe94a00b1c00fd29bb8f?s=128&d=identicon&r=PG", "display_name": "Oleg Shanyuk", "link": "https://stackoverflow.com/users/535749/oleg-shanyuk"}, "edited": false, "score": 0, "creation_date": 1570103106, "post_id": 57606549, "comment_id": 102812727, "body": "<code>sudo gem install fastlane -NV</code> \u2013 this is how you can break your system!"}, {"owner": {"reputation": 1289, "user_id": 535749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0e6a4aa881fe94a00b1c00fd29bb8f?s=128&d=identicon&r=PG", "display_name": "Oleg Shanyuk", "link": "https://stackoverflow.com/users/535749/oleg-shanyuk"}, "edited": false, "score": 3, "creation_date": 1570103137, "post_id": 57606549, "comment_id": 102812747, "body": "please do thing that way: <code>gem install  --user-install fastlane -NV</code> - as this way you will avoid writing shared gems, avoid granting any gem to access system with a root privilege."}, {"owner": {"reputation": 656, "user_id": 2554203, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100002828978495/picture?type=large", "display_name": "JeremyF", "link": "https://stackoverflow.com/users/2554203/jeremyf"}, "reply_to_user": {"reputation": 1289, "user_id": 535749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0e6a4aa881fe94a00b1c00fd29bb8f?s=128&d=identicon&r=PG", "display_name": "Oleg Shanyuk", "link": "https://stackoverflow.com/users/535749/oleg-shanyuk"}, "edited": false, "score": 0, "creation_date": 1606341161, "post_id": 57606549, "comment_id": 114939041, "body": "@OlegShanyuk seems to have worked with sudo. Thanks."}, {"owner": {"reputation": 1289, "user_id": 535749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0e6a4aa881fe94a00b1c00fd29bb8f?s=128&d=identicon&r=PG", "display_name": "Oleg Shanyuk", "link": "https://stackoverflow.com/users/535749/oleg-shanyuk"}, "reply_to_user": {"reputation": 656, "user_id": 2554203, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100002828978495/picture?type=large", "display_name": "JeremyF", "link": "https://stackoverflow.com/users/2554203/jeremyf"}, "edited": false, "score": 0, "creation_date": 1606392856, "post_id": 57606549, "comment_id": 114953600, "body": "@JeremyF &#175;_(\u30c4)_/&#175; well, it should work with sudo indeed, just saying: mastering to use gems without sudo is a nice skill, and safe way for your system"}], "tags": [], "owner": {"reputation": 3773, "user_id": 1364053, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/KACnF.png?s=128&g=1", "display_name": "nr5", "link": "https://stackoverflow.com/users/1364053/nr5"}, "is_accepted": false, "score": 2, "last_activity_date": 1566467257, "creation_date": 1566467257, "answer_id": 57606549, "question_id": 57593746, "link": "https://stackoverflow.com/questions/57593746/cant-install-fastlane-on-mac-os-catalina/57606549#57606549", "title": "Can&#39;t install fastlane on Mac OS Catalina", "body": "<p>Since the error says we have to instal ruby as a separate package for development, I had to install <code>rbenv</code> as shown on <a href=\"https://gorails.com/setup/osx/10.14-mojave\" rel=\"nofollow noreferrer\">ROR's</a> website. You can check the full problem and solution <a href=\"https://snippetsource.wordpress.com/2019/08/22/fastlane-installation-cant-find-header-files-for-ruby/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 3773, "user_id": 1364053, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/KACnF.png?s=128&g=1", "display_name": "nr5", "link": "https://stackoverflow.com/users/1364053/nr5"}, "edited": false, "score": 0, "creation_date": 1566984563, "post_id": 57688107, "comment_id": 101823105, "body": "See my answer. I am running Catalina beta and fastlane successfully."}], "tags": [], "owner": {"reputation": 49, "user_id": 11988034, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA7FSczvcIQugxqfOCB3oDhxH9uH5hAnZeQyoStUg=k-s128", "display_name": "Clayton Kim", "link": "https://stackoverflow.com/users/11988034/clayton-kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1566981087, "creation_date": 1566981087, "answer_id": 57688107, "question_id": 57593746, "link": "https://stackoverflow.com/questions/57593746/cant-install-fastlane-on-mac-os-catalina/57688107#57688107", "title": "Can&#39;t install fastlane on Mac OS Catalina", "body": "<p>According to <a href=\"https://github.com/fastlane/fastlane/issues/15183\" rel=\"nofollow noreferrer\">https://github.com/fastlane/fastlane/issues/15183</a> \nThis is a common issue which nobody can solve it.</p>\n"}, {"tags": [], "owner": {"reputation": 1452, "user_id": 6133329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5VAQ6Bzgjy8/AAAAAAAAAAI/AAAAAAAAC5s/c80SLwIjoG0/photo.jpg?sz=128", "display_name": "Sultanmyrza Kasymbekov", "link": "https://stackoverflow.com/users/6133329/sultanmyrza-kasymbekov"}, "is_accepted": false, "score": 0, "last_activity_date": 1611316963, "creation_date": 1611316963, "answer_id": 65844814, "question_id": 57593746, "link": "https://stackoverflow.com/questions/57593746/cant-install-fastlane-on-mac-os-catalina/65844814#65844814", "title": "Can&#39;t install fastlane on Mac OS Catalina", "body": "<p>In case you can't update fastlane version\ntry</p>\n<p><code>sudo gem install -n /usr/local/bin fastlane</code></p>\n"}], "owner": {"reputation": 3773, "user_id": 1364053, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/KACnF.png?s=128&g=1", "display_name": "nr5", "link": "https://stackoverflow.com/users/1364053/nr5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4944, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1611316963, "creation_date": 1566397032, "last_edit_date": 1571305322, "question_id": 57593746, "link": "https://stackoverflow.com/questions/57593746/cant-install-fastlane-on-mac-os-catalina", "title": "Can&#39;t install fastlane on Mac OS Catalina", "body": "<p>As per the steps given in fastlane <a href=\"https://docs.fastlane.tools/getting-started/ios/setup/\" rel=\"nofollow noreferrer\">docs</a>, I am not able to install fastlane. </p>\n\n<p>After running <code>brew cask install fastlane</code>, I get this pop up:\n<a href=\"https://i.stack.imgur.com/aCWHs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aCWHs.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I try to run from gem with <code>sudo gem install fastlane</code>, I get this error:\n<a href=\"https://i.stack.imgur.com/H0jeF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H0jeF.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I see is the ruby.h file is missing from the directory. As it says in the error, I need to install the ruby-dev environment separately. But I could not find how to do that. I saw <code>apt-get</code> commands for this, but then what about the ruby installed via brew?</p>\n\n<p>ruby -v: ruby 2.6.3p62<br>\nbrew -v: Homebrew 2.1.10<br>\nbrew upgrade ruby: ruby 2.6.3 already installed  </p>\n"}, {"tags": ["ruby", "docker"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1566397155, "post_id": 57593402, "comment_id": 101645026, "body": "Does adding a <code>docker run -i</code> option help?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1566399958, "post_id": 57593402, "comment_id": 101646416, "body": "what you posted in Gemfile is <code>rspec</code> not <code>pry</code>"}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1566400949, "post_id": 57593402, "comment_id": 101646984, "body": "Fixed it, a copy paste small mistake"}], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": false, "score": 1, "last_activity_date": 1566400545, "creation_date": 1566400545, "answer_id": 57594706, "question_id": 57593402, "link": "https://stackoverflow.com/questions/57593402/pry-not-working-on-docker-container-with-pure-ruby-application-no-rails/57594706#57594706", "title": "Pry not working on Docker container with pure Ruby application (No Rails)", "body": "<p>I needed to add <code>-it</code> to the docker command in order for it to work.</p>\n\n<pre><code>docker run --rm -v $(pwd):/var/task -e -it TENANCY=\"local\" -e SUBMISSION_ID=\"{{submission_id}}\" -t online-apps:latest bash scripts/webhook/formstack_webhook.sh\n</code></pre>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566400545, "creation_date": 1566395892, "last_edit_date": 1566400397, "question_id": 57593402, "link": "https://stackoverflow.com/questions/57593402/pry-not-working-on-docker-container-with-pure-ruby-application-no-rails", "title": "Pry not working on Docker container with pure Ruby application (No Rails)", "body": "<p>Currently I'm working on a pure Ruby application no Rails. When I try to use <code>pry</code> with Docker it gets stuck. I have success to get pry to work in Rails but not in a pure ruby application. When <code>binding.pry</code> is hit, I then go and run <code>docker attach 1f8bc4aa4ac6</code> to attach to the container but still nothing is run. </p>\n\n<pre><code>[1] pry(LambdaFunctions::WebhookHandler)&gt; form_fields\n</code></pre>\n\n<p>The dependencies are in the Gemfile, so I don't think I have to get a <code>pry</code> image, or do I? Here is my Dockerfile:</p>\n\n<pre><code># Start with AWS lambda ruby environment\nFROM lambci/lambda:build-ruby2.5\n\nWORKDIR /var/task\n\n# Install MySQL\nRUN yum -y install mysql-devel\n</code></pre>\n\n<p>This is <code>pry</code> version I'm using in my Gemfile:</p>\n\n<pre><code>      gem 'pry', '~&gt; 0.12.2'\n</code></pre>\n\n<p>This is the command I'm using for running the container:</p>\n\n<pre><code> docker run --rm -v $(pwd):/var/task -e TENANCY=\"local\" -e SUBMISSION_ID=\"{{submission_id}}\" -t online-apps:latest bash scripts/webhook/formstack_webhook.sh\n</code></pre>\n"}, {"tags": ["json", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1566394870, "post_id": 57592823, "comment_id": 101643453, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What JSON input used to work, and is now failing? Where is your code? (Just <code>JSON.parse</code>, or something more?) As it stands, I have no idea how to reproduce your problem - and therefore no idea how to answer the question."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1566394973, "post_id": 57592823, "comment_id": 101643524, "body": "I <b>suspect</b> (!!) that the problem has got nothing to do with the <code>json</code> gem. It&#39;s far more likely, I think, that the behaviour of the thing which generates JSON has changed... For example, maybe you&#39;re calling an API that&#39;s stopped working as expected."}, {"owner": {"reputation": 11, "user_id": 11957345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145137df9a75cff0f3fc3ca232f77933?s=128&d=identicon&r=PG&f=1", "display_name": "Rubyst123321", "link": "https://stackoverflow.com/users/11957345/rubyst123321"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1566395780, "post_id": 57592823, "comment_id": 101644101, "body": "@TomLord Thank you for your comment.  This is an example that is failing:  <code>JSON.parse(&quot;null&quot;)</code>  Also:   JSON.parse(&#39;&#39;&quot;)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1566399338, "post_id": 57592823, "comment_id": 101646064, "body": "Your original question included unicode characters (\\u201C) and (\\u201D) which would be unparsable by JSON. Please feel free to revoke my edit but this is what caused the error on the second example and the first example has no content so I am not sure what you expected the result to be but an empty string has always resulted in <code>unexpected token at &#39;&#39;</code> I cannot even recreate the error you provided in any version"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566467552, "post_id": 57592823, "comment_id": 101668796, "body": "Your first example is not legal JSON, so <i>of course</i> it is rejected by the JSON parser. The JSON parser only parses JSON, your first example is not JSON, ergo, the JSON parser doesn&#39;t parse it."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1566573973, "post_id": 57592823, "comment_id": 101711843, "body": "What command(s) did you use to update your projects? <code>JSON.parse(&#39;&#39;)</code> appears to fail in both 1.8.6 &amp; 2.1.0. parsing <code>null</code> fails in 1.8.6, but passes in 2.1.0, so I&#39;m in agreement with @TomLord that it&#39;s likely something else that got upgraded if you used <code>bundle update</code>, for example"}], "owner": {"reputation": 11, "user_id": 11957345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145137df9a75cff0f3fc3ca232f77933?s=128&d=identicon&r=PG&f=1", "display_name": "Rubyst123321", "link": "https://stackoverflow.com/users/11957345/rubyst123321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566398809, "creation_date": 1566394171, "last_edit_date": 1566398809, "question_id": 57592823, "link": "https://stackoverflow.com/questions/57592823/upgrade-ruby-2-4-2-to-2-6-3-causing-errors-with-json", "title": "Upgrade Ruby 2.4.2 to 2.6.3 causing errors with JSON", "body": "<p>I am new and searched a lot but I couldn\u2019t find an answer to my problem.</p>\n\n<p>When I upgraded my ruby projects version from <code>2.4.2</code> to <code>2.6.3</code>, my JSON gem by default upgraded from <code>1.8.6</code> to <code>2.1.0</code>.</p>\n\n<p>This following codes caused errors:</p>\n\n<pre><code>JSON.parse(\"\")\n</code></pre>\n\n<blockquote>\n  <p>JSON::ParserError:A JSON text must at least contain two octets!</p>\n</blockquote>\n\n<p>and</p>\n\n<pre><code>JSON.parse(\"null\")\n</code></pre>\n\n<blockquote>\n  <p>JSON::ParserError: 784: unexpected token at 'null\u2019</p>\n</blockquote>\n\n<p>How can I turn off/change the automatically upgrade of JSON gem or solve the above errors.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "activeadmin"], "comments": [{"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 1, "creation_date": 1566390633, "post_id": 57591014, "comment_id": 101640610, "body": "Did you take a look at Single table inheritance? It might be something that you might find useful."}, {"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "reply_to_user": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1566392484, "post_id": 57591014, "comment_id": 101641854, "body": "Thanks; I can see how that would let me store variants of &#39;user&#39; but I&#39;m not sure how it would help me manage the relationship between the different types."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1566395177, "post_id": 57592347, "comment_id": 101643670, "body": "Thanks. I&#39;ll test this in my code later and get back to you."}, {"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1566398186, "post_id": 57592347, "comment_id": 101645426, "body": "Just for clarity. Please can you explain what the two lines <code>belongs_to :support_worker, :foreign_key =&gt; :support_worker_id, :class_name =&gt; User belongs_to :service_user, :foreign_key =&gt; :service_user_id, :class_name =&gt; User</code> do?"}, {"owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1566406713, "post_id": 57592347, "comment_id": 101649670, "body": "OK. I&#39;ve tried your code. The migrations work and I can import seed data. However, when I try and use ActiveAdmin I can&#39;t traverse the associations back to the user table to retrieve attributes from there. For example, this code tells me that &#39;user&#39; is an undefined method: <code>column &#39;Service user&#39;, :full_name, :sortable =&gt; users.family_name do |support_allocation|       support_allocation.user.full_name     end</code>  I&#39;m also unclear how ActiveAdmin will know which user_id (service_user_id or support_worker_id) to do the join over."}, {"owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "reply_to_user": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "edited": false, "score": 0, "creation_date": 1566481640, "post_id": 57592347, "comment_id": 101676916, "body": "It is ActiveRecord that knows how to do the join, and that is why it is declared in the <code>belongs_to</code> association method in the <code>User</code> model. I updated the answer so you can get the index view of <code>SupportAllocations</code> to work."}], "tags": [], "owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "is_accepted": true, "score": 1, "last_activity_date": 1566481533, "last_edit_date": 1566481533, "creation_date": 1566392703, "answer_id": 57592347, "question_id": 57591014, "link": "https://stackoverflow.com/questions/57591014/how-to-map-one-user-to-another-from-same-table/57592347#57592347", "title": "How to map one user to another (from same table)", "body": "<p>I don't think you need the <code>AddJoins</code> migration. Add 2 associations in your <code>CreateSupportAllocations</code> model like so:</p>\n\n<pre><code>belongs_to :support_worker, :foreign_key =&gt; :support_worker_id, :class_name =&gt; User\nbelongs_to :service_user, :foreign_key =&gt; :service_user_id, :class_name =&gt; User\n</code></pre>\n\n<p>In your activeadmin form you can set the collections for the select, for example</p>\n\n<p>(in app/admin/support_allocations.rb)</p>\n\n<pre><code>form do |f|\n  f.inputs do \n    # your inputs\n    f.input :support_worker, :as =&gt; :select, :collection =&gt; User.where(:user_type =&gt; 'support_worker')\n    f.input :service_user, :as =&gt; :select, :collection =&gt; User.where(:user_type =&gt; 'service_user')\n\n  end\n  f.actions \nend\n\n# added after comments\nindex do\n  selectable_column\n  column :support_worker\n  actions \nend\n</code></pre>\n\n<p>Add a to_s method in you user model like so:</p>\n\n<pre><code>def to_s\n  \"#{self.full_name}\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1566551857, "creation_date": 1566551857, "answer_id": 57623231, "question_id": 57591014, "link": "https://stackoverflow.com/questions/57591014/how-to-map-one-user-to-another-from-same-table/57623231#57623231", "title": "How to map one user to another (from same table)", "body": "<p>Thanks for all your help. I added the suggested associations to my SupportAllocation model. For the record, I also had to add the following associations to my User model to make the join work fully, in both directions:</p>\n\n<pre><code>  has_many :occurances_as_support_worker, :class_name =&gt; 'SupportAllocation', :foreign_key =&gt; 'support_worker_id'\n  has_many :occurances_as_service_user, :class_name =&gt; 'SupportAllocation', :foreign_key =&gt; 'service_user_id'\n</code></pre>\n\n<p>I used the example <a href=\"http://%20%20#%20http://www.emreakkas.com/ruby-on-rails/rails-multiple-columns-to-the-same-tables-key\" rel=\"nofollow noreferrer\">given here</a> to work this out.</p>\n\n<p>When accessing attributes specific to a type of user (i.e. using the join over support_worker_id OR service_user_id), on the index page. I use code like this:</p>\n\n<pre><code> column 'Service user', :full_name, :sortable =&gt; 'service_users.family_name' do |support_allocation|\n      #ServiceUser.find(support_allocation.service_user_id).full_name\n      support_allocation.service_user.full_name\n    end\n\n      column 'Support worker', :full_name, :sortable =&gt; 'support_workers.family_name' do |support_allocation|\n        support_allocation.support_worker.full_name\n      end\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 11581296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcb42096f543aa1ba87060e8ad0cc60?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Kenworthy", "link": "https://stackoverflow.com/users/11581296/chris-kenworthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57592347, "answer_count": 2, "score": 0, "last_activity_date": 1566551857, "creation_date": 1566388325, "last_edit_date": 1566392211, "question_id": 57591014, "link": "https://stackoverflow.com/questions/57591014/how-to-map-one-user-to-another-from-same-table", "title": "How to map one user to another (from same table)", "body": "<p>I'd like to know how to solve this problem in my model/migrations, with correct referential integrity/uniqueness constraints.</p>\n\n<p>I have a user table with two types of user: support_worker and service_user (like teacher and pupil). A support_worker can provide support for many service_users. I used to have separate tables for these respective user types, but for simplicity it makes more sense to have both user types in a single 'user' table (for Devise). </p>\n\n<p>I'll have another table called support_allocation which records the relationship between a support_worker and the service_user(s) they support - this support_allocation has other information stored about it (like a budget; time/money). So this table needs to map one user_id to another user_id. I imagine the table structure will look something like this: SupportAllocation (id, support_worker_id, service_user_id)</p>\n\n<p>So far, my migrations look like this (I've used Devise gem to create the user table so this amends it):</p>\n\n<pre><code>class ChangeUsers &lt; ActiveRecord::Migration[5.2]\n  def change\n    change_table :users do |t|\n      t.string :user_type # support_worker or service_user\n\n      t.string :given_name\n      t.string :family_name\n\n      t.string :customer_reference # only for service_users\n      t.date :date_of_birth # only for service_users\n\n      t.string :job_roles # only for support_workers\n  end\nend\n\nclass CreateSupportAllocations &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :support_allocations do |t|\n      t.boolean :active, default: true\n\n      # This next bit is guesswork\n      t.integer support_worker_id # support_worker's user_id\n      t.integer service_user_id # service_user's user_id \n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Here's where I get confused... I need to create a join, but this will only do it on user_id, whereas the relationship is defined by the two user_id columns (as shown and named above). I'm not sure if this a compound key or if a single foreign key (or two) will suffice. </p>\n\n<p>Here's my migration work-in-progress:</p>\n\n<pre><code>class AddJoins &lt; ActiveRecord::Migration[5.2]\n  def change\n    change_table :support_allocations do |t|\n      t.belongs_to :user, index: true\n    end\n  end\nend\n</code></pre>\n\n<p>I'd like to know how to achieve this. For the record, I'm using ActiveAdmin for my app. Thank you for your help.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "api", "response"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1566386594, "post_id": 57590461, "comment_id": 101638359, "body": "\u201cWhat can I do to get same response in json\u201d\u2014you can write the code that will produce json."}, {"owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566387047, "post_id": 57590461, "comment_id": 101638574, "body": "i have tryed most of the case but i can not get same output like this @AlekseiMatiushkin"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1566387891, "post_id": 57590461, "comment_id": 101639021, "body": "Can you show how <code>@hours</code> looks? Is it the same structure? Is the question how to get from hash to json, or to correctly map your data to the required format/order/nesting in the json? In which case we definitely need to see how the data looks to help you with that transformation."}, {"owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 1, "creation_date": 1566389938, "post_id": 57590461, "comment_id": 101640162, "body": "please read que again @nathanvda"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1566390913, "post_id": 57590461, "comment_id": 101640792, "body": "Thanks for the update, your question is much clearer now. Wow: the requested format is sooooo wierd. I am presuming the numbers indicating the position in the array are a kind of comments, not requested, right? Because otherwise it would not make sense, afaik an array in json cannot have an index/position?"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1566391037, "post_id": 57590461, "comment_id": 101640875, "body": "In the wanted structure &quot;hour_type_id&quot; and &quot;hours&quot; are combined, and in your original you just list all &quot;hour-types&quot; and &quot;hours&quot;: what is the relation/reasoning to combine them? Does an hour belong to an hour_type?"}, {"owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1566392478, "post_id": 57590461, "comment_id": 101641850, "body": "relation like this: User has many Hours, hour has many hour_type @nathanvda"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1566404894, "post_id": 57590461, "comment_id": 101648908, "body": "More of a pattern recommendation, but for complex and non-standard payloads you should look into using serializers like <a href=\"https://github.com/Netflix/fast_jsonapi\" rel=\"nofollow noreferrer\">github.com/Netflix/fast_jsonapi</a>. It&#39;ll give you a nice arena for formatting your json, separate from the rest of your controller logic."}], "answers": [{"comments": [{"owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "edited": false, "score": 0, "creation_date": 1566392408, "post_id": 57591916, "comment_id": 101641804, "body": "I tried this but its show me syntex error in this line users: @users.map{|u| user_id: u.id},"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "reply_to_user": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "edited": false, "score": 0, "creation_date": 1566394709, "post_id": 57591916, "comment_id": 101643349, "body": "Right, this is of course untested code. Doh. We should make it more explicit we are creating/returning a hash. It should now work? (I changed/fixed it in two places). Does it work now?"}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": true, "score": 1, "last_activity_date": 1566394656, "last_edit_date": 1566394656, "creation_date": 1566391399, "answer_id": 57591916, "question_id": 57590461, "link": "https://stackoverflow.com/questions/57590461/render-custom-json-array-in-rails/57591916#57591916", "title": "render custom json array in rails", "body": "<p>This is a pretty naive way to render it, but this should get you started:</p>\n\n<pre><code>@hours = Hour.all\n@users = User.where(id: @hours.map(&amp;:user_id).uniq)\n@hour_types = HourType.where(id: @hours.map(&amp;:hour_type_id).uniq)\n\nresult = {\n  users: @users.map{|u| {user_id: u.id} },\n  hours: [] \n} \n\n@hour_types.each do |hour_type| \n  hour_type_hash = { \n    hour_type_id: hour_type.id, \n    hours: Hour.where(hour_type_id: hour_type.id).all.map{|h| {hour_id: h.id} } \n  }\n  result[:hours] &lt;&lt; hour_type_hash  \nend \n\nrender json: result_hash \n</code></pre>\n"}], "owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "closed_date": 1566424896, "accepted_answer_id": 57591916, "answer_count": 1, "score": -2, "last_activity_date": 1566394656, "creation_date": 1566386332, "last_edit_date": 1566393016, "question_id": 57590461, "link": "https://stackoverflow.com/questions/57590461/render-custom-json-array-in-rails", "closed_reason": "Not suitable for this site", "title": "render custom json array in rails", "body": "<p>Here I have array of Hours in @hours now with relation of user and hour_type.</p>\n\n<p>Hours_controller.rb</p>\n\n<pre><code>def index\n  @houra = Hour.all\n  @users = User.where(id: @hours.map(&amp;:user_id).uniq)\n  @hour_type = HourType.where(id: @hours.map(&amp;:hour_type_id).uniq)\n  render json: {\n    users: [@users],\n    hour_type: [@hour_type],\n    hours: @hours\n  }\nend\n</code></pre>\n\n<p>this above code is give me response like below.</p>\n\n<pre><code>{\n  \"users\": [\n    \"id\": 6\n  ],\n  \"hour_type\": [\n    \"id\": 69\n  ],\n  \"hours\": [\n    {\n      \"id\": 1,\n    },\n    {\n      \"id\": 12\n    },\n    {\n      \"id\": 2,\n    }\n  ]\n}\n</code></pre>\n\n<p>But Now I want a response in json like below.</p>\n\n<pre><code>{\n  \"users\":[\n    0:{\n      user_id:2\n    },\n    1:{\n      user_id:3\n    },\n  ],\n\"hours\":[\n0:[\n  {\n    hour_type_id:\"1\"\n    hours: [\n      {\n        hour_id: 1\n      },\n\n        hour_id: 2\n      },\n    ]\n  },\n1:[\n  {\n    hour_type_id:\"1\"\n    hours: [\n      {\n        hour_id: 1\n      },\n      {\n        hour_id: 2\n      },\n    ]\n  }\n}\n</code></pre>\n\n<p>What can I do to get same response in json?</p>\n\n<p>Here I am adding some what near to result i got </p>\n\n<pre><code>  @hours = Hour.all\n  @users = User.where(id: @hours.map(&amp;:user_id).uniq)\n  @hour_types = HourType.where(id: @hours.map(&amp;:hour_type_id).uniq)\n\n  result = {\n    users: @users,\n    hours: []\n  }\n\n  @hour_types.each do |hour_type|\n    hour_type_hash = {\n      hour_type: hour_type,\n      hours: Hour.where(hour_type_id: hour_type.id).all\n    }\n    result[:hours] &lt;&lt; hour_type_hash\n  end\n</code></pre>\n\n<p>render json: result</p>\n\n<p>Now just want to add id before user</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "csrf", "doorkeeper"], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1566393865, "creation_date": 1566393865, "answer_id": 57592729, "question_id": 57590229, "link": "https://stackoverflow.com/questions/57590229/csrf-protection-with-doorkeeper-authorization-rails/57592729#57592729", "title": "CSRF Protection with doorkeeper authorization rails", "body": "<p>It's good to have CSRF attack protection in your app. In api you can add this token to header and pass it between frontend and backend. I used this guide from pragmatic studio to set it up in my application:</p>\n\n<p><a href=\"https://pragmaticstudio.com/tutorials/rails-session-cookies-for-api-authentication\" rel=\"nofollow noreferrer\">https://pragmaticstudio.com/tutorials/rails-session-cookies-for-api-authentication</a></p>\n\n<p>However, I have no idea how will it work with doorkeeper (haven't used it).</p>\n"}], "owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 57592729, "answer_count": 1, "score": -1, "last_activity_date": 1566393865, "creation_date": 1566385562, "question_id": 57590229, "link": "https://stackoverflow.com/questions/57590229/csrf-protection-with-doorkeeper-authorization-rails", "title": "CSRF Protection with doorkeeper authorization rails", "body": "<p>I have a question which i can't seem to figure out from all the googling. I am building a rails app basically an api app. When i give out post request it returns me with an error 'InvalidAuthenticityToken' so i used </p>\n\n<pre><code>  skip_before_action :verify_authenticity_token\n</code></pre>\n\n<p>And after some googling i came to know that it is not recommended to skip this because our app will be vulnerable to CSRF attacks. I am also using doorkeeper gem for my authentication. My question is that even if i have the doorkeeper gem for authentication will my app be still vulnerable to attacks ?</p>\n\n<p>I have also placed this code in my application controller and removed the above code</p>\n\n<pre><code>  protect_from_forgery with: :null_session\n</code></pre>\n\n<p>Is this safe or can someone say how to properly implement this ?</p>\n"}, {"tags": ["ruby", "apple-push-notifications"], "answers": [{"tags": [], "owner": {"reputation": 799, "user_id": 1986018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7vBpa.jpg?s=128&g=1", "display_name": "yosei", "link": "https://stackoverflow.com/users/1986018/yosei"}, "is_accepted": false, "score": 0, "last_activity_date": 1566446941, "last_edit_date": 1566446941, "creation_date": 1566445243, "answer_id": 57601764, "question_id": 57590096, "link": "https://stackoverflow.com/questions/57590096/how-to-send-apple-push-notifications-by-using-apnotic-gem/57601764#57601764", "title": "How to send Apple Push Notifications by using apnotic gem?", "body": "<p>The problem was my virtual machine's clock. After adjusting the clock(by installing <code>ntp</code>), it worked.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ sudo apt install ntp\n$ sudo service ntp status\n\u25cf ntp.service - Network Time Service\n   Loaded: loaded (/lib/systemd/system/ntp.service; enabled; vendor preset: enab\n   Active: active (running) since Sat 2019-08-17 05:46:06 UTC; 7s ago\n   :\n$ ruby push.rb \n200\n{\":status\"=&gt;\"200\", \"apns-id\"=&gt;\"......\"}\n</code></pre>\n"}], "owner": {"reputation": 799, "user_id": 1986018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7vBpa.jpg?s=128&g=1", "display_name": "yosei", "link": "https://stackoverflow.com/users/1986018/yosei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1566446941, "creation_date": 1566385084, "question_id": 57590096, "link": "https://stackoverflow.com/questions/57590096/how-to-send-apple-push-notifications-by-using-apnotic-gem", "title": "How to send Apple Push Notifications by using apnotic gem?", "body": "<p>I am trying to send Apple's push notification by following the instruction of <code>apnotic</code> gem.</p>\n\n<p><a href=\"https://github.com/ostinelli/apnotic\" rel=\"nofollow noreferrer\">https://github.com/ostinelli/apnotic</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'apnotic'\n\nconnection = Apnotic::Connection.development(\n  auth_method: :token,\n  cert_path: \"AuthKey_foobar.p8\",\n  key_id: \"foobar\",\n  team_id: \"abcd1234\"\n)\n\n# create a notification for a specific device token\ntoken = 'abcdef123456..'\n\nnotification       = Apnotic::Notification.new(token)\nnotification.topic = \"bundle_id\"\nnotification.alert = \"Notification from Apnotic!\"\n\n# send notifications and get results\nresponse = connection.push(notification)\n\nputs response.status\nputs response.body\n\nconnection.close\n</code></pre>\n\n<p>However, I got the response.</p>\n\n<pre><code>403\n{\"reason\"=&gt;\"ExpiredProviderToken\"}\n</code></pre>\n\n<p>I don't think the token is actually expired because I can send notifications by using the app and same IDs and tokens.</p>\n\n<p><a href=\"https://github.com/onmyway133/PushNotifications\" rel=\"nofollow noreferrer\">https://github.com/onmyway133/PushNotifications</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1566384734, "post_id": 57589960, "comment_id": 101637336, "body": "<code>@counter = @counter.to_i + 1</code>?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566384844, "post_id": 57589960, "comment_id": 101637390, "body": "Nice, but also requires <code>@counter</code> to be mentioned twice. Imagine that instead of having a simple variable, we want to deal with <code>@counter_array[my_function(i,j,k)]</code> to be incremented in this way."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1566384902, "post_id": 57589960, "comment_id": 101637426, "body": "@user1934428: And it\u2019s an array, not a hash?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1566385020, "post_id": 57589960, "comment_id": 101637476, "body": "If it is a <code>Hash</code>, you might have <code>default_proc</code>. If it\u2019s an instance variable, you might initialize it to zero in the constructor."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566385624, "post_id": 57589960, "comment_id": 101637797, "body": "If the index is a calculation, factor it out: <code>my_function(i, j, k).then { |index| @counter_array[index] ||= 0; @counter_array[index] += 1 }</code> (or equivalently <code>index = my_function(i, j, k); @counter_array[index] ||= 0; @counter_array[index] += 1</code>)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566385992, "post_id": 57589960, "comment_id": 101638005, "body": "If you know the size of the array, you can pre-fill it with zeroes. E.g. if you know the index will never reach 20, <code>@counter_array = Array.new(20, 0)</code>, and then you don&#39;t need the check any more."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566388429, "post_id": 57589960, "comment_id": 101639330, "body": "@Amadan : If I know the size, it is possible. If I don&#39;t know, or if it is not an array, but a Hash, it is not. Or if it is just a simple variable, as stated in my posting. It is obvious that we can solve this depending on the circumstance in various ways, but these does not relate to the original problem.  I was looking for something similar in spirit as in <code>C</code> or <code>C++</code>, where you can write something like <code>(foo[bar()] ||= m) += n</code>, because assignments return lvalues. I just wondered whether there is some trick in the realm of Ruby, which would have a comparable effect."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1566388514, "post_id": 57589960, "comment_id": 101639368, "body": "If it&#39;s a hash, then as Aleksei said, <code>Hash.new(0)</code> and it all just works. But yes, there is no way to get lvalue in Ruby as a result of an expression."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1566388818, "post_id": 57589960, "comment_id": 101639542, "body": "I think the basic problem is, that the class <code>Integer</code> does not have any methods, which actually <i>change</i> the value represented by an instance. You can even not monkeypatch the class to define a method <code>incr!</code>, which would modify the receiver by incrementing it. With this restrictions, it seems to be impossible to achieve what I am looking for."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566388973, "post_id": 57589960, "comment_id": 101639611, "body": "@Amadan : With a Hash, it would work only if you want to have <b>all</b> new values to spring out with value 0, which is not what I want to achieve. Incidentally, in my concrete case which triggered the posting, the value happens to be an element in a Hash, and since many of the elements in the Hash are not Integer-valued, it does not make sense to have 0 as a default initializer...."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1566403207, "post_id": 57589960, "comment_id": 101648135, "body": "@user1934428 while your statement about <code>Integer</code> are correct there is nothing that keeps you from creating your own class that can implement such a feature and using that as your value. e.g. <code>(@counter ||= Counter.new).increment!</code>"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1566453752, "post_id": 57589960, "comment_id": 101662184, "body": "@steenslag : Did you try it? This gives the error message <i>undefined method &#39;to_i=&#39; for nil:NilClass</i> (in Ruby 2.6.3p62)."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1566467842, "post_id": 57589960, "comment_id": 101668950, "body": "@user1934428: &quot;I think the basic problem is, that the class Integer does not have any methods, which actually change the value represented by an instance.&quot; \u2013 If this were possible, it would be really, really, really, really bad. Imagine, some library that you use calls <code>1.inc!</code>, and then somewhere else in your code, you do <code>1 + 1</code> and the result is <code>4</code>!!!"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566476111, "post_id": 57589960, "comment_id": 101673542, "body": "@J&#246;rgWMittag : Well, <code>1</code> is a literal, and this could(should be protected for a change anyway. In a similar way, you can not do a <code>&#39;abc&#39;</code>[0] = &#39;x&#39;` although you can do a <code>s=&#39;abc&#39;; s[0]=&#39;x&#39;</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566492973, "post_id": 57589960, "comment_id": 101683007, "body": "@user1934428: Actually, you <i>can</i> do <code>&#39;abc&#39;[0] = &#39;x&#39;</code> just fine. <code>1</code> is an <code>Integer</code> like any other <code>Integer</code>. You said you wanted a way to change the value of an instance of <code>Integer</code>. Well, <code>1</code> <i>is</i> an instance of <code>Integer</code>. With your proposed <code>inc!</code> method, the following would also happen: <code>n = 1; n.inc!; 1 + 1 #=&gt; 4</code>."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566543456, "post_id": 57589960, "comment_id": 101696484, "body": "@J&#246;rgWMittag : <code>&#39;abc&#39;[0] = &#39;x&#39;</code> works only if you don&#39;t have <code>--enable=frozen-string-literal</code>, otherwise you get a <i>can&#39;t modify frozen String</i>. In Ruby 3, this is going to be the default behaviour, which makes sense to me. Indeed, if the language where designed to allow an Integer object to be mutable, the language would most likely also freeze Integer literals in the same way, simply to avoid such bizarre bugs which you describe."}], "answers": [{"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1566453991, "post_id": 57597018, "comment_id": 101662277, "body": "@CarySwoeveland : Actually, the variable is definied, either because it really is an variable explicitly initialized to nil, or because it comes from the hash which is indexted by a non existing key (<code>myHash[:new_key]</code>), and the goal is that if the key does not exist yet, the hash element should be initialized, otherwise incremented. Also, from the context I know that when the variable is non-nil, it must be an Integer."}, {"owner": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1566487515, "post_id": 57597018, "comment_id": 101680418, "body": "in the case of non existing hash key I&#39;d rather use hash proc to ensure default value to 0, then add 1 <a href=\"https://ruby-doc.org/core-2.0.0/Hash.html#method-i-default\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.0.0/Hash.html#method-i-default</a>"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1566543053, "post_id": 57597018, "comment_id": 101696313, "body": "@AlexisDelahaye : Not a good idea, because this would then assign 0 to <b>every</b> new Hash element automatically, not just to those which are supposed to hold an integer value."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1566410541, "creation_date": 1566410541, "answer_id": 57597018, "question_id": 57589960, "link": "https://stackoverflow.com/questions/57589960/ruby-idiom-for-create-and-increment/57597018#57597018", "title": "Ruby: Idiom for &quot;create and increment&quot;", "body": "<p>The question is clear:</p>\n\n<ul>\n<li>A variable is known to hold <code>nil</code> or an integer. If <code>nil</code> the variable is to be set equal to <code>1</code>, else it is to be set equal to its value plus <code>1</code>.</li>\n<li>What is the best way to implement this in Ruby?</li>\n</ul>\n\n<p>First, two points.</p>\n\n<ul>\n<li>The question states, \"If it is nil, it should be initialized with <code>1</code>.\". This contradicts the statement that the variable is known to be <code>nil</code> or an integer, meaning that it has already been initialized, or more accurately, <em>defined</em>. In the case of an instance variable, this distinction is irrelevant as Ruby initializes undefined instance variables to <code>nil</code> when they are referenced as <a href=\"https://www.oreilly.com/library/view/the-ruby-programming/9780596516178/ch04s05.html\" rel=\"nofollow noreferrer\">rvalues</a>. It's an important distinction for local variables, however, as an exception is raised when an undefined local variable is referenced as an rvalue.</li>\n<li>The comments largely address situations where the variable holds an object other than <code>nil</code> or an <code>integer</code>. They are therefore irrelevant. If the OP wishes to broaden the question to allow the variable to hold objects other than <code>nil</code> or an integer (an array or hash, for example), a separate question should be asked.</li>\n</ul>\n\n<p>What criteria should be used in deciding what code is best? Of the various possibilities that have been mentioned, I do not see important differences in efficiency. Assuming that to be the case, or that relative efficiency is not important in the application, we are left with readability (and by extension, maintainability) as the sole criterion. If <code>x</code> equals <code>nil</code> or an integer, or is an undefined instance variable, perhaps the clearest code is the following:</p>\n\n<pre><code>x = 0 if x.nil?\nx += 1\n</code></pre>\n\n<p>or</p>\n\n<pre><code>x = x.nil? ? 1 : x+1\n</code></pre>\n\n<p>Ever-so-slightly less readable:</p>\n\n<pre><code>x = (x || 0) + 1\n</code></pre>\n\n<p>and one step behind that:</p>\n\n<pre><code>x = x.to_i + 1\n</code></pre>\n\n<p>which requires the reader to know that <code>nil.to_i #=&gt; 0</code>.</p>\n\n<p>The OP may regard these solutions as \"clumsy\", but I think they are all beautiful.</p>\n\n<p>Can an expression be written that references <code>x</code> but once? I can't think of a way and one has not been suggested in the comments, so if there is a way (doubtful, I believe) it probably would not meet the test for readability.</p>\n\n<p>Consider now the case where the local variable <code>x</code> may not have been defined. In that case we might write:</p>\n\n<pre><code>x = (defined?(x) ? (x || 0) : 0) + 1\n</code></pre>\n\n<p><a href=\"https://docs.ruby-lang.org/en/2.6.0/keywords_rdoc.html\" rel=\"nofollow noreferrer\">defined?</a> is a Ruby keyword.</p>\n"}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 57597018, "answer_count": 1, "score": 1, "last_activity_date": 1566411908, "creation_date": 1566384535, "question_id": 57589960, "link": "https://stackoverflow.com/questions/57589960/ruby-idiom-for-create-and-increment", "title": "Ruby: Idiom for &quot;create and increment&quot;", "body": "<p>I am looking for a concise way to deal with the following situation: Given a variable (in practince, an instance variable in a class, though I don't think this matters here), which is known to be either <code>nil</code> or hold some <code>Integer</code>. If it is an Integer, the variable should be incremented. If it is nil, it should be initialized with <code>1</code>.</p>\n\n<p>These are obvious solutions to this, taking <code>@counter</code> as the variable to deal with:</p>\n\n<pre><code># Separate the cases into two statements\n@counter ||= 0\n@counter += 1\n</code></pre>\n\n<p>or</p>\n\n<pre><code># Separate the cases into one conditional\n@counter = @counter ? (@counter + 1) : 1\n</code></pre>\n\n<p>I don't like these solutions because they require to repeat the name of the variable. The following attempt failed:</p>\n\n<pre><code># Does not work\n(@counter ||= 0) += 1\n</code></pre>\n\n<p>This can't be done, because the result of the assignment operators is not an lvalue, though the actual error message is a bit obscure. In this case, you get the error _unexpected tOP_ASGN, expecting end_.</p>\n\n<p>Is there a good idiom to code my problem, or do I have to stick with one of my clumsy solutions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "activerecord"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1566383191, "post_id": 57589429, "comment_id": 101636541, "body": "Please, show us the model relationships or the related schema parts."}, {"owner": {"reputation": 123, "user_id": 11940997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d8XYSQGavDg/AAAAAAAAAAI/AAAAAAAAAQY/Z18PSao_lNM/photo.jpg?sz=128", "display_name": "arnasklas", "link": "https://stackoverflow.com/users/11940997/arnasklas"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1566383559, "post_id": 57589429, "comment_id": 101636722, "body": "I added the model relations."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1566384357, "creation_date": 1566384357, "answer_id": 57589922, "question_id": 57589429, "link": "https://stackoverflow.com/questions/57589429/rails-how-to-use-sum-and-multiple-models-to-get-the-total-order-value/57589922#57589922", "title": "Rails: How to use sum and multiple models to get the total order value", "body": "<p>You can't call <code>@products.reservations</code> to get all the reservations, because <code>@products</code> is a relationship (a collection) and you can call <code>has_many</code> methods on a single object. Instead you need to use SQL <code>JOIN</code> (implemented in ActiveRecord <code>joins</code>) to get all the relevant reservations and the to sum their total:</p>\n\n<pre><code>@products.joins(:reservations).sum('reservations.total')\n</code></pre>\n\n<p>See more:</p>\n\n<ul>\n<li><a href=\"https://guides.rubyonrails.org/active_record_querying.html#joins\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_querying.html#joins</a></li>\n<li><a href=\"https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-joins\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-joins</a></li>\n<li><a href=\"http://www.sql-join.com/sql-join-types\" rel=\"nofollow noreferrer\">http://www.sql-join.com/sql-join-types</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1566395420, "creation_date": 1566395420, "answer_id": 57593235, "question_id": 57589429, "link": "https://stackoverflow.com/questions/57589429/rails-how-to-use-sum-and-multiple-models-to-get-the-total-order-value/57593235#57593235", "title": "Rails: How to use sum and multiple models to get the total order value", "body": "<p>The reason you get the exception is because <code>.reservations</code> can only be called upon a single product. Not on a collection of products. The following should work:</p>\n\n<pre><code>@amount_received = Reservation.where(product_id: @products).sum(:total)\n</code></pre>\n\n<p>Normally you would specify the column to select, but this defaults to the <em>id</em>. Meaning <code>.where(product_id: @products)</code> produces the same result as <code>.where(product_id: @products.select(:id))</code>.</p>\n"}], "owner": {"reputation": 123, "user_id": 11940997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-d8XYSQGavDg/AAAAAAAAAAI/AAAAAAAAAQY/Z18PSao_lNM/photo.jpg?sz=128", "display_name": "arnasklas", "link": "https://stackoverflow.com/users/11940997/arnasklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566395420, "creation_date": 1566382777, "last_edit_date": 1592644375, "question_id": 57589429, "link": "https://stackoverflow.com/questions/57589429/rails-how-to-use-sum-and-multiple-models-to-get-the-total-order-value", "title": "Rails: How to use sum and multiple models to get the total order value", "body": "<p>I would like to display <code>@amount_spent</code> and <code>@amount_received</code> by each user. I've already finished the first part with <code>@amount_spent = Reservation.where(user_id: @user.id).sum(:total)</code></p>\n<p>Now I would also like to display the <code>@amount_received</code>, since I use Stripe Connect.</p>\n<p>I've tried something similar to:</p>\n<pre><code>@user = User.find(params[:id])\n@products = @user.products\n@amount_received = @products.reservations.sum(:total)\n</code></pre>\n<p>But when I try to use <code>reservations</code> with <code>@products</code> I get an <code>#&lt;Product::ActiveRecord_Associations_CollectionProxy:0x00007f50b8709fa8&gt;</code> error.</p>\n<p>Is there a better way or another way, probably with scopes?</p>\n<h3>User Model:</h3>\n<pre><code>has_many :products\nhas_many :reservations\n</code></pre>\n<h3>Product Model:</h3>\n<pre><code>has_many :reservations\n</code></pre>\n<h3>Reservation Model:</h3>\n<pre><code>belongs_to :user\nbelongs_to :product\n</code></pre>\n"}, {"tags": ["ruby", "logging"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1566382430, "post_id": 57589163, "comment_id": 101636126, "body": "What would it do if the log device is <code>&#47;dev&#47;null</code> or <code>&#47;dev&#47;stderr</code> etc?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 2, "creation_date": 1566382597, "post_id": 57589163, "comment_id": 101636229, "body": "<code>MainClass.logger.instance_variable_get(:@logdev).dev</code> is the log device / file."}], "owner": {"reputation": 96, "user_id": 7408598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c6134d361550f3a22f21ae86e675382?s=128&d=identicon&r=PG&f=1", "display_name": "ItamarG", "link": "https://stackoverflow.com/users/7408598/itamarg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566381855, "creation_date": 1566381855, "question_id": 57589163, "link": "https://stackoverflow.com/questions/57589163/how-to-take-a-log-snapshot-through-logger-class-in-ruby", "title": "How to take a log snapshot through Logger class in Ruby", "body": "<p>I use Ruby's logger class from the standard library.</p>\n\n<p>I need to print the program log to a different report (some kind of snapshot)\nbut I can't access the content of the logger or find any way to access the file through the Logger instance.</p>\n\n<p>My solution is to keep a pointer to the file when I initialize the logger and then access it later, \nBut I don't need it all the time and keeping that seems redundant.\nThere must be a more elegant way to address the problem (though I can't find it)</p>\n\n<p>I want something like:</p>\n\n<pre><code>class MainClass\n    @@logger = nil\n    def self.log_to(file_log_device)\n        @@logger = Logger.new(file_log_device)\n    end \nend\n</code></pre>\n\n<p>...program runs and logging using @@logger...</p>\n\n<pre><code>def take_log_snapshot\n    snapshot_file = File.open(\"snapshot.txt\",'wr')\n    MainClass.logger.flush(snapshot_file)   \nend\n</code></pre>\n\n<p>I want that the current data that spilled to the device (logging file) will be flushed also to snapshot_file</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1566393402, "creation_date": 1566393402, "answer_id": 57592588, "question_id": 57589054, "link": "https://stackoverflow.com/questions/57589054/implement-a-playlist-queuing-system-for-a-song-request-app-in-rails/57592588#57592588", "title": "Implement a Playlist Queuing System for a Song Request App in rails", "body": "<p>I think that you shouldn't think of Songs table order as a way in which you will serve songs on playlist. It would be good idea if you could query songs in some structured way but as you said you will be moving songs around playlist.</p>\n\n<p>I would think of implementing some kind of <code>Playlist</code> model which can hold array of all songs added by users (each new song gets pushed to the end of array). </p>\n\n<p>At the same time DJ have access to this array and can move song to specific position in array. At most it will be one operation on db per songs order change because you would only be changing array with references to songs, not songs themselves.</p>\n"}], "owner": {"reputation": 500, "user_id": 5973933, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-Oibv_qAg5fQ/AAAAAAAAAAI/AAAAAAAAAGs/PWra2-sj8Pk/photo.jpg?sz=128", "display_name": "Raunak Joneja", "link": "https://stackoverflow.com/users/5973933/raunak-joneja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566393402, "creation_date": 1566381515, "question_id": 57589054, "link": "https://stackoverflow.com/questions/57589054/implement-a-playlist-queuing-system-for-a-song-request-app-in-rails", "title": "Implement a Playlist Queuing System for a Song Request App in rails", "body": "<p>So the purpose of this app is to allow customers at a venue to requests songs to be played to the host/dj. The host take requests of the songs and plays it at his will. The host also is allowed to change the position of the songs that is to be played.</p>\n\n<p>When a user requests a song it automatically adds it to the bottom of the playlist queue, the 'position' field is updated by simply taking the count of the playlist queue.</p>\n\n<p>But, the host is allowed to change the position, if he/she decides to push a track up from position 5 to 2. The songs in between should also increment their position accordingly.</p>\n\n<p>A simple, solution to this is to x+1 on all the songs in between the old and new position. But this would create a lot of write operations on the db, it is very much possible that a song is pushed from no.100 to no.2, which would in return lead to 98 write operations on the database.</p>\n\n<p>Would there be any better solution out of this?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1566380837, "post_id": 57588834, "comment_id": 101635188, "body": "How did you define <code>customers_and_suppliers</code> method, show that.."}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 1, "creation_date": 1566384306, "post_id": 57588834, "comment_id": 101637102, "body": "@ArupRakshit Above i attached the method."}, {"owner": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "edited": false, "score": 1, "creation_date": 1566388169, "post_id": 57588834, "comment_id": 101639183, "body": "add a <code>.uniq</code> in your scope ?"}, {"owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "reply_to_user": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "edited": false, "score": 1, "creation_date": 1566388768, "post_id": 57588834, "comment_id": 101639510, "body": "@morissetcl Oh god it helped me to solve the problem. Thank u sir !"}], "owner": {"reputation": 43, "user_id": 9441331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ceea0711338b20204d472a434f17956?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaDx", "link": "https://stackoverflow.com/users/9441331/anujadx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566387661, "creation_date": 1566380766, "last_edit_date": 1566387661, "question_id": 57588834, "link": "https://stackoverflow.com/questions/57588834/how-to-sort-values-in-rails-drop-down", "title": "How to Sort Values in Rails Drop Down", "body": "<p>I have a dropdown with options_from_collection_for_select tag.I want to have the values in the dropdown list sorted by ascending order. (it's a list of cusromer names,just want them sorted by customer name in ascending order). This is what I have:</p>\n\n<pre><code>.row\n .col-md-3\n   = label_tag \"Customer/Supplier Name\"\n   = select_tag \"search_customer_supplier[id]\", options_from_collection_for_select(Organization.customers_and_suppliers, :id, :name, params.dig('search_customer_supplier', 'id')), class: \"form-control parent_class chosen-select\", id: \"search_registered_customers\", include_blank: true\n</code></pre>\n\n<p>In my model the customers_and_suppliers method difined as a scope. Here it is</p>\n\n<pre><code> scope :customers_and_suppliers, -&gt; { joins(accounts_dealer_types: :dealer_type).where(mst_dealer_types: {code: Organization::TYPES}) }\n\n</code></pre>\n\n<p>Finally i tried using this code </p>\n\n<pre><code>scope :customers_and_suppliers, -&gt; { joins(accounts_dealer_types: :dealer_type).where(mst_dealer_types: {code: Organization::TYPES}).order('name ASC') }\n\n</code></pre>\n\n<p>Then i got the results as ascending order.But in the dropdown there are so many duplicated records displaying,What will be the solution ?</p>\n"}, {"tags": ["ruby", "syntax"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1566373912, "post_id": 57586791, "comment_id": 101631444, "body": "I doubt I follow how one who \u201cwants to learn how to do functional programming with it\u201d would <i>ever</i> prefer mutating methods. In my professional career, there were zero cases when I used method mutating the receiver (those with bangs.)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1566374004, "post_id": 57586791, "comment_id": 101631486, "body": "\u201csince it resolves first [...] then assign it to <code>frequencies =</code> and then it calls the next method\u201d\u2014this is plain wrong."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1566374159, "post_id": 57586791, "comment_id": 101631573, "body": "Can you clarify your question, please? You wrote that you want to do functional programming, but <code>reverse!</code> is the <i>exact opposite</i> of functional programming."}, {"owner": {"reputation": 5336, "user_id": 618099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/A3bOH.png?s=128&g=1", "display_name": "Norfeldt", "link": "https://stackoverflow.com/users/618099/norfeldt"}, "edited": false, "score": 0, "creation_date": 1566374908, "post_id": 57586791, "comment_id": 101631865, "body": "As mentioned: I&#39;m new at Ruby (please bear with me). I do see the conflict in fun.prog. and use of <code>!</code> in my question. I think it was because I expected <code>sort_by</code> and <code>reverse</code> to non-mutating methods"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 2, "creation_date": 1566376433, "post_id": 57586791, "comment_id": 101632605, "body": "I think <code>frequencies = frequencies.sort_by { |word, count| -1 * count}</code> would eliminate the need for <code>.reverse</code>"}, {"owner": {"reputation": 5336, "user_id": 618099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/A3bOH.png?s=128&g=1", "display_name": "Norfeldt", "link": "https://stackoverflow.com/users/618099/norfeldt"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566378478, "post_id": 57586791, "comment_id": 101633705, "body": "@AlekseiMatiushkin Is there a list over Ruby hash mutating and non-mutating methods?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566384279, "post_id": 57586791, "comment_id": 101637088, "body": "There is a convention in Ruby: mutating method names end with a bang."}, {"owner": {"reputation": 5336, "user_id": 618099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/A3bOH.png?s=128&g=1", "display_name": "Norfeldt", "link": "https://stackoverflow.com/users/618099/norfeldt"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566410182, "post_id": 57586791, "comment_id": 101651003, "body": "@AlekseiMatiushkin and it&#39;s not possible to &quot;bang&quot; <code>sort_by</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 5336, "user_id": 618099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/A3bOH.png?s=128&g=1", "display_name": "Norfeldt", "link": "https://stackoverflow.com/users/618099/norfeldt"}, "edited": false, "score": 0, "creation_date": 1566378666, "post_id": 57587564, "comment_id": 101633817, "body": "I like the concept of defining a method that is non-mutating."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1566384507, "post_id": 57587564, "comment_id": 101637210, "body": "<code>&quot;foo bar baz baz baz Foo FOO foo&quot;.downcase.split.each_with_object(Hash.new{0}) { |e, h| h[e] += 1 }.sort_by(&amp;:last).map { |e| e.join(&quot; \u2192 &quot;) } .map(&amp;method(:puts))</code> :)"}, {"owner": {"reputation": 5336, "user_id": 618099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/A3bOH.png?s=128&g=1", "display_name": "Norfeldt", "link": "https://stackoverflow.com/users/618099/norfeldt"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566409845, "post_id": 57587564, "comment_id": 101650881, "body": "thx for the oneliner @AlekseiMatiushkin ;-) (I had to drop a <code>.reverse</code> in to make it work though."}], "tags": [], "owner": {"reputation": 684, "user_id": 528483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9fShF.jpg?s=128&g=1", "display_name": "olistik", "link": "https://stackoverflow.com/users/528483/olistik"}, "is_accepted": true, "score": 4, "last_activity_date": 1566376548, "creation_date": 1566376548, "answer_id": 57587564, "question_id": 57586791, "link": "https://stackoverflow.com/questions/57586791/ruby-reassignment-after-chained-methods-sort-by-reverse-etc/57587564#57587564", "title": "Ruby reassignment after chained methods (sort_by, reverse etc)", "body": "<p>It looks like you're just doing imperative programming, because I see mainly a list of statements.\nI suggest you to wrap the logic in a function so that you can clearly define what are the inputs and the output you're dealing with:</p>\n\n<pre><code>def word_frequencies(text)\n  words = text.downcase.split(\" \") \n  frequencies = Hash.new(0) \n  words.each { |word| frequencies[word] += 1 }\n  frequencies.sort_by { |word, count| count}.reverse\nend\n</code></pre>\n\n<p>This way you are clearly stating that:</p>\n\n<ul>\n<li>text is the only input</li>\n<li>you won't mutate the input</li>\n<li>you won't generate side effects. Each time you invoke the function, given the same input, the output will always be the same and the only output will be the value returned by the function.</li>\n</ul>\n\n<p>Once you clearly define the function's boundaries, there's no shame in performing assignments.</p>\n\n<p>There's point where you need to generate side effects, such as printing something to the screen:</p>\n\n<pre><code>frequencies = word_frequencies(\"foo bar baz baz baz Foo FOO foo\")\nfrequencies.each { |word, count| puts \"#{word} #{count}\"}\n</code></pre>\n\n<p>Finally, if you want to experiment with a completely chained program, you can do so with <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-then\" rel=\"nofollow noreferrer\"><code>Object#then</code></a>:</p>\n\n<pre><code>\"foo bar baz baz baz Foo FOO foo\".then do |text|\n  text.downcase.split(\" \")\nend.then do |words|\n  words.each_with_object(Hash.new(0)) do |word, memo|\n    memo[word] += 1\n  end\nend.then do |frequencies|\n  frequencies.\n    sort_by { |word, count| count}.\n    reverse\nend.each do |word, count|\n  puts \"#{word} #{count}\"\nend\n\n# foo 4\n# baz 3\n# bar 1\n</code></pre>\n\n<p>Pick your poison. :-)</p>\n"}], "owner": {"reputation": 5336, "user_id": 618099, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/A3bOH.png?s=128&g=1", "display_name": "Norfeldt", "link": "https://stackoverflow.com/users/618099/norfeldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57587564, "answer_count": 1, "score": 0, "last_activity_date": 1566410333, "creation_date": 1566373533, "last_edit_date": 1566410333, "question_id": 57586791, "link": "https://stackoverflow.com/questions/57586791/ruby-reassignment-after-chained-methods-sort-by-reverse-etc", "title": "Ruby reassignment after chained methods (sort_by, reverse etc)", "body": "<p>Just learning Ruby for the first time and playing around with it to learn how to do <s>functional programming with it</s> not mutate the object before I explicit want to mutate it (using <code>!</code>).</p>\n\n<pre><code>text = \"foo bar baz baz baz Foo FOO foo\"\n# Splitting the sentence into an array of words\nwords = text.downcase.split(\" \") \n# Hash to store the frequencies of each word\nfrequencies = Hash.new(0) \n# Count the instances of a word one by one\nwords.each { |word| frequencies[word] += 1 }\n# Sort it by the most frequent words\nfrequencies.sort_by { |word, count| count}.reverse!\n# Print out the histogram\nfrequencies.each { |word, count| puts \"#{word} #{count}\"}\n</code></pre>\n\n<p>prints out the following </p>\n\n<pre><code>foo 4\nbar 1\nbaz 3\n</code></pre>\n\n<p>The expected results would be </p>\n\n<pre><code>foo 4\nbaz 3\nbar 1\n</code></pre>\n\n<p>I know that it can be solved by this</p>\n\n<pre><code>frequencies = frequencies.sort_by { |word, count| count}.reverse!\n</code></pre>\n\n<p><strong>But I do like the simple <code>!</code> reassignment syntax in ruby and are wondering if I can avoid this <code>frequencies =</code> ?</strong></p>\n\n<hr>\n\n<p>Doing <code>frequencies.sort_by! { |word, count| count}.reverse!</code> throws an <code>undefined method</code> error.</p>\n\n<p><s>I also find the working solution a bit counter-intuitive since it resolves first </p>\n\n<pre><code>frequencies.sort_by { |word, count| count}\n</code></pre>\n\n<p>then assign it to <code>frequencies =</code> and then it calls the next method <code>.reverse!</code></s></p>\n\n<h1>EDIT</h1>\n\n<p>I now think understand how to read the working solution. The </p>\n\n<p><code>frequencies.sort_by { |word, count| count}</code></p>\n\n<p>returns a new Hash which then is reversed by <code>reverse</code>.\nThe <code>!</code> does nothing since it \"reassigns\" the new (sorted and reversed) hash which has no variable assignment.</p>\n\n<p>Then the whole thing is assigned to <code>frequencies</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1566361831, "post_id": 57584312, "comment_id": 101627220, "body": "<code>&lt;%= link_to &quot;Results&quot;, &quot;path of your action (sensors: @sensors)&quot; %&gt;</code> for an example <code>&lt;%= link_to &quot;Results&quot;, articles_path(sensors: @sensors) %&gt; </code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1566363032, "post_id": 57584312, "comment_id": 101627450, "body": "@Vishal - I don&#39;t think <code>articles_path(sensors: @sensors)</code> is going to give you what you think it&#39;s going to give you."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1566363465, "post_id": 57584312, "comment_id": 101627528, "body": "@jvillian I just gave an example of how to pass parameters with link to, what particular she wants to send, like ids. it&#39;s up to her."}], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 2457762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564360e73796c7b491b0d07619a7813?s=128&d=identicon&r=PG", "display_name": "Jonathan Bennett", "link": "https://stackoverflow.com/users/2457762/jonathan-bennett"}, "is_accepted": false, "score": 0, "last_activity_date": 1566362068, "creation_date": 1566362068, "answer_id": 57584489, "question_id": 57584312, "link": "https://stackoverflow.com/questions/57584312/how-to-pass-down-parameter-using-link-to/57584489#57584489", "title": "How to pass down parameter using link_to", "body": "<p><code>&lt;%= link_to \"Results\", results_path(senid: sensor.id) %&gt;</code> would give you a link to something like <code>/results?senid=123</code></p>\n"}, {"comments": [{"owner": {"reputation": 235, "user_id": 11876193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8d60ef1c541d619b23743be3ba1e4?s=128&d=identicon&r=PG&f=1", "display_name": "YLim", "link": "https://stackoverflow.com/users/11876193/ylim"}, "edited": false, "score": 0, "creation_date": 1566418718, "post_id": 57584591, "comment_id": 101654526, "body": "It is giving me an error undefined method `ids&#39; because @sensors is an array. How can I pass down each ids in the array?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 235, "user_id": 11876193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8d60ef1c541d619b23743be3ba1e4?s=128&d=identicon&r=PG&f=1", "display_name": "YLim", "link": "https://stackoverflow.com/users/11876193/ylim"}, "edited": false, "score": 0, "creation_date": 1566419227, "post_id": 57584591, "comment_id": 101654718, "body": "An array of what? If it is an array of objects that respond to <code>.id</code>, then you could probably do <code>@sensors.map(&amp;:id)</code> or, possibly, <code>@sensors.pluck(:id)</code>."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1566362852, "creation_date": 1566362852, "answer_id": 57584591, "question_id": 57584312, "link": "https://stackoverflow.com/questions/57584312/how-to-pass-down-parameter-using-link-to/57584591#57584591", "title": "How to pass down parameter using link_to", "body": "<p>Assuming you have <code>@sensors</code> that is an enumerable that responds to <code>ids</code>. And also assuming in your <code>routes.rb</code>, you have something like: </p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :results\nend\n</code></pre>\n\n<p>...then you could do something like: </p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to \"Results\", results_path(sensor_ids: @sensor.ids) %&gt; &lt;/td&gt;\n</code></pre>\n\n<p>Which will give you something like:</p>\n\n<pre><code>&lt;a href=\"/results?sensor_ids%5B%5D=3&amp;sensor_ids%5B%5D=4\"&gt;Results&lt;/a&gt;\n</code></pre>\n\n<p>When you click on the link, you'll have something like: </p>\n\n<pre><code>Started GET \"/results?sensor_ids%5B%5D=3&amp;sensor_ids%5B%5D=4\" for ::1 at 2019-08-20 21:36:50 -0700\nProcessing by ResultsController#index as HTML\n  Parameters: {\"sensor_ids\"=&gt;[\"3\", \"4\"]}\n</code></pre>\n\n<p>In your <code>ResultsController</code>, then, you can do something like: </p>\n\n<pre><code>#app/controllers/results_controller.rb\nclass ResultsController &lt; ApplicationController\n\n  def index\n    @sensors = Sensor.where(id: params[:sensor_ids])\n    ...\n  end\n\nend\n</code></pre>\n\n<p>...and now you'll have <code>@sensors</code> in your <code>ResultsController</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "is_accepted": false, "score": 0, "last_activity_date": 1566373174, "creation_date": 1566373174, "answer_id": 57586703, "question_id": 57584312, "link": "https://stackoverflow.com/questions/57584312/how-to-pass-down-parameter-using-link-to/57586703#57586703", "title": "How to pass down parameter using link_to", "body": "<pre><code>&lt;%= link_to \"See Chart\", \"chart_path(sensor_id: @sensor.id)\" %&gt;\n</code></pre>\n\n<p>This is how you can pass sensor id to chart controller.</p>\n"}], "owner": {"reputation": 235, "user_id": 11876193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e8d60ef1c541d619b23743be3ba1e4?s=128&d=identicon&r=PG&f=1", "display_name": "YLim", "link": "https://stackoverflow.com/users/11876193/ylim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57584591, "answer_count": 3, "score": 0, "last_activity_date": 1566373174, "creation_date": 1566360597, "question_id": 57584312, "link": "https://stackoverflow.com/questions/57584312/how-to-pass-down-parameter-using-link-to", "title": "How to pass down parameter using link_to", "body": "<pre><code>&lt;td&gt;&lt;%= link_to \"See Chart\", \"#AddChartModal\" %&gt; &lt;/td&gt;\n\n&lt;%= render partial: 'searches/chart', locals: {senid: sensor.id} %&gt;\n</code></pre>\n\n<p>Like the code above, I'll like to pass down @sensors to another controller.</p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to \"Results\", \"folder_name/file_name\" %&gt; &lt;/td&gt;\n</code></pre>\n\n<p>Is there a way to pass down @sensors using link_to to another controller?</p>\n"}, {"tags": ["ruby", "multithreading", "loops"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1566358085, "post_id": 57584004, "comment_id": 101626638, "body": "Second sentence: <a href=\"https://apidock.com/ruby/Thread/join\" rel=\"nofollow noreferrer\">apidock.com/ruby/Thread/join</a> But you&#39;ll likely want to read docs like <a href=\"https://www.toptal.com/ruby/ruby-concurrency-and-parallelism-a-practical-primer\" rel=\"nofollow noreferrer\">toptal.com/ruby/&hellip;</a>, <a href=\"https://dev.to/enether/working-with-multithreaded-ruby-part-i-cj3\" rel=\"nofollow noreferrer\">dev.to/enether/working-with-multithreaded-ruby-part-i-cj3</a>, <a href=\"https://engineering.universe.com/introduction-to-concurrency-models-with-ruby-part-i-550d0dbb970\" rel=\"nofollow noreferrer\">engineering.universe.com/&hellip;</a>, etc."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566367074, "post_id": 57584004, "comment_id": 101628510, "body": "Since your example is incomplete, we have no clue what the problem is. Please make <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that accurately shows your problem."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566367169, "post_id": 57584004, "comment_id": 101628540, "body": "@Amadan the issue is <a href=\"https://ruby-doc.org/core/Thread.html#method-i-join\" rel=\"nofollow noreferrer\"><code>Thread#join</code></a> that synchronizes execution."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1566367274, "post_id": 57584004, "comment_id": 101628578, "body": "@AlekseiMatiushkin: I cannot see anything there that would prevent other threads running while threads[0] is being waited upon. Once thread[0] completes, again nothing prevents threads[x] for x&gt;1 to run while thread[1] is being waited on. This just looks like a common pattern, with no discernable reason why other threads would block, unless I&#39;m missing something."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1566367679, "post_id": 57584004, "comment_id": 101628724, "body": "@AlekseiMatiushkin: Proof that this runs in parallel, simultaneously (with minimal modifications to make it execute): <a href=\"https://repl.it/repls/FluffyShadyToolbox\" rel=\"nofollow noreferrer\">repl.it/repls/FluffyShadyToolbox</a> . The example would execute in 25 seconds if it was serial, but it completes in 5 seconds (with start and end of each thread happening at roughly the same time)."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566367781, "post_id": 57584004, "comment_id": 101628756, "body": "@Amadan oh, indeed. For some reason, I thought one should explicitly call <code>Thread#pass</code> to pass the control to the awaiting thread."}], "owner": {"reputation": 1, "user_id": 11027960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hd3SmDvJFaA/AAAAAAAAAAI/AAAAAAAAALk/ZgOKYwemjb8/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/11027960/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566362693, "creation_date": 1566357375, "question_id": 57584004, "link": "https://stackoverflow.com/questions/57584004/why-doesnt-my-ruby-loop-create-n-threads", "title": "Why doesn&#39;t my ruby loop create N threads?", "body": "<p>I'm playing around with ruby at the moment, and I'm interested in using multiple threads; n to be exact. </p>\n\n<p>However, my program gets stuck on running the first thread to completion instead of starting the rest of the threads.</p>\n\n<p>I've look around on the web for some assistance but found nothing that really helped. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>numberThreads = 5\n\nputs \"Number of threads: \" + numberThreads.to_s \n\nfor i in 1..numberThreads do\n\n    threads &lt;&lt; Thread.new{\n        function(x, y)\n    }\n\nend\n\nthreads.each { |thr| thr.join }\n</code></pre>\n\n<p>I'm looking to have all n threads (in this case 5) run the function simultaneously.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "edited": false, "score": 0, "creation_date": 1566721220, "post_id": 57584492, "comment_id": 101739859, "body": "thanks for your help! Problem was solved! Just had to add an image tag, silly me. But I watched the tutorial, very helpful."}, {"owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "reply_to_user": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "edited": false, "score": 0, "creation_date": 1566821212, "post_id": 57584492, "comment_id": 101764719, "body": "No problem, glad I could be of help."}], "tags": [], "owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1566362451, "last_edit_date": 1566362451, "creation_date": 1566362102, "answer_id": 57584492, "question_id": 57582442, "link": "https://stackoverflow.com/questions/57582442/how-to-get-a-file-uploaded-from-a-form-to-get-displayed-to-another-view-using-ra/57584492#57584492", "title": "How to GET a file uploaded from a form to get displayed to another view using Rails?", "body": "<p>The Rails offers a simple way for uploading files via <code>ActiveStorage</code> (there are also few gems which do the same thing but for now you can try <code>ActiveStorage</code> as it is build in solution).</p>\n\n<p>Official guides are good resource to start digging into this topic. You can find <code>ActiveStorage</code> related article here:</p>\n\n<p><a href=\"https://guides.rubyonrails.org/active_storage_overview.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_storage_overview.html</a></p>\n\n<p>There are also many tutorials on how to set it up on the Internet. If you are more of video guy GoRails offers nice overview:</p>\n\n<p><a href=\"https://gorails.com/episodes/file-uploading-with-activestorage-rails-5-2?autoplay=1\" rel=\"nofollow noreferrer\">https://gorails.com/episodes/file-uploading-with-activestorage-rails-5-2?autoplay=1</a></p>\n\n<p>Basically you will need to add some configuration to your application and related fields to your models. After this you will be able to pass files in the params to your controller and save their representation in database. This will allow you to retrieve them in the view from instance variables (just as you do now with <code>title</code>, <code>author</code> and <code>description</code>.</p>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "edited": false, "score": 0, "creation_date": 1566721251, "post_id": 57586783, "comment_id": 101739868, "body": "it&#39;s an attribute, just had to add an image tag to my view. Thank you for your help!"}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "reply_to_user": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "edited": false, "score": 0, "creation_date": 1566802356, "post_id": 57586783, "comment_id": 101756080, "body": "Ok, so for that you can use CarrierWave gem <a href=\"https://github.com/carrierwaveuploader/carrierwave\" rel=\"nofollow noreferrer\">github.com/carrierwaveuploader/carrierwave</a> It&#39;s easy to implement please go through the documentation and if you still need help you can ping."}], "tags": [], "owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "is_accepted": false, "score": 1, "last_activity_date": 1566373502, "creation_date": 1566373502, "answer_id": 57586783, "question_id": 57582442, "link": "https://stackoverflow.com/questions/57582442/how-to-get-a-file-uploaded-from-a-form-to-get-displayed-to-another-view-using-ra/57586783#57586783", "title": "How to GET a file uploaded from a form to get displayed to another view using Rails?", "body": "<p>is file an attribute or association?\nIn which model you're trying to upload file is it book or other association model?</p>\n"}], "owner": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57584492, "answer_count": 2, "score": 4, "last_activity_date": 1566709679, "creation_date": 1566341516, "last_edit_date": 1566380102, "question_id": 57582442, "link": "https://stackoverflow.com/questions/57582442/how-to-get-a-file-uploaded-from-a-form-to-get-displayed-to-another-view-using-ra", "title": "How to GET a file uploaded from a form to get displayed to another view using Rails?", "body": "<p>Newbie to Rails here. So I'm creating an online library for my project where I am able to upload e-books (in the forms of pdfs) of the user's choice. The form, Add Manga takes in two files: the thumbnail (in jpg, jpeg, png) and the actual pdf of the ebook. </p>\n\n<p>I would like to know how to get both the thumbnail and the pdf files from the forms, and display it in my show view. </p>\n\n<p>Thank you! </p>\n\n<p>1) I've tried bringing in the img tag inside the label tag, however with the current script, returning nothing. </p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt;\n    &lt;%= csrf_meta_tag %&gt;\n    &lt;title&gt;Document&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;div class=\"container\"&gt;\n  &lt;div class=\"information\"&gt;\n    &lt;h1&gt;Title&lt;/h1&gt;\n    &lt;p&gt;&lt;%= @book.title%&gt;&lt;/p&gt;\n    &lt;h1&gt;Author&lt;/h1&gt;\n    &lt;p&gt;&lt;%= @book.author%&gt;&lt;/p&gt;\n    &lt;h1&gt;Description&lt;/h1&gt;\n    &lt;p&gt;&lt;%= @book.description%&gt;&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;%= link_to \"Edit\", edit_book_path(@book), :class =&gt; \"btn btn-default\" %&gt;\n&lt;!--after you make this make edit method in books controller--&gt;\n&lt;%= button_to \"Delete\", book_path(@book),\n    method: :delete,\n    data: {confirm: 'Are you sure?'},\n    :class =&gt; \"btn btn-danger\" %&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n\nThis is my books controller. \nclass BooksController &lt; ApplicationController\n  skip_before_action :verify_authenticity_token\n\n  def index  #step 4\n    @books = Book.all\n  end\n\n  def show #step 3\n    @book = Book.find(params[:id]) #get individual post page\n  end\n\n  def newBook \n    @book = Book.new\n    #creates a new post of registered books \n  end\n\n  def create #Step 2\n    #render plain: params[:books].inspect #see what data is sent\n    @book = Book.new(book_params)\n\n    if(@book.save)\n      redirect_to @book\n    else\n      render 'newBook' #if title is not there, just re renders newBook page\n    end\n\n  end\n\n  def edit \n    @book = Book.find(params[:id]) #after this, make edit.html.erb\n  end\n\n  def update\n    @book = Book.find(params[:id]) \n\n    if(@book.update(book_params))\n      redirect_to @book\n    else\n      render 'edit'\n    end\n  end\n\n  def destroy \n    @book = Book.find(params[:id])\n    @book.destroy\n    redirect_to books_path\n  end\n\n  def mangaList\n    @books = Book.all\n  end\n\n  private \n\n  def book_params #can only be accessed from this class #step1 \n    params.require(:books).permit(:title, :author, :description)\n  end\nend\n</code></pre>\n\n<p>I tried adding a :file inside the book_params but it did not work.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 501, "user_id": 3533906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d9c055b52b568e9021c6623e6d9b87b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3533906/mike"}, "edited": false, "score": 1, "creation_date": 1566341537, "post_id": 57582338, "comment_id": 101624054, "body": "That&#39;s not a hash.  It&#39;s 5 hashes.  Do you want to sort an array of those 5 hashes?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11825400, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-72RXxMJH4fY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rexe_nEcIlVktR0iOFd4A2AqDMMqQ/photo.jpg?sz=128", "display_name": "NewUser123", "link": "https://stackoverflow.com/users/11825400/newuser123"}, "edited": false, "score": 0, "creation_date": 1566342262, "post_id": 57582490, "comment_id": 101624178, "body": "Thanks that worked!!! newbie to Ruby! thats right..its an array of hashes. Ruby does not seem to print arrays with <code>[..]</code> in <code>puts</code> like python :thinking_face:"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1566367926, "post_id": 57582490, "comment_id": 101628808, "body": "Depends how you print them. <code>p stuff</code> and <code>puts stuff</code> do different things. <code>puts</code> prints array elements as separate lines. <code>p</code> gives more of a debuggy output."}], "tags": [], "owner": {"reputation": 501, "user_id": 3533906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d9c055b52b568e9021c6623e6d9b87b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3533906/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1566341935, "creation_date": 1566341935, "answer_id": 57582490, "question_id": 57582338, "link": "https://stackoverflow.com/questions/57582338/sort-ruby-hash-by-specific-key/57582490#57582490", "title": "sort ruby hash by specific key", "body": "<p>Assuming you want to sort an array of hashes:</p>\n\n<pre><code>def sort_by_name(hashes)\n  hashes.sort_by { |h| h[\"name\"] }\nend\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11825400, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-72RXxMJH4fY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rexe_nEcIlVktR0iOFd4A2AqDMMqQ/photo.jpg?sz=128", "display_name": "NewUser123", "link": "https://stackoverflow.com/users/11825400/newuser123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57582490, "answer_count": 1, "score": 0, "last_activity_date": 1566341935, "creation_date": 1566340682, "question_id": 57582338, "link": "https://stackoverflow.com/questions/57582338/sort-ruby-hash-by-specific-key", "title": "sort ruby hash by specific key", "body": "<p>I have a ruby hash like this</p>\n\n<pre><code> {\"id\"=&gt;62, \"name\"=&gt;\"Wine and Spirits\"}\n {\"id\"=&gt;63, \"name\"=&gt;\"Tobacco\"}\n {\"id\"=&gt;64, \"name\"=&gt;\"Printing\"}\n {\"id\"=&gt;65, \"name\"=&gt;\"Information Services\"}\n {\"id\"=&gt;66, \"name\"=&gt;\"Business Supplies and Equipment\"}\n</code></pre>\n\n<p>How do I sort this by name? I tried </p>\n\n<pre><code> categories.sort_by {|_key, value, _key1, value1| value1}\n</code></pre>\n\n<p>But that did not work</p>\n"}, {"tags": ["ruby", "websocket", "eventmachine"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1566342829, "post_id": 57581125, "comment_id": 101624292, "body": "based on your code alone, there doesn&#39;t appear to be anything&quot;wrong&quot; with it.  Have you posted the contents of <code>ws_test.rb:36</code> ?  There are only 24 lines of code in what you&#39;ve posted."}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 3523475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000033871949/picture?type=large", "display_name": "chernish2", "link": "https://stackoverflow.com/users/3523475/chernish2"}, "is_accepted": false, "score": 0, "last_activity_date": 1566370000, "creation_date": 1566370000, "answer_id": 57585894, "question_id": 57581125, "link": "https://stackoverflow.com/questions/57581125/how-to-fix-errnoenetunreach-while-connecting-to-coinex-via-websocket/57585894#57585894", "title": "How to fix Errno::ENETUNREACH while connecting to CoinEx via websocket?", "body": "<p>Oh, it is working now, without any changes from my side. Seems like there was some problems on the server side.</p>\n"}], "owner": {"reputation": 105, "user_id": 3523475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000033871949/picture?type=large", "display_name": "chernish2", "link": "https://stackoverflow.com/users/3523475/chernish2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566370000, "creation_date": 1566332970, "question_id": 57581125, "link": "https://stackoverflow.com/questions/57581125/how-to-fix-errnoenetunreach-while-connecting-to-coinex-via-websocket", "title": "How to fix Errno::ENETUNREACH while connecting to CoinEx via websocket?", "body": "<p>I'm trying to communicate with CoinEx (cryptocurrency exchange) API via WebSocket using Ruby 2.6. I have the following code:</p>\n\n<pre><code>require 'faye/websocket'\nrequire 'eventmachine'\n\nurl = 'wss://socket.coinex.com/'\n# url = 'wss://stream.binance.com:9443/ws/ltcbtc@miniTicker'\n\nEM.run do\n  ws = Faye::WebSocket::Client.new(url)\n\n  ws.on :open do |event|\n    p [:open]\n    ...\n  end\n\n  ws.on :message do |event|\n    p [:message]\n    ...\n  end\n\n  ws.on :close do |event|\n    p [:close, event.code, event.reason]\n    ...\n  end\nend\n</code></pre>\n\n<p>When I run this code, I always see <code>[:close, 1006, \"\"]</code> immediately, without <code>[:open]</code>. I hacked deeply into gems (faye/websocket and eventmachine) and added some debug output to have better understanding of what is going on. Now my traceback is as follows:</p>\n\n<pre><code>/home/chernish2/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/faye-websocket-0.10.9/lib/faye/websocket/client.rb:87:in `unbind'\n/home/chernish2/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/eventmachine-1.2.7/lib/eventmachine.rb:1483:in `event_callback'\n/home/chernish2/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/eventmachine-1.2.7/lib/eventmachine.rb:195:in `run_machine'\n/home/chernish2/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/eventmachine-1.2.7/lib/eventmachine.rb:195:in `run'\n/home/chernish2/soft/trader2/test/ws_test.rb:36:in `&lt;main&gt;'\nemit_error(), message=Errno::ENETUNREACH\n[:close, 1006, \"\"]\n</code></pre>\n\n<p>Which really doesn't make any sense to me since another URL</p>\n\n<pre><code>url = 'wss://stream.binance.com:9443/ws/ltcbtc@miniTicker'\n</code></pre>\n\n<p>works just fine, and when I'm using <a href=\"https://github.com/altangent/ccxws\" rel=\"nofollow noreferrer\">https://github.com/altangent/ccxws</a> library (nodejs) it connects to CoinEx using exactly the same URL as in my code without any troubles which means I don't have problems connecting to CoinEx WS endpoint.\nSo what is wrong with my code? Thank you in advance!</p>\n"}, {"tags": ["ruby", "stream", "pusher"], "answers": [{"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": true, "score": 1, "last_activity_date": 1583548351, "last_edit_date": 1583548351, "creation_date": 1566336518, "answer_id": 57581742, "question_id": 57580734, "link": "https://stackoverflow.com/questions/57580734/pusher-not-able-to-establish-connection/57581742#57581742", "title": "Pusher not able to establish connection", "body": "<p>The error comes from tcpsocket.new (Ruby <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/socket/rdoc/TCPSocket.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.5.1/libdoc/socket/rdoc/TCPSocket.html</a>) in websocket line 17: <a href=\"https://github.com/pusher-community/pusher-websocket-ruby/blob/master/lib/pusher-client/websocket.rb\" rel=\"nofollow noreferrer\">https://github.com/pusher-community/pusher-websocket-ruby/blob/master/lib/pusher-client/websocket.rb</a></p>\n\n<p>ws_host tap.liquid.com 80 seems to be invalid, <a href=\"https://pusher.com/docs/channels/library_auth_reference/pusher-websockets-protocol\" rel=\"nofollow noreferrer\">https://pusher.com/docs/channels/library_auth_reference/pusher-websockets-protocol</a></p>\n\n<p>I have tried using a secure connection, at least in the browser and got a 404 for ws and invalid request, which is good in this case, for https (<a href=\"https://tap.liquid.com/\" rel=\"nofollow noreferrer\">https://tap.liquid.com/</a>).</p>\n\n<p>You need to configure ssl in the client configuration, but the pusher-client gem as well as one other I have found are pretty old. Maybe it is wise to switch to a more up-to-date library like <a href=\"https://github.com/pusher/pusher-http-ruby/blob/master/README.md\" rel=\"nofollow noreferrer\">https://github.com/pusher/pusher-http-ruby/blob/master/README.md</a></p>\n\n<p>The example contains an option for activated SSL.</p>\n"}], "owner": {"reputation": 55, "user_id": 3364046, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9a164bca32813ccf2007ac6c550963d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3364046", "link": "https://stackoverflow.com/users/3364046/user3364046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 57581742, "answer_count": 1, "score": 1, "last_activity_date": 1583548351, "creation_date": 1566330945, "last_edit_date": 1566337697, "question_id": 57580734, "link": "https://stackoverflow.com/questions/57580734/pusher-not-able-to-establish-connection", "title": "Pusher not able to establish connection", "body": "<p>I'm trying to connect to the Liquid exchange's Stream API with pusher. <a href=\"https://developers.liquid.com/?ruby#authenticated\" rel=\"nofollow noreferrer\">Documentation here</a></p>\n\n<p>I have constructed a function that is in line with the Pusher library's documentation. <a href=\"https://github.com/pusher-community/pusher-websocket-ruby#installation\" rel=\"nofollow noreferrer\">Link to that here</a>\nMy current code looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'pusher-client'\nchannels_client = PusherClient::Socket.new('LIQUID', {\n      ws_host: 'tap.liquid.com'\n  })\n</code></pre>\n\n<p>and running that gives me an error message of:</p>\n\n<blockquote>\n  <p>D, [2019-08-20Txx:xx:xx.xxxxxx #xxxxx] DEBUG -- : Binding\n  pusher:connection_established to pusher_global_channel</p>\n  \n  <p>D, [2019-08-20Txx:xx:xx.xxxxxx #xxxxx] DEBUG -- : Binding\n  pusher:connection_disconnected to pusher_global_channel</p>\n  \n  <p>D, [2019-08-20Txx:xx:xx.xxxxxx #xxxxx] DEBUG -- : Binding pusher:error\n  to pusher_global_channel</p>\n  \n  <p>D, [2019-08-20Txx:xx:xx.xxxxxx #xxxxx] DEBUG -- : Binding pusher:ping\n  to pusher_global_channel</p>\n</blockquote>\n\n<p>If I try to run this after the first command:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>channels_client.connect\n</code></pre>\n\n<p>...it refuses to connect.</p>\n\n<blockquote>\n  <p>C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/pusher-client-0.6.2/lib/pusher-client/websocket.rb:17:in\n  `initialize': No connection could be made because the target machine\n  actively refused it. - connect(2) for \"tap.liquid.com\" port 80\n  (Errno::ECONNREFUSED)</p>\n</blockquote>\n"}, {"tags": ["ruby", "irb"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1566323849, "post_id": 57579159, "comment_id": 101618211, "body": "<code>if barsofsoap &gt;= 1</code> is in fact the right way to check this. <code>match</code> would work for a String type, but your <code>barsofsoap = Integer(x)</code> ensures that you&#39;re dealing with a numeric type. Try it again!"}, {"owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "reply_to_user": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1566324283, "post_id": 57579159, "comment_id": 101618391, "body": "@Chris Heald  if barsofsoap &gt;= 1 works, but if I input a string, the program will break, I guess my problem is how to make the program not break if I put a string."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566324346, "post_id": 57579187, "comment_id": 101618422, "body": "That&#39;s works, but if I input a string, the program will break, I try to find some way that the program will not break even I put a string."}, {"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 0, "creation_date": 1566325214, "post_id": 57579187, "comment_id": 101618758, "body": "Why do you check twice here? <code>if barsofsoap &gt;= 0 &amp;&amp; barsofsoap.positive?</code>"}, {"owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566325488, "post_id": 57579187, "comment_id": 101618854, "body": "@Zach Tuttle  Thanks for your answer.  I tried this before, but if I input a decimal number, the program will think it&#39;s an integer and keep going, I don&#39;t want users to input a float."}, {"owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "reply_to_user": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566325926, "post_id": 57579187, "comment_id": 101619036, "body": "@Leslie just call the #floor method to drop the decimal all together. Please see updated example."}, {"owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566326266, "post_id": 57579187, "comment_id": 101619156, "body": "@Zach Tuttle I tried. the program will still keep going when I input a decimal number"}, {"owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "reply_to_user": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566326415, "post_id": 57579187, "comment_id": 101619215, "body": "@Leslie This is what #floor does, for example if you enter in 3.2 it then becomes 3."}, {"owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566326671, "post_id": 57579187, "comment_id": 101619319, "body": "@Zach Tuttle Thanks for your answer. but I guess I don&#39;t want the user to input decimal number, I want the system to tell users they can&#39;t input decimal number."}, {"owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "reply_to_user": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566328179, "post_id": 57579187, "comment_id": 101619890, "body": "@Leslie Okay I added an extra check to make sure that only whole numbers and entered then that is followed by another to ensure that is a non-negative number. Please see the updated example."}], "tags": [], "owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "is_accepted": false, "score": 5, "last_activity_date": 1566328088, "last_edit_date": 1566328088, "creation_date": 1566323765, "answer_id": 57579187, "question_id": 57579159, "link": "https://stackoverflow.com/questions/57579159/check-if-integer-is-positive-in-ruby/57579187#57579187", "title": "Check if integer is positive in ruby", "body": "<p>You try this: <code>num.positive?</code> </p>\n\n<p>see here: <a href=\"https://ruby-doc.org/core-2.6/Numeric.html#method-i-positive-3F\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6/Numeric.html#method-i-positive-3F</a></p>\n\n<p>Also you can try convert the text to an integer and validate by doing this:\n<code>num.is_a?(Integer)</code></p>\n\n<p><a href=\"https://ruby-doc.org/core-2.6/Object.html#method-i-is_a-3F\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6/Object.html#method-i-is_a-3F</a></p>\n\n<p>Or even better since input is always text, you can use a regex to make sure only numbers are entered: <code>\"12345\" =~ /\\A\\d+\\Z/</code></p>\n\n<p>How about try this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>loop do\n  puts \"How many soaps are you looking to purchase? (Please put an integer)\"\n\n  barsofsoap = gets.chomp\n\n  if barsofsoap.match(/^[\\d]+$/).nil?\n    puts \"You didn't put an integer, please put an integer and try again.\"\n  elsif barsofsoap.to_i.positive?\n    break\n  else\n    puts \"You didn't put an integer, please put an integer and try again.\"\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566325450, "post_id": 57579508, "comment_id": 101618838, "body": "The <code>.to_i</code> method is more idiomatic Ruby since any object which responds to <code>.to_i</code> is valid (Duck Typing) instead of forcing it down <code>Integer</code> and hoping it works out."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566326163, "post_id": 57579508, "comment_id": 101619120, "body": "@Leslie I&#39;ve updated the answer to only allow the numbers 1 through 4. See the new code block."}, {"owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "edited": false, "score": 0, "creation_date": 1566326475, "post_id": 57579508, "comment_id": 101619247, "body": "@3limin4t0r Sorry, that was a typo, I want the number to be 1 to infinity"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 6, "last_activity_date": 1611830283, "last_edit_date": 1611830283, "creation_date": 1566325257, "answer_id": 57579508, "question_id": 57579159, "link": "https://stackoverflow.com/questions/57579159/check-if-integer-is-positive-in-ruby/57579508#57579508", "title": "Check if integer is positive in ruby", "body": "<p>The reason why your current code fails is because you use <code>false</code> as rescue value. You can't compare <code>false &gt;= 1</code>. Sticking close to your original code you might wrap the comparison into a <code>begin</code>/<code>end</code> block.</p>\n<pre><code>loop do\n  puts &quot;How many soaps are you looking to purchase? (Please put an integer)&quot;\n  x = gets.chomp\n  begin\n    barsofsoap = Integer(x)\n    if barsofsoap &gt;= 1\n      break\n    end\n  rescue ArgumentError =&gt; _error\n    puts &quot;You didn't put an integer, please put an integer and try again.&quot;\n  end\nend\n</code></pre>\n<p>Or simplifying the code:</p>\n<pre><code>loop do\n  puts &quot;How many soaps are you looking to purchase? (Please put an integer)&quot;\n  break if (barsofsoap = gets.to_i).positive?\n  puts &quot;Invalid input. Provide a positive integer.&quot;\nend\n</code></pre>\n<p>The above code doesn't detect if the input is a string or an integer. By replacing <code>Integer(x)</code> with <code>x.to_i</code> it would simply return <code>0</code> if invalid. Since you want the user to provide an positive integer it still requests them to provide a new integer.</p>\n<pre><code>nil.to_i #=&gt; 0\n''.to_i #=&gt; 0\n'asdf'.to_i #=&gt; 0\n'12.34'.to_i #=&gt; 12\n</code></pre>\n<p>Like shown above the string <code>'12.34'</code> will produce the value <code>12</code>. Depending on your requirements you might not want to use this value and instead mark it as invalid input. In this case you could use a regex to check the provided input.</p>\n<pre><code>loop do\n  puts &quot;How many soaps are you looking to purchase? (Please put an integer)&quot;\n  input = gets\n  break barsofsoap = input.to_i if input.match?(/\\A[1-9]\\d*\\Z/)\n  puts &quot;Invalid input. Provide a positive integer.&quot;\nend\n</code></pre>\n<p>The regex <code>/\\A[1-9]\\d*\\Z/</code> will match the following:</p>\n<ul>\n<li><code>\\A</code> Matches start of string.</li>\n<li><code>[1-9]</code> Matches one of the digits <code>1-9</code>.</li>\n<li><code>\\d*</code> Matches zero or more digits <code>0-9</code>.</li>\n<li><code>\\Z</code> Matches end of string. If the string ends with a newline, it matches just before the newline.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566383670, "creation_date": 1566383670, "answer_id": 57589696, "question_id": 57579159, "link": "https://stackoverflow.com/questions/57579159/check-if-integer-is-positive-in-ruby/57589696#57589696", "title": "Check if integer is positive in ruby", "body": "<p>Other option, using <code>n.to_i.to_s == n</code> to check the input is an Integer and moving the loop into a method:</p>\n\n<pre><code>def get_input_integer\n  loop do\n    puts \"Enter a positive Integer\"\n    n = gets.chomp\n    if n.to_i.to_s == n\n      return n.to_i if n.to_i.positive?\n      puts \"It's not positive\"\n    else\n      puts \"It's not an integer\" \n    end\n  end\nend\n\nx = get_input_integer\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 11874898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe007eee9e21c40edfc89939985cdd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie", "link": "https://stackoverflow.com/users/11874898/leslie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4740, "favorite_count": 0, "accepted_answer_id": 57579508, "answer_count": 3, "score": 2, "last_activity_date": 1611830283, "creation_date": 1566323647, "last_edit_date": 1566326396, "question_id": 57579159, "link": "https://stackoverflow.com/questions/57579159/check-if-integer-is-positive-in-ruby", "title": "Check if integer is positive in ruby", "body": "<p>I'm trying to make users input a positive integer(>=1). If the user inputs a negative integer or 0, the program gonna notice and say you didn't put a valid integer, please try again. my program works so far until I try to input a string. My program break after I input a string. Does anybody know how to fix this?</p>\n\n<p>I tried elsif !barsofsoap.match (/\\A[-+]?[0-9]*.?[0-9]+\\Z/)\n    puts \"You didn't enter an integer, please put a positive integer\", but it didn't work</p>\n\n<pre><code>loop do\n  puts \"How many soaps are you looking to purchase? (Please put an integer)\"\n  x = gets.chomp\n  barsofsoap = Integer(x) rescue false\n\n  if barsofsoap &gt;= 1\n    break\n  else\n    puts \"You didn't put an integer, please put an integer and try again.\"\n  end\nend\n</code></pre>\n\n<p>I hope the program will not break if the user inputs a string.</p>\n"}, {"tags": ["ruby", "character-encoding"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1566320890, "post_id": 57578481, "comment_id": 101617002, "body": "Could you show us the code use to fetch that page?"}, {"owner": {"reputation": 363, "user_id": 3008512, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002492486839/picture?type=large", "display_name": "kotu b", "link": "https://stackoverflow.com/users/3008512/kotu-b"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1566321660, "post_id": 57578481, "comment_id": 101617296, "body": "Added the sample ruby snippet."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1566323378, "post_id": 57578481, "comment_id": 101618019, "body": "Try <code>puts response.body.encode(&#39;UTF-8&#39;, &#39;Shift_JIS&#39;)</code> \u2013 seems like rest client isn&#39;t able to determine the page&#39;s encoding automatically."}, {"owner": {"reputation": 363, "user_id": 3008512, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002492486839/picture?type=large", "display_name": "kotu b", "link": "https://stackoverflow.com/users/3008512/kotu-b"}, "edited": false, "score": 0, "creation_date": 1566323752, "post_id": 57578481, "comment_id": 101618174, "body": "<code>puts response.body.encode(&#39;UTF-8&#39;, &#39;Shift_JIS&#39;)</code> is working. How about other languages? like Chinese, Korean ..etc ?"}, {"owner": {"reputation": 363, "user_id": 3008512, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002492486839/picture?type=large", "display_name": "kotu b", "link": "https://stackoverflow.com/users/3008512/kotu-b"}, "edited": false, "score": 0, "creation_date": 1566323860, "post_id": 57578481, "comment_id": 101618216, "body": "The default <code>puts response.body.encoding #&lt;Encoding:ASCII-8BIT&gt;</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566324538, "post_id": 57578481, "comment_id": 101618485, "body": "What version of Ruby do you use?"}, {"owner": {"reputation": 363, "user_id": 3008512, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002492486839/picture?type=large", "display_name": "kotu b", "link": "https://stackoverflow.com/users/3008512/kotu-b"}, "edited": false, "score": 0, "creation_date": 1566325482, "post_id": 57578481, "comment_id": 101618851, "body": "<code>ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "is_accepted": false, "score": 1, "last_activity_date": 1566322835, "creation_date": 1566322835, "answer_id": 57578968, "question_id": 57578481, "link": "https://stackoverflow.com/questions/57578481/ruby-encoding-why-japanese-text-is-not-read-as-it-is-by-scraper/57578968#57578968", "title": "Ruby Encoding: Why Japanese text is not read as it is by scraper?", "body": "<p>Can you add in you <code>params_hash</code> the <code>content_type</code> attribute like below:</p>\n\n<p><code>content_type: \"text/html; charset=UTF-8\"</code></p>\n"}], "owner": {"reputation": 363, "user_id": 3008512, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002492486839/picture?type=large", "display_name": "kotu b", "link": "https://stackoverflow.com/users/3008512/kotu-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566322835, "creation_date": 1566320613, "last_edit_date": 1566321314, "question_id": 57578481, "link": "https://stackoverflow.com/questions/57578481/ruby-encoding-why-japanese-text-is-not-read-as-it-is-by-scraper", "title": "Ruby Encoding: Why Japanese text is not read as it is by scraper?", "body": "<blockquote>\n  <p>Actual HTML</p>\n</blockquote>\n\n<pre><code>&lt;HTML&gt;&lt;HEAD&gt;\n&lt;TITLE&gt;\u7d9c\u5408\u30e6\u30cb\u30b3\u30e0\u682a\u5f0f\u4f1a\u793e&lt;/TITLE&gt;\n&lt;a href=http://www.sogo-unicom.co.jp/index.html&gt;\u7d9c\u5408\u30e6\u30cb\u30b3\u30e0\u682a\u5f0f\u4f1a\u793e&lt;/a&gt;\n\n&lt;/HTML&gt;\n</code></pre>\n\n<blockquote>\n  <p>HTML received by rest-client get</p>\n</blockquote>\n\n<pre><code> &lt;HTML&gt;&lt;HEAD&gt;\n&lt;TITLE&gt;\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdj\ufffdR\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd&lt;/TITLE&gt;\n&lt;/HEAD&gt;\n&lt;a href=http://www.sogo-unicom.co.jp/index.html&gt;\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdj\ufffdR\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd&lt;/a&gt;&lt;/font&gt;&lt;/td&gt;\n&lt;/HTML&gt;\n</code></pre>\n\n<blockquote>\n  <p>Ruby code sample</p>\n</blockquote>\n\n<pre><code> require 'rest-client'\n params_hash = {\n          method: :get,\n          url: 'http://sogo-uni.com/',\n        }\n\nresponse = RestClient::Request.execute(params_hash)\nputs response.body\n</code></pre>\n\n<p>What is the reason that the scraper is not able to interpret Japanese langualge as it is?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566320154, "post_id": 57577215, "comment_id": 101616675, "body": "What have you built so far? How did you implement the filters that are already working?"}], "answers": [{"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1566331131, "last_edit_date": 1566331131, "creation_date": 1566328413, "answer_id": 57580198, "question_id": 57577215, "link": "https://stackoverflow.com/questions/57577215/ruby-on-rails-exclude-results-by-adding-a-param-to-a-url/57580198#57580198", "title": "Ruby on Rails - exclude results by adding a param to a URL", "body": "<p>I would suggest the following parameters instead:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>?active=true&amp;p=1&amp;exclude[has_a_car]=true\n</code></pre>\n\n<p>Rails knows this parameter syntax and converts it to:</p>\n\n<pre><code>{ \"active\" =&gt; \"true\", \"p\" =&gt; \"1\", \"exclude\" =&gt; { \"has_a_car\" =&gt; \"true\" } }\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7080630, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rckwt8tUOLo/AAAAAAAAAAI/AAAAAAAABqk/yqPioPpp5Wo/photo.jpg?sz=128", "display_name": "Richard Gamarra", "link": "https://stackoverflow.com/users/7080630/richard-gamarra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566331131, "creation_date": 1566315718, "question_id": 57577215, "link": "https://stackoverflow.com/questions/57577215/ruby-on-rails-exclude-results-by-adding-a-param-to-a-url", "title": "Ruby on Rails - exclude results by adding a param to a URL", "body": "<p>I need to add a parameter to this url:\n<a href=\"https://my.app/users.json?active=true&amp;p=1\" rel=\"nofollow noreferrer\">https://my.app/users.json?active=true&amp;p=1</a></p>\n\n<p>to be like this:\n<a href=\"https://my.app/users.json?active=true&amp;p=1&amp;exclude=[has_a_car=true]\" rel=\"nofollow noreferrer\">https://my.app/users.json?active=true&amp;p=1&amp;exclude=[has_a_car=true]</a></p>\n\n<p>The syntax <code>exclude=[has_a_car=true]</code> is just an example to illustrate what I need: to exclude users with the attribute <em>has_a_car</em> with value = <em>true</em>.</p>\n\n<p>This is being processed by the <code>UsersController#index</code> function in server side.</p>\n\n<p>Is there a best practice to accomplish this? Maybe a built in feature in rails?</p>\n"}, {"tags": ["ruby", "docusignapi"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "edited": false, "score": 0, "creation_date": 1566479891, "post_id": 57578287, "comment_id": 101675844, "body": "Thanks for the response.   It&#39;s not working with the token generator token either, which tells me that the token is not the problem. I also am running through the eg-01-ruby-jwt code with the exact same inputs to receive a token, even getting the PK from the same location on my system, and that token does work. The account id passed to the Envelopes API is the same. Viewing the API client from both the example code and my code, the only difference is the token.   Is there another non-token, non-account id reason that would cause a partner authentication error?"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "edited": false, "score": 0, "creation_date": 1566489505, "post_id": 57578287, "comment_id": 101681446, "body": "you are saying with token generator you&#39;re getting &quot;The specified Integrator Key was not found or is disabled. An Integrator key was not specified&quot;? the only explanation for this might be that you are using production and not demo. Make sure your api calls go to demo.docusign.net and not www.docusign.net"}, {"owner": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "edited": false, "score": 0, "creation_date": 1566490303, "post_id": 57578287, "comment_id": 101681843, "body": "I am positive that this is going to demo.docusign.net. Here is my ApiClient right before DocuSign_eSign::EnvelopesApi#create_envelope   #&lt;DocuSign_eSign::ApiClient:0x00007faf69f97778    @config=#&lt;DocuSign_eSign::Configuration:0x00007faf69f97f48      @scheme=&quot;https&quot;,      @host=&quot;demo.docusign.net&quot;,      @base_path=&quot;/restapi&quot;,      @api_key={}     . . .   &gt;,    @user_agent=&quot;Swagger-Codegen/1.0.2/ruby&quot;,    @default_headers={     &quot;Content-Type&quot;=&gt;&quot;application/json&quot;,      &quot;User-Agent&quot;=&gt;&quot;Swagger-Codegen/1.0.2/ruby&quot;,      &quot;Authorization&quot;=&gt;&quot;Bearer eyJ. . .GFg&quot;   } &gt;"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "edited": false, "score": 0, "creation_date": 1566492081, "post_id": 57578287, "comment_id": 101682629, "body": "ok, and you are using a token generated in the token generator and you are getting an error saying &quot;The specified Integrator Key was not found or is disabled. An Integrator key was not specified&quot;? you 100% sure of that?"}, {"owner": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "edited": false, "score": 0, "creation_date": 1566503765, "post_id": 57578287, "comment_id": 101687477, "body": "Golly, I am not bright today. I must have messed something up in my line-by-line walkthrough of the code, and authorization was not the issue. It was a different issue that I didn&#39;t see because I wasn&#39;t logging the complete error message. Sorry for the trouble. Thanks for helping!"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "edited": false, "score": 0, "creation_date": 1566574565, "post_id": 57578287, "comment_id": 101712117, "body": "would you mind marking this question as answered? thanks!"}], "tags": [], "owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "is_accepted": true, "score": 0, "last_activity_date": 1566319844, "creation_date": 1566319844, "answer_id": 57578287, "question_id": 57577063, "link": "https://stackoverflow.com/questions/57577063/sso-auth-flow-w-docusign-esign-gem-the-specified-integrator-key-was-not-found/57578287#57578287", "title": "SSO Auth flow w/ DocuSign_eSign gem: &quot;The specified Integrator Key was not found or is disabled.&quot;", "body": "<ol>\n<li>Try to use the token generator (<a href=\"https://developers.docusign.com/oauth-token-generator\" rel=\"nofollow noreferrer\">https://developers.docusign.com/oauth-token-generator</a>) and see if that token works for you. That would isolate the issue to obtaining the token.</li>\n<li>Make sure in the sandbox admin, you configured your IK correctly, and that you use the exact same one. </li>\n<li>You need an RSA key generated and make sure to use it for JWT. </li>\n<li>Make sure you point to account-d.docusign.com and not account.docusign.com (so you use our developer sandbox and not production)</li>\n</ol>\n"}], "owner": {"reputation": 15, "user_id": 5347209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f12e0763efb618415db152b230a3cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole C", "link": "https://stackoverflow.com/users/5347209/nicole-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 57578287, "answer_count": 1, "score": 1, "last_activity_date": 1566489736, "creation_date": 1566315217, "last_edit_date": 1566489736, "question_id": 57577063, "link": "https://stackoverflow.com/questions/57577063/sso-auth-flow-w-docusign-esign-gem-the-specified-integrator-key-was-not-found", "title": "SSO Auth flow w/ DocuSign_eSign gem: &quot;The specified Integrator Key was not found or is disabled.&quot;", "body": "<p>I am using the DocuSign_eSign ruby gem <a href=\"https://github.com/docusign/docusign-ruby-client/releases/tag/v1.0.2\" rel=\"nofollow noreferrer\">version 1.0.2</a> because version 2.0.0 does not handle JWT auth. The <a href=\"https://github.com/docusign/eg-01-ruby-jwt\" rel=\"nofollow noreferrer\">eg-01-ruby-jwt example</a> provided by DocuSign uses v1.0.2 as well, so I just pinned this version in my Gemfile.</p>\n\n<p>I am getting the following error when I attempt to make a call using the <code>DocuSign_eSign::EnvelopesApi.new#create_envelope</code> method:</p>\n\n<pre><code>docusign_esign-1.0.2/lib/docusign_esign/api_client.rb:66:in `call_api': Bad Request (DocuSign_eSign::ApiError)\n</code></pre>\n\n<p>For good measure, I walked through the code line by line to get a better idea of what was happening, and I ended up with this error:</p>\n\n<pre><code>irb(main):101:0&gt; response.code\n=&gt; 401\nirb(main):103:0&gt; response.body\n=&gt; \"{\\r\\n  \\\"errorCode\\\": \\\"PARTNER_AUTHENTICATION_FAILED\\\",\\r\\n  \\\"message\\\": \\\"The specified Integrator Key was not found or is disabled. An Integrator key was not specified.\\\"\\r\\n}\"\nirb(main):104:0&gt; response.status_message\n=&gt; \"Unauthorized\"\n</code></pre>\n\n<p>Here is the ruby code (minus logging/error handling) from my DocuSignWebClient where I trigger the call (<code>send_envelope</code>). This is where the auth happens:</p>\n\n<pre><code>TOKEN_REPLACEMENT_IN_SECONDS = 10.minutes.seconds\nTOKEN_EXPIRATION_IN_SECONDS = 1.hour.seconds\n\ndef initialize(options = {})\n  @docusign_config = Padrino.config.docusign\n  @api_client = DocuSignWebClient.setup_api_client\n  @s3_client = options[:s3_client] || Aws::S3::Client.new(region: Padrino.config.aws.region)\n  @token_expire_in = options[:token_expire_in] || 0\n  @account_id = options[:account_id]\nend\n\ndef self.setup_api_client\n  configuration = DocuSign_eSign::Configuration.new\n  DocuSign_eSign::ApiClient.new(configuration)\nend\n\ndef send_envelope(details)\n  authorize\n\n  envelope = DocuSign::EnvelopeBuilder.new(details, @s3_client).build_envelope\n  sender = DocuSign::EnvelopeSender.new(@api_client, @account_id)\n  response = sender.send_envelope(envelope)\n  update_document_status(details, response)\nend\n\ndef authorize\n  check_token\n  @account_id ||= update_account_id\nend\n\ndef check_token\n  if no_token? || token_near_expiration?\n    update_token\n  end\nend\n\ndef no_token?\n  !@api_client.default_headers['Authorization']\nend\n\ndef token_near_expiration?\n  now = Time.now.to_f\n  (now + TOKEN_REPLACEMENT_IN_SECONDS) &gt; @token_expire_in\nend\n\ndef update_token\n  configure_jwt_authorization_flow\n  @token_expire_in = Time.now.to_f + TOKEN_EXPIRATION_IN_SECONDS\nend\n\ndef configure_jwt_authorization_flow\n  @api_client.configure_jwt_authorization_flow(@docusign_config[:private_key_file],\n                                               @docusign_config[:auth_server],\n                                               @docusign_config[:integrator_key],\n                                               @docusign_config[:user_id],\n                                               TOKEN_EXPIRATION_IN_SECONDS)\nend\n\ndef update_account_id\n  account = fetch_account_info\n  @api_client.config.host = account[:base_uri]\n  account[:account_id]\nend\n\ndef fetch_account_info\n  response = DocuSignResponse.new(@api_client.call_api('GET', \"https://#{@docusign_config[:auth_server]}/oauth/userinfo\", return_type: 'Object'))\n\n  if response.ok?\n    response.data[:accounts].detect { |acct| acct[:is_default] }\n  end\nend\n</code></pre>\n\n<p>I <em>am</em> getting a token back from DocuSign after I go through the authorization flow, but it says that the token is not valid once I try to use it.</p>\n\n<pre><code>irb(main):033:0&gt; account_id = client.authorize\n=&gt; \"386...a24\"\nirb(main):036:0&gt; client.api_client\n=&gt; #&lt;DocuSign_eSign::ApiClient:0x00007ff6d243c8c8 @config=#&lt;DocuSign_eSign::Configuration:0x00007ff6d243d2f0 @scheme=\"https\", @host=\"demo.docusign.net\", @base_path=\"/restapi\", @api_key={}, @api_key_prefix={}, @timeout=0, @verify_ssl=true, @verify_ssl_host=true, @params_encoding=nil, @cert_file=nil, @key_file=nil, @debugging=false, @inject_format=false, @force_ending_format=false, @logger=#&lt;Logger:0x00007ff6d243d110 @level=0, @progname=nil, @default_formatter=#&lt;Logger::Formatter:0x00007ff6d243d098 @datetime_format=nil&gt;, @formatter=nil, @logdev=#&lt;Logger::LogDevice:0x00007ff6d243cfa8 @shift_period_suffix=nil, @shift_size=nil, @shift_age=nil, @filename=nil, @dev=#&lt;IO:&lt;STDOUT&gt;&gt;, @mon_mutex=#&lt;Thread::Mutex:0x00007ff6d243c8f0&gt;, @mon_mutex_owner_object_id=70349033170900, @mon_owner=nil, @mon_count=0&gt;&gt;&gt;, @user_agent=\"Swagger-Codegen/1.0.2/ruby\", @default_headers={\"Content-Type\"=&gt;\"application/json\", \"User-Agent\"=&gt;\"Swagger-Codegen/1.0.2/ruby\", \"Authorization\"=&gt;\"Bearer eyJ0eXAiOiJNVCIsImFsZyI6IlJTMjU2Iiwia2lkIjoiNjgxODVmZjEtNGU1MS00Y2U5LWFmMWMtNjg5ODEyMjAzMzE3In0.AQkAAAABAAUABwAACzCudSXXSAgAAHP0D34l10gCABIJ3tlGgoJMvWi9_zzeFocVAAEAAAAYAAEAAAAFAAAADQAkAAAAZTVjOTIwMTItMWI0ZC00ZTgzLTgzNjYtNjgzNDQ0NjQyNjc0IwAkAAAAZTVjOTIwMTItMWI0ZC00ZTgzLTgzNjYtNjgzNDQ0NjQyNjc0EgABAAAABgAAAGp3dF9icg.yt_0QtjwAcL1dosfVuaNoKoM3Yzq9DK4MUf6lx3Sp5EYy0OdeSaKt6TgsAujUNQQoQH4e_IZFGtVXxBjFXzP2hh9EB2nsdwKAzi5EZJcOIp1wEfzKjEllUnOXOkEoUwcmHHCSN1j4LfNF8olRTDJnaSDB9A5TbumLURC_-FkttxHitFVpt39Fvl85VtSlIsQxU544SRjeJGJMl_BDwRmu0JrUSawc5LSUF9ET9SVTBGEjS_vZMz92hdiFM2x4qZqupeSXLrQ92bhzjEXHOH7kmKbE-iKDTH_TOln0rhhqLXq25yOTBJ_yUWqhvYaxpct9GRuPo6IIZCDDv0Of7k-xQ\"}&gt;\n</code></pre>\n\n<p>Does anything in that API instance look wrong? I can't figure out why my token is not working.</p>\n\n<p>UPDATE: I re-attempted the same flow with a token using the <a href=\"https://developers.docusign.com/oauth-token-generator\" rel=\"nofollow noreferrer\">OAuth Token Generator</a> and that token also fails with the same error. Additionaly, I am able to send a token using the eg-01-ruby-jwt example code with the SAME EXACT inputs when calling DocuSign_eSign::ApiClient#configure_jwt_authorization_flow. The Envelopes API takes the API client and the account ID, which are identical upon inspection between the example code and my code (besides the auth token).</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "list", "view"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1566315293, "post_id": 57576974, "comment_id": 101614353, "body": "Nowhere in the code you show do you create a <code>GymList</code>. Where do you create your <code>GymList</code> records? If you think you are trying to access the values returned by <code>gym_names</code> and/or <code>gym_locations</code>, then you are going about it all wrong."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 9559266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CuDynlDo9CA/AAAAAAAAAAI/AAAAAAAABzQ/-Pj97ngfbvg/photo.jpg?sz=128", "display_name": "Hisham Magdy", "link": "https://stackoverflow.com/users/9559266/hisham-magdy"}, "reply_to_user": {"reputation": 11, "user_id": 11777969, "user_type": "registered", "profile_image": "https://graph.facebook.com/2262520663806715/picture?type=large", "display_name": "Igor Rudenko", "link": "https://stackoverflow.com/users/11777969/igor-rudenko"}, "edited": false, "score": 0, "creation_date": 1566316306, "post_id": 57577146, "comment_id": 101614921, "body": "I think that tutorial will help you a lot <a href=\"https://guides.rubyonrails.org/active_record_basics.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_record_basics.html</a>"}], "tags": [], "owner": {"reputation": 119, "user_id": 9559266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CuDynlDo9CA/AAAAAAAAAAI/AAAAAAAABzQ/-Pj97ngfbvg/photo.jpg?sz=128", "display_name": "Hisham Magdy", "link": "https://stackoverflow.com/users/9559266/hisham-magdy"}, "is_accepted": false, "score": 0, "last_activity_date": 1566315463, "creation_date": 1566315463, "answer_id": 57577146, "question_id": 57576974, "link": "https://stackoverflow.com/questions/57576974/why-my-list-shows-as-an-empty-in-app-if-its-contain-information-in-it/57577146#57577146", "title": "Why my list shows as an empty in app, if it&#39;s contain information in it?", "body": "<p><code>@gym_lists = GymList.all</code> gets all GymList records from the databse </p>\n\n<ul>\n<li>you should use something like\nController </li>\n</ul>\n\n<pre><code>    class GymListsController &lt; ApplicationController\n\n      def index\n        @gym_list = GymList.new\n        @gym_lists_name = gym_list.gym_names\n        @gym_locations = gym_list.gym_locations  \n      end\n    end\n\n</code></pre>\n\n<p>and loop through these two lists in the view and print it\n<strong>second solution</strong></p>\n\n<ul>\n<li>add these lists to the database then you can use <code>@gym_lists = GymList.all</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "is_accepted": false, "score": 0, "last_activity_date": 1566320931, "last_edit_date": 1566320931, "creation_date": 1566316692, "answer_id": 57577497, "question_id": 57576974, "link": "https://stackoverflow.com/questions/57576974/why-my-list-shows-as-an-empty-in-app-if-its-contain-information-in-it/57577497#57577497", "title": "Why my list shows as an empty in app, if it&#39;s contain information in it?", "body": "<p>Ok, there are many things wrong in your code. You should probably read some documentation about CRUD <a href=\"https://medium.com/@nancydo7/ruby-on-rails-crud-tutorial-899117710c7a\" rel=\"nofollow noreferrer\">this medium post should be a good start</a>.</p>\n\n<p>But..regarding your given informations I would like to help you.</p>\n\n<ul>\n<li>Remove your methods inside your <code>GymList</code> model and replace them by:</li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>NAMES = [\"Blink Fitness\", \"24 Hour Fitness\", \"Peloton Studio\", \"Simply Fit\", \"Equinox\", \"Harbor Fitness\"]\nLOCATIONS = [\"1172 5th Ave, Brooklyn\", \"1556 96 Ave, Brooklyn\", \"356 Lockey St, New York\", \"421 Hudson St, New York\", \"111 Cortney St, New York\", \"37-20 Astoria Blvd, Queens\"]\n</code></pre>\n\n<ul>\n<li>An update your controler with:</li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def index\n  @gym_lists = GymList::NAMES.zip(GymList::LOCATIONS)\nend\n</code></pre>\n\n<p><code>zip</code> is going to create an array of array like that: <code>[[\"Blink Fitness\", \"1172 5th Ave, Brooklyn\"], [\"24 Hour Fitness\", \"1556 96 Ave, Brooklyn\"], ...]</code> <a href=\"https://apidock.com/ruby/Array/zip\" rel=\"nofollow noreferrer\">doc here</a></p>\n\n<ul>\n<li>And update your view with the following code:</li>\n</ul>\n\n<p><strong>edited answer after the Aleksei Matiushkin's comment</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;% @gym_lists.each do |name, location|%&gt;\n  &lt;h2&gt;&lt;%= name %&gt;&lt;/h2&gt;\n  &lt;h2&gt;&lt;%= location %&gt;&lt;/h2&gt;\n  &lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But seriously, think about create a model <code>GymClub</code> with a <code>name</code> and a <code>location</code> attributes, and populate your <code>db</code> through a <code>seed.rb</code></p>\n"}], "owner": {"reputation": 11, "user_id": 11777969, "user_type": "registered", "profile_image": "https://graph.facebook.com/2262520663806715/picture?type=large", "display_name": "Igor Rudenko", "link": "https://stackoverflow.com/users/11777969/igor-rudenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1566320931, "creation_date": 1566314917, "question_id": 57576974, "link": "https://stackoverflow.com/questions/57576974/why-my-list-shows-as-an-empty-in-app-if-its-contain-information-in-it", "title": "Why my list shows as an empty in app, if it&#39;s contain information in it?", "body": "<p>Can not display the list in my app.\nApp accepts array-like empty, but I have info on it and I need to show it. Can you check Ruby people</p>\n\n<p>Controller</p>\n\n<pre><code>class GymListsController &lt; ApplicationController\n\n  def index\n    @gym_lists = GymList.all\n  end\n\nend\n</code></pre>\n\n<p>Model (this list should be available, but it's not)</p>\n\n<pre><code>class GymList &lt; ApplicationRecord\n\n  has_many :users, through: :schedules\n\n  def gym_names\n      [\"Blink Fitness\",\n      \"24 Hour Fitness\",\n      \"Peloton Studio\",\n      \"Simply Fit\",\n      \"Equinox\",\n      \"Harbor Fitness\"]\n  end\n\n  def gym_locations\n      [\"1172 5th Ave, Brooklyn\",\n      \"1556 96 Ave, Brooklyn\",\n      \"356 Lockey St, New York\",\n      \"421 Hudson St, New York\",\n      \"111 Cortney St, New York\",\n      \"37-20 Astoria Blvd, Queens\"]\n  end\n\nend\n\n</code></pre>\n\n<p>View</p>\n\n<pre><code>&lt;h2&gt;Yours GYM&lt;/h2&gt;\n&lt;br&gt;\n&lt;div&gt;\n&lt;% @gym_lists.each do |gym|%&gt;\n  &lt;h2&gt;&lt;%= gym.name %&gt;&lt;/h2&gt;\n  &lt;h2&gt;&lt;%= gym.location %&gt;&lt;/h2&gt;\n  &lt;br&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n</code></pre>\n\n<p>and it shows an empty page.</p>\n\n<p>ruby on rails</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566314071, "post_id": 57576632, "comment_id": 101613606, "body": "Use <code>bin</code> everywhere. <code>exe</code> is produced by a weird bundler template."}], "owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566313757, "creation_date": 1566313757, "question_id": 57576632, "link": "https://stackoverflow.com/questions/57576632/difference-between-bin-and-exe-when-creating-a-gem", "title": "Difference between bin and exe when creating a gem", "body": "<p>I'm creating a gem for the first time and I'm a bit confused by the <code>bin/</code> and <code>exe/</code> directories.\nI've added an executable to <code>spec.executables</code> with:</p>\n\n<pre><code>spec.bindir        = \"exe\"\nspec.executables   = spec.files.grep(%r{^exe/}) { |f| File.basename(f) }\n</code></pre>\n\n<p>but when I <code>gem build</code> it it asks me for a \"binary\" in both <code>bin/</code> and <code>exe/</code> and I'm very confused because I can't really understand the difference between the 2.\nI solved the problem by copying the executable in <code>bin/</code> into <code>exe/</code> and everything works, but looks somewhat weird and suboptimal.\nCan anybody explain?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "watir"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1566312941, "post_id": 57575901, "comment_id": 101612965, "body": "From your question, it appears that your <code>browser.execute_script</code> line is inserting <code>files</code> or <code>comments</code>. And that your problem is setting <code>files</code> or <code>comments</code> correctly in your iteration. Is that correct? If so, I think it would be helpful if you could add a very small example of the text you are trying to work with to your question (using the <code>edit</code> button below the tags)."}, {"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1566314848, "post_id": 57575901, "comment_id": 101614075, "body": "@jvillian Ok i just editet my question , so the problem is that i cant add for example the first text in comment field on youtube with id &#39;contenteditable-root&#39; . In first example that does work but it shows in this case [&#39;Hellooo !!&#39;] instead of just Hellooo !! without brackets"}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1566315354, "post_id": 57576960, "comment_id": 101614403, "body": "I have tried this to but it does nothing .. Runtime.evaluate threw exception: SyntaxError: Invalid or unexpected token (Selenium::WebDriver::Error::UnknownError)"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1566316551, "post_id": 57576960, "comment_id": 101615048, "body": "Confused because you said that you had that part working: <i>&quot;but the text that is been added on the youtube comment field show in brackets for example [&quot;Hello&quot;]&quot;</i>"}, {"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1566318921, "post_id": 57576960, "comment_id": 101616172, "body": "yes but i want to show it without brackets .. the method you showed me doesnt work either"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 0, "creation_date": 1566413259, "post_id": 57576960, "comment_id": 101652277, "body": "Heh, so no syntax error after all ;)  And no, my code doesn&#39;t add brackets, see: <a href=\"https://repl.it/repls/DeadUnhealthyCharmap\" rel=\"nofollow noreferrer\">repl.it/repls/DeadUnhealthyCharmap</a>"}], "tags": [], "owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "is_accepted": false, "score": 1, "last_activity_date": 1566314872, "creation_date": 1566314872, "answer_id": 57576960, "question_id": 57575901, "link": "https://stackoverflow.com/questions/57575901/add-a-specific-line-from-a-document-txt-to-a-comment-field-with-specific-id-and/57576960#57576960", "title": "Add a specific line from a document.txt to a comment field with specific id and then move to next line?", "body": "<p>Assuming a whole bunch of other things here are correct, you're doing a very weird iteration, you should just use:</p>\n\n<pre><code>file = 'comments.txt'\nFile.readlines(file).each do |i|\n  browser.execute_script(\"document.getElementById('contenteditable-root').innerHTML = '#{i}';\")\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1106, "user_id": 782713, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20b309cdcea1aa280b617c318af99274?s=128&d=identicon&r=PG", "display_name": "Gijs Paulides", "link": "https://stackoverflow.com/users/782713/gijs-paulides"}, "is_accepted": false, "score": 1, "last_activity_date": 1566333367, "creation_date": 1566333367, "answer_id": 57581198, "question_id": 57575901, "link": "https://stackoverflow.com/questions/57575901/add-a-specific-line-from-a-document-txt-to-a-comment-field-with-specific-id-and/57581198#57581198", "title": "Add a specific line from a document.txt to a comment field with specific id and then move to next line?", "body": "<p>Seems to me like you need to learn how to debug.</p>\n\n<p><strong>Step 1:</strong> Check in <code>irb</code> (<a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-irb-to-explore-ruby\" rel=\"nofollow noreferrer\">about irb</a>) if your code is printing the correct text:</p>\n\n<pre><code>File.readlines('comments.txt').each do |line|\n  p line\nend\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>=&gt; \"Line 1\"\n=&gt; \"Line 2\"\n=&gt; \"Line 3\"\n</code></pre>\n\n<p>If not, then look up <a href=\"https://stackoverflow.com/a/11974989/782713\">how to read a file per line</a>.</p>\n\n<p><strong>Step 2:</strong> Does your piece of Javascript actually work?</p>\n\n<p>Go to the page you're trying to test, Open the debugger (F12) and run your Javascript directly from the console:</p>\n\n<pre><code>document.getElementById('contenteditable-root').innerHTML = 'hi';\n</code></pre>\n\n<p>If it doesn't work, then try learning more abut Javascript on how it works interacting with elements.</p>\n\n<p><strong>Step 3:</strong> Does my piece of code actually work from Watir?</p>\n\n<p>Open up <code>irb</code> again and try it out</p>\n\n<pre><code>require 'watir'\nb = Watir::Browser.new\nb.goto 'https://youryoutubepage.com/path'\nb.execute_script(\"document.getElementById('contenteditable-root').innerHTML = 'hi';\")\n</code></pre>\n\n<p>If it fails, google the error, look for Watir and execute_script.</p>\n\n<p>Then finally run the whole combination of your code in <code>irb</code>:</p>\n\n<pre><code>require 'watir'\nb = Watir::Browser.new\nb.goto 'https://youryoutubepage.com/path'\nFile.readlines('comments.txt').each do |line|\n  b.execute_script(\"document.getElementById('contenteditable-root').innerHTML = 'hi';\")\n  sleep 5 # Give yourself some time to visually confirm the changes.\nend\n</code></pre>\n\n<p>A quick Google about your <code>SyntaxError: Invalid or unexpected token (Selenium::WebDriver::Error::UnknownError)</code> I see it might be a problem with the quotations that <code>execute_script</code> doesn't like.</p>\n\n<p>Maybe try reversing the quotes:</p>\n\n<pre><code>b.execute_script('document.getElementById(\"contenteditable-root\").innerHTML = \"hi\";')\n</code></pre>\n\n<p>In the future, please try to pinpoint your problem and don't use StackOverflow as a place to debug your code. Get your code to work step by step and focus your question on a specific function that's not working as expected.</p>\n"}], "owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1568740467, "creation_date": 1566311329, "last_edit_date": 1568740467, "question_id": 57575901, "link": "https://stackoverflow.com/questions/57575901/add-a-specific-line-from-a-document-txt-to-a-comment-field-with-specific-id-and", "title": "Add a specific line from a document.txt to a comment field with specific id and then move to next line?", "body": "<p>How can I add a specific line from my document.txt to YouTube comment field with specific id and then move to next line on my document.txt. The id of YouTube comment field is 'contenteditable-root'. I have created this code but the text that is been added on the YouTube comment field show in brackets for example [\"Hello\"]</p>\n\n<p>Or in second example it shows nothing</p>\n\n<p><strong>Example 1:</strong></p>\n\n<pre><code>file = 'comments.txt'\nFile.readlines(file).each do |i|\n            files = [i]\n            files.each { |val| \n\nbrowser.execute_script(\"document.getElementById('contenteditable-root').innerHTML = '#{files}';\")\n\n}\nend\n</code></pre>\n\n<p><strong>Example 2:</strong></p>\n\n<pre><code>line_number = 1 \nloop do\ncomments = IO.readlines('comments.txt')[line_number-1]\nbrowser.execute_script(\"document.getElementById('contenteditable-root').innerHTML = '#{comments}';\")\nline_number += 1 \nend\n</code></pre>\n\n<p><strong>comment.txt file:</strong></p>\n\n<pre><code>Hellooo !!\nhi\nGoodbye \nGoodnight \n</code></pre>\n"}, {"tags": ["ruby", "sockets", "server", "udp"], "answers": [{"comments": [{"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566311829, "post_id": 57575934, "comment_id": 101612257, "body": "This only halts if the server receives a UDP packet, correct?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566311933, "post_id": 57575934, "comment_id": 101612324, "body": "Correct. The block gets executed on the new messages only."}, {"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566312189, "post_id": 57575934, "comment_id": 101612494, "body": "I&#39;d rather want to stop it from inside the application without sending UDP packets."}, {"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566313987, "post_id": 57575934, "comment_id": 101613556, "body": "I don&#39;t know how long <code>handle_incoming_message</code> takes. The thing I am searching for is semantically like: &quot;kill the thread as soon as no message is being processed anymore&quot;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566314134, "post_id": 57575934, "comment_id": 101613648, "body": "Eh. How do you know there would not be any message anymore? That\u2019s not how sockets work."}, {"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566314251, "post_id": 57575934, "comment_id": 101613715, "body": "Maybe I indeed have a misunderstanding here. I thought that this would be the case as soon as <code>IO#select</code> blocks."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566319315, "post_id": 57575934, "comment_id": 101616349, "body": "Imagine the client that sends UDP packets once per a second. <code>IO#select</code> blocks for a second every second. Should we terminate?"}, {"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566325889, "post_id": 57575934, "comment_id": 101619023, "body": "Yes, as soon as processing of the last package is complete."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1566325950, "post_id": 57575934, "comment_id": 101619045, "body": "There is no <i>last</i> package."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1566311429, "creation_date": 1566311429, "answer_id": 57575934, "question_id": 57575662, "link": "https://stackoverflow.com/questions/57575662/how-to-stop-a-udp-server-loop-from-the-outside/57575934#57575934", "title": "How to stop a udp_server_loop from the outside", "body": "<p>Although I doubt I understand what would be wrong with <a href=\"https://ruby-doc.org/core-2.6.3/Thread.html#class-Thread-label-Thread+termination\" rel=\"nofollow noreferrer\"><code>Thread::kill</code></a> and/or <code>Thread#exit</code>, you might use the thread local variable for that.</p>\n\n<pre><code>def listen\n  Socket.udp_server_loop(@port) do |message, message_source|\n    break :interrupted if Thread.current[:break]\n    handle_incoming_message(message)\n  end\nend\n</code></pre>\n\n<p>and do</p>\n\n<pre><code>thread[:break] = true\n</code></pre>\n\n<p>from the outside.</p>\n"}, {"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1566341406, "creation_date": 1566341406, "answer_id": 57582432, "question_id": 57575662, "link": "https://stackoverflow.com/questions/57575662/how-to-stop-a-udp-server-loop-from-the-outside/57582432#57582432", "title": "How to stop a udp_server_loop from the outside", "body": "<p>I don\u2019t think you can do this with <code>udp_server_loop</code> (although you might be able to use some of the methods it uses). You are going to have to call <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-select\" rel=\"nofollow noreferrer\"><code>IO::select</code></a> in a loop of your own with some way of signalling it to exit, and some way of waking the thread so you don\u2019t have to send a packet to stop it.</p>\n\n<p>A simple way would be to use the timeout option to <code>select</code> with a variable to set to indicate you want the thread to end, something like:</p>\n\n<pre><code>@halt_loop = false\n\ndef listen\n  puts \"Started UDP server on #{@port}...\"\n  sockets = Socket.udp_server_sockets(@port)\n\n  loop do\n    readable, _, _ = IO.select(sockets, nil, nil, 1) # timeout 1 sec\n    break if @halt_loop\n    next unless readable # select returns nil on timeout\n\n    Socket.udp_server_recv(readable) do |message, message_source|\n      puts \"Got \\\"#{message}\\\" from #{message_source}\"\n\n      handle_incoming_message(message)\n    end\n  end\nend\n</code></pre>\n\n<p>You then set <code>@halt_loop</code> to true when you want to stop the thread.</p>\n\n<p>The downside to this is that it is effectively polling. If you decrease the timeout then you potentially do more work on an empty loop, and if you increase it you have to wait longer when stopping the thread.</p>\n\n<p>Another, slightly more complex solution would be to use a <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-pipe\" rel=\"nofollow noreferrer\"><code>pipe</code></a> and have the select listen on it along with the sockets. You could then signal directly to finish the <code>select</code> and exit the thread.</p>\n\n<pre><code>@read, @write = IO.pipe\n@halt_loop = false\n\ndef listen\n  puts \"Started UDP server on #{@port}...\"\n  sockets = Socket.udp_server_sockets(@port)\n  sockets &lt;&lt; @read\n\n  loop do\n    readable, _, _ = IO.select(sockets)\n    break if @halt_loop\n\n    readable.delete @read\n\n    Socket.udp_server_recv(readable) do |message, message_source|\n      puts \"Got \\\"#{message}\\\" from #{message_source}\"\n\n      handle_incoming_message(message)\n    end\n  end\nend\n\ndef end_loop\n  @halt_loop = true\n  @write.puts \"STOP!\"\nend\n</code></pre>\n\n<p>To exit the thread you just call <code>end_loop</code> which sets the <code>@halt_loop</code> flag then writes to the pipe, making the other end readable and causing the other thread to return from <code>select</code>.</p>\n\n<p>You could have this code check the readable <code>IO</code>s and exit if one of them is the read end of the pipe instead of using the variable, but at least on Linux there is a potential bug where a call to select might return a file descriptor as readable when it actuallt isn\u2019t. I don\u2019t know if Ruby deals with this, so better safe than sorry.</p>\n\n<p>Also be sure to remove the pipe from the <code>readable</code> array before passing it to <code>udp_server_recv</code>. It\u2019s not a socket so will cause an exception if you don\u2019t.</p>\n\n<p>A downside to this technique is that pipes are \u201c[n]ot available on all platforms\".</p>\n"}], "owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566375600, "creation_date": 1566310552, "last_edit_date": 1566375600, "question_id": 57575662, "link": "https://stackoverflow.com/questions/57575662/how-to-stop-a-udp-server-loop-from-the-outside", "title": "How to stop a udp_server_loop from the outside", "body": "<p>I've written little UDP server in Ruby:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def listen\n  puts \"Started UDP server on #{@port}...\"\n\n  Socket.udp_server_loop(@port) do |message, message_source|\n    puts \"Got \\\"#{message}\\\" from #{message_source}\"\n\n    handle_incoming_message(message)\n  end\nend\n</code></pre>\n\n<p>I start it in a separate thread:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>thread = Thread.new { listen }\n</code></pre>\n\n<p>Is there a way to gracefully stop the <code>udp_server_loop</code> from outside the thread without just killing it (<code>thread.kill</code>)? I also dont't want to stop it from the inside by receiving any UDP message. Is <code>udp_server_loop</code> maybe not the right tool for me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1566320517, "last_edit_date": 1566320517, "creation_date": 1566310013, "answer_id": 57575505, "question_id": 57575370, "link": "https://stackoverflow.com/questions/57575370/persist-hash-to-corresponding-db-table/57575505#57575505", "title": "Persist hash to corresponding db-table", "body": "<p>This can easily be done as below,</p>\n\n<pre><code>my_hash.each { |k,v| Model.create(color: k, count: v) }\n</code></pre>\n"}], "owner": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 57575505, "answer_count": 1, "score": 0, "last_activity_date": 1566320517, "creation_date": 1566309585, "last_edit_date": 1566314387, "question_id": 57575370, "link": "https://stackoverflow.com/questions/57575370/persist-hash-to-corresponding-db-table", "title": "Persist hash to corresponding db-table", "body": "<p>I have a hash:</p>\n\n<pre><code>my_hash = {\n  blue: 2,\n  red: 3,\n  purple: 4,\n}\n</code></pre>\n\n<p>I have a Model with corresponding db-table:</p>\n\n<pre><code> ____________________\n| id | color | count |\n----------------------\n|    |       |       |\n----------------------\n</code></pre>\n\n<p>I want to put my hash in the table like this:</p>\n\n<pre><code> ____________________\n| id | color | count |\n----------------------\n|  1 | blue  |   2   |\n|  2 | red   |   3   |\n|  3 | purple|   4   |\n----------------------\n</code></pre>\n\n<p>So my question is, How can I write code that persists the hash to the corresponding db-table?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1566311363, "post_id": 57574973, "comment_id": 101611988, "body": "Not sure why people are downvoting, but thanks for coming back and answering"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1566317712, "post_id": 57574973, "comment_id": 101615588, "body": "Probably, You have merged instead of inspecting file changes on upgrade!"}, {"owner": {"reputation": 341, "user_id": 11951659, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8v_mdOz9Sg/AAAAAAAAAAI/AAAAAAAAAAc/7AjAmlL0_wY/photo.jpg?sz=128", "display_name": "Daniel Pogosyan", "link": "https://stackoverflow.com/users/11951659/daniel-pogosyan"}, "edited": false, "score": 0, "creation_date": 1566320669, "post_id": 57574973, "comment_id": 101616890, "body": "Yes, but I inspected only those files that I changed before upgrading."}], "tags": [], "owner": {"reputation": 341, "user_id": 11951659, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8v_mdOz9Sg/AAAAAAAAAAI/AAAAAAAAAAc/7AjAmlL0_wY/photo.jpg?sz=128", "display_name": "Daniel Pogosyan", "link": "https://stackoverflow.com/users/11951659/daniel-pogosyan"}, "is_accepted": true, "score": 11, "last_activity_date": 1566308198, "creation_date": 1566308198, "answer_id": 57574973, "question_id": 57574694, "link": "https://stackoverflow.com/questions/57574694/why-does-the-heroku-rails-app-crash-after-upgrading-rails-to-6-0-0/57574973#57574973", "title": "Why does the Heroku Rails App crash after upgrading Rails to 6.0.0?", "body": "<p>Ok, I solved the problem by removing the line <code>pidfile ENV.fetch(\"PIDFILE\") { \"tmp/pids/server.pid\" }</code> from the <code>config/puma.rb</code> that was added during the rails upgrade :)</p>\n"}, {"tags": [], "owner": {"reputation": 802, "user_id": 39077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2a8e845ddc4edc45af3933b421ca7a?s=128&d=identicon&r=PG", "display_name": "PJ Davis", "link": "https://stackoverflow.com/users/39077/pj-davis"}, "is_accepted": false, "score": 1, "last_activity_date": 1566363253, "creation_date": 1566363253, "answer_id": 57584635, "question_id": 57574694, "link": "https://stackoverflow.com/questions/57574694/why-does-the-heroku-rails-app-crash-after-upgrading-rails-to-6-0-0/57584635#57584635", "title": "Why does the Heroku Rails App crash after upgrading Rails to 6.0.0?", "body": "<p>You can add the <code>tmp/pids</code> folder to version control using a <code>.keep</code> file. This puts the folder in version control, so when it gets cloned to Heroku, the folder is there. </p>\n\n<p>You will also probably have to edit your .gitignore file so it doesn't ignore the <code>tmp/pids</code> directory.</p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 9136318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba32997bd40a5a809cab469bb731d16?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/9136318/rahul"}, "edited": false, "score": 0, "creation_date": 1608199988, "post_id": 59534466, "comment_id": 115512339, "body": "didn&#39;t work... pids folder is not pushed to heroku got error-&gt; launcher.rb:244:in `write&#39;: No such file or directory @ rb_sysopen - tmp/pids/server.pid (Errno::ENOENT)"}], "tags": [], "owner": {"reputation": 3960, "user_id": 326111, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/359024e7132672aaeef4a3e792be4ae5?s=128&d=identicon&r=PG", "display_name": "bswinnerton", "link": "https://stackoverflow.com/users/326111/bswinnerton"}, "is_accepted": false, "score": 8, "last_activity_date": 1577726074, "creation_date": 1577726074, "answer_id": 59534466, "question_id": 57574694, "link": "https://stackoverflow.com/questions/57574694/why-does-the-heroku-rails-app-crash-after-upgrading-rails-to-6-0-0/59534466#59534466", "title": "Why does the Heroku Rails App crash after upgrading Rails to 6.0.0?", "body": "<p>You'll need to modify your <code>.gitignore</code> file to explicitly let through the <code>tmp/pids</code> directory with a <code>.keep</code> file. Ensure your <code>.gitignore</code> looks like this:</p>\n\n<pre><code>/tmp/*\n/tmp/pids/*\n!/tmp/.keep\n!/tmp/pids\n!/tmp/pids/.keep\n</code></pre>\n\n<p>And then <code>touch tmp/pids/.keep</code>.</p>\n"}], "owner": {"reputation": 341, "user_id": 11951659, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8v_mdOz9Sg/AAAAAAAAAAI/AAAAAAAAAAc/7AjAmlL0_wY/photo.jpg?sz=128", "display_name": "Daniel Pogosyan", "link": "https://stackoverflow.com/users/11951659/daniel-pogosyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1780, "favorite_count": 1, "accepted_answer_id": 57574973, "answer_count": 3, "score": 4, "last_activity_date": 1577726074, "creation_date": 1566307304, "last_edit_date": 1566310495, "question_id": 57574694, "link": "https://stackoverflow.com/questions/57574694/why-does-the-heroku-rails-app-crash-after-upgrading-rails-to-6-0-0", "title": "Why does the Heroku Rails App crash after upgrading Rails to 6.0.0?", "body": "<p>I have an application that I successfully uploaded to Heroku and everything worked fine. After updating with the <code>rails app:update</code> command from version 6.0.0rc1 to 6.0.0, I deployed the application to heroku and after that the Heroku is crashed when the server launch.</p>\n\n<pre><code>2019-08-20T12:45:56.047319+00:00 heroku[web.1]: State changed from crashed to starting\n2019-08-20T12:46:01.995009+00:00 heroku[web.1]: Starting process with command `bundle exec puma -t 5:5 -p ${PORT:-3000} -e ${RACK_ENV:-development}`\n2019-08-20T12:46:04.051365+00:00 app[web.1]: Puma starting in single mode...\n2019-08-20T12:46:04.051387+00:00 app[web.1]: * Version 3.12.1 (ruby 2.6.1-p33), codename: Llamas in Pajamas\n2019-08-20T12:46:04.051389+00:00 app[web.1]: * Min threads: 5, max threads: 5\n2019-08-20T12:46:04.051390+00:00 app[web.1]: * Environment: production\n2019-08-20T12:46:08.886669+00:00 heroku[web.1]: State changed from starting to crashed\n2019-08-20T12:46:08.769945+00:00 app[web.1]: * Listening on tcp://0.0.0.0:32178\n2019-08-20T12:46:08.770225+00:00 app[web.1]: bundler: failed to load command: puma (/app/vendor/bundle/ruby/2.6.0/bin/puma)\n2019-08-20T12:46:08.770272+00:00 app[web.1]: Errno::ENOENT: No such file or directory @ rb_sysopen - tmp/pids/server.pid\n2019-08-20T12:46:08.770276+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/launcher.rb:133:in `initialize'\n2019-08-20T12:46:08.770277+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/launcher.rb:133:in `open'\n2019-08-20T12:46:08.770278+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/launcher.rb:133:in `write_pid'\n2019-08-20T12:46:08.770280+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/launcher.rb:106:in `write_state'\n2019-08-20T12:46:08.770281+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/single.rb:103:in `run'\n2019-08-20T12:46:08.770282+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/launcher.rb:186:in `run'\n2019-08-20T12:46:08.770284+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/lib/puma/cli.rb:80:in `run'\n2019-08-20T12:46:08.770285+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/gems/puma-3.12.1/bin/puma:10:in `&lt;top (required)&gt;'\n2019-08-20T12:46:08.770287+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/bin/puma:23:in `load'\n2019-08-20T12:46:08.770289+00:00 app[web.1]: /app/vendor/bundle/ruby/2.6.0/bin/puma:23:in `&lt;top (required)&gt;'\n2019-08-20T12:46:08.867275+00:00 heroku[web.1]: Process exited with status 1\n</code></pre>\n\n<p>For some reason, the <code>tmp/pids/server.pid</code> is not created when the server starts.</p>\n\n<p>Can you please help me with a solution to this problem?\nI did not find a solution in google</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "timeout"], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "edited": false, "score": 0, "creation_date": 1566371931, "post_id": 57575779, "comment_id": 101630520, "body": "Thanks for the suggestion @AhmeDEV , but we&#39;re trying to keep gem usage to a minimum for our application. I&#39;ll keep looking around for alternatives!"}], "tags": [], "owner": {"reputation": 131, "user_id": 8950142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJSBn.png?s=128&g=1", "display_name": "AhmeDEV49", "link": "https://stackoverflow.com/users/8950142/ahmedev49"}, "is_accepted": false, "score": 0, "last_activity_date": 1566310965, "creation_date": 1566310965, "answer_id": 57575779, "question_id": 57574665, "link": "https://stackoverflow.com/questions/57574665/how-to-automatically-redirect-to-sign-in-after-timeout-in-the-client-side-with-d/57575779#57575779", "title": "How to automatically redirect to sign in after timeout in the client side with Devise", "body": "<p>It's not easy because Devise is server side, and the client don't take care about session expiration. </p>\n\n<p>But this gem could help you :</p>\n\n<p><a href=\"https://github.com/pelargir/auto-session-timeout\" rel=\"nofollow noreferrer\">auto-session-timeout</a></p>\n\n<p>it will add some Javascript helper to logout after inactivity.</p>\n\n<p>Hope it works :-)</p>\n"}], "owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566310965, "creation_date": 1566307203, "question_id": 57574665, "link": "https://stackoverflow.com/questions/57574665/how-to-automatically-redirect-to-sign-in-after-timeout-in-the-client-side-with-d", "title": "How to automatically redirect to sign in after timeout in the client side with Devise", "body": "<p>I'm trying to get my client side rails application to redirect to the sign in page when Devise times the user out.</p>\n\n<p>We have periodic requests that get sent out every 30 seconds or so, so before this request, I'm trying to check if the user's session has expired. The issue with this is that the requests are sent via jQuery.</p>\n\n<p>Inside devise.rb I'm overriding the timedout? method to try and set a session variable if the session is timed out.</p>\n\n<pre><code>module Devise\n  module Models\n    module Timeoutable\n      def timedout?(last_access)\n        # Custom code goes into this method\n        session[:user_expired] = true\n        !timeout_in.nil? &amp;&amp; last_access &amp;&amp; last_access &lt;= timeout_in.ago\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In my client side view home page (home.html.erb), I have the following method to get this session variable:</p>\n\n<pre><code>&lt;script&gt;\n  fuction getExpired()\n  {\n    console.log(\"getExpired\");\n    var session_val = &lt;%= session[:user_expired].to_json %&gt;\n    return session_val;\n  }\n&lt;/script&gt;\n</code></pre>\n\n<p>Finally, in my JavaScript file that sends the requests, I will be calling this method and checking if it is equal or not equal to true.</p>\n\n<p>The issue that I'm running into at the moment is \"Caught NameError: undefined local variable or method `session' for #\". Looking further into it, it seems you can only create session variables in controllers, which means I need another way of passing a value from this timedout? method to JavaScript.</p>\n\n<p>I have also tried leaving the timedout? method as is and done the following in home.html.erb</p>\n\n<pre><code>&lt;script&gt;\n  fuction getExpired()\n  {\n    console.log(\"getExpired\");\n    var timedOutVar;\n    &lt;% if current_user.timedout?(1.second.ago) %&gt;\n      timedOutVar = true\n    &lt;% else %&gt;\n      timedOutVar = false\n    &lt;% end %&gt;\n  }\n&lt;/script&gt;\n</code></pre>\n\n<p>This doesn't seem to be working though, as timedOutVar is always == false. It seems that the ruby code is not executed inside of the function apart from when the script is first generated. Is there a way to do this?</p>\n"}, {"tags": ["arrays", "ruby", "oop", "object"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1566306142, "post_id": 57574263, "comment_id": 101608851, "body": "Show the <code>Map</code> class definition."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1566306289, "post_id": 57574263, "comment_id": 101608932, "body": "You might be thinking first, why you did not think whether <code>Map</code> class have instance method <code>get_id</code>"}, {"owner": {"reputation": 63, "user_id": 8383688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e41bc00002e11fa0e27171d3e86091?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing_Man", "link": "https://stackoverflow.com/users/8383688/laughing-man"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1566307317, "post_id": 57574263, "comment_id": 101609512, "body": "@ray I am very sorry for this. I&#39;ve just started learning Ruby after C/C++. So I in the past I always wrote get_ and set_ names for methods."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8383688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e41bc00002e11fa0e27171d3e86091?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing_Man", "link": "https://stackoverflow.com/users/8383688/laughing-man"}, "edited": false, "score": 0, "creation_date": 1566306152, "post_id": 57574291, "comment_id": 101608857, "body": "You are totally right! I&#39;ve renamed my method to read_id. Thanks!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1566306474, "post_id": 57574291, "comment_id": 101609030, "body": "It would be more common to write <code>@id = id</code> in the <code>initialize</code> method, and <code>attr_reader :id</code> to create an access method."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1566306551, "post_id": 57574291, "comment_id": 101609069, "body": "And <code>def id=(value)</code> when you need to set the ID from outside (you&#39;ll put some verification on value to ensure id always has allowed values)."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 5, "creation_date": 1566306558, "post_id": 57574291, "comment_id": 101609072, "body": "And in future, I&#39;d strongly recommend aiming to write a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> when posting questions on StackOverflow. Your question is not reproducible, since you did not show us the definition of the <code>Map</code> class."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1566306021, "creation_date": 1566306021, "answer_id": 57574291, "question_id": 57574263, "link": "https://stackoverflow.com/questions/57574263/undefined-method-ruby/57574291#57574291", "title": "Undefined method Ruby", "body": "<p>It seems that your <code>Map</code> class doesn't define <code>get_id</code> method. Hint - in Ruby you don't use <code>get_</code> and <code>set_</code> prefixes, so maybe you just wanted to call <code>maps[0].id</code>?</p>\n"}], "owner": {"reputation": 63, "user_id": 8383688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e41bc00002e11fa0e27171d3e86091?s=128&d=identicon&r=PG&f=1", "display_name": "Laughing_Man", "link": "https://stackoverflow.com/users/8383688/laughing-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57574291, "answer_count": 1, "score": 1, "last_activity_date": 1566306042, "creation_date": 1566305936, "last_edit_date": 1566306042, "question_id": 57574263, "link": "https://stackoverflow.com/questions/57574263/undefined-method-ruby", "title": "Undefined method Ruby", "body": "<p>I would like to create an array of my custom objects. But when I try to call a method of the one of the objects, I get an error <strong>undefined method `get_id' for #Map:0x000055cf036a0838></strong>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>maps = []\nmap = Map.new(id)\nmaps.push(map)\nputs maps[0].get_id\n</code></pre>\n"}, {"tags": ["ruby", "haml", "tailwind-css"], "answers": [{"comments": [{"owner": {"reputation": 1456, "user_id": 423961, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/o3gwk.jpg?s=128&g=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/423961/darren"}, "edited": false, "score": 0, "creation_date": 1566303213, "post_id": 57573373, "comment_id": 101607042, "body": "Awesome! Thanks for your reply. I&#39;ll give it a go when I&#39;m back near my development machine and then accept your answer."}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1566303072, "creation_date": 1566303072, "answer_id": 57573373, "question_id": 57572997, "link": "https://stackoverflow.com/questions/57572997/fractional-classes-with-tailwind-css-inside-a-haml-file/57573373#57573373", "title": "Fractional classes with Tailwind CSS inside a HAML file", "body": "<p>You will have to explicitly add the class, something like</p>\n\n<pre><code>%div{:class =&gt; \"w-2/3\"}\n</code></pre>\n\n<p>Note you can combine this with the shorthand syntax for classes if you want, e.g.</p>\n\n<pre><code>.foo{:class =&gt; \"w-2/3\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1456, "user_id": 423961, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/o3gwk.jpg?s=128&g=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/423961/darren"}, "edited": false, "score": 0, "creation_date": 1609054984, "post_id": 65448486, "comment_id": 115737287, "body": "Thanks so much. This is also incredibly helpful!"}], "tags": [], "owner": {"reputation": 1156, "user_id": 1023963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f883aed63ecc08802ce95473d8eb3b43?s=128&d=identicon&r=PG", "display_name": "nyi", "link": "https://stackoverflow.com/users/1023963/nyi"}, "is_accepted": false, "score": 1, "last_activity_date": 1608902818, "creation_date": 1608902818, "answer_id": 65448486, "question_id": 57572997, "link": "https://stackoverflow.com/questions/57572997/fractional-classes-with-tailwind-css-inside-a-haml-file/65448486#65448486", "title": "Fractional classes with Tailwind CSS inside a HAML file", "body": "<p>The class names used in Tailwind can be overwritten. This might help if you tend to use these classes frequently and don't want to write the extended version (<code>%div{class: 'w-1/2'}</code> or <code>%div(class=&quot;w-1/2&quot;)</code>.</p>\n<p>To overwrite the width classes to use <code>_</code> instead of <code>/</code>, use the following configuration in your <code>tailwind.config.js</code>:</p>\n<pre><code>module.exports = {\n  theme: {\n    extend: {},\n    width: (theme) =&gt; ({\n      auto: 'auto',\n      ...theme('spacing'),\n      '1_2': '50%',\n      '1_3': '33.333333%',\n      '2_3': '66.666667%',\n      '1_4': '25%',\n      '2_4': '50%',\n      '3_4': '75%',\n      '1_5': '20%',\n      '2_5': '40%',\n      '3_5': '60%',\n      '4_5': '80%',\n      '1_6': '16.666667%',\n      '2_6': '33.333333%',\n      '3_6': '50%',\n      '4_6': '66.666667%',\n      '5_6': '83.333333%',\n      '1_12': '8.333333%',\n      '2_12': '16.666667%',\n      '3_12': '25%',\n      '4_12': '33.333333%',\n      '5_12': '41.666667%',\n      '6_12': '50%',\n      '7_12': '58.333333%',\n      '8_12': '66.666667%',\n      '9_12': '75%',\n      '10_12': '83.333333%',\n      '11_12': '91.666667%',\n      full: '100%',\n      screen: '100vw',\n    }),\n  }\n}\n</code></pre>\n<p>Obviously, this duplicates information from Tailwind and might make framework upgrades more cumbersome.</p>\n"}], "owner": {"reputation": 1456, "user_id": 423961, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/o3gwk.jpg?s=128&g=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/423961/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 57573373, "answer_count": 2, "score": 0, "last_activity_date": 1608902818, "creation_date": 1566301795, "last_edit_date": 1581308497, "question_id": 57572997, "link": "https://stackoverflow.com/questions/57572997/fractional-classes-with-tailwind-css-inside-a-haml-file", "title": "Fractional classes with Tailwind CSS inside a HAML file", "body": "<p>I am trying to use the <code>w-2/3</code> class from Tailwind CSS with HAML in a Rails <code>.html.haml</code> file. The forward slash is causing Rails (or HAML) to throw an exception and I don't know how to format it so it's accepted.</p>\n\n<p>Is there a way to use the <code>w-2/3</code> etc classes or will I have to go back to using <code>.html.erb</code>?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1566308267, "post_id": 57573115, "comment_id": 101610138, "body": "Thank you! But still, I don&#39;t get how it works sorry. I have to study this part can you suggest some reference?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 1, "creation_date": 1566308933, "post_id": 57573115, "comment_id": 101610567, "body": "I am not sure. Reducing is a very common CS approach, covered everywhere including <a href=\"https://en.wikipedia.org/wiki/Fold_(higher-order_function)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Fold_(higher-order_function)</a> What happens there is actually we walk through the functions in the pipeline and subsequently apply them to the variable."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1566302147, "creation_date": 1566302147, "answer_id": 57573115, "question_id": 57572954, "link": "https://stackoverflow.com/questions/57572954/test-dome-pipeline-for-ruby/57573115#57573115", "title": "Test Dome pipeline for ruby", "body": "<p>All you need is simply reduce the array of functions.</p>\n\n<pre><code>def pipeline(*args)\n  -&gt;(x) { args.reduce(x) { |acc, f| f.(acc) } }\nend\nfun = pipeline(-&gt; (x) { x * 3 }, -&gt; (x) { x + 1 }, -&gt; (x) { x / 2 })\n#\u21d2 #&lt;Proc:0x0000561a73f48768@(pry):36 (lambda)&gt;\nfun.(3)\n#\u21d2 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12956532, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157340259580895/picture?type=large", "display_name": "EduBatz", "link": "https://stackoverflow.com/users/12956532/edubatz"}, "is_accepted": false, "score": 0, "last_activity_date": 1582585944, "last_edit_date": 1582585944, "creation_date": 1582583772, "answer_id": 60384942, "question_id": 57572954, "link": "https://stackoverflow.com/questions/57572954/test-dome-pipeline-for-ruby/60384942#60384942", "title": "Test Dome pipeline for ruby", "body": "<p>This is way simpler, by assigning a variable to control the flow of the operations make it crash</p>\n\n<p>try this:</p>\n\n<pre><code>funcs.each do |func|\n arg = func.call(arg)     \nend\nreturn arg\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 57573115, "answer_count": 2, "score": 2, "last_activity_date": 1582585944, "creation_date": 1566301595, "last_edit_date": 1592644375, "question_id": 57572954, "link": "https://stackoverflow.com/questions/57572954/test-dome-pipeline-for-ruby", "title": "Test Dome pipeline for ruby", "body": "<p>I'm practicing on test dome and come across to this question I don't have idea how to use lambda but I still try so I don't know if I'm right. Here's the instruction:</p>\n<blockquote>\n<p>As part of a data processing pipeline, complete the implementation of the pipeline method:</p>\n<p>The method should accept a variable number of functions, and it should return a new function that accepts one parameter arg.</p>\n<p>The returned function should call the first function in the pipeline with the parameter arg, and call the second function with the result of the first function.</p>\n<p>The returned function should continue calling each function in the pipeline in order, following the same pattern, and return the value from the last function.</p>\n<p>For example, <code>pipeline(-&gt; (x) { x * 3 }, -&gt; (x) { x + 1 }, -&gt; (x) { x / 2 })</code> then calling the returned function with <code>3</code> should return <code>5</code>.</p>\n</blockquote>\n<p>And here's my code.</p>\n<pre><code>def pipeline(*funcs)\n  -&gt; (arg) {\n    counter = 0\n    temp = 0\n    funcs.each do |func|\n      if counter == 0\n        temp += func.call(arg)\n        counter += 1\n      else\n        temp = func.call(temp)\n      end\n    end\n    return temp\n  }\nend\n\nfun = pipeline(-&gt; (x) { x * 3 }, -&gt; (x) { x + 1 }, -&gt; (x) { x / 2 })\nputs (fun.call(3)) \n</code></pre>\n<pre><code>Output:\n\nRun OK\n\n\n5\n</code></pre>\n<p>but I got this error.</p>\n<pre><code>done Example case: Correct answer \nerror  Various functions: TypeError: pipeline.rb:7:in `+' \nerror  Various data types: TypeError: pipeline.rb:7:in `+' \n</code></pre>\n<p>if you're curious here is the question its free.</p>\n<p><a href=\"https://www.testdome.com/d/ruby-interview-questions/6\" rel=\"nofollow noreferrer\">https://www.testdome.com/d/ruby-interview-questions/6</a></p>\n<p>Here's the starting code:</p>\n<pre><code>def pipeline(*funcs)\n  -&gt; (arg) {\n    # write your code here  \n  }\nend\n\nfun = pipeline(-&gt; (x) { x * 3 }, -&gt; (x) { x + 1 }, -&gt; (x) { x / 2 })\nputs (fun.call(3)) # should print 5\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "xpath", "capybara"], "comments": [{"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1566300931, "post_id": 57572687, "comment_id": 101605759, "body": "What are you trying to find? The radio buttons?"}, {"owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "reply_to_user": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1566310776, "post_id": 57572687, "comment_id": 101611648, "body": "@GregBurghardt, I have updated the question with example. Please let me know if you need more information"}, {"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1566310988, "post_id": 57572687, "comment_id": 101611770, "body": "What code have you tried so far to get the elements?"}, {"owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "reply_to_user": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1566311574, "post_id": 57572687, "comment_id": 101612111, "body": "Below xpath is giving all the three loan amounts //td[contains(., &quot;Investor A&quot;)]/preceding-sibling::td[descendant::input][1]/label/text(&zwnj;&#8203;)  But I need only loan amounts from row one and two for which radio button is selected"}, {"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1566311963, "post_id": 57572687, "comment_id": 101612353, "body": "Please add this to your question not the comments."}, {"owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "reply_to_user": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1566312155, "post_id": 57572687, "comment_id": 101612470, "body": "Thanks @GregBurghardt added code sample to the question. Let me know if you need any other information"}], "answers": [{"tags": [], "owner": {"reputation": 10832, "user_id": 9800042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nqmxr.jpg?s=128&g=1", "display_name": "Sers", "link": "https://stackoverflow.com/users/9800042/sers"}, "is_accepted": false, "score": 0, "last_activity_date": 1566303416, "creation_date": 1566303416, "answer_id": 57573489, "question_id": 57572687, "link": "https://stackoverflow.com/questions/57572687/selenium-find-elements-using-xpath/57573489#57573489", "title": "Selenium find elements using xpath", "body": "<p>Here example how you can get radio buttons depends on Loan label and value:</p>\n\n<pre><code>//tr[.//label[.='Loan1']]//td[./label[.='100']]/input\n//tr[.//label[.='Loan1']]//td[./label[.='300']]/input\n\n//tr[.//label[.='Loan2']]//td[./label[.='100']]/input\n\n//tr[.//label[.='Loan3']]//td[./label[.='200']]/input\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "edited": false, "score": 0, "creation_date": 1566309491, "post_id": 57573707, "comment_id": 101610917, "body": "Thanks for providing the xpath. for some reason If I have [@selected] elements are not selected. Below xpath is giving all the three loan amounts //td[contains(., &quot;Investor A&quot;)]/preceding-sibling::td[descendant::input][1]/label/text(&zwnj;&#8203;) is there another way to get selected inputs?"}, {"owner": {"reputation": 563, "user_id": 5090901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64321cc0cef8fd93a88151dac9e7e90f?s=128&d=identicon&r=PG&f=1", "display_name": "ruhaib", "link": "https://stackoverflow.com/users/5090901/ruhaib"}, "reply_to_user": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "edited": false, "score": 0, "creation_date": 1566310839, "post_id": 57573707, "comment_id": 101611681, "body": "i have updated the xpath to use @checked or @selected, but i have tried and even they are not working for xpath, however a solution is working in css, if you are interested in css based solution then please try this <code>#L1_one:checked</code>. if this works for you than i&#39;ll convert the above xpath to a css."}, {"owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "edited": false, "score": 0, "creation_date": 1566311369, "post_id": 57573707, "comment_id": 101611991, "body": "I will try using css, can you please provide equivalent css"}], "tags": [], "owner": {"reputation": 563, "user_id": 5090901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64321cc0cef8fd93a88151dac9e7e90f?s=128&d=identicon&r=PG&f=1", "display_name": "ruhaib", "link": "https://stackoverflow.com/users/5090901/ruhaib"}, "is_accepted": false, "score": 1, "last_activity_date": 1566310746, "last_edit_date": 1566310746, "creation_date": 1566304183, "answer_id": 57573707, "question_id": 57572687, "link": "https://stackoverflow.com/questions/57572687/selenium-find-elements-using-xpath/57573707#57573707", "title": "Selenium find elements using xpath", "body": "<p>try this xpath: </p>\n\n<p><code>//td[contains(., \"Investor A\")]/preceding-sibling::td[descendant::input[@selected or @checked]][1]/label/text()</code></p>\n"}, {"comments": [{"owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "edited": false, "score": 0, "creation_date": 1566310594, "post_id": 57575451, "comment_id": 101611556, "body": "Thanks for providing the code. I need to fetch the element only if the radio button next to the loan amount is selected. As ruhaib suggested I used input[@selected] in the xpath but it is not working."}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "reply_to_user": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "edited": false, "score": 1, "creation_date": 1566310881, "post_id": 57575451, "comment_id": 101611705, "body": "As far as I know, you can&#39;t get the selected elements using XPath because that value isn&#39;t reflected in the HTML (a default might be but not one that&#39;s been selected). You will have to loop through all, find the ones that are checked using Selenium, and then go back and find the elements based on what you found."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1566832861, "post_id": 57575451, "comment_id": 101770609, "body": "Why did your post get so many downvotes @JeffC? I tried to fix few of them."}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1566842878, "post_id": 57575451, "comment_id": 101774592, "body": "Well it only got one downvote. It&#39;s usually a particular person that revenge downvotes. You downvote his post and leave a constructive criticism or feedback and he downvotes a few of your answers. It&#39;s been happening for years. I flag from time to time and he has been banned before but he keeps doing it. I appreciate the upvotes... but you should upvote only if you think it warrants it, not just because it was downvoted."}], "tags": [], "owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "is_accepted": false, "score": 1, "last_activity_date": 1566309846, "creation_date": 1566309846, "answer_id": 57575451, "question_id": 57572687, "link": "https://stackoverflow.com/questions/57572687/selenium-find-elements-using-xpath/57575451#57575451", "title": "Selenium find elements using xpath", "body": "<p>Since you are looking for loan amount given the loan label (Loan1) and investor (Investor A), you can use the XPath below.</p>\n\n<pre><code>//tr[.//label[.='Loan1']]//label[.='Investor A']//preceding::label[1]\n^ find a TR\n    ^ that has a descendant LABEL with the loan label\n                         ^ that TR has a descendant LABEL that contains the investor name\n                                                ^ then go back up the DOM and find the first LABEL\n</code></pre>\n\n<p>That will return \"100\".</p>\n\n<p>You can insert whatever loan and investor label you want into the XPath and get the loan amount of anything you want.</p>\n\n<pre><code>\"//tr[.//label[.='#{loanLabel}']]//label[.='#{investorLabel}']//preceding::label[1]\"\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/554666/ruby-merging-variables-in-to-a-string\">Ruby: Merging variables in to a string</a></p>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1566318184, "last_edit_date": 1566318184, "creation_date": 1566314876, "answer_id": 57576961, "question_id": 57572687, "link": "https://stackoverflow.com/questions/57572687/selenium-find-elements-using-xpath/57576961#57576961", "title": "Selenium find elements using xpath", "body": "<p>If the selection status of the radio buttons has changed since the HTML was loaded what you're trying to do isn't possible with XPath.  This is because XPath doesn't have access to the properties of the inputs which reflect the current state (it can only access the attributes). You also have the issue that none of the &lt;label> elements are actually associated with any of the inputs they refer to (if you are the person creating this HTML you should really fix that). CSS does have access to the current state of the page and all of the radios you're interested in appear to have ids ending in <code>_one</code> so we can use that to find the relevant elements. The CSS would be</p>\n\n<p>input[id$=\"_one\"]:checked + label</p>\n\n<p>since you want the text of the label elements that CSS will find and you indicate you're using Capybara it would then be</p>\n\n<pre><code>texts = all(:css, 'input[id$=\"_one\"]:checked + label').map(&amp;:text)\n</code></pre>\n\n<p>Note: this doesn't actually use the text \"Investor A\" to find elements you're interested in. If the ids are not reliable and using the \"Investor A\" text is important then it's not possible to do this using a single XPath or CSS with the way the HTML is structured.</p>\n"}], "owner": {"reputation": 2745, "user_id": 1647913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c81f1ae904b58fec109eb3f450bbf28?s=128&d=identicon&r=PG", "display_name": "vineel", "link": "https://stackoverflow.com/users/1647913/vineel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1566318184, "creation_date": 1566300727, "last_edit_date": 1566314299, "question_id": 57572687, "link": "https://stackoverflow.com/questions/57572687/selenium-find-elements-using-xpath", "title": "Selenium find elements using xpath", "body": "<p>I need to find elements with loan amounts for investor A (in this case it is 100, 100)</p>\n\n<p>can someone suggest how to write xpath to find those elements</p>\n\n<p>[Example]\nIn the screenshot below, I need to find xpath to get elements with text 100 in row one and two for which radio buttons are selected.</p>\n\n<p>Below xpath is giving all the three loan amounts </p>\n\n<pre><code>//td[contains(., \"Investor A\")]/preceding-sibling::td[descendant::input][1]/label/text()\n</code></pre>\n\n<p>But I need only loan amounts from row one and two for which radio button is selected</p>\n\n<p><a href=\"https://i.stack.imgur.com/xRO5j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xRO5j.png\" alt=\"enter image description here\"></a></p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;script src=\"https://code.jquery.com/jquery-3.4.1.js\" integrity=\"sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=\"\n  crossorigin=\"anonymous\"&gt;&lt;/script&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n  &lt;style&gt;\n    table {\n      border: 1px dashed #cccccc;\n      border-collapse: collapse;\n    }\n\n    table td {\n      border: 1px dashed #cccccc;\n    }\n  &lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;table&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;label&gt;Loan1&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;input type='radio' name='L1' id='L1_one'&gt;&lt;/input&gt;\n        &lt;label&gt;100&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;label&gt;Investor A&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;input type='radio' name='L1' id='L1_two'&gt;&lt;/input&gt;\n        &lt;label&gt;200&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;label&gt;Investor B&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;input type='radio' name='L1' id='L1_three'&gt;&lt;/input&gt;\n        &lt;label&gt;300&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;label&gt;Investor C&lt;/label&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;label&gt;Loan2&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;input type='radio' name='L2' id='L2_one'&gt;&lt;/input&gt;\n        &lt;label&gt;100&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;label&gt;Investor A&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;input type='radio' name='L2' id='L2_two'&gt;&lt;/input&gt;\n        &lt;label&gt;200&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;label&gt;Investor B&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;input type='radio' name='L2' id='L2_three'&gt;&lt;/input&gt;\n        &lt;label&gt;300&lt;/label&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;label&gt;Investor C&lt;/label&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;\n          &lt;label&gt;Loan3&lt;/label&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;input type='radio' name='L3' id='L3_one'&gt;&lt;/input&gt;\n          &lt;label&gt;100&lt;/label&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;label&gt;Investor A&lt;/label&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;input type='radio' name='L3' id='L3_two'&gt;&lt;/input&gt;\n          &lt;label&gt;200&lt;/label&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;label&gt;Investor B&lt;/label&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;input type='radio' name='L3' id='L3_three'&gt;&lt;/input&gt;\n          &lt;label&gt;300&lt;/label&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;label&gt;Investor C&lt;/label&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;/body&gt;\n</code></pre>\n"}, {"tags": ["ruby", "ruby-2.5"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1566292129, "post_id": 57570175, "comment_id": 101601004, "body": "<code>Foo.singleton_class.met</code> obviously. You open a singleton class and define a method on its singleton class."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566292619, "post_id": 57570175, "comment_id": 101601290, "body": "I&#39;d love some explanation about the downvote... and @AlekseiMatiushkin I&#39;ve been looking for an explanation of <code>singleton_class</code>, but every cases reference usage of <code>singleton_class</code> over instances of a class. Hence I really do not get the usage here :/"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566293902, "post_id": 57570175, "comment_id": 101602003, "body": "Downvote is not mine; I\u2019ll post the answer explaining the details."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566294901, "post_id": 57570175, "comment_id": 101602615, "body": "Upvoted for the sake of enthropy constancy."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 5, "last_activity_date": 1566294718, "creation_date": 1566294718, "answer_id": 57571009, "question_id": 57570175, "link": "https://stackoverflow.com/questions/57570175/class-method-self-within-class-methods-block-class-self-in-ruby/57571009#57571009", "title": "class method `self.` within class methods block `class &lt;&lt; self` in Ruby", "body": "<p>Each object in Ruby has its own <a href=\"https://ruby-doc.org/core/Object.html#method-i-singleton_class\" rel=\"noreferrer\">singleton class</a>. This is where all the methods of instances are defined.</p>\n\n<p>Consider the following example.</p>\n\n<pre><code>class C; end\nc1, c2 = C.new, C.new\nc1.extend(Module.new { def m1; 42; end })\n\nc1.m1\n#\u21d2\u00a042\nc2.m1\n#\u21d2 NoMethodError: undefined method `m1' for #&lt;C:0x000055cb062e6888&gt;\n\nc1.singleton_class.instance_methods.grep /m1/\n#\u21d2 [:m1]\nc2.singleton_class.instance_methods.grep /m1/\n#\u21d2 []\n</code></pre>\n\n<p>Singleton class is needed to make it possible to extend objects etc.</p>\n\n<p>In Ruby, <em>everything is object</em>. Classes <em>are indeed objects as well</em>. That\u2019s why each class has its own singleton class. And each singleton class has its singleton class.</p>\n\n<pre><code>c1.singleton_class.singleton_class.singleton_class.singleton_class\n#\u21d2 #&lt;Class:#&lt;Class:#&lt;Class:#&lt;Class:#&lt;C:0x000055cb0459c700&gt;&gt;&gt;&gt;&gt;\n</code></pre>\n\n<p>Methods defined on <code>foo</code> are <em>stored</em> in the singleton class of <code>foo</code>. Methods defined on <code>foo</code>\u2019s singleton class are <em>stored</em> in the singleton class of the singleton class of <code>foo</code>. And so forth.</p>\n\n<p>It\u2019s not quite practical, but it\u2019s still possible due to how Ruby treats everything as <code>Object</code>.</p>\n"}], "owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 57571009, "answer_count": 1, "score": 2, "last_activity_date": 1566294718, "creation_date": 1566291789, "last_edit_date": 1566292245, "question_id": 57570175, "link": "https://stackoverflow.com/questions/57570175/class-method-self-within-class-methods-block-class-self-in-ruby", "title": "class method `self.` within class methods block `class &lt;&lt; self` in Ruby", "body": "<p><strong>context:</strong> I'm currently working with the <a href=\"https://github.com/whitequark/parser\" rel=\"nofollow noreferrer\">parser</a> gem and trying to handle all cases of <em>what is a public method</em>.</p>\n\n<p>I've written this next code, hoping it will fail on runtime. But it doesn't.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class Foo\n  class &lt;&lt; self\n    def self.met\n      puts \"I'm just a troll\"\n    end\n\n    class &lt;&lt; self\n      def mut\n        puts \"Try and find me\"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>So I'm wondering where is <code>met</code> callable (<code>Foo.met</code> would raise a <code>NoMethodError</code>)? And is this a useful Ruby pattern or just something I should not do, neither care about?</p>\n"}, {"tags": ["ruby", "bash", "path", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1566294700, "post_id": 57570124, "comment_id": 101602500, "body": "Have you opened a new Terminal window after having changed your <code>.bash_profile</code>? What&#39;s the output of <code>echo $PATH</code>? Also, what version if macOS are you on (since macOS Catalina will use zsh by default instead of Bash)?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1566318624, "post_id": 57570124, "comment_id": 101616032, "body": "Install RVM with <code>\\curl -sSL https:&#47;&#47;get.rvm.io | bash -s stable</code>; restart your shell; install Ruby with <code>rvm install 2.6.0</code>. <a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">Don&#39;t</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>."}], "owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566294753, "creation_date": 1566291611, "last_edit_date": 1566294753, "question_id": 57570124, "link": "https://stackoverflow.com/questions/57570124/trying-to-put-bundle-in-path", "title": "Trying to put bundle in PATH", "body": "<p>I'm working on a Ruby project that requires the use of a few gems. I'm a bit confused, since I thought I already had bundler installed on my Mac. I tried installing it just now and got the following error:</p>\n\n<pre><code>Leias-MacBook-Pro:spec leia$ gem install bundler\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory.\n</code></pre>\n\n<p>I then tried using <code>--user-install</code>, a trick I picked up from browsing Stack Overflow.</p>\n\n<pre><code>Leias-MacBook-Pro:spec leia$ gem install bundler --user-install\nWARNING:  You don't have /Users/leia/.gem/ruby/2.3.0/bin in your PATH, gem executables will not run.\nSuccessfully installed bundler-2.0.2\nParsing documentation for bundler-2.0.2\nDone installing documentation for bundler after 5 seconds\n1 gem installed\n</code></pre>\n\n<p>Now, I kind of need the gem executables to run, so I opened my <code>.bash_profile</code> and dropped the following code in:</p>\n\n<pre><code>export PATH=/Users/leia/.gem/ruby/2.3.0/bin:$PATH\n</code></pre>\n\n<p>But no matter how I try to fix it, <code>bundle</code> still won't run. The gem I'm installing is rspec, and I definitely need to be able to run those executables. Am I doing something wrong here? I've tried to follow tutorials and Google similar issues, but I can't figure out what the problem is. Any pointers or suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 6, "last_activity_date": 1566290831, "creation_date": 1566290831, "answer_id": 57569892, "question_id": 57569825, "link": "https://stackoverflow.com/questions/57569825/is-missing-a-template-for-request-formats-text-html/57569892#57569892", "title": "is missing a template for request formats: text/html", "body": "<p>This means you do not have a app/views/phrases_term(s)/new.html.erb file. I'm unsure if you've namespaced the files under 'phrases_term' or 'phrases_terms'. </p>\n\n<p>Make one in the correct directory, populate it, and it will load.</p>\n"}], "owner": {"reputation": 65, "user_id": 11850228, "user_type": "registered", "profile_image": "https://graph.facebook.com/938857089785122/picture?type=large", "display_name": "Dutavi", "link": "https://stackoverflow.com/users/11850228/dutavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5164, "favorite_count": 0, "accepted_answer_id": 57569892, "answer_count": 1, "score": 3, "last_activity_date": 1566290831, "creation_date": 1566290629, "last_edit_date": 1592644375, "question_id": 57569825, "link": "https://stackoverflow.com/questions/57569825/is-missing-a-template-for-request-formats-text-html", "title": "is missing a template for request formats: text/html", "body": "<blockquote>\n<p>I have Term and Phrase models and I am adding Nested Resources. I want to get the Term Id for Phraes_term to create a data pair</p>\n<p>Example: Term 1 and Phrase 2.\nBut when you press the new button from show.html.erb term, an error will occur</p>\n</blockquote>\n<pre><code>--&gt;error :PhrasesTermsController#new is missing a template for request formats: text/html\n</code></pre>\n<p>form.html.erb\n-(phrases_term).</p>\n<pre><code>&lt;%= form_with(model: phrases_term, local: true) do |form| %&gt;\n  &lt;% if pharases_term.errors.any? %&gt;\n    &lt;div id=&quot;error_explanation&quot;&gt;\n      &lt;h2&gt;&lt;%= pluralize(pharases_term.errors.count, &quot;error&quot;) %&gt; prohibited this phrase from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% pharases_term.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=&quot;field&quot;&gt;\n    &lt;%= form.label :ID %&gt;\n    &lt;%= form.number_field_tag :ID %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=&quot;actions&quot;&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n<p>(phrases_term)\n-new.html.erb</p>\n<pre><code>&lt;%= render 'form', phrases_term: @phrases_term %&gt;\n</code></pre>\n<p>Phrases_terms_controller.rb</p>\n<pre><code>class PhrasesTermsController &lt; ApplicationController\n  before_action :authenticate_user!\n  before_action :set_term\n\n  def new\n    @phrases_term = PhrasesTerm.new\n  end\n\n  def create\n    @phrases_term = @term.phrases_term\n    @phrases_term.user = current_user\n    @phrases_term.save\n    redirect_back(fallback_location: root_path)\n  end\n  \n  private\n  \n  def phrases_term_params\n    params.require(:phrases_term).permit(:term_id)\n  end\n\n  def set_term\n    @term = Term.find(params[:term_id])\n  end\nend\n\n</code></pre>\n<p>routes.rb</p>\n<pre><code>resources :terms do\n    resources :phrases_terms, only: [:create, :destroy, :new]\n  end\n</code></pre>\n<p>(Term)\nShow.html.erb</p>\n<pre><code>&lt;td&gt;&lt;%= link_to 'New', new_term_phrases_term_path(@term) %&gt;&lt;/td&gt;\n</code></pre>\n<pre><code>(phrases_term).\n\n_form.html.ebr\n&lt;%= form_with(model: phrases_term, local: true) do |form| %&gt;\n  &lt;% if pharases_term.errors.any? %&gt;\n    &lt;div id=&quot;error_explanation&quot;&gt;\n      &lt;h2&gt;&lt;%= pluralize(pharases_term.errors.count, &quot;error&quot;) %&gt; prohibited this phrase from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% pharases_term.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=&quot;field&quot;&gt;\n    &lt;%= form.label :ID %&gt;\n    &lt;%= form.number_field_tag :ID %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=&quot;actions&quot;&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n<pre><code>(phrases_term)\n new.html.erb\n&lt;%= render 'form', phrases_term: @phrases_term %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566291983, "post_id": 57569549, "comment_id": 101600933, "body": "Do not change the content of the question with what was proposed in answers. The question must stay as it was stated."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566290617, "post_id": 57569705, "comment_id": 101600207, "body": "Perhaps <code>scan</code> would be a better choice."}, {"owner": {"reputation": 13, "user_id": 11950379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff01279ad42b715f5dfa561417f5a2f?s=128&d=identicon&r=PG&f=1", "display_name": "apaterson", "link": "https://stackoverflow.com/users/11950379/apaterson"}, "edited": false, "score": 0, "creation_date": 1566291628, "post_id": 57569705, "comment_id": 101600749, "body": "Thanks, that did the trick. However, when i put it in the code above, it outputs each value on new line.  Not sure what i am missing? Trying to read in from a file which has lots of rows of similar input values."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 13, "user_id": 11950379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff01279ad42b715f5dfa561417f5a2f?s=128&d=identicon&r=PG&f=1", "display_name": "apaterson", "link": "https://stackoverflow.com/users/11950379/apaterson"}, "edited": false, "score": 0, "creation_date": 1566291941, "post_id": 57569705, "comment_id": 101600915, "body": "@apaterson <code>Kernel#puts</code> prints arrays that way, each element on its own line. Use <code>puts arr.inspect</code> instead to see all of them on the same line, or like.-"}, {"owner": {"reputation": 13, "user_id": 11950379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff01279ad42b715f5dfa561417f5a2f?s=128&d=identicon&r=PG&f=1", "display_name": "apaterson", "link": "https://stackoverflow.com/users/11950379/apaterson"}, "edited": false, "score": 0, "creation_date": 1566292097, "post_id": 57569705, "comment_id": 101600992, "body": "Ah ok, thanks. Still learning ruby at the moment, so thanks for providing your help/information. Fully understand now."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1566291832, "last_edit_date": 1566291832, "creation_date": 1566290216, "answer_id": 57569705, "question_id": 57569549, "link": "https://stackoverflow.com/questions/57569549/parse-bpftrace-output-data/57569705#57569705", "title": "Parse bpftrace output data", "body": "<p>You don\u2019t need to split by <code>'|'</code>, split by non-digit out of the box:</p>\n\n<pre><code>input = '[4, 8) 824 |@@@@ |'\ninput.split(/\\D+/).reject(&amp;:empty?).map(&amp;:to_i)\n#\u21d2 [4, 8, 824]\n</code></pre>\n\n<p>or, as suggested by Cary in comments:</p>\n\n<pre><code>input.scan(/\\d+/).map(&amp;:to_i)\n#\u21d2 [4, 8, 824]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11950379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff01279ad42b715f5dfa561417f5a2f?s=128&d=identicon&r=PG&f=1", "display_name": "apaterson", "link": "https://stackoverflow.com/users/11950379/apaterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57569705, "answer_count": 1, "score": 1, "last_activity_date": 1566292008, "creation_date": 1566289635, "last_edit_date": 1566292008, "question_id": 57569549, "link": "https://stackoverflow.com/questions/57569549/parse-bpftrace-output-data", "title": "Parse bpftrace output data", "body": "<p>I'm looking at trying to parse the below output from a bpftrace file, using ruby. I thought about splitting on the <code>'|'</code> and then I need to get the values from <code>\"[4, 8) 824\"</code> for example. Need to get these two values into an array. I was thinking about using the trim method as well, but surely there must be a better way - maybe using a regular expression. Can I please get some guidance on how to proceed, please?</p>\n\n<p>Input: <code>[4, 8) 824 |@@@@ |</code></p>\n\n<pre><code>first_array = []\ntext=File.foreach('/.../test.txt').with_index do |line|\n   puts \"#{line}\"\n   values=line.split(\"|\")\n\n   first_array=values[0].split(\" \")\n   puts first_array\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "scope", "devise"], "comments": [{"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1566289757, "post_id": 57569530, "comment_id": 101599759, "body": "can u add the schema for user relation ??"}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1566289915, "post_id": 57569530, "comment_id": 101599848, "body": "Please show what you mean by &quot;not working&quot;. ie error message, or what you expected versus what actually happened."}, {"owner": {"reputation": 175, "user_id": 11844918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8284e2c546dc5c918b8d40d8eba6ed09?s=128&d=identicon&r=PG&f=1", "display_name": "roshita", "link": "https://stackoverflow.com/users/11844918/roshita"}, "reply_to_user": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1566290237, "post_id": 57569530, "comment_id": 101600019, "body": "I have added relation and schema as well. @mahemoff  &#39;not working&#39; mean validation not working as per required."}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1566291178, "post_id": 57569530, "comment_id": 101600505, "body": "I can only guess you mean it saved a record it shouldn&#39;t have, but it would help if you&#39;re more explicit with an example of what you tried to save and what happened. Otherwise, you&#39;re requiring readers to make a lot of assumptions and not necessarily solve your problem."}, {"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1566291271, "post_id": 57569530, "comment_id": 101600563, "body": "please remove the index from the relation using a migration <code>t.index [&quot;email&quot; , &quot;organization_id&quot;]</code>"}, {"owner": {"reputation": 175, "user_id": 11844918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8284e2c546dc5c918b8d40d8eba6ed09?s=128&d=identicon&r=PG&f=1", "display_name": "roshita", "link": "https://stackoverflow.com/users/11844918/roshita"}, "reply_to_user": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 1, "creation_date": 1566291664, "post_id": 57569530, "comment_id": 101600768, "body": "@mahemoff I have added problem example and error message in above question"}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 2, "creation_date": 1566291905, "post_id": 57569530, "comment_id": 101600896, "body": "Thanks. &quot;another user in organization&quot; Did you mean &quot;a user in another organization&quot;? Because if it&#39;s same organization, the error makes sense."}, {"owner": {"reputation": 560, "user_id": 11883546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab46bcd1aad9d7d7e8629d555d263a90?s=128&d=identicon&r=PG", "display_name": "Violeta", "link": "https://stackoverflow.com/users/11883546/violeta"}, "edited": false, "score": 0, "creation_date": 1566294857, "post_id": 57569530, "comment_id": 101602592, "body": "Can you please clarify this: Do you want one user to be able to be part of different ogranizations, or you want each organization to have only one unique user? Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "is_accepted": true, "score": 2, "last_activity_date": 1566791534, "creation_date": 1566791534, "answer_id": 57651557, "question_id": 57569530, "link": "https://stackoverflow.com/questions/57569530/custom-email-unique-validation-not-working-on-devise/57651557#57651557", "title": "Custom email unique validation not working on devise", "body": "<p>For the email unique validation, you can try this: \nDefine following in your model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n  validates_uniqueness_of :email, scope: :organization\n\n  def will_save_change_to_email?\n    false\n  end\n\n  def email_changed?\n    false\n  end\nend\n</code></pre>\n\n<p>This worked for me.</p>\n"}], "owner": {"reputation": 175, "user_id": 11844918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8284e2c546dc5c918b8d40d8eba6ed09?s=128&d=identicon&r=PG&f=1", "display_name": "roshita", "link": "https://stackoverflow.com/users/11844918/roshita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 57651557, "answer_count": 1, "score": 3, "last_activity_date": 1566791534, "creation_date": 1566289544, "last_edit_date": 1566291611, "question_id": 57569530, "link": "https://stackoverflow.com/questions/57569530/custom-email-unique-validation-not-working-on-devise", "title": "Custom email unique validation not working on devise", "body": "<p>I need to validate email with scope but with devise it is not working. Even after modifying index for email uniqueness it is not allowing user to create on basis of scope.</p>\n\n<p>i have tried adding following line on config/initializers/devise.rb</p>\n\n<pre><code>config.authentication_keys=[:email, :organization_id]\n</code></pre>\n\n<p>But it doesnot work.</p>\n\n<p>Also i have tried with validation on model:</p>\n\n<pre><code> validates_uniqueness_of :email, scope: :organization_id\n</code></pre>\n\n<p>But it doesnot work.</p>\n\n<p>Also tried by modifying user migration:</p>\n\n<pre><code>def up\n  remove_index :users, name: 'index_users_on_email'\n  add_index :users, [:email, :organization_id], unique: true\nend\n</code></pre>\n\n<p>But it doesnot work as well.</p>\n\n<p>Relation between user model an organization: \napp/models/organization.rb</p>\n\n<pre><code>Class Organization &lt; ApplicationRecord\n  has_many :users\nend\n</code></pre>\n\n<p>app/models/user.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  belongs_to :organization\nend\n</code></pre>\n\n<p>Here is schema :</p>\n\n<pre><code>create_table \"users\", force: :cascade do |t|\nt.string \"type\"\nt.string \"full_name\"\nt.string \"email\", default: \"\", null: false\nt.string \"encrypted_password\", default: \"\", null: false\nt.string \"reset_password_token\"\nt.datetime \"reset_password_sent_at\"\nt.datetime \"remember_created_at\"\nt.datetime \"created_at\", null: false\nt.datetime \"updated_at\", null: false\nt.string \"authentication_token\", limit: 30\nt.integer \"organization_id\"\nt.string \"archive_number\"\nt.datetime \"archived_at\"\nt.index [\"authentication_token\"], name: \"index_users_on_authentication_token\", unique: true\nt.index [\"email\" , \"organization_id\"], name: \"index_users_on_email_and_organization_id\", unique: true\nt.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n</code></pre>\n\n<p>end</p>\n\n<p>My problem was that: \nI have user with email in organizatin 1 now is have to add another user in organization 2 with same email. While doing this i am getting error </p>\n\n<blockquote>\n  <p>ActiveRecord::RecordInvalid: Validation failed: Email has already been\n  taken</p>\n</blockquote>\n\n<p>I belive that i should be able to add user with same email after adding scope under validation.</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1566288093, "post_id": 57568387, "comment_id": 101598908, "body": "<i>&quot;I have added the code below [...] It worked pretty well&quot;</i> \u2013 I doubt so. <code>:known_for[&#39;Ruby&#39;]</code> returns <code>nil</code>, so the first line would assign <code>[nil]</code> to the key <code>:yukihiro_matsumoto</code>. The second line would then result in an error."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1566288017, "last_edit_date": 1566288017, "creation_date": 1566285336, "answer_id": 57568441, "question_id": 57568387, "link": "https://stackoverflow.com/questions/57568387/how-can-i-an-add-array-of-values-to-a-key-programatically/57568441#57568441", "title": "How can I an add array of values to a key programatically?", "body": "<p>Assign a new hash to <code>:yukihiro_matsumoto</code> key in the main hash:</p>\n\n<pre><code>programmer_hash[:yukihiro_matsumoto] = { \n  known_for: 'Ruby'\n  languages: ['LISP', 'C']\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "is_accepted": false, "score": 1, "last_activity_date": 1566285775, "creation_date": 1566285775, "answer_id": 57568550, "question_id": 57568387, "link": "https://stackoverflow.com/questions/57568387/how-can-i-an-add-array-of-values-to-a-key-programatically/57568550#57568550", "title": "How can I an add array of values to a key programatically?", "body": "<p>You can merge two hashes. Standard docs for <a href=\"https://apidock.com/ruby/Hash/merge!\" rel=\"nofollow noreferrer\">merge!</a></p>\n\n<pre><code>programmer_hash = {\n    :grace_hopper =&gt; {\n        :known_for =&gt; \"COBOL\",\n        :languages =&gt; [\"COBOL\", \"FORTRAN\"]\n     },\n    :alan_kay =&gt; {\n        :known_for =&gt; \"Object Orientation\",\n        :languages =&gt; [\"Smalltalk\", \"LISP\"]\n     },\n    :dennis_ritchie =&gt; {\n        :known_for =&gt; \"Unix\",\n        :languages =&gt; [\"C\"]\n    }\n}\n</code></pre>\n\n<p>Then you have your another hash like below </p>\n\n<pre><code>another_hash = { \n    :yukihiro_matsumoto =&gt; {\n        :known_for =&gt; \"Ruby\",\n         :languages =&gt; [\"LISP\", \"C\"]\n    }\n}\n</code></pre>\n\n<p>Then you can merge them by - </p>\n\n<pre><code>programmer_hash.merge!(another_hash)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8625461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_sUVbB1HLCA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdtjrKksiVdBicXcyd2DRkOE-MziA/mo/photo.jpg?sz=128", "display_name": "Pouya", "link": "https://stackoverflow.com/users/8625461/pouya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566298468, "creation_date": 1566285132, "last_edit_date": 1566298468, "question_id": 57568387, "link": "https://stackoverflow.com/questions/57568387/how-can-i-an-add-array-of-values-to-a-key-programatically", "title": "How can I an add array of values to a key programatically?", "body": "<p>I am new in Ruby and I wanna add a block of hash to the top of the programmer_hash:</p>\n\n<pre><code>def adding_matz\n    programmer_hash = \n    {\n    :grace_hopper =&gt; {\n      :known_for =&gt; \"COBOL\",\n      :languages =&gt; [\"COBOL\", \"FORTRAN\"]\n    },\n    :alan_kay =&gt; {\n      :known_for =&gt; \"Object Orientation\",\n      :languages =&gt; [\"Smalltalk\", \"LISP\"]\n    },\n    :dennis_ritchie =&gt; {\n      :known_for =&gt; \"Unix\",\n      :languages =&gt; [\"C\"]\n    }\n }\nend\n</code></pre>\n\n<p>This is what I want to add to the top of <code>programmer_hash</code> hash:</p>\n\n<pre><code>:yukihiro_matsumoto =&gt; {\n    :known_for =&gt; \"Ruby\",\n     :languages =&gt; [\"LISP\", \"C\"]\n}\n</code></pre>\n\n<p>I have added the code below at the end of the method:</p>\n\n<pre><code>programmer_hash[:yukihiro_matsumoto] = [:known_for['Ruby']]\nprogrammer_hash[:yukihiro_matsumoto][:languages] = 'LISP'\nprogrammer_hash[:yukihiro_matsumoto][:languages] = 'C'\n</code></pre>\n\n<p>It worked pretty well, but I want to do all of this in one line, but nothing comes out right. I will appreciate your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1566284867, "post_id": 57568246, "comment_id": 101597383, "body": "Thanks for your answer. I have updated an error message."}, {"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1566285697, "post_id": 57568246, "comment_id": 101597741, "body": "Thanks so much for your answer. But I couldn&#39;t. The events are related to the users via tickets (many to many). So I have to define the event not tickets."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1566284997, "last_edit_date": 1566284997, "creation_date": 1566284498, "answer_id": 57568246, "question_id": 57568214, "link": "https://stackoverflow.com/questions/57568214/how-to-call-objects-many-to-many-relationships/57568246#57568246", "title": "How to call objects (many to many relationships)", "body": "<p><code>current_user</code> is <code>nil</code>. It seems that you access this page as a not logged-in user. You need to ensure that the page is not accessible without logging in.</p>\n\n<p>Rails by default generates relation class based on its name. For <code>:join_events</code>, it'll be searching for <code>JoinEvent</code> class. You need to add <code>class_name</code> to you relationship definition:</p>\n\n<pre><code>has_many :join_events, dependent: :destroy, source: :tickets, class_name: 'Ticket'\n</code></pre>\n\n<p>I also guess that you can drop <code>source: :tickets</code></p>\n"}, {"comments": [{"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1566285743, "post_id": 57568400, "comment_id": 101597758, "body": "Thanks but I couldn&#39;t... Although the user has tickets for the event but he couldn&#39;t see the page."}, {"owner": {"reputation": 131, "user_id": 8950142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJSBn.png?s=128&g=1", "display_name": "AhmeDEV49", "link": "https://stackoverflow.com/users/8950142/ahmedev49"}, "reply_to_user": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1566286261, "post_id": 57568400, "comment_id": 101598028, "body": "Could you try : current_user.join_events.where(event: {id: @event }).present?"}], "tags": [], "owner": {"reputation": 131, "user_id": 8950142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJSBn.png?s=128&g=1", "display_name": "AhmeDEV49", "link": "https://stackoverflow.com/users/8950142/ahmedev49"}, "is_accepted": true, "score": 0, "last_activity_date": 1566285516, "last_edit_date": 1566285516, "creation_date": 1566285199, "answer_id": 57568400, "question_id": 57568214, "link": "https://stackoverflow.com/questions/57568214/how-to-call-objects-many-to-many-relationships/57568400#57568400", "title": "How to call objects (many to many relationships)", "body": "<p>You must specify the class for which the association is made ( here Ticket) otherwise it will look for a JoinEvent class :</p>\n\n<pre><code>class_name: 'Ticket'\n</code></pre>\n\n<p>However, are you sure that </p>\n\n<pre><code> current_user.join_events.include?(@event)\n</code></pre>\n\n<p>Allows you to search directly for an event?</p>\n\n<p>Because join_events is just the tickets associated with the user, which themselves are linked to an event. You'll have to request on the joint events (tickets), then on the associated event I think.</p>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57568400, "answer_count": 2, "score": 1, "last_activity_date": 1566553789, "creation_date": 1566284405, "last_edit_date": 1566553789, "question_id": 57568214, "link": "https://stackoverflow.com/questions/57568214/how-to-call-objects-many-to-many-relationships", "title": "How to call objects (many to many relationships)", "body": "<p>I'm working on Rails project. I want to call <code>join_events</code>. But the error occurs. I want only people joined events or the organizer to see event page.</p>\n\n<pre><code>uninitialized constant User::JoinEvent\n</code></pre>\n\n<p><strong>events_controller.rb</strong></p>\n\n<pre><code>def index\n  @event = Event.find_by_slug(params[:slug])\n  unless @event.user === current_user || current_user.join_events.include?(@event)\n    redirect_to root_path\n  end\nend\n</code></pre>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :events, dependent: :destroy\n  has_many :tickets, dependent: :destroy\n\n  has_many :join_events, dependent: :destroy, source: :tickets\nend\n</code></pre>\n\n<p><strong>ticket.rb</strong></p>\n\n<pre><code>class Ticket &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :event\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "null", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 101, "user_id": 7899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be611d4545ff33ed76207b4d88d3e009?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/7899640/vin"}, "edited": false, "score": 0, "creation_date": 1566278117, "post_id": 57566960, "comment_id": 101595086, "body": "try fill your datetime, created_at &amp; updated_at"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1566282226, "creation_date": 1566282226, "answer_id": 57567728, "question_id": 57566960, "link": "https://stackoverflow.com/questions/57566960/sqlite3constraintexception-not-null-constraint-failed-items-title-insert-in/57567728#57567728", "title": "SQLite3::ConstraintException: NOT NULL constraint failed: items.title: INSERT INTO &quot;items&quot; (&quot;image&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES (?, ?, ?)", "body": "<p>Take a closer look at your error message:</p>\n\n<blockquote>\n  <p>SQLite3::ConstraintException: NOT NULL constraint failed: items.title: INSERT INTO \"items\" (\"image\", \"created_at\", \"updated_at\") VALUES (?, ?, ?)</p>\n</blockquote>\n\n<p>It says that failed not null constraint on <code>items.title</code> column. And indeed, you don't provide <code>title</code> in your insert statement. It means that they were not passed to <code>Item.new</code> in your controller code.</p>\n\n<p>I can see two solutions - if you want to keep all those constraints (you have multiple not-null columns in your table), you should also add active record <code>presence</code> validations. They will prevent calling <code>insert</code> statement to the database if values are missing and they will give you nice error messages in <code>@item.error</code>. </p>\n\n<p>If you can allow those columns to be nullable, you can drop the constraint in a migration:</p>\n\n<pre><code>change_column_null :items, :title, false\n</code></pre>\n\n<p>You can also rollback the migration that created <code>items</code> table and edit this migration to avoid setting <code>NOT NULL</code> constraint there.</p>\n\n<p><code>schema.rb</code> is generated when you run migrations and can be used to load schema into a database. It's not done automatically though, you need to run a proper rake task (<code>rake db:schema:load</code>). It's not advisable to edit this file manually, as it's auto-generated and your changes will be automatically overwritten.</p>\n"}], "owner": {"reputation": 21, "user_id": 11866642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5gRM7LIdtAk/AAAAAAAAAAI/AAAAAAAAAr4/V1AlBg5Etho/photo.jpg?sz=128", "display_name": "Yuka Miya", "link": "https://stackoverflow.com/users/11866642/yuka-miya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1566282272, "creation_date": 1566277422, "last_edit_date": 1566282272, "question_id": 57566960, "link": "https://stackoverflow.com/questions/57566960/sqlite3constraintexception-not-null-constraint-failed-items-title-insert-in", "title": "SQLite3::ConstraintException: NOT NULL constraint failed: items.title: INSERT INTO &quot;items&quot; (&quot;image&quot;, &quot;created_at&quot;, &quot;updated_at&quot;) VALUES (?, ?, ?)", "body": "<p>I am developing a simple app where a user can add a subject to a cart. But there is an error about not null constraint. </p>\n\n<p>The error message browser shows is like that.</p>\n\n<blockquote>\n  <p>SQLite3::ConstraintException: NOT NULL constraint failed: items.title: INSERT INTO \"items\" (\"image\", \"created_at\", \"updated_at\") VALUES (?, ?, ?)</p>\n</blockquote>\n\n<p>I've tried deleting not null constraint in <code>schema.rb</code>. But the error message is still on. So, what should I do?</p>\n\n<p>Schema:</p>\n\n<pre><code>create_table \"items\", force: :cascade do |t|\n    t.string \"image\", null: false\n    t.string \"title\", null: false\n    t.string \"description\", null: false\n    t.string \"stock\", null: false\n    t.string \"price\", null: false\n    t.integer \"status\", limit: 1, default: 0, null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>class SellController &lt; ApplicationController\n  def new\n    @item = Item.new\n  end\n\n  def confirm\n  @item = Item.new(title: params[:title],price: params[:price],stock: params[:stock],description: params[:description],image: \"default_item.jpg\")\n  render :new if @item.invalid?\n  end\n\n  def create\n    @item = Item.new(title: params[:title],price: params[:price],stock: params[:stock],description: params[:description],image: \"default_item.jpg\")\n    #@item = Item.new(item_params)\n    if params[:image]\n      @item.image = \"#{@item.id}.jpg\" \n      image = params[:image]\n      File.binwrite(\"public/item_images/#{@item.image}\", image.read)\n    end\n    if params[:back]\n      format.html { render :new }\n    elsif @item.save\n      flash[:notice] = \"your item data is saved.\"\n      redirect_to(\"/sell/complete\")\n    else\n      render(\"sell/new\")\n    end\n  end\n\n  def complete\n  end\nend\n</code></pre>\n\n<p>I expect item data be saved and the page on browser is changed to thanks page.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "helper"], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "is_accepted": true, "score": 1, "last_activity_date": 1566271045, "creation_date": 1566271045, "answer_id": 57566282, "question_id": 57566211, "link": "https://stackoverflow.com/questions/57566211/testing-a-rails-helper-method-that-returns-html-compare-with-plain-text/57566282#57566282", "title": "Testing a Rails helper method that returns HTML, compare with plain text", "body": "<p>I figured out how to do this! I use <code>strip_tags</code> to strip the HTML from the input string.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>expect(\n  strip_tags(helper.add_to_library_event_text(game_purchase_library_event))\n).to eq \"#{user.username} added #{game.name} to their library.\"\n</code></pre>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-strip_tags\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-strip_tags</a></p>\n\n<p>You could also use the <code>sanitize(html_string_goes_here, tags: [])</code> method, but this is simpler as far as I can tell.</p>\n"}, {"comments": [{"owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 1, "creation_date": 1566678916, "post_id": 57638208, "comment_id": 101734372, "body": "Interesting, I wonder what the performance difference between these two versus strip_tags is."}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "reply_to_user": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 0, "creation_date": 1566697280, "post_id": 57638208, "comment_id": 101736800, "body": "Performance is not a great concern here. Either approach is all string manipulation in memory, so it will scroll by faster than you can see. You could run a hundred of these tests in the time of one test with a database write. That said, looking for a substring will be faster than parsing HTML in strip tags."}], "tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": false, "score": 0, "last_activity_date": 1566651836, "creation_date": 1566651836, "answer_id": 57638208, "question_id": 57566211, "link": "https://stackoverflow.com/questions/57566211/testing-a-rails-helper-method-that-returns-html-compare-with-plain-text/57638208#57638208", "title": "Testing a Rails helper method that returns HTML, compare with plain text", "body": "<p>When I want to match particular text within any complex markup (such as HTML), I like to use <code>match</code> or <code>include</code>, something like this:</p>\n\n<pre><code>expect(output).to include \"#{user.username} added #{game.name} to their library.\"\n</code></pre>\n\n<p>or...</p>\n\n<pre><code>expect(output).to match /#{user.username} added #{game.name} to their library./\n</code></pre>\n\n<p>This cuts to the essence of what you're testing, and is very resilient to changes in markup, focusing on the content.</p>\n"}], "owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 57566282, "answer_count": 2, "score": 2, "last_activity_date": 1566651836, "creation_date": 1566270462, "question_id": 57566211, "link": "https://stackoverflow.com/questions/57566211/testing-a-rails-helper-method-that-returns-html-compare-with-plain-text", "title": "Testing a Rails helper method that returns HTML, compare with plain text", "body": "<p>I have this Rails helper method that returns text with links inside it:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def add_to_library_event_text(event)\n  user_link = link_to(event.user.username, user_path(event.user))\n  game_link = link_to(event.game_purchase.game.name, game_path(event.game_purchase.game))\n\n  return user_link + \" added \" + game_link + \" to their library.\"\nend\n</code></pre>\n\n<p>What I want to do is write a spec for it, to make sure it outputs the right text. I don't care much about the exact details of the HTML, and I'd prefer to do this in a helper spec rather than a feature/browser spec since it's much faster.</p>\n\n<p>I have a working test already, it looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>expect(helper.add_to_library_event_text(add_to_library_event)).to eq \\\n  \"&lt;a href=\\\"/users/#{user.username}\\\"&gt;#{user.username}&lt;/a&gt; added &lt;a href=\\\"/games/#{game.id}\\\"&gt;#{game.name}&lt;/a&gt; to their library.\"\n</code></pre>\n\n<p>I'm hoping there's some way that I haven't found yet that will allow me to strip out the HTML from this, so I can write a comparison like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>expect(helper.add_to_library_event_text(add_to_library_event)).to eq \\\n  \"#{user.username} added #{game.name} to their library.\"\n</code></pre>\n\n<p>Is there anything in RSpec/Rails that'd allow me to strip the HTML from this?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 9010, "user_id": 2588800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/847da843d41921363502159c8b7e5549?s=128&d=identicon&r=PG", "display_name": "Svetlin Zarev", "link": "https://stackoverflow.com/users/2588800/svetlin-zarev"}, "edited": false, "score": 1, "creation_date": 1566292996, "post_id": 57566059, "comment_id": 101601502, "body": "What are your table definitions ?"}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "edited": false, "score": 0, "creation_date": 1566373642, "post_id": 57566537, "comment_id": 101631329, "body": "@somethingsomeone were you able to solve your problem?"}], "tags": [], "owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1566273578, "creation_date": 1566273578, "answer_id": 57566537, "question_id": 57566059, "link": "https://stackoverflow.com/questions/57566059/how-to-filter-based-on-a-joined-tables-relations/57566537#57566537", "title": "How to filter based on a joined tables relations?", "body": "<p>If it doesn't have to be strictly SQL based solution you can always use Ruby and Rails to look for this homes.</p>\n\n<p>You can use <code>select</code> method on <code>Home.all</code> collection to return all elements which pass the condition provided in block. Just like this:</p>\n\n<pre><code>Home.all.select { |h| h.users.map(&amp;:role).exclude?('owner') &amp;&amp; h.users.count &lt; 3 }\n</code></pre>\n\n<p>Please note that <code>exclude?</code> is Rails method if you would like to use Ruby based solution you can always reach for <code>include?</code> and place <code>!</code> in front of the statement.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 36, "user_id": 10247524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0415989ac430a5ed390b142cf74bed8?s=128&d=identicon&r=PG&f=1", "display_name": "somethingsomeone", "link": "https://stackoverflow.com/users/10247524/somethingsomeone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566273578, "creation_date": 1566268952, "question_id": 57566059, "link": "https://stackoverflow.com/questions/57566059/how-to-filter-based-on-a-joined-tables-relations", "title": "How to filter based on a joined tables relations?", "body": "<p>I don't write much raw SQL so I apologize in advance. Most of my necessary queries resolve within the framework's methods &amp; active record. Hopefully I can explain my question well: I have 3 models:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Home &lt; ApplicationRecord\n\nhas_and_belongs_to_many :users\n# has an attribute \"max_number\" with the maximum number of users allowed to belong.\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ApplicationRecord\n\nhas_and_belongs_to_many :homes\nhas_many :roles, as: :roleable\n\n</code></pre>\n\n<pre><code>class Role &lt; ApplicationRecord\n\nbelongs_to :roleable, polymorphic: true\n# has an attribute \"name\" with the name of the role\n</code></pre>\n\n<p>I want to fetch all of the homes that have users with any role name except for \"owner\" and with a max # of 2 users associated. I've tried a number of things similar to this query:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Home.joins(user: :roles).group('user.id').having('COUNT(CASE WHEN roles.name != \"owner\" THEN 1 END) &gt; max_number')\n</code></pre>\n\n<p>But this does not yield the intended result. This seems to includes records that already have 2 users belonging, and does not seem to be impacted by the <code>roles.name</code> portion.</p>\n\n<p>My wording may be confusing: I essentially need to be able to count the number of roles without name \"owner\" of a user and fetch homes based on that being less than 2.</p>\n\n<p>Any pointers would be greatly appreciated, thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1566270002, "creation_date": 1566270002, "answer_id": 57566172, "question_id": 57566028, "link": "https://stackoverflow.com/questions/57566028/how-to-create-a-class-that-serializes-to-json-that-represents-a-calender-view/57566172#57566172", "title": "How to create a class that serializes to json that represents a calender view?", "body": "<pre><code>class Calendar\n    def initialize(month, data)\n        @month = month\n        @data = data\n    end\n\n    def to_json\n        {'month': @month, \n         'data': @data\n        }.to_json\n    end\nend\n\n\ncal = Calendar.new('jan', [{'day': '1'}])\ncal.to_json\n</code></pre>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 57566172, "answer_count": 1, "score": 0, "last_activity_date": 1566276511, "creation_date": 1566268665, "last_edit_date": 1566276511, "question_id": 57566028, "link": "https://stackoverflow.com/questions/57566028/how-to-create-a-class-that-serializes-to-json-that-represents-a-calender-view", "title": "How to create a class that serializes to json that represents a calender view?", "body": "<p>I need to create a class that serializes into JSON but it isn't a active record model.</p>\n\n<p>I basically want to render a calender month in JSON that I will then render using Reactjs.</p>\n\n<p>So the properties should be:</p>\n\n<ol>\n<li>name of month</li>\n<li>list of days of the month, but with attributes like:</li>\n</ol>\n\n<pre><code>[{\"day\": \"Thursday\", \"value\": 1, \"date\": \"2019-08-1\"},\n {\"day\": \"Friday\", \"value\": 2, \"date\": \"2019-08-2\"},...]\n</code></pre>\n\n<p>What is the best way to create a class like this that will serialize to JSON easily also?</p>\n"}, {"tags": ["ruby", "fail2ban"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1566276474, "post_id": 57565805, "comment_id": 101594744, "body": "What suggested command (<code>grep -a PATH= &#47;proc&#47;`pidof -x fail2ban-server`&#47;environ</code>) returns?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6902754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11853bf0680cbc4af0e37018d0b3caf?s=128&d=identicon&r=PG&f=1", "display_name": "Anil Ahir", "link": "https://stackoverflow.com/users/6902754/anil-ahir"}, "is_accepted": false, "score": -1, "last_activity_date": 1577983596, "last_edit_date": 1577983596, "creation_date": 1577979884, "answer_id": 59566088, "question_id": 57565805, "link": "https://stackoverflow.com/questions/57565805/fail2ban-command-not-found-when-executing-banaction/59566088#59566088", "title": "fail2ban &quot;command not found&quot; when executing banaction", "body": "<p>You can restart the fail2ban and check it again:</p>\n\n<pre><code>sudo systemctl restart fail2ban\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6902754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11853bf0680cbc4af0e37018d0b3caf?s=128&d=identicon&r=PG&f=1", "display_name": "Anil Ahir", "link": "https://stackoverflow.com/users/6902754/anil-ahir"}, "is_accepted": false, "score": 0, "last_activity_date": 1578035798, "creation_date": 1578035798, "answer_id": 59574591, "question_id": 57565805, "link": "https://stackoverflow.com/questions/57565805/fail2ban-command-not-found-when-executing-banaction/59574591#59574591", "title": "fail2ban &quot;command not found&quot; when executing banaction", "body": "<p>You can enable fail2ban debug mode &amp; check fail2ban log for more details.</p>\n\n<pre><code># change fail2ban log level\nsudo nano /etc/fail2ban/fail2ban.conf\nloglevel = DEBUG \n\n# restart fail2ban\nsudo systemctl restart fail2ban\n\n# check logs\ntail -f /var/log/fail2ban.log\n</code></pre>\n"}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 775, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1578035798, "creation_date": 1566266425, "last_edit_date": 1566269911, "question_id": 57565805, "link": "https://stackoverflow.com/questions/57565805/fail2ban-command-not-found-when-executing-banaction", "title": "fail2ban &quot;command not found&quot; when executing banaction", "body": "<p>One of the actions for fail2ban is configured to run a ruby script; however, fail2ban fails when trying to execute the ruby script with a \"Command not found\" error. I don't understand this error because I'm providing the full path to the ruby script and it has execution permissions:</p>\n\n<p>Here's my fail2ban action:</p>\n\n<pre><code>[root:a17924e746f0:~]# cat /etc/fail2ban/action.d/404.conf\n# Fail2Ban action configuration file for Subzero/Core\n\n[Definition]\nactionstart =\nactionstop =\nactioncheck =\nactionban = /root/ban_modify.rb ban &lt;ip&gt;\nactionunban = /root/ban_modify.rb unban &lt;ip&gt;\n</code></pre>\n\n<p>Here are the contents to the <code>/root/ban_modify.rb</code> script:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\ncommand = ARGV[0]\nip_address = ARGV[1]\n\nblacklist = File.open(\"/root/blacklist.txt\").read.split(\"\\n\")\n\nif command == \"unban\"\n  if blacklist.include? \"#{ip_address} deny\"\n    blacklist.delete \"#{ip_address} deny\"\n  end\nelsif command == \"ban\"\n  blacklist &lt;&lt; \"#{ip_address} deny\"\nend\n\nFile.open(\"/root/blacklist.txt\", \"w\") {|f| f.write(blacklist.join(\"\\n\"))}\n</code></pre>\n\n<p>Very simple. This <code>blacklist.txt</code> file is used by Apache to permanently ban individuals from the web server when a fail2ban condition is met.</p>\n\n<p>However, when I issue the following command: <code>sudo /usr/bin/fail2ban-client set 404 unbanip &lt;my ip&gt;</code></p>\n\n<p>I get the following error:</p>\n\n<pre><code>2019-08-19 20:56:43,508 fail2ban.utils          [16176]: Level 39 7ff7395873f0 -- exec: ban_modify.rb ban &lt;myip&gt;\n2019-08-19 20:56:43,509 fail2ban.utils          [16176]: ERROR   7ff7395873f0 -- stderr: '/bin/sh: 1: ban_modify.rb: not found'\n2019-08-19 20:56:43,509 fail2ban.utils          [16176]: ERROR   7ff7395873f0 -- returned 127\n2019-08-19 20:56:43,509 fail2ban.utils          [16176]: INFO    HINT on 127: \"Command not found\".  Make sure that all commands in 'ban_modify.rb ban &lt;myip&gt;' are in the PATH of fail2ban-server process (grep -a PATH= /proc/`pidof -x fail2ban-server`/environ). You may want to start \"fail2ban-server -f\" separately, initiate it with \"fail2ban-client reload\" in another shell session and observe if additional informative error messages appear in the terminals.\n2019-08-19 20:56:43,509 fail2ban.actions        [16176]: ERROR   Failed to execute ban jail '404' action '404' info 'ActionInfo({'ip': '&lt;myip&gt;', 'family': 'inet4', 'ip-rev': '&lt;myip&gt;.', 'ip-host': '&lt;myip&gt;', 'fid': '&lt;myip&gt;', 'failures': 1, 'time': 1566266203.3465006, 'matches': '', 'restored': 0, 'F-*': {'matches': [], 'failures': 1}, 'ipmatches': '', 'ipjailmatches': '', 'ipfailures': 1, 'ipjailfailures': 1})': Error banning &lt;myip&gt;\n</code></pre>\n\n<p>I'm not sure why this error is happening if the actionban is pointing to the full path of a ruby script. </p>\n\n<p>I even tried changing the contents of <code>/root/ban_modify.rb</code> to just simply <code>puts \"Hello World\"</code>. Tried changing the banaction to iptables-allports and that still failed. It seems like banaction just simply doesn't work.</p>\n"}, {"tags": ["ruby", "hash", "symbols"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6102010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c967310070b7b2e95c067bae7e0ce39f?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/6102010/rishi"}, "edited": false, "score": 0, "creation_date": 1566357295, "post_id": 57565867, "comment_id": 101626545, "body": "Thanks! Seems like the <code>to_s</code> solution is probably best practice."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1566266915, "creation_date": 1566266915, "answer_id": 57565867, "question_id": 57565683, "link": "https://stackoverflow.com/questions/57565683/ruby-2-6-3-warn-a-hash-with-a-symbol-as-key-produces-argumenterror/57565867#57565867", "title": "Ruby 2.6.3 - &#39;warn&#39; a hash with a symbol as key produces ArgumentError", "body": "<p>Since like forever, Ruby allowed to drop the curly braces around hash-as-last-argument in method calls to allow for keyword-like arguments. This allowed Rails to do e.g.</p>\n\n<pre><code>link_to \"Delete\", @item, method: \"delete\"\n</code></pre>\n\n<p>which is interpreted as</p>\n\n<pre><code>link_to(\"Delete\", @item, { method: \"delete\" })\n</code></pre>\n\n<p>Then Ruby got support for keyword arguments, but they had to be hacked in, in a way that will still make all the old code running. So keyword arguments are <em>also</em> treated as if they were this argument-final hash. The problem for you is this: if there are keyword arguments in the signature, then the keyword arguments are strictly checked against the signature; you can't have extra keyword arguments, just like you can't have extra positional arguments. Remember, these are all equivalent:</p>\n\n<pre><code>warn h\nwarn({ one: 1 })\nwarn(one: 1)\n</code></pre>\n\n<p>Ruby sees a positional argument in the signature, and takes a look if the last argument that was passed is a hash. It is, so it assumes it's the keyword argument hash that it needs to compare to the signature - and <code>one:</code> is not a valid keyword.</p>\n\n<p>What to do? Make sure the hash is not the last argument. At a trivial level, you can do this:</p>\n\n<pre><code>warn h, \"was my hash\"\n# {:one=&gt;1}\n# was my hash\n</code></pre>\n\n<p>The other thing you can do is to remember that <code>warn</code> wants a string; if it doesn't get one, it will stringify the arguments. So you can do it preemptively:</p>\n\n<pre><code>warn h.to_s\n# {:one=&gt;1}\n</code></pre>\n\n<p>tl;dr: Ruby keyword arguments are weird.</p>\n"}], "owner": {"reputation": 11, "user_id": 6102010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c967310070b7b2e95c067bae7e0ce39f?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/6102010/rishi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566266915, "creation_date": 1566264913, "question_id": 57565683, "link": "https://stackoverflow.com/questions/57565683/ruby-2-6-3-warn-a-hash-with-a-symbol-as-key-produces-argumenterror", "title": "Ruby 2.6.3 - &#39;warn&#39; a hash with a symbol as key produces ArgumentError", "body": "<p>Using Ruby 2.6.3, I'm coming across a bug where an ArgumentError is thrown when I try to 'warn' a hash that has at least one key as a symbol. If I try to 'puts' the same hash, there is no error and the hash is printed normally.</p>\n\n<pre><code> &gt;&gt; h = {:one =&gt; 1}\n  =&gt; {:one=&gt;1}\n\n &gt;&gt; puts h\n {:one=&gt;1}\n  =&gt; nil\n\n &gt;&gt; warn h\n  Traceback (most recent call last):\n    5: from /Users/rishi/.rvm/rubies/ruby-2.6.3/bin/irb:23:in `&lt;main&gt;'\n    4: from /Users/rishi/.rvm/rubies/ruby-2.6.3/bin/irb:23:in `load'\n    3: from /Users/rishi/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `&lt;top (required)&gt;'\n    2: from (irb):48\n    1: from /Users/rishi/.rvm/rubies/ruby-2.6.3/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_warn.rb:15:in `block in &lt;module:Kernel&gt;' \n  ArgumentError (unknown keyword: one) \n</code></pre>\n\n<p>It seems to be throwing the error at line 15 of my kernel_warn.rb:</p>\n\n<pre><code>module_function define_method(:warn) {|*messages, uplevel: nil|\n   ...\n</code></pre>\n\n<p>Can anyone advise on how to fix?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rack"], "comments": [{"owner": {"reputation": 2936, "user_id": 2765277, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000395317275/picture?type=large", "display_name": "Jo&#227;o Paulo Motta", "link": "https://stackoverflow.com/users/2765277/jo%c3%a3o-paulo-motta"}, "edited": false, "score": 1, "creation_date": 1566268268, "post_id": 57565643, "comment_id": 101593287, "body": "If you are using Chrome and want to inspect the request you can open the developer tools, choose the Network tab, and check the box &quot;Preserve log&quot;.   Click on your save button and the request to /rooms/11 will show up on the list with all sorts of useful information."}], "answers": [{"tags": [], "owner": {"reputation": 2936, "user_id": 2765277, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000395317275/picture?type=large", "display_name": "Jo&#227;o Paulo Motta", "link": "https://stackoverflow.com/users/2765277/jo%c3%a3o-paulo-motta"}, "is_accepted": true, "score": 4, "last_activity_date": 1566290021, "last_edit_date": 1566290021, "creation_date": 1566267087, "answer_id": 57565884, "question_id": 57565643, "link": "https://stackoverflow.com/questions/57565643/whats-the-actual-url-rails-generated-for-http-verb-patch/57565884#57565884", "title": "What&#39;s the actual URL Rails generated for HTTP Verb PATCH?", "body": "<p>No, the URL generated by <code>app.room_path(11)</code> is <code>http://localhost:3000/rooms/11</code>.</p>\n\n<p>PATCH, PUT, DELETE and POST are called HTTP verbs. <em>CREATE is not an HTTP verb.</em></p>\n\n<p>One of these verbs goes along with your request, and Rails Router uses it to route the request to the correct Controller and Action.</p>\n\n<p>Requests can have parameters, likes the one you showed here:\n<code>{\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"JHiCJ6HoTsgd8SGgLTFiZ9+J9hS9U8hHGvjKf4Lz3uieQ8OO2eFqFEM/D5xocHp/Nd3eA0az9k+okrmNe65BYg==\", \"room\"=&gt;{\"home_type\"=&gt;\"Apartment\", \"room_type\"=&gt;\"Private\", \"accommodate\"=&gt;\"3\", \"bed_room\"=&gt;\"4\", \"bath_room\"=&gt;\"3\"}, \"commit\"=&gt;\"Save\", \"id\"=&gt;\"11\"}</code> </p>\n\n<p>When you clicked on the Save button your browser requested <code>http://localhost:3000/rooms/11</code>  using the HTTP verb POST. The parameters were encoded on the body of the request.</p>\n\n<p>A good place to learn more about this would be the <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">Rails routing guide</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": false, "score": 3, "last_activity_date": 1566267497, "creation_date": 1566267497, "answer_id": 57565923, "question_id": 57565643, "link": "https://stackoverflow.com/questions/57565643/whats-the-actual-url-rails-generated-for-http-verb-patch/57565923#57565923", "title": "What&#39;s the actual URL Rails generated for HTTP Verb PATCH?", "body": "<p><a href=\"https://i.stack.imgur.com/J4td5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J4td5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the result from <code>rake routes</code> command. As you can see, GET, PATCH and PUT share the same generated URL (/rooms/:id, in your example /rooms/11). Since Rails 4.0, PATCH is the default verb to update action. Update action is triggered when you're sending a form to a route.</p>\n"}], "owner": {"reputation": 21, "user_id": 5294701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135d91624367f8521e1595f2ffb8428b?s=128&d=identicon&r=PG", "display_name": "Zakir Jaafar", "link": "https://stackoverflow.com/users/5294701/zakir-jaafar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 1, "accepted_answer_id": 57565884, "answer_count": 2, "score": 0, "last_activity_date": 1566299282, "creation_date": 1566264520, "last_edit_date": 1566299282, "question_id": 57565643, "link": "https://stackoverflow.com/questions/57565643/whats-the-actual-url-rails-generated-for-http-verb-patch", "title": "What&#39;s the actual URL Rails generated for HTTP Verb PATCH?", "body": "<p>Please bear with a newbie. I understand how Rails provides simple request with GET for simple URL links like <code>localhost:3000/rooms/11/listing</code>. The format is straight forward as stated in the Routes table. However I am confuse when it comes to PATCH, PUT, DELETE &amp; CREATE. For example the output below, with params, was when I clicked SAVE button. My question, what's the actual URL that Rails generated when I clicked that SAVE button? </p>\n\n<pre><code>Started PATCH \"/rooms/11\" for 127.0.0.1 at 2019-08-20 05:25:32 +0800\n(0.8ms)  SELECT \"schema_migrations\".\"version\" FROM \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\n  \u21b3 /usr/local/rvm/gems/ruby-2.6.0/gems/activerecord-5.2.2/lib/active_record/log_subscriber.rb:98\nProcessing by RoomsController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"JHiCJ6HoTsgd8SGgLTFiZ9+J9hS9U8hHGvjKf4Lz3uieQ8OO2eFqFEM/D5xocHp/Nd3eA0az9k+okrmNe65BYg==\", \"room\"=&gt;{\"home_type\"=&gt;\"Apartment\", \"room_type\"=&gt;\"Private\", \"accommodate\"=&gt;\"3\", \"bed_room\"=&gt;\"4\", \"bath_room\"=&gt;\"3\"}, \"commit\"=&gt;\"Save\", \"id\"=&gt;\"11\"}\n</code></pre>\n\n<p>I know from console </p>\n\n<pre><code>app.room_path(11)\n =&gt; \"/rooms/11\" \n</code></pre>\n\n<p>Is this Rails generated URL <code>localhost:3000/rooms/11{\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"JHiCJ6HoTsgd8SGgLTFiZ9+J9hS9U8hHGvjKf4Lz3uieQ8OO2eFqFEM/D5xocHp/Nd3eA0az9k+okrmNe65BYg==\", \"room\"=&gt;{\"home_type\"=&gt;\"Apartment\", \"room_type\"=&gt;\"Private\", \"accommodate\"=&gt;\"3\", \"bed_room\"=&gt;\"4\", \"bath_room\"=&gt;\"3\"}, \"commit\"=&gt;\"Save\", \"id\"=&gt;\"11\"}</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activestorage"], "comments": [{"owner": {"reputation": 1171, "user_id": 545994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c7e763dc590dcc36ffc690b06d3a8b?s=128&d=identicon&r=PG", "display_name": "ahmeij", "link": "https://stackoverflow.com/users/545994/ahmeij"}, "edited": false, "score": 0, "creation_date": 1566388659, "post_id": 57564796, "comment_id": 101639446, "body": "Is this on rails 6?  on rails 5.2 this worked, I&#39;m facing the same problem on rails 6 where download or download_to methods seem to fail if the record is not yet saved. Looks related to this change: <a href=\"https://github.com/rails/rails/pull/33303\" rel=\"nofollow noreferrer\">github.com/rails/rails/pull/33303</a>"}], "answers": [{"comments": [{"owner": {"reputation": 839, "user_id": 705236, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665c950af17d747b396da1010fa7b1e5?s=128&d=identicon&r=PG", "display_name": "Frank", "link": "https://stackoverflow.com/users/705236/frank"}, "edited": false, "score": 1, "creation_date": 1566303636, "post_id": 57565254, "comment_id": 101607271, "body": "I <i>want</i> to access the file <code>before_save</code> because I don&#39;t want to have to write to the database twice."}], "tags": [], "owner": {"reputation": 119, "user_id": 9559266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CuDynlDo9CA/AAAAAAAAAAI/AAAAAAAABzQ/-Pj97ngfbvg/photo.jpg?sz=128", "display_name": "Hisham Magdy", "link": "https://stackoverflow.com/users/9559266/hisham-magdy"}, "is_accepted": false, "score": 0, "last_activity_date": 1566259902, "creation_date": 1566259902, "answer_id": 57565254, "question_id": 57564796, "link": "https://stackoverflow.com/questions/57564796/reading-from-active-storage-attachment-before-save/57565254#57565254", "title": "Reading from Active Storage Attachment Before Save", "body": "<p>you use <code>before_save :set_name</code> which call the file before it actually being saved you can use <code>after_save</code> instead </p>\n\n<ol>\n<li>try to use <a href=\"https://api.rubyonrails.org/v5.2.3/classes/ActionDispatch/Routing/UrlFor.html\" rel=\"nofollow noreferrer\">url_for()</a> funtion <code>file = JSON.parse(url_for(hlx_file))</code></li>\n<li>also dont forget to <code>include Rails.application.routes.url_helpers</code> at your model</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1171, "user_id": 545994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c7e763dc590dcc36ffc690b06d3a8b?s=128&d=identicon&r=PG", "display_name": "ahmeij", "link": "https://stackoverflow.com/users/545994/ahmeij"}, "is_accepted": true, "score": 6, "last_activity_date": 1566464936, "last_edit_date": 1566464936, "creation_date": 1566389684, "answer_id": 57591408, "question_id": 57564796, "link": "https://stackoverflow.com/questions/57564796/reading-from-active-storage-attachment-before-save/57591408#57591408", "title": "Reading from Active Storage Attachment Before Save", "body": "<p>Rails 6 changed the moment of uploading the file to storage to during the actual save of the record.</p>\n\n<p>This means that a before_save or validation cannot access the file the regular way.</p>\n\n<p>If you need to access the newly uploaded file you can get a file reference like this:</p>\n\n<pre><code>record.attachment_changes['&lt;attributename&gt;'].attachable\n</code></pre>\n\n<p>This will be a tempfile of the to-be-attached file. </p>\n\n<p>NOTE: The above is an undocumented internal api and subject to change (<a href=\"https://github.com/rails/rails/pull/37005\" rel=\"noreferrer\">https://github.com/rails/rails/pull/37005</a>)</p>\n"}], "owner": {"reputation": 839, "user_id": 705236, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665c950af17d747b396da1010fa7b1e5?s=128&d=identicon&r=PG", "display_name": "Frank", "link": "https://stackoverflow.com/users/705236/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2219, "favorite_count": 0, "accepted_answer_id": 57591408, "answer_count": 2, "score": 1, "last_activity_date": 1566464936, "creation_date": 1566255081, "question_id": 57564796, "link": "https://stackoverflow.com/questions/57564796/reading-from-active-storage-attachment-before-save", "title": "Reading from Active Storage Attachment Before Save", "body": "<p>I have users uploading JSON files as part of a model called <code>Preset</code>, very standard Active Storage stuff. One thing that's somewhat out of the ordinary (I suppose, given my inability to make it work) is that I'd like to grab data from the uploaded JSON file and use it to annotate the <code>Preset</code> record, like so:</p>\n\n<pre><code>class Preset &lt; ApplicationRecord\n    has_one_attached :hlx_file\n    before_save :set_name\n\n    def set_name\n        file = JSON.parse(hlx_file.download)\n        self.name = file['data']['name']\n    end\nend\n</code></pre>\n\n<p>When I call hlx_file.download I get <code>ActiveStorage::FileNotFoundError: ActiveStorage::FileNotFoundError</code>.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "is_accepted": true, "score": 2, "last_activity_date": 1566265210, "creation_date": 1566265210, "answer_id": 57565707, "question_id": 57564725, "link": "https://stackoverflow.com/questions/57564725/how-to-get-the-crc32-checksum-out-of-a-large-file-with-ruby/57565707#57565707", "title": "How to get the CRC32 checksum out of a large file with Ruby?", "body": "<p>It's the solution I found, but I think there's room for improvement.</p>\n\n<pre><code>require \"zlib\"\n\ncrc32 = \"\"\nrange = 104857600 #100MB\n\nFile.open(\"video.mkv\") do |f|\n    while byte = f.read(range)       \n        begin\n            crc32 = Zlib::crc32(byte, crc32)\n        rescue\n            crc32 = Zlib::crc32(byte)\n        end         \n    end\nend\n\nputs crc32.to_s(16)\n</code></pre>\n\n<p>For a 3GB file it took 2 minutes.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 57565707, "answer_count": 1, "score": 1, "last_activity_date": 1566265210, "creation_date": 1566254555, "question_id": 57564725, "link": "https://stackoverflow.com/questions/57564725/how-to-get-the-crc32-checksum-out-of-a-large-file-with-ruby", "title": "How to get the CRC32 checksum out of a large file with Ruby?", "body": "<p>This code works for the sha256 hash, even if the files are large:</p>\n\n<pre><code>require \"digest\"\n\nsha256 = Digest::SHA256.file \"video.mkv\"\nputs \"Checksum SHA256: #{sha256.hexdigest}\"\n</code></pre>\n\n<p>But what I need is the CRC32 value and Zlib only works for string and small files.</p>\n\n<pre><code>require \"zlib\"\n\ncalc = IO.binread(\"video.mkv\")\ncrc32 = Zlib.crc32(calc) \n\n# file too big for single read (IOError)\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "is_accepted": true, "score": 1, "last_activity_date": 1566275325, "creation_date": 1566275325, "answer_id": 57566743, "question_id": 57564548, "link": "https://stackoverflow.com/questions/57564548/why-private-repo-requires-rb-file-for-a-custom-gem/57566743#57566743", "title": "Why private repo requires *.rb file for a custom gem?", "body": "<p>A <code>*.gem</code> file is really just a zip file that contains the contents (source code and other metadata) of your gem.</p>\n\n<p>It is also a build artifact that developers don't usually check into a repo as it can be reproduced from the source code. And indeed, the contents of the <code>*.gem</code> archive are the source code of the gem, so checking it in would be duplicating the contents of the repo.</p>\n\n<p>For that reason, when Bundler implemented installing gems from a git source (the <code>gem install</code> command itself doesn't support this) it <a href=\"https://bundler.io/guides/git.html\" rel=\"nofollow noreferrer\">required the git repo to include the source code and a <code>.gemspec</code> file</a>. From this it will actually build a <code>*.gem</code> file and then install it with <code>gem install</code>. Bundler is not set up and doesn't expect there to be a <code>*.gem</code> file in a repo.</p>\n\n<p>So, what you should do is check in the source code and not the <code>*.gem</code> file.</p>\n"}], "owner": {"reputation": 676, "user_id": 1611925, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/VVlis.jpg?s=128&g=1", "display_name": "Julien Lamarche", "link": "https://stackoverflow.com/users/1611925/julien-lamarche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57566743, "answer_count": 1, "score": 0, "last_activity_date": 1566275325, "creation_date": 1566252943, "question_id": 57564548, "link": "https://stackoverflow.com/questions/57564548/why-private-repo-requires-rb-file-for-a-custom-gem", "title": "Why private repo requires *.rb file for a custom gem?", "body": "<p>I have code from a project I am trying to make into a gem stored in a private git repo so we can re-use it in other projects.</p>\n\n<p>Even though the gem stores the code, the *.rb files containing the code seem to be required.   This would seem redundant to me as the *.rb files are now both in the repo of the gem and the gem itself.     That, or my Gemfile / bundler setup is wrong.</p>\n\n<p>Let's say I make this file:</p>\n\n<pre><code>~/code/holaPrj$ cat &gt; hola.rb \nclass Hola\n\nself.say(lang: :en)\nend\nend\n</code></pre>\n\n<p>... and I build the gem:</p>\n\n<pre><code>~/code/holaPrj$ cat hola.gemspec \nGem::Specification.new do |s|\n  s.name        = 'hola'\n  s.version     = '0.0.1'\n  s.date        = '2019-08-14'\n  s.summary     = \"Custom gem in private repo testing\"\n  s.authors     = [\"Julien Lamarche\"]\n  s.email       = [\"jlam@credil.org\"]\n  s.files       = [\"lib/hola.rb\"]\n  s.license     = 'Nonstandard'\nend\n\n~/code/holaPrj$ rvm default do gem build hola.gemspec \nWARNING:  no homepage specified\nWARNING:  See http://guides.rubygems.org/specification-reference/ for help\n  Successfully built RubyGem\n  Name: hola\n  Version: 0.0.1\n  File: hola-0.0.1.gem\n</code></pre>\n\n<p>I copy this gem to my ~/tmp/, then unpack it.   I can see the files in the file system:</p>\n\n<pre><code>~/code/holaPrj$ cp hola-0.0.1.gem ~/tmp/\n'hola-0.0.1.gem' -&gt; '/home/jlam/tmp/hola-0.0.1.gem'\n\n~/code/holaPrj$ cd ~/tmp/\nlusk 16:33:18 ~/tmp$ rvm default do gem unpack hola-0.0.1.gem \nUnpacked gem: '/home/jlam/tmp/hola-0.0.1'\n\nlusk 16:33:28 ~/tmp$ ls hola-0.0.1/lib/hola.rb \nhola-0.0.1/lib/hola.rb\n</code></pre>\n\n<p><strong>Thus, it is esblish that a *.gem file will contain the ruby files in quesation</strong>.</p>\n\n<p>Copying this gem and the gemspec file into a repo for internal publication:</p>\n\n<pre><code>~/code/holaPrj$ cp hola-0.0.1.gem ../holaGem/\n'hola-0.0.1.gem' -&gt; '../holaGem/hola-0.0.1.gem'\n~/code/holaPrj$ cp hola.gemspec ../holaGem/\n'hola.gemspec' -&gt; '../holaGem/hola.gemspec'\n~/code/holaPrj$ \n\n~/code/holaGem$ git add *\n~/code/holaGem$ git commit -am \"adding the gem and gemspec file\"\n[master (commit racine) 9c7807c] adding the gem and gemspec file\n 2 files changed, 11 insertions(+)\n create mode 100644 hola-0.0.1.gem\n create mode 100644 hola.gemspec\n\n~/code/holaGem$ git remote add origin git+ssh://$ourServer/gems/hola\n~/code/holaGem$ git push origin master\nD\u00e9compte des objets: 4, fait.\nDelta compression using up to 8 threads.\nCompression des objets: 100% (4/4), fait.\n\u00c9criture des objets: 100% (4/4), 1.54 KiB | 0 bytes/s, fait.\nTotal 4 (delta 0), reused 0 (delta 0)\nTo git+ssh://$ourServer/gems/hola\n * [new branch]      master -&gt; master\n</code></pre>\n\n<p>Added in Gemfile:</p>\n\n<pre><code>~/tmp/importMyGem$ cat Gemfile\n\nsource 'https://rubygems.org'\ngit_source(:our_gems){ |repo_name| \"git+ssh://$ourServer/gems/#{repo_name}\" }\n\ngem 'hola', our_gems: 'hola'\n</code></pre>\n\n<p>Then we install it:</p>\n\n<pre><code> ~/tmp/importMyGem$ rvm default do bundle  install \n\nWarning, new version of rvm available '1.29.9-next', you are using older version '1.29.3'.\nYou can disable this warning with:    echo rvm_autoupdate_flag=0 &gt;&gt; ~/.rvmrc\nYou can enable  auto-update  with:    echo rvm_autoupdate_flag=2 &gt;&gt; ~/.rvmrc\nFetching git+ssh://$ourServer/gems/hola\nFetching gem metadata from https://rubygems.org/\nResolving dependencies...\nUsing bundler 2.0.2\nUsing hola 0.0.1 from git+ssh://$ourServer/gems/hola (at master@9c7807c)\nBundle complete! 1 Gemfile dependency, 2 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n</code></pre>\n\n<p>... and bundle knows where it is:</p>\n\n<pre><code>~/tmp/importMyGem$ rvm default do bundle info hola\n  * hola (0.0.1 9c7807c)\n    Summary: Custom gem in private repo testing\n    Path: /usr/local/rvm/gems/ruby-2.3.1/bundler/gems/hola-9c7807c88e90\n\n~/tmp/importMyGem$ ls /usr/local/rvm/gems/ruby-2.3.1/bundler/gems/hola-9c7807c88e90/\nhola-0.0.1.gem  hola.gemspec\n</code></pre>\n\n<p>Loading up irb and the gem:</p>\n\n<pre><code>~/tmp/importMyGem$ rvm default do bundle exec irb\n2.3.1 :001 &gt; require 'hola'\nLoadError: cannot load such file -- hola\n    from (irb):1:in `require'\n    from (irb):1\n    from /usr/local/rvm/rubies/ruby-2.3.1/bin/irb:11:in `&lt;top (required)&gt;'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:74:in `load'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:74:in `kernel_load'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:28:in `run'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/cli.rb:465:in `exec'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor.rb:387:in `dispatch'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/cli.rb:27:in `dispatch'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/base.rb:466:in `start'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/cli.rb:18:in `start'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/exe/bundle:30:in `block in &lt;top (required)&gt;'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/lib/bundler/friendly_errors.rb:124:in `with_friendly_errors'\n    from /usr/local/rvm/gems/ruby-2.3.1/gems/bundler-2.0.2/exe/bundle:22:in `&lt;top (required)&gt;'\n    from /usr/local/rvm/gems/ruby-2.3.1/bin/bundle:23:in `load'\n    from /usr/local/rvm/gems/ruby-2.3.1/bin/bundle:23:in `&lt;main&gt;'\n    from /usr/local/rvm/gems/ruby-2.3.1/bin/ruby_executable_hooks:15:in `eval'\n    from /usr/local/rvm/gems/ruby-2.3.1/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n\n<p>This I would have expected to work.</p>\n\n<p>Lets add the .rb files:</p>\n\n<pre><code> ~/code/holaGem$ cp -r ../holaPrj/lib ./\n'../holaPrj/lib' -&gt; './lib'\n'../holaPrj/lib/hola.rb' -&gt; './lib/hola.rb'\n\n~/code/holaGem$ ls\nhola-0.0.1.gem  hola.gemspec  lib\n\n~/code/holaGem$ git add lib/\n~/code/holaGem$ git commit -am \"adding the .rb files of the gem\"\n[master 1c6ee59] adding the .rb files of the gem\n 1 file changed, 7 insertions(+)\n create mode 100644 lib/hola.rb\n\n~/code/holaGem$ git push origin master \n\nD\u00e9compte des objets: 4, fait.\nDelta compression using up to 8 threads.\nCompression des objets: 100% (3/3), fait.\n\u00c9criture des objets: 100% (4/4), 381 bytes | 0 bytes/s, fait.\nTotal 4 (delta 1), reused 0 (delta 0)\nTo git+ssh://$ourServer/gems/hola\n   9c7807c..1c6ee59  master -&gt; master\n</code></pre>\n\n<p>... and lets upgrade the gem version to 0.0.2 just to make sure we know we have a new gem version (though I suppose the hash in bunlder or the Gemfile.lock would suffice):</p>\n\n<pre><code>~/code/holaGem$ cat hola.gemspec \nGem::Specification.new do |s|\n  s.name        = 'hola'\n  s.version     = '0.0.2'\n  s.date        = '2019-08-14'\n  s.summary     = \"Custom gem in private repo testing\"\n  s.authors     = [\"Julien Lamarche\"]\n  s.email       = [\"jlam@credil.org\"]\n  s.files       = [\"lib/hola.rb\"]\n  s.license     = 'Nonstandard'\nend\n~/code/holaGem$ vi hola.gemspec \n\n~/code/holaGem$ git commit -am \"wo#15499 - project .rb files added\"\n[master 87742bc] wo#15499 - project .rb files added\n 1 file changed, 1 insertion(+), 2 deletions(-)\nlusk 17:51:38 (master) ~/code/holaGem$ git push origin master \nD\u00e9compte des objets: 3, fait.\nDelta compression using up to 8 threads.\nCompression des objets: 100% (3/3), fait.\n\u00c9criture des objets: 100% (3/3), 366 bytes | 0 bytes/s, fait.\nTotal 3 (delta 1), reused 0 (delta 0)\nTo git+ssh://$ourServer/gems/hola\n   1c6ee59..87742bc  master -&gt; master\n</code></pre>\n\n<p>Going to the importing project, importMyGem, I update to 0.0.2!</p>\n\n<pre><code>~/tmp/importMyGem$ rvm default do bundle update\nFetching git+ssh://$ourServer/gems/hola\nFetching gem metadata from https://rubygems.org/\nResolving dependencies...\nUsing bundler 2.0.2\nUsing hola 0.0.2 (was 0.0.1) from git+ssh://$ourServer/gems/hola (at master@87742bc)\nBundle updated!\n</code></pre>\n\n<p>The *.rb files are now there:</p>\n\n<pre><code>$ ls /usr/local/rvm/gems/ruby-2.3.1/bundler/gems/hola-5b37daed4c3a\nhola-0.0.1.gem  hola.gemspec  lib\n</code></pre>\n\n<p>And irb can find the file:</p>\n\n<pre><code>~/tmp/importMyGem$ rvm default do bundle exec irb\n2.3.1 :001 &gt; require 'hola'\n =&gt; true\n</code></pre>\n\n<p>So what's the point of having *.rb files inside the *.gem file if my private git repo requires it's own copy of the *.rb files for the importing project to find the *.rb files?    Or rather, is there something wrong with my bundler or Gemfile setup?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7080630, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rckwt8tUOLo/AAAAAAAAAAI/AAAAAAAABqk/yqPioPpp5Wo/photo.jpg?sz=128", "display_name": "Richard Gamarra", "link": "https://stackoverflow.com/users/7080630/richard-gamarra"}, "edited": false, "score": 0, "creation_date": 1566246996, "post_id": 57563582, "comment_id": 101588900, "body": "Thanks <a href=\"https://stackoverflow.com/users/87189/tadman\">stackoverflow.com/users/87189/tadman</a>, but this column needs to be alphanumerical.  I mentioned: &gt; some users may use it as alphanumeric and others as only numeric.  But the ASCIIabetical &quot;max&quot; makes sense, since <code>&quot;999&quot; &gt; &quot;1000&quot; = true</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 73, "user_id": 7080630, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rckwt8tUOLo/AAAAAAAAAAI/AAAAAAAABqk/yqPioPpp5Wo/photo.jpg?sz=128", "display_name": "Richard Gamarra", "link": "https://stackoverflow.com/users/7080630/richard-gamarra"}, "edited": false, "score": 0, "creation_date": 1566250983, "post_id": 57563582, "comment_id": 101590130, "body": "If you have a mix of alphabetical and numerical values then you need to define a derived sortable value. This could be zero padded, for example, to make things line up properly. The database can&#39;t do it for you since those rules are often ambiguous: Is <code>&quot;A2A2&quot;</code> before or after <code>&quot;A11A1&quot;</code>? Look at <a href=\"https://stackoverflow.com/questions/9173558/postgresql-order-by-issue-natural-sort\">other examples</a> for inspiration."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1566246739, "creation_date": 1566246739, "answer_id": 57563582, "question_id": 57563199, "link": "https://stackoverflow.com/questions/57563199/calculate-the-maximum-number-on-a-string-column-with-active-record/57563582#57563582", "title": "Calculate the maximum number on a string column with active record", "body": "<p>If this is a text column you may be getting the ASCIIabetical \"max\" instead of the numerical max. \"999\" sorts after \"2291\".</p>\n\n<p>You need a numerical column type (e.g. <code>INT</code>) in order to do numerical maximums.</p>\n\n<p>This should be a simple migration to change the column type if those values are purely numerical and fit in a 32-bit or 64-bit integer.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 7080630, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rckwt8tUOLo/AAAAAAAAAAI/AAAAAAAABqk/yqPioPpp5Wo/photo.jpg?sz=128", "display_name": "Richard Gamarra", "link": "https://stackoverflow.com/users/7080630/richard-gamarra"}, "is_accepted": false, "score": 0, "last_activity_date": 1566312228, "creation_date": 1566312228, "answer_id": 57576172, "question_id": 57563199, "link": "https://stackoverflow.com/questions/57563199/calculate-the-maximum-number-on-a-string-column-with-active-record/57576172#57576172", "title": "Calculate the maximum number on a string column with active record", "body": "<p>The definitive solution I found:</p>\n\n<pre><code># Note: the ORDER clause is the KEY. Length means biggest number, ::bytea means sort it alphanumerically\nfiltered_result = Company.where.not(:internal_code =&gt; [nil,'']).where(:company_id =&gt; self.company_id).order(\"length(internal_code) DESC, internal_code::bytea DESC\").first\n\nprevious_number = filtered_result.internal_code.scan(/\\d{2,5}/).last\n</code></pre>\n\n<p>This complexity is given because of the possible values the users can put in this field. E.g.\n<code>\"ABD123\"</code>\n<code>AS2134FG</code>\n<code>AS34SD2342</code></p>\n\n<p>Hope it helps in similar issues. Thanks all.</p>\n"}], "owner": {"reputation": 73, "user_id": 7080630, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rckwt8tUOLo/AAAAAAAAAAI/AAAAAAAABqk/yqPioPpp5Wo/photo.jpg?sz=128", "display_name": "Richard Gamarra", "link": "https://stackoverflow.com/users/7080630/richard-gamarra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566312228, "creation_date": 1566244728, "last_edit_date": 1566246636, "question_id": 57563199, "link": "https://stackoverflow.com/questions/57563199/calculate-the-maximum-number-on-a-string-column-with-active-record", "title": "Calculate the maximum number on a string column with active record", "body": "<p>I have a column called internal_code in my Customer model. Since some users may use it as alphanumeric and others as only numeric, I need to suggest a number to the user before confirmation, in the UI.</p>\n\n<p>I'm using this code right now:</p>\n\n<pre><code>previous_number = Company.where(:company_id =&gt; self.company_id).maximum(:internal_code)\n</code></pre>\n\n<p>But this is not working as expected, given for some reason, sometimes it's returning \"999\" when the latest value is \"1000\", or in another example \"2290\" when the latest value \"2291\".</p>\n\n<p>I've been digging in the official documentation on <em>maximum</em> and <em>calculate</em> for Active Record, but didn't found if it's not intended to work with String columns. Maybe it's just obvious, but I wanted to ask here before I confirm my thoughts.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "module"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1566244650, "post_id": 57563158, "comment_id": 101588007, "body": "You define <code>Pieces::Piece</code> in <code>MainApp&#47;app&#47;lib&#47;game&#47;pieces.rb</code> but are trying to include <code>Game::Piece</code>. That doesn&#39;t make sense, yes?"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1566245583, "post_id": 57563158, "comment_id": 101588351, "body": "You are missing naming convention..."}, {"owner": {"reputation": 13, "user_id": 10912197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c43b59ef08341db0ca53a912bb32da19?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10912197/andrew"}, "edited": false, "score": 0, "creation_date": 1566245879, "post_id": 57563158, "comment_id": 101588481, "body": "I realize that, now :/ thanks"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1566244719, "creation_date": 1566244719, "answer_id": 57563198, "question_id": 57563158, "link": "https://stackoverflow.com/questions/57563158/getting-unable-to-autoload-constant-expected-app-lib-subfolder-module-rb/57563198#57563198", "title": "Getting &quot;Unable to autoload constant&quot; .. &#39;&quot;expected app/lib/subfolder/module.rb to define it&quot;", "body": "<p>You have defined a class <code>Piece</code> in a module <code>Pieces</code>, but you expect a class <code>Piece</code> in a module game. You need to change the code in <code>MainApp/app/lib/game/pieces.rb</code> to</p>\n\n<pre><code>  module Game\n    class Piece\n        def initialize\n           puts \"I'm a piece!\"\n        end\n     end\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 4071960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ix1gBH_SFd8/AAAAAAAAAAI/AAAAAAAAAOM/HfpreXhTJn0/photo.jpg?sz=128", "display_name": "Mike Mulev", "link": "https://stackoverflow.com/users/4071960/mike-mulev"}, "is_accepted": true, "score": 1, "last_activity_date": 1566245088, "creation_date": 1566245088, "answer_id": 57563263, "question_id": 57563158, "link": "https://stackoverflow.com/questions/57563158/getting-unable-to-autoload-constant-expected-app-lib-subfolder-module-rb/57563263#57563263", "title": "Getting &quot;Unable to autoload constant&quot; .. &#39;&quot;expected app/lib/subfolder/module.rb to define it&quot;", "body": "<p>When you include <code>Game::Pieces</code> your module should look like that:</p>\n\n<pre><code>module Game\n  module Pieces\n    # some code here\n  end\nend\n</code></pre>\n\n<p>In addition to that, the preferred way of structuring in Ruby and Rails is to name your directory according to your module name, so your module path would rather be <code>lib/game/pieces.rb</code>.\nAnd please consider including a module, not a class</p>\n"}], "owner": {"reputation": 13, "user_id": 10912197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c43b59ef08341db0ca53a912bb32da19?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/10912197/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 57563263, "answer_count": 2, "score": 1, "last_activity_date": 1566245537, "creation_date": 1566244532, "last_edit_date": 1566245537, "question_id": 57563158, "link": "https://stackoverflow.com/questions/57563158/getting-unable-to-autoload-constant-expected-app-lib-subfolder-module-rb", "title": "Getting &quot;Unable to autoload constant&quot; .. &#39;&quot;expected app/lib/subfolder/module.rb to define it&quot;", "body": "<p>I'm trying to load the module:</p>\n\n<pre><code> #MainApp/app/lib/game/pieces.rb\n  module Pieces\n    class Pawn\n        def initialize\n           puts \"I'm a piece!\"\n        end\n     end\n  end\n</code></pre>\n\n<p>In the model:</p>\n\n<pre><code> # MainApp/app/models/boardgame.rb\n class Boardgame &lt; ApplicationRecord\n   include Game::Pieces\n end\n</code></pre>\n\n<p>But i get \"Unable to autoload constant Game::Pieces, expected /home/..MainApp/app/lib/game/pieces.rb to define it (LoadError)\"   </p>\n\n<p>I tried to set the folder in the autoload_paths and eager_load_paths:</p>\n\n<pre><code> # config/application.rb\n module MainApp\n   class Application &lt; Rails::Application\n      config.load_defaults 5.2\n      config.autoload_paths &lt;&lt; Rails.root.join('app/lib/game')\n      config.eager_load_paths &lt;&lt; Rails.root.join('app/lib/game')\n   end\n end\n</code></pre>\n\n<p>but it still doesn't work, if i put the module in app/lib it loads it perfectly, the problem occurs only in a subfolder.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration", "rails-migrations"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 5, "creation_date": 1566240468, "post_id": 57562280, "comment_id": 101586446, "body": "Why don&#39;t you just use create a new migration in which you use <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-drop_table\" rel=\"nofollow noreferrer\"><code>drop_table</code></a> to delete the table you do not need anymore? Rolling back doesn&#39;t make sense to me if there a newer tables which You want to keep."}, {"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566240670, "post_id": 57562280, "comment_id": 101586531, "body": "@spickermann im lost to why did they recommend that. I&#39;m actually thinking of just dropping the tables in one migration. so rolling back is not a good approach?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566241520, "post_id": 57562280, "comment_id": 101586839, "body": "Rolling back and only re-run the migration that you would like to keep would delete all data in the newer table. I would argue that is not a good idea..."}, {"owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566245841, "post_id": 57562280, "comment_id": 101588472, "body": "I dont know about argue man. I&#39;m just a junior here. but what I know its wrong way of doing it. thank you."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566244135, "post_id": 57562855, "comment_id": 101587785, "body": "As a note, this is an irreversible migration and the tool may bark about that. When you drop a table there&#39;s no way to &quot;un-drop&quot; it."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 2, "last_activity_date": 1566242939, "creation_date": 1566242939, "answer_id": 57562855, "question_id": 57562280, "link": "https://stackoverflow.com/questions/57562280/what-is-the-best-practice-when-it-comes-to-deleting-a-table-in-the-ruby-on-rails/57562855#57562855", "title": "What is the best practice when it comes to deleting a table in the Ruby on Rails migration?", "body": "<p>There will be unsuitable commit if you just comment out migration.</p>\n\n<p>Also you will delete all data in other tables.</p>\n\n<p>So the best practice to drop table via migration like this:</p>\n\n<pre><code>class DropMenuTable &lt; ActiveRecord::Migration\n  def change\n    drop_table :menus\n  end\nend\n\nclass DropMenuRolesTable &lt; ActiveRecord::Migration\n  def change\n    drop_table :menu_roles\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 9559266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CuDynlDo9CA/AAAAAAAAAAI/AAAAAAAABzQ/-Pj97ngfbvg/photo.jpg?sz=128", "display_name": "Hisham Magdy", "link": "https://stackoverflow.com/users/9559266/hisham-magdy"}, "is_accepted": false, "score": 4, "last_activity_date": 1566249757, "last_edit_date": 1566249757, "creation_date": 1566245784, "answer_id": 57563407, "question_id": 57562280, "link": "https://stackoverflow.com/questions/57562280/what-is-the-best-practice-when-it-comes-to-deleting-a-table-in-the-ruby-on-rails/57563407#57563407", "title": "What is the best practice when it comes to deleting a table in the Ruby on Rails migration?", "body": "<ol>\n<li>Generate a migration to drop these tables <code>rails g migration DropMenuTable</code> and <code>rails g migration DropMenuRolesTable</code></li>\n<li>Drop the Tablet by either</li>\n</ol>\n\n<p><strong>migration not reversible</strong></p>\n\n<pre><code>class DropMenuTable &lt; ActiveRecord::Migration\n  def up\n    drop_table :menus\n  end\n\n  def down\n    fail ActiveRecord::IrreversibleMigration\n  end\nend\n</code></pre>\n\n<pre><code>class DropMenuRolesTable &lt; ActiveRecord::Migration\n  def up\n    drop_table :menu_roles\n  end\n\n  def down\n    fail ActiveRecord::IrreversibleMigration\n  end\nend\n</code></pre>\n\n<p>or</p>\n\n<p><strong>migration is reversible</strong></p>\n\n<pre><code>class DropMenuTable &lt; ActiveRecord::Migration\n  def change\n    drop_table :menues do |t|\n      t.string :name\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<pre><code>class DropMenuRolesTable &lt; ActiveRecord::Migration\n  def change\n    drop_table :menu_roles do |t|\n      t.belongs_to :role, class_name: 'Role'\n      t.belongs_to :menu, class_name: 'Menu'\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<ol start=\"3\">\n<li>run <code>rake db:migrate</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2936, "user_id": 2765277, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000395317275/picture?type=large", "display_name": "Jo&#227;o Paulo Motta", "link": "https://stackoverflow.com/users/2765277/jo%c3%a3o-paulo-motta"}, "is_accepted": false, "score": 1, "last_activity_date": 1566267977, "creation_date": 1566267977, "answer_id": 57565964, "question_id": 57562280, "link": "https://stackoverflow.com/questions/57562280/what-is-the-best-practice-when-it-comes-to-deleting-a-table-in-the-ruby-on-rails/57565964#57565964", "title": "What is the best practice when it comes to deleting a table in the Ruby on Rails migration?", "body": "<p>Migrations allow you to evolve your database schema overtime.</p>\n\n<p>When your app is in development it may seem easy to just rollback the migration and make changes, or even delete it. But you shouldn't do it when you have code deployed to production or is sharing code with another developer. Your database will likely become corrupted and will produce hard to fix bugs. </p>\n\n<p>The best thing you can do to delete a table is to create a new migration and <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-drop_table\" rel=\"nofollow noreferrer\">drop_table</a> as suggested by spickermann.</p>\n"}], "owner": {"reputation": 851, "user_id": 7034540, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209364272256116/picture?type=large", "display_name": "aRtoo", "link": "https://stackoverflow.com/users/7034540/artoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1566267977, "creation_date": 1566239959, "last_edit_date": 1566252797, "question_id": 57562280, "link": "https://stackoverflow.com/questions/57562280/what-is-the-best-practice-when-it-comes-to-deleting-a-table-in-the-ruby-on-rails", "title": "What is the best practice when it comes to deleting a table in the Ruby on Rails migration?", "body": "<p>I created a few tables last week and I was told to delete them. The suggested way in which I should do it looks like this:</p>\n\n<p><strong>Sample table:</strong></p>\n\n<pre><code>class CreateMenuTable &lt; ActiveRecord::Migration\n  def change\n    create_table :menus do |t|\n      t.string :name\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<pre><code>class CreateSpreeMenuRole &lt; ActiveRecord::Migration\n  def change\n    create_table :menu_roles do |t|\n      t.belongs_to :role, class_name: 'Role'\n      t.belongs_to :menu, class_name: 'Menu'\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p><strong>step 1.</strong> <code>bin/rake db:rollback STEP=6</code></p>\n\n<p><strong>step 2.</strong> after rolling back I have to comment out those tables then</p>\n\n<p><strong>step 3.</strong> <code>bin/rake db:migrate</code> </p>\n\n<p>Btw we still have multiple tables created after that, that's why we still need to run <code>migrate</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566240772, "post_id": 57561749, "comment_id": 101586572, "body": "I am afraid that you will not be able to implement this without database checks. There are two reasons why <code>&#47;activity&#47;1</code> might be invalid. 1) the <code>ActivitiesController</code> or its route was removed which is unlikely and easy to detect. And 2) there is no activity with the id <code>1</code> and the only way to discover this is to look into the database."}, {"owner": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566240909, "post_id": 57561749, "comment_id": 101586615, "body": "It&#39;s not about checking DB or not, I just wanted a way to validate ANY route ;/"}, {"owner": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566240969, "post_id": 57561749, "comment_id": 101586641, "body": "@spickermann Like &quot;if tryRoute(activity/&#39;) == false redirect_to(dashboard)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "edited": false, "score": 0, "creation_date": 1566238052, "post_id": 57561876, "comment_id": 101585479, "body": "Either way I&#39;d have to check on that specific value in the DB... Like this, too many things will changes (there are really many pages where this can happen), I wanted a solution that would solve every one of them, like a try-catch"}, {"owner": {"reputation": 1039, "user_id": 558232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aLHwj.jpg?s=128&g=1", "display_name": "shivashankar", "link": "https://stackoverflow.com/users/558232/shivashankar"}, "reply_to_user": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "edited": false, "score": 0, "creation_date": 1566238449, "post_id": 57561876, "comment_id": 101585636, "body": "1. Is it possible to save the last visit page in cookie?  2. In routes.rb       you can try <code>get &#39;*path&#39;, to: &#39;catch_all#index&#39;</code>         May be it gives you some hint"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "edited": false, "score": 0, "creation_date": 1566239381, "post_id": 57561876, "comment_id": 101586008, "body": "@CH4B You will <i>always</i> have to check against the DB, because it&#39;s the values in the DB that determine whether or not the entity being looked up exists. The only thing you need to know is whether or not they&#39;re hitting that page from a last-URL or if they navigated there themselves."}, {"owner": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "edited": false, "score": 0, "creation_date": 1566239421, "post_id": 57561876, "comment_id": 101586026, "body": "unfortunately the cookie is not possible :( thats because, if I were to open the system back at home, it should still take me to the last page I saw."}], "tags": [], "owner": {"reputation": 1039, "user_id": 558232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aLHwj.jpg?s=128&g=1", "display_name": "shivashankar", "link": "https://stackoverflow.com/users/558232/shivashankar"}, "is_accepted": false, "score": 0, "last_activity_date": 1566237921, "creation_date": 1566237921, "answer_id": 57561876, "question_id": 57561749, "link": "https://stackoverflow.com/questions/57561749/how-can-i-validate-my-own-route-before-redirect/57561876#57561876", "title": "How can I validate my own route before redirect?", "body": "<p>How about </p>\n\n<p>1) adding an extra field <code>status</code> in the table \n     and set as 'false' for page which gets deleted.</p>\n\n<p>2) Redirect to the URL only for page which has active <code>status</code> or redirect it to a fallback URL.</p>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 9533591, "user_type": "registered", "profile_image": "https://graph.facebook.com/1977695792258579/picture?type=large", "display_name": "Tomasz S", "link": "https://stackoverflow.com/users/9533591/tomasz-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1566243359, "last_edit_date": 1566243359, "creation_date": 1566239012, "answer_id": 57562096, "question_id": 57561749, "link": "https://stackoverflow.com/questions/57561749/how-can-i-validate-my-own-route-before-redirect/57562096#57562096", "title": "How can I validate my own route before redirect?", "body": "<p>If you need to make it only in case of a user who logs back in via <code>SessionsController</code> here's my suggestion: </p>\n\n<p>You could create some kind of <code>before_action</code> e.g. <code>ensure_first_place_after_login_exists</code> in your <code>SessionsController</code> and <code>rescue</code> from specific errors with redirection to <code>root_path</code> or any other place.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1566242581, "creation_date": 1566242581, "answer_id": 57562784, "question_id": 57561749, "link": "https://stackoverflow.com/questions/57561749/how-can-i-validate-my-own-route-before-redirect/57562784#57562784", "title": "How can I validate my own route before redirect?", "body": "<p>You can use the same method that Rails uses to determine the controller and the other params from the route:</p>\n\n<p>Imagine <code>/activities/1</code> exists:</p>\n\n<pre><code>Rails.application.routes.recognize_path('/activities/1', method: :get)\n#=&gt; {:controller=&gt;\"activites\", :action=&gt;\"show\", :id=&gt;\"1\"}\n</code></pre>\n\n<p>And if that routes doesn't exist anymore:</p>\n\n<pre><code>Rails.application.routes.recognize_path('/activities/1', method: :get)\n#=&gt; raises ActionController::RoutingError (No route matches \"/activities/12\")\n</code></pre>\n\n<p>With this you can build a helper method like:</p>\n\n<pre><code>def redirect_to_last_page(url_from_session)\n  Rails.application.routes.recognize_path(url_from_session, method: :get)\n  redirect_to(url_from_session)\nrescue ActionController::RoutingError\n  redirect_to root_path\nend\n</code></pre>\n\n<p>Keep in mind that it doesn't cover cases like that the URL itself is valid like <code>/activities/1</code> but the activities with the ID <code>1</code> was deleted from the database.</p>\n"}], "owner": {"reputation": 546, "user_id": 9970268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTHi3.png?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9970268/ch4b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 57562784, "answer_count": 3, "score": 1, "last_activity_date": 1566243359, "creation_date": 1566237233, "last_edit_date": 1566239447, "question_id": 57561749, "link": "https://stackoverflow.com/questions/57561749/how-can-i-validate-my-own-route-before-redirect", "title": "How can I validate my own route before redirect?", "body": "<p>Hay! The system I'm working on has the following feature: after your disconnect, the next time you log in, you'll be redirected to the last page you've been. </p>\n\n<p>That info is stored in the DB, as a string called <code>first_place_after_login</code>, and Rails will take the user there. </p>\n\n<p>The problem is that sometimes that route does not exist anymore.</p>\n\n<p>Imagine your last page was 'activity/1', and that activity got deleted, when you log in, you're gonna see an error screen. The main issue with this, is that some users get confused why they hop right into an error when they just entered a 'normal' route (but got redirected to a invalid one).</p>\n\n<p>So, before redirecting my user, I need to make sure that that route still exists, and it would be very bad to create a specific DB check for that (because there are dozens of possible routes that could not exist). So I wanted a way to send a request to my own route, and check the status it returns me.</p>\n\n<p>I've tried this: <a href=\"https://stackoverflow.com/questions/5908017/check-if-url-exists-in-ruby\">Check if URL exists in Ruby</a>, but the system is login-secured, so request returns as without permission.</p>\n\n<p>Is there any practical way for me to validate my own routes?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1566236899, "post_id": 57561517, "comment_id": 101585064, "body": "What is wrong with reading the file and dropping all unwanted bits?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566237610, "post_id": 57561517, "comment_id": 101585328, "body": "I need to read ALL the bits. With the detail that the reading range will change."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566237727, "post_id": 57561517, "comment_id": 101585366, "body": "Can you read the file into an array of bytes, convert each byte to an array of bits, flatten, reverse the array, then read from the array so-many elements at a time?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1566282068, "post_id": 57561517, "comment_id": 101596186, "body": "What do you mean by <i>&quot;reading range&quot;</i> and <i>&quot;every 3 bits, 18 bits, etc&quot;</i>? Can you give an example \u2013 how could such file look like and what would be the expected result?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1566286773, "post_id": 57561517, "comment_id": 101598267, "body": "@talC what is <code>11011</code> \u2013 a string, the integer <code>0b11011</code> i.e. <code>27</code>, or something else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1566354923, "post_id": 57561517, "comment_id": 101626162, "body": "@Stefan Answering your question will mainly be used as integer (27), as said, it can be anything as the case may be, the important thing is to be able to read it in <code>n</code> bits, but yes, integer is more important."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "edited": false, "score": 0, "creation_date": 1566247635, "post_id": 57562809, "comment_id": 101589154, "body": "And yes, the input is binary."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1566248117, "post_id": 57562809, "comment_id": 101589304, "body": "for big files you will need to work with a read buffer, plenty of examples to read big binary files here at stackoverflow, it&#39;s going to be a long task anyway you do it.It would help if you explain what kind of files are your input, how you are going to process the result and what is the final purpose."}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 3, "last_activity_date": 1566242715, "creation_date": 1566242715, "answer_id": 57562809, "question_id": 57561517, "link": "https://stackoverflow.com/questions/57561517/how-to-read-a-file-every-n-bits-in-ruby/57562809#57562809", "title": "How to read a file every &#39;n&#39; bits in ruby?", "body": "<p>Here is a short but not so simple solution.\nAllthough you didn't provide code you allready have, I'm sure you have no difficulty reading the string from a file. Some special consideration would have to be made if the input file were binary.</p>\n\n<pre><code>def string_to_bits text, chunksize = 8\n  StringIO.new(text.unpack('B*').first).each(chunksize).map{|chunk| chunk}\nend\n</code></pre>\n\n<p>Some explanation: <code>String.unpack</code> formats a string, <code>B*</code> means in bits, MostSignificant Bits first. See <a href=\"https://apidock.com/ruby/String/unpack\" rel=\"nofollow noreferrer\">here</a> for the API. It returns an array of one element (hence the following <code>first</code>)\nThis string is converted to an enumarable using <code>StringIO</code>, which has an <code>each(n)</code> method that chops the string in chunks of the desired length. We convert the enumerator back to an array using map.</p>\n\n<p>Use it like this</p>\n\n<pre><code>puts string_to_bits \"this is my text\"\n#=&gt; [\"01110100\", \"01101000\", \"01101001\", \"01110011\", \"00100000\", \"01101001\", \"01110011\", \"00100000\", \"01101101\", \"01111001\", \"00100000\", \"01110100\", \"01100101\", \"01111000\", \"01110100\"]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>puts string_to_bits \"this is my text\", 3\n#=&gt; [\"011\", \"101\", \"000\", \"110\", \"100\", \"001\", \"101\", \"001\", \"011\", \"100\", \"110\", \"010\", \"000\", \"001\", \"101\", \"001\", \"011\", \"100\", \"110\", \"010\", \"000\", \"001\", \"101\", \"101\", \"011\", \"110\", \"010\", \"010\", \"000\", \"001\", \"110\", \"100\", \"011\", \"001\", \"010\", \"111\", \"100\", \"001\", \"110\", \"100\"]\n</code></pre>\n\n<p>[</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 57562809, "answer_count": 1, "score": 0, "last_activity_date": 1566285149, "creation_date": 1566236153, "last_edit_date": 1566285149, "question_id": 57561517, "link": "https://stackoverflow.com/questions/57561517/how-to-read-a-file-every-n-bits-in-ruby", "title": "How to read a file every &#39;n&#39; bits in ruby?", "body": "<p>I need to read a file (from right to left), whose reading range can vary, in some cases it can be every 3 bits, 18 bits, etc...</p>\n\n<p>How to do it?</p>\n\n<p>I'll give an example:</p>\n\n<p>The file is:</p>\n\n<pre><code>file : \"anyway.rar\"\n</code></pre>\n\n<p>The last 10 hexadecimals of this file are:</p>\n\n<p><code>1A 2B DF FA 00 15 02 12 EA 1B</code></p>\n\n<p>I want to read every 3 bits and from right to left. So we started with <code>EA 1B</code> which in binary is:</p>\n\n<p><code>11101010 00011011</code></p>\n\n<p>The reading would be:</p>\n\n<p><code>011 &gt;&gt; 011 &gt;&gt; 000 &gt;&gt; 101...</code></p>\n\n<p>If I want to read every 5 bits the reading would be:</p>\n\n<p><code>11011 &gt;&gt; 10000 &gt;&gt; 11010...</code></p>\n\n<p>The intention is to make a calculation with each group of bits.</p>\n"}, {"tags": ["ruby", "csv", "search", "ldap", "ldap-query"], "answers": [{"comments": [{"owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "edited": false, "score": 0, "creation_date": 1566255186, "post_id": 57564035, "comment_id": 101591170, "body": "Sorry but that doesn&#39;t work, it says &quot;keys&quot; is an undefined method."}, {"owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "edited": false, "score": 0, "creation_date": 1566256066, "post_id": 57564035, "comment_id": 101591353, "body": "Yes, I was going to say that the class turned out to be &quot;Net::LDAP::Entry&quot;"}, {"owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "edited": false, "score": 0, "creation_date": 1566257628, "post_id": 57564035, "comment_id": 101591610, "body": "Unfortunately, map isn&#39;t working either. This is a tricky one."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "reply_to_user": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "edited": false, "score": 0, "creation_date": 1566306556, "post_id": 57564035, "comment_id": 101609071, "body": "Try without a block. I will add the option to my answer."}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1566316205, "last_edit_date": 1566316205, "creation_date": 1566249277, "answer_id": 57564035, "question_id": 57561302, "link": "https://stackoverflow.com/questions/57561302/convert-ldap-search-results-into-csv/57564035#57564035", "title": "Convert LDAP search results into CSV", "body": "<p>The result set returned by default is a bit special: \n<a href=\"https://www.rubydoc.info/gems/ruby-net-ldap/Net/LDAP/Entry\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/ruby-net-ldap/Net/LDAP/Entry</a></p>\n\n<p>I would add the attribute names In the first line of the new CSV file like this:</p>\n\n<pre><code>result_set = ldap.search( :base =&gt; treebase, :filter =&gt; filter )\nCSV.open(\"mysearch.csv\", \"w\") do |csv|\n  csv &lt;&lt; result_set.map { |entry| entry.attribute_names }\n  result_set.each do |entry|\n     csv &lt;&lt; [entry.dn] # add what you need additionally to dn https://www.rubydoc.info/gems/ruby-net-ldap/Net/LDAP/Entry)\n  end\nend\n</code></pre>\n\n<p>P.S. Maybe you need to use result_set.first.attribute_names instead of the map line.</p>\n"}], "owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566316205, "creation_date": 1566235104, "last_edit_date": 1566253889, "question_id": 57561302, "link": "https://stackoverflow.com/questions/57561302/convert-ldap-search-results-into-csv", "title": "Convert LDAP search results into CSV", "body": "<p>I'm currently working on a program that takes the results of an LDAP search and converts it into CSV. I've never worked with LDAP before, only SQL, and I find it a bit challenging. </p>\n\n<p>I'm having trouble getting the LDAP data into a form that will translate well to CSV. I've been trying to use what I learned in SQL to help out, but it's proving to be a bit challenging.</p>\n\n<p>Here's the LDAP server I'm working with.</p>\n\n<h1>example.org</h1>\n\n<pre><code>dn: dc=example,dc=org\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Example Inc.\ndc: example\n\n# admin, example.org\ndn: cn=admin,dc=example,dc=org\nobjectClass: simpleSecurityObject\nobjectClass: organizationalRole\ncn: admin\ndescription: LDAP administrator\nuserPassword: mypassword\n\n# people, example.org\ndn: ou=people,dc=example,dc=org\nobjectClass: organizationalUnit\nou: people\n\n# chris, people, example.org\ndn: uid=jane,ou=people,dc=example,dc=org\nobjectClass: inetOrgPerson\ncn: Chris\nsn: smith\nmail: chris@example.org\nuid: chris\n</code></pre>\n\n<p>And here's the Ruby code I'm using to try to get the data.</p>\n\n<pre><code>ldap = Net::LDAP.new  :host =&gt; '127.0.0.1',\n  :port =&gt; 1300,\n  :auth =&gt; {\n    :method =&gt; :simple,\n    :username =&gt; 'cn=admin,dc=example,dc=org',\n    :password =&gt; 'mypassword'\n}\nfilter = Net::LDAP::Filter.eq( \"cn\", \"Chris*\")\ntreebase = \"dc=example,dc=org\"\n\nldap.search( :base =&gt; treebase, :filter =&gt; filter ) do |entry|\n  CSV.open(\"mysearch.csv\", \"w\") do |csv|\n  puts \"DN: #{entry.dn}\"\n  entry.each do |attribute, values|\n    search_array.push(attribute)\n    values.each do |value|\n     csv &lt;&lt; [attribute, values]\n     data_array.push(values)\n    end\n    end\n  end\nend\n</code></pre>\n\n<p>When I try to load it up in a CSV, here's what I end up getting:\n<a href=\"https://i.stack.imgur.com/3HUIU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3HUIU.png\" alt=\"wrong\"></a></p>\n\n<p>How can I get the headers to line up at the top of the page, not vertically? Any pointers/suggestions from anyone?</p>\n"}, {"tags": ["ios", "ruby", "fastlane"], "comments": [{"owner": {"reputation": 29472, "user_id": 4253437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/bcBpJ.jpg?s=128&g=1", "display_name": "CodeBender", "link": "https://stackoverflow.com/users/4253437/codebender"}, "edited": false, "score": 2, "creation_date": 1566232705, "post_id": 57560671, "comment_id": 101583234, "body": "What does <code>fastlane env</code> give you? That should show where Fastlane is at least looking for Ruby."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 1, "creation_date": 1566232818, "post_id": 57560671, "comment_id": 101583282, "body": "And how are you executing your lane - what command are you running?"}, {"owner": {"reputation": 2138, "user_id": 607009, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d01b0951df1bdf7b8ce51a1fda75af3f?s=128&d=identicon&r=PG", "display_name": "blueether", "link": "https://stackoverflow.com/users/607009/blueether"}, "edited": false, "score": 0, "creation_date": 1566233180, "post_id": 57560671, "comment_id": 101583447, "body": "I added the <code>fastlane env</code> above. I&#39;m running <code>fastlane ios alpha</code>, <code>alpha</code> is the name of my lane as defined in my Fastfile. Did that answer your question?"}, {"owner": {"reputation": 162, "user_id": 6107098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0brod.png?s=128&g=1", "display_name": "eeekari", "link": "https://stackoverflow.com/users/6107098/eeekari"}, "edited": false, "score": 0, "creation_date": 1566234169, "post_id": 57560671, "comment_id": 101583918, "body": "It&#39;s my understanding that the Homebrew installation method bundles that version of Ruby. Have you tried uninstalling from Homebrew and reinstalling using RubyGems?  <a href=\"https://github.com/fastlane/fastlane/issues/14212\" rel=\"nofollow noreferrer\">github.com/fastlane/fastlane/issues/14212</a>"}, {"owner": {"reputation": 2138, "user_id": 607009, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d01b0951df1bdf7b8ce51a1fda75af3f?s=128&d=identicon&r=PG", "display_name": "blueether", "link": "https://stackoverflow.com/users/607009/blueether"}, "reply_to_user": {"reputation": 162, "user_id": 6107098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0brod.png?s=128&g=1", "display_name": "eeekari", "link": "https://stackoverflow.com/users/6107098/eeekari"}, "edited": false, "score": 0, "creation_date": 1566265877, "post_id": 57560671, "comment_id": 101592888, "body": "@eeekari I haven&#39;t tried that, I was hoping to get it to work via homebrew. I&#39;ll give it a try"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1566273610, "post_id": 57560671, "comment_id": 101594161, "body": "You either manage Ruby with Homebrew or with RVM - they don&#39;t mix."}, {"owner": {"reputation": 611, "user_id": 4185100, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/--8PpKJw1L5g/AAAAAAAAAAI/AAAAAAAACcc/Hxc3yao3y9g/photo.jpg?sz=128", "display_name": "Jijo John", "link": "https://stackoverflow.com/users/4185100/jijo-john"}, "edited": false, "score": 0, "creation_date": 1593610411, "post_id": 57560671, "comment_id": 110841276, "body": "Here is what I did for fresh install: <a href=\"https://stackoverflow.com/a/62677836/4185100\">stackoverflow.com/a/62677836/4185100</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1552, "user_id": 64239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f4919d77c2a59b3c321ff5992e5b9f9b?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/64239/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1573483524, "creation_date": 1573483524, "answer_id": 58803566, "question_id": 57560671, "link": "https://stackoverflow.com/questions/57560671/fastlane-keeps-warning-that-i-am-using-ruby-2-2-4/58803566#58803566", "title": "Fastlane keeps warning that I am using Ruby 2.2.4", "body": "<p>When you install fastlane via homebrew it includes its own version of ruby, as you've seen.  But if you install fastlane through <code>gem install fastlane</code> it'll pick up the version of ruby from <code>rvm</code>.  So the solution in this case is to uninstall fastlane and reinstall it as a gem.  Once you've done that you can run <code>fastlane env</code> again and you should see it picking up the expected ruby version.</p>\n\n<p>Thanks to the people on <a href=\"https://github.com/fastlane/fastlane/issues/14212\" rel=\"nofollow noreferrer\">this thread</a> for the answer.</p>\n\n<p>Hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5120933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c48671912c6c62d34395e1c803825778?s=128&d=identicon&r=PG", "display_name": "Patrick Saxton", "link": "https://stackoverflow.com/users/5120933/patrick-saxton"}, "is_accepted": false, "score": 0, "last_activity_date": 1578072357, "creation_date": 1578072357, "answer_id": 59582785, "question_id": 57560671, "link": "https://stackoverflow.com/questions/57560671/fastlane-keeps-warning-that-i-am-using-ruby-2-2-4/59582785#59582785", "title": "Fastlane keeps warning that I am using Ruby 2.2.4", "body": "<p>I spent the last few days with this because it would not update fastlane and this is how I was able to fix it. Here is what I found and what I did that worked for me</p>\n\n<p>Using the sudo command to run install with the <code>gem</code> command puts it into the the usr/local/bin folder and you have to have root privileges to update fastlane and you don't want that. Brew bundles an incorrect version of ruby that won't let you update, either. I ended up with two installations that I needed to get rid of and then get things done the correct way. I am running Catalina so I needed to change my <code>~/.zshrc</code> file, but I assume changing <code>~/.profile</code> or <code>~/.bash_profile</code> should do the same for older version of OSX.</p>\n\n<p>You may not have to do all of this, I was angry yesterday and ended up with multiple installs. Just be aware if some of these things don't exist or error out.</p>\n\n<p>Here is what I did:</p>\n\n<p>I uninstalled fastlane from brew <code>brew cask uninstall fastlane</code></p>\n\n<p>I then went into my user folder and deleted the <code>.fastlane</code> folder</p>\n\n<p>I ran <code>fastlane env</code> to catch my second install and looked at the <code>Installation Source</code> and deleted the fastlane command from that location. </p>\n\n<p>I then ran <code>fastlane</code> and got No Command Found</p>\n\n<p>Now edit your bash or zshrc file to add </p>\n\n<pre><code>export PATH=$PATH:~/.gems/bin\nexport GEM_HOME=~/.gems\n</code></pre>\n\n<p>save, close and restart the terminal</p>\n\n<p>run <code>gem install fastlane -NV</code>. DO NOT USE SUDO! It installs back to usr/local/bin and you don't want that. fastlane can't update if you do</p>\n\n<p>once the install finishes, run <code>fastlane env</code> and make sure the Install Location is in <code>~/.gems/..</code> and if you want, run <code>fastlane update_fastlane</code> to make sure you get the Nothing to Update message instead of a waring about needing sudo.</p>\n\n<p>Hopefully this works or helps someone else.</p>\n"}], "owner": {"reputation": 2138, "user_id": 607009, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d01b0951df1bdf7b8ce51a1fda75af3f?s=128&d=identicon&r=PG", "display_name": "blueether", "link": "https://stackoverflow.com/users/607009/blueether"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 833, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1578072357, "creation_date": 1566232182, "last_edit_date": 1566233062, "question_id": 57560671, "link": "https://stackoverflow.com/questions/57560671/fastlane-keeps-warning-that-i-am-using-ruby-2-2-4", "title": "Fastlane keeps warning that I am using Ruby 2.2.4", "body": "<p>I've updated to Ruby 2.5.5 via <code>rvm</code> but I continue to get warnings from Fastlane. For context, I'm building an iOS app on Max OSX and I installed Fastlane via homebrew, <code>brew cask install fastlane</code>. I searched online and in the github repo for Fastlane, but couldn't really find a solution.</p>\n\n<pre><code>$ ruby -v\nruby 2.5.5p157 (2019-03-15 revision 67260) [x86_64-darwin18]\n</code></pre>\n\n<p>And here is the Fastlane output\n<a href=\"https://i.stack.imgur.com/wK6cg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wK6cg.png\" alt=\"enter image description here\"></a></p>\n\n<p>There <em>is</em> a ruby 2.2.4 located here, which I am presuming Fastlane is using, but it's not clear to me what the proper way to upgrade this is or if there is some environment variable I can set so that Fastlane picks up the newer version.</p>\n\n<pre><code>~/.fastlane/bin/bundle/bin/ruby -v\nruby 2.2.4p230 (2015-12-16 revision 53155) [x86_64-darwin15]\n</code></pre>\n\n<p>How can I get Fastlane to pick up the right version of Ruby?</p>\n\n<p>Alternatively, are these warnings safe to ignore?</p>\n\n<p><strong>EDIT:</strong>\nHere is my <code>fastlane env</code> stack</p>\n\n<pre><code>| --------------------------- | ------------------------------------------- |\n| OS                          | 10.14.6                                     |\n| Ruby                        | 2.2.4                                       |\n| Bundler?                    | false                                       |\n| Git                         | git version 2.22.0                          |\n| Installation Source         | ~/.fastlane/bin/bundle/bin/fastlane         |\n| Host                        | Mac OS X 10.14.6 (18G87)                    |\n| Ruby Lib Dir                | ~/.fastlane/bin/bundle/lib                  |\n| OpenSSL Version             | OpenSSL 1.0.2g  1 Mar 2016                  |\n| Is contained                | false                                       |\n| Is homebrew                 | true                                        |\n| Is installed via Fabric.app | false                                       |\n| Xcode Path                  | /Applications/Xcode.app/Contents/Developer/ |\n| Xcode Version               | 10.3                                        |\n</code></pre>\n"}, {"tags": ["ruby", "watir"], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "edited": false, "score": 1, "creation_date": 1566232523, "post_id": 57560453, "comment_id": 101583163, "body": "it shows the following error : undefined local variable or method `line_number&#39; .. can show me an example ?"}], "tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": false, "score": 1, "last_activity_date": 1566238971, "last_edit_date": 1566238971, "creation_date": 1566231193, "answer_id": 57560453, "question_id": 57560044, "link": "https://stackoverflow.com/questions/57560044/how-to-read-the-second-line-in-a-document-txt-and-then-make-a-loop-that-reads-li/57560453#57560453", "title": "How to read the second line in a document.txt and then make a loop that reads line +1 in this document", "body": "<p>Try the below.</p>\n\n<pre><code># set the line number to read\nline_number = 2 # &lt;== Reading 2nd line\ncomment = IO.readlines('comments.txt')[line_number-1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 3, "last_activity_date": 1566238991, "creation_date": 1566238991, "answer_id": 57562090, "question_id": 57560044, "link": "https://stackoverflow.com/questions/57560044/how-to-read-the-second-line-in-a-document-txt-and-then-make-a-loop-that-reads-li/57562090#57562090", "title": "How to read the second line in a document.txt and then make a loop that reads line +1 in this document", "body": "<p><code>File.readlines</code> returns array. So you can do everything you want</p>\n\n<pre><code>lines = []\n\nFile.readlines(path_to_file, chomp: true).each.with_index(1) do |line, line_number|\n  lines &lt;&lt; (line_number == 2 ? 'Special line' : line)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566254455, "last_edit_date": 1566254455, "creation_date": 1566253350, "answer_id": 57564592, "question_id": 57560044, "link": "https://stackoverflow.com/questions/57560044/how-to-read-the-second-line-in-a-document-txt-and-then-make-a-loop-that-reads-li/57564592#57564592", "title": "How to read the second line in a document.txt and then make a loop that reads line +1 in this document", "body": "<p>Your code is overwriting the comment variable in each iteration. </p>\n\n<p>I'd write your code like this:</p>\n\n<pre><code>lines = File.readlines('comments.txt')\nlines.each do |line|\n  # entire line\nend\n</code></pre>\n\n<p>In the loop you can do a lot of things with the single line, unfortunately I don't get 100% what you want to do (one comment vs. multiple, always the same for specific users, etc.) I hope this helps anyway.</p>\n"}], "owner": {"reputation": 438, "user_id": 10658246, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHSip3LH7eA/AAAAAAAAAAI/AAAAAAAAADU/FWM0VrWo3pI/photo.jpg?sz=128", "display_name": "Astrit Shuli", "link": "https://stackoverflow.com/users/10658246/astrit-shuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 2, "answer_count": 3, "score": 5, "last_activity_date": 1578906989, "creation_date": 1566229532, "last_edit_date": 1578906989, "question_id": 57560044, "link": "https://stackoverflow.com/questions/57560044/how-to-read-the-second-line-in-a-document-txt-and-then-make-a-loop-that-reads-li", "title": "How to read the second line in a document.txt and then make a loop that reads line +1 in this document", "body": "<p>My bot reads emails one by one from a document.txt file and after login with this email the bot outputs the comments that I have in another file.</p>\n\n<p>I have reached the point that the bot reads the emails but I want that a specific account makes a specific and not a repeated comment.</p>\n\n<p>So I have in mind the solution of reading a specific line from the comments file.</p>\n\n<p>For example account 1 reads and puts line 1 of the comments file. I want to know how can I read the second line from a comments file.</p>\n\n<p><i>This is the code part when I read comments one by one but I want to read for example line two or three! </i></p>\n\n<pre><code>file = 'comments.txt'\nFile.readlines(file).each do |line|\n    comment = [\"#{line}\"] \n    comment.each { |val| \n        comment = [\"#{val}\"] \n}\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": true, "score": 3, "last_activity_date": 1566294735, "creation_date": 1566294735, "answer_id": 57571019, "question_id": 57558475, "link": "https://stackoverflow.com/questions/57558475/foreign-key-constraint-do-cause-n1-query-but-without-constraint-eager-loading/57571019#57571019", "title": "Foreign key constraint do cause N+1 query but without constraint, eager-loading works properly", "body": "<p>change the association called inside the block to base_currency2 in the latter.</p>\n\n<pre><code>Market.includes(:base_currency2).each { |x| puts x.base_currency2.code }\n</code></pre>\n"}], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57571019, "answer_count": 1, "score": 2, "last_activity_date": 1566294735, "creation_date": 1566223772, "last_edit_date": 1566286329, "question_id": 57558475, "link": "https://stackoverflow.com/questions/57558475/foreign-key-constraint-do-cause-n1-query-but-without-constraint-eager-loading", "title": "Foreign key constraint do cause N+1 query but without constraint, eager-loading works properly", "body": "<p>I have added added <code>base_currency_id</code> &amp; <code>base_currency_id2</code> with &amp; without foreign-key constraint respectively as below in <code>markets</code> table,</p>\n\n<pre><code>def change\n  create_table :currencies do |t|\n    t.string :code\n    t.timestamps\n  end\n\n  create_table :market2 do |t|\n    t.string :code\n    t.integer :base_currency_id\n    t.integer :base_currency_id2\n    t.foreign_key :currencies, column: :base_currency_id2\n    t.integer :quote_currency_id\n    t.timestamps\n  end\nend\n\nActiveRecord::Migration.change\n</code></pre>\n\n<p><code>Market</code> model have following associations defined,</p>\n\n<pre><code>class Market &lt; ApplicationRecord\n  belongs_to :base_currency, class_name: 'Currency', foreign_key: :base_currency_id\n  belongs_to :base_currency2, class_name: 'Currency', foreign_key: :base_currency_id2\nend\n</code></pre>\n\n<p>I am not getting why one of the below association is causing N+1 query even on eager-loading here,</p>\n\n<pre><code>Market.includes(:base_currency).each { |x| puts x.base_currency.code }\n  # Market Load (0.6ms)  SELECT \"markets\".* FROM \"markets\"\n  # Currency Load (0.3ms)  SELECT \"currencies\".* FROM \"currencies\" WHERE \"currencies\".\"id\" = $1  [[\"id\", 1]]\n#  INR\n#  INR\n\n\nMarket.includes(:base_currency2).each { |x| puts x.base_currency.code }\n  #  Market Load (0.5ms)  SELECT \"markets\".* FROM \"markets\"\n  #  Currency Load (0.4ms)  SELECT  \"currencies\".* FROM \"currencies\" WHERE \"currencies\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n# INR\n  # Currency Load (0.4ms)  SELECT  \"currencies\".* FROM \"currencies\" WHERE \"currencies\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n# INR\n</code></pre>\n\n<p>Please explain if I miss something here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "edited": false, "score": 0, "creation_date": 1566235698, "post_id": 57558471, "comment_id": 101584566, "body": "Sorry I don&#39;t understand your goal. And what behaviour you expect. What&#39;s wrong with a button which call your <code>create</code> action inside your <code>ImagesController</code> ? It&#39;s because without Ajax it&#39;s going to reload your page?"}, {"owner": {"reputation": 21, "user_id": 11946538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab6002bb363ff053c72866e64b75a97?s=128&d=identicon&r=PG&f=1", "display_name": "SerDev19", "link": "https://stackoverflow.com/users/11946538/serdev19"}, "reply_to_user": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "edited": false, "score": 0, "creation_date": 1566238757, "post_id": 57558471, "comment_id": 101585747, "body": "while I formulated a question, I forgot to say that I need to parse pictures in ActiveAdmin, and how just explained to me, that my ImageController is not available in ActiveAdmin. It turns out that I need to write new action in the ActiveAdmin resource, that will save the picture with passed parameters? right?"}, {"owner": {"reputation": 21, "user_id": 11946538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab6002bb363ff053c72866e64b75a97?s=128&d=identicon&r=PG&f=1", "display_name": "SerDev19", "link": "https://stackoverflow.com/users/11946538/serdev19"}, "reply_to_user": {"reputation": 416, "user_id": 7821606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z8Ad.png?s=128&g=1", "display_name": "morissetcl", "link": "https://stackoverflow.com/users/7821606/morissetcl"}, "edited": false, "score": 0, "creation_date": 1566239357, "post_id": 57558471, "comment_id": 101585999, "body": "clarification: the file parser.rb is located in app/admin/parser.rb"}], "owner": {"reputation": 21, "user_id": 11946538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab6002bb363ff053c72866e64b75a97?s=128&d=identicon&r=PG&f=1", "display_name": "SerDev19", "link": "https://stackoverflow.com/users/11946538/serdev19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1566233917, "creation_date": 1566223758, "last_edit_date": 1566233917, "question_id": 57558471, "link": "https://stackoverflow.com/questions/57558471/parse-images-from-page-view-them-and-save-selected", "title": "Parse images from page, view them and save selected", "body": "<p>I have written a parser that pulls pictures from a page using the <code>img</code> tag, I made a page on which these pictures are displayed, I need the ability to save certain pictures in the database.</p>\n\n<p>I think it will be a button opposite each picture, by clicking on which it will be saved in a certain category.</p>\n\n<p>To download local files, I use CarrierWave, and Nokogiri to search for pictures.</p>\n\n<p>In the console, I can add a file to the database specifying url: </p>\n\n<pre><code>Image.new(id: 777, title: 'down', user_id: 2, category_id: 3, remote_picture_url: ('url_to_image.jpg')).\n</code></pre>\n\n<p>How can I now transfer all this to the controller so as not to disrupt local loading? maybe create a new action?</p>\n\n<p>I will be glad to any ideas</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>page_action :grab, method: :post do\n    unparsed_page = HTTParty.get(params[:parser][:url])\n    parsed_page = Nokogiri::HTML(unparsed_page)\n    @images = parsed_page.css('img')\n    @images.each do |image|\n      img = {\n          url: image.attributes['src'].value\n      }\n    end\n    render partial: 'images', image: @images\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ImagesController &lt; ApplicationController\ndef create\n    @category = Category.friendly.find(params[:image][:category_id])\n    @image = current_user.images.new(image_params)\n    @image.category_id = @category.id\n    @image.save!\nend\n</code></pre>\n\n<p>My goal is to save certain pictures from the page to the database.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "google-calendar-api"], "owner": {"reputation": 21, "user_id": 7411054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298b56d4602c2f8eed09f0b30b2d77cb?s=128&d=identicon&r=PG&f=1", "display_name": "Adeel Kamal Malik", "link": "https://stackoverflow.com/users/7411054/adeel-kamal-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1566377461, "creation_date": 1566222640, "last_edit_date": 1566377461, "question_id": 57558138, "link": "https://stackoverflow.com/questions/57558138/google-calendar-api-source-title-gadget-are-not-working-on-google-calendar-e", "title": "Google Calendar API - Source Title &amp; Gadget are not working on google calendar event prompt", "body": "<p>I'm using Javascript version of Google Calendar API to create Events from Ruby on Rails app to User's Google Calendar.</p>\n\n<p>I needed to add custom link and title on Event Prompt (on Google Calendar) from js insert event script. Everything is working fine but <code>Source</code> &amp; <code>Gadget</code> options are not working as expected.</p>\n\n<p>In <code>Source</code>, I have provided URL and Title. Url is there but not the title. In the same way, <code>Gadget</code> option is making no difference on Google Event.</p>\n\n<pre><code>\"gadget\": {\n    \"type\": 'object',\n    \"title\": 'Go To Website',\n    \"link\": 'https://url',\n    \"iconLink\": 'https://icon-url',\n    \"width\": 100,\n    \"height\": 100,\n    \"display\": 'chip'\n },\n \"source\": {\n     \"url\": 'https://url',\n     \"title\": 'Title'\n}\n</code></pre>\n\n<p>As per documentation <a href=\"https://developers.google.com/calendar/v3/reference/events\" rel=\"nofollow noreferrer\">https://developers.google.com/calendar/v3/reference/events</a>,\nThere should be a new icon for <code>Gadget</code> along with Event Title,\nand there should Title with URL for <code>Source</code> in Event Prompt.</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 6271351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7df3b3963efa6e68027432259210c47b?s=128&d=identicon&r=PG&f=1", "display_name": "Angus ", "link": "https://stackoverflow.com/users/6271351/angus"}, "edited": false, "score": 1, "creation_date": 1566223915, "post_id": 57558345, "comment_id": 101578889, "body": "Ahhh thank you.  I wasn&#39;t too far off, not bad for someone taking a complete guess.  I&#39;ll give it a go in a few hours and see what happens.  Thanks for this."}], "tags": [], "owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "is_accepted": true, "score": 2, "last_activity_date": 1566223334, "creation_date": 1566223334, "answer_id": 57558345, "question_id": 57557245, "link": "https://stackoverflow.com/questions/57557245/advice-on-reading-multiple-text-files-into-an-array-with-ruby/57558345#57558345", "title": "Advice on reading multiple text files into an array with Ruby", "body": "<p>Thank you for the question.</p>\n\n<p>First let's assume that 'filepath' is something like the target pattern you want to glob in <code>Dir.glob('filepath')</code> (I used <code>Dir.glob('src/*.h').each do |filename|</code> in my test).</p>\n\n<p>After that, <code>File.open(\"#{path}#{filename}\")</code> prepends another path to the already complete path you'll have in <code>filename</code>.</p>\n\n<p>And lastly, although this is probably not the problem, the code opens the file and never closes it. The <code>IO</code> object provides a <code>readlines</code> method that takes care of opening and closing the file for you.</p>\n\n<p>Here's some working code that you can adapt:</p>\n\n<pre><code>contentsArray = []\n\nDir.glob('filepath').each do |filename|\n  next if File.directory?(filename)\n  lines = IO.readlines(filename)\n  contentsArray.concat(lines)\nend\n\nputs \"#{contentsArray.length} LINES\"\n</code></pre>\n\n<p>Here are references to the Ruby doc's for the <code>IO::readlines</code> and <code>Array::concat</code> methods used:</p>\n\n<ul>\n<li><p><a href=\"https://ruby-doc.org/core-2.5.5/IO.html#method-i-readlines\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.5/IO.html#method-i-readlines</a></p></li>\n<li><p><a href=\"https://ruby-doc.org/core-2.5.5/Array.html#method-i-concat\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.5/Array.html#method-i-concat</a></p></li>\n</ul>\n\n<p>As an alternative to using the goto (<code>next</code>) the code could conditionally execute on files, like this:</p>\n\n<pre><code>  if File.file?(filename)\n    lines = IO.readlines(filename)\n    contentsArray.concat(lines)\n  end\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6271351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7df3b3963efa6e68027432259210c47b?s=128&d=identicon&r=PG&f=1", "display_name": "Angus ", "link": "https://stackoverflow.com/users/6271351/angus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 57558345, "answer_count": 1, "score": 0, "last_activity_date": 1566223334, "creation_date": 1566219468, "question_id": 57557245, "link": "https://stackoverflow.com/questions/57557245/advice-on-reading-multiple-text-files-into-an-array-with-ruby", "title": "Advice on reading multiple text files into an array with Ruby", "body": "<p>I'm currently writing out a program in Ruby, which I'm fairly new at, and it requires multiple text files to be pushed into an array line by line.</p>\n\n<p>I am currently unable to actually test my code since I'm at work and this is for personal use, but I'm seeking advice to see if my code is correct.  I knows how to read a file and push it to the array.  If possible can someone check it over and advise if I have the correct idea?  I'm self taught regarding Ruby and have no-one to check my work.</p>\n\n<p>I understand if this isn't the right place for trying to get this sort of advice and it's deleted/locked.  Apologies if so.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>contentsArray = []\n\nDir.glob('filepath').each do |filename|\n  next if File.directory?(filename)\n  r = File.open(\"#{path}#{filename}\")\n  r.each_line { |line| contentsArray.push line}\nend\n</code></pre>\n\n<p>I'm hoping this snippet will take the lines from multiple files in the same directory and stick them in the array so I can later splice what's in there.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "watir"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "edited": false, "score": 0, "creation_date": 1566226125, "post_id": 57558925, "comment_id": 101580098, "body": "Thank you, good job.. i also solved it like : <code>Watir::Wait.until { browser.div(class: &#39;posts&#39;).div(index: 25).exist? }</code> index number is up to you"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "reply_to_user": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "edited": false, "score": 0, "creation_date": 1566410185, "post_id": 57558925, "comment_id": 101651005, "body": "@O\u011fuz&#199;i&#231;ek I like your approach, and if you are going this route, you can just as easily do this with less code by: <code>browser.div(class: &#39;posts&#39;).div(index: 25).wait_until(&amp;:exist?)</code>"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1566441110, "post_id": 57558925, "comment_id": 101659567, "body": "You could probably shorten to even <code>browser.div(class: &#39;single-post&#39;, index: 25).wait_until(&amp;:exists?)</code>"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 1, "last_activity_date": 1566225395, "creation_date": 1566225395, "answer_id": 57558925, "question_id": 57557198, "link": "https://stackoverflow.com/questions/57557198/watir-wait-for-more-posts-load/57558925#57558925", "title": "Watir wait for more posts load", "body": "<p>You can get a collection of the single-post divs to see if more have loaded. Depending on the markup of the page, you can do:</p>\n\n<pre><code>browser.divs(class: 'single-post').count\n</code></pre>\n\n<p>or, if the parent matters:</p>\n\n<pre><code>browser.div(class: 'posts').divs(class: 'single-post').count\n</code></pre>\n\n<p>This can be used to wait for the number of posts to increase:</p>\n\n<pre><code># Find the original count\noriginal_count = browser.divs(class: 'single-post').count\n\n# Take an whatever action to trigger the loading of more posts\nbrowser.scroll.to :bottom\n\n# Wait for the count to increase\nbrowser.wait_until do\n  new_count = browser.divs(class: 'single-post').count\n  new_count &gt; original_count\nend\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57558925, "answer_count": 1, "score": 0, "last_activity_date": 1566225395, "creation_date": 1566219289, "question_id": 57557198, "link": "https://stackoverflow.com/questions/57557198/watir-wait-for-more-posts-load", "title": "Watir wait for more posts load", "body": "<p>The site which I want to scrape is having lazy loading with a scroll event. (infinite scroll)\nI want to wait for more posts to load, but all posts have the same class name. So, I can't wait for an element with a specific class name to load. I don't want to use <code>sleep()</code> method.</p>\n\n<p>Example Code:</p>\n\n<pre><code>&lt;div class='posts'&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n // The following posts appear after scrolling. I want to fetch these posts\n &lt;div class='single-post'&gt;&lt;/div&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n &lt;div class='single-post'&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>How can I solve this issue? Is it possible to check if this div has more than 10 posts? </p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "edited": false, "score": 0, "creation_date": 1566245516, "post_id": 57556990, "comment_id": 101588325, "body": "in the console when you do <code>Service.last.images.count </code> do you get 3?"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "edited": false, "score": 0, "creation_date": 1566247503, "post_id": 57556990, "comment_id": 101589095, "body": "Hello @MZaragoza yes I do! All i can see on my front end is broken images and the active record string from the console."}, {"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "edited": false, "score": 0, "creation_date": 1566247629, "post_id": 57556990, "comment_id": 101589152, "body": "on the ERB file if what do you get when you do  `&lt;%=@service.images.each do  |img| %&gt;   img   &lt;br&gt; &lt;%end %&gt;"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "edited": false, "score": 0, "creation_date": 1566247832, "post_id": 57556990, "comment_id": 101589218, "body": "I get this  on the front end <code>img  img  img  [#&lt;ActiveStorage::Attachment id: 16, name: &quot;images&quot;, record_type: &quot;Service&quot;, record_id: 15, blob_id: 16, created_at: &quot;2019-08-19 18:56:12&quot;&gt;, #&lt;ActiveStorage::Attachment id: 17, name: &quot;images&quot;, record_type: &quot;Service&quot;, record_id: 15, blob_id: 17, created_at: &quot;2019-08-19 18:56:13&quot;&gt;, #&lt;ActiveStorage::Attachment id: 18, name: &quot;images&quot;, record_type: &quot;Service&quot;, record_id: 15, blob_id: 18, created_at: &quot;2019-08-19 18:56:13&quot;&gt;]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "is_accepted": false, "score": 0, "last_activity_date": 1566250289, "creation_date": 1566250289, "answer_id": 57564186, "question_id": 57556990, "link": "https://stackoverflow.com/questions/57556990/image-not-showing-for-multiple-image-upload-with-active-storage/57564186#57564186", "title": "Image not showing for multiple image upload with active storage", "body": "<p>This is the code that I finally used to get the imageS to show on my SHOW PAGE.</p>\n\n<pre><code>&lt;% if @service.images.attached? %&gt;\n&lt;p&gt;\n  &lt;strong&gt;Images:&lt;/strong&gt;\n  &lt;br&gt;\n  &lt;% @service.images.each do |image| %&gt;\n    &lt;%= image_tag(image) %&gt;\n  &lt;% end %&gt;\n&lt;/p&gt;\n&lt;% end %&gt;\n\n</code></pre>\n\n<p>I was using <code>cl_image_tag</code> to display my image which was causing the image to display broken. I should have used the above. </p>\n\n<p>Source:<a href=\"https://evilmartians.com/chronicles/rails-5-2-active-storage-and-beyond\" rel=\"nofollow noreferrer\">https://evilmartians.com/chronicles/rails-5-2-active-storage-and-beyond</a></p>\n"}], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 459, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566250289, "creation_date": 1566218490, "last_edit_date": 1566241138, "question_id": 57556990, "link": "https://stackoverflow.com/questions/57556990/image-not-showing-for-multiple-image-upload-with-active-storage", "title": "Image not showing for multiple image upload with active storage", "body": "<p>I have followed a tutorial on how to upload multiple images using active record. I have installed active record, added my associations to my model and when I create a Service (my model) everything seems to be working when I upload 3 images i.e no Active Record errors however I cannot see my images on the FE, all I see is a broken images.</p>\n\n<p>When I go into Rails c and type Service.images.last I can see that images is nil. Does anyone know why this is?</p>\n\n<p>Is there anything else you need to know or see from me?</p>\n\n<p>Thank you</p>\n\n<p>My code to show the image:</p>\n\n<pre><code>&lt;%=@service.images.each do  |img| %&gt;\n  &lt;%= cl_image_tag @service.images, crop: :fill, class: 'card-image', class: 'card-image-show'%&gt;\n &lt;%end %&gt;\n\n</code></pre>\n\n<p>Rails c </p>\n\n<pre><code>  Service Load (59.6ms)  SELECT  \"services\".* FROM \"services\" ORDER BY \"services\".\"id\" DESC LIMIT $1  [[\"LIMIT\", 1]]\n=&gt; #&lt;ActiveStorage::Attached::Many:0x00007fffc3ff08a0 @name=\"images\", @record=#&lt;Service id: 14, name: \"Test Carpet cleaning\", description: \"Lorem Ipsum is simply dummy text of the printing a...\", picture_url: nil, video: nil, category: \"carpet cleaning\", created_at: \"2019-08-19 12:32:35\", updated_at: \"2019-08-19 12:32:35\", photo: nil, images: nil&gt;, @dependent=:purge_later&gt;\n</code></pre>\n\n<p>Rails c when i do Service.last.images</p>\n\n<pre><code>irb(main):013:0&gt; Service.last.images\n  Service Load (0.6ms)  SELECT  \"services\".* FROM \"services\" ORDER BY \"services\".\"id\" DESC LIMIT $1  [[\"LIMIT\", 1]]\n=&gt; #&lt;ActiveStorage::Attached::Many:0x00007f92fd1f8780 @name=\"images\", @record=#&lt;Service id: 15, name: \"test multiple images\", description: \"Lorem Ipsum is simply dummy text of the printing a...\", picture_url: nil, video: nil, category: \"carpet cleaning\", created_at: \"2019-08-19 18:56:12\", updated_at: \"2019-08-19 18:56:13\", photo: nil, images: nil&gt;, @dependent=:purge_later&gt;\n</code></pre>\n\n<p>Service model</p>\n\n<pre><code>class Service &lt; ApplicationRecord\n  has_many_attached :images\n  mount_uploader :photo, PhotoUploader\nend\n\n</code></pre>\n\n<p>I would like my 3 images to display on the FE</p>\n"}, {"tags": ["ruby", "ruby2d"], "comments": [{"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 3, "creation_date": 1566218431, "post_id": 57555972, "comment_id": 101575648, "body": "Is this your complete code? Currently you just remove and readd the Item when the Position overlaps. Have you seen the examples on github: <a href=\"https://github.com/ruby2d/examples\" rel=\"nofollow noreferrer\">github.com/ruby2d/examples</a> and the documentation in <a href=\"http://ruby2d.com\" rel=\"nofollow noreferrer\">ruby2d.com</a> ?"}, {"owner": {"reputation": 487, "user_id": 8242557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyWRa.png?s=128&g=1", "display_name": "pr0f3ss", "link": "https://stackoverflow.com/users/8242557/pr0f3ss"}, "edited": false, "score": 0, "creation_date": 1566293382, "post_id": 57555972, "comment_id": 101601718, "body": "The code wouldn&#39;t even work because hit() doesn&#39;t return anything. Add a return statement to hit"}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "reply_to_user": {"reputation": 487, "user_id": 8242557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyWRa.png?s=128&g=1", "display_name": "pr0f3ss", "link": "https://stackoverflow.com/users/8242557/pr0f3ss"}, "edited": false, "score": 1, "creation_date": 1566294428, "post_id": 57555972, "comment_id": 101602325, "body": "@pr0f3ss <code>hit</code> return true/false as <code>&amp;&amp;</code> result. Return in ruby is implicit."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5477894, "user_type": "registered", "profile_image": "https://graph.facebook.com/706551832809818/picture?type=large", "display_name": "Edward Lampshade Gein", "link": "https://stackoverflow.com/users/5477894/edward-lampshade-gein"}, "is_accepted": false, "score": 1, "last_activity_date": 1569010928, "creation_date": 1569010928, "answer_id": 58034731, "question_id": 57555972, "link": "https://stackoverflow.com/questions/57555972/collision-detection-ruby2d/58034731#58034731", "title": "Collision Detection Ruby2d", "body": "<pre><code>def hit(a, s)\n  return a.contains?(s.x + a.radius ,s.y +a.radius)\nend\n</code></pre>\n\n<p>this will get you close, triangles have sloped edges so if you want to be extremely accurate you will need to apply some math.</p>\n"}], "owner": {"reputation": 101, "user_id": 11908332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d001d59e0ff426efd3b97757b43263?s=128&d=identicon&r=PG&f=1", "display_name": "import_hill", "link": "https://stackoverflow.com/users/11908332/import-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1569010928, "creation_date": 1566214679, "last_edit_date": 1566302891, "question_id": 57555972, "link": "https://stackoverflow.com/questions/57555972/collision-detection-ruby2d", "title": "Collision Detection Ruby2d", "body": "<p>I have posted a question similar to this and still have no clue on what steps forward I should take. I am trying to make the computer detect if the square touches the circle.  </p>\n\n<p>I have seen some code that could probably work but am not able to implement it into my script. Please provide an edited piece of my code below, thanks!</p>\n\n<p>EDIT: I have tried putting a return command but it still does not work, I have posted my whole script below to provide as much info as I can. Thanks again!</p>\n\n<pre><code>require 'ruby2d'\nset title: 'Merdeka', background: 'olive'\nset width: 600, height: 500\ns = Square.new(\n  x: @x, y: @y,\n  size: 25,\n  color: 'navy',\n  z: 10\n)\na = Circle.new(\n  x: rand(600), y: rand(500),\n  radius: 11,\n  sectors: 32,\n  color: 'maroon',\n  z: 10\n)\n\n@x_speed = 0\n@y_speed = 0\non :key_down do |event|\n  if event.key == 'up'\n    @x_speed = 0\n    @y_speed = -2\n  elsif event.key == 'right'\n    @x_speed = 2\n    @y_speed = 0\n  elsif event.key == 'down'\n    @x_speed = 0\n    @y_speed = 2\n  elsif event.key == 'left'\n    @x_speed = -2\n    @y_speed = 0\n  end\nend\n\nupdate do\n  s.x += @x_speed\n  s.y += @y_speed\nend\ndef hit(a, s)\n  return a.x == s.x &amp;&amp; a.y == s.y\nend\nif hit(a, s)\na.remove\na.add\nend\nshow\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "limit", "offset"], "comments": [{"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 4, "creation_date": 1566212353, "post_id": 57555042, "comment_id": 101572495, "body": "Are you sure the <code>live</code> is <code>true</code> for the missing product?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1566214097, "post_id": 57555042, "comment_id": 101573345, "body": "check the value of &quot;live&quot; it must be false for few records"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 9559266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CuDynlDo9CA/AAAAAAAAAAI/AAAAAAAABzQ/-Pj97ngfbvg/photo.jpg?sz=128", "display_name": "Hisham Magdy", "link": "https://stackoverflow.com/users/9559266/hisham-magdy"}, "is_accepted": true, "score": 0, "last_activity_date": 1566216482, "creation_date": 1566216482, "answer_id": 57556426, "question_id": 57555042, "link": "https://stackoverflow.com/questions/57555042/why-is-record-missing-while-using-limit-and-offset-in-mysql/57556426#57556426", "title": "Why is record missing while using limit and offset in mysql?", "body": "<p>just make sure that <code>\"live\" =&gt; true</code> for the missing records </p>\n"}], "owner": {"reputation": 3, "user_id": 7407740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d58afb1c5e4f09f7a255fbdf4603de?s=128&d=identicon&r=PG&f=1", "display_name": "Rakshitha", "link": "https://stackoverflow.com/users/7407740/rakshitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57556426, "answer_count": 1, "score": 0, "last_activity_date": 1566216482, "creation_date": 1566210973, "last_edit_date": 1566214062, "question_id": 57555042, "link": "https://stackoverflow.com/questions/57555042/why-is-record-missing-while-using-limit-and-offset-in-mysql", "title": "Why is record missing while using limit and offset in mysql?", "body": "<p>Lets say I have a table Product. I have few thousands record in my table.</p>\n\n<p>When I tried\nThe <code>offset_val = 0,10,20,30...</code></p>\n\n<pre><code>Product.where(\"live\" =&gt; true).offset(offset_val).limit(10).order(\"position DESC\")\n</code></pre>\n\n<p>Executing the same query with different offset_val, </p>\n\n<p>It returns me the live product only 10 at a time, but found some records are missing in the result</p>\n\n<p>Any constraint or situation will have this problem?</p>\n\n<pre><code>  Sample Record Set =[0,1,2,3,4,5,6,7,.....,20]\n    Expected Output \n    when offset_val = 10  &amp; limit = 10\n    =&gt; [10,11,12,13,14,15,16,17,18,19]\n   Actual Output =&gt; [10,11,12,13,15,16,17,18,20,21]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "ruby-on-rails-5", "nokogiri"], "comments": [{"owner": {"reputation": 2121, "user_id": 10413416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceedf65b5c2b247ee12ed7b3420ee77d?s=128&d=identicon&r=PG&f=1", "display_name": "Infern0", "link": "https://stackoverflow.com/users/10413416/infern0"}, "edited": false, "score": 0, "creation_date": 1566210704, "post_id": 57554936, "comment_id": 101571688, "body": "Some examples of the HTML DOM ? Example: find the total count of visible elements per page, iterate them and on the latest, send scroll event ?"}, {"owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "reply_to_user": {"reputation": 2121, "user_id": 10413416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceedf65b5c2b247ee12ed7b3420ee77d?s=128&d=identicon&r=PG&f=1", "display_name": "Infern0", "link": "https://stackoverflow.com/users/10413416/infern0"}, "edited": false, "score": 0, "creation_date": 1566212519, "post_id": 57554936, "comment_id": 101572549, "body": "the xhr request is not like ?page=1 to easily iterate.."}], "owner": {"reputation": 143, "user_id": 2351980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HLah7.jpg?s=128&g=1", "display_name": "O\u011fuz &#199;i&#231;ek", "link": "https://stackoverflow.com/users/2351980/o%c4%9fuz-%c3%87i%c3%a7ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "closed_date": 1566214479, "answer_count": 0, "score": 0, "last_activity_date": 1566214602, "creation_date": 1566210558, "question_id": 57554936, "link": "https://stackoverflow.com/questions/57554936/how-to-scrape-data-which-have-auto-scroll-and-lazy-loading", "closed_reason": "Duplicate", "title": "How to scrape data which have auto-scroll and lazy loading", "body": "<p>I want to scrape some data from a website. (I am using Rails and Nokogiri.)\nThe site which I want to scrape is having lazy loading with a scroll event. But I have a problem with the url of ajax request.</p>\n\n<p>The site uses a complex request : <code>load_more?id=1837373&amp;lastPostid=987984545</code> instead of a regular request like <code>?page=1</code>.</p>\n\n<p>Is it possible to scroll down 2 times and fetch all data? </p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["ruby", "cucumber", "watir", "page-object-gem"], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 2775990, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/q0b2b.jpg?s=128&g=1", "display_name": "spectator", "link": "https://stackoverflow.com/users/2775990/spectator"}, "is_accepted": true, "score": 0, "last_activity_date": 1566490434, "creation_date": 1566490434, "answer_id": 57613401, "question_id": 57553373, "link": "https://stackoverflow.com/questions/57553373/how-to-embed-text-into-cucumber-report-with-ruby/57613401#57613401", "title": "How to embed text into cucumber report with ruby?", "body": "<p>I got the solution it is simply by printing the value as below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Given(\"I have {int} cukes in my belly\") do |cukes|\n puts 'This goes into the report: #{cukes}'\nend\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 2775990, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/q0b2b.jpg?s=128&g=1", "display_name": "spectator", "link": "https://stackoverflow.com/users/2775990/spectator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 57613401, "answer_count": 1, "score": 0, "last_activity_date": 1566490434, "creation_date": 1566204831, "last_edit_date": 1566457194, "question_id": 57553373, "link": "https://stackoverflow.com/questions/57553373/how-to-embed-text-into-cucumber-report-with-ruby", "title": "How to embed text into cucumber report with ruby?", "body": "<p>How to embed the text into the cucumber report using ruby. We can do it using java by using the below code but similarly how can I do it in cucumber-ruby?</p>\n\n<p>I have tried using embed method but it is not working.</p>\n\n<p>Below is the code in java to write text in to report.</p>\n\n<p>Source: <a href=\"https://gist.github.com/aslakhellesoy/4072962\" rel=\"nofollow noreferrer\">https://gist.github.com/aslakhellesoy/4072962</a></p>\n\n<pre class=\"lang-java prettyprint-override\"><code>import cucumber.api.Scenario;\n\npublic class MyStepdefs {\n    private Scenario scenario;\n\n    @Before\n    public void before(Scenario scenario) {\n        this.scenario = scenario;\n    }\n\n    @Given(\"^I have (\\\\d+) cukes in my belly$\")\n    public void cukes_in_my_belly(int cukes) {\n        scenario.write(\"This goes into the report(s)\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 2, "creation_date": 1566191104, "post_id": 57550727, "comment_id": 101563833, "body": "The typical way to do this would be to define a Hash, and then to keep the counts there. <code>counts = Hash.new(0); counts[&quot;foo&quot;] += 1</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "edited": false, "score": 0, "creation_date": 1566191650, "post_id": 57550749, "comment_id": 101563941, "body": "Thank you very much, this is what I was looking for."}, {"owner": {"reputation": 301, "user_id": 6701820, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_9g0OuM9ZQ/AAAAAAAAAAI/AAAAAAAAAEw/ktX4E3hT93s/photo.jpg?sz=128", "display_name": "TheVinspro", "link": "https://stackoverflow.com/users/6701820/thevinspro"}, "edited": false, "score": 0, "creation_date": 1566198421, "post_id": 57550749, "comment_id": 101566028, "body": "You can add one thing. If line data has any space, line.chomp  will create the hash key with space.   lines.each do |line|   counter[line.scan(/\\w+/).first] += 1 end"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 301, "user_id": 6701820, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_9g0OuM9ZQ/AAAAAAAAAAI/AAAAAAAAAEw/ktX4E3hT93s/photo.jpg?sz=128", "display_name": "TheVinspro", "link": "https://stackoverflow.com/users/6701820/thevinspro"}, "edited": false, "score": 0, "creation_date": 1566238118, "post_id": 57550749, "comment_id": 101585497, "body": "@TheVinspro The whole input stream can be broken into words using <code>scan</code> if that&#39;s the desired outcome."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1566191203, "creation_date": 1566191203, "answer_id": 57550749, "question_id": 57550727, "link": "https://stackoverflow.com/questions/57550727/how-to-create-a-dynamic-variable-to-perform-a-count-with-ruby/57550749#57550749", "title": "How to create a dynamic variable to perform a count with Ruby?", "body": "<p>If you need a quick counter table:</p>\n\n<pre><code>counter = Hash.new(0)\n</code></pre>\n\n<p>Where you can then do:</p>\n\n<pre><code>lines.each do |line|\n  counter[line.chomp] += 1\nend\n</code></pre>\n\n<p>Now you have a count of lines.</p>\n\n<p>The <code>chomp</code> is there to remove any newline characters that might contaminate matches.</p>\n\n<p>Think in terms of data, not in terms of variables. The initial approach you had depends on referencing variables dynamically which sort of misses the point. You want all your counters to be grouped together so you can do things like <em>iterate over them</em> and <em>inspect their state as a whole</em>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9450045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 57550749, "answer_count": 1, "score": 1, "last_activity_date": 1566191203, "creation_date": 1566190987, "last_edit_date": 1566191119, "question_id": 57550727, "link": "https://stackoverflow.com/questions/57550727/how-to-create-a-dynamic-variable-to-perform-a-count-with-ruby", "title": "How to create a dynamic variable to perform a count with Ruby?", "body": "<p>I have these variables:</p>\n\n<pre><code>call = 0\nbrake = 0\n</code></pre>\n\n<p>Then I read several files where in each line there is 1 word. These words/string coincide with the name of the variables.</p>\n\n<pre><code>lines.each do |line|\n  line += 1 #line == 'call' therefore you wish to do &gt;&gt; call += 1\nend\n</code></pre>\n\n<p>Since I have too many variables in the program something like that would simplify the process a lot. </p>\n\n<p>Furthermore, it could be reused in other scenarios of the same program.</p>\n"}, {"tags": ["arrays", "ruby", "sorting"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566206076, "post_id": 57550052, "comment_id": 101569445, "body": "You should edit to clarify your question. (It\u2019s an interesting one.) If you do I will vote to reopen,"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566209213, "post_id": 57550052, "comment_id": 101570961, "body": "<code>array.each_with_object([]) { |s,a| d=s.downcase; i = a.find_index { |i| a[i].key?(d) ==false }; i.nil? ? (a &lt;&lt; { d=&gt; s }) : a[i][d] = s }.map(&amp;:values)</code>. I wrote this on a phone so I didn\u2019t test, so maybe I made a small mistake. Can another reader check my code? \u2013"}, {"owner": {"reputation": 1705, "user_id": 1060070, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/30fc2666127827c20a1bef8802c5e755?s=128&d=identicon&r=PG", "display_name": "mamesaye", "link": "https://stackoverflow.com/users/1060070/mamesaye"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566231755, "post_id": 57550052, "comment_id": 101582853, "body": "I don&#39;t know what details you want. I put the desired output. The desired output will be used in another process. I could not figured out how to get to the desired output that is why I ask the question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1566235195, "post_id": 57550052, "comment_id": 101584354, "body": "You can use an example to elaborate your question, but it generally is not sufficient to tell readers what you would like to do. For example, <code>my_array.to_a</code> creates a collection of arrays that do not contain case-indifferent duplicates, but I don&#39;t think that&#39;s what you want. You need to begin with a statement of your problem in words that is complete and unambiguous. For example,..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566235333, "post_id": 57550052, "comment_id": 101584404, "body": "...(assuming my understanding is correct), &quot;Given an array of strings, <code>my_array</code>, I wish to create an array <code>partition</code> that contains arrays of elements from <code>my_array</code> such that: 1) <code>partition.flatten</code> contains all the elements of <code>my_array</code>; 2) for each element <code>a</code> of <code>partition</code>, the array <code>a.map { |s| s.downcase }</code> contains no duplicates; and 3) the number of elements of <code>partition</code> is as small as possible.&quot; Sounds like legalese, eh? You might not like that wording but I believe it meets the tests of completeness and clarify. You can use it if you wish."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566268427, "post_id": 57550052, "comment_id": 101593323, "body": "I misspoke in the first of my my two previous comments. <code>my_array.map { |s| [s] }</code> creates a collection of arrays that do not contain..."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566269324, "post_id": 57550211, "comment_id": 101593472, "body": "If you use <a href=\"https://ruby-doc.org//core-2.6.3/Array.html#method-i-zip\" rel=\"nofollow noreferrer\">Array#zip</a> (rather than <code>transpose</code>) you don&#39;t need to pad the arrays. For example, <code>a1 = [1,2,3,4]; a2 = [7,8]; a3 = [4,5,6]; a = [a1, a2, a3]; a.shift.zip(*a) #=&gt; [[1, 7, 4], [2, 8, 5], [3, nil, 6], [4, nil, nil]]</code>. The only requirement is that the <code>zip</code>&#39;s receiver (here <code>a1</code>) be no smaller than any array in <code>d</code>. It could be the largest or even <code>[nil]*(d.map(&amp;:size).max)</code>."}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1566323718, "post_id": 57550211, "comment_id": 101618161, "body": "I left the answer intentionally obtuse so as to provide the shape of the solution without necessarily giving a good homework answer. :)"}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 3, "last_activity_date": 1566185902, "creation_date": 1566185902, "answer_id": 57550211, "question_id": 57550052, "link": "https://stackoverflow.com/questions/57550052/ruby-array-separate-duplicates/57550211#57550211", "title": "ruby array separate &quot;duplicates&quot;", "body": "<p>The parameters of the question are fairly open to interpretation, but here's one approach: group the array by the downcase of the value:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&gt; d = my_array.group_by(&amp;:downcase).values\n&gt; pp d\n[[\"ZV2\", \"zv2\", \"zV2\"],\n [\"4Q3\", \"4q3\"],\n [\"abDc\", \"Abdc\", \"ABDC\"],\n [\"zQ2\"],\n [\"Def\", \"def\", \"DeF\", \"DEF\"]]\n</code></pre>\n\n<p>This gives you an array of arrays, each containing all the duplicates. From here, the solution should be relatively straightforward: given this list of \"rows\", you want a list of \"columns\". You can construct your output arrays by creating new arrays, taking the <em>n</em>th element of each array until you don't get any elements.</p>\n\n<p>One (non-optimal, in case this is homework!) way to do this would be to pad all your arrays to a common length, then to transpose the result:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>d = my_array.group_by(&amp;:downcase).values\nmax_len = d.map(&amp;:length).max\npadded = d.map {|v| v.fill(nil, v.length..max_len) }\n\npp padded\n[[\"ZV2\", \"zv2\", \"zV2\", nil, nil],\n [\"4Q3\", \"4q3\", nil, nil, nil],\n [\"abDc\", \"Abdc\", \"ABDC\", nil, nil],\n [\"zQ2\", nil, nil, nil, nil],\n [\"Def\", \"def\", \"DeF\", \"DEF\", nil]]\n</code></pre>\n\n<p>Now you simply transpose your array of arrays and compact out any nils:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>padded.transpose.map(&amp;:compact).select(&amp;:any?)\n=&gt; [[\"ZV2\", \"4Q3\", \"abDc\", \"zQ2\", \"Def\"], [\"zv2\", \"4q3\", \"Abdc\", \"def\"], [\"zV2\", \"ABDC\", \"DeF\"], [\"DEF\"]]\n</code></pre>\n\n<p>This is hardly the most elegant approach, but it illustrates the idea. You may be able to use this to conceive of better solutions.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1566188480, "creation_date": 1566188480, "answer_id": 57550459, "question_id": 57550052, "link": "https://stackoverflow.com/questions/57550052/ruby-array-separate-duplicates/57550459#57550459", "title": "ruby array separate &quot;duplicates&quot;", "body": "<p>You might reduce your array, splitting into the new subarray when needed:</p>\n\n<pre><code>my_array.each_with_object([]) do |e, acc|\n  (\n    acc.find { |a| !a.find { |ae| ae.casecmp(e).zero? } } ||\n    (acc &lt;&lt; []).last\n  ) &lt;&lt; e\nend\n#\u21d2\u00a0[[\"ZV2\", \"4Q3\", \"abDc\", \"zQ2\", \"Def\"],\n#   [\"4q3\", \"Abdc\", \"def\", \"zv2\"],\n#   [\"ABDC\", \"DeF\", \"zV2\"],\n#   [\"DEF\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1566237516, "creation_date": 1566237516, "answer_id": 57561795, "question_id": 57550052, "link": "https://stackoverflow.com/questions/57550052/ruby-array-separate-duplicates/57561795#57561795", "title": "ruby array separate &quot;duplicates&quot;", "body": "<pre><code>my_array.each_with_object([]) do |s,a|\n  d = s.downcase\n  idx = a.find_index { |h| h.key?(d) == false }\n  if idx.nil?\n    a &lt;&lt; { d=&gt;s }\n  else\n    a[idx][d] = s\n  end\nend.map(&amp;:values)\n  #=&gt; [[\"ZV2\", \"4Q3\", \"abDc\", \"zQ2\", \"Def\"],\n  #    [\"4q3\", \"Abdc\", \"def\", \"zv2\"],\n  #    [\"ABDC\", \"DeF\", \"zV2\"],\n  #    [\"DEF\"]] \n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org//core-2.6.3/Array.html#method-i-find_index\" rel=\"nofollow noreferrer\">Array#find_index</a>.</p>\n\n<p>I can best explain how this works by adding some <code>puts</code> statements. Interested readers can run the code below to observe the step-by-step calculations.</p>\n\n<pre><code>arr = my_array.each_with_object([]) do |s,a|\n  d = s.downcase\n  puts \"s=#{s}, a=#{a}, d=#{d}\"\n  idx = a.find_index { |h| h.key?(d) == false }\n  puts \"s=#{s}, a=#{a}, idx.nil?=#{idx.nil?}, idx=#{idx}\"\n  if idx.nil?\n    a &lt;&lt; { d=&gt;s }\n  else\n    a[idx][d] = s\n  end\n  puts \"  after case a=#{a.to_s}\"\nend\narr.map(&amp;:values)\n</code></pre>\n"}], "owner": {"reputation": 1705, "user_id": 1060070, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/30fc2666127827c20a1bef8802c5e755?s=128&d=identicon&r=PG", "display_name": "mamesaye", "link": "https://stackoverflow.com/users/1060070/mamesaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57550211, "answer_count": 3, "score": -1, "last_activity_date": 1566237516, "creation_date": 1566184230, "question_id": 57550052, "link": "https://stackoverflow.com/questions/57550052/ruby-array-separate-duplicates", "title": "ruby array separate &quot;duplicates&quot;", "body": "<p>I have this Array of words with a mix of caps and non-caps letters (and number sometimes ) :   </p>\n\n<p><code>my_array = ['ZV2', '4Q3', 'abDc', 'zQ2', 'Def', '4q3', 'Abdc', 'ABDC', 'def', 'zv2', 'DeF', 'zV2', 'DEF']</code>     </p>\n\n<p>I wanted to separate in several arrays that don't have duplicate words:   </p>\n\n<p><code>my_array1 = ['ZV2', '4Q3', 'abDc', 'zQ2', 'Def']</code>   </p>\n\n<p><code>my_array2 = ['4q3', 'Abdc', 'def', 'zv2']</code>      </p>\n\n<p><code>my_array3 = ['ABDC', 'DeF', 'zV2']</code>    and  </p>\n\n<p><code>my_array4 = ['DEF']</code></p>\n\n<p>What would be the best way to do it?</p>\n"}, {"tags": ["ruby", "database", "active-directory", "ldap", "ldap-query"], "comments": [{"owner": {"reputation": 4178, "user_id": 738708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7d0f23ff8919a2720a7845ba1d4e5a?s=128&d=identicon&r=PG", "display_name": "Ludovic Poitou", "link": "https://stackoverflow.com/users/738708/ludovic-poitou"}, "edited": false, "score": 0, "creation_date": 1566210101, "post_id": 57549697, "comment_id": 101571380, "body": "Could you please describe the error you are getting back?"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1566215702, "post_id": 57549697, "comment_id": 101574123, "body": "Maybe a separate ldap.auth is required, See here: <a href=\"https://stackoverflow.com/questions/21271834/ruby-net-ldap-add-user\" title=\"ruby net ldap add user\">stackoverflow.com/questions/21271834/ruby-net-ldap-add-user</a>."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1566215716, "post_id": 57549697, "comment_id": 101574131, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21271834/ruby-net-ldap-add-user\">Ruby net-ldap add user</a>"}, {"owner": {"reputation": 2464, "user_id": 1740662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3f09ad8d3af9982f70d2d5ce338aa?s=128&d=identicon&r=PG", "display_name": "Bernhard Thalmayr", "link": "https://stackoverflow.com/users/1740662/bernhard-thalmayr"}, "edited": false, "score": 0, "creation_date": 1566239737, "post_id": 57549697, "comment_id": 101586155, "body": "Just to note .... as the naming attribute is &#39;uid&#39; ,you don&#39;t need to add it as attribute as well."}, {"owner": {"reputation": 28745, "user_id": 1202807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09276b9edb245e928e7163b27b15691?s=128&d=identicon&r=PG", "display_name": "Gabriel Luci", "link": "https://stackoverflow.com/users/1202807/gabriel-luci"}, "edited": false, "score": 0, "creation_date": 1566324073, "post_id": 57549697, "comment_id": 101618296, "body": "You tagged <code>active-directory</code>. Are you actually using AD? If so, you have a few problems that I can see."}, {"owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "reply_to_user": {"reputation": 28745, "user_id": 1202807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09276b9edb245e928e7163b27b15691?s=128&d=identicon&r=PG", "display_name": "Gabriel Luci", "link": "https://stackoverflow.com/users/1202807/gabriel-luci"}, "edited": false, "score": 0, "creation_date": 1566324745, "post_id": 57549697, "comment_id": 101618572, "body": "@GabrielLuci Yes, I believe so. I&#39;m extremely new to LDAP so I am also trying to figure out how exactly it works too."}], "answers": [{"tags": [], "owner": {"reputation": 28745, "user_id": 1202807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09276b9edb245e928e7163b27b15691?s=128&d=identicon&r=PG", "display_name": "Gabriel Luci", "link": "https://stackoverflow.com/users/1202807/gabriel-luci"}, "is_accepted": false, "score": 0, "last_activity_date": 1566325683, "creation_date": 1566325683, "answer_id": 57579602, "question_id": 57549697, "link": "https://stackoverflow.com/questions/57549697/ldap-ldap-add-does-not-add-entries-to-the-ldap-server/57579602#57579602", "title": "LDAP- ldap.add does not add entries to the LDAP server", "body": "<p>I am not a Ruby developer, so my code examples may need tweaks. But if you are using Active Directory, then I see two problems:</p>\n\n<ol>\n<li>The <code>objectClass</code> should be <code>user</code></li>\n<li>In AD, the <a href=\"https://docs.microsoft.com/en-us/windows/win32/adschema/a-uid\" rel=\"nofollow noreferrer\"><code>uid</code></a> attribute has no special meaning. The username used for login is the <a href=\"https://docs.microsoft.com/en-us/windows/win32/adschema/a-samaccountname\" rel=\"nofollow noreferrer\"><code>sAMAccountName</code></a> attribute.</li>\n</ol>\n\n<pre><code>attr = {\n  :cn =&gt; \"Christine\",\n  :sn =&gt; \"Smith\",\n  :objectClass =&gt; \"user\",\n  :mail =&gt; \"christine@example.com\",\n  :sAMAccountName =&gt; \"christine\"\n}\n</code></pre>\n\n<p>You may also want to set <a href=\"https://docs.microsoft.com/en-us/windows/win32/adschema/a-givenname\" rel=\"nofollow noreferrer\"><code>givenName</code></a>, which is for the user's first name.</p>\n\n<p>If that doesn't work, let us know what error you are getting.</p>\n\n<p>That will create the account in a disabled state. To enable it you need to give it a password in a second step by setting the <a href=\"https://docs.microsoft.com/en-us/windows/win32/adschema/a-unicodepwd\" rel=\"nofollow noreferrer\"><code>unicodePwd</code></a> attribute (which has a weird format), and updating the <a href=\"https://docs.microsoft.com/en-us/windows/win32/adschema/a-useraccountcontrol\" rel=\"nofollow noreferrer\"><code>userAccountControl</code></a> attribute to enable it.</p>\n\n<p>Modify it again, using these attributes (where the new password is <code>\"new_password\"</code>):</p>\n\n<pre><code>def self.str2unicodePwd(str)\n    ('\"' + str + '\"').encode(\"utf-16le\").force_encoding(\"utf-8\")\nend\n\nattr = {\n  :unicodePwd, str2unicodePwd(\"new_password\"),\n  :userAccountControl, 0x200\n}\n</code></pre>\n\n<p>I borrowed some code from <a href=\"https://blog.bronislavrobenek.com/post/80163028550/changing-password-in-activedirectory-using-ruby\" rel=\"nofollow noreferrer\">here</a> for the password bit.</p>\n"}], "owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566325683, "creation_date": 1566179755, "question_id": 57549697, "link": "https://stackoverflow.com/questions/57549697/ldap-ldap-add-does-not-add-entries-to-the-ldap-server", "title": "LDAP- ldap.add does not add entries to the LDAP server", "body": "<p>I'm very new to working with LDAP, and any help is appreciated.</p>\n\n<p>I'm writing a Ruby program that adds entries to an LDAP server. I'm able to add entries just fine using Terminal. But the challenge is getting it to work using Ruby.</p>\n\n<p>Here is the LDAP server I'm trying to write to.</p>\n\n<pre><code># example.org\ndn: dc=example,dc=org\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Example Inc.\ndc: example\n\n# admin, example.org\ndn: cn=admin,dc=example,dc=org\nobjectClass: simpleSecurityObject\nobjectClass: organizationalRole\ncn: admin\ndescription: LDAP administrator\nuserPassword: mypassword\n\n# people, example.org\ndn: ou=people,dc=example,dc=org\nobjectClass: organizationalUnit\nou: people\n</code></pre>\n\n<p>And here are the contents of ldap-program.rb. For the</p>\n\n<pre><code>    require 'rubygems'\n    require 'net/ldap'\n\n    ldap = Net::LDAP.new  :host =&gt; '127.0.0.1',\n                            :port =&gt; 1300,\n                            :auth =&gt; {\n                                :method =&gt; :simple,\n                                :username =&gt; 'cn=admin,dc=example,dc=org',\n                                :password =&gt; 'mypassword'\n    }\n\n  dn = \"uid=christine,ou=people,dc=example,dc=com\"\nattr = {\n  :cn =&gt; \"Christine\",\n  :sn =&gt; \"Smith\",\n  :objectClass =&gt; \"inetOrgPerson\",\n  :mail =&gt; \"christine@example.com\",\n  :uid =&gt; \"christine\"\n}\n\nldap.add(:dn =&gt; dn, :attr =&gt; attr)\n</code></pre>\n\n<p>I've been following the documentation for ldap.add very closely, but in this case the entry does not get added to LDAP. Can anyone give any pointers or suggestions?</p>\n"}, {"tags": ["arrays", "ruby", "memory", "iterator"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1566175500, "post_id": 57549283, "comment_id": 101561528, "body": "In general, Ruby won&#39;t create an array unless it really has to, see <a href=\"https://stackoverflow.com/q/6487747/479863\">stackoverflow.com/q/6487747/479863</a> (which is about 1.9.2 but it is highly unlikely that the behavior has changed for the worse)."}], "answers": [{"comments": [{"owner": {"reputation": 129875, "user_id": 325418, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/eb71c362ddeda80c2668d2575e97bc70?s=128&d=identicon&r=PG", "display_name": "nonopolarity", "link": "https://stackoverflow.com/users/325418/nonopolarity"}, "edited": false, "score": 0, "creation_date": 1566196394, "post_id": 57551263, "comment_id": 101565248, "body": "I think we can infer it... although using numbers may be more relevant to the common use case. I wonder why the big increase of number of objects in the first case. Is it because the string objects created but not garbage collected. In the second case, why that many objects... 26**4 is only 456976"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 129875, "user_id": 325418, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/eb71c362ddeda80c2668d2575e97bc70?s=128&d=identicon&r=PG", "display_name": "nonopolarity", "link": "https://stackoverflow.com/users/325418/nonopolarity"}, "edited": false, "score": 0, "creation_date": 1566196935, "post_id": 57551263, "comment_id": 101565434, "body": "No idea, maybe String#succ creates an intermediate value or something. But that&#39;s an implementation detail. I added an example with integers (they just need to be large enough to exit the fixnum range)."}, {"owner": {"reputation": 129875, "user_id": 325418, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/eb71c362ddeda80c2668d2575e97bc70?s=128&d=identicon&r=PG", "display_name": "nonopolarity", "link": "https://stackoverflow.com/users/325418/nonopolarity"}, "edited": false, "score": 0, "creation_date": 1566198461, "post_id": 57551263, "comment_id": 101566042, "body": "how come you call <code>GC.start</code> ? isn&#39;t it automatic?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 129875, "user_id": 325418, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/eb71c362ddeda80c2668d2575e97bc70?s=128&d=identicon&r=PG", "display_name": "nonopolarity", "link": "https://stackoverflow.com/users/325418/nonopolarity"}, "edited": false, "score": 0, "creation_date": 1566198616, "post_id": 57551263, "comment_id": 101566117, "body": "It&#39;s automatic but unpredictable. I wanted to start with as clear a slate as possible, given that counting live objects is what the example is about."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1566196839, "last_edit_date": 1566196839, "creation_date": 1566195056, "answer_id": 57551263, "question_id": 57549283, "link": "https://stackoverflow.com/questions/57549283/which-ruby-methods-to-loop-through-numbers-actually-create-the-array-and-which-d/57551263#57551263", "title": "Which Ruby methods to loop through numbers actually create the array and which do not?", "body": "<p>None of those three create an array. The first creates a <code>Range</code>, the last two create an <code>Enumerator</code>.</p>\n\n<p>Proof (in MRI only, tested on 2.6.3p62):</p>\n\n<pre><code># Does not create an array:\nruby -e 's = {}; GC.start; p \"Before: #{ObjectSpace.count_objects(s)[:T_STRING]}\"; (\"AAAA\"..\"ZZZZ\").each { |x| p \"During: #{ObjectSpace.count_objects(s)[:T_STRING]}\" if x == \"ZZZZ\" }'\n# =&gt; \"Before: 8417\"\n# =&gt; \"During: 16979\"\n\n# Creates an array:\nruby -e 's = {}; GC.start; p \"Before: #{ObjectSpace.count_objects(s)[:T_STRING]}\"; (\"AAAA\"..\"ZZZZ\").to_a.each { |x| p \"During: #{ObjectSpace.count_objects(s)[:T_STRING]}\" if x == \"ZZZZ\" }'\n# =&gt; \"Before: 8417\"\n# =&gt; \"During: 780125\"\n</code></pre>\n\n<p>The only difference between the two is <code>#to_a</code> inserted before <code>#each</code>. The exact numbers will change from run to run, but the magnitude should be obviously different. I went with strings rather than integers because small integers are not implemented as objects and cannot be counted by <code>Objectspace::count_objects</code>.</p>\n\n<p>EDIT: but large integers are. :)</p>\n\n<pre><code>ruby -e 'base = 4611686018427387904; s = {}; GC.start; p \"Before: #{ObjectSpace.count_objects(s)[:T_BIGNUM]}\"; base.upto(base + 10000).each { |x| p \"During: #{ObjectSpace.count_objects(s)[:T_BIGNUM]}\" if x == base }'\n# =&gt; \"Before: 3\"\n# =&gt; \"During: 4\"\n\nruby -e 'base = 4611686018427387904; s = {}; GC.start; p \"Before: #{ObjectSpace.count_objects(s)[:T_BIGNUM]}\"; base.upto(base + 10000).to_a.each { |x| p \"During: #{ObjectSpace.count_objects(s)[:T_BIGNUM]}\" if x == base }'\n# =&gt; \"Before: 3\"\n# =&gt; \"During: 10005\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 129875, "user_id": 325418, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/eb71c362ddeda80c2668d2575e97bc70?s=128&d=identicon&r=PG", "display_name": "nonopolarity", "link": "https://stackoverflow.com/users/325418/nonopolarity"}, "is_accepted": false, "score": 0, "last_activity_date": 1566215717, "last_edit_date": 1566215717, "creation_date": 1566198164, "answer_id": 57551855, "question_id": 57549283, "link": "https://stackoverflow.com/questions/57549283/which-ruby-methods-to-loop-through-numbers-actually-create-the-array-and-which-d/57551855#57551855", "title": "Which Ruby methods to loop through numbers actually create the array and which do not?", "body": "<p>Together with @Amadan's answer and <a href=\"https://stackoverflow.com/a/7863068/325418\">another post on showing memory use</a> and then <a href=\"https://github.com/schneems/get_process_mem/blob/master/lib/get_process_mem.rb\" rel=\"nofollow noreferrer\">a even better one</a>, the following can show the memory use inside the loop:</p>\n\n<pre><code>def show_memory_used(s = \"\")\n  puts \"%.1fMB used %s\" % [`ps -o rss= -p #{$$}`.to_f/1024, s]\nend\n\nshow_memory_used(\"at the beginning\")\n\nn = 10000000\n\n(0..n).each{|i| show_memory_used(\"during loop 1\") if i == n}\n\n0.upto(n){|i| show_memory_used(\"during loop 2\") if i == n}\n\n(n+1).times.to_a.each.each{|i| show_memory_used(\"during loop 3\") if i == n}\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre><code>6.0MB used at the beginning\n6.0MB used during loop 1\n6.0MB used during loop 2\n6.0MB used during loop 3\n</code></pre>\n\n<p>change any of those lines to something like:</p>\n\n<pre><code>(0..n).to_a.each{|i| show_memory_used() if i == n}\n</code></pre>\n\n<p>to actually create an array, and you can see a big increase in memory used:</p>\n\n<pre><code>82.7MB used during loop 1\n</code></pre>\n"}], "owner": {"reputation": 129875, "user_id": 325418, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/eb71c362ddeda80c2668d2575e97bc70?s=128&d=identicon&r=PG", "display_name": "nonopolarity", "link": "https://stackoverflow.com/users/325418/nonopolarity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566215717, "creation_date": 1566174146, "last_edit_date": 1566177107, "question_id": 57549283, "link": "https://stackoverflow.com/questions/57549283/which-ruby-methods-to-loop-through-numbers-actually-create-the-array-and-which-d", "title": "Which Ruby methods to loop through numbers actually create the array and which do not?", "body": "<p>For example, given <code>n</code>, which may be <code>1000000</code> or <code>100000000</code>, to find out </p>\n\n<pre><code>0 ^ 1 ^ 2 ^ 3 ^ ... ^ n\n</code></pre>\n\n<p>there can be several ways:</p>\n\n<pre><code>p (0..n).inject(:^)\np 0.upto(n).inject(:^)\np (n+1).times.inject(:^)\n</code></pre>\n\n<p>(is there any other common ways to do this in Ruby?) Which of the common ways to loop through a range in Ruby actually creates an array and therefore may cause huge memory usage? (as a general rule to remember).</p>\n\n<p>On a Mac, are there ways either inside of the Ruby program and by using the OS to tell that the memory use is in fact minimal (O(1) space) to verify that no actual array is created?</p>\n\n<p>P.S. one way is to make <code>n</code> quite big such as <code>100000000</code>, run it, and use <code>ps v</code> in another shell to see that memory is at a low % (as compared to running a program with <code>(0..n).to_a.inject(:^)</code>), but I am not sure if there is a better way.</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1566172621, "post_id": 57549118, "comment_id": 101561182, "body": "Have you considered using <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-select\" rel=\"nofollow noreferrer\">select</a>?"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1566173024, "post_id": 57549118, "comment_id": 101561231, "body": "You have a <code>val_count</code> variable that you never use, you&#39;re assigning it to the result of <code>.include?</code> which will be a boolean so it&#39;s confusing that the name is <code>val_count</code> which implies a number, you have never declared the <code>gmail_count</code> variable though you&#39;re <code>puts</code>ing it. Also you&#39;re showing the output but not the input so people trying to help you just have to guess?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1566182847, "post_id": 57549824, "comment_id": 101562554, "body": "Enumerable#count accepts a block. Better than a select/size combo."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1566186558, "post_id": 57549824, "comment_id": 101563047, "body": "@SergioTulentsev Thanks. There&#39;s always more Ruby convenience methods to learn."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1566186532, "last_edit_date": 1566186532, "creation_date": 1566181291, "answer_id": 57549824, "question_id": 57549118, "link": "https://stackoverflow.com/questions/57549118/count-how-many-times-return-true-include-ruby/57549824#57549824", "title": "count how many times return true .include? ruby", "body": "<p>This can be done by using <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-select\" rel=\"nofollow noreferrer\"><code>count</code></a> to count the entries which match in each company and then <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-sum\" rel=\"nofollow noreferrer\"><code>sum</code></a> them together.</p>\n\n<pre><code>companies = [\n  { this: { \"email_hosts\" =&gt; \"hotestmail\" } },\n  {\n    this: { \"email_hosts\" =&gt; \"gmail\" },\n    that: { \"email_hosts\" =&gt; \"gmail.com\" },\n    other: { \"email_hosts\" =&gt; \"gmail.com\" }\n  }\n]\n\nputs companies.sum { |company|\n  company.count { |_,host|\n    host[\"email_hosts\"].include?(\"gmail\")\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11103168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRG3o.jpg?s=128&g=1", "display_name": "7KAG7", "link": "https://stackoverflow.com/users/11103168/7kag7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1566186532, "creation_date": 1566171577, "last_edit_date": 1566172791, "question_id": 57549118, "link": "https://stackoverflow.com/questions/57549118/count-how-many-times-return-true-include-ruby", "title": "count how many times return true .include? ruby", "body": "<p>I have a function I am building where I need to check if the value from a hash object includes a specific word/string. </p>\n\n<p>I can get my <code>|key, value|</code> value to return if all the values include the specific phrase giving me a list of true or false and I just need the output the number of <code>true</code>s.</p>\n\n<pre><code>def example(array)\n  array.each do |company|\n    company.each do |key, value|\n      val_count = value[\"email_hosts\"].include?(\"gmail\")\n      puts gmail_count\n    end\n  end\nend\n\nexample(request)\n</code></pre>\n\n<p>this outputs:</p>\n\n<pre><code>false\nfalse\ntrue\ntrue\nfalse\ntrue\nfalse\nfalse\nfalse\nfalse\nfalse\nfalse\n</code></pre>\n\n<p>I need the output to just be 3, for the three <code>true</code>s.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "erb", "enumerable"], "comments": [{"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 1, "creation_date": 1566165617, "post_id": 57547599, "comment_id": 101560334, "body": "I think this logic could be better a method providing an own instance variable within the controller."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1566225473, "post_id": 57547599, "comment_id": 101579726, "body": "You should consider using <code>Schedule.where(class_room: 10)</code> which will filter the results in the database instead of pulling everything out and then filtering it in Ruby."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 4, "last_activity_date": 1566155945, "last_edit_date": 1566155945, "creation_date": 1566155625, "answer_id": 57547617, "question_id": 57547599, "link": "https://stackoverflow.com/questions/57547599/how-use-block-with-enumerable-in-erb/57547617#57547617", "title": "How use block with enumerable in erb", "body": "<p>You have some <code>&lt;%</code> and <code>%&gt;</code> extra, but this might work:</p>\n\n<pre><code>&lt;% @schedules.select { |schedule| schedule.class_room == 10 }.each do |schedule| %&gt;\n  &lt;%= schedule.class_room %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>First line just select those schedules where <code>class_room</code> in is 10 in one line, then opens a multi line block, and in a new line you use <code>&lt;%= %&gt;</code> to open each schedule <code>class_room</code>.</p>\n\n<hr>\n\n<p>Alternatively you can pass to the next element during the iteration <code>unless</code> the <code>schedule.class_room</code> is 10:</p>\n\n<pre><code>&lt;% @schedules.each do |schedule| %&gt;\n  &lt;% next unless schedule.class_room == 10 %&gt;\n  &lt;%= schedule.class_room %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11885305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42514adbf8ec46977e9f547e4dfc5f30?s=128&d=identicon&r=PG&f=1", "display_name": "DEv", "link": "https://stackoverflow.com/users/11885305/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 57547617, "answer_count": 1, "score": 1, "last_activity_date": 1566157145, "creation_date": 1566155435, "last_edit_date": 1566157145, "question_id": 57547599, "link": "https://stackoverflow.com/questions/57547599/how-use-block-with-enumerable-in-erb", "title": "How use block with enumerable in erb", "body": "<p>How use enumerable in erb (rails views) with block. for example:</p>\n\n<pre><code>&lt;% &lt;% @schedules.select do |s| s.class_room == 10 %&gt;\n  &lt;%= s.class_room %&gt;\n&lt;% end %&gt; %&gt;\n</code></pre>\n\n<p>I want select record where field <code>class_room</code> equal <code>10</code>. how i can do this in the erb???</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1566157192, "post_id": 57547737, "comment_id": 101558675, "body": "Thank you - <i>&quot;The value of i here is a Hash, which is <b>mutable</b>&quot;</i> - this was how I was groking it."}, {"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1566157658, "post_id": 57547737, "comment_id": 101558794, "body": "Can you pls clarify <i>&quot;The assignment doesn&#39;t propogate anywhere, no matter if you use <code>map</code> or <code>map!</code>&quot;</i>  - re: <code>map!</code> assigns the new value as expected (in first example Array&lt;number&gt;)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1566166006, "post_id": 57547737, "comment_id": 101560389, "body": "@EdSF I can try ... consider <code>[1,2,3].each { |i| i = 5000 }</code>. What&#39;s getting assigned to 5000 here? The variable <code>i</code>, which is redefined each block."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1566156700, "creation_date": 1566156700, "answer_id": 57547737, "question_id": 57547589, "link": "https://stackoverflow.com/questions/57547589/ruby-map-map-modifying-array-of-hashes/57547737#57547737", "title": "Ruby map, map! modifying array of hashes", "body": "<p>Let's compare the value of <code>i</code> in your first example:</p>\n\n<pre><code>foo = [1,2,3]\nfoo.map { |i| i*=2}\n</code></pre>\n\n<p><code>i</code> here is a number. Numbers are immutable. Thus writing <code>i * 2</code> or <code>i *= 2</code> in the block makes no difference. The assignment doesn't propogate anywhere, no matter if you use <code>map</code> or <code>map!</code>.</p>\n\n<p>Why doesn't the assignment matter, even if you use <code>map!</code> ? We can re-implement <code>map!</code> quickly to understand:</p>\n\n<pre><code>def my_map!(list, &amp;blk)\n  list.each_index { |i| list[i] = blk.call(list[i]) }\n  list\nend\n</code></pre>\n\n<p>As you can see, we're setting the value of each index to the <em>return value of the block</em>. And the <em>return value</em> of <code>i * 2</code> or <code>i *= 2</code> is the same. </p>\n\n<p>Now, looking at the second example:</p>\n\n<pre><code>bar =  [{foo:1,bar:11}, {foo:2,bar:12}, {foo:3,bar:13}]\nbar.map { |i| i[:foo]*= 2}\n</code></pre>\n\n<p>Why does this mutate the hashes? The value of <code>i</code> here is a Hash, which <em>is mutable</em>. Assigning a key-val (<code>i[:foo]*= 2</code>) mutates it, regardless of if it happens in <code>each</code>, <code>map</code>, <code>map!</code>, etc.</p>\n\n<p>So, to cut to the chase, you would want to create a new hash using something like <code>merge</code> or <code>dup</code>:</p>\n\n<pre><code>bar =  [{foo:1,bar:11}, {foo:2,bar:12}, {foo:3,bar:13}]\nbar.map { |i| i.merge(foo: i[:foo] * 2) }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1566158237, "post_id": 57547910, "comment_id": 101558932, "body": "Thank you, <i>&quot;hash is mutable&quot;</i> was how I was making sense of it. IMHO, worth a note in documentation(?) of <code>map</code>, <code>map!</code>...."}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1566158582, "post_id": 57547910, "comment_id": 101558999, "body": "It might be worth suggesting a comment in the documentation."}], "tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": true, "score": 2, "last_activity_date": 1566158042, "creation_date": 1566158042, "answer_id": 57547910, "question_id": 57547589, "link": "https://stackoverflow.com/questions/57547589/ruby-map-map-modifying-array-of-hashes/57547910#57547910", "title": "Ruby map, map! modifying array of hashes", "body": "<p>The <code>map</code> method does not change the array's contents, as can be seen by inspecting the <code>object_id</code> of each element of the array.  However, each element is a hash, which is mutable, so updating the contents of the hash is permissible.  This can be seen from the following step-by-step trace of the results:</p>\n\n<pre><code>p baz = [{foo:1,bar:11}, {foo:2,bar:12}, {foo:3,bar:13}]\nputs \"baz contents IDs are:\"\nbaz.each { |hsh| p hsh.object_id }\nputs \"performing the map operation\"\np baz.map { |i| i[:foo] *= 2 }\nputs \"baz contents IDs still are:\"\nbaz.each { |hsh| p hsh.object_id }\nputs \"...but the contents of those contents have changed:\"\np baz\n</code></pre>\n\n<p>which produces, e.g.:</p>\n\n<pre><code>[{:foo=&gt;1, :bar=&gt;11}, {:foo=&gt;2, :bar=&gt;12}, {:foo=&gt;3, :bar=&gt;13}]\nbaz contents IDs are:\n70261047089900\n70261047089860\n70261047089840\nperforming the map operation:\n[2, 4, 6]\nbaz contents IDs still are:\n70261047089900\n70261047089860\n70261047089840\n...but the contents of those contents have changed:\n[{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}]\n</code></pre>\n\n<p>Note that I changed the name of the array to <code>baz</code> to avoid any confusion due to name shadowing.</p>\n"}, {"comments": [{"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 1, "creation_date": 1566237037, "post_id": 57553893, "comment_id": 101585126, "body": "Thank you - yup, understand that. I&#39;m more into what happens to the underlying/original array, with <code>map</code> - re: it <i>does</i> change contrary to what one might think depending on mutability."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566206811, "creation_date": 1566206811, "answer_id": 57553893, "question_id": 57547589, "link": "https://stackoverflow.com/questions/57547589/ruby-map-map-modifying-array-of-hashes/57553893#57553893", "title": "Ruby map, map! modifying array of hashes", "body": "<p>I'd like to add my two cents.</p>\n\n<p>When you use the exact same code (<code>e[:foo] *= 2</code>) in the block you can see that <code>map</code> and <code>map!</code> differs.\n<hr>\n<strong>Using <code>map</code></strong></p>\n\n<pre><code>bar =  [ {foo:1, bar:11}, {foo:2, bar:12}, {foo:3, bar:13} ]\nbar.map { |e| e[:foo] *= 2 } #=&gt; [2, 4, 6]\nbar #=&gt; [{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}]\n</code></pre>\n\n<p>On <code>bar</code> you get the exact same effect as using <code>each</code>, except for the returning value of the call:</p>\n\n<pre><code>bar =  [ {foo:1, bar:11}, {foo:2, bar:12}, {foo:3, bar:13} ]\nbar.each { |e| e[:foo] *= 2 } #=&gt; [{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}]\nbar #=&gt; [{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}]\n</code></pre>\n\n<p><hr>\n<strong>Using <code>map!</code></strong></p>\n\n<pre><code>bar =  [ {foo:1, bar:11}, {foo:2, bar:12}, {foo:3, bar:13} ]\nbar.map! { |e| e[:foo] *= 2 } #=&gt; [2, 4, 6]\nbar #=&gt; [2, 4, 6]\n</code></pre>\n\n<p><hr>\n<a href=\"https://stackoverflow.com/a/57270113/5239030\">Once @Amadam</a> gave me a link to a really useful tool to understand what's going on during the execution of the code, maybe could help further: <a href=\"http://www.pythontutor.com/visualize.html#mode=edit\" rel=\"nofollow noreferrer\">http://www.pythontutor.com/visualize.html#mode=edit</a></p>\n"}], "owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57547910, "answer_count": 3, "score": 2, "last_activity_date": 1566206811, "creation_date": 1566155353, "last_edit_date": 1566176191, "question_id": 57547589, "link": "https://stackoverflow.com/questions/57547589/ruby-map-map-modifying-array-of-hashes", "title": "Ruby map, map! modifying array of hashes", "body": "<p>So <code>map</code> vs <code>map!</code></p>\n\n<pre><code>foo = [1,2,3]\nfoo.map { |i| i*=2}\n=&gt; [2, 4, 6]\nfoo\n=&gt; [1, 2, 3] # foo unchanged\n\nfoo.map! { |i| i*=2}\n=&gt; [2, 4, 6]\nfoo\n=&gt; [2, 4, 6] # foo is changed\n</code></pre>\n\n<p>All good/expected. Now with Array of <code>hash</code>, let's do <code>map</code>:</p>\n\n<pre><code>bar =  [{foo:1,bar:11}, {foo:2,bar:12}, {foo:3,bar:13}]\n=&gt; [{:foo=&gt;1, :bar=&gt;11}, {:foo=&gt;2, :bar=&gt;12}, {:foo=&gt;3, :bar=&gt;13}]\nbar.map { |i| i[:foo]*= 2}\n=&gt; [2, 4, 6]\nbar\n=&gt; [{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}] # changed\n</code></pre>\n\n<p>So it seems that the underlying array of hashes were modified using <code>map</code>, and essentially is the same as <code>map!</code>:</p>\n\n<pre><code>bar.map! do |i| \n i[:foo]*=2 \n i \nend\n=&gt; [{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}]\nbar\n=&gt; [{:foo=&gt;2, :bar=&gt;11}, {:foo=&gt;4, :bar=&gt;12}, {:foo=&gt;6, :bar=&gt;13}]\n</code></pre>\n\n<p>Probably missing something fundamental here. Not looking for alternatives, just trying to understand what <em>seems</em> to be an undocumented(?) note/gotcha/inconsistency. Tnx!</p>\n"}, {"tags": ["javascript", "ruby", "http", "pusher"], "answers": [{"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1566335425, "creation_date": 1566335425, "answer_id": 57581573, "question_id": 57547423, "link": "https://stackoverflow.com/questions/57547423/trying-to-use-pusher-to-read-exchange-data/57581573#57581573", "title": "Trying to use Pusher to read exchange data", "body": "<p>The PUSHER_URL should not be defined in your code but as environment variable, as you assign this String to the constant, you get this error. It hould be in the form <a href=\"http://KEY:SECRET@HOST/apps/APP_ID\" rel=\"nofollow noreferrer\">http://KEY:SECRET@HOST/apps/APP_ID</a></p>\n\n<p>The .from_env reads this environment variable.</p>\n\n<p>Environment variables are set differently depending in your operating system.</p>\n"}], "owner": {"reputation": 55, "user_id": 3364046, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9a164bca32813ccf2007ac6c550963d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3364046", "link": "https://stackoverflow.com/users/3364046/user3364046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566335425, "creation_date": 1566153914, "question_id": 57547423, "link": "https://stackoverflow.com/questions/57547423/trying-to-use-pusher-to-read-exchange-data", "title": "Trying to use Pusher to read exchange data", "body": "<p>I'm trying to read sell offers from this exchange called Liquid using Ruby's Pusher library. For some reason everything else in the documentation is in Ruby, except for the Pusher part which is in Javascript. <a href=\"https://developers.liquid.com/?ruby#liquid-tap\" rel=\"nofollow noreferrer\">Link to the documentation</a></p>\n\n<p>I read <a href=\"https://github.com/pusher/pusher-http-ruby#installation--configuration\" rel=\"nofollow noreferrer\">Ruby's Pusher documentation</a> and they simply don't really go well together. They don't use the same variables and I'm totally lost.</p>\n\n<p>This is what I have so far and am kind of stuck. Even this is pretty much a guess.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'pusher'\n\ntaptoliq('price_ladders_cash_btcusd_sell')\n\ndef taptoliq(path=nil)\n  channels_client = Pusher::Client.new(\n      key: 'LIQUID',\n      channel: path,\n      event: 'updated',\n      host: 'tap.liquid.com',\n      wsHost: 'tap.liquid.com',\n  )\nPUSHER_URL = 'The example code doesnt have secrets, apps or app ids. The command below doesnt run without this being configured correctly.'\n\nchannels_client = Pusher::Client.from_env\nend\n</code></pre>\n\n<p>I want to have a variable that would dynamically update. I'm not sure if my channel_client is configured correctly and I'm more than sure that PUSHER_URL is wrong as well. The final command of the function is what crashes complaining bad configurations. \n\"Uncaught exception: C:/rubyproj/liquidtap.rb:10: dynamic constant assignment\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 4, "creation_date": 1566155199, "post_id": 57547414, "comment_id": 101558237, "body": "You can try replacing this <code>&quot;\u201d&quot;</code> and this <code>&quot;\u201d&quot;</code> with this <code>&quot;&quot;&quot;</code>."}, {"owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1566155927, "post_id": 57547414, "comment_id": 101558384, "body": "It seemed to work with single quotes!"}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 5472341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5dbe2071e88de9580a9e7c97b46880?s=128&d=identicon&r=PG&f=1", "display_name": "James.Oliver", "link": "https://stackoverflow.com/users/5472341/james-oliver"}, "edited": false, "score": 1, "creation_date": 1566166952, "post_id": 57548714, "comment_id": 101560518, "body": "I often get caught up with this when copying some data from my password manager. Your syntax highlighter should be showing that the string&#39;s are &#39;overflowing&#39; the UTF8 characters."}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566167193, "last_edit_date": 1566167193, "creation_date": 1566165998, "answer_id": 57548714, "question_id": 57547414, "link": "https://stackoverflow.com/questions/57547414/whats-wrong-with-my-scope-ruby-on-rails/57548714#57548714", "title": "What&#39;s wrong with my scope, ruby on rails?", "body": "<p>Your quotation marks are not the standard ones but some weird utf8 characters, use \" or ' instead. The error message ist pretty misleading. Some editors are using this format which is not valid for rails.</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1566225119, "last_edit_date": 1566225119, "creation_date": 1566213436, "answer_id": 57555678, "question_id": 57547414, "link": "https://stackoverflow.com/questions/57547414/whats-wrong-with-my-scope-ruby-on-rails/57555678#57555678", "title": "What&#39;s wrong with my scope, ruby on rails?", "body": "<p>You are using angled double quotation marks (<code>\u201c</code> and <code>\u201d</code>) which is not a valid string delimiter for literals in Ruby. Usually this happens if you are are copying text into an editor not meant for programming like MS Word. Valid delimeters are <code>'</code> and <code>\"</code>. </p>\n\n<p>You can also improve the readability greatly by using named instead of ordinal placeholders.</p>\n\n<pre><code>scope :between, -&gt; (sender_id,recipient_id) do\n  where(\n    \"(conversations.sender_id = :s AND conversations.recipient_id = :r ) OR (conversations.sender_id = :r AND conversations.recipient_id = :s)\", \n    s: sender_id, r: recipient_id\n  )\nend\n</code></pre>\n"}], "owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57555678, "answer_count": 2, "score": 1, "last_activity_date": 1566225119, "creation_date": 1566153830, "question_id": 57547414, "link": "https://stackoverflow.com/questions/57547414/whats-wrong-with-my-scope-ruby-on-rails", "title": "What&#39;s wrong with my scope, ruby on rails?", "body": "<pre><code> scope :between, -&gt; (sender_id,recipient_id) do\n    where(\u201c(conversations.sender_id = ? AND conversations.recipient_id = ? ) OR (conversations.sender_id = ? AND conversations.recipient_id =?)\u201d, sender_id, recipient_id, recipient_id, sender_id)\n  end\n</code></pre>\n\n<p>I keep getting an error that says:</p>\n\n<pre><code>warning: invalid character syntax; use ?\\s\n</code></pre>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["ruby", "rvm"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1566155339, "post_id": 57547323, "comment_id": 101558262, "body": "How did you install RVM? It should not be at <code>&#47;usr&#47;local&#47;rvm</code>, which is probably the issue. Make sure you install RVM using <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">the instructions on their site</a> -- <code>\\curl -sSL https:&#47;&#47;get.rvm.io | bash -s stable</code> -- not using brew."}], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 1, "last_activity_date": 1566205698, "creation_date": 1566205698, "answer_id": 57553586, "question_id": 57547323, "link": "https://stackoverflow.com/questions/57547323/i-am-not-able-to-install-ruby-through-rvm/57553586#57553586", "title": "I am not able to install ruby through rvm", "body": "<p>As reading from the documentation <a href=\"https://github.com/rvm/rvm/blob/master/help/fix-permissions.md\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>You can try</p>\n\n<pre><code>rvm fix-permissions\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11286717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OysRu6ppb0U/AAAAAAAAAAI/AAAAAAAAAAk/c8eR1BlDQ8s/photo.jpg?sz=128", "display_name": "Mr.Movies Tamil", "link": "https://stackoverflow.com/users/11286717/mr-movies-tamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566205698, "creation_date": 1566153041, "last_edit_date": 1566155236, "question_id": 57547323, "link": "https://stackoverflow.com/questions/57547323/i-am-not-able-to-install-ruby-through-rvm", "title": "I am not able to install ruby through rvm", "body": "<p>I am not able to install ruby via rvm. I uninstalled all the homebrew, rvm and installed again. </p>\n\n<p>After installing rvm I am not able to install ruby via it.</p>\n\n<pre><code>rvm install ruby 2.2.3\nSearching for binary rubies, this might take some time.\nNo binary rubies available for: osx/10.14/x86_64/ruby-2.2.3.\nContinuing with compilation. Please read 'rvm help mount' to get more information on binary rubies.\n\n\nChecking requirements for osx.\nInstalling requirements for osx.\nmkdir: /usr/local/rvm/log/1566152593_ruby-2.2.3: Permission denied\ntee: /usr/local/rvm/log/1566152593_ruby-2.2.3/update_system.log: No such file or directory\nUpdating system......\nError running 'requirements_osx_brew_update_system ruby-2.2.3',\nplease read /usr/local/rvm/log/1566152593_ruby-2.2.3/update_system.log\nRequirements installation failed with status: 1.\n</code></pre>\n\n<p>I didnt get any solution after searching internet for an hour</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "migration"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1566191414, "post_id": 57546487, "comment_id": 101563890, "body": "Check the docs, it tells you how your migration should look for a HABTM relationship <a href=\"https://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "edited": false, "score": 0, "creation_date": 1566149869, "post_id": 57546611, "comment_id": 101557064, "body": "My user (sender) model has this:   has_and_belongs_to_many :conversations, dependent: :destroy  Would this work?   This is really messy haha"}, {"owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "edited": false, "score": 0, "creation_date": 1566151075, "post_id": 57546611, "comment_id": 101557330, "body": "I get this query for some reason when I run: User.first.conversations.to_sql  &quot;SELECT \\&quot;conversations\\&quot;.* FROM \\&quot;conversations\\&quot; INNER JOIN \\&quot;conversations_users\\&quot; ON \\&quot;conversations\\&quot;.\\&quot;id\\&quot; = \\&quot;conversations_users\\&quot;.\\&quot;conversation_id\\&quot; WHERE \\&quot;conversations_users\\&quot;.\\&quot;user_id\\&quot; = 1&quot;  Where is the &quot;conversations_users&quot; table even coming from??"}, {"owner": {"reputation": 55, "user_id": 4660182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TRg22douzc/AAAAAAAAAAI/AAAAAAAAABA/tcq0iO6bxC4/photo.jpg?sz=128", "display_name": "Skilly", "link": "https://stackoverflow.com/users/4660182/skilly"}, "reply_to_user": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "edited": false, "score": 0, "creation_date": 1566151801, "post_id": 57546611, "comment_id": 101557448, "body": "@RyanGlen Rails knows that a <code>has_and_belongs_to_many</code> relation needs such a table. Check your <code>db&#47;schema.rb</code> file, you should be able to find the <code>conversations_users</code> table in there."}], "tags": [], "owner": {"reputation": 55, "user_id": 4660182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0TRg22douzc/AAAAAAAAAAI/AAAAAAAAABA/tcq0iO6bxC4/photo.jpg?sz=128", "display_name": "Skilly", "link": "https://stackoverflow.com/users/4660182/skilly"}, "is_accepted": false, "score": 1, "last_activity_date": 1566147733, "last_edit_date": 1566147733, "creation_date": 1566147403, "answer_id": 57546611, "question_id": 57546487, "link": "https://stackoverflow.com/questions/57546487/conversation-migration-ruby-on-rails/57546611#57546611", "title": "Conversation Migration Ruby on Rails", "body": "<p>Your <code>conversations</code> and <code>messages</code> tables look fine, but your <code>Sender</code> (User?) model should have a <code>belongs_to</code> relation to <code>Conversation</code>. Add this in a <code>senders</code> migration: </p>\n\n<p><code>t.references :conversation</code></p>\n\n<p>EDIT: My bad, above solution assumes a one <code>Sender</code> to one <code>Conversation</code> relation, but a many to many relation seems more appropriate (a <code>Conversation</code> can have multiple <code>Sender</code>s, and a <code>Sender</code> can be in multiple <code>Conversation</code>s)</p>\n\n<p>What you'd need in that case, is a <code>senders_conversations</code> table that maps this many-to-many relation. <a href=\"https://www.sitepoint.com/master-many-to-many-associations-with-activerecord/\" rel=\"nofollow noreferrer\">Read up on ActiveRecord many-to-many here</a></p>\n\n<p><code>rails g migration CreateJoinTableAuthorsBooks authors books</code> from the link above is what you need (substitute authors and books with senders and conversations).</p>\n"}], "owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566147733, "creation_date": 1566146338, "question_id": 57546487, "link": "https://stackoverflow.com/questions/57546487/conversation-migration-ruby-on-rails", "title": "Conversation Migration Ruby on Rails", "body": "<pre><code>class Conversation &lt; ApplicationRecord\n    has_many :messages, dependent: :destroy\n    has_and_belongs_to_many :users\nend\n</code></pre>\n\n<p>I have this model above, but I'm not sure how to handle the migration for this table. Basically, each 'conversation' could have multiple users, like a group chat, and then it also has many messages. Any idea of how I should create my migration?</p>\n\n<pre><code>class CreateConversations &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :conversations do |t|\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>My messages migration looks like this:</p>\n\n<pre><code>class CreateMessages &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :messages do |t|\n      t.references :sender\n      t.references :conversation\n      t.text :content\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Does this look right?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566138140, "post_id": 57545385, "comment_id": 101554052, "body": "&quot;not seems to be working&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566138258, "post_id": 57545385, "comment_id": 101554076, "body": "It is unclear from your description what the code is supposed to be doing. I understand that you want to check inclusion by <code>id</code> but only if that is defined, otherwise by <code>sheet_id</code>? Can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including examples of desired inputs and outputs, both in normal cases as well as exceptional and boundary cases?"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566138278, "post_id": 57545385, "comment_id": 101554087, "body": "I am sorry for not describing the error i will update my question."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1566138422, "post_id": 57545385, "comment_id": 101554115, "body": "@J&#246;rgWMittag do i have to explain more i will surely do."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566138912, "post_id": 57545506, "comment_id": 101554237, "body": "This is not working still returns false even if it is present."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566139080, "post_id": 57545506, "comment_id": 101554274, "body": "@AmalTS: There are no examples in your question, no specification of what is supposed to happen, no test cases, no explanation of the rules for what you consider a correct result. The interpretation in this answer is a perfectly valid interpretation of your question. At the moment, there are three different interpretations of your question, which seems to clearly indicate that you need to add a specification, test cases, examples, and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to your question."}, {"owner": {"reputation": 35, "user_id": 7753818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7fXe.jpg?s=128&g=1", "display_name": "Oluwasegun Adeleye", "link": "https://stackoverflow.com/users/7753818/oluwasegun-adeleye"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566139174, "post_id": 57545506, "comment_id": 101554299, "body": "Are you trying to check if either <code>params[:id].to_i</code> or <code>params[:sheet_id]</code> is included the array <code>users.sheet_ids</code>? @AmalTS"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566139295, "post_id": 57545506, "comment_id": 101554322, "body": "Yes that&#39;s what exactly i am trying to do."}, {"owner": {"reputation": 35, "user_id": 7753818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7fXe.jpg?s=128&g=1", "display_name": "Oluwasegun Adeleye", "link": "https://stackoverflow.com/users/7753818/oluwasegun-adeleye"}, "edited": false, "score": 0, "creation_date": 1566139363, "post_id": 57545506, "comment_id": 101554347, "body": "I&#39;ll edit my answer to show how to do that."}, {"owner": {"reputation": 35, "user_id": 7753818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7fXe.jpg?s=128&g=1", "display_name": "Oluwasegun Adeleye", "link": "https://stackoverflow.com/users/7753818/oluwasegun-adeleye"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566139832, "post_id": 57545506, "comment_id": 101554486, "body": "@AmalTS I have modified the answer. Please check"}], "tags": [], "owner": {"reputation": 35, "user_id": 7753818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7fXe.jpg?s=128&g=1", "display_name": "Oluwasegun Adeleye", "link": "https://stackoverflow.com/users/7753818/oluwasegun-adeleye"}, "is_accepted": false, "score": -1, "last_activity_date": 1566139668, "last_edit_date": 1566139668, "creation_date": 1566138661, "answer_id": 57545506, "question_id": 57545385, "link": "https://stackoverflow.com/questions/57545385/how-to-use-or-in-checking-presence/57545506#57545506", "title": "How to use or in checking presence?", "body": "<p><code>user.sheet_ids.include? params[:id].to_i || params[:sheet_id]</code> is executed in this way <code>user.sheet_ids.include?(params[:id].to_i || params[:sheet_id])</code>. The OR statement is executed and the result is what is passed as an argument to <code>user.sheet_ids.include?</code></p>\n\n<p>To check if either <code>params[:id].to_i</code> or <code>params[:sheet_id]</code> is included in the array <code>users.sheet_ids</code>, you need to do this;</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>if user.sheet_ids.include?(params[:id].to_i) || user.sheet_ids.include?(params[:sheet_id].to_i)\n  can :show, Project\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1566139031, "last_edit_date": 1566139031, "creation_date": 1566138785, "answer_id": 57545515, "question_id": 57545385, "link": "https://stackoverflow.com/questions/57545385/how-to-use-or-in-checking-presence/57545515#57545515", "title": "How to use or in checking presence?", "body": "<p>I would do something like this:</p>\n\n<pre><code>(user.sheet_ids &amp; params.values_at(:id, :sheet_id).map(&amp;:to_i)).any?\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1566141405, "accepted_answer_id": 57545515, "answer_count": 2, "score": -2, "last_activity_date": 1566139668, "creation_date": 1566137733, "last_edit_date": 1566138460, "question_id": 57545385, "link": "https://stackoverflow.com/questions/57545385/how-to-use-or-in-checking-presence", "closed_reason": "Not suitable for this site", "title": "How to use or in checking presence?", "body": "<p>i need to check presence of a value in an array. It can be two values i need to check with an or case if it includes in the array. I think it will be confusing from my description you will understand after you see the code below.</p>\n\n<pre><code>if user.sheet_ids.include? params[:id].to_i || params[:sheet_id].to_i\n  can :show, Project\nend\n</code></pre>\n\n<p>It returns false even if sheet_id is present in the array of sheet_ids.</p>\n\n<p>user.sheet_ids is an array and i need to check if any of the value includes in this array. The method i used is not seems to be working.</p>\n\n<p>Is there any simple way of doing this. Thanks.</p>\n"}, {"tags": ["ruby", "parsing", "nokogiri", "curb"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8925106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KmiF9stMVvU/AAAAAAAAAAI/AAAAAAAAAFw/KFABjCWUjfU/photo.jpg?sz=128", "display_name": "PTaHHHa", "link": "https://stackoverflow.com/users/8925106/ptahhha"}, "edited": false, "score": 0, "creation_date": 1566131631, "post_id": 57544428, "comment_id": 101552514, "body": "oh jeez,my bad. Thanks"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1566130171, "creation_date": 1566130171, "answer_id": 57544428, "question_id": 57544398, "link": "https://stackoverflow.com/questions/57544398/cant-collect-pagination/57544428#57544428", "title": "Can&#39;t collect pagination", "body": "<p>It is a simple typo. Just replace</p>\n\n<pre><code>pagination=(\"https://www.petsonic.com/snacks-huesos-para-perros/?=#{page}\")\n</code></pre>\n\n<p>with</p>\n\n<pre><code>pagination=(\"https://www.petsonic.com/snacks-huesos-para-perros/?p=#{page}\")\n</code></pre>\n\n<p>Note the <code>p</code> in the query params.</p>\n"}], "owner": {"reputation": 57, "user_id": 8925106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KmiF9stMVvU/AAAAAAAAAAI/AAAAAAAAAFw/KFABjCWUjfU/photo.jpg?sz=128", "display_name": "PTaHHHa", "link": "https://stackoverflow.com/users/8925106/ptahhha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 57544428, "answer_count": 1, "score": 0, "last_activity_date": 1566667010, "creation_date": 1566130008, "last_edit_date": 1566667010, "question_id": 57544398, "link": "https://stackoverflow.com/questions/57544398/cant-collect-pagination", "title": "Can&#39;t collect pagination", "body": "<pre><code>while page &lt;= last_page\n\n  pagination=(\"https://www.petsonic.com/snacks-huesos-para-perros/?=#{page}\")\n  puts pagination\n  doc2=Nokogiri::HTML(Curl.get(pagination).body_str)\n\n  links=doc2.xpath('//a[@class=\"product-name\"]/@href')\n  links.each do |url|\n    doc3=Nokogiri::HTML(Curl.get(url).body_str)\n    name1=doc3.xpath('//h1[@class=\"product_main_name\"]').text\n    puts name1\n  end\n  page +=1\nend\n</code></pre>\n\n<p>However,for some reason it collects information from first page 4 times, instead of collection from all 4 pages. \nWhat might be the issue?</p>\n\n<p>EDIT: i missed 'p' in <code>pagination=(\"https://www.petsonic.com/snacks-huesos-para-perros/?p=#{page}\")</code></p>\n\n<p>Case closed</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "background-process", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 370, "user_id": 12219679, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DLRZ3EouY4g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBZA4Y2ic8pIjsv7lUrz6xDLxZxQ/photo.jpg?sz=128", "display_name": "Lam Phan", "link": "https://stackoverflow.com/users/12219679/lam-phan"}, "is_accepted": false, "score": 0, "last_activity_date": 1582281668, "creation_date": 1582281668, "answer_id": 60336898, "question_id": 57544293, "link": "https://stackoverflow.com/questions/57544293/rails-sidekiq-how-do-i-avoid-a-failed-job-blocking-and-slowing-down-the-serve/60336898#60336898", "title": "Rails + Sidekiq: How do I avoid a failed job blocking and slowing down the server?", "body": "<p>base on the document : <a href=\"https://github.com/mperham/sidekiq/wiki/Error-Handling\" rel=\"nofollow noreferrer\">https://github.com/mperham/sidekiq/wiki/Error-Handling</a></p>\n\n<p>if the job failed then it will be retried 25 times (about 21 days) so i guess you put a-lot-of failed jobs every day then the retry queues was the cause of your server be slow.</p>\n\n<blockquote>\n  <p>so I tried to remove it</p>\n</blockquote>\n\n<p>how did you try to remove it when you didn't log job_id ? </p>\n\n<p>base on document : <a href=\"https://github.com/mperham/sidekiq/wiki/API\" rel=\"nofollow noreferrer\">https://github.com/mperham/sidekiq/wiki/API</a></p>\n\n<p>i think you can try selecting all jobs of a certain type and deleting them from the retry queue :</p>\n\n<pre><code>query = Sidekiq::RetrySet.new\nquery.select do |job|\n  job.klass == 'Sidekiq::Extensions::DelayedClass' &amp;&amp;\n    # For Sidekiq::Extensions (e.g., Foo.delay.bar(*args)),\n    # the context is serialized to YAML, and must\n    # be deserialized to get to the original args\n    ((klass, method, args) = YAML.load(job.args[0])) &amp;&amp;\n    klass == User &amp;&amp;\n    method == :setup_new_subscriber\nend.map(&amp;:delete)\n\n# a better approach using 6.0's `scan` to pre-filter\nquery.scan(\"setup_new_subscriber\").select do |job|\n  job.klass == 'Sidekiq::Extensions::DelayedClass' &amp;&amp;\n    # For Sidekiq::Extensions (e.g., Foo.delay.bar(*args)),\n    # the context is serialized to YAML, and must\n    # be deserialized to get to the original args\n    ((klass, method, args) = YAML.load(job.args[0])) &amp;&amp;\n    klass == User &amp;&amp;\n    method == :setup_new_subscriber\nend.map(&amp;:delete)\n</code></pre>\n"}], "owner": {"reputation": 40732, "user_id": 984621, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/817afccebcbe3a4983a5e8c584f30373?s=128&d=identicon&r=PG", "display_name": "user984621", "link": "https://stackoverflow.com/users/984621/user984621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1582281668, "creation_date": 1566129238, "question_id": 57544293, "link": "https://stackoverflow.com/questions/57544293/rails-sidekiq-how-do-i-avoid-a-failed-job-blocking-and-slowing-down-the-serve", "title": "Rails + Sidekiq: How do I avoid a failed job blocking and slowing down the server?", "body": "<p>I have a mailer that send emails to company's clients about new products. The emails are sent out to thousands email addresses every day. Here's the code I use for it:</p>\n\n<p>CRON job schedule:</p>\n\n<pre><code>every 1.day, at: local('7:00am') do\n  rake \"mailer:daily_product_mailer\", environment: 'production' \nend\n</code></pre>\n\n<p>rake task:</p>\n\n<pre><code>namespace :mailer do  desc \"Daily product mailer\"\n  task :daily_product_mailer =&gt; [:environment] do                                            \n    DailyProductMailerJob.perform_later\n  end\nend\n</code></pre>\n\n<p>Job task:</p>\n\n<pre><code>class DailyProductMailerJob &lt; ApplicationJob\n  def perform\n    ... preparing data...\n    DailyProductMailer.send_products.deliver_now\n  end\nend\n</code></pre>\n\n<p>Mailer:</p>\n\n<pre><code>class DailyProductMailer &lt; ApplicationMailer\n  ...\n  def send_products\n    ...\n    clients.each do |client|\n      @email = all_emails_str(client)\n\n      yield client, nil; next if @email.blank?\n\n      begin\n        @token = unsubscribe_token\n\n        Retryable.retryable( tries: 3, sleep: 30, on: [Net::OpenTimeout, Net::SMTPAuthenticationError, Net::SMTPServerBusy]) do\n          mail(to: @email, subject: \"subject\", from: noreply@myaddr.com).deliver\n        end\n\n        yield client, @token\n      rescue Net::SMTPSyntaxError =&gt; e\n        error_msg = \"Product mailer sending failed on #{Time.now} with: #{e.message}. e.inspect: #{e.inspect}\"\n        InfonMailer.test_msg('myemail@myaddr.com', 'Product Mailer - error', error_msg).deliver_now\n        logger.warn error_msg\n        yield carrier, @token\n        next\n      end\n    end\n  end\n  ...\nend\n</code></pre>\n\n<p>What happens here is that every morning is run a rake task (in the background) that calls a method that picks all clients from my database and sends out emails about the latest products.</p>\n\n<p>Since a few days ago, I experience a problem when sending emails to certain email addresses fails, which causes significant performance issues of the whole server - everything in the Rails app is super slow, so I need to log in to the AWS EC2 instance, kill the Sidekiq process, then start it again. And next day the same procedure...</p>\n\n<p>I am trying to identify the problem and I thought that the issue is here:</p>\n\n<pre><code>Retryable.retryable( tries: 3, sleep: 30, on: [Net::OpenTimeout, Net::SMTPAuthenticationError, Net::SMTPServerBusy]) do\n  mail(to: @email, subject: \"subject\", from: noreply@myaddr.com).deliver\nend\n</code></pre>\n\n<p>This block should try to execute the job that has failed up to 3 times - so I tried to remove it, but it didn't help - the job still stays stuck somewhere (and keeps slowing down the server).</p>\n\n<p>What is the reason of Sidekiq blocking the server here? Is there a way to set Sidekiq to continue sending out emails to the new client email addresses if in the previous iteration occurred any error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1566123357, "post_id": 57543562, "comment_id": 101550507, "body": "What value would be that? A &quot;dynamic&quot; one, or always the same value?"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1566125142, "post_id": 57543562, "comment_id": 101550926, "body": "@SebastianPalma i need to set the value which is currently in database if params[sheet_name] is null"}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1566125320, "post_id": 57543562, "comment_id": 101550970, "body": "@spickermann i am using a method for both updation and creation. For example if i give a value into params[sheet_name] = Sheet 1 it should set the name to Sheet 1. If i try to update that record if no params[sheet_name] is given it should set the default value which is Sheet 1."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566125344, "post_id": 57543588, "comment_id": 101550975, "body": "I am using a method for both updation and creation. For example if i give a value into params[sheet_name] = Sheet 1 it should set the name to Sheet 1. If i try to update that record if no params[sheet_name] is given it should set the default value which is Sheet 1."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566125382, "post_id": 57543588, "comment_id": 101550984, "body": "Thank you for answering but please check the comment."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566129884, "post_id": 57543588, "comment_id": 101552121, "body": "@AmalTS I still think my answer should solve your question. If it does not please elaborate on what is going wrong or is missing."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566132623, "post_id": 57543588, "comment_id": 101552752, "body": "What does the sheet_name.presence does ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566132807, "post_id": 57543588, "comment_id": 101552799, "body": "It calls the <a href=\"https://api.rubyonrails.org/classes/Object.html#method-i-presence\" rel=\"nofollow noreferrer\"><code>presence</code> method</a> on <code>sheet_name</code> and makes sure that empty strings get handled as <code>nil</code> and therefore still fall back to the default."}, {"owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566137391, "post_id": 57543588, "comment_id": 101553872, "body": "it doesn&#39;t seems to be working if param[sheet_name] is null it writes sheet_name = null"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566137496, "post_id": 57543588, "comment_id": 101553896, "body": "Is the attribute really named just <code>name</code>? Or should it be <code>@sheet.sheet_name = ...</code>? And how and where do you actually set <code>sheet_name</code>?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "edited": false, "score": 0, "creation_date": 1566138183, "post_id": 57543588, "comment_id": 101554063, "body": "Yes, there is a shortcut for that: Exactly to code I wrote above in my answer. Therefore I am sure there must be another issue in your code outside of the example that you posted."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1566129791, "last_edit_date": 1566129791, "creation_date": 1566123499, "answer_id": 57543588, "question_id": 57543562, "link": "https://stackoverflow.com/questions/57543562/how-to-set-default-value-from-database-rails-if-params-is-blank/57543588#57543588", "title": "How to set default value from database rails if params is blank", "body": "<p>In your example this should work:</p>\n\n<pre><code>if @sheet = Sheet.where(id: sheet_id).first_or_initialize\n  @sheet.user_id = user_id\n  @sheet.name = sheet_name.presence || 'Sheet 1'\n  @sheet.save\nend\n</code></pre>\n\n<p>Depending on your use-case you might want to consider <a href=\"https://stackoverflow.com/q/1186400/2483313\">setting the default in the database</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 9559266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CuDynlDo9CA/AAAAAAAAAAI/AAAAAAAABzQ/-Pj97ngfbvg/photo.jpg?sz=128", "display_name": "Hisham Magdy", "link": "https://stackoverflow.com/users/9559266/hisham-magdy"}, "is_accepted": false, "score": 0, "last_activity_date": 1566165538, "creation_date": 1566165538, "answer_id": 57548677, "question_id": 57543562, "link": "https://stackoverflow.com/questions/57543562/how-to-set-default-value-from-database-rails-if-params-is-blank/57548677#57548677", "title": "How to set default value from database rails if params is blank", "body": "<p>you can add a default value for that column in the database by</p>\n\n<ol>\n<li>create a migration using <code>rails g migration AddDefaultValueForSheetName</code></li>\n<li>add that line <code>change_column_default :sheets, :name, value you want to be default</code></li>\n<li>run the migration using <code>rake db:migrate</code> </li>\n<li>in the controller use something like</li>\n</ol>\n\n<pre><code>  if @sheet = Sheet.where(id: sheet_id).first_or_initialize\n        @sheet.user_id = user_id\n        @sheet.name = params[sheet_name] if params[sheet_name].present?\n        @sheet.save\n  end\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11825504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ipTIegEK8fY/AAAAAAAAAAI/AAAAAAAAAV0/x9WJ6eBOyIM/photo.jpg?sz=128", "display_name": "Amal T S", "link": "https://stackoverflow.com/users/11825504/amal-t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566165538, "creation_date": 1566123238, "last_edit_date": 1566138151, "question_id": 57543562, "link": "https://stackoverflow.com/questions/57543562/how-to-set-default-value-from-database-rails-if-params-is-blank", "title": "How to set default value from database rails if params is blank", "body": "<p>Hai i want to know how to set a default value from the database if my <code>params</code> is <code>nil</code></p>\n\n<p>I am trying to update a record in my database I have used this code</p>\n\n<pre><code>  if @sheet = Sheet.where(id: sheet_id).first_or_initialize\n    @sheet.user_id = user_id\n    @sheet.name = sheet_name ## I want to set a default value for this\n    @sheet.save\n  end\n</code></pre>\n\n<p>I want to set the default value of sheet name from database if my <code>params[sheet_name]</code> is <code>nil</code>.</p>\n\n<p><strong>Update</strong>\nThis is the thing i am trying to achieve</p>\n\n<pre><code>if sheet_name != nil\n  @sheet.name = sheet_name\nend\n</code></pre>\n\n<p>is there any short hand way of writing this</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1566123830, "post_id": 57543523, "comment_id": 101550617, "body": "Yeah, this makes more sense. Looks like I didn&#39;t really understand what he was trying to do"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1566122913, "creation_date": 1566122913, "answer_id": 57543523, "question_id": 57542773, "link": "https://stackoverflow.com/questions/57542773/why-am-i-getting-this-error-stack-level-too-deep-systemstackerror/57543523#57543523", "title": "why am i getting this error stack level too deep (SystemStackError)", "body": "<p>The issue is here:</p>\n\n<pre><code>def trump prompt\n  year_born = trump(prompt)\n</code></pre>\n\n<p>in the first line of the method, you call itself again and again, recursively. The method calls allocate frames on the stack and sooner or later the stack gets exhausted.</p>\n\n<p>What you want is probably to get the value from the user\u2019s input:</p>\n\n<pre><code>def trump prompt\n  print prompt\n  year_born = gets.to_i\n  ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11942020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19e100a17d6b9e4fd99be5ec81f7ed3?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/11942020/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566294490, "creation_date": 1566115665, "last_edit_date": 1566294490, "question_id": 57542773, "link": "https://stackoverflow.com/questions/57542773/why-am-i-getting-this-error-stack-level-too-deep-systemstackerror", "title": "why am i getting this error stack level too deep (SystemStackError)", "body": "<p>Trying to calculate how old the user was when Trump got elected.</p>\n\n<pre><code> def trump prompt\n   year_born = trump(prompt)\n   year_born =  2016 - year_born.to_i\n   return year_born.to_s\n end\n\n age_when_trump_elected = trump('what year were you born?')\n puts name + ' you were ' + age_when_trump_elected + ' years old when Trump got elected'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-oauth"], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "is_accepted": false, "score": 1, "last_activity_date": 1566117054, "creation_date": 1566117054, "answer_id": 57542907, "question_id": 57542156, "link": "https://stackoverflow.com/questions/57542156/cant-save-google-profile-image/57542907#57542907", "title": "Can&#39;t save google profile image", "body": "<p>I passed through after version down for carrierwave(1.3.1).</p>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566117054, "creation_date": 1566109195, "question_id": 57542156, "link": "https://stackoverflow.com/questions/57542156/cant-save-google-profile-image", "title": "Can&#39;t save google profile image", "body": "<p>I'm working on authenticating with Google. I could fetch Google auth info at all but couldn't save profile picture. Carrierwave would work and I could find google image url also. But I couldn't save...</p>\n\n<p>I've got this error.</p>\n\n<pre><code>NoMethodError: undefined method `[]' for nil:NilClass\nfrom /Users/xxx/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/carrierwave-2.0.0/lib/carrierwave/downloader/remote_file.rb:28:in `filename_from_header'\n</code></pre>\n\n<p><strong>apps/models/user.rb</strong></p>\n\n<pre><code>def self.find_for_google_oauth(auth)\n  where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n    binding.pry\n    user.email = auth.info.email\n    user.password = Devise.friendly_token[0,20]\n    user.username = auth.info.name\n    user.remote_image_url = auth.info.image\n    user.confirmed_at = Time.now.utc\n  end\nend\n</code></pre>\n\n<p><strong>config/initializers/devise.rb</strong></p>\n\n<pre><code>config.omniauth :google_oauth2,\n  Rails.application.credentials.google[:client_id],\n  Rails.application.credentials.google[:client_secret],\n  skip_jwt: true,\n  scope: 'email profile',\n  redirect_uri: \"#{Rails.application.credentials[Rails.env.to_sym][:host_domain]}/users/auth/google_oauth2/callback\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 1, "creation_date": 1566110605, "post_id": 57541975, "comment_id": 101548208, "body": "Don&#39;t forget. When you are on the <code>edit</code> page and you submit the form, you referrer on the <code>update</code> action is <code>edit</code> page. You cannot use <code>redirect_back</code> or anything similar. You have to tell your edit form, where you user came from, and send this information to <code>update</code> action and then redirect back according to this parameter or something similar."}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "reply_to_user": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 0, "creation_date": 1566141275, "post_id": 57541975, "comment_id": 101554885, "body": "@edariedl Thank you for your answer. So I can&#39;t have one redirect that sends users to their previous url no matter which url that is (because the comment form is on multiple places)?"}, {"owner": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 0, "creation_date": 1566145565, "post_id": 57541975, "comment_id": 101556005, "body": "You can, but there is no feature like this directly in rails, you would have to develop it by yourself or try to find some gem that could help you with it."}, {"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "reply_to_user": {"reputation": 2388, "user_id": 3655580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58695ea14f641ae7e2f15b34434fd6a0?s=128&d=identicon&r=PG&f=1", "display_name": "edariedl", "link": "https://stackoverflow.com/users/3655580/edariedl"}, "edited": false, "score": 0, "creation_date": 1566244708, "post_id": 57541975, "comment_id": 101588033, "body": "@edariedl Great, thank you for the advice."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "edited": false, "score": 0, "creation_date": 1566244692, "post_id": 57553859, "comment_id": 101588024, "body": "Worked like a charm. Thank you!"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": true, "score": 0, "last_activity_date": 1566206670, "creation_date": 1566206670, "answer_id": 57553859, "question_id": 57541975, "link": "https://stackoverflow.com/questions/57541975/how-can-i-go-back-to-the-previous-page-after-updating/57553859#57553859", "title": "How can I go back to the previous page after updating?", "body": "<p>You can't call <code>request.referer</code> to directly back the the previous of edit page. Cause on the <code>update</code> method, the <code>request.referer</code> will be always the <code>edit</code> path.</p>\n\n<p>You can, do a trick like, parse the <code>request.referer</code> of <code>edit</code> action (might be the <code>index</code> one, for ex. as params to <code>update</code> action, and redirect to the path on updating the resource )</p>\n\n<pre><code># edit form view\n&lt;%= hidden_field_tag :previous_request, request.referer %&gt;\n\n# update action\ndef update\n  ...\n  redirect_to params[:previous_request]\nend\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6591677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3492f567b2c4d3bd5f8d001b080259d7?s=128&d=identicon&r=PG&f=1", "display_name": "superbot", "link": "https://stackoverflow.com/users/6591677/superbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 57553859, "answer_count": 1, "score": 0, "last_activity_date": 1566206670, "creation_date": 1566107045, "last_edit_date": 1566108312, "question_id": 57541975, "link": "https://stackoverflow.com/questions/57541975/how-can-i-go-back-to-the-previous-page-after-updating", "title": "How can I go back to the previous page after updating?", "body": "<p>How can I go back to the previous page (where the items in question were listed) from the edit view (edit.html.erb) after clicking on the update button? I have tried:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>redirect_to request.referer #stays on the same page(edit.html.erb) \nredirect_to session.delete(:return_to) #outputs \"Cannot redirect to nil!\"\nredirect_to :back #stays on same page\nredirect_back fallback_location: posts_path #stays on same page\nredirect_to(request.env['HTTP_REFERER']) #stays on same page\n</code></pre>\n\n<p>In the database, the comment is updated. </p>\n\n<p>While I can use posts_path(@comment), I want to also edit comment from another url. Hence the need for a redirect to the previous page. </p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1566112303, "post_id": 57541658, "comment_id": 101548477, "body": "Can you show the code in <code>authenticate_user.rb</code>?"}, {"owner": {"reputation": 5, "user_id": 11909353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730804ad6b74ef73e36e722e20fed5df?s=128&d=identicon&r=PG&f=1", "display_name": "zplack631", "link": "https://stackoverflow.com/users/11909353/zplack631"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1566134609, "post_id": 57541658, "comment_id": 101553254, "body": "Sure, @maxpleaner the quenstion is updated with authenticate_user.rb"}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1566786158, "post_id": 57541658, "comment_id": 101752629, "body": "Is there supposed to be <code>Authenticate_user</code> and <code>AuthenticateUser</code> in there? If so, where does <code>Authenticate_user</code> come from?"}], "owner": {"reputation": 5, "user_id": 11909353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730804ad6b74ef73e36e722e20fed5df?s=128&d=identicon&r=PG&f=1", "display_name": "zplack631", "link": "https://stackoverflow.com/users/11909353/zplack631"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566134561, "creation_date": 1566102440, "last_edit_date": 1566134561, "question_id": 57541658, "link": "https://stackoverflow.com/questions/57541658/sinatra-initialize-a-namespace-controller", "title": "Sinatra initialize a namespace controller", "body": "<p>Under the commands folder, I'd like to initialize a controller\nbut Sinatra reports this error in the logs </p>\n\n<blockquote>\n  <p>ArgumentError: wrong number of arguments (given 1, expected 2)</p>\n</blockquote>\n\n<pre><code>/home/daniel/sinatraApi/app/commands/authenticate_user.rb:6:in `initialize'\n/home/daniel/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rack-2.0.7/lib/rack/builder.rb:86:in `new'\n2.0.7/lib/rack/builder.rb:147:in `to_app'\nconfig.ru:15:in `inner_app'\n/\n</code></pre>\n\n<p>The controllers are called</p>\n\n<pre><code>use AuthenticateUser\nrun ApplicationController\n</code></pre>\n\n<p>I've tried to add</p>\n\n<pre><code>use Commands::AuthenticateUser\n</code></pre>\n\n<p>or require</p>\n\n<pre><code>require \"./app/commands/authenticate_user\"\n</code></pre>\n\n<p>on config.ru</p>\n\n<pre><code>Authenticate_user\n\nrequire 'jwt'\n#require './app/controllers/application'\nclass AuthenticateUser\n  prepend SimpleCommand\n\n  def initialize(email, password)\n    @email = email\n    @password = password\n  end\n\n  def call\n    JsonWebToken.encode(user_id: user.id) if user\n  end\n\n  private\n\n  attr_accessor :email, :password\n\n  def user\n    user = User.find_by_email(email)\n    return user if user &amp;&amp; user.authenticate(password)\n\n    errors.add :user_authentication, 'invalid credentials'\n    nil\n  end\nend\n</code></pre>\n\n<p>How can I setup the namespace or nested controllers in Sinatra?</p>\n"}]