[{"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1554941812, "post_id": 55622847, "comment_id": 97938820, "body": "There is a good list of debugging tricks using puts in this blogpost by Aaron patterson <a href=\"https://tenderlovemaking.com/2016/02/05/i-am-a-puts-debuggerer.html\" rel=\"nofollow noreferrer\">tenderlovemaking.com/2016/02/05/i-am-a-puts-debuggerer.html</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1554948578, "post_id": 55622847, "comment_id": 97940153, "body": "Within Rails the rule of thumb is it&#39;s in <code>some_class.rb</code> stored somewhere, but many Ruby tools exist to find out for sure: <code>puts SomeClass.method(:SomeMethod).source_location</code> is usually the most precise."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554963969, "post_id": 55622847, "comment_id": 97943954, "body": "You can also install ruby ctags in your editor (I do it with sublime, pretty sure it&#39;s there in others as well). This lets you mouse over the method call to see where it&#39;s defined."}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 11275596, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gewiN2n-1YI/AAAAAAAAAAI/AAAAAAAAAAc/sBC2tJTStP0/photo.jpg?sz=128", "display_name": "Povilas Jur\u010dys", "link": "https://stackoverflow.com/users/11275596/povilas-jur%c4%8dys"}, "is_accepted": true, "score": 3, "last_activity_date": 1554953941, "creation_date": 1554953941, "answer_id": 55624346, "question_id": 55622847, "link": "https://stackoverflow.com/questions/55622847/how-do-i-know-which-class-function-its-calling/55624346#55624346", "title": "how do I know which class &amp; function it&#39;s calling?", "body": "<p>The easiest way to find method location is to use <a href=\"https://ruby-doc.org/core-1.9.3/Method.html#method-i-source_location\" rel=\"nofollow noreferrer\">Method#source_location</a>. In your case you need to do this:</p>\n\n<pre><code>SomeClass.method(:SomeMethod).source_location\n</code></pre>\n\n<p>it will give you file path and line number where this method is defined</p>\n"}], "owner": {"reputation": 328, "user_id": 3470629, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/8bd45df95393906744e399e5d55b2c1a?s=128&d=identicon&r=PG&f=1", "display_name": "user3470629", "link": "https://stackoverflow.com/users/3470629/user3470629"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55624346, "answer_count": 1, "score": 0, "last_activity_date": 1554953941, "creation_date": 1554940701, "question_id": 55622847, "link": "https://stackoverflow.com/questions/55622847/how-do-i-know-which-class-function-its-calling", "title": "how do I know which class &amp; function it&#39;s calling?", "body": "<p>I'm new to Ruby and Ruby on Rails. Have Java, C#, NodeJS background. I will have to work on Rails application. When reading the code, all of the sudden I see it calls a function from some class. Lets say</p>\n\n<pre><code>class HelloWorld &lt; ApplicationController\n   before_action :get_data\n\n   def get_data\n      @data = SomeClass.SomeMethod(AAA: :BBB)\n   end\nend\n</code></pre>\n\n<p>As coming from C# / Java background I don't understand where is that SomeClass and where is that SomeMethod (SomeClass is defined in 5 places).</p>\n\n<p>It could be a newbie question. But it helps other people who comes from other languages.</p>\n"}, {"tags": ["ruby", "sqlite", "each", "mean"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1554949906, "post_id": 55622754, "comment_id": 97940402, "body": "Your first problem is that your query is not valid SQL. It should be <code>SELECT Amount, Id FROM bills...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "is_accepted": true, "score": 0, "last_activity_date": 1555041401, "creation_date": 1555041401, "answer_id": 55644281, "question_id": 55622754, "link": "https://stackoverflow.com/questions/55622754/unable-to-calculate-a-mean-excluding-current-observation-in-a-each-block-in-sql/55644281#55644281", "title": "unable to calculate a mean excluding current observation in a .each block in sqlite3", "body": "<p>One major problem with the above <code>.each</code> block is the use of an <code>instance variable</code>.  Swapping <code>@avgx</code> for <code>local variable avgx</code> solves this problem. <code>avgx</code> can then be used in the SQL <code>UPDATE</code> statement.</p>\n\n<p>Second <code>specific_row array</code> needs to specify the correct value.  In this case the  desired value is <code>Amount</code>.  Because <code>arrays</code> are 0-indexed, the value for <code>Amount</code> is stored in `specific_row[0]'.  </p>\n\n<pre><code>        specific_amt.each do |specific_row|\n            if @total_rows == 1\n                avgx = @total_amt / @total_rows\n            elsif @total_rows &gt; 1\n                avgx = (@total_amt - specific_row[0]) / (@total_rows - 1)\n            else\n                puts \"insufficient entries\"\n                return \"insufficient entries\"\n            end \n        db.execute2 \"UPDATE bills SET AvgX = :AvgX WHERE Amount = :Amount AND Type = :Type AND Year = :Year\", avgx, specific_row[0], info_hash[:category], info_hash[:year]\n        end\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55644281, "answer_count": 1, "score": -3, "last_activity_date": 1555041401, "creation_date": 1554939801, "question_id": 55622754, "link": "https://stackoverflow.com/questions/55622754/unable-to-calculate-a-mean-excluding-current-observation-in-a-each-block-in-sql", "title": "unable to calculate a mean excluding current observation in a .each block in sqlite3", "body": "<p>I have the following method.  My code snags at the <code>if statement</code> within my <code>.each</code> block with error: <code>nil can't be coerced into Float (TypeError)</code>.</p>\n\n<p>I have tried <strong>many</strong> variants, all snag in <code>.each</code> block.  </p>\n\n<p>The code should calculate an average of <strong>all</strong> items, grouped by <code>Type</code>, <strong>excluding the current observation</strong>.  For example, 10 items with 10 different values under <code>Type foo</code>.  Item 1 has a cell calculating the mean of 9 items - <strong>excluding</strong> itself.  Please advise. I am at wit's end. </p>\n\n<p>Code below is the method as existing in my IDE.  <code>Ruby 2.3.7</code> </p>\n\n<p><code>specific_row[0]</code> should pertain to <code>Id</code> and\n<code>specific_row[1]</code> should pertain to <code>Amount</code>.\n<strong>Note:</strong> I have made the choice to use <code>.execute</code> over <code>.execute2</code> in the effort not trip of the header data.</p>\n\n<pre><code>def billavgx(info_hash)\n    begin\n        db = SQLite3::Database.open('billinfo.db')\n        db.results_as_hash = true\n        db.transaction\n        specific_amt =  db.prepare \"SELECT Amount AND Id FROM bills WHERE Type = :Type\" \n        specific_amt.execute info_hash[:category]\n        specific_amt.each do |specific_row|\n            if @total_rows == 1\n                @avgx = (@total_amt - specific_row[1]) / @total_rows\n            elsif @total_rows &gt; 1\n                @avgx = (@total_amt - specific_row[1]) / (@total_rows - 1)\n            else\n                return \"insufficient entries\"\n            end         \n            db.execute2 \"UPDATE bills SET AvgX = :AvgX WHERE Id = :Id AND Type = :Type\", @avgx, specific_row[0], info_hash[:category]\n            end\n        puts db.changes.to_s + \" changes made\"\n        db.commit\n    rescue SQLite3::Exception =&gt; e\n        puts \"error here \" , e\n    ensure\n        specific_amt.close if specific_amt\n        db.close if db\n    end\nend\n</code></pre>\n"}, {"tags": ["javascript", "json", "ruby", "square"], "comments": [{"owner": {"reputation": 1305, "user_id": 9352043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4CQH.jpg?s=128&g=1", "display_name": "sjosey", "link": "https://stackoverflow.com/users/9352043/sjosey"}, "edited": false, "score": 0, "creation_date": 1555015846, "post_id": 55622660, "comment_id": 97972467, "body": "Are you doing anything to the response once you get it from Square? Square always returns a JSON body as the response. For example <code>response = Unirest.get &quot;https:&#47;&#47;connect.squareup.com&#47;v2&#47;locations&quot;, headers:{&quot;Authorization&quot; =&gt; &quot;Bearer access_token&quot;, &quot;Accept&quot; =&gt; &quot;application&#47;json&quot; }</code> and then doing response.body returns a JSON string so you can just do something like <code>response.body[&quot;locations&quot;]</code> to get the JSON array of locations."}, {"owner": {"reputation": 1305, "user_id": 9352043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4CQH.jpg?s=128&g=1", "display_name": "sjosey", "link": "https://stackoverflow.com/users/9352043/sjosey"}, "edited": false, "score": 0, "creation_date": 1555015964, "post_id": 55622660, "comment_id": 97972516, "body": "And so assuming you have a JSON response, you can simply do something like <code>transactions = response.body[&quot;transactions&quot;]</code> and loop through it like <code>for transaction in transactions</code> and do whatever you want inside the loop."}], "owner": {"reputation": 15, "user_id": 9105863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a19abced883df00e53ddcece170d3f?s=128&d=identicon&r=PG&f=1", "display_name": "whatbox", "link": "https://stackoverflow.com/users/9105863/whatbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554992737, "creation_date": 1554939048, "last_edit_date": 1554992737, "question_id": 55622660, "link": "https://stackoverflow.com/questions/55622660/how-to-get-a-table-of-records-from-squares-transaction-hash", "title": "How to get a table of records from Square&#39;s transaction hash?", "body": "<p>I need to iterate through this hash of Square transactions and join each record to the results of a MySQL query.  Is there a way to get the records in the Square transactions hash into an array that is more like a table?</p>\n\n<p>I posted a similar question a few weeks ago (<a href=\"https://stackoverflow.com/questions/55365027/how-to-parse-square-response-nested-key-values-in-ruby-2-2-10/55365773#55365773\">How to parse Square response nested key values in Ruby 2.2.10</a>) where the hash had only one record but now I need to iterate through all the Transactions.  Notice that the hash can also contain Refund transactions, which I would want to parse out separately.  And some transactions will be missing the reference_id field.</p>\n\n<pre><code>{:transactions=&gt;[\n{:id=&gt;\"sacfx8eqLYsBQom7G9kV7gS1K4lbnMG83w3U0Gpzu1cCJROfZvRJqLhO\", \n:location_id=&gt;\"CBASEJJZMYbNZW8F1bbRjRuPQ7Q\", \n:created_at=&gt;\"2019-04-10T16:38:57Z\", \n:tenders=&gt;[{\n    :id=&gt;\"eeb92f2a-379b-55c6-439b-f0f5c44925c8\", \n    :location_id=&gt;\"CBASEJJZMYbNZW8F1bbRjRuPQ7Q\", \n    :transaction_id=&gt;\"sacfx8eqLYsBQom7G9kV7gS1K4lbnMG83w3U0Gpzu1cCJROfZvRJqLhO\", \n    :created_at=&gt;\"2019-04-10T16:38:57Z\", \n    :note=&gt;\"Online Transaction\", \n    :amount_money=&gt;{:amount=&gt;65000, :currency=&gt;\"USD\"}, \n    :processing_fee_money=&gt;{:amount=&gt;1915, :currency=&gt;\"USD\"}, \n    :type=&gt;\"CARD\", \n    :card_details=&gt;{:status=&gt;\"CAPTURED\", \n                    :card=&gt;{:card_brand=&gt;\"VISA\", \n                            :last_4=&gt;\"1111\", \n                            :fingerprint=&gt;\"50b16672bf4472e9058524e3c0a060faab196bc3e43f9c693a870c7e8b6da626\"\n                            }, \n                    :entry_method=&gt;\"KEYED\"\n                    }\n}], \n:reference_id=&gt;\"796\", \n:product=&gt;\"EXTERNAL_API\"\n}, \n\n{:id=&gt;\"mvMhdOrfBdXQvE0S6EPFoeHf7Fm8duSJgsk4bZyt6APQTa2PGkix6LhO\", \n:location_id=&gt;\"CBASEJJZMYbNZW8F1bbRjRuPQ7Q\", \n:created_at=&gt;\"2019-04-10T01:22:16Z\", \n:tenders=&gt;[{\n    :id=&gt;\"693c42d4-5e16-52a3-5594-5e8dd4ff9f95\", \n    :location_id=&gt;\"CBASEJJZMYbNZW8F1bbRjRuPQ7Q\", \n    :transaction_id=&gt;\"mvMhdOrfBdXQvE0S6EPFoeHf7Fm8duSJgsk4bZyt6APQTa2PGkix6LhO\", \n    :created_at=&gt;\"2019-04-10T01:22:16Z\", \n    :note=&gt;\"Online Transaction\", \n    :amount_money=&gt;{:amount=&gt;65000, :currency=&gt;\"USD\"}, \n    :processing_fee_money=&gt;{:amount=&gt;1915, :currency=&gt;\"USD\"}, \n    :type=&gt;\"CARD\", \n    :card_details=&gt;{:status=&gt;\"CAPTURED\", \n                    :card=&gt;{:card_brand=&gt;\"VISA\", \n                        :last_4=&gt;\"1111\", \n                        :fingerprint=&gt;\"50b16672bf4472e9058524e3c0a060faab196bc3e43f9c693a870c7e8b6da626\"\n                        }, \n                    :entry_method=&gt;\"KEYED\"\n                    }\n}], \n:product=&gt;\"EXTERNAL_API\"\n},\n...\n],\n:refunds=&gt;[... refunds here ...]\n}\n</code></pre>\n\n<p>I put in the carriage returns to make it easier to see the key/values.<br>\nAdditionally, Square's sample in their documentation (<a href=\"https://docs.connect.squareup.com/api/connect/v2/?q=reference_id#endpoint-transactions-listtransactions\" rel=\"nofollow noreferrer\">https://docs.connect.squareup.com/api/connect/v2/?q=reference_id#endpoint-transactions-listtransactions</a>) shows keys in quotation marks but the actual response that comes to Ruby is just as I showed it above, where all the keys are just colon key name - like :id</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activestorage"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554939727, "post_id": 55621655, "comment_id": 97938391, "body": "Did you try adding a breakpoint in <code>correct_video_type</code> to see if it&#39;s called?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554942281, "post_id": 55621655, "comment_id": 97938916, "body": "I haven&#39;t.  I also attempted this without using direct_upload and it also didn&#39;t work.  I can assume its not being called?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554944027, "post_id": 55621655, "comment_id": 97939250, "body": "i would say try the breakpoint to chec"}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554954456, "post_id": 55621655, "comment_id": 97941223, "body": "check this <a href=\"https://stackoverflow.com/questions/48158770/activestorage-file-attachment-validation\" title=\"activestorage file attachment validation\">stackoverflow.com/questions/48158770/&hellip;</a>"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554965802, "post_id": 55621655, "comment_id": 97944749, "body": "@Nandhini Thanks i guess it &#39;s time to upgrade...."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 14154200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d74135c2e4280116c04ad226251bec9c?s=128&d=identicon&r=PG&f=1", "display_name": "Artem Shevchenko", "link": "https://stackoverflow.com/users/14154200/artem-shevchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1613716447, "creation_date": 1613716447, "answer_id": 66272785, "question_id": 55621655, "link": "https://stackoverflow.com/questions/55621655/validate-file-type-on-direct-uploads-with-active-storage-is-it-possible/66272785#66272785", "title": "Validate file type on Direct Uploads with Active Storage? Is it possible?", "body": "<p>You can use this <a href=\"https://github.com/aki77/activestorage-validator\" rel=\"nofollow noreferrer\">gem</a>. As I know It implements what you did)</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 715, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1613716447, "creation_date": 1554932245, "question_id": 55621655, "link": "https://stackoverflow.com/questions/55621655/validate-file-type-on-direct-uploads-with-active-storage-is-it-possible", "title": "Validate file type on Direct Uploads with Active Storage? Is it possible?", "body": "<p>I created a method in my model to validate the upload file type.  But it won't work, and I assume it's because i am using Direct uploads.</p>\n\n<p>Is it possible to validate the file type with direct uploads with active storage? and How can I?</p>\n\n<p><strong>I tried:</strong></p>\n\n<p><strong>Model:</strong></p>\n\n<pre><code>validate :correct_video_type\n\n\n  def correct_video_type\n    if video.attached? &amp;&amp; video.content_type.in?(%w(video/mov video/mp4 video/avi video/mpeg))\n      errors.add(:video, \"Must be video format\")\n    elsif video.attached? == false\n      errors.add(:video, \"Video must be attached\")\n    end\n  end\n</code></pre>\n\n<p><strong>View:</strong></p>\n\n<pre><code>&lt;%= form.file_field :video, class: \"upload\", direct_upload: true %&gt;\n</code></pre>\n\n<p>And nothing becomes validated...</p>\n\n<p><strong>I also tried front end validation, but this didn't work:</strong></p>\n\n<pre><code> &lt;%= form.file_field :video, class: \"upload\", direct_upload: true, accept: 'video/mov, video/mpeg, video/mp4, video/avi' %&gt;\n</code></pre>\n\n<p>None of these worked.  Even if the front-end were to work, i would still want to validate it further on the backend.  </p>\n\n<p>How can I validate this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1554933258, "post_id": 55621512, "comment_id": 97936652, "body": "Where exactly is that error being thrown? Please add your stack trace to your question."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554933720, "post_id": 55621512, "comment_id": 97936803, "body": "Is there <code>has_many :shopping_lists</code> in the Ingredient model? If you, I think you just need <code>has_many :shopping_lists, through: :ingredients</code> in the Recipe modell"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1554940076, "post_id": 55621512, "comment_id": 97938463, "body": "Also, what does your <code>Ingredient</code> model look like? Specifically, its associations."}, {"owner": {"reputation": 13, "user_id": 6586258, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-Gn6dVXc-EEY/AAAAAAAAAAI/AAAAAAAAAT4/Fp2bnkGVD2Q/photo.jpg?sz=128", "display_name": "StoyanovEZ", "link": "https://stackoverflow.com/users/6586258/stoyanovez"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1554980260, "post_id": 55621512, "comment_id": 97952876, "body": "@jvillian : I&#39;ve added the strack trace"}, {"owner": {"reputation": 13, "user_id": 6586258, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-Gn6dVXc-EEY/AAAAAAAAAAI/AAAAAAAAAT4/Fp2bnkGVD2Q/photo.jpg?sz=128", "display_name": "StoyanovEZ", "link": "https://stackoverflow.com/users/6586258/stoyanovez"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554980325, "post_id": 55621512, "comment_id": 97952908, "body": "@maxpleaner : I can access the page by adding your line in my model, but then the drop-down menu gives me only two options : &quot;yes&quot; or &quot;no&quot;"}], "owner": {"reputation": 13, "user_id": 6586258, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-Gn6dVXc-EEY/AAAAAAAAAAI/AAAAAAAAAT4/Fp2bnkGVD2Q/photo.jpg?sz=128", "display_name": "StoyanovEZ", "link": "https://stackoverflow.com/users/6586258/stoyanovez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554980225, "creation_date": 1554931411, "last_edit_date": 1554980225, "question_id": 55621512, "link": "https://stackoverflow.com/questions/55621512/how-to-get-relations-from-another-class", "title": "How to get relations from another class", "body": "<p>I want to copy the relations of a class A to a class B</p>\n\n<pre><code>class ShoppingList\n  has_many :ingredients\nend\n\nclass Recipe\n  has_many :ingredients\nend\n</code></pre>\n\n<p>I want to add the ingredients of a recipe to a shopping list, but FROM the recipe page (I won't elaborate why but it makes sense in the UX). Ingredients are the only relation they have in common.</p>\n\n<p>The logic is : On my recipe page, I wish to have a drop-down menu containing my shopping lists. Then, when I select a shopping list and validate, it will add the ingredients of the recipe to the shopping list.</p>\n\n<p>I've been struggling to make this work, I know there's possibly multiple things I did wrong, but here's what I tried :</p>\n\n<p>recipes_controller.rb :</p>\n\n<pre><code>def add_ingredients_to_list\n  # call method to find the @recipe\n  tmp = ShoppingList.find_by_id(shopping_list_params[:shopping_lists])\n  tmp.ingredients &lt;&lt; @recipe.ingredients\n  redirect_to shopping_list_path(id: tmp.id)\nend\n\nprivate\n\ndef shopping_list_params\n  params.require(:recipe).permit(:shopping_lists, :id)\nend\n</code></pre>\n\n<p>routes.rb :</p>\n\n<pre><code>resources :recipes do\n  post 'add_ingredients_to_list' =&gt; \"recipes#add_ingredients_to_list\"\nend\n</code></pre>\n\n<p>recipes/show.html.erb :</p>\n\n<pre><code>&lt;%= simple_form_for :recipe, :url =&gt; recipe_add_ingredients_to_list_url(@recipe), :method =&gt; 'post' do |f| %&gt;\n  &lt;%= f.input :id, :input_html =&gt; { :value =&gt; @recipe.id}, as: :hidden %&gt;\n  &lt;%= f.input :shopping_lists, collecton: ShoppingList.all, as: :select %&gt;\n  &lt;%= f.button :submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>With this code, I'm getting this trace :</p>\n\n<pre><code>Rendered recipes/show.html.erb within layouts/application (122.9ms)\nCompleted 500 Internal Server Error in 395ms (ActiveRecord: 109.7ms)\n\n\n\nActionView::Template::Error (undefined method `shopping_lists' for #&lt;Recipe:0x000055a4c080af88&gt;):\n    54:           &lt;% end %&gt;\n    55:           &lt;%= simple_form_for :recipe, :url =&gt; recipe_add_ingredients_to_list_url(@recipe), :method =&gt; 'post' do |f| %&gt;\n    56:             &lt;%= f.input :id, :input_html =&gt; { :value =&gt; @recipe.id}, as: :hidden %&gt;\n    57:             &lt;%= f.input :shopping_lists, collecton: ShoppingList.all, as: :select %&gt;\n    58:             &lt;%= f.button :submit %&gt;\n    59:           &lt;% end %&gt;\n    60:         &lt;/div&gt;\n\napp/views/recipes/show.html.erb:57:in `block in _app_views_recipes_show_html_erb___4100323442142788090_47083061551380'\napp/views/recipes/show.html.erb:55:in `_app_views_recipes_show_html_erb___4100323442142788090_47083061551380'\n</code></pre>\n\n<p>My best guess is that the simple_form is not suited for what I want to do, but I really don't know how to make this feature.</p>\n\n<p>Could you help me ?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1554929278, "post_id": 55620746, "comment_id": 97935133, "body": "You can also do (with your second) example <code>print_if ||= -&gt; { true }</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554930145, "post_id": 55620746, "comment_id": 97935506, "body": "I just noticed your second code block, after posting my answer (since deleted), but there is nothing wrong with that at all, as the code describes perfectly what you are trying to achieve. I personally think <code>print_if.nil? ? true : print_if.call(internal_value)</code> reads better."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1554930162, "post_id": 55620746, "comment_id": 97935514, "body": "@Sergio, what are you talking about?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1554946158, "post_id": 55620746, "comment_id": 97939663, "body": "Remember that declaring a block as an argument carries a fairly hefty performance penalty as Ruby needs to capture a lot of contextual information for a block that&#39;s able to be passed on. Whenever possible use <code>block_given?</code> and <code>yield</code> in conjunction. For light use the difference is largely academic, but for performance sensitive code the difference can be dramatic. The general rule is to only declare block parameters if you need to forward the block to another method, in which case you have to pay the price anyway."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 3991555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7544757eac6291740cb1322e232212bf?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Dauenhauer", "link": "https://stackoverflow.com/users/3991555/eric-dauenhauer"}, "edited": false, "score": 0, "creation_date": 1555024722, "post_id": 55631099, "comment_id": 97975051, "body": "I think this answer is pretty good in the sense that it proves Ruby does not have a good way of setting defaults on arguments that should be procs/lambdas/blocks. I am not the biggest fan in general of the way Ruby allows passing around methods, but such is life. Just wanted to see if there was a shortcut I was missing."}], "tags": [], "owner": {"reputation": 146, "user_id": 11345395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpEXg.jpg?s=128&g=1", "display_name": "Dmitriy Pankratov", "link": "https://stackoverflow.com/users/11345395/dmitriy-pankratov"}, "is_accepted": false, "score": 1, "last_activity_date": 1554980988, "creation_date": 1554980988, "answer_id": 55631099, "question_id": 55620746, "link": "https://stackoverflow.com/questions/55620746/default-value-for-a-block-argument/55631099#55631099", "title": "Default value for a block argument", "body": "<p>You may use this dirty hack:</p>\n\n<pre><code>def my_method(print_if = -&gt; (*args) { block_given? ? yield(*args) : true })\n  internal_value = [1, 2, 3]\n  puts \"printing\" if print_if.call(internal_value)\nend\n</code></pre>\n\n<p>But is it convenient?</p>\n"}], "owner": {"reputation": 403, "user_id": 3991555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7544757eac6291740cb1322e232212bf?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Dauenhauer", "link": "https://stackoverflow.com/users/3991555/eric-dauenhauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554980988, "creation_date": 1554927646, "last_edit_date": 1554928122, "question_id": 55620746, "link": "https://stackoverflow.com/questions/55620746/default-value-for-a-block-argument", "title": "Default value for a block argument", "body": "<p>I would like to create a method which accepts a block argument but defaults the block to a method that always returns true.</p>\n\n<pre><code>def my_method(&amp;print_if = Proc.new { true })\n  internal_value = [1, 2, 3]\n  puts \"printing\" if print_if.call(internal_value)\nend\n\nmy_method { |array| array[1] == 2 }\n \"printing\"\n =&gt; nil\nmy_method { |array| array[1] == 3 }\n =&gt; nil\nmy_method\n \"printing\"\n =&gt; nil\n</code></pre>\n\n<p>It seems that my best option is to check for the presence of a block in the method. This works, its just clunkier</p>\n\n<pre><code>def my_method(&amp;print_if)\n  internal_value = [1, 2, 3]\n  puts \"printing\" if !block_given? || print_if.call(internal_value)\nend\n\nmy_method { |array| array[1] == 2 }\n \"printing\"\n =&gt; nil\nmy_method { |array| array[1] == 3 }\n =&gt; nil\nmy_method\n \"printing\"\n =&gt; nil\n</code></pre>\n\n<p>Any way to default a block arg in Ruby? Please no answers that rely on external libraries (even Rails), just trying to find out if this is possible with pure Ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb"], "comments": [{"owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "edited": false, "score": 1, "creation_date": 1554926641, "post_id": 55620462, "comment_id": 97933971, "body": "Has <code>&#39;kaminari-mongoid&#39;</code> been added to the Gemfile?"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "reply_to_user": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "edited": false, "score": 0, "creation_date": 1554946364, "post_id": 55620462, "comment_id": 97939698, "body": "Adding the GEM appears to work."}], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554926407, "creation_date": 1554926407, "question_id": 55620462, "link": "https://stackoverflow.com/questions/55620462/why-am-i-getting-undefined-method-page-for-mongoidcriteria", "title": "Why am I getting undefined method page for MongoID::Criteria", "body": "<p>Took over this project and updating to Rail 4.2.11. I haven't changed anything. We are using Kaminari. I am guessing Mongo is bringing back something now that it wasn't before? Or is Kaminari the issue?</p>\n\n<p>I get the following error</p>\n\n<pre><code>NoMethodError (undefined method `page' for #&lt;Mongoid::Criteria:0x0070f088&gt;):\n</code></pre>\n\n<p>on this line of code</p>\n\n<pre><code>@calls = MyRequest.desc(:timestamp_requested).page(params[:page])\n</code></pre>\n\n<p>FULL CODE:</p>\n\n<pre><code>def calls_admin\nensure_root\n@sort = params[:s] || 'requested'\n@direction = params[:d] || 'desc'\nif @direction == 'desc'\n  case @sort\n  when 'status'\n    @calls = MyRequest.desc(:status, :timestamp_requested).page(params[:page])\n  when 'requested'\n    @calls = MyRequest.desc(:timestamp_requested).page(params[:page])\n  when 'yo'\n    @calls = MyRequest.desc(:name, :timestamp_requested).page(params[:page])\n  when 'length'\n    @calls = MyRequest.desc(:calculated_mileage).page(params[:page])\n  when 'time'\n    @calls = MyRequest.desc(:time_in_seconds).page(params[:page])\n  when 'billing'\n    @calls = MyRequest.page(params[:page])\n  end\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1554922568, "creation_date": 1554922568, "answer_id": 55619545, "question_id": 55619382, "link": "https://stackoverflow.com/questions/55619382/how-the-comparison-operator-work-with-the-if-statement-of-the-code-below/55619545#55619545", "title": "How the comparison operator &#39;==&#39; work with the &#39;if&#39; statement of the code below?", "body": "<p>When the <code>stack</code> is empty then <code>stack.last</code> will return <code>nil</code>. </p>\n\n<p><code>OPPOSITE['NORHT']</code> will return <code>'SOUTH'</code> and <code>'SOUTH' == nil</code> if <code>false</code>, therefore the <code>else</code> branch (<code>stack.push(dir)</code>) will be evaluated.</p>\n"}], "owner": {"reputation": 33, "user_id": 11325492, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157673790594068/picture?type=large", "display_name": "Luigi Palermo", "link": "https://stackoverflow.com/users/11325492/luigi-palermo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554923228, "creation_date": 1554921885, "last_edit_date": 1554923228, "question_id": 55619382, "link": "https://stackoverflow.com/questions/55619382/how-the-comparison-operator-work-with-the-if-statement-of-the-code-below", "title": "How the comparison operator &#39;==&#39; work with the &#39;if&#39; statement of the code below?", "body": "<p>As shown in the below method, I do not understand how the 'comparison operator' works. If the defined 'stack array' is initially empty how can the elements of the hash 'OPPOSITE' can be compared with the last element of an empty array? Does the comparison happen on the operand 'OPPOSITE[dir]'? Even if so, it is still not clear.</p>\n\n<p>Thanks</p>\n\n<p>code:</p>\n\n<pre><code> OPPOSITE = {\n   \"NORTH\" =&gt; \"SOUTH\",\n   \"SOUTH\" =&gt; \"NORTH\",\n   \"EAST\"  =&gt; \"WEST\",\n   \"WEST\"  =&gt; \"EAST\"\n }\n\ndef dirReduc(arr)\n  stack = []\n\n  arr.each do |dir|\n    OPPOSITE[dir] == stack.last ? stack.pop : stack.push(dir)\n  end\n\n  stack\nend \n\n\n arr = [\"NORTH\", \"SOUTH\", \"SOUTH\", \"EAST\", \"WEST\", \"NORTH\", \"WEST\"]\n\n print dirReduc(arr)\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "image"], "answers": [{"tags": [], "owner": {"reputation": 259, "user_id": 10136560, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G1KRTyhGFh4/AAAAAAAAAAI/AAAAAAAAUxs/RzYlXgnLKl4/photo.jpg?sz=128", "display_name": "aaron lilly", "link": "https://stackoverflow.com/users/10136560/aaron-lilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1554920039, "creation_date": 1554920039, "answer_id": 55618917, "question_id": 55618804, "link": "https://stackoverflow.com/questions/55618804/cant-link-to-image-with-html-on-rails-app/55618917#55618917", "title": "Can&#39;t link to image with HTML on Rails app", "body": "<p>can you try with a online based example ? My guess is ruby isn't finding your image within the directory.</p>\n\n<pre><code>&lt;img src =\"https://upload.wikimedia.org/wikipedia/commons/thumb/3/32/Googleplex_HQ_%28cropped%29.jpg/250px-Googleplex_HQ_%28cropped%29.jpg\"&gt; &lt;/img&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "edited": false, "score": 0, "creation_date": 1554963701, "post_id": 55618954, "comment_id": 97943853, "body": "Hello,  Thanks for the answer. I tried &lt;img src=&quot;&lt;%=asset_path(&#39;images/image1.png&#39;)%&gt;&quot;&gt;  But it gave me an error saying the Asset couldn&#39;t be found  So then I tried &lt;img src=&quot;&lt;%=asset_path(&#39;/image1.png&#39;)%&gt;&quot;&gt;  Which didn&#39;t give me any errors but the picture still won&#39;t load, it&#39;s just displayed as a broken link.  When I inspect the image_tag (that works) it shows the HTML as follows: img src= &quot;/assets/image1-48e6870c46f97f301cb1d7c6e8fdf2d04c03dc407bf5&zwnj;&#8203;f2199f27ad41f3f26137&zwnj;&#8203;.png  Why is it adding all of this other information? This must be why I can&#39;t call it."}, {"owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "reply_to_user": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "edited": false, "score": 0, "creation_date": 1555006446, "post_id": 55618954, "comment_id": 97968569, "body": "The extra information is a cache fingerprint, so that browsers can cache the resource and not reload it from the network. When the file changes, the fingerprint changes. Then browsers have to load the changed file. It&#39;s possible that I should have written <code>&lt;%=asset_path(&#39;image1.png&#39;)%&gt;</code>"}, {"owner": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "edited": false, "score": 0, "creation_date": 1555309906, "post_id": 55618954, "comment_id": 98051061, "body": "&lt;%=asset_path(&#39;image1.png&#39;)%&gt; works fine, thank you!"}], "tags": [], "owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "is_accepted": true, "score": 2, "last_activity_date": 1554920219, "creation_date": 1554920219, "answer_id": 55618954, "question_id": 55618804, "link": "https://stackoverflow.com/questions/55618804/cant-link-to-image-with-html-on-rails-app/55618954#55618954", "title": "Can&#39;t link to image with HTML on Rails app", "body": "<p>Nice question. The Rails asset compiler is important but makes some problems like this one.</p>\n\n<p>The asset compiler is likely adding a cache fingerprint to the file name. You can use <code>&lt;%=asset_path('images/image1.png')%&gt;</code> as the value of the <code>src</code> attribute, or continue using <code>image_tag</code>. </p>\n\n<p>See <a href=\"https://guides.rubyonrails.org/v5.0/asset_pipeline.html\" rel=\"nofollow noreferrer\">the Rails guide assets document</a> for more information.</p>\n\n<p>Does that help?</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "edited": false, "score": 0, "creation_date": 1554963062, "post_id": 55619041, "comment_id": 97943612, "body": "Yep I wrote the tag incorrectly on here but I wrote it correctly on my app, the image tag is the one that works, its the img-src that doesn&#39;t work"}], "tags": [], "owner": {"reputation": 11, "user_id": 6700860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LcU6V.jpg?s=128&g=1", "display_name": "Mike Retzak", "link": "https://stackoverflow.com/users/6700860/mike-retzak"}, "is_accepted": false, "score": 0, "last_activity_date": 1554920583, "creation_date": 1554920583, "answer_id": 55619041, "question_id": 55618804, "link": "https://stackoverflow.com/questions/55618804/cant-link-to-image-with-html-on-rails-app/55619041#55619041", "title": "Can&#39;t link to image with HTML on Rails app", "body": "<p>Looks like your syntax is incorrect for the <code>image_tag</code> helper. Try this:</p>\n\n<p><code>&lt;%= image_tag \"image1.png\" %&gt;</code></p>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag\" rel=\"nofollow noreferrer\">More info in the Rails docs</a></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "edited": false, "score": 0, "creation_date": 1554963991, "post_id": 55620040, "comment_id": 97943966, "body": "I&#39;ve tried omitting &#39;app&#39; from the path and just entering in img src=&quot;/assets/images/image1.png&quot;, but that didn&#39;t work either.     When I inspect the image_tag (that works) it shows the HTML as follows: img src= &quot;/assets/image1-48e6870c46f97f301cb1d7c6e8fdf2d04c03dc407bf5&zwnj;&#8203;f2199f27ad41f3f26137&zwnj;&#8203;.png  Why is it adding all of this other information? This must be why I can&#39;t call it.   Cheers for the info about using image_tag instead!"}, {"owner": {"reputation": 712, "user_id": 4191738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKXDY.jpg?s=128&g=1", "display_name": "Sculper", "link": "https://stackoverflow.com/users/4191738/sculper"}, "reply_to_user": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "edited": false, "score": 0, "creation_date": 1554990464, "post_id": 55620040, "comment_id": 97959321, "body": "That&#39;s covered by the documentation I linked - that&#39;s a fingerprint that&#39;s being generated by <code>image_tag</code>. If you make any updates to that image (or swap it out entirely), that string will change - meaning any browsers that have already cached the original image will be forced to request the new one."}], "tags": [], "owner": {"reputation": 712, "user_id": 4191738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKXDY.jpg?s=128&g=1", "display_name": "Sculper", "link": "https://stackoverflow.com/users/4191738/sculper"}, "is_accepted": false, "score": 0, "last_activity_date": 1554925702, "last_edit_date": 1554925702, "creation_date": 1554924705, "answer_id": 55620040, "question_id": 55618804, "link": "https://stackoverflow.com/questions/55618804/cant-link-to-image-with-html-on-rails-app/55620040#55620040", "title": "Can&#39;t link to image with HTML on Rails app", "body": "<p>The problem is the path you're using. Here's the short version: Remove <code>app/</code> from the image URL, and it should work as expected.</p>\n\n<p>If you run the app with the working code, you can see that this is what <code>image_tag</code> is already doing for you behind the scenes by inspecting the HTML. You should see something like this:</p>\n\n<pre><code>&lt;img src=\"/assets/images/image1.png\"&gt;\n\n</code></pre>\n\n<p>Updating your <code>img</code> tag to use that path should resolve the issue.</p>\n\n<p>However, you <em>should</em> be using <code>image_tag</code> if possible! Without delving too deep into the technical details, if you deploy your site to production with the <code>image_tag</code> version and take a look at the HTML, you'll probably see something like this:</p>\n\n<pre><code>&lt;img src=\"/assets/images/image1-[sequence of characters].png\"&gt;\n</code></pre>\n\n<p>This will help ensure that clients are removing stale assets from their caches as necessary - the technical details can be found <a href=\"https://guides.rubyonrails.org/asset_pipeline.html\" rel=\"nofollow noreferrer\">here</a> (see section 1.2). If you hard-code the image, you're going to miss out on any features provided by the asset pipeline.</p>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 11345395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpEXg.jpg?s=128&g=1", "display_name": "Dmitriy Pankratov", "link": "https://stackoverflow.com/users/11345395/dmitriy-pankratov"}, "is_accepted": false, "score": 0, "last_activity_date": 1554985279, "creation_date": 1554985279, "answer_id": 55632402, "question_id": 55618804, "link": "https://stackoverflow.com/questions/55618804/cant-link-to-image-with-html-on-rails-app/55632402#55632402", "title": "Can&#39;t link to image with HTML on Rails app", "body": "<p>If you want use <strong>img</strong> tag you should:</p>\n\n<pre><code>&lt;img src=\"&lt;%= asset_path('image1.png') %&gt;\"/&gt;\n</code></pre>\n\n<p>Without \"/images\" and \"/\".</p>\n"}], "owner": {"reputation": 13, "user_id": 11342057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pmI9PGiyVQ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc23EgtrPhC7ceFPRy-ZPOiPBF90w/mo/photo.jpg?sz=128", "display_name": "Ghazarios", "link": "https://stackoverflow.com/users/11342057/ghazarios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 55618954, "answer_count": 5, "score": 1, "last_activity_date": 1554985279, "creation_date": 1554919586, "question_id": 55618804, "link": "https://stackoverflow.com/questions/55618804/cant-link-to-image-with-html-on-rails-app", "title": "Can&#39;t link to image with HTML on Rails app", "body": "<p>I'm developing a Web app using Ruby on Rails. I have an image to add to the site, and I tried using the \"img src\" HTML tag to call a local image, but it won't work. If I use ruby to call it using the \"image-tag\" method, it works fine. I'm just wondering as to why it never works with HTML.</p>\n\n<p>For example, I add an image to app>assets>images>image1.png</p>\n\n<p>On the View file, I add HMTL as follows:</p>\n\n<pre><code> &lt;img src=\"/app/assets/images/image1.png\"&gt;\n</code></pre>\n\n<p>It doesn't load</p>\n\n<p>Yet if I enter this code in the same spot:</p>\n\n<pre><code>&lt;%= image-tag: \"image1.png\" %&gt;\n</code></pre>\n\n<p>It works fine.</p>\n\n<p>Does anyone know why this is happening? I know I have a workaround, but I would rather know why my HTML tag has an issue with local files, yet links to files on the internet just fine. \nI'm new to coding.\nCheers!</p>\n"}, {"tags": ["ruby", "macos", "rvm"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554918421, "post_id": 55618516, "comment_id": 97930271, "body": "Older versions of Ruby, like 2.3.x, may not work on newer versions of macOS. Have you tried 2.5.x? 2.6 is current and the most likely to install without issues as that&#39;s where everyone&#39;s attention is focused at the moment."}, {"owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1554919393, "post_id": 55618516, "comment_id": 97930699, "body": "I just updated the question to show 2.6.0, it still does not work"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1554921121, "post_id": 55618516, "comment_id": 97931526, "body": "If <code>open &#47;Library&#47;Developer&#47;CommandLineTools&#47;Packages&#47;macOS_SDK_heade&zwnj;&#8203;rs_for_macOS_10.14.p&zwnj;&#8203;kg</code> does not resolve your issue, and if completely removing brew and all installed brew packages followed by reinstalling brew (but NOT reinstalling your packages; allow the RVM installer to use brew to install anything it needs) does not resolve your issue then you should reinstall macOS from scratch and retry your operation."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1554921517, "post_id": 55618516, "comment_id": 97931705, "body": "Please post output of both <code>rvm config-get</code> and <code>gem env</code> ?"}, {"owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1554922568, "post_id": 55618516, "comment_id": 97932207, "body": "@anothermh The pkg installed and rvm installs now!"}, {"owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1554922718, "post_id": 55618516, "comment_id": 97932276, "body": "@lacostenycoder I want to make sure everything is correctly setup though between OSX ruby and the homebrew/rvm ruby. Here is the pastebin for the gem env: <a href=\"https://pastebin.com/raw/VXEPXgKq\" rel=\"nofollow noreferrer\">pastebin.com/raw/VXEPXgKq</a>  Here is the one for the rvm config-get: <a href=\"https://pastebin.com/raw/vSXRSEdp\" rel=\"nofollow noreferrer\">pastebin.com/raw/vSXRSEdp</a>  It is complaining about the PATH directory still. So I am afraid my path is still incorrect."}], "answers": [{"comments": [{"owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1554923490, "post_id": 55619610, "comment_id": 97932619, "body": "@anothermh seriously thank you so much I have been searching all week. Where did you find that command? I haven&#39;t seen it anywhere hopefully someone else will see it here that needs header files."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1554924659, "post_id": 55619610, "comment_id": 97933093, "body": "<a href=\"https://stackoverflow.com/q/55525660/3784008\">The last time you asked about this</a> someone told you to read <a href=\"https://rubytalk.org/t/installing-ruby-latest-on-mac-mojave-corefoundation-cfstring-h-not-found/74830/2\" rel=\"nofollow noreferrer\">this</a> which links to <a href=\"https://stackoverflow.com/q/52509602/3784008\">this</a>; you said &quot;<i>I came across that post and it pretty much leads to a dead end</i>&quot; which is odd because the top voted comment on that post (with 22 upvotes) and the <a href=\"https://stackoverflow.com/a/52530212/3784008\">top voted answer</a> on that post (with 144 upvotes) say to do exactly this."}, {"owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1554985095, "post_id": 55619610, "comment_id": 97955675, "body": "Wow I totally missed that command. I tried everything else that posts says. Either way the answer has around 5 possible solutions, and lots of text makes it very unclear which one reinstalls the header files. I went to apple\u2019s website and downloaded a command line tools pkg and installed it and it did nothing. Same with reinstalling Xcode."}], "tags": [], "owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "is_accepted": true, "score": 1, "last_activity_date": 1554923071, "last_edit_date": 1554923071, "creation_date": 1554922876, "answer_id": 55619610, "question_id": 55618516, "link": "https://stackoverflow.com/questions/55618516/installing-ruby-with-rvm-cannot-find-corefoundation-cfstring-h/55619610#55619610", "title": "Installing ruby with RVM cannot find &lt;CoreFoundation/CFString.h&gt;", "body": "<p>Open terminal and type:</p>\n\n<pre><code>open /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg\n</code></pre>\n"}], "owner": {"reputation": 882, "user_id": 3097454, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/2V4D2.jpg?s=128&g=1", "display_name": "Nick Gallimore", "link": "https://stackoverflow.com/users/3097454/nick-gallimore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "accepted_answer_id": 55619610, "answer_count": 1, "score": 0, "last_activity_date": 1554923071, "creation_date": 1554918240, "last_edit_date": 1554920548, "question_id": 55618516, "link": "https://stackoverflow.com/questions/55618516/installing-ruby-with-rvm-cannot-find-corefoundation-cfstring-h", "title": "Installing ruby with RVM cannot find &lt;CoreFoundation/CFString.h&gt;", "body": "<p>When typing</p>\n\n<pre><code>rvm install 2.6.0\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>file.c:23:10: fatal error: 'CoreFoundation/CFString.h' file not found\n#include &lt;CoreFoundation/CFString.h&gt;\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>I am on OSX 10.14.4</p>\n\n<p>I have the newest version of Xcode installed (10.2).</p>\n\n<p>How can I fix my system?</p>\n\n<p>Here is a link to my other posts on the ruby mailing list: <a href=\"https://rubytalk.org/t/installing-ruby-with-rvm-cannot-find-corefoundation-cfstring-h/74982\" rel=\"nofollow noreferrer\">https://rubytalk.org/t/installing-ruby-with-rvm-cannot-find-corefoundation-cfstring-h/74982</a></p>\n"}, {"tags": ["ruby", "date"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1554912851, "post_id": 55616955, "comment_id": 97927470, "body": "Works for me, how are you creating your <code>expiry_date</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554914073, "post_id": 55616955, "comment_id": 97928081, "body": "Can you show your exact definition of <code>expiry_date</code>? If that&#39;s a string you need to <code>Date.parse</code> into a <code>Date</code>. It&#39;s also worth noting you call that method more than once, meaning you need to do the calculations several times. Instead do the calculation once, save it in a variable, then do your comparisons."}, {"owner": {"reputation": 15, "user_id": 10457724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f955494ce3e8e1e0ca9301d65d56a39?s=128&d=identicon&r=PG&f=1", "display_name": "Phil C", "link": "https://stackoverflow.com/users/10457724/phil-c"}, "edited": false, "score": 0, "creation_date": 1554914887, "post_id": 55616955, "comment_id": 97928516, "body": "This is where my problem was - I was not using Date.parse on the string. Works as expected now, thanks"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554915500, "post_id": 55616955, "comment_id": 97928815, "body": "<code>&quot;2019-04-20&quot; - Date.today #=&gt; NoMethodError (undefined method &#39;-&#39; for &quot;2019-04-20&quot;:String)</code>, so I don&#39;t understand how you concluded the code worked correctly for future dates."}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "is_accepted": true, "score": 1, "last_activity_date": 1554914153, "creation_date": 1554914153, "answer_id": 55617422, "question_id": 55616955, "link": "https://stackoverflow.com/questions/55616955/ruby-calculate-difference-in-days/55617422#55617422", "title": "ruby - calculate difference in days", "body": "<p>I guess it's about smth within your codebase that wasn't provided here, but generally speaking current logic handles it. Updated sample which shows it:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'date'\n\nexpiry_date = Date.new(2019,4,1) \n\ndef calculate_date_difference(expiry_date)\n  (expiry_date - Date.today).to_i\nend\n\nmessage = if calculate_date_difference(expiry_date).between?(0,90)\n  \"90 days or less\"\nelsif calculate_date_difference(expiry_date) &gt; 90\n  \"more than 90 days\"\nelse \n  \"past\"\nend\n\nmessage == \"past\" # true\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10457724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f955494ce3e8e1e0ca9301d65d56a39?s=128&d=identicon&r=PG&f=1", "display_name": "Phil C", "link": "https://stackoverflow.com/users/10457724/phil-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55617422, "answer_count": 1, "score": 0, "last_activity_date": 1554914153, "creation_date": 1554912412, "last_edit_date": 1554912861, "question_id": 55616955, "link": "https://stackoverflow.com/questions/55616955/ruby-calculate-difference-in-days", "title": "ruby - calculate difference in days", "body": "<p>I am trying to calculate the difference in days (as an integer) between two dates. How do I handle the difference if it is a negative int?</p>\n\n<p>Here is an example of my code. </p>\n\n<p>expiry_date is populated from a JSON response</p>\n\n<pre><code>expiry_date #e.g - 2019-04-01\n\ndef calculate_date_difference\n (expiry_date - Date.today).to_i\nend\n\nif calculate_date_difference.between?(0,90)\n puts \"90 days or less\"\nelsif calculate_date_difference &gt; 90\n puts \"more than 90 days\"\nelse \n puts \"past\"\nend\n</code></pre>\n\n<p>The code works correctly when the expiry_date is in the future, however if the expiry date is in the past then it keeps falling into the wrong condition. For example, the difference in this example is \"-9\".</p>\n\n<p>I expect it to print \"past\" but it always prints \"90 days of less\"</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "windows", "ruby2d"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1554912232, "post_id": 55616849, "comment_id": 97927124, "body": "What version of ruby? What platform? What version of ruby2d? Please include the necessary information to replicate your environment."}, {"owner": {"reputation": 1, "user_id": 8164344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lX7Szu0ZgJQ/AAAAAAAAAAI/AAAAAAAAABE/iP1qoE6VJX8/photo.jpg?sz=128", "display_name": "carl schimdt", "link": "https://stackoverflow.com/users/8164344/carl-schimdt"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1554914472, "post_id": 55616849, "comment_id": 97928284, "body": "ah sorry, i&#39;m using windows 10, ruby version 2.5.1p57 64 bit and ruby2D version 0.9.0"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554916049, "post_id": 55616849, "comment_id": 97929083, "body": "This isn&#39;t enough code to reproduce the problem. What&#39;s the most minimal, complete program that still crashes?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554917200, "post_id": 55616849, "comment_id": 97929643, "body": "@tadman apparently it is not very far from it though <a href=\"https://github.com/ruby2d/examples/blob/master/keyevent-example/keyevent-example.rb\" rel=\"nofollow noreferrer\">Key Event Example</a>. Also not that I have any idea how ruby 2d works but wouldn&#39;t a higher y coordinate be up? If so then this code would seemingly make you drop 25 (y units) and then raise back up to where you were more like a dive than a jump."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1554918220, "post_id": 55616849, "comment_id": 97930179, "body": "@engineersmnky There&#39;s presumably some other surrounding code to frame this <code>on</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1554918411, "post_id": 55616849, "comment_id": 97930267, "body": "true we lack a definition for <code>player</code> and <code>player#y</code>"}, {"owner": {"reputation": 1, "user_id": 8164344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lX7Szu0ZgJQ/AAAAAAAAAAI/AAAAAAAAABE/iP1qoE6VJX8/photo.jpg?sz=128", "display_name": "carl schimdt", "link": "https://stackoverflow.com/users/8164344/carl-schimdt"}, "edited": false, "score": 0, "creation_date": 1554962877, "post_id": 55616849, "comment_id": 97943549, "body": "<a href=\"https://pastebin.com/73U2jqxS\" rel=\"nofollow noreferrer\">pastebin.com/73U2jqxS</a>"}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "is_accepted": false, "score": 0, "last_activity_date": 1559916628, "creation_date": 1559916628, "answer_id": 56495945, "question_id": 55616849, "link": "https://stackoverflow.com/questions/55616849/ruby-interpretor-crashes-on-key-down/56495945#56495945", "title": "Ruby interpretor crashes on :key_down", "body": "<p>In Ruby2D you must use <code>tick</code> to do animation.</p>\n\n<p>The window also manages the update loop, one of the few infinite loops in programming you\u2019ll encounter that isn\u2019t a mistake. Every window has a heartbeat, a loop that runs 60 times per second, or as close to it as the computer\u2019s performance will allow. Using the <code>update</code> method, we can enter this loop and make the window come to life!</p>\n\n<p>Try something like this:</p>\n\n<pre><code>require 'ruby2d'\n\nset title: 'squares'\nset background: 'blue'\nset width: 1280\nset height: 720\nset borderless: true\n\non_air = false \ntick = 0\n\n\nground = Rectangle.new(\n x: 0, y: 620,\n width: 1280, height: 100,\n color: 'green'\n)\n\nplayer = Square.new(\n x: 100, y: 520,\n size: 100,\n color: ['red', 'purple', 'fuchsia', 'maroon']\n)\n\non :key_down do |jump|\n if jump.key == 'j'\n  player.y -= 50\n  on_air = true\n end\nend\n\nupdate do\n  if on_air\n   if tick % 1 == 0\n     player.y += 5\n     if (player.y + player.size) == ground.y\n      on_air = false\n     end     \n   end\n  end\n\n  tick += 1\nend\n\nshow\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8164344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lX7Szu0ZgJQ/AAAAAAAAAAI/AAAAAAAAABE/iP1qoE6VJX8/photo.jpg?sz=128", "display_name": "carl schimdt", "link": "https://stackoverflow.com/users/8164344/carl-schimdt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559916628, "creation_date": 1554912047, "last_edit_date": 1554916054, "question_id": 55616849, "link": "https://stackoverflow.com/questions/55616849/ruby-interpretor-crashes-on-key-down", "title": "Ruby interpretor crashes on :key_down", "body": "<p>i'm new to ruby and programming in general and i'm using a gem called ruby2D.\nIm trying to get a cube to jump, but when i press my jump key, my interpretor just crashes without any saying any errors</p>\n\n<p>I've had problems actually identifying the problem, but i've tried with while instead of until and that didn't seem to work either</p>\n\n<pre><code>on :key_down do |jump|\n if jump.key == 'j'\n  if player.y == 520\n   gravity = -15\n   player.y = 510\n   until player.y == 520\n    player.y += gravity\n    gravity += 1\n   end\n  end\n end\nend \n</code></pre>\n\n<p>i would want my cube to jump, and fall down again, but i just get crashes</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1554911306, "post_id": 55616623, "comment_id": 97926600, "body": "I don&#39;t see <code>num_printer</code> method defined..."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1554913235, "post_id": 55616623, "comment_id": 97927648, "body": "&quot;<i>maybe</i> called num_printer&quot; @orde..."}], "answers": [{"tags": [], "owner": {"reputation": 24667, "user_id": 797303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DahZJ.jpg?s=128&g=1", "display_name": "Maxim Krizhanovsky", "link": "https://stackoverflow.com/users/797303/maxim-krizhanovsky"}, "is_accepted": true, "score": 0, "last_activity_date": 1554911582, "creation_date": 1554911582, "answer_id": 55616736, "question_id": 55616623, "link": "https://stackoverflow.com/questions/55616623/how-to-set-a-variable-to-an-if-condition/55616736#55616736", "title": "How to set a variable to an if condition", "body": "<p>Basically, you want to insert something (' x ' in your case) between the elements and output the result. Use <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow noreferrer\">join</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>puts arr1.join(' x ')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1554913488, "post_id": 55616887, "comment_id": 97927766, "body": "<code>arr1.last</code> is suspicious - what if there is another 4 before the last?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1554913586, "post_id": 55616887, "comment_id": 97927813, "body": "@steenslag I agree, but that&#39;s a question for OP."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1554912538, "last_edit_date": 1554912538, "creation_date": 1554912175, "answer_id": 55616887, "question_id": 55616623, "link": "https://stackoverflow.com/questions/55616623/how-to-set-a-variable-to-an-if-condition/55616887#55616887", "title": "How to set a variable to an if condition", "body": "<p>There are simpler ways to accomplish this as Maxim points out in their answer, but to answer your question, you could accomplish this by initializing an empty string variable and then in your <code>each</code> block appending text to the variable instead of printing it:</p>\n\n<pre><code>arr1 = [1, 2, 3, 4]\nnums_str = \"\"\n\narr1.each do |num|\n  if num == arr1.last\n    nums_str &lt;&lt; num.to_s\n  else\n    nums_str &lt;&lt; \"#{num} x \"\n  end\nend\n\nputs nums_str\n# =&gt; 1 x 2 x 3 x 4\n</code></pre>\n\n<p>See it on repl.it: <a href=\"https://repl.it/@jrunning/ArcticDeficientArchitecture\" rel=\"nofollow noreferrer\">https://repl.it/@jrunning/ArcticDeficientArchitecture</a></p>\n"}], "owner": {"reputation": 59, "user_id": 6272532, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INtAIiFdEtw/AAAAAAAAAAI/AAAAAAAABS4/mh7H3fOz4aw/photo.jpg?sz=128", "display_name": "Gregorio Pompei", "link": "https://stackoverflow.com/users/6272532/gregorio-pompei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55616736, "answer_count": 2, "score": 0, "last_activity_date": 1554912538, "creation_date": 1554911138, "question_id": 55616623, "link": "https://stackoverflow.com/questions/55616623/how-to-set-a-variable-to-an-if-condition", "title": "How to set a variable to an if condition", "body": "<p>I have this condition:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr1 = [1, 2, 3, 4]\n\narr1.each do |num|\n  if num == arr1.last\n    print \"#{num}\\n\"\n    exit\n  else\n    print \"#{num} x \"\n  end\nend\n</code></pre>\n\n<p>and I have to print this like a variable, maybe called num_printer, so that if I write</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  puts num_printer\n</code></pre>\n\n<p>it should print this</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  1 x 2 x 3 x 4\n</code></pre>\n\n<p>But I don't know how to do this.\nCan anyone help me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "edited": false, "score": 0, "creation_date": 1554916033, "post_id": 55617006, "comment_id": 97929071, "body": "Hello @jvillian - correct - it is Platform. My problem here is my resultant map is [[35, &quot;assetname, [&quot;platname1&quot;, &quot;platname2&quot;, &quot;platname3&quot;]]]. I want [[35,&quot;assetname&quot;,&quot;platname1&quot;,&quot;platname2&quot;,&quot;platname3&quot;]]. Sorry if I&#39;ve made that super unclear - I will update the question here."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "edited": false, "score": 0, "creation_date": 1554917311, "post_id": 55617006, "comment_id": 97929697, "body": "See updated answer. I <i>think</i> this is what you&#39;re looking for. Maybe."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1554918028, "post_id": 55617006, "comment_id": 97930067, "body": "Or <code>[asset.id, asset.name, *platform_names]</code>, maybe."}, {"owner": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "edited": false, "score": 1, "creation_date": 1554918871, "post_id": 55617006, "comment_id": 97930454, "body": "@jvillian Ahhhh - yes - concat works splendidly. And likewise for mu is too short. Either works well - thanks!"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 3, "last_activity_date": 1554918233, "last_edit_date": 1554918233, "creation_date": 1554912539, "answer_id": 55617006, "question_id": 55616455, "link": "https://stackoverflow.com/questions/55616455/ruby-in-rails-dynamically-mapping-in-a-map/55617006#55617006", "title": "Ruby in Rails - dynamically mapping in a .map", "body": "<p>Assuming you have a model called <code>Platform</code> (not <code>Platforms</code>, since models are usually in the singular), it seems like this would be as simple as:</p>\n\n<pre><code>platform_names = Platform.pluck(:platform_name)\n\nassets.map do |asset|\n  [\n    asset.id,\n    asset.name,\n    platform_names\n  ]\nend\n</code></pre>\n\n<p>Naturally, <code>platform_names</code> will be identical for each mapped <code>asset</code>, but I guess that's what you want?</p>\n\n<p>Given your comment, you can try: </p>\n\n<pre><code>platform_names = Platform.pluck(:platform_name)\n\nassets.map do |asset|\n  [\n    asset.id,\n    asset.name\n  ].concat(platform_names)\nend\n</code></pre>\n\n<p>Or, as mu says:</p>\n\n<pre><code>platform_names = Platform.pluck(:platform_name)\n\nassets.map do |asset|\n  [\n    asset.id,\n    asset.name,\n    *platform_names\n  ]\nend\n</code></pre>\n"}], "owner": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 55617006, "answer_count": 1, "score": 0, "last_activity_date": 1554918233, "creation_date": 1554910614, "last_edit_date": 1554916686, "question_id": 55616455, "link": "https://stackoverflow.com/questions/55616455/ruby-in-rails-dynamically-mapping-in-a-map", "title": "Ruby in Rails - dynamically mapping in a .map", "body": "<p><strong>EDIT</strong>:\nFor clarification, I want the number of elements of the resultant array-of-arrays to change dynamically based on the # of platforms. I.e. I want [[35,\"assetname\",\"platname1\",\"platname2\",\"platname3\"]], not [[35, \"assetname, [\"platname1\", \"platname2\", \"platname3\"]]]. </p>\n\n<p>I am using datatables as a part of my Rails app. I have a method that generates an ActiveRecord association and passes it to map. The operative code looks like this:</p>\n\n<pre><code>assets.map do |asset|\n[\n  asset.id,\n  asset.name,\n  asset.thing\n]\n</code></pre>\n\n<p>But I want to do something trickier - I want to dynamically make <strong>the number of entries in the resultant array</strong> to be larger based on the # of some other object. I have an object called Platforms... so something like this</p>\n\n<pre><code>assets.map do |asset|\n[\n  asset.id,\n  asset.name,\n  Platforms.all.each do |line|\n     line.platform_name.to_s,\n  end\n]\n</code></pre>\n\n<p>The problem is... it appears to be a syntax problem. No matter what I do, I cannot get a setup like this to work. I tried to simplify - this works (showing 1 in the final column):</p>\n\n<pre><code>assets.map do |asset|\n[\n  asset.id,\n  asset.name,\n  [1].each do |line| line.to_s end\n]\n</code></pre>\n\n<p>But try to break that out to having more than one element, and no dice:</p>\n\n<pre><code>assets.map do |asset|\n[\n  asset.id,\n  asset.name,\n  [1,2].each do |line| line.to_s end\n]\n</code></pre>\n\n<p>This puts just \"1,2\" in the final column. Whereas I want 1, then 2 in their own two columns - not \"1,2\" in a singular column.</p>\n\n<p>As far as the syntax errors I get when trying to do it with my actual object:</p>\n\n<p>app/datatables/assets_datatable.rb:111: syntax error, unexpected keyword_end, expecting '='\napp/datatables/assets_datatable.rb:142: syntax error, unexpected keyword_end, expecting ']'</p>\n\n<p>How does one achieve this? What I want to achieve is to have a <strong>resultant array that has more elements</strong> for each # of Platforms.</p>\n"}, {"tags": ["ruby", "sorting", "alphabetical"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554910248, "post_id": 55616288, "comment_id": 97925992, "body": "What if there is more than one <code>e</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11113981"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554910357, "post_id": 55616288, "comment_id": 97926046, "body": "let&#39;s sat there is just one e; it&#39;s just example; I would use &#39;default&#39; in my case"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1554914434, "post_id": 55616288, "comment_id": 97928263, "body": "<code>arr.sort.unshift(arr.delete(&#39;e&#39;))</code>. Only works for an array of unique characters and the <code>&#39;e&#39;</code> must exist else you&#39;ll get a <code>nil</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1554941228, "post_id": 55617980, "comment_id": 97938696, "body": "You could also use <code>s == &#39;e&#39; ? &#39;&#39; : \u201c #{s}\u201c</code> or better yet <code>&quot;#{ s unless s == &#39;e&#39;}&quot;</code> assuming no <code>nil</code> elements or empty strings"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1554916526, "last_edit_date": 1554916526, "creation_date": 1554916199, "answer_id": 55617980, "question_id": 55616288, "link": "https://stackoverflow.com/questions/55616288/ruby-sorting-except-one-element/55617980#55617980", "title": "Ruby: Sorting except one element", "body": "<pre><code>[\"b\", \"e\", \"f\", \"t\", \"g\"] .sort_by { |s| [s == 'e' ? 0 : 1, s] }\n  #=&gt; [\"e\", \"b\", \"f\", \"g\", \"t\"] \n</code></pre>\n\n<p>Here <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a> uses <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Array#&lt;=></a> to compare each pair of elements computed by the block, such as <code>[0, \"e\"]</code> and <code>[1, \"b\"]</code>. See the third paragraph of the doc for <code>Array#&lt;=&gt;</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1554926591, "post_id": 55618434, "comment_id": 97933954, "body": "Good idea with <code>partition</code>! Also <code>arr.sort.partition {|e| e == &#39;e&#39;}.flatten</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1554928341, "post_id": 55618434, "comment_id": 97934723, "body": "@iGian worth adding for sure"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1554928330, "last_edit_date": 1554928330, "creation_date": 1554917916, "answer_id": 55618434, "question_id": 55616288, "link": "https://stackoverflow.com/questions/55616288/ruby-sorting-except-one-element/55618434#55618434", "title": "Ruby: Sorting except one element", "body": "<p>You could partition the <code>Array</code> into all the \"e\"'s and all the not \"e\"'s then reduce them back together like so </p>\n\n<pre><code>  arr = [\"b\", \"e\", \"f\", \"t\", \"e\",\"g\"]\n  arr.partition {|e| e == 'e'}.reduce {|e,not_e| e.concat(not_e.sort)}\n  #=&gt; [\"e\", \"e\", \"b\", \"f\", \"g\", \"t\"]    \n</code></pre>\n\n<p>Additional credit to <a href=\"https://stackoverflow.com/users/5239030/igian\">@iGian</a> for </p>\n\n<pre><code>  arr.sort.partition {|e| e == 'e'}.flatten\n  #=&gt; [\"e\", \"e\", \"b\", \"f\", \"g\", \"t\"]    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 11094356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36488439a836bc8c5969bdac74e8aa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragya Sriharsh", "link": "https://stackoverflow.com/users/11094356/pragya-sriharsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1554919329, "creation_date": 1554919329, "answer_id": 55618753, "question_id": 55616288, "link": "https://stackoverflow.com/questions/55616288/ruby-sorting-except-one-element/55618753#55618753", "title": "Ruby: Sorting except one element", "body": "<p>You can try this: </p>\n\n<pre><code> arr.sort.reject{|x| x==\"e\"}.unshift('e')\n</code></pre>\n\n<p>If you have more than \"e\" in the array then it will ignore all 'e'.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1554926982, "last_edit_date": 1554926982, "creation_date": 1554926321, "answer_id": 55620439, "question_id": 55616288, "link": "https://stackoverflow.com/questions/55616288/ruby-sorting-except-one-element/55620439#55620439", "title": "Ruby: Sorting except one element", "body": "<p>Just to add one option more, converting to an Hash:</p>\n\n<pre><code>ary = [:b, :e, :f, :t, :g, :e]\nary.sort.group_by(&amp;:itself).then { |h| h.delete(:e) + h.values.flatten }\n</code></pre>\n\n<p>It returns the array keeping all <code>:e</code> in front. <code>:e</code> must exist.</p>\n\n<pre><code>#=&gt; [:e, :e, :b, :f, :g, :t]\n</code></pre>\n\n<p>The first part is returning the sorted grouping hash:</p>\n\n<pre><code>ary.sort.group_by(&amp;:itself) #=&gt; {:b=&gt;[:b], :e=&gt;[:e, :e], :f=&gt;[:f], :g=&gt;[:g], :t=&gt;[:t]}\n</code></pre>\n\n<p><hr>\nFor the method to work even <strong>when <code>:e</code> is not present</strong>:</p>\n\n<pre><code>ary.sort.group_by(&amp;:itself).then { |h| h.delete(:e).to_a + h.values.flatten }\n</code></pre>\n\n<p>Since <code>nil.to_a #=&gt; []</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11113981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1554928330, "creation_date": 1554910067, "question_id": 55616288, "link": "https://stackoverflow.com/questions/55616288/ruby-sorting-except-one-element", "title": "Ruby: Sorting except one element", "body": "<p>I am trying to sort string elements in array. Let's say I want to sort it [b, e, f, t, g], but want to keep e in first in ruby. So the result should be [e, b, f, g, t]. How can I write a code in ruby that sort the array that way.</p>\n"}, {"tags": ["ruby", "api", "exception", "grape"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554916395, "post_id": 55614530, "comment_id": 97929246, "body": "The documentation you linked shows where you inject it. Do so inside your class which inherits from <code>Grape::API</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1554917058, "last_edit_date": 1554917058, "creation_date": 1554916402, "answer_id": 55618038, "question_id": 55614530, "link": "https://stackoverflow.com/questions/55614530/is-there-a-way-using-grape-to-trap-all-exceptions-within-the-api-instead-of-show/55618038#55618038", "title": "Is there a way using GRAPE to trap all exceptions within the API instead of showing HTML error page", "body": "<blockquote>\n  <p>not sure where to inject the ApiErrorHandler</p>\n</blockquote>\n\n<p>In your Grape controller:</p>\n\n<pre><code>require 'api_error_handler'\n\nclass Api_v1 &lt; Grape::API\n  prefix 'api'\n  version 'v1'\n\n  use ApiErrorHandler\n\n  ...\nend\n</code></pre>\n\n<p>Code example from an <a href=\"https://code.dblock.org/2011/05/04/grape-trapping-all-exceptions-within-the-api.html\" rel=\"nofollow noreferrer\"><code>article</code></a> you linked</p>\n\n<hr>\n\n<p>Or you can catch exceptions in helper method. Something like:</p>\n\n<pre><code>module ActionsHelper\n  extend Grape::API::Helpers\n\n  def request_with_error_handling(options = { status: 422 }, &amp;block)\n    raise ArgumentError, 'Options are nil' if options.nil?\n    raise ArgumentError, 'No block given' unless block_given?\n\n    yield\n\n    rescue Mongoid::Errors::Validations =&gt; ex\n      error! ex.message\n    rescue ArgumentError =&gt; ex\n      error! ex.message\n  end\nend\n\n# users as an example\nclass Users &lt; Grape::API\n  namespace :users do\n    helpers ActionsHelper\n\n    desc 'Create new user'\n    params do\n      # user params\n    end\n    post '/' do\n      request_with_error_handling do\n        # your user creation logic here\n        # any exception would be catched \n        # in request_with_error_handling helper method\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2405, "user_id": 3704713, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c169cba3cd10f9bd85d65d5dc15630c?s=128&d=identicon&r=PG&f=1", "display_name": "MikeWu", "link": "https://stackoverflow.com/users/3704713/mikewu"}, "is_accepted": false, "score": 0, "last_activity_date": 1554923469, "creation_date": 1554923469, "answer_id": 55619771, "question_id": 55614530, "link": "https://stackoverflow.com/questions/55614530/is-there-a-way-using-grape-to-trap-all-exceptions-within-the-api-instead-of-show/55619771#55619771", "title": "Is there a way using GRAPE to trap all exceptions within the API instead of showing HTML error page", "body": "<p>I'm not sure if this will work with your setup, but Grape has built in way of doing this kind of thing.  From the documentation: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Twitter::API &lt; Grape::API\n  rescue_from ArgumentError do |e|\n    Rack::Response.new([ \"ArgumentError: #{e.message}\" ], 500).finish\n  end\n  rescue_from NotImplementedError do |e|\n    Rack::Response.new([ \"NotImplementedError: #{e.message}\" ], 500).finish\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11340675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46c985e904a329b454ee609916b818e?s=128&d=identicon&r=PG&f=1", "display_name": "Japs", "link": "https://stackoverflow.com/users/11340675/japs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554923469, "creation_date": 1554904913, "last_edit_date": 1554905241, "question_id": 55614530, "link": "https://stackoverflow.com/questions/55614530/is-there-a-way-using-grape-to-trap-all-exceptions-within-the-api-instead-of-show", "title": "Is there a way using GRAPE to trap all exceptions within the API instead of showing HTML error page", "body": "<p>We are using Grape to provide a API; the API raises exceptions in a lot of places randomly because of insufficient parameters, nils etc. This causes Rails to produce an HTML error page. \nIs there a way to control this and wrap all calls to return an error message instead?</p>\n\n<p>We are using </p>\n\n<h1>API</h1>\n\n<pre><code>gem 'grape', '0.9'\ngem 'grape-swagger', '0.8.0'\ngem 'grape-swagger-rails'\n</code></pre>\n\n<p>For example:\nif any error occurs in the API, it does not reach </p>\n\n<pre><code>rescue ArgumentError =&gt; ex\n    error! ex.message\nrescue Mongoid::Errors::Validations =&gt; ex\n    error! ex.message\n</code></pre>\n\n<p>of the API method.\nWe need a way to catch exact error message bypassing the HTML error page.</p>\n\n<p>Already tried this </p>\n\n<blockquote>\n  <p><a href=\"https://code.dblock.org/2011/05/04/grape-trapping-all-exceptions-within-the-api.html\" rel=\"nofollow noreferrer\">https://code.dblock.org/2011/05/04/grape-trapping-all-exceptions-within-the-api.html</a></p>\n</blockquote>\n\n<p>not sure where to inject the ApiErrorHandler .</p>\n\n<p>Expected results should be <strong>\"result: xyz error message\"</strong></p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1554890356, "post_id": 55609698, "comment_id": 97913977, "body": "What do you consider a &quot;word&quot;? I see you added a dot and an underscore. If you consider words to be lowercase letter chunks, try <code>&#47;\\A\\p{Lu}\\p{Ll}*(?:\\s\\p{Ll}+)*[.?!]\\z&#47;</code>"}, {"owner": {"reputation": 121, "user_id": 2725401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/XIKGA.png?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2725401/neil"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1554890614, "post_id": 55609698, "comment_id": 97914151, "body": "yes so all other characters must be lowercase letters, separators(, ; :) or terminal marks(, ? !)"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1554891221, "post_id": 55609698, "comment_id": 97914516, "body": "Could you clarify? Do you want to allow any punctuation (but final) before a whitespace? <code>&#47;\\A\\p{Lu}\\p{Ll}*(?:[\\p{P}&amp;&amp;[^?!.]]?\\s\\p{Ll}+)*[.?!]\\z&#47;</code>? See <a href=\"https://rubular.com/r/MlD0EZI5w8ak6C\" rel=\"nofollow noreferrer\">rubular.com/r/MlD0EZI5w8ak6C</a>"}, {"owner": {"reputation": 121, "user_id": 2725401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/XIKGA.png?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2725401/neil"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1554891347, "post_id": 55609698, "comment_id": 97914583, "body": "yes to allow punctuation  , ; : or terminal marks . ? !"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1554891464, "post_id": 55609698, "comment_id": 97914651, "body": "Does my regex above work as expected? If you need to only support <code>,</code>, <code>;</code>, or <code>:</code> replace <code>[\\p{P}&amp;&amp;[^?!.]]</code> with <code>[,;:]</code>. See <a href=\"https://rubular.com/r/MkfFz5uvnGhYY7\" rel=\"nofollow noreferrer\">rubular.com/r/MkfFz5uvnGhYY7</a>"}, {"owner": {"reputation": 121, "user_id": 2725401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/XIKGA.png?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2725401/neil"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1554891965, "post_id": 55609698, "comment_id": 97914912, "body": "what does \\p{Lu}\\p{Ll} mean?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1554892117, "post_id": 55609698, "comment_id": 97915001, "body": "<code>\\p{Lu}</code> - uppercase letter, <code>\\p{Ll}</code> - lowercase letter."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554892568, "post_id": 55609698, "comment_id": 97915262, "body": "Neil, the four rules in your question are unambiguous but  with what you&#39;ve written in comments above. Also, what is a &quot;valid&quot; capital letter?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554893124, "post_id": 55609698, "comment_id": 97915577, "body": "@CarySwoveland What is ambiguous is the <code>[a-z0-9_.]</code> in the original regex that does not meet the verbal requirements."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1554907430, "post_id": 55609698, "comment_id": 97924278, "body": "@Wiktor, as that is part of  the OP&#39;s failed attempt to solve the problem, I gave it no weight in parsing the question, especially because the itemised list of requirements is unambiguous."}], "answers": [{"comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1554917392, "post_id": 55612656, "comment_id": 97929741, "body": "I&#39;m not sure why I got the downvote, but if someone wants to chime in and provide an explanation that would be great. My original answer didn&#39;t include a full solution because the OP&#39;s criteria &amp; regex don&#39;t match up (regex allows for integers and underscores, but says letters only). It&#39;s pretty obvious to me that this is a learning exercise and that they&#39;re not trying parse a sentence with limited regex. Hence, I&#39;m not trying to go beyond the problem, just provide enough nudge in the right direction rather than flood them with more complex regex solutions to address criteria not stated"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": -1, "last_activity_date": 1554917131, "last_edit_date": 1554917131, "creation_date": 1554899531, "answer_id": 55612656, "question_id": 55609698, "link": "https://stackoverflow.com/questions/55609698/ruby-regex-to-check-for-a-valid-sentence/55612656#55612656", "title": "ruby regex to check for a valid sentence", "body": "<p>Your regex is only checking for a capital letter, followed immediately by lowercase letter/number/underscore/any character, followed by a space.</p>\n\n<p>You need something that allows for multiple values after the first that meet your criteria. You can use a <code>+</code> for this</p>\n\n<p>Here's a sample that meets your test criteria. It doesn't meet your full set of rules, however.</p>\n\n<pre><code>def sentence?(sentence)\n  sentence = sentence.strip\n\n  if sentence =~ /^[A-Z][a-z0-9_. ]+[\\.?!]$/\n    puts \"  Correct &gt;&gt;&gt; \" + sentence + \" &lt;&lt;&lt; Is a valid sentence!\"\n  else\n    puts \"INCORRECT &gt;&gt;&gt; \" + sentence + \" Is NOT a valid sentence \"\n  end\nend\n\nsentence?('Hello!') # valid\nsentence?('hello!') # not valid\nsentence?('HHello!') # not valid\nsentence?('HeLlo!') # not valid\n</code></pre>\n\n<p>You can use <a href=\"https://rubular.com/r/7xv7erPhXZIQr3\" rel=\"nofollow noreferrer\">rubular</a> to see how the regex captures various sentences/phrases</p>\n\n<p>Here's something that meets the criteria you described</p>\n\n<pre><code>def real_sentence?(sentence)\n  sentence = sentence.strip\n\n  if sentence =~ /^[A-Z][a-z]+(\\s[a-z]+){0,}[?!\\.]$/\n    puts \"  Correct &gt;&gt;&gt; \" + sentence + \" &lt;&lt;&lt; Is a valid sentence!\"\n  else\n    puts \"INCORRECT &gt;&gt;&gt; \" + sentence + \" Is NOT a valid sentence \"\n  end\nend\n\nreal_sentence?('Hello how are you John?!') # not valid\nreal_sentence?('hello how are you?') # not valid\nreal_sentence?('Hello!') # valid\nreal_sentence?('Hello how are you?') # valid\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2725401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/XIKGA.png?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2725401/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554917131, "creation_date": 1554890144, "question_id": 55609698, "link": "https://stackoverflow.com/questions/55609698/ruby-regex-to-check-for-a-valid-sentence", "title": "ruby regex to check for a valid sentence", "body": "<p>I'm creating a basic sentence checker that takes a string and determines whether it is valid or not using the following rules </p>\n\n<ol>\n<li>The sentence must start with a valid capital letter followed by a lowercase letter</li>\n<li>All other characters must be lowercase letters</li>\n<li>There must be a single space between each word</li>\n<li>The sentence must end with a  terminal mark . or ? or !</li>\n</ol>\n\n<p>I've tried the following code - which covers 1 , 4.  But 2 works  only after the first character </p>\n\n<pre><code>puts \"Enter your sentence: \" \nsentence = gets.chomp\n\n    if (sentence =~ /^[A-Z][a-z0-9_.]\\s/ &amp;&amp; sentence.end_with?('.','?','!')) \n        puts \"Correct &gt;&gt;&gt; \" + sentence + \" &lt;&lt;&lt; Is a valid sentence!\"\n    else \n        puts \"Incorrect &gt;&gt;&gt;  \" + sentence + \" Is NOT a valid sentence \"\n    end\n</code></pre>\n\n<p>Expected result</p>\n\n<p>Enter your sentence: \nHello!\nCorrect >>> Hello! &lt;&lt;&lt; Is a valid sentence!</p>\n\n<p>Enter your sentence: \nhello!\nIncorrect >>>  hello! Is NOT a valid sentence </p>\n\n<p>Enter your sentence: \nHHello!\nIncorrect >>>  HHello! Is NOT a valid sentence </p>\n\n<p>Unexpected result \nHeLlo!\nCorrect >>> HeLlo! &lt;&lt;&lt; Is a valid sentence!</p>\n\n<p>For single space between each word using \\s but it allows more than one space</p>\n"}, {"tags": ["ruby", "docker"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11755726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ad8a5bd89be1808dba93ac8709a9f5?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Duffield", "link": "https://stackoverflow.com/users/11755726/tom-duffield"}, "is_accepted": false, "score": -1, "last_activity_date": 1562621893, "creation_date": 1562621893, "answer_id": 56942863, "question_id": 55609071, "link": "https://stackoverflow.com/questions/55609071/docker-volume-mounting-issues-with-ruby/56942863#56942863", "title": "Docker Volume Mounting issues with Ruby", "body": "<p>I tried for several days and the only solution I was able to find to this problem was to use ltsc2019. </p>\n"}], "owner": {"reputation": 763, "user_id": 5986227, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-R58sngDauK0/AAAAAAAAAAI/AAAAAAAAB_0/pzxD2AYGNQA/photo.jpg?sz=128", "display_name": "Chris Hopkins", "link": "https://stackoverflow.com/users/5986227/chris-hopkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562621893, "creation_date": 1554888197, "question_id": 55609071, "link": "https://stackoverflow.com/questions/55609071/docker-volume-mounting-issues-with-ruby", "title": "Docker Volume Mounting issues with Ruby", "body": "<p>I have a testcase where I am running an instance of Ruby inside a windows docker container. I should stress the ruby script works fine outside of docker. When run inside the docker container the script also works fine, except when the target of the Ruby file's access is on a mounted volume. In which case I get an error. I can for the testcase of course work around this issue by copying the file, but that would cause complications for the real script that found this problem.</p>\n\n<p>Here's an example transcript, cbh_test is the mounted volume</p>\n\n<pre><code>PS C:\\&gt; echo \"\"&gt; bob\nPS C:\\&gt; cp cbh_test\\failer.rb .\nPS C:\\&gt; C:\\Ruby25-x64\\bin\\ruby.exe .\\failer.rb\nPS C:\\&gt; cd cbh_test\nPS C:\\cbh_test&gt; echo \"\"&gt; bob\nPS C:\\cbh_test&gt; C:\\Ruby25-x64\\bin\\ruby.exe .\\failer.rb\nTraceback (most recent call last):\n./failer.rb: Invalid argument @ rb_readlink - C:/cbh_test (Errno::EINVAL)\n</code></pre>\n\n<p>Docker instance invoked by:</p>\n\n<pre><code>docker run -it -v c:\\Users\\me\\work\\fred:c:\\cbh_test  bob/failer  powershell\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code># escape=`\nFROM microsoft/windowsservercore:ltsc2016\nSHELL [\"powershell\", \"-Command\", \"$ErrorActionPreference = 'Stop'; $ProgressPreference = 'SilentlyContinue';\"]\nCOPY install_ruby.ps1 c:\nRUN powershell c:\\install_ruby.ps1\n</code></pre>\n\n<p>failer.rb:</p>\n\n<pre><code>def main(args)\n    fragment = \"bob\"\n    $tmp = File.open(File.join(File.dirname(__FILE__), fragment), 'r+').read      \nend\nmain($ARGV)\n</code></pre>\n\n<p>install_ruby.ps:</p>\n\n<pre><code>$RUBY_VERSION = \"2.5.3-1\"\n$RUBY_RELEASE =  \"2.5.3-1\"\n\n\n$url = ('https://github.com/oneclick/rubyinstaller2/releases/download/rubyinstaller-{0}/rubyinstaller-{1}-x64.exe'-f $RUBY_VERSION, $RUBY_RELEASE);\n$exe = \"ruby-install.exe\"\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;\nInvoke-WebRequest -Uri $url -OutFile $exe; \n$args = \"/silent /tasks='assocfiles,modpath'\"\nStart-Process -FilePath $exe -ArgumentList $args -PassThru -Wait \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1554882101, "post_id": 55607183, "comment_id": 97909101, "body": "It&#39;s not pipeline, it&#39;s logical OR, it works similarily to most other programming languages."}, {"owner": {"reputation": 31, "user_id": 11175292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5d3ac57f47b7b35ea640b2eb397f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay Sharma", "link": "https://stackoverflow.com/users/11175292/vijay-sharma"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1554882200, "post_id": 55607183, "comment_id": 97909153, "body": "Can you explain this code how the values in hash are getting stored"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1554882349, "post_id": 55607183, "comment_id": 97909227, "body": "@VijaySharma: it may help understanding if you &quot;uncompress&quot; that line into 3-4 lines (by extracting variables). But first, read up on that logical OR and how it works in ruby (truthy/falsey values)"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554886024, "post_id": 55607468, "comment_id": 97911238, "body": "<code>Hash.new { Array.new }</code> - careful with that, though, it&#39;s a trap :)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554886221, "post_id": 55607468, "comment_id": 97911349, "body": "What do you mean? I would have said that to <code>Hash.new(Array.new)</code> :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554886448, "post_id": 55607468, "comment_id": 97911480, "body": "That too, but this one is worse. :) Doesn&#39;t persist <i>anything</i> without an explicit <code>[]=</code>. <a href=\"https://eval.in/1093640\" rel=\"nofollow noreferrer\">eval.in/1093640</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554886585, "post_id": 55607468, "comment_id": 97911563, "body": "no-no, here it works out fine, because of <code>Hash#merge</code>. But one must keep an eye out, is all I&#39;m saying :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1554885558, "last_edit_date": 1554885558, "creation_date": 1554882956, "answer_id": 55607468, "question_id": 55607183, "link": "https://stackoverflow.com/questions/55607183/can-someone-please-explain-use-of-each-with-index-reduce-select-chained-in-the/55607468#55607468", "title": "Can someone please explain use of each_with_index, reduce, select chained in the code along with OR (||)?", "body": "<p>I'd rewrite it this way</p>\n\n<pre><code>array.each_with_index.reduce(Hash.new { Array.new }) do |hash, (item, index)|\n  hash.merge(item =&gt; hash[item] &lt;&lt; index)\nend.select { |_, indexes| indexes.size &gt; 1 }\n</code></pre>\n\n<ul>\n<li>We use <a href=\"https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-each_with_index\" rel=\"nofollow noreferrer\"><code>each_with_index</code></a> because we want to access the index while looping the array. You can see it later next to item as a parameter in the <code>reduce</code>'s block.</li>\n<li><a href=\"https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>reduce</code></a> permits us to \"transform\" a collection in something else. In our case we want to construct an hash out of an array. </li>\n<li>In the <code>reduce</code>'s block we add the current index to the key value pair for the current item. I used <a href=\"https://ruby-doc.org/core-2.5.3/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\"><code>merge</code></a> to do it in just one expression (update the hash and using it as an expression to return).</li>\n<li>In the end, we keep just the key value pairs whose values (and those are arrays) have more than one elements. Note that we don't care about keys here so I called the key parameter <code>_</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554885022, "post_id": 55607473, "comment_id": 97910662, "body": "&quot;and additionally the index gets added to this array&quot; - and this array is saved back to the hash. I think being extra verbose would not hurt in this case :)"}], "tags": [], "owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "is_accepted": false, "score": 0, "last_activity_date": 1554882971, "creation_date": 1554882971, "answer_id": 55607473, "question_id": 55607183, "link": "https://stackoverflow.com/questions/55607183/can-someone-please-explain-use-of-each-with-index-reduce-select-chained-in-the/55607473#55607473", "title": "Can someone please explain use of each_with_index, reduce, select chained in the code along with OR (||)?", "body": "<pre><code>array = [1, 2, 3, 4, 5, 3, 6, 7, 2, 8, 1, 9]\n\narray.each_with_index.reduce({}) do |hash, (item, index)|\n  hash[item] = (hash[item] || []) &lt;&lt; index\n  hash\nend.select do |key, value|\n  value.size &gt; 1\nend\n</code></pre>\n\n<p>First of all cleaner way of writing Enumerators single line are enclosed with <code>{}</code> and multiline with <code>do; end</code>.</p>\n\n<pre><code>array.each_with_index.reduce({}) do |hash, (item, index)|\n  # hash[item] gets either itself and if itself is nil it gets an empty \n  # array assigned and additionally the index gets added to this array \n  hash[item] = (hash[item] || []) &lt;&lt; index\n  # return the hash for the reduce enumerator\n  hash\nend\n</code></pre>\n\n<p>In this part you iterate over the array and pass in the initial empty hash with <code>.reduce({})</code>. The hash then gets transformed and returned in L3 in the \"loop\" and passed into the next iteration of the <code>reduce</code>. Your result then is the build up <code>hash</code> which then immediately get enumerated with <code>select</code> where only key value pairs get returned that have a value size larger than 1.</p>\n\n<p>Best would be to readup on <a href=\"https://ruby-doc.org/core-2.4.0/Enumerable.html#inject-method\" rel=\"nofollow noreferrer\">Enumerators#reduce</a> and how the objects are passed into the \"loop\".</p>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": -1, "last_activity_date": 1554893439, "last_edit_date": 1554893439, "creation_date": 1554883360, "answer_id": 55607584, "question_id": 55607183, "link": "https://stackoverflow.com/questions/55607183/can-someone-please-explain-use-of-each-with-index-reduce-select-chained-in-the/55607584#55607584", "title": "Can someone please explain use of each_with_index, reduce, select chained in the code along with OR (||)?", "body": "<p><code>hash[item]</code> is <code>nil</code> at first. <code>nil || [] =&gt; []</code>, so <code>hash[item]</code> become array. <code>&lt;&lt;</code> push an item into array.</p>\n\n<p>hope this can help you understand how hash store the value</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"pp\"\nhash = {}\npp hash[1] # =&gt; nil \npp hash[1] || [] # =&gt; []\npp (hash[1] || []) &lt;&lt; 1 # =&gt; [1]\npp hash[1] # =&gt; nil\nhash[1] = (hash[1] || []) &lt;&lt; 1\npp hash[1] # =&gt; [1]\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11175292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5d3ac57f47b7b35ea640b2eb397f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay Sharma", "link": "https://stackoverflow.com/users/11175292/vijay-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 3, "score": -7, "last_activity_date": 1554902395, "creation_date": 1554881913, "last_edit_date": 1554902395, "question_id": 55607183, "link": "https://stackoverflow.com/questions/55607183/can-someone-please-explain-use-of-each-with-index-reduce-select-chained-in-the", "title": "Can someone please explain use of each_with_index, reduce, select chained in the code along with OR (||)?", "body": "<p>Can someone explain this code to me? What does the <code>||</code> syntax mean and how does it work?</p>\n\n<pre><code>array = [1, 2, 3, 4, 5, 3, 6, 7, 2, 8, 1, 9]\n\narray.each_with_index.reduce({}) { |hash, (item, index)|\n  hash[item] = (hash[item] || []) &lt;&lt; index\n  hash\n}.select{ |key, value| value.size &gt; 1 }\n</code></pre>\n"}, {"tags": ["ruby", "openssl"], "comments": [{"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554883534, "post_id": 55606510, "comment_id": 97909879, "body": "is the URL an &quot;https&quot; URL?"}, {"owner": {"reputation": 27, "user_id": 7089407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c8918d1abeb3b41845e6ff8adcd5db?s=128&d=identicon&r=PG&f=1", "display_name": "shivakumar", "link": "https://stackoverflow.com/users/7089407/shivakumar"}, "reply_to_user": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554885714, "post_id": 55606510, "comment_id": 97911058, "body": "yes, it is being decided by the following line of code.     scheme          = self.ssl ? &quot;https&quot; : &quot;http&quot;     url             = &quot;#{scheme}://#{host}:#{port}/#{uri}&quot;"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1554902762, "post_id": 55606510, "comment_id": 97921348, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5711190/how-to-get-rid-of-opensslsslsslerror\">How to get rid of OpenSSL::SSL::SSLError</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7089407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c8918d1abeb3b41845e6ff8adcd5db?s=128&d=identicon&r=PG&f=1", "display_name": "shivakumar", "link": "https://stackoverflow.com/users/7089407/shivakumar"}, "edited": false, "score": 0, "creation_date": 1554971405, "post_id": 55614385, "comment_id": 97947691, "body": "i used &quot;reposne = RestClient::Request.execute&quot; it worked. Thanks."}], "tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": true, "score": 0, "last_activity_date": 1554904499, "creation_date": 1554904499, "answer_id": 55614385, "question_id": 55606510, "link": "https://stackoverflow.com/questions/55606510/post-connection-check-hostname-ip-does-not-match-the-server-certificate-ope/55614385#55614385", "title": "post_connection_check&#39;: hostname &quot;ip&quot; does not match the server certificate (OpenSSL::SSL::SSLError)", "body": "<p><code>hostname \"ip\" does not match the server certificate (OpenSSL::SSL::SSLError)</code> means that the server certificate validation has some issue. </p>\n\n<p>Depending on your situation, it can be OK to ignore it or not. In case you want to ignore it (note: insecure), use</p>\n\n<pre><code>response = RestClient.execute(method: :post, \n                              url: url, \n                              payload: data, \n                              verify_ssl: false, \n                              headers: { content_type: ctype })\n</code></pre>\n\n<p>See <a href=\"https://github.com/rest-client/rest-client/issues/288\" rel=\"nofollow noreferrer\">https://github.com/rest-client/rest-client/issues/288</a></p>\n"}], "owner": {"reputation": 27, "user_id": 7089407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c8918d1abeb3b41845e6ff8adcd5db?s=128&d=identicon&r=PG&f=1", "display_name": "shivakumar", "link": "https://stackoverflow.com/users/7089407/shivakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 55614385, "answer_count": 1, "score": 0, "last_activity_date": 1554904499, "creation_date": 1554879558, "question_id": 55606510, "link": "https://stackoverflow.com/questions/55606510/post-connection-check-hostname-ip-does-not-match-the-server-certificate-ope", "title": "post_connection_check&#39;: hostname &quot;ip&quot; does not match the server certificate (OpenSSL::SSL::SSLError)", "body": "<p>I tried to connect to remote server using REST method, in ruby I'm getting error as </p>\n\n<pre><code>/usr/lib/ruby/2.3.0/openssl/ssl.rb:315:in `post_connection_check': hostname \"ip\" does not match the server certificate (OpenSSL::SSL::SSLError)\n        from /usr/lib/ruby/2.3.0/net/http.rb:944:in `connect'\n        from /usr/lib/ruby/2.3.0/net/http.rb:863:in `do_start'\n        from /usr/lib/ruby/2.3.0/net/http.rb:852:in `start'\n        from /var/lib/gems/2.3.0/gems/rest-client-2.0.2/lib/restclient/request.rb:715:in `transmit'\n        from /var/lib/gems/2.3.0/gems/rest-client-2.0.2/lib/restclient/request.rb:145:in `execute'\n        from /var/lib/gems/2.3.0/gems/rest-client-2.0.2/lib/restclient/request.rb:52:in `execute'\n        from /var/lib/gems/2.3.0/gems/rest-client-2.0.2/lib/restclient.rb:71:in `post'\n</code></pre>\n\n<p>this error occurred from the below line of code </p>\n\n<pre><code>\nrequire 'rest-client'\n\nresponse        = RestClient.post(url, data, content_type: ctype)\n</code></pre>\n\n<p>I tried connecting to server using the openssl from command line as follows\nI was able to connect to the server</p>\n\n<pre><code>openssl s_client -connect ip:port \n</code></pre>\n\n<p>How to solve this error as I am using ruby only. ( not rails )\nplease help me. Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 329, "user_id": 4112224, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh5.googleusercontent.com/-hFw5rXmfl5Q/AAAAAAAAAAI/AAAAAAAAADk/xZAkY0JoWwE/photo.jpg?sz=128", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/4112224/peter-nguyen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554872278, "post_id": 55604630, "comment_id": 97905065, "body": "I updated the question. &quot;... Do you mean you want to minimise the difference between the largest and smallest? If so, you need to say that....&quot; ==&gt; Yes! That&#39;s exactly what I want."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1554872306, "post_id": 55604630, "comment_id": 97905077, "body": "It feels to me like this is an NP-complete problem. I am not sure if it is just a variant of <a href=\"https://en.wikipedia.org/wiki/Knapsack_problem\" rel=\"nofollow noreferrer\">the knapsack problem</a>. Or if it is special enough to have its own name. You might want to look through an of famous problems of combinatorial optimization."}, {"owner": {"reputation": 329, "user_id": 4112224, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh5.googleusercontent.com/-hFw5rXmfl5Q/AAAAAAAAAAI/AAAAAAAAADk/xZAkY0JoWwE/photo.jpg?sz=128", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/4112224/peter-nguyen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554872873, "post_id": 55604630, "comment_id": 97905201, "body": "@CarySwoveland I already wrote it in the question at &quot;...I have found a way to solve this problem...&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1656, "user_id": 6138119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YzV7y.jpg?s=128&g=1", "display_name": "Pravesh Khatri", "link": "https://stackoverflow.com/users/6138119/pravesh-khatri"}, "is_accepted": false, "score": 1, "last_activity_date": 1554872025, "creation_date": 1554872025, "answer_id": 55604943, "question_id": 55604630, "link": "https://stackoverflow.com/questions/55604630/how-to-divide-all-members-into-individual-fair-teams-based-on-their-ratings/55604943#55604943", "title": "How to divide all members into individual fair teams based on their ratings?", "body": "<p>We can solve it sorting the hash by rating as key</p>\n\n<pre><code>players.sort_by { |k| k[:rating] }\n</code></pre>\n\n<p>Now when you have sorted array.</p>\n\n<p>You can iterate upto half of length of the array, and push <code>i</code> element and <code>length-i</code> element in one team in this case you have 4 teams.  </p>\n\n<pre><code>def divide_teams players\n   players = players.sort_by { |k| k[:rating] } # sorted\n   len = players.length\n   teams = Hash.new(0)\n   (len/2).times do |i|\n      teams[\"team#{i+1}\"] = [players[i], players[len-i-1]]\n   end\n   teams\nend\n\ndivide_teams players\n\n=&gt; {\"team1\"=&gt;[{:name=&gt;\"Qasim\", :rating=&gt;1}, {:name=&gt;\"Kaka\", :rating=&gt;20}],\n \"team2\"=&gt;[{:name=&gt;\"Usama\", :rating=&gt;2}, {:name=&gt;\"Owen\", :rating=&gt;15}],\n \"team3\"=&gt;[{:name=&gt;\"Aj\", :rating=&gt;3}, {:name=&gt;\"Bilal\", :rating=&gt;8}],\n \"team4\"=&gt;[{:name=&gt;\"Osman\", :rating=&gt;6}, {:name=&gt;\"Mahsam\", :rating=&gt;7}]}\n</code></pre>\n\n<p>Right now, I have assumed, 4 teams and in each team there are 2 member.</p>\n\n<p>you can change the function according to your need, if function teams is a dynamic variable.</p>\n\n<p>Thanks.</p>\n"}, {"comments": [{"owner": {"reputation": 329, "user_id": 4112224, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh5.googleusercontent.com/-hFw5rXmfl5Q/AAAAAAAAAAI/AAAAAAAAADk/xZAkY0JoWwE/photo.jpg?sz=128", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/4112224/peter-nguyen"}, "edited": false, "score": 0, "creation_date": 1554881202, "post_id": 55605406, "comment_id": 97908611, "body": "Since the algorithm ( that I have found ) is not a perfect one, but the result is still acceptable. Anyway, your answer is the most accurate of what I need. Thanks for the detail explanation too ;-)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1554877588, "last_edit_date": 1554877588, "creation_date": 1554874811, "answer_id": 55605406, "question_id": 55604630, "link": "https://stackoverflow.com/questions/55604630/how-to-divide-all-members-into-individual-fair-teams-based-on-their-ratings/55605406#55605406", "title": "How to divide all members into individual fair teams based on their ratings?", "body": "<p>You can implement the assignment algorithm you describe as follows.</p>\n\n<pre><code>def assign(nbr_teams, players)\n  flip = [true, false].cycle\n  players.\n    sort_by { |p| p[:rating] }.\n    each_slice(nbr_teams).\n    map { |a| flip.next ? a.reverse : a }.\n    transpose\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>assign(4, players)\n  #=&gt; [[{:name=&gt;\"Osman\",  :rating=&gt;6}, {:name=&gt;\"Mahsam\", :rating=&gt;7}],\n  #    [{:name=&gt;\"Aj\",     :rating=&gt;3}, {:name=&gt;\"Bilal\",  :rating=&gt;8}],\n  #    [{:name=&gt;\"Usama\",  :rating=&gt;2}, {:name=&gt;\"Owen\",   :rating=&gt;15}],\n  #    [{:name=&gt;\"Qasim\",  :rating=&gt;1}, {:name=&gt;\"Kaka\",   :rating=&gt;20}]] \n</code></pre>\n\n<p>The assignments would be as follows if there were 2 teams.</p>\n\n<pre><code>assign(2, players)\n  #=&gt; [[{:name=&gt;\"Usama\",  :rating=&gt;2}, {:name=&gt;\"Aj\",     :rating=&gt;3},\n  #     {:name=&gt;\"Bilal\",  :rating=&gt;8}, {:name=&gt;\"Owen\",   :rating=&gt;15}],\n  #    [{:name=&gt;\"Qasim\",  :rating=&gt;1}, {:name=&gt;\"Osman\",  :rating=&gt;6},\n  #     {:name=&gt;\"Mahsam\", :rating=&gt;7}, {:name=&gt;\"Kaka\",   :rating=&gt;20}]]\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>nbr_teams = 4\nflip = [true, false].cycle\n  #=&gt; #&lt;Enumerator: [true, false]:cycle&gt;\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-cycle\" rel=\"nofollow noreferrer\">Array#cycle</a> works like this: <code>flip.next #=&gt; true</code>, <code>flip.next #=&gt; false</code>, <code>flip.next #=&gt; true</code>, and so on. Continuing,</p>\n\n<pre><code>a = players.sort_by { |p| p[:rating] }\n  #=&gt; [{:name=&gt;\"Qasim\",  :rating=&gt;1},  {:name=&gt;\"Usama\", :rating=&gt;2},\n  #    {:name=&gt;\"Aj\",     :rating=&gt;3},  {:name=&gt;\"Osman\", :rating=&gt;6},\n  #    {:name=&gt;\"Mahsam\", :rating=&gt;7},  {:name=&gt;\"Bilal\", :rating=&gt;8},\n  #    {:name=&gt;\"Owen\",   :rating=&gt;15}, {:name=&gt;\"Kaka\", :rating=&gt;20}] \nb = a.each_slice(nbr_teams)\n  #=&gt; #&lt;Enumerator:\n  #     [{:name=&gt;\"Qasim\",  :rating=&gt;1},  {:name=&gt;\"Usama\", :rating=&gt;2},\n  #      {:name=&gt;\"Aj\",     :rating=&gt;3},  {:name=&gt;\"Osman\", :rating=&gt;6},\n  #      {:name=&gt;\"Mahsam\", :rating=&gt;7},  {:name=&gt;\"Bilal\", :rating=&gt;8},\n  #      {:name=&gt;\"Owen\",   :rating=&gt;15}, {:name=&gt;\"Kaka\",  :rating=&gt;20}]\n  #     :each_slice(4)&gt; \n</code></pre>\n\n<p>We can convert this enumerator to an array to see the objects it will generate and pass to <code>map</code>.</p>\n\n<pre><code>b.to_a\n  #=&gt; [[{:name=&gt;\"Qasim\",  :rating=&gt;1},  {:name=&gt;\"Usama\", :rating=&gt;2},\n  #     {:name=&gt;\"Aj\",     :rating=&gt;3},  {:name=&gt;\"Osman\", :rating=&gt;6}], \n  #    [{:name=&gt;\"Mahsam\", :rating=&gt;7},  {:name=&gt;\"Bilal\", :rating=&gt;8}, \n  #     {:name=&gt;\"Owen\",   :rating=&gt;15}, {:name=&gt;\"Kaka\",  :rating=&gt;20}]] \n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>c = b.map { |a| flip.next ? a.reverse : a }\n  #=&gt; [[{:name=&gt;\"Osman\",  :rating=&gt;6},  {:name=&gt;\"Aj\",    :rating=&gt;3},\n  #     {:name=&gt;\"Usama\",  :rating=&gt;2},  {:name=&gt;\"Qasim\", :rating=&gt;1}],\n  #    [{:name=&gt;\"Mahsam\", :rating=&gt;7},  {:name=&gt;\"Bilal\", :rating=&gt;8},\n  #     {:name=&gt;\"Owen\",   :rating=&gt;15}, {:name=&gt;\"Kaka\",  :rating=&gt;20}]] \nc.transpose\n  #=&gt; [[{:name=&gt;\"Osman\", :rating=&gt;6}, {:name=&gt;\"Mahsam\", :rating=&gt;7}],\n  #    [{:name=&gt;\"Aj\",    :rating=&gt;3}, {:name=&gt;\"Bilal\",  :rating=&gt;8}],\n  #    [{:name=&gt;\"Usama\", :rating=&gt;2}, {:name=&gt;\"Owen\",   :rating=&gt;15}],\n  #    [{:name=&gt;\"Qasim\", :rating=&gt;1}, {:name=&gt;\"Kaka\",   :rating=&gt;20}]] \n</code></pre>\n\n<p>It may be desirable to convert the results to an array of hashes.</p>\n\n<pre><code>assign(4, players).map { |a| a.map { |h| [h[:name], h[:rating]] }.to_h }\n  #=&gt; [{\"Osman\"=&gt;6, \"Mahsam\"=&gt;7},\n  #    {\"Aj\"   =&gt;3, \"Bilal\" =&gt;8},\n  #    {\"Usama\"=&gt;2, \"Owen\"  =&gt;15},\n  #    {\"Qasim\"=&gt;1, \"Kaka\"  =&gt;20}] \n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4112224, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh5.googleusercontent.com/-hFw5rXmfl5Q/AAAAAAAAAAI/AAAAAAAAADk/xZAkY0JoWwE/photo.jpg?sz=128", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/4112224/peter-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 55605406, "answer_count": 2, "score": 1, "last_activity_date": 1588517685, "creation_date": 1554869357, "last_edit_date": 1588517685, "question_id": 55604630, "link": "https://stackoverflow.com/questions/55604630/how-to-divide-all-members-into-individual-fair-teams-based-on-their-ratings", "title": "How to divide all members into individual fair teams based on their ratings?", "body": "<p>I want to divide players into individual fair teams based on their rating. For example, I have a list of players like this:</p>\n\n<pre><code>players = [{\n    name: \"Qasim\",\n    rating: 1\n  }, {\n    name: \"Mahsam\",\n    rating: 7\n  }, {\n    name: \"Aj\",\n    rating: 3\n  }, {\n    name: \"Osman\",\n    rating: 6\n  }, {\n    name: \"Usama\",\n    rating: 2\n  }, {\n    name: \"Bilal\",\n    rating: 8\n  }, {\n    name: \"Kaka\",\n    rating: 20\n  }, {\n    name: \"Owen\",\n    rating: 15\n  }\n]\n</code></pre>\n\n<p>I want to divide them into 4 teams with the best equally total scores and also equally in members like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Team A       Team B       Team C     Team D\n=======      =======      =======    =======\nKaka: 20     Owen: 15     Bilal: 8   Mahsam: 7\nQasim: 1     Usama: 2     Aj: 3      Osman: 6\n</code></pre>\n\n<p>I have found a way to solve this problem, but it's hard to turn it into ruby code. Assume we can have more than 8 players and the number of teams can vary from 2 to 4 teams.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>1. Sort all players by their ratings descendingly.\n2. Assign team A the best player.\n3. Assign team B the next best player.\n4. Assign team C the next best player.\n5. Assign team D the next best player.\n6. Assign team D the next best player.\n7. Assign team C the next best player.\n8. Assign team B the next best player.\n9. Assign team A the next best player.\n10. Go to 2\n11. End when we're out of players.\n</code></pre>\n\n<p>Actually the team can vary from 2 to 4 teams, all the players in each team must be equal and the total ratings of each team must be equal too or as close to equal as possible. </p>\n\n<p>The players can be any numbers and must be divisible by teams. </p>\n\n<p>For example, if 2 teams, the total players must be even. If 3 teams, the total players must be divisible by 3 and if 4 teams, the total players must be divisible by 4.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku", "heroku-postgres"], "comments": [{"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 1, "creation_date": 1554861056, "post_id": 55603264, "comment_id": 97902690, "body": "Is your timezone &quot;Eastern Time (US &amp; Canada)&quot;?"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1554863889, "post_id": 55603264, "comment_id": 97903228, "body": "timezone is a  <code>config.time_zone</code> setting in your <code>application.rb</code> or in your <code>production.rb</code> file. please look into that - make sure that it&#39;s set accordingly"}, {"owner": {"reputation": 37, "user_id": 3276058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H8LBK.png?s=128&g=1", "display_name": "joffet", "link": "https://stackoverflow.com/users/3276058/joffet"}, "edited": false, "score": 0, "creation_date": 1555016292, "post_id": 55603264, "comment_id": 97972628, "body": "Yes, app is in &quot;Eastern Time (US &amp; Canada)&quot;, specified in application.rb. The postgres db is also in Canada/Eastern (checked via SELECT current_setting(&#39;TIMEZONE&#39;) )"}], "owner": {"reputation": 37, "user_id": 3276058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H8LBK.png?s=128&g=1", "display_name": "joffet", "link": "https://stackoverflow.com/users/3276058/joffet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555019964, "creation_date": 1554857812, "last_edit_date": 1555019964, "question_id": 55603264, "link": "https://stackoverflow.com/questions/55603264/postgres-local-restore-of-heroku-backup-changes-datetime-fields-ahead-by-4-hours", "title": "Postgres local restore of Heroku backup changes datetime fields ahead by 4 hours", "body": "<p>I'm restoring a downloaded Heroku Postgres backup on my mac to do some testing. All of the datetime columns (in every model) have been moved ahead by 4 hours. Need to fix it.</p>\n\n<p>Seems like it must be a timezone issue, but my local server instance is on the same timezone as the Heroku instance. ( same Time.zone.to_s results in my local console and the Heroku console )</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT: I checked the Heroku postgres instance, and it's timezone is UTC (checked via SELECT current_setting('TIMEZONE')). The difference between the timezones of the postgres instances feels like the issue.</p>\n\n<p>I'm trying to set my local postgres instance to UTC, but it keeps flipping back to EDT.</p>\n\n<p>FIXED: In application.rb changed config.active_record.default_timezone = :utc from config.active_record.default_timezone = :local</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "edited": false, "score": 0, "creation_date": 1554856746, "post_id": 55603026, "comment_id": 97901854, "body": "What about <code>Mr. Smith</code> or <code>J. K. Rowling</code>?"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "edited": false, "score": 0, "creation_date": 1554857251, "post_id": 55603026, "comment_id": 97901950, "body": "@CAustin Those should be valid"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554859585, "post_id": 55603026, "comment_id": 97902409, "body": "@CarySwoveland I did see the other answer. Although the accepted one fails on <a href=\"https://rubular.com/r/NypFcxfbVkRn6T\" rel=\"nofollow noreferrer\">rubular</a> it is passing in my <a href=\"https://gist.github.com/antarr/b6b551ddafd8e6791deb9cd1c7869785\" rel=\"nofollow noreferrer\">specs</a>."}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554860320, "post_id": 55603026, "comment_id": 97902550, "body": "@CarySwoveland I may be changing the answer soon. There was a problem in my spec."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554858635, "post_id": 55603059, "comment_id": 97902216, "body": "That&#39;s not the regex at your link. Anchors? But what about <code>&quot;Mr. Smith&quot;</code>? (See comment on question.)"}], "tags": [], "owner": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "is_accepted": false, "score": 0, "last_activity_date": 1554856108, "creation_date": 1554856108, "answer_id": 55603059, "question_id": 55603026, "link": "https://stackoverflow.com/questions/55603026/update-regex-to-exclude-dots-followed-by-anything-but-a-whitespace/55603059#55603059", "title": "Update Regex to exclude dots followed by anything but a whitespace", "body": "<p>Then you just need to move the <code>.</code> to the end of your regex (and escape it) so that you still get people with <code>Jr.</code> at the end of their name:</p>\n\n<pre><code>/([A-Za-z ',-]+\\.?)/\n</code></pre>\n\n<p>And it should work fine. <a href=\"https://regex101.com/r/LkUl38/1\" rel=\"nofollow noreferrer\">Try it online!</a></p>\n\n<p>There are some <a href=\"https://regexone.com/\" rel=\"nofollow noreferrer\">great resources online</a> for learning Regex, if you're interested.</p>\n"}, {"comments": [{"owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554859957, "post_id": 55603402, "comment_id": 97902467, "body": "@CarySwoveland I&#39;m not sure if that&#39;s true. What if a period followed by a comma is valid, for example?"}, {"owner": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "edited": false, "score": 0, "creation_date": 1554861246, "post_id": 55603402, "comment_id": 97902740, "body": "@AntarrByrd - It sounds like you don&#39;t know what you want. Please edit your answer to include which category you expect each of these to be in: <code>P.A.</code>, <code>P.A</code>, <code>p.a.</code>, <code>pa.</code>, <code>p.a.</code> and <code>PA.</code>"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "edited": false, "score": 0, "creation_date": 1554861480, "post_id": 55603402, "comment_id": 97902789, "body": "@Addison Yeah, I realized that. That&#39;s why I removed the comment. I&#39;ll exclude that example for now. Kind of hard for me to know what is valid since I wasn&#39;t given clear requirements."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554862832, "post_id": 55603402, "comment_id": 97903067, "body": "Antarr, you merely need to make an assumption about what is required by you and frame your question accordingly. That&#39;s up to you--we don&#39;t want to hear about that. Examples are fine for helping readers understand the question but they are not a substitute for a precise statement of the problem. You need begin your question with something like, &quot;I need to validate names in my application. Names may contain letters, whitespaces and any of the characters <code>&#39;,.-</code>, with the proviso that each period (if any) must be followed by a whitespace or be at the end of the string.&quot;"}], "tags": [], "owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "is_accepted": true, "score": 2, "last_activity_date": 1554860130, "last_edit_date": 1554860130, "creation_date": 1554859129, "answer_id": 55603402, "question_id": 55603026, "link": "https://stackoverflow.com/questions/55603026/update-regex-to-exclude-dots-followed-by-anything-but-a-whitespace/55603402#55603402", "title": "Update Regex to exclude dots followed by anything but a whitespace", "body": "<p>The answer is a bit complicated when you need to account for periods that occur in the middle of valid names. According to your description, the rule seems to be that periods are fine as long as they aren't immediately followed by letters. This can be accomplished with regex lookahead:</p>\n\n<p><code>^(?!.*\\.\\S)[A-Za-z ',.-]+$</code></p>\n\n<p>demo: <a href=\"https://regex101.com/r/LkUl38/2\" rel=\"nofollow noreferrer\">https://regex101.com/r/LkUl38/2</a></p>\n"}], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55603402, "answer_count": 2, "score": 0, "last_activity_date": 1554860130, "creation_date": 1554855803, "question_id": 55603026, "link": "https://stackoverflow.com/questions/55603026/update-regex-to-exclude-dots-followed-by-anything-but-a-whitespace", "title": "Update Regex to exclude dots followed by anything but a whitespace", "body": "<p>I'm using to validate the format of names in my rails applications. I need to update it so it doesn't accept something like <code>mike.jones</code></p>\n\n<h3>current regex</h3>\n\n<pre><code>/([A-Za-z ',.-]+)/\n</code></pre>\n\n<h3>acceptable names</h3>\n\n<pre><code>'Baxter',\n'Doe de Sour Jr.',\n'Smith-Brown',\n\"Mathias d'Arras\",\n\"d'Arras\",\n'King, Jr.',\n'Cotton III'\n</code></pre>\n\n<h3>invalid names</h3>\n\n<pre><code>'Baxter2',\n'user@gmail',\n'#michael',\n'tina.fay'\n</code></pre>\n"}, {"tags": ["ruby", "tk", "keyboard-events"], "answers": [{"tags": [], "owner": {"reputation": 1626, "user_id": 1136063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8d63377824449cc8627aae609579f50?s=128&d=identicon&r=PG", "display_name": "MarkDBlackwell", "link": "https://stackoverflow.com/users/1136063/markdblackwell"}, "is_accepted": true, "score": 0, "last_activity_date": 1555012110, "last_edit_date": 1555012110, "creation_date": 1554853666, "answer_id": 55602797, "question_id": 55602789, "link": "https://stackoverflow.com/questions/55602789/how-can-i-determine-most-easily-the-keysyms-of-unusual-keys-on-my-keyboard-in-r/55602797#55602797", "title": "How can I determine most easily the keysyms of unusual keys on my keyboard, in Ruby, with Tk?", "body": "<p>This code worked for me using Ruby 2.2.5 (with Tk 8.5.12) on Windows 7:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># coding: utf-8\n\nrequire 'tk'\n\ndef lambda_keypress\n  @lambda_keypress ||= Kernel.lambda do |key_code, key_symbol|\n    puts \"lambda_keypress invoked with keycode #{key_code} and keysym #{key_symbol}.\"\n  end\nend\n\ndef root\n  $root ||= begin\n    Tk::Encoding.encoding = ''.encoding\n    TkRoot.new\n  end\nend\n\nroot.bind :KeyPress, lambda_keypress, '%k %K'\nTk.mainloop\n</code></pre>\n"}], "owner": {"reputation": 1626, "user_id": 1136063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8d63377824449cc8627aae609579f50?s=128&d=identicon&r=PG", "display_name": "MarkDBlackwell", "link": "https://stackoverflow.com/users/1136063/markdblackwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 55602797, "answer_count": 1, "score": 0, "last_activity_date": 1555012110, "creation_date": 1554853568, "last_edit_date": 1554900678, "question_id": 55602789, "link": "https://stackoverflow.com/questions/55602789/how-can-i-determine-most-easily-the-keysyms-of-unusual-keys-on-my-keyboard-in-r", "title": "How can I determine most easily the keysyms of unusual keys on my keyboard, in Ruby, with Tk?", "body": "<p>I'm using Ruby and Tk. I want to know the keysyms of various odd keys on my unusual keyboard. I want to know what they really are, not merely what some reference (such as\n<a href=\"http://www.tcl.tk/man/tcl/TkCmd/keysyms.htm\" rel=\"nofollow noreferrer\">this</a>)\nsays they should be.</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 802, "user_id": 4448436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNVhA.png?s=128&g=1", "display_name": "Mr. Kevin Thomas", "link": "https://stackoverflow.com/users/4448436/mr-kevin-thomas"}, "edited": false, "score": 0, "creation_date": 1554930705, "post_id": 55602705, "comment_id": 97935723, "body": "It very well might be an <i>rspec-mocks</i> bug. From the <a href=\"https://github.com/rspec/rspec-mocks#settings-mocks-or-stubs-on-any-instance-of-a-class\" rel=\"nofollow noreferrer\">README</a>, it states in regard to <b>allow_any_instance_of</b> - <code>It is the most complicated feature of rspec-mocks, and has historically received the most bug reports. (None of the core team actively use it, which doesn&#39;t help.)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27022, "user_id": 182693, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7e4422dd860fce9b9f3c024c8655c7d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/182693/sean"}, "edited": false, "score": 0, "creation_date": 1554854416, "post_id": 55602791, "comment_id": 97901377, "body": "I&#39;ve updated the question to add that I have checked whether the value is cached beforehand, and it&#39;s not.  In any case, in my <code>widget_spec.rb</code> I explicitly create a new object with <code>Widget.new</code>, so whatever might have been cached in a Widget instance in some other test can&#39;t possibly still be cached in the Widget spec, unless there are RSpec shenanigans happening that are similar to what I&#39;ve described."}], "tags": [], "owner": {"reputation": 89146, "user_id": 211563, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32a10a2f047dec1e5582e74cba6b3ec?s=128&d=identicon&r=PG", "display_name": "Andrew Marshall", "link": "https://stackoverflow.com/users/211563/andrew-marshall"}, "is_accepted": false, "score": 0, "last_activity_date": 1554853591, "creation_date": 1554853591, "answer_id": 55602791, "question_id": 55602705, "link": "https://stackoverflow.com/questions/55602705/rspec-stubs-apparently-not-cleaned-up-after-test/55602791#55602791", "title": "RSpec stubs apparently not cleaned up after test", "body": "<p>The stub is almost certainly being cleared, but you\u2019ve cached the fake instance in <code>get_cached_service</code>. Nothing clears the cached value in <code>@service</code>, and RSpec (rightfully) doesn\u2019t know about it. As such, stubbing <code>make_service</code> is not enough if tests call <code>get_cached_service</code>. You have a few options:</p>\n\n<ul>\n<li>Always stub <code>get_cached_service</code> instead of, or in addition to, <code>make_service</code></li>\n<li>Provide a way to clear the cached value which is called after each test.</li>\n<li>Make the caching configurable in some way, or a wrapper around the actual implementation, such that the caching does not occur in test code.</li>\n</ul>\n"}], "owner": {"reputation": 27022, "user_id": 182693, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7e4422dd860fce9b9f3c024c8655c7d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/182693/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554854188, "creation_date": 1554852704, "last_edit_date": 1554854188, "question_id": 55602705, "link": "https://stackoverflow.com/questions/55602705/rspec-stubs-apparently-not-cleaned-up-after-test", "title": "RSpec stubs apparently not cleaned up after test", "body": "<p>I've been working to diagnose a test failure that only occurs on my master branch.  Following is the relevant code, in simplified form.</p>\n\n<p>There's a service:</p>\n\n<pre><code>class Service\n\n  attr_reader :traces\n\n  def initialize\n    @traces = []\n  end\n\n  def do_work\n    @traces &lt;&lt; Thread.current.backtrace\n    # ... actual work ...\n  end\n\nend\n</code></pre>\n\n<p>And a class that makes use of the service:</p>\n\n<pre><code>class Widget\n\n  def get_cached_service\n    puts(\"Getting a cached service!\")\n    puts(\"Do I already have one? #{!!@service}\")\n    @service ||= make_service\n  end\n\n  def make_service\n    puts(\"Making a service!\")\n    Service.new\n  end\n\nend\n</code></pre>\n\n<p>I have a test (that lives in a file <code>widget_spec.rb</code>) that fails intermittently.  This test creates an instance of <code>Widget</code> and calls <code>get_cached_service</code>.  I see the <code>Getting a cached service!</code> message on the console, followed by <code>Do I already have one? false</code>, but I <em>don't</em> see the <code>Making a service!</code> message.</p>\n\n<p>Furthermore, when I examine the <code>traces</code> attribute of the returned <code>Service</code> object, I find stack traces originating from <em>other tests in my project</em> (eg. <code>foo_spec.rb</code>, <code>bar_spec.rb</code>, etc).</p>\n\n<p>In a few different places I find code like:</p>\n\n<pre><code>allow_any_instance_of(Widget)\n  .to receive(:make_service).and_return(whatever)\n</code></pre>\n\n<p>The other tests whose stack traces I find are likely stubbing <code>make_service</code> like this.  But it appears that the stubbing is not being undone after those tests, as should always happen according to my understanding.</p>\n\n<p>Is there any reason, other than a bug in rspec, that could cause a stub not to be reset at the end of a test?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1554848817, "post_id": 55602069, "comment_id": 97900147, "body": "try <code>subject { build(described_class.to_s.downcase.to_sym) }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 10824646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd5b8c225b86871e1d8b6aab6618803?s=128&d=identicon&r=PG&f=1", "display_name": "lacroix", "link": "https://stackoverflow.com/users/10824646/lacroix"}, "is_accepted": true, "score": 2, "last_activity_date": 1554851609, "creation_date": 1554851609, "answer_id": 55602558, "question_id": 55602069, "link": "https://stackoverflow.com/questions/55602069/factorybot-looking-up-by-class-deprecated/55602558#55602558", "title": "Factorybot looking up by class deprecated", "body": "<p>Related post on the topic: <a href=\"https://stackoverflow.com/questions/50437961/factorybot-namespaced-models-without-class-name\">FactoryBot namespaced models without class_name</a></p>\n\n<p>From the link -- updating the factory to \n<code>factory :foo_bar, class: 'foo/bar' do; end</code> should work because of <code>key.to_s.underscore.to_sym</code> <a href=\"https://github.com/thoughtbot/factory_bot/blob/c716ce01b448ce4e0bf855c5a2c63ecb9206322e/lib/factory_bot/decorator/class_key_hash.rb#L18\" rel=\"nofollow noreferrer\">in this class</a></p>\n"}], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 55602558, "answer_count": 1, "score": 0, "last_activity_date": 1554851609, "creation_date": 1554848017, "question_id": 55602069, "link": "https://stackoverflow.com/questions/55602069/factorybot-looking-up-by-class-deprecated", "title": "Factorybot looking up by class deprecated", "body": "<p>I'm trying to create a shared_example in a rails application. It's working but I'm getting a deprecation error. I can I refactor the code to fix this?</p>\n\n<h3>error</h3>\n\n<pre><code>Looking up factories by class is deprecated and will be removed in 5.0. Use symbols instead and set FactoryBot.allow_class_lookup = false.\n</code></pre>\n\n<h3>source</h3>\n\n<pre><code>shared_examples 'a sanatized_record' do\n  subject { build(described_class) }\n\n  describe 'stripped_attributes' do\n    described_class::STRIPPED_ATTRIBUTES.each do |attr|\n      it \"strips whitespaces from #{attr}\" do\n        original = subject[attr]\n        subject[attr] = \" #{original} \"\n        subject.validate\n        expect(subject[attr]).to eq original\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554837715, "post_id": 55599843, "comment_id": 97895957, "body": "<i>Do</i> you need to use it, though? It doesn&#39;t do much, you can build your own."}, {"owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554837783, "post_id": 55599843, "comment_id": 97895980, "body": "You are telling that use span directly, don&#39;t use content_tag is it..?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554837813, "post_id": 55599843, "comment_id": 97895987, "body": "Pretty much, yes."}, {"owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554837891, "post_id": 55599843, "comment_id": 97896017, "body": "Cool. Will try doing that. But can you please tell me how to include rails action_view in gem using railtie..? I&#39;m curious. I tried but didn&#39;t get it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554837979, "post_id": 55599843, "comment_id": 97896055, "body": "I haven&#39;t tried, but adding actionview to your gemspec, requiring something like <code>action_view&#47;helpers</code> and including that module into your class sounds like it should work."}, {"owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554838040, "post_id": 55599843, "comment_id": 97896083, "body": "okay. cool. Thanks."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1554847380, "post_id": 55599843, "comment_id": 97899732, "body": "Do you really need a dependency to do <code>&quot;&lt;span&gt;#{value}&lt;&#47;span&gt;&quot;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "edited": false, "score": 0, "creation_date": 1554885885, "post_id": 55604286, "comment_id": 97911160, "body": "Yes. i had tried this Max. But we cannot require &#39;fun_emoji&#39; locally. It has to be bundle installed in rails."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "edited": false, "score": 0, "creation_date": 1554889995, "post_id": 55604286, "comment_id": 97913753, "body": "@SrinidhiGs: &quot; It has to be bundle installed in rails. &quot; - yes, The usual process of installing gems. Nothing to do with having actionview as a dependency."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "edited": false, "score": 0, "creation_date": 1554916267, "post_id": 55604286, "comment_id": 97929189, "body": "@SrinidhiGs are you saying that the gem doesnt work outside of rails? I think ActionView is part of rails so you need to add it to your gem dependencies .."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1554867901, "last_edit_date": 1554867901, "creation_date": 1554866457, "answer_id": 55604286, "question_id": 55599843, "link": "https://stackoverflow.com/questions/55599843/how-to-include-actionviewhelperstaghelper-in-ruby-gem-to-make-use-of-con/55604286#55604286", "title": "How to include ActionView::Helpers::TagHelper in ruby gem...? To make use of content_tag", "body": "<p>Really simply, just:</p>\n\n<pre><code>require 'action_view'\nmodule FunEmoji\n  class Index\n    include ActionView::Helpers::TagHelper\n    # ... initialize method\n  end\nend\n</code></pre>\n\n<p>However, this will do nothing:</p>\n\n<pre><code>list.each do |key, value|\n  content_tag(:span, value)\nend\n</code></pre>\n\n<p><code>content_tag</code> returns a string, so you need to do something with the result (remember <code>each</code> ignores the return value of its block):</p>\n\n<pre><code>tags = list.map { |k,v| content_tag :span, v }\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1554867901, "creation_date": 1554837597, "question_id": 55599843, "link": "https://stackoverflow.com/questions/55599843/how-to-include-actionviewhelperstaghelper-in-ruby-gem-to-make-use-of-con", "title": "How to include ActionView::Helpers::TagHelper in ruby gem...? To make use of content_tag", "body": "<p>I need to use content_tag in my gem. How to include ActionView::Helpers::TagHelper in the gem.</p>\n\nlib/fun_emoji.rb\n\n<pre><code>require 'fun_emoji/version'\nrequire 'json'\n\nmodule FunEmoji\n   class Index\n\n     def initialize(list)\n\n       list.each do |key, value|\n          content_tag(:span, value)\n        end\n     end\n\n   end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 0, "last_activity_date": 1554837152, "creation_date": 1554837152, "answer_id": 55599733, "question_id": 55599309, "link": "https://stackoverflow.com/questions/55599309/how-to-concatenate-two-lines-from-a-given-file/55599733#55599733", "title": "How to concatenate two lines from a given file?", "body": "<p>Although I couldn't understand why and what you want to achieve this but I could figure out that basically you are looking to read/call the lines as index.</p>\n\n<p>Please refer <a href=\"https://ruby-doc.org/core-2.0.0/IO.html#method-c-readlines\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<pre><code>=&gt; file = IO.readlines('filename') # =&gt; [\"line 1\\n\", \"line 2\\n\", \"line 3\\n\"]\n=&gt; file[2] # =&gt; \"line 3\\n\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55599733, "answer_count": 1, "score": 0, "last_activity_date": 1554837152, "creation_date": 1554835318, "question_id": 55599309, "link": "https://stackoverflow.com/questions/55599309/how-to-concatenate-two-lines-from-a-given-file", "title": "How to concatenate two lines from a given file?", "body": "<p>I want to concatenate a line with another line given by a text file. How do I do that?</p>\n\n<p>I've tried using an array with an index, but whenver I do <code>line + line[index + 1]</code> it doesn't concatenate the previous line with the second line.</p>\n\n<pre><code>def createWordList(filename)\n\n  wordArray = Array.new\n\n  for i in 1..6\n    i = gets.chomp\n    i.delete(\"\\n\\r\\t\")\n    wordArray.push(i)\n  end\n\n  file = File.open(filename, \"r+\")\n\n  wordArray.each_with_index do |item, index|\n    file.puts(item)\n    item += item[index + 1]\n    file.puts(item)\n\n  end\n\nend\n\ncreateWordList(\"words.txt\")\n\n</code></pre>\n\n<p>\u00cc was expecting the <code>line[index + 1]</code> to return the next line, but it instead returned the letter at <code>line[index + 1]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "isomorphic", "hyperstack"], "answers": [{"tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1554849951, "creation_date": 1554849951, "answer_id": 55602340, "question_id": 55597847, "link": "https://stackoverflow.com/questions/55597847/using-googles-text-to-speech-api-with-hyperstack/55602340#55602340", "title": "Using Google&#39;s text to speech API with Hyperstack", "body": "\n\n<p>An operation is not going to help you here.  Why?</p>\n\n<p>Because unless you know a trick I don't, the only way to play an audio file without a lot of extra work, is to point an HTML audio tag's source at a url on the server.</p>\n\n<p>This is then very easily done by a standard rails controller method that decodes the string from the URL params and returns the mp3 file in the response body.</p>\n\n<p>For example /utils/text2speech.mp3?text=Hello%020There would just return the MP3 file.</p>\n\n<p>Just to fully answer your question however, the <code>Hyperstack::ServerOp</code> class is a subclass of Operation that only runs on the server, but can be called from the client.</p>\n\n<p>Too bad its no help here :-)</p>\n"}], "owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554871690, "creation_date": 1554829310, "last_edit_date": 1554871690, "question_id": 55597847, "link": "https://stackoverflow.com/questions/55597847/using-googles-text-to-speech-api-with-hyperstack", "title": "Using Google&#39;s text to speech API with Hyperstack", "body": "<p>I would like to use the Google text-speech API to let my user type text into a text control, and then click a button which would send the text to my Rails server, where it would use the Google TextToSpeach API to create an mp3 file of that speech.</p>\n\n<p>The Google API looks very simple to use: <a href=\"https://cloud.google.com/text-to-speech/docs/create-audio\" rel=\"nofollow noreferrer\">https://cloud.google.com/text-to-speech/docs/create-audio</a></p>\n\n<p>In a traditional Rails application, I would write an API to pass the text to be transcribed and would expect that API call to return the path to the MP3 file created for the user to download.</p>\n\n<p>It seems that a <a href=\"https://hyperstack.org/edge/docs/dsl-isomorphic/operations\" rel=\"nofollow noreferrer\">Hyperstack Isomorphic Operations</a> would be the right approach for this, but how do I ensure the operation only runs on the server and not on the client though and how do I get the output value of the Operation (ie the file created) so I can display it in the browser for the user to download?</p>\n\n<p>I should stress that I only need the Google API to Create the Audio file on the server (not play it). The user will then download the created file so their own use.</p>\n"}, {"tags": ["ruby-on-rails", "angularjs", "ruby", "angularjs-directive", "rails-api"], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 4196620, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KldA9D_LWWA/AAAAAAAAAAI/AAAAAAAAAH4/eYknRVT3XA4/photo.jpg?sz=128", "display_name": "kendavidson", "link": "https://stackoverflow.com/users/4196620/kendavidson"}, "is_accepted": true, "score": 0, "last_activity_date": 1555427346, "creation_date": 1555427346, "answer_id": 55711366, "question_id": 55597697, "link": "https://stackoverflow.com/questions/55597697/how-to-format-currency-input-in-ror-angularjs-app/55711366#55711366", "title": "How to format currency input in RoR + AngularJS app", "body": "<p>You're going to need to create a new directive that requires ngModel and applies the appropriate $parser/$formatter to it.  </p>\n\n<p><a href=\"https://docs.angularjs.org/api/ng/type/ngModel.NgModelController#\" rel=\"nofollow noreferrer\">https://docs.angularjs.org/api/ng/type/ngModel.NgModelController#</a>$parsers</p>\n\n<p>A good example of how to do this is (displaying as uppercase but always storing data as lowercase):</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22841225/ngmodel-formatters-and-parsers\">ngModel Formatters and Parsers</a></p>\n\n<p>You should be able to then add the ability to include other directives in your 'options' argument so that they get added correctly to the output.</p>\n"}], "owner": {"reputation": 119, "user_id": 8319323, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344036448998167/picture?type=large", "display_name": "Anatolii Stupin", "link": "https://stackoverflow.com/users/8319323/anatolii-stupin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55711366, "answer_count": 1, "score": 0, "last_activity_date": 1555427346, "creation_date": 1554828714, "last_edit_date": 1554830934, "question_id": 55597697, "link": "https://stackoverflow.com/questions/55597697/how-to-format-currency-input-in-ror-angularjs-app", "title": "How to format currency input in RoR + AngularJS app", "body": "<p>Sorry for my English.</p>\n\n<p>I need to change input value format, for example: from \"1000000\" to \"1 000 000 $\".</p>\n\n<p>In my views of rails app, I have this line of code:</p>\n\n<pre><code>&lt;%= ng_text_field('total_price', 'selected.data.total_price', 'Full price', ng_readonly: '!selected.permissions.update') %&gt;\n</code></pre>\n\n<p>In helper:</p>\n\n<pre><code>  def ng_text_field(name, ng_model, placeholder, options = {})\n    result = &lt;&lt;-HTML\n      &lt;div class=\"form-group\" ng-class='{\"has-error\":errors.#{name}}' #{options[:ng_if] &amp;&amp; \"ng-if=\\\"#{options[:ng_if]}\\\"\"}&gt;\n        &lt;label for=\"#{name}\" class=\"col-sm-3 control-label\"&gt;#{placeholder}&lt;/label&gt;\n        &lt;div class=\"col-sm-9\"&gt;\n          &lt;input id=\"#{name}\" \n                 type=\"text\" \n                 class=\"form-control\" \n                 name=\"#{name}\" \n                 placeholder=\"#{placeholder}\" \n                 ng-model=\"#{ng_model}\"\n                 #{options[:ng_readonly] &amp;&amp; \"ng-readonly=\\\"#{options[:ng_readonly]}\\\"\"}&gt;\n          &lt;p class=\"help-block small\" ng-if=\"errors.#{name}\"&gt;{{errors.#{name} | join:',' }}&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    HTML\n    result.html_safe\n  end\n</code></pre>\n\n<p>I am know Angular very little, I have tried some ways and all this ways was incorrect. :(</p>\n\n<p>Could anyone give advice of some help?\nThank you in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "controller"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1554831041, "post_id": 55597549, "comment_id": 97892904, "body": "Have you looked at the devise docs for <a href=\"https://github.com/plataformatec/devise#strong-parameters\" rel=\"nofollow noreferrer\">strong parameters</a> yet? They show how to allow additional fields"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1554848713, "post_id": 55597549, "comment_id": 97900111, "body": "Devise controllers are hidden. You can use Jay solution or you can ask Devise to explicitly generates the controllers and tweak them : <a href=\"https://github.com/plataformatec/devise#configuring-controllers\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise#configuring-controllers</a>"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1554852190, "post_id": 55597549, "comment_id": 97900853, "body": "As said above.  Create the controllers and then permit the params."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 11094356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36488439a836bc8c5969bdac74e8aa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragya Sriharsh", "link": "https://stackoverflow.com/users/11094356/pragya-sriharsh"}, "is_accepted": true, "score": 0, "last_activity_date": 1554889140, "creation_date": 1554889140, "answer_id": 55609385, "question_id": 55597549, "link": "https://stackoverflow.com/questions/55597549/how-to-add-custom-devise-fields-access-devise-default-controller/55609385#55609385", "title": "How to add custom devise fields/ Access devise default controller", "body": "<p>See doc: <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise</a></p>\n\n<p>You have to tell the devise to save extra parameters in the DB.</p>\n\n<p>Your application_controller.rb file look like: </p>\n\n<pre><code> class ApplicationController &lt; ActionController::Base\n    protect_from_forgery with: :exception\n    before_action :configure_permitted_parameters, if: :devise_controller?\n\n    protected\n\n    def configure_permitted_parameters\n        devise_parameter_sanitizer.permit(:sign_up, keys: [:username])\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11335427, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UY_zOEK5h1Y/AAAAAAAAAAI/AAAAAAAATbw/mWqy30DqrIs/photo.jpg?sz=128", "display_name": "Edi Junior", "link": "https://stackoverflow.com/users/11335427/edi-junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 55609385, "answer_count": 1, "score": 0, "last_activity_date": 1554889140, "creation_date": 1554828183, "question_id": 55597549, "link": "https://stackoverflow.com/questions/55597549/how-to-add-custom-devise-fields-access-devise-default-controller", "title": "How to add custom devise fields/ Access devise default controller", "body": "<p>I'm trying to use Devise gem in my project. That worked, but I still have a problem:</p>\n\n<p>I setup devise in my application and generated the views, but I added an extra field in the database (username). So, the thing is that I need this username, but it's not being saved in the database when I create a new user :/ The problem seems to be in the controller, but I don't know how to access it.</p>\n\n<p>Do devise hide its controllers? Can I access this controller and simply add the field I want in the params, for example? Do I really need to code a new controller that will override the default one? What should I do? and how?</p>\n"}, {"tags": ["ruby", "yaml"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1554828818, "post_id": 55596878, "comment_id": 97891886, "body": "It does not leave the alias it leaves the node. The alias is <code>&amp;defaults</code>. These are separate concerns in the parser"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1554842145, "post_id": 55596878, "comment_id": 97897802, "body": "What if the alias was nested at another level how would you want that stripped out?"}, {"owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1554858745, "post_id": 55596878, "comment_id": 97902235, "body": "I just realized that yes, there&#39;s a node and an alias!"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "edited": false, "score": 0, "creation_date": 1554826327, "post_id": 55597004, "comment_id": 97890650, "body": "Is there any way to tell YAML (or psych) that I just want it flattened? This is a good answer I&#39;m just hoping there is a less round-about way."}, {"owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "edited": false, "score": 0, "creation_date": 1554826746, "post_id": 55597004, "comment_id": 97890876, "body": "despite my best efforts, this looks like the only solution."}, {"owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "edited": false, "score": 0, "creation_date": 1554827018, "post_id": 55597004, "comment_id": 97891012, "body": "Actually, this doesn&#39;t quite work: It leaves the aliases in the document. Is there any other way?"}], "tags": [], "owner": {"reputation": 2055, "user_id": 2716092, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93305428cde3eb1e7c3eed694e5a23c7?s=128&d=identicon&r=PG", "display_name": "Mikhail Chuprynski", "link": "https://stackoverflow.com/users/2716092/mikhail-chuprynski"}, "is_accepted": false, "score": 1, "last_activity_date": 1554826083, "creation_date": 1554826083, "answer_id": 55597004, "question_id": 55596878, "link": "https://stackoverflow.com/questions/55596878/how-do-i-flatten-a-yaml-file-so-it-has-no-aliases-in-ruby/55597004#55597004", "title": "How do I flatten a YAML file so it has no aliases (in ruby)?", "body": "<p>Just use <code>YAML.dump</code></p>\n\n<pre><code>require 'yaml'\nyaml = YAML::load(File.open('t.yml'))\nYAML.dump yaml\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2055, "user_id": 2716092, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93305428cde3eb1e7c3eed694e5a23c7?s=128&d=identicon&r=PG", "display_name": "Mikhail Chuprynski", "link": "https://stackoverflow.com/users/2716092/mikhail-chuprynski"}, "is_accepted": true, "score": 1, "last_activity_date": 1554828708, "creation_date": 1554828708, "answer_id": 55597696, "question_id": 55596878, "link": "https://stackoverflow.com/questions/55596878/how-do-i-flatten-a-yaml-file-so-it-has-no-aliases-in-ruby/55597696#55597696", "title": "How do I flatten a YAML file so it has no aliases (in ruby)?", "body": "<p>What you want in your amended question breaks YAML itself. In this case you should remove your initial alias manually:</p>\n\n<pre><code>require 'yaml'\nyml = YAML.load(File.open 't.yml')\nyml.delete('-')\nyml.to_yaml\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 3341972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c97cadaffeb09e32312d37dd31dd6?s=128&d=identicon&r=PG", "display_name": "apanzerj", "link": "https://stackoverflow.com/users/3341972/apanzerj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 55597696, "answer_count": 2, "score": 0, "last_activity_date": 1554828708, "creation_date": 1554825586, "last_edit_date": 1554827152, "question_id": 55596878, "link": "https://stackoverflow.com/questions/55596878/how-do-i-flatten-a-yaml-file-so-it-has-no-aliases-in-ruby", "title": "How do I flatten a YAML file so it has no aliases (in ruby)?", "body": "<p>Let's say I have:</p>\n\n<pre><code>-: &amp;defaults\n  client_id: 'invalid_client_id'\n  client_secret: 'secret'\n\nproduction:\n  &lt;&lt;: *defaults\nstaging:\n  &lt;&lt;: *defaults\n</code></pre>\n\n<p>and I want to read it and then flatten it so there are no aliases. How would I do that? I would super prefer a solution that utilizes some configuration of the current YAML library rather than something tossed together (if that makes sense).</p>\n\n<p>IOW: </p>\n\n<pre><code>production:\n  client_id: 'invalid_client_id'\n  client_secret: 'secret'\nstaging:\n  client_id: 'invalid_client_id'\n  client_secret: 'secret'\n</code></pre>\n\n<p>Edit:</p>\n\n<p>The suggestion to do YAML.dump from a YAML.load works but it leaves the original alias in the document:</p>\n\n<pre><code>---\n\"-\":\n  client_id: invalid_client_id\n  client_secret: secret\nproduction:\n  client_id: invalid_client_id\n  client_secret: secret\nstaging:\n  client_id: invalid_client_id\n  client_secret: secret\n</code></pre>\n\n<p>Which is not exactly what I need. Happy to accept the answer but want to see if there are any other ideas.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1554824008, "post_id": 55596403, "comment_id": 97889395, "body": "Just check if <code>current_user</code> is being initialized before those actions (new, create) are executed."}, {"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554824221, "post_id": 55596403, "comment_id": 97889524, "body": "@SebastianPalma thanks, but i think i need help with that.can you please"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554824963, "post_id": 55596403, "comment_id": 97889935, "body": "Put a <code>byebug</code> or <code>binding.pry</code> (in case you&#39;re using pry) right before any current_user.jobs call and proceed executing that action, check the rails server then."}, {"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554826535, "post_id": 55596403, "comment_id": 97890777, "body": "Thank You @SebastianPalma. I did not add  before_action :authenticate_user! in the jobs_controller. I added it and its now working"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554826729, "post_id": 55596403, "comment_id": 97890869, "body": "That&#39;s great. Don&#39;t forget you can answer your own question."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "is_accepted": false, "score": 1, "last_activity_date": 1554829832, "last_edit_date": 1554829832, "creation_date": 1554829397, "answer_id": 55597874, "question_id": 55596403, "link": "https://stackoverflow.com/questions/55596403/undefined-method-jobs-for-nilnilclass-in-my-rails-app/55597874#55597874", "title": "undefined method `jobs&#39; for nil:NilClass in my rails app", "body": "<p>I did not add before_action :authenticate_user! in the jobs_controller.</p>\n\n<p>I added it and it's now working:</p>\n\n<pre><code>#\u00a0jobs_controller\nclass JobsController &lt; ApplicationController\n  before_action :authenticate_user!, except: [:index, :show]\n\n  # stuffs\n  def method\n  end\n\n  def method\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554829832, "creation_date": 1554823922, "last_edit_date": 1592644375, "question_id": 55596403, "link": "https://stackoverflow.com/questions/55596403/undefined-method-jobs-for-nilnilclass-in-my-rails-app", "title": "undefined method `jobs&#39; for nil:NilClass in my rails app", "body": "<p>Please Guys, i need help solving this problem. I was trying to get jobs/new .From my rails console;</p>\n<pre><code>NoMethodError - undefined method `jobs' for nil:NilClass:\n  app/controllers/jobs_controller.rb:17:in `new'\n</code></pre>\n<h2>routes.rb</h2>\n<pre><code>Rails.application.routes.draw do\n  resources :jobs\n  devise_for :users\n    resources :home\n    root 'jobs#index'\n  end\n</code></pre>\n<h2>jobs_controller.rb</h2>\n<pre><code> # GET /jobs/new\n  def new\n    @job = current_user.jobs.build\n  end\n\n  # POST /jobs\n  # POST /jobs.json\n  def create\n    @job = current_user.jobs.build(job_params)\n\n    respond_to do |format|\n      if @job.save\n        format.html { redirect_to @job, notice: 'Job was successfully created.' }\n        format.json { render :show, status: :created, location: @job }\n      else\n        format.html { render :new }\n        format.json { render json: @job.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "unix", "webpack", "terminal"], "comments": [{"owner": {"reputation": 445, "user_id": 5362658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jLMFF.jpg?s=128&g=1", "display_name": "QNester", "link": "https://stackoverflow.com/users/5362658/qnester"}, "edited": false, "score": 1, "creation_date": 1554827538, "post_id": 55596260, "comment_id": 97891260, "body": "Just use foreman: <a href=\"https://github.com/ddollar/foreman\" rel=\"nofollow noreferrer\">github.com/ddollar/foreman</a>"}, {"owner": {"reputation": 1544, "user_id": 6820579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZy5g.jpg?s=128&g=1", "display_name": "Aminu Kano", "link": "https://stackoverflow.com/users/6820579/aminu-kano"}, "reply_to_user": {"reputation": 445, "user_id": 5362658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jLMFF.jpg?s=128&g=1", "display_name": "QNester", "link": "https://stackoverflow.com/users/5362658/qnester"}, "edited": false, "score": 0, "creation_date": 1554827835, "post_id": 55596260, "comment_id": 97891405, "body": "Yes @QNester, foreman will work just fine."}, {"owner": {"reputation": 733, "user_id": 2441263, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/TOE8s.jpg?s=128&g=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/2441263/lucas"}, "edited": false, "score": 1, "creation_date": 1567176248, "post_id": 55596260, "comment_id": 101898025, "body": "Is there any way to do this without foreman?"}, {"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1613204905, "post_id": 55596260, "comment_id": 117008233, "body": "Why wouldn&#39;t Rails start Webpack on its own?"}], "answers": [{"tags": [], "owner": {"reputation": 1544, "user_id": 6820579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZy5g.jpg?s=128&g=1", "display_name": "Aminu Kano", "link": "https://stackoverflow.com/users/6820579/aminu-kano"}, "is_accepted": false, "score": 5, "last_activity_date": 1554827751, "creation_date": 1554827751, "answer_id": 55597440, "question_id": 55596260, "link": "https://stackoverflow.com/questions/55596260/how-can-i-start-the-rails-server-in-parallel-with-the-webpack-server-so-that-i-c/55597440#55597440", "title": "How can I start the rails server in parallel with the webpack server so that I can kill both at the same time?", "body": "<p>You can install <code>foreman</code> gem, instructions <a href=\"https://github.com/ddollar/foreman\" rel=\"noreferrer\">here</a>.</p>\n\n<p>Then create a <code>Procfile</code> and add the startup scripts to it.</p>\n\n<pre><code>web: bin/webpack-dev-server\napi: rails s\n</code></pre>\n\n<p>To start the servers run <code>foreman start</code>. </p>\n\n<p>To kill all processes use <code>Ctrl^C</code>, if it fails run <code>killall \"foreman: master\"</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 10160404, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GWeKidOymZ0/AAAAAAAAAAI/AAAAAAAAG6I/IPtqhIz86wc/photo.jpg?sz=128", "display_name": "Benjamin Hargett", "link": "https://stackoverflow.com/users/10160404/benjamin-hargett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1554827751, "creation_date": 1554823449, "question_id": 55596260, "link": "https://stackoverflow.com/questions/55596260/how-can-i-start-the-rails-server-in-parallel-with-the-webpack-server-so-that-i-c", "title": "How can I start the rails server in parallel with the webpack server so that I can kill both at the same time?", "body": "<p>I'm looking for a way to spin up the rails development server in parallel with the webpack server. The problem is that if I run one of them in the background, when I <code>Ctrl^C</code> to close everything, one process continues to run in the background and can cause some odd behavior involving the addresses being in use.</p>\n\n<p>I have tried this:</p>\n\n<pre><code>$ rails s &amp; bin/webpack-dev-server\n\n// rails and webpack running in parallel\n\n$ sudo lsof -n -i :3000 -i :3035 | grep LISTEN\n\nruby    26847 username   13u  IPv4 0xa889e9178532bffd      0t0  TCP 127.0.0.1:hbci (LISTEN)\nruby    26847 username   14u  IPv6 0xa889e91781b9ae3d      0t0  TCP [::1]:hbci (LISTEN)\nnode    26848 username   19u  IPv4 0xa889e9178e468ffd      0t0  TCP 127.0.0.1:fjsv-gssagt (LISTEN)\n</code></pre>\n\n<p>But as you can see, when you attempt to kill the process with <code>Ctrl^C</code>, there are still processes running on the port.</p>\n\n<pre><code>$ sudo lsof -n -i :3000 -i :3035 | grep LISTEN\n\nruby    26847 username   13u  IPv4 0xa889e9178532bffd      0t0  TCP 127.0.0.1:hbci (LISTEN)\nruby    26847 username   14u  IPv6 0xa889e91781b9ae3d      0t0  TCP [::1]:hbci (LISTEN)\n</code></pre>\n\n<p>I know that I could simply run these in separate terminals and kill both processes individually, but I would like to be able to create a yarn script that runs them both using something like <code>yarn start</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "ruby-on-rails-5.2"], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1554894580, "post_id": 55610613, "comment_id": 97916349, "body": "Note that the <code>local: true</code> option for <code>form_with</code> has nothing to do with local variables. It just sets the <code>data-remote</code> attribute on the form which determines if the form is sent normally or with AJAX."}, {"owner": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "edited": false, "score": 0, "creation_date": 1554922888, "post_id": 55610613, "comment_id": 97932360, "body": "This is so insanely helpful with fantastically readable examples! It works perfectly now! Regarding the different approaches you outlined - is one better than the other, or more accepted within the community?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "edited": false, "score": 1, "creation_date": 1554923511, "post_id": 55610613, "comment_id": 97932628, "body": "Both are just different ways to solve the same problem. By using locals you are explicitly passing the variables to the partial instead of just relying on external state - this makes it easier to make truly reusable partials as they are more functional in nature."}, {"owner": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "edited": false, "score": 0, "creation_date": 1555473989, "post_id": 55610613, "comment_id": 98119301, "body": "Just a quick note: I had to change the <code>show.html.erb</code> code to   <code>&lt;%= render partial: &#39;books&#47;form&#39;, locals: {model: [@series, @series.books.new]} %&gt;</code>   in order for it to work. Seems you need to explicitly state its a partial when using local variables."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 9, "last_activity_date": 1554894455, "last_edit_date": 1554894455, "creation_date": 1554893113, "answer_id": 55610613, "question_id": 55596186, "link": "https://stackoverflow.com/questions/55596186/use-a-single-form-with-to-create-and-edit-nested-resources-in-rails/55610613#55610613", "title": "Use a single form_with to create and edit nested resources in Rails", "body": "<p>You can pass an array to the form to handle both nested and \"shallow\" routes:</p>\n\n<pre><code>&lt;%= form_with(model: [@series, @book], local: true) do |form| %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Rails compacts the array (removes nil values) so if <code>@series</code> is nil the form will fall back to <code>book_url(@book)</code> or <code>books_url</code>. However you need to handle setting <code>@series</code> and <code>@book</code> properly from the controller.</p>\n\n<pre><code>class SeriesController &lt; ApplicationController\n  def show\n    @series = Series.find(params[:id])\n    @book = @series.books.new # used by the form\n  end\nend\n</code></pre>\n\n<p>You could instead handle this in your views by using <a href=\"https://guides.rubyonrails.org/layouts_and_rendering.html#passing-local-variables\" rel=\"noreferrer\">local</a> variables:</p>\n\n<pre><code># app/views/books/_form.html.erb\n&lt;%= form_with(model: model, local: true) do |form| %&gt;\n\n&lt;% end %&gt;\n\n# app/views/books/edit.html.erb\n&lt;%= render 'form', locals: { model: [@series, @book] } %&gt;\n\n# app/views/series/show.html.erb\n&lt;%= render 'books/form', locals: { model: [@series, @series.book.new] } %&gt;\n</code></pre>\n\n<p>You can also use the <a href=\"https://guides.rubyonrails.org/routing.html#shallow-nesting\" rel=\"noreferrer\"><code>shallow: true</code></a> option in your routes to avoid nesting the member routes (show, edit, update, destroy):</p>\n\n<pre><code>resources :series do\n  resources :books, shallow: true\nend\n</code></pre>\n\n<p>This will let you just do:</p>\n\n<pre><code># app/views/books/edit.html.erb\n&lt;%= render 'form', model: @book %&gt;\n\n# app/views/books/_book.html.erb\n&lt;%= link_to 'Edit', edit_book_path(book) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2679, "favorite_count": 4, "accepted_answer_id": 55610613, "answer_count": 1, "score": 4, "last_activity_date": 1554922991, "creation_date": 1554823218, "last_edit_date": 1554922991, "question_id": 55596186, "link": "https://stackoverflow.com/questions/55596186/use-a-single-form-with-to-create-and-edit-nested-resources-in-rails", "title": "Use a single form_with to create and edit nested resources in Rails", "body": "<h1>Background</h1>\n\n<p>Inside of my application, a <em>series</em> is composed of many <em>books</em>. A series' <strong>Show</strong> page allows a user to see all the books in a series and to add a new book to the series using a form.</p>\n\n<p>Every book listed on the <strong>Show</strong> page has a link to an <strong>Edit</strong> page for that book. The edit page contains <em>the same form</em> used to initially add a book. When editing a book, the form should auto-fill with the books existing information.</p>\n\n<h1>Question</h1>\n\n<p>How do I configure my <code>form_with</code> tag so that it can both create a new book and edit an existing book (auto-filling the edit form)? I have tried the following configurations, but they either break the Edit page or break the Show page:</p>\n\n<ol>\n<li><code>&lt;%= form_with(model: [ @series, @series.books.build ], local: true) do |form| %&gt;</code>\n\n<ul>\n<li>Breaks book Edit page</li>\n<li>Error: No error, but form doesn't auto-fill data</li>\n</ul></li>\n<li><code>&lt;%= form_with(model: @book, url: series_book_path, local: true) do |form| %&gt;</code>\n\n<ul>\n<li>Breaks series Show page</li>\n<li>Error: <code>No route matches {:action=&gt;\"show\", :controller=&gt;\"books\", :id=&gt;\"6\"}, missing required keys: [series_id]</code></li>\n</ul></li>\n<li><code>&lt;%= form_with(model: [:series, @book], local: true) do |form| %&gt;</code>\n\n<ul>\n<li>Breaks series Show page</li>\n<li>Error: <code>Undefined method 'model_name' for nil:NilClass</code></li>\n</ul></li>\n<li><code>&lt;%= form_with(model: [@series, @series.books.find(@book.id)], local: true) do |form| %&gt;</code>\n\n<ul>\n<li>Breaks series Show page</li>\n<li>Error: <code>undefined method 'id' for nil:NilClass</code></li>\n</ul></li>\n<li><code>&lt;%= form_with(model: @book, url: [@series, @book], local: true) do |form| %&gt;</code>\n\n<ul>\n<li>Breaks when submitting new book on series Show page</li>\n<li>Error: <code>No route matches [POST] \"/series/6\"</code></li>\n</ul></li>\n</ol>\n\n<h1>Resources I have consulted:</h1>\n\n<ul>\n<li><a href=\"https://api.rubyonrails.org/v5.2.2/classes/ActionView/Helpers/FormHelper.html#method-i-form_with\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/v5.2.2/classes/ActionView/Helpers/FormHelper.html#method-i-form_with</a></li>\n<li><a href=\"https://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/form_helpers.html</a></li>\n<li><a href=\"https://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default</a></li>\n<li><a href=\"https://github.com/rails/rails/blob/master/actionview/lib/action_view/helpers/form_helper.rb\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/master/actionview/lib/action_view/helpers/form_helper.rb</a></li>\n</ul>\n\n<h1>Existing code</h1>\n\n<p>Stripped-down sections of relevant code are below, as well as links to where they exist in my current GitHub repository.</p>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/config/routes.rb\" rel=\"nofollow noreferrer\">config/<strong>routes.rb</strong></a></p>\n\n<pre><code>resources :series do\n  resources :books\nend\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/models/book.rb\" rel=\"nofollow noreferrer\">app/models/<strong>book.rb</strong></a></p>\n\n<pre><code>class Book &lt; ApplicationRecord\n  belongs_to :series\nend\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/models/series.rb\" rel=\"nofollow noreferrer\">app/models/<strong>series.rb</strong></a></p>\n\n<pre><code>class Series &lt; ApplicationRecord\n  has_many :books, dependent: :destroy\nend\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/db/schema.rb\" rel=\"nofollow noreferrer\">db/<strong>schema.rb</strong></a></p>\n\n<pre><code>create_table \"books\", force: :cascade do |t|\n  t.integer \"series_number\"\n  t.integer \"year_published\"\n  t.integer \"series_id\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.index [\"series_id\"], name: \"index_books_on_series_id\"\nend\n\ncreate_table \"series\", force: :cascade do |t|\n  t.string \"title\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/views/series/show.html.erb\" rel=\"nofollow noreferrer\">app/views/series/<strong>show.html.erb</strong></a></p>\n\n<pre><code>&lt;%= render @series.books %&gt;\n&lt;%= render 'books/form' %&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/views/books/_book.html.erb\" rel=\"nofollow noreferrer\">app/views/books/<strong>_book.html.erb</strong></a></p>\n\n<pre><code>&lt;%= link_to 'Edit', edit_series_book_path(book.series, book) %&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/views/books/edit.html.erb\" rel=\"nofollow noreferrer\">app/views/books/<strong>edit.html.erb</strong></a></p>\n\n<pre><code>&lt;%= render 'form' %&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/views/books/_form.html.erb\" rel=\"nofollow noreferrer\">app/views/books/<strong>_form.html.erb</strong></a></p>\n\n<pre><code>&lt;%= form_with(model: @book, url: [@series, @book], local: true) do |form| %&gt;\n  &lt;%= form.label :series_number %&gt;\n  &lt;%= form.number_field :series_number %&gt;\n\n  &lt;%= form.label :year_published %&gt;\n  &lt;%= form.number_field :year_published %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/tliss/lianhuanhua/blob/master/app/controllers/books_controller.rb\" rel=\"nofollow noreferrer\">app/controllers/<strong>books_controller.rb</strong></a></p>\n\n<pre><code>class BooksController &lt; ApplicationController\n  def index\n    @books = Book.all\n  end\n\n  def show\n    @book = Book.find(params[:id])\n  end\n\n  def new\n    @book = Book.new\n  end\n\n  def edit\n    @series = Series.find(params[:series_id])\n    @book = @series.books.find(params[:id])\n  end\n\n  def create\n    @series = Series.find(params[:series_id])\n    @book = @series.books.create(book_params)\n    redirect_to series_path(@series)\n  end\n\n  def destroy\n    @series = Series.find(params[:series_id])\n    @book = @series.books.find(params[:id])\n    @book.destroy\n    redirect_to series_path(@series)\n  end\n\n  private\n    def book_params\n      params.require(:book).permit(:year_published, :series_number)\n    end\nend\n</code></pre>\n\n<h1>Routes</h1>\n\n<pre><code>          Prefix Verb   URI Pattern                                 Controller#Action\n        articles GET    /articles(.:format)                         articles#index\n                 POST   /articles(.:format)                         articles#create\n     new_article GET    /articles/new(.:format)                     articles#new\n    edit_article GET    /articles/:id/edit(.:format)                articles#edit\n         article GET    /articles/:id(.:format)                     articles#show\n                 PATCH  /articles/:id(.:format)                     articles#update\n                 PUT    /articles/:id(.:format)                     articles#update\n                 DELETE /articles/:id(.:format)                     articles#destroy\n    series_books GET    /series/:series_id/books(.:format)          books#index\n                 POST   /series/:series_id/books(.:format)          books#create\n new_series_book GET    /series/:series_id/books/new(.:format)      books#new\nedit_series_book GET    /series/:series_id/books/:id/edit(.:format) books#edit\n     series_book GET    /series/:series_id/books/:id(.:format)      books#show\n                 PATCH  /series/:series_id/books/:id(.:format)      books#update\n                 PUT    /series/:series_id/books/:id(.:format)      books#update\n                 DELETE /series/:series_id/books/:id(.:format)      books#destroy\n    series_index GET    /series(.:format)                           series#index\n                 POST   /series(.:format)                           series#create\n      new_series GET    /series/new(.:format)                       series#new\n     edit_series GET    /series/:id/edit(.:format)                  series#edit\n          series GET    /series/:id(.:format)                       series#show\n                 PATCH  /series/:id(.:format)                       series#update\n                 PUT    /series/:id(.:format)                       series#update\n                 DELETE /series/:id(.:format)                       series#destroy\n</code></pre>\n"}, {"tags": ["ruby", "rubymine", "editorconfig"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1554825452, "post_id": 55596045, "comment_id": 97890204, "body": "RubyMine does not know that <code>.m2</code> is going to be a continuation of <code>variable.m1</code> when you press return. You could try <code>variable.m1.</code> (note the trailing dot) which will allow you to adjust the indentation for continuations however other than in irb most people do not use this style as is can be missed"}], "answers": [{"tags": [], "owner": {"reputation": 1955, "user_id": 2193416, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4173555c6bc153846714c964c0cd8a19?s=128&d=identicon&r=PG", "display_name": "dug", "link": "https://stackoverflow.com/users/2193416/dug"}, "is_accepted": false, "score": 0, "last_activity_date": 1554829261, "creation_date": 1554829261, "answer_id": 55597834, "question_id": 55596045, "link": "https://stackoverflow.com/questions/55596045/align-multiple-method-calls-for-ruby-in-rubymine/55597834#55597834", "title": "Align multiple method calls for Ruby in RubyMine", "body": "<p>It isn't currently supported, but there is an open ticket: <a href=\"https://youtrack.jetbrains.com/issue/RUBY-17293\" rel=\"nofollow noreferrer\">RUBY-17293</a> \n(The specific alignment style you're looking for was filed as <a href=\"https://youtrack.jetbrains.com/issue/RUBY-18797\" rel=\"nofollow noreferrer\">RUBY-18797</a>, but it was closed as a duplicate).\nA comment indicates that it was planned for the 2019.1 release, but it doesn't appear to have made it in. (You can vote for the ticket if you make a YouTrack account, but I don't how that influences issue priorities.)\nOne option in the interim would be to use Rubocop <a href=\"https://blog.jetbrains.com/ruby/2017/07/rubymine-2017-2-release-candidate-quick-fixes-for-rubocop/\" rel=\"nofollow noreferrer\">quick-fixes</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 10574445, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217399386478250/picture?type=large", "display_name": "Andrey Aksyonov", "link": "https://stackoverflow.com/users/10574445/andrey-aksyonov"}, "is_accepted": false, "score": 1, "last_activity_date": 1585820045, "last_edit_date": 1585820045, "creation_date": 1585733239, "answer_id": 60967648, "question_id": 55596045, "link": "https://stackoverflow.com/questions/55596045/align-multiple-method-calls-for-ruby-in-rubymine/60967648#60967648", "title": "Align multiple method calls for Ruby in RubyMine", "body": "<p>Starting with 2019.3, RubyMine has an option for aligning chained method calls by the initial receiver or leading dots for the Ruby language. You can configure it in the same way as for JavaScript: open the <strong>Settings/Preferences | Editor | Code Style | Ruby | Wrapping and Braces</strong>  page and go to the <strong>Chained method calls | Alignment</strong> option.</p>\n"}], "owner": {"reputation": 21, "user_id": 7420451, "user_type": "registered", "profile_image": "https://graph.facebook.com/760975707384633/picture?type=large", "display_name": "Denys Husiev", "link": "https://stackoverflow.com/users/7420451/denys-husiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1585820045, "creation_date": 1554822797, "question_id": 55596045, "link": "https://stackoverflow.com/questions/55596045/align-multiple-method-calls-for-ruby-in-rubymine", "title": "Align multiple method calls for Ruby in RubyMine", "body": "<p>We use rubocop in our project and it enforces us to align our chain method calls. I used to use RubyMine linter, but it places methods with indent of 2 spaces from beginning of variable.</p>\n\n<p>I tried to find this setting in Preferences > Editor > Code Style > Ruby, but seems they don't have this option for Ruby.</p>\n\n<p>JavaScript has this under Preferences > Editor > Code Style > JavaScript > Wrapping and Braces > Chained method calls > Align when multiline</p>\n\n<pre><code># bad\nvariable.m1\n  .m2\n  .m3\n\n# good\nvariable.m1\n        .m2\n        .m3\n</code></pre>\n\n<p>Do we have this option in RubyMine? Or how can we add some custom .editorconfig setting for this? Or maybe there are other options?</p>\n"}, {"tags": ["ruby", "bitcoin"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1554827748, "post_id": 55595070, "comment_id": 97891363, "body": "The output from your exception seems to be missing something. Did you omit some lines? In particular, I don&#39;t see any line corresponding to your own code."}, {"owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1554880717, "post_id": 55595070, "comment_id": 97908333, "body": "@MichaelHampton me neither, and this is the problem..."}], "answers": [{"tags": [], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "is_accepted": true, "score": 0, "last_activity_date": 1554909069, "creation_date": 1554909069, "answer_id": 55615967, "question_id": 55595070, "link": "https://stackoverflow.com/questions/55595070/why-i-cant-sign-a-bitcoin-transaction-in-ruby/55615967#55615967", "title": "Why I can&#39;t sign a Bitcoin transaction in Ruby?", "body": "<p>The problem was with the format of the script. This code works:</p>\n\n<pre><code>utxo = # coming from https://www.blockchain.info/api/unspent\n  builder.input do |i|\n    i.prev_out(utxo['tx_hash_big_endian'])\n    i.prev_out_index(utxo['tx_output_n'])\n    i.prev_out_script = [utxo['script']].pack('H*')\n    i.signature_key(key)\n  end\n</code></pre>\n"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55615967, "answer_count": 1, "score": 0, "last_activity_date": 1554909069, "creation_date": 1554819725, "last_edit_date": 1554820133, "question_id": 55595070, "link": "https://stackoverflow.com/questions/55595070/why-i-cant-sign-a-bitcoin-transaction-in-ruby", "title": "Why I can&#39;t sign a Bitcoin transaction in Ruby?", "body": "<p>What is wrong with my code (I'm using <a href=\"https://github.com/lian/bitcoin-ruby\" rel=\"nofollow noreferrer\">this gem</a>)?</p>\n\n<pre><code>require 'bitcoin'\ninclude Bitcoin::Builder\nkey = Bitcoin::Key.from_base58('...')\ntxn = build_tx do |tx|\n  tx.input do |i|\n    i.prev_out(Bitcoin::P::Tx.from_hash(...))\n    i.prev_out_index(0)\n    i.signature_key(Bitcoin::Key.from_base58(...))\n  end\n  tx.output do |o|\n    o.value(50000)\n    o.to('1GzqkR2zNQUzHLpE7PLPjVNJ51FHC3bpDH')\n  end\nend\n</code></pre>\n\n<p>I'm getting:</p>\n\n<pre><code>RuntimeError: Script type must be hash160, pubkey, p2wpkh or multisig\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:239:in `sig_hash_and_all_keys_exist?'\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:308:in `sign_input'\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:208:in `block in tx'\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:207:in `each'\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:207:in `each_with_index'\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:207:in `tx'\n    /Users/yegor/.rvm/gems/ruby-2.6.0/gems/bitcoin-ruby-0.0.19/lib/bitcoin/builder.rb:21:in `build_tx'\n</code></pre>\n\n<p>What am I doing wrong? BTW, no matter what private key I provide to the <code>signature_key</code> I get the same error. If I remove the line with <code>singature_key</code>, I get no error.</p>\n\n<p>I submitted a ticket to their repo too: <a href=\"https://github.com/lian/bitcoin-ruby/issues/287\" rel=\"nofollow noreferrer\">https://github.com/lian/bitcoin-ruby/issues/287</a></p>\n"}, {"tags": ["ruby", "encoding", "python-3.7"], "comments": [{"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1554820813, "post_id": 55594097, "comment_id": 97887380, "body": "<a href=\"https://stackoverflow.com/questions/21614228/what-is-the-difference-between-encode-and-force-encoding-in-ruby\">Here</a> a post to help you understand difference between <code>encoding</code> and <code>force_encoding</code>."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1554820947, "post_id": 55594097, "comment_id": 97887456, "body": "And <a href=\"https://stackoverflow.com/questions/47077798/python-to-ruby-conversion-stuck-on-the-equivalent\">here</a> an example for help you in conversion."}, {"owner": {"reputation": 1, "user_id": 7026817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41706849bb0c0e74a0e55abd0e73a278?s=128&d=identicon&r=PG", "display_name": "Parth Mandaliya", "link": "https://stackoverflow.com/users/7026817/parth-mandaliya"}, "reply_to_user": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1554827333, "post_id": 55594097, "comment_id": 97891161, "body": "Thanks, @Nifriz but I&#39;ve read those posts. I&#39;m looking for the method in Python which does not change the representation of the string in memory if there is any or any other programmatical way to implement the same."}], "owner": {"reputation": 1, "user_id": 7026817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41706849bb0c0e74a0e55abd0e73a278?s=128&d=identicon&r=PG", "display_name": "Parth Mandaliya", "link": "https://stackoverflow.com/users/7026817/parth-mandaliya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554816597, "creation_date": 1554816597, "question_id": 55594097, "link": "https://stackoverflow.com/questions/55594097/ruby-to-python-conversion-stuck-on-the-equivalent", "title": "Ruby to Python conversion stuck on the equivalent", "body": "<p>I'm converting a project from Ruby to Python. There is a force_encoding method used in Ruby. I'm stuck there not able to find anything equivalent in Python.</p>\n\n<p>I've tried to use the encode method but it changes the representation of the string in memory itself.</p>\n\n<pre><code>callback = lambda do |context, kb, k|\n    yield(k.get_bytes(0, kb).force_encoding(encoding))\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554813573, "post_id": 55591823, "comment_id": 97882605, "body": "Can you check this <a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-edit-their-password\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise/wiki/&hellip;</a>"}, {"owner": {"reputation": 119, "user_id": 8319323, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344036448998167/picture?type=large", "display_name": "Anatolii Stupin", "link": "https://stackoverflow.com/users/8319323/anatolii-stupin"}, "reply_to_user": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554820208, "post_id": 55591823, "comment_id": 97887010, "body": "Thank you! I have already add this functionality to my app. My question was about resetting password by admin and then set new password by user. (as wanted my employer).  I have solved this problem too. I just added skip_before_action :require_no_authentication to PasswordsController.rb."}], "answers": [{"tags": [], "owner": {"reputation": 1244, "user_id": 1042324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf7d96c6cd1ad77fd77a1331b264819?s=128&d=identicon&r=PG", "display_name": "daniloisr", "link": "https://stackoverflow.com/users/1042324/daniloisr"}, "is_accepted": true, "score": 1, "last_activity_date": 1554820872, "creation_date": 1554820872, "answer_id": 55595443, "question_id": 55591823, "link": "https://stackoverflow.com/questions/55591823/require-no-authentication-filter-when-reset-user-password/55595443#55595443", "title": ":require_no_authentication filter when reset user password", "body": "<p>This behavior is correct.</p>\n\n<p>The \"Reset password\" page is used only to recover the password, so if the user is already logged the page isn't shown. Logged users can use the route <code>/users/edit</code> to edit their password.</p>\n\n<p>Here is how Devise's recover password controller prevent logged user from accessing the \"Reset Password\" page:</p>\n\n<ul>\n<li><a href=\"https://github.com/plataformatec/devise/blob/715192a7709a4c02127afb067e66230061b82cf2/app/controllers/devise/passwords_controller.rb#L4\" rel=\"nofollow noreferrer\">controllers/devise/passwords_controller.rb#L4</a>\n\n<ul>\n<li>Calls <code>require_no_authentication</code></li>\n</ul></li>\n<li><a href=\"https://github.com/plataformatec/devise/blob/715192a7709a4c02127afb067e66230061b82cf2/app/controllers/devise_controller.rb#L114-L116\" rel=\"nofollow noreferrer\">devise_controller.rb#L114-L116</a>\n\n<ul>\n<li>Detects the logged user and redirects to <code>after_sign_in_path_for</code> path</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 119, "user_id": 8319323, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344036448998167/picture?type=large", "display_name": "Anatolii Stupin", "link": "https://stackoverflow.com/users/8319323/anatolii-stupin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 55595443, "answer_count": 1, "score": 1, "last_activity_date": 1554820872, "creation_date": 1554809358, "last_edit_date": 1554814688, "question_id": 55591823, "link": "https://stackoverflow.com/questions/55591823/require-no-authentication-filter-when-reset-user-password", "title": ":require_no_authentication filter when reset user password", "body": "<p>I have trouble with password resetting in my application.\nOn clicking \"Reset password\" button, I get an email \"Reset password instructions\" with link to \"Reset password\".</p>\n\n<p>When signed in -\nIf I click on reset password link from the email, it is redirected to root path, not password reset page.</p>\n\n<p>When logged out - \nAfter logging out from my app, and then click on reset password link from the email, it redirects to edit password page.</p>\n\n<p>Following this instructions - (<a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Redirect-URL-after-sending-reset-password-instructions\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/wiki/How-To:-Redirect-URL-after-sending-reset-password-instructions</a>) </p>\n\n<p>Passwords controller:</p>\n\n<pre><code>class Users::PasswordsController &lt; Devise::PasswordsController\n\n  protected\n\n  def after_sending_reset_password_instructions_path_for(resource_name)\n    edit_user_registration_path\n  end\n\nend\n</code></pre>\n\n<p>config/routes.rb:</p>\n\n<pre><code>devise_for :users, controllers: { passwords: 'passwords' }\n</code></pre>\n\n<p>But still getting the same error. Console log:</p>\n\n<pre><code>Started GET \"/users/password/edit?reset_password_token=[FILTERED]\" for 127.0.0.1 at 2019-04-09 13:59:26 +0300\nProcessing by Users::PasswordsController#edit as HTML\n  Parameters: {\"reset_password_token\"=&gt;\"[FILTERED]\"}\n  User Load (0.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 10], [\"LIMIT\", 1]]\n  \u21b3 /home/anatoly/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98\nRedirected to http://localhost:3000/\nFilter chain halted as :require_no_authentication rendered or redirected\nCompleted 302 Found in 2ms (ActiveRecord: 0.3ms)\n</code></pre>\n\n<p>Can anyone help me?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557828620, "post_id": 55591372, "comment_id": 98887291, "body": "Did you customise the rails generator template by any chance?"}, {"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "reply_to_user": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "edited": false, "score": 0, "creation_date": 1557830645, "post_id": 55591372, "comment_id": 98888412, "body": "No I haven&#39;t done anything like that"}, {"owner": {"reputation": 380, "user_id": 2398842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92be0029d1e7c51ca6726df4499dbf3?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Coelho", "link": "https://stackoverflow.com/users/2398842/jos%c3%a9-coelho"}, "edited": false, "score": 0, "creation_date": 1557869301, "post_id": 55591372, "comment_id": 98908480, "body": "Would it be possible to share your Gemfile? Is this a new project? If not, could you try to replicate creating a new project? <code>rails new test_generators</code>"}, {"owner": {"reputation": 145, "user_id": 8229753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22660980995e03dfd59812c9acf93db8?s=128&d=identicon&r=PG&f=1", "display_name": "Ketan Mangukiya", "link": "https://stackoverflow.com/users/8229753/ketan-mangukiya"}, "edited": false, "score": 0, "creation_date": 1557900401, "post_id": 55591372, "comment_id": 98915319, "body": "I think, you should try with Creating new Project by   <code>rails new _project_name</code> and try with same command <code>rails g controller supprefresh index process</code>  if it create same issue, than may be issue with your system."}], "owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1557910206, "creation_date": 1554807933, "last_edit_date": 1554836379, "question_id": 55591372, "link": "https://stackoverflow.com/questions/55591372/generating-rails-controller-starts-up-the-server-afterwards", "title": "Generating rails controller starts up the server afterwards", "body": "<p>Every time I try to generate a rails controller in windows it starts up the server after generating the necessary file.</p>\n\n<pre><code>$ rails g controller supprefresh index process                                                                \nio/console not supported; tty will not be manipulated                                                         \nC:/Rubies/jruby-1.7.9/lib/ruby/shared/Win32API.rb:11 warning: warning: variable $KCODE is no longer effective \n      create  app/controllers/supprefresh_controller.rb                                                       \n       route  get \"supprefresh/process\"                                                                       \n       route  get \"supprefresh/index\"                                                                         \n      invoke  erb                                                                                             \n      create    app/views/supprefresh                                                                         \n      create    app/views/supprefresh/index.html.erb                                                          \n      create    app/views/supprefresh/process.html.erb                                                        \n      invoke  rspec                                                                                           \n      create    spec/controllers/supprefresh_controller_spec.rb                                               \n      create    spec/views/supprefresh                                                                        \n      create    spec/views/supprefresh/index.html.erb_spec.rb                                                 \n      create    spec/views/supprefresh/process.html.erb_spec.rb                                               \n      invoke  helper                                                                                          \n      create    app/helpers/supprefresh_helper.rb                                                             \n      invoke    rspec                                                                                         \n      create      spec/helpers/supprefresh_helper_spec.rb                                                     \n      invoke  assets                                                                                          \n      invoke    coffee                                                                                        \n      create      app/assets/javascripts/supprefresh.js.coffee                                                \n      invoke    scss                                                                                          \n      create      app/assets/stylesheets/supprefresh.css.scss                                                 \n[2019-04-09 16:18:34] INFO  WEBrick 1.3.1                                                                     \n[2019-04-09 16:18:34] INFO  ruby 2.0.0 (2013-12-06) [java]                                                    \n[2019-04-09 16:18:34] WARN  TCPServer Error: Address already in use - bind - Address already in use: bind     \n== Someone is already performing on port 4567!                                       \n</code></pre>\n\n<p>I'm running rails 4 with jruby 1.7 on windows</p>\n\n<p>What is the reason for this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11333061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf4303ff35b8750818e432dd034991b?s=128&d=identicon&r=PG&f=1", "display_name": "edmunteanu", "link": "https://stackoverflow.com/users/11333061/edmunteanu"}, "edited": false, "score": 0, "creation_date": 1554811505, "post_id": 55590866, "comment_id": 97881400, "body": "Thank you! The first option works just fine, but regarding the second one I have a question: How do I prevent <code>BusinessType.all</code> from returning an array instead of the class itself?"}, {"owner": {"reputation": 53, "user_id": 11333061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf4303ff35b8750818e432dd034991b?s=128&d=identicon&r=PG&f=1", "display_name": "edmunteanu", "link": "https://stackoverflow.com/users/11333061/edmunteanu"}, "edited": false, "score": 0, "creation_date": 1554812988, "post_id": 55590866, "comment_id": 97882256, "body": "Never mind, after a little bit of digging I found out that I can call <code>.class</code> at the end. Thanks a lot again for your explanation!"}, {"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "reply_to_user": {"reputation": 53, "user_id": 11333061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf4303ff35b8750818e432dd034991b?s=128&d=identicon&r=PG&f=1", "display_name": "edmunteanu", "link": "https://stackoverflow.com/users/11333061/edmunteanu"}, "edited": false, "score": 0, "creation_date": 1554814324, "post_id": 55590866, "comment_id": 97883098, "body": "You are right! I just forgot to add <code>.class</code> there. Thank you for noticing! I&#39;ve fixed the answer."}], "tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": true, "score": 2, "last_activity_date": 1554814338, "last_edit_date": 1554814338, "creation_date": 1554806286, "answer_id": 55590866, "question_id": 55589454, "link": "https://stackoverflow.com/questions/55589454/how-to-fix-uninitialised-constant-activerecord-relation-in-rails-5-1-7/55590866#55590866", "title": "How to fix `uninitialised constant &#39;ActiveRecord_Relation&#39;` in Rails 5.1.7?", "body": "<p>The problem is that the <code>ActiveRecord_Relation</code> is defined as a private constant inside <code>BusinessType</code>. You can't reference it outside of <code>BusinessType</code>.</p>\n\n<p><a href=\"https://www.rubydoc.info/stdlib/core/Module:private_constant\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/stdlib/core/Module:private_constant</a></p>\n\n<p><a href=\"https://github.com/rails/rails/blob/f40860800c231ecd1daef6cf6b5a8a8eda76478d/activerecord/lib/active_record/relation/delegation.rb#L25\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/f40860800c231ecd1daef6cf6b5a8a8eda76478d/activerecord/lib/active_record/relation/delegation.rb#L25</a></p>\n\n<p>However you can reference it like this:</p>\n\n<pre><code>BusinessTypes.const_get(\"ActiveRecord_Relation\")\n</code></pre>\n\n<p>But I wouldn't reference it in the tests that way. I think a better way is:</p>\n\n<pre><code>expect(BusinessTypes::Index).to receive(:new).with(kind_of(BusinessType.all.class), # ...\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11333061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf4303ff35b8750818e432dd034991b?s=128&d=identicon&r=PG&f=1", "display_name": "edmunteanu", "link": "https://stackoverflow.com/users/11333061/edmunteanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 55590866, "answer_count": 1, "score": 5, "last_activity_date": 1554814338, "creation_date": 1554802068, "question_id": 55589454, "link": "https://stackoverflow.com/questions/55589454/how-to-fix-uninitialised-constant-activerecord-relation-in-rails-5-1-7", "title": "How to fix `uninitialised constant &#39;ActiveRecord_Relation&#39;` in Rails 5.1.7?", "body": "<h2>Problem at hand</h2>\n\n<p>I'm currently upgrading the Rails version in one of our projects from 5.0.7 to 5.1.7, but I can't seem to find an explanation as to why the previously working call <code>BusinessTypes::ActiveRecord_Relation</code> doesn't work anymore. This call is performed as part of a spec, in order to check if the controller properly initialises a view model with the correct arguments (and an <code>ActiveRecord::Relation</code> with the correct class).</p>\n\n<h2>What I've tried</h2>\n\n<ol>\n<li>I've tried to check the source code / file using the rails console, but to no avail, because I didn't seem to find any source. I've tried following commands: \n\n<ul>\n<li><code>show-source BusinessTypes::ActiveRecord_Relation</code></li>\n<li><code>BusinessTypes::ActiveRecord_Relation.source_location</code></li>\n</ul></li>\n<li>I've tried searching the <code>ActiveRecord_Relation</code> subclass on Google and in the Rails repos (5.0-stable and 5.1-stable), but I didn't find anything, only the <code>ActiveRecord::Relation</code> class itself, which didn't really help with my problem.</li>\n<li>I've checked also the changelog, but nothing made me think that it had an impact on this.</li>\n</ol>\n\n<h2>Code insight</h2>\n\n<p>The tested method <code>BusinessTypes#index</code> looks like this:</p>\n\n<pre><code>def index\n  @vm = BusinessTypes::Index.new(@business_types.all, current_user, address_confirmed: address_confirmed?)\nend\n</code></pre>\n\n<p>The faulty spec looks like this:</p>\n\n<pre><code>let(:user) { create(:user) }\n\ndescribe 'GET #index' do\n  it 'initialises the view model with the correct arguments' do\n    expect(BusinessTypes::Index).to receive(:new)\n      .with(kind_of(BusinessType::ActiveRecord_Relation), user, address_confirmed: true)\n    get :index\n  end\n\n  context 'user has not confirmed his address' do\n    let(:user) { create(:user, address_confirmed_at: nil) }\n\n    it 'initialises the view model with the correct arguments' do\n      expect(BusinessTypes::Index).to receive(:new)\n        .with(kind_of(BusinessType::ActiveRecord_Relation), user, address_confirmed: false)\n      get :index\n    end\n  end\nend\n</code></pre>\n\n<h2>Expected vs. actual result</h2>\n\n<h3>Rails version 5.0.7</h3>\n\n<p>This test would pass because <code>kind_of(BusinessTypes::ActiveRecord_Relation)</code> would return an object <code>#&lt;RSpec::Mocks::ArgumentMatchers::KindOf:0x00007fe52529ae20 @klass=BusinessType::ActiveRecord_Relation&gt;</code> which coincides with the object the controller gets passed as an argument.</p>\n\n<h3>Rails version 5.1.7</h3>\n\n<p>I get the following error: <code>NameError: uninitialized constant BusinessTypes::ActiveRecord_Relation</code></p>\n\n<p>The only thing that has changed between the two cases is the Rails version. Have I overseen something? Thank you for your time!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "comments": [{"owner": {"reputation": 769, "user_id": 3553665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EQPSk.jpg?s=128&g=1", "display_name": "jaspreet21anand", "link": "https://stackoverflow.com/users/3553665/jaspreet21anand"}, "edited": false, "score": 0, "creation_date": 1554800196, "post_id": 55588739, "comment_id": 97874602, "body": "refer {<a href=\"https://stackoverflow.com/questions/2249431/put-a-link-in-a-flashnotice\" title=\"put a link in a flashnotice\">stackoverflow.com/questions/2249431/put-a-link-in-a-flashno&zwnj;&#8203;tice</a>}"}, {"owner": {"reputation": 61, "user_id": 11332662, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c5yYkn4RpQ0/AAAAAAAAAAI/AAAAAAAAABA/XQjUN1zaWXk/photo.jpg?sz=128", "display_name": "gisha gireesh", "link": "https://stackoverflow.com/users/11332662/gisha-gireesh"}, "edited": false, "score": 0, "creation_date": 1554801654, "post_id": 55588739, "comment_id": 97875469, "body": "I had already tried this, but it didn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": true, "score": 5, "last_activity_date": 1554809214, "creation_date": 1554809214, "answer_id": 55591777, "question_id": 55588739, "link": "https://stackoverflow.com/questions/55588739/add-link-to-a-flash-notice-in-rails-activeadmin-view/55591777#55591777", "title": "Add link to a flash notice in Rails ActiveAdmin view", "body": "<p>The only way (probably not a good one) to achieve your purpose is to override <code>activeadmin</code>'s <code>:build_flash_messages</code> method which generates flash messages.</p>\n\n<p><a href=\"https://github.com/activeadmin/activeadmin/blob/14d6e500c777e82111faafe9392d90a6efed7e0b/lib/active_admin/views/pages/base.rb#L86\" rel=\"noreferrer\">https://github.com/activeadmin/activeadmin/blob/14d6e500c777e82111faafe9392d90a6efed7e0b/lib/active_admin/views/pages/base.rb#L86</a></p>\n\n<p>This is the overridden version (added <code>.html_safe</code>). Place this code somewhere in initializers.  </p>\n\n<pre><code>class ActiveAdmin::Views::Pages::Base\n  def build_flash_messages\n    div class: 'flashes' do\n      flash_messages.each do |type, message|\n        div message.html_safe, class: \"flash flash_#{type}\"\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11332662, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c5yYkn4RpQ0/AAAAAAAAAAI/AAAAAAAAABA/XQjUN1zaWXk/photo.jpg?sz=128", "display_name": "gisha gireesh", "link": "https://stackoverflow.com/users/11332662/gisha-gireesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 2, "accepted_answer_id": 55591777, "answer_count": 1, "score": 5, "last_activity_date": 1554809500, "creation_date": 1554799974, "last_edit_date": 1554809500, "question_id": 55588739, "link": "https://stackoverflow.com/questions/55588739/add-link-to-a-flash-notice-in-rails-activeadmin-view", "title": "Add link to a flash notice in Rails ActiveAdmin view", "body": "<p>I am trying to add a link in a flash message on successful create action of active-admin controller.But the HTML of the link is being escaped and  displayed as plain text on view.</p>\n\n<p>Rails 5.2.1, ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-linux]</p>\n\n<p>eg: If I try to do</p>\n\n<pre><code>flash[:success] = \"Complete this quick survey. &lt;a href='#{url}'&gt;Click here&lt;/a&gt;\".html_safe\n</code></pre>\n\n<p>The flash message is displayed as,</p>\n\n<pre><code>\"Complete this quick survey. &lt;a href='https://www.example.com'&gt;Click here&lt;/a&gt;\"\n</code></pre>\n\n<p>Expected behaviour: There should be a working link in the flash message</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1554790703, "post_id": 55586173, "comment_id": 97869659, "body": "Can you please explain your exact situation (with code preferably). If users are able to update the record with empty values (that you don&#39;t want to be empty), then it is a validation issue."}, {"owner": {"reputation": 2202, "user_id": 3607039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8Bj3I.jpg?s=128&g=1", "display_name": "Bustikiller", "link": "https://stackoverflow.com/users/3607039/bustikiller"}, "edited": false, "score": 0, "creation_date": 1554791065, "post_id": 55586173, "comment_id": 97869810, "body": "Maybe you can use an ActiveRecord callback to avoid updating the record in the database. You can use changed? (<a href=\"https://apidock.com/rails/ActiveRecord/Dirty/changed%3F\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/Dirty/changed%3F</a>) within a <code>before_update</code> callback and <code>throw :abort</code> to intentionally stop the callback chain."}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554972218, "post_id": 55586173, "comment_id": 97948124, "body": "@JamesLovesPython can you validate the answer?"}], "answers": [{"comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1554799982, "post_id": 55586815, "comment_id": 97874476, "body": "Please dont write custom update method :) <a href=\"https://davidverhasselt.com/set-attributes-in-activerecord/\" rel=\"nofollow noreferrer\"><code>There are bunch of ways you can update record with AR</code></a>"}, {"owner": {"reputation": 121, "user_id": 8966048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf89754b257bb9841a3256799973104?s=128&d=identicon&r=PG&f=1", "display_name": "JamesLovesPython", "link": "https://stackoverflow.com/users/8966048/jameslovespython"}, "edited": false, "score": 0, "creation_date": 1555025853, "post_id": 55586815, "comment_id": 97975271, "body": "Hi, I believe the reason for this behaviour is that I had set drop down fields that contained values that were not in the DB. Therefore when the page populates and you click update client, it would see that these fields had changed (because the actual values in the db were not getting filled in, due to not being in these lists). This would allow the update query to run. Will update my lists to accommodate for this. Thanks for all the assistance."}], "tags": [], "owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "is_accepted": true, "score": 5, "last_activity_date": 1554793167, "creation_date": 1554793167, "answer_id": 55586815, "question_id": 55586173, "link": "https://stackoverflow.com/questions/55586173/preventing-update-of-record-in-rails-app-where-no-fields-are-changed/55586815#55586815", "title": "Preventing UPDATE of record in Rails app where no fields are changed", "body": "<p>By default in Rails UPDATE method will be executed only if any one of the value is modified. If no field value is modified the UPDATE method will not run the query, just check and returns the result.</p>\n\n<p>I will give examples for the same. I have an organisation model , in which I initially updated the record with the same existing field values:</p>\n\n<p><a href=\"https://i.stack.imgur.com/I75uu.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/I75uu.png\" alt=\"Postman update request\"></a>\n<a href=\"https://i.stack.imgur.com/hRUnn.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/hRUnn.png\" alt=\"console log for first update(no values changed)\"></a></p>\n\n<p>I just modified one of the field values - internal status\n<a href=\"https://i.stack.imgur.com/fAgu8.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/fAgu8.png\" alt=\"console log where only modified value is updated\"></a>\n<a href=\"https://i.stack.imgur.com/GAbOm.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/GAbOm.png\" alt=\"Postman update request for new value\"></a></p>\n\n<p><strong>Note</strong>: In update it is better to send the old values to avoid empty values being stored in the database.Update expects all the params defined in 'client_params' in your case. If empty params are sent, include a nil check or validation to avoid the same. You can also write a custom update method for the same.</p>\n"}, {"tags": [], "owner": {"reputation": 470, "user_id": 1419458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40be82026a81f18a2bbbaad209694e0?s=128&d=identicon&r=PG", "display_name": "Stanko Krtali\u0107 Rusendi\u0107", "link": "https://stackoverflow.com/users/1419458/stanko-krtali%c4%87-rusendi%c4%87"}, "is_accepted": false, "score": 2, "last_activity_date": 1554793233, "creation_date": 1554793233, "answer_id": 55586836, "question_id": 55586173, "link": "https://stackoverflow.com/questions/55586173/preventing-update-of-record-in-rails-app-where-no-fields-are-changed/55586836#55586836", "title": "Preventing UPDATE of record in Rails app where no fields are changed", "body": "<p>You can use the <code>attributes=</code> and <code>changed?</code> methods in conjunction to accomplish your goal.</p>\n\n<p><code>attributes=</code> mass assigns values from a hash to an instance of a model.\n<code>changed?</code> returns true if any value on the model changed it's value.</p>\n\n<p>Take the following example:</p>\n\n<pre><code>[1] pry(main)&gt; u = User.all.sample # this returns a random user\n=&gt; #&lt;User id: 1319, email: \"bob@test.com\"&gt;\n[2] pry(main)&gt; u.changed?\n=&gt; false\n[3] pry(main)&gt; u.attributes = { email: \"bob@test.com\" }\n=&gt; {:email=&gt;\"bob@test.com\"}\n[4] pry(main)&gt; u.changed?\n=&gt; false\n[5] pry(main)&gt; u.email\n=&gt; \"bob@test.com\"\n[6] pry(main)&gt; u.attributes = { email: \"alice@test.com\" }\n=&gt; {:email=&gt;\"alice@test.com\"}\n[7] pry(main)&gt; u.changed?\n=&gt; true\n[8] pry(main)&gt; u.email\n=&gt; \"alice@test.com\"\n[9] pry(main)&gt; u.save\n=&gt; true\n</code></pre>\n\n<p>When applied to your code snippet.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def update\n  @client.attributes = client_params\n\n  if @client.changed? &amp;&amp; @client.save\n    redirect_to @client, notice: 'Client was successfully updated.'\n  else\n    render :edit\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 11094356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36488439a836bc8c5969bdac74e8aa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragya Sriharsh", "link": "https://stackoverflow.com/users/11094356/pragya-sriharsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1554810030, "last_edit_date": 1554810030, "creation_date": 1554808419, "answer_id": 55591537, "question_id": 55586173, "link": "https://stackoverflow.com/questions/55586173/preventing-update-of-record-in-rails-app-where-no-fields-are-changed/55591537#55591537", "title": "Preventing UPDATE of record in Rails app where no fields are changed", "body": "<p>No need to add custom conditions to check whether your attributes have been modified or not because <strong>Rails handles ByDefault</strong>.</p>\n\n<p>If modified Active Record object has been retrieved then it will be saved to the database Otherwise no operation will be performed. For better understanding, you can check your console by yourself by running the both queries.</p>\n\n<p>For preventing the empty values being stored in the database. Please check that whether you are using 'PATCH' method types for updating the record or not. </p>\n\n<p>Because it is possible only in one condition: </p>\n\n<blockquote>\n  <p>using 'PUT' method for updating the record and supply only modified 'key-pair' attributes to\n  the rails. Rails will save the other non-specified 'key-value'\n  attributes with empty values.</p>\n</blockquote>\n\n<p>In Rails, we have two method types for \"Update\" method.</p>\n\n<ol>\n<li>PUT  </li>\n</ol>\n\n<blockquote>\n  <p><em>(update all or just a portion of the record.)</em></p>\n</blockquote>\n\n<ol start=\"2\">\n<li>PATCH  </li>\n</ol>\n\n<blockquote>\n  <p><em>can only update a partial record</em></p>\n</blockquote>\n\n<p>To follow better HTTP semantics, Rails will be using the HTTP verb PATCH for updates. PATCH allows for both full and partial updates of a resource, and is more suited to how Rails updates resources.If you are upgrading an existing Rails application, the HTTP verb PUT will still map to the update action in\nRESTful routes, but it\u2019s recommended to use PATCH moving forward.</p>\n"}, {"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": false, "score": 1, "last_activity_date": 1554939482, "creation_date": 1554939482, "answer_id": 55622718, "question_id": 55586173, "link": "https://stackoverflow.com/questions/55586173/preventing-update-of-record-in-rails-app-where-no-fields-are-changed/55622718#55622718", "title": "Preventing UPDATE of record in Rails app where no fields are changed", "body": "<p>Are you able to pre fill your form with the existing values? This way if update is pressed the form will send what was there before instead of blank values and the record will not be filled with blank data. Its also good UX to show users the existing values in edit forms.</p>\n"}], "owner": {"reputation": 121, "user_id": 8966048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf89754b257bb9841a3256799973104?s=128&d=identicon&r=PG&f=1", "display_name": "JamesLovesPython", "link": "https://stackoverflow.com/users/8966048/jameslovespython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3418, "favorite_count": 0, "accepted_answer_id": 55586815, "answer_count": 4, "score": 0, "last_activity_date": 1554939482, "creation_date": 1554790394, "last_edit_date": 1554790496, "question_id": 55586173, "link": "https://stackoverflow.com/questions/55586173/preventing-update-of-record-in-rails-app-where-no-fields-are-changed", "title": "Preventing UPDATE of record in Rails app where no fields are changed", "body": "<p>I'm looking for a way to prevent users from clicking update for the Update method in my Rails app when they have not changed any values. If they do not change any values, my UPDATE method will write empty values in some of the fields, therefore if the user doesn't change any details and just clicks update, I need the app to prevent from updating the record.</p>\n\n<p>Any suggestions would be greatly appreciated.</p>\n\n<p>FYI this is standard cookie cutter Update method:</p>\n\n<pre><code>def update\n    if @client.update(client_params)\n      redirect_to @client, notice: 'Client was successfully updated.'\n    else\n      render :edit\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "gnupg"], "comments": [{"owner": {"reputation": 470, "user_id": 1419458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40be82026a81f18a2bbbaad209694e0?s=128&d=identicon&r=PG", "display_name": "Stanko Krtali\u0107 Rusendi\u0107", "link": "https://stackoverflow.com/users/1419458/stanko-krtali%c4%87-rusendi%c4%87"}, "edited": false, "score": 0, "creation_date": 1554794692, "post_id": 55585975, "comment_id": 97871571, "body": "Seems like you are missing dirmngr - check out <a href=\"https://unix.stackexchange.com/questions/401547/gpg-keyserver-receive-failed-no-dirmngr#401548\" title=\"gpg keyserver receive failed no dirmngr%23401548\">unix.stackexchange.com/questions/401547/&hellip;</a>"}, {"owner": {"reputation": 526, "user_id": 8903920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BI6rZ.jpg?s=128&g=1", "display_name": "Adwaith R Krishna", "link": "https://stackoverflow.com/users/8903920/adwaith-r-krishna"}, "reply_to_user": {"reputation": 470, "user_id": 1419458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40be82026a81f18a2bbbaad209694e0?s=128&d=identicon&r=PG", "display_name": "Stanko Krtali\u0107 Rusendi\u0107", "link": "https://stackoverflow.com/users/1419458/stanko-krtali%c4%87-rusendi%c4%87"}, "edited": false, "score": 0, "creation_date": 1554801717, "post_id": 55585975, "comment_id": 97875502, "body": "already tried it"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 9793596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250382a14e260f1d29aa4ee818c2b876?s=128&d=identicon&r=PG", "display_name": "Mayur Pathak", "link": "https://stackoverflow.com/users/9793596/mayur-pathak"}, "is_accepted": false, "score": 0, "last_activity_date": 1598594614, "last_edit_date": 1598594614, "creation_date": 1598496484, "answer_id": 63608410, "question_id": 55585975, "link": "https://stackoverflow.com/questions/55585975/gpg-key-server-showing-gpg-keyserver-receive-failed-no-dirmngr-while-install/63608410#63608410", "title": "Gpg key server showing &#39;gpg: keyserver receive failed: No dirmngr&#39; while installing rvm", "body": "<p>You can run the same key using  Sudo Command I am Sure the run and perfectly wrok</p>\n<pre><code>sudo apt-key adv --recv-keys --keyserver hkp://p80.pool.sks-keyservers.net:80 7638D0442B90D010 \n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 8903920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BI6rZ.jpg?s=128&g=1", "display_name": "Adwaith R Krishna", "link": "https://stackoverflow.com/users/8903920/adwaith-r-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 920, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1598594614, "creation_date": 1554789326, "question_id": 55585975, "link": "https://stackoverflow.com/questions/55585975/gpg-key-server-showing-gpg-keyserver-receive-failed-no-dirmngr-while-install", "title": "Gpg key server showing &#39;gpg: keyserver receive failed: No dirmngr&#39; while installing rvm", "body": "<p>I am trying to install rvm in my Ubuntu 18.04.2 LTS and am getting error while installing gpg keys. </p>\n\n<p>Command:</p>\n\n<pre><code>gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>gpg: connecting dirmngr at '/run/user/1000/gnupg/S.dirmngr' failed: IPC connect call failed\ngpg: keyserver receive failed: No dirmngr\n</code></pre>\n\n<p>dirmngr is installed.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-ec2", "rvm", "aws-code-deploy"], "owner": {"reputation": 1724, "user_id": 1547875, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3ef6471943723771e1c86f5828968f66?s=128&d=identicon&r=PG", "display_name": "Nishutosh Sharma", "link": "https://stackoverflow.com/users/1547875/nishutosh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554786121, "creation_date": 1554786121, "question_id": 55585395, "link": "https://stackoverflow.com/questions/55585395/rvm-do-not-works-on-rhel-ec2-with-codedeploy-after-reboot", "title": "RVM do not works on RHEL EC2 with CodeDeploy after reboot", "body": "<p>I have an RHEL 7.6 EC2 instance, I manually installed rvm for root user. Then used code-deploy agent to deploy my application. It all works fine as I use <code>rvm</code> in my before/after install codedeploy shell scripts. Once the reboot happens OR you have an AMI baked with the RVM already, we get the following errors, ONLY for codedeploy deployment. Normal ssh works fine.</p>\n\n<pre><code>[stderr]/bin/bash: __rvm_ruby_string_find: line 8: syntax error near unexpected token `(' \n[stderr]/bin/bash: __rvm_ruby_string_find: line 8: ` ruby-+([1-9]) | ruby-+([1-9]).+([0-9]) | ruby-1.+([1-9]).+([0-9]) | jruby-[19]*)' \n</code></pre>\n\n<p>I tried <code>source /etc/profile.d/rvm.sh</code> looking at [this][1]\nAnd also tried <code>/bin/bash --login</code> looking at [this][2], But did not work.\ndoing <code>which rvm</code> shows me the path to rvm binary. But <code>rvm use</code>, <code>rvm help</code>... <code>rvm &lt;anything at all&gt;</code> is not working, throwing the same error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 1, "creation_date": 1554788978, "post_id": 55585335, "comment_id": 97869069, "body": "Please make 100% sure that your credentials are working. I did the exact same thing that you described and I can login"}, {"owner": {"reputation": 476, "user_id": 3265018, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/44fdc79b5bd971ee83c566ddcaba9bf2?s=128&d=identicon&r=PG&f=1", "display_name": "VDN", "link": "https://stackoverflow.com/users/3265018/vdn"}, "reply_to_user": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 0, "creation_date": 1554789525, "post_id": 55585335, "comment_id": 97869240, "body": "If I use the same credentials to log in through Gmail it&#39;s working fine but if I use net/imap it&#39;s not working."}, {"owner": {"reputation": 476, "user_id": 3265018, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/44fdc79b5bd971ee83c566ddcaba9bf2?s=128&d=identicon&r=PG&f=1", "display_name": "VDN", "link": "https://stackoverflow.com/users/3265018/vdn"}, "reply_to_user": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 1, "creation_date": 1555395588, "post_id": 55585335, "comment_id": 98084702, "body": "Solved...Steps to follow - <a href=\"https://support.google.com/accounts/answer/6010255?hl=en\" rel=\"nofollow noreferrer\">support.google.com/accounts/answer/6010255?hl=en</a>  1. Go to your Google Account 2. On the left navigation panel, click Security 3. On the bottom of the page, in the Less secure app access panel, click Turn on access."}], "owner": {"reputation": 476, "user_id": 3265018, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/44fdc79b5bd971ee83c566ddcaba9bf2?s=128&d=identicon&r=PG&f=1", "display_name": "VDN", "link": "https://stackoverflow.com/users/3265018/vdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 592, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1607669553, "creation_date": 1554785693, "last_edit_date": 1607669553, "question_id": 55585335, "link": "https://stackoverflow.com/questions/55585335/netimapnoresponseerror-invalid-credentials-failure", "title": "Net::IMAP::NoResponseError: Invalid credentials (Failure)", "body": "<p>Steps:</p>\n<ol>\n<li><code>require 'net/imap'</code></li>\n<li><code>imap = Net::IMAP.new(&quot;imap.gmail.com&quot;, 993, true)</code></li>\n<li><code>imap.login(email, password)</code></li>\n</ol>\n<p>passed email and password values, but I am getting the below error message:</p>\n<blockquote>\n<p>Net::IMAP::NoResponseError:  Invalid credentials (Failure)</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"tags": [], "owner": {"reputation": 1889, "user_id": 79790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ed25610d3c177097464b2800c83c3a?s=128&d=identicon&r=PG", "display_name": "bpaul", "link": "https://stackoverflow.com/users/79790/bpaul"}, "is_accepted": true, "score": 1, "last_activity_date": 1554784562, "creation_date": 1554784562, "answer_id": 55585192, "question_id": 55585153, "link": "https://stackoverflow.com/questions/55585153/running-two-server-at-the-same-time-with-a-scriptruby-and-rails/55585192#55585192", "title": "Running two server at the same time with a script(Ruby and Rails)", "body": "<p>If you are on a unix based system adding an <code>&amp;</code> will start a command in the background. What you need is:</p>\n\n<pre><code>rake ts:stop\nrake ts:start\nrake ts:index\nruby server.rb &amp;\nrails server\n</code></pre>\n\n<p>For a rails project the better way to start multiple processes is to use a Procfile. Then you would start your application using a Procfile manager like foreman <a href=\"https://github.com/ddollar/foreman\" rel=\"nofollow noreferrer\">https://github.com/ddollar/foreman</a></p>\n"}], "owner": {"reputation": 19, "user_id": 11128944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbfc85150a57ddb715984b55e6a94289?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijit Jadhav", "link": "https://stackoverflow.com/users/11128944/abhijit-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 55585192, "answer_count": 1, "score": 0, "last_activity_date": 1554784562, "creation_date": 1554784325, "question_id": 55585153, "link": "https://stackoverflow.com/questions/55585153/running-two-server-at-the-same-time-with-a-scriptruby-and-rails", "title": "Running two server at the same time with a script(Ruby and Rails)", "body": "<p>I am new new to Ruby on Rails.\nIn my rails rails application I have used the two servers. One is the rails server and other one is simple ruby server.rb file. I need to start both the server with Start.sh script to deploy.</p>\n\n<p>I have tried the following Code of Start.sh file. But the issue is Rail server is not starting until and unless I stop the ruby server.rb.</p>\n\n<p>start.sh file code</p>\n\n<p>rake ts:stop</p>\n\n<p>rake ts:start</p>\n\n<p>rake ts:index</p>\n\n<p>ruby server.rb</p>\n\n<p>rails server</p>\n\n<p>I want to run both the servers through a single script</p>\n"}, {"tags": ["ruby", "rspec", "capybara", "ruby-on-rails-5.2"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 3, "last_activity_date": 1554780645, "creation_date": 1554780645, "answer_id": 55584716, "question_id": 55584140, "link": "https://stackoverflow.com/questions/55584140/capybara-fails-with-notsupportedbydrivererror/55584716#55584716", "title": "Capybara fails with NotSupportedByDriverError", "body": "<p>The selenium driver does not provide access to response headers (nor status codes).  You have a couple of options</p>\n\n<ol>\n<li>Just verify the href and attributes (download, etc) or the link are correct</li>\n<li>Configure the driver to actually download the file and then open and verify it's correct. </li>\n</ol>\n\n<p>Read <a href=\"http://ardesco.lazerycode.com/testing/webdriver/2012/07/25/how-to-download-files-with-selenium-and-why-you-shouldnt.html\" rel=\"nofollow noreferrer\">http://ardesco.lazerycode.com/testing/webdriver/2012/07/25/how-to-download-files-with-selenium-and-why-you-shouldnt.html</a> and then decide which of those you want to do. If #1 then it's straightforward</p>\n\n<pre><code>expect(page).to have_link('Download to CSV', href: 'http://blahblah' )\n</code></pre>\n\n<p>if #2 then take a look at the Capybara test suite for how to configure the selenium driver to actually download a file - <a href=\"https://github.com/teamcapybara/capybara/blob/master/spec/selenium_spec_chrome.rb#L14\" rel=\"nofollow noreferrer\">https://github.com/teamcapybara/capybara/blob/master/spec/selenium_spec_chrome.rb#L14</a></p>\n"}], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "accepted_answer_id": 55584716, "answer_count": 1, "score": 2, "last_activity_date": 1554780645, "creation_date": 1554775908, "question_id": 55584140, "link": "https://stackoverflow.com/questions/55584140/capybara-fails-with-notsupportedbydrivererror", "title": "Capybara fails with NotSupportedByDriverError", "body": "<p>I'm trying to verify download csv works in my rails application. But its throwing the error <code>Capybara::NotSupportedByDriverError:\n  Capybara::Driver::Base#response_headers</code></p>\n\n<pre><code>  it 'exports as CSV' do\n    visit_and_login\n    agree_to_tos\n\n    click_link 'Download to CSV'\n\n    page.response_headers['Content-Type'].should include 'text/csv'\n  end\n</code></pre>\n"}, {"tags": ["sql", "ruby", "sqlite", "calculated-columns"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1554772608, "post_id": 55583734, "comment_id": 97865557, "body": "Instead of doing two queries in your <code>get_total</code>, which is subject to <a href=\"https://en.wikipedia.org/wiki/Race_condition\" rel=\"nofollow noreferrer\">Race Conditions</a>, do one with an <code>UPDATE</code> <a href=\"https://stackoverflow.com/questions/19270259/update-with-join-in-sqlite\">using a <code>JOIN</code></a>. An atomic update won&#39;t expose you to situations where the total computes incorrectly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1554772677, "post_id": 55583734, "comment_id": 97865568, "body": "If you want a counter, consider <code>get_num.each_with_index do |item, i|</code> where <code>i</code> is a 0-indexed counter provided automatically. There&#39;s no need for a separate test. Also <b><code>i=1</code> is an assignment, not a comparison</b>. For that you need <code>==</code>. It&#39;s worth noting that your first iteration will not match either <code>if</code> branch when <code>i == 0</code>."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554773730, "post_id": 55583734, "comment_id": 97865759, "body": "@tadman it&#39;s not that I WANT a counter...I need to know the total <code>Type</code> I have to compute an average.  How can I do this w/o the counter?"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554774082, "post_id": 55583734, "comment_id": 97865804, "body": "@tadman can u show me an example of <code>join</code>.  Reading up now, I don&#39;t think it pertains for this specific use case...<code>join</code> essentially is used when having 2 different tables, not 1.  Also, can there be situations where <code>total</code> computes incorrectly?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554774178, "post_id": 55583734, "comment_id": 97865816, "body": "<code>JOIN</code> is precisely what you use when you have two different tables. It&#39;s how you relate them together in a single query."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554774365, "post_id": 55583734, "comment_id": 97865844, "body": "@tadman yes. but I only have myTable...and column for <code>total</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554774445, "post_id": 55583734, "comment_id": 97865861, "body": "The name <code>myTable</code> is really annoyingly vague here, and it&#39;s not clear why you&#39;re calling <code>SUM(Amount)</code> on a table and then updating the table with that sum. Won&#39;t that increment infinitely, as the future sum is now higher? A slightly more concrete use case would help considerably here."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554775237, "post_id": 55583734, "comment_id": 97865994, "body": "Every time you update your table with a new value it updates <i>every</i> matching row. Do you really want to do that? And why save these values at all? It&#39;s trivial to compute them on the fly when needed..."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554775382, "post_id": 55583734, "comment_id": 97866018, "body": "@tadman apologies renamed table for clarification. Pls understand <code>@total</code> will populate its own column.  So it won&#39;t increment infinitely..."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554775517, "post_id": 55583734, "comment_id": 97866042, "body": "@Shawn it&#39;s more to have <code>@total</code> always on hand...user is able to display each row...so they can see what the total is as well."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554776442, "post_id": 55583734, "comment_id": 97866181, "body": "<code>myTable</code> and <code>table1</code> are two flavours of the same. Is this a transactions table? A balances table? What&#39;s going on in there? You sum all amounts for a single category, then <i>update all entries in the database for that category</i> with that total. If there&#39;s two or more rows per category, this keeps incrementing forever. If there&#39;s one row per category then you don&#39;t need <code>SUM()</code>."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554778075, "post_id": 55583734, "comment_id": 97866454, "body": "@tadman i see now.  noob @ sqlite3.  I <b>thought</b> <code>sum()</code> summed up entire columns - and <code>insert</code> that summation into <code>Total</code>. This is a <b>category balances</b> tale (it sums up categories of amounts of things)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554780871, "post_id": 55583734, "comment_id": 97866960, "body": "<code>SUM()</code> will tally up all values in that column for all records matching the <code>WHERE</code> conditions, if any, or all records otherwise. I&#39;m still not sure that this is the structure you want. Normally you sum from one table to another related, but different table, and do that with a <code>SUM(Amount) GROUP BY Type</code> to get aggregate sums per-type."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554789247, "post_id": 55583734, "comment_id": 97869152, "body": "Oh, I think there&#39;s an error in how you compute average - you&#39;re calculating the total - current row value divided by the number of rows seen so far minus 1, not the number of total rows minus 1. That doesn&#39;t sound right. (Side note: Once sqlite 3.28 is out (Currently available for beta testing), you can calculate the average of all but the current row with <code>SELECT Amount, avg(Amount) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING EXCLUDE CURRENT ROW) AS AvgX FROM Table1 WHERE Type = :Type</code>)"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554816777, "post_id": 55583734, "comment_id": 97884795, "body": "@Shawn that <b>is</b> a good observation!  I have some work with this obviously."}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554775039, "creation_date": 1554771926, "last_edit_date": 1554775039, "question_id": 55583734, "link": "https://stackoverflow.com/questions/55583734/cant-calculate-a-mean-that-excludes-the-current-observation-using-each-block-a", "title": "can&#39;t calculate a mean that excludes the current observation using .each block and sqlite3", "body": "<p>I've done my best to strip down code to bare minimum and provided concise explanation of problem (I hope)</p>\n\n<p>I have a db scheme as indicated below.</p>\n\n<pre><code>def a_method(info_hash)\n     ...\n     db.execute2 \"create table if not exists Table1(Id INTEGER PRIMARY KEY, Item TEXT, Amount FLOAT, Type TEXT, AvgInc FLOAT, AvgX FLOAT, Total FLOAT)\"\n     ...\nend\n</code></pre>\n\n<p>This creates my schema.  Once I populate the database, I run the following method which gives me the <code>#{@total}</code> value grouped by my <code>Type</code> column:</p>\n\n<pre><code>def get_total(info_hash)\n    ...\n    get_amt =  db.execute2 \"SELECT sum(Amount) from Table1 WHERE Type = :Type\", info_hash[:category]\n    puts \"foo\"\n    db.execute2 \"UPDATE Table1 SET Total = :Total WHERE Type = :Type\", get_amt[1][0], info_hash[:category]\n    @total=get_amt[1][0]\n    ...\n    @total\nend\n</code></pre>\n\n<p>I want to run the following method to compute an <code>Item</code> average in the event the item did not exist.  Basically the impact each <code>Item</code> has on the <code>Type</code> average.  </p>\n\n<p><strong>Please see the in code comment for where I think my logic is faulty</strong></p>\n\n<pre><code>def method_excluding(info_hash) \n     ...\n     get_num =  db.execute2 \"SELECT Amount from Table1 WHERE Type = :Type\", info_hash[:category]\n    i = 0\n    get_num.each do |item| \n    #purpose of block to compute an average value for Type as if #{item} did not exist.  So: the average value for Type EXLCUDING #{item}\n        if i == 1\n            @avgx = (@total - get_num[1][0]) / i\n        elsif i &gt; 1\n            @avgx = (@total - get_num[i][0]) / (i - 1)\n        end         \n        i+=1\n        db.execute2 \"UPDATE Table1 SET AvgX = :AvgX WHERE Type = :Type\", @avgx, info_hash[:category]\n        ...\nend\n</code></pre>\n\n<p><strong>Please advise on how I can get to my desired outcome.</strong></p>\n"}, {"tags": ["ruby", "caching", "sinatra", "browser-cache"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1554772283, "post_id": 55583704, "comment_id": 97865485, "body": "if you wrote the <code>&quot;Minimal!__ !_!&quot;</code> into an actual view file (a html or erb template) it would properly reload. However for changes to the Ruby code you need to either restart the server, or use a library such as <a href=\"https://github.com/alexch/rerun\" rel=\"nofollow noreferrer\">rerun</a> or <a href=\"https://github.com/rtomayko/shotgun\" rel=\"nofollow noreferrer\">shotgun</a>. The behavior you see is not because of a cache, it&#39;s because rack does not automatically reload source code in general"}, {"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554773914, "post_id": 55583704, "comment_id": 97865782, "body": "I like the erb approach however when i tried <code>text = &quot;MMinimal!__ !_!&lt;%= &#39;frooYZZYoggy&#39; %&gt;&quot;   erb text</code> it didn&#39;t reload when i then changed the text within the erb tag"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554777960, "post_id": 55583704, "comment_id": 97866438, "body": "I mean an actual <code>.erb</code> file. It reloads and recompiles the file on every request, meaning refreshing the page will show updates to that file. <i>Refreshing the page does not cause the <code>.rb</code> code to reload though</i> and your inline erb code is no exception"}], "answers": [{"tags": [], "owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "is_accepted": false, "score": 1, "last_activity_date": 1554799395, "creation_date": 1554799395, "answer_id": 55588539, "question_id": 55583704, "link": "https://stackoverflow.com/questions/55583704/how-to-create-sinatra-app-with-page-that-reloads-with-new-content-not-cache/55588539#55588539", "title": "How to create Sinatra app with page that reloads with new content not cache", "body": "<p>You need to use <a href=\"http://sinatrarb.com/contrib/reloader\" rel=\"nofollow noreferrer\"><code>sinatra-reloader</code></a></p>\n\n<p>Based on the example code, your app seems to be of the \"classic\" type.\nTherefore simply load the <code>reloader</code> library into your app:</p>\n\n<pre><code>require 'sinatra'\nrequire 'sinatra/reloader' if development?\n\nget '/' do\n  \"Minimal!__ !_!\"\nend\n</code></pre>\n\n<p>Since you're using a Gemfile, ensure that you've the <code>sinatra-contrib</code> gem listed as well (and install it via <code>bundle install</code>):</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rspec'\ngem 'thin'\ngem 'sinatra', '~&gt; 2.0`\ngem 'sinatra-contrib', '~&gt; 2.0'\n</code></pre>\n\n<p>Otherwise install the gem directly: <code>gem install sinatra-contrib</code></p>\n\n<p>Now onwards anytime you start up the server in <code>'development'</code> mode and make changes to either your <code>app.rb</code> or your <code>views/index.erb</code>, the changes will be reflected in your browser with a refresh.</p>\n"}, {"tags": [], "owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "is_accepted": true, "score": 2, "last_activity_date": 1555332548, "last_edit_date": 1555332548, "creation_date": 1554974579, "answer_id": 55629015, "question_id": 55583704, "link": "https://stackoverflow.com/questions/55583704/how-to-create-sinatra-app-with-page-that-reloads-with-new-content-not-cache/55629015#55629015", "title": "How to create Sinatra app with page that reloads with new content not cache", "body": "<p>If you <em>were</em> having problems with the cache you could tell the browser not to cache anything:</p>\n\n<pre><code>cache_control :no_cache\n</code></pre>\n\n<p>You might also add Pragma and Expires to the header:</p>\n\n<pre><code>headers \\\n  \"Pragma\"   =&gt; \"no-cache\",\n  \"Expires\" =&gt; \"0\"\n</code></pre>\n\n<p>and put it all in a <code>before</code> filter:</p>\n\n<pre><code>before do\n  cache_control :no_cache\n  headers \\\n    \"Pragma\"   =&gt; \"no-cache\",\n    \"Expires\" =&gt; \"0\"\nend\n</code></pre>\n\n<p>Or, since you're doing demonstrations, open the browser's inspector and turn off caching. Both Chrome and Firefox have this option.</p>\n\n<p>(OP Adding this) A minimalist version for one call might be just to have</p>\n\n<pre><code>  headers \"Expires\" =&gt; \"0\"\n</code></pre>\n\n<p>within the get in question</p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 55629015, "answer_count": 2, "score": 2, "last_activity_date": 1555332548, "creation_date": 1554771651, "question_id": 55583704, "link": "https://stackoverflow.com/questions/55583704/how-to-create-sinatra-app-with-page-that-reloads-with-new-content-not-cache", "title": "How to create Sinatra app with page that reloads with new content not cache", "body": "<p>I trying to create a fairly minimal example for templates and teaching.</p>\n\n<p>I create my <code>app.rb</code> file</p>\n\n<pre><code>require 'sinatra'\n\nget '/' do\n  \"Minimal!__ !_!\"\nend\n</code></pre>\n\n<p>My Gemfile just has</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rspec'\ngem 'thin'\n</code></pre>\n\n<p>I started up Sinatra</p>\n\n<pre><code>$ ruby app.rb \n== Sinatra (v2.0.5) has taken the stage on 4567 for development with backup from Thin\nThin web server (v1.7.2 codename Bachmanity)\nMaximum connections set to 1024\nListening on localhost:4567, CTRL+C to stop\n</code></pre>\n\n<p>and I can visit the page</p>\n\n<p><a href=\"https://i.stack.imgur.com/EKOEd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EKOEd.png\" alt=\"enter image description here\"></a></p>\n\n<p>but when I then change the code the page is cached and the new content doesn't show unless i stop and start the server.</p>\n\n<p>I've read the Sinatra documentation but still can't figure it out.</p>\n\n<p>I've tried adding</p>\n\n<pre><code>set :sessions, false\n</code></pre>\n\n<p>and</p>\n\n<pre><code>   cache_control :off\n</code></pre>\n\n<p>to no avail</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "capistrano", "git-submodules"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1554775272, "post_id": 55583376, "comment_id": 97866000, "body": "All the gems I&#39;ve used just copy the migrations to the project&#39;s db/migrate folder. Is your gem a custom one? The error is not related to the migrations though, it says it can&#39;t find aasm-5.0.2, login to your server and run bundle install on your project&#39;s root and make sure it ends successfully."}, {"owner": {"reputation": 1737, "user_id": 4476186, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3452238962a96a1515d4ab4420aaf35?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard Simpson", "link": "https://stackoverflow.com/users/4476186/gerard-simpson"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1554784202, "post_id": 55583376, "comment_id": 97867640, "body": "@arieljuod yes it&#39;s a custom gem, and yes it can bundle them successfully, just not during this task"}], "answers": [{"tags": [], "owner": {"reputation": 1737, "user_id": 4476186, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3452238962a96a1515d4ab4420aaf35?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard Simpson", "link": "https://stackoverflow.com/users/4476186/gerard-simpson"}, "is_accepted": true, "score": 0, "last_activity_date": 1554785810, "creation_date": 1554785810, "answer_id": 55585349, "question_id": 55583376, "link": "https://stackoverflow.com/questions/55583376/run-rails-dbmigrate-with-capistrano-in-a-gem-submodule/55585349#55585349", "title": "Run `rails db:migrate` with capistrano in a gem/submodule", "body": "<p>I figured it out, I needed 3 things:</p>\n\n<p>1.<code>execute :bundle</code> before <code>execute :rake, :\"db:migrate\"</code></p>\n\n<ol start=\"2\">\n<li><p>Provide a second argument to <code>within \"#{release_path}/PATH/TO/SUBMODULE\"</code> to make it <code>within \"#{release_path}/PATH/TO/SUBMODULE\", release_path</code> - couldn't find docs on this, only this PR: <a href=\"https://github.com/capistrano/bundler/pull/84\" rel=\"nofollow noreferrer\">https://github.com/capistrano/bundler/pull/84</a></p></li>\n<li><p>symlink secrets to the engine so it doesn't prevent any tasks from running:</p></li>\n</ol>\n\n<pre><code>    task :symlink_secrets do\n        on roles(:app) do\n          execute \"rm -rf #{release_path}/PATH/TO/SUBMODULE/spec/dummy/config/secrets.yml\"\n          execute \"ln -nfs ~/secrets.yml #{release_path}/PATH/TO/SUBMODULE/spec/dummy/config/secrets.yml\"\n        end \n    end\n</code></pre>\n"}], "owner": {"reputation": 1737, "user_id": 4476186, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3452238962a96a1515d4ab4420aaf35?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard Simpson", "link": "https://stackoverflow.com/users/4476186/gerard-simpson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 55585349, "answer_count": 1, "score": 2, "last_activity_date": 1554785810, "creation_date": 1554768272, "question_id": 55583376, "link": "https://stackoverflow.com/questions/55583376/run-rails-dbmigrate-with-capistrano-in-a-gem-submodule", "title": "Run `rails db:migrate` with capistrano in a gem/submodule", "body": "<p>I have a rails 5.2 app. I am trying to deploy it using Capistrano.</p>\n\n<p>The app has a gem dependency submodule, which contains all of the models and migrations needed for this project. This submodule depends on other gems in it's <code>.gemspec</code>.</p>\n\n<p>Therefore, I need to run <code>rails db:migrate</code> in the submodule root, instead of the parent project root.</p>\n\n<p>I have added the following to <code>deploy.rb</code>:</p>\n\n<pre><code>  desc 'Runs rake db:migrate if migrations are set'\n  task :migrate =&gt; [:set_rails_env] do\n    on primary fetch(:migration_role) do\n      within \"#{release_path}/PATH/TO/SUBMODULE\" do\n        with rails_env: fetch(:rails_env) do\n          execute :rake, \"db:migrate\"\n        end\n      end\n    end\n  end\n\n  before :starting,    :migrate\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>gem 'dependency', path: 'PATH/TO/SUBMODULE'\ngem 'capistrano-git-with-submodules', '~&gt; 2.0'\ngroup :development do\n  gem 'capistrano',         require: false\n  gem 'capistrano-rvm',     require: false\n  gem 'capistrano-rails',   require: false\n  gem 'capistrano-bundler', require: false\n  gem 'capistrano3-puma',   require: false\nend\n</code></pre>\n\n<p>When I try to run this task, I get an error message saying:  </p>\n\n<pre><code> DEBUG [b4c1cf18]   [31mCould not find aasm-5.0.2 in any of the sources[0m\n DEBUG [b4c1cf18]   \n DEBUG [b4c1cf18]   [33mRun `bundle install` to install missing gems.[0m\n DEBUG [b4c1cf18]\n</code></pre>\n\n<p>It seems like the gem set (containing all parent and submodule gems) used in deploying the parent project isn't in the path or is unavailable when it comes time to run this task.</p>\n\n<p>I can get the parent project running without the migrations, so I know that the parent project is loading all the correct gem set at runtime. Just not during this task.</p>\n\n<p>I'm not quite sure how Capistrano works under the hood, how could I make sure that these gems are available to this task when it runs?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "heroku"], "comments": [{"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1554767908, "post_id": 55583272, "comment_id": 97864697, "body": "Does this also have a front end deployed on heroku as well? Ie. 2 heroku instances? If so, then you should be using the external url to communicate across the 2 instances. Otherwise if this is just the rails app, then you should be using url helpers, which should take care of everything for you (you might have to specify the heroku public url somewhere in the rails config, or set something in the heroku env variables)."}, {"owner": {"reputation": 1, "user_id": 11331656, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c9u8711yCUA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEHPZ-3rKHB2aXR79xRNRtlzdxHw/mo/photo.jpg?sz=128", "display_name": "Jonathan C", "link": "https://stackoverflow.com/users/11331656/jonathan-c"}, "reply_to_user": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1554768717, "post_id": 55583272, "comment_id": 97864846, "body": "@baseballlover723 Sorry, I forgot to mention that I&#39;m using a React/Redux frontend. The domain for the frontend is <a href=\"https://placardny.herokuapp.com/\" rel=\"nofollow noreferrer\">placardny.herokuapp.com</a>, while that of the backend is different. Is that what you mean by an external url?"}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1554768991, "post_id": 55583272, "comment_id": 97864911, "body": "are they hosted together, or separately? ie. do you need to deploy 2 things or 1 thing. If its 1 thing, then your hosting them together and using local host should work. But if your hosting them separately, they you have to use the backend url, since the backend and frontend aren&#39;t on the same machine"}, {"owner": {"reputation": 1, "user_id": 11331656, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c9u8711yCUA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEHPZ-3rKHB2aXR79xRNRtlzdxHw/mo/photo.jpg?sz=128", "display_name": "Jonathan C", "link": "https://stackoverflow.com/users/11331656/jonathan-c"}, "reply_to_user": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1555528006, "post_id": 55583272, "comment_id": 98147228, "body": "@baseballlover723 sorry about the late response-- Yes, they are hosted separately so I&#39;m fetching from my Heroku backend. It doesn&#39;t seem to be reaching it at all though. Is it a production/development issue?"}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1555529312, "post_id": 55583272, "comment_id": 98147825, "body": "So you can&#39;t reach your heroku backend using the herokuapp url from your front end?"}, {"owner": {"reputation": 1, "user_id": 11331656, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c9u8711yCUA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEHPZ-3rKHB2aXR79xRNRtlzdxHw/mo/photo.jpg?sz=128", "display_name": "Jonathan C", "link": "https://stackoverflow.com/users/11331656/jonathan-c"}, "reply_to_user": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1555530476, "post_id": 55583272, "comment_id": 98148277, "body": "@baseballlover723 Yeah so when I try to console log the data I should be receiving, I get back nothing. All fields are empty in Redux as well."}], "owner": {"reputation": 1, "user_id": 11331656, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c9u8711yCUA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEHPZ-3rKHB2aXR79xRNRtlzdxHw/mo/photo.jpg?sz=128", "display_name": "Jonathan C", "link": "https://stackoverflow.com/users/11331656/jonathan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554767195, "creation_date": 1554767195, "question_id": 55583272, "link": "https://stackoverflow.com/questions/55583272/why-does-my-heroku-app-only-work-when-rails-server-is-running-locally", "title": "Why does my heroku app only work when rails server is running locally?", "body": "<p>Sorry, this is my first time deploying my site on Heroku. The main elements of website does run, but none of my fetch requests are working. So, none of the data from my Rails backend is rendering. I've been receiving this in my console whenever the site is supposed to make a fetch request (to localhost:3000) => \"Failed to load resource: net::ERR_CONNECTION_REFUSED\"\nShould I not be trying to fetch from localhost when my site is deployed on heroku?</p>\n\n<p>I've tried creating a Procfile, updating my production and development environments, etc.</p>\n\n<pre><code>web: bundle exec puma -t 5:5 -p ${PORT:-3000} -e ${RACK_ENV:-production}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1554768034, "post_id": 55583243, "comment_id": 97864720, "body": "I do not get the listed output when I run the script. I get <code>Usage: frsDic &lt;wordlist&gt;</code>"}, {"owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "reply_to_user": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1554768262, "post_id": 55583243, "comment_id": 97864753, "body": "You need to pas a wordlist as an argument :/"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554770607, "post_id": 55583243, "comment_id": 97865201, "body": "Note   <code>if ARGV.length != 1; return false; end; return true</code> in <code>check_usage</code> can be simplified to <code>if ARGV.length != 1; false; end; true</code>, which can be simplified to <code>ARGV.length == 1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1554768487, "creation_date": 1554768487, "answer_id": 55583394, "question_id": 55583243, "link": "https://stackoverflow.com/questions/55583243/why-does-my-code-output-enumaration-values-instead-of-a-string/55583394#55583394", "title": "Why does my code output enumaration values instead of a string?", "body": "<p>The method <a href=\"https://ruby-doc.org/core-2.6.2/Array.html#method-i-repeated_permutation\" rel=\"nofollow noreferrer\"><code>repeated_permutation</code></a> returns an Enumerator if you don't provide a block. If you're looking to loop through all of the permutations, you can either pass a block directly to it:</p>\n\n<pre><code>wordArray.repeated_permutation(7) { |permutation| puts permutation }\n</code></pre>\n\n<p>Or you can pass the enumerator somewhere and call <code>.each</code> on it.</p>\n\n<pre><code>word_enumerator = wordArray.repeated_permutation(7)\nword_enumerator.each { |permutation| puts permutation }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 55583394, "answer_count": 1, "score": 0, "last_activity_date": 1554768487, "creation_date": 1554766962, "last_edit_date": 1554767706, "question_id": 55583243, "link": "https://stackoverflow.com/questions/55583243/why-does-my-code-output-enumaration-values-instead-of-a-string", "title": "Why does my code output enumaration values instead of a string?", "body": "<p>I'm writing  dictionary based attack program in ruby for a CTF, but my output prints an enumeration value instead of a string. I've tried explicingly converting the variable that ouputs to a string, but that did not change anything.</p>\n\n<pre><code>require 'net/http'\n\ndef checkUsage()\n  if ARGV.length != 1\n    return false\n  end\n  return true\nend\n\n\ndef generateUsername()\n\n  wordArray = Array.new\n  wordlist = File.open(\"words.txt\", \"r\")\n\n  for word in wordlist\n    wordArray.push(word)\n  end\n\n return wordArray.repeated_permutation(7).to_s\n\nend\n\ndef generatePassword()\n\n  wordArray = Array.new\n  wordlist = File.open(\"words.txt\", \"r\")\n\n  for word in wordlist\n    wordArray.push(word)\n  end\n\n  return wordArray.repeated_permutation(7).to_s\n\nend\n\ndef requestAuthentication()\n\n  if(!checkUsage())\n    puts(\"Usage: frsDic &lt;wordlist&gt;\")\n    return false\n  end\n\n  uri = URI(\"http://challenges.laptophackingcoffee.org:3199/secret.php\")\n  req = Net::HTTP::Get.new(uri)\n\n  loop do\n\n    username = generateUsername()\n    password = generatePassword()\n\n    if req.basic_auth username, password\n      puts\"Username found: \" + username\n      puts\"Password found: \" + password\n      break\n    else\n      puts\"Username failed: \" + username\n      puts\"Password failed: \" + password\n    end\n  end\nend\n\n\nrequestAuthentication()\n\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\n#&lt;Enumerator:0x000055a491c74ad0&gt;\n#&lt;Enumerator:0x000055a491c74828&gt;\n#&lt;Enumerator:0x000055a491c74ad0&gt;\n#&lt;Enumerator:0x000055a491c74828&gt;\n\n</code></pre>\n\n<p>I was expecting to print out the string of the usernames/passwords found by the bruteforce, but it only printed enumeration values.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "string", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "is_accepted": false, "score": 1, "last_activity_date": 1554768735, "creation_date": 1554768735, "answer_id": 55583428, "question_id": 55583124, "link": "https://stackoverflow.com/questions/55583124/custom-sort-array-of-strings-by-another-array-of-strings-ruby/55583428#55583428", "title": "Custom Sort array of strings by another array of strings - Ruby", "body": "<p>you may want to just make a medal class or something, with a numerical rank and a string name, and then just sort by the rank. like so. </p>\n\n<pre><code>class Medal\n  attr_accessor :name, :rank\n\n  def initialize(name, rank)\n    @name = name\n    @rank = rank\n  end\nend\n\nlist = [Medal.new(\"gold\", 0), Medal.new(\"silver\", 1), Medal.new(\"bronze\", 2), Medal.new(\"steel\", 4), Medal.new(\"copper\", 3)]\n\nlist = list.sort_by &amp;:rank\n</code></pre>\n\n<p>you could take this a big farther if you want and define a map of medal names to ranks to drop the rank from the initialize. You could also just define each medal as a constant if you want, since you'll probably only have a fixed list.</p>\n\n<p>But if you don't want to do that then you could probably also just have a list of the order and sort by the index, like this</p>\n\n<pre><code>list = [\"gold\",\"silver\",\"bronze\",\"steel\",\"copper\"]\n\nsort_order = [\"bronze\",\"silver\",\"gold\",\"\",\"copper\",\"steel\"]\n\nlist = list.sort_by {|m| sort_order.index m}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554770075, "post_id": 55583554, "comment_id": 97865110, "body": "<code>sort_order.each_with_index.to_h</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554770753, "post_id": 55583554, "comment_id": 97865230, "body": "To generate the <code>count</code> table in one shot."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554771039, "post_id": 55583554, "comment_id": 97865272, "body": "But that generates <code>#=&gt; {&quot;bronze&quot;=&gt;0, &quot;silver&quot;=&gt;1, &quot;gold&quot;=&gt;2, &quot;copper&quot;=&gt;3, &quot;steel&quot;=&gt;4}</code>. I need <code>{&quot;gold&quot;=&gt;2, &quot;copper&quot;=&gt;2, &quot;silver&quot;=&gt;1, &quot;steel&quot;=&gt;1}</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1554774591, "post_id": 55583554, "comment_id": 97865882, "body": "I think you understand the problem better than I do because the question itself doesn&#39;t make sense to me."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1554780503, "last_edit_date": 1554780503, "creation_date": 1554770033, "answer_id": 55583554, "question_id": 55583124, "link": "https://stackoverflow.com/questions/55583124/custom-sort-array-of-strings-by-another-array-of-strings-ruby/55583554#55583554", "title": "Custom Sort array of strings by another array of strings - Ruby", "body": "<p>I assume that:</p>\n\n<ul>\n<li>every element of <code>list</code> is in <code>sort_order</code>;</li>\n<li><code>sort_order</code> may contain elements that are not in <code>list</code>;</li>\n<li><code>list</code> may contain duplicates; and</li>\n<li><code>sort_order</code> contains no duplicates.</li>\n</ul>\n\n<p>If <code>sort_order</code> initially contains duplicates the temporary array <code>sort_order.uniq</code> can be used in the calculations.</p>\n\n<p>Observe that if, as in the example, <code>list</code> contains no duplicates and <code>sort_order</code> contains no elements other than those in <code>list</code>, sorting <code>list</code> by the order of its elements in <code>sort_order</code> is trivial, as it merely returns <code>sort_order</code>.</p>\n\n<p>The following is more efficient than methods that use <code>sort</code> or <code>sort_by</code> (<code>O(n)</code> versus <code>O(n*log(n)</code>) computational complexity.)</p>\n\n<pre><code>list = [\"gold\", \"copper\", \"silver\", \"copper\", \"steel\", \"gold\"]\nsort_order = [\"bronze\", \"silver\", \"tin\", \"gold\", \"copper\", \"steel\"]\n\ncount = list.each_with_object(Hash.new(0)) { |e,h| h[e] += 1 }\n  #=&gt; {\"gold\"=&gt;2, \"copper\"=&gt;2, \"silver\"=&gt;1, \"steel\"=&gt;1} \nsort_order.flat_map { |e| [e]*count[e] }.reject(&amp;:empty?)\n  #=&gt; [\"silver\", \"gold\", \"gold\", \"copper\", \"copper\", \"steel\"] \n</code></pre>\n"}], "owner": {"reputation": 564, "user_id": 651314, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c3925ca02512cb9e6517b27861797afd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobius", "link": "https://stackoverflow.com/users/651314/kobius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 55583554, "answer_count": 2, "score": 1, "last_activity_date": 1554780503, "creation_date": 1554766035, "last_edit_date": 1554766508, "question_id": 55583124, "link": "https://stackoverflow.com/questions/55583124/custom-sort-array-of-strings-by-another-array-of-strings-ruby", "title": "Custom Sort array of strings by another array of strings - Ruby", "body": "<p>I have an array that is currently sorted alphabetically, and I'm trying to sort it by a manual order of strings.</p>\n\n<p>Current code:</p>\n\n<pre><code>list = [\"gold\",\"silver\",\"bronze\",\"steel\",\"copper\"]\n\nlist = list.sort { |a, b| a &lt;=&gt; b }\n</code></pre>\n\n<p>What I'm trying to achieve: (With a blank entry as a separator)</p>\n\n<pre><code>list = [\"gold\",\"silver\",\"bronze\",\"steel\",\"copper\"]\n\nsort_order = [\"bronze\",\"silver\",\"gold\",\"\",\"copper\",\"steel\"]\n\nlist = list.sort_by sort_order\n</code></pre>\n\n<p>Output: bronze | silver | gold | - | copper | steel</p>\n\n<p>Is this possible? Currently stuck with these error messages:</p>\n\n<pre><code>comparison of Integer with nil failed\ncomparison of String with String failed\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1554770529, "post_id": 55583085, "comment_id": 97865189, "body": "Check the guide on custom validator <a href=\"https://guides.rubyonrails.org/active_record_validations.html#custom-validators\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>. You can create a class extending ActiveModel::Validator instead of using a concern and use validates_with."}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554794282, "post_id": 55583085, "comment_id": 97871339, "body": "can you try moving the file <code>validations.rb</code> to <code>app&#47;models&#47;concerns</code> folder and try adding <code>include Validations</code> in your model"}, {"owner": {"reputation": 274, "user_id": 3290465, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/647cbc7a98012c227127b19e5a5f634c?s=128&d=identicon&r=PG", "display_name": "asalgan", "link": "https://stackoverflow.com/users/3290465/asalgan"}, "reply_to_user": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554858148, "post_id": 55583085, "comment_id": 97902130, "body": "@Nandhini I actually initially had it in concerns prior to moving it and had the same issue"}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554874849, "post_id": 55583085, "comment_id": 97905812, "body": "@asalgan have posted my answer. It worked for me. Try the same and let me know if any issue persists."}, {"owner": {"reputation": 274, "user_id": 3290465, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/647cbc7a98012c227127b19e5a5f634c?s=128&d=identicon&r=PG", "display_name": "asalgan", "link": "https://stackoverflow.com/users/3290465/asalgan"}, "reply_to_user": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1554995373, "post_id": 55583085, "comment_id": 97962778, "body": "@Nandhini actually I realized this doesn&#39;t solve my issue when the class doesn&#39;t inherit from <code>ActiveRecord::Base</code> if it&#39;s a standalone class then I still encounter the issue above, any idea as to why that&#39;s happening?"}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1555006161, "post_id": 55583085, "comment_id": 97968436, "body": "@asalgan it worked for me without the inheritance. what is the rails version that you are using?"}, {"owner": {"reputation": 274, "user_id": 3290465, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/647cbc7a98012c227127b19e5a5f634c?s=128&d=identicon&r=PG", "display_name": "asalgan", "link": "https://stackoverflow.com/users/3290465/asalgan"}, "reply_to_user": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1555037731, "post_id": 55583085, "comment_id": 97977377, "body": "@Nandhini im on 5.1.6"}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 0, "creation_date": 1555081871, "post_id": 55583085, "comment_id": 97998066, "body": "@asalgan I checked in 5.2.2 and it was an API only application"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11332143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff07f650b51f3502fb3087058ef4b60?s=128&d=identicon&r=PG&f=1", "display_name": "grangersg1993", "link": "https://stackoverflow.com/users/11332143/grangersg1993"}, "is_accepted": false, "score": 0, "last_activity_date": 1554783329, "creation_date": 1554783329, "answer_id": 55585040, "question_id": 55583085, "link": "https://stackoverflow.com/questions/55583085/rails-accessing-a-shared-custom-validation-in-a-module-within-a-model/55585040#55585040", "title": "Rails accessing a shared custom validation in a module within a model", "body": "<p>Have you tried using require_relative Validations</p>\n"}, {"comments": [{"owner": {"reputation": 274, "user_id": 3290465, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/647cbc7a98012c227127b19e5a5f634c?s=128&d=identicon&r=PG", "display_name": "asalgan", "link": "https://stackoverflow.com/users/3290465/asalgan"}, "edited": false, "score": 0, "creation_date": 1554913635, "post_id": 55605410, "comment_id": 97927855, "body": "apparently I was using <code>validate</code> instead of <code>validates</code> - it also worked when I did <code>validates_format_of</code> whoops! thanks!"}], "tags": [], "owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "is_accepted": true, "score": 4, "last_activity_date": 1554874815, "creation_date": 1554874815, "answer_id": 55605410, "question_id": 55583085, "link": "https://stackoverflow.com/questions/55583085/rails-accessing-a-shared-custom-validation-in-a-module-within-a-model/55605410#55605410", "title": "Rails accessing a shared custom validation in a module within a model", "body": "<p>I tried the following and it worked for me:</p>\n\n<p>Created validations.rb in models/concerns</p>\n\n<pre><code>module Validations\n  extend ActiveSupport::Concern\n\n  def email_format_validation\n    if self.email.present?\n      if !validates_format_of :email, with: email_regex\n        self.errors.add(:email, \"doesn't exist\")\n      end\n    end\n  end\n\n\n  def email_regex\n    /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\Z/i\n  end\nend\n</code></pre>\n\n<p>In the model:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>include Validations\n\nclass User &lt; ApplicationRecord\n  validate :email_format_validation\n  validates :user_email, with: :email_regex\nend\n</code></pre>\n\n<p>user_email is the field name</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 2514714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca26c3ebc548ee72e5db9d00fb9b14f?s=128&d=identicon&r=PG&f=1", "display_name": "bumcode", "link": "https://stackoverflow.com/users/2514714/bumcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1619137075, "last_edit_date": 1619137075, "creation_date": 1619129682, "answer_id": 67221497, "question_id": 55583085, "link": "https://stackoverflow.com/questions/55583085/rails-accessing-a-shared-custom-validation-in-a-module-within-a-model/67221497#67221497", "title": "Rails accessing a shared custom validation in a module within a model", "body": "<p>As of Rails 3, you may also use <a href=\"https://guides.rubyonrails.org/active_record_validations.html#validates-with\" rel=\"nofollow noreferrer\">validates_with</a>:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>class EmailValidator &lt; ActiveModel::Validator\n  def validate(record)\n    if record.email.present?\n      if !email_regex.match?(record.email)\n        record.errors.add(:email, &quot;is invalid&quot;)\n      end\n    end\n  end\n\n  def email_regex\n    /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\Z/i\n  end\nend\n\nclass User &lt; ApplicationRecord\n  validates_with EmailValidator\nend\n</code></pre>\n<p>This allows you to e.g. easily make the field name dynamic.</p>\n"}], "owner": {"reputation": 274, "user_id": 3290465, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/647cbc7a98012c227127b19e5a5f634c?s=128&d=identicon&r=PG", "display_name": "asalgan", "link": "https://stackoverflow.com/users/3290465/asalgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 0, "accepted_answer_id": 55605410, "answer_count": 3, "score": 1, "last_activity_date": 1619137075, "creation_date": 1554765709, "question_id": 55583085, "link": "https://stackoverflow.com/questions/55583085/rails-accessing-a-shared-custom-validation-in-a-module-within-a-model", "title": "Rails accessing a shared custom validation in a module within a model", "body": "<p>I'm trying to figure out how to create a shared custom validation that I can use across my models that I've placed within a lib/validations.rb folder. </p>\n\n<pre><code>module Validations\n  extend ActiveSupport::Concern\n\n  # included do\n\n\n  def email_format_validation\n    if self.email.present?\n      if !validates_format_of :email, with: email_regex\n        self.errors.add(:email, \"doesn't exist\")\n      end\n    end\n  end\n\n\n  def email_regex\n    /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\Z/i\n  end\nend\n</code></pre>\n\n<p>So in my model, this allows me to do:</p>\n\n<pre><code>validate :email_format_validation\n</code></pre>\n\n<p>In other models, I'm trying to just call <code>email_regex</code>:</p>\n\n<pre><code>validate :user_email, with: email_regex\n</code></pre>\n\n<p>which produces the following error:</p>\n\n<pre><code>undefined local variable or method `email_regex' for #&lt;Class....&gt;\n</code></pre>\n\n<p>I've tried using <code>include Validations</code>, <code>extend Validations</code>, <code>require 'validations'</code>, etc. in my model with no luck. I've also tried placing the module methods within a <code>class &lt;&lt; self</code>, using the <code>included do</code> block, setting the methods as <code>self.email_regex</code> and calling <code>Validations.email_regex</code> and yet nothing seems to work. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "bundler", "rbenv"], "comments": [{"owner": {"reputation": 116, "user_id": 11236159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb476ec41be9fb66aad685837f837047?s=128&d=identicon&r=PG&f=1", "display_name": "IlyaOsotov", "link": "https://stackoverflow.com/users/11236159/ilyaosotov"}, "edited": false, "score": 0, "creation_date": 1554791106, "post_id": 55583038, "comment_id": 97869822, "body": "Did you try to use capistrano-bundler gem?"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8702213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099caf15a5389286503bb56dec9ee607?s=128&d=identicon&r=PG&f=1", "display_name": "Alien", "link": "https://stackoverflow.com/users/8702213/alien"}, "edited": false, "score": 0, "creation_date": 1554769127, "post_id": 55583116, "comment_id": 97864943, "body": "When I switched to rbenv global 2.6.1 and checked the bundler version, it says bundler version 2.0.1. Also, check the post edit, I added the Capfile, which has the set:rbenv type and user, but when I use cap production deploy, it still throws the same error as before."}, {"owner": {"reputation": 2244, "user_id": 163231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f3584528141b950ebb596087b9a59ef?s=128&d=identicon&r=PG", "display_name": "count0", "link": "https://stackoverflow.com/users/163231/count0"}, "reply_to_user": {"reputation": 75, "user_id": 8702213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099caf15a5389286503bb56dec9ee607?s=128&d=identicon&r=PG&f=1", "display_name": "Alien", "link": "https://stackoverflow.com/users/8702213/alien"}, "edited": false, "score": 0, "creation_date": 1554840120, "post_id": 55583116, "comment_id": 97896943, "body": "Hardcoding version in Capfile was to enforce the right rbenv is loaded for deployment. From your logs this seems the case (even before the Capfile tweak). But it seems that something went wrong installing the new version. Can you try <code>bundle update --bundler</code> as deploy user. Maybe bundler will autocorrect it. Usually double checking the error-logs and looking at the correctness of the paths helps with those type of issues."}], "tags": [], "owner": {"reputation": 2244, "user_id": 163231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f3584528141b950ebb596087b9a59ef?s=128&d=identicon&r=PG", "display_name": "count0", "link": "https://stackoverflow.com/users/163231/count0"}, "is_accepted": false, "score": 0, "last_activity_date": 1554765965, "creation_date": 1554765965, "answer_id": 55583116, "question_id": 55583038, "link": "https://stackoverflow.com/questions/55583038/capistrano-wont-deploy-rails-app-with-bundler/55583116#55583116", "title": "Capistrano Wont Deploy Rails App With Bundler", "body": "<p>First check if you have bundler installed as the deploy user <strong>after</strong> switching into the proper <code>rbenv</code>:</p>\n\n<pre><code>rbenv global 2.6.1\nbundler --version\n</code></pre>\n\n<p>If not install it: <code>gem install bundler:2.0.1</code>.</p>\n\n<p>Otherwise make sure your <code>Capfile</code> has the rbenv label mentioned (see tutorial).</p>\n\n<pre><code>set :rbenv_type, :user\nset :rbenv_ruby, '2.6.1'\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8702213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099caf15a5389286503bb56dec9ee607?s=128&d=identicon&r=PG&f=1", "display_name": "Alien", "link": "https://stackoverflow.com/users/8702213/alien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554769210, "creation_date": 1554765414, "last_edit_date": 1554769210, "question_id": 55583038, "link": "https://stackoverflow.com/questions/55583038/capistrano-wont-deploy-rails-app-with-bundler", "title": "Capistrano Wont Deploy Rails App With Bundler", "body": "<p>I'm trying to set up my rails app onto a DigitalOcean Server with postgres, following <a href=\"https://gorails.com/deploy/ubuntu/18.04#vps\" rel=\"nofollow noreferrer\">This Tutorial</a>. I am at the point where I am trying to deploy my app with capistrano, but when I run  <code>$cap production deploy</code>, it always fails with this error message:</p>\n\n<pre><code>** DEPLOY FAILED\n** Refer to log/capistrano.log for details. Here are the last 20 lines:\n\n\n DEBUG [1c7e325c]       )\n\n DEBUG [1c7e325c]       \n\n DEBUG [1c7e325c]       To update to the latest version installed on your system, run `bundle update --bundler`.\n\nTo install the missing version, run `gem install bundler:2.0.1`\n\n DEBUG [1c7e325c]               from /home/deploy/.rbenv/versions/2.6.1/lib/ruby/2.6.0/rubygems.rb:302:in `activate_bin_path'\n\n DEBUG [1c7e325c]               from /home/deploy/.rbenv/versions/2.6.1/bin/bundle:23:in `&lt;main&gt;'\n\n DEBUG [1c7e325c] Finished in 0.408 seconds with exit status 1 (failed).\n\n  INFO [5d18f10c] Running $HOME/.rbenv/bin/rbenv exec bundle install --path /home/deploy/myapp/shared/bundle --jobs 4 --without development test --deployment --quiet as deploy@1.2.3.4\n\n DEBUG [5d18f10c] Command: cd /home/deploy/myapp/releases/20190408225913 &amp;&amp; ( export RBENV_ROOT=\"$HOME/.rbenv\" RBENV_VERSION=\"2.6.1\" ; $HOME/.rbenv/bin/rbenv exec bundle install --path /home/deploy/myapp/shared/bundle --jobs 4 --without development test --deployment --quiet )\n\n DEBUG [969718b0]       /home/deploy/.rbenv/versions/2.6.1/lib/ruby/2.6.0/rubygems.rb:283:in `find_spec_for_exe'\n\n DEBUG [969718b0]       : \n\n DEBUG [969718b0]       Could not find 'bundler' (2.0.1) required by your /home/deploy/myapp/releases/20190408225913/Gemfile.lock.\n\n DEBUG [969718b0]        (\n\n DEBUG [969718b0]       Gem::GemNotFoundException\n\n DEBUG [969718b0]       )\n\n DEBUG [969718b0]       \n\n DEBUG [969718b0]       To update to the latest version installed on your system, run `bundle update --bundler`.\n\nTo install the missing version, run `gem install bundler:2.0.1`\n\n DEBUG [969718b0]               from /home/deploy/.rbenv/versions/2.6.1/lib/ruby/2.6.0/rubygems.rb:302:in `activate_bin_path'\n\n DEBUG [969718b0]               from /home/deploy/.rbenv/versions/2.6.1/bin/bundle:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>This is my deploy file:</p>\n\n<pre><code>set :application, \"myapp\"\nset :repo_url, \"git@github.com:user/myapp.git\"\nappend :rbenv_map_bins, 'puma', 'pumactl'\n# Deploy to the user's home directory\nset :deploy_to, \"/home/deploy/#{fetch :application}\"\n\n\nset :default_environment, {\n    'PATH' =&gt; \"$HOME/.rbenv/shims:$HOME/.rbenv/bin:$PATH\"\n}\n\n\nappend :linked_dirs, 'log', 'tmp/pids', 'tmp/cache', 'tmp/sockets', 'vendor/bundle', '.bundle', 'public/system', 'public/uploads'\n\n# Only keep the last 5 releases to save disk space\nset :keep_releases, 5\n\n# Optionally, you can symlink your database.yml and/or secrets.yml file from the shared directory during deploy\n# This is useful if you don't want to use ENV variables\n# append :linked_files, 'config/database.yml', 'config/secrets.yml'\n</code></pre>\n\n<p>gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.4.1'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.3'\n# Use postgresql as the database for Active Record\ngem 'pg', '&gt;= 0.18', '&lt; 2.0'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'mini_racer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of chromedriver to run system tests with Chrome\n  gem 'chromedriver-helper'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n\ngem 'capistrano', '~&gt; 3.11'\ngem 'capistrano-passenger', '~&gt; 0.2.0'\ngem 'capistrano-rails', '~&gt; 1.4'\ngem 'capistrano-rbenv', '~&gt; 2.1', '&gt;= 2.1.4'\n</code></pre>\n\n<p>I've already tried running <code>gem install bundler:2.0.1</code> and <code>gem install bundler</code> on both the deploy@myapp and my local computer. Any suggestions on how I can fix this problem, and fix the error that occurs when I try to deploy my app to production with capistrano rbenv?</p>\n\n<p><strong><em>EDIT</em></strong>\nCapfile:</p>\n\n<pre><code># Load DSL and set up stages\nrequire \"capistrano/setup\"\n\n# Include default deployment tasks\nrequire \"capistrano/deploy\"\n\n# Load the SCM plugin appropriate to your project:\n#\n# require \"capistrano/scm/hg\"\n# install_plugin Capistrano::SCM::Hg\n# or\n# require \"capistrano/scm/svn\"\n# install_plugin Capistrano::SCM::Svn\n# or\nrequire \"capistrano/scm/git\"\ninstall_plugin Capistrano::SCM::Git\n\n# Include tasks from other gems included in your Gemfile\n#\n# For documentation on these, see for example:\n#\n#   https://github.com/capistrano/rvm\n#   https://github.com/capistrano/rbenv\n#   https://github.com/capistrano/chruby\n#   https://github.com/capistrano/bundler\n#   https://github.com/capistrano/rails\n#   https://github.com/capistrano/passenger\n#\n# require \"capistrano/rvm\"\n# require \"capistrano/rbenv\"\n# require \"capistrano/chruby\"\n# require \"capistrano/bundler\"\n# require \"capistrano/rails/assets\"\n# require \"capistrano/rails/migrations\"\n# require \"capistrano/passenger\"\n\n# Load custom tasks from `lib/capistrano/tasks` if you have any defined\nDir.glob(\"lib/capistrano/tasks/*.rake\").each { |r| import r }\n\nrequire 'capistrano/rails'\nrequire 'capistrano/passenger'\nrequire 'capistrano/rbenv'\n\nset :rbenv_type, :user\nset :rbenv_ruby, '2.6.1'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "pdf-generation"], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "is_accepted": true, "score": 0, "last_activity_date": 1574849072, "last_edit_date": 1574849072, "creation_date": 1556385532, "answer_id": 55883045, "question_id": 55582406, "link": "https://stackoverflow.com/questions/55582406/hexapdf-page-orientation-and-content-sequence/55883045#55883045", "title": "hexapdf page orientation and content sequence", "body": "<p>answers are below.</p>\n\n<p>1) <code>composer</code> will help to create a doc from top to bottom.</p>\n\n<p>2) import font like this.</p>\n\n<p>example:</p>\n\n<pre><code>HexaPDF::Composer.create('composer.pdf') do |pdf|\n  font_name = \"path_of_file.ttf\"\n  text_style = pdf.base_style.dup.update(font: font_name)\n  pdf.text(\"this is some text\", style: text_style)\nend\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 55883045, "answer_count": 1, "score": 0, "last_activity_date": 1574849072, "creation_date": 1554761050, "last_edit_date": 1557658564, "question_id": 55582406, "link": "https://stackoverflow.com/questions/55582406/hexapdf-page-orientation-and-content-sequence", "title": "hexapdf page orientation and content sequence", "body": "<p>I'm using <code>hexapdf</code> for pdf creation and newbie in this gem so I want some solutions about the following issues.</p>\n\n<p>1) How to set page content from top instead of bottom in <code>hexapdf</code> gem's page and how can we give height, width and at parameters in percentage.\"</p>\n\n<p>2) how can import new font in this.</p>\n\n<p>please give me some solution for these problem</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554760488, "post_id": 55581478, "comment_id": 97862763, "body": "Regarding formatting, to have a code block stand out you&#39;ve surrounded it with a series of backticks. That&#39;s OK, but the usual practice is to indent your code four spaces. If you like you can write your code with no indent, then select it and click on <code>{}</code> above the code box. That will shift your code 4 spaces. To highlight <code>middle_element</code> in the text in your answer, surround it with backticks."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554761732, "post_id": 55581478, "comment_id": 97863173, "body": "The <code>return</code> keword (in two places) in not needed, as the return value of the <code>case</code> statement will be the return value of the method. <code>self</code> is the implicit receiver of instance methods, so you generally don&#39;t need <code>self.</code>. You&#39;ve omitted <code>self.</code> in <code>mid = size&#47;2</code> but not in <code>self.take</code> and <code>self.drop</code>.  You can&#39;t change <code>self[mod]</code> to <code>[mod]</code>, but you could write <code>[].(mid)</code>, which I do not recommend. The second line under <code>else</code> could be <code>mid + 1 my_besearch unless besearch.nil?</code>, as <code>nil</code> is returned if the <code>unless</code> test fails. Some may view this as less clear than what you wrote, however."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11295999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4w3t.jpg?s=128&g=1", "display_name": "Hangman", "link": "https://stackoverflow.com/users/11295999/hangman"}, "edited": false, "score": 0, "creation_date": 1554759498, "post_id": 55581993, "comment_id": 97862462, "body": "Hi Tim,   Thanks for jumping in, it looks like I posted right as you were. I&#39;ve looked over your suggestions and edited the code in my follow up post. I cleaned up the redundant .nil? == true comparison as well as the self.empty?. I tried self.empty? on the line for return nil if searched_right_side.nil? and it errored out in rspec. So I&#39;m keeping it as .nil? unless you can think of something otherwise."}], "tags": [], "owner": {"reputation": 151, "user_id": 4616147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sAbMa.jpg?s=128&g=1", "display_name": "Tim Heilman", "link": "https://stackoverflow.com/users/4616147/tim-heilman"}, "is_accepted": false, "score": 1, "last_activity_date": 1554758742, "creation_date": 1554758742, "answer_id": 55581993, "question_id": 55581478, "link": "https://stackoverflow.com/questions/55581478/extending-monkey-patching-a-binary-search-for-array-class-and-syntactic-sugar/55581993#55581993", "title": "Extending (Monkey Patching) a Binary Search for Array Class and Syntactic Sugar", "body": "<p>First, <code>take</code> and <code>drop</code> have sufficiently similar interfaces that you don't actually want your <code>+ 1</code> for drop.  It will disregard one element in the array if you do.</p>\n\n<p>Next, <code>self.nil?</code> will always be <code>false</code> (and never <code>nil</code>) for instances of this class.  In fact, <code>.nil?</code> is a method exactly to avoid having to ever compare against <code>nil</code> with <code>==</code>. </p>\n\n<p>You want <code>self.empty?</code>.  Furthermore, with the exception of setters, in Ruby messages are sent to <code>self</code> by default.  In other words, the only time <code>self.</code> is a useful prefix is when the message ends in <code>=</code> and operates as an lvalue, as in <code>self.instance_var = 'a constant'</code>, since without the <code>self.</code>, the tokens <code>instance_var =</code> would be interpreted as a local variable rather than an instance variable setting.  That's not the case here, so <code>empty?</code> will suffice just as well as <code>self.empty?</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11295999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4w3t.jpg?s=128&g=1", "display_name": "Hangman", "link": "https://stackoverflow.com/users/11295999/hangman"}, "is_accepted": false, "score": 0, "last_activity_date": 1554759556, "last_edit_date": 1554759556, "creation_date": 1554759000, "answer_id": 55582039, "question_id": 55581478, "link": "https://stackoverflow.com/questions/55581478/extending-monkey-patching-a-binary-search-for-array-class-and-syntactic-sugar/55582039#55582039", "title": "Extending (Monkey Patching) a Binary Search for Array Class and Syntactic Sugar", "body": "<p>So I figured it out, and I decided to answer my own post in hopes to help someone else out if they run into this issue.</p>\n\n<p>So, if I have an Array and the target is the middle_element, then it will report middle_element_idx. That's fine. What if the target is less than middle_element? It recursively searches the left-side of the original Array. When it finds it, it reports the left_side_idx. There's no problem with that because elements in an array are sequentially counted left to right. So, it starts at 0 and goes up.</p>\n\n<p>But what if the target is on the right side of the middle element? </p>\n\n<p>Well, searching for the right side is easy. Relatively the same logic as searching left. Done recursively. And it will return a target_idx if it's found on that right side --however that's the target's idx as it was found in the right-side array! So, you need to take that returned target_idx and add 1 to it and the original middle_element_idx. See below:</p>\n\n<pre><code>  def my_bsearch(target)\n\n    return nil if self.empty?\n\n    middle_idx = self.length/2\n    left = self.take(middle_idx)\n    right = self.drop(middle_idx + 1)\n\n      if self[middle_idx] == target\n        return middle_idx\n      elsif self[middle_idx] &gt; target\n        return left.my_bsearch(target)\n      else\n        searched_right_side = 1 + right.my_bsearch(target)\n        return nil if searched_right_side.nil? == true\n        return searched_right_side + middle_idx\n      end\n\n  end\nend\n\n</code></pre>\n\n<p>Notice how many more lines this solution is? The spaceship operator used in conjunction with case/when and a ternary method will reduce the number of lines significantly. </p>\n\n<p>Based on suggestions/feedback from Tim, I updated it to:</p>\n\n<pre><code>  def my_bsearch(target)\n\n    return nil if empty?\n\n    middle_idx = self.length/2\n    left = self.take(middle_idx)\n    right = self.drop(middle_idx)\n\n      if self[middle_idx] == target\n        return middle_idx\n      elsif self[middle_idx] &gt; target\n        return left.my_bsearch(target)\n      else\n        searched_right_side = right.my_bsearch(target)\n        return nil if searched_right_side.nil?\n        return searched_right_side + middle_idx\n      end\n\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11295999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4w3t.jpg?s=128&g=1", "display_name": "Hangman", "link": "https://stackoverflow.com/users/11295999/hangman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554759556, "creation_date": 1554756259, "last_edit_date": 1554758145, "question_id": 55581478, "link": "https://stackoverflow.com/questions/55581478/extending-monkey-patching-a-binary-search-for-array-class-and-syntactic-sugar", "title": "Extending (Monkey Patching) a Binary Search for Array Class and Syntactic Sugar", "body": "<p>I've been studying a few searching algorithms and my last problem comes down to binary searching. I watched a few youtube videos to understand the concept and then tried to solve the problem, but keep getting an endless loop error. I've looked through stack overflow, and reddit, and wherever Google would lead me, but I can't quite find a solution that fits my method of coding. Also, please excuse the term 'monkey patching', it's been brought to my attention that the technical term is called 'extending' so the fault lies on my instructors for teaching it to us as 'monkey patching'.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>class Array\n   def my_bsearch(target)\n\n    return nil if self.empty?\n\n    middle_idx = self.length/2\n\n    left = self.take(middle_idx)\n    right = self.drop(middle_idx + 1)\n\n    return middle_idx if self[middle_idx] == target\n\n    until self[middle_idx] == target || self.nil? == nil\n      if self[middle_idx] &lt; target\n        right.my_bsearch(target)\n      elsif self[middle_idx] &gt; target\n        left.my_bsearch(target)\n      end\n    end\n\n  end\nend\n\n</code></pre>\n\n<p>I have a solution, but I don't want to just memorize it-- and I'm having trouble understanding it; as I'm trying to translate it, learn from it, and implement what I'm missing into my own code.</p>\n\n<pre><code>class Array\n  def my_bsearch(target)\n    return nil if size == 0\n    mid = size/2\n\n    case self[mid] &lt;=&gt; target\n    when 0\n      return mid\n    when 1\n      return self.take(mid).my_bsearch(target)\n    else\n      search_res = self.drop(mid+1).my_bsearch(target)\n      search_res.nil? ? nil : mid + 1 + search_res\n    end\n  end\nend\n\n</code></pre>\n\n<p>I guess I understand case/when despite not use to using it. I've tried following it with debugger, but I think I'm hung up on what's going on in the ELSE section. The syntactic sugar, while making this obviously more concise than my logic, isn't straight-forward/clean to someone of my ruby literacy level. So, yeah, my ignorance is most of the problem I guess. </p>\n\n<p>Is there someone who is a little more literate, and patient, able to help me break this down into something I can understand a bit better so I can learn from this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "shrine"], "answers": [{"tags": [], "owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1554897416, "creation_date": 1554897416, "answer_id": 55611986, "question_id": 55580732, "link": "https://stackoverflow.com/questions/55580732/shrine-gem-with-rails-generate-versions-with-upload-endpoint/55611986#55611986", "title": "Shrine gem with Rails: generate versions with upload endpoint?", "body": "<p>The <code>:recache</code> action only happens when you assign a file to a model instance, and after validation succeeded. So the <code>recache</code> plugin is not what you want here.</p>\n\n<p>Whenever Shrine uploads a file, it includes an <code>:action</code> parameter in that upload, and this is what's matched when you register a <code>process</code> block. It's not currently documented, but the <code>upload_endpoint</code> includes <code>action: :upload</code>, so just use <code>process(:upload)</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>process(:upload) do |io, context|\n  # ...\nend\n</code></pre>\n\n<p>In your <code>:rack_response</code> block, <code>uploaded_file</code> will now be a hash of uploaded files, so you won't be able to call <code>#data</code> on it. But you can just include them in the hash directly, and they should automatically convert to JSON.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  plugin :upload_endpoint, rack_response: -&gt; (uploaded_file, request) do\n    body = { data: uploaded_file, url: uploaded_file[:original].url }.to_json\n    [201, { \"Content-Type\" =&gt; \"application/json\" }, [body]]\n  end\n</code></pre>\n"}], "owner": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 55611986, "answer_count": 1, "score": 0, "last_activity_date": 1554897416, "creation_date": 1554752819, "question_id": 55580732, "link": "https://stackoverflow.com/questions/55580732/shrine-gem-with-rails-generate-versions-with-upload-endpoint", "title": "Shrine gem with Rails: generate versions with upload endpoint?", "body": "<p>I use Shrine gem with Rails 5. I enabled plugins upload_endpoint, versions, processing and recache. I expected to get generated versions in upload endpoint response.</p>\n\n<pre><code>class VideoUploader &lt; Shrine\n  plugin :processing\n  plugin :versions\n  plugin :recache\n  plugin :upload_endpoint\n\n  plugin :upload_endpoint, rack_response: -&gt; (uploaded_file, request) do\n\n    # ??? I expected uploaded_file to have thumbnail version here ???\n\n    body = { data: uploaded_file.data, url: uploaded_file.url }.to_json\n    [201, { \"Content-Type\" =&gt; \"application/json\" }, [body]]\n  end\n\n  process(:recache) do |io, context|\n    versions = { original: io }\n\n    io.download do |original|\n      screenshot = Tempfile.new([\"screenshot\", \".jpg\"], binmode: true)\n      movie = FFMPEG::Movie.new(original.path)\n      movie.screenshot(screenshot.path)\n      screenshot.open # refresh file descriptors\n\n      versions[:thumbnail] = screenshot\n    end\n\n    versions\n  end\nend\n</code></pre>\n\n<p>Why process callback process(:recache) happens only when saving whole record? And how to make it generate versions right after direct uploading?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 1, "creation_date": 1554752255, "post_id": 55580566, "comment_id": 97859650, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3884829/ruby-how-to-group-a-ruby-array\">Ruby: How to group a Ruby array?</a>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 2, "creation_date": 1554752649, "post_id": 55580566, "comment_id": 97859825, "body": "Read about the use of return in a block. Try <code>hash[word] += 1</code> just with <code>word</code> and  <code>hash</code> as block variables."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1554800944, "post_id": 55580566, "comment_id": 97875062, "body": "&quot;doesn&#39;t work at all&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1554787028, "last_edit_date": 1554787028, "creation_date": 1554754629, "answer_id": 55581138, "question_id": 55580566, "link": "https://stackoverflow.com/questions/55580566/making-a-hash-out-of-an-array-of-strings/55581138#55581138", "title": "Making a hash out of an Array of strings", "body": "<p>While you can follow the comments above for fixing your code, I liked to provide this alternative:</p>\n\n<pre><code>array.zip.group_by(&amp;:first).transform_values(&amp;:size)\n#=&gt; {\"banana\"=&gt;1, \"pear\"=&gt;1, \"mango\"=&gt;2, \"kiwi\"=&gt;1}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "is_accepted": false, "score": 1, "last_activity_date": 1554755514, "last_edit_date": 1554755514, "creation_date": 1554755208, "answer_id": 55581257, "question_id": 55580566, "link": "https://stackoverflow.com/questions/55580566/making-a-hash-out-of-an-array-of-strings/55581257#55581257", "title": "Making a hash out of an Array of strings", "body": "<p>With latest ruby (<code>itself</code> and <code>transform_values</code> methods) you can do:</p>\n\n<pre><code>%w(word one two word).group_by(&amp;:itself).transform_values(&amp;:length)\n# =&gt; {\"word\"=&gt;2, \"one\"=&gt;1, \"two\"=&gt;1}\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>.group_by(&amp;:itself)\n# returns =&gt; {\"word\"=&gt;[\"word\", \"word\"], \"one\"=&gt;[\"one\"], \"two\"=&gt;[\"two\"]}\n\n.transform_values(&amp;:length)\n# returns =&gt; {\"word\"=&gt;2, \"one\"=&gt;1, \"two\"=&gt;1}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1554757453, "post_id": 55581364, "comment_id": 97861770, "body": "I think this is the best way to do it."}, {"owner": {"reputation": 61, "user_id": 11330515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acfe29ab72a4bc4f6758b7992e4350d?s=128&d=identicon&r=PG&f=1", "display_name": "ollsop", "link": "https://stackoverflow.com/users/11330515/ollsop"}, "edited": false, "score": 0, "creation_date": 1554813140, "post_id": 55581364, "comment_id": 97882331, "body": "Thanks, this is really helpful. But why do we write counts[word] +=1 rather than word[counts] +=1 ? I think the fact that &quot;count&quot;, which is the value, goes before the &quot;word&quot;, which is the key, confuses me.                                                                                           Is it because &quot;word&quot; here is a key so it has to be in []?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554826478, "post_id": 55581364, "comment_id": 97890743, "body": "<code>counts</code> here is a hash (<code>Hash.new(0)</code>) where the keys are strings and the values are numbers. This is the signature of <a href=\"https://apidock.com/rails/Enumerable/each_with_object\" rel=\"nofollow noreferrer\"><code>each_with_object</code></a>. Maybe add a <code>puts counts</code> in the loop so you can see. You could rename <code>counts</code> to <code>hash</code> if that makes things more clear for you"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1554755635, "creation_date": 1554755635, "answer_id": 55581364, "question_id": 55580566, "link": "https://stackoverflow.com/questions/55580566/making-a-hash-out-of-an-array-of-strings/55581364#55581364", "title": "Making a hash out of an Array of strings", "body": "<p>To make your code work you would need to fix the way you use <code>each_with_object</code>.</p>\n\n<pre><code>array = %w(banana pear mango kiwi mango)\n\nhash1 = array.each_with_object(Hash.new(0)) do |word, counts|\n  counts[word] += 1\nend\n\nputs hash1\n</code></pre>\n\n<p><code>Hash.new(0)</code> is a hash that returns zero when an unknown key is read. So what you're doing here is populating it by iterating over <code>array</code> and increasing the count for each key by one.</p>\n\n<p>I recommend reading more up on reduce and each_with_object to understand their usage.</p>\n\n<p>Fabio's answer is the more idiomatic one, but I just wanted to show how to fix your code rather than rewrite it.</p>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "is_accepted": false, "score": 1, "last_activity_date": 1554786640, "creation_date": 1554786640, "answer_id": 55585471, "question_id": 55580566, "link": "https://stackoverflow.com/questions/55580566/making-a-hash-out-of-an-array-of-strings/55585471#55585471", "title": "Making a hash out of an Array of strings", "body": "<p>Don't know if its efficient way or not, but its alternate way\n<code>\n%w[banana pear mango kiwi mango].group_by{|x| x}.map{|key, values| [key, values.length]}.to_h\n</code></p>\n"}], "owner": {"reputation": 61, "user_id": 11330515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acfe29ab72a4bc4f6758b7992e4350d?s=128&d=identicon&r=PG&f=1", "display_name": "ollsop", "link": "https://stackoverflow.com/users/11330515/ollsop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1554787028, "creation_date": 1554752042, "last_edit_date": 1554757072, "question_id": 55580566, "link": "https://stackoverflow.com/questions/55580566/making-a-hash-out-of-an-array-of-strings", "title": "Making a hash out of an Array of strings", "body": "<p>I'm new to Ruby (and coding in general) and trying to convert an array into a hash, with keys being words and values being the number of times the words occur in the array (so e.g. \"banana\" => 1, \"mango\" => 2 etc).</p>\n\n<p>I'm trying to do so with each_with_object as I read it should work for building new hashes from arrays.</p>\n\n<pre><code>array = %w(banana pear mango kiwi mango)\n\nhash1 = array.each_with_object(Hash.new(0)) do |word, count|\n  hash1[word] = count\n  count += 1\n  return hash1\nend\n\nputs hash1\n</code></pre>\n\n<p>But the code doesn't work at all. Can someone please explain to me why not and what I should change? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "ruby-on-rails-5.1"], "answers": [{"tags": [], "owner": {"reputation": 277, "user_id": 6770601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83c06b3b12c1782276623ef08355495?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/6770601/kamil"}, "is_accepted": true, "score": 1, "last_activity_date": 1555154728, "creation_date": 1555154728, "answer_id": 55664936, "question_id": 55580474, "link": "https://stackoverflow.com/questions/55580474/rails-semantic-logger-tags-stopped-working-after-upgrade-to-4-4-1/55664936#55664936", "title": "Rails semantic logger tags stopped working after upgrade to 4.4.1", "body": "<p>Semantic logger from version 4.3 or 4.4 needs setting config.log_tags earlier. It need to be set in config/[ENV_NAME].rb or application.rb. Initializer in config/initializers/*.rb is too late as loggers for Rails &amp; Rack are initialzied before.</p>\n"}], "owner": {"reputation": 277, "user_id": 6770601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83c06b3b12c1782276623ef08355495?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/6770601/kamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 55664936, "answer_count": 1, "score": 0, "last_activity_date": 1555154728, "creation_date": 1554751599, "question_id": 55580474, "link": "https://stackoverflow.com/questions/55580474/rails-semantic-logger-tags-stopped-working-after-upgrade-to-4-4-1", "title": "Rails semantic logger tags stopped working after upgrade to 4.4.1", "body": "<p><strong>Before upgrade</strong>\nI used rails_semantic_logger with tags for logging request id, and session id. I had in my logging initialzier and it worked adding tags with these ids:</p>\n\n<pre><code>  config.log_tags = [\n      #:host,\n      #:remote_ip,\n      lambda { |request| \"#{request.uuid}\"[0..32] },\n      lambda { |request| \"#{request.cookie_jar[\"_session_id\"]}\" },\n  ]\n</code></pre>\n\n<p>Sample log row:</p>\n\n<pre><code>2019-04-07 13:54:03.563661 I [25929:puma 001] [[\"a2eb2610-9db1-475b-8d0a-547dc514d\", \"7713d31653d81aa6d9fe1882c282cc95\"]] (499.8ms) DebugController -- Completed #show -- { :controller =&gt; \"DebugController\", :action =&gt; \"show\", :format =&gt; \"*/*\", :method =&gt; \"GET\", :path =&gt; \"/debug\", :status =&gt; 200, :view_runtime =&gt; 463.81, :rendered_format =&gt; :js, :variant =&gt; [], :db_runtime =&gt; 32.32, :status_message =&gt; \"OK\" }\n</code></pre>\n\n<p>Environment:</p>\n\n<ul>\n<li>rails 5.0.4</li>\n<li>ruby 2.4.2</li>\n<li>semantic_logger 4.2.0</li>\n<li>rails_semantic_loggger 4.1.3</li>\n</ul>\n\n<p><strong>After upgrade</strong>\nRecently I upgraded my enviroment to newer versions of rails and gems (specific versions below) I can't setup automatic tags logging. I tried some combinations with named_tags like this:</p>\n\n<pre><code>  config.log_tags = {\n      host:       :host,\n      ip:         :remote_ip,\n      request_id: :request_id,\n      session_id: -&gt; request { request.cookie_jar['_session_id'] }\n  }\n</code></pre>\n\n<p>But it simply doesn't work:</p>\n\n<pre><code>2019-04-07 14:19:04.131479 I [23455:puma 001] (394.2ms) DebugController -- Completed #show -- { :controller =&gt; \"DebugController\", :action =&gt; \"show\", :format =&gt; \"*/*\", :method =&gt; \"GET\", :path =&gt; \"/debug\", :status =&gt; 200, :view_runtime =&gt; 384.13, :db_runtime =&gt; 6.99, :status_message =&gt; \"OK\" }\n\n</code></pre>\n\n<p>Environment:\n- rails 5.1.7\n- ruby 2.4.2\n- semantic_logger 4.2.0\n- rails_semantic_loggger 4.4.1</p>\n\n<p>I created a sample app to picture the problem: <a href=\"https://github.com/camaeel/logger-error\" rel=\"nofollow noreferrer\">https://github.com/camaeel/logger-error</a></p>\n"}, {"tags": ["ruby", "rvm"], "comments": [{"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 0, "creation_date": 1554750999, "post_id": 55580311, "comment_id": 97859086, "body": "Backtick notation?"}], "answers": [{"comments": [{"owner": {"reputation": 1635, "user_id": 3017954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eb24756b6ef26baee8ae161006099cc7?s=128&d=identicon&r=PG&f=1", "display_name": "CodeSmith", "link": "https://stackoverflow.com/users/3017954/codesmith"}, "edited": false, "score": 0, "creation_date": 1556580496, "post_id": 55590744, "comment_id": 98478843, "body": "I only wanted to access the current shell because it was already a login shell.  This solution works great."}], "tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": true, "score": 1, "last_activity_date": 1554805936, "creation_date": 1554805936, "answer_id": 55590744, "question_id": 55580311, "link": "https://stackoverflow.com/questions/55580311/how-to-execute-a-ruby-system-call-in-the-context-of-the-current-shell/55590744#55590744", "title": "How to execute a Ruby system call in the context of the current shell", "body": "<p>These things can be tricky with RVM. Try this:</p>\n\n<pre><code>\"/bin/bash -c -l 'rvm use 2.5.5 &amp;&amp; &lt;add your system commands here&gt;'\"\n</code></pre>\n\n<p>Note: I guess it would create a <em>new</em> shell environment. Do you really need to access your <em>current</em> shell? </p>\n"}], "owner": {"reputation": 1635, "user_id": 3017954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eb24756b6ef26baee8ae161006099cc7?s=128&d=identicon&r=PG&f=1", "display_name": "CodeSmith", "link": "https://stackoverflow.com/users/3017954/codesmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 55590744, "answer_count": 1, "score": 0, "last_activity_date": 1554811362, "creation_date": 1554750917, "last_edit_date": 1554811362, "question_id": 55580311, "link": "https://stackoverflow.com/questions/55580311/how-to-execute-a-ruby-system-call-in-the-context-of-the-current-shell", "title": "How to execute a Ruby system call in the context of the current shell", "body": "<p>I'm executing a call to <code>rvm use ...</code> from inside a Ruby script:</p>\n\n<pre><code>system \"rvm use 2.5.5\"\n</code></pre>\n\n<p>When the above executes, I get</p>\n\n<pre><code>RVM is not a function, selecting rubies with 'rvm use ...' will not work.  \n\nYou need to change your terminal emulator preferences to allow login shell.\n</code></pre>\n\n<p>I'm fairly sure that I'm logged in as a login shell.  There's no problem using normal RVM commands in the terminal I have open.  Does the <code>system</code> command pick up on the current shell or does it use something else by default?  If it uses something else, what's the best way to get Ruby to run a command in the context of the current shell?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "export-to-csv"], "comments": [{"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 1, "creation_date": 1554746851, "post_id": 55579125, "comment_id": 97857134, "body": "You don&#39;t need those headers, just set type and filename: <code>send_data @incentives.to_csv, type: &#39;text&#47;csv&#39;, filename: &#39;myfile.csv&#39;</code>."}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554747089, "post_id": 55579125, "comment_id": 97857271, "body": "@CAmador That still gives me the same response."}, {"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554747632, "post_id": 55579125, "comment_id": 97857527, "body": "byebug/log that format.csv, is the block really being run?"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554747676, "post_id": 55579125, "comment_id": 97857542, "body": "@CAmador It&#39;s not being being hit"}, {"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 1, "creation_date": 1554747750, "post_id": 55579125, "comment_id": 97857578, "body": "set a new action just for the export, or comment out all the respond_to thing except the call to send_data"}, {"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554748078, "post_id": 55579125, "comment_id": 97857756, "body": "Also, is <code>incenctives_path(property.slug)</code> even pointing to <code>index</code>?"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554748419, "post_id": 55579125, "comment_id": 97857937, "body": "@CAmador creating the custom action fixed it"}, {"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554748572, "post_id": 55579125, "comment_id": 97858014, "body": "Glad to know. I think it was a routing issue, btw. Maybe your index action wasn&#39;t being hit at all. Check the log."}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1554748867, "post_id": 55579125, "comment_id": 97858155, "body": "@CAmador Just checked. I was hitting that action, just not the <code>format.csv</code> block"}], "answers": [{"comments": [{"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "edited": false, "score": 0, "creation_date": 1554747539, "post_id": 55579408, "comment_id": 97857479, "body": "It doesn&#39;t help."}], "tags": [], "owner": {"reputation": 36, "user_id": 4581953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d671335239a2ec26579260f24dd3614?s=128&d=identicon&r=PG&f=1", "display_name": "bardera", "link": "https://stackoverflow.com/users/4581953/bardera"}, "is_accepted": true, "score": 1, "last_activity_date": 1554747148, "creation_date": 1554747148, "answer_id": 55579408, "question_id": 55579125, "link": "https://stackoverflow.com/questions/55579125/link-to-csv-rendering-as-html/55579408#55579408", "title": "Link to CSV rendering as HTML", "body": "<p>Assuming the routes are all in good order, have you <a href=\"https://www.codementor.io/victor_hazbun/export-records-to-csv-files-ruby-on-rails-vda8323q0\" rel=\"nofollow noreferrer\">tried this way</a> of including the <code>filename</code> like this?</p>\n\n<pre><code>def index\n\n  respond_to do |format|\n    format.html\n    format.csv do\n      send_data @incentives.to_csv, filename: 'custome_incentives.csv'\n    end\n  end\nend\n</code></pre>\n\n<p>It is also possible to <a href=\"https://stackoverflow.com/a/12785972/4581953\">force a download link</a> if that doesn't work out. </p>\n"}], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 55579408, "answer_count": 1, "score": 0, "last_activity_date": 1554747627, "creation_date": 1554746094, "last_edit_date": 1554747627, "question_id": 55579125, "link": "https://stackoverflow.com/questions/55579125/link-to-csv-rendering-as-html", "title": "Link to CSV rendering as HTML", "body": "<p>I have a link in my rails application that should export CSV. But when I click on the link it reloads the page as html. I tried adding <code>response.headers['Content-Type'] = 'text/csv'\n    response.headers['Content-Disposition'] = 'attachment; filename=invoice.csv'</code> to the controller but that doesn't help. </p>\n\n<h3>controller</h3>\n\n<pre><code>def index\n\n  respond_to do |format|\n    format.html\n    format.csv do\n      response.headers['Content-Type'] = 'text/csv'\n      response.headers['Content-Disposition'] = 'attachment; filename=custome_incentives.csv'\n      send_data @incentives.to_csv\n    end\n  end\nend\n</code></pre>\n\n<h3>erb</h3>\n\n<pre><code>&lt;%= link_to 'Download to CSV', incentives_path(property.slug, format: :csv), class: 'btn csv' %&gt;\n</code></pre>\n\n<h3>update</h3>\n\n<p>I tried putting a binding.pry in the <code>format.csv</code> block and it does not fire.</p>\n"}, {"tags": ["ruby", "button", "fxruby"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6332141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf47d36c2ed9985c9eb0463cabdfe6?s=128&d=identicon&r=PG&f=1", "display_name": "Arbuthnut", "link": "https://stackoverflow.com/users/6332141/arbuthnut"}, "is_accepted": false, "score": 0, "last_activity_date": 1554981488, "creation_date": 1554981488, "answer_id": 55631258, "question_id": 55577867, "link": "https://stackoverflow.com/questions/55577867/how-does-one-unselect-previously-selected-button-when-re-enabling/55631258#55631258", "title": "How does one &quot;unselect&quot; previously selected button when re-enabling", "body": "<p>OK, I'm a bit stupid - the answer was obvious! All I needed to do was set the FXDataTarget value back to -1: @letterSel.value = -1</p>\n\n<p>(I don't know how to flag this as resolved)</p>\n"}], "owner": {"reputation": 11, "user_id": 6332141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf47d36c2ed9985c9eb0463cabdfe6?s=128&d=identicon&r=PG&f=1", "display_name": "Arbuthnut", "link": "https://stackoverflow.com/users/6332141/arbuthnut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554981488, "creation_date": 1554741072, "question_id": 55577867, "link": "https://stackoverflow.com/questions/55577867/how-does-one-unselect-previously-selected-button-when-re-enabling", "title": "How does one &quot;unselect&quot; previously selected button when re-enabling", "body": "<p>I have an old-school programming background, but am new to Ruby: For a Hangman game I have A..Z buttons connected via FXDataTarget (set to -1 so that first button is not auto-selected). During play, as each button is pressed it is disabled. To initialize a new game I re-enable each button. All is well except that the last button from the previous game is highlighted, and thus unavailable (until a different button is pressed). I obviously would like ALL buttons set as at load time.</p>\n\n<p>I have tried changing attributes(buttonStyle and State); I have tried killFocus; I have even tried re-creating the FXDataTarget. None of these have any effect.</p>\n\n<pre><code>@letterSel =FXDataTarget.new(-1)\n\nletterBtns = {}\n(\"A\"..\"Z\").each_with_index do |ltr, x|\n   letterBtns[x] = FXButton.new(matrix, ltr, opts:FRAME_RAISED, target:@letterSel, selector:FXDataTarget::ID_OPTION+(x))\nend\n\n@letterSel.connect(SEL_COMMAND) do |sender, sel, data|\n   ltr = letterBtns[data].text\n   letterBtns[data].disable\nend\n\nnewGameBtn.connect(SEL_COMMAND) do |sender, sel, data|\n   matrix.each_child do |btn|\n      btn.enable\n      # And here is where I try manipulating the button's appearance/functionality\n   end\nend\n</code></pre>\n"}, {"tags": ["ruby", "zlib"], "comments": [{"owner": {"reputation": 1244, "user_id": 1042324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf7d96c6cd1ad77fd77a1331b264819?s=128&d=identicon&r=PG", "display_name": "daniloisr", "link": "https://stackoverflow.com/users/1042324/daniloisr"}, "edited": false, "score": 0, "creation_date": 1554746317, "post_id": 55577218, "comment_id": 97856899, "body": "I guess that the <code>inflate</code> method is used to decompress the response from the server (as webservers compress data). As this error happens randomly, this can be an inconsistency in the server response."}, {"owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "reply_to_user": {"reputation": 1244, "user_id": 1042324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf7d96c6cd1ad77fd77a1331b264819?s=128&d=identicon&r=PG", "display_name": "daniloisr", "link": "https://stackoverflow.com/users/1042324/daniloisr"}, "edited": false, "score": 0, "creation_date": 1554748984, "post_id": 55577218, "comment_id": 97858209, "body": "but I don&#39;t set any headers like <code>Accept-Encoding: gzip,deflate</code> in the request. Or do you mean some kind of transport compression (and not content compression)? If so, can you elaborate?"}, {"owner": {"reputation": 1244, "user_id": 1042324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bf7d96c6cd1ad77fd77a1331b264819?s=128&d=identicon&r=PG", "display_name": "daniloisr", "link": "https://stackoverflow.com/users/1042324/daniloisr"}, "edited": false, "score": 0, "creation_date": 1554813373, "post_id": 55577218, "comment_id": 97882472, "body": "I found that <a href=\"https://github.com/ruby/ruby/blob/v2_6_0/lib/net/http/response.rb#L382\" rel=\"nofollow noreferrer\">response.rb#L382</a> &quot;This allows a large response body to be inflated without storing the entire body in memory.&quot;, and the error description is <a href=\"https://github.com/ruby/ruby/blob/v2_6_0/ext/zlib/zlib.c#L4860\" rel=\"nofollow noreferrer\">here</a> &quot;Usually if a stream was prematurely freed&quot;. So it <i>seems</i> that the error is indeed in the server, and in your code, I would catch this error and retry the request with a little timeout."}], "owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554738481, "creation_date": 1554738481, "question_id": 55577218, "link": "https://stackoverflow.com/questions/55577218/open-uri-fails-with-zlibdataerror-incorrect-data-check", "title": "open-uri fails with Zlib::DataError: incorrect data check", "body": "<p>I have a list of image urls (> 1000) that I need to download inside my ruby app. I'm using <code>open-uri</code> for this. I know that it has flaws, but it's handy if you have to support http, https and ftp.</p>\n\n<p>The call itself is as simple as this</p>\n\n<pre><code>file = open(url) # an https url\n</code></pre>\n\n<p>After that the file is processed by Paperclip.</p>\n\n<p>The problem is, that the call fails from time to time with a <code>Zlib::DataError</code>, even when using the same URLs over and over again. Sometimes they can be downloaded, sometimes an image throws an error. This is the stacktrace:</p>\n\n<pre><code>/usr/local/lib/ruby/2.6.0/net/http/response.rb:382 in inflate\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:382 in block in inflate_adapter\n/usr/local/lib/ruby/2.6.0/net/protocol.rb:497 in call_block\n/usr/local/lib/ruby/2.6.0/net/protocol.rb:488 in &lt;&lt;\n/usr/local/lib/ruby/2.6.0/net/protocol.rb:163 in read\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:405 in read\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:293 in block in read_body_0\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:264 in inflater\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:283 in read_body_0\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:204 in read_body\n/usr/local/lib/ruby/2.6.0/open-uri.rb:352 in block (2 levels) in open_http\n/usr/local/lib/ruby/2.6.0/net/http.rb:1518 in block in transport_request\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:165 in reading_body\n/usr/local/lib/ruby/2.6.0/net/http.rb:1517 in transport_request\n/usr/local/lib/ruby/2.6.0/net/http.rb:1479 in request\n/gems/newrelic_rpm-5.6.0.349/lib/new_relic/agent/instrumentation/net.rb:36 in block in request_with_newrelic_trace\n/gems/newrelic_rpm-5.6.0.349/lib/new_relic/agent.rb:501 in disable_all_tracing\n/gems/newrelic_rpm-5.6.0.349/lib/new_relic/agent/instrumentation/net.rb:35 in request_with_newrelic_trace\n/gems/elastic-apm-2.3.1/lib/elastic_apm/spies/net_http.rb:54 in block in request\n/gems/elastic-apm-2.3.1/lib/elastic_apm.rb:276 in with_span\n/gems/elastic-apm-2.3.1/lib/elastic_apm/spies/net_http.rb:51 in request\n/usr/local/lib/ruby/2.6.0/open-uri.rb:343 in block in open_http\n/usr/local/lib/ruby/2.6.0/net/http.rb:920 in start\n/usr/local/lib/ruby/2.6.0/open-uri.rb:337 in open_http\n/usr/local/lib/ruby/2.6.0/open-uri.rb:756 in buffer_open\n/usr/local/lib/ruby/2.6.0/open-uri.rb:226 in block in open_loop\n/usr/local/lib/ruby/2.6.0/open-uri.rb:224 in catch\n/usr/local/lib/ruby/2.6.0/open-uri.rb:224 in open_loop\n/usr/local/lib/ruby/2.6.0/open-uri.rb:165 in open_uri\n/usr/local/lib/ruby/2.6.0/open-uri.rb:736 in open\n/usr/local/lib/ruby/2.6.0/open-uri.rb:35 in open\n</code></pre>\n\n<p>I also downloaded the images with <code>wget</code> to see if the server sends a broken image, but it's hard to debug: You can't be sure if everything is ok because the server didn't return an error in this run, or if just everything is ok with the server and there is no error with it.</p>\n\n<p>So I'm not sure if the error is caused by the server, or by open-uri or by...?</p>\n\n<blockquote>\n  <p>So, to better debug this issue, I want to understand why ruby http does this <code>inflate</code> stuff and if I can get around it, OR if anyone has experienced something similar before.</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1554736131, "post_id": 55576501, "comment_id": 97851835, "body": "Seems like your form is missing a <code>form</code> tag?"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1554736423, "post_id": 55576501, "comment_id": 97851985, "body": "I can&#39;t see the <code>&lt;%= form_for ... %&gt;</code>"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554737024, "post_id": 55576501, "comment_id": 97852316, "body": "Apologies both i didn&#39;t put my form inside the backticks here it is in full now"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1554737249, "post_id": 55576501, "comment_id": 97852446, "body": "What is written to the log file when you try to make create request?"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554737393, "post_id": 55576501, "comment_id": 97852529, "body": "I have text, it says it is processing: &#39;Started POST &quot;/hairdressers&quot; for ::1 at 2019-04-08 16:29:14 +0100 <code>Processing by HairdressersController#create as HTML</code> Then there is no error but it says this: <code>(0.3ms)  BEGIN   \u21b3 app&#47;controllers&#47;hairdressers_controller.rb:18    (0.3ms)  ROLLBACK   \u21b3 app&#47;controllers&#47;hairdressers_controller.rb:18</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1554739138, "post_id": 55576501, "comment_id": 97853534, "body": "Well the ROLLBACK part means there was some error. Try temporarily changing <code>save</code> to <code>save!</code> and see what happens. Also what is <code>photo_cache</code> in relation to a hair dresser I think this is more than likely your issue"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554741500, "post_id": 55576501, "comment_id": 97854706, "body": "Hi engineersmnky ok so I changed it to <code>save!</code>  My form still did not save but now i have another error <code>Validation failed: User must exist</code>. Is this because my Hairdresser model belongs to a User ? The photo_cache param comes from the cloudinary photo uploaded I am using. When I do not add this to the permitted params in my controller it errors and says that <code>photo_cache is not permitted</code>.... Thanks in advance. I am rather lost with this one."}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554743185, "post_id": 55576501, "comment_id": 97855418, "body": "I found the reason after 4 hours :) I have posted it below. Thanks all"}], "answers": [{"tags": [], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "is_accepted": false, "score": 1, "last_activity_date": 1554743155, "creation_date": 1554743155, "answer_id": 55578396, "question_id": 55576501, "link": "https://stackoverflow.com/questions/55576501/my-submit-button-is-not-working-on-my-form-for-in-rails-no-error-message/55578396#55578396", "title": "My submit button is not working on my form_for in Rails - no error message", "body": "<p>Hi I actually found an answer to this online. Here is the answer for anyone who has lost time with this issue! :</p>\n\n<p>\"If you're on Rails 5, you'll need to update your user association to:</p>\n\n<p>belongs_to :user, optional: true\"</p>\n"}], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554743155, "creation_date": 1554736072, "last_edit_date": 1554736999, "question_id": 55576501, "link": "https://stackoverflow.com/questions/55576501/my-submit-button-is-not-working-on-my-form-for-in-rails-no-error-message", "title": "My submit button is not working on my form_for in Rails - no error message", "body": "<p>Hello I am back for my second question.</p>\n\n<p>My submit button on my form_for does not do anything when I click on it. I did have an error message in the console that said 'Unpermitted parameter: :photo_cache' however when I saw this I permitted the 'photo_cache' in the params in my controller, BUT the submit button on my form still doesn't work. </p>\n\n<p>Context: I am trying to create a hairdressers which has the following params: name, description, location, photo and address.</p>\n\n<p>Any help would be appreciated, thanks!</p>\n\n<p>My form:</p>\n\n<pre><code>&lt;%= simple_form_for(@hairdresser) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n  &lt;%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %&gt;\n  &lt;!-- [...] --&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n    &lt;%= f.input :name %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n    &lt;%= f.input :address %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n    &lt;%= f.input :location %&gt;\n  &lt;/div&gt;\n\n   &lt;div class=\"form-inputs\"&gt;\n    &lt;%= f.input :description %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n  &lt;%= f.input :photo %&gt;\n  &lt;%= f.input :photo_cache, as: :hidden %&gt;\n   &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit, label: \"Submit Form\", class: \"btn btn-primary\"  %&gt;\n  &lt;/div&gt;\n  &lt;!-- [...] --&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>class HairdressersController &lt; ApplicationController\n  def index\n    @hairdressers = Hairdresser.all\n  end\n\n  def show\n    @hairdresser = Hairdresser.find(params[:id])\n  end\n\n  def new\n    @hairdresser = Hairdresser.new\n  end\n\n  def create\n    @hairdresser = Hairdresser.new(hairdresser_params)\n    # @hairdresser.save ? (redirect_to hairdresser_path(@hairdresser)) : (render 'new')\n      if @hairdresser.save\n        redirect_to hairdresser_path(@hairdresser)\n      else\n        render 'new'\n      end\n  end\n\n  def edit\n    @hairdresser = Hairdresser.find(params[:id])\n  end\n\n  def update\n    @hairdresser =  Hairdresser.find(params[:id])\n  end\n\n  def destroy\n    @hairdresser =  Hairdresser.find(params[:id])\n  end\nend\nprivate\n\ndef hairdresser_params\n  params.require(:hairdresser).permit(:name, :address, :photo, :location, :description, :photo_cache)\nend\n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>class Hairdresser &lt; ApplicationRecord\n  belongs_to :user\n  validates :name, presence: true\n  validates :location, presence: true\n  validates :description, presence: true\n  validates :location, presence: true\n\n  mount_uploader :photo, PhotoUploader\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "erb"], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 4588188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pytwu.jpg?s=128&g=1", "display_name": "AJwr", "link": "https://stackoverflow.com/users/4588188/ajwr"}, "edited": false, "score": 0, "creation_date": 1554734878, "post_id": 55576034, "comment_id": 97851015, "body": "to be clear, this should go in the <code>snap</code> partial I am rendering? not in the main <code>index</code> file? or both"}], "tags": [], "owner": {"reputation": 308, "user_id": 2218094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnUld.jpg?s=128&g=1", "display_name": "SgtPepper", "link": "https://stackoverflow.com/users/2218094/sgtpepper"}, "is_accepted": false, "score": 0, "last_activity_date": 1554734674, "creation_date": 1554734674, "answer_id": 55576034, "question_id": 55575940, "link": "https://stackoverflow.com/questions/55575940/understanding-rails-rendering-an-error-from-controller/55576034#55576034", "title": "Understanding Rails rendering an error from controller", "body": "<p>You would need something like this on your layouts</p>\n\n<pre><code>  &lt;% flash.each do |name, msg| %&gt;\n    &lt;%= content_tag :div, msg, class: \"alert alert-info\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Then on your controller</p>\n\n<pre><code>def processing\n  if service.upload\n    flash[:notice] = \"Success\"\n  else\n    flash[:notice] = \"Error\"\n  end\nend\n</code></pre>\n\n<p>Take a look at this: <a href=\"https://stackoverflow.com/questions/22566072/rails-4-flash-notice\">rails 4 -- flash notice</a></p>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 4588188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pytwu.jpg?s=128&g=1", "display_name": "AJwr", "link": "https://stackoverflow.com/users/4588188/ajwr"}, "edited": false, "score": 0, "creation_date": 1554735638, "post_id": 55576241, "comment_id": 97851522, "body": "thank you, good call with the <code>:action</code> I definitely don&#39;t need it. I think the controller variable would be the best way to go about this, I would just have to pass it to the partial I assume?"}], "tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 2, "last_activity_date": 1554735339, "creation_date": 1554735339, "answer_id": 55576241, "question_id": 55575940, "link": "https://stackoverflow.com/questions/55575940/understanding-rails-rendering-an-error-from-controller/55576241#55576241", "title": "Understanding Rails rendering an error from controller", "body": "<ol>\n<li><code>link_to processing_path(@app.id), method: :post, action: :processing</code> Using both <code>_path</code> and <code>:action</code> parameters doesn't make sense. Use only one of them</li>\n<li>You need to decide whether your button is doing a \"traditional\" request or an AJAX request</li>\n<li>In case of a traditional request, you can use a controller variable <code>@success = ...</code>, and then check this variable inside the view: <code>&lt;% if @success %&gt;</code></li>\n<li>In case of an AJAX request, things would get a little more complicated. However, there's Rails support for \"success\" and \"failed\" AJAX responses. Take a look at <a href=\"https://guides.rubyonrails.org/working_with_javascript_in_rails.html#rails-ujs-event-handlers\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/working_with_javascript_in_rails.html#rails-ujs-event-handlers</a>. Typically, you would show/hide certain elements on the page, depending on the server response</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 11094356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36488439a836bc8c5969bdac74e8aa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragya Sriharsh", "link": "https://stackoverflow.com/users/11094356/pragya-sriharsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1554748253, "creation_date": 1554748253, "answer_id": 55579693, "question_id": 55575940, "link": "https://stackoverflow.com/questions/55575940/understanding-rails-rendering-an-error-from-controller/55579693#55579693", "title": "Understanding Rails rendering an error from controller", "body": "<p>see Doc: <a href=\"https://coderwall.com/p/jzofog/ruby-on-rails-flash-messages-with-bootstrap\" rel=\"nofollow noreferrer\">https://coderwall.com/p/jzofog/ruby-on-rails-flash-messages-with-bootstrap</a></p>\n\n<p>Step 1: Add flash code in layouts/application.html.erb file </p>\n\n<pre><code>&lt;% flash.each do |key, value| %&gt;\n    &lt;div class=\"&lt;%= flash_class(key) %&gt;\"&gt;\n        &lt;%= value %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Step 2: Just need to quickly extend application_helper.rb with the following</p>\n\n<pre><code>def flash_class(level)\n    case level\n        when :notice then \"alert alert-info\"  \n        when :success then \"alert alert-success\"\n        when :error then \"alert alert-error\"\n        when :alert then \"alert alert-error\"\n     end\nend\n\n# sometimes it will not work then wrap it with single quotes. for example:  \n  when 'notice' then \"alert alert-success\"\n</code></pre>\n\n<p>Step 3: Add below in controller.erb</p>\n\n<pre><code> def processing\n   if service.upload\n      flash[:success] = \"Processing complete!\"\n   else\n      flash[:error] = \"Something went wrong!\"\n   end\n end\n</code></pre>\n\n<p>Hope it will work :)</p>\n"}], "owner": {"reputation": 302, "user_id": 4588188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pytwu.jpg?s=128&g=1", "display_name": "AJwr", "link": "https://stackoverflow.com/users/4588188/ajwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1554748253, "creation_date": 1554734352, "question_id": 55575940, "link": "https://stackoverflow.com/questions/55575940/understanding-rails-rendering-an-error-from-controller", "title": "Understanding Rails rendering an error from controller", "body": "<p>I am still new to Rails and am having trouble understanding how to render certain sections of a page conditionally. I have a button in <code>index.html.erb</code> as well as another partial rendered:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= @facade.processing_button %&gt;\n&lt;%= render 'snap', app: @facade.app %&gt;\n</code></pre>\n\n<p>Which is defined as follows:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>link_to processing_path(@app.id),\n  method: :post, action: :processing,\n  class: 'btn btn-danger' do\n    concat([\n      image_tag('blah', class: 'check_icon'),\n      content_tag(:span, 'Processing')\n    ].join(' ').html_safe)\n  end\n</code></pre>\n\n<p>This button calls a controller method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def processing\n  if service.upload\n    # render success bar?\n  else\n    # render error bar?\n  end\nend\n</code></pre>\n\n<p>I would like to render something like the following pictures. In the snap partial, a section looks like this normally:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cj3r1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cj3r1.png\" alt=\"default\"></a></p>\n\n<p>Once the button is clicked, if the action is successful I want to render the following green success bar:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SRcbE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SRcbE.png\" alt=\"enter image description here\"></a></p>\n\n<p>It is unclear to me how to accomplish this. Should I be leveraging some form of JS/CoffeeScript? Should I add the bars to the partial as hidden by default and simply show them with JS when the action is completed?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 308, "user_id": 2218094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PnUld.jpg?s=128&g=1", "display_name": "SgtPepper", "link": "https://stackoverflow.com/users/2218094/sgtpepper"}, "edited": false, "score": 0, "creation_date": 1554734124, "post_id": 55575378, "comment_id": 97850584, "body": "Take a look at this <a href=\"https://stackoverflow.com/questions/21419342/search-for-word-in-text-file-and-display-ruby\">search-for-word-in-text-file-and-display-ruby</a> in your conditional you could have an array and save the name of the file if the word you&#39;re looking for is in it (that&#39;s what I understand you&#39;re trying to do)  I also recommend that you refactor that method, split it into different methods with one single purpose each."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554745916, "post_id": 55575378, "comment_id": 97856699, "body": "<code>file = directory+&quot;.&#47;txt&quot;</code> won&#39;t be correct. However you can use <code>Dir.glob(&quot;#{directory}&#47;*.txt&quot;).each</code> to iterate through the files. Also, use <code>Regexp.new(phrase)</code> not <code>&#47;phrase&#47;</code>, which will match the literal text &quot;phrase&quot;. Or you can just use <code>include?(phrase)</code>"}], "owner": {"reputation": 1, "user_id": 5882912, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206036701891681/picture?type=large", "display_name": "Mya Thuta", "link": "https://stackoverflow.com/users/5882912/mya-thuta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554732497, "creation_date": 1554732497, "question_id": 55575378, "link": "https://stackoverflow.com/questions/55575378/how-do-i-print-list-of-files-that-contain-certain-words-or-phrases-that-is-put-b", "title": "How do I print list of files that contain certain words or phrases that is put by the user?", "body": "<p>I need to get two inputs from user \n\"Phrases or words\" and \"Directory\"\nand then I need to  read every single \".txt\" files from that directory and look for the files with these phrases.\nThen print the list of documents that contain the \"phrases\". \nI'm having trouble understanding the logic flowchart and the coding.</p>\n\n<p>I tried it on @AptanaStudio Ruby. This is far as I can go for now.</p>\n\n<pre><code> def ListDocument\n        puts \"Enter a phrase or a term\"\n        phrase = STDIN.gets.chomp!\n        puts \"Enter a directory\"\n        directory = STDIN.gets.chomp!\n        file = directory+\"./txt\"\n        if !File.exist?(file)\n          puts \"File don't exist\"\n        else\n          File.open(file,'r')\n          inputs = File.read(file)\n          if inputs=~/phrase/\n        end\n        end\n</code></pre>\n\n<p>I expect list of document outputs.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "naming-conventions"], "comments": [{"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 2, "creation_date": 1554722125, "post_id": 55571988, "comment_id": 97842943, "body": "Ruby convention on this is to postfix the method with a question mark: <code>has_customs?</code>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1554727771, "post_id": 55572947, "comment_id": 97846372, "body": "I&#39;d never use <code>is_</code> or <code>does_</code> but I&#39;d usually keep <code>has_</code>. Think of <code>earth.has_moon?</code> vs. <code>phobos.moon?</code>. The former checks whether Earth <i>has</i> a moon whereas the latter checks if Phobos <i>is</i> a moon. Removing all prefixes can result in ambiguous predicate methods."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1554742748, "post_id": 55572947, "comment_id": 97855223, "body": "@Stefan as a general rule of thumb maybe, but think of how <code>animal.a?(Cat)</code> would sound vs <code>animal.is_a?(Cat)</code> or <code>worker.does_work?</code> vs. <code>worker.works?</code> the latter makes it sound like the <code>worker</code> could be broken (&quot;not work&quot;) however the former makes it clear we are checking whether or not the <code>worker</code> actually performs work. There are use cases for all of theses prefixes if they lend to readability and understanding."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1554749907, "post_id": 55572947, "comment_id": 97858611, "body": "@engineersmnky okay, there might be exceptions. But <code>is_a?</code> is a special case to me. And <code>worker.does_work?</code> seems a bit contrived. An actual method would probably be called <code>worker.performing?</code>, <code>worker.active?</code> or <code>worker.busy?</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1554752242, "post_id": 55572947, "comment_id": 97859642, "body": "@Stefan I will agree with &quot;a bit contrived&quot; (although your counter suggestions imply that it is currently doing work, rather than whether or not it ever does work) my point was more to the fact that a) style guides are just <i>guides</i>; b) prefixing a boolean method can lend to making it more readable which is a cornerstone of ruby code. So I certainly would not turn my nose up at something like <code>ruby.is_awesome?</code>  and would honestly probably prefer it over <code>ruby.awesome?</code>"}, {"owner": {"reputation": 5004, "user_id": 18642, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/ac35f0b2f290c9e5bfdcdd79f7126d9b?s=128&d=identicon&r=PG", "display_name": "VP.", "link": "https://stackoverflow.com/users/18642/vp"}, "edited": false, "score": 1, "creation_date": 1584439008, "post_id": 55572947, "comment_id": 107430104, "body": "The advantage of use <code>has_</code> predicate is to be able to use rspec predicate matchers. In this context, <code>expect(obj).to have_foo</code> is much better than <code>expect(obj).to be_foo</code>"}, {"owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1597454510, "post_id": 55572947, "comment_id": 112146767, "body": "@engineersmnky I would prefer <code>ruby.awesome?</code>  over <code>ruby.is_awesome?</code>. I feel like <code>is_</code> is implied by the question mark. Also rspec syntax also sounds great without <code>is_</code> <code>expect(ruby).to be_awesome</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "edited": false, "score": 0, "creation_date": 1597456678, "post_id": 55572947, "comment_id": 112147042, "body": "@rubyprince what do you mean &quot;rspec syntax sounds great without is&quot;. &quot;Is&quot; is a be verb rspec uses <code>be_</code> instead to assist in readability instead your proposal would be more like <code>expect(ruby).to awesome</code>"}, {"owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1598065713, "post_id": 55572947, "comment_id": 112344370, "body": "@engineersmnky hmm, yeah, RSpec was a bad example as it is tailored to the ruby idioms, but I still prefer <code>ruby.awesome?</code> over <code>ruby.is_awesome?</code>. Maybe it is more due to my familiarity to Ruby idioms."}], "tags": [], "owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "is_accepted": false, "score": 4, "last_activity_date": 1554724620, "creation_date": 1554724620, "answer_id": 55572947, "question_id": 55571988, "link": "https://stackoverflow.com/questions/55571988/boolean-convention-with-has-prefix-in-ruby/55572947#55572947", "title": "Boolean convention with &quot;has&quot; prefix in Ruby", "body": "<p>I would advise you to follow the RuboCop guide style : <a href=\"https://github.com/rubocop-hq/rubocop\" rel=\"nofollow noreferrer\">https://github.com/rubocop-hq/rubocop</a></p>\n\n<p>For boolean naming convention, it is advised to remove all prefixes (e.g. <code>has_</code> \n<code>is_</code>...) but to end it with a question mark <code>?</code>. So in your case it would be <code>customs?</code></p>\n\n<p>Here are the related docs : \n<a href=\"https://docs.rubocop.org/en/latest/cops_naming/#namingpredicatename\" rel=\"nofollow noreferrer\">https://docs.rubocop.org/en/latest/cops_naming/#namingpredicatename</a>\n<a href=\"https://github.com/rubocop-hq/ruby-style-guide#bool-methods-qmark\" rel=\"nofollow noreferrer\">https://github.com/rubocop-hq/ruby-style-guide#bool-methods-qmark</a></p>\n"}, {"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 2, "last_activity_date": 1554725593, "creation_date": 1554725593, "answer_id": 55573228, "question_id": 55571988, "link": "https://stackoverflow.com/questions/55571988/boolean-convention-with-has-prefix-in-ruby/55573228#55573228", "title": "Boolean convention with &quot;has&quot; prefix in Ruby", "body": "<p><code>has_foo?</code> is fine. For example, the <code>Hash</code> class has an instance_method <code>has_key?</code>. You should always append a question mark at the method name if that method returns <code>true</code> or <code>false</code>.</p>\n"}], "owner": {"reputation": 889, "user_id": 2581267, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mfYO4.png?s=128&g=1", "display_name": "Benjamin J. Benoudis", "link": "https://stackoverflow.com/users/2581267/benjamin-j-benoudis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554725593, "creation_date": 1554721438, "question_id": 55571988, "link": "https://stackoverflow.com/questions/55571988/boolean-convention-with-has-prefix-in-ruby", "title": "Boolean convention with &quot;has&quot; prefix in Ruby", "body": "<p>I have a class called Order.\nA order can have or not, customs to be paid (for a worlwide transport for instance).\nI think fo a boolean called has_customs.\nIs it a good practice to name boolean with \"has\" prefix in Ruby/Rails?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "webpacker"], "comments": [{"owner": {"reputation": 822, "user_id": 3738936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/762a46533d8d4488a9c6ad749d6a0691?s=128&d=identicon&r=PG&f=1", "display_name": "user3738936", "link": "https://stackoverflow.com/users/3738936/user3738936"}, "edited": false, "score": 0, "creation_date": 1554731393, "post_id": 55571233, "comment_id": 97848811, "body": "how are you running webpacker ? what is in your webpacker config ? is your project public ?"}, {"owner": {"reputation": 181, "user_id": 5724906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ba2cda68a7916b7c97d60b52c1110ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/5724906/tomasz"}, "reply_to_user": {"reputation": 822, "user_id": 3738936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/762a46533d8d4488a9c6ad749d6a0691?s=128&d=identicon&r=PG&f=1", "display_name": "user3738936", "link": "https://stackoverflow.com/users/3738936/user3738936"}, "edited": false, "score": 0, "creation_date": 1554737972, "post_id": 55571233, "comment_id": 97852887, "body": "I use default webpacker config from <code>rails new projectname --webpack=react</code>. I add webpacker.yml to my post"}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 274087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c08ff149e0e495f26f5d1cb7070cb4?s=128&d=identicon&r=PG", "display_name": "Muhammad Nasir Shamshad", "link": "https://stackoverflow.com/users/274087/muhammad-nasir-shamshad"}, "edited": false, "score": 0, "creation_date": 1595358612, "post_id": 57175231, "comment_id": 111445694, "body": "Hi thanks for your answer, if you can explain how I can use images in VIEWS after doing so?"}], "tags": [], "owner": {"reputation": 2054, "user_id": 4156997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7fa7cb5bd276eee498ec9c458d0dc1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sritam", "link": "https://stackoverflow.com/users/4156997/sritam"}, "is_accepted": false, "score": 6, "last_activity_date": 1575602222, "last_edit_date": 1575602222, "creation_date": 1563942200, "answer_id": 57175231, "question_id": 55571233, "link": "https://stackoverflow.com/questions/55571233/ruby-on-rails-webpacker-cant-find-images-under-asset-pack-path/57175231#57175231", "title": "Ruby on rails webpacker can&#39;t find images under asset_pack_path", "body": "<p>My images are located in <code>/app/assets/images</code>.</p>\n\n<p>Firstly add  <code>app/assets</code> to <code>resolved_paths: ['app/assets']</code> in <code>webpacker.yml</code></p>\n\n<p>And then you can use the image in your JS like so:</p>\n\n<p><code>&lt;img src='~images/logo.png' /&gt;</code></p>\n\n<p>in CSS:</p>\n\n<pre><code>&lt;style lang='sass'&gt;\n#app\n  background: url('~images/logo.png')\n&lt;/style&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 358, "user_id": 4691741, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh4.googleusercontent.com/-FwZnZ4lk0wc/AAAAAAAAAAI/AAAAAAAABLU/OpACk4POs6U/photo.jpg?sz=128", "display_name": "niborg", "link": "https://stackoverflow.com/users/4691741/niborg"}, "edited": false, "score": 0, "creation_date": 1582220098, "post_id": 59093222, "comment_id": 106711325, "body": "Your first solution worked for me, but it actually did change the path of my assets to &quot;media/images/your-file.png&quot;."}], "tags": [], "owner": {"reputation": 10805, "user_id": 262956, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7515cb5c8df2d07f6d3780346ec0da92?s=128&d=identicon&r=PG", "display_name": "vise", "link": "https://stackoverflow.com/users/262956/vise"}, "is_accepted": false, "score": 1, "last_activity_date": 1574959138, "creation_date": 1574959138, "answer_id": 59093222, "question_id": 55571233, "link": "https://stackoverflow.com/questions/55571233/ruby-on-rails-webpacker-cant-find-images-under-asset-pack-path/59093222#59093222", "title": "Ruby on rails webpacker can&#39;t find images under asset_pack_path", "body": "<p>It looks like the path is not in the manifest file.</p>\n\n<p>In Rails 6 there are two commented lines in application.js. Regardless of what rails version you're running just make sure you add them in:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const images = require.context('../images', true)\nconst imagePath = (name) =&gt; images(name, true)\n</code></pre>\n\n<p>Alternatively, you can force the images to be added to the manifest by moving your folder inside <code>packs</code>, eg. <code>packs/images</code>. The path would change though to <code>media/images/your-file.png</code>.</p>\n\n<p>For seeing if the path exists or not, I found it easier to just lookup it up from ruby directly:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Webpacker.manifest.send(:data).keys.grep /logo/\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 12921091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1be6bf270f8e17927c2846d7c09e931?s=128&d=identicon&r=PG&f=1", "display_name": "tblev", "link": "https://stackoverflow.com/users/12921091/tblev"}, "edited": false, "score": 0, "creation_date": 1587741821, "post_id": 60816733, "comment_id": 108637576, "body": "For future viewers if your project is commercial you should look to store images on a hosting site like s3."}], "tags": [], "owner": {"reputation": 125, "user_id": 12921091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1be6bf270f8e17927c2846d7c09e931?s=128&d=identicon&r=PG&f=1", "display_name": "tblev", "link": "https://stackoverflow.com/users/12921091/tblev"}, "is_accepted": false, "score": 2, "last_activity_date": 1586099068, "last_edit_date": 1586099068, "creation_date": 1584977884, "answer_id": 60816733, "question_id": 55571233, "link": "https://stackoverflow.com/questions/55571233/ruby-on-rails-webpacker-cant-find-images-under-asset-pack-path/60816733#60816733", "title": "Ruby on rails webpacker can&#39;t find images under asset_pack_path", "body": "<p>I had an issue with getting images to show up in Rails 6.  I did this:</p>\n\n<p>Add image to </p>\n\n<pre><code>assets/custom_folder/img_filename.file_extension\n</code></pre>\n\n<p>Uncomment two lines in javascript/packs/application.js</p>\n\n<pre><code>const images = require.context('../images', true)\nconst imagePath = (name) =&gt; images(name, true)\n</code></pre>\n\n<p>Then add your image to your erb file using this: (I had an index.html.erb view file)</p>\n\n<pre><code>&lt;%= image_tag(\"custom_folder/file_name.file_extension\")%&gt;\n</code></pre>\n\n<p>This worked for me, hope it helped.</p>\n\n<p>Check out <a href=\"https://www.youtube.com/watch?time_continue=28&amp;v=a3qmGdiLNAc&amp;feature=emb_title\" rel=\"nofollow noreferrer\">this link</a></p>\n"}, {"tags": [], "owner": {"reputation": 435, "user_id": 274087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c08ff149e0e495f26f5d1cb7070cb4?s=128&d=identicon&r=PG", "display_name": "Muhammad Nasir Shamshad", "link": "https://stackoverflow.com/users/274087/muhammad-nasir-shamshad"}, "is_accepted": false, "score": 1, "last_activity_date": 1595360317, "creation_date": 1595360317, "answer_id": 63021908, "question_id": 55571233, "link": "https://stackoverflow.com/questions/55571233/ruby-on-rails-webpacker-cant-find-images-under-asset-pack-path/63021908#63021908", "title": "Ruby on rails webpacker can&#39;t find images under asset_pack_path", "body": "<ol>\n<li><p>Place your images in\n<code>app/javascripts/images</code></p>\n</li>\n<li><p>Put following code in <strong><code>application.js</code></strong> At TOP of the file.</p>\n<p><code>// top of packs/application.js</code></p>\n<p><code>const importAll = (r) =&gt; r.keys().map(r)</code></p>\n<p><code>importAll(require.context('../images', false, /\\.(png|jpe?g|svg)$/));</code></p>\n</li>\n<li><p>This will load all images from images folder and then it should be available in manifest for you to pick up using\n<code>asset_pack_path</code></p>\n</li>\n<li><p>In your <code>erb</code> files, use like <code>&lt;%= asset_pack_path 'media/images/image_name.png' %&gt;</code></p>\n</li>\n</ol>\n<p>-- Read this for more details <a href=\"https://github.com/rails/webpacker/issues/1839\" rel=\"nofollow noreferrer\">https://github.com/rails/webpacker/issues/1839</a></p>\n"}, {"tags": [], "owner": {"reputation": 693, "user_id": 3748376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ss4Eo.jpg?s=128&g=1", "display_name": "fydelio", "link": "https://stackoverflow.com/users/3748376/fydelio"}, "is_accepted": false, "score": 0, "last_activity_date": 1608651294, "creation_date": 1608651294, "answer_id": 65411500, "question_id": 55571233, "link": "https://stackoverflow.com/questions/55571233/ruby-on-rails-webpacker-cant-find-images-under-asset-pack-path/65411500#65411500", "title": "Ruby on rails webpacker can&#39;t find images under asset_pack_path", "body": "<p>For accessing images handled by Sprockets, add this to your  your_file_name.js.erb file:</p>\n<pre><code>&lt;% helpers = ActionController::Base.helpers %&gt;\nconst railsImagePath = &quot;&lt;%= helpers.image_path('your_image.png') %&gt;&quot;\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5724906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ba2cda68a7916b7c97d60b52c1110ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/5724906/tomasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5678, "favorite_count": 5, "answer_count": 5, "score": 5, "last_activity_date": 1608651294, "creation_date": 1554718990, "last_edit_date": 1554738006, "question_id": 55571233, "link": "https://stackoverflow.com/questions/55571233/ruby-on-rails-webpacker-cant-find-images-under-asset-pack-path", "title": "Ruby on rails webpacker can&#39;t find images under asset_pack_path", "body": "<p>I have a problem with including images in my views using Ruby on Rails Webpacker. When i try to insert image in my view using html img tag and asset_pack_path i got an error. My images is located in <code>app/javascript/images/logo.png</code>. According to webpacker docs i should append /media/ to file but it does not help. I try diffrent path but it's still not working. I think webpacker doesn't compile my image.</p>\n\n<pre><code>Webpacker::Manifest::MissingEntryError in Home#index\nShowing app/views/layouts/application.html.haml where line #14 raised:\n\nWebpacker can't find media/logo.png in public/packs/manifest.json. Possible causes:\n1. You want to set webpacker.yml value of compile to true for your environment\n   unless you are using the `webpack -w` or the webpack-dev-server.\n2. webpack has not yet re-run to reflect updates.\n3. You have misconfigured Webpacker's config/webpacker.yml file.\n4. Your webpack configuration is not creating a manifest.\nYour manifest contains:\n{\n  \"application.js\": \"/packs/js/application-321d1c3bcc175b7f61a6.js\",\n  \"application.js.map\": \"/packs/js/application-321d1c3bcc175b7f61a6.js.map\",\n  \"entrypoints\": {\n    \"application\": {\n      \"js\": [\n        \"/packs/js/application-321d1c3bcc175b7f61a6.js\"\n      ],\n      \"js.map\": [\n        \"/packs/js/application-321d1c3bcc175b7f61a6.js.map\"\n      ]\n    },\n    \"hello_react\": {\n      \"js\": [\n        \"/packs/js/hello_react-c48c89eaf873362b846b.js\"\n      ],\n      \"js.map\": [\n        \"/packs/js/hello_react-c48c89eaf873362b846b.js.map\"\n      ]\n    }\n  },\n  \"hello_react.js\": \"/packs/js/hello_react-c48c89eaf873362b846b.js\",\n  \"hello_react.js.map\": \"/packs/js/hello_react-c48c89eaf873362b846b.js.map\"\n}\n</code></pre>\n\n<p>In my view <code>application.html.haml</code></p>\n\n<pre><code>!!! 5\n%html\n  %head\n   = javascript_pack_tag 'application', 'data-turbolinks-track': 'reload'\n    = stylesheet_pack_tag    'application'\n  %body\n    %nav.navbar.navbar-expand-lg.navbar-light.bg-primary\n      %a.navbar-brand(href=\"/\")\n        %img(src=\"#{asset_pack_path 'media/logo.png'}\")\n</code></pre>\n\n<p><code>app/javascript/packs/application.js</code></p>\n\n<pre><code>require.context('../images', true)\n\nimport 'bootstrap'\nimport './src/application.scss' \n</code></pre>\n\n<p><code>Procfile.dev</code></p>\n\n<pre><code>web: bundle exec rails s\nwebpacker: ./bin/webpack-dev-server\n</code></pre>\n\n<p><code>webpacker.yml</code></p>\n\n<pre><code># Note: You must restart bin/webpack-dev-server for changes to take effect\n\ndefault: &amp;default\n  source_path: app/javascript\n  source_entry_path: packs\n  public_root_path: public\n  public_output_path: packs\n  cache_path: tmp/cache/webpacker\n  check_yarn_integrity: false\n  webpack_compile_output: false\n\n  # Additional paths webpack should lookup modules\n  # ['app/assets', 'engine/foo/app/assets']\n  resolved_paths: []\n\n  # Reload manifest.json on all requests so we reload latest compiled packs\n  cache_manifest: false\n\n  # Extract and emit a css file\n  extract_css: false\n\n  static_assets_extensions:\n    - .jpg\n    - .jpeg\n    - .png\n    - .gif\n    - .tiff\n    - .ico\n    - .svg\n    - .eot\n    - .otf\n    - .ttf\n    - .woff\n    - .woff2\n\n  extensions:\n    - .jsx\n    - .mjs\n    - .js\n    - .sass\n    - .scss\n    - .css\n    - .module.sass\n    - .module.scss\n    - .module.css\n    - .png\n    - .svg\n    - .gif\n    - .jpeg\n    - .jpg\n\ndevelopment:\n  &lt;&lt;: *default\n  compile: true\n\n  # Verifies that versions and hashed value of the package contents in the project's package.json\n  check_yarn_integrity: true\n\n  # Reference: https://webpack.js.org/configuration/dev-server/\n  dev_server:\n    https: false\n    host: localhost\n    port: 3035\n    public: localhost:3035\n    hmr: false\n    # Inline should be set to true if using HMR\n    inline: true\n    overlay: true\n    compress: true\n    disable_host_check: true\n    use_local_ip: false\n    quiet: false\n    headers:\n      'Access-Control-Allow-Origin': '*'\n    watch_options:\n      ignored: '**/node_modules/**'\n\n\ntest:\n  &lt;&lt;: *default\n  compile: true\n\n  # Compile test packs to a separate directory\n  public_output_path: packs-test\n\nproduction:\n  &lt;&lt;: *default\n\n  # Production depends on precompilation of packs prior to booting for performance.\n  compile: false\n\n  # Extract and emit a css file\n  extract_css: true\n\n  # Cache manifest.json for performance\n  cache_manifest: true\n</code></pre>\n"}, {"tags": ["c", "arrays", "ruby", "memory", "ffi"], "comments": [{"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1554987880, "post_id": 55571127, "comment_id": 97957478, "body": "What is your goal here? Performance, reduced memory use, interaction with other native code?"}], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1555319893, "post_id": 55633418, "comment_id": 98055508, "body": "So I have initialized an array of 16 bytes and my pointer doesn\u2019t know the type of pointer I have initialized so when I am trying to access a particular value through index, I am actually accessing a specific byte. Then because I specify the type of value I want to read (read(:int)), the pointer understands that I want to read the all 4 bytes starting from there and compute an integer.  From your explanations, I understand that to make my program work, I should multiply all my indexing by a factor of 4. <a href=\"https://github.com/davidgeismar/ruby-tuto-web/blob/master/dynamic_array.rb\" rel=\"nofollow noreferrer\">Github repo</a>"}, {"owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1555319921, "post_id": 55633418, "comment_id": 98055526, "body": "However I still get pretty unexpected behaviour\u2026example : <code>arr = StaticArray.new(4) arr.print 0 -268435456 -1600786800 2047</code> what a am I doing wrong here ?"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1555320867, "post_id": 55633418, "comment_id": 98055991, "body": "<code>malloc</code> doesn&#39;t guarantee the memory is zero filled and may have something left over from previous use of the memory. Looks like it might be that."}, {"owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1555341869, "post_id": 55633418, "comment_id": 98067700, "body": "So I dont get what malloc is for... if when you use malloc(n) 1) you re not guaranteed that you have n of free space and 2) you dont actually raise an error if you try to writte to an offset that is further than what you affected with malloc (C don\u2019t provide any specification which deal with problem of accessing invalid index). Then what is the advantage of using malloc compare to initializing a random pointer...."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1555342389, "post_id": 55633418, "comment_id": 98068027, "body": "1) If <code>malloc(n)</code> returns a non-null pointer, it is guaranteed (mostly, see for example the Linux OOM killer), that you have n bytes. But it doesn&#39;t promise to set those bytes to any particular value (e.g. 0) for performance reasons (one of the common reasons to be using C). You could use say <code>memset</code> if you want to zero it. For security reasons, these days fresh (unused yet by the specific process ) from the OS is zeroed (so you can&#39;t see if it has a password from say Chrome laying around in it), but after a process creates/destroys a few things malloc will reuse memory filled with stuff."}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": true, "score": 5, "last_activity_date": 1554988876, "last_edit_date": 1554988876, "creation_date": 1554988576, "answer_id": 55633418, "question_id": 55571127, "link": "https://stackoverflow.com/questions/55571127/creating-a-static-array-class-in-ruby-with-ruby-ffi/55633418#55633418", "title": "Creating a static array class in ruby with ruby FFI", "body": "<p>The FFI interface doesn't know about the type of your pointer, so it is just treating it as a byte array (see initialize on the pointer type). Note that while you do pass <code>:int</code>, this is to the specific <code>write</code> and <code>read</code>, not where you are doing the indexing. Thus you are writing and printing at byte offsets 0,1,2,3 rather than the integer elements at 0,4,8,12.</p>\n\n<p>On a little endian system, with a 32bit, 4 byte int, the binary value of 20 is <code>14 00 00 00</code> and 16 is <code>10 00 00 00</code>.</p>\n\n<p>So you allocate 4*4 bytes, so 32 bytes, the first 8 being.</p>\n\n<pre><code>00 00 00 00 00 00 00 00\n</code></pre>\n\n<p>And write 20 at offset 0</p>\n\n<pre><code>14 00 00 00 00 00 00 00\n</code></pre>\n\n<p>And then write 16 at offset 1</p>\n\n<pre><code>14 10 00 00 00 00 00 00\n</code></pre>\n\n<p><code>14 10 00 00</code> is <code>0x00001014</code> or 4116, and then at the next offset you print it is <code>10 00 00 00</code> which is 16.</p>\n"}], "owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 55633418, "answer_count": 1, "score": 2, "last_activity_date": 1554988876, "creation_date": 1554718662, "last_edit_date": 1554792616, "question_id": 55571127, "link": "https://stackoverflow.com/questions/55571127/creating-a-static-array-class-in-ruby-with-ruby-ffi", "title": "Creating a static array class in ruby with ruby FFI", "body": "<p>I want to implement my own static array class in ruby. It will be an array with a fixed capacity and all elements in the array will be of a single type.\nIn order to have direct access to memory, I am using the FFI gem <a href=\"https://github.com/ffi/ffi\" rel=\"nofollow noreferrer\">https://github.com/ffi/ffi</a> which enables to create your own C functions and use them in your ruby program. \nI created a very simple C function that allocates memory for an array of integer and returns a pointer to the memory space :</p>\n\n<pre><code>int * create_static_array(int size) {\n  int *arr = malloc(size * sizeof(int));\n  return arr;\n}\n</code></pre>\n\n<p>This is my ruby static_array class that uses create_static_array :</p>\n\n<pre><code>require 'ffi'\nclass StaticArray\n  attr_accessor :pointer, :capacity, :next_index\n  extend FFI::Library\n\n  ffi_lib './create_array/create_array.so'\n  attach_function :create_static_array, [:int], :pointer\n\n  def initialize(capacity)\n    @capacity = capacity\n    @pointer = create_static_array(capacity)\n    @next_index = 0\n  end\n # adds value to the next_index in array\n  def push(val)\n    @pointer[@next_index].write(:int, val)\n    @next_index += 1\n  end\n # reads value at index\n  def [](index)\n    raise IndexOutOfBoundException if index &gt;= @capacity\n    self.pointer[index].read(:int)\n  end\n # print every value in index\n  def print\n    i = 0\n    while (i &lt;   @capacity)\n      puts @pointer[i].read(:int)\n      i += 1\n    end\n  end\nend\n</code></pre>\n\n<p>I added a couple methods to interact with my array, push elements, read elements at index...\nHowever my static_array instances are not exactly working as expected...</p>\n\n<p>Let's say I write :</p>\n\n<pre><code>// creates a static array in memory which can store 4 ints\narr = StaticArray.new(4)\n</code></pre>\n\n<p>now let's push an int in our arr :</p>\n\n<pre><code>arr.push(20)\n</code></pre>\n\n<p><code>arr.print</code> will output </p>\n\n<pre><code>20\n0\n0\n0\n</code></pre>\n\n<p>which makes sense. Now let's push another int into arr :</p>\n\n<pre><code>arr.push(16)\n</code></pre>\n\n<p>and <code>arr.print</code> again :</p>\n\n<pre><code>4116\n16\n0\n0\n</code></pre>\n\n<p>20 has been replaced by 4116 ... I cant really get what is going on here ?</p>\n\n<p><a href=\"https://www.rubydoc.info/github/ffi/ffi/FFI/Pointer\" rel=\"nofollow noreferrer\">Here's the link to the FFIPointer class doc if that helps \nhttps://www.rubydoc.info/github/ffi/ffi/FFI/Pointer</a></p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "selenium-webdriver"], "comments": [{"owner": {"reputation": 1453, "user_id": 3711562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pAcnq.jpg?s=128&g=1", "display_name": "Anantha Raju C", "link": "https://stackoverflow.com/users/3711562/anantha-raju-c"}, "edited": false, "score": 0, "creation_date": 1554718622, "post_id": 55571059, "comment_id": 97840971, "body": "add additional details to your program"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 10911678, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oC_2GjpaXTY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbGLpAdzzOO3b5S8rGPpkw4Zj6VXQ/mo/photo.jpg?sz=128", "display_name": "Nicola Landro", "link": "https://stackoverflow.com/users/10911678/nicola-landro"}, "is_accepted": true, "score": 0, "last_activity_date": 1554718739, "creation_date": 1554718739, "answer_id": 55571144, "question_id": 55571059, "link": "https://stackoverflow.com/questions/55571059/problem-with-selenium-webdriver-on-linux-with-ruby/55571144#55571144", "title": "Problem with selenium webdriver on linux with ruby", "body": "<p>You have two choice to solve this problem:</p>\n\n<ol>\n<li>You can uninstall chrome-stable and install latest version of <a href=\"https://www.google.com/chrome/beta/\" rel=\"nofollow noreferrer\">chrome beta</a> (this only because the chrome 74 for linux is not released yet)</li>\n<li>You can downgrade your chromedriver version</li>\n</ol>\n\n<pre><code>bundle exec chromedriver-update 73.0.3683.68\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11328416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b298baaf4152d14e12c0ee9ed19c4a28?s=128&d=identicon&r=PG&f=1", "display_name": "teamrocket", "link": "https://stackoverflow.com/users/11328416/teamrocket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 55571144, "answer_count": 1, "score": 0, "last_activity_date": 1554718739, "creation_date": 1554718456, "question_id": 55571059, "link": "https://stackoverflow.com/questions/55571059/problem-with-selenium-webdriver-on-linux-with-ruby", "title": "Problem with selenium webdriver on linux with ruby", "body": "<p>I reinstalled ruby 2.3.1p112, and my spec test do not work.\nThe error was:</p>\n\n<pre><code>Selenium::WebDriver::Error::SessionNotCreatedError: session not created: This version of ChromeDriver only supports Chrome version 74\n  (Driver info: chromedriver=74.0.3729.6 (255758eccf3d244491b8a1317aa76e1ce10d57e9-refs/branch-heads/3729@{#29}),platform=Linux 4.15.0-47-generic x86_64)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested", "cocoon-gem"], "answers": [{"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": true, "score": 4, "last_activity_date": 1554799206, "creation_date": 1554799206, "answer_id": 55588486, "question_id": 55568004, "link": "https://stackoverflow.com/questions/55568004/how-to-get-the-index-value-that-forms-cocoon/55588486#55588486", "title": "How to get the index value that forms cocoon?", "body": "<p>If you check the code, cocoon will only replace the <code>f.index</code> if it is either surrounded with <code>[]</code> or <code>_</code>, which is how it is used in a form when addressing the nested items. </p>\n\n<p>So the wiki you link to (which I did not write) just happens to work in that specific case because it the <code>f.index</code> is between the square brackets. </p>\n\n<p>It is a bit unclear what you are trying to do, but there are a few alternatives: </p>\n\n<ul>\n<li>use the cocoon callbacks to then fix your code (e.g. assign a unique id based on the order/counter) </li>\n<li>use jquery selectors which allow to just address/find the nearest/closest selector </li>\n</ul>\n"}], "owner": {"reputation": 485, "user_id": 7399323, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/64e3a4116517813a2042aed29f841ede?s=128&d=identicon&r=PG&f=1", "display_name": "evans", "link": "https://stackoverflow.com/users/7399323/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 1, "accepted_answer_id": 55588486, "answer_count": 1, "score": 1, "last_activity_date": 1554799206, "creation_date": 1554707521, "question_id": 55568004, "link": "https://stackoverflow.com/questions/55568004/how-to-get-the-index-value-that-forms-cocoon", "title": "How to get the index value that forms cocoon?", "body": "<p>Need control <strong>id</strong> (or <strong>class</strong>) which forms <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">cocoon</a>.<br>\nTo make custom links work only for the correct elements.\nTo link <strong>price is not displayed</strong> fill in only the field <strong>new_price</strong> associated with it.</p>\n\n<p>And I need to get a unique value which forms <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">cocoon</a>.</p>\n\n<p><em>_promo_service_fields.html.haml</em></p>\n\n<pre><code>.nested-fields\n  %p= f.select :service_id, {}, {}, {class: \"service_#{f.index}\"}\n  %p= f.text_field :new_price\n  %p= link_to \"price is not displayed\", '', remote: true, class: \"no-price-#{f.index}\"\n  %p= link_to_remove_association \"\u0423\u0434\u0430\u043b\u0438\u0442\u044c\", f\n\n:coffeescript\n  $(\".service_#{f.index}).ajaxChosen\n    # minLength: 3\n    dataType: 'json'\n    type: 'GET'\n    url:'/admin/promo_pages/search_service.json'\n    data: {'keyboard':'cat'}\n</code></pre>\n\n<p>At <code>f.index</code> I get the wrong value (<a href=\"https://github.com/nathanvda/cocoon/wiki/Manually-setting-the-index-of-a-new-element\" rel=\"nofollow noreferrer\">manual</a>)</p>\n\n<p>How can I get a unique value that forms <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">cocoon</a>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554706628, "post_id": 55567543, "comment_id": 97834525, "body": "seems there is a config in your project, setting lock: :all"}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "reply_to_user": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554706860, "post_id": 55567543, "comment_id": 97834627, "body": "@PanKe Thanks for the quick reply, which configuration are you talking about?"}, {"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554707187, "post_id": 55567543, "comment_id": 97834792, "body": "is <code>lock: :until_executing</code> the only lock configure in your project? any other sidekiq_options?"}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "reply_to_user": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554707363, "post_id": 55567543, "comment_id": 97834872, "body": "@PanKe This is only one lock configuration on my project."}, {"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554707589, "post_id": 55567543, "comment_id": 97834991, "body": "hmmm, from code base, there is a <code>:all</code> <code>lock_type</code> in your project. <a href=\"https://github.com/mhenrixon/sidekiq-unique-jobs/blob/63974568db7e29ad4a3328e48af3243983fccf4a/lib/sidekiq_unique_jobs/options_with_fallback.rb#L53\" rel=\"nofollow noreferrer\">github.com/mhenrixon/sidekiq-unique-jobs/blob/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": true, "score": 1, "last_activity_date": 1554712109, "last_edit_date": 1554712109, "creation_date": 1554711691, "answer_id": 55569030, "question_id": 55567543, "link": "https://stackoverflow.com/questions/55567543/sidekiquniquejobsunknownlock-no-implementation-for-lock-all/55569030#55569030", "title": "SidekiqUniqueJobs::UnknownLock: No implementation for `lock: :all`", "body": "<p>There are other <code>sidekiq_options</code> in your project which set the <code>lock: :all</code>. try to grep in your project files and remove it. </p>\n"}], "owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 55569030, "answer_count": 1, "score": 0, "last_activity_date": 1554712109, "creation_date": 1554705606, "question_id": 55567543, "link": "https://stackoverflow.com/questions/55567543/sidekiquniquejobsunknownlock-no-implementation-for-lock-all", "title": "SidekiqUniqueJobs::UnknownLock: No implementation for `lock: :all`", "body": "<p>I have implemented sidekiq, In which a number of jobs been executed So I wanted to add uniqueness on <code>default queue</code>, to add uniqueness on jobs I have used <a href=\"https://github.com/mhenrixon/sidekiq-unique-jobs\" rel=\"nofollow noreferrer\">sidekiq-unique-jobs</a> gem.</p>\n\n<p>I have followed the below steps:</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>gem 'sidekiq-unique-jobs'\n</code></pre>\n\n<p>And then execute:</p>\n\n<pre><code>bundle install \n</code></pre>\n\n<p><strong>Worker.rb</strong></p>\n\n<pre><code>Class Worker\n  include Sidekiq::Worker\n\n  sidekiq_options retry: 2, unique_across_queues: true, queue: 'default',lock: :until_executing\n\n  def perform(args); \n   ....\n   ....\n  end\nend\n</code></pre>\n\n<p>After adding the above configuration on my worker I am getting below error:</p>\n\n<blockquote>\n  <p>SidekiqUniqueJobs::UnknownLock: No implementation for <code>lock: :all</code></p>\n</blockquote>\n\n<p>Any suggestion will be appreciated!</p>\n"}, {"tags": ["ruby", "tk"], "comments": [{"owner": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "edited": false, "score": 0, "creation_date": 1556188051, "post_id": 55567159, "comment_id": 98356297, "body": "The short answer is that at least for my purposes (see my comment to MarkDBlackwell&#39;s answer): Tk.focus will return the address of the of the TK object."}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "edited": false, "score": 0, "creation_date": 1556182461, "post_id": 55815460, "comment_id": 98352998, "body": "Excellent! For my purposes (five cells arranged in a spreadsheet-like fashion), Tk.focus (without the &quot;.path&quot;) returns the address of the TK object so I can do things like: x = Tk.focus; x.delete(0, :end); x.insert(0, :x) to replace the contents of a cell with an &#39;x&#39;"}, {"owner": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "edited": false, "score": 0, "creation_date": 1556182809, "post_id": 55815460, "comment_id": 98353181, "body": "I have Mastering Perl/Tk by Lidie and Walsh, which is great."}, {"owner": {"reputation": 1626, "user_id": 1136063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8d63377824449cc8627aae609579f50?s=128&d=identicon&r=PG", "display_name": "MarkDBlackwell", "link": "https://stackoverflow.com/users/1136063/markdblackwell"}, "reply_to_user": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "edited": false, "score": 1, "creation_date": 1556205215, "post_id": 55815460, "comment_id": 98366882, "body": "@Jorgen I have edited my answer to reflect that <code>Tk.focus</code> is the equivalent you asked for."}, {"owner": {"reputation": 1626, "user_id": 1136063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8d63377824449cc8627aae609579f50?s=128&d=identicon&r=PG", "display_name": "MarkDBlackwell", "link": "https://stackoverflow.com/users/1136063/markdblackwell"}, "reply_to_user": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "edited": false, "score": 1, "creation_date": 1556209626, "post_id": 55815460, "comment_id": 98369215, "body": "@Jorgen As you may know, both books <i>Learning Perl/Tk</i> and <i>Mastering Perl/Tk</i> describe only the Perl Tk module, which eschews Tcl. Instead, Ruby&#39;s Tk wrapper is a thin wrapper over Tk&#39;s own Tcl code, as is the newer Perl Tkx module, described at <a href=\"http://metacpan.org/pod/Tkx\" rel=\"nofollow noreferrer\">meta::cpan</a> and <a href=\"http://www.perlmonks.org/?node_id=846156\" rel=\"nofollow noreferrer\">perlmonks</a>. These can utilize the improved graphical look of Tk version 8.5, per the <a href=\"https://tkdocs.com/tutorial/firstexample.html#walkthrough\" rel=\"nofollow noreferrer\">TkDocs tutorial</a> (if you select Perl)."}, {"owner": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "edited": false, "score": 0, "creation_date": 1556213474, "post_id": 55815460, "comment_id": 98370925, "body": "Thanks, yes, I come from Perl and Python. I got the above Ruby solution from your excellent link to the tcl/tk documentation plus what I learned from your above code. In Perl widget-&gt;focus() sets the focus and returns nothing. In tcl/tk focus() returns the address I was looking for. Thanks again! I would never have found the solution without your answer!"}], "tags": [], "owner": {"reputation": 1626, "user_id": 1136063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8d63377824449cc8627aae609579f50?s=128&d=identicon&r=PG", "display_name": "MarkDBlackwell", "link": "https://stackoverflow.com/users/1136063/markdblackwell"}, "is_accepted": true, "score": 1, "last_activity_date": 1556207340, "last_edit_date": 1556207340, "creation_date": 1556036254, "answer_id": 55815460, "question_id": 55567159, "link": "https://stackoverflow.com/questions/55567159/find-which-widget-has-focus-in-ruby-2-3-3/55815460#55815460", "title": "Find which widget has focus in Ruby 2.3.3", "body": "<blockquote>\n  <p>[T]o tell me which widget has the focus[...w]hat is the equivalent code in Ruby under Linux?</p>\n</blockquote>\n\n<p>Fairly equivalently, if you have three Tk objects (for example), then you can say (in Ruby):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>array = [tk_object_1, tk_object_2, tk_object_3]\npath = Tk.focus.path\nindex = array.find_index {|e| e.path == path}\nobject = array.at index\n</code></pre>\n\n<p>EDIT: Or, more simply:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>object = Tk.focus\n</code></pre>\n\n<p>Here's how to determine which object (of your many Tk objects) this is:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>array = [tk_object_1, tk_object_2, tk_object_3]\nindex = array.find_index {|e| e == object}\n</code></pre>\n\n<p>(End of edit.)</p>\n\n<p>I managed to locate documentation for the <code>focus</code> method (in both the\n<a href=\"http://ruby-doc.org/stdlib-2.2.5/libdoc/tk/rdoc/Tk.html#method-c-focus\" rel=\"nofollow noreferrer\">Ruby wrapper</a>\nand the original\n<a href=\"http://www.tcl.tk/man/tcl8.5/TkCmd/focus.htm\" rel=\"nofollow noreferrer\">Tcl</a>)\nand for the <code>path</code> method (in the\n<a href=\"http://ruby-doc.org/stdlib-2.2.5/libdoc/tk/rdoc/TkObject.html#method-i-path\" rel=\"nofollow noreferrer\">Ruby wrapper</a>).</p>\n\n<p>I wrote a program which demonstrates setting and getting the focus:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'tk'\n\ndef focus_array\n  @focus_array ||= [\n      f_content, e_content,\n      to_one,    e_one,\n      to_two,    e_two,\n      ]\nend\n\ndef focus_array_class_width_max\n  @focus_array_class_width_max ||= focus_array.map {|e| e.class.to_s.length}.max\nend\n\ndef focus_delay\n  milliseconds = 1000\n  Tk.after milliseconds, lambda_focus_rotate\n  nil\nend\n\ndef focus_force(object)\n  force = true\n  Tk.focus_to object, force\n  nil\nend\n\ndef focus_print\n  path = Tk.focus.path\n  index = focus_array.find_index {|e| e.path == path}\n  s = klass_justified index\n  puts \"Item #{index}'s class and path are:  #{s}  #{path}\"\n  nil\nend\n\ndef focus_rotate\n  @counter += 1\n  index = @counter % focus_array.length\n  puts '' if 0 == index\n  focus_force focus_array.at index\n  nil\nend\n\ndef klass_justified(index)\n  focus_array.at(index).class.to_s.ljust focus_array_class_width_max\nend\n\ndef lambda_focus_rotate\n  @lambda_focus_rotate ||= Kernel.lambda do\n    focus_rotate\n    focus_print\n    focus_delay\n  end\nend\n\ndef main\n  root.title = 'Root'\n  objects_create\n  @counter = -1 # Start before first.\n  focus_delay\n  Tk.mainloop\n  nil\nend\n\ndef objects_create\n# Keep order:\n  e_content\n  e_one\n  e_two\n  nil\nend\n\ndef spacing_set(object)\n  object.width 7\n  object.grid padx: 40\nend\n\n#-------------\n# Tk objects:\n\ndef e_content\n  @e_content ||= begin\n    e = Tk::Tile::Entry.new f_content\n    spacing_set e\n  end\nend\n\ndef e_one\n  @e_one ||= begin\n    e = Tk::Tile::Entry.new to_one\n    spacing_set e\n  end\nend\n\ndef e_two\n  @e_two ||= begin\n    e = Tk::Tile::Entry.new to_two\n    spacing_set e\n  end\nend\n\ndef f_content\n  $f_content ||= begin\n    f = Tk::Tile::Frame.new root\n    f.grid\n  end\nend\n\ndef root\n  $root ||= TkRoot.new\nend\n\ndef to_one\n  @to_one ||= TkToplevel.new f_content\nend\n\ndef to_two\n  @to_two ||= TkToplevel.new f_content\nend\n\nmain\n</code></pre>\n\n<p>It works for me using Ruby 2.2.5 (with Tk 8.5.12) on Windows 7.</p>\n\n<blockquote>\n  <p>Is there a good book or article about low-level Ruby Tk? All the articles I have seen only cover the simplistic stuff.</p>\n</blockquote>\n\n<p>To my knowledge, no one has written a thorough description of Ruby's wrapper for Tk (at least, not in English). However, we have the wrapper's\n<a href=\"http://ruby-doc.org/stdlib-2.2.5/libdoc/tk/rdoc/\" rel=\"nofollow noreferrer\">RDoc</a>\ndocumentation, and we can read books describing how to use Tk from other languages. I think the best one (for Ruby purposes) is <em>Learning Perk/Tk</em> by Nancy Walsh (1999). Here are its links at\n<a href=\"https://rads.stackoverflow.com/amzn/click/com/1565923146\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Amazon</a>,\n<a href=\"http://www.alibris.com/Learning-Perl-TK-Nancy-Walsh/book/28329527\" rel=\"nofollow noreferrer\">Alibris</a>\nand\n<a href=\"http://shop.oreilly.com/product/9781565923140.do\" rel=\"nofollow noreferrer\">O'Reilly</a> (along with its <a href=\"http://resources.oreilly.com/examples/9781565923140\" rel=\"nofollow noreferrer\">example code</a>).</p>\n\n<p>Also we can <code>grep</code> the wrapper's library source code (since it's installed on our computers).</p>\n\n<p>Doing so for the constant <code>TkToplevel</code> (for example) leads to the file <code>/Ruby/lib/ruby/2.2.0/tk/toplevel.rb</code> (or wherever that file resides on your system).</p>\n\n<p>In that file, searching (for the string <code>TkToplevel</code>) reveals that the constant seems to be defined as an alias for class <code>Tk::Toplevel</code>, which is documented\n<a href=\"http://ruby-doc.org/stdlib-2.2.5/libdoc/tk/rdoc/Tk/Toplevel.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Ultimately it takes fairly difficult effort to investigate how to do unusual things in Ruby with Tk.</p>\n\n<p>Good results regarding particular issues have been obtained by asking on the\n<a href=\"http://www.ruby-forum.com\" rel=\"nofollow noreferrer\">Ruby forum</a>.</p>\n\n<p>The\n<a href=\"http://tkdocs.com/tutorial/index.html\" rel=\"nofollow noreferrer\">TkDocs</a>\ntutorial is very helpful, along with the Tcl-language\n<a href=\"http://www.tcl.tk/man/tcl8.5/TkCmd/contents.htm\" rel=\"nofollow noreferrer\">Tk commands</a>\nreference documentation.</p>\n"}], "owner": {"reputation": 174, "user_id": 5889745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6e1d09e53789c17ad12bef08a52e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jorgen", "link": "https://stackoverflow.com/users/5889745/jorgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 55815460, "answer_count": 1, "score": 0, "last_activity_date": 1556207340, "creation_date": 1554703732, "last_edit_date": 1555935652, "question_id": 55567159, "link": "https://stackoverflow.com/questions/55567159/find-which-widget-has-focus-in-ruby-2-3-3", "title": "Find which widget has focus in Ruby 2.3.3", "body": "<p>In Python, I use:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>who = widget.focus_get()\n</code></pre>\n\n<p>and in Perl:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>$who = $widget-&gt;focusCurrent;\n</code></pre>\n\n<p>to tell me which widget has the focus. So:</p>\n\n<ol>\n<li>What is the equivalent code in Ruby under Linux?</li>\n<li>Is there a good book or article about low-level Ruby Tk? All the articles I have seen only cover the simplistic stuff.</li>\n</ol>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554690906, "post_id": 55565511, "comment_id": 97830479, "body": "Shouldn&#39;t <code>2016215</code> be <code>20161215</code>?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1554691350, "post_id": 55565511, "comment_id": 97830548, "body": "What does <code>11-15-2012, 20130720</code> represent?"}, {"owner": {"reputation": 1414, "user_id": 9869951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arthur Truong", "link": "https://stackoverflow.com/users/9869951/arthur-truong"}, "edited": false, "score": 0, "creation_date": 1554691496, "post_id": 55565511, "comment_id": 97830568, "body": "updated question"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1554696337, "post_id": 55565511, "comment_id": 97831415, "body": "There\u2019s a million questions here about formatting dates in Ruby; did none of them provide you with any insight into this question? Have you made any attempt at all to solve this on your own that you can show us with code? There\u2019s a big difference between \u201cdo my work for me\u201d and \u201cI want to do X but when I tried Y I got Z. How do I do X?\u201d"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554695978, "post_id": 55565628, "comment_id": 97831340, "body": "<code>Date.parse</code> &quot;I question whether <code>parse</code> should ever be used, considering how it may lead to some very strange results&quot;. <code>#=&gt; #&lt;Date: 2019-05-01 ((2458605j,0s,0n),+0s,2299161j)&gt;</code>. If the date may be one of several formats wouldn&#39;t it be better to use <code>strptime</code> with multiple format strings? Another: <code>Date.parse</code> &quot;Where is 007 when you really need him?&quot;  <code>#=&gt; #&lt;Date: 2019-01-07 ((2458491j,0s,0n),+0s,2299161j)&gt;</code>."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554726911, "post_id": 55565628, "comment_id": 97845847, "body": "@CarySwoveland I agree, if the set of possible formats is known. Perhaps varous strptimes with a parse fallback."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1554692005, "creation_date": 1554692005, "answer_id": 55565628, "question_id": 55565511, "link": "https://stackoverflow.com/questions/55565511/how-to-parse-different-date-strings-in-ruby/55565628#55565628", "title": "How to parse different date strings in Ruby", "body": "<p>Most can be parsed with <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/Date.html#method-c-parse\" rel=\"nofollow noreferrer\"><code>Date.parse</code></a>. But it doesn't understand all of them.</p>\n\n<pre><code>2.4.4 :013 &gt; Date.parse(\"11-15-2012\")\nArgumentError: invalid date\n    from (irb):13:in `parse'\n    from (irb):13\n    from /Users/schwern/.rvm/rubies/ruby-2.4.4/bin/irb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p>For any that it doesn't understand you can rescue from the ArgumentError and try your own parsing with <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/Date.html#method-c-strptime\" rel=\"nofollow noreferrer\">strptime</a>.</p>\n\n<pre><code>require 'date'\n\ndef parse_date(date)\n  Date.parse(date)\nrescue ArgumentError\n  Date.strptime(date, '%m-%d-%Y')\nend\n\ndates = [\"2010/03/30\", \"15/12/2016\", \"11-15-2012\", \"20130720\"]\nputs dates.map { |date| parse_date(date) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 7836368, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O2cWZN0iRPk/AAAAAAAAAAI/AAAAAAAAAuw/l-LBgIx1b6w/photo.jpg?sz=128", "display_name": "tequila", "link": "https://stackoverflow.com/users/7836368/tequila"}, "is_accepted": false, "score": 0, "last_activity_date": 1554734763, "creation_date": 1554734763, "answer_id": 55576071, "question_id": 55565511, "link": "https://stackoverflow.com/questions/55565511/how-to-parse-different-date-strings-in-ruby/55576071#55576071", "title": "How to parse different date strings in Ruby", "body": "<pre class=\"lang-rb prettyprint-override\"><code>dates = [\"2010/03/30\", \"15/12/2016\", \"11-15-2012\", \"20130720\"]\ndates = dates.map{|date| date.tr(\"/-\",\"\")} # runs through every string in the array and replaces the stuff\n</code></pre>\n"}], "owner": {"reputation": 1414, "user_id": 9869951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arthur Truong", "link": "https://stackoverflow.com/users/9869951/arthur-truong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1554734763, "creation_date": 1554690656, "last_edit_date": 1554709118, "question_id": 55565511, "link": "https://stackoverflow.com/questions/55565511/how-to-parse-different-date-strings-in-ruby", "title": "How to parse different date strings in Ruby", "body": "<p>I'm stuck on a question. How to convert the date strings:</p>\n\n<pre><code>[\"2010/03/30\", \"15/12/2016\", \"11-15-2012\", \"20130720\"]\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>[\"20100330\", \"20161215\", \"20121215\", \"20130720\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "csv", "converters"], "comments": [{"owner": {"reputation": 2328, "user_id": 3340588, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Pd3kv.jpg?s=128&g=1", "display_name": "knh190", "link": "https://stackoverflow.com/users/3340588/knh190"}, "edited": false, "score": 0, "creation_date": 1554692178, "post_id": 55565401, "comment_id": 97830677, "body": "Filter your json keys to remove certain columns. And use a sorted array to keep your output in order. What have you tried?"}, {"owner": {"reputation": 564, "user_id": 651314, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c3925ca02512cb9e6517b27861797afd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobius", "link": "https://stackoverflow.com/users/651314/kobius"}, "reply_to_user": {"reputation": 2328, "user_id": 3340588, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Pd3kv.jpg?s=128&g=1", "display_name": "knh190", "link": "https://stackoverflow.com/users/3340588/knh190"}, "edited": false, "score": 0, "creation_date": 1554695977, "post_id": 55565401, "comment_id": 97831339, "body": "@knh190 I&#39;ve been mostly working with the headings, but my filter seems to break the array every time. I&#39;ve tried using a switch statement for &quot;h&quot; to filter out the columns I don&#39;t want after the &quot;headings.map do |h|&quot; - would it work better to focus on the json keys before the headings?"}], "answers": [{"comments": [{"owner": {"reputation": 564, "user_id": 651314, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c3925ca02512cb9e6517b27861797afd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobius", "link": "https://stackoverflow.com/users/651314/kobius"}, "edited": false, "score": 0, "creation_date": 1554747691, "post_id": 55567700, "comment_id": 97857551, "body": "This is great! Works perfectly, I&#39;ve also tweaked this to now only include headers that are specified instead of removing specific headers."}], "tags": [], "owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "is_accepted": true, "score": 1, "last_activity_date": 1554706319, "creation_date": 1554706319, "answer_id": 55567700, "question_id": 55565401, "link": "https://stackoverflow.com/questions/55565401/json-to-csv-skipping-certain-columns-and-re-ordering-others-ruby/55567700#55567700", "title": "JSON to CSV, skipping certain columns and re-ordering others - Ruby", "body": "<p>Here is the code that works:</p>\n\n<pre><code>require 'csv'\nrequire 'json'\nrequire 'set'\n\ndef get_recursive_keys(hash, nested_key=nil)\n  hash.each_with_object([]) do |(k,v),keys|\n    # Col filter\n    next if [\"score\", \"original_name\"].include? k\n    k = \"#{nested_key}.#{k}\" unless nested_key.nil?\n    if v.is_a? Hash\n      keys.concat(get_recursive_keys(v, k))\n    else\n      keys &lt;&lt; k\n    end\n  end\nend\n\njson = JSON.parse(File.open(ARGV[0]).read)\nheadings = Set.new\nheadings = get_recursive_keys(json)\n\nheadings = headings.to_a\n# Header sorting\nheadings = headings.sort { |a, b| a &lt;=&gt; b }\n\n\nCSV.open(ARGV[0] + '.csv', 'w') do |csv|\n  csv &lt;&lt; headings\n  row = headings.map do |h|\n    v = (h.split('.').length &gt; 1) ? json.dig(*h.split('.')) : h\n    v.is_a?(Array) ? v.join(',') : v\n  end\n  csv &lt;&lt; row\nend\n</code></pre>\n\n<p>I tested with this small json string: {\"score\": \"12\", \"name\": \"Obi\", \"original_name\": \"Wan Kenobi\", \"something\": {\"sub_key\": \"Wuhu\"} }  </p>\n"}], "owner": {"reputation": 564, "user_id": 651314, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c3925ca02512cb9e6517b27861797afd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobius", "link": "https://stackoverflow.com/users/651314/kobius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 55567700, "answer_count": 1, "score": 0, "last_activity_date": 1554706319, "creation_date": 1554689433, "last_edit_date": 1554690558, "question_id": 55565401, "link": "https://stackoverflow.com/questions/55565401/json-to-csv-skipping-certain-columns-and-re-ordering-others-ruby", "title": "JSON to CSV, skipping certain columns and re-ordering others - Ruby", "body": "<p>I have a working script that nicely converts JSON files to CSV files, however I'm trying to edit the script to make some changes to the CSV file before saving, currently without any success.</p>\n\n<p>Here is my current conversion script:</p>\n\n<pre><code>require 'csv'\nrequire 'json'\nrequire 'set'\n\ndef get_recursive_keys(hash, nested_key=nil)\n  hash.each_with_object([]) do |(k,v),keys|\n    k = \"#{nested_key}.#{k}\" unless nested_key.nil?\n      if v.is_a? Hash\n      keys.concat(get_recursive_keys(v, k))\n    else\n      keys &lt;&lt; k\n    end\n  end\nend\n\njson = JSON.parse(File.open(ARGV[0]).read)\nheadings = Set.new\njson.each do |hash|\n  headings.merge(get_recursive_keys(hash))\nend\n\nheadings = headings.to_a\nCSV.open(ARGV[0] + '.csv', 'w') do |csv|\n  csv &lt;&lt; headings\n  json.each do |hash|\n    row = headings.map do |h|\n      v = hash.dig(*h.split('.'))\n      v.is_a?(Array) ? v.join(',') : v\n    end\n    csv &lt;&lt; row\n  end\nend\n</code></pre>\n\n<p>Which I run with this command:</p>\n\n<pre><code>for file in directory/*; do ruby json-to-csv.rb \"$file\"; done\n</code></pre>\n\n<p>How can I edit this script to:</p>\n\n<ul>\n<li>Remove columns with certain headers, such as \"score\" and \"original_name\"</li>\n<li>(Re-order the remaining columns into alphabetical order from left-to-right) - if possible?</li>\n</ul>\n\n<p>So far, everything I have tried completely breaks the script - where is the best place to start to make these changes?</p>\n"}, {"tags": ["ruby", "reverse"], "comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1554690909, "post_id": 55565178, "comment_id": 97830480, "body": "Not sure if this matters but the string sent to popen3 is missing the trailing newline."}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": true, "score": 0, "last_activity_date": 1554711567, "creation_date": 1554711567, "answer_id": 55568987, "question_id": 55565178, "link": "https://stackoverflow.com/questions/55565178/reverse-shell-how-to-make-the-server-print-multiple-messages-sent-to-the-clien/55568987#55568987", "title": "Reverse Shell - How to make the server print multiple messages sent to the client", "body": "<p>the <code>client.gets</code> keeps listening to the socket until it is closed. so it hangs there.</p>\n\n<p>you can try to open a tread to listen to the socket. The main loop listens to stdin and sends msg to the socket. like this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>   Thread.new do\n     while line = client.gets \n        puts line\n     end\n   end\n\n   loop do\n     message = gets.chomp\n     if message == \"exit\"\n       break\n     end\n     client.puts(message)\n   end\n\n   client.close\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11326622, "user_type": "registered", "profile_image": "https://graph.facebook.com/666252613813506/picture?type=large", "display_name": "Francisco Santos", "link": "https://stackoverflow.com/users/11326622/francisco-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 55568987, "answer_count": 1, "score": 1, "last_activity_date": 1554711567, "creation_date": 1554686951, "question_id": 55565178, "link": "https://stackoverflow.com/questions/55565178/reverse-shell-how-to-make-the-server-print-multiple-messages-sent-to-the-clien", "title": "Reverse Shell - How to make the server print multiple messages sent to the client", "body": "<p>My reverse shell will only print the output of \"ls\" command the first time, how can I make it print, in the server, as many times as I want to?</p>\n\n<pre><code>require 'socket'\nrequire 'open3'\n\ndef createClient(hostname, port)\n\n  s = TCPSocket.new hostname, port\n\n    while line = s.gets\n      if line == \"exit\"\n        s.close\n      end\n      stdin, stdout, stderr, wait_thr = Open3.popen3(line)\n      s.puts(\"#{stdout.read}\")\n    end\nend\n\ncreateClient(\"127.0.0.1\", 9090)\n\n\nrequire 'socket'\n\n def createServer(hostname, port)\n\n   server = TCPServer.new(hostname, port)\n   client = server.accept\n\n\n   loop do\n\n     message = gets.chomp\n     if message == \"exit\"\n       break\n     end\n     client.puts(message)\n     while line = client.gets\n       puts line\n     end\n   end\n\n   client.close\n\nend\n\ncreateServer(\"127.0.0.1\", 9090)\n</code></pre>\n\n<p>I was expecting the server to print all of the ls commands processed by the client, but it only printed the first one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 1775, "user_id": 4893580, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/621d06faeb8ed8be874951e0f6b624e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kris MP", "link": "https://stackoverflow.com/users/4893580/kris-mp"}, "edited": false, "score": 0, "creation_date": 1554760597, "post_id": 55577558, "comment_id": 97862793, "body": "I have checked in my rails console that YAML object is appeared to be using <code>Psych</code>. But somehow I still get the above result."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1554741175, "last_edit_date": 1554741175, "creation_date": 1554739795, "answer_id": 55577558, "question_id": 55565173, "link": "https://stackoverflow.com/questions/55565173/yaml-dump-inconsistent-string-encoding/55577558#55577558", "title": "YAML dump inconsistent string encoding", "body": "<p>It appears \"You\" might be using <a href=\"https://github.com/ruby/syck\" rel=\"nofollow noreferrer\"><code>syck</code></a> as a YAML processor while \"He\" is using <a href=\"https://github.com/ruby/psych\" rel=\"nofollow noreferrer\"><code>psych</code></a>. E.g. </p>\n\n<pre><code> require 'syck' \n require 'psych'\n Syck.dump(\"foo\")\n #=&gt; \"--- foo\\n\"\n Psych.dump(\"foo\")\n #=&gt; \"--- foo\\n...\\n\"\n</code></pre>\n\n<p>Both are valid YAML parser/emitters per se although <code>Psych</code> has been preferred since 1.9 and <code>Syck</code> really only exists as a gem for backwards compatibility and was completely removed from ruby standard lib as of 2.0.0</p>\n\n<p>As for why \"You\" are somehow using <code>Syck</code> instead I cannot say without far more information than was provided in this post.</p>\n"}], "owner": {"reputation": 1775, "user_id": 4893580, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/621d06faeb8ed8be874951e0f6b624e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kris MP", "link": "https://stackoverflow.com/users/4893580/kris-mp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554767146, "creation_date": 1554686827, "last_edit_date": 1554767146, "question_id": 55565173, "link": "https://stackoverflow.com/questions/55565173/yaml-dump-inconsistent-string-encoding", "title": "YAML dump inconsistent string encoding", "body": "<p>Ruby version: 2.2.5\nRails version: '~> 4.0.13'</p>\n\n<p>Why I and my friend have received different result when trying to convert a string to YAML using <code>YAML.dump</code> method?</p>\n\n<pre><code>[1] pry(main)&gt; YAML.dump(\"foo\")\n=&gt; \"--- foo\\n\"\n[2] pry(main)&gt; \"foo\".to_yaml\n=&gt; \"--- foo\\n\"\n</code></pre>\n\n<p>While he has:</p>\n\n<pre><code>[1] pry(main)&gt; YAML.dump(\"foo\")\n=&gt; \"--- foo\\n...\\n\"\n[2] pry(main)&gt; \"foo\".to_yaml\n=&gt; \"--- foo\\n...\\n\"\n</code></pre>\n\n<p>With triple dots after new line (...)</p>\n\n<p><strong>UPDATED</strong></p>\n\n<p>I have confirmed that my rails is using <code>Psych</code> as YAML parser engine, in rails console:</p>\n\n<pre><code>2.2.5 :002 &gt; YAML\n =&gt; Psych\n2.2.5 :004 &gt; Psych.dump(\"foo\")\n =&gt; \"--- foo\\n\"\n2.2.5 :005 &gt; YAML.dump(\"foo\")\n =&gt; \"--- foo\\n\"\n2.2.5 :006 &gt;\n</code></pre>\n\n<p>But still the result is somehow different. For additional informations, I don't have any <code>syck</code> gem installed and not required it in any files in my rails project.</p>\n"}, {"tags": ["ruby", "sqlite", "each", "nomethoderror"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1554681654, "post_id": 55564598, "comment_id": 97829033, "body": "Ruby 2.7? <a href=\"https://www.ruby-lang.org/en/downloads/releases/\" rel=\"nofollow noreferrer\">Are you sure about that?</a>"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1554682125, "post_id": 55564598, "comment_id": 97829108, "body": "@anothermh sorry bout that typo (must have missed it about a dozen times !!!)  corrected"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554682189, "post_id": 55564598, "comment_id": 97829119, "body": "Sqlite <b>2.8</b>? ... why? That&#39;s from 2003!"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1554682290, "post_id": 55564598, "comment_id": 97829137, "body": "And why not <code>SELECT sum(amount) FROM a_table WHERE ...</code>?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554682426, "post_id": 55564598, "comment_id": 97829164, "body": "Oh! Are there any null values for amount in the returned rows?"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554682662, "post_id": 55564598, "comment_id": 97829191, "body": "@Shawn 1. just realized sqlite v myself!  wonder how that happened...upgrading now 2. Had not come across the <code>sum</code> method in sqlite3 yet (noob).Can u provide example?  3.no null values that I am aware of,"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554683636, "post_id": 55564598, "comment_id": 97829333, "body": "@Shawn I <code>sudo apt upgrade sqlite</code> was told I am running latest v.  checked <code>sqlite -v</code> = 2.8"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554684759, "post_id": 55564598, "comment_id": 97829529, "body": "The package name is sqlite3 on Debian/Ubuntu etc. And libsqlite3-dev if you&#39;re compiling the Ruby sqlite gem manually."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1554684977, "post_id": 55564598, "comment_id": 97829561, "body": "That&#39;s really really weird. The only way that error can happen is if <code>sum</code> is <code>nil</code>, regardless of what <code>g</code> is. Is this a real representation of your code, or is there more to it? Specifically, any way that <code>sum</code> would be <code>nil</code>, somewhere between <code>sum = 0</code> and that error?"}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1554685489, "post_id": 55564598, "comment_id": 97829633, "body": "@Amadan its real rep.  I opened up db browser only <code>total</code> is NULL bc <code>sum</code> isn&#39;t working"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "is_accepted": true, "score": 0, "last_activity_date": 1554687408, "creation_date": 1554687408, "answer_id": 55565220, "question_id": 55564598, "link": "https://stackoverflow.com/questions/55564598/unable-to-sum-a-float-iteration/55565220#55565220", "title": "unable to sum a float iteration", "body": "<pre><code>db.execute2 \"INSERT into a_table(Total) values(:get_amt)\", get_amt[1][0]\n</code></pre>\n\n<p>Essentially statement <code>get_amt = db.execute2 \"SELECT sum(Amount) from a_table WHERE type = :type\", hash_info[category]</code> writes more than 1 value into <code>get_amt</code> variable.\nthe variable must be provided with the<code>row</code> and <code>column</code> of the <strong>specific</strong> value that <code>INSERT</code> utilize.  Hence <code>get_amt[1][0]</code> Or the first row (next row after headers row) and the first column.</p>\n"}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 55565220, "answer_count": 1, "score": 0, "last_activity_date": 1554687408, "creation_date": 1554680256, "last_edit_date": 1554686085, "question_id": 55564598, "link": "https://stackoverflow.com/questions/55564598/unable-to-sum-a-float-iteration", "title": "unable to sum a float iteration", "body": "<p><code>ruby -v 2.3.7</code> (sqlite3 has compatability issues with newer ruby -v)\n<code>sqlite3 -v 3.22</code> <code>sqlite -v 2.8</code> <code>lsb_release -a 18.04</code></p>\n\n<p>I have condensed the code as much as I can. </p>\n\n<pre><code>def some_method(info_hash)\n    ...\n    db.results_as_hash = true\n    sum = 0\n    db.transaction\n    db.execute2 \"CREATE table if not exists a_table(Id INT PRIMARY KEY, Type TEXT, Month TEXT, Amount FLOAT, TOTAL FLOAT)\"\n    db.execute2 \"INSERT into a_table(Type, Month, Amount) values(:Type , :Month , :Amount)\", info_hash[:category], info_hash[:month], info_hash[:amount]\n    get_amt =  db.prepare \"SELECT Amount from a_table WHERE Type = :Type\" \n    get_amt.execute info_hash[:category]\n    get_amt.each do |g| \n        sum += g #here I get a NoMethodError for Nil:NilClass\n    end\n    db.execute2 \"INSERT into bills(Total) values(:sum)\", sum\n    db.commit\n    ...\nend\n</code></pre>\n\n<p>I use mainly the <code>execute2</code> method.  I rely on the <code>execute</code> method where I need to ignore headers, such as in my <code>get_amt.each</code> block.  </p>\n\n<p>I want to <code>sum</code> the <code>Amount</code> column for <code>Type</code>.  But I run into a <code>NoMethodError</code> when I run my <code>block</code>.</p>\n\n<p>The full error is:\n<code>undefined method '+' for nil:NilClass (NoMethodError)</code></p>\n\n<p><strong>Please advise as to where I've gone wrong.</strong></p>\n\n<p><strong>EDIT:</strong>\nI rewrote the code to reflect @Shawn 's suggestion:</p>\n\n<pre><code>def some_method(info_hash)\n        ...\n        db.transaction\n        db.execute2 \"CREATE table if not exists a_table(Id INTEGER PRIMARY KEY, Type TEXT, Month TEXT, Amount FLOAT, Total FLOAT)\"\n        db.execute2 \"INSERT into a_table(Type, Month, Amount) values(:Type , :Month , :Amount)\", info_hash[:category], info_hash[:month], info_hash[:amount]\n        get_amt =  db.execute2 \"SELECT sum(Amount) from a_table WHERE Type = :Type\", info_hash[:category]\n        db.execute2 \"INSERT into a_table(Total) values(:get_amt)\", get_amt\n        db.commit\n        ...\nend\n</code></pre>\n\n<p>This yields the <code>sqlite3 Exception</code> <code>Index out of range</code></p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "paypal-rest-sdk"], "comments": [{"owner": {"reputation": 104, "user_id": 4381022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e930fc1b15c96917acf14b6df8d9c981?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan Tran", "link": "https://stackoverflow.com/users/4381022/tuan-tran"}, "edited": false, "score": 0, "creation_date": 1554684286, "post_id": 55564103, "comment_id": 97829455, "body": "Could you add an example for <code>@payout_batch</code>?"}, {"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1554689172, "post_id": 55564103, "comment_id": 97830238, "body": "seems <code>batch_header</code> is not enumerable"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 104, "user_id": 4381022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e930fc1b15c96917acf14b6df8d9c981?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan Tran", "link": "https://stackoverflow.com/users/4381022/tuan-tran"}, "edited": false, "score": 0, "creation_date": 1554692647, "post_id": 55564103, "comment_id": 97830757, "body": "@TuanTran yes, I&#39;ll add the response in the update in a second"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 104, "user_id": 4381022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e930fc1b15c96917acf14b6df8d9c981?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan Tran", "link": "https://stackoverflow.com/users/4381022/tuan-tran"}, "edited": false, "score": 0, "creation_date": 1554692678, "post_id": 55564103, "comment_id": 97830764, "body": "@TuanTran actually, thsi is best since its very long: <a href=\"https://developer.paypal.com/docs/api/payments.payouts-batch/v1/#payouts_get\" rel=\"nofollow noreferrer\">developer.paypal.com/docs/api/payments.payouts-batch/v1/&hellip;</a> (scroll down a bit)"}, {"owner": {"reputation": 104, "user_id": 4381022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e930fc1b15c96917acf14b6df8d9c981?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan Tran", "link": "https://stackoverflow.com/users/4381022/tuan-tran"}, "edited": false, "score": 0, "creation_date": 1554694394, "post_id": 55564103, "comment_id": 97831053, "body": "@uno Do you want to print all keys, values in <code>batch_header</code> (<code>payout_batch_id</code>, <code>batch_status</code>, ...) or just print <code>amount</code> value?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1554694566, "post_id": 55564103, "comment_id": 97831077, "body": "So, i am able to print, the batch_header information from the view but i have issues printing the &quot;items.receiver&quot;, since i get the error: <code>undefined method receiver for #&lt;PayPal::SDK::Core::API::DataTypes::ArrayWithBlock:xxxxxxx&gt;</code>&zwnj;&#8203;... ... byt yeah, basicall yi want the be able to print all of the parameters"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1554697650, "post_id": 55564103, "comment_id": 97831642, "body": "Whats getting me is that all of the info i want response&#39;s within the CMD.. but in order to get receiver, I need to use ` @payout_item_details= PayoutItem.get(@payout_batch.items[0].payout_item_id)` but shouldn&#39;t i be able to have it appear in my views from the response? I&#39;ve been stuck on this all day"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554703505, "post_id": 55564103, "comment_id": 97833248, "body": "If you can show some more info about what exact info you want to extract, it would be helpful (and please do so by editing the question, not in comments). I&#39;m not sure if <code>PayPal::SDK::REST::DataTypes::PayoutBatchHeader.members</code> helps, it returns a list of method names that you can call on the result of <code>.batch_header</code>."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1554703621, "post_id": 55564103, "comment_id": 97833288, "body": "I&#39;m mostly aiming for &quot;receiver&quot; ... I am able to get the payout_item_id but nothing past that will append to the view with errors all saying they are nil, but i can see them in my cmd"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1554704062, "post_id": 55564103, "comment_id": 97833435, "body": "HOLY... actually hours later.... <code>&lt;%= @payout_batch.items[0].payout_item.receiver %&gt;</code> got it for me...."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 11094356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36488439a836bc8c5969bdac74e8aa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragya Sriharsh", "link": "https://stackoverflow.com/users/11094356/pragya-sriharsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1554719016, "creation_date": 1554719016, "answer_id": 55571238, "question_id": 55564103, "link": "https://stackoverflow.com/questions/55564103/loop-through-api-response-with-each/55571238#55571238", "title": "Loop through API response with .each", "body": "<p>PayPal and Stripe Payment Gateway's response always in the form of array. (For now, Don't know about other gateway as i have worked on these two.) </p>\n\n<p>You can say that they have to maintain a common structure which handles both single record or multiple record that's why it returns in the form of array in most of the cases in every payment gateway.</p>\n\n<p>So you have to do like this. </p>\n\n<pre><code> &lt;%= @payout_batch.items[0].batch_header %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554719016, "creation_date": 1554674771, "question_id": 55564103, "link": "https://stackoverflow.com/questions/55564103/loop-through-api-response-with-each", "title": "Loop through API response with .each", "body": "<p>I want to be able to parse through the API response in a loop.</p>\n\n<p>I have this in a controller method:</p>\n\n<pre><code>@payout_batch= PayPal::SDK::REST::Payout.get('xxxxxxx')\nlogger.info \"Got Payout Batch Status[#{@payout_batch.batch_header.payout_batch_id}]\"\n\n\nrescue ResourceNotFound =&gt; err\n  logger.error \"Payout Batch not Found\"\nend\n</code></pre>\n\n<p>I can show results like this:</p>\n\n<pre><code>&lt;%= @payout_batch.batch_header.amount.value %&gt;\n</code></pre>\n\n<p>But I want to be able to loop through everything in an .each loop, if posible..  I have tried a few ways but nothing seems to be working:</p>\n\n<pre><code>&lt;% @payout_batch.batch_header.each  do |x| %&gt;\n    &lt;%= (x[\"amount\"]) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And many more ways similar to this.   Tried defining the response with:</p>\n\n<pre><code> json = JSON.parse(@payout_batch)\n</code></pre>\n\n<p>and looping with json but that wouldn't seem to work either eithe.</p>\n\n<p>Question: How can I result the response in the views with a loop?</p>\n"}, {"tags": ["ruby", "docker", "rspec", "serverspec"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1554679329, "post_id": 55563822, "comment_id": 97828718, "body": "What&#39;s <code>set</code>?  (I don&#39;t think it&#39;s a standard rspec thing?)  Do you really want to build a new image each time, and require your tests to run as root?"}, {"owner": {"reputation": 1489, "user_id": 1613695, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/49b5b3b9873e3060bff7244940fed930?s=128&d=identicon&r=PG", "display_name": "tomasbasham", "link": "https://stackoverflow.com/users/1613695/tomasbasham"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1554706186, "post_id": 55563822, "comment_id": 97834331, "body": "I believe <code>set</code> comes from the <code>serverspec</code> gem. I&#39;ll edit the question to make that more clear. I don&#39;t really care right now if the image is built each time. I&#39;ll refactor this out later. More important is the the correct container is running"}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 1, "creation_date": 1554739341, "post_id": 55563822, "comment_id": 97853656, "body": "I would recommend interfacing the tests to the images through a <code>Rakefile</code> instead of a <code>bundle exec rspec</code> so you can create robust custom commands against your spec files. It is the boilerplate way with Serverspec as well."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 1262771, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/xArCe.jpg?s=128&g=1", "display_name": "Hemm K", "link": "https://stackoverflow.com/users/1262771/hemm-k"}, "edited": false, "score": 0, "creation_date": 1554835703, "post_id": 55582612, "comment_id": 97895076, "body": "Here here. Good solution, Sir"}], "tags": [], "owner": {"reputation": 1489, "user_id": 1613695, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/49b5b3b9873e3060bff7244940fed930?s=128&d=identicon&r=PG", "display_name": "tomasbasham", "link": "https://stackoverflow.com/users/1613695/tomasbasham"}, "is_accepted": true, "score": 1, "last_activity_date": 1554836306, "last_edit_date": 1554836306, "creation_date": 1554762319, "answer_id": 55582612, "question_id": 55563822, "link": "https://stackoverflow.com/questions/55563822/serverspec-using-wrong-container/55582612#55582612", "title": "serverspec using wrong container", "body": "<p>I found a way to solve the problem, albeit a pretty hacky one. The key to this problem lay in how the container is finally <a href=\"https://github.com/mizzy/specinfra/blob/457855560b74e0f6140f9943e441b48c535e1462/lib/specinfra/backend/docker.rb#L20\" rel=\"nofollow noreferrer\">released</a>. When there are no longer any references pointing to the <code>Docker</code> instance it will be garbage collected and the container killed and deleted. However the object instance is held in a class level variable as a singleton in the <a href=\"https://github.com/mizzy/specinfra/blob/457855560b74e0f6140f9943e441b48c535e1462/lib/specinfra/backend/docker.rb#L20\" rel=\"nofollow noreferrer\">base class</a>. It would seem to me the only way to \"reset\" specinfra is to call the <code>clear</code> method inherited on the <code>Docker</code> class.</p>\n\n<p>In the end the following solved the problem and the correct class is being used to run each spec.</p>\n\n<pre><code>after(:all) {\n  Specinfra.backend.class.clear\n}\n</code></pre>\n\n<p>It would be great to know there is a better way to access this methods without having to rely on a method not exposed through the <code>serverspec</code> gem.</p>\n"}], "owner": {"reputation": 1489, "user_id": 1613695, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/49b5b3b9873e3060bff7244940fed930?s=128&d=identicon&r=PG", "display_name": "tomasbasham", "link": "https://stackoverflow.com/users/1613695/tomasbasham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 55582612, "answer_count": 1, "score": 1, "last_activity_date": 1554836306, "creation_date": 1554672480, "last_edit_date": 1554706230, "question_id": 55563822, "link": "https://stackoverflow.com/questions/55563822/serverspec-using-wrong-container", "title": "serverspec using wrong container", "body": "<p>I have 2 spec files that use different docker images and therefore are suppose to start separate and different docker containers to run the examples.</p>\n\n<p>In the snippets below I'm using the <code>serverspec</code> gem to test my containers</p>\n\n<h3>spec/dockerfile/ember_spec.rb</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'spec_helper'\nrequire 'shared_examples/release'\n\ndescribe 'ember' do\n  before(:all) do\n    @image = Docker::Image.build_from_dir(image_path('ember'))\n\n    set :os, family: :alpine\n    set :backend, :docker\n    set :docker_image, @image.id\n    set :docker_container_create_options, { 'Entrypoint' =&gt; ['/bin/sh'] }\n  end\n\n  describe command('ember version') do\n    its(:stdout) { should contain 'ember-cli: 3.3.0' }\n    its(:stdout) { should contain 'node: 10.10.0' }\n  end\n\n  include_examples 'os release', 'Alpine Linux'\nend\n</code></pre>\n\n<h3>spec/dockerfile/gerbv_spec.rb</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'spec_helper'\nrequire 'shared_examples/release'\n\ndescribe 'gerbv' do\n  before(:all) do\n    @image = Docker::Image.build_from_dir(image_path('gerbv'))\n\n    set :os, family: :debian\n    set :backend, :docker\n    set :docker_image, @image.id\n    set :docker_container_create_options, { 'Entrypoint' =&gt; ['/bin/sh'] }\n  end\n\n  describe package('gerbv') do\n    it { should be_installed }\n  end\n\n  include_examples 'os release', 'Ubuntu 18.04'\nend\n</code></pre>\n\n<p>However when running <code>bundle exec rspec</code> it is quite clear that the same container is being used to run each spec file. I have confirmed this by printing out the running containers before each of the examples. This is of course causing the specs to fail for one of the files (whichever runs second).</p>\n\n<p>When the files are run independently using <code>bundle exec rspec path/to/file</code> then all the specs pass.</p>\n\n<p>Is there any way to force a container to be spun down after the examples in one file have run and a new container created for the other set of examples?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1554671972, "post_id": 55563733, "comment_id": 97827223, "body": "Are you sure if that is even supported by that ActiveHash gem? Sound like it just isn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 11094356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36488439a836bc8c5969bdac74e8aa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragya Sriharsh", "link": "https://stackoverflow.com/users/11094356/pragya-sriharsh"}, "is_accepted": true, "score": 1, "last_activity_date": 1554722118, "last_edit_date": 1554722118, "creation_date": 1554721382, "answer_id": 55571968, "question_id": 55563733, "link": "https://stackoverflow.com/questions/55563733/polymorphic-association-not-working-with-activehash/55571968#55571968", "title": "Polymorphic Association not working with ActiveHash", "body": "<p>See Doc: <a href=\"https://github.com/zilkey/active_hash/issues/151\" rel=\"nofollow noreferrer\">https://github.com/zilkey/active_hash/issues/151</a></p>\n\n<p>**</p>\n\n<blockquote>\n  <p>ActiveHash does not support <strong>arel</strong> behaviour.</p>\n</blockquote>\n\n<p>** </p>\n\n<p><strong>Arel</strong> is a SQL AST (Abstract Syntax Tree-like) manager for Ruby. It allows us to write complex SQL queries in a semantic, reusable fashion. Arel is \"framework framework\"; it's designed to optimize object and collection modeling over database compatibility. <strong>Active Record is built on top of Arel</strong>.</p>\n\n<p>see Doc: <a href=\"https://www.rubydoc.info/gems/honkster-active_hash/0.7.3\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/honkster-active_hash/0.7.3</a></p>\n\n<p>Even in this official doc, it doesn't explain anywhere  like this:</p>\n\n<pre><code>has_many :people, as: :placeable\n</code></pre>\n\n<p>Just explain</p>\n\n<pre><code>belongs_to :placeable, polymorphic: true\n</code></pre>\n"}], "owner": {"reputation": 1043, "user_id": 2483318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39ff3c31312946a611e3aab37ec7b6f?s=128&d=identicon&r=PG", "display_name": "kuiro5", "link": "https://stackoverflow.com/users/2483318/kuiro5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 55571968, "answer_count": 1, "score": 1, "last_activity_date": 1554722118, "creation_date": 1554671636, "last_edit_date": 1554672401, "question_id": 55563733, "link": "https://stackoverflow.com/questions/55563733/polymorphic-association-not-working-with-activehash", "title": "Polymorphic Association not working with ActiveHash", "body": "<p>I have an ActiveHash class that I'd like to use in a polymorphic association:</p>\n\n<pre><code>class Person &lt; ActiveRecord::Base\n  extend ActiveHash::Associations::ActiveRecordExtensions\n\n  belongs_to :placeable, polymorphic: true\nend\n\nclass Country &lt; ActiveHash::Base\n  include ActiveHash::Associations\n\n  has_many :people, as: :placeable\n\n  self.data = [\n    { id: 1, name: 'US' },\n    { id: 2, name: 'Canada' }\n  ]\nend\n\n</code></pre>\n\n<p>When setting the polymorphic association, it persists to the database setting the polymorphic type to <code>ActiveHash::Base</code>. When accessing it later, I receive an <code>undefined method 'arel_table'</code> error.</p>\n\n<pre><code>person = Person.create\nperson.placeable = Country.last\nperson.save\nperson\n=&gt; #&lt;Person id: 1, placeable_id: 2, placeable_type: \"ActiveHash::Base\"&gt;\n\nperson.placeable\nNoMethodError: undefined method `arel_table' for ActiveHash::Base:Class\n    from (irb):2\n</code></pre>\n\n<p>I've also tried setting the polymorphic type to <code>Country</code>, but I receive the same error for the Country class.</p>\n\n<p>A non-polymorphic <code>belongs_to</code> seems to work fine.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1208, "user_id": 180981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da09ed010a4332988a2fe3499208804e?s=128&d=identicon&r=PG", "display_name": "ives", "link": "https://stackoverflow.com/users/180981/ives"}, "edited": false, "score": 1, "creation_date": 1554677807, "post_id": 55563724, "comment_id": 97828479, "body": "To add to @arieljoud &#39;s comment, you often don&#39;t want your columns to automatically update. This is particularly true for scale. DDL statements are locking, and changing values in a column could take a really long time. This would block all other transactions until the updates are complete. Shoot for zero downtime deployments with proper feature enabling, with very fast schema migrations, then back-fill the data in manageable batches to avoid performance impact."}, {"owner": {"reputation": 123, "user_id": 3358528, "user_type": "registered", "profile_image": "https://graph.facebook.com/22301475/picture?type=large", "display_name": "Lannar", "link": "https://stackoverflow.com/users/3358528/lannar"}, "edited": false, "score": 0, "creation_date": 1611598920, "post_id": 55563724, "comment_id": 116498594, "body": "Try to avoid using model classes in your migrations.  See Habit 4 here: <a href=\"https://blog.testdouble.com/posts/2014-11-04-healthy-migration-habits/#habit-4-dont-reference-models\" rel=\"nofollow noreferrer\">blog.testdouble.com/posts/2014-11-04-healthy-migration-habit&zwnj;&#8203;s/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": true, "score": 3, "last_activity_date": 1554671559, "creation_date": 1554671559, "answer_id": 55563724, "question_id": 55563632, "link": "https://stackoverflow.com/questions/55563632/why-does-setting-a-default-value-for-an-existing-column-in-an-activerecord-migra/55563724#55563724", "title": "Why does setting a default value for an existing column in an ActiveRecord Migration not extend to existing associations on production?", "body": "<p>That's how it works. When you change the column default value, you are configuring the default value for new records, not existing ones. If you want to update existing values with <code>false</code> then do something like <code>Download.where(is_deleted: nil).update_all(is_deleted: false)</code> right after the <code>change_column</code> line:</p>\n\n<pre><code>class AddDefaultValuesToAFewColumns &lt; ActiveRecord::Migration[5.2]\n  def change\n    change_column :downloads, :is_deleted, :boolean, :default =&gt; false\n    Download.where(is_deleted: nil).update_all(is_deleted: false)\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6481581"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "accepted_answer_id": 55563724, "answer_count": 1, "score": 1, "last_activity_date": 1554671559, "creation_date": 1554670784, "question_id": 55563632, "link": "https://stackoverflow.com/questions/55563632/why-does-setting-a-default-value-for-an-existing-column-in-an-activerecord-migra", "title": "Why does setting a default value for an existing column in an ActiveRecord Migration not extend to existing associations on production?", "body": "<p>If I add a default value to an existing column through an ActiveRecord Migration, when deploying my changes to production, existing associations are not affected.</p>\n\n<p>I can drop to a rails production console and iterate over every single record and set the value on the new column to false on each record however it's tedious and doesn't scale well.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class AddDefaultValuesToAFewColumns &lt; ActiveRecord::Migration[5.2]\n  def change\n    change_column :downloads, :is_deleted, :boolean, :default =&gt; false\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>create_table \"downloads\", force: :cascade do |t|\n    t.string \"version\"\n    t.string \"comment\"\n    t.string \"contributors\"\n    t.string \"release_date\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"download_url\"\n    t.boolean \"is_deleted\", default: false\n  end\n\n</code></pre>\n\n<p>The expected result would be for associations when queried from the rails console to return <code>false</code> for is_deleted, rather it returns <code>nil</code>. Why is this and what alternative solutions are there?</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554671913, "post_id": 55563234, "comment_id": 97827212, "body": "I went with the first option but that gave me the error: ActiveRecord::StatementInvalid in Searches# show. --- PG::UndefinedColumn: ERROR:  column &quot;vin&quot; does not exist. And it seemed to point to the first VIN in the line"}, {"owner": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554675823, "post_id": 55563234, "comment_id": 97828101, "body": "Is there a similar way to scope out the first VIN like you did with the second @weilandia? I tried Appointment.VIN and appointments.VIN but those did not seem to work."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554704190, "post_id": 55563234, "comment_id": 97833486, "body": "@AJ.N the <code>PG::UndefinedColumn: ERROR: column &quot;vin&quot;</code> means you did not run a migration to change the column.  These docs can help you with that: <a href=\"https://edgeguides.rubyonrails.org/active_record_migrations.html\" rel=\"nofollow noreferrer\">edgeguides.rubyonrails.org/active_record_migrations.html</a>.  If you want to keep &quot;VIN&quot; as the column, you will have to reference it as <code>self.VIN</code> when accessing it from an instance of <code>Appointment</code>. You could define a method so that you can reference it as <code>vin</code> (i.e. <code>def vin; self.VIN; end</code>) but that is not necessary and I recommend against it."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554704751, "post_id": 55563234, "comment_id": 97833738, "body": "You could also do something like <code>alias_attribute :vin, :VIN</code> in the <code>Appointment</code> model, but again if you can change the column name, I&#39;d recommend that."}, {"owner": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554747581, "post_id": 55563234, "comment_id": 97857500, "body": "I get what you&#39;re saying but the table for appointments has existed for a long time and has worked everywhere else, so I&#39;m sure it was migrated. That&#39;s why I&#39;m confused by this error and trying alias_attribute or defining the vin function doesn&#39;t fix the issue. It gives the same error each time saying the column does not exist when I&#39;m sure it does. That&#39;s why i was asking for a way to scope it as it doesn&#39;t seem to be looking in the right place.."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554753969, "post_id": 55563234, "comment_id": 97860441, "body": "@AJ.N I misspoke in the comments above. I was commenting as though <code>VIN</code> was an attribute on <code>Appointment</code> but it&#39;s on <code>Search</code>.  So the <code>alias_attribute</code> would have to be in the <code>Search</code> model. I&#39;m not sure why you&#39;re getting <code>PG::UndefinedColumn: ERROR: column &quot;vin&quot;</code> but if you share the updated <code>Search</code> model and the relevant parts of <code>schema.rb</code> it might be clearer."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554754095, "post_id": 55563234, "comment_id": 97860493, "body": "As a side note, when looking closer at your code I realized you were persisting searches -- Is persistence of every search a requirement? If not I would use a PORO to handle your searching, something like <code>@search = AppointmentSearcher.new(search_params)</code> where <code>AppointmentSearcher</code> is just a ruby class that takes search params, searches and memoizes the results to be used in the view."}, {"owner": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554764577, "post_id": 55563234, "comment_id": 97863914, "body": "I fixed the the error by changing the line to appointments = appointments.where(&#39;&quot;VIN&quot; LIKE ?&#39;, self.VIN) if self.VIN.present? Thanks so much for all the help! I do not need it to be persistent and was worried about that, which line exactly would I change to using AppointmentSearcher that would fix this? I added my search controller code at the bottom of my post."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "edited": false, "score": 0, "creation_date": 1554774725, "post_id": 55563234, "comment_id": 97865903, "body": "@AJ.N that&#39;s a longer conversation. I&#39;d recommend looking into &#39;service objects&#39; generally. Here&#39;s a couple resources, but there are tons: <a href=\"https://medium.freecodecamp.org/service-objects-explained-simply-for-ruby-on-rails-5-a8cc42a5441f\" rel=\"nofollow noreferrer\">medium.freecodecamp.org/&hellip;</a>, <a href=\"https://medium.flatstack.com/query-object-in-ruby-on-rails-56ea434365f0\" rel=\"nofollow noreferrer\">medium.flatstack.com/query-object-in-ruby-on-rails-56ea43436&zwnj;&#8203;5f0</a>"}], "tags": [], "owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "is_accepted": true, "score": 2, "last_activity_date": 1554668377, "last_edit_date": 1554668377, "creation_date": 1554667899, "answer_id": 55563234, "question_id": 55563031, "link": "https://stackoverflow.com/questions/55563031/how-to-resolve-uninitialized-constant-search-error/55563234#55563234", "title": "How to resolve uninitialized constant Search:: error", "body": "<p>When you reference <code>VIN</code> in <code>appointments.where(\"VIN LIKE ?\", VIN)</code> ruby is looking for a constant because it is uppercase. In order to access your attribute you will need to reference <code>self.VIN</code> or change the column name to be lowercase (recommended).</p>\n\n<p>Option 1: <code>appointments = appointments.where(\"VIN LIKE ?\", self.VIN) if self.VIN.present?</code></p>\n\n<p>Option 2: </p>\n\n<ul>\n<li>Change the <code>VIN</code> column to <code>vin</code></li>\n<li><code>appointments = appointments.where(\"vin LIKE ?\", vin) if vin.present?</code></li>\n</ul>\n"}], "owner": {"reputation": 17, "user_id": 8865839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2349fd469617f2769eda22e26ed6172c?s=128&d=identicon&r=PG&f=1", "display_name": "AJ.N", "link": "https://stackoverflow.com/users/8865839/aj-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55563234, "answer_count": 1, "score": 0, "last_activity_date": 1554764310, "creation_date": 1554666449, "last_edit_date": 1554764310, "question_id": 55563031, "link": "https://stackoverflow.com/questions/55563031/how-to-resolve-uninitialized-constant-search-error", "title": "How to resolve uninitialized constant Search:: error", "body": "<p>I'm creating an advanced search/filter for my Appointment model related to car maintenance, where the tables in schema.rb for each are:</p>\n\n<pre><code>  create_table \"appointments\", force: :cascade do |t|\n    t.string \"VIN\"\n    t.string \"owner_email\"\n    t.string \"date\"\n    t.string \"time\"\n    t.string \"reason\"\n    t.string \"parts_needed\"\n    t.string \"hours_needed\"\n    t.string \"cost\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"searches\", force: :cascade do |t|\n    t.string \"VIN\"\n    t.string \"email\"\n    t.string \"after_date\"\n    t.string \"before_date\"\n    t.string \"time\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n</code></pre>\n\n<p>In my search.rb model I define the search function:</p>\n\n<pre><code>class Search &lt; ApplicationRecord\n\n    def search_appointments\n        appointments = Appointment.all\n        # appointments = appointments.where(\"VIN LIKE ?\", VIN) if VIN.present? GIVES ERROR\n        appointments = appointments.where(\"owner_email LIKE ?\", email) if email.present?\n        appointments = appointments.where(\"date &gt;= ?\", after_date) if after_date.present?\n        appointments = appointments.where(\"date &lt;= ?\", before_date) if before_date.present?\n        if !time==\"Any\"\n            appointments = appointments.where(\"time LIKE ?\", time) if time.present?\n        end\n\n        return appointments\n    end\nend\n</code></pre>\n\n<p>And then in my show.html.erb display the resulting filter:</p>\n\n<pre><code>&lt;h2 align=\"center\"&gt;Search Results&lt;/h2&gt;\n&lt;/br&gt;\n\n\n&lt;div class=\"container-fluid\"&gt;\n    &lt;% if @search.search_appointments.empty? %&gt;\n        &lt;p&gt; No Appointments Fit This Search&lt;/p&gt;\n\n    &lt;% else %&gt;\n        &lt;%= @search.search_appointments.each do |a| %&gt;\n\n        Email: &lt;%= a.owner_email%&gt; &lt;/br&gt;\n        Date: &lt;%= a.date%&gt; &lt;/br&gt;\n        Time: &lt;%= a.time%&gt; &lt;/br&gt;\n        VIN: &lt;%= a.VIN %&gt; &lt;/br&gt;\n\n        &lt;/br&gt;\n        &lt;/br&gt;\n        &lt;/br&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;\n    &lt;/br&gt;\n    &lt;%= link_to 'Return', @search, method: :delete %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Things work fine except for the first filter attempt in the search.rb model, the line that is commented out. If I uncomment the line and run a search, that line is highlighted and I get an error:</p>\n\n<pre><code>uninitialized constant Search::VIN\n</code></pre>\n\n<p>I don't understand why this is happening as all other filters are working just fine. I would appreciate any suggestions, thanks.</p>\n\n<p>Search controller:</p>\n\n<pre><code>class SearchesController &lt; ApplicationController\n\n    def new\n        @search = Search.new\n    end\n\n    def create\n        @search = Search.create(search_params)\n        redirect_to @search\n    end\n\n    def show\n        @search = Search.find(params[:id])\n    end\n\n    def destroy\n        @search = Search.find(params[:id])\n        @search.destroy\n\n        redirect_to admin_path\n    end\n\n    def search_params\n        params.require(:search).permit(:VIN, :email, :after_date, :before_date, :time)\n    end\nend\n</code></pre>\n\n<p>Where my 'new' page is a form where the user fills in the filter parameters and then clicks a submit button to take them to the show page that lists the filtered appointments.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1554664616, "post_id": 55562682, "comment_id": 97825251, "body": "So, you&#39;re creating many users. Which of those should <code>user</code> from <code>user.save</code> refer to? It&#39;s redundant anyway, <code>create!</code> either creates users or not. There are no pending changes in any of those users."}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554666126, "post_id": 55562740, "comment_id": 97825707, "body": "Hello @spickermann I have removed user.save now and I don&#39;t have any errors, which is great however when I type &quot;rails c&quot; into the console and then Hairstyle.all I see an empty array [ ]. Should I not see the 2 hairstyles that I created in my Seed?  Thanks in advance"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554671376, "post_id": 55562740, "comment_id": 97827086, "body": "@AngelaInniss and the users are there?"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1554672211, "post_id": 55562740, "comment_id": 97827287, "body": "Hello @Ursus Yes the users are there which is strange. I keep running rails db:seed and the users are wiped and created each time. Could it be something to do with my Model?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1554672386, "post_id": 55562740, "comment_id": 97827331, "body": "One error is that you&#39;re assigning a user, the entire object, to <code>user_id</code>. Either <code>user_id: User.first.id</code> or <code>user: User.first</code>."}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1554673099, "post_id": 55562740, "comment_id": 97827503, "body": "Hello @ursus I tried both and it does not work still. I have users and no hairstyles when I type rails c, Hairstyle.all. It&#39;s so strange, please let me know if you would like to see any other files/ have any more ideas. I am quite stuck at this point :S"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1554673250, "post_id": 55562740, "comment_id": 97827532, "body": "Then there&#39;s something else but we should see model and migration for hairstyle."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1554673373, "post_id": 55562740, "comment_id": 97827559, "body": "Otherwise you should try to see the errors active record returns. Something like <code>hairstyles.each do |h| hairstyle = Hairstyle.new(h); unless hairstyle.save then puts hairstyle.errors.inspect end</code>"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1554674018, "post_id": 55562740, "comment_id": 97827718, "body": "I just added the line of code you wrote above and did rails c Hairstyle.all and it returned something :O. Do you mind explaining why I had to iterate through the hairstyles and create a new one on each iteration? Why did my seed not work the way I had it originally? Thank you!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1554664654, "creation_date": 1554664654, "answer_id": 55562740, "question_id": 55562682, "link": "https://stackoverflow.com/questions/55562682/how-do-i-associate-a-user-foreign-key-in-my-ruby-on-rails-seed/55562740#55562740", "title": "How do I associate a user foreign key in my Ruby on Rails seed?", "body": "<p>Just remove this line</p>\n\n<pre><code>user.save\n</code></pre>\n\n<p>It doesn't make sense, you don't need it.</p>\n"}], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554665336, "creation_date": 1554664339, "last_edit_date": 1554665336, "question_id": 55562682, "link": "https://stackoverflow.com/questions/55562682/how-do-i-associate-a-user-foreign-key-in-my-ruby-on-rails-seed", "title": "How do I associate a user foreign key in my Ruby on Rails seed?", "body": "<p>I am a 'baby coder' and I am creating a new rails app and I would like to add some seeded data. The app will display different hairstyles belonging to a user meaning that each hairstyle needs a user_id. In my seed file I have created Users and Hairstyles however when I run rails:dbseed in the console it gives me the error: </p>\n\n<pre><code>\"NameError: undefined local variable or method `user' for main:Object\nDid you mean?  users\"\n</code></pre>\n\n<p>When I run rails c I see that users are created but my hairstyles aren't. Please can someone help me and explain why this is? Thank you</p>\n\n<p>SEED FILE: </p>\n\n<pre><code>Hairstyle.destroy_all\n\nUser.destroy_all\n\nusers = [\n  {\n    first_name: 'test',\n    last_name: 'Inniss',\n    email: 'angela@hair.com',\n    password: '123456' \n  },   \n  { \n    first_name: 'test2',\n    last_name: 'Clarke',\n    email: 'aaron@hair.com',\n    password: '123456'\n  }\n]\n\nUser.create!(users)\n\nuser.save\n\nhairstyles = [\n  {\n    name: 'Single Braids',\n    description: 'Really easy to maintain',\n    category: 'Braids',\n    video_url: 'www.google.com',\n    photo_url: 'https://images.unsplash.com/photo-1533233336213-b3a32825c689?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1049&amp;q=80',\n    user_id: User.first\n  },\n  {\n    name: 'Crochets',\n    description: 'Protective style',\n    category: 'Braids',\n    video_url: 'www.google.com',\n    photo_url: 'https://images.unsplash.com/photo-1533233336213-b3a32825c689?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1049&amp;q=80',\n    user_id: User.first\n  }\n]\n\nHairstyle.create!(hairstyles)\n</code></pre>\n"}, {"tags": ["ruby", "byebug"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554663508, "post_id": 55562217, "comment_id": 97824967, "body": "How about <code>caller.grep \\&#47;home\\&#47;albert\\&#47;druby\\&#47;bankbox&#47;</code>"}, {"owner": {"reputation": 1913, "user_id": 547341, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/10a0cbba661dd3521b5a35a3e7bbabcd?s=128&d=identicon&r=PG", "display_name": "Albert Catal&#224;", "link": "https://stackoverflow.com/users/547341/albert-catal%c3%a0"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1554818497, "post_id": 55562217, "comment_id": 97885967, "body": "Yes, it does the expected, Thanks"}, {"owner": {"reputation": 1913, "user_id": 547341, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/10a0cbba661dd3521b5a35a3e7bbabcd?s=128&d=identicon&r=PG", "display_name": "Albert Catal&#224;", "link": "https://stackoverflow.com/users/547341/albert-catal%c3%a0"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1554818574, "post_id": 55562217, "comment_id": 97886009, "body": "I thought byebug it would have something built for this purpose At the end all I have to put is something like <code>caller.grep(&#47;home\\&#47;albert\\&#47;druby\\&#47;bankbox&#47;).each { |call| puts call }</code>"}], "owner": {"reputation": 1913, "user_id": 547341, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/10a0cbba661dd3521b5a35a3e7bbabcd?s=128&d=identicon&r=PG", "display_name": "Albert Catal&#224;", "link": "https://stackoverflow.com/users/547341/albert-catal%c3%a0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1554660960, "creation_date": 1554660960, "question_id": 55562217, "link": "https://stackoverflow.com/questions/55562217/firendly-backtrace-where-command-with-ruby-byebug", "title": "Firendly backtrace (where command) with ruby byebug", "body": "<p>I use <code>byebug</code> to know the origin of a specific call, but when I use <code>where</code> I get the <strong>full backtrace</strong>.</p>\n\n<p>Is there a way to filter the <code>where</code> command to show only my code?</p>\n\n<p>For example this, is a typical <code>where</code> result, it shows 127 lines but I would like to see easily the lines #0, #1, #64, and #74 because only these lines are my \"code calls\"</p>\n\n<pre><code>(byebug) where\n--&gt; #0  Account.last_transactions at /home/albert/druby/bankbox/app/models/account.rb:31\n    #1  Api::V1::TransactionsController.index at /home/albert/druby/bankbox/app/controllers/api/v1/transactions_controller.rb:11\n    #2  ActionController::BasicImplicitRender.send_action(method#String, *args#Array) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/actionpack-5.2.2/lib/action_controller/metal/basic_implicit_render.rb:6\n    #3  AbstractController::Base.process_action(method_name#String, *args#Array) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/actionpack-5.2.2/lib/abstract_controller/base.rb:194\n    #4  ActionController::Rendering.process_action(*args) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/actionpack-5.2.2/lib/action_controller/metal/rendering.rb:30\n    #5  block in AbstractController::Callbacks.block in process_action(*args#Array) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/actionpack-5.2.2/lib/abstract_controller/callbacks.rb:42\n    #6  ActiveSupport::Callbacks.run_callbacks(kind#Symbol) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:132\n    #7  AbstractController::Callbacks.process_action(*args#Array) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/actionpack-5.2.2/lib/abstract_controller/callbacks.rb:41\n    #8  ActionController::Rescue.process_action(*args#Array) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/actionpack-5.2.2/lib/action_controller/metal/rescue.rb:22\n.... \n55 more lines\n....\n    #63 block (2 levels) in Rails::Controller::Testing::Integration.block (2 levels) in &lt;module:Integration&gt;(*args#Array) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rails-controller-testing-1.0.4/lib/rails/controller/testing/integration.rb:13\n    #64 block (2 levels) in RSpec::ExampleGroups::GETApiV1AccountsAccountIdTransactions::LetDefinitions.block (2 levels) in &lt;main&gt; at /home/albert/druby/bankbox/spec/requests/api/v1/transactions/index_spec.rb:7\n    #65 block (2 levels) in RSpec::ExampleGroups::GETApiV1AccountsAccountIdTransactions.block (2 levels) in let at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:298\n    #66 block (3 levels) in RSpec::Core::MemoizedHelpers::ThreadsafeMemoized.block (3 levels) in fetch_or_store(key#Symbol) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:157\n    \u0371-- #67 Hash.fetch(*args) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:157\n    #68 block (2 levels) in RSpec::Core::MemoizedHelpers::ThreadsafeMemoized.block (2 levels) in fetch_or_store(key#Symbol) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:157\n    #69 RSpec::Support::ReentrantMutex.synchronize at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-support-3.8.0/lib/rspec/support/reentrant_mutex.rb:23\n    #70 block in RSpec::Core::MemoizedHelpers::ThreadsafeMemoized.block in fetch_or_store(key#Symbol) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:156\n    \u0371-- #71 Hash.fetch(*args) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:155\n    #72 RSpec::Core::MemoizedHelpers::ThreadsafeMemoized.fetch_or_store(key#Symbol) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:155\n    #73 block in RSpec::ExampleGroups::GETApiV1AccountsAccountIdTransactions.block in let at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/memoized_helpers.rb:298\n    #74 block (3 levels) in block (3 levels) in &lt;main&gt; at /home/albert/druby/bankbox/spec/requests/api/v1/transactions/index_spec.rb:16\n    \u0371-- #75 BasicObject.instance_exec(*args) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:447\n    #76 RSpec::Core::Example.instance_exec(*args#Array, &amp;block#Proc) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/example.rb:447\n    #77 RSpec::Core::Hooks::BeforeHook.run(example#RSpec::Core::Example) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:348\n    #78 block in RSpec::Core::Hooks::HookCollections.block in run_owned_hooks_for(position#Symbol, scope#Symbol, example_or_group#RSpec::Core::Example) at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:507\n    \u0371-- #79 Array.each at /home/albert/.rvm/gems/ruby-2.6.0@5.2.2/gems/rspec-core-3.8.0/lib/rspec/core/hooks.rb:506\n    #80 RSpec::Core::Hooks::HookCollections.run_owned_hooks_for(position#Symb\n....\n47 more lines\n.....\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11325492, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157673790594068/picture?type=large", "display_name": "Luigi Palermo", "link": "https://stackoverflow.com/users/11325492/luigi-palermo"}, "edited": false, "score": 1, "creation_date": 1554905258, "post_id": 55561874, "comment_id": 97922976, "body": "Many thanks for your comment it has been very helpful in understanding the syntax in Ruby. Thanks"}], "tags": [], "owner": {"reputation": 470, "user_id": 1419458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40be82026a81f18a2bbbaad209694e0?s=128&d=identicon&r=PG", "display_name": "Stanko Krtali\u0107 Rusendi\u0107", "link": "https://stackoverflow.com/users/1419458/stanko-krtali%c4%87-rusendi%c4%87"}, "is_accepted": false, "score": 4, "last_activity_date": 1554659518, "last_edit_date": 1554659518, "creation_date": 1554658489, "answer_id": 55561874, "question_id": 55561826, "link": "https://stackoverflow.com/questions/55561826/whats-the-function-of-the-comma-in-this-piece-of-code/55561874#55561874", "title": "What&#39;s the function of the comma in this piece of code?", "body": "<p>In Ruby you can \"deconstruct\" an array and bind it to multiple variables in the following manner <code>a, b = [1, 2]</code>, where <code>1</code> will be bound to <code>a</code> and <code>2</code> to <code>b</code>. To give an example:</p>\n\n<pre><code>[1] pry(main)&gt; a, b = [1, 2]\n=&gt; [1, 2]\n[2] pry(main)&gt; a\n=&gt; 1\n[3] pry(main)&gt; b\n=&gt; 2\n</code></pre>\n\n<p>Knowing this the above code is the same as</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>units = durations.each_with_object({}) do |(name, duration), units|\n    result = seconds.divmod(duration)\n    units[name] = result.first\n    seconds = result.last\n    result\nend.reject { |k, v| v.zero? }.map(&amp;singularize)\n</code></pre>\n\n<p>To reflect upon your question <code>units[name, seconds=seconds....]</code> is not valid Ruby. A Hash's <code>[]</code> method expects only one argument. You could define your own class that accepts more.</p>\n\n<pre><code># The following was tested on ruby 2.6\n\nclass A\n  def [](name, surname)\n    puts \"#{name} #{surname}\"\n  end\n\n  def []=(name, surname, value)\n    puts \"#{name} #{surname} = #{value}\"\n  end\nend\n\na = A.new\na['foo', 'bar'] # prints 'foo bar'\na['foo', 'bar'] = 'baz' # prints 'foo bar = bar'\n</code></pre>\n\n<p>So you could define your own Hash implementation that does what you described, but by default it doesn't.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 11325492, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157673790594068/picture?type=large", "display_name": "Luigi Palermo", "link": "https://stackoverflow.com/users/11325492/luigi-palermo"}, "edited": false, "score": 0, "creation_date": 1554905491, "post_id": 55563818, "comment_id": 97923102, "body": "Hello Cary Many thanks for your time and the very complete explanation.  I have saved some of the links you suggested.  Thanks"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1554674665, "last_edit_date": 1592644375, "creation_date": 1554672470, "answer_id": 55563818, "question_id": 55561826, "link": "https://stackoverflow.com/questions/55561826/whats-the-function-of-the-comma-in-this-piece-of-code/55563818#55563818", "title": "What&#39;s the function of the comma in this piece of code?", "body": "<p>It appears that <code>.map(&amp;singularize)</code> is not really relevant to the question, so I've lopped that off.</p>\n<p><strong>Sample data</strong></p>\n<p>Let's break down this code snippet. For that we need some data. I'm guessing that <code>durations</code> may look something like the following, but the actual structure is probably not important.</p>\n<pre><code>seconds = 1630\ndurations = [[&quot;Bob&quot;, 3600], [&quot;Melba&quot;, 60]] \n</code></pre>\n<p>Bob consumes time in hours; Melba, in minutes.</p>\n<p><strong>The enumerator</strong></p>\n<p>We begin by defining an enumerator.</p>\n<pre><code>enum = durations.each_with_object({})\n  #=&gt; #&lt;Enumerator: {&quot;Bob&quot;=&gt;3600, &quot;Melba&quot;=&gt;60}:each_with_object({})&gt;\n</code></pre>\n<p><strong>First value generated by <code>enum</code></strong></p>\n<p>The first element is generated by <code>enum</code> and passed to the block, and the block variables are assigned values.</p>\n<pre><code>(name, duration), units = enum.next\n  #=&gt; [[&quot;Bob&quot;, 3600], {}] \nname\n  #=&gt; &quot;Bob&quot; \nduration\n  #=&gt; 3600 \nunits\n  #=&gt; {} \n</code></pre>\n<p><strong>Array decomposition</strong></p>\n<p>The process of breaking down <code>enum.next</code> is called <a href=\"https://docs.ruby-lang.org/en/2.1.0/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decomposition</a>. That link deserves a careful read. In fact, the entire file is well-written and informative. Notice how the parentheses in <code>|(name, duration), units|</code> correspond to the brackets in the array <code>duration</code>. See also <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\">Enumerator#next</a>.</p>\n<p><strong>Block calculation</strong></p>\n<p>The block calculation can now be performed.</p>\n<pre><code>units[name], seconds = seconds.divmod(duration)\n  #=&gt; units[&quot;Bob&quot;], seconds = 1630.divmod(3600)\n  #=&gt; units[&quot;Bob&quot;], seconds = [0, 1600]\nunits\n  #=&gt; {&quot;Bob&quot;=&gt;0} \nseconds\n  #=&gt; 1630 \n</code></pre>\n<p>Once again, we have used array decomposition. As <code>duration</code> equals the number of seconds per hour for Bob (3600), <code>units[&quot;Bob&quot;]</code> is set equal to a number of hours he &quot;consumed&quot; and <code>seconds</code> now equals the remaining number of seconds remaining. As the latter is unchanged (<code>1630</code>), we infer that Bob can only consume time in multiples of hours, so he consumed zero seconds.</p>\n<p><strong>Second value generated by <code>enum</code></strong></p>\n<p>After the block informs <code>enum</code> that it is ready for another element to be generated, we have the following.</p>\n<pre><code>(name, duration), units = enum.next\n  #=&gt; [[&quot;Melba&quot;, 60], {&quot;Bob&quot;=&gt;1}] \nname\n  #=&gt; &quot;Melba&quot; \nduration\n  #=&gt; 60 \nunits\n  #=&gt; {&quot;Bob&quot;=&gt;0} \n</code></pre>\n<p>Notice that <code>units</code> has been updated. Continuing,</p>\n<pre><code>units[name], seconds = seconds.divmod(duration)\n  #=&gt; units[&quot;Melba&quot;], seconds = 1630.divmod(60)\n  #=&gt; units[&quot;Melba&quot;], seconds = [27, 10]\nunits\n  #=&gt; {&quot;Bob&quot;=&gt;0, &quot;Melba&quot;=&gt;27}\nseconds\n  #=&gt; 10\n</code></pre>\n<p>We see that Melba has consumed <code>27</code> minutes worth of the <code>1630</code> seconds, leaving <code>10</code> seconds.</p>\n<p><strong>The block asks for the next element from <code>enum</code></strong></p>\n<p>The block is now ready for another element from <code>enum</code>.</p>\n<pre><code>(name, duration), units = enum.next    \n   #=&gt; #StopIteration (iteration reached an end)\n</code></pre>\n<p><code>enum</code> has raised a <code>StopInteration</code> exception as it has no more elements to give. This causes the value of <code>units</code> (<code>{&quot;Bob&quot;=&gt;0, &quot;Melba&quot;=&gt;27}</code>) to be returned by the block.</p>\n<p><strong>Remove non-consumers of time</strong></p>\n<p>Lastly, we rid ourselves of everyone who consumed zero seconds.</p>\n<pre><code>{&quot;Bob&quot;=&gt;0, &quot;Melba&quot;=&gt;27}.reject { |k, v| v.zero? }\n  #=&gt; {&quot;Melba&quot;=&gt;27}\n</code></pre>\n<p><strong>More complex examples of array decomposition</strong></p>\n<p>Here are two.</p>\n<pre><code>arr = [[1, {a:2}, [3, [4, 5..6]]], 7]\n\n(a, b, (c, (d, e))), f  = arr\na #=&gt; 1 \nb #=&gt; {:a=&gt;2} \nc #=&gt; 3 \nd #=&gt; 4 \ne #=&gt; 5..6 \nf #=&gt; 7\n\n[arr].each do |(a,b,(c,(d,e))),f|\n  puts a\n  puts b\n  puts c\n  puts d\n  puts e\n  puts f\nend\n1\n{:a=&gt;2}\n3\n4\n5..6\n7\n</code></pre>\n<p>Again, compare the locations of the parentheses with those of the brackets in <code>arr</code>.</p>\n<p>The use of array decomposition is extremely useful, but seems to be underutilised.</p>\n"}], "owner": {"reputation": 33, "user_id": 11325492, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157673790594068/picture?type=large", "display_name": "Luigi Palermo", "link": "https://stackoverflow.com/users/11325492/luigi-palermo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55563818, "answer_count": 2, "score": 3, "last_activity_date": 1554674665, "creation_date": 1554658077, "last_edit_date": 1554658726, "question_id": 55561826, "link": "https://stackoverflow.com/questions/55561826/whats-the-function-of-the-comma-in-this-piece-of-code", "title": "What&#39;s the function of the comma in this piece of code?", "body": "<p>I am trying to understand this code with the method.each_with_object.\nI do not understand how the comma (after <code>units[name]</code>) works inside the block.</p>\n\n<p>More clearly, what is its function? \nWhy there is a comma that separates the <code>units[name]</code> from <code>seconds=...</code> and it is not written as <code>units[name, seconds=seconds....]</code>?</p>\n\n<p>This is the piece of code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>units = durations.each_with_object({}) do |(name, duration), units|\n    units[name], seconds = seconds.divmod(duration)\nend.reject { |k, v| v.zero? }.map(&amp;singularize)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1554654389, "post_id": 55561076, "comment_id": 97822218, "body": "Don&#39;t post links to tutorials, we won&#39;t look there. Post the code you&#39;re using which is giving you the error."}, {"owner": {"reputation": 3, "user_id": 8614173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f274afab5adb7ac91402b4c5a32fd0f?s=128&d=identicon&r=PG&f=1", "display_name": "Smugller", "link": "https://stackoverflow.com/users/8614173/smugller"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1554655259, "post_id": 55561076, "comment_id": 97822466, "body": "I added code parts to post."}, {"owner": {"reputation": 470, "user_id": 1419458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40be82026a81f18a2bbbaad209694e0?s=128&d=identicon&r=PG", "display_name": "Stanko Krtali\u0107 Rusendi\u0107", "link": "https://stackoverflow.com/users/1419458/stanko-krtali%c4%87-rusendi%c4%87"}, "edited": false, "score": 0, "creation_date": 1554656337, "post_id": 55561076, "comment_id": 97822764, "body": "@Smugller From the snippets you posted it seems like you are missing <code>Types::MutationType</code>. Can you comment out <code>mutation(Types::MutationType)</code> and try again?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8614173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f274afab5adb7ac91402b4c5a32fd0f?s=128&d=identicon&r=PG&f=1", "display_name": "Smugller", "link": "https://stackoverflow.com/users/8614173/smugller"}, "edited": false, "score": 1, "creation_date": 1554685385, "post_id": 55564198, "comment_id": 97829616, "body": "Thank you for link to tutorial, this helps me. I delete graphql folder, generate new files with graphql:install comand and write code from scratch and it works!"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1554675738, "creation_date": 1554675738, "answer_id": 55564198, "question_id": 55561076, "link": "https://stackoverflow.com/questions/55561076/typeerror-cannot-read-property-types-of-undefined/55564198#55564198", "title": "TypeError: Cannot read property &#39;types&#39; of undefined", "body": "<p>I pulled code from you git repo. I have not worked with graphql but you clearly have not structured your modules and classes correctly.  Did your app ever work??  I suggest you start over with a new project and start from the very beginning if you're working from <a href=\"https://medium.com/@IreneuszSkrobis/graphql-mutations-in-ruby-on-rails-4f93f91b1f2d\" rel=\"nofollow noreferrer\">this tutorial</a></p>\n\n<p>But you might be better off with a new rails project,going step by step reading the <a href=\"https://graphql-ruby.org/\" rel=\"nofollow noreferrer\">documentation here</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 8614173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f274afab5adb7ac91402b4c5a32fd0f?s=128&d=identicon&r=PG&f=1", "display_name": "Smugller", "link": "https://stackoverflow.com/users/8614173/smugller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1644, "favorite_count": 0, "accepted_answer_id": 55564198, "answer_count": 1, "score": 0, "last_activity_date": 1587262207, "creation_date": 1554653617, "last_edit_date": 1587262207, "question_id": 55561076, "link": "https://stackoverflow.com/questions/55561076/typeerror-cannot-read-property-types-of-undefined", "title": "TypeError: Cannot read property &#39;types&#39; of undefined", "body": "<p>I'm confused, because i have a problem with this basic tutorial --> <a href=\"https://www.howtographql.com/graphql-ruby/4-authentication/\" rel=\"nofollow noreferrer\">https://www.howtographql.com/graphql-ruby/4-authentication/</a></p>\n\n<p>I move all queries to another folder (like mutations) with this tutorial -->\n<a href=\"https://itnext.io/graphql-with-ruby-on-rails-queries-in-multiple-files-3a7b818354a2\" rel=\"nofollow noreferrer\">https://itnext.io/graphql-with-ruby-on-rails-queries-in-multiple-files-3a7b818354a2</a></p>\n\n<p><strong>I got error in GraphiQL console:</strong></p>\n\n<pre><code>TypeError: Cannot read property 'types' of undefined\n    at buildClientSchema (http://localhost:4000/assets/graphiql/rails/application-6f03c7a92432765b0fbe671bfb7a292ee6c37e6704b6e6ac95587e45676bbf72.js:34102:72)\n    at http://localhost:4000/assets/graphiql/rails/application-6f03c7a92432765b0fbe671bfb7a292ee6c37e6704b6e6ac95587e45676bbf72.js:2795:55\n</code></pre>\n\n<p><strong>app/graphql/backend_schema.rb</strong></p>\n\n<pre><code>class BackendSchema &lt; GraphQL::Schema\n  mutation(Types::MutationType)\n  query(Types::QueryType)\nend\n</code></pre>\n\n<p><strong>app/graphql/types/user_type.rb</strong></p>\n\n<pre><code>module Types\n  class UserType &lt; Types::BaseObject\n    field :id, ID, null: false\n    field :name, String, null: false\n    field :email, String, null: false\n  end\nend\n</code></pre>\n\n<p><strong>app/graphql/types/query_type.rb</strong></p>\n\n<pre><code>module Types\n  class QueryType &lt; Types::BaseObject\n     field :get_all_users, resolver: Queries::GetAllUsers\n  end\nend\n</code></pre>\n\n<p><strong>app/graphql/queries/base_queries.rb</strong></p>\n\n<pre><code>module Queries\n  class BaseQuery &lt; GraphQL::Schema::Resolver\n    # null false\n  end\nend\n</code></pre>\n\n<p><strong>app/graphql/queries/get_all_users.rb</strong></p>\n\n<pre><code>module Queries\n  class GetAllUsers &lt; Queries::BaseQuery\n    type [Types::UserType], null: false\n\n    def get_all_users\n      User.all\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Logs from console:</strong></p>\n\n<pre><code>backend git:(master) rails s -p 4000\n=&gt; Booting Puma\n=&gt; Rails 5.2.3 application starting in development \n=&gt; Run `rails server -h` for more startup options\nPuma starting in single mode...\n* Version 3.12.1 (ruby 2.6.2-p47), codename: Llamas in Pajamas\n* Min threads: 5, max threads: 5\n* Environment: development\n* Listening on tcp://localhost:4000\nUse Ctrl-C to stop\nStarted GET \"/graphiql\" for ::1 at 2019-04-07 12:55:21 +0100\n   (0.7ms)  SELECT \"schema_migrations\".\"version\" FROM \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\n  \u21b3 /Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/log_subscriber.rb:98\nProcessing by GraphiQL::Rails::EditorsController#show as HTML\n  Parameters: {\"graphql_path\"=&gt;\"/graphql\"}\n  Rendering /Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/graphiql-rails-1.7.0/app/views/graphiql/rails/editors/show.html.erb\n  Rendered /Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/graphiql-rails-1.7.0/app/views/graphiql/rails/editors/show.html.erb (166.0ms)\nCompleted 200 OK in 171ms (Views: 169.2ms | ActiveRecord: 0.0ms)\n\n\nStarted POST \"/graphql\" for ::1 at 2019-04-07 12:55:22 +0100\nProcessing by GraphqlController#execute as */*\n  Parameters: {\"query\"=&gt;\"\\n    query IntrospectionQuery {\\n      __schema {\\n        queryType { name }\\n        mutationType { name }\\n        subscriptionType { name }\\n        types {\\n          ...FullType\\n        }\\n        directives {\\n          name\\n          description\\n          locations\\n          args {\\n            ...InputValue\\n          }\\n        }\\n      }\\n    }\\n\\n    fragment FullType on __Type {\\n      kind\\n      name\\n      description\\n      fields(includeDeprecated: true) {\\n        name\\n        description\\n        args {\\n          ...InputValue\\n        }\\n        type {\\n          ...TypeRef\\n        }\\n        isDeprecated\\n        deprecationReason\\n      }\\n      inputFields {\\n        ...InputValue\\n      }\\n      interfaces {\\n        ...TypeRef\\n      }\\n      enumValues(includeDeprecated: true) {\\n        name\\n        description\\n        isDeprecated\\n        deprecationReason\\n      }\\n      possibleTypes {\\n        ...TypeRef\\n      }\\n    }\\n\\n    fragment InputValue on __InputValue {\\n      name\\n      description\\n      type { ...TypeRef }\\n      defaultValue\\n    }\\n\\n    fragment TypeRef on __Type {\\n      kind\\n      name\\n      ofType {\\n        kind\\n        name\\n        ofType {\\n          kind\\n          name\\n          ofType {\\n            kind\\n            name\\n            ofType {\\n              kind\\n              name\\n              ofType {\\n                kind\\n                name\\n                ofType {\\n                  kind\\n                  name\\n                  ofType {\\n                    kind\\n                    name\\n                  }\\n                }\\n              }\\n            }\\n          }\\n        }\\n      }\\n    }\\n  \", \"graphql\"=&gt;{\"query\"=&gt;\"\\n    query IntrospectionQuery {\\n      __schema {\\n        queryType { name }\\n        mutationType { name }\\n        subscriptionType { name }\\n        types {\\n          ...FullType\\n        }\\n        directives {\\n          name\\n          description\\n          locations\\n          args {\\n            ...InputValue\\n          }\\n        }\\n      }\\n    }\\n\\n    fragment FullType on __Type {\\n      kind\\n      name\\n      description\\n      fields(includeDeprecated: true) {\\n        name\\n        description\\n        args {\\n          ...InputValue\\n        }\\n        type {\\n          ...TypeRef\\n        }\\n        isDeprecated\\n        deprecationReason\\n      }\\n      inputFields {\\n        ...InputValue\\n      }\\n      interfaces {\\n        ...TypeRef\\n      }\\n      enumValues(includeDeprecated: true) {\\n        name\\n        description\\n        isDeprecated\\n        deprecationReason\\n      }\\n      possibleTypes {\\n        ...TypeRef\\n      }\\n    }\\n\\n    fragment InputValue on __InputValue {\\n      name\\n      description\\n      type { ...TypeRef }\\n      defaultValue\\n    }\\n\\n    fragment TypeRef on __Type {\\n      kind\\n      name\\n      ofType {\\n        kind\\n        name\\n        ofType {\\n          kind\\n          name\\n          ofType {\\n            kind\\n            name\\n            ofType {\\n              kind\\n              name\\n              ofType {\\n                kind\\n                name\\n                ofType {\\n                  kind\\n                  name\\n                  ofType {\\n                    kind\\n                    name\\n                  }\\n                }\\n              }\\n            }\\n          }\\n        }\\n      }\\n    }\\n  \"}}\nuninitialized constant Queries::BaseQuery\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:79:in `block in load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:8:in `without_bootsnap_cache'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:79:in `rescue in load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:58:in `load_missing_constant'\n/Users/qwerty/projects/backend/app/graphql/queries/get_all_users.rb:2:in `&lt;module:Queries&gt;'\n/Users/qwerty/projects/backend/app/graphql/queries/get_all_users.rb:1:in `&lt;main&gt;'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:14:in `block in loading'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/concurrency/share_lock.rb:151:in `exclusive'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:13:in `loading'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:48:in `block in require_or_load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:47:in `require_or_load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:60:in `block in load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:59:in `load_missing_constant'\n/Users/qwerty/projects/backend/app/graphql/types/query_type.rb:3:in `&lt;class:QueryType&gt;'\n/Users/qwerty/projects/backend/app/graphql/types/query_type.rb:2:in `&lt;module:Types&gt;'\n/Users/qwerty/projects/backend/app/graphql/types/query_type.rb:1:in `&lt;main&gt;'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:14:in `block in loading'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/concurrency/share_lock.rb:151:in `exclusive'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:13:in `loading'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:48:in `block in require_or_load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:47:in `require_or_load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:60:in `block in load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:59:in `load_missing_constant'\n/Users/qwerty/projects/backend/app/graphql/backend_schema.rb:3:in `&lt;class:BackendSchema&gt;'\n/Users/qwerty/projects/backend/app/graphql/backend_schema.rb:1:in `&lt;main&gt;'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:14:in `block in loading'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/concurrency/share_lock.rb:151:in `exclusive'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:13:in `loading'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:48:in `block in require_or_load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:47:in `require_or_load'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:60:in `block in load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:59:in `load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:60:in `block in load_missing_constant'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.2/lib/bootsnap/load_path_cache/core_ext/active_support.rb:59:in `load_missing_constant'\n/Users/qwerty/projects/backend/app/controllers/graphql_controller.rb:10:in `execute'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/abstract_controller/base.rb:194:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal/rendering.rb:30:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/abstract_controller/callbacks.rb:42:in `block in process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/callbacks.rb:98:in `run_callbacks'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/abstract_controller/callbacks.rb:41:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal/rescue.rb:22:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/notifications.rb:168:in `block in instrument'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/notifications/instrumenter.rb:23:in `instrument'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/notifications.rb:168:in `instrument'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal/instrumentation.rb:32:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/railties/controller_runtime.rb:24:in `process_action'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/abstract_controller/base.rb:134:in `process'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal.rb:191:in `dispatch'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_controller/metal.rb:252:in `dispatch'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/routing/route_set.rb:34:in `serve'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/journey/router.rb:52:in `block in serve'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/journey/router.rb:35:in `each'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/journey/router.rb:35:in `serve'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/routing/route_set.rb:840:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/rack-2.0.7/lib/rack/etag.rb:25:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/rack-2.0.7/lib/rack/conditional_get.rb:38:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/rack-2.0.7/lib/rack/head.rb:12:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/migration.rb:559:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/callbacks.rb:98:in `run_callbacks'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/callbacks.rb:26:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/executor.rb:14:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/rack/logger.rb:38:in `call_app'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/rack/logger.rb:26:in `block in call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/tagged_logging.rb:71:in `block in tagged'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/tagged_logging.rb:28:in `tagged'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/tagged_logging.rb:71:in `tagged'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/rack/logger.rb:26:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/request_id.rb:27:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/rack-2.0.7/lib/rack/runtime.rb:22:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/executor.rb:14:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/actionpack-5.2.3/lib/action_dispatch/middleware/static.rb:127:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/rack-2.0.7/lib/rack/sendfile.rb:111:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/rack-cors-1.0.3/lib/rack/cors.rb:95:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/engine.rb:524:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/puma-3.12.1/lib/puma/configuration.rb:227:in `call'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/puma-3.12.1/lib/puma/server.rb:660:in `handle_request'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/puma-3.12.1/lib/puma/server.rb:474:in `process_client'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/puma-3.12.1/lib/puma/server.rb:334:in `block in run'\n/Users/qwerty/.rbenv/versions/2.6.2/lib/ruby/gems/2.6.0/gems/puma-3.12.1/lib/puma/thread_pool.rb:135:in `block in spawn_thread'\nCompleted 500 Internal Server Error in 12ms (Views: 0.9ms | ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>Thanks for help!</p>\n"}, {"tags": ["ruby", "rubygems", "zlib"], "comments": [{"owner": {"reputation": 470, "user_id": 1419458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40be82026a81f18a2bbbaad209694e0?s=128&d=identicon&r=PG", "display_name": "Stanko Krtali\u0107 Rusendi\u0107", "link": "https://stackoverflow.com/users/1419458/stanko-krtali%c4%87-rusendi%c4%87"}, "edited": false, "score": 0, "creation_date": 1554656751, "post_id": 55560859, "comment_id": 97822895, "body": "Depending on your OS setup you can try <code>brew install zlib</code>. Alternatively it could be that you haven&#39;t installed the command line tools - <a href=\"https://stackoverflow.com/questions/31304531/rails-will-not-install-on-my-mac\" title=\"rails will not install on my mac\">stackoverflow.com/questions/31304531/&hellip;</a> but it seems that you have done that from the error message. Or it could be that the version of libxml on your system is too new."}], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 449250, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d193dfed5a67ca650a3492203d7c952?s=128&d=identicon&r=PG", "display_name": "Little Jack", "link": "https://stackoverflow.com/users/449250/little-jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1554659000, "creation_date": 1554659000, "answer_id": 55561935, "question_id": 55560859, "link": "https://stackoverflow.com/questions/55560859/how-to-fix-zlib-missing-error-on-osx-10-14/55561935#55561935", "title": "How to FIX Zlib missing error on OSX 10.14?", "body": "<p>It turned out that I have to manually download zlib from its site and then install it myself to make it work.</p>\n\n<p>Extract the package then install as instruction :</p>\n\n<pre><code>./Configure\nmake\nmake install\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 449250, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d193dfed5a67ca650a3492203d7c952?s=128&d=identicon&r=PG", "display_name": "Little Jack", "link": "https://stackoverflow.com/users/449250/little-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554659000, "creation_date": 1554652234, "question_id": 55560859, "link": "https://stackoverflow.com/questions/55560859/how-to-fix-zlib-missing-error-on-osx-10-14", "title": "How to FIX Zlib missing error on OSX 10.14?", "body": "<p>I found this \"Zlib missing\" continously when installing gems for Rails on Ruby, please let me know a solution :</p>\n\n<pre><code>Fetching nokogiri 1.10.2\nInstalling nokogiri 1.10.2 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /usr/local/lib/ruby/gems/2.6.0/gems/nokogiri-1.10.2/ext/nokogiri\n/usr/local/opt/ruby/bin/ruby -I /usr/local/Cellar/ruby/2.6.2/lib/ruby/2.6.0 -r ./siteconf20190407-34092-u44l37.rb extconf.rb\nchecking if the C compiler accepts  -I /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/libxml2... yes\nchecking if the C compiler accepts -Wno-error=unused-command-line-argument-hard-error-in-future... no\nBuilding nokogiri using packaged libraries.\nUsing mini_portile version 2.4.0\nchecking for iconv.h... yes\nchecking for gzdopen() in -lz... no\nzlib is missing; necessary for building libxml2\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n</code></pre>\n\n<p>I also re-installed OSX 10.14 SDK header but didn't work.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 2, "last_activity_date": 1554655428, "creation_date": 1554655428, "answer_id": 55561374, "question_id": 55560737, "link": "https://stackoverflow.com/questions/55560737/how-does-an-instance-method-declaration-outside-a-class-work-in-ruby/55561374#55561374", "title": "How does an instance method declaration outside a class work in Ruby?", "body": "<p>Methods defined outside any class are added to the <code>Object</code> class, which is one of <code>Struct</code> ancestors (that is, <code>Struct</code> inherits all <code>Object</code> methods).</p>\n\n<p>Try this in a new irb session:</p>\n\n<pre><code>self.class\n#=&gt; Object\n\nself.respond_to?(:foo)\n#=&gt; false\n\ndef foo\n  \"foo\"\nend\n#=&gt; :foo\n\nself.respond_to?(:foo)\n#=&gt; true\n</code></pre>\n\n<p>In the provided example, you create an instance of <code>Klass</code> (which include <code>Struct</code> and <code>Object</code> in its ancestors chain), so when a new <code>Klass</code> instance is created, it includes all <code>Object</code>'s methods, including the new <code>foo</code> method.</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 55561374, "answer_count": 1, "score": 1, "last_activity_date": 1554655428, "creation_date": 1554651543, "last_edit_date": 1554655153, "question_id": 55560737, "link": "https://stackoverflow.com/questions/55560737/how-does-an-instance-method-declaration-outside-a-class-work-in-ruby", "title": "How does an instance method declaration outside a class work in Ruby?", "body": "<p>Well, the title of the question may seem improper, but I want to ask how does the following code actually work?</p>\n\n<pre><code>class Klass &lt; Struct.new(:x, :y, :z)\nend\n\npublic\ndef foo\n        bar\nend\n\ndef inspect\n        \"Can't override inspect -&gt; #{self.class}\"\nend\n\nprivate\ndef bar\n        [x, y, z]\nend\n\ndef baz\n        send(:class)\nend\n\nobj = Klass.new(1, 2, 3)\n\np obj.foo            # =&gt; [1, 2, 3]\np obj                # =&gt; #&lt;struct Klass x=1, y=2, z=3&gt;\np Klass.ancestors    # =&gt; [Klass, #&lt;Class:0x0000563835a45600&gt;, Struct, Enumerable, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>Now, this looks like a very bad practice. But how does this actually work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1554652046, "creation_date": 1554652046, "answer_id": 55560827, "question_id": 55560519, "link": "https://stackoverflow.com/questions/55560519/instancedoublesession-anonymous-received-unexpected-message-with/55560827#55560827", "title": "InstanceDouble(session) (anonymous)&gt; received unexpected message :[]= with", "body": "<p>The message is telling you that your double received the message <code>[]=</code> with arguments <code>:cart_id</code> and <code>123</code> but didn't expect it.</p>\n\n<p>Let's apply some basic logic. The problem is:</p>\n\n<ol>\n<li>receiving a message</li>\n<li>that wasn't expected</li>\n</ol>\n\n<p>So, there are two things you can do to get rid of the message:</p>\n\n<ol>\n<li>not send the message OR </li>\n<li>tell the double to expect the message</li>\n</ol>\n\n<p>The first one is easy: just remove line 14 which says <code>session[:cart_id] = current_cart.id</code> since that is the only place you are calling <code>[]=</code>. However, I don't think that is what you want to do.</p>\n\n<p>Number two is also easy. There is a method called <code>expect</code> which allows you to tell a double to expect a certain message. So, all we need to do, is to set up an expectation.</p>\n\n<p>Good failure messages are really important in a testing framework, and thankfully, RSpec <em>does</em> have good failure messages. The failure message should tell you how to move forward with your tests, and the message you quoted contains all the information we need:</p>\n\n<ul>\n<li>the name of the double that raised the failure (<code>session</code>)</li>\n<li>the name of the unexpected message that caused the failure (<code>[]=</code>)</li>\n<li>and even the arguments that were passed to the message (<code>:cart_id</code> and <code>123</code>)</li>\n</ul>\n\n<p>All we have to do is, without even thinking about it, literally just copy&amp;paste this information:</p>\n\n<pre><code>expect(session).to receive(:[]=).with(:cart_id, 123)\n</code></pre>\n\n<p>Or, if we want our tests to be a little less brittle and not hard-code the <code>123</code>, we could also do something like this:</p>\n\n<pre><code>expect(session).to receive(:[]=).with(:cart_id, instance_of(Integer))\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11325021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197fba38fc1ad5f5b8ca2ce3415e85?s=128&d=identicon&r=PG&f=1", "display_name": "damianw", "link": "https://stackoverflow.com/users/11325021/damianw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 0, "accepted_answer_id": 55560827, "answer_count": 1, "score": 3, "last_activity_date": 1554877073, "creation_date": 1554650257, "last_edit_date": 1554877073, "question_id": 55560519, "link": "https://stackoverflow.com/questions/55560519/instancedoublesession-anonymous-received-unexpected-message-with", "title": "InstanceDouble(session) (anonymous)&gt; received unexpected message :[]= with", "body": "<p>I have a problem with rspec behavior. I try to write test for service where I use <code>session</code>, for read some value and overwrite this value.</p>\n\n<p>For example what I want to test</p>\n\n<pre><code>class CurrentCartService\n  attr_reader :user, :session\n\n  def initialize(user, session)\n    @user = user\n    @session = session\n  end\n\n  def cart_id\n    { id: session[:cart_id] }\n  end\n\n  def assigne_cart_to_session\n    session[:cart_id] = current_cart.id\n  end\n\n</code></pre>\n\n<p><code>spec</code></p>\n\n<pre><code>describe CurrentCartService do\n  let(:current_user) { user }\n  let(:session) { double('session') }\n\n  let!(:cart) { create(:cart) }\n\n  subject { described_class.new current_user, session }\n\n  before do\n    allow(session).to receive(:[]).and_return(cart.id)\n  end\n\n  describe '#call' do\n    context 'when user is not signed' do\n      let(:user) { nil }\n      it { subject.call }\n    end\n  end\nend\n</code></pre>\n\n<p><code>binding.pry</code></p>\n\n<pre><code>session[:cart_id]\n=&gt; 574\n</code></pre>\n\n<pre><code>session[:cart_id] = 123\nRSpec::Mocks::MockExpectationError: #&lt;InstanceDouble(session) (anonymous)&gt; received unexpected message :[]= with (:cart_id, 123)\n</code></pre>\n\n<p>How to fix this? I tried to write some <code>expect</code></p>\n\n<pre><code>expect(session).to receive(:[])\n</code></pre>\n\n<p>But it does not work, it's still the same error</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "haml"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1554647384, "post_id": 55558520, "comment_id": 97820209, "body": "You should delete your edit and add it as an answer, that is perfectly fine to do here if you solve your own problem."}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1554658414, "post_id": 55558520, "comment_id": 97823409, "body": "I meant as an answer, not a comment. Maybe you don&#39;t have enough reputation points for that, I don&#39;t know."}], "answers": [{"comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1558976203, "post_id": 55562047, "comment_id": 99266998, "body": "There&#39;s a beta version of rspec-rails now that should work with rails 6 if you are interested. Check this RailsConf talk from a few days ago by one of the leads <a href=\"https://www.youtube.com/watch?v=aPYNMsXju_A\" rel=\"nofollow noreferrer\">youtube.com/watch?v=aPYNMsXju_A</a>"}, {"owner": {"reputation": 332, "user_id": 1328404, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b895f6335810e8c8d9b7fda0cba63c7c?s=128&d=identicon&r=PG", "display_name": "nilid", "link": "https://stackoverflow.com/users/1328404/nilid"}, "edited": false, "score": 1, "creation_date": 1581407321, "post_id": 55562047, "comment_id": 106412586, "body": "feb 11 2020, now you must specify branch as: gem &#39;rspec-rails&#39;, github: &#39;rspec/rspec-rails&#39;, branch: &#39;4-0-maintenance&#39;"}, {"owner": {"reputation": 161, "user_id": 1527024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sp5DY.jpg?s=128&g=1", "display_name": "racar", "link": "https://stackoverflow.com/users/1527024/racar"}, "edited": false, "score": 0, "creation_date": 1581511374, "post_id": 55562047, "comment_id": 106457735, "body": "Now you can use: gem &#39;rspec-rails&#39;, &#39;4.0.0.beta3&#39;  <a href=\"https://github.com/rspec/rspec-rails/issues/2177\" rel=\"nofollow noreferrer\">github.com/rspec/rspec-rails/issues/2177</a>"}], "tags": [], "owner": {"reputation": 131, "user_id": 7293415, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kyehx1WTJds/AAAAAAAAAAI/AAAAAAAAIwc/HlU8Xt2CkWE/photo.jpg?sz=128", "display_name": "Daniel Kukula", "link": "https://stackoverflow.com/users/7293415/daniel-kukula"}, "is_accepted": false, "score": 2, "last_activity_date": 1554659987, "creation_date": 1554659987, "answer_id": 55562047, "question_id": 55558520, "link": "https://stackoverflow.com/questions/55558520/i-cant-run-a-basic-rspec-test-with-haml-and-rails6/55562047#55562047", "title": "I can&#39;t run a basic rspec test with haml and rails6", "body": "<p>I updated rspec and now it passes - it seems that rspec is not ready for rails 6 </p>\n\n<pre><code>gem 'rspec-rails', github: 'rspec/rspec-rails', branch: '4-0-dev' \ngem 'rspec', github: 'rspec/rspec', branch: 'master' \ngem 'rspec-core', github: 'rspec/rspec-core', branch: 'master' \ngem 'rspec-mocks', github: 'rspec/rspec-mocks', branch: 'master' \ngem 'rspec-expectations', github: 'rspec/rspec-expectations', branch: 'master' \ngem 'rspec-support', github: 'rspec/rspec-support', branch: 'master' \n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 7293415, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kyehx1WTJds/AAAAAAAAAAI/AAAAAAAAIwc/HlU8Xt2CkWE/photo.jpg?sz=128", "display_name": "Daniel Kukula", "link": "https://stackoverflow.com/users/7293415/daniel-kukula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581308850, "creation_date": 1554636526, "last_edit_date": 1581308850, "question_id": 55558520, "link": "https://stackoverflow.com/questions/55558520/i-cant-run-a-basic-rspec-test-with-haml-and-rails6", "title": "I can&#39;t run a basic rspec test with haml and rails6", "body": "<p>I started a simple project with rails 6 and haml-rails and rspec and my basic tests are failing on a basic get :home pointing to a simple haml template - I don't really know if it's a haml-rails, haml or rspec problem. </p>\n\n<p>the errors I got</p>\n\n<pre><code># rspec spec/controllers/static_pages_controller_spec.rb\nDEPRECATION WARNING: Single arity template handlers are deprecated.  Template handlers must\nnow accept two parameters, the view object and the source for the view object.\nChange:\n  &gt;&gt; Class#call(template)\nTo:\n  &gt;&gt; Class#call(template, source)\n (called from &lt;top (required)&gt; at /home/kuku/Projects/Permission/config/application.rb:22)\nDEPRECATION WARNING: action_view.finalize_compiled_template_methods is deprecated and has no effect (called from &lt;top (required)&gt; at /home/kuku/Projects/Permission/config/environment.rb:7)\nDEPRECATION WARNING: formats is deprecated and will be removed from Rails 6.1 (called from block (3 levels) in &lt;top (required)&gt; at /home/kuku/Projects/Permission/spec/controllers/static_pages_controller_spec.rb:8)\nDEPRECATION WARNING: formats is deprecated and will be removed from Rails 6.1 (called from block (3 levels) in &lt;top (required)&gt; at /home/kuku/Projects/Permission/spec/controllers/static_pages_controller_spec.rb:8)\nDEPRECATION WARNING: formats is deprecated and will be removed from Rails 6.1 (called from block (3 levels) in &lt;top (required)&gt; at /home/kuku/Projects/Permission/spec/controllers/static_pages_controller_spec.rb:8)\nF\n\nFailures:\n\n  1) StaticPagesController GET #home returns http success\n     Failure/Error: get :home\n\n     ActionView::Template::Error:\n       wrong number of arguments (given 2, expected 1)\n     # ./spec/controllers/static_pages_controller_spec.rb:8:in `block (3 levels) in &lt;top (required)&gt;'\n     # ------------------\n     # --- Caused by: ---\n     # ArgumentError:\n     #   wrong number of arguments (given 2, expected 1)\n     #   ./spec/controllers/static_pages_controller_spec.rb:8:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.01728 seconds (files took 0.9926 seconds to load)\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/controllers/static_pages_controller_spec.rb:7 # StaticPagesController GET #home returns http success\n</code></pre>\n\n<p>my test - <code>get :home</code> is line 8</p>\n\n<pre><code># frozen_string_literal: true\n\nrequire 'rails_helper'\n\nRSpec.describe StaticPagesController, type: :controller do\n  describe 'GET #home' do\n    it 'returns http success' do\n      get :home\n      expect(response).to have_http_status(:success)\n    end\n  end\nend\n</code></pre>\n\n<p>and my controller</p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\n  def home; end\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  root to: 'static_pages#home'\nend\n</code></pre>\n\n<p>I tried to use haml-rails and haml from master branch which seems to have some rails6 fixes but the errors I got are the same errors:</p>\n\n<pre><code>gem 'haml', github: 'haml/haml', branch: 'master'\ngem 'haml-rails', github: 'indirect/haml-rails', branch: 'master'\n</code></pre>\n\n<p>Any suggestions that I may try or maybe is there any easy way to rollback from rails-haml to erb ?</p>\n"}, {"tags": ["ruby", "postgresql", "sinatra", "sinatra-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 5362658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jLMFF.jpg?s=128&g=1", "display_name": "QNester", "link": "https://stackoverflow.com/users/5362658/qnester"}, "is_accepted": true, "score": 2, "last_activity_date": 1554646444, "creation_date": 1554646444, "answer_id": 55559887, "question_id": 55557410, "link": "https://stackoverflow.com/questions/55557410/how-add-line-to-postqresql-use-activerecord-sinatra/55559887#55559887", "title": "How add line to PostqreSQL use activerecord-sinatra?", "body": "<p>For create new article use:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Article.create(title: your_title, content: your_content, published: true, published_on: Time.now)\n</code></pre>\n\n<p>For find article by ID:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Article.find(id)\n</code></pre>\n\n<p>For update article:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>article = Article.find(id)\narticle.update(title: your_title, content: your_content, published: true, published_on: Time.now)\n</code></pre>\n\n<p>For delete article record: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>article = Article.find(id)\narticle.destroy\n</code></pre>\n\n<p>AR documentation: </p>\n\n<ol>\n<li><p>for persistence - <a href=\"https://www.rubydoc.info/gems/activerecord/ActiveRecord/Persistence\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/activerecord/ActiveRecord/Persistence</a></p></li>\n<li><p>For finding: <a href=\"https://www.rubydoc.info/gems/activerecord/ActiveRecord/FinderMethods\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/activerecord/ActiveRecord/FinderMethods</a></p></li>\n<li><p>For complex queries: <a href=\"https://www.rubydoc.info/gems/activerecord/ActiveRecord/QueryMethods\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/activerecord/ActiveRecord/QueryMethods</a></p></li>\n</ol>\n"}], "owner": {"reputation": 325, "user_id": 10711461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x09vFeGc87g/AAAAAAAAAAI/AAAAAAAAHsA/63IliGHyj28/photo.jpg?sz=128", "display_name": "Stas Chehovskih", "link": "https://stackoverflow.com/users/10711461/stas-chehovskih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55559887, "answer_count": 1, "score": 0, "last_activity_date": 1554692463, "creation_date": 1554628859, "last_edit_date": 1554692463, "question_id": 55557410, "link": "https://stackoverflow.com/questions/55557410/how-add-line-to-postqresql-use-activerecord-sinatra", "title": "How add line to PostqreSQL use activerecord-sinatra?", "body": "<p>I installed PostgreSQL, later</p>\n\n<p>1 - Installed gem <code>pg</code></p>\n\n<p>2 - Installed gems:</p>\n\n<pre><code>gem install activerecord \ngem install sinatra-activerecord \ngem install rake\n</code></pre>\n\n<p>3 - I created connect to database to file app.rb</p>\n\n<pre><code># app.rb \nconfigure :development do set :database, {adapter: \"postgresql\",  encoding: \"unicode\", database: \"your_database_name\", pool: 2, username: \"your_username\", password: \"your_password\"}\nend\n\nconfigure :production do\n  set :database, {adapter: \"postgresql\",  encoding: \"unicode\", database: \"your_database_name\", pool: 2, username: \"your_username\", password: \"your_password\"}\nend\n</code></pre>\n\n<p>4 - Created model to file app.rb</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>5 - Created migration to Rakefile</p>\n\n<pre><code>require 'sinatra/activerecord'\nrequire 'sinatra/activerecord/rake'\nrequire './app'\n</code></pre>\n\n<p>6 - <code>rake db:create_migration NAME=create_articles</code></p>\n\n<p>7 - In new created by file migration </p>\n\n<pre><code>class CreateArticles &lt; ActiveRecord::Migration\n    def change\n        create_table :articles do |t|\n          t.string :title\n          t.string :content\n          t.boolean :published, :default =&gt; false\n          t.datetime :published_on, :required =&gt; false\n          t.integer :likes, :default =&gt; 0\n          t.timestamps null: false\n        end\n      end\n    end \n</code></pre>\n\n<p>8 - I fulfilled commands <code>db:create</code> and <code>rake db:migration</code></p>\n\n<p>Database created, The database in the psql console is displayed. how about now added line to database, in sinatra?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "isomorphic", "hyperstack"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1555277380, "post_id": 55559499, "comment_id": 98044854, "body": "You were a hacker before WWII?"}, {"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555291098, "post_id": 55559499, "comment_id": 98047205, "body": "@CarySwoveland close but not quite.  You look pretty experienced yourself"}], "tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1554663130, "last_edit_date": 1554663130, "creation_date": 1554643599, "answer_id": 55559499, "question_id": 55556083, "link": "https://stackoverflow.com/questions/55556083/how-do-i-only-set-a-state-variable-in-a-store-if-it-has-not-already-been-set/55559499#55559499", "title": "How do I only set a state variable in a Store if it has not already been set?", "body": "\n\n<p>You should move the logic around initialization into your store.  Remember that in Ruby your class instance variables can be initialized as the class is defined:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class BridgeStore &lt; HyperStore\n  @show_card_sample = true\n  class &lt;&lt; self\n    state_accessor :show_card_sample\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55559499, "answer_count": 1, "score": 1, "last_activity_date": 1554663130, "creation_date": 1554616911, "question_id": 55556083, "link": "https://stackoverflow.com/questions/55556083/how-do-i-only-set-a-state-variable-in-a-store-if-it-has-not-already-been-set", "title": "How do I only set a state variable in a Store if it has not already been set?", "body": "<p>I am using <a href=\"https://hyperstack.org/\" rel=\"nofollow noreferrer\">Hyperstack</a> Stores and in the <code>before_mount</code> of my component I want to do:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>before_mount do\n  BridgeStore.show_card_sample ||= true\nend\n</code></pre>\n\n<p>And in the store:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class BridgeStore &lt; HyperStore\n  class &lt;&lt; self\n    state_accessor :show_card_sample\n  end\nend\n</code></pre>\n\n<p>But the conditional assignment <code>||=</code> is being triggered each time a component of this type is rendered. </p>\n\n<p>I know I can get around this by setting a state variable in the store <code>state_accessor :is_set</code> and only set the other variables if that has not been set, but I was wondering if there is a better way round this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller", "rubygems"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1554614421, "post_id": 55555833, "comment_id": 97812678, "body": "Introduce <code>core</code> engine with common logic included. Core engine will be loaded when one of the others engine get loaded."}, {"owner": {"reputation": 323, "user_id": 1092800, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yVzfE.jpg?s=128&g=1", "display_name": "bradpotts", "link": "https://stackoverflow.com/users/1092800/bradpotts"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1554788518, "post_id": 55555833, "comment_id": 97868897, "body": "Thanks @Fabio your comment pushed me in the right direction."}], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 1092800, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yVzfE.jpg?s=128&g=1", "display_name": "bradpotts", "link": "https://stackoverflow.com/users/1092800/bradpotts"}, "is_accepted": false, "score": 0, "last_activity_date": 1554789263, "creation_date": 1554789263, "answer_id": 55585961, "question_id": 55555833, "link": "https://stackoverflow.com/questions/55555833/load-applicationcontroller-from-one-rails-engine-into-another-rails-engine/55585961#55585961", "title": "Load ApplicationController from One Rails Engine into Another Rails Engine", "body": "<p>There might be other ways, but this works for anybody building Rails Engines and wants some sort of solution. Based on Fabio comment I created a helper engine (example MyCoreHelperEngine) add it as a dependency to my other engines, put the logic in helper files. Views were alright but in the controllers, you have to include the engine helper files.</p>\n\n<pre><code> module Phcpress\n   class ApplicationController &lt; ActionController::Base\n\n     include MyCoreHelperEngine::MyHelperFile\n\n   end\n end\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 1092800, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yVzfE.jpg?s=128&g=1", "display_name": "bradpotts", "link": "https://stackoverflow.com/users/1092800/bradpotts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554789263, "creation_date": 1554614056, "question_id": 55555833, "link": "https://stackoverflow.com/questions/55555833/load-applicationcontroller-from-one-rails-engine-into-another-rails-engine", "title": "Load ApplicationController from One Rails Engine into Another Rails Engine", "body": "<p>Is there a way I can take my User MyAccounts::ApplicationController and include it into another Engine as if it's in the MyOtherEngine::ActionController. I was able to load Helpers from other engines but like to keep things in ApplicationController for this project.</p>\n\n<p>I'm also open to other ways but the Accounts engine uses the def and would like other engines to use it without pasting and repeating definition, also consider the loading helpers are repeating in both engines.</p>\n\n<pre><code>module Phcaccounts\n      class ApplicationController &lt; ActionController::Base\n\n        # Devise Filter\n        before_action :phc_devise_permitted_parameters, if: :devise_controller?\n\n        # Filter and Security\n        protect_from_forgery with: :exception\n\n        protected\n\n        # Whitelist Additional Fields\n        def phc_devise_permitted_parameters\n          added_attrs = [:username, :firstname, :lastname, :email, :password, :password_confirmation, :remember_me]\n          devise_parameter_sanitizer.permit :sign_up, keys: added_attrs\n          devise_parameter_sanitizer.permit :account_update, keys: added_attrs\n        end\n\n        # Load Helpers &amp; Load Helpers to Mainapp\n        helper Phctitleseo::Engine.helpers\n        helper Phcnotifi::Engine.helpers\n\n        # Redirect User to Welcome Screen After Signin\n        def after_sign_in_path_for(resource)\n          welcome_status_page_path\n        end\n\n        # Auth Filter for Admin\n        def phcaccounts_authentication_filter!\n          if admin_signed_in?\n            true\n          else\n            authenticate_user!\n          end\n        end\n\n      end\n    end\n</code></pre>\n\n<pre><code>    require \"???/???\"\n\n    module Phcpress\n      class ApplicationController &lt; ActionController::Base\n\n        # Security\n        ?????include Phcaccounts::ApplicationController?????\n        protect_from_forgery with: :exception\n\n        # Load Helpers\n        helper Phctitleseo::Engine.helpers\n        helper Phcnotifi::Engine.helpers\n\n      end\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "isomorphic", "hyperstack"], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "is_accepted": true, "score": 1, "last_activity_date": 1554959719, "last_edit_date": 1554959719, "creation_date": 1554613267, "answer_id": 55555776, "question_id": 55555755, "link": "https://stackoverflow.com/questions/55555755/material-ui-themes-and-hyperstack/55555776#55555776", "title": "Material UI Themes and Hyperstack", "body": "<p>After some experimentation, I got this working well by mixing JS and Opal code so here is the solution in case anyone else comes up with this. (There may be a better 'more Opal' solution, so if there is please do post an alternative answer, but the one below does work well.</p>\n\n<p>First import the JS libraries with webpack:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>import { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport indigo from '@material-ui/core/colors/indigo';\nimport pink from '@material-ui/core/colors/pink';\nimport red from '@material-ui/core/colors/red';\nglobal.createMuiTheme = createMuiTheme;\nglobal.MuiThemeProvider = MuiThemeProvider;\nglobal.indigo = indigo;\nglobal.pink = pink;\nglobal.red = red;\n</code></pre>\n\n<p>Add the following to your Javascript assets:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>// app/assets/javascripts/my_theme.js\nconst my_theme = createMuiTheme(\n  { palette: {\n    primary: { main: pink[500] },\n    secondary: { main: indigo[500] }\n  }\n});\n</code></pre>\n\n<p>Then provide the theme in your top-level Component code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyRouter &lt; HyperComponent\n  include Hyperstack::Router\n\n  render(DIV) do\n    MuiThemeProvider(theme: `my_theme` ) do\n      CssBaseline do\n        ...\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 55555776, "answer_count": 1, "score": 1, "last_activity_date": 1554959719, "creation_date": 1554612975, "question_id": 55555755, "link": "https://stackoverflow.com/questions/55555755/material-ui-themes-and-hyperstack", "title": "Material UI Themes and Hyperstack", "body": "<p>Material UI (React) uses a theaming solution where the theme object is created in JS then passed into the top level component. Creating the theme object in Opal can be complicated as the Material component expects a JS function to be passed in which actually creates the theme on the fly.</p>\n\n<p>Has anyone got an example of this working well?</p>\n"}, {"tags": ["regex", "ruby", "string"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1554604730, "post_id": 55555085, "comment_id": 97811380, "body": "Your answer works. <code>double_consonants(&#39;abcdefg&#39;) #=&gt; &quot;abbccddeffgg&quot;</code>."}, {"owner": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "edited": false, "score": 0, "creation_date": 1554604880, "post_id": 55555085, "comment_id": 97811402, "body": "Try: <code>if char =~ &#47;[bcdfghjklmnpqrstvwxyz]&#47;i</code>"}, {"owner": {"reputation": 13, "user_id": 11323044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1hGBg1k8ing/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH-SyDogvZ_SE3GAowP9bccELiPQ/mo/photo.jpg?sz=128", "display_name": "Purge Ibaka", "link": "https://stackoverflow.com/users/11323044/purge-ibaka"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1554605209, "post_id": 55555085, "comment_id": 97811443, "body": "Yes I know that my answer works but I was looking for a simpler solution that combines my two conditions, assuming it&#39;s possible. @SagarPandya"}, {"owner": {"reputation": 13, "user_id": 11323044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1hGBg1k8ing/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH-SyDogvZ_SE3GAowP9bccELiPQ/mo/photo.jpg?sz=128", "display_name": "Purge Ibaka", "link": "https://stackoverflow.com/users/11323044/purge-ibaka"}, "reply_to_user": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "edited": false, "score": 0, "creation_date": 1554605505, "post_id": 55555085, "comment_id": 97811477, "body": "Thank you @Matt.G that worked, but to be honest I was looking for a working version of [a-z^aeiou]/i, more so to better understand the mechanics of regular expressions."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1554606579, "post_id": 55555085, "comment_id": 97811640, "body": "This <code>&#47;[a-z&amp;&amp;[^aeiou]]&#47;</code> from <a href=\"https://stackoverflow.com/questions/26026913/using-regex-to-match-consonant-letters\">here</a>. Then another way using gsub would be <code>str.gsub(&#47;([a-z&amp;&amp;[^aeiou]])&#47;i,&#39;\\1\\1&#39;)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554610815, "post_id": 55555085, "comment_id": 97812198, "body": "A few very small points. 1) Since Ruby v2.4 you can write <code>char.match?(&#47;[a-z]&#47;i)</code> instead of  <code>char =~ &#47;[a-z]&#47;i</code>. The former arguably reads better, and returns a boolean, rather than a string index (you would not use) or <code>nil</code>. 2. You could write <code>char !~ &#47;aeiou&#47;i</code> instead of <code>char =~ &#47;[^aeiou]&#47;i</code>. (cont...)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554610900, "post_id": 55555085, "comment_id": 97812206, "body": "...3. <code>string.chars</code> returns a temporary array. As <code>map</code> is an <code>Enumerable</code> method it requires a receiver that is an enumerator, to you can instead write <code>string.each_char.map</code>, as <code>each_char</code> returns an enumerator rather than a temporary array, saving memory. Use <code>each_char</code> except when chaining to an <code>Array</code> method, in which case you must use <code>chars</code> (e.g., <code>string.chars.product(...)</code>)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1554612769, "post_id": 55555085, "comment_id": 97812444, "body": "Note that you don&#39;t need the variable <code>array</code>. Remove <code>array =</code> and <code>array.join</code>, and replace <code>end</code> that ends <code>map</code>&#39;s block with <code>end.join</code>. Recall every block returns a value. Here&#39;s a variant that avoids the conversion to an array and the subsequent <code>join</code>, and also incorporates @Sagar&#39;s suggestion: <code>&quot;Cats!&quot;.each_char.with_object(&#39;&#39;) { |c,s| s &lt;&lt; (c.match?(&#47;[a-z&amp;&amp;[^aeiou]]&#47;i) ? c*2 : c) } # #=&gt; &quot;CCattss!&quot;</code>. Incidentally, since your code works, your question is really more suitable for SO&#39;s sister site at Stack Exchange, <a href=\"https://codereview.stackexchange.com/\">Code Review</a>. Have a look!"}, {"owner": {"reputation": 13, "user_id": 11323044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1hGBg1k8ing/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH-SyDogvZ_SE3GAowP9bccELiPQ/mo/photo.jpg?sz=128", "display_name": "Purge Ibaka", "link": "https://stackoverflow.com/users/11323044/purge-ibaka"}, "edited": false, "score": 0, "creation_date": 1554688397, "post_id": 55555085, "comment_id": 97830113, "body": "Thank you @SagarPanya your solution is the one closest to the solution that I envisioned."}, {"owner": {"reputation": 13, "user_id": 11323044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1hGBg1k8ing/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH-SyDogvZ_SE3GAowP9bccELiPQ/mo/photo.jpg?sz=128", "display_name": "Purge Ibaka", "link": "https://stackoverflow.com/users/11323044/purge-ibaka"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554689104, "post_id": 55555085, "comment_id": 97830228, "body": "@CarySwoveland you&#39;re a rockstar.  Your larger solution was very thorough and your suggestion to use the match? method instead of the =~ regex method makes perfect sense and is easier to work with.  By the way, I literally made a profile right before posting this problem and was shocked at the speed of the responses.  I want to thank you and everyone else that took time to help me out."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1554695455, "last_edit_date": 1554695455, "creation_date": 1554605496, "answer_id": 55555177, "question_id": 55555085, "link": "https://stackoverflow.com/questions/55555085/how-do-i-simplify-my-solution-to-this-ruby-problem-that-asks-for-every-consonant/55555177#55555177", "title": "How do I simplify my solution to this ruby problem that asks for every consonant to be doubled in a given string?", "body": "<pre><code>MAPPING =\n  (('a'..'z').to_a - %w|a e i o u|).\n    each_with_object({}) do |s,h|\n      h[s] = s + s\n      h[s.upcase] = h[s].upcase\n    end.tap { |h| h.default_proc = proc { |_,c| c } } \n  #=&gt; {\"b\"=&gt;\"bb\", \"c\"=&gt;\"cc\", \"d\"=&gt;\"dd\", \"f\"=&gt;\"ff\",...\"z\"=&gt;\"zz\",\n  #    \"B\"=&gt;\"BB\", \"C\"=&gt;\"CC\", \"D\"=&gt;\"DD\", \"F\"=&gt;\"FF\",...\"Z\"=&gt;\"ZZ\"} \n\nMAPPING['c']  #=&gt; \"cc\" \nMAPPING['C']  #=&gt; \"CC\" \nMAPPING['a']  #=&gt; \"a\" \nMAPPING['$']  #=&gt; \"$\" \n\n\"Now is the time to party, said 007.\".gsub(/./, MAPPING)\n  #=&gt; \"NNoww iss tthhe ttimme tto pparrttyy, ssaidd 007.\"\n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">String#gsub</a> that employs a hash (<code>MAPPING</code>) to perform substitutions. <code>gsub</code>'s first argument, the regular expression <code>/./</code> causes each character of the string to be matched.</p>\n\n<p>For this to work, <code>MAPPING[c]</code> (<code>c</code> a variable) must return <code>c</code> for every character <code>c</code> that is not a consonant. That is achieved by attaching a <em>default proc</em> (<code>proc { |_,c| c }</code>) to the hash. See <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-default_proc-3D\" rel=\"nofollow noreferrer\">Hash#default_proc=</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Kernel#tap</a>.</p>\n\n<p>If several strings are to be converted, using a regex is relatively inefficient when compared to using a hash, as matching a character against a collection of consonants requires a linear search, whereas hash lookups are very fast, being relatively insensitive to the numbers of keys in the hash.</p>\n"}, {"tags": [], "owner": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1554606779, "creation_date": 1554606779, "answer_id": 55555275, "question_id": 55555085, "link": "https://stackoverflow.com/questions/55555085/how-do-i-simplify-my-solution-to-this-ruby-problem-that-asks-for-every-consonant/55555275#55555275", "title": "How do I simplify my solution to this ruby problem that asks for every consonant to be doubled in a given string?", "body": "<p>if you need a regex solution similar to the one posted in question, try Regex: <code>(?=[a-z])(?![aeiou])(.)</code></p>\n\n<p>and replace with <code>\\1\\1</code></p>\n\n<p><a href=\"https://regex101.com/r/gZGMmw/2\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>Coming to the regex mentioned in the question: <code>[a-z^aeiou]</code> matches a single character in the range between <code>a (index 97)</code> and <code>z (index 122)</code> or <code>^</code> or <code>a</code> or <code>e</code> or <code>i</code> or <code>o</code> or <code>u</code> (case insensitive) (For more details see the description given in the top right corner in this <a href=\"https://regex101.com/r/gZGMmw/3\" rel=\"nofollow noreferrer\">Demo</a>)</p>\n"}], "owner": {"reputation": 13, "user_id": 11323044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1hGBg1k8ing/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH-SyDogvZ_SE3GAowP9bccELiPQ/mo/photo.jpg?sz=128", "display_name": "Purge Ibaka", "link": "https://stackoverflow.com/users/11323044/purge-ibaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55555177, "answer_count": 2, "score": -1, "last_activity_date": 1554695455, "creation_date": 1554603821, "last_edit_date": 1554606025, "question_id": 55555085, "link": "https://stackoverflow.com/questions/55555085/how-do-i-simplify-my-solution-to-this-ruby-problem-that-asks-for-every-consonant", "title": "How do I simplify my solution to this ruby problem that asks for every consonant to be doubled in a given string?", "body": "<p>So the question asks that I \"Write a method that takes a string, and returns a new string in which every consonant character is doubled.  Vowels (a,e,i,o,u), digits, punctuation and white space should not be doubled.\"  Well I quickly realized that a regular expression should do the trick, but i'm pretty new to such expressions and thus had to use an &amp;&amp; operator to get my solution to work.  Now I'm sure it's an easy fix, but I was unable to create it so here's my solution to the problem: </p>\n\n<pre><code>def double_consonants(string)\n  array = string.chars.map do |char| \n    if char =~ /[a-z]/i &amp;&amp; char =~ /[^aeiou]/i\n      char * 2\n    else \n      char \n    end \n  end \n  array.join \nend \n</code></pre>\n\n<p>So double_consonants(\"Hello World!\") correctly outputs \"HHellllo WWorrlldd!\" but i'm looking for a more terse solution.  I tried, [a-z^aeiou]/i and similar combinations but they also doubled the vowels.  So if someone can instruct me on how to combine the two expressions correctly, as well as explain to me why my rudimentary attempt was wrong, I would be extremely grateful.  Furthermore any suggestions or corrections to the rest of my code is also welcome.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows", "sqlite", "railsinstaller"], "comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1554606973, "post_id": 55555020, "comment_id": 97811709, "body": "I found that the rails installation can be &quot;mended&quot; by just doing a gem install rails first."}, {"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 1, "creation_date": 1554635093, "post_id": 55555020, "comment_id": 97816823, "body": "This is probably not the advice you are looking for - but if you haven&#39;t already, I would consider using Linux for development. You can still remain on your Windows, and install Vagrant with the latest Ubuntu box. After you go through this initial headache, things will be easier in their more natural Linux environment."}], "owner": {"reputation": 1, "user_id": 7718042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/778e28e1231735d36295703fbf5db112?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7718042/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554603135, "creation_date": 1554602841, "question_id": 55555020, "link": "https://stackoverflow.com/questions/55555020/how-to-install-ruby-on-rails-on-windows-10-using-rails-installer", "title": "How to install Ruby On Rails on Windows 10 using Rails Installer", "body": "<p>I am trying to create a new Ruby On Rails project. I am following the official <a href=\"https://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">Getting Started with Rails</a> guide. After running the <a href=\"http://railsinstaller.org/en\" rel=\"nofollow noreferrer\">Rails Installer</a> for Ruby 2.2 I attempt to create a new project by running <code>rails new blog</code> and get the following error:</p>\n\n<pre><code>...\nInstalling sqlite3 1.4.0 with native extensions\nInstalling turbolinks-source 5.2.0\nInstalling i18n 1.6.0\nInstalling tzinfo 1.2.5\nInstalling nokogiri 1.10.2\nUsing rack-test 0.6.3\nInstalling sprockets 3.7.2\nInstalling websocket-driver 0.6.5 with native extensions\nInstalling mail 2.7.1\nUsing coffee-script 2.4.1\nInstalling uglifier 4.1.20\nInstalling rb-inotify 0.10.0\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\nC:/RailsInstaller/Ruby2.2.0/bin/ruby.exe -r\n./siteconf20190406-3720-ldo4eg.rb extconf.rb\nchecking for sqlite3.h... no\nsqlite3.h is missing. Install SQLite3 from http://www.sqlite.org/ first.\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/RailsInstaller/Ruby2.2.0/bin/$(RUBY_BASE_NAME)\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-config\n        --without-sqlite3-config\n        --with-pkg-config\n        --without-pkg-config\n        --with-sqlcipher\n        --without-sqlcipher\n        --with-sqlite3-dir\n        --without-sqlite3-dir\n        --with-sqlite3-include\n        --without-sqlite3-include=${sqlite3-dir}/include\n        --with-sqlite3-lib\n        --without-sqlite3-lib=${sqlite3-dir}/lib\n\nextconf failed, exit code 1\n\nGem files will remain installed in\nC:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/sqlite3-1.4.0 for\ninspection.\nResults logged to\nC:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/extensions/x86-mingw32/2.2.0/sqlite3-1.4.0/gem_make.out\n\nAn error occurred while installing sqlite3 (1.4.0), and Bundler cannot continue.\nMake sure that `gem install sqlite3 -v '1.4.0'` succeeds before bundling.\n</code></pre>\n\n<p>There are many \"solutions\" to this problem online. They all explain different ways to install sqlite manually. I have tried installing sqlite manually but do not know how to install it so that Rails knows where to find my local installation. There are many different suggestions online for how to do this, and none of them have worked for me.</p>\n\n<p>I have spent over six hours trying to simply create a new Rails project and keep getting this error (or similar errors). It is my understanding that the Rails Installer is supposed to install <strong>everything</strong> you need to get started. What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5", "acts-as-list"], "answers": [{"comments": [{"owner": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "edited": false, "score": 0, "creation_date": 1554683307, "post_id": 55554502, "comment_id": 97829288, "body": "The destroy callback is added for you: <a href=\"https://github.com/swanandp/acts_as_list/blob/0440822674685bc29ca119e25f57ae5e9c3724c9/lib/acts_as_list/active_record/acts/callback_definer.rb#L9\" rel=\"nofollow noreferrer\">github.com/swanandp/acts_as_list/blob/&hellip;</a> so no need to do it manually. Per <a href=\"https://github.com/swanandp/acts_as_list/issues/347\" rel=\"nofollow noreferrer\">github.com/swanandp/acts_as_list/issues/347</a> I think the OP has misconfigured something but we need more information."}, {"owner": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "reply_to_user": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "edited": false, "score": 0, "creation_date": 1554715270, "post_id": 55554502, "comment_id": 97839077, "body": "I was wrong in showing column data and I updated the question. At this time I am solving the issue by using the <code>before_destroy { |record| record.remove_from_list }</code> callback inside the model but, since ActsAsList has one itself as @Brendon Muir pointed out, probably I should use it. Maybe I misconfigured something. Let me know if you need further info."}, {"owner": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "edited": false, "score": 0, "creation_date": 1554718813, "post_id": 55554502, "comment_id": 97841078, "body": "UPDATE - I (subtly) misconfigured the <code>:scope</code> option. Now all works without the use of the <code>before_destroy</code> callback. Thanks anyway."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1554736249, "post_id": 55554502, "comment_id": 97851901, "body": "Thanks for taking the time to update as I was about to spend some more time on this :)"}, {"owner": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "reply_to_user": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "edited": false, "score": 0, "creation_date": 1554757198, "post_id": 55554502, "comment_id": 97861677, "body": "@Backo, you should create an answer that shows your solution to the problem and accept that as the answer if this answer isn&#39;t the correct solution."}, {"owner": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "reply_to_user": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "edited": false, "score": 0, "creation_date": 1554851044, "post_id": 55554502, "comment_id": 97900644, "body": "@BrendonMuir The actual answer worked (<i>and still works</i>) for reordering of list items when a list item is destroyed... until I discovered the (subtle) misconfiguration in setting the <code>:scope</code>."}, {"owner": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "reply_to_user": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "edited": false, "score": 0, "creation_date": 1554884477, "post_id": 55554502, "comment_id": 97910387, "body": "@BrendonMuir Maybe Mark could update the answer prepending it with something such as <i>Although it can/should work with the ActsAsList gem core methods, ...</i>."}, {"owner": {"reputation": 4250, "user_id": 129798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5cc165c5b9f18bfb64faddb021c82172?s=128&d=identicon&r=PG", "display_name": "Brendon Muir", "link": "https://stackoverflow.com/users/129798/brendon-muir"}, "reply_to_user": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "edited": false, "score": 0, "creation_date": 1554944230, "post_id": 55554502, "comment_id": 97939297, "body": "@Backo, I think the answer is a bit misleading. It might work in this scenario, but could lead to problems down the track. The real answer is to configure acts_as_list properly."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1554607209, "last_edit_date": 1554607209, "creation_date": 1554595118, "answer_id": 55554502, "question_id": 55553944, "link": "https://stackoverflow.com/questions/55553944/rails-gem-acts-as-list-how-to-handle-reordering-of-list-items-when-a-list-item/55554502#55554502", "title": "Rails gem acts_as_list: How to handle reordering of list items when a list item is destroyed?", "body": "<p>As you say you need to use the method you provided, and you can either do it in your controller or the model itself. If you're the kind of guy who likes callbacks, then:</p>\n\n<pre><code>class ListItem &lt; ActiveRecord::Base\n  acts_as_list scope: [:column1_id, :column2_id], :add_new_at =&gt; :bottom\n  before_destroy { |record| record.remove_from_list }\n\n  ....\nend\n</code></pre>\n\n<p>Some people don't like handling logic like that as a callback, so you can also add it straight into your controller:</p>\n\n<pre><code>class ListItemsController &lt; Wherever\n  ....\n  ....\n\n  def destroy\n    @list_item.remove_from_list\n    @list_item.delete\n\n    ....\n  end\nend\n</code></pre>\n\n<p>Personally I'd add it into the model but they both do the same thing.</p>\n\n<p>If you need to try and fix a list that has a missing record in it, say you have LineItems with an ID and position of 0-4 and 6-9, missing position 5. You can make a dirtyish fix in console with:</p>\n\n<pre><code>LineItem.where('position &gt;= ?', 5).each { |line_item| line_item.update_attributes(position: line_item.position - 1) }\n</code></pre>\n\n<p>This will find all LineItems with a position over 4, and decrement each of them by one, leaving you with a correctly ordered list from 0-8.</p>\n"}], "owner": {"reputation": 16441, "user_id": 824806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2ba601f52c82370f266a1d7f2f0b6ef?s=128&d=identicon&r=PG", "display_name": "Backo", "link": "https://stackoverflow.com/users/824806/backo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "accepted_answer_id": 55554502, "answer_count": 1, "score": 0, "last_activity_date": 1554712193, "creation_date": 1554589141, "last_edit_date": 1554712193, "question_id": 55553944, "link": "https://stackoverflow.com/questions/55553944/rails-gem-acts-as-list-how-to-handle-reordering-of-list-items-when-a-list-item", "title": "Rails gem acts_as_list: How to handle reordering of list items when a list item is destroyed?", "body": "<p>I'm using <a href=\"https://github.com/swanandp/acts_as_list\" rel=\"nofollow noreferrer\">acts_as_list</a> v0.9.17 this way:</p>\n\n<pre><code>class ListItem &lt; ActiveRecord::Base\n  acts_as_list scope: [:column1_id, :column2_id], :add_new_at =&gt; :bottom\nend\n</code></pre>\n\n<p>When a new (scoped) <code>@list_item</code> is created, say the one where <code>column1_id</code> is <code>1</code>, <code>column2_id</code> is <code>11</code> and <code>column3_id</code> is <code>37</code>, the database looks as follows, as expected:</p>\n\n<pre><code>id  | position | column1_id | column2_id | column3_id\n--- | -------- | ---------- | ---------- | ----------\n750 | 1        | 1          | 11         | 89\n751 | 2        | 1          | 11         | 56\n752 | 3        | 1          | 11         | 105\n753 | 4        | 1          | 11         | 25\n754 | 5        | 1          | 11         | 37\n</code></pre>\n\n<p>However, when a <code>@list_item</code> is destroyed, say the one where <code>column1_id</code> is <code>1</code>, <code>column2_id</code> is <code>11</code> and <code>column3_id</code> is <code>56</code> (record id <code>751</code>), then the database looks as follows:</p>\n\n<pre><code>id  | position | column1_id | column2_id | column3_id\n--- | -------- | ---------- | ---------- | ----------\n750 | 1        | 1          | 11         | 89\n752 | 3        | 1          | 11         | 105\n753 | 4        | 1          | 11         | 25\n754 | 5        | 1          | 11         | 37\n</code></pre>\n\n<p>That means there is a gap for <code>position</code> <code>2</code>.</p>\n\n<p>How to prevent or adjust the gap? That is, how to handle reordering of list items when a list item is destroyed?</p>\n\n<hr>\n\n<p>Note: I know there are <a href=\"https://github.com/swanandp/acts_as_list#methods-that-change-position-and-reorder-list\" rel=\"nofollow noreferrer\">methods that change position and reorder list</a> but I don't know whether\nand how to use them to solve the issue (maybe using someway <a href=\"https://github.com/swanandp/acts_as_list/blob/master/lib/acts_as_list/active_record/acts/list.rb#L120\" rel=\"nofollow noreferrer\"><code>remove_from_list</code></a>).</p>\n"}]