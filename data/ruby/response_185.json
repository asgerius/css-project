[{"tags": ["ruby", "ansi-escape"], "comments": [{"owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "edited": false, "score": 0, "creation_date": 1532560726, "post_id": 51527732, "comment_id": 90026234, "body": "Does the <code>script -q ...</code> thing work from the command line if you pipe it into <code>cat</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 0, "creation_date": 1532559125, "post_id": 51528315, "comment_id": 90025917, "body": "Tried both, no luck. :( See update. But I&#39;m probably not calling <code>PTY.spawn()</code> / <code>Process.wait2()</code> correctly."}, {"owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "reply_to_user": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 0, "creation_date": 1532559690, "post_id": 51528315, "comment_id": 90026028, "body": "@DavidMoles Hmm, not sure about the <code>script -q &#47;dev&#47;null ...</code> not working, but let me see if I can figure out what&#39;s wrong with your <code>PTY.spawn()</code>ing."}, {"owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "reply_to_user": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 0, "creation_date": 1532560836, "post_id": 51528315, "comment_id": 90026256, "body": "@DavidMoles I tried running the following: <code>lines = []; PTY.spawn(&quot;ls -G &amp;&amp; sleep 5&quot;) {|reader, writer, pid| reader.each {|line| lines &lt;&lt; line }; Process.wait2(pid) }</code>, and <code>Process.wait2(pid)</code> blocked for the right amount of time, and the output was correct. I don&#39;t really see any difference between what you did and that; can you try running mine on your system so we can see if it&#39;s a difference between <code>ls -G</code> and your command, or if it&#39;s a system issue?"}], "tags": [], "owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1532557462, "last_edit_date": 1532557462, "creation_date": 1532556131, "answer_id": 51528315, "question_id": 51527732, "link": "https://stackoverflow.com/questions/51527732/capture-ansi-colorized-output-with-rubys-open3-process-spawn/51528315#51528315", "title": "Capture ANSI colorized output with Ruby&#39;s Open3 / Process.spawn()", "body": "<p>Have you considered using Ruby's excellent <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/pty/rdoc/PTY.html\" rel=\"nofollow noreferrer\"><code>pty</code></a> library instead of <code>Open3</code>?</p>\n\n<p>Pseudo terminals, per <a href=\"https://stackoverflow.com/a/1401557/1743874\">the thread you linked</a>, seem to emulate an actual TTY, so the script wouldn't know it wasn't in a terminal unless it checked for things like <code>$TERM</code>, but that can also be spoofed with relative ease.</p>\n\n<p>According to <a href=\"https://stackoverflow.com/a/31572431/1743874\">this flowchart</a>, the downside of using <code>pty</code> instead of <code>Open3</code> is that <code>STDERR</code> does not get its own stream. </p>\n\n<hr>\n\n<p>Alternatively, per <a href=\"https://stackoverflow.com/a/13587964/1743874\">this answer</a>, also from the thread you linked, <code>script -q /dev/null $COMMAND</code> appears to do the trick on Mac OS X.</p>\n\n<p>On Macs, <code>ls -G</code> colorizes the output of <code>ls</code>, and as a brief test, I piped <code>ls -G</code> into <code>cat</code> as follows:</p>\n\n<pre><code>script -q /dev/null ls -G | cat\n</code></pre>\n\n<p>and it displayed with colors, whereas simply running</p>\n\n<pre><code>ls -G | cat\n</code></pre>\n\n<p>did not.</p>\n\n<p>This method also worked in <code>irb</code>, again using <code>ls -G</code>:</p>\n\n<pre><code>$ touch regular_file\n$ touch executable_file\n$ mkdir directory\n$ chmod +x executable_file\n$ irb\n2.4.1 :001 &gt; require 'Open3'\n =&gt; true\n2.4.1 :002 &gt; output, status = Open3.capture2e(\"ls -G\")\n =&gt; [\"directory\\nexecutable_file\\nregular_file\\n\", #&lt;Process::Status: pid 39299 exit 0&gt;]\n2.4.1 :003 &gt; output, status = Open3.capture2e(\"script -q /dev/null ls -G\")\n =&gt; [\"^D\\b\\b\\e[1m\\e[36mdirectory\\e[39;49m\\e[0m       \\e[31mexecutable_file\\e[39;49m\\e[0m regular_file\\r\\n\", #&lt;Process::Status: pid 39301 exit 0&gt;]\n2.4.1 :004 &gt;\n</code></pre>\n"}], "owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1532559022, "creation_date": 1532553144, "last_edit_date": 1532559022, "question_id": 51527732, "link": "https://stackoverflow.com/questions/51527732/capture-ansi-colorized-output-with-rubys-open3-process-spawn", "title": "Capture ANSI colorized output with Ruby&#39;s Open3 / Process.spawn()", "body": "<p>I'm using the <code>sass-lint</code> NPM package to style-check <code>.scss</code> files from within a Rake task, thus:</p>\n\n<pre><code>  sass_lint_cmd = \"sass-lint --config #{ui_library_path}/scss/.sass-lint.yml '#{ui_library_path}/scss/*.scss' -v -q --max-warnings=0\"\n  output, status = Open3.capture2e(sass_lint_cmd)\n  raise IOError, output unless status == 0\n</code></pre>\n\n<p>This basically works, insofar as in the event of any linter warnings or errors the Rake task aborts and the <code>sass-lint</code> output, including errors, is dumped to the console.</p>\n\n<p>However, when run directly, <code>sass-lint</code> produces nice colorized output. When captured by <code>capture2e</code>, the colors are lost.</p>\n\n<p>I assume the issue is that <code>sass-lint</code> (or Node) detects it's not running in a TTY, and so outputs plain text. Is there some <code>Process.spawn()</code> option I can pass to <code>Open3.capture2e()</code>, or some other method, by which I can make it think it's running in a TTY?</p>\n\n<p>(Note: I did look at <a href=\"https://stackoverflow.com/questions/1401002/trick-an-application-into-thinking-its-stdout-is-a-terminal-not-a-pipe\">Trick an application into thinking its stdout is a terminal, not a pipe</a>, but the BSD version of <code>script</code> that ships with macOS doesn't seem to support either the <code>--return</code> or the <code>-c</code> options, and I'm running on macOS.)</p>\n\n<hr>\n\n<p><strong>Update:</strong> I tried <code>script -q /dev/null</code> and <code>PTY.spawn()</code> as per <a href=\"https://stackoverflow.com/a/51528315/27358\">Piccolo's answer</a>, but no luck.</p>\n\n<p><code>script -q /dev/null \u2026</code> works from the command line, but doesn't work in <code>Open3.capture2e()</code> (it runs, but produces monochrome output and a spurious <code>Bundler::GemNotFound</code> stack trace).</p>\n\n<p>As for <code>PTY.spawn()</code>, replacing the code above with the following:</p>\n\n<pre><code>r, _w, pid = PTY.spawn(scss_lint_command)\n_, proc_status = Process.wait2(pid)\noutput, status = [r, proc_status.exitstatus]\n(warn(output); raise) unless status == 0\n</code></pre>\n\n<p>the subprocess never seems to complete; if I <code>ps</code> in another terminal it shows as in interruptible sleep status. Killing the subprocess doesn't free up the parent process.</p>\n\n<p>The same happens with the block form.</p>\n\n<pre><code>output, status = nil\nPTY.spawn(scss_lint_command) do |r, _w, pid|\n  _, proc_status = Process.wait2(pid)\n  output, status = [r, proc_status.exitstatus]\nend\n(warn(output); raise) unless status == 0\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 1, "last_activity_date": 1532563812, "creation_date": 1532563812, "answer_id": 51529300, "question_id": 51526606, "link": "https://stackoverflow.com/questions/51526606/error-when-assigning-attributes-you-must-pass-a-hash-as-an-argument/51529300#51529300", "title": "Error- When assigning attributes, you must pass a hash as an argument", "body": "<blockquote>\n  <p><a href=\"https://apidock.com/rails/ActiveRecord/Base/update_attributes\" rel=\"nofollow noreferrer\"><code>update_attributes</code></a> updates all the attributes from the passed-in\n  Hash and saves the record. If the object is invalid, the saving will\n  fail and false will be returned.</p>\n</blockquote>\n\n<p>But at <code>funding.update_attributes(:cheque_cut_date)</code> you put only key <code>:cheque_cut_date</code> without any value. Try next:</p>\n\n<pre><code>funding.update_attributes(funding_params)\n</code></pre>\n\n<p>Also, there is more than one problem. <code>date_field_tag \"funding.cheque_cut_date\"</code> create field with the name <code>funding.cheque_cut_date</code>, but <code>params.require(:funding).permit(:cheque_cut_date)</code> not permit key <code>funding.cheque_cut_date</code>. Change your fields name too:</p>\n\n<pre><code>&lt;td&gt;&lt;%= date_field_tag \"funding[cheque_cut_date]\", funding.cheque_cut_date %&gt;&lt;/td&gt;\n\n#or the same fields helpers type as other from this form\n&lt;td&gt;&lt;%= f.date_field :cheque_cut_date %&gt;&lt;/td&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "is_accepted": false, "score": 0, "last_activity_date": 1532615323, "creation_date": 1532615323, "answer_id": 51541280, "question_id": 51526606, "link": "https://stackoverflow.com/questions/51526606/error-when-assigning-attributes-you-must-pass-a-hash-as-an-argument/51541280#51541280", "title": "Error- When assigning attributes, you must pass a hash as an argument", "body": "<p>form.html.erb</p>\n\n<pre><code>&lt;td&gt;&lt;%= date_field_tag \"cheque_cut_date[#{funding.id}]\", funding.cheque_cut_date, min: Date.today %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>controller.rb</p>\n\n<pre><code>def add_cheque_date\n        fundings = params[:cheque_cut_date]\n        fundings.select do |k, v|\n            if v.present?\n                funding = Funding.find(k)\n                funding.update_attributes({cheque_cut_date: v})\n            end\n        end\n    end\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1977, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1532615323, "creation_date": 1532548009, "last_edit_date": 1532585193, "question_id": 51526606, "link": "https://stackoverflow.com/questions/51526606/error-when-assigning-attributes-you-must-pass-a-hash-as-an-argument", "title": "Error- When assigning attributes, you must pass a hash as an argument", "body": "<p>I have a funding table below is its admin funding show page. I want to add a feature so that the admin can add the cheque cut date directly from this page with a submit button at the end. </p>\n\n<pre><code>&lt;%= form_tag add_cheque_date_path, :method =&gt; 'patch' do %&gt;\n &lt;tbody&gt;\n  &lt;% @fundings.each do |funding| %&gt;\n   &lt;tr&gt; \n    &lt;td&gt;&lt;%= funding.child.parent.parent_1_firstname %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= funding.child.parent.email %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= funding.activity_start_date %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= funding.date_submitted %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= funding.status %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= date_field_tag \"funding.cheque_cut_date\", funding.cheque_cut_date %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to \"View\", parent_child_funding_path(funding.child.parent, funding.child, funding) %&gt;&lt;/td&gt;   \n  &lt;/tr&gt;\n  &lt;% end %&gt;\n  &lt;/tbody&gt;   \n  &lt;/table&gt;\n  &lt;%= submit_tag \"Submit\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>parents_controller.rb</p>\n\n<pre><code>def add_cheque_date\n        @fundings= Funding.all\n        fundings = params[:fundings]\n        @fundings.each do |funding|\n        funding.update_attributes(:cheque_cut_date)\n        end\n    end\n\ndef funding_params\n        params.require(:funding).permit(:cheque_cut_date)\n    end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>patch 'admin/application-status', to: 'parents#add_cheque_date', as: 'add_cheque_date'\n</code></pre>\n\n<p>When I click on submit below is the error i am getting. Kindly help me fix it.</p>\n\n<pre><code>When assigning attributes, you must pass a hash as an argument.\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1532545781, "post_id": 51525999, "comment_id": 90020827, "body": "The docs for <code>gsub!</code> explain what it does."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 1, "creation_date": 1532546184, "post_id": 51525999, "comment_id": 90021004, "body": "It is passed by value, but internally reference the same object, which is altered with <code>gsub!</code>, changing both. Ruby&#39;s value/reference passing isn&#39;t as &quot;clear&quot; as in some other languages. Hopefully <a href=\"https://stackoverflow.com/questions/19889245/ruby-pass-by-value-clarification?rq=1\">this answer</a> can help clarify for you."}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1532546299, "post_id": 51525999, "comment_id": 90021055, "body": "Okay, thanks. Should I delete the question?"}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1532547159, "post_id": 51526239, "comment_id": 90021402, "body": "No, Ruby is pass by value, full stop. However, those values are references and some objects (such as strings) provide methods (such as <code>#gsub!</code>) that make the objects mutable, other objects (such as numbers and symbols) don&#39;t provide such methods."}, {"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1532547280, "post_id": 51526239, "comment_id": 90021452, "body": "That was what I was trying to say. My clumsy."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1532547492, "post_id": 51526239, "comment_id": 90021541, "body": "Fair enough, the terminology is rather cumbersome."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1532549835, "post_id": 51526239, "comment_id": 90022561, "body": "The examples could be slightly better here. By writing it as <code>b = b &lt;&lt; &quot;def&quot;</code> it makes it <i>seem</i> like it&#39;s necessary to assign back to the variable in order for <code>b</code> to have the new value. The point is that <code>&lt;&lt;</code> modifies the original string and so I think <code>b &lt;&lt; &quot;def&quot;</code>with no assignment makes the point more clearly."}, {"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 1, "creation_date": 1532551902, "post_id": 51526239, "comment_id": 90023510, "body": "Very true. It did not occur to me at the time. I have updated my reply."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1532568618, "post_id": 51526239, "comment_id": 90027691, "body": "@muistooshort: The terminology is clumsy because it was developed for ALGOL, and &quot;pass by reference&quot; is used by very few languages nowadays (C++ being a notable one). IMO, best to avoid stuffing oval objects in round holes, and use &quot;pass by sharing&quot; (with a completely new term), or &quot;pass by reference value&quot;, which more correctly describes the behaviour of many modern programming languages, to avoid the pitfall of conflating true pass by value where objects are cloned (like what PHP does by default) from this. <a href=\"https://en.wikipedia.org/wiki/Evaluation_strategy\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Evaluation_strategy</a>"}], "tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": true, "score": 0, "last_activity_date": 1532551978, "last_edit_date": 1532551978, "creation_date": 1532546519, "answer_id": 51526239, "question_id": 51525999, "link": "https://stackoverflow.com/questions/51525999/why-is-ruby-acting-like-passing-by-reference-when-using-gsub-function-in-ruby/51526239#51526239", "title": "Why is ruby acting like passing by reference when using gsub function in Ruby?", "body": "<p>In Ruby: Objects like strings are passed by reference. Variables with objects like strings are in fact references to those strings. Parameters are passed by value. However, for strings, these are references to those strings.</p>\n\n<p>So here is the classic example:</p>\n\n<pre><code>irb(main):004:0* a = \"abcd\"\n=&gt; \"abcd\"\nirb(main):005:0&gt; b = a\n=&gt; \"abcd\"\nirb(main):006:0&gt; b &lt;&lt; \"def\"\n=&gt; \"abcddef\"\nirb(main):007:0&gt; a\n=&gt; \"abcddef\"\nirb(main):008:0&gt; b\n=&gt; \"abcddef\"\n</code></pre>\n\n<p>If you do not wish to modify the original string, you need to make a copy of it:</p>\n\n<p>Three ways (of many) to do this are:</p>\n\n<pre><code>b = a.dup\nb = a.clone\nb = String.new a\n</code></pre>\n\n<p>Using dup</p>\n\n<pre><code>irb(main):009:0&gt; a = \"abcd\"\n=&gt; \"abcd\"\nirb(main):010:0&gt; b = a.dup\n=&gt; \"abcd\"\nirb(main):011:0&gt; b &lt;&lt; \"def\"\n=&gt; \"abcddef\"\nirb(main):012:0&gt; a\n=&gt; \"abcd\"\nirb(main):013:0&gt; b\n=&gt; \"abcddef\"\n</code></pre>\n\n<p>BTW: For myself, this effect is the number one cause of defects in my own code.</p>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1532547217, "accepted_answer_id": 51526239, "answer_count": 1, "score": 0, "last_activity_date": 1532551978, "creation_date": 1532545482, "question_id": 51525999, "link": "https://stackoverflow.com/questions/51525999/why-is-ruby-acting-like-passing-by-reference-when-using-gsub-function-in-ruby", "closed_reason": "Duplicate", "title": "Why is ruby acting like passing by reference when using gsub function in Ruby?", "body": "<p>Given the following two methods:</p>\n\n<pre><code>    [53] pry(main)&gt; def my_method\n    [53] pry(main)*   leti = 'leti'\n    [53] pry(main)*   edit(leti)\n    [53] pry(main)*   leti \n    [53] pry(main)* end  \n    =&gt; :my_method\n    [54] pry(main)&gt; def edit(a_leti)\n    [54] pry(main)*   a_leti.gsub!('e', '3')\n    [54] pry(main)*   a_leti\n    [54] pry(main)* end  \n    =&gt; :edit\n    [55] pry(main)&gt; my_method\n    =&gt; \"l3ti\"\n</code></pre>\n\n<p>Can someone explain why I am getting the value edited inside the <code>edit</code> method and not the original value ('leti'). I though Ruby was passed by value. In fact, if instead of using the function <code>gsub</code> I use a simple assignment, I get the original value. Does the <code>gsub!</code> make it by reference?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["mysql", "ruby"], "comments": [{"owner": {"reputation": 21, "user_id": 8679422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k3qRiQeUHq8/AAAAAAAAAAI/AAAAAAAAAjI/9N21YXsrUO0/photo.jpg?sz=128", "display_name": "KTH", "link": "https://stackoverflow.com/users/8679422/kth"}, "edited": false, "score": 0, "creation_date": 1532545580, "post_id": 51525981, "comment_id": 90020744, "body": "Diff column is set as int already"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 2, "creation_date": 1532546643, "post_id": 51525981, "comment_id": 90021194, "body": "That&#39;s your resultset, it seems perfectly okay. I wanted to help you but it&#39;s not clear to me what you want to achieve."}, {"owner": {"reputation": 21, "user_id": 8679422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k3qRiQeUHq8/AAAAAAAAAAI/AAAAAAAAAjI/9N21YXsrUO0/photo.jpg?sz=128", "display_name": "KTH", "link": "https://stackoverflow.com/users/8679422/kth"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1532547565, "post_id": 51525981, "comment_id": 90021578, "body": "@Ursus I want to update the existing &quot;Diff&quot; value by adding this to it.  &#39;time_change = ((Time.parse(row[&#39;CheckOutDateTime&#39;].to_s) - Time.parse(row[&#39;CheckInDateTime&#39;].to_s)) / 60).round&#39;  So row 1&#39;s &quot;Diff&quot; will add it&#39;s original value to time_change"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8679422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k3qRiQeUHq8/AAAAAAAAAAI/AAAAAAAAAjI/9N21YXsrUO0/photo.jpg?sz=128", "display_name": "KTH", "link": "https://stackoverflow.com/users/8679422/kth"}, "edited": false, "score": 0, "creation_date": 1532547844, "post_id": 51526355, "comment_id": 90021678, "body": "how would you assign <code>Diff</code> into a variable?"}, {"owner": {"reputation": 6948, "user_id": 2408342, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/f4a7N.jpg?s=128&g=1", "display_name": "Roshana Pitigala", "link": "https://stackoverflow.com/users/2408342/roshana-pitigala"}, "reply_to_user": {"reputation": 21, "user_id": 8679422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k3qRiQeUHq8/AAAAAAAAAAI/AAAAAAAAAjI/9N21YXsrUO0/photo.jpg?sz=128", "display_name": "KTH", "link": "https://stackoverflow.com/users/8679422/kth"}, "edited": false, "score": 0, "creation_date": 1532548767, "post_id": 51526355, "comment_id": 90022093, "body": "Yeah, sry about that"}], "tags": [], "owner": {"reputation": 6948, "user_id": 2408342, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/f4a7N.jpg?s=128&g=1", "display_name": "Roshana Pitigala", "link": "https://stackoverflow.com/users/2408342/roshana-pitigala"}, "is_accepted": false, "score": 0, "last_activity_date": 1532548744, "last_edit_date": 1532548744, "creation_date": 1532546959, "answer_id": 51526355, "question_id": 51525981, "link": "https://stackoverflow.com/questions/51525981/pulling-an-integer-value-from-sql-database-to-be-used-for-calculation/51526355#51526355", "title": "Pulling an Integer value from SQL database to be used for calculation", "body": "<p>I have no knowledge of <a href=\"/questions/tagged/ruby\" class=\"post-tag\" title=\"show questions tagged &#39;ruby&#39;\" rel=\"tag\">ruby</a> but I'll show you the steps to achieve what you are trying based on <a href=\"https://stackoverflow.com/a/5510419/2408342\">this</a> and <a href=\"https://stackoverflow.com/a/10836967/2408342\">this</a>.</p>\n\n<ol>\n<li><p>Get User <code>Id</code>s and the <code>Diff</code> numbers.</p>\n\n<pre><code>SELECT `Id`, `Diff` FROM users where `Status`='CheckOut'\n</code></pre></li>\n<li><p>Iterate the <code>result</code>.</p>\n\n<pre><code>result.each do |row|\n</code></pre></li>\n<li><p>Assign <code>Diff</code> and <code>Id</code> into variables.</p>\n\n<pre><code>usrId = #{row['Id']};\ndiffCal = #{row['Diff']};\n</code></pre></li>\n<li><p>Do your calculations to <code>diffCal</code> variable.</p></li>\n<li><p>Execute the <code>UPDATE</code> query.</p>\n\n<pre><code>UPDATE `users` SET `Diff` = '#{diffCal}' WHERE `Id` = '#{usrId}'\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 8679422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k3qRiQeUHq8/AAAAAAAAAAI/AAAAAAAAAjI/9N21YXsrUO0/photo.jpg?sz=128", "display_name": "KTH", "link": "https://stackoverflow.com/users/8679422/kth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1532548866, "creation_date": 1532545413, "last_edit_date": 1532548866, "question_id": 51525981, "link": "https://stackoverflow.com/questions/51525981/pulling-an-integer-value-from-sql-database-to-be-used-for-calculation", "title": "Pulling an Integer value from SQL database to be used for calculation", "body": "<p>I am having trouble just trying to pull data out of my table. I just want to pull the integer value from column <code>Diff</code> and add/subtract numbers to it.</p>\n\n<p>Once I am done adding/subtracting, I want to update each row with the new value\"</p>\n\n<p>My Table chart for \"users\" in ruby</p>\n\n<p><a href=\"https://i.stack.imgur.com/5uKdh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5uKdh.jpg\" alt=\"My Table chart for &quot;users&quot; in ruby\"></a></p>\n\n<p>This is my code as of now</p>\n\n<pre><code>require 'date'\nrequire 'mysql2'\nrequire 'time' \n\ndef test()\n  connect = Mysql2::Client.new(:host =&gt; \"localhost\", :username =&gt; \"root\", :database =&gt; \"rubydb\")\n  result = connect.query(\"SELECT * FROM users where Status='CheckOut'\")\n  if result.count &gt; 0\n    result.each do |row|\n    stored_diff = connect.query(\"SELECT * FROM users WHERE Diff\")\n    #stored_diff = stored_diff.to_s  \n    puts stored_diff\n    end\n  end\nend\n\ntest()\n</code></pre>\n\n<p>I am sure the code in the hashtag  does not work since I am getting like <code>#Mysql2::Result:0x000000000004863248</code> etc. Can anyone help me with this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "timezone"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1532544909, "post_id": 51525777, "comment_id": 90020435, "body": "<i>Sidenote:</i> there is no <code>in_time_zone</code> method defined on any date/time class in Ruby."}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532545120, "post_id": 51525777, "comment_id": 90020520, "body": "I have updated my question. The date is ActiveSupport::TimeWithZone class"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532545441, "post_id": 51525777, "comment_id": 90020675, "body": "You should probably update tags, There is no such class <code>ActiveSupport::TimeWithZone</code> in <a href=\"https://stackoverflow.com/questions/tagged/ruby\">ruby</a>."}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532545646, "post_id": 51525777, "comment_id": 90020767, "body": "Right. Done that now."}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "edited": false, "score": 0, "creation_date": 1532546110, "post_id": 51525777, "comment_id": 90020982, "body": "What&#39;s your operating system?"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532546412, "post_id": 51525777, "comment_id": 90021102, "body": "Well, it&#39;s OS X. Note: it should work on Circle Ci servers so it should be platform independent."}], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": true, "score": 2, "last_activity_date": 1532550690, "creation_date": 1532550690, "answer_id": 51527206, "question_id": 51525777, "link": "https://stackoverflow.com/questions/51525777/strftimez-returns-wrong-result/51527206#51527206", "title": "strftime(%Z) returns wrong result", "body": "<p>Sadly, it seems there is no 'FJT' abbreviation assigned to 'Fiji' in timezone data used by Rails. Also, support for those abbreviations seems patchy regarding Pacific timezones.</p>\n\n<pre><code>irb(main):002:0&gt; DateTime.now.in_time_zone('Samoa').strftime('%Z')\n=&gt; \"+13\"\nirb(main):003:0&gt; DateTime.now.in_time_zone('Midway Island').strftime('%Z')\n=&gt; \"SST\"\nirb(main):004:0&gt; DateTime.now.in_time_zone('Samoa').strftime('%Z')\n=&gt; \"+13\"\nirb(main):005:0&gt; DateTime.now.in_time_zone('Tokelau Is.').strftime('%Z')\n=&gt; \"+13\"\nirb(main):006:0&gt; DateTime.now.in_time_zone('Wellington').strftime('%Z')\n=&gt; \"NZST\"\n</code></pre>\n\n<p>UTC offset is displayed as fallback. If it's any help, remember that full name and additional information can be retrieved with <code>.time_zone.tzinfo</code> on <code>ActiveSupport::TimeWithZone</code> objects. 'FJ' code is recognized by <a href=\"https://www.rubydoc.info/gems/tzinfo/TZInfo/Country\" rel=\"nofollow noreferrer\"><code>TZInfo::Country</code></a>.</p>\n\n<pre><code>irb(main):056:0&gt; TZInfo::Country.get('FJ')\n=&gt; #&lt;TZInfo::Country: FJ&gt;\nirb(main):057:0&gt; TZInfo::Country.get('FJ').zone_info\n=&gt; [#&lt;TZInfo::CountryTimezone: Pacific/Fiji&gt;]\n</code></pre>\n"}], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 51527206, "answer_count": 1, "score": 1, "last_activity_date": 1532588579, "creation_date": 1532544470, "last_edit_date": 1532588579, "question_id": 51525777, "link": "https://stackoverflow.com/questions/51525777/strftimez-returns-wrong-result", "title": "strftime(%Z) returns wrong result", "body": "<p>I have this date</p>\n\n<pre><code>date = Mon, 15 Aug 2016 13:00:00 UTC +00:00\n</code></pre>\n\n<p>which is <code>ActiveSupport::TimeWithZone</code> class</p>\n\n<p>Then, I need to get the time in time zone \"Fiji\"</p>\n\n<pre><code>start_in_time_zone = date.in_time_zone(\"Fiji\")\n</code></pre>\n\n<p>This returns <code>Tue, 16 Aug 2016 01:00:00 +12 +12:00</code></p>\n\n<p>Then, I need to present the date with the name of the time zone, so</p>\n\n<pre><code>time_zone_abbr = start_in_time_zone.strftime(\"%Z\")\n</code></pre>\n\n<p>It should return <code>\"FJT\"</code></p>\n\n<p>but returns <code>\"+12\"</code></p>\n\n<p>Any idea why?</p>\n\n<p>I am using <code>ruby 2.3.7</code> and <code>rails 4.2.7</code></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>If I do</p>\n\n<pre><code>start_in_time_zone = date.in_time_zone(\"Madrid\")\n</code></pre>\n\n<p>it returns</p>\n\n<pre><code>\"CEST\"\n</code></pre>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>I have tried to see where the problem is by setting different time.</p>\n\n<pre><code>date=Time.utc(2018, 07, 25, 20, 30, 45)\ndate.class #=&gt; Time\ndate.in_time_zone(\"Madrid\") #=&gt; Wed, 25 Jul 2018 22:30:45 CEST +02:00\ndate.in_time_zone(\"Fiji\") #=&gt; Thu, 26 Jul 2018 08:30:45 +12 +12:00\ndate.in_time_zone(\"EST\") #=&gt; Wed, 25 Jul 2018 15:30:45 EST -05:00\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "puppet"], "comments": [{"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "edited": false, "score": 0, "creation_date": 1532745014, "post_id": 51525536, "comment_id": 90101536, "body": "@supremebeing7&#39;s answer is on the right track, and to answer this properly I would need to see exactly how $globals is really being set."}], "answers": [{"tags": [], "owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "is_accepted": false, "score": 2, "last_activity_date": 1532574741, "creation_date": 1532574741, "answer_id": 51530459, "question_id": 51525536, "link": "https://stackoverflow.com/questions/51525536/cannot-get-rspec-to-test-both-parts-of-an-if-else-puppet-statement/51530459#51530459", "title": "Cannot get rspec to test both parts of an if else puppet statement", "body": "<p><code>let(:status)</code> in your rspec code is just setting a local variable <code>status</code>, it is not setting the global <code>$status</code>. What's more, your puppet code is setting that <code>$status</code> global at the top of the file, so even if you could set it in your rspec code, it would be overwritten.</p>\n\n<p>You say <code>$globals</code> is getting it's values from hiera. I've never used that before, but if you're using <code>rspec-puppet</code> gem, it looks like you can <a href=\"https://github.com/rodjek/rspec-puppet#hiera-integration\" rel=\"nofollow noreferrer\">define the path to your hiera yaml file</a>. So you could then possibly overwrite the value after that, or have separate hiera yaml files for each test.</p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 2896289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8619d931b5ca3bfef5aa2a9e90cafdaf?s=128&d=identicon&r=PG&f=1", "display_name": "user2896289", "link": "https://stackoverflow.com/users/2896289/user2896289"}, "is_accepted": false, "score": 0, "last_activity_date": 1533219048, "creation_date": 1533219048, "answer_id": 51655743, "question_id": 51525536, "link": "https://stackoverflow.com/questions/51525536/cannot-get-rspec-to-test-both-parts-of-an-if-else-puppet-statement/51655743#51655743", "title": "Cannot get rspec to test both parts of an if else puppet statement", "body": "<p>Many thanks to @supremebeing7 for setting me on the right path.  I created a second hiera yaml file which contained alternate values for which I wanted to test in my rspec code.  I added the following code to the section in my rspec file where I needed to test with the alternate value:</p>\n\n<pre><code>context 'If the globals yum status = off' do\n  let(:hiera_config) { \n    'spec/fixtures/alt_hiera/hiera.yaml' }\n    hiera = Hiera.new({ :config =&gt; \n    'spec/fixtures/alt_hiera/hiera.yaml' })\n    globals = hiera.lookup('globals', nil, nil)\n</code></pre>\n\n<p>This alternate hiera file had the value of \"off\" set for $globals['yum']['status'] and my test passed.</p>\n"}], "owner": {"reputation": 27, "user_id": 2896289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8619d931b5ca3bfef5aa2a9e90cafdaf?s=128&d=identicon&r=PG&f=1", "display_name": "user2896289", "link": "https://stackoverflow.com/users/2896289/user2896289"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533219048, "creation_date": 1532543432, "last_edit_date": 1532585026, "question_id": 51525536, "link": "https://stackoverflow.com/questions/51525536/cannot-get-rspec-to-test-both-parts-of-an-if-else-puppet-statement", "title": "Cannot get rspec to test both parts of an if else puppet statement", "body": "<p>I am writing unit tests for our puppet code (puppet 3.8). I have a variable set by data in hiera. For example, I have this code in puppet:</p>\n\n<pre><code># globals value coming from hiera\n$status = $globals['yum']['status']\nif $status =~ /on/ {\n  service { 'yum-cron':\n    ensure     =&gt; 'running',\n    enable     =&gt; true,\n    hasrestart =&gt; true,\n    require    =&gt; [ Package['yum-cron'], File['/var/lock/subsys/'] ]\n  }\n} else {\n  service { 'yum-cron':\n    ensure     =&gt; 'stopped',\n    enable     =&gt; false,\n    hasrestart =&gt; true,\n    require    =&gt; Package['yum-cron'],\n  }\n  file {'/var/lock/subsys/yum-cron':\n    ensure  =&gt; 'absent',\n    require =&gt; Package['yum-cron'],\n  }\n}\n</code></pre>\n\n<p>In my rspec test file, I have the following code to test both the parts of the <code>if</code>/<code>else</code>:</p>\n\n<pre><code>context 'If the globals yum status = on' do\n  it 'The service resource yum-cron should exist' do\n    is_expected.to contain_service('yum-cron').with(\n      ensure: 'running',\n      enable:  true,\n      hasrestart: true,\n      require: ['Package[yum-cron]', 'File[/var/lock/subsys/]' ]\n    )\n  end\nend\n\ncontext 'If the globals yum status = off' do\n  let(:status) {'off'}\n  it 'The service resource yum-cron should NOT exist' do\n    is_expected.to contain_service('yum-cron').with(\n      ensure: 'stopped',\n      enable:  false,\n      hasrestart: true,\n      require: 'Package[yum-cron]'\n    )\n  end\nend\n</code></pre>\n\n<p>No matter what I do in my <code>xxx_setup.rb</code> file to test both parts of the <code>if</code>/<code>else</code> statement, only the part that matches the value coming from hiera tests successfully. Because the value from hiera sets the value of <code>$status</code> to <code>\"on\"</code>, that section evaluates successfully in the rspec test code. But the section where I try to test for the value of <code>$status</code> to be <code>\"off\"</code> fails no matter how I try to set the value of the status variable in rspec. When the puppet catalog is generated, it seems to generate only the section that matches what is in hiera and not what I set the <code>$status</code> variable to in rspec.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "dropzone.js"], "comments": [{"owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532540452, "post_id": 51524206, "comment_id": 90018358, "body": "Added server logs, @JagdeepSingh"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532542752, "post_id": 51524206, "comment_id": 90019503, "body": "This might be worth checking: <a href=\"https://stackoverflow.com/questions/2335985/rails-format-js-or-format-json-or-both\" title=\"rails format js or format json or both\">stackoverflow.com/questions/2335985/&hellip;</a>"}, {"owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532543865, "post_id": 51524206, "comment_id": 90019977, "body": "I need to execute <code>create.js.erb</code> file after an object is created, so <code>format.json</code> does not suit me..."}], "answers": [{"comments": [{"owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "edited": false, "score": 0, "creation_date": 1532540621, "post_id": 51524833, "comment_id": 90018438, "body": "What do you mean? I have <code>format.js</code> in <code>respond_to</code> block"}], "tags": [], "owner": {"reputation": 21, "user_id": 5906904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-r_Y4EHv26wA/AAAAAAAAAAI/AAAAAAAAAP8/gNPX_z414Kc/photo.jpg?sz=128", "display_name": "Demon", "link": "https://stackoverflow.com/users/5906904/demon"}, "is_accepted": false, "score": 0, "last_activity_date": 1532540528, "creation_date": 1532540528, "answer_id": 51524833, "question_id": 51524206, "link": "https://stackoverflow.com/questions/51524206/actioncontrollerunknownformat-actioncontrollerunknownformat-in-create-acti/51524833#51524833", "title": "ActionController::UnknownFormat (ActionController::UnknownFormat) in create action with format.js", "body": "<p>You are using <code>respond_to</code> but you are not specifying the format. <a href=\"https://stackoverflow.com/questions/22943892/actioncontrollerunknownformat\">ActionController::UnknownFormat</a></p>\n"}, {"tags": [], "owner": {"reputation": 691, "user_id": 2144199, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/c42ZL.jpg?s=128&g=1", "display_name": "larz", "link": "https://stackoverflow.com/users/2144199/larz"}, "is_accepted": false, "score": 1, "last_activity_date": 1582280827, "creation_date": 1582280827, "answer_id": 60336646, "question_id": 51524206, "link": "https://stackoverflow.com/questions/51524206/actioncontrollerunknownformat-actioncontrollerunknownformat-in-create-acti/60336646#60336646", "title": "ActionController::UnknownFormat (ActionController::UnknownFormat) in create action with format.js", "body": "<p>The request format from <code>dropzone</code> is <code>json</code> so you need to add:</p>\n\n<p><code>format.json { head :ok }</code></p>\n\n<p>to your <code>respond_to</code> block.</p>\n"}], "owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1582280827, "creation_date": 1532537997, "last_edit_date": 1532540430, "question_id": 51524206, "link": "https://stackoverflow.com/questions/51524206/actioncontrollerunknownformat-actioncontrollerunknownformat-in-create-acti", "title": "ActionController::UnknownFormat (ActionController::UnknownFormat) in create action with format.js", "body": "<p>I have a form, that creates images with a <code>dropzone</code>:</p>\n\n<pre><code>&lt;%= form_tag \"/admin/products/#{@product.slug}/product_images\",\n                   method: :post,\n                   class: 'dropzone needsclick dz-clickable',\n                   id: 'form_dropzone',\n                   remote: true do %&gt;\n        &lt;input name=\"authenticity_token\" type=\"hidden\" value=\"&lt;%= form_authenticity_token %&gt;\" /&gt;\n        &lt;div class=\"fallback\"&gt;\n          &lt;%= file_field_tag 'media', multiple: true %&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n</code></pre>\n\n<p>and a correspondent controller action:</p>\n\n<pre><code> def create\n    @product = @current_domain.products.find(params[:product_id])\n    @product_image = ProductImage.create(file_name: params[:file],\n                                         product_id: @product.id)\n\n    respond_to do |format|\n      format.js { render 'create.js', content_type: 'text/javascript', layout: 'admin' }\n    end\n  end\n</code></pre>\n\n<p><code>ProductImage</code> is created, but I receive an error: <code>ActionController::UnknownFormat (ActionController::UnknownFormat)</code></p>\n\n<p>Here is my <code>create.js.erb</code> file:</p>\n\n<pre><code>alert('Done'); // This is for test\n</code></pre>\n\n<p>What is the reason for the given error above? Thanks.</p>\n\n<p><strong>EDIT</strong> Server logs:</p>\n\n<pre><code>Started POST \"/admin/products/a-test-t-shirt/product_images\" for 127.0.0.1 at 2018-07-25 20:23:25 +0300\nProcessing by Admin::ProductImagesController#create as JSON\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"FaIiJclyTvEZaYIx157PDGCpSnVO4Xg7n59CLSCi/IfxME84I/EML0Ej5FGmVRfIlNsmaXzJ5prurCkPVN3Zyg==\", \"file\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x00007fe607430950 @tempfile=#&lt;Tempfile:/tmp/RackMultipart20180725-7417-19ua3ie.png&gt;, @original_filename=\"\u0421\u043d\u0438\u043c\u043e\u043a \u044d\u043a\u0440\u0430\u043d\u0430 \u043e\u0442 2018-03-20 21-15-02.png\", @content_type=\"image/png\", @headers=\"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"\\xD0\\xA1\\xD0\\xBD\\xD0\\xB8\\xD0\\xBC\\xD0\\xBE\\xD0\\xBA \\xD1\\x8D\\xD0\\xBA\\xD1\\x80\\xD0\\xB0\\xD0\\xBD\\xD0\\xB0 \\xD0\\xBE\\xD1\\x82 2018-03-20 21-15-02.png\\\"\\r\\nContent-Type: image/png\\r\\n\"&gt;, \"product_id\"=&gt;\"a-test-t-shirt\"}\n  Domain Load (11.1ms)  SELECT  \"domains\".* FROM \"domains\" WHERE \"domains\".\"name\" = $1 LIMIT $2  [[\"name\", \"localhost:3000\"], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/application_controller.rb:26\n  Domain Load (0.9ms)  SELECT  \"domains\".* FROM \"domains\" WHERE \"domains\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/admin/admin_controller.rb:29\n  User Load (3.3ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/admin/admin_controller.rb:17\n  Product Load (1.4ms)  SELECT  \"products\".* FROM \"products\" WHERE \"products\".\"domain_id\" = $1 AND \"products\".\"slug\" = $2 LIMIT $3  [[\"domain_id\", 1], [\"slug\", \"a-test-t-shirt\"], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/admin/product_images_controller.rb:9\n   (0.3ms)  BEGIN\n  \u21b3 app/controllers/admin/product_images_controller.rb:10\n  Product Load (0.6ms)  SELECT  \"products\".* FROM \"products\" WHERE \"products\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/admin/product_images_controller.rb:10\n  ProductImage Create (4.6ms)  INSERT INTO \"product_images\" (\"file_name\", \"product_id\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4) RETURNING \"id\"  [[\"file_name\", \"\u0421\u043d\u0438\u043c\u043e\u043a_\u044d\u043a\u0440\u0430\u043d\u0430_\u043e\u0442_2018-03-20_21-15-02.png\"], [\"product_id\", 1], [\"created_at\", \"2018-07-25 17:23:25.714816\"], [\"updated_at\", \"2018-07-25 17:23:25.714816\"]]\n  \u21b3 app/controllers/admin/product_images_controller.rb:10\n   (15.2ms)  COMMIT\n  \u21b3 app/controllers/admin/product_images_controller.rb:10\nCompleted 406 Not Acceptable in 391ms (ActiveRecord: 37.7ms)\n\n\n\nActionController::UnknownFormat (ActionController::UnknownFormat):\n\napp/controllers/admin/product_images_controller.rb:13:in `create'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8029, "user_id": 4157589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2TGtf.jpg?s=128&g=1", "display_name": "valdeci", "link": "https://stackoverflow.com/users/4157589/valdeci"}, "edited": false, "score": 0, "creation_date": 1532538493, "post_id": 51523873, "comment_id": 90017364, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3450641/removing-all-empty-elements-from-a-hash-yaml\">Removing all empty elements from a hash / YAML?</a>"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1532540177, "post_id": 51523873, "comment_id": 90018212, "body": "Even though @tadman has provided a pretty nice solution, please consider adding your attempts to solve your problem whenever asking a question."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 8029, "user_id": 4157589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2TGtf.jpg?s=128&g=1", "display_name": "valdeci", "link": "https://stackoverflow.com/users/4157589/valdeci"}, "edited": false, "score": 0, "creation_date": 1532540178, "post_id": 51523873, "comment_id": 90018213, "body": "@coderade That&#39;s not a duplicate."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532540325, "post_id": 51523873, "comment_id": 90018289, "body": "@RutvikOnline Your question is <code>ruby</code> only. You can remove <code>ruby-on-rails</code> tag."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532540571, "post_id": 51523873, "comment_id": 90018412, "body": "Can you clarify what you mean by <i>&quot;I want to preserve one of them&quot;</i>? Do you mean &quot;the first one&quot;? Or &quot;a specific one&quot;? Or something else?"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1532541334, "post_id": 51523873, "comment_id": 90018821, "body": "@JagdeepSingh There is no reason to assume this is &quot;ruby only&quot;. If this is for a Rails app, there are thousands of Rails-specific extensions to Ruby that may be relevant. The answer to many Ruby-only questions might be quite long, but if the <code>ruby-on-rails</code> tag is included, the answers may be single line method invocations because of some extension Rails provides."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 1, "creation_date": 1532541722, "post_id": 51523873, "comment_id": 90019009, "body": "<i>&quot;The answer to many Ruby-only questions might be quite long&quot;</i> - @meagar i agree to this. But for this particular question, it can be solved in one line with ruby only. At least with the current question description, it is possible."}], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1532537024, "post_id": 51523915, "comment_id": 90016612, "body": "He says he wants to preserve one of them, yours would delete every value which has the nil value."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1532537053, "post_id": 51523915, "comment_id": 90016628, "body": "@Rajagopalan Added clarification for that."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 3, "creation_date": 1532537176, "post_id": 51523915, "comment_id": 90016683, "body": "Something like <code>h.delete_if{|k,v| k != &quot;c&quot; &amp;&amp; v.nil?}</code>, perhaps?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1532541262, "post_id": 51523915, "comment_id": 90018782, "body": "<code>Hash#delete_if</code> is the same as <code>Hash#reject!</code>. Depending on requirements, <code>Hash#reject</code>, which does not mutate the hash, may be a better choice."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1532537310, "last_edit_date": 1532537310, "creation_date": 1532536980, "answer_id": 51523915, "question_id": 51523873, "link": "https://stackoverflow.com/questions/51523873/how-do-i-remove-specific-nil-values-from-a-ruby-hash/51523915#51523915", "title": "How do I remove specific &#39;nil&#39; values from a ruby hash?", "body": "<p>There's a <a href=\"https://docs.ruby-lang.org/en/2.5.0/Hash.html#method-i-delete_if\" rel=\"nofollow noreferrer\">method</a> for that:</p>\n\n<pre><code>h.delete_if { |k,v| v.nil? }\n</code></pre>\n\n<p>Where <code>k,v</code> represents the key/value pair.</p>\n\n<p>If you can quantify why you want the <code>c</code> key preserved you can incorporate that in the logic. Is it just the first <code>nil</code> that's saved?</p>\n\n<p>If that's the case, you can try this:</p>\n\n<pre><code>count = 0\nh.delete_if { |k,v| v.nil? &amp;&amp; (count += 1) != 1 }\n</code></pre>\n\n<p>Note that Ruby is a case sensitive language and <code>H</code> is a constant by virtue of being a capital letter. For variables use lower-case only.</p>\n\n<p>Additionally, the traditional way to declare a Ruby hash is:</p>\n\n<pre><code>h = { \"a\" =&gt; 100, \"b\" =&gt; 200, \"c\" =&gt; nil, \"d\" =&gt; nil }\n</code></pre>\n\n<p>Where that's only if you want string keys. With Symbol keys it's even more concise:</p>\n\n<pre><code>h = { a: 100, b: 200, c: nil, d: nil }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532542514, "post_id": 51525239, "comment_id": 90019397, "body": "This gives <code>NoMethodError (undefined method &#39;[]=&#39; for nil:NilClass)</code> with <code>{&quot;a&quot;=&gt;100, &quot;b&quot;=&gt;200, &quot;c&quot;=&gt;300}</code> as <code>compact!</code> returns <code>nil</code> if there is no change in original hash."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532542833, "post_id": 51525239, "comment_id": 90019534, "body": "Good point @JagdeepSingh! I meant, if you already know that some values are <code>nil</code> and want to preserve one of those key. This is how I interpreted the question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532552734, "post_id": 51525239, "comment_id": 90023879, "body": "Yes, <code>h[&quot;c&quot;]</code> will return <code>nil</code>, but so will <code>h[&quot;d&quot;]</code> and any other key not in the hash, which is why one needs to use <code>h.key?(&quot;c&quot;)</code> when values can be <code>nil</code> (a good practice generally)."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1532542210, "creation_date": 1532542210, "answer_id": 51525239, "question_id": 51523873, "link": "https://stackoverflow.com/questions/51523873/how-do-i-remove-specific-nil-values-from-a-ruby-hash/51525239#51525239", "title": "How do I remove specific &#39;nil&#39; values from a ruby hash?", "body": "<p>If I get the point, once you know that a specific key must be <code>nil</code>, for example <code>\"c\"</code> you could do something like:</p>\n\n<pre><code>h = {\"a\"=&gt;100, \"b\"=&gt;200, \"c\"=&gt;nil, \"d\"=&gt;nil}\nh.compact![\"c\"] = nil\n\n# =&gt; {\"a\"=&gt;100, \"b\"=&gt;200, \"c\"=&gt;nil}\n</code></pre>\n\n<p>Now, if you call <code>h[\"c\"]</code> you get <code>nil</code>.</p>\n\n<p>Consider also that when you simply do <code>h.compact!</code> and call <code>h[\"c\"]</code> you get <code>nil</code> anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1532552806, "creation_date": 1532552806, "answer_id": 51527655, "question_id": 51523873, "link": "https://stackoverflow.com/questions/51523873/how-do-i-remove-specific-nil-values-from-a-ruby-hash/51527655#51527655", "title": "How do I remove specific &#39;nil&#39; values from a ruby hash?", "body": "<pre><code>h = Hash[\"a\" =&gt; 100, \"b\" =&gt; 200, \"c\" =&gt; nil, \"d\" =&gt; nil]\n</code></pre>\n\n<p>If the resulting key order is not important you could write:</p>\n\n<pre><code>h.compact.merge(\"c\" =&gt; nil)\n  #=&gt; {\"a\"=&gt;100, \"b\"=&gt;200, \"c\"=&gt;nil}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>h.compact!.update(\"c\" =&gt; nil)\n</code></pre>\n\n<p>if the hash is to be modified in place.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10136423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrjCF.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10136423/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1532582659, "last_edit_date": 1532582659, "creation_date": 1532574580, "answer_id": 51530433, "question_id": 51523873, "link": "https://stackoverflow.com/questions/51523873/how-do-i-remove-specific-nil-values-from-a-ruby-hash/51530433#51530433", "title": "How do I remove specific &#39;nil&#39; values from a ruby hash?", "body": "<p>If it is just one key, why not <a href=\"http://ruby-doc.org/core/Hash.html#method-i-delete\" rel=\"nofollow noreferrer\">Hash#delete</a> to remove the pair from the Hash instance?</p>\n\n<pre><code>h = {\"a\" =&gt; 100, \"b\" =&gt; 200, \"c\" =&gt; nil, \"d\" =&gt; nil}\nh.delete(\"d\") \nh # =&gt; {\"a\" =&gt; 100, \"b\" =&gt; 200, \"c\" =&gt; nil}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5769049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ys4eI.jpg?s=128&g=1", "display_name": "rutvikpensionwar", "link": "https://stackoverflow.com/users/5769049/rutvikpensionwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1180, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1532582659, "creation_date": 1532536794, "last_edit_date": 1532573635, "question_id": 51523873, "link": "https://stackoverflow.com/questions/51523873/how-do-i-remove-specific-nil-values-from-a-ruby-hash", "title": "How do I remove specific &#39;nil&#39; values from a ruby hash?", "body": "<p>Consider the following hash:</p>\n\n<pre><code>H = {\"a\" =&gt; 100, \"b\" =&gt; 200, \"c\" =&gt; nil, \"d\" =&gt; nil}\n</code></pre>\n\n<p>I want to preserve the <code>nil</code> value with <code>\"c\"</code>, and remove the <code>nil</code> value with <code>\"d\"</code>. How can I do that?</p>\n\n<p>Applying <code>compact</code> will remove all <code>nil</code> values (i.e., with keys <code>\"c\"</code> and <code>\"d\"</code>).</p>\n\n<p>Question <a href=\"https://stackoverflow.com/questions/3450641/removing-all-empty-elements-from-a-hash-yaml\">Removing all empty elements from a hash / YAML?</a> addresses this issue, but I thought there could have been a function equivalent to <code>.compact</code>.</p>\n"}, {"tags": ["ruby", "algorithm"], "comments": [{"owner": {"reputation": 871354, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 2, "creation_date": 1532534882, "post_id": 51523307, "comment_id": 90015590, "body": "Hi! Please review <a href=\"/help/how-to-ask\"><i>How do I ask a good question?</i></a> Your best bet here is to do your research, <a href=\"/help/searching\">search</a> for related topics on SO, and give it a go. <b><i>If</i></b> you get stuck and can&#39;t get unstuck after doing more research and searching, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your attempt and say specifically where you&#39;re stuck. People will be glad to help."}, {"owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "reply_to_user": {"reputation": 871354, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 0, "creation_date": 1532535181, "post_id": 51523307, "comment_id": 90015741, "body": "I am not sure what kind of algorithm is this and how it would be the correct way of doing it. I am thinking that this is some category of algorithms which this one is achievable for doing it. If you have a similar example or a similar question to point me, I&#39;ll be more than happy so I can investigate further."}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 1, "creation_date": 1532535647, "post_id": 51523307, "comment_id": 90015976, "body": "if the dataset is not big, picking all possible 5 players and then checking your restrictions would suffice"}, {"owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "edited": false, "score": 0, "creation_date": 1532535919, "post_id": 51523307, "comment_id": 90016103, "body": "Yes I was thinking to sort based on score and then starting with brute force so I can find the ELO but I was wondering if there is a more elegant way of doing it. Some kind of &quot;magic&quot; algorithm and logic behind it."}, {"owner": {"reputation": 1230, "user_id": 5402852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Thx5j.jpg?s=128&g=1", "display_name": "Leonid Pyrlia", "link": "https://stackoverflow.com/users/5402852/leonid-pyrlia"}, "edited": false, "score": 0, "creation_date": 1532536063, "post_id": 51523307, "comment_id": 90016166, "body": "<code>Array.prototype.sort()</code> and <code>Array.prototype.filter()</code> should do the job: <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/&hellip;</a>, <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/&hellip;</a>"}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1532538848, "post_id": 51523307, "comment_id": 90017542, "body": "If the scores are so few, you can group them by score and sort by elo and then pick all possible 5 players with that structure, you would never consider 5 players with score 2 with 3000 elo if there are 5 with score 2 and 2000 elo"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1532552150, "post_id": 51523307, "comment_id": 90023618, "body": "Why delete the question (but it&#39;s not been deleted yet)? Why not just edit to clarify a bit. It&#39;s basically a good question."}, {"owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "edited": false, "score": 0, "creation_date": 1532552535, "post_id": 51523307, "comment_id": 90023781, "body": "Well I&#39;ve got -3 and I couldn&#39;t delete it because an answer has been voted. I guess the rest of stackoverflow community don&#39;t think it&#39;s worth it, so I tried to remove it. Still, I learnt new things, thank you. My solution is pretty close to yours, I&#39;ve done some additions and it is faster because I tested it with 150 rows and the combination is still slow."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532553432, "post_id": 51523307, "comment_id": 90024194, "body": "John, there are a few things to consider before abandoning the question. Firstly, it&#39;s basically a good question, one that could benefit others who see it in future. Secondly, those of us who spent time working up answers would not especially like to see the fruits of our work relegated to the dust bin. Lastly, all that is needed is a clarification of the question (which might result in downvotes being removed). You could state the question as follows: &quot;Which combination of five players has the largest combined scores subject to the condition that their combined ELO&#39;s does not exceed 11,000?&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532553934, "post_id": 51523307, "comment_id": 90024379, "body": "I just noticed that you clarified the question before I submitted my previous comment. I think it&#39;s fine now. I suggest you simply roll-back to your previous edit."}, {"owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "edited": false, "score": 0, "creation_date": 1532554236, "post_id": 51523307, "comment_id": 90024501, "body": "I don&#39;t think the problem was the clarification, you and other members understood clearly what I was trying to achieve. I think it is mostly the attitude of other stackoverflow members even from well recognized ones like @t-j-crowder who don&#39;t know the answer and they blame the question itself.  I may need to add only easy questions because most members only care for raising fakely their points."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532578472, "post_id": 51523307, "comment_id": 90029589, "body": "@TJCrowder and others who voted to close. The OP has edited the question. I believe it now perfectly clear what the OP is trying to do. It certainly cannot be construed as being too broad. I request you and the others consider reopening the question. Others that agree with my request can also vote to reopen. John, you way wish to consider restoring the &quot;Ruby&quot; and &quot;Javascript&quot; tags."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1532578808, "post_id": 51523307, "comment_id": 90029678, "body": "@TJCrowder and others who voted to close. The OP has edited the question. I believe it now perfectly clear what the OP is trying to do. It certainly cannot be construed as being too broad. I request you and the others consider reopening the question. Others that agree with my request can also vote to reopen. John, you may wish to consider restoring the &quot;Ruby&quot; and &quot;Javascript&quot; tags. Perhaps also consider changing <code>11.000</code> to <code>11000</code> for those who don&#39;t realize that the period is a thousands separator. Hang in there."}], "answers": [{"comments": [{"owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "edited": false, "score": 1, "creation_date": 1532546057, "post_id": 51523719, "comment_id": 90020959, "body": "Thank you for the idea, I optimize it very much and it works for datasets up to 200 records. I would post the answer for the rest but for another time the majority of stackoverflow community knows everything and it doesn&#39;t need my answer for this."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1532554572, "last_edit_date": 1532554572, "creation_date": 1532536178, "answer_id": 51523719, "question_id": 51523307, "link": "https://stackoverflow.com/questions/51523307/best-combination-based-in-rules/51523719#51523719", "title": "Best combination based in rules", "body": "<p>If the dataset is not huge, here you go (possibly quite inefficient):</p>\n\n<pre><code>data =\n  %|Derek Aufderhar, 2134, 1\n    Hadley Kuhn, 2044, 0\n    Myrtie Lueilwitz, 2207, 2\n    Mitchell Schiller, 2036, 2\n    Javier Walter MD, 2485, 4\n    Waino Leuschke, 2486, 2\n    Ariel Jacobson, 2015, 3\n    Melvin Bailey, 2485, 0\n    Dovie Emmerich, 2383, 4\n    Adrian Stroman Jr., 2180, 1\n    Helen Douglas, 2352, 4\n    Yessenia O\u2019Reilly, 2247, 2|\n\n# unnecessary: transform to hash for clarity\nvalues =\n  data.\n    split($/).\n    map { |e| e.split(',') }.\n    map { |name, elo, score| {name: name, elo: elo.to_i, score: score.to_i } }\n\n# find the top\nvalues.\n  combination(5).\n  reject { |data| data.map { |e| e[:elo] }.inject(:+) &gt; 11_000 }.\n  max { |data| data.map { |e| e[:score] }.inject(:+) }\n#\u21d2 [{:name=&gt;\"Yessenia O'Reilly\", :elo=&gt;2247, :score=&gt;2},\n#   {:name=&gt;\"Helen Douglas\", :elo=&gt;2352, :score=&gt;4},\n#   {:name=&gt;\"Adrian Stroman Jr.\", :elo=&gt;2180, :score=&gt;1},\n#   {:name=&gt;\"Ariel Jacobson\", :elo=&gt;2015, :score=&gt;3},\n#   {:name=&gt;\"Mitchell Schiller\", :elo=&gt;2036, :score=&gt;2}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1532551802, "last_edit_date": 1532551802, "creation_date": 1532551438, "answer_id": 51527367, "question_id": 51523307, "link": "https://stackoverflow.com/questions/51523307/best-combination-based-in-rules/51527367#51527367", "title": "Best combination based in rules", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def best_five(players, max_elo)\n  players.combination(5).with_object({ names:[], tot_scores: -1 }) do |arr, best|\n    names, elos, scores = arr.map(&amp;:values).transpose\n    best.replace({ names: names, tot_scores: scores.sum }) unless\n      elos.sum &gt; max_elo || scores.sum &lt;= best[:tot_scores]\n  end\nend\n</code></pre>\n\n<p>Here <code>players</code> is an array of hashes, each with keys <code>:name</code>, <code>:elo</code> and <code>score</code>, where the value of <code>:name</code> is a string and values of the other two keys are integers.</p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>players =&lt;&lt;_\nDerek Aufderhar, 2134, 1\nHadley Kuhn, 2044, 0\nMyrtie Lueilwitz, 2207, 2\nMitchell Schiller, 2036, 2\nJavier Walter MD, 2485, 4\nWaino Leuschke, 2486, 2\nAriel Jacobson, 2015, 3\nMelvin Bailey, 2485, 0\nDovie Emmerich, 2383, 4\nAdrian Stroman Jr., 2180, 1\nHelen Douglas, 2352, 4\nYessenia O\u2019Reilly, 2247, 2\n_\n</code></pre>\n\n<p>It is convenient to convert this string to a hash, both to address the current problem and to perform other operations with the data.</p>\n\n<pre><code>players_by_name = players.each_line.with_object({}) do |line, h|\n  name, elo, score = line.split(',')\n  h[name] = { name: name, elo: elo.to_i, score: score.to_i }\nend\n  #=&gt; {\"Derek Aufderhar\"  =&gt;{:name=&gt;\"Derek Aufderhar\",   :elo=&gt;2134, :score=&gt;1},\n  #    \"Hadley Kuhn\"      =&gt;{:name=&gt;\"Hadley Kuhn\",       :elo=&gt;2044, :score=&gt;0},\n  #    ...\n  #    \"Yessenia O\u2019Reilly\"=&gt;{:name=&gt;\"Yessenia O\u2019Reilly\", :elo=&gt;2247, :score=&gt;2}}\n</code></pre>\n\n<p>We may now compute the best five for <code>max_elo = 11000</code>:</p>\n\n<pre><code>best = best_five(players_by_name.values, 11000)\n  #=&gt; {:names=&gt;[\"Myrtie Lueilwitz\", \"Mitchell Schiller\", \"Ariel Jacobson\",\n  #             \"Dovie Emmerich\", \"Helen Douglas\"],\n  #    :tot_scores=&gt;15}\n</code></pre>\n\n<p>To retrieve information for these five players we compute the following:</p>\n\n<pre><code>a = players_by_name.values_at(*best[:names])\n  #=&gt; [{:name=&gt;\"Myrtie Lueilwitz\" , :elo=&gt;2207, :score=&gt;2},\n  #    {:name=&gt;\"Mitchell Schiller\", :elo=&gt;2036, :score=&gt;2},\n  #    {:name=&gt;\"Ariel Jacobson\"   , :elo=&gt;2015, :score=&gt;3},\n  #    {:name=&gt;\"Dovie Emmerich\"   , :elo=&gt;2383, :score=&gt;4},\n  #    {:name=&gt;\"Helen Douglas\"    , :elo=&gt;2352, :score=&gt;4}]\n</code></pre>\n\n<p>We already know the scores sum to 15. As</p>\n\n<pre><code>a.map { |h| h[:elo] }.sum\n  #=&gt; 10993\n</code></pre>\n\n<p>we see that the combined ELO limit is not exceeded.</p>\n\n<p><a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-sum\" rel=\"nofollow noreferrer\">Array#sum</a> made its debut in Ruby v2.4.</p>\n"}], "owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1532576671, "accepted_answer_id": 51527367, "answer_count": 2, "score": -4, "last_activity_date": 1532636158, "creation_date": 1532534618, "last_edit_date": 1532636158, "question_id": 51523307, "link": "https://stackoverflow.com/questions/51523307/best-combination-based-in-rules", "closed_reason": "Needs more focus", "title": "Best combination based in rules", "body": "<p>Which combination of five entries has the largest combined scores subject to the condition?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "scalability", "sidekiq"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1532533178, "post_id": 51522728, "comment_id": 90014647, "body": "Data size of job arguments does impact performance, of course, because the arguments are sent to/from redis (this naturally implies serialization/deserialization). If your jobs have payload of 10KB or more, you&#39;ll get significantly lower throughput, compared to 20 byte payload. Use this info (and results of your own benchmarks) to make a sufficiently informed decision."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1532533440, "post_id": 51522728, "comment_id": 90014784, "body": "Looking at your code, it is entirely possible that the cost of marshaling an array of 5k ids will be insignificant compared to the actual work you&#39;re doing on them (looks like remote calls). Again, do your own benchmarks."}], "owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 694, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532532664, "creation_date": 1532532664, "question_id": 51522728, "link": "https://stackoverflow.com/questions/51522728/sidekiq-worker-and-arguments-size", "title": "Sidekiq worker and arguments size", "body": "<p>Currently I've this code in one of my Sidekiq worker : </p>\n\n<pre><code>def perform(identity_id, format, model, items_ids, columns, options)\n  ExportListService::Dispatcher.new(\n    identity: identity_from(identity_id),\n    format:   format,\n    items:    items_from(model, items_ids),\n    columns:  columns,\n    options:  options&amp;.symbolize_keys! || {}\n  ).perform\nend\n</code></pre>\n\n<p>The <code>items_from</code> method is in charge of recovering each item from the database in the order it was sent within the array <code>items_ids</code>, then we proceed through the service.</p>\n\n<p>The order is very important as the controller which initiate this worker has multiple filters and options, IDs can be sent in all kind of orders which should not be lost when transmitted to Sidekiq.</p>\n\n<p>Works great, but I realised this <code>items_ids</code> array could have <strong>more than 5 000 entries in it.</strong></p>\n\n<p>In term of scalability, what would be best ?</p>\n\n<ul>\n<li>Keep it as it is, it won't impact the worker performance if the array is big. I didn't find anything relevant to params length about Sidekiq, so I don't know if it'll break the performances.</li>\n</ul>\n\n<p>OR</p>\n\n<ul>\n<li>Take the whole controller logic to sort this <code>items_ids</code> and copy it into the worker (imply possible duplicate and hard to maintain code)</li>\n</ul>\n\n<p>What solution should I take ? Is there any other possibility I didn't think of ?</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1532528607, "post_id": 51520961, "comment_id": 90011409, "body": "Why not use Nokogiri to grab the elements directly? <code>css(&#39;.job h2 a&#39;)</code>?"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1532529041, "post_id": 51520961, "comment_id": 90011724, "body": "Also why are you calling <code>children</code> on the <code>.job</code> collection?"}, {"owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1532541355, "post_id": 51520961, "comment_id": 90018835, "body": "The page has a lot of divs with class &quot;job&quot;. So I want that, for each div, make a processing. Was it clear?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1579148936, "post_id": 51520961, "comment_id": 105670923, "body": "&quot;lasso&quot;? Are you referring to the &quot;at&quot; (&quot;<code>@</code>&quot;)?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1579149024, "post_id": 51520961, "comment_id": 105670939, "body": "When asking we need the smallest example of input data (HTML) that duplicates the problem in the question itself. Don&#39;t ask us to retrieve data from an unknown site; help us help you."}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1532528111, "post_id": 51521097, "comment_id": 90011049, "body": "Hey Casper. The problem here is that this attribution breaks the code (because it doesnt have a h2 on it. link = @job_parse_page.at_css(&quot;h2 a&quot;)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532529311, "post_id": 51521097, "comment_id": 90011930, "body": "<code>next unless link</code>?"}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 1, "last_activity_date": 1532560708, "last_edit_date": 1532560708, "creation_date": 1532527930, "answer_id": 51521097, "question_id": 51520961, "link": "https://stackoverflow.com/questions/51520961/conditional-processing-with-nokogiri/51521097#51521097", "title": "Conditional processing with Nokogiri", "body": "<p>Loops in Ruby can be advanced using the <code>next</code> keyword. So you could do something like this:</p>\n\n<pre><code>@all_jobs.each do |job|\n  link = job.at_css(\"h2 a\")\n  next unless link\n\n  @url = link['href']\n  ... \nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 0, "last_activity_date": 1532562798, "creation_date": 1532562798, "answer_id": 51529198, "question_id": 51520961, "link": "https://stackoverflow.com/questions/51520961/conditional-processing-with-nokogiri/51529198#51529198", "title": "Conditional processing with Nokogiri", "body": "<p>You can do:</p>\n\n<pre><code>@url = job_parse_page.at_css(\"h2 a,[href]\")['href'] rescue 'no href!'\n</code></pre>\n\n<p>That will look for the h2 a, then anything with a href attribute, and rescue with 'no href!'</p>\n"}], "owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532562798, "creation_date": 1532527538, "last_edit_date": 1532537939, "question_id": 51520961, "link": "https://stackoverflow.com/questions/51520961/conditional-processing-with-nokogiri", "title": "Conditional processing with Nokogiri", "body": "<p>Im doing some scraping from web. And want that some data get saved, only if we find some tags inside it. My code looks like this: </p>\n\n<pre><code>def process\n    doc = HTTParty.get(\"https://www.remotelyawesomejobs.com/jobs\")\n    @parse_page ||= Nokogiri::HTML(doc)\n    @all_jobs = @parse_page.css(\".job\")\n    @all_jobs.children.each do |job|\n       @url =  @job_parse_page.at_css(\"h2 a\")['href'] \n    end\nend\n</code></pre>\n\n<p>The problem here. When Im doing </p>\n\n<pre><code>@url = job_parse_page.at_css(\"h2 a\")['href'] \n</code></pre>\n\n<p>Sometimes the children on the lasso doesnt have a css (\"h2 a\") and the app breaks and throws an error. </p>\n\n<p>How is the best way to do \"Hey. If you dont have a \"h2 and a\" on your DOM, just go to the next element? But if you have, do some other processing?  </p>\n"}, {"tags": ["ruby", "sequel", "eager"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10130271, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Njde96OZ_nQ/AAAAAAAAAAI/AAAAAAAAAEE/VzUEv5tTr9o/photo.jpg?sz=128", "display_name": "Everton", "link": "https://stackoverflow.com/users/10130271/everton"}, "edited": false, "score": 0, "creation_date": 1532711119, "post_id": 51522275, "comment_id": 90091898, "body": "This worked, the number of queries was what i expected but i cannot paginate the orders using limit/offset.  The eager is loading all orders for all clients and i think limiting on the ruby side is not efficient. Thanks for the help anyway, i appreciate your work"}, {"owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "reply_to_user": {"reputation": 13, "user_id": 10130271, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Njde96OZ_nQ/AAAAAAAAAAI/AAAAAAAAAEE/VzUEv5tTr9o/photo.jpg?sz=128", "display_name": "Everton", "link": "https://stackoverflow.com/users/10130271/everton"}, "edited": false, "score": 1, "creation_date": 1533332648, "post_id": 51522275, "comment_id": 90324062, "body": "Sequel&#39;s master branch now supports what you want via the eager_graph_eager plugin: <a href=\"https://github.com/jeremyevans/sequel/commit/7a19a1617847ec9be12bac5104cf01bda102ff78\" rel=\"nofollow noreferrer\">github.com/jeremyevans/sequel/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "is_accepted": true, "score": 1, "last_activity_date": 1532531346, "creation_date": 1532531346, "answer_id": 51522275, "question_id": 51520637, "link": "https://stackoverflow.com/questions/51520637/how-to-eager-load-an-association-from-a-eager-graph-association-using-sequel-rub/51522275#51522275", "title": "How to eager load an association from a eager graph association using Sequel Ruby gem?", "body": "<p>Sequel doesn't currently support mixing eager and eager_graph in that way. You could do:</p>\n\n<pre><code>Order.eager(:client=&gt;{proc{|ds| ds.where(:account_id=&gt;1)}=&gt;:images}).all.\n  select{|order| order.client}\n</code></pre>\n\n<p>But that may not be very efficient if most orders do not have that client.  You may be better off doing:</p>\n\n<pre><code>clients = Client.where(:account_id=&gt;1).eager(:orders, :images)\nclients.flat_map(&amp;:orders)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10130271, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Njde96OZ_nQ/AAAAAAAAAAI/AAAAAAAAAEE/VzUEv5tTr9o/photo.jpg?sz=128", "display_name": "Everton", "link": "https://stackoverflow.com/users/10130271/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 51522275, "answer_count": 1, "score": 1, "last_activity_date": 1532531346, "creation_date": 1532526683, "last_edit_date": 1532527260, "question_id": 51520637, "link": "https://stackoverflow.com/questions/51520637/how-to-eager-load-an-association-from-a-eager-graph-association-using-sequel-rub", "title": "How to eager load an association from a eager graph association using Sequel Ruby gem?", "body": "<p>I have the following models in my application:</p>\n\n<pre><code>class Order &lt; Sequel::Model\n    many_to_one(:client, class: 'Client', key: :client_id)\nend\n\nclass Client &lt; Sequel::Model\n    one_to_many(:images, class: 'Image', key: :client_id, eager: :file)\nend\n\nclass Image &lt; Sequel::Model\n    many_to_one(:file, class: 'File', key: :file_id, eager: :namespace)\nend\n\nclass File &lt; Sequel::Model\n    many_to_one(:namespace, class: 'Namespace', key: :namespace_id)\nend\n\nclass Namespace &lt; Sequel::Model\nend\n</code></pre>\n\n<p>I can fetch all <code>Orders</code> for all <code>Clients</code> with <code>account_id=1</code> using eager_graph (eager_graph because the search column is in the <code>client</code> table):</p>\n\n<pre><code>orders = Order.eager_graph(:client).where(account_id: 1)\n</code></pre>\n\n<p>What is the best strategy to eager load all this entities?\nIf I change it to <code>.eager_graph(client: :images)</code> the result will be a big query with a lot of joins.</p>\n\n<p>Is it possible to have a separate query for every nested associations, like it was used only the <code>.eager</code> method?</p>\n\n<p>I trying to fine tune this because of performance issues.<br>\nThanks in advance.</p>\n"}, {"tags": ["ruby", "activerecord", "sinatra", "geocoder"], "comments": [{"owner": {"reputation": 136, "user_id": 5784018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fe3d40490517d185cf8d25ffe903ff?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Mirkhaydarov", "link": "https://stackoverflow.com/users/5784018/alex-mirkhaydarov"}, "edited": false, "score": 2, "creation_date": 1532530589, "post_id": 51520034, "comment_id": 90012837, "body": "On your post method, you&#39;re calling <code>Post.create</code> and then saving it again which doesn&#39;t make sense. <code>Post.create</code> already saves the object to the database. You should just remove both <code>record</code> and <code>record.save</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "is_accepted": true, "score": 1, "last_activity_date": 1532543554, "creation_date": 1532543554, "answer_id": 51525568, "question_id": 51520034, "link": "https://stackoverflow.com/questions/51520034/setting-up-geocoder-with-sinatra-and-activerecord/51525568#51525568", "title": "Setting up Geocoder with Sinatra and ActiveRecord?", "body": "<p>I fixed the above by adding:</p>\n\n<pre><code>require 'geocoder'\n</code></pre>\n\n<p>and</p>\n\n<pre><code>reverse_geocoded_by :latitude, :longitude\n</code></pre>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51525568, "answer_count": 1, "score": 1, "last_activity_date": 1532543554, "creation_date": 1532525041, "last_edit_date": 1532530881, "question_id": 51520034, "link": "https://stackoverflow.com/questions/51520034/setting-up-geocoder-with-sinatra-and-activerecord", "title": "Setting up Geocoder with Sinatra and ActiveRecord?", "body": "<p>I have a MYSQL database which is accessed using ActiveRecord and Sinatra. I am trying to perform certain geolocation task on the records in the tables.</p>\n\n<p>However, i believe my syntax is wrong as extending the geocoder class makes my CRUD request fail:</p>\n\n<p><strong>myapp.rb</strong></p>\n\n<pre><code>require 'rubygems'\nrequire 'sinatra'\nrequire 'active_record'\nrequire 'table_print'\nrequire 'json'\n\nActiveRecord::Base.establish_connection(\n  :adapter  =&gt; \"mysql2\",\n  :host     =&gt; \"localhost\",\n  :username =&gt; \"root\",\n  :database =&gt; \"orbital\"\n)\n\nclass Post &lt; ActiveRecord::Base\n  extend Geocoder::Model::ActiveRecord\n\n # attr_accessor :latitude, :longitude\nend\n\nclass Comment &lt; ActiveRecord::Base\n  #extend Geocoder::Model::ActiveRecord\nend\n\nclass MyApp &lt; Sinatra::Application\n  #extend Geocoder::Model::ActiveRecord\nend\n\npost '/post' do\n  @user = params[:user]\n  @content = params[:content]\n  @latitude = params[:latitude]\n  @longitude = params[:longitude]\n  @timestamp = params[:timestamp]\n  record = Post.create(user: @user, content: @content, longitude: @longitude, latitude: @latitude, timestamp: @timestamp)\n  record.save\nend\n</code></pre>\n\n<p>The query I am trying to perform is:\n<code>Post.near([@lat, @long], @dist, units: :km).offset(10 * @var.to_i).first(10)</code></p>\n\n<p>This stackoverflow thread <a href=\"https://stackoverflow.com/questions/23796364/problems-implementing-ruby-geocoder-using-sinatra\">here</a> also suggests that I need to setup additional arguments such as <code>attr_accessors</code>. How do I go about setting up rewriting the above so i can use Geocoder's <code>near</code> method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "edited": false, "score": 0, "creation_date": 1532532117, "post_id": 51518621, "comment_id": 90013955, "body": "As stated above, going to the site without using DNS, via the ip address, fails as well."}, {"owner": {"reputation": 732, "user_id": 3165889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iH3bp.jpg?s=128&g=1", "display_name": "Joao Cunha", "link": "https://stackoverflow.com/users/3165889/joao-cunha"}, "reply_to_user": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "edited": false, "score": 0, "creation_date": 1532532416, "post_id": 51518621, "comment_id": 90014182, "body": "can you at least ping the public ip?"}, {"owner": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "edited": false, "score": 0, "creation_date": 1532532454, "post_id": 51518621, "comment_id": 90014206, "body": "Yes, I can ping the ip address."}, {"owner": {"reputation": 732, "user_id": 3165889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iH3bp.jpg?s=128&g=1", "display_name": "Joao Cunha", "link": "https://stackoverflow.com/users/3165889/joao-cunha"}, "reply_to_user": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "edited": false, "score": 0, "creation_date": 1532532731, "post_id": 51518621, "comment_id": 90014375, "body": "can you run nmap on your public ip and check which open ports it finds?"}, {"owner": {"reputation": 732, "user_id": 3165889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iH3bp.jpg?s=128&g=1", "display_name": "Joao Cunha", "link": "https://stackoverflow.com/users/3165889/joao-cunha"}, "reply_to_user": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "edited": false, "score": 0, "creation_date": 1532532834, "post_id": 51518621, "comment_id": 90014441, "body": "you can also run against a specific port: sudo nmap -p port_number remote_host"}], "tags": [], "owner": {"reputation": 732, "user_id": 3165889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iH3bp.jpg?s=128&g=1", "display_name": "Joao Cunha", "link": "https://stackoverflow.com/users/3165889/joao-cunha"}, "is_accepted": false, "score": 0, "last_activity_date": 1532520851, "creation_date": 1532520851, "answer_id": 51518621, "question_id": 51518047, "link": "https://stackoverflow.com/questions/51518047/access-puma-from-outside-network/51518621#51518621", "title": "Access Puma from outside network", "body": "<p>Maybe the dns server is down?</p>\n\n<ul>\n<li>use <a href=\"https://en.wikipedia.org/wiki/Dig_(command)\" rel=\"nofollow noreferrer\">dig</a> to find out if you dns is really pointing to your ip (could be that the dns server unreachable)</li>\n<li>test requesting your ip directly instead of the dns</li>\n<li>are you listening for ipv4 AND ipv6 connections?</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "is_accepted": false, "score": 0, "last_activity_date": 1532534300, "creation_date": 1532534300, "answer_id": 51523223, "question_id": 51518047, "link": "https://stackoverflow.com/questions/51518047/access-puma-from-outside-network/51523223#51523223", "title": "Access Puma from outside network", "body": "<p>I recently re-attached my physical ethernet cable to my computer, allowing it to use both wired and wireless connections. My port forwarding rule was routing to my wireless address which had somehow connected to my ceiling fan instead of to my router. All requests for port 3000 were going to my ceiling fan.</p>\n"}], "owner": {"reputation": 313, "user_id": 5112301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6d9bc544d2f61b4452203ab8c821b?s=128&d=identicon&r=PG&f=1", "display_name": "rdiddly", "link": "https://stackoverflow.com/users/5112301/rdiddly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532534300, "creation_date": 1532519003, "last_edit_date": 1532532164, "question_id": 51518047, "link": "https://stackoverflow.com/questions/51518047/access-puma-from-outside-network", "title": "Access Puma from outside network", "body": "<p>For over a year I've been able to serve a RoR site using Puma from my local machine. As of yesterday it's no longer available from outside my network. I use DynDns to allow outside users to access via a url vs. an ip address. I have used Dyn's network tool to validate that port 3000 is open to the outside. It is. My router configuration has not changed. Dyn has my correct ip address. (It fails going direct to my ip address also.) I can access the site from 127.0.0.1. The service is started using 'rails s -b 0.0.0.0'. When hit from outside there is no output from Puma. Where can I look to find out what the problem might be?</p>\n\n<p>Output from dig:  </p>\n\n<pre><code>myMac$ dig mydomain.dyndns-pics.com\n\n; &lt;&lt;&gt;&gt; DiG 9.8.3-P1 &lt;&lt;&gt;&gt; mydomain.dyndns-pics.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 40324\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;mydomain.dyndns-pics.com.      IN  A\n\n;; ANSWER SECTION:\nmydomain.dyndns-pics.com.   60  IN  A   nn.nnn.nn.nn (my ip address)\n\n;; Query time: 159 msec\n;; SERVER: 216.146.35.35#53(216.146.35.35)\n;; WHEN: Wed Jul 25 11:12:35 2018\n;; MSG SIZE  rcvd: 54\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532516856, "post_id": 51517332, "comment_id": 90003134, "body": "<i>&quot;how I can get the selected option in a dropdown menu inside a .erb file&quot;</i> - You can&#39;t. You can use JavaScript to find the selected option and its value if you need it before submitting the form."}, {"owner": {"reputation": 197, "user_id": 5821242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f2002130a95fe1c9f20c772b4cb7233?s=128&d=identicon&r=PG&f=1", "display_name": "Gautam Kathrotiya", "link": "https://stackoverflow.com/users/5821242/gautam-kathrotiya"}, "edited": false, "score": 0, "creation_date": 1532516948, "post_id": 51517332, "comment_id": 90003185, "body": "using javascript you have to set selected"}], "answers": [{"comments": [{"owner": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "reply_to_user": {"reputation": 35, "user_id": 6736674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e94de64fddc7431af624c76281ee0438?s=128&d=identicon&r=PG&f=1", "display_name": "Horatio Velveteen", "link": "https://stackoverflow.com/users/6736674/horatio-velveteen"}, "edited": false, "score": 0, "creation_date": 1532517886, "post_id": 51517491, "comment_id": 90003791, "body": "@HoratioVelveteen No problem, funny the folk that just tell you to use JS immediately. If you have other issues, first consider if you could choose to do your behaviour server-side rather than client-side. Choose server-side most of the time and use JS only when needed. Have fun learning!"}], "tags": [], "owner": {"reputation": 3164, "user_id": 193785, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b9110bc3c6f788945c789bf190932dc1?s=128&d=identicon&r=PG", "display_name": "BookOfGreg", "link": "https://stackoverflow.com/users/193785/bookofgreg"}, "is_accepted": true, "score": 1, "last_activity_date": 1532517184, "creation_date": 1532517184, "answer_id": 51517491, "question_id": 51517332, "link": "https://stackoverflow.com/questions/51517332/get-selected-option-from-dropdown-in-ruby/51517491#51517491", "title": "Get selected option from dropdown in ruby", "body": "<p>If you want to submit the selection to the rails server, you can make it into a form:</p>\n\n<p><a href=\"https://guides.rubyonrails.org/form_helpers.html#a-generic-search-form\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/form_helpers.html#a-generic-search-form</a></p>\n\n<pre><code>&lt;%= form_tag(\"/search\", method: \"get\") do %&gt;\n  &lt;%= label_tag(:q, \"Search for:\") %&gt;\n  &lt;select name=\"regions\"&gt;\n    &lt;option value=\"all\"&gt;All regions&lt;/option&gt;\n    &lt;% @regions.each do |region| %&gt;\n        &lt;option value=\"&lt;%= region.name %&gt;\"&gt;&lt;%= region.name.capitalize %&gt;&lt;/option&gt;\n    &lt;% end %&gt;\n  &lt;/select&gt;\n  &lt;%= submit_tag(\"Search\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>From the form you can modify your response with a filtered list.</p>\n\n<p>Otherwise you want to use JavaScript to have purely client-side behaviour.</p>\n"}], "owner": {"reputation": 35, "user_id": 6736674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e94de64fddc7431af624c76281ee0438?s=128&d=identicon&r=PG&f=1", "display_name": "Horatio Velveteen", "link": "https://stackoverflow.com/users/6736674/horatio-velveteen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 51517491, "answer_count": 1, "score": 0, "last_activity_date": 1532517596, "creation_date": 1532516659, "question_id": 51517332, "link": "https://stackoverflow.com/questions/51517332/get-selected-option-from-dropdown-in-ruby", "title": "Get selected option from dropdown in ruby", "body": "<p>I'm new to both Ruby and Rails and I was wondering if and how I can get the selected option in a dropdown menu inside a <code>.erb</code> file.</p>\n\n<p>At the moment, this is my code:</p>\n\n<pre><code>&lt;select name=\"regions\"&gt;\n    &lt;option value=\"all\"&gt;All regions&lt;/option&gt;\n    &lt;% @regions.each do |region| %&gt;\n        &lt;option value=\"&lt;%= region.name %&gt;\"&gt;&lt;%= region.name.capitalize %&gt;&lt;/option&gt;\n    &lt;% end %&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>The purpose for this dropdown menu is to show a list of regions and to select one that, in future, will act as a filter for a list of displayed items that I will implement as I progress through my learning process.</p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 4, "creation_date": 1532515986, "post_id": 51516990, "comment_id": 90002585, "body": "The Ruby answers prove that it does short-circuit; but if you still want to find where that is in C, look at where <code>ENUMFUNC(any)</code> is defined (look for <code>DEFINE_ENUMFUNCS(any)</code>), and you should see <code>rb_iter_break()</code> on a match. (BTW, your source is a little old; <a href=\"https://github.com/ruby/ruby/blob/8099b9279b7401fa393385611a4c159900582105/enum.c\" rel=\"nofollow noreferrer\">here</a>&#39;s the MRI 2.5 file.)"}, {"owner": {"reputation": 103, "user_id": 8937642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677745c2ebda486da271d4d33ed6fce2?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Marti", "link": "https://stackoverflow.com/users/8937642/alejandro-marti"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1532516842, "post_id": 51516990, "comment_id": 90003128, "body": "Thank you for the depth on the answer. Next time I&#39;ll be able to go further on my search"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 4, "last_activity_date": 1532515735, "creation_date": 1532515735, "answer_id": 51517063, "question_id": 51516990, "link": "https://stackoverflow.com/questions/51516990/does-any-break-from-the-loop-when-a-match-is-found/51517063#51517063", "title": "Does &#39;any?&#39; break from the loop when a match is found?", "body": "<p>The term is \"short-circuiting\" and yes, <code>any?</code> does that. After it finds a match, it doesn't look any further.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532515779, "post_id": 51517067, "comment_id": 90002459, "body": "yeah, I was about to post a demo snippet :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1532515815, "post_id": 51517067, "comment_id": 90002486, "body": "@SergioTulentsev and I was about to mention <i>short-circuiting</i> term :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1532515749, "creation_date": 1532515749, "answer_id": 51517067, "question_id": 51516990, "link": "https://stackoverflow.com/questions/51516990/does-any-break-from-the-loop-when-a-match-is-found/51517067#51517067", "title": "Does &#39;any?&#39; break from the loop when a match is found?", "body": "<p>Yes, it does break the loop. One does not need to dig into <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> code to check that:</p>\n\n<pre><code>[1,2,3].any? { |e| puts \"Checking #{e}\"; e == 2 }\n# Checking 1\n# Checking 2\n#\u21d2 true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 732, "user_id": 3165889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iH3bp.jpg?s=128&g=1", "display_name": "Joao Cunha", "link": "https://stackoverflow.com/users/3165889/joao-cunha"}, "is_accepted": false, "score": 1, "last_activity_date": 1532515798, "creation_date": 1532515798, "answer_id": 51517080, "question_id": 51516990, "link": "https://stackoverflow.com/questions/51516990/does-any-break-from-the-loop-when-a-match-is-found/51517080#51517080", "title": "Does &#39;any?&#39; break from the loop when a match is found?", "body": "<p>Yes and it's easy to prove:</p>\n\n<pre><code>irb(main):009:0&gt; %w{ant bear cat}.any? {|word| puts \"hello\"; word.length &gt;= 4}\nhello\nhello\n=&gt; true\n</code></pre>\n\n<p>It has printed only twice. If it did not break it would print 3 times.</p>\n"}, {"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1532936272, "post_id": 51521434, "comment_id": 90143345, "body": "Awesome answer. However, most Rubyists will agree that whatever YARV does it&#39;s de facto standard, and all the other implementations either follow YARV or are explicit about it when they don&#39;t. (And I don&#39;t see ISO spec as particularly relevant, as it describes a dead language, as of June 2013.)"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1532528913, "last_edit_date": 1592644375, "creation_date": 1532528913, "answer_id": 51521434, "question_id": 51516990, "link": "https://stackoverflow.com/questions/51516990/does-any-break-from-the-loop-when-a-match-is-found/51521434#51521434", "title": "Does &#39;any?&#39; break from the loop when a match is found?", "body": "<blockquote>\n<p>Does <code>any?</code> break from the loop when a match is found?</p>\n</blockquote>\n<p><a href=\"http://ruby-doc.org/core/Enumerable.html#method-i-any-3F\" rel=\"nofollow noreferrer\">The documentation is unclear about that</a>:</p>\n<blockquote>\n<p>The method returns <code>true</code> if the block ever returns a value other than <code>false</code> or <code>nil</code>.</p>\n</blockquote>\n<p>Note: it does not say &quot;<em>when</em> the block ever returns a value other than <code>false</code> or <code>nil</code>&quot; or &quot;<em>as soon as</em> the block ever returns a value other than <code>false</code> or <code>nil</code>&quot;.</p>\n<p>This can be interpreted either way, or it can be interpreted as making no guarantees at all. If you go by this documentation, then you can <em>neither</em> guarantee that it <em>will</em> short-ciruit, nor can you guarantee that it <em>won't</em> short-circuit.</p>\n<p>Generally speaking, this is typical for API specifications: make the minimum amount of guarantees, giving the API implementor maximum freedom in how to implement the API.</p>\n<p>There is somewhere else we can look: <a href=\"https://iso.org/standard/59579.html\" rel=\"nofollow noreferrer\">the ISO Ruby Programming Language Specification</a> (<strong>bold</strong> emphasis mine):</p>\n<blockquote>\n<h1>15.3.2.2.2 <code>Enumerable#any?</code></h1>\n<pre><code>any?(&amp;block)\n</code></pre>\n<p><em>Visibility</em>: public</p>\n<p><em>Behavior</em>:</p>\n<p>a) Invoke the method <code>each</code> on the receiver</p>\n<p>b) For each element <em>X</em> which <code>each</code> yields</p>\n<ol>\n<li>If <em>block</em> is given, call <em>block</em> with <em>X</em> as the argument.\n<strong>If this call results in a <em>trueish</em> object, return <code>true</code></strong></li>\n</ol>\n</blockquote>\n<p>As you can see, again it only says &quot;if&quot;, but not &quot;when&quot; or &quot;as soon as&quot;. This sentence can be interpreted in two ways: &quot;Return <code>true</code> as the result of the method&quot; (no indication of how often the block gets called, only that the method will return <code>true</code> at the end) or &quot;return <code>true</code> when you encounter an invocation of the block that evaluates to a trueish value&quot;.</p>\n<p>Try #3: <a href=\"https://github.com/ruby/spec/blob/master/core/enumerable/any_spec.rb#L99-L127\" rel=\"nofollow noreferrer\">The Ruby Spec</a>:</p>\n<blockquote>\n<pre><code>it &quot;stops iterating once t\u00e4he return value is determined&quot; do\n</code></pre>\n</blockquote>\n<p>So, yes, we can indeed rely on the fact that the block is only evaluated until the first truthy value is encountered.</p>\n<blockquote>\n<p>The following is the <a href=\"https://apidock.com/ruby/Enumerable/any%3F\" rel=\"nofollow noreferrer\"><code>any?</code> source code</a>, but I don't understand it.</p>\n</blockquote>\n<p>Note: by looking at the source code, you can <em>not</em> determine how something behaves in Ruby. You can only determine how something behaves in <em>that</em> specific version of <em>that</em> specific implementation of Ruby. Different implementations may behave differently (for example, in YARV, Ruby threads cannot run at the same time, in JRuby, they can). Even <em>different versions</em> of the <em>same</em> implementation can behave differently.</p>\n<p>It is usually not a good idea to make assumptions about the behavior of a programming language by just looking at a single version of a single implementation.</p>\n<p>However, <em>if</em> you really want to look at some implementation, and are fully aware about the limitations of this approach, then I would suggest to look at Rubinius, Topaz, Opal, IronRuby, or JRuby. They are (in my opinion) better organized and easier to read than YARV.</p>\n<p>For example, <a href=\"https://github.com/rubinius/rubinius/blob/master/core/enumerable.rb#L412-L419\" rel=\"nofollow noreferrer\">this is the code for <code>Enumerable#any?</code> in Rubinius</a>:</p>\n<pre><code>def any?\n  if block_given?\n    each { |*element| return true if yield(*element) }\n  else\n    each { return true if Rubinius.single_block_arg }\n  end\n  false\nend\n</code></pre>\n<p>This looks rather clear and readable, doesn't it?</p>\n<p><a href=\"https://github.com/topazproject/topaz/blob/master/lib-topaz/enumerable.rb#L92-L99\" rel=\"nofollow noreferrer\">This is the definition in Topaz</a>:</p>\n<pre><code>def any?(&amp;block)\n  if block\n    self.each { |*e| return true if yield(*e) }\n  else\n    self.each_entry { |e| return true if e }\n  end\n  false\nend\n</code></pre>\n<p>This also looks fairly readable.</p>\n<p><a href=\"https://github.com/opal/opal/blob/master/opal/corelib/enumerable.rb#L40-L62\" rel=\"nofollow noreferrer\">The soure in Opal</a> is a little bit more complex, but only marginally so:</p>\n<pre><code>def any?(pattern = undefined, &amp;block)\n  if `pattern !== undefined`\n    each do |*value|\n      comparable = `comparableForPattern(value)`\n\n      return true if pattern.public_send(:===, *comparable)\n    end\n  elsif block_given?\n    each do |*value|\n      if yield(*value)\n        return true\n      end\n    end\n  else\n    each do |*value|\n      if Opal.destructure(value)\n        return true\n      end\n    end\n  end\n\n  false\nend\n</code></pre>\n<p>[Note the interesting use of overriding the <code>`</code> method for injecting literal ECMAScript into the compiled code.]</p>\n<p>Most of the added complexity compared to the Rubinius and Topaz versions stems from the fact that Opal already supports the third overload of <code>any?</code> taking a pattern which was introduced in Ruby 2.5, whereas Rubinius and Topaz only support the two overloads with a block and without any arguments at all.</p>\n<p><a href=\"https://github.com/IronLanguages/ironruby/blob/master/Src/Libraries/Builtins/Enumerable.cs#L57-L84\" rel=\"nofollow noreferrer\">IronRuby's implementation</a> implements the short-circuiting like <a href=\"https://github.com/IronLanguages/ironruby/blob/master/Src/Libraries/Builtins/Enumerable.cs#L67-L70\" rel=\"nofollow noreferrer\">this</a>:</p>\n<pre><code>if (predicate.Yield(item, out blockResult)) {\n    result = blockResult;\n    return selfBlock.PropagateFlow(predicate, blockResult);\n}\n</code></pre>\n<p><a href=\"https://github.com/jruby/jruby/blob/master/core/src/main/java/org/jruby/RubyEnumerable.java#L1805-L1857\" rel=\"nofollow noreferrer\">JRuby's implementation</a> is a little bit more involved still, but you can see that as soon as it encounters a truthy block value, it breaks out of the loop by <a href=\"https://github.com/jruby/jruby/blob/master/core/src/main/java/org/jruby/RubyEnumerable.java#L1827\" rel=\"nofollow noreferrer\"><code>throw</code>ing a <code>SPECIAL_JUMP</code> exception</a> and <a href=\"https://github.com/jruby/jruby/blob/master/core/src/main/java/org/jruby/RubyEnumerable.java#L1852-L1854\" rel=\"nofollow noreferrer\"><code>catch</code>ing it to return <code>true</code></a>.</p>\n"}], "owner": {"reputation": 103, "user_id": 8937642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677745c2ebda486da271d4d33ed6fce2?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Marti", "link": "https://stackoverflow.com/users/8937642/alejandro-marti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1532527121, "accepted_answer_id": 51517067, "answer_count": 4, "score": 0, "last_activity_date": 1532528913, "creation_date": 1532515500, "last_edit_date": 1532515948, "question_id": 51516990, "link": "https://stackoverflow.com/questions/51516990/does-any-break-from-the-loop-when-a-match-is-found", "closed_reason": "Duplicate", "title": "Does &#39;any?&#39; break from the loop when a match is found?", "body": "<p>Does <code>any?</code> break from the loop when a match is found?</p>\n\n<p>The following is the <a href=\"https://apidock.com/ruby/Enumerable/any%3F\" rel=\"nofollow noreferrer\"><code>any?</code> source code</a>, but I don't understand it.</p>\n\n<pre><code>static VALUE\nenum_any(VALUE obj)\n{\n    VALUE result = Qfalse;\n\n    rb_block_call(obj, id_each, 0, 0, ENUMFUNC(any), (VALUE)&amp;result);\n    return result;\n}\n</code></pre>\n"}, {"tags": ["ruby", "numbers"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1532550506, "post_id": 51516507, "comment_id": 90022875, "body": "<code>*ys.minmax.map {#...}</code> :)"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1532550746, "post_id": 51516507, "comment_id": 90022975, "body": "<code>ys = input.map { |e| e[:y] }; [ys.min, ys.max]</code> can become <code>input.minmax_by { |e| e[:y] }</code>..and if I&#39;m not mistaken you can use <code>Math.log10</code> to get the <i>positive</i> number to round to (you&#39;d still need to make it negative; so like <code>num.round(-Math.log10(num).to_i)</code> should work unless I&#39;m derping on my math right now)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1532555243, "post_id": 51516507, "comment_id": 90024851, "body": "@SimpleLime <code>minmax_by</code> would return the whole Hash so you would still need to access <code>e[:y]</code> to create the actual Range"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 6, "last_activity_date": 1532514402, "last_edit_date": 1532514402, "creation_date": 1532514120, "answer_id": 51516507, "question_id": 51516439, "link": "https://stackoverflow.com/questions/51516439/create-ranges-from-numbers/51516507#51516507", "title": "Create ranges from numbers", "body": "<p>Use <a href=\"https://ruby-doc.org/core/Float.html#method-i-round\" rel=\"noreferrer\"><code>Float#round</code></a> with a negative argument:</p>\n\n<pre><code>316.28.round(-2)\n#\u21d2 300\n363.13.round(-2)\n#\u21d2 400\n</code></pre>\n\n<hr>\n\n<pre><code>input = _\n#\u21d2 [{:y=&gt;316.28, :label=&gt;\"Kaimur\", :color=&gt;\"Light_Green\"},\n#   {:y=&gt;323.63, :label=&gt;\"Banka\", :color=&gt;\"Light_Green\"},\n#   {:y=&gt;327.85, :label=&gt;\"Gaya\", :color=&gt;\"Light_Green\"},\n#   {:y=&gt;346.11, :label=&gt;\"EastChamparan\", :color=&gt;\"Light_Green\"},\n#   {:y=&gt;358.38, :label=&gt;\"Nalanda\", :color=&gt;\"Light_Green\"},\n#   {:y=&gt;363.13, :label=&gt;\"Madhubani\", :color=&gt;\"Light_Green\"}]\nys = input.map { |e| e[:y] }\n#\u21d2 [316.28, 323.63, 327.85, 346.11, 358.38, 363.13]\nRange.new *[ys.min, ys.max].map { |e| e.round(-e.round.to_s.length+1) }\n#\u21d2 300..400\n</code></pre>\n"}], "owner": {"reputation": 1735, "user_id": 4903843, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9o6SR.jpg?s=128&g=1", "display_name": "Nilay Singh", "link": "https://stackoverflow.com/users/4903843/nilay-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51516507, "answer_count": 1, "score": 0, "last_activity_date": 1532515281, "creation_date": 1532513957, "last_edit_date": 1532515281, "question_id": 51516439, "link": "https://stackoverflow.com/questions/51516439/create-ranges-from-numbers", "title": "Create ranges from numbers", "body": "<p>I have an array of hashes that have numbers:</p>\n\n<pre><code> [\n    {\n    y: 316.28,\n    label: \"Kaimur\",\n    color: \"Light_Green\"\n    },\n    {\n    y: 323.63,\n    label: \"Banka\",\n    color: \"Light_Green\"\n    },\n    {\n    y: 327.85,\n    label: \"Gaya\",\n    color: \"Light_Green\"\n    },\n    {\n    y: 346.11,\n    label: \"EastChamparan\",\n    color: \"Light_Green\"\n    },\n    {\n    y: 358.38,\n    label: \"Nalanda\",\n    color: \"Light_Green\"\n    },\n    {\n    y: 363.13,\n    label: \"Madhubani\",\n    color: \"Light_Green\"\n    }\n]\n</code></pre>\n\n<p>Here my first number is <code>316.28</code> and last number is <code>363.13</code>. I want to created ranges from this array like <code>300 to 400</code>. This is an example using the first and the last element of the array.</p>\n\n<p>I want to make it like <code>300 to 400</code> or <code>100 to 200</code> or <code>10 to 20</code>.</p>\n\n<p>If my number is <code>316.28</code>, I want to return a value <code>300</code> and if my value is <code>363.13</code>, then it should return <code>400</code>.</p>\n\n<p>How can I do that?</p>\n\n<p>I want to round my values if my list of array has three number 2 numbers or 4 numbers such as <code>12.5</code>, <code>123.45</code>, or <code>3900.56</code>. These can be the number and all of my array can have these kind of numbers. If I have to round each number after finding a length, that becomes a nightmare. I need a function which can do the trick.</p>\n"}, {"tags": ["ruby", "selenium", "capybara", "selenium-chromedriver", "google-chrome-headless"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 5, "last_activity_date": 1532532697, "creation_date": 1532532697, "answer_id": 51522736, "question_id": 51516147, "link": "https://stackoverflow.com/questions/51516147/inject-js-file-into-capybara-chrome-headless/51522736#51522736", "title": "Inject JS file into capybara chrome headless", "body": "<p>Neither Capybara nor selenium support this directly, however Chrome does via its DevTools protocol <code>Page.addScriptToEvaluateOnNewDocument</code> command.  If you're running the latest selenium-webdriver and chromedriver it's possible to utilize this but it's not guaranteed to keep working forever since it involves calling the private method <code>bridge</code> on the selenium driver</p>\n\n<pre><code>params = {\n  cmd: 'Page.addScriptToEvaluateOnNewDocument',\n  params: {\n    source: '&lt;The JS you want run before scripts on every page load&gt;'\n  }\n}\npage.driver.browser.send(:bridge).send_command(params)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2817, "user_id": 126183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a16404c28a6c08da086ade177735c22?s=128&d=identicon&r=PG", "display_name": "Martin Gjaldbaek", "link": "https://stackoverflow.com/users/126183/martin-gjaldbaek"}, "is_accepted": false, "score": 0, "last_activity_date": 1571755081, "last_edit_date": 1571755081, "creation_date": 1571751360, "answer_id": 58505568, "question_id": 51516147, "link": "https://stackoverflow.com/questions/51516147/inject-js-file-into-capybara-chrome-headless/58505568#58505568", "title": "Inject JS file into capybara chrome headless", "body": "<p>Instead of injecting a mock js script via the web driver, I could suggest using something like webmock to stub the call to the external js and return a sensible mock that way. This avoids needing to use a private method of Chrome which may change in the future, and can also be used to stub other kinds of external resources.</p>\n"}], "owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 1, "accepted_answer_id": 51522736, "answer_count": 2, "score": 4, "last_activity_date": 1571755081, "creation_date": 1532512966, "question_id": 51516147, "link": "https://stackoverflow.com/questions/51516147/inject-js-file-into-capybara-chrome-headless", "title": "Inject JS file into capybara chrome headless", "body": "<p>I have RSpec with Capybara and Chrome Headless in my tests. For some pages, I load external JS files where other javascripts depends on.</p>\n\n<p>I'd like to make my tests independent of this external JS calls, e.g. when I'm offline they won't work and throw JS errors. Changing the production code (e.g. testing the environment and then load or don't load files or execute scripts) feels extremely ugly, so this won't be an option.</p>\n\n<p>Therefore, I was thinking about injecting some sort of mocking script into the browser on every page visit. The problem is, methods like <code>page.evaluate_script</code> or <code>page.execute_script</code> only run the script when the page is loaded. And at this point, the production JS code already threw an error.</p>\n\n<p>I was searching around trying to find a solution, but I haven't found an option for chrome headless to load a file or execute scripts on every page load.</p>\n\n<p>My setup currently looks like this</p>\n\n<pre><code>Capybara.register_driver :chrome_headless do |app|\n  options = Selenium::WebDriver::Chrome::Options.new\n  options.add_argument(\"no-sandbox\")\n  options.add_argument(\"headless\")\n  options.add_argument(\"disable-gpu\")\n  options.add_argument(\"window-size=1400,1400\")\n\n  capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(\n    acceptInsecureCerts: true\n  )\n\n  Capybara::Selenium::Driver.new(\n    app, browser: :chrome, options: options, desired_capabilities: capabilities\n  )\nend\nCapybara.javascript_driver = :chrome_headless\n</code></pre>\n\n<p>I also tried to build an extension and use it with </p>\n\n<pre><code>options.add_extension(\"spec/support/chrome_extension_test_helper/chrome_extension_test_helper.crx\")\n</code></pre>\n\n<p>but it seems that the extension is not loaded (I added a <code>console.error(\"foobar\")</code> in the extension but nothing is shown. So maybe self signed extensions are not allowed? Furthermore, I would want to build such an extension on the fly without having to pack it through chrome every time I change something.</p>\n\n<p>So, is there a way to load a mock JS file into chrome headless with capybara?=</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "utf-8"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1532510416, "post_id": 51515041, "comment_id": 89998846, "body": "Is there anything weird in <code>bin&#47;rails</code>? Any non-UTF8 characters?"}, {"owner": {"reputation": 151, "user_id": 5568045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e61e6cb6006fa4bf4bb5d2c449d37e4?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan", "link": "https://stackoverflow.com/users/5568045/bogdan"}, "edited": false, "score": 0, "creation_date": 1532510426, "post_id": 51515041, "comment_id": 89998853, "body": "Try this gem <a href=\"https://github.com/whitequark/rack-utf8_sanitizer/\" rel=\"nofollow noreferrer\">github.com/whitequark/rack-utf8_sanitizer</a>"}, {"owner": {"reputation": 21, "user_id": 5906904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-r_Y4EHv26wA/AAAAAAAAAAI/AAAAAAAAAP8/gNPX_z414Kc/photo.jpg?sz=128", "display_name": "Demon", "link": "https://stackoverflow.com/users/5906904/demon"}, "edited": false, "score": 0, "creation_date": 1532543518, "post_id": 51515041, "comment_id": 90019824, "body": "Try this <a href=\"https://stackoverflow.com/questions/14839674/bundle-install-error-invalid-byte-sequence-in-us-ascii-argumenterror\" title=\"bundle install error invalid byte sequence in us ascii argumenterror\">stackoverflow.com/questions/14839674/&hellip;</a>"}], "owner": {"reputation": 381, "user_id": 4857642, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh3.googleusercontent.com/-kwtVmykXWww/AAAAAAAAAAI/AAAAAAAAAEs/rE6ZDFojwyA/photo.jpg?sz=128", "display_name": "Michael Stokes", "link": "https://stackoverflow.com/users/4857642/michael-stokes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532509636, "creation_date": 1532509636, "question_id": 51515041, "link": "https://stackoverflow.com/questions/51515041/cant-start-rails-application-invalid-byte-sequence-in-utf-8-argumenterror", "title": "Can&#39;t start Rails application (invalid byte sequence in UTF-8 (ArgumentError))", "body": "<p>I am having issues starting my rails application. I run <code>rails s</code>, I get the following error:</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 5.0.1 application starting in development on http://localhost:3000\n=&gt; Run `rails server -h` for more startup options\nExiting\nTraceback (most recent call last):\n    14: from bin/rails:4:in `&lt;main&gt;'\n    13: from bin/rails:4:in `require'\n    12: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    11: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n    10: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:85:in `server'\n     9: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:85:in `tap'\n     8: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/commands_tasks.rb:90:in `block in server'\n     7: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/server.rb:77:in `start'\n     6: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/server.rb:124:in `log_to_stdout'\n     5: from /usr/local/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/server.rb:354:in `wrapped_app'\n     4: from /usr/local/lib/ruby/gems/2.5.0/gems/railties-5.0.1/lib/rails/commands/server.rb:59:in `app'\n     3: from /usr/local/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/server.rb:219:in `app'\n     2: from /usr/local/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n     1: from /usr/local/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/builder.rb:36:in `parse_file'\n/usr/local/lib/ruby/gems/2.5.0/gems/rack-2.0.5/lib/rack/builder.rb:36:in `[]': invalid byte sequence in UTF-8 (ArgumentError)\n</code></pre>\n\n<p>I don't know what is going on and why it's happening. I have searched all online for a solution. Can someone help me with this? Thanks. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532510054, "post_id": 51514693, "comment_id": 89998593, "body": "<code>date_select</code> is not able to limit the range. For that try some js date picker/write own"}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1532510664, "post_id": 51514796, "comment_id": 89999033, "body": "<i>&quot;If you do wish to have front-end / client-side validation, look for a JS / jQuery datepicker.&quot;</i> -- <b>This</b> part of your answer is on the right lines. But just saying that &quot;the answer is to not bother&quot; isn&#39;t much help!"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532511057, "post_id": 51514796, "comment_id": 89999320, "body": "I don&#39;t think the standard Rails date picker supports setting max month and/or date, since that would be impossible as it is rendered back-end. But I;ll adapt the answer."}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": false, "score": -2, "last_activity_date": 1532510245, "last_edit_date": 1532510245, "creation_date": 1532508969, "answer_id": 51514796, "question_id": 51514693, "link": "https://stackoverflow.com/questions/51514693/how-to-set-the-max-date-of-being-today-for-date-select-in-rails/51514796#51514796", "title": "How to set the max date of being today for date_select in Rails?", "body": "<p>Don't bother about dates in the future yet. Just ignore such bad entries for now. Best to add a validation to the model that checks whether the submitted <code>date &lt; Date.today</code>. If you do wish to have front-end / client-side validation, look for a JS / jQuery datepicker. These are more easy to configure and support direct inline error messages.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1532511510, "post_id": 51515587, "comment_id": 89999636, "body": "Even with client-side smart UI, a server-side check is a must-have."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532511594, "post_id": 51515587, "comment_id": 89999691, "body": "One could probably do away with <i>just</i> the server-side check. Just emit dynamic validation error: <code>&quot;date: cannot be greater than #{Date.today}&quot;</code>. Not the best UX, but takes two minutes to implement."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 21, "user_id": 10028132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6ebd3c773925eba07f1a6ad2117bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/10028132/jerry"}, "edited": false, "score": 1, "creation_date": 1532532234, "post_id": 51515587, "comment_id": 90014049, "body": "@Jerry Your question <b>has</b> been answered. If you feel that the answer is unsatisfactory, could you provide some feedback that&#39;s a little more constructive than &quot;re-read my question&quot;?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 21, "user_id": 10028132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6ebd3c773925eba07f1a6ad2117bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/10028132/jerry"}, "edited": false, "score": 1, "creation_date": 1532532384, "post_id": 51515587, "comment_id": 90014150, "body": "@Jerry Are you unsure how to implement validations? Or how to implement a JS datepicker? Or maybe the thing you&#39;re looking for is just a chunk of code to blindly copy+paste?"}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": false, "score": 2, "last_activity_date": 1532512493, "last_edit_date": 1532512493, "creation_date": 1532511323, "answer_id": 51515587, "question_id": 51514693, "link": "https://stackoverflow.com/questions/51514693/how-to-set-the-max-date-of-being-today-for-date-select-in-rails/51515587#51515587", "title": "How to set the max date of being today for date_select in Rails?", "body": "<p>Ok, based on the negative points I got on my previous answer, let me explain this a bit more. The Rails datepicker renders three selects, one for day, one for month and one for year. Since this is \"fixed\" there's no option to reduce the amount of days or months. This would not allow you to select a valid date anymore. The only thing you can change is the range of years. You already did that in your sample code.</p>\n\n<p>Now, back to your use case. You'd like to prevent someone inputing a date in the future? Sure. You've got three options:</p>\n\n<ol>\n<li>Only validate this server side, through a model validation and\npresent the user back with the error message: \"birth date should be\nin the past\". Always do this!! </li>\n</ol>\n\n<p>The following are nice-to-haves to add to 1:</p>\n\n<ol start=\"2\">\n<li>Capture form submission through JS, check the submitted date and\nshow error in case the date is invalid</li>\n<li>Change the way you display the date through some kind of\nDatepicker plugin. jQuery UI has a few nice one:\n<a href=\"https://jqueryui.com/datepicker/\" rel=\"nofollow noreferrer\">https://jqueryui.com/datepicker/</a>. This one allows you to better\nconfigure allowed dates, since it is programmed client-side</li>\n</ol>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 10028132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6ebd3c773925eba07f1a6ad2117bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/10028132/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532512493, "creation_date": 1532508672, "last_edit_date": 1532509196, "question_id": 51514693, "link": "https://stackoverflow.com/questions/51514693/how-to-set-the-max-date-of-being-today-for-date-select-in-rails", "title": "How to set the max date of being today for date_select in Rails?", "body": "<p>I have where a person can choose date of birth:</p>\n\n<pre><code>= form.date_select :date_of_birth, start_year: Date.current.year, end_year: Date.current.year - 333\n</code></pre>\n\n<p>I want it to have the maximum date of today. <strong>The max day must be equal to today and max month. Not only year.</strong></p>\n\n<p>I've tried \"min: Date.today\" and \"max: Date.today\" and it didn't work out.</p>\n\n<p>How can I do that?</p>\n"}, {"tags": ["ruby", "windows-10", "side-by-side", "ruby-2.4"], "comments": [{"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1532530040, "post_id": 51513954, "comment_id": 90012464, "body": "<a href=\"https://pastebin.com/ZbfMC41R\" rel=\"nofollow noreferrer\">pastebin.com/ZbfMC41R</a>"}, {"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1533223136, "post_id": 51513954, "comment_id": 90277899, "body": "have you used sxstrace? What do you see in the sxstrace.txt?"}, {"owner": {"reputation": 107, "user_id": 4881841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gR61.png?s=128&g=1", "display_name": "buzzysin", "link": "https://stackoverflow.com/users/4881841/buzzysin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1538762805, "post_id": 51513954, "comment_id": 92271985, "body": "hi there, @magicandre1981 sorry for the late reply - I don&#39;t know where the log file is for Ruby, and also I don&#39;t know how to use the Sxstrace tool"}, {"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1538848922, "post_id": 51513954, "comment_id": 92291954, "body": "my pastebin link shows how to run sxstrace"}, {"owner": {"reputation": 107, "user_id": 4881841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gR61.png?s=128&g=1", "display_name": "buzzysin", "link": "https://stackoverflow.com/users/4881841/buzzysin"}, "reply_to_user": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 0, "creation_date": 1539333283, "post_id": 51513954, "comment_id": 92472704, "body": "Thank you @magicandre1981, I will definitely try this when I get the time. Thanks for your patience (and perseverance)"}], "owner": {"reputation": 107, "user_id": 4881841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gR61.png?s=128&g=1", "display_name": "buzzysin", "link": "https://stackoverflow.com/users/4881841/buzzysin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532506311, "creation_date": 1532506311, "question_id": 51513954, "link": "https://stackoverflow.com/questions/51513954/ruby-side-by-side-error-sxstrace", "title": "Ruby side-by-side error (sxstrace)", "body": "<p><strong>Apologies in advance for the messy question</strong>. </p>\n\n<p>I have a problem after installing Ruby 2.4.4-x64 with MYSYS2 from the site.</p>\n\n<p>Running <code>ruby -v</code> from the command prompt gives this error:</p>\n\n<pre><code>The application has failed to start because its side-by-side configuration is \nincorrect. Please see the application event log or use the command-line \nsxstrace.exe tool for more detail.\n</code></pre>\n\n<p>Here is the error from the event viewer:</p>\n\n<pre><code>Activation context generation failed for \"C:\\WINDOWS\\system32\\ruby.exe\". \nDependent Assembly ruby_builtin_dlls,type=\"win32\",version=\"1.0.0.0\" could not \nbe found. Please use sxstrace.exe for detailed diagnosis.\n</code></pre>\n\n<p>Not knowing how to use sxstrace, I decided to freshly install Ruby, but the same error persists. Some forums suggested installing <code>Microsoft Visual C++ 2008 Redistributable (x86)</code> but this has no effect on my PC.</p>\n\n<p>Info</p>\n\n<ol>\n<li><code>gem</code> and <code>irb</code> work if called, but <code>ruby -v</code> does not.</li>\n<li>PC info - Lenovo ThinkPad T420, Windows 10 Home x64.</li>\n<li>Worked fine on old laptop</li>\n</ol>\n\n<p>Path variable (if relevant):</p>\n\n<pre><code>C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;\nC:\\ProgramData\\Oracle\\Java\\javapath;\nC:\\WINDOWS\\system32;\nC:\\WINDOWS;\nC:\\WINDOWS\\System32\\Wbem;\nC:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;\nC:\\WINDOWS\\System32\\OpenSSH\\;\nC:\\Windows;C:\\Users\\okait\\AppData\\Local\\Programs\\Python\\Python37-32;\nC:\\Program Files (x86)\\Intel\\OpenCL SDK\\2.0\\bin\\x86;\nC:\\Program Files (x86)\\Intel\\OpenCL SDK\\2.0\\bin\\x64;\nC:\\Program Files\\Java\\jdk1.8.0_51\\bin;\nC:\\Program Files\\Java\\jre1.8.0_51\\bin;\nC:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;\nC:\\ProgramData\\Oracle\\Java\\javapath;\nC:\\WINDOWS\\system32;\nC:\\WINDOWS;\nC:\\WINDOWS\\System32\\Wbem;\nC:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;\nC:\\WINDOWS\\System32\\OpenSSH\\;\nC:\\Windows;\nC:\\Users\\okait\\AppData\\Local\\Programs\\Python\\Python37-32;\nC:\\Program Files (x86)\\Intel\\OpenCL SDK\\2.0\\bin\\x86;\nC:\\Program Files (x86)\\Intel\\OpenCL SDK\\2.0\\bin\\x64;\nC:\\Program Files\\Java\\jdk1.8.0_51\\bin;\nC:\\Program Files\\Java\\jre1.8.0_51\\bin;\nC:\\Ruby24-x64\\bin;\nC:\\Users\\okait\\AppData\\Local\\Microsoft\\WindowsApps;\n</code></pre>\n\n<p>Sidenote:</p>\n\n<p>(I <em>may</em> have had to copy <code>ruby.exe</code> into the <code>system32</code> folder which was the only way for me to get it to respond in any way, otherwise the command prompt stalls and does not respond.)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532499999, "post_id": 51511799, "comment_id": 89992647, "body": "In <code>link_to &#39;Destroy&#39;, category_product_path(product)</code>, what is <code>product</code>?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532500136, "post_id": 51511799, "comment_id": 89992713, "body": "Why do you have <code>GET &#47;categories&#47;:id&#47;products&#47;new</code> if you already defined a route as <code>GET &#47;categories&#47;:category_id&#47;products&#47;new</code>? Same for other 3 routes below it."}], "answers": [{"comments": [{"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "reply_to_user": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532499981, "post_id": 51511850, "comment_id": 89992640, "body": "Could you post the current error message while using the above code?"}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532500148, "post_id": 51511850, "comment_id": 89992717, "body": "It is exactly the same."}, {"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "reply_to_user": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532500668, "post_id": 51511850, "comment_id": 89992982, "body": "Answer edited. Try <code>category_product_path(product, category_id: product.category.id)</code>"}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532500894, "post_id": 51511850, "comment_id": 89993117, "body": "I actually solved the url problem - using resources, shallow: true I am able to now just use &#39;product&#39;!  Thank you.  However I now have a &#39;destroy&#39; method error which I will post."}], "tags": [], "owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "is_accepted": true, "score": 0, "last_activity_date": 1532500621, "last_edit_date": 1532500621, "creation_date": 1532498718, "answer_id": 51511850, "question_id": 51511799, "link": "https://stackoverflow.com/questions/51511799/cannot-delete-item-in-database-and-views/51511850#51511850", "title": "Cannot delete item in database and views", "body": "<p>As it is a nested route, you need to pass category id in the route. like:</p>\n\n<pre><code>&lt;%= link_to 'Destroy', category_product_path(product, category_id: category.id), method: :delete, data: { confirm: 'Are you sure?' } %&gt;\n</code></pre>\n\n<p>Here, in the route <code>category_product_path(product, category_id: category.id)</code>, <strong>category</strong> is the category under which the <strong>product</strong> belongs. </p>\n\n<p>You can also use <code>category_product_path(product, category_id: product.category.id)</code> as the delete route.</p>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1532501762, "post_id": 51512539, "comment_id": 89993555, "body": "If you found a fix for your problem, consider adding it as an answer and <b>not</b> an <i>edit</i> in the question itself."}], "tags": [], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1532502336, "last_edit_date": 1532502336, "creation_date": 1532501575, "answer_id": 51512539, "question_id": 51511799, "link": "https://stackoverflow.com/questions/51511799/cannot-delete-item-in-database-and-views/51512539#51512539", "title": "Cannot delete item in database and views", "body": "<p>Using </p>\n\n<pre><code>resources :categories do\n  resources :products, shallow: true\n</code></pre>\n\n<p>I was able to just use 'product' as the url/path</p>\n"}], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 51511850, "answer_count": 2, "score": 0, "last_activity_date": 1532511851, "creation_date": 1532498528, "last_edit_date": 1532501510, "question_id": 51511799, "link": "https://stackoverflow.com/questions/51511799/cannot-delete-item-in-database-and-views", "title": "Cannot delete item in database and views", "body": "<p>I have two tables categories, products.  Products has foreign key category.  I am trying to delete (in views) through index.html.erb in products with below code:</p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to 'Destroy', category_product_path(product), method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>however all this does is leave the following error:</p>\n\n<pre><code>No route matches [DELETE] \"/categories/product/products\"\n</code></pre>\n\n<p>First, why am I getting this error, there is not a '/categories/product/products' url anywhere in routes or rake routes?  Below is the rake routes command (left out devise routes):</p>\n\n<pre><code>category_products GET    /categories/:category_id/products(.:format)                                              products#index\n                      POST   /categories/:category_id/products(.:format)                                              products#create\n new_category_product GET    /categories/:category_id/products/new(.:format)                                          products#new\nedit_category_product GET    /categories/:category_id/products/:id/edit(.:format)                                     products#edit\n     category_product GET    /categories/:category_id/products/:id(.:format)                                          products#show\n                      PATCH  /categories/:category_id/products/:id(.:format)                                          products#update\n                      PUT    /categories/:category_id/products/:id(.:format)                                          products#update\n                      DELETE /categories/:category_id/products/:id(.:format)                                          products#destroy\n           categories GET    /categories(.:format)                                                                    categories#index\n                      POST   /categories(.:format)                                                                    categories#create\n         new_category GET    /categories/new(.:format)                                                                categories#new\n        edit_category GET    /categories/:id/edit(.:format)                                                           categories#edit\n             category GET    /categories/:id(.:format)                                                                categories#show\n                      PATCH  /categories/:id(.:format)                                                                categories#update\n                      PUT    /categories/:id(.:format)                                                                categories#update\n                      DELETE /categories/:id(.:format)                                                                categories#destroy\n       categories_new GET    /categories/new(.:format)                                                                categories#new\n                      POST   /categories/:id(.:format)                                                                categories#create\n                      GET    /categories(.:format)                                                                    categories#index\n                      DELETE /categories/:id(.:format)                                                                categories#destroy\n                      GET    /categories/:id/products/new(.:format)                                                   products#new\n                      POST   /categories/:id/products/:id(.:format)                                                   products#create\n                      GET    /categories/:id/products(.:format)                                                       products#index\n                      DELETE /categories/:id/products/:id(.:format)                                                   products#destroy\n</code></pre>\n\n<p>EDIT:  This was solved by placing :</p>\n\n<pre><code>resources :categories do\n  resources :products, shallow: true\nend\n</code></pre>\n\n<p>in routes.rb, allowing only 'product' in the 'delete' link...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532497164, "post_id": 51511461, "comment_id": 89991410, "body": "You could always change it to POST if the limitation is a problem. There you have &quot;unlimited&quot; space. But what are you trying to achieve here, because I&#39;ve never run into such a situation?"}, {"owner": {"reputation": 263, "user_id": 1317482, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/67c8af56d3d1b0fb756a18f0be21c943?s=128&d=identicon&r=PG", "display_name": "Berimbolo", "link": "https://stackoverflow.com/users/1317482/berimbolo"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532497280, "post_id": 51511461, "comment_id": 89991461, "body": "Let&#39;s say I have a list of users that needs to be processed for something, I have already made some queries to sort them out but now I need to pass them via ajax to for another process. Currently it&#39;s working but my main concern is that if this gets too big I might run into some limitation issues"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 1, "creation_date": 1532501134, "post_id": 51511461, "comment_id": 89993229, "body": "Use a Ajax POST / PATCH instead. You won&#39;t run into any issues with size, and it&#39;s best practice when sending data other than a single ID."}], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 0, "last_activity_date": 1532505055, "creation_date": 1532505055, "answer_id": 51513571, "question_id": 51511461, "link": "https://stackoverflow.com/questions/51511461/limitations-in-passing-a-huge-list-of-id-array-in-parameters/51513571#51513571", "title": "Limitations in passing a huge list of ID array in parameters", "body": "<p>There is no thumb rule made for the maximum URL size of HTTP Get Request as per RFC 2616 (Hypertext Transfer Protocol \u2014 HTTP/1.1 \u2013 Section 3.2.1).</p>\n\n<p>Limits are imposed by <strong>various browsers</strong> and respective servers.</p>\n\n<p>Just use plain POST request with JSON body.</p>\n"}], "owner": {"reputation": 263, "user_id": 1317482, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/67c8af56d3d1b0fb756a18f0be21c943?s=128&d=identicon&r=PG", "display_name": "Berimbolo", "link": "https://stackoverflow.com/users/1317482/berimbolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532505055, "creation_date": 1532496907, "last_edit_date": 1532498130, "question_id": 51511461, "link": "https://stackoverflow.com/questions/51511461/limitations-in-passing-a-huge-list-of-id-array-in-parameters", "title": "Limitations in passing a huge list of ID array in parameters", "body": "<p>I was wondering if there are any issues/consequences when passing a huge chunk of id array via parameter. There is a browser url limitation, but what if I send the request via <code>ajax</code> <code>http</code> <code>get</code>? Are there still any possible limitation problems like for example the following?</p>\n\n<pre><code>@users = User.all\nmy_method_path(:user_ids =&gt; @users.pluck(:id))\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "include"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532494928, "post_id": 51510571, "comment_id": 89990696, "body": "Can&#39;t you just add <code>include Util::FindInBatchesWithOrder</code> in the ApplicationRecord class (rails 5) or ActiveRecord::Base class (rails 4) instead? That should make it available as an instance method for a model."}, {"owner": {"reputation": 1, "user_id": 9960405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bN2KxJd_qeI/AAAAAAAAAAI/AAAAAAAAmm0/h9r3S3pgIWM/photo.jpg?sz=128", "display_name": "heroyct", "link": "https://stackoverflow.com/users/9960405/heroyct"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532498321, "post_id": 51510571, "comment_id": 89991908, "body": "@bo-oz Thanks, Yes, add include ActiveRecord::Base is works great. I want to know why include is not work, but write in ActiveRecord:: Batches is works great."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532501187, "post_id": 51510571, "comment_id": 89993253, "body": "Because your model doesn&#39;t inherit from the Batches class I guess."}], "owner": {"reputation": 1, "user_id": 9960405, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bN2KxJd_qeI/AAAAAAAAAAI/AAAAAAAAmm0/h9r3S3pgIWM/photo.jpg?sz=128", "display_name": "heroyct", "link": "https://stackoverflow.com/users/9960405/heroyct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532498099, "creation_date": 1532491003, "last_edit_date": 1532498099, "question_id": 51510571, "link": "https://stackoverflow.com/questions/51510571/how-do-i-add-a-method-to-activerecordbatches-use-include", "title": "How do I add a method to ActiveRecord::Batches use include", "body": "<p>environment: rails 4.2, ruby 2.2.0</p>\n\n<p>I was trying to add function something like find_each, but order by id descending.<br>\nI want to use it like this.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Person.where('age &gt; 30').find_each_desc.each do |person|\nend\n</code></pre>\n\n<p>I add method to ActiveRecord::Batches, it works great.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># file config/initializers/active_record.rb \nmodule ActiveRecord\n  module Batches\n    def find_each_desc(options = {})\n      # do something\n    end\n  end\nend\n</code></pre>\n\n<p>But if move to anthoer module, use include to add method, it's not working.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># file util/find_in_batches_with_order.rb\nmodule Util\n  module FindInBatchesWithOrder\n    def find_each_desc(options = {})\n      # do something\n    end\n  end\nend\n\n# file config/initializers/active_record.rb \nmodule ActiveRecord\n  module Batches\n    include Util::FindInBatchesWithOrder\n  end\nend\n\n# can get find_each_desc method\n$ ActiveRecord::Batches.instance_methods\n=&gt; [:find_each, :find_in_batches, :find_each_desc]\n</code></pre>\n\n<p>ActiveRecord::Relation include ActiveRecord::Batches, so can find find_each_desc method in ActiveRecord::Relation instance methods, but not.</p>\n\n<p>How should I do?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532488397, "post_id": 51510176, "comment_id": 89989408, "body": "Say more about &quot;will not work&quot;."}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532489582, "post_id": 51510176, "comment_id": 89989601, "body": "I am trying to add products to categories, within the site, however nothing is stored inthe database because it gives an error message saying that category must exist, I presume because :category_id in products table remains empty, I would like it to populate with the associated category_id from which I am creating a product..."}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532492668, "post_id": 51510176, "comment_id": 89990160, "body": "actually all I want is primary key :category_id on categories, and foreign key :category_id on products, so that I may associate tables."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532492827, "post_id": 51510176, "comment_id": 89990187, "body": "Why are you using <code>category_id</code> as the primary key on <code>categories</code> instead of the conventional <code>id</code>?"}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532493046, "post_id": 51510176, "comment_id": 89990233, "body": "i&#39;m not sure how to associate tables from :id to :id to each, does rails create category_id?  In other words, how would i associate tables from :id to :id from categories to products?"}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1532493358, "post_id": 51510176, "comment_id": 89990310, "body": "You can just reference the model name....<code>t.references :category, foreign_key: true</code>, and keep the default primary key"}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532493758, "post_id": 51510176, "comment_id": 89990411, "body": "How do I include the category_id &lt;- correct? in my products_controller?"}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1532502971, "post_id": 51510176, "comment_id": 89994203, "body": "In what context? Please post your products controller so people can answer the question...but, for a common answer, you can grab the product&#39;s category with <code>@category = @product.category</code>, or, if you need to grab the category from params...<code>@category = Category.find(params[:category_id])</code>."}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532505672, "post_id": 51510176, "comment_id": 89995781, "body": "Yes, that is the answer!"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1532505837, "creation_date": 1532505837, "answer_id": 51513806, "question_id": 51510176, "link": "https://stackoverflow.com/questions/51510176/rails-5-2-migrations-conundrum-create-primary-key-and-foreign-keys/51513806#51513806", "title": "Rails 5.2 migrations conundrum, create primary key and foreign keys", "body": "<p>The answer to this is to remove t.integer :category_id, and rely on rails' :id column for each table, references can be made with @category or with @product, and as mentioned in the comments - @category = Cateogory.find(params[:id]) or Category.find(params[:category_id]) as I believe that is how it is referenced in routes.   Thank you.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1532508523, "creation_date": 1532508523, "answer_id": 51514647, "question_id": 51510176, "link": "https://stackoverflow.com/questions/51510176/rails-5-2-migrations-conundrum-create-primary-key-and-foreign-keys/51514647#51514647", "title": "Rails 5.2 migrations conundrum, create primary key and foreign keys", "body": "<p>Ruby on Rails embraces the <em>convention over configuration</em> principle. That means if you follow the Rails conventions things will be much easier and almost no configuration is needed.</p>\n\n<p>In your migrations you decided to fight one of the Rails conventions: The primary key of a database is stored in an <code>id</code> column. When you decide to not follow this convention then you cannot simply use the <code>references</code> method anymore without telling Rails how you set up your database instead.</p>\n\n<p>My advice is: Unless you have a very, very good reason, do not fight against Rails conventions. It will not only make this task (database migration) more complex, but it also increased the risk that something else needs more configuration (ActiveRecord models for example) or that things might break in gems or when you update Rails to a newer version.</p>\n\n<p>That said: Change your migration to use the Rails conventions:</p>\n\n<pre><code># 20180724203015_create_categories.rb\nclass CreateCategories &lt; ActiveRecord::Migration[5.2]\n   def change\n    create_table :categories do |t| # &lt;- create an `id` column per default\n      t.string :name\n      t.text :description\n\n      t.timestamps\n    end\n  end\nend\n\n# 20180724203105_create_products.rb\nclass CreateProducts &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :products do |t|\n      t.references :category, foreign_key: true # &lt;- just name the relation\n\n      t.string :name\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1532508523, "creation_date": 1532487512, "last_edit_date": 1532492609, "question_id": 51510176, "link": "https://stackoverflow.com/questions/51510176/rails-5-2-migrations-conundrum-create-primary-key-and-foreign-keys", "title": "Rails 5.2 migrations conundrum, create primary key and foreign keys", "body": "<p>I cannot figure out what is wrong with my migrations, but they won't work, trying to add foreign key on products from primary key in categories\n20180724203015_create_categories.rb </p>\n\n<pre><code>class CreateCategories &lt; ActiveRecord::Migration[5.2]\n   def change\n    create_table :categories, id: false do |t|\n      t.string :name\n      t.text :description\n      t.integer :category_id, primary_key: true, auto_increment: true\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>20180724203105_create_products.rb</p>\n\n<pre><code> class CreateProducts &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :products do |t|\n\n      t.string :name\n      t.references :category_id, foreign_key: true, index: true\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>however this always ends with an error, cannot add foreign key contraint</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "erb"], "answers": [{"tags": [], "owner": {"reputation": 477, "user_id": 72635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e620537859cbb0954eb8639d2afd502?s=128&d=identicon&r=PG", "display_name": "Parthan", "link": "https://stackoverflow.com/users/72635/parthan"}, "is_accepted": false, "score": 1, "last_activity_date": 1532498056, "creation_date": 1532498056, "answer_id": 51511705, "question_id": 51510005, "link": "https://stackoverflow.com/questions/51510005/how-to-use-a-css-class-in-an-erb-do-statement-ruby-on-rails/51511705#51511705", "title": "How To Use A CSS Class in an ERB Do Statement | Ruby on Rails", "body": "<p>Check out the documentation for <a href=\"https://api.rubyonrails.org/v5.2/classes/ActionView/Helpers/UrlHelper.html\" rel=\"nofollow noreferrer\">link_to</a></p>\n\n<p>It also has this example,</p>\n\n<pre><code>link_to \"Articles\", articles_path, id: \"news\", class: \"article\"\n# =&gt; &lt;a href=\"/articles\" class=\"article\" id=\"news\"&gt;Articles&lt;/a&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 807, "user_id": 1688322, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/cZ6Ai.jpg?s=128&g=1", "display_name": "Robin van Dijk", "link": "https://stackoverflow.com/users/1688322/robin-van-dijk"}, "is_accepted": true, "score": 0, "last_activity_date": 1532503740, "creation_date": 1532503740, "answer_id": 51513175, "question_id": 51510005, "link": "https://stackoverflow.com/questions/51510005/how-to-use-a-css-class-in-an-erb-do-statement-ruby-on-rails/51513175#51513175", "title": "How To Use A CSS Class in an ERB Do Statement | Ruby on Rails", "body": "<p>Try the following.</p>\n\n<pre><code>&lt;%= link_to(something_path, class: \"classname\") do %&gt;\n  &lt;div&gt;Stuff&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 51513175, "answer_count": 2, "score": 0, "last_activity_date": 1532697428, "creation_date": 1532485808, "question_id": 51510005, "link": "https://stackoverflow.com/questions/51510005/how-to-use-a-css-class-in-an-erb-do-statement-ruby-on-rails", "title": "How To Use A CSS Class in an ERB Do Statement | Ruby on Rails", "body": "<p>I have a do statement in my view and was wondering how to format the code properly to use a class like other elements?</p>\n\n<pre><code>&lt;%= link_to something_path do %&gt;\n  &lt;div&gt;Stuff&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I tried to do it like most ERB, adding the class to the end of the statement:</p>\n\n<pre><code>&lt;%= link_to something_path do, class: \"classname\" %&gt;\n</code></pre>\n\n<p>That didn't work so I tried to do it like an <code>image_tag</code>:</p>\n\n<pre><code>&lt;%= link_to(something_path do, class: \"classname\") %&gt;\n</code></pre>\n\n<p>Where does <code>class:</code> fit into this line of code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1611, "user_id": 3810466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JUvyo.png?s=128&g=1", "display_name": "ricky3350", "link": "https://stackoverflow.com/users/3810466/ricky3350"}, "edited": false, "score": 1, "creation_date": 1532491982, "post_id": 51509728, "comment_id": 89990008, "body": "Usually, when someone writes in all caps, it is supposed to be interpreted as shouting. Are you shouting at us? If not, please <a href=\"https://stackoverflow.com/posts/51509728/edit\">edit your post</a>."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1532484299, "creation_date": 1532484299, "answer_id": 51509843, "question_id": 51509728, "link": "https://stackoverflow.com/questions/51509728/how-to-use-gem-cryptocompare-in-ruby-on-rails/51509843#51509843", "title": "How to use gem cryptocompare in ruby on rails?", "body": "<p>You're storing the wrong data in your <code>@coinlists</code>. According to the gem's documentation, what you should be storing is actually the <code>\"Data\"</code> key.</p>\n\n<p>In your controller action, it should be like this:</p>\n\n<pre><code>def index\n  ...\n  @coinlists = Cryptocompare::CoinList.all[\"Data\"]\nend\n</code></pre>\n\n<p>In your view:</p>\n\n<pre><code>&lt;% @coinlists.values.each do |coin| %&gt;\n  &lt;%= coin[\"Name\"] %&gt;\n  &lt;%= coin[\"Symbol\"] %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You should learn more about how <a href=\"https://api.rubyonrails.org/classes/Hash.html\" rel=\"nofollow noreferrer\">hashes</a> work in Rails. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10136423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrjCF.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10136423/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1532575977, "creation_date": 1532575977, "answer_id": 51530604, "question_id": 51509728, "link": "https://stackoverflow.com/questions/51509728/how-to-use-gem-cryptocompare-in-ruby-on-rails/51530604#51530604", "title": "How to use gem cryptocompare in ruby on rails?", "body": "<p>Also, you may prefer <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-each_value\" rel=\"nofollow noreferrer\">Hash#each_value</a> -- it avoids unnecessary Array allocation incurred by <code>@coinlists.values.each { |coin| ... }</code>.</p>\n\n<p>You might refer to these generally useful <a href=\"https://github.com/JuanitoFatas/fast-ruby#hasheach_key-instead-of-hashkeyseach-code\" rel=\"nofollow noreferrer\">performance optimisations</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6886123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtuvV.jpg?s=128&g=1", "display_name": "geniusmind", "link": "https://stackoverflow.com/users/6886123/geniusmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 51509843, "answer_count": 2, "score": 0, "last_activity_date": 1532575977, "creation_date": 1532483157, "last_edit_date": 1532493789, "question_id": 51509728, "link": "https://stackoverflow.com/questions/51509728/how-to-use-gem-cryptocompare-in-ruby-on-rails", "title": "How to use gem cryptocompare in ruby on rails?", "body": "<p>I am a newbie to Ruby. I am building a crypto news site. I want to use gem cryptocompare (<a href=\"https://github.com/alexanderdavidpan/cryptocompare\" rel=\"nofollow noreferrer\">https://github.com/alexanderdavidpan/cryptocompare</a>) which uses cryptocompare's API but I am lost. </p>\n\n<p>I need help. </p>\n\n<p>Thanks in advance. </p>\n\n<p>The documentation uses module like functions for example:</p>\n\n<p><strong>gem screenshot</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/lqUdi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lqUdi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My controller is like this:</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n\n    before_action :authenticate_user!\n    before_action :find_post, only: [:show, :edit, :update, :destroy, :like]\n#   before_action :owned_post, only: [:edit, :update, :destroy]    \n\n    def index\n\n        @posts = Post.of_followed_users(current_user.following).order('created_at DESC').page params[:page]\n        @posts = Post.all.order('created_at DESC').page params[:page]\n        @coinlists = Cryptocompare::CoinList.all\n\n        @my_coins = []\n        @coinlists.each {|coin| @my_coins.push(coin) }\n\n    end\n</code></pre>\n\n<p>And my view like this:</p>\n\n<pre><code>&lt;% @my_coins.each {|coin| puts coin } %&gt;\n</code></pre>\n\n<p>Problem is that nothing happens; don't know what to do to fix this. When I use this other iteration, it throws error:</p>\n\n<p>Method</p>\n\n<pre><code>def index\n\n@coinlists = Cryptocompare::CoinList.all      \n@my_coins = []\n\n        @coinlists.each do |coin|\n            coin[\"Name\"]\n            coin[\"Symbol\"]\n            @my_coins.push(coin)\n        end\nend\n</code></pre>\n\n<p>in my View</p>\n\n<pre><code>&lt;% @my_coins.each_with_index do |coin, index| %&gt;\n\n         &lt;%= coin[\"Name\"] %&gt;\n         &lt;%= coin[\"Symbol\"] %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>See the <strong>error</strong> below:</p>\n\n<blockquote>\n  <p>TypeError in PostsController#index no implicit conversion of String\n  into Integer</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532483902, "post_id": 51509653, "comment_id": 89988668, "body": "Thank you, its just the routes are very similar and typos easy to make, thank you."}], "tags": [], "owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1532482209, "creation_date": 1532482209, "answer_id": 51509653, "question_id": 51509632, "link": "https://stackoverflow.com/questions/51509632/rails-5-2-products-new-html-erb-having-real-problems-adding-product/51509653#51509653", "title": "Rails 5.2 /products/new.html.erb having real problems adding product", "body": "<p>Your <code>form_for</code> url is wrong. You should be using the route that points to <code>products#create</code>, which also has the <code>POST</code> verb that is used in forms</p>\n\n<pre><code>&lt;%= form_for :product, as: :post, url: category_products_path do |form| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 51509653, "answer_count": 1, "score": 0, "last_activity_date": 1532482209, "creation_date": 1532482000, "question_id": 51509632, "link": "https://stackoverflow.com/questions/51509632/rails-5-2-products-new-html-erb-having-real-problems-adding-product", "title": "Rails 5.2 /products/new.html.erb having real problems adding product", "body": "<p>OK, I have asked regarding a similar issue, but this is a problem with the views.  I have played with form_for for several hours and cannot quite get it right.  Wondering if anyone can point out obvioius mistakes...</p>\n\n<p>/products/new.html.erb:</p>\n\n<pre><code>&lt;h1&gt;New Product&lt;/h1&gt;\n\n&lt;%= form_for :product, as: :post, url: category_product_path(:product) do |form| %&gt;\n  &lt;% if @product.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@product.errors.count, \"error\") %&gt; prohibited this product from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @product.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n &lt;div class=\"field\"&gt;\n   &lt;%= form.label :name %&gt;\n   &lt;%= form.text_field :name %&gt;\n &lt;/div&gt;\n\n &lt;div class=\"field\"&gt;\n   &lt;%= form.label :category_id %&gt;\n   &lt;%= form.text_field :category_id %&gt;\n &lt;/div&gt;\n\n &lt;div class=\"actions\"&gt;\n   &lt;%= form.submit %&gt;\n &lt;/div&gt;\n &lt;% end %&gt;\n\n\n &lt;%= link_to 'Back', category_products_path %&gt;\n</code></pre>\n\n<p>and my routes.rb:</p>\n\n<pre><code>category_products GET    /categories/:category_id  /products(.:format)                                              products#index\n                      POST   /categories/:category_id/products(.:format)                                              products#create\n new_category_product GET    /categories/:category_id/products/new(.:format)                                          products#new\n edit_category_product GET    /categories/:category_id/products/:id/edit(.:format)                                     products#edit\n     category_product GET    /categories/:category_id/products/:id(.:format)                                          products#show\n                      PATCH  /categories/:category_id/products/:id(.:format)                                          products#update\n                      PUT    /categories/:category_id/products/:id(.:format)                                          products#update\n                      DELETE /categories/:category_id/products/:id(.:format)                                          products#destroy\n           categories GET    /categories(.:format)                                                                    categories#index\n                      POST   /categories(.:format)                                                                    categories#create\n         new_category GET    /categories/new(.:format)                                                                categories#new\n        edit_category GET    /categories/:id/edit(.:format)                                                           categories#edit\n             category GET    /categories/:id(.:format)                                                                categories#show\n                      PATCH  /categories/:id(.:format)                                                                categories#update\n                      PUT    /categories/:id(.:format)                                                                categories#update\n                      DELETE /categories/:id(.:format)                                                                categories#destroy\n</code></pre>\n\n<p>and the error message:</p>\n\n<pre><code>ActionView::Template::Error (No route matches {:action=&gt;\"show\", :category_id=&gt;:product, :controller=&gt;\"products\"}, missing required keys: [:id])\n</code></pre>\n\n<p>isn't column :id created when the migration occurs - I have a typical migration file with t.string :name and t.text :description, and nothing else. </p>\n"}, {"tags": ["ruby", "database", "ms-access", "odbc", "connection-string"], "comments": [{"owner": {"reputation": 581, "user_id": 9822083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7oFg.png?s=128&g=1", "display_name": "Jett", "link": "https://stackoverflow.com/users/9822083/jett"}, "edited": false, "score": 0, "creation_date": 1532481613, "post_id": 51509589, "comment_id": 89988207, "body": "(Also, apology in advance if this is a very rudimentary question - I have just started learning Ruby)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532542955, "post_id": 51509589, "comment_id": 90019587, "body": "While it appears you have already asked this question <a href=\"https://stackoverflow.com/questions/51475118/connecting-ruby-and-ms-access-using-odbc\" title=\"connecting ruby and ms access using odbc\">stackoverflow.com/questions/51475118/&hellip;</a> (Maybe delete one of them). <a href=\"https://github.com/RDBI/rdbi-driver-odbc\" rel=\"nofollow noreferrer\"><code>rdbi-driver-odbc</code></a> can make ODBC connections to access using a dsn"}, {"owner": {"reputation": 581, "user_id": 9822083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7oFg.png?s=128&g=1", "display_name": "Jett", "link": "https://stackoverflow.com/users/9822083/jett"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532566853, "post_id": 51509589, "comment_id": 90027360, "body": "ahh my apologies - I improved the question on this post and simply forgot to delete my previous post. Thank you!"}], "owner": {"reputation": 581, "user_id": 9822083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7oFg.png?s=128&g=1", "display_name": "Jett", "link": "https://stackoverflow.com/users/9822083/jett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532481581, "creation_date": 1532481581, "question_id": 51509589, "link": "https://stackoverflow.com/questions/51509589/odbc-connection-with-ms-access-in-ruby-accdb", "title": "ODBC connection with MS Access in Ruby (.accdb)", "body": "<p>I have a .accdb file (from Microsoft Access) that would connect to ODBC database and read data in my Ruby file (C:/Documents/foo.rb)</p>\n\n<p>[In case this information is necessary, I'm using Windows 10 and MS Access 2010 and would like to connect to .accdb file]</p>\n\n<p>From <a href=\"https://www.connectionstrings.com/access-2010/\" rel=\"nofollow noreferrer\">this website: Connection Strings</a>, I found this bit of code but it's not in Ruby:</p>\n\n<pre><code>Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=C:\\mydatabase.accdb;\nUid=Admin;Pwd=;\n</code></pre>\n\n<p>And from <a href=\"https://stackoverflow.com/questions/1120225/ruby-and-accdb-ms-access\">this stackoverflow question</a>, someone provides excellent code in Ruby but it's using the ACE engine instead of ODBC:</p>\n\n<pre><code>require 'win32ole'\nconnection = WIN32OLE.new('ADODB.Connection')\nconnection.Open('Provider=Microsoft.ACE.OLEDB.12.0;\n                 Data Source=c:\\path\\filename.accdb')\n</code></pre>\n\n<p>This <a href=\"https://stackoverflow.com/questions/14146134/odbc-with-ruby-connection-string\">Stackflowquestion</a> uses the JET engine (also in Ruby):</p>\n\n<pre><code>require 'sequel'\n\nDir['*.mdb'].each{|mdb|\n    print \"Check #{mdb}\"\n    @db = Sequel.ado(:conn_string=&gt;\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=#{mdb}\")\n    begin\n        @db.test_connection \n        puts \" ok\"\n    rescue Sequel::DatabaseConnectionError\n        puts \" error\"\n    end\n}\n</code></pre>\n\n<p>I feel like I'm very close to finding the connection string but I've looked online and couldn't improve what I already have. I would very much appreciate a connection in Ruby that connects .accdb files in ODBC database.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 9329834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b242c08da59ff77cbdac97d3dd728e5?s=128&d=identicon&r=PG&f=1", "display_name": "akorn3000", "link": "https://stackoverflow.com/users/9329834/akorn3000"}, "edited": false, "score": 1, "creation_date": 1532479793, "post_id": 51509389, "comment_id": 89987797, "body": "Yes! That works! For some reason I didn&#39;t consider using &#39;Category.find....&quot; from within my Articles controller. Thank you!"}], "tags": [], "owner": {"reputation": 317, "user_id": 10125204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6b8e492fee0d2e224721dc1f73723cc?s=128&d=identicon&r=PG", "display_name": "WebD", "link": "https://stackoverflow.com/users/10125204/webd"}, "is_accepted": true, "score": 1, "last_activity_date": 1532479543, "creation_date": 1532479543, "answer_id": 51509389, "question_id": 51509361, "link": "https://stackoverflow.com/questions/51509361/i-have-a-rails-blog-where-articles-can-have-multiple-categories-how-do-i-struc/51509389#51509389", "title": "I have a rails blog where articles can have multiple categories - how do I structure my ArticlesController index action to match on given category id?", "body": "<p>Try this: <code>Category.find(id).articles</code>\nc.f: <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</a></p>\n"}], "owner": {"reputation": 219, "user_id": 9329834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b242c08da59ff77cbdac97d3dd728e5?s=128&d=identicon&r=PG&f=1", "display_name": "akorn3000", "link": "https://stackoverflow.com/users/9329834/akorn3000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 51509389, "answer_count": 1, "score": 0, "last_activity_date": 1532480353, "creation_date": 1532479302, "last_edit_date": 1532480353, "question_id": 51509361, "link": "https://stackoverflow.com/questions/51509361/i-have-a-rails-blog-where-articles-can-have-multiple-categories-how-do-i-struc", "title": "I have a rails blog where articles can have multiple categories - how do I structure my ArticlesController index action to match on given category id?", "body": "<p>So I have a rails blog where articles can have many categories and categories can have many articles, bridging through an ArticleTags join table like so: </p>\n\n<pre><code>class Article &lt; ApplicationRecord\n  ...\n  has_many :article_tags,\n    primary_key: :id,\n    foreign_key: :article_id,\n    class_name: 'ArticleTag'\n\n  has_many :categories,\n    through: :article_tags,\n    source: :category\nend\n\nclass Category &lt; ApplicationRecord\n  ...\n  has_many :article_tags,\n    primary_key: :id,\n    foreign_key: :category_id,\n    class_name: 'ArticleTag'\n\n  has_many :articles,\n    through: :article_tags,\n    source: :article\nend\n\nclass ArticleTag &lt; ApplicationRecord\n  belongs_to :article,\n    primary_key: :id,\n    foreign_key: :article_id,\n    class_name: 'Article'\n\n  belongs_to :category,\n    primary_key: :id,\n    foreign_key: :category_id,\n    class_name: 'Category'\nend\n</code></pre>\n\n<p>If my route is \"/categories/:id/articles\" I want to return only the articles that match on that category id, but I'm not sure how to structure my controller index action. I got as far as this:</p>\n\n<pre><code>class Api::ArticlesController &lt; ApplicationController\n  def index\n    if params[:category_id]\n#     @articles = Article.where(????)\n    else\n      @articles = Article.all\n    end\n    render :index\n  end\n  ...\n</code></pre>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["ruby", "django", "python-3.x", "apache", "virtualhost"], "comments": [{"owner": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "edited": false, "score": 0, "creation_date": 1532478257, "post_id": 51509125, "comment_id": 89987503, "body": "Yes it is possible."}, {"owner": {"reputation": 11, "user_id": 6690773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c5a8615d95d93cfa4e0003dbfda884?s=128&d=identicon&r=PG&f=1", "display_name": "nixon", "link": "https://stackoverflow.com/users/6690773/nixon"}, "reply_to_user": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "edited": false, "score": 0, "creation_date": 1532569050, "post_id": 51509125, "comment_id": 90027766, "body": "Can please give me an example of a Virtual Host Configuration? I&#39;m really confused with the ones in the Apache website."}], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 9256271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99068c78d44a26613180666edaaed7d?s=128&d=identicon&r=PG", "display_name": "pankaj", "link": "https://stackoverflow.com/users/9256271/pankaj"}, "edited": false, "score": 0, "creation_date": 1581072750, "post_id": 51538151, "comment_id": 106316449, "body": "Very detailed answer. Some parts can be elaborated more. Like how to use &quot;Sub-directory and path&quot;."}], "tags": [], "owner": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "is_accepted": false, "score": 1, "last_activity_date": 1532605804, "creation_date": 1532605804, "answer_id": 51538151, "question_id": 51509125, "link": "https://stackoverflow.com/questions/51509125/how-to-serve-different-web-apps-using-one-domain-name-in-apache/51538151#51538151", "title": "How to serve different web apps using one domain name in Apache?", "body": "<p>Since you can only have 1 VirtualHost (one domain, one port, one IP), you cannot create additionnal VH.  You need to \"split\" the paths to the different applications some other way.</p>\n\n<p>Let assume www.example.com:</p>\n\n<pre><code>ServerRoot \"/some/path/apache\"\n\n[...] OTHER LoadModule directives [...]    \nLoadModule alias_module modules/mod_alias.so\n\nListen *:80\n&lt;VirtualHost *:80&gt;\n    ServerName www.example.com\n    ServerAlias example.com\n\n    # Logs\n    LogLevel warn\n    CustomLog \"logs/www.example.com_access-log\" combined\n    ErrorLog \"logs/www.example.com_error-log\"\n\n    # Index file.  Add as many as required for your applications\n    &lt;IfModule dir_module&gt;    \n        DirectoryIndex index.html\n    &lt;/IfModule&gt;\n\n    # Where the documents are\n    DocumentRoot \"/some/path/apache/htdocs\"\n\n    &lt;Directory /&gt;\n        Options FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n    &lt;/Directory&gt;\n\n    &lt;Directory \"/some/path/apache/htdocs\"&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>This VirtualHost is a basic configuration for the www.example.com domain.  Now you want to have Ruby, PHP WebApps and Django 2.0 App under that single domain.  You have 3 choices:</p>\n\n<ol>\n<li>Get 1 domain per application, not applicable here, that is your question.</li>\n<li>Make a sub-directory in htdocs, and a path in the URI for each application.</li>\n<li>Put each application in some directory, not under <code>DocumentRoot</code> and use <code>Alias</code>.</li>\n<li>Use sub-domains.</li>\n</ol>\n\n<hr>\n\n<ol>\n<li>Not applicable.</li>\n</ol>\n\n<hr>\n\n<ol start=\"2\">\n<li>Sub-directory and path</li>\n</ol>\n\n<p>Create <code>/some/path/apache/htdocs/Ruby</code>, put your Ruby app. here.<br>\nWill be accessed via <code>http://www.example.com/Ruby</code></p>\n\n<p>Create <code>/some/path/apache/htdocs/PHPWebApps</code>, put your PHP app. here.<br>\nWill be accessed via <code>http://www.example.com/PHPWebApps</code></p>\n\n<p>Create <code>/some/path/apache/htdocs/Django</code>, put your Django app. here.<br>\nWill be accessed via <code>http://www.example.com/Django</code></p>\n\n<p>The URI value must match the directory value.</p>\n\n<hr>\n\n<ol start=\"3\">\n<li>In some directory, use <code>Alias</code></li>\n</ol>\n\n<p>If you do not need, or want the URI to match the directory name (like in 2.), use Alias.</p>\n\n<p>Create <code>/SOME_DIR_FOR_Ruby</code>, put your Ruby app. here.<br>\nAdd <code>Alias \"/Ruby\" \"/SOME-DIR-FOR-Ruby\"</code><br>\nWill be accessed via <code>http://www.example.com/Ruby</code></p>\n\n<p>Create <code>/SOME_DIR_FOR_PHPWebApps</code>, put your PHP app. here.<br>\nAdd <code>Alias \"/PHPWebApps\" \"/SOME_DIR_FOR_PHPWebApps\"</code><br>\nWill be accessed via <code>http://www.example.com/PHPWebApps</code></p>\n\n<p>Create <code>/SOME_DIR_FOR_Django</code>, put your Django app. here.<br>\nAdd <code>Alias \"/Django\" \"/SOME_DIR_FOR_Django\"</code><br>\nWill be accessed via <code>http://www.example.com/Django</code></p>\n\n<hr>\n\n<ol start=\"4\">\n<li>Use sub-domains</li>\n</ol>\n\n<p>This is where you could use multiple VirtualHosts.  But you have to be able to create sub-domains.  This is done either via a DNS configuration, or through your hosting provider.</p>\n\n<p>You could setup <a href=\"http://ruby.example.com\" rel=\"nofollow noreferrer\">http://ruby.example.com</a>, <a href=\"http://php.example.com\" rel=\"nofollow noreferrer\">http://php.example.com</a>, <a href=\"http://django.example.com\" rel=\"nofollow noreferrer\">http://django.example.com</a>.  Each of these will have 1 VirtualHost, but will all be mapped to the same IP in the DNS.</p>\n\n<p>Then setup 3 VH:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName ruby.example.com\n\n    # Logs\n    LogLevel warn\n    CustomLog \"logs/ruby.example.com_access-log\" combined\n    ErrorLog \"logs/ruby.example.com_error-log\"\n\n    # Index file.  Add as many as required for your applications\n    &lt;IfModule dir_module&gt;    \n        DirectoryIndex index.html\n    &lt;/IfModule&gt;\n\n    # Where the documents are\n    DocumentRoot \"/some/path/apache/htdocs/Ruby\"\n\n    &lt;Directory /&gt;\n        Options FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n    &lt;/Directory&gt;\n\n    &lt;Directory \"/some/path/apache/htdocs/Ruby\"&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:80&gt;\n    ServerName php.example.com\n\n    # Logs\n    LogLevel warn\n    CustomLog \"logs/php.example.com_access-log\" combined\n    ErrorLog \"logs/php.example.com_error-log\"\n\n    # Index file.  Add as many as required for your applications\n    &lt;IfModule dir_module&gt;    \n        DirectoryIndex index.html\n    &lt;/IfModule&gt;\n\n    # Where the documents are\n    DocumentRoot \"/some/path/apache/htdocs/php\"\n\n    &lt;Directory /&gt;\n        Options FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n    &lt;/Directory&gt;\n\n    &lt;Directory \"/some/path/apache/htdocs/php\"&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:80&gt;\n    ServerName django.example.com\n\n    # Logs\n    LogLevel warn\n    CustomLog \"logs/django.example.com_access-log\" combined\n    ErrorLog \"logs/django.example.com_error-log\"\n\n    # Index file.  Add as many as required for your applications\n    &lt;IfModule dir_module&gt;    \n        DirectoryIndex index.html\n    &lt;/IfModule&gt;\n\n    # Where the documents are\n    DocumentRoot \"/some/path/apache/htdocs/django\"\n\n    &lt;Directory /&gt;\n        Options FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n    &lt;/Directory&gt;\n\n    &lt;Directory \"/some/path/apache/htdocs/django\"&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>On Apache 2.2, you have to add <code>NameVirtualHost *:80</code>, in Apache 2.4, nothing, it is always \"on\".</p>\n\n<p>All these values can be changed as you like, this is just an example to explain the concept.</p>\n"}], "owner": {"reputation": 11, "user_id": 6690773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c5a8615d95d93cfa4e0003dbfda884?s=128&d=identicon&r=PG&f=1", "display_name": "nixon", "link": "https://stackoverflow.com/users/6690773/nixon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1532605804, "creation_date": 1532476951, "question_id": 51509125, "link": "https://stackoverflow.com/questions/51509125/how-to-serve-different-web-apps-using-one-domain-name-in-apache", "title": "How to serve different web apps using one domain name in Apache?", "body": "<p>I'm currently trying to deploy my Django 2.0 App on an Apache Web Server. However I'm experiencing difficulties in configuring it because my Virtual Host configuration overrides other Virtual Hosts which is used by other projects (Ruby and PHP WebApps). We only have one domain name at the moment so I cannot use other domain names to host my app.</p>\n\n<p>Is it possible to serve different kind of apps with one domain name using Apache Virtual Hosts?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1532475535, "post_id": 51508923, "comment_id": 89986913, "body": "What real value do you want <code>foo</code> to return?"}, {"owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1532476141, "post_id": 51508923, "comment_id": 89987053, "body": "I&#39;m asking for general way of setting &quot;default accessors&quot;. I want to be able to return whatever I want e.g.: <code>foo =&gt;  &quot;some string&quot;</code> or <code>foo =&gt; [:a, :b]</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532544324, "post_id": 51508923, "comment_id": 90020172, "body": "@Sepp please note that these &quot;real values&quot; are for low-level native objects and each of them has a literal syntax e.g. single or double quotes for strings, square brackets for arrays, curly braces for Hashes, numeric values, etc. Foo does not have a literal syntax and representing in this fashion could cause confusion. For example if <code>foo #=&gt; [:a, :b]</code> then I would be inclined to believe that <code>foo</code> was an <code>Array</code> but clearly <code>foo</code> is not an <code>Array</code>. I would actually be inclined to say that the representation of <code>Foo</code> is actually more &quot;real&quot; since this is the default presentation of an object."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "edited": false, "score": 0, "creation_date": 1532476831, "post_id": 51509080, "comment_id": 89987193, "body": "Thank you very much for this great answer!!  This is exactly what I was looking for!  I think this could be very useful if you want to create data type like structures."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532478710, "post_id": 51509080, "comment_id": 89987597, "body": "Good answer, but the OP seems to have a misconception of &quot;real value&quot;. You may wish to add a few words to address that; i.e., <code>&quot;#&lt;Foo:0x00007f9e04c7b240 @a=:a, @b=:b&gt;&quot;</code> and <code>&quot;[1,2]&quot;</code> both merely describe an instance of a class."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 2, "last_activity_date": 1532476720, "last_edit_date": 1532476720, "creation_date": 1532476353, "answer_id": 51509080, "question_id": 51508923, "link": "https://stackoverflow.com/questions/51508923/define-default-accessor-of-class-instance/51509080#51509080", "title": "Define default accessor of class instance", "body": "<p>When you see the output on the IRB console, all it's doing is calling <code>inspect</code> on the object. So, all you need to do is (like Array), define an <code>inspect</code> method for you custom object:</p>\n\n<pre><code>class Foo\n  def initialize(a, b)\n    @a = a\n    @b = b\n  end\n\n  def inspect\n    %[\"Real value\" for Foo with #{@a} and #{@b}]\n  end\nend\nfoo = Foo.new(:a, :b) # =&gt; \"Real value\" for Foo with a and b\n</code></pre>\n\n<p>What you see by default, is just the implementation of <code>Object#inspect</code>, so you could if you really wanted to, just override that for all objects (that don't have a custom implementation):</p>\n\n<pre><code>class Object\n  def inspect\n    \"Custom Inspection of #{self.class.name}\"\n  end\nend\n\n# Foo2 is the same as Foo just without the `inspect` method)\nfoo_2 = Foo2.new(:a, :b) # =&gt; Custom Inspection of Foo2\n</code></pre>\n\n<p>I'd avoid doing this for <code>Object#inspect</code> though, since people are used to and expect to see the default format and changing things might throw them off.</p>\n"}], "owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 51509080, "answer_count": 1, "score": 0, "last_activity_date": 1532493965, "creation_date": 1532474939, "last_edit_date": 1532493965, "question_id": 51508923, "link": "https://stackoverflow.com/questions/51508923/define-default-accessor-of-class-instance", "title": "Define default accessor of class instance", "body": "<p>Is it possible to define a default accessor for an instance of my class?</p>\n\n<p>I have a class:</p>\n\n<pre><code>class Foo\n    def initialize(a, b)\n        @a = a\n        @b = b\n    end\nend\n</code></pre>\n\n<p>I want to create a new instance of this class:</p>\n\n<pre><code>foo = Foo.new(:a, :b)\n# =&gt; #&lt;Foo:0x00007f9e04c7b240 @a=:a, @b=:b&gt;\n</code></pre>\n\n<p>Creating a new array returns a real value:</p>\n\n<pre><code>arr = Array.new(2, :bar)\n# =&gt; [:bar, :bar]\n</code></pre>\n\n<p>How can I set a default accessor of my own class instance so that when I call <code>foo</code>, I get a real value instead of <code>#&lt;Foo:0x00007f9e04c7b240 @a=:a, @b=:b&gt;</code>?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rspec", "controller", "factory-bot"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1532469513, "post_id": 51508065, "comment_id": 89985282, "body": "Your <code>@dog_vaccination_records</code> is not saved in the database to begin with (from what you&#39;ve shown us). So it can&#39;t be reloaded."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1532469640, "post_id": 51508065, "comment_id": 89985320, "body": "Also, aren&#39;t you confusing <code>reload!</code> from rails console and <code>reload</code> from ActiveRecord?"}, {"owner": {"reputation": 1, "user_id": 9829702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "S. Causey", "link": "https://stackoverflow.com/users/9829702/s-causey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532469852, "post_id": 51508065, "comment_id": 89985372, "body": "Sorry @SergioTulentsev, I&#39;ve had to refactor this code a bit to protect the project. I&#39;ve fixed all mentions of <code>.reload!</code> to just <code>.reload</code> as it is in the controller&#39;s update action.  Yes, I was confusing it with the ActiveRecord method."}, {"owner": {"reputation": 1, "user_id": 9829702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "S. Causey", "link": "https://stackoverflow.com/users/9829702/s-causey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532470507, "post_id": 51508065, "comment_id": 89985547, "body": "@SergioTulentsev, I was about to ask you what you meant by <code>@dog_vaccination_records</code> not being saved to begin with. But then I changed that <code>FactoryGirl.build()</code> to <code>FactoryGirl.create</code> and the ID appears. That&#39;s what you were talking about, wasn&#39;t it? The difference between <code>.build</code> and <code>.create</code>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532470875, "post_id": 51508065, "comment_id": 89985651, "body": "Exactly that, yes."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1532514762, "post_id": 51508065, "comment_id": 90001812, "body": "That&#39;s the crucial part of your question - that you&#39;ve used FactoryBot&#39;s <code>build</code> instead of <code>create</code>. Care to update the question for others to find?"}, {"owner": {"reputation": 1, "user_id": 9829702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "S. Causey", "link": "https://stackoverflow.com/users/9829702/s-causey"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532531189, "post_id": 51508065, "comment_id": 90013263, "body": "Thanks for your help, @SergioTulentsev and question has been updated"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9829702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "S. Causey", "link": "https://stackoverflow.com/users/9829702/s-causey"}, "is_accepted": false, "score": 0, "last_activity_date": 1537810182, "last_edit_date": 1537810182, "creation_date": 1532540051, "answer_id": 51524707, "question_id": 51508065, "link": "https://stackoverflow.com/questions/51508065/calling-activerecord-reload-method-in-update-action-causing-spec-object-to-have/51524707#51524707", "title": "Calling ActiveRecord .reload method in update action causing spec object to have nil id", "body": "<p><strong>RESOLVED</strong></p>\n\n<p>The issue was that I was using .build to build a FactoryBot object, when I should have used .create. .build is like calling .new without a .save, while using .create creates the object and saves it to the database <a href=\"https://stackoverflow.com/questions/14098031/whats-the-difference-between-the-build-and-create-methods-in-factorygirl\">source</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9829702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "S. Causey", "link": "https://stackoverflow.com/users/9829702/s-causey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 835, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537810204, "creation_date": 1532469297, "last_edit_date": 1537810204, "question_id": 51508065, "link": "https://stackoverflow.com/questions/51508065/calling-activerecord-reload-method-in-update-action-causing-spec-object-to-have", "title": "Calling ActiveRecord .reload method in update action causing spec object to have nil id", "body": "<p><strong>ISSUE HAS BEEN RESOLVED</strong></p>\n\n<p>After adding <code>.reload</code> in order to prevent the dog_vaccination_records from saving to the database twice with different data, a few of my specs fail with the same error: </p>\n\n<pre><code>Failure/Error: Unable to find matching line from backtrace\n     ActiveRecord::RecordNotFound:\n       Couldn't find DogVaccinationRecord without an ID\n     # ./app/controllers/dog_vaccination_record_controller.rb:9:in `update'\n</code></pre>\n\n<p>Setting a breakpoint inside of the failing spec and calling <code>dog_medical_records</code> or <code>dog_vaccination_records</code> does indeed return both objects with <code>nil</code> ids, but correct information otherwise:</p>\n\n<pre><code>#&lt;DogVaccinationRecord:0x007fed0bf322d0\nid: nil,\ndog_record_id: 6,\narchived_at: nil,\ncreated_at: nil,\nupdated_at: nil&gt;\n</code></pre>\n\n<p>What is it about <code>.reload</code> that causes the id of an object in the test database to be <code>nil</code>? A <code>nil</code> ID would make sense if I called <code>.reload</code> in create, but why in update is that object not already in the database?</p>\n\n<p>I've done a bit of Googling and wonder if the error has anything to do with the <code>.reload</code> only reloading \"the latest code in the console environment\" and not \"re-initializing existing objects\" a la <a href=\"https://stackoverflow.com/questions/5427596/rails-console-reload-not-reflecting-changes-in-model-files-what-could-be-poss\">this explanation of <code>.reload</code></a>.</p>\n\n<p>TL:DR: Help me understand how the <code>.reload</code> method works, which should give me a better idea of how <code>.reload</code> is affecting my specs. </p>\n\n<p>Initialization of dog_medical_record in the spec via FactoryGirl: </p>\n\n<pre><code>dog_vaccination_record = FactoryGirl.build(:dog_vaccination_record_base, dog_medical_record: dog.dog_medical_record)\n</code></pre>\n\n<p>DogMedicalRecords controller update action:</p>\n\n<pre><code>def update\n  @dog_vaccination_records = @dog.dog_record.dog_vaccination_records.decorate\n  if @dog_medical_records.update_attributes(params[:dog_medical_records])\n    @dog_vaccination_records.reload.update_attributes(params[:dog_vaccination_records]) if params[:dog_vaccination_records]\n\n    @dog_medical_records.errors.add(:dog_vaccination_records, \"fields are not valid\") unless @dog_vaccination_records.valid?\n    initialize_resource\n  end\n\nrespond_with @dog_medical_records\nend\n</code></pre>\n\n<p><strong>EDIT 07/26/2018</strong></p>\n\n<p>The issue was that I was using <code>.build</code> to build a FactoryBot object, when I should have used <code>.create</code>. <code>.build</code> is like calling <code>.new</code> without a <code>.save</code>, while using <code>.create</code> creates the object and saves it to the database. </p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532467261, "post_id": 51507439, "comment_id": 89984438, "body": "<code>example_hash.sort_by{|k, v| v[:occurence]}.reverse!.to_h</code>"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532467405, "post_id": 51507439, "comment_id": 89984496, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2540435/how-to-sort-a-ruby-hash-by-number-value\">How to sort a Ruby Hash by number value?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1532466639, "creation_date": 1532466639, "answer_id": 51507587, "question_id": 51507439, "link": "https://stackoverflow.com/questions/51507439/how-to-sort-nested-hash-in-ruby/51507587#51507587", "title": "How to sort nested hash in ruby?", "body": "<p>In console, this:</p>\n\n<pre><code>example_hash.sort{|a,b| b[1][:occurence] &lt;=&gt; a[1][:occurence]}.to_h\n</code></pre>\n\n<p>returns this:</p>\n\n<pre><code>{\"3\"=&gt;{:occurence=&gt;16, :display=&gt;\"\"}, \"2\"=&gt;{:occurence=&gt;15, :display=&gt;\"\"}, \"1\"=&gt;{:occurence=&gt;12, :display=&gt;\"\"}}\n</code></pre>\n\n<p>BTW, I believe you've misspelled 'occurence'. </p>\n"}, {"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532476055, "post_id": 51508363, "comment_id": 89987034, "body": "SHAZAM! For us knuckle heads that are still ham fisting with <code>sort{|a,b| ...}</code>, could you say a little more about that syntax?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532480366, "post_id": 51508363, "comment_id": 89987942, "body": "@jvillian, there&#39;s not much to say, it&#39;s just the method <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a>. One advantage of that over <code>sort</code> is that <code>h[&quot;occurrence&quot;]</code> is calculated just once for each value (hash), rather than twice for each pairwise-comparison with <code>sort</code>."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532480578, "post_id": 51508363, "comment_id": 89987991, "body": "I suppose I was thrown by the underscore in the <code>|_,h|</code> bit. How does that underscore work? Also, the <code>-h[:occurrence]</code>. I guess the <code>-</code> in front of the <code>h</code> means descending?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1532481403, "post_id": 51508363, "comment_id": 89988155, "body": "@jvillian, one Ruby convention is to represent a block variable with an underscore when it&#39;s not used in the block calculation (&#39;hey, reader I&#39;m not using this variable in this block&quot;). Here that variable represents a hash key. While <code>_</code> is a valid local variable, it differs from variable names that do not begin with an underscore in that Ruby allows it to be used to represent more than one local variable (e.g., <code>{ |_,_,x|...}</code> or <code>_,x,_ = [1,2,3]</code>). Sometimes you might see <code>{ |_k,h|...}</code> when <code>_k</code> is not used."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1532471074, "creation_date": 1532471074, "answer_id": 51508363, "question_id": 51507439, "link": "https://stackoverflow.com/questions/51507439/how-to-sort-nested-hash-in-ruby/51508363#51508363", "title": "How to sort nested hash in ruby?", "body": "<pre><code>example_hash.sort_by { |_,h| -h[:occurrence] }\n  #=&gt; [[\"3\", {:occurrence=&gt;16, :display=&gt;\"\"}],\n  #    [\"2\", {:occurrence=&gt;15, :display=&gt;\"\"}],\n  #    [\"1\", {:occurrence=&gt;12, :display=&gt;\"\"}]]\n</code></pre>\n\n<p>Tack on <code>.to_h</code> if a hash is desired, but one does not normally desire a hash with keys sorted in a particular way.</p>\n"}], "owner": {"reputation": 211, "user_id": 1366417, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d5c489ecafce92b4e014bd60ec531663?s=128&d=identicon&r=PG", "display_name": "Lollypop", "link": "https://stackoverflow.com/users/1366417/lollypop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1532471074, "creation_date": 1532465934, "last_edit_date": 1532466710, "question_id": 51507439, "link": "https://stackoverflow.com/questions/51507439/how-to-sort-nested-hash-in-ruby", "title": "How to sort nested hash in ruby?", "body": "<pre><code>example_hash = {\n  \"1\" =&gt; {\"occurence\": 12, \"display\": \"\"},\n  \"2\" =&gt; {\"occurence\": 15, \"display\": \"\"},\n  \"3\" =&gt; {\"occurence\": 16, \"display\": \"\"}\n}\n</code></pre>\n\n<p>For the given above nested hash, how do we sort (descending) it based on the occurrence value. The result should display the keys in the sorted order [3,2,1]</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532465711, "post_id": 51507342, "comment_id": 89983828, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It&#39;s hard to tell what&#39;s happening, if we can&#39;t reproduce."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532466180, "post_id": 51507342, "comment_id": 89984039, "body": "@SergioTulentsev I updated the question. All it&#39;s doing is running that <code>test_id</code> test in minitest. Putting a <code>pry </code> in at the end of the end of the <code>initialize</code> and calling  <code>@id</code> or <code>id</code> results in the array posted in the question. Or calling <code>i.id</code> in the test method results in the same thing."}], "answers": [{"tags": [], "owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "is_accepted": false, "score": 1, "last_activity_date": 1532466603, "creation_date": 1532466603, "answer_id": 51507574, "question_id": 51507342, "link": "https://stackoverflow.com/questions/51507342/passing-hash-to-new-results-in-array-of-values-instead-of-correct-value/51507574#51507574", "title": "Passing hash to #new results in array of values instead of correct value", "body": "<p>It seems that the problem are the commas that you are adding at the end of each setting variable. Check with this code:</p>\n\n<pre><code>require 'bigdecimal'\nrequire 'time'\n\nclass Item\n  attr_reader :id, :created_at, :merchant_id\n  attr_accessor :name, :description, :unit_price, :updated_at\n\n  def initialize(item_data)\n    @id =           item_data[:id].to_i\n    @name =         item_data[:name]\n    @description =  item_data[:description]\n    @unit_price =   BigDecimal.new(item_data[:unit_price], 4)\n    @created_at =   item_data[:created_at]\n    @updated_at =   item_data[:updated_at]\n    @merchant_id =  item_data[:merchant_id].to_i\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1532466606, "creation_date": 1532466606, "answer_id": 51507575, "question_id": 51507342, "link": "https://stackoverflow.com/questions/51507342/passing-hash-to-new-results-in-array-of-values-instead-of-correct-value/51507575#51507575", "title": "Passing hash to #new results in array of values instead of correct value", "body": "<p>It's your trailing commas in the initializer:</p>\n\n<pre><code>def initialize(item_data)\n  @id =           item_data[:id].to_i, # &lt;=\n  @name =         item_data[:name],    # &lt;=\n</code></pre>\n\n<p>What they do is make ruby see the method like this:</p>\n\n<pre><code> @id = [item_data[id].to_i, @name = item_data[:name], ...]\n</code></pre>\n"}], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 1, "accepted_answer_id": 51507575, "answer_count": 2, "score": -1, "last_activity_date": 1532466990, "creation_date": 1532465453, "last_edit_date": 1532466990, "question_id": 51507342, "link": "https://stackoverflow.com/questions/51507342/passing-hash-to-new-results-in-array-of-values-instead-of-correct-value", "title": "Passing hash to #new results in array of values instead of correct value", "body": "<p>With this setup in minitest, </p>\n\n<pre><code> def test_id\n    i = Item.new({\n      :id          =&gt; 1,\n      :name        =&gt; \"Pencil\",\n      :description =&gt; \"You can use it to write things\",\n      :unit_price  =&gt; BigDecimal.new(10.99,4),\n      :created_at  =&gt; Time.now,\n      :updated_at  =&gt; Time.now,\n      :merchant_id =&gt; 2\n                    })\n    assert_equal 1, i.id  \nend\n</code></pre>\n\n<p>For some reason, when created, calling the <code>id</code> attribute results in an array of all of the values:\n<code>[1,'Pencil','You can use it to write things',#&lt;BigDecimal...&gt;, 2018-07-24 14:43:36 -0600, 2018-07-24 14:43:36 -0600, 2]</code></p>\n\n<p>instead of the integer <code>1</code>. </p>\n\n<p>In the item file, it looks like what you would expect</p>\n\n<pre><code>require 'bigdecimal'\nrequire 'time'\n\n    class Item\n      attr_reader :id, :created_at, :merchant_id\n      attr_accessor :name, :description, :unit_price, :updated_at\n\n      def initialize(item_data)\n        @id =           item_data[:id].to_i,\n        @name =         item_data[:name],\n        @description =  item_data[:description],\n        @unit_price =   BigDecimal.new(item_data[:unit_price], 4),\n        @created_at =   item_data[:created_at],\n        @updated_at =   item_data[:updated_at],\n        @merchant_id =  item_data[:merchant_id].to_i\n      end\n    end\n</code></pre>\n\n<p>Not really sure how this is happening. </p>\n\n<p>Throwing a <code>pry</code> in the test method before the assertion and calling <code>i</code> results in </p>\n\n<pre><code>#&lt;Item:0x00007f8cc48eb4f0\n @created_at=2018-07-24 15:14:55 -0600,\n @description=\"You can use it to write things\",\n @id=[1, \"Pencil\", \"You can use it to write things\", #&lt;BigDecimal:7f8cc48eb4c8,'0.1099E2',18(27)&gt;, 2018-07-24 15:14:55 -0600, 2018-07-24 15:14:55 -0600, 2],\n @merchant_id=2,\n @name=\"Pencil\",\n @unit_price=#&lt;BigDecimal:7f8cc48eb4c8,'0.1099E2',18(27)&gt;,\n @updated_at=2018-07-24 15:14:55 -0600&gt;\n</code></pre>\n\n<p>in the terminal.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "is_accepted": true, "score": 0, "last_activity_date": 1532466382, "creation_date": 1532466382, "answer_id": 51507530, "question_id": 51507320, "link": "https://stackoverflow.com/questions/51507320/skip-after-update-if-given-field-is-the-only-updated-attribute-ruby-on-rails/51507530#51507530", "title": "skip after_update if given field is the only updated attribute - Ruby on Rails", "body": "<p>You could use <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-update_columns\" rel=\"nofollow noreferrer\">ActiveRecord::Persistence#update_columns</a> which skips callbacks.</p>\n\n<pre><code>def make_api_call\n  response = SomeAPI.call    \n  update_columns(api_response: response)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": 1, "last_activity_date": 1532468565, "creation_date": 1532468565, "answer_id": 51507949, "question_id": 51507320, "link": "https://stackoverflow.com/questions/51507320/skip-after-update-if-given-field-is-the-only-updated-attribute-ruby-on-rails/51507949#51507949", "title": "skip after_update if given field is the only updated attribute - Ruby on Rails", "body": "<p>As of Rails 5.1 you could also do:</p>\n\n<pre><code>after_update :make_api_call, unless: :saved_change_to_response?\n</code></pre>\n\n<p>The <code>saved_change_to_response?</code> method comes from <code>ActiveRecord::AttributeMethods::Dirty</code>, which allows us to check if a specific attribute has changed by prepending <code>saved_change_to_</code> to the attribute name.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 51507530, "answer_count": 2, "score": 0, "last_activity_date": 1532468565, "creation_date": 1532465361, "question_id": 51507320, "link": "https://stackoverflow.com/questions/51507320/skip-after-update-if-given-field-is-the-only-updated-attribute-ruby-on-rails", "title": "skip after_update if given field is the only updated attribute - Ruby on Rails", "body": "<p>I've got a model that can be updated twice within the same update request. </p>\n\n<p>Here is my filter:</p>\n\n<pre><code>after_update :make_api_call\n</code></pre>\n\n<p>In my function, I update the api and then save the response on the same object. </p>\n\n<pre><code>def make_api_call\n    response = SomeAPI.call    \n    self.api_response = response\n    self.save\nend\n</code></pre>\n\n<p>This will obviously cause the update function to be called in an endless loop. I want the <code>make_api_call</code> function to be skipped if the only attribute being updated is the <code>api_response</code> attribute. Executing the API call before update is not an option do to some nested resources associated with the record. </p>\n"}, {"tags": ["json", "ruby", "shell", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532466547, "post_id": 51506282, "comment_id": 89984159, "body": "Try <code>pre_request.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>"}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532466734, "post_id": 51506282, "comment_id": 89984226, "body": "i tried, no success. then it looses all quotes. I know that somehow string needs to know that its not over and posts \\ before quote."}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532467993, "post_id": 51506282, "comment_id": 89984726, "body": "<code>signature.chop</code> - removes the last character"}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532468065, "post_id": 51506282, "comment_id": 89984765, "body": "bardzo zabawne :)"}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532518457, "post_id": 51506282, "comment_id": 90004141, "body": "Any advice appreciated"}], "owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1532527770, "creation_date": 1532460777, "last_edit_date": 1532527770, "question_id": 51506282, "link": "https://stackoverflow.com/questions/51506282/base64-encoding-new-line-after-60-chars-vs-new-line-after-76-chars", "title": "Base64 encoding, new line after 60 chars vs new line after 76 chars", "body": "<p><strong>Before u start reading all my long post</strong> I figured it out why it doesnt work. Its about base64, it adds new line after each 60chars by default. This link : <a href=\"https://stackoverflow.com/questions/13301708/base64-encode-length-parameter\">base64 encode length parameter</a> \nis a bit explenation. Is there Base64 module which adds new line after every 76 chars ?</p>\n\n<p><strong>So solution</strong> is just this</p>\n\n<pre><code>@checkout_signature = Base64.strict_encode64(@signature + \"|\" + checkout_request)\n@checkout_signature = @checkout_signature.insert(76, \"\\n\") # once \nor \n@checkout_signature.gsub!(/.{76}(?=.)/, '\\0'+\"\\n\") # every 76 chars\n</code></pre>\n\n<p>Please help me translate this bash script to ruby in proper way. Actually just base64 encoding is bad</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>bash way</p>\n\n<pre><code>#!/bin/bash\necho 'Signature test'\nexport checkout_request='{\"charge\":{\"amount\":499,\"currency\":\"EUR\"}}'\necho $checkout_request\nexport signature=`echo -n \"$checkout_request\" | openssl dgst -sha256 -hmac 'pr_test_tXHm9qV9qV9bjIRHcQr9PLPa' | sed 's/^.* //'`\necho $signature\necho '--------'\necho -n \"$signature|$checkout_request\" | base64\n</code></pre>\n\n<p>RESULT</p>\n\n<pre><code>{\"charge\":{\"amount\":499,\"currency\":\"EUR\"}}\ncf9ce2d8331c531f8389a616a18f9578c134b784dab5cb7e4b5964e7790f173c\n--------\nY2Y5Y2UyZDgzMzFjNTMxZjgzODlhNjE2YTE4Zjk1NzhjMTM0Yjc4NGRhYjVjYjdlNGI1OTY0ZTc3\nOTBmMTczY3x7ImNoYXJnZSI6eyJhbW91bnQiOjQ5OSwiY3VycmVuY3kiOiJFVVIifX0=\nY2Y5Y2UyZDgzMzFjNTMxZjgzODlhNjE2YTE4Zjk1NzhjMTM0Yjc4NGRhYjVjYjdlNGI1OTY0ZTc3OTBmMTczY3x7ImNoYXJnZSI6eyJhbW91bnQiOjQ5OSwiY3VycmVuY3kiOiJFVVIifX0=\n</code></pre>\n\n<p>ruby way</p>\n\n<pre><code>checkout_request='{\"charge\":{\"amount\":499,\"currency\":\"EUR\"}}'\nsecret_key ='pr_test_tXHm9qV9qV9bjIRHcQr9PLPa'\n\n@signature = OpenSSL::HMAC.hexdigest('sha256', secret_key, checkout_request);\nputs @signature;\nputs \"-----\"\n@checkout_signature = Base64.urlsafe_encode64(@signature + \"|\" + checkout_request)\nputs @checkout_signature \n</code></pre>\n\n<p>RESULT</p>\n\n<pre><code>cf9ce2d8331c531f8389a616a18f9578c134b784dab5cb7e4b5964e7790f173c\n-----\nODY4YzY4YTg4NmFmOTg2MGY5OGVjMmUyODM5OTBhYmViNmQyZjUzYWI5ZjgxMzlhYzFlODllNThhZTVhZTFkMnx7ImNoYXJnZSI6eyJhbW91bnQiOjQ5OSwiY3VycmVuY3kiOiJFVVIifX0=\n</code></pre>\n\n<p><strong>UPDATE</strong>\nok signature is ok, but I use bad base64 encoding....</p>\n\n<p><strong>SOMEHOW</strong> </p>\n\n<p><code>echo -n \"$signature|$checkout_request\" | base64</code>\nadds newline after $signature</p>\n\n<p>and its the only '\\n' in bash result</p>\n\n<p>in ruby when i use <code>.encode64</code> i get many more n's\n<code>\"Y2Y5Y2UyZDgzMzFjNTMxZjgzODlhNjE2YTE4Zjk1NzhjMTM0Yjc4NGRhYjVj\\nYjdlNGI1OTY0ZTc3OTBmMTczY3x7ImNoYXJnZSI6eyJhbW91bnQiOjQ5OSwi\\nY3VycmVuY3kiOiJFVVIifX0=\\n\"</code></p>\n\n<p>when I use <code>.strict_encode64</code> or <code>.urlsafe_encode64</code> there is no <code>\\n</code>\n<code>\"Y2Y5Y2UyZDgzMzFjNTMxZjgzODlhNjE2YTE4Zjk1NzhjMTM0Yjc4NGRhYjVjYjdlNGI1OTY0ZTc3OTBmMTczY3x7ImNoYXJnZSI6eyJhbW91bnQiOjQ5OSwiY3VycmVuY3kiOiJFVVIifX0=\"</code></p>\n\n<p>and result from bash looks like this\n<code>Y2Y5Y2UyZDgzMzFjNTMxZjgzODlhNjE2YTE4Zjk1NzhjMTM0Yjc4NGRhYjVjYjdlNGI1OTY0ZTc3\nOTBmMTczY3x7ImNoYXJnZSI6eyJhbW91bnQiOjQ5OSwiY3VycmVuY3kiOiJFVVIifX0=</code></p>\n\n<p>there must be newline after c3, that's the way <code>pritnenv</code> shows variable.I  can't inspect it like in ruby</p>\n\n<p><strong>WHY THERE IS SUCH DIFFERENCE</strong></p>\n"}, {"tags": ["ruby", "heroku", "amazon-s3", "sinatra", "carrierwave"], "comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 1, "creation_date": 1532870459, "post_id": 51506207, "comment_id": 90126773, "body": "You&#39;ll probably get more views if you add the <code>ruby</code> tag to this, probably in place of <code>amazon-web-services</code> as that&#39;s kind of covered by the <code>amazon-s3</code> tag."}], "answers": [{"tags": [], "owner": {"reputation": 533, "user_id": 786414, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c5e7177fba3bd1340c029f258d0a3da8?s=128&d=identicon&r=PG", "display_name": "digerati32", "link": "https://stackoverflow.com/users/786414/digerati32"}, "is_accepted": false, "score": 0, "last_activity_date": 1572014971, "creation_date": 1572014971, "answer_id": 58560835, "question_id": 51506207, "link": "https://stackoverflow.com/questions/51506207/carrierwave-not-uploading-files-to-s3-but-to-cache-sinatra-app-on-heroku/58560835#58560835", "title": "CarrierWave not uploading files to s3, but to cache (Sinatra app on Heroku)", "body": "<p>I uploaded it directly through s3:</p>\n\n<pre><code>image = params[:file] || ''\n\nuri = URI::Data.new(image)\n\nfilename = nom.id.to_s + \"_\" + Time.now.strftime('%Y%b%d_%H:%M:%S') + '.png'\ns3 = Aws::S3::Client.new(\n  access_key_id: ENV.fetch('s3_access_key_id'),\n  secret_access_key: ENV.fetch('s3_secret_access_key'),\n  region: ENV.fetch('s3_region'),\n)\nresponse = s3.put_object(bucket: ENV.fetch('s3_bucket'), key: filename, body: uri.data, acl: \"public-read\")\n\nimage = \"https://s3.amazonaws.com/\" + ENV.fetch('s3_bucket') + \"/\" + filename\n\n</code></pre>\n"}], "owner": {"reputation": 533, "user_id": 786414, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c5e7177fba3bd1340c029f258d0a3da8?s=128&d=identicon&r=PG", "display_name": "digerati32", "link": "https://stackoverflow.com/users/786414/digerati32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572014971, "creation_date": 1532460478, "last_edit_date": 1532888365, "question_id": 51506207, "link": "https://stackoverflow.com/questions/51506207/carrierwave-not-uploading-files-to-s3-but-to-cache-sinatra-app-on-heroku", "title": "CarrierWave not uploading files to s3, but to cache (Sinatra app on Heroku)", "body": "<p>I have a Sinatra app which takes in an image and am trying to upload that to s3. The response I receive says that the model is successfully saved, but the image URL it returns on saving is the cached upload. No image shows up in the s3 bucket either. The code is below, is there an obvious error? I was following the <a href=\"http://railscasts.com/episodes/383-uploading-to-amazon-s3?autoplay=true\" rel=\"nofollow noreferrer\">Railscast #383</a> episode on uploading to s3. </p>\n\n<p>Any help is appreciated, I've tried a bunch of things to no avail.</p>\n\n<p>app.rb</p>\n\n<pre><code>    before do\n        #Configure Carrierwave\n        CarrierWave.configure do |config|\n            config.storage = :fog\n\n            config.fog_credentials = {\n                provider: \"AWS\",\n                aws_access_key_id: ENV['s3_access_key_id'],\n                aws_secret_access_key: ENV['s3_secret_access_key']\n            }\n\n            config.fog_directory = ENV['s3_bucket']\n            config.fog_public = true\n        end\n    end\n\n    post \"/nominations\" do\n        image = params[:file] || nil\n\n        nomination = Nomination.create({\n            image: image\n        })\n\n        if nomination.valid?\n            nomination.save\n\n            status 201\n            body nomination.image.url\n        else\n            status 500\n            body nomination.errors.messages.to_s.to_json\n        end\n    end\nend\n</code></pre>\n\n<p>image_uploader.rb</p>\n\n<pre><code>require \"carrierwave\"\nrequire 'carrierwave/storage/fog'\n\nclass ImageUploader &lt; CarrierWave::Uploader::Base\n\n  storage :fog\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\nend\n</code></pre>\n\n<p>nomination.rb</p>\n\n<pre><code>class Nomination &lt; ActiveRecord::Base\n    extend CarrierWave::Mount\n\n    attr_accessor :image\n\n    mount_uploader :image, ImageUploader\nend\n</code></pre>\n"}, {"tags": ["c", "ruby", "windows", "winapi", "fiddle"], "comments": [{"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459506, "post_id": 51505870, "comment_id": 89980932, "body": "Do you know what each API call returned (VirtualAlloc, VirtualProtect, ...). In particular what does CreateThread returns, and if null, what does GetLastError returns?"}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459763, "post_id": 51505870, "comment_id": 89981049, "body": "<code>VirtualAlloc</code> returns an integer, a reference to that function. <code>CreateThread</code> just spawn the pry process so I couldn&#39;t know. I&#39;ve suspected the <code>VirtualProtec</code> but if the python calls didn&#39;t need it then why would the ruby do?"}, {"owner": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532459946, "post_id": 51505870, "comment_id": 89981116, "body": "I mean, do you know what value is returned? As your code is not working, you need to test the API call return value to be sure it succeed. For example VirtualAlloc returns NULL if it fails. It has not reason to, but you should check every API call return, that&#39;s a good practice."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532460173, "post_id": 51505870, "comment_id": 89981222, "body": "In my case, <code>VirtualAlloc</code> returns its reference. so it didn&#39;t fail. And you&#39;re right, I&#39;ve to check all returns and I did. The Fiddle documentation is no mature enough and no too many useful references for it.   Note: that when I use a TCP shell it opens a TCP server but not the other functionalities (eg executing the remote commands)"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1532460337, "post_id": 51505870, "comment_id": 89981297, "body": "Do you understand the <i>&quot;shell code&quot;</i>? It doesn&#39;t appear to be fully location-independent. Moving it around in memory is thus going to fail."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "edited": false, "score": 0, "creation_date": 1532460454, "post_id": 51505870, "comment_id": 89981339, "body": "Yes I do and I tested it with the python version using the same functions and it works. Please check the first link in the references."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1532460755, "post_id": 51505870, "comment_id": 89981483, "body": "Since you understand the code, attach a debugger and single-step through it to find out, where it fails to produce the desired result."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "edited": false, "score": 0, "creation_date": 1532511675, "post_id": 51505870, "comment_id": 89999742, "body": "Of course, still it&#39;s not in the shellcode at all, it&#39;s how should I deal with the Windows APIs using Fiddle in Ruby."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 1692, "user_id": 2542165, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/27a8186d2f0f6d88ad56327bacbeb258?s=128&d=identicon&r=PG", "display_name": "jaudo", "link": "https://stackoverflow.com/users/2542165/jaudo"}, "edited": false, "score": 0, "creation_date": 1532636255, "post_id": 51505870, "comment_id": 90061516, "body": "@jaudo I tried to use <code>GetLastError</code>, it returns <code>0</code> always after each function."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1532998146, "post_id": 51505870, "comment_id": 90173890, "body": "Just for my own curiosity if you would be willing to answer, but why not just invoke the functions? Why all this need for binary strings and virtual memory, etc? To be honest, this looks like it is intended either for A) evil things, or B) trying to obfuscate code, which is rather silly to use Ruby in the first place if that is the intention."}, {"owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "reply_to_user": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1533151293, "post_id": 51505870, "comment_id": 90246103, "body": "@ForeverZer0 The invoking the APIs takes time and efforts each time I want to do farther tasks. Further tasks (shellcode) are generated using bigger frameworks like Metasploit and others.  Regarding the why doing it in ruby, it&#39;s for Red Teaming porpuses and not evil.  The idea is to run a shellcode in memory without touching the desk in the first place. Again this is for PT/RT purposes no evil in it. And I&#39;m asking how to buffer a shellcode, create a thread that executes the code regardless the shellcode contents.   Thanks for asking to make that clear"}], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "is_accepted": true, "score": 0, "last_activity_date": 1537196988, "last_edit_date": 1537196988, "creation_date": 1533586391, "answer_id": 51714973, "question_id": 51505870, "link": "https://stackoverflow.com/questions/51505870/how-to-use-fiddle-with-windows-api-dll-to-run-a-shellcode-in-ruby/51714973#51714973", "title": "How to use Fiddle with Windows API (dll) to run a shellcode in Ruby", "body": "<p>Well, I think this code works perfectly</p>\n\n<pre><code>require 'fiddle'\nrequire 'fiddle/import'\nrequire 'fiddle/types'\n\n# MessageBoxA\nshellcode =\n    \"\\xd9\\xeb\\x9b\\xd9\\x74\\x24\\xf4\\x31\\xd2\\xb2\\x77\\x31\\xc9\\x64\" +\n    \"\\x8b\\x71\\x30\\x8b\\x76\\x0c\\x8b\\x76\\x1c\\x8b\\x46\\x08\\x8b\\x7e\" +\n    \"\\x20\\x8b\\x36\\x38\\x4f\\x18\\x75\\xf3\\x59\\x01\\xd1\\xff\\xe1\\x60\" +\n    \"\\x8b\\x6c\\x24\\x24\\x8b\\x45\\x3c\\x8b\\x54\\x28\\x78\\x01\\xea\\x8b\" +\n    \"\\x4a\\x18\\x8b\\x5a\\x20\\x01\\xeb\\xe3\\x34\\x49\\x8b\\x34\\x8b\\x01\" +\n    \"\\xee\\x31\\xff\\x31\\xc0\\xfc\\xac\\x84\\xc0\\x74\\x07\\xc1\\xcf\\x0d\" +\n    \"\\x01\\xc7\\xeb\\xf4\\x3b\\x7c\\x24\\x28\\x75\\xe1\\x8b\\x5a\\x24\\x01\" +\n    \"\\xeb\\x66\\x8b\\x0c\\x4b\\x8b\\x5a\\x1c\\x01\\xeb\\x8b\\x04\\x8b\\x01\" +\n    \"\\xe8\\x89\\x44\\x24\\x1c\\x61\\xc3\\xb2\\x08\\x29\\xd4\\x89\\xe5\\x89\" +\n    \"\\xc2\\x68\\x8e\\x4e\\x0e\\xec\\x52\\xe8\\x9f\\xff\\xff\\xff\\x89\\x45\" +\n    \"\\x04\\xbb\\x7e\\xd8\\xe2\\x73\\x87\\x1c\\x24\\x52\\xe8\\x8e\\xff\\xff\" +\n    \"\\xff\\x89\\x45\\x08\\x68\\x6c\\x6c\\x20\\x41\\x68\\x33\\x32\\x2e\\x64\" +\n    \"\\x68\\x75\\x73\\x65\\x72\\x30\\xdb\\x88\\x5c\\x24\\x0a\\x89\\xe6\\x56\" +\n    \"\\xff\\x55\\x04\\x89\\xc2\\x50\\xbb\\xa8\\xa2\\x4d\\xbc\\x87\\x1c\\x24\" +\n    \"\\x52\\xe8\\x5f\\xff\\xff\\xff\\x68\\x6f\\x78\\x58\\x20\\x68\\x61\\x67\" +\n    \"\\x65\\x42\\x68\\x4d\\x65\\x73\\x73\\x31\\xdb\\x88\\x5c\\x24\\x0a\\x89\" +\n    \"\\xe3\\x68\\x52\\x49\\x58\\x20\\x68\\x47\\x53\\x41\\x42\\x68\\x40\\x4b\" +\n    \"\\x49\\x4e\\x31\\xc9\\x88\\x4c\\x24\\x0a\\x89\\xe1\\x31\\xd2\\x52\\x53\" +\n    \"\\x51\\x52\\xff\\xd0\\x31\\xc0\\x50\\xff\\x55\\x08\"\n\n\ninclude Fiddle\n\nkernel32 = Fiddle.dlopen('kernel32')\n\nputs \"[-] VirtualAlloc\"\nptr = Function.new(kernel32['VirtualAlloc'], [4,4,4,4], 4).call(0, (shellcode.size), 0x3000, 0x40)\nFunction.new(kernel32['VirtualProtect'], [4,4,4,4], 4).call(ptr, shellcode.size, 0, 0)\n\nputs \"[-] Create buffer\"\nbuf = Fiddle::Pointer[shellcode]\n\nputs \"[-] RtlMoveMemory\"\nFunction.new(kernel32['RtlMoveMemory'], [4, 4, 4], 4).call(ptr, buf, shellcode.size)\n\nputs \"[-] CreateThread\"\n# thread = Function.new(kernel32['CreateThread'], [4,4,4,4,4,4], 4).call(Fiddle::NULL, 0, ptr, 0, 0, 0) # Works\nthread = Function.new(kernel32['CreateThread'], [4,4,4,4,4,4], 4).call(0, 0, ptr, 0, 0, 0)              # Works\nFunction.new(kernel32['WaitForSingleObject'], [4,4], 4).call(thread, -1)\n</code></pre>\n\n<p>Note: The Shellcode should be OS architecture compatible. In our case, this MessageBoxA is 32-bit compatible. </p>\n\n<p><strong>Reference</strong></p>\n\n<ul>\n<li><a href=\"https://king-sabri.net/how-to-execute-shellcode-using-ruby-on-windows-and-linux/\" rel=\"nofollow noreferrer\">How to Execute Raw Shellcode Using Ruby On Windows and Linux</a></li>\n</ul>\n\n<p>HTH Someone one day</p>\n"}], "owner": {"reputation": 635, "user_id": 967283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2636e8a6703c49f66027361402ab0261?s=128&d=identicon&r=PG", "display_name": "KING SABRI", "link": "https://stackoverflow.com/users/967283/king-sabri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 51714973, "answer_count": 1, "score": 6, "last_activity_date": 1537196988, "creation_date": 1532459075, "last_edit_date": 1533580411, "question_id": 51505870, "link": "https://stackoverflow.com/questions/51505870/how-to-use-fiddle-with-windows-api-dll-to-run-a-shellcode-in-ruby", "title": "How to use Fiddle with Windows API (dll) to run a shellcode in Ruby", "body": "<p>I'm trying to use ruby Fiddle standard library to Windows APIs to run a shellcode </p>\n\n<p>The idea of the code is to </p>\n\n<ol>\n<li>having a hexdicemial shellcode raw that executes anything (eg. MessageBoxA)</li>\n<li>call <code>kernel32.dll</code></li>\n<li>allocate a memory for this shellcode. <code>VirtualAlloc</code> </li>\n<li>create a buffer for this shellcode </li>\n<li>move the shellcode to that allocation. <code>RtlMoveMemory</code> </li>\n<li>create a new thread to execute that shellcode. <code>CreateThread</code></li>\n<li>wait for the execution/thread to end. <code>WaitForSingleObject</code></li>\n</ol>\n\n<p>here is the code: </p>\n\n<pre><code>require 'fiddle'\nrequire 'fiddle/import'\nrequire 'fiddle/types'\n\nshellcode = # MessageBoxA\n\"\\x31\\xd2\\xb2\\x30\\x64\\x8b\\x12\\x8b\\x52\\x0c\\x8b\\x52\\x1c\\x8b\\x42\" +  \n\"\\x08\\x8b\\x72\\x20\\x8b\\x12\\x80\\x7e\\x0c\\x33\\x75\\xf2\\x89\\xc7\\x03\" + \n\"\\x78\\x3c\\x8b\\x57\\x78\\x01\\xc2\\x8b\\x7a\\x20\\x01\\xc7\\x31\\xed\\x8b\" + \n\"\\x34\\xaf\\x01\\xc6\\x45\\x81\\x3e\\x46\\x61\\x74\\x61\\x75\\xf2\\x81\\x7e\" + \n\"\\x08\\x45\\x78\\x69\\x74\\x75\\xe9\\x8b\\x7a\\x24\\x01\\xc7\\x66\\x8b\\x2c\" + \n\"\\x6f\\x8b\\x7a\\x1c\\x01\\xc7\\x8b\\x7c\\xaf\\xfc\\x01\\xc7\\x68\\x79\\x74\" + \n\"\\x65\\x01\\x68\\x6b\\x65\\x6e\\x42\\x68\\x20\\x42\\x72\\x6f\\x89\\xe1\\xfe\" + \n\"\\x49\\x0b\\x31\\xc0\\x51\\x50\\xff\\xd7\"\n\ninclude Fiddle \nkernel32 = Fiddle.dlopen('kernel32')\n\nputs \"[-] VirtualAlloc\"\nptr = Function.new(kernel32['VirtualAlloc'], [4,4,4,4], 4).call(0, (shellcode.size), 0x3000, 0x40)\nFunction.new(kernel32['VirtualProtect'], [4,4,4,4], 4).call(ptr, shellcode.size, 0, 0)\n\nputs \"[-] Create buffer\"\nbuf = Fiddle::Pointer[shellcode]\n\nputs \"[-] RtlMoveMemory\"\nFunction.new(kernel32['RtlMoveMemory'], [4, 4, 4], 4).call(ptr, buf, shellcode.size)\n\nputs \"[-] CreateThread\"\n# thread = Function.new(kernel32['CreateThread'], [4, 4, 4, 4, 4, -4], 4).call(0, 0, ptr, 0, 0, 0)\nthread = Function.new(kernel32['CreateThread'], [4,4,4,4,4,4], 4).call(Fiddle::NULL, 0, ptr, 0, 0, 0)\n\npp Function.new(kernel32['WaitForSingleObject'], [4,4], 4).call(thread, -1)\n</code></pre>\n\n<p>The problem is the MessageBoxA never get executed, when I try to something like a bind shell, the TCP connection starts successfully when I connect but I can't execute commands and it ends once I send anything twice like pressing enter twice. </p>\n\n<p>I checked the buffer <code>buf</code> size and contents <code>buf.size</code>, <code>buf.to_str</code> and it's accurate.</p>\n\n<p>Am I missing something here? </p>\n\n<p>Thanks! </p>\n\n<p>Note: I don't want to call the MessageBoxA API directly I need to execute it from the shellcode. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "controller"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1532459374, "post_id": 51505122, "comment_id": 89980883, "body": "Why does one example start with <code>#{Rails.root}&#47;</code> and the other with <code>.&#47;</code>? What is your actual code? Where do the files actually exist?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532459815, "post_id": 51505122, "comment_id": 89981064, "body": "The code you&#39;ve written is clearly different to the code in the error message. Can you please verify which version of the code you&#39;re running, and show the corresponding error (if there is one!)"}, {"owner": {"reputation": 432, "user_id": 5529252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b93c1cab573e87ee3080d1baa70ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bodh1004", "link": "https://stackoverflow.com/users/5529252/bodh1004"}, "edited": false, "score": 1, "creation_date": 1532460586, "post_id": 51505122, "comment_id": 89981395, "body": "if these PDF shouldn&#39;t be in public where should I store them?  Answer is you can upload your file on amazon s3 and can use active storage"}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532465756, "post_id": 51505122, "comment_id": 89983843, "body": "@tom-lord my apologies by mistake I uploaded the wrong image. However, I got passed this issue but wondering if theres a more optimal solution. Please feel free to comment on the answer."}], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": false, "score": 1, "last_activity_date": 1532465809, "creation_date": 1532465809, "answer_id": 51507412, "question_id": 51505122, "link": "https://stackoverflow.com/questions/51505122/files-in-public-directory-in-rails-errnoenoent-no-such-file-or-directory/51507412#51507412", "title": "Files in public directory in Rails - Errno::ENOENT (No such file or directory @ rb_sysopen", "body": "<p>This fixed it for me:</p>\n\n<pre><code>  def pdf_download\n    pdf = CombinePDF.new\n    pdf &lt;&lt; CombinePDF.load(Rails.root.join(\"public\", \"pdfs/1.pdf\").to_s)\n    pdf &lt;&lt; CombinePDF.load(Rails.root.join(\"public\", \"pdfs/2.pdf\").to_s)\n    # pdf.save \"combined.pdf\"\n\n    send_data pdf.to_pdf, filename: \"combined.pdf\", type: \"application/pdf\"\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11142004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35958e4330fddc4f6cc26fcd8e0b8c6d?s=128&d=identicon&r=PG&f=1", "display_name": "PepeGomez", "link": "https://stackoverflow.com/users/11142004/pepegomez"}, "is_accepted": false, "score": 1, "last_activity_date": 1561328706, "creation_date": 1561328706, "answer_id": 56728136, "question_id": 51505122, "link": "https://stackoverflow.com/questions/51505122/files-in-public-directory-in-rails-errnoenoent-no-such-file-or-directory/56728136#56728136", "title": "Files in public directory in Rails - Errno::ENOENT (No such file or directory @ rb_sysopen", "body": "<p>This fixed it for me:</p>\n\n<pre><code>pdf &lt;&lt; CombinePDF.load(\"./public/pdfs/1.pdf\")\n</code></pre>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1561328706, "creation_date": 1532455990, "last_edit_date": 1532466032, "question_id": 51505122, "link": "https://stackoverflow.com/questions/51505122/files-in-public-directory-in-rails-errnoenoent-no-such-file-or-directory", "title": "Files in public directory in Rails - Errno::ENOENT (No such file or directory @ rb_sysopen", "body": "<p>I'm currently working on a Rails 5.2 application using the <a href=\"https://github.com/boazsegev/combine_pdf\" rel=\"nofollow noreferrer\">combine pdf</a> gem. I'm trying to merge two PDF files but somehow I'm unable to load files from the <code>public</code> directory.</p>\n\n<p>In the controller I have the following method:</p>\n\n<pre><code>def pdf_download\n  pdf = CombinePDF.new\n  pdf &lt;&lt; CombinePDF.load(\"#{Rails.root}/public/pdfs/1.pdf\") \n  pdf &lt;&lt; CombinePDF.load(\"#{Rails.root}/public/pdfs/1.pdf\")\n  pdf.save \"combined.pdf\"\n\n  send_data combined_file.to_pdf, filename: \"combined.pdf\", type: \"application/pdf\"\nend\n</code></pre>\n\n<p>I have tried many posts on StackOverflow without success such as using <a href=\"https://stackoverflow.com/questions/28403667/no-such-file-or-directory-rb-sysopen-public-receipts-416981-pdf\">Rails.root</a>. But I still get the same error:</p>\n\n<pre><code>Errno::ENOENT (No such file or directory @ rb_sysopen - app/public/pdfs/1.pdf):\n</code></pre>\n\n<p>Is there any additional configuration I have to do to load files from <code>public</code>? and if these PDF shouldn't be in <code>public</code> where should I store them?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532455220, "post_id": 51504862, "comment_id": 89978740, "body": "Re: <code>put &#39;&#47;categories&#47;:categoriy_id&#47;products&#47;:id&#39; =&gt; &#39;products#create&#39;</code>, why PUT (and not POST) for CREATE? Why (and how) are you passing <code>:id</code> in CREATE?"}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532455471, "post_id": 51504862, "comment_id": 89978877, "body": "I thought i remember reading it should be PUT but sounds like POST is more appropriate, I was confusing a security flaw from earlier rails maybe?  Thank you!"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532455501, "post_id": 51504862, "comment_id": 89978892, "body": "<i>&quot;I am trying to &#39;delete&#39; a product from categories&quot;</i> - I assume your question is limited to products controller only. I will remove the extra code. Add it later if required."}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "edited": false, "score": 0, "creation_date": 1532456669, "post_id": 51505129, "comment_id": 89979508, "body": "Did that do the trick? If so, please feel free to upvote/accept for future searchers."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 0, "last_activity_date": 1532456030, "creation_date": 1532456030, "answer_id": 51505129, "question_id": 51504862, "link": "https://stackoverflow.com/questions/51504862/rails-5-2-nested-routes-and-urls-paths-not-working-for-delete/51505129#51505129", "title": "Rails 5.2 nested routes, and urls paths not working for delete", "body": "<p>I would suggest that your routes.rb look more like: </p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n\n  devise_scope :user do\n\n    authenticated :user do\n      root 'categories#index', as: :authenticated_root\n      resources :categories, shallow: true do\n        resources :products\n      end\n    end\n\n    unauthenticated :user do\n      root 'devise/sessions#new', as: :unauthenticated_root\n      get 'sign-in' =&gt; 'devise/sessions#new'\n      post 'login' =&gt; 'devise/sessions#create'\n      delete 'logout' =&gt; 'devise/sessions#destroy'\n    end\n\n  end\nend\n</code></pre>\n\n<p>This will give you routes like:</p>\n\n<pre><code>   category_products GET    /categories/:category_id/products(.:format)     products#index\n                     POST   /categories/:category_id/products(.:format)     products#create\nnew_category_product GET    /categories/:category_id/products/new(.:format) products#new\n        edit_product GET    /products/:id/edit(.:format)                    products#edit\n             product GET    /products/:id(.:format)                         products#show\n                     PATCH  /products/:id(.:format)                         products#update\n                     PUT    /products/:id(.:format)                         products#update\n                     DELETE /products/:id(.:format)                         products#destroy\n          categories GET    /categories(.:format)                           categories#index\n                     POST   /categories(.:format)                           categories#create\n        new_category GET    /categories/new(.:format)                       categories#new\n       edit_category GET    /categories/:id/edit(.:format)                  categories#edit\n            category GET    /categories/:id(.:format)                       categories#show\n                     PATCH  /categories/:id(.:format)                       categories#update\n                     PUT    /categories/:id(.:format)                       categories#update\n                     DELETE /categories/:id(.:format)                       categories#destroy    \n</code></pre>\n\n<p>Note that this gives you <code>new_category_product</code> and <code>category_products</code>, so you don't need: </p>\n\n<pre><code>  post '/categories/:category_id/products/new' =&gt; 'products#new'\n  put '/categories/:categoriy_id/products/:id' =&gt; 'products#create'\n</code></pre>\n\n<p>(BTW, <code>:categoriy_id</code> is misspelled in the second line.)</p>\n\n<p>Also note shallow nesting, which you can read more about in <a href=\"https://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">the Guide, section 2.7 Nested Resources</a>.</p>\n\n<p>Then, you should be able to do:</p>\n\n<pre><code>&lt;td&gt;\n  &lt;%= link_to 'Delete', product, method: :delete, data: { confirm: 'Are you sure?' } %&gt;\n&lt;/td&gt;\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 51505129, "answer_count": 1, "score": 0, "last_activity_date": 1532456030, "creation_date": 1532454878, "last_edit_date": 1532455721, "question_id": 51504862, "link": "https://stackoverflow.com/questions/51504862/rails-5-2-nested-routes-and-urls-paths-not-working-for-delete", "title": "Rails 5.2 nested routes, and urls paths not working for delete", "body": "<p>I have tried not to ask any questions regarding this and figure it out myself but now I am at a loss, thinking I might have to start over :(.  I generated a rails mysql project with <code>devise</code>, used scaffolding for categories, then products like so:</p>\n\n<pre><code>rails g scaffold category name:string description:text\nrails g scaffold product name:string category:references\n</code></pre>\n\n<p>my routes.rb (for some reason create was not included with product/new)</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n\n  devise_scope :user do\n    authenticated :user do\n      root 'categories#index', as: :authenticated_root\n      resources :categories do\n        resources :products\n      end\n      post '/categories/:category_id/products/new' =&gt; 'products#new'\n      put '/categories/:categoriy_id/products/:id' =&gt; 'products#create'\n    end\n\n    unauthenticated :user do\n      root 'devise/sessions#new', as: :unauthenticated_root\n      get 'sign-in' =&gt; 'devise/sessions#new'\n      post 'login' =&gt; 'devise/sessions#create'\n      delete 'logout' =&gt; 'devise/sessions#destroy'\n    end\n  end\nend\n</code></pre>\n\n<p>my products_controller.rb</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  before_action :set_product, only: [:show, :edit, :update, :destroy]\n\n  def destroy\n    @product.destroy\n    redirect_to category_products_path\n  end\n\n  private\n\n  def set_product\n    @product = Product.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>and my rake routes:</p>\n\n<pre><code>Prefix Verb       URI Pattern                                            Controller#Action\n    new_user_session GET        /users/sign_in(.:format)                             devise/sessions#new\n        user_session POST       /users/sign_in(.:format)                             devise/sessions#create\n destroy_user_session GET|DELETE /users/sign_out(.:format)                            devise/sessions#destroy\n       user_password POST       /users/password(.:format)                            devise/passwords#create\n   new_user_password GET        /users/password/new(.:format)                        devise/passwords#new\n  edit_user_password GET        /users/password/edit(.:format)                       devise/passwords#edit\n                     PATCH      /users/password(.:format)                            devise/passwords#update\n                     PUT        /users/password(.:format)                            devise/passwords#update\ncancel_user_registration GET        /users/cancel(.:format)                              devise/registrations#cancel\n   user_registration POST       /users(.:format)                                     devise/registrations#create\nnew_user_registration GET        /users/sign_up(.:format)                             devise/registrations#new\nedit_user_registration GET        /users/edit(.:format)                                devise/registrations#edit\n                     PATCH      /users(.:format)                                     devise/registrations#update\n                     PUT        /users(.:format)                                     devise/registrations#update\n                     DELETE     /users(.:format)                                     devise/registrations#destroy\n  authenticated_root GET        /                                                    categories#index\n   category_products GET        /categories/:category_id/products(.:format)          products#index\n                     POST       /categories/:category_id/products(.:format)          products#create\n new_category_product GET        /categories/:category_id/products/new(.:format)      products#new\n edit_category_product GET        /categories/:category_id/products/:id/edit(.:format) products#edit\n    category_product GET        /categories/:category_id/products/:id(.:format)      products#show\n                     PATCH      /categories/:category_id/products/:id(.:format)      products#update\n                     PUT        /categories/:category_id/products/:id(.:format)      products#update\n                     DELETE     /categories/:category_id/products/:id(.:format)      products#destroy\n          categories GET        /categories(.:format)                                categories#index\n                     POST       /categories(.:format)                                categories#create\n        new_category GET        /categories/new(.:format)                            categories#new\n       edit_category GET        /categories/:id/edit(.:format)                       categories#edit\n            category GET        /categories/:id(.:format)                            categories#show\n                     PATCH      /categories/:id(.:format)                            categories#update\n                     PUT        /categories/:id(.:format)                            categories#update\n                     DELETE     /categories/:id(.:format)                            categories#destroy\n                     POST       /categories/:category_id/products/new(.:format)      products#new\n                     PUT        /categories/:categoriy_id/products/:id(.:format)     products#create\n  unauthenticated_root GET        /                                                    devise/sessions#new\n             sign_in GET        /sign-in(.:format)                                   devise/sessions#new\n               login POST       /login(.:format)                                     devise/sessions#create\n              logout DELETE     /logout(.:format)                                    devise/sessions#destroy\n</code></pre>\n\n<p>Sorry for the length of this post I didn't want to leave anything out.  Really only needed routes.rb, anyway, as is the user is routed to 'show' product from categories, rather than 'delete', I am trying to 'delete' a product from categories.  And the product/index.html.erb has a 'delete' link as shown below, however that just shows a product,</p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to 'Delete', action: \"destroy\", id: product.id, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "push-notification", "ruby-on-rails-5", "web-push"], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 5568045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e61e6cb6006fa4bf4bb5d2c449d37e4?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan", "link": "https://stackoverflow.com/users/5568045/bogdan"}, "is_accepted": true, "score": 4, "last_activity_date": 1532456019, "last_edit_date": 1592644375, "creation_date": 1532454976, "answer_id": 51504875, "question_id": 51504454, "link": "https://stackoverflow.com/questions/51504454/where-should-i-put-keys-at-my-rails-app/51504875#51504875", "title": "Where should I put keys at my rails app?", "body": "<p>Idealy it should be stored in <code>environment variables</code> (depends on the OS you use).\nIf you are using <code>dotenv</code> gem and find it conveniant to use <code>dotenv</code> in production you can store it in <code>.env</code> file.\nTo use a variable use ENV['NAME']</p>\n<p>Also for this purpose you can use default rails <code>config/secrets.yml</code> file. To use a variable use <code>Rails.application.secrets.name</code>.</p>\n<p>Also you can combine env variables with secrets.yml file like:</p>\n<h1>secrets.yml</h1>\n<pre><code>...\n key: ENV['NAME']\n</code></pre>\n<p>benefit: use variable independent of rails environment.</p>\n<p>Notice: Neve share you credentials file to git or any public repo! If you need to share this file with other developers just send them copy with development keys.</p>\n<p>Links:</p>\n<p><a href=\"https://github.com/bkeepers/dotenv\" rel=\"nofollow noreferrer\">dotenv</a></p>\n<p><a href=\"http://railsapps.github.io/rails-environment-variables.html\" rel=\"nofollow noreferrer\">environment variables</a></p>\n<p><a href=\"https://richonrails.com/articles/the-rails-4-1-secrets-yml-file\" rel=\"nofollow noreferrer\">secrets.yml</a></p>\n"}, {"tags": [], "owner": {"reputation": 8371, "user_id": 1094339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cibe3.png?s=128&g=1", "display_name": "Deekor", "link": "https://stackoverflow.com/users/1094339/deekor"}, "is_accepted": false, "score": 0, "last_activity_date": 1538969335, "creation_date": 1538969335, "answer_id": 52695016, "question_id": 51504454, "link": "https://stackoverflow.com/questions/51504454/where-should-i-put-keys-at-my-rails-app/52695016#52695016", "title": "Where should I put keys at my rails app?", "body": "<p>I wrote <a href=\"https://github.com/Deekor/site_variables\" rel=\"nofollow noreferrer\">a gem</a> to help with this now that Rails no longer supports <code>secrets.yml.</code></p>\n\n<p>REMINDER: you should never store a private key or any other secret variable in a file that is committed to your version control - use environment variables for that.</p>\n"}], "owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 51504875, "answer_count": 2, "score": 1, "last_activity_date": 1538969335, "creation_date": 1532453307, "last_edit_date": 1532454287, "question_id": 51504454, "link": "https://stackoverflow.com/questions/51504454/where-should-i-put-keys-at-my-rails-app", "title": "Where should I put keys at my rails app?", "body": "<p>I am trying to use the gem webpush to create push notifications at my rails app.</p>\n\n<p>At <a href=\"https://github.com/zaru/webpush#generating-vapid-keys\" rel=\"nofollow noreferrer\">this part at tutorial</a> he say: </p>\n\n<p><em>\"Use webpush to generate a VAPID key that has both a public_key and private_key attribute to be saved on the server side.\"</em></p>\n\n<pre><code># One-time, on the server\nvapid_key = Webpush.generate_key\n\n# Save these in your application server settings\nvapid_key.public_key\nvapid_key.private_key\n</code></pre>\n\n<p>My doubt is: What exactly is \"application server settings\"? Where should I put these keys at my rails app?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1532452883, "post_id": 51504294, "comment_id": 89977438, "body": "What is the question?"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 1, "creation_date": 1532453032, "post_id": 51504294, "comment_id": 89977541, "body": "Same, what is the question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1532453091, "post_id": 51504294, "comment_id": 89977575, "body": "sorry, i was editing @jvillian"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532453100, "post_id": 51504294, "comment_id": 89977584, "body": "&quot;&quot;3 products can be delivered with DeliveryMod(1) / 1 product can be delivered with DeliveryMods(2,3,4).&quot;. What?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532453639, "post_id": 51504294, "comment_id": 89977886, "body": "@jedi it was confusing, edition done."}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532453704, "post_id": 51504294, "comment_id": 89977922, "body": "&quot;Goal : find each same records&quot; What records? Products or delivery mods of a single product?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532453766, "post_id": 51504294, "comment_id": 89977964, "body": "find each same delivery mods on a single product @jedi"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532453969, "post_id": 51504294, "comment_id": 89978093, "body": "So you want to create a LogisitcaOrder per delivery mod? Do I understand you correctly?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532454219, "post_id": 51504294, "comment_id": 89978239, "body": "@jedi more specificly, 5 products in the cart. 3 have the Delivery mod A. 2 have the Delivery mod B. I want to create 2 logistical order because there is 2 differents delivery mods on the products. Sorry it&#39;s a bit difficult for me to explain.."}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532454460, "post_id": 51504294, "comment_id": 89978353, "body": "What is LogisitcalOrder? What fields does it have? Is it a model? If yes, please paste the mode code as well."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "edited": false, "score": 0, "creation_date": 1532501193, "post_id": 51504795, "comment_id": 89993256, "body": "hey @jedi thanks for you answer. It&#39;s not exactly working because the action is creating as many LogisticalOrder as there is DeliveryMods records, and not as many as there is different DeliveryMods"}], "tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1532454574, "creation_date": 1532454574, "answer_id": 51504795, "question_id": 51504294, "link": "https://stackoverflow.com/questions/51504294/how-to-find-the-same-data-in-a-record-and-do-an-action-in-rails/51504795#51504795", "title": "How to find the same data in a record and do an action in rails?", "body": "<pre><code>@products = current_cart.products\n  @products.each do |product|\n    @delivery_mods = product.delivery_mods\n    @delivery_mods.each.uniq do |delivery_mod|\n      logistical_order = LogisticalOrder.new\n      logistical_order.products = delivery_mod.products\n      logistical_order.save\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "edited": false, "score": 0, "creation_date": 1534841542, "post_id": 51543069, "comment_id": 90839392, "body": "Hi @Juan F it&#39;s exactly what I needed (sorry for delay). But there is a bug with : <code>products: dm.products</code>, it returns me <code>undefined method &quot;products&quot; for #&lt;DeliveryMod::ActiveRecord_Associations_CollectionProxy:0x0&zwnj;&#8203;0007f7f61dc7d18&gt; Did you mean? product_values</code> Any idea please ?"}, {"owner": {"reputation": 516, "user_id": 5588506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UoBXp.jpg?s=128&g=1", "display_name": "Juan Furattini", "link": "https://stackoverflow.com/users/5588506/juan-furattini"}, "edited": false, "score": 0, "creation_date": 1534946607, "post_id": 51543069, "comment_id": 90887576, "body": "This is pseudocode, I don&#39;t know how your model is built, you must use your defined properties"}], "tags": [], "owner": {"reputation": 516, "user_id": 5588506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UoBXp.jpg?s=128&g=1", "display_name": "Juan Furattini", "link": "https://stackoverflow.com/users/5588506/juan-furattini"}, "is_accepted": true, "score": 0, "last_activity_date": 1532620683, "creation_date": 1532620683, "answer_id": 51543069, "question_id": 51504294, "link": "https://stackoverflow.com/questions/51504294/how-to-find-the-same-data-in-a-record-and-do-an-action-in-rails/51543069#51543069", "title": "How to find the same data in a record and do an action in rails?", "body": "<p>So, you have a many to many relationship right? A product can have 0..n delivery mods, and a delivery mod can have 0..n products, am I right?</p>\n\n<p>In that case, you could start getting the delivery mods of your products, map those delivery mods to a logical order object. Example:</p>\n\n<pre><code>logical_orders = current_cart.products.map(&amp;:delivery_mods).uniq.map { |dm| LogicalOrder.create(order: @order, products: dm.products, delivery_mod: dm) }\n</code></pre>\n\n<p>Step by step:</p>\n\n<ol>\n<li><p>Get all products from your cart and convert those products to its the delivery mods and remove duplicates, so you'll have a list of delivery mods that are related to the products on your cart.</p>\n\n<pre><code>current_cart.products.map(&amp;:delivery_mods).uniq\n</code></pre></li>\n<li><p>Convert those deliver mods into a Logical order passing the attributes in a hash param. Also the #create method will create it directly on the database, so you don't to call #save manually.</p>\n\n<pre><code>map { |dm| LogicalOrder.create(order: @order, products: dm.products, delivery_mod: dm) }\n</code></pre></li>\n<li><p>If you want to check which logical orders where saved successfully, you could check which of them were saved</p>\n\n<ol>\n<li><p>Saved logical orders:</p>\n\n<pre><code>logical_orders.select { |lo| lo.persisted? }\n</code></pre></li>\n<li><p>Not saved logical orders:</p>\n\n<pre><code>logical_orders.reject { |lo| lo.persisted? }\n</code></pre></li>\n</ol></li>\n</ol>\n\n<p>Hope this helps.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 2, "accepted_answer_id": 51543069, "answer_count": 2, "score": -1, "last_activity_date": 1532620683, "creation_date": 1532452711, "last_edit_date": 1532502257, "question_id": 51504294, "link": "https://stackoverflow.com/questions/51504294/how-to-find-the-same-data-in-a-record-and-do-an-action-in-rails", "title": "How to find the same data in a record and do an action in rails?", "body": "<p>I have a very tricky problem : I want to identify the same records and do some actions when the records are the same.</p>\n\n<p><strong>Exemple (e-commerce case) :</strong></p>\n\n<p>Each products have delivery mods. I have many products in a cart, and so multiple delivery mods and they can be the same.</p>\n\n<p>Goal : find each same delivery mods on a single product, and create a LogisticalOrder, to purpose to the customers a choice with multiples delivery mods : </p>\n\n<p><strong>First LogisticalOrder :</strong> 3 products with 1 DeliveryMoD</p>\n\n<p><strong>Second LogisticalOrder :</strong> 2 product with 1 other DeliveryMod</p>\n\n<p>There is <strong>2 LogisticalOrders beacause the delivery mods are not the same.</strong> </p>\n\n<p>Data specific, Products and DeliveryMods have a join table (product.delivery_mods)</p>\n\n<p><strong>Test 1 :</strong></p>\n\n<pre><code>  @products = current_cart.products\n      @delivery_mods = @products.delivery_mods\n      @delivery_mods.uniq.each do |delivery_mod|\n        @logistical_order = LogisticalOrder.new\n        @logistical_order.products = @products\n        @logistical_order.logistical_order_digits = [*('A'..'Z')].sample(2).join\n        @logistical_order.save\n      end\n  end\n</code></pre>\n\n<p><strong>Test 2 :</strong> </p>\n\n<pre><code>@products = current_cart.products\n  @products.each do |product|\n    @delivery_mod = Array.new\n    @delivery_mod &lt;&lt; product.delivery_mods\n    @delivery_mod.uniq.each do |logistical_order|\n      logistical_order = LogisticalOrder.new\n      logistical_order.order = @order\n      logistical_order.products = @products\n      logistical_order.save\n    end\n  end\nend\n</code></pre>\n\n<p>It's not working, it's creates as many LogisticalOrder as there is DeliveryMods, while <strong>it should create LogisticalOrder as many as there is differents DeliveryMods.</strong></p>\n\n<p>Do you have any solutions for this issue and identify same records ?</p>\n\n<p>Please help me :) \nMany thanks</p>\n"}, {"tags": ["ruby", "irb"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532447156, "post_id": 51502579, "comment_id": 89974062, "body": "FWIW: in <a href=\"http://pryrepl.org/\" rel=\"nofollow noreferrer\"><code>pry</code></a> it perfectly works as expected. Would you mind to try <code>methods.grep(&#47;foo&#47;)</code> to see if the method is indeed defined?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532447632, "post_id": 51502579, "comment_id": 89974340, "body": "The method is defined (after all, I can call it), but we can&#39;t see it with the command you suggested. But I found a way to fix it. See my own answer to this problem. Maybe <code>pry</code> has a different approach how to handle the interactive shell."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1532464600, "post_id": 51502579, "comment_id": 89983356, "body": "Here is a clue (but I cannot explain it): <code>respond_to_foo? #=&gt; false</code> when the code is in irbrc, <code>respond_to_foo? #=&gt; true</code> when executed in an IRB session. (Ruby v2.5.1)"}, {"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 1, "creation_date": 1532469389, "post_id": 51502579, "comment_id": 89985247, "body": "Oddly enough, change the foo definition to <code>def self.foo; end;</code> and it all works."}], "answers": [{"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 1, "last_activity_date": 1532447268, "creation_date": 1532447268, "answer_id": 51502839, "question_id": 51502579, "link": "https://stackoverflow.com/questions/51502579/ruby-and-irbrc-find-whether-a-method-is-defined/51502839#51502839", "title": "Ruby and .irbrc : Find whether a method is defined.", "body": "<p>To answer my own question: It just occured to me, that I could use</p>\n\n<pre><code>private_methods.include?(:foo)\n</code></pre>\n\n<p>This does work, but it looks a bit like a hack to me. If someone knows a better way, please let me know.</p>\n"}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532447268, "creation_date": 1532446439, "question_id": 51502579, "link": "https://stackoverflow.com/questions/51502579/ruby-and-irbrc-find-whether-a-method-is-defined", "title": "Ruby and .irbrc : Find whether a method is defined.", "body": "<p>I have a function in my .irbrc which basically builds together a string form certain input parameters, and then is supposed to check, whether another function with name of this string exists. I'm doing it like this</p>\n\n<pre><code>methodname = ... # Calculate a string\nif respond_to?(methodname)\n  ....\nend\n</code></pre>\n\n<p>This does not work in that respond_to? returns false even in those cases where in my opinion it should return true. I have boiled down the problem to the following simple case:</p>\n\n<p>I have in my .irbrc  </p>\n\n<pre><code>def foo\nend\ndef respond_to_foo?\n  respond_to?(:foo)\nend\nputs \"Respond: #{respond_to_foo?}\"\n</code></pre>\n\n<p>Running <code>irb</code>, this outputs <em>false</em>. I would expect it to print <em>true</em> instead. Still, I am able to run <code>foo</code> from within irb.</p>\n\n<p>I guess that this has to do with the scope in which irb defines my methods. For instance, <code>self.foo</code> does not work (<em>private method 'foo' called for main:Object</em>), while <code>send.foo</code> does work (since it bypasses privacy). This looks like a clue to my problem, but I still can't come up with an explanation, nor find the proper way for doing my task.</p>\n\n<p>Could someone enlighten me?</p>\n"}, {"tags": ["ruby", "redis", "ruby-on-rails-5", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 1, "last_activity_date": 1532522485, "creation_date": 1532522485, "answer_id": 51519157, "question_id": 51502374, "link": "https://stackoverflow.com/questions/51502374/thread-in-parallel-gem-ruby/51519157#51519157", "title": "Thread in Parallel gem Ruby", "body": "<p>Try next to make it work</p>\n\n<pre><code>Parallel.each(disbursement.employee_disbursements, in_threads: 2) do |employee|\n  ActiveRecord::Base.connection_pool.with_connection do\n    amount = amount_format(employee.amount)\n    res = unload_company_account(cmp_acc_id, amount.to_s)\n    load_employee_account(employee) unless res.empty?\n  end\nend\n</code></pre>\n\n<p>Also, that issue go away when use map instead of each or pass attribute <code>preserve_results</code> as <code>true</code> or <code>false</code>. That is a bit mystery because:</p>\n\n<pre><code>def each(array, options={}, &amp;block)\n  map(array, options.merge(:preserve_results =&gt; false), &amp;block)\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9309678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ea2c65d711ea0ece49f77035404c55?s=128&d=identicon&r=PG&f=1", "display_name": "mag", "link": "https://stackoverflow.com/users/9309678/mag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532522485, "creation_date": 1532445850, "question_id": 51502374, "link": "https://stackoverflow.com/questions/51502374/thread-in-parallel-gem-ruby", "title": "Thread in Parallel gem Ruby", "body": "<p>I am using sidekiq gem for queue. and I want to process my executing parallely inside the queue.</p>\n\n<p>here is my code for queue</p>\n\n<pre><code>      def perform(disbursement_id)\n         some logic...\n          Parallel.each(disbursement.employee_disbursements, in_threads: 2) do |employee|\n            amount = amount_format(employee.amount)\n            res = unload_company_account(cmp_acc_id, amount.to_s)\n            load_employee_account(employee) unless res.empty?\n          end\n      end\n</code></pre>\n\n<p>Now when I use Parallel.each() without threads it works good, but when i use  Parallel.each(.., in_threads:3) it goes to busy state of queue.</p>\n\n<p>Not sure why in_threads takes my queue to busy state. I am not able to resolve it.</p>\n"}, {"tags": ["ruby", "rspec", "stringio"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532445211, "post_id": 51501992, "comment_id": 89972587, "body": "Can&#39;t reproduce your &quot;if I do it in normal ruby&quot; scenario. Works as it should. Is it possible that you redefine <code>StringIO</code> somewhere, in any way?"}, {"owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532445452, "post_id": 51501992, "comment_id": 89972792, "body": "Surprisinly normal ruby is working now. But the RSpec test is still failing. I updated my question."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532445481, "post_id": 51501992, "comment_id": 89972813, "body": "Restart spring if you use it. It was the source of many many mysterious problems for me."}, {"owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532445693, "post_id": 51501992, "comment_id": 89972994, "body": "@SergioTulentsev thanks, I&#39;m not using Spring. It&#39;s a very basic ruby app. I updated my question."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532445906, "post_id": 51501992, "comment_id": 89973159, "body": "if you post an actual runnable and reproducible example to github, I&#39;ll take a look. Don&#39;t post your whole app, though. Reduce it to absolute minimum that <b>a)</b>  still reproduces the problem and <b>b)</b> is complete and runnable. I (or someone else) should be able to simply checkout, bundle and run rspec."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532446187, "post_id": 51501992, "comment_id": 89973366, "body": "^ it&#39;s called a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, btw."}, {"owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1532447419, "post_id": 51501992, "comment_id": 89974225, "body": "@SergioTulentsev thanks, I have pushed to <a href=\"https://github.com/crocodileDundee/foo\" rel=\"nofollow noreferrer\">github.com/crocodileDundee/foo</a>, it contains only the writer and the writer tests, just clone it and run <code>bundle</code> and <code>rspec</code>"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1532448944, "creation_date": 1532448944, "answer_id": 51503310, "question_id": 51501992, "link": "https://stackoverflow.com/questions/51501992/is-there-such-a-thing-as-opening-a-stringio-for-writing/51503310#51503310", "title": "Is there such a thing as opening a StringIO for writing?", "body": "<p>Here's your problem:</p>\n\n<pre><code># frozen_string_literal: true\n</code></pre>\n\n<p>Your string <code>contents</code> is frozen and can't be modified. StringIO expresses it with the abovementioned <code>IOError</code>.</p>\n"}], "owner": {"reputation": 781, "user_id": 2750478, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/db3f32fbc9f8de3052199d04c48f7200?s=128&d=identicon&r=PG&f=1", "display_name": "Xirux Nefer", "link": "https://stackoverflow.com/users/2750478/xirux-nefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 1, "accepted_answer_id": 51503310, "answer_count": 1, "score": 0, "last_activity_date": 1532448944, "creation_date": 1532444781, "last_edit_date": 1532447934, "question_id": 51501992, "link": "https://stackoverflow.com/questions/51501992/is-there-such-a-thing-as-opening-a-stringio-for-writing", "title": "Is there such a thing as opening a StringIO for writing?", "body": "<p>I am trying to use RSpec to test a class that writes to a file. But I want the tests to be fast, so instead of using a real file and write to disk I want to use StringIO in tests and write to memory.</p>\n\n<p>In a very simplified way, let's say I have this test:</p>\n\n<pre><code>RSpec.describe Writer do\n  it 'replaces the contents of the file' do\n    file = StringIO.new('foo')\n    writer = described_class.new(file)\n    one_contact = [{ 'name' =&gt; 'name', 'address' =&gt; 'address' }]\n\n    writer.write(one_contact)\n\n    expect(file.string).to eq('[{\"name\":\"name1\",\"address\":\"address1\"}]')\n  end\nend\n</code></pre>\n\n<p>and let's say the writer class is like this:</p>\n\n<pre><code>require 'json'\n\nclass Writer\n  def initialize(file)\n    @file = file\n  end\n\n  def write(contacts)\n    file.truncate(0)\n    file.write(contacts.to_json)\n    file.flush\n  end\n\n  private\n\n  attr_reader :file\nend\n</code></pre>\n\n<p>when I run the tests through Rspec I get the error:</p>\n\n<pre><code> Failure/Error: file.truncate(0)\n\n IOError:\n   not opened for writing\n</code></pre>\n\n<p>If I change <code>truncate</code> for something else then I get this error in the line that calls <code>write</code> on <code>file</code>.</p>\n\n<p>However, if I do it in pry, it works:</p>\n\n<pre><code>$ pry\n[1] pry(main)&gt; require_relative 'lib/db/writer'\n=&gt; true\n[2] pry(main)&gt; file = StringIO.new('foo')\n=&gt; #&lt;StringIO:0x0000563c99220f70&gt;\n[3] pry(main)&gt; writer = Writer.new(file)\n=&gt; #&lt;Writer:0x0000563c98ff8950 @file=#&lt;StringIO:0x0000563c99220f70&gt;&gt;\n[4] pry(main)&gt; one_contact = [{ 'name' =&gt; 'name', 'address' =&gt; 'address' }]\n=&gt; [{\"name\"=&gt;\"name\", \"address\"=&gt;\"address\"}]\n[5] pry(main)&gt; writer.write(one_contact)\n=&gt; #&lt;StringIO:0x0000563c99220f70&gt;\n[6] pry(main)&gt; file.string\n=&gt; \"[{\\\"name\\\":\\\"name\\\",\\\"address\\\":\\\"address\\\"}]\"\n</code></pre>\n\n<p>If I do it in a normal ruby file and run it with ruby, for example:</p>\n\n<pre><code>require_relative 'lib/db/writer'\n\nfile = StringIO.new('foo')\nwriter = Writer.new(file)\n\none_contact = [{ 'name' =&gt; 'name1', 'address' =&gt; 'address1' }]\nwriter.write(one_contact)\nputs file.string\n</code></pre>\n\n<p>It works as well.</p>\n\n<p>This is a super simple Ruby app, no dependencies or frameworks, this is what the Gemfile looks like:</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.5.1'\n\ngem 'sqlite3'\n\ngroup :test do\n  gem 'coveralls', require: false\n  gem 'pry'\n  gem 'rake'\n  gem 'rspec'\n  gem 'rubocop', require: false\nend\n</code></pre>\n\n<p>Actual gem versions:</p>\n\n<ul>\n<li>sqlite3 (1.3.13)</li>\n<li>coveralls (0.8.22)</li>\n<li>pry (0.11.3)</li>\n<li>rake (12.3.1)</li>\n<li>rspec (3.7.0)</li>\n<li>rubocop (0.58.1)</li>\n</ul>\n\n<p>How can I open a StringIO for writing? I want to keep writing to memory rather than disk on tests.</p>\n"}, {"tags": ["ruby", "shoes"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532439164, "post_id": 51499905, "comment_id": 89968084, "body": "May be you need to replace <code>shuffle</code> with <code>shuffle!</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532439196, "post_id": 51499905, "comment_id": 89968120, "body": "@JagdeepSingh: no, it&#39;s another thing."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1532439214, "post_id": 51499905, "comment_id": 89968137, "body": "It looks like you sample for nouns in the assignment to <code>@base</code>, which only happens once. So you get the same quote since you never reassign that variable in <code>@think.click</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532439287, "post_id": 51499905, "comment_id": 89968211, "body": "Your <code>shuffle</code> is redundant, btw. Random choice is already achieved by <code>sample</code>"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 13, "user_id": 10127818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OyQXhNfX2ns/AAAAAAAAAAI/AAAAAAAAADM/efBjumQwKDM/photo.jpg?sz=128", "display_name": "Remmi Bogomolova", "link": "https://stackoverflow.com/users/10127818/remmi-bogomolova"}, "edited": false, "score": 0, "creation_date": 1532441255, "post_id": 51500162, "comment_id": 89969690, "body": "@RemmiBogomolova: you&#39;re welcome. Don&#39;t stop here, though. Try to do the suggested improvement. Good practice."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 0, "last_activity_date": 1532439683, "creation_date": 1532439683, "answer_id": 51500162, "question_id": 51499905, "link": "https://stackoverflow.com/questions/51499905/random-quote-generator-repeats-the-same-quotes-why/51500162#51500162", "title": "Random quote generator repeats the same quotes, why?", "body": "<p>You need to generate random quote on each click, rather than pre-generating them at app startup. This should be the laziest change to do what you want:</p>\n\n<pre><code>def generate_random_quote(nominative, accusative)\n  all_generated_quotes = [\n    nominative.sample.capitalize + \" - \u044d\u0442\u043e \u0432\u0441\u044f\u043a\u0438\u0439, \u043a\u0442\u043e \u0441\u0442\u0440\u0435\u043c\u0438\u0442\u0441\u044f \u0443\u0431\u0438\u0442\u044c \u0442\u0435\u0431\u044f, \u043d\u0435\u0432\u0430\u0436\u043d\u043e \u043d\u0430 \u0447\u044c\u0435\u0439 \u043e\u043d \u0441\u0442\u043e\u0440\u043e\u043d\u0435.\",\n    \"\u0418\u043d\u043e\u0433\u0434\u0430 \" + nominative.sample + \" \u043d\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \" + accusative.sample + \", \u043d\u043e \" + nominative.sample + \" \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u043e\u043c\u0430\u0445\u043d\u0443\u0442\u044c\u0441\u044f.\",\n    \"\u041d\u0435\u0442 \u043d\u0438\u0447\u0435\u0433\u043e \u0442\u0440\u0443\u0434\u043d\u0435\u0435, \u0447\u0435\u043c \u0433\u0438\u0431\u043d\u0443\u0442\u044c, \u043d\u0435 \u043f\u043b\u0430\u0442\u044f \u0441\u043c\u0435\u0440\u0442\u044c\u044e \u0437\u0430 \" + accusative.sample + \".\",\n    \"\u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0443\u043c\u044b \u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \" + accusative.sample + \", \u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u043d\u0441\u0442\u0438\u0442\u0443\u0442\u044b \u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \" + accusative.sample + \".\",\n    nominative.sample.capitalize + \" - \u044d\u0442\u043e \u0442\u043e\u0442 \u0447\u0435\u043b\u043e\u0432\u0435\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u043d\u0430\u0435\u0442 \u043e \u0432\u0430\u0441 \u0432\u0441\u0435 \u0438 \u043d\u0435 \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u0435\u0442 \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u043b\u044e\u0431\u0438\u0442\u044c \u0432\u0430\u0441.\",\n    \"\u0422\u0440\u0443\u0434\u043d\u043e \u0441\u0435\u0431\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c, \u0447\u0442\u043e \u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0431\u044b \u0441 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u043e\u043c, \u0436\u0438\u0432\u0438 \u043e\u043d \u0432 \u0433\u043e\u0441\u0443\u0434\u0430\u0440\u0441\u0442\u0432\u0435, \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u043c \u043b\u0438\u0442\u0435\u0440\u0430\u0442\u0443\u0440\u043d\u044b\u043c\u0438 \u0433\u0435\u0440\u043e\u044f\u043c\u0438.\"\n  ]\n\n  all_generated_quotes.sample\nend\n\n@think.click do\n  freshly_baked_random_quote = generate_random_quote(@noun_nominative, @noun_accusative)\n  @thought.replace(freshly_baked_random_quote)\nend\n</code></pre>\n\n<p>It is, of course, rather wasteful. It generates all possible quotes and discards all but one. If that's a concern, fixing that would be your homework. :)</p>\n"}], "owner": {"reputation": 13, "user_id": 10127818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OyQXhNfX2ns/AAAAAAAAAAI/AAAAAAAAADM/efBjumQwKDM/photo.jpg?sz=128", "display_name": "Remmi Bogomolova", "link": "https://stackoverflow.com/users/10127818/remmi-bogomolova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 51500162, "answer_count": 1, "score": 1, "last_activity_date": 1532441004, "creation_date": 1532438954, "last_edit_date": 1532441004, "question_id": 51499905, "link": "https://stackoverflow.com/questions/51499905/random-quote-generator-repeats-the-same-quotes-why", "title": "Random quote generator repeats the same quotes, why?", "body": "<p>Good day to everyone! There is a quote generator made with Shoes.</p>\n\n<pre><code>    @think.click do\n        @noun_nominative.shuffle\n        @base.shuffle\n        @thought.replace(@base.sample)\n    end\n\n    @noun_nominative = \n        [\n            \"word1\", \"word2\", \"word3\", \"word4\",\n            \"word5\", \"word6\", \"word7\", \"word8\"\n        ]\n    @noun_accusative = \n        [\n            \"word1\", \"word2\", \"word3\"\n        ]\n    @base =\n        [\n        @noun_nominative.sample.capitalize + \"regular quote\",\n        \"Regular quote\" + @noun_nominative.sample,\n        \"Regular quote\" + @noun_accusative.sample,\n        \"Regular quote\" + @noun_accusative.sample,\n        @noun_nominative.sample.capitalize + \"regular quote\",\n        \"And another one base for a quote\"\n        ]       \n</code></pre>\n\n<p>It simply replaces phrases in <em>base</em> array with random words from <em>noun_nominative</em> and <em>noun_accusative</em>, showing a new quote every time button \"think\" is clicked.</p>\n\n<p>The program should make a brand new quote with every click, however, it keeps showing the same phrases which were generated once. How could I make it regenerate the quotes without reopening the program?</p>\n\n<p>Thank you for answering!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532439418, "post_id": 51499893, "comment_id": 89968303, "body": "<code>self.settings = self.settings || {my_fields: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}</code> can be written as <code>self.settings ||= {my_fields: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}</code> btw."}, {"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532439522, "post_id": 51499893, "comment_id": 89968407, "body": "Got it. Thank you.."}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "edited": false, "score": 2, "creation_date": 1532440830, "post_id": 51499893, "comment_id": 89969387, "body": "That&#39;s strange behaviour, are you sure you haven&#39;t set <code>&lt;ActionController::Parameters  permitted: &gt;</code> before via assigning params? What <code>MyModel.new</code> returns?"}, {"owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "edited": false, "score": 0, "creation_date": 1532442098, "post_id": 51499893, "comment_id": 89970322, "body": "When I tried MyModel.new it woks fine. I have checked records in database, and it seems you are correct, the value was set as <code>&lt;ActionController::Parameters  permitted: &gt;</code> but I can&#39;t confirm that how it was assigned and goes to database. This is important to know for me as in couple of places I have used callback like this. Any hint ?"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532445147, "post_id": 51499893, "comment_id": 89972539, "body": "Check the model, or some custom validations / before save callbacks. Probably you are assigning the reponse of some function to the settings attribute."}], "owner": {"reputation": 5930, "user_id": 663660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vMsSv.jpg?s=128&g=1", "display_name": "Anand Soni", "link": "https://stackoverflow.com/users/663660/anand-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1532438923, "creation_date": 1532438923, "question_id": 51499893, "link": "https://stackoverflow.com/questions/51499893/actioncontrollerparameters-permitted-assigned-with-field-is-nil-in-model-rai", "title": "ActionController::Parameters permitted assigned with field is nil in Model : Rails 5", "body": "<p>I am migrating code from Rails 3 to Rails 5.1.6 and Ruby 2.5. I am facing strange issue. I have written <code>after_initialize</code> callback in model and assigning default value to field. The field is <code>serialize</code> and when there is <code>nil</code> in that field it will assign default value inside the callback. </p>\n\n<p>Here is my code for clear picture</p>\n\n<pre><code>class MyModel &lt; ActiveRecord::Base\n  serialize :settings\n\n  after_initialize :set_default_setting\n\n  def set_default_setting\n    self.settings = self.settings || {my_fields: [\"a\", \"b\", \"c\"]}\n  end\nend\n</code></pre>\n\n<p>Here is my Rails console log :</p>\n\n<pre><code>[1] 2.5.0 :135 &gt; md = MyModel.find(1)\n=&gt; #&lt;MyModel:0x00007fe433608348\n id: 1,\n settings: &lt;ActionController::Parameters  permitted: &gt;,\n created_at: Tue, 16 Jan 2018 08:45:26 GMT +00:00,\n updated_at: Fri, 04 May 2018 10:50:20 BST +01:00&gt;\n\n[2] 2.5.0 :136 &gt; md.settings\n=&gt; &lt;ActionController::Parameters  permitted: &gt;\n[3] 2.5.0 :137 &gt; md.settings.nil?\n=&gt; false\n</code></pre>\n\n<p>My question is why <code>&lt;ActionController::Parameters  permitted: &gt;</code> is being added in to nil field ? when I execute <code>nil?</code> method it should return me <code>nil</code>. Above code was working fine with Rails 3.2 and Ruby 2.0 from which I am upgrading to Rails 5 and Ruby 2.5</p>\n\n<p>Any help will be appreciated. </p>\n\n<p>Thank you in Advance.</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "is_accepted": false, "score": 1, "last_activity_date": 1532437212, "creation_date": 1532437212, "answer_id": 51499283, "question_id": 51498319, "link": "https://stackoverflow.com/questions/51498319/error-compiler-gem-private-gem-server/51499283#51499283", "title": "Error Compiler gem &#39;private-gem-server&#39;", "body": "<p>As written in error <code>You have to install development tools first.</code></p>\n\n<p>Development tools are used to compile gems with C-extensions.</p>\n\n<p>So go to <a href=\"https://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">https://rubyinstaller.org/downloads/</a>, select corresponding ruby version <strong>with devkit</strong>, donwload and install it, but be prepared, ruby on windows will give you lots of headaches as newbie.</p>\n"}], "owner": {"reputation": 66, "user_id": 1000188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72lXK.jpg?s=128&g=1", "display_name": "cumulus13", "link": "https://stackoverflow.com/users/1000188/cumulus13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532437212, "creation_date": 1532434282, "question_id": 51498319, "link": "https://stackoverflow.com/questions/51498319/error-compiler-gem-private-gem-server", "title": "Error Compiler gem &#39;private-gem-server&#39;", "body": "<p>i get an error while compile gem 'private_gem_server' on my windows, ActiveRuby with gcc</p>\n\n<pre>                                                                                                                                                                                                               \n    gem_make.out:\n    current directory: C:/SDK/ActiveRuby/lib/ruby/gems/2.3.0/gems/thin-1.7.2/ext/thin_parser\n                C:/SDK/ActiveRuby/bin/ruby.exe -r ./siteconf20180724-39224-y3ahsm.rb extconf.rb\n                checking for main() in -lc... *** extconf.rb failed ***\n                Could not create Makefile due to some reason, probably lack of necessary\n                libraries and/or headers.  Check the mkmf.log file for more details.  You may\n                need configuration options.\n\n                Provided configuration options:\n                    --with-opt-dir\n                    --without-opt-dir\n                    --with-opt-include\n                    --without-opt-include=${opt-dir}/include\n                    --with-opt-lib\n                    --without-opt-lib=${opt-dir}/lib\n                    --with-make-prog\n                    --without-make-prog\n                    --srcdir=.\n                    --curdir\n                    --ruby=C:/SDK/ActiveRuby/bin/$(RUBY_BASE_NAME)\n                    --with-thin_parser-dir\n                    --without-thin_parser-dir\n                    --with-thin_parser-include\n                    --without-thin_parser-include=${thin_parser-dir}/include\n                    --with-thin_parser-lib\n                    --without-thin_parser-lib=${thin_parser-dir}/lib\n                    --with-clib\n                    --without-clib\n                C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\n                You have to install development tools first.\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:541:in `try_link0'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:556:in `try_link'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:765:in `try_func'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:997:in `block in have_library'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:942:in `block in checking_for'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:350:in `block (2 levels) in postpone'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:320:in `open'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:350:in `block in postpone'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:320:in `open'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:346:in `postpone'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:941:in `checking_for'\n                    from C:/SDK/ActiveRuby/lib/ruby/2.3.0/mkmf.rb:992:in `have_library'\n                    from extconf.rb:4:in `'\n\n                To see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n                  C:/SDK/ActiveRuby/lib/ruby/gems/2.3.0/extensions/x64-mingw32/2.3.0/thin-1.7.2/mkmf.log\n\n                extconf failed, exit code 1\n\n    mkmf.log:\n\n                \"gcc -o conftest.exe -IC:/SDK/ActiveRuby/include/ruby-2.3.0/x64-mingw32 -IC:/SDK/ActiveRuby/include/ruby-2.3.0/ruby/backward -IC:/SDK/ActiveRuby/include/ruby-2.3.0 -I. -DFD_SETSIZE=2048 -D_WIN32_WINNT=0x0501 -D__MINGW_USE_VC2005_COMPAT -D_FILE_OFFSET_BITS=64   -O3 -fno-omit-frame-pointer -fno-fast-math -g -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Wunused-variable -Wpointer-arith -Wwrite-strings -Wdeclaration-after-statement -Wimplicit-function-declaration -Wdeprecated-declarations -Wno-packed-bitfield-compat -Wno-maybe-uninitialized conftest.c  -L. -LC:/SDK/ActiveRuby/lib -L.      -lx64-msvcrt-ruby230  -lshell32 -lws2_32 -liphlpapi -limagehlp -lshlwapi  \"\n                checked program was:\n                /* begin */\n                1: #include \"ruby.h\"\n                2: \n                3: #include \n                4: #include \n                5: int main(int argc, char **argv)\n                6: {\n                7:   return 0;\n                8: }\n                /* end */\n\n</pre>\n\n<p>How to correct it, sorry i am newbie </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1532433333, "post_id": 51497950, "comment_id": 89963727, "body": "Your data from the file likely includes a trailing newline character. Do <code>p data</code> and you&#39;ll see."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532433458, "post_id": 51497950, "comment_id": 89963813, "body": "Also, style-wise, your parenthesizing is... unusual. Either do <code>if data.to_s.eql?(&quot;hello&quot;)</code> (what I would do) or no parentheses at all (they&#39;re not necessary here)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1532433569, "post_id": 51497950, "comment_id": 89963884, "body": "@SergioTulentsev you <i>would do</i> <code>String#to_s#eql?</code>?!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 4, "creation_date": 1532433594, "post_id": 51497950, "comment_id": 89963900, "body": "@mudasobwa: you know what I meant. :) The comment was only about parentheses. Fixing other issues is out of scope."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 1, "creation_date": 1532434114, "post_id": 51497950, "comment_id": 89964280, "body": "<code>data.chomp.eql? &quot;hello&quot; #=&gt; true</code>"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532434119, "post_id": 51497950, "comment_id": 89964291, "body": "Try with <code>data.include?(&#39;hello&#39;)</code> if you <b>instead</b> want to check <code>data</code> contains a particular string. Ignore otherwise."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1532435482, "post_id": 51498496, "comment_id": 89965249, "body": "Touching the file is not necessary, btw. At least, on my machine."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1532435751, "post_id": 51498496, "comment_id": 89965441, "body": "@SergioTulentsev, not necessary anywhere(Ubuntu, Windows etc)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 1, "last_activity_date": 1532435855, "last_edit_date": 1532435855, "creation_date": 1532434830, "answer_id": 51498496, "question_id": 51497950, "link": "https://stackoverflow.com/questions/51497950/comparing-string-with-string-from-file-in-ruby/51498496#51498496", "title": "Comparing String with String from file in Ruby", "body": "<p>When reading data from a file, it's likely you get a newline tagged on to the end of your data.</p>\n\n<p>For example, if I run the following in the terminal to create a file containing only the word 'hello':</p>\n\n<pre><code>echo hello &gt; data.txt\n</code></pre>\n\n<p>And the read this in the terminal, I see:</p>\n\n<pre><code>cat data.txt\n# =&gt; hello\n</code></pre>\n\n<p>However, jumping into <code>irb</code>, I get the following:</p>\n\n<pre><code>File.read(\"data.txt\")\n# =&gt; \"hello\\n\"\n</code></pre>\n\n<p>The <code>\\n</code> is the newline operator.</p>\n\n<p>To solve your question, you can use:</p>\n\n<pre><code>if data.chomp == \"hello\"\n  ...   \nend\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-chomp\" rel=\"nofollow noreferrer\"><code>chomp</code></a> removes any record separator from the end of the string, giving you the comparison you're after.</p>\n\n<p>If you just want to know whether the file contains the specified string, you can also use:</p>\n\n<pre><code>data['hello']\n</code></pre>\n\n<p>This will return the truthy value in the square brackets if present, or <code>nil</code> if not.</p>\n\n<pre><code>if data[\"hello\"]\n  ...   \nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10127658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85eacc406a3b3215ab34f04d4a8aaaee?s=128&d=identicon&r=PG&f=1", "display_name": "Wi3l4nd", "link": "https://stackoverflow.com/users/10127658/wi3l4nd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 51498496, "answer_count": 1, "score": 0, "last_activity_date": 1532435855, "creation_date": 1532433266, "last_edit_date": 1532433385, "question_id": 51497950, "link": "https://stackoverflow.com/questions/51497950/comparing-string-with-string-from-file-in-ruby", "title": "Comparing String with String from file in Ruby", "body": "<pre><code>data = File.read(\"data.txt\")\nif(data.to_s.eql? \"hello\")\n  ...   \nend\n</code></pre>\n\n<p>My data.txt is filled with \"hello\" as well, so the if-loop should get active but it doesn't. What do I do wrong?</p>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532434454, "post_id": 51497768, "comment_id": 89964517, "body": "You can check if a variable is defined with <code>defined?(y)</code>."}, {"owner": {"reputation": 67, "user_id": 6833192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bd818310557ee0732f1f26fb406d73d?s=128&d=identicon&r=PG&f=1", "display_name": "Francis Zhu", "link": "https://stackoverflow.com/users/6833192/francis-zhu"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532435539, "post_id": 51497768, "comment_id": 89965290, "body": "@JagdeepSingh, what I was trying to say is that I have to always define the variables(x and y in this case) even I want the template result in &quot;The value of x is: 42 The value of y is &lt;%= y %&gt;&quot; ?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532437376, "post_id": 51499099, "comment_id": 89966639, "body": "Will behave as specified, but the implementation is... wordy :)"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1532437583, "post_id": 51499099, "comment_id": 89966843, "body": "Can&#39;t help it. :D"}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 2, "last_activity_date": 1532436677, "creation_date": 1532436677, "answer_id": 51499099, "question_id": 51497768, "link": "https://stackoverflow.com/questions/51497768/ruby-templating-is-it-possible-that-only-pass-some-values-to-variables-in-templ/51499099#51499099", "title": "Ruby templating: is it possible that only pass some values to variables in template?", "body": "<p>You can use double opening <code>%%</code>s to prevent it from being evaluated in erb.</p>\n\n<p>This solution might look ugly but it returns exactly what you want (if it is what you want):</p>\n\n<pre><code>require 'erb'\n\ntemplate = ERB.new &lt;&lt;-EOF\n  The value of x is: &lt;% if defined?(x) %&gt;&lt;%= x %&gt;&lt;% else %&gt;&lt;%%= x %&gt;&lt;% end %&gt;\n  The value of y is: &lt;% if defined?(y) %&gt;&lt;%= y %&gt;&lt;% else %&gt;&lt;%%= y %&gt;&lt;% end %&gt;\nEOF\n =&gt; #&lt;ERB:0x00007feeec80c428 @safe_level=nil, @src=\"#coding:UTF-8\\n_erbout = +''; _erbout.&lt;&lt;(-\\\"  The value of x is: \\\");  if defined?(x) ; _erbout.&lt;&lt;(( x ).to_s);  else ; _erbout.&lt;&lt;(-\\\"&lt;%= x %&gt;\\\");  end ; _erbout.&lt;&lt;(-\\\"\\\\n  The value of y is: \\\"\\n);  if defined?(y) ; _erbout.&lt;&lt;(( y ).to_s);  else ; _erbout.&lt;&lt;(-\\\"&lt;%= y %&gt;\\\");  end ; _erbout.&lt;&lt;(-\\\"\\\\n\\\"\\n); _erbout\", @encoding=#&lt;Encoding:UTF-8&gt;, @frozen_string=nil, @filename=nil, @lineno=0&gt; \n\nputs template.result(binding)\n  The value of x is: &lt;%= x %&gt;\n  The value of y is: &lt;%= y %&gt;\n =&gt; nil \n\nx = 20\n\nputs template.result(binding)\n  The value of x is: 20\n  The value of y is: &lt;%= y %&gt;\n =&gt; nil \n\ny= 50\n\nputs template.result(binding)\n  The value of x is: 20\n  The value of y is: 50\n =&gt; nil \n</code></pre>\n\n<p>I assume you can do the formatting.</p>\n"}], "owner": {"reputation": 67, "user_id": 6833192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bd818310557ee0732f1f26fb406d73d?s=128&d=identicon&r=PG&f=1", "display_name": "Francis Zhu", "link": "https://stackoverflow.com/users/6833192/francis-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51499099, "answer_count": 1, "score": 0, "last_activity_date": 1532436677, "creation_date": 1532432752, "question_id": 51497768, "link": "https://stackoverflow.com/questions/51497768/ruby-templating-is-it-possible-that-only-pass-some-values-to-variables-in-templ", "title": "Ruby templating: is it possible that only pass some values to variables in template?", "body": "<p>I'm learning ruby template and looking at the example provided by ruby documentation.</p>\n\n<pre><code>require 'erb'\nx = 42\ntemplate = ERB.new &lt;&lt;-EOF\n   The value of x is: &lt;%= x %&gt;\nEOF\nputs template.result(binding)\n</code></pre>\n\n<p>When I change the example by doing something like this:</p>\n\n<pre><code>require 'erb'\nx = 42\ntemplate = ERB.new &lt;&lt;-EOF\n   The value of x is: &lt;%= x %&gt;\n   The value of y is &lt;%= y %&gt;\nEOF\nputs template.result(binding)\n</code></pre>\n\n<p>I was hoping the template will become something like this:</p>\n\n<pre><code>The value of x is: 42\nThe value of y is &lt;%= y %&gt;\n</code></pre>\n\n<p>It gives me the error:</p>\n\n<blockquote>\n  <p>Error: undefined local variable or method `y' for main:Object (NameError)</p>\n</blockquote>\n\n<p>Looks like we need to pass all the values for all the variable substitutions in the template.</p>\n\n<p><strong>Question:</strong>\nI'm just wondering if it is possible that we can have two variable substitutions in the template but only pass one value into the template when binding the data?</p>\n"}, {"tags": ["ruby", "ruby-2.3"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1532433297, "creation_date": 1532433297, "answer_id": 51497961, "question_id": 51497766, "link": "https://stackoverflow.com/questions/51497766/which-class-does-a-method-defined-inside-a-block-belong-to/51497961#51497961", "title": "Which class does a method defined inside a block belong to?", "body": "<p>If you want to retrieve the class the method is defined on, you should do it explicitly:</p>\n\n<pre><code>Foo.new.test_method do \n  def m1; :content_does_not_matter; end\n  puts method(:m1).inspect\nend  \n#\u21d2\u00a0#&lt;Method: Object#m1&gt;\n</code></pre>\n\n<p>One might use <a href=\"https://ruby-doc.org/core/Method.html#method-i-owner\" rel=\"nofollow noreferrer\"><code>Method#owner</code></a> to retrieve the owner:</p>\n\n<pre><code>method(:m1).owner\n#\u21d2 Object\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1532433969, "post_id": 51497979, "comment_id": 89964166, "body": "@mudasobwa fair point, I edited my answer. It turns out <code>instance_eval</code> adds <code>m1</code> method as singleton method of the object on which <code>instance_eval</code> was called."}, {"owner": {"reputation": 1373, "user_id": 3887531, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5166843e0184db7a03e539d6fb24f443?s=128&d=identicon&r=PG&f=1", "display_name": "dhaliman", "link": "https://stackoverflow.com/users/3887531/dhaliman"}, "edited": false, "score": 0, "creation_date": 1532494340, "post_id": 51497979, "comment_id": 89990563, "body": "I was working with helpers in Sinatra. In Sinatra, helpers are defined in a helper block - <code>helpers do ... end</code>. Does this work according to the technique that you&#39;ve mentioned here?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 1373, "user_id": 3887531, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5166843e0184db7a03e539d6fb24f443?s=128&d=identicon&r=PG&f=1", "display_name": "dhaliman", "link": "https://stackoverflow.com/users/3887531/dhaliman"}, "edited": false, "score": 1, "creation_date": 1532495663, "post_id": 51497979, "comment_id": 89990915, "body": "@dhaliman as far as I can see, yes, it does:  <a href=\"https://github.com/sinatra/sinatra/blob/17b4253b209c7f537f67bb984774b4933b9147b4/sinatra-contrib/lib/sinatra/namespace.rb#L233\" rel=\"nofollow noreferrer\">github.com/sinatra/sinatra/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 4, "last_activity_date": 1532434239, "last_edit_date": 1532434239, "creation_date": 1532433352, "answer_id": 51497979, "question_id": 51497766, "link": "https://stackoverflow.com/questions/51497766/which-class-does-a-method-defined-inside-a-block-belong-to/51497979#51497979", "title": "Which class does a method defined inside a block belong to?", "body": "<p>First of all, <code>m1</code> returns the result of <code>puts</code>, which is <code>nil</code>.</p>\n\n<p>Second, with your current code, <code>m1</code> method is defined for <code>Object</code> class, because block by default remains its context, not only for local variables (which it does always), but also for 'current object' and 'current class'. If you want your definition work as you expect, you can use <code>class_eval</code>, which changes the current class inside of the block (executes this block in different context:</p>\n\n<pre><code>class Foo\n  def test_method(&amp;c)\n    puts 'inside test method'\n    self.class.class_eval(&amp;c)\n  end\nend\nf = Foo.new\nf.test_method do\n  def m1\n    # anything\n  end\nend\n\nFoo.instance_methods.grep(/m1/)\n# =&gt; [:m1]\nf.m1\n# =&gt; not an error\nObject.new.m1\n# =&gt; NoMethodError: undefined method `m1' for #&lt;Object:0x00000001c9b4f8&gt;\n</code></pre>\n"}], "owner": {"reputation": 1373, "user_id": 3887531, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5166843e0184db7a03e539d6fb24f443?s=128&d=identicon&r=PG&f=1", "display_name": "dhaliman", "link": "https://stackoverflow.com/users/3887531/dhaliman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 51497979, "answer_count": 2, "score": 1, "last_activity_date": 1532434239, "creation_date": 1532432751, "question_id": 51497766, "link": "https://stackoverflow.com/questions/51497766/which-class-does-a-method-defined-inside-a-block-belong-to", "title": "Which class does a method defined inside a block belong to?", "body": "<p>Here's a class </p>\n\n<pre><code>class Foo\n  def test_method(&amp;c)\n    puts \"inside test method\"\n    c.call\n  end\nend \n</code></pre>\n\n<p>Now, if I define a method inside the block</p>\n\n<pre><code>f = Foo.new\nf.test_method do \n  def m1\n    puts \"inside the method m1 defined inside the block\"\n  end\n  puts m1.class\nend\n</code></pre>\n\n<p>The output of the block is <code>NilClass</code></p>\n\n<p>If a method is defined outside a class it becomes a private method inside the class <code>Object</code>. Why does a method defined inside a block become a part of <code>NilClass</code> and not of the class <code>Foo</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sunspot", "sunspot-rails", "sunspot-solr"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5483671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBIzy.jpg?s=128&g=1", "display_name": "Alexey Spiridonov", "link": "https://stackoverflow.com/users/5483671/alexey-spiridonov"}, "edited": false, "score": 0, "creation_date": 1532436361, "post_id": 51496062, "comment_id": 89965874, "body": "Sunspot must combine Solr queries inside."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1532427288, "creation_date": 1532427288, "answer_id": 51496062, "question_id": 51495855, "link": "https://stackoverflow.com/questions/51495855/combine-two-sunspot-searches-with-or-condition/51496062#51496062", "title": "Combine two sunspot searches with OR condition", "body": "<p>I don't know about sunspot, but if you have two procs <code>first_search_conditions</code> and <code>second_search_conditions</code>, and want the disjunction of them, you can just construct:</p>\n\n<pre><code>Proc.new do |s|\n  first_search_conditions.call(s) ||\n  second_search_conditions.call(s)\nend\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5483671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBIzy.jpg?s=128&g=1", "display_name": "Alexey Spiridonov", "link": "https://stackoverflow.com/users/5483671/alexey-spiridonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532427288, "creation_date": 1532426668, "question_id": 51495855, "link": "https://stackoverflow.com/questions/51495855/combine-two-sunspot-searches-with-or-condition", "title": "Combine two sunspot searches with OR condition", "body": "<p>How can I combine two sunspot search conditions with OR condition?\nI tried here \u2193 but didn't have success.</p>\n\n<pre><code>first_search_conditions = Proc.new do |s|\n  s.with(:store_id, 1)\nend\n\nsecond_search_conditions = Proc.new do |s|\n  s.with(:store_id, 2)\n  s.fulltext('hello') do |ft|\n    ft.fields(name_words: 90)\n  end\nend\n\ndef search(first_block, second_block)\n  Sunspot.new_search(Offer) do |s|\n    s.any_of do |scope|\n      first_block.call(scope)\n      second_block.call(scope)\n    end\n  end\nend\n\nsearch(first_search_conditions, second_search_conditions)\n</code></pre>\n"}, {"tags": ["ruby", "rdoc", "yard"], "answers": [{"comments": [{"owner": {"reputation": 1235, "user_id": 533510, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/266cd5923db54ae0e7e49c7a48575c14?s=128&d=identicon&r=PG", "display_name": "ribamar", "link": "https://stackoverflow.com/users/533510/ribamar"}, "edited": false, "score": 0, "creation_date": 1532617622, "post_id": 51530849, "comment_id": 90051764, "body": "ok, maybe the question was confusing, but, although what I what to display in the case above is an example, but I would like the solution to work for other cases too. Example of other cases: an ASCII art image displaying a super cow."}, {"owner": {"reputation": 1235, "user_id": 533510, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/266cd5923db54ae0e7e49c7a48575c14?s=128&d=identicon&r=PG", "display_name": "ribamar", "link": "https://stackoverflow.com/users/533510/ribamar"}, "edited": false, "score": 0, "creation_date": 1533825958, "post_id": 51530849, "comment_id": 90498555, "body": "I really appreciate your efforts and I really like the supercow there... but that&#39;s definitively not the answer -- the source code isn&#39;t to be output. I think that&#39;s better to admit that it&#39;s probably not possible to do it."}], "tags": [], "owner": {"reputation": 1, "user_id": 10136423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrjCF.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10136423/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1532651926, "last_edit_date": 1532651926, "creation_date": 1532578074, "answer_id": 51530849, "question_id": 51495783, "link": "https://stackoverflow.com/questions/51495783/ruby-yard-documentation-how-to-add-a-verbatim-to-generate-something-like-a/51530849#51530849", "title": "Ruby Yard documentation: how to add a &quot;verbatim&quot; (to generate something like a &lt;pre&gt; tag)", "body": "<h2>EDIT</h2>\n\n<pre><code>&gt; gem install redcarpet\n&gt; yard doc --markup-provider redcarpet --markup markdown - file.rb\n</code></pre>\n\n<p>Should wrap the contents of <code>file.rb</code> within a <code>&lt;pre&gt;</code> tag, producing this <a href=\"https://i.stack.imgur.com/XSFWX.png\" rel=\"nofollow noreferrer\">page</a>.</p>\n\n<hr>\n\n<p>Use <a href=\"https://www.rubydoc.info/gems/yard/file/docs/Tags.md#example\" rel=\"nofollow noreferrer\">@example</a></p>\n\n<blockquote>\n  <p>Show an example snippet of code for an object. The first line is an optional title.</p>\n</blockquote>\n\n<pre><code># @example One example of valid hash to this function is:\n#   {\n#       :name =&gt; \"Engelbert\",\n#       :id  =&gt; 1345\n#   }\ndef f hash_param\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1235, "user_id": 533510, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/266cd5923db54ae0e7e49c7a48575c14?s=128&d=identicon&r=PG", "display_name": "ribamar", "link": "https://stackoverflow.com/users/533510/ribamar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532651926, "creation_date": 1532426434, "last_edit_date": 1532520026, "question_id": 51495783, "link": "https://stackoverflow.com/questions/51495783/ruby-yard-documentation-how-to-add-a-verbatim-to-generate-something-like-a", "title": "Ruby Yard documentation: how to add a &quot;verbatim&quot; (to generate something like a &lt;pre&gt; tag)", "body": "<p>I want a piece of code, like a hash, to display with fixed typeface on the resulting html. Suppose this is the contents of my file:</p>\n\n<pre><code>=begin\n\nOne example of valid hash to this function is:\n{\n    :name =&gt; \"Engelbert\",\n    :id  =&gt; 1345\n}\n=end\ndef f hash_param\n  # ...\nend\n</code></pre>\n\n<p>How to instruct yard (using the default of the version <code>0.9.15</code>) so a <code>yard doc file.rb</code>  will generate, for the hash example, the equivalent of adding 4 backslashes to the markdown format, or 4 starting empty spaces to stackoverflow, or the  <code>&lt;pre&gt;</code> tag in html, resulting in a verbatim/fixed typeface format in the resulting html? </p>\n\n<p>Expected output:</p>\n\n<pre><code>One example of valid hash to this function is:\n{\n    :name =&gt; \"Engelbert\",\n    :id  =&gt; 1345\n}\n</code></pre>\n"}, {"tags": ["ruby", "email", "google-app-engine"], "comments": [{"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532425572, "post_id": 51494757, "comment_id": 89958987, "body": "Why you want not use some gem for that? For example <a href=\"https://github.com/mikel/mail\" rel=\"nofollow noreferrer\">github.com/mikel/mail</a>"}], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 3, "last_activity_date": 1532425634, "creation_date": 1532425634, "answer_id": 51495492, "question_id": 51494757, "link": "https://stackoverflow.com/questions/51494757/sending-emails-with-gae-and-ruby/51495492#51495492", "title": "Sending emails with GAE and Ruby", "body": "<p>The documentation you saw is only for the standard environment. Sending emails natively (i.e. using the GAE infrastructure) is not supported for those languages in the flexible environment either. From the <a href=\"https://cloud.google.com/appengine/docs/flexible/python/migrating#mail\" rel=\"nofollow noreferrer\">Mail</a> section of the <a href=\"https://cloud.google.com/appengine/docs/flexible/python/migrating\" rel=\"nofollow noreferrer\">Migrating Services from the Standard Environment to the Flexible Environment</a> guide:</p>\n\n<blockquote>\n  <p>The App Engine Mail service is not available outside the standard\n  environment. You will need to use a third-party mail provider such as\n  <a href=\"https://sendgrid.com/\" rel=\"nofollow noreferrer\">SendGrid</a>, <a href=\"https://www.mailgun.com/\" rel=\"nofollow noreferrer\">Mailgun</a>, or <a href=\"https://www.mailjet.com/\" rel=\"nofollow noreferrer\">Mailjet</a> to send email. All of\n  these services offer APIs to send email from applications running\n  anywhere.</p>\n  \n  <p>The following guides show how to use these services with the flexible\n  environment:</p>\n  \n  <ul>\n  <li><a href=\"https://cloud.google.com/appengine/docs/flexible/python/sending-emails-with-sendgrid\" rel=\"nofollow noreferrer\">Sending emails with SendGrid</a></li>\n  <li><a href=\"https://cloud.google.com/appengine/docs/flexible/python/sending-emails-with-mailgun\" rel=\"nofollow noreferrer\">Sending emails with Mailgun</a></li>\n  <li><a href=\"https://cloud.google.com/appengine/docs/flexible/python/sending-emails-with-mailjet\" rel=\"nofollow noreferrer\">Sending emails with Mailjet</a></li>\n  </ul>\n</blockquote>\n\n<p>So similarly you'd have to use one of those third party services. The referenced guides include Ruby examples.</p>\n"}], "owner": {"reputation": 18772, "user_id": 278984, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/29a6c77c187f2a5d02d2b79df4b31223?s=128&d=identicon&r=PG", "display_name": "spacemonkey", "link": "https://stackoverflow.com/users/278984/spacemonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532427850, "creation_date": 1532423319, "last_edit_date": 1532427850, "question_id": 51494757, "link": "https://stackoverflow.com/questions/51494757/sending-emails-with-gae-and-ruby", "title": "Sending emails with GAE and Ruby", "body": "<p>How can I send emails from a Ruby/Rails app using GAE Mail API? I see documentation for Python/Java/Go/PHP, but nothing for Ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8501573"}, "edited": false, "score": 1, "creation_date": 1532421117, "post_id": 51493787, "comment_id": 89956342, "body": "I just did that, but then this other error appeared, /Users/macbook/.rvm/gems/ruby-2.3.4/gems/railties-5.1.4/lib/&zwnj;&#8203;rails/application/co&zwnj;&#8203;nfiguration.rb:81:in `load_defaults&#39;: Unknown version &quot;5.2&quot; (RuntimeError)"}, {"owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "edited": false, "score": 2, "creation_date": 1532427687, "post_id": 51493787, "comment_id": 89960219, "body": "I think you messed up with your <code>Gemfile</code>, because all your apps files seems to be from 5.2 version of rails while your <code>Gemfile</code> have  <code>gem &#39;rails&#39;, &#39;5.1.4&#39;</code>, you can try replacing it by <code>gem &#39;rails&#39;, &#39;~&gt; 5.2&#39;</code> and launching an <code>bundle install</code>"}], "tags": [], "owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "is_accepted": true, "score": 20, "last_activity_date": 1542015875, "last_edit_date": 1542015875, "creation_date": 1532420342, "answer_id": 51493787, "question_id": 51493625, "link": "https://stackoverflow.com/questions/51493625/new-to-rails-rails-server-error-cannot-load-such-file-bootsnap-setup-load/51493787#51493787", "title": "(New to Rails) rails server error: cannot load such file -- bootsnap/setup (LoadError)", "body": "<p>You have an issue with the gem <code>bootsnap</code> which main job is to accelerate rails startup time.</p>\n\n<p>So, you should either :</p>\n\n<ul>\n<li>In case you want <code>bootsnap</code>, add <code>gem 'bootsnap'</code> to your gemfile to install it.</li>\n<li>In case you don't want <code>bootsnap</code>, remove the line <code>require 'bootsnap/setup'</code> in <code>config/boot.rb</code></li>\n</ul>\n\n<p>More info about <code>bootsnap</code> : <a href=\"https://github.com/Shopify/bootsnap#how-does-this-work\" rel=\"noreferrer\">https://github.com/Shopify/bootsnap#how-does-this-work</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8501573"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11328, "favorite_count": 2, "accepted_answer_id": 51493787, "answer_count": 1, "score": 11, "last_activity_date": 1542015875, "creation_date": 1532419799, "last_edit_date": 1532437725, "question_id": 51493625, "link": "https://stackoverflow.com/questions/51493625/new-to-rails-rails-server-error-cannot-load-such-file-bootsnap-setup-load", "title": "(New to Rails) rails server error: cannot load such file -- bootsnap/setup (LoadError)", "body": "<p>I have installed my JS runtime as Node, and I have bundle update-ed and bundle install-ed, but I still get this error: </p>\n\n<pre><code>/Users/macbook/Documents/Studies/Coding/the_back_end/the_odin_project/odin_on_rails/hello_app/config/boot.rb:4:in `require': cannot load such file -- bootsnap/setup (LoadError)\n    from /Users/macbook/Documents/Studies/Coding/the_back_end/the_odin_project/odin_on_rails/hello_app/config/boot.rb:4:in `&lt;top (required)&gt;'\n    from /Users/macbook/Documents/Studies/Coding/the_back_end/the_odin_project/odin_on_rails/hello_app/bin/rails:8:in `require_relative'\n    from /Users/macbook/Documents/Studies/Coding/the_back_end/the_odin_project/odin_on_rails/hello_app/bin/rails:8:in `&lt;top (required)&gt;'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `load'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `call'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/bin/spring:49:in `&lt;top (required)&gt;'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `load'\n    from /Users/macbook/.rvm/gems/ruby-2.3.4/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n    from /Users/macbook/Documents/Studies/Coding/the_back_end/the_odin_project/odin_on_rails/hello_app/bin/spring:15:in `require'\n    from /Users/macbook/Documents/Studies/Coding/the_back_end/the_odin_project/odin_on_rails/hello_app/bin/spring:15:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>Here's what's in my Gemfile ,</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails',        '5.1.4'\ngem 'puma',         '3.9.1'\ngem 'sass-rails',   '5.0.6'\ngem 'uglifier',     '3.2.0'\ngem 'coffee-rails', '4.2.2'\ngem 'jquery-rails', '4.3.1'\ngem 'turbolinks',   '5.0.1'\ngem 'jbuilder',     '2.7.0'\n\n\ngroup :development, :test do\n  gem 'sqlite3', '1.3.13'\n  gem 'byebug',  '9.0.6', platform: :mri\nend\n\ngroup :development do\n  gem 'web-console',           '3.5.1'\n  gem 'listen',                '3.1.5'\n  gem 'spring',                '2.0.2'\n  gem 'spring-watcher-listen', '2.0.1'\nend\n\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>I feel a little lost on that one, and I can't find any helpful answer anywhere.</p>\n\n<p>Thanks a lot in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1532414471, "post_id": 51492025, "comment_id": 89952588, "body": "<code>render text: response.body</code> doesn&#39;t do anything about headers, so they remain &#39;default&#39; for Rails response."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 1, "creation_date": 1532414586, "post_id": 51492025, "comment_id": 89952667, "body": "You can get the head by doing: <code>Net::HTTP.head(uri)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "edited": false, "score": 0, "creation_date": 1532416823, "post_id": 51492505, "comment_id": 89953978, "body": "response.to_hash will list all headers, but how can I render the body + all headers within the response?"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "edited": false, "score": 0, "creation_date": 1532417464, "post_id": 51492505, "comment_id": 89954385, "body": "@simo add new key in response, and assign body content to it like :  <code>response[&quot;body_part&quot;] = response.body</code> then check <code>response.to_hash</code>"}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 4, "last_activity_date": 1532416406, "last_edit_date": 1532416406, "creation_date": 1532416052, "answer_id": 51492505, "question_id": 51492025, "link": "https://stackoverflow.com/questions/51492025/does-ruby-strip-headers-from-response/51492505#51492505", "title": "Does ruby strip headers from response?", "body": "<p><code>response.body</code> will return you body part not <code>header</code> part. you can convert response to hash and check header like below:</p>\n\n<pre><code>&gt; url = \"https://stackoverflow.com/questions/51492025/does-ruby-strip-headers-from-response\"\n&gt; uri = URI.parse(url)\n&gt; response = Net::HTTP.get_response(uri)\n#=&gt; #&lt;Net::HTTPOK 200 OK readbody=true&gt; \n&gt; response.to_hash\n#=&gt; {\"cache-control\"=&gt;[\"private\"], \"content-type\"=&gt;[\"text/html; charset=utf-8\"], \"last-modified\"=&gt;[\"Tue, 24 Jul 2018 07:04:00 GMT\"], \"x-frame-options\"=&gt;[\"SAMEORIGIN\"], \"x-request-guid\"=&gt;[\"22a4b6b6-3039-46e2-b4de-c8af7cad6659\"], \"strict-transport-security\"=&gt;[\"max-age=15552000\"], \"content-security-policy\"=&gt;[\"upgrade-insecure-requests\"], \"accept-ranges\"=&gt;[\"bytes\", \"bytes\"], \"age\"=&gt;[\"0\", \"0\"], \"content-length\"=&gt;[\"31575\"], \"date\"=&gt;[\"Tue, 24 Jul 2018 07:04:46 GMT\"], \"via\"=&gt;[\"1.1 varnish\"], \"connection\"=&gt;[\"keep-alive\"], \"x-served-by\"=&gt;[\"cache-bom18221-BOM\"], \"x-cache\"=&gt;[\"MISS\"], \"x-cache-hits\"=&gt;[\"0\"], \"x-timer\"=&gt;[\"S1532415886.990199,VS0,VE280\"], \"vary\"=&gt;[\"Accept-Encoding,Fastly-SSL\"], \"x-dns-prefetch-control\"=&gt;[\"off\"], \"set-cookie\"=&gt;[\"prov=a7dfe911-76a1-f1c1-093b-3fc8fe79af65; domain=.stackoverflow.com; expires=Fri, 01-Jan-2055 00:00:00 GMT; path=/; HttpOnly\"]}\n</code></pre>\n\n<p>You can access specific header as below by passing header name:</p>\n\n<pre><code>&gt; response['Cache-Control']\n#=&gt; \"private\" \n</code></pre>\n\n<p>for more details read: <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/net/http/rdoc/Net/HTTP.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.5.1/libdoc/net/http/rdoc/Net/HTTP.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "edited": false, "score": 0, "creation_date": 1532416801, "post_id": 51492530, "comment_id": 89953959, "body": "<code>response.to_hash</code> will list all headers, but how can I render the body + all headers within the response?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "edited": false, "score": 0, "creation_date": 1532416919, "post_id": 51492530, "comment_id": 89954048, "body": "<code>response.to_hash.map { |k, v| &quot;#{k}: #{v}&quot; }.join(&quot;\\n&quot;) + &quot;\\n\\n&quot; + response.body</code>"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1532416147, "creation_date": 1532416147, "answer_id": 51492530, "question_id": 51492025, "link": "https://stackoverflow.com/questions/51492025/does-ruby-strip-headers-from-response/51492530#51492530", "title": "Does ruby strip headers from response?", "body": "<p><code>Net::HTTPResponse</code> (that is your <code>response</code>) mixes in <a href=\"https://ruby-doc.org/stdlib-2.1.1/libdoc/net/http/rdoc/Net/HTTPHeader.html\" rel=\"nofollow noreferrer\"><code>Net::HTTPHeader</code></a>. Thus, you can get an individual header as <code>response['Access-Control-Allow-Origin']</code>, iterate over them with <code>response.each_header</code>, or even get them all as a hash using <code>response.to_hash</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "edited": false, "score": 0, "creation_date": 1532449824, "post_id": 51492819, "comment_id": 89975694, "body": "perfect answer!"}], "tags": [], "owner": {"reputation": 159, "user_id": 799912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59dfc1cd413e2335ca5ea37fe7dfc159?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/799912/eric"}, "is_accepted": true, "score": 2, "last_activity_date": 1532417689, "last_edit_date": 1532417689, "creation_date": 1532417172, "answer_id": 51492819, "question_id": 51492025, "link": "https://stackoverflow.com/questions/51492025/does-ruby-strip-headers-from-response/51492819#51492819", "title": "Does ruby strip headers from response?", "body": "<p>If you want to pass through headers that are being served from the host that you're fetching from, you first need to stash the response from your blog in a different variable name. Let's call it <code>blog_response</code> (this is because <code>response</code> is a preexisting special method name in a rails controller instance.).</p>\n\n<pre><code>blog_response = Net::HTTP.get_response(uri)\n</code></pre>\n\n<p>Then you need to grab the header you care about from the <code>blog_response</code> like this:</p>\n\n<pre><code>header_name, header_value = blog_response.each_header.find do |name, value| \n  name =~ /pattern-matching-a-header-name-i-care-about/i  #case insensitive regex matching recommended for http headers\nend\n</code></pre>\n\n<p>Then you need to set them in your controller before you render the response, e.g.:</p>\n\n<pre><code>response.headers[header_name] = header_value\n\nrespond_to do |format|\n  format.html { render :text =&gt; blog_response.body }\nend\n</code></pre>\n\n<p>This example is obviously only for one header, but you can copy multiple headers by just iterating through, matching and setting them in your response like so:</p>\n\n<pre><code>blog_response.each_header.select do |name, value| \n  if name =~ /pattern-matching-header-names-i-care-about|some-other-pattern-i-care-about/i  #case insensitive regex matching recommended for http headers\n    response.headers[name] = value\n  end\nend\n</code></pre>\n\n<p>If you want to pass all headers through just do this:</p>\n\n<pre><code>blog_response.each_header do |name, value| \n  response.headers[name] = value\nend\n\nrespond_to do |format|\n  format.html { render :text =&gt; blog_response.body }\nend\n</code></pre>\n"}], "owner": {"reputation": 20308, "user_id": 396681, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/nACwy.jpg?s=128&g=1", "display_name": "simo", "link": "https://stackoverflow.com/users/396681/simo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 51492819, "answer_count": 3, "score": 1, "last_activity_date": 1532417689, "creation_date": 1532414361, "question_id": 51492025, "link": "https://stackoverflow.com/questions/51492025/does-ruby-strip-headers-from-response", "title": "Does ruby strip headers from response?", "body": "<p>I am fetching html content directly from my blog as:</p>\n\n<pre><code>response = Net::HTTP.get_response(uri)\n\nrespond_to do |format|\n  format.html { render :text =&gt; response.body }\nend\n</code></pre>\n\n<p>Although at the blog engine (WordPress) I am adding header <code>Access-Control-Allow-Origin: *</code> how ever I noticed that its not passed within the response.</p>\n\n<p>However, if I use postman to get the page or view the page into browser directly, I can see that the header is there.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I can see other headers passed, ex:</p>\n\n<pre><code>cache-control: no-cache, must-revalidate, max-age=0\ncontent-type: text/html; charset=UTF-8\ndate: Tue, 24 Jul 2018 06:37:57 GMT\nexpires: Wed, 11 Jan 1984 05:00:00 GMT\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "actionmailer"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532414194, "post_id": 51491819, "comment_id": 89952445, "body": "Could you share some code?"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532415055, "post_id": 51491819, "comment_id": 89952918, "body": "Some time generating PDF need too many time. Doing that twice is not the better solution. Move generator from mailer to controller action that invokes mailer action and sending PDF to google drive."}], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 8080473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d17ba0e5c6e5205a5d950548363389?s=128&d=identicon&r=PG", "display_name": "AkshatP", "link": "https://stackoverflow.com/users/8080473/akshatp"}, "edited": false, "score": 0, "creation_date": 1532416124, "post_id": 51492046, "comment_id": 89953559, "body": "We were following the procedure, but instead of retrieving the attachment, we were getting a Mail::Part file instead of the attachment itself."}, {"owner": {"reputation": 33, "user_id": 2481279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba062b59a726dd93c0774dce3e284ad?s=128&d=identicon&r=PG", "display_name": "hacker Zhang", "link": "https://stackoverflow.com/users/2481279/hacker-zhang"}, "reply_to_user": {"reputation": 414, "user_id": 8080473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d17ba0e5c6e5205a5d950548363389?s=128&d=identicon&r=PG", "display_name": "AkshatP", "link": "https://stackoverflow.com/users/8080473/akshatp"}, "edited": false, "score": 0, "creation_date": 1532416899, "post_id": 51492046, "comment_id": 89954030, "body": "Maybe you download the file to the server"}], "tags": [], "owner": {"reputation": 33, "user_id": 2481279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba062b59a726dd93c0774dce3e284ad?s=128&d=identicon&r=PG", "display_name": "hacker Zhang", "link": "https://stackoverflow.com/users/2481279/hacker-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1532414433, "creation_date": 1532414433, "answer_id": 51492046, "question_id": 51491819, "link": "https://stackoverflow.com/questions/51491819/passing-pdf-generated-through-wickedpdf-in-actionmailer-to-functions-in-other-mo/51492046#51492046", "title": "Passing PDF Generated through WickedPDF in ActionMailer to functions in other Modules", "body": "<p>You can fetch the file path from ActionMailer objects or database and manipulate the file directly in the third step.</p>\n"}, {"tags": [], "owner": {"reputation": 414, "user_id": 8080473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d17ba0e5c6e5205a5d950548363389?s=128&d=identicon&r=PG", "display_name": "AkshatP", "link": "https://stackoverflow.com/users/8080473/akshatp"}, "is_accepted": true, "score": 0, "last_activity_date": 1532415847, "creation_date": 1532415847, "answer_id": 51492450, "question_id": 51491819, "link": "https://stackoverflow.com/questions/51491819/passing-pdf-generated-through-wickedpdf-in-actionmailer-to-functions-in-other-mo/51492450#51492450", "title": "Passing PDF Generated through WickedPDF in ActionMailer to functions in other Modules", "body": "<p>I have solved the issue and updating the answer so others could benefit.</p>\n\n<p>I was able to implement it through importing the render function from the ActionController itself.</p>\n\n<p>Now from the view object I can just do view.render and perform the same parameters. I am using Rails 4, but as some people have told me this functionality has been simplified in Rails 5.</p>\n\n<p>I used this code from here : \n<a href=\"https://stackoverflow.com/questions/28332630/rails-render-view-from-outside-controller/33349408\">Rails: Render view from outside controller</a></p>\n\n<pre><code>view = ActionView::Base.new(ActionController::Base.view_paths, {})\nview.render(file: 'template.html.erb')\n</code></pre>\n"}], "owner": {"reputation": 414, "user_id": 8080473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d17ba0e5c6e5205a5d950548363389?s=128&d=identicon&r=PG", "display_name": "AkshatP", "link": "https://stackoverflow.com/users/8080473/akshatp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 51492450, "answer_count": 2, "score": 1, "last_activity_date": 1532415847, "creation_date": 1532413572, "question_id": 51491819, "link": "https://stackoverflow.com/questions/51491819/passing-pdf-generated-through-wickedpdf-in-actionmailer-to-functions-in-other-mo", "title": "Passing PDF Generated through WickedPDF in ActionMailer to functions in other Modules", "body": "<p>I am trying to send an email to people when they do a payment through my site. I am able to generate the attachment and send it along with the emails.</p>\n\n<p>I need my application flow to be like this :</p>\n\n<p><strong>Generate attachment</strong> -> <strong>Send with email</strong> -> <strong>Send the attachment to Google Drive</strong></p>\n\n<p>The first and second steps are done. I am having some issues with the third step. For Google Drive, I have made a separate module using the Google APIs and it is working nicely.</p>\n\n<p>The issue I am having is with passing the pdf object to the Functions declared in Drive from my ActionMailer. Instead of passing the pdf, the function is sending this Object. </p>\n\n<blockquote>\n  <p>ActionMailer::Base::NullMail:0x0x0x(something)</p>\n</blockquote>\n\n<p>The Mailer by default only returns ActionMailer objects, is there any way I can override it to return the PDF which I generated in my Mailer? If there is not, what are some other ways I can do it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "strategy-pattern", "open-closed-principle"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532412261, "post_id": 51491421, "comment_id": 89951444, "body": "\u201cbut closed for modification\u201d\u2014not in ruby. One cannot prevent any piece of the code to be modified by 3rd party in ruby."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532412886, "post_id": 51491421, "comment_id": 89951774, "body": "I think you mean <code>result = case @payment_type</code> in <code>PaymentService#process</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 4, "last_activity_date": 1532412793, "last_edit_date": 1532412793, "creation_date": 1532412413, "answer_id": 51491527, "question_id": 51491421, "link": "https://stackoverflow.com/questions/51491421/how-can-i-refactor-this-ruby-code-using-the-open-closed-principle-or-strategy-pa/51491527#51491527", "title": "How can I refactor this ruby code using the Open/Closed principle or Strategy pattern", "body": "<p>In this example, instead of passing a <code>payment_type</code> you can build an object with a class that processes a payment:</p>\n\n<pre><code>class FirstPayment\n  def process\n    'process_first'\n  end\nend\n\nclass SecondPayment\n  def process\n    'process_second'\n  end\nend\n\nclass PaymentService\n  def initialize(payment, payment_strategy)\n    @payment = payment\n    @payment_strategy = payment_strategy\n  end\n\n  def process\n    result = @payment_stategy.process\n    payment.save(result)\n  end\nend\n\nPaymentService.new(payment, FirstPayment.new)\n</code></pre>\n\n<p>As a result, <code>PaymentService</code> behaviour can be extended by passing a new strategy (for example, <code>ThirdPayment</code>), but the class doesn't need to be modified, if the logic of processing the first or the second payments is changed.</p>\n"}], "owner": {"reputation": 387, "user_id": 6612534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b444eeda2224d4067e3ec6d36b3a44d6?s=128&d=identicon&r=PG&f=1", "display_name": "spirito_libero", "link": "https://stackoverflow.com/users/6612534/spirito-libero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 51491527, "answer_count": 1, "score": 1, "last_activity_date": 1532412793, "creation_date": 1532411914, "question_id": 51491421, "link": "https://stackoverflow.com/questions/51491421/how-can-i-refactor-this-ruby-code-using-the-open-closed-principle-or-strategy-pa", "title": "How can I refactor this ruby code using the Open/Closed principle or Strategy pattern", "body": "<p>How can I refactor this ruby code using the Open/Closed principle or Strategy pattern ?\nI know that the main thought is 'software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification' but how can I use this in practice? </p>\n\n<pre><code>class PaymentService\n  def initialize(payment, payment_type)\n    @payment = payment\n    @payment_type = payment_type\n  end\n\n  def process\n    result = case payment_type\n    when 'first'\n      process_first\n    when 'second'\n      process_second\n    end\n\n    payment.save(result)\n  end\n\n  def process_first\n    'process_first'\n  end\n\n  def process_second\n    'process_second'\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532411241, "post_id": 51491078, "comment_id": 89951026, "body": "Not sure your use case, this is quite the anti-pattern. But, if you must, <a href=\"http://codeconnoisseur.org/ramblings/creating-dynamic-routes-at-runtime-in-rails-4\" rel=\"nofollow noreferrer\">codeconnoisseur.org/ramblings/&hellip;</a> has some insight as to how to do this. Be warned though that unless you&#39;re storing this in some sort of persisted data store, you&#39;ll lose it every time you restart your server."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1532411942, "post_id": 51491078, "comment_id": 89951292, "body": "I would argue that your solution will not work. Imagine what happens if the server restarts or there is a new version deployed? Then all additional route that you created will be gone. Instead, store the URL and the redirect URL in a database table and have a catch-all route that calls a controller method that checks this table and does the redirect."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1532412444, "post_id": 51491078, "comment_id": 89951548, "body": "Backing on what @spickermann said, what you probably want to do is create a new record, have a route like <code>&#47;:vanity_url</code>, match that to a controller action, query said model based on <code>params[:vanity_url]</code> and then redirect."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532413192, "post_id": 51491078, "comment_id": 89951933, "body": "Could you share some more context about what you are trying to achieve? If this is only for redirects, why not create a dedicated controller for that, and just use standard routing? I&#39;ve never come across a usecase in which you require dynamic routes."}, {"owner": {"reputation": 145, "user_id": 3843071, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4336af5818b18e1047d2d23c148fd5e3?s=128&d=identicon&r=PG&f=1", "display_name": "Codosapien", "link": "https://stackoverflow.com/users/3843071/codosapien"}, "edited": false, "score": 0, "creation_date": 1532414712, "post_id": 51491078, "comment_id": 89952736, "body": "Thanks all. I was always planning to persist the vanity urls in the db, but was looking for a way to not restart the server each time a new record was added to db. I had envisioned the routes would be set at initialization from the db, but the catch-all route to controller action that does a db lookup makes more sense and then no restart is necessary either."}], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 8, "last_activity_date": 1532413932, "last_edit_date": 1532413932, "creation_date": 1532412886, "answer_id": 51491647, "question_id": 51491078, "link": "https://stackoverflow.com/questions/51491078/rails-5-x-how-can-i-add-a-route-at-runtime-without-overwriting-original-routes/51491647#51491647", "title": "Rails 5.x: How can I add a route at runtime without overwriting original routes table?", "body": "<p>In prod's env Rails load configuration once and not listen to changes. If you want to build custom routes you must <a href=\"https://apidock.com/rails/Rails/Application/reload_routes!\" rel=\"noreferrer\">reload routes</a> each time when the new route was added:</p>\n\n<pre><code>Rails.application.reload_routes!\n</code></pre>\n\n<p>Also, that does not append a new route to your route file and any server restart reset your router to default. But you can save new routes to the database and recreate them when the server starts or build your routes inside <code>routes.rb</code> from ENV variables.</p>\n\n<p>But if you want to use <code>draw</code> and need a new route just once:</p>\n\n<pre><code>Rails.application.routes.disable_clear_and_finalize = true  #add this line\nRails.application.routes.draw do\n  #new route\nend\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3843071, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4336af5818b18e1047d2d23c148fd5e3?s=128&d=identicon&r=PG&f=1", "display_name": "Codosapien", "link": "https://stackoverflow.com/users/3843071/codosapien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 993, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1532413932, "creation_date": 1532410223, "question_id": 51491078, "link": "https://stackoverflow.com/questions/51491078/rails-5-x-how-can-i-add-a-route-at-runtime-without-overwriting-original-routes", "title": "Rails 5.x: How can I add a route at runtime without overwriting original routes table?", "body": "<p>Say I have a controller action that should result in a new route being added to the routes table:</p>\n\n<pre><code>def make_route\n  vanity_url = params[:vanity_url]\n  vanity_redirect = params[:vanity_redirect]\n  return render json: { status: 400 } unless vanity_url &amp;&amp; vanity_redirect\n\n  Rails.application.routes.draw do\n    get vanity_url, to: redirect(vanity_redirect)\n  end\n  render json: { status: :ok }\nend\n</code></pre>\n\n<p>When I trigger this action, it does add the new route but completely erases the rest of the table! How do I prepend, append or otherwise map through the original routes when drawing the new table?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 2, "creation_date": 1532409595, "post_id": 51490918, "comment_id": 89950421, "body": "detailed stack trace on the questions is preferred to images"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532409971, "post_id": 51490918, "comment_id": 89950562, "body": "To build native extensions one needs the <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> compiler and/or build tools."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532413309, "post_id": 51490918, "comment_id": 89951978, "body": "What&#39;s in the mkmf.log? Did you try to build the gem directly, like what is suggested in the error message?"}, {"owner": {"reputation": 2352, "user_id": 8870132, "user_type": "registered", "profile_image": "https://graph.facebook.com/798647053545078/picture?type=large", "display_name": "Raman Mishra", "link": "https://stackoverflow.com/users/8870132/raman-mishra"}, "edited": false, "score": 0, "creation_date": 1532413642, "post_id": 51490918, "comment_id": 89952152, "body": "would you please add the stack trace that will be helpful."}, {"owner": {"reputation": 289, "user_id": 2926839, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/D5ArA.jpg?s=128&g=1", "display_name": "Hard Developer", "link": "https://stackoverflow.com/users/2926839/hard-developer"}, "edited": false, "score": 0, "creation_date": 1532442288, "post_id": 51490918, "comment_id": 89970482, "body": "Setting up the rails environment  in windows machine is tough job, If you planning for rails development, people usually suggest Linux or Mac platforms to avoid the unwanted  platforms compatibility issues in future."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 2481279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba062b59a726dd93c0774dce3e284ad?s=128&d=identicon&r=PG", "display_name": "hacker Zhang", "link": "https://stackoverflow.com/users/2481279/hacker-zhang"}, "is_accepted": false, "score": 1, "last_activity_date": 1532496807, "last_edit_date": 1532496807, "creation_date": 1532414727, "answer_id": 51492118, "question_id": 51490918, "link": "https://stackoverflow.com/questions/51490918/ruby-on-rails-gem-installation-failed/51492118#51492118", "title": "Ruby on Rails Gem Installation Failed", "body": "<p>Try to install <code>ImageMagick</code> and then <code>gem install rmagick -v '2.16.0' --source</code></p>\n\n<p>on Mac: <code>brew install imagemagick</code></p>\n\n<p>on Ubuntu</p>\n\n<pre><code>sudo apt-get update\n\nsudo apt-get install imagemagick\n</code></pre>\n\n<p>If your are on Windows, you can try <a href=\"https://docs.microsoft.com/en-us/windows/wsl/install-win10\" rel=\"nofollow noreferrer\">WSL</a></p>\n"}], "owner": {"reputation": 19, "user_id": 5741001, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001465847383/picture?type=large", "display_name": "Mohamed Salman", "link": "https://stackoverflow.com/users/5741001/mohamed-salman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532496807, "creation_date": 1532409384, "last_edit_date": 1532409882, "question_id": 51490918, "link": "https://stackoverflow.com/questions/51490918/ruby-on-rails-gem-installation-failed", "title": "Ruby on Rails Gem Installation Failed", "body": "<p><img src=\"https://i.stack.imgur.com/ru0vj.png\" alt=\"Ruby on Rails i can&#39;t install rmagick gem. please help me.\"></p>\n\n<p>the above image is the output of the installation result.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3309, "user_id": 3786332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R33iW.jpg?s=128&g=1", "display_name": "uzaif", "link": "https://stackoverflow.com/users/3786332/uzaif"}, "edited": false, "score": 1, "creation_date": 1532408577, "post_id": 51490773, "comment_id": 89950071, "body": "where did you specify path for delete"}, {"owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "reply_to_user": {"reputation": 3309, "user_id": 3786332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R33iW.jpg?s=128&g=1", "display_name": "uzaif", "link": "https://stackoverflow.com/users/3786332/uzaif"}, "edited": false, "score": 0, "creation_date": 1532455023, "post_id": 51490773, "comment_id": 89978642, "body": "Thank you for your response...I did not as it show up in rake routes - I suppose I will have to do that?"}, {"owner": {"reputation": 3309, "user_id": 3786332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R33iW.jpg?s=128&g=1", "display_name": "uzaif", "link": "https://stackoverflow.com/users/3786332/uzaif"}, "edited": false, "score": 0, "creation_date": 1532455409, "post_id": 51490773, "comment_id": 89978844, "body": "didnt get your response i mean your link to should contain routes for delete product"}], "answers": [{"tags": [], "owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "is_accepted": false, "score": 0, "last_activity_date": 1532509440, "creation_date": 1532509440, "answer_id": 51514955, "question_id": 51490773, "link": "https://stackoverflow.com/questions/51490773/rails-index-html-erb-delete-item-not-working/51514955#51514955", "title": "Rails index.html.erb delete item - not working", "body": "<p>Define your action for delete and implement deleting a product in there.</p>\n"}], "owner": {"reputation": 55, "user_id": 10108195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bda6acfa7065d1562707a6805fac4c?s=128&d=identicon&r=PG&f=1", "display_name": "Belvin", "link": "https://stackoverflow.com/users/10108195/belvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532509440, "creation_date": 1532408462, "question_id": 51490773, "link": "https://stackoverflow.com/questions/51490773/rails-index-html-erb-delete-item-not-working", "title": "Rails index.html.erb delete item - not working", "body": "<p>Trying to delete an item from index.html.erb with following code:</p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to 'Delete', method: :delete, id: product.id, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>however all it does is try to show the index again.  How can I be more specific, I.e. - if this is a product from a category, how to I reference the path to this object in the database to delete it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "deployment", "capistrano", "capistrano3"], "comments": [{"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532419917, "post_id": 51490421, "comment_id": 89955724, "body": "Why not just <code>role :app, &quot;machine1.mydomain.com&quot;, &quot;machine2.mydomain.com&quot;, &quot;machine3.mydomain.com&quot;</code>? <a href=\"https://stackoverflow.com/questions/2633758/deploying-a-rails-app-to-multiple-servers-using-capistrano-best-practices\" title=\"deploying a rails app to multiple servers using capistrano best practices\">stackoverflow.com/questions/2633758/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 2481279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba062b59a726dd93c0774dce3e284ad?s=128&d=identicon&r=PG", "display_name": "hacker Zhang", "link": "https://stackoverflow.com/users/2481279/hacker-zhang"}, "is_accepted": false, "score": 1, "last_activity_date": 1532415843, "creation_date": 1532415843, "answer_id": 51492447, "question_id": 51490421, "link": "https://stackoverflow.com/questions/51490421/how-can-i-execute-capistrano-task-in-sequence-for-multiple-server/51492447#51492447", "title": "How can i execute capistrano task in sequence for multiple server?", "body": "<p>You have multiple options here.</p>\n\n<p>Let's say you have cap config like this:</p>\n\n<pre><code>server 'server_1', user: 'deploy', roles: %w[app db web]\nserver 'server_2', user: 'deploy', roles: %w[app]\n</code></pre>\n\n<h1>Do it manually.</h1>\n\n<p>You can do this; </p>\n\n<ul>\n<li>comment out the server_2 line and run <code>cap production deploy</code></li>\n<li>restore server_2 line and comment out the server_1 line and run <code>cap production deploy</code></li>\n</ul>\n\n<p>It's silly while useful and dead simple.</p>\n\n<h1>Use different deploy env.</h1>\n\n<p>You can set up another deploy env like production2 and run <code>cap production deploy; cap production2 deploy</code></p>\n\n<h1>Use different deploy role.</h1>\n\n<p>Give your server different roles and change your tasks and config like this:</p>\n\n<pre><code>server 'server_1', user: 'deploy', roles: %w[app db web server_1]\nserver 'server_2', user: 'deploy', roles: %w[app server_2]\n\nnamespace elb do\n  task ::deregister_1 do\n    on roles(:server_1) do\n      ...\n    end\n  end\n\n\n  task ::deregister_2 do\n    on roles(:server_2) do\n      ...\n    end\n  end\nend\n\n\nbefore 'deploy:starting',   'elb:deregister_2'\nbefore 'elb:deregister_2',   'elb:deregister_1'\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9622992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56267390e8091d0b1bf7c2d73558c6c5?s=128&d=identicon&r=PG&f=1", "display_name": "mbt", "link": "https://stackoverflow.com/users/9622992/mbt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532415843, "creation_date": 1532406177, "question_id": 51490421, "link": "https://stackoverflow.com/questions/51490421/how-can-i-execute-capistrano-task-in-sequence-for-multiple-server", "title": "How can i execute capistrano task in sequence for multiple server?", "body": "<p>I have multiple servers and capistrano tasks below</p>\n\n<pre><code>before 'deploy:starting',   'elb:deregister'\nbefore 'deploy:finishing',  'elb:register'\n\nafter 'deploy:publishing', 'deploy:restart'\nafter 'deploy:failed',     'elb:deregister'\n</code></pre>\n\n<p>When i deploy now like below</p>\n\n<pre><code>  before 'deploy:starting',   'elb:deregister' -&gt; server1\n  before 'deploy:starting',   'elb:deregister' -&gt; server1\n\n  ...\n  ...\n</code></pre>\n\n<p>How to deploy in sequence like below</p>\n\n<p>Server1 </p>\n\n<pre><code>  before 'deploy:starting',   'elb:deregister'\n  before 'deploy:finishing',  'elb:register'\n\n  after 'deploy:publishing', 'deploy:restart'\n  after 'deploy:failed',     'elb:deregister'  \n</code></pre>\n\n<p>Server2 </p>\n\n<pre><code>  before 'deploy:starting',   'elb:deregister'\n  before 'deploy:finishing',  'elb:register'\n\n  after 'deploy:publishing', 'deploy:restart'\n  after 'deploy:failed',     'elb:deregister'\n</code></pre>\n"}, {"tags": ["ruby", "cucumber", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1532410069, "creation_date": 1532410069, "answer_id": 51491050, "question_id": 51489745, "link": "https://stackoverflow.com/questions/51489745/trying-to-change-ruby-cucumber-transforms-code-to-cucumber-3-0-0-replacement/51491050#51491050", "title": "Trying to change Ruby Cucumber Transforms Code to Cucumber 3.0.0 Replacement", "body": "<p>Transforms were removed from Cucumber 3 and you need to swap over to using <code>ParameterTypes</code>. How to do that is documented in the 'Upgrading to Cucumber 3' blog post at <a href=\"https://cucumber.io/blog/2017/09/21/upgrading-to-cucumber-3\" rel=\"nofollow noreferrer\">https://cucumber.io/blog/2017/09/21/upgrading-to-cucumber-3</a> . </p>\n\n<p>For your first transform above it would be something like</p>\n\n<pre><code>ParameterType(\n  name: 'GoogleMaps'\n  regexp: /google maps/,\n  transformer: -&gt; (_) { google_maps }\nend\n</code></pre>\n"}], "owner": {"reputation": 590, "user_id": 1893392, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/655d7dfc6a0bef43a175bcca278feaba?s=128&d=identicon&r=PG", "display_name": "Joseph Ishak", "link": "https://stackoverflow.com/users/1893392/joseph-ishak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532410069, "creation_date": 1532400462, "question_id": 51489745, "link": "https://stackoverflow.com/questions/51489745/trying-to-change-ruby-cucumber-transforms-code-to-cucumber-3-0-0-replacement", "title": "Trying to change Ruby Cucumber Transforms Code to Cucumber 3.0.0 Replacement", "body": "<p>I recently found this old project for setting up ruby, cucumber, and capybara on this page:  <a href=\"https://github.com/jonathanchrisp/capybara-cucumber-ruby-kickstarter\" rel=\"nofollow noreferrer\">jonathanchrisp/capybara-cucumber-ruby-kickstarter</a></p>\n\n<p>I was able to fix some runtime errors by adding the following line in support/env.rb</p>\n\n<pre><code>require 'capybara/dsl'\n</code></pre>\n\n<p>However, whenever I run \"cucumber\" to run the code, it always fails with </p>\n\n<pre><code>undefined method `open_google_maps' for \"google maps\":String (NoMethodError)\n</code></pre>\n\n<p>I think the problem is that the \"Transforms\" code in features/step_definitions/transforms.rb was deprecated in cucumber 3.0.0.  The code I am looking at is over 3 years old so I am not sure if the original author will still maintain it.  I did reach out to him.  In the meantime, I was wondering if there is a Rub/Cucumber expert who can tell me what is the proper way to change the old transform code from:</p>\n\n<pre><code>Transform(/^google maps$/) do |impersonator|\n  google_maps\nend\n\nTransform(/^the user$/) do |impersonator|\n  @current_user\nend\n\nTransform(/^a anonymous user$/) do |impersonator|\n  a_anonymous_user\nend\n</code></pre>\n\n<p>to something that works in cucumber 3.0.0 and later.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532400138, "post_id": 51489459, "comment_id": 89948052, "body": "Hey, thanks for getting back to me on this, I never knew you could pass the object in brackets like that! <code>track</code> btw, is simply the object name and is still created as a new <code>Pack</code> I tried this again, and for some reason, it says no matching routes, yet when I edit the pack in its show view, it is the same domain path and it works."}, {"owner": {"reputation": 189, "user_id": 9430067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan Hilton", "link": "https://stackoverflow.com/users/9430067/dan-hilton"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532401326, "post_id": 51489459, "comment_id": 89948268, "body": "hmm what do you get when you run <code>rake routes</code>? And do you have an edit template in your views directory for that controller?"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532401975, "post_id": 51489459, "comment_id": 89948370, "body": "I get: <code>packs#index, packs#create, packs#new, packs#edit, packs#show, packs#update, packs#update, packs#destroy</code> for the packs, the <code>track</code> I am referring to in the question is being rendered in a view called <code>tracksIndie</code> and it&#39;s path is <code>packs#tracksIndie tracksIndie GET    &#47;indie-soundtracks(.:format)</code> As for the edit template, I have one in the directory and in the controller. The item will edit fine when done through the products show page, just not when through the view I created for it."}, {"owner": {"reputation": 189, "user_id": 9430067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan Hilton", "link": "https://stackoverflow.com/users/9430067/dan-hilton"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532434565, "post_id": 51489459, "comment_id": 89964595, "body": "What do you mean when you say &quot;edit the pack in its show view&quot; in the first comment? Maybe I&#39;m misunderstanding the issue, what is the expected outcome you&#39;re looking for and what is the error you&#39;re seeing? It sounds like you have the routing and controller action &amp; template in place so it might just be wiring it up correctly."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532438933, "post_id": 51489459, "comment_id": 89967914, "body": "Oh, I have a &quot;packs&quot; directory (the MVC) and in that there is the typical edit, new, index, and show. I have a &quot;secondary index&quot; if you will for tracks, in this case, it&#39;s called <code>tracksIndie.html.erb</code> The show renders each individual pack on its own page, and I am trying to go directly to the edit view of the <code>(track)</code> from the view <code>tracksIndie.html.erb</code> instead of the MVC&#39;s show view."}, {"owner": {"reputation": 189, "user_id": 9430067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan Hilton", "link": "https://stackoverflow.com/users/9430067/dan-hilton"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532466128, "post_id": 51489459, "comment_id": 89984010, "body": "Okay, I see. Does <code>@packs[&#39;track-indie&#39;]</code> return an array of Pack? I&#39;d confirm the object is the class that you&#39;re expecting. And are you able to go to /packs/:id/edit page and see the edit form? If so then it&#39;s a matter of routing the link_to correctly, otherwise it means routing needs to be changed"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532469777, "post_id": 51489459, "comment_id": 89985357, "body": "Yes, <code>@packs[&#39;track-indie&#39;]</code> returns all items in the <code>packs</code> table that have a <code>:category_id</code> of <code>track-indie</code>. Navigating to /packs/:id/edit does work and I am able to edit the pack."}, {"owner": {"reputation": 189, "user_id": 9430067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan Hilton", "link": "https://stackoverflow.com/users/9430067/dan-hilton"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532475720, "post_id": 51489459, "comment_id": 89986951, "body": "Gotcha so it must be an issue with the data being passed into the <code>link_to &quot;edit&#39;...</code>. I&#39;d confirm the route name is correct (i.e. edit_track_path) and then confirm that the track has the id attribute loaded. When you call edit_pack_path(track) it&#39;s basically a short hand for edit_pack_path(id: track.id) so maybe it&#39;s missing the id. Try the explicit path with the id and see if it resolves your problem. If not, I&#39;d be happy to hop on a chat with you to debug this"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1532481631, "post_id": 51489459, "comment_id": 89988210, "body": "Thank you so much! The problem was, I changed it from <code>track</code> to <code>edit_pack_path(track)</code> without removing <code>method: :edit</code>. After removing it, the edit page opened and successfully changed the item."}], "tags": [], "owner": {"reputation": 189, "user_id": 9430067, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan Hilton", "link": "https://stackoverflow.com/users/9430067/dan-hilton"}, "is_accepted": true, "score": 1, "last_activity_date": 1532398078, "creation_date": 1532398078, "answer_id": 51489459, "question_id": 51488986, "link": "https://stackoverflow.com/questions/51488986/edit-a-db-item-through-object-name-in-erb-ruby-on-rails/51489459#51489459", "title": "Edit a db item through object name in ERB | Ruby on Rails", "body": "<p>I'm not 100% certain what the model relations are between Track and Pack, but it appears the issue is in your link_to.</p>\n\n<p>The second argument should reference the path you want so it'll be something like:</p>\n\n<p><code>link_to \"Edit\", edit_track_path(track)</code></p>\n\n<p>If you don't know what the route name is, do a <code>rake routes</code> on the command line and see what the corresponding name is for the route you want.</p>\n\n<p>More info here: <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html</a></p>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51489459, "answer_count": 1, "score": 0, "last_activity_date": 1532398078, "creation_date": 1532393339, "last_edit_date": 1532395835, "question_id": 51488986, "link": "https://stackoverflow.com/questions/51488986/edit-a-db-item-through-object-name-in-erb-ruby-on-rails", "title": "Edit a db item through object name in ERB | Ruby on Rails", "body": "<p>I have a page in my rails app that renders products from the database that is not the products index page. I was wondering about the following:</p>\n\n<blockquote>\n  <p>How can I edit an item through the object from a <code>do</code> statement?</p>\n</blockquote>\n\n<p><strong>Bonus:</strong> Is it possible to code the following statement to allow for <code>@pack</code> instead of through the object's <code>track</code> object?</p>\n\n<p>My view:</p>\n\n<pre><code>&lt;% @packs['track-indie']&amp;.each do |track| %&gt;\n  &lt;div class=\"wellington top-drop\"&gt;\n    &lt;div&gt;\n      &lt;h3 class=\"soundtrack-heading align-left pack-name\"&gt;&lt;%= track.title %&gt;&lt;/h3&gt;\n      &lt;button class=\"btn btn-price align-right hidden-xs btn-bump\" type=\"button\"&gt;$&lt;%= track.price %&gt;&lt;/button&gt;\n      &lt;button class=\"btn btn-success align-right btn-bump\" id=\"btn-buy\" type=\"button\"&gt;Buy!&lt;/button&gt;\n      &lt;% if current_user.present? &amp;&amp; current_user.admin? %&gt;\n      &lt;%= link_to \"Edit\", track, class: \"btn btn-warning align-right btn-bump\" %&gt;\n      &lt;%= link_to \"Delete\", track,\n                      method: :delete,\n                      data: {confirm: \"Are you sure you want to delete this pack?\"},\n                      class: \"btn btn-danger align-right\" %&gt;\n      &lt;% end %&gt;\n      &lt;div style=\"clear: both;\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;iframe width=\"100%\" height=\"110\" scrolling=\"no\" frameborder=\"no\" allow=\"autoplay\" src=\"&lt;%= track.audio_embed %&gt;\"&gt;&lt;/iframe&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I press the edit button it says that there is no product with that name. I've even tried to use <code>method: :edit</code> but that doesn't seem to work either.</p>\n\n<p>The error I get when I press the edit button when using <code>:update</code> or <code>:edit</code> is a routing error. It states: <code>No route matches [POST] \"/products/the-hunt\"</code> yet I'm able to navigate there and the delete button works fine.</p>\n"}, {"tags": ["ruby", "web-scraping", "capybara", "recaptcha"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 3787179, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8e08b2eb7f0cfaf9342e09aacf77507?s=128&d=identicon&r=PG&f=1", "display_name": "user3787179", "link": "https://stackoverflow.com/users/3787179/user3787179"}, "edited": false, "score": 0, "creation_date": 1532460169, "post_id": 51489172, "comment_id": 89981219, "body": "I didn&#39;t write the code myself and i&#39;m a very amateur programmer. When I commented out page.close so the software can just loop to `visit = @page.url the program just froze. Anyway, thanks for the help"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 143, "user_id": 3787179, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8e08b2eb7f0cfaf9342e09aacf77507?s=128&d=identicon&r=PG&f=1", "display_name": "user3787179", "link": "https://stackoverflow.com/users/3787179/user3787179"}, "edited": false, "score": 0, "creation_date": 1532460557, "post_id": 51489172, "comment_id": 89981381, "body": "@user3787179 Without seeing the code or knowing what exactly it&#39;s doing I can&#39;t really diagnose the hang - however you could always try visiting some other url (www.google.com for instance) at the end of your loop before revisiting craigslist."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1532395394, "creation_date": 1532395394, "answer_id": 51489172, "question_id": 51488543, "link": "https://stackoverflow.com/questions/51488543/capybara-are-cookies-saved-in-a-scraping-session/51489172#51489172", "title": "Capybara: are cookies saved in a scraping session?", "body": "<p>Capybara doesn't save any cookies between sessions itself. You can manually write code to save the cookies and reload them using driver specific methods, or you can look at <a href=\"https://github.com/nruth/show_me_the_cookies\" rel=\"nofollow noreferrer\">show me the cookies</a>  <a href=\"https://github.com/nruth/show_me_the_cookies\" rel=\"nofollow noreferrer\">https://github.com/nruth/show_me_the_cookies</a> for a cross browser API for getting and creating cookies. I do wonder why you're closing the browser in between each application though?  Why not just keep it open and reuse the same session?</p>\n"}], "owner": {"reputation": 143, "user_id": 3787179, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8e08b2eb7f0cfaf9342e09aacf77507?s=128&d=identicon&r=PG&f=1", "display_name": "user3787179", "link": "https://stackoverflow.com/users/3787179/user3787179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 51489172, "answer_count": 1, "score": 0, "last_activity_date": 1532395394, "creation_date": 1532389222, "question_id": 51488543, "link": "https://stackoverflow.com/questions/51488543/capybara-are-cookies-saved-in-a-scraping-session", "title": "Capybara: are cookies saved in a scraping session?", "body": "<p>I've built a program to automate posting ads on craigslist using ruby and capybara. As i recall, it would visit the craigslist URL, log me in, then post a job ad and close the browser, wait 30 minutes then repeat for a total of 3 times. What was curious was that it had to retype my login credentials ever single time.</p>\n\n<p>I'm wondering if cookies get saved after closing the browser during a scraping session, and if it is possible to save these cookies so it wouldn't have to keep logging in each time.</p>\n\n<p>The reason for this is that I modified an existing program to automate job applications on indeed.com but I keep running into the new recaptcha security feature. I would solve the recaptcha image manually (about 5 times until it lets me through), then it would apply to the job and then close the browser. It would open again to apply to the next job and let me pass without a recaptcha test, then the job after that it would pop up again and ask me for around 5-10 recaptcha tests.</p>\n\n<p>So my theory is that saving cookies would at least help in reducing the frequency of these recaptcha tests. Is it possible to do that? am I wrong?</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["ruby", "design-patterns"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1532383725, "post_id": 51487744, "comment_id": 89944645, "body": "Write automated tests for all your code, and then refactor your code when you learn how to improve its design. Your question assumes the code&#39;s design will be set in stone; this is wrong. Read books like /Refactoring to Patterns/ by Josh Kerievsky to get the hang of designing like this."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1532390495, "post_id": 51487744, "comment_id": 89946215, "body": "Note that Ruby supports (mixin) inheritance for modules, so your assumption that you need classes for inheritance is flawed."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "edited": false, "score": 0, "creation_date": 1532418393, "post_id": 51488070, "comment_id": 89954954, "body": "thanks for your reply. In the example of modules you introduced, the &quot;code to convert a link ...&quot; has some common lines like creating the object to be returned and the way that object is being filled. Is it DRY to repeat it ?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "edited": false, "score": 1, "creation_date": 1532459026, "post_id": 51488070, "comment_id": 89980705, "body": "@hassanalmorsy Sharing code between modules gets a bit awkward, so look back at the assumptions. <code>link_to_object</code> takes a url and produces an object. Could this be done instead as a class method on each applicable class? <code>obj = SomeClass.from_link(link)</code> If there&#39;s logic to determine which class to instantiate, is this a factory? <code>obj = LinkFactory.new(link)</code> If you find you really, really just need to inherit behavior, make <code>DoThatThing</code> a module with the common methods and have implementations include it. Or make it a class and inherit, there&#39;s nothing which says classes <i>must</i> hold state."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "edited": false, "score": 1, "creation_date": 1532459309, "post_id": 51488070, "comment_id": 89980858, "body": "@hassanalmorsy For cross-cutting concerns, look into <a href=\"https://www.toptal.com/ruby-on-rails/rails-service-objects-tutorial\" rel=\"nofollow noreferrer\">service objects</a>. These are great for code which uses a bunch of classes together, or which encodes business logic which isn&#39;t fundamental to the objects. For example, if you wanted to add users to lists <code>List#add_user</code> would be very simple but the business logic can make it complex. Instead of making <code>List#add_user</code> complex and less flexible, write <code>ListManager#add_user</code> which contains the business logic and calls <code>List#add_user</code>."}, {"owner": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "edited": false, "score": 0, "creation_date": 1532499147, "post_id": 51488070, "comment_id": 89992270, "body": "Thanks, I got you"}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 0, "last_activity_date": 1532385405, "creation_date": 1532385405, "answer_id": 51488070, "question_id": 51487744, "link": "https://stackoverflow.com/questions/51487744/using-design-pattern-with-modules/51488070#51488070", "title": "Using design pattern with modules", "body": "<blockquote>\n  <p><em>In Ruby, we use modules instead of classes when we don't need a state; if it's just a function that takes an input an produces an output.</em></p>\n</blockquote>\n\n<p>That's <em>one</em> use of modules. Another use of modules is to provide what other languages would call \"traits\", sets of functionality which can be plugged into any class without inheritance. This can and often does include storing state.</p>\n\n<p>Be sure to remain flexible, Ruby is a very flexible language.</p>\n\n<hr>\n\n<blockquote>\n  <p><em>It don't need a state so a module seems to be suitable for me instead of a class. I also need to use the template design pattern as I am using different algorithms to produce data with the same structure.</em></p>\n</blockquote>\n\n<p>Design patterns provide a <em>pattern</em> for solving certain general problems, not a set of rules which must be strictly adhered to. Many were written with C++ or Java in mind, extremely class-centric languages, and require some adapting to other languages.</p>\n\n<p>In your case, all that matters is the interface remains the same. Rather than creating a whole abstract class, all you need to do is define an interface. Some languages have formal interfaces, like Rust or Java. Ruby does not. Instead it uses <a href=\"https://en.wikipedia.org/wiki/Duck_typing\" rel=\"nofollow noreferrer\">duck-typing</a>. Basically if it has the methods you need and says it works like you need, use it.</p>\n\n<pre><code>module DoThatThing\n  module ThisProvider\n    def link_to_object(link)\n      ...code to convert a link to ThisProvider into an object...\n\n      return object\n    end\n  end\n\n  module ThatProvider\n    def link_to_object(link)\n      ...code to convert a link to ThatProvider into an object...\n\n      return object\n    end\n  end\nend\n</code></pre>\n\n<p>Now it doesn't matter if you have <code>DoThatThing::ThisProvider</code> or <code>DoThatThing::ThatProvider</code>, you use them the same.</p>\n\n<pre><code>obj = provider_module.link_to_object(link)\n</code></pre>\n\n<p>You can, if you really want to, <a href=\"https://www.metabates.com/2011/02/07/building-interfaces-and-abstract-classes-in-ruby/\" rel=\"nofollow noreferrer\">implement formal abstract modules in Ruby</a>, but <em>in Ruby</em> it's generally a wasted effort and very much goes against how one does things <em>in Ruby</em> (in other languages, absolutely create an interface).</p>\n\n<p>Instead, enforce this with testing. <a href=\"https://medium.freecodecamp.org/how-to-dry-out-your-rspec-tests-using-shared-examples-d5cc5d33fd76\" rel=\"nofollow noreferrer\">RSpec shared examples</a>, or a similar feature of your testing system, are a good way to do that. You write one set of tests which should work for any implementation of <code>DoThatThing</code> and run them for all implementations of <code>DoThatThing</code>.</p>\n\n<pre><code>RSpec.shared_examples 'DoThatThing' do\n  ...shared tests for any DoThatThing...\nend\n\n\nRSpec.describe DoThatThing::ThisProvider do\n  include_examples \"DoThatThing\"\n\n  ...tests specific to ThisProvider...\nend\n\nRSpec.describe DoThatThing::ThatProvider do\n  include_examples \"DoThatThing\"\n\n  ...tests specific to ThatProvider...\nend\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 51488070, "answer_count": 1, "score": 1, "last_activity_date": 1532402012, "creation_date": 1532383148, "last_edit_date": 1532402012, "question_id": 51487744, "link": "https://stackoverflow.com/questions/51487744/using-design-pattern-with-modules", "title": "Using design pattern with modules", "body": "<p>As I understand: in Ruby, we use modules instead of classes when we don't need a state; if it's just a function that takes an input an produces an output.</p>\n\n<p>Some design patterns depend on inheritance, like the <a href=\"https://www.tutorialspoint.com/design_pattern/template_pattern.htm\" rel=\"nofollow noreferrer\">template design pattern</a>.</p>\n\n<p>I am making a crawling library that takes a link as an input and produces an object containing the data.</p>\n\n<p>It don't need a state so a module seems to be suitable for me instead of a class. I also need to use the template design pattern as I am using different algorithms to produce data with the same structure. I need to use inheritance to implement template design pattern, but I don't need a state; it just returns the data from the website.</p>\n\n<p>Is implementing a design pattern a good reason to use classes (for inheritance)? What is the best practice in such cases?</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1532388510, "creation_date": 1532388510, "answer_id": 51488455, "question_id": 51487661, "link": "https://stackoverflow.com/questions/51487661/chef-why-am-i-not-reading-in-the-attribute-value-i-just-set/51488455#51488455", "title": "Chef: Why am I not reading in the attribute value I just set?", "body": "<p>Chef uses a two-pass loading system, check out <a href=\"https://coderanger.net/two-pass/\" rel=\"nofollow noreferrer\">https://coderanger.net/two-pass/</a> for more details. But the tl;dr for this case is that the stuff inside <code>block do ... end</code> runs in the second phase, while the Ruby code for the <code>log</code> resource is evaluated in the first phase. In general you can fix this using the <code>lazy{}</code> helper, but in this case what you probably want is either a custom resource or an Ohai plugin. For \"normal\" Windows applications, this is all handled by the MSI subsystem and the <code>windows_package</code> resource, but as Telegraf doesn't offer MSI packages you are a bit out of luck. That said, there are packages available for Chocolatey (a Windows packaging system like Mac's Homebrew) so you might want to look into using that instead of writing this yourself.</p>\n"}], "owner": {"reputation": 513, "user_id": 5389365, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c78b8d1ebf8e2a0440d45def17ddf346?s=128&d=identicon&r=PG&f=1", "display_name": "Buster", "link": "https://stackoverflow.com/users/5389365/buster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51488455, "answer_count": 1, "score": 0, "last_activity_date": 1532388510, "creation_date": 1532382637, "question_id": 51487661, "link": "https://stackoverflow.com/questions/51487661/chef-why-am-i-not-reading-in-the-attribute-value-i-just-set", "title": "Chef: Why am I not reading in the attribute value I just set?", "body": "<p>I am getting my toes wet with chef at my job and have been tasked with installing making a recipe to install telegraf on our machines with custom configs. Let me also preface this with I have no ruby experience. </p>\n\n<p>Before downloading or installing telegraf I want to verify that the if telegraf exists to only do all the following work if the versions miss match. </p>\n\n<p>So I have attempted to set an attribute during the recipe runtime that other resources will check against. </p>\n\n<pre><code>ruby_block 'get telegraf version' do\n  block do\n      #tricky way to load this Chef::Mixin::ShellOut utilities\n      Chef::Resource::RubyBlock.send(:include, Chef::Mixin::ShellOut)\n      command = 'C:\\\\Program Files\\\\telegraf\\\\telegraf.exe --version'\n      command_out = shell_out(command)\n      node.default['windows']['telegraf']['installed_version'] = 'good'\n  end\n  notifies :write, 'log[log_version]', :delayed\n  action :run\n  only_if { ::File.exists?('C:\\\\Program Files\\\\telegraf\\\\telegraf.exe')}\nend\n\nlog 'log_version' do\n    message node['windows']['telegraf']['installed_version']\n    level :error\nend\n</code></pre>\n\n<p>When I look at the output though I see </p>\n\n<pre><code>     * ruby_block[get telegraf version] action run[2018-07-23T14:48:11-07:00] INFO: Processing ruby_block[get telegraf version] action run (win-telegraf::telegraf line 26)\n   [2018-07-23T14:48:11-07:00] INFO: ruby_block[get telegraf version] called\n\n       - execute the ruby block get telegraf version\n     * log[log_version] action write[2018-07-23T14:48:11-07:00] INFO: Processing log[log_version] action write (win-telegraf::telegraf line 39)\n   [2018-07-23T14:48:11-07:00] ERROR:\n</code></pre>\n\n<p>So why is it when I read <code>node['windows']['telegraf']['installed_version']</code> that the log prints nothing instead of 'good'?</p>\n"}, {"tags": ["ruby", "hex", "jekyll", "indicator", "generate"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532379610, "post_id": 51487024, "comment_id": 89943328, "body": "What does that color represent?"}, {"owner": {"reputation": 51, "user_id": 6709673, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fQilC.png?s=128&g=1", "display_name": "Andrei Deinichenko", "link": "https://stackoverflow.com/users/6709673/andrei-deinichenko"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532380558, "post_id": 51487024, "comment_id": 89943678, "body": "In theory this is abstract display of sort of karma, in real is the high of the rating (see full rating formula here <a href=\"https://indexmod.gq/indexmod\" rel=\"nofollow noreferrer\">indexmod.gq/indexmod</a>) from white 0.0 to green or red of the highest rate value. Later I want to clarify rating color with age and some other values as facebook or youtube rates correlation. In ideal way this should be any hex color from hex palette in 3D including third one as brightness."}], "owner": {"reputation": 51, "user_id": 6709673, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fQilC.png?s=128&g=1", "display_name": "Andrei Deinichenko", "link": "https://stackoverflow.com/users/6709673/andrei-deinichenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532378941, "creation_date": 1532378941, "question_id": 51487024, "link": "https://stackoverflow.com/questions/51487024/color-indicator-for-page-rating-fraction-decimal-value-at-jekyll-pages", "title": "Color indicator for page rating fraction decimal value at Jekyll pages", "body": "<p>Every articles of my site based on Jekyll are rated with some formula and have values in fraction decimals from 0.0 either 179.87 and further more. Here is sample of the including in layout  </p>\n\n<pre><code>&lt;p class=\"one\"&gt;#&lt;u&gt;&lt;a \nhref=\"https://www.google.com?q={{ page.shortname \n}}\"&gt;{{ page.shortname }}&lt;/a&gt;&lt;/u&gt; {% include \nindexmod.html %}&lt;/b&gt;&lt;br&gt;is an Indexmod of the \u201c{{ \npage.title }}\u201d&lt;br&gt; at the &lt;a href=\"index\"&gt;{{ \nsite.title }}&lt;/a&gt;&lt;br&gt;{{ site.time | \ndate_to_long_string }}&lt;/p&gt;\n</code></pre>\n\n<p>that displays on the <a href=\"https://indexmod.gq/amed-imran\" rel=\"nofollow noreferrer\">random page sample</a> an article rating some value (here 179.87) in fraction decimal value. I want to generate and include with a color indicator that getting a hex color value from any fraction decimal value and look like correspondent-color-dot (see below)</p>\n\n<p><a href=\"https://i.stack.imgur.com/5isnd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5isnd.png\" alt=\"Mockup\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "is_accepted": false, "score": 0, "last_activity_date": 1532393644, "creation_date": 1532393644, "answer_id": 51489012, "question_id": 51486989, "link": "https://stackoverflow.com/questions/51486989/log-keep-track-which-rails-partials-views-are-used-in-its-render-sequence/51489012#51489012", "title": "Log/Keep track which Rails partials &amp; views are used in its render sequence", "body": "<p>You should be able to log partials by subscribing to the appropriate active support notification. The rails guides has a list of the built in <a href=\"https://guides.rubyonrails.org/active_support_instrumentation.html#action-view\" rel=\"nofollow noreferrer\">action view instruments</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 6670519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7r9T.jpg?s=128&g=1", "display_name": "Dapeng114", "link": "https://stackoverflow.com/users/6670519/dapeng114"}, "is_accepted": false, "score": 0, "last_activity_date": 1532424444, "creation_date": 1532424444, "answer_id": 51495120, "question_id": 51486989, "link": "https://stackoverflow.com/questions/51486989/log-keep-track-which-rails-partials-views-are-used-in-its-render-sequence/51495120#51495120", "title": "Log/Keep track which Rails partials &amp; views are used in its render sequence", "body": "<p>You can use this gem: <a href=\"https://github.com/r7kamura/view_source_map\" rel=\"nofollow noreferrer\">view_source_map</a></p>\n"}], "owner": {"reputation": 474, "user_id": 3674071, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/a077084401d5bd5e42df5cc2da9cbcc5?s=128&d=identicon&r=PG", "display_name": "reid", "link": "https://stackoverflow.com/users/3674071/reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532424444, "creation_date": 1532378753, "question_id": 51486989, "link": "https://stackoverflow.com/questions/51486989/log-keep-track-which-rails-partials-views-are-used-in-its-render-sequence", "title": "Log/Keep track which Rails partials &amp; views are used in its render sequence", "body": "<p>I am looking for a way to keep track (log) which views and/or partials are used for the rendering sequence in Rails.</p>\n\n<p>My objective is to dynamically compose a stylesheet, comprised of a view's (or partial's) configured stylesheet, with uniqueness. Then once I know which partials/views are used, I can create a stylesheet unique to that request.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 2, "creation_date": 1532382224, "post_id": 51487571, "comment_id": 89944222, "body": "Or in Rails 5 <code>.where.not(message: { type: &quot;sms&quot;})</code>"}, {"owner": {"reputation": 369, "user_id": 3850150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-f_t1j9UVgAk/AAAAAAAAAAI/AAAAAAAAABs/mHsbAo9B72A/photo.jpg?sz=128", "display_name": "Bruno", "link": "https://stackoverflow.com/users/3850150/bruno"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532382426, "post_id": 51487571, "comment_id": 89944274, "body": "That looks better! My answer was merely illustrative."}], "tags": [], "owner": {"reputation": 369, "user_id": 3850150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-f_t1j9UVgAk/AAAAAAAAAAI/AAAAAAAAABs/mHsbAo9B72A/photo.jpg?sz=128", "display_name": "Bruno", "link": "https://stackoverflow.com/users/3850150/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1532382225, "last_edit_date": 1532382225, "creation_date": 1532382065, "answer_id": 51487571, "question_id": 51486915, "link": "https://stackoverflow.com/questions/51486915/rails-nested-querying-through-another-association/51487571#51487571", "title": "Rails nested querying through another association", "body": "<p>You could join your tables and set a where clause in order to filter those messages that are not sms.</p>\n\n<p>May be something like this:</p>\n\n<pre><code>Jobs.joins(leads: [{ notifications: :messages }]).where(\"type &lt;&gt; 'sms'\")\n</code></pre>\n\n<p>Check <a href=\"https://guides.rubyonrails.org/active_record_querying.html#joining-tables\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_querying.html#joining-tables</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10124668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4026b3c534cc43d55e7ba2564c2dcab9?s=128&d=identicon&r=PG&f=1", "display_name": "WVU2001", "link": "https://stackoverflow.com/users/10124668/wvu2001"}, "is_accepted": false, "score": 1, "last_activity_date": 1532385687, "creation_date": 1532385687, "answer_id": 51488106, "question_id": 51486915, "link": "https://stackoverflow.com/questions/51486915/rails-nested-querying-through-another-association/51488106#51488106", "title": "Rails nested querying through another association", "body": "<p>As Bruno and Jedi pointed out, something like this may work:</p>\n\n<pre><code>Job.joins(leads: [{ notifications: :message }]).where.not(messages: {msg_type: 'sms'})\n</code></pre>\n\n<p>Note this uses singular model name for Job (not Jobs). And associations like:</p>\n\n<pre><code>class Job &lt; ApplicationRecord\n  has_many :leads\nend\n\nclass Lead &lt; ApplicationRecord\n  belongs_to :job\n  has_many :notifications\n  has_many :messages, through: :notifications\nend\n\nclass Notification &lt; ApplicationRecord\n  belongs_to :lead\n  belongs_to :message\nend\n\nclass Message &lt; ApplicationRecord\n  has_many :notifications\n  has_many :leads, through: :notifications\nend\n</code></pre>\n\n<p>Not clear from your question whether you have all those associations set properly.</p>\n"}], "owner": {"reputation": 1169, "user_id": 2628355, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100004033970083/picture?type=large", "display_name": "Babistalikesflyingonrails", "link": "https://stackoverflow.com/users/2628355/babistalikesflyingonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51487571, "answer_count": 2, "score": 0, "last_activity_date": 1532385687, "creation_date": 1532378449, "last_edit_date": 1532379269, "question_id": 51486915, "link": "https://stackoverflow.com/questions/51486915/rails-nested-querying-through-another-association", "title": "Rails nested querying through another association", "body": "<p>I have the following active record models:</p>\n\n<pre><code>class Jobs\n  has_many :leads\nend\n\nclass Lead\n  has_many :messages, through :notification\nend\n\nclass Notification\n  has_many :messages\nend\n\nclass Message\n  # has a type column (varchar) containing either: email, sms\nend\n</code></pre>\n\n<p>I am unsure about how to find all jobs which through its associations have messages which are not of type sms. Is this even possible to do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "checkbox"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532378402, "post_id": 51486734, "comment_id": 89942821, "body": "This is from 4.2, but I doubt it would have changed in latest. <a href=\"https://apidock.com/rails/v4.2.7/ActionView/Helpers/FormOptionsHelper/collection_check_boxes\" rel=\"nofollow noreferrer\">apidock.com/rails/v4.2.7/ActionView/Helpers/FormOptionsHelpe&zwnj;&#8203;r/&hellip;</a>"}, {"owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 1, "creation_date": 1532383175, "post_id": 51486734, "comment_id": 89944503, "body": "can you post also your corresponding controller code and also the code where <code>merge</code> method is being called"}, {"owner": {"reputation": 159, "user_id": 799912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59dfc1cd413e2335ca5ea37fe7dfc159?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/799912/eric"}, "edited": false, "score": 0, "creation_date": 1532418961, "post_id": 51486734, "comment_id": 89955263, "body": "You said &quot;names changed&quot; for your example model setup, but as they are (if it remotely resembles your data) it&#39;s a very awkward data model. I&#39;d need more information on the actual problem being solved to give good advice, right now the data model feels inverted."}, {"owner": {"reputation": 189, "user_id": 2316010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/364734f05343abeb08d82e0e348cd88b?s=128&d=identicon&r=PG&f=1", "display_name": "ruby24", "link": "https://stackoverflow.com/users/2316010/ruby24"}, "edited": false, "score": 0, "creation_date": 1532551825, "post_id": 51486734, "comment_id": 90023473, "body": "Ok, thanks for your comments... I feel kind of embarrassed, probably there is something wrong with my code :( It&#39;s only my fourth app, all hobby projects. Basically, all I&#39;m trying to do be able to select items that are rendered in a show view, but my main problem is defining the instance variable for the form and passing it &quot;somewhere&quot;, similar to <a href=\"https://medium.com/programming-problem-solving-logbook/rails-multiple-checkboxes-e9c4c7fda356\" rel=\"nofollow noreferrer\">medium.com/programming-problem-solving-logbook/&hellip;</a>"}, {"owner": {"reputation": 189, "user_id": 2316010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/364734f05343abeb08d82e0e348cd88b?s=128&d=identicon&r=PG&f=1", "display_name": "ruby24", "link": "https://stackoverflow.com/users/2316010/ruby24"}, "edited": false, "score": 0, "creation_date": 1532552015, "post_id": 51486734, "comment_id": 90023563, "body": "Regarding the models, only the names changed slightly. &quot;Response&quot; is data I get back from an API, as well as ContactInfo. Will look into &quot;collection_check_boxes&quot;. Thanks for all the suggestions!"}], "owner": {"reputation": 189, "user_id": 2316010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/364734f05343abeb08d82e0e348cd88b?s=128&d=identicon&r=PG&f=1", "display_name": "ruby24", "link": "https://stackoverflow.com/users/2316010/ruby24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1532377473, "creation_date": 1532377473, "question_id": 51486734, "link": "https://stackoverflow.com/questions/51486734/ruby-on-rails-check-boxes-for-each-item-in-a-list", "title": "Ruby on Rails: Check_boxes for each item in a list", "body": "<p>I'm trying to render simple check_boxes in a list of results so users can select on which of these results to get additional content for.</p>\n\n<p>Example model setup (names changed):</p>\n\n<pre><code>UserRequest has_one :response\nResponse has_many :individual_results\nIndividualResult has_one :contact_info\n</code></pre>\n\n<p>In the <code>UserRequestsController</code> I have a show action, which shows the user_request (duh), response, and its individual_results in a table.</p>\n\n<p>The user should be able to select items (= contact_info) to request additional content for those. For some reason I don't manage to render the check_boxes after days of trying. Basically, I don't really understand where and how to store the array of selected <code>contact_infos</code> and how to pass it to the method that then gets the additional content.</p>\n\n<p>My attempt was:</p>\n\n<ul>\n<li>Create a <code>ContactInfosController</code> (didn't exist before, the user was only creating and showing her requests up to now, so contact_info was \"model only\" before)</li>\n<li>Create a method <code>request_content(contact_infos)</code> (as post, to pass the user-selected contact_infos to. If I were to make it Restful, it would probably be \"edit/update\") </li>\n<li>Add the form with check_boxes <code>search_request#show</code></li>\n</ul>\n\n<p>My <code>search_request/show.html.erb</code>:</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;% if @response %&gt;\n    &lt;% form_for @contact_infos, url: contact_infos_request_content_path(@contact_infos) do |form| %&gt;\n      &lt;% @response.individual_results.each do |result| %&gt;\n        # result.foo, ...\n        # result.contact_info.bar\n        &lt;%= form.check_box \"contact_info\", \"contact_info.request_content?\", \"true\", \"false %&gt;\n      &lt;% end %&gt;\n      # form.submit\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>As it didn't work, I also had to declare the instance variable <code>@contact_infos</code> in <code>RequestsController#show</code> as <code>@contact_infos = @response.individual_results.map { |r| r.contact_info }</code></p>\n\n<p>Now, it fails at the check_box with \"undefined method `merge'\". Also, not sure how the params would be passed? I feel I went seriously \"off the rails\" and probably screwed up the design with this as it seems way too complicated...</p>\n\n<p>Would anybody be so kind and help me get into the right direction, e.g., how would you pass the response to a method to request additional information? Read tons online but somehow couldn't apply it.</p>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532374790, "post_id": 51486071, "comment_id": 89941254, "body": "<code>header = [&quot;Full Name&quot;, &quot;Email&quot;, &quot;Phone Number&quot;]</code>. <code>CSV</code> expects an <code>Array</code> of columns. It will handle the commas."}, {"owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532375070, "post_id": 51486071, "comment_id": 89941399, "body": "I changed the header, but it not even written to the csv file. The main issue is why the array desired_info is not written to the csv file."}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1532376204, "post_id": 51486071, "comment_id": 89941893, "body": "See also How to write columns header to a csv file with Ruby?: <a href=\"https://stackoverflow.com/questions/15905985/how-to-write-columns-header-to-a-csv-file-with-ruby\" title=\"how to write columns header to a csv file with ruby\">stackoverflow.com/questions/15905985/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 3354384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AllgV.png?s=128&g=1", "display_name": "FaaduBaalak", "link": "https://stackoverflow.com/users/3354384/faadubaalak"}, "edited": false, "score": 1, "creation_date": 1535700380, "post_id": 51486438, "comment_id": 91171422, "body": "Since there&#39;s a tag of ROR-3 on this question <code>pluck</code> won&#39;t work. Use <code>select</code> instead :)"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1535714774, "last_edit_date": 1535714774, "creation_date": 1532376186, "answer_id": 51486438, "question_id": 51486071, "link": "https://stackoverflow.com/questions/51486071/issue-writing-data-to-csv-file-in-ruby/51486438#51486438", "title": "Issue writing data to csv file in ruby", "body": "<p>While I cannot replicate your issues please try this instead: </p>\n\n<pre><code>headers = [\"Full Name\", \"Email\", \"Phone Number\"]\nCSV.open(\"myfile.csv\", \"wb\", write_headers: true, headers: headers ) do |csv|\n  User.where(id: inactive_users_id)\n      .pluck(:full_name, :email, :phone_number)\n      .each do |row|\n        csv &lt;&lt; row\n      end\nend\n</code></pre>\n\n<p>Here we are collecting all the <code>User</code>s in 1 query (rather than your current 3 per <code>User</code>) and just the needed columns are converted to an <code>Array</code> (using <code>#pluck</code>). Then we just push each one into the <code>csv</code> as a row</p>\n\n<p>As pointed out in the comments in rails 3 <code>pluck</code> will not work with multiple columns (or at all depending on version) instead one should use <code>select</code> and then reference the attrubutes inside the loop to to create the row</p>\n"}], "owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535714774, "creation_date": 1532374484, "question_id": 51486071, "link": "https://stackoverflow.com/questions/51486071/issue-writing-data-to-csv-file-in-ruby", "title": "Issue writing data to csv file in ruby", "body": "<p>I have an issue writing to a CSV file in ruby and can't figure out.</p>\n\n<pre><code>&gt; header = \"Full Name, Email, Phone Number\" csv_file =\n&gt; CSV.open(\"myfile.csv\", \"wb\") do |csv|\n&gt;     csv &lt;&lt; header\n&gt;     inactive_users_id.each do |inactive_id|  #inactive_users_id is just an array on integers, which represent user id\n&gt;         full_name = User.find(inactive_id).full_name\n&gt;         email = User.find(inactive_id).email\n&gt;         phone_num = User.find(inactive_id).phone_number\n&gt;         desired_info = Array.new\n&gt;         desired_info.push(full_name)\n&gt;         desired_info.push(email)\n&gt;         desired_info.push(phone_num)\n&gt;         csv &lt;&lt; desired_info\n&gt;       end \n&gt;    end\n</code></pre>\n\n<p>I do get following errors:</p>\n\n<ol>\n<li>undefined method `map' for \"Full Name, Email, Phone\nNumber\":String </li>\n<li>if I remove line csv &lt;&lt; header my csv file is\n    literally like this: [138] --> which represents the id and other\n    things are not there.</li>\n</ol>\n\n<p>What could be the issue?\nThank you!</p>\n"}, {"tags": ["ruby", "rest", "this"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1532372298, "creation_date": 1532372298, "answer_id": 51485540, "question_id": 51485486, "link": "https://stackoverflow.com/questions/51485486/undefined-method-for-nilnilclass/51485540#51485540", "title": "&quot;undefined method `+&#39; for nil:NilClass&quot;", "body": "<p><code>gLayer3</code> has no value. Or better, its value is <code>nil</code>. Because you called it <code>glayer3</code>. So, you're practically doing <code>nil + something_else</code>. And that is <code>nil.+(something_else)</code>. And there is no <code>+</code> method for <code>nil</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 7970641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046dbc862254f6b872b030db74723faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gurpreet Singh", "link": "https://stackoverflow.com/users/7970641/gurpreet-singh"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532375709, "post_id": 51485780, "comment_id": 89941689, "body": "My bad gLayer6 was not defined."}], "tags": [], "owner": {"reputation": 161, "user_id": 7970641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046dbc862254f6b872b030db74723faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gurpreet Singh", "link": "https://stackoverflow.com/users/7970641/gurpreet-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1532375674, "last_edit_date": 1532375674, "creation_date": 1532373448, "answer_id": 51485780, "question_id": 51485486, "link": "https://stackoverflow.com/questions/51485486/undefined-method-for-nilnilclass/51485780#51485780", "title": "&quot;undefined method `+&#39; for nil:NilClass&quot;", "body": "<p>In xlayer == 5 block gLayer6 is not defined and returning nil. Just in the beginning of your program set gLayer6 = 0.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "is_accepted": false, "score": 1, "last_activity_date": 1532467944, "last_edit_date": 1532467944, "creation_date": 1532467466, "answer_id": 51507743, "question_id": 51485486, "link": "https://stackoverflow.com/questions/51485486/undefined-method-for-nilnilclass/51507743#51507743", "title": "&quot;undefined method `+&#39; for nil:NilClass&quot;", "body": "<p>Remember that <code>everything on Ruby are objects</code>. So when you call <code>a + b</code> is the same of <code>a.+ b</code>. So <code>+</code> is a method from \"a\". </p>\n\n<p>So, if you are receiving \u201cundefined method <code>+</code> for nil:NilClass\u201d is because some variable on left of operator/method is nil. </p>\n\n<p>To check exacly where it is happening check the line where it is happening on logs. Hope I could help you to understand your error and make things easy on next time.</p>\n"}], "owner": {"reputation": 5, "user_id": 9617185, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bXdHHB2zV8w/AAAAAAAAAAI/AAAAAAAAAYM/H3nCGI6mLEM/photo.jpg?sz=128", "display_name": "snalrus", "link": "https://stackoverflow.com/users/9617185/snalrus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1532467944, "creation_date": 1532372012, "last_edit_date": 1532402572, "question_id": 51485486, "link": "https://stackoverflow.com/questions/51485486/undefined-method-for-nilnilclass", "title": "&quot;undefined method `+&#39; for nil:NilClass&quot;", "body": "<pre><code># .              gLayer1. gLayer2  gLayer3  gLayer4. gLayer5. gLayer6. gLayer7. gLayer8. gLayer9\ngameBoard = %w[oooooooo xooooooo oxoooooo ooxooooo oooxoooo ooooxooo oooooxoo ooooooxo ooooooox]\n\nputs 'hello, welcome to eve sim'\nsleep 1\nputs 'this is a game, where the player has to avoid stuff, and collect candy.'\nsleep 2\nputs 'please use wasd to move around'\nputs ' '\n\nputs gameBoard[1]\nputs gameBoard[0]\nputs gameBoard[0]\nputs gameBoard[0]\nputs gameBoard[0]\n\ngLayer1 = 1\ngLayer2 = 0\nglayer3 = 0\ngLayer4 = 0\ngLayer5 = 0\n\nx_layer = 1\nx_pos = 1\n\nloop do\n  move_command = gets.chomp\n\n  if move_command == 'd'\n\n    # \\/.    \\/.    \\/.    \\/.    \\/.    \\/.    \\/.\n    # this is the code to move the player right\n    if x_layer == 1\n      gLayer1 += 1\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_pos += 1\n\n    elsif x_layer == 2\n      gLayer2 += 1\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_pos += 1\n\n    elsif x_layer == 3\n      glayer3 += 1\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_pos += 1\n\n    elsif x_layer == 4\n      gLayer4 += 1\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_pos += 1\n\n    elsif x_layer == 5\n      gLayer5 += 1\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_pos += 1\n\n    end\n\n    if x_pos == 9\n      puts 'you have died, sorry'\n      sleep 2\n      exit!\n    end\n\n  elsif move_command == 's'\n\n    if x_layer == 1\n      gLayer1 -= gLayer1\n      gLayer2 += x_pos\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_layer += 1\n\n    elsif x_layer == 2\n      gLayer2 -= gLayer2\n      gLayer3 += x_pos\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_layer += 1\n\n    elsif x_layer == 3\n      gLayer3 -= gLayer3\n      gLayer4 += x_pos\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_layer += 1\n\n    elsif x_layer == 4\n      gLayer4 -= gLayer4\n      gLayer5 += x_pos\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_layer += 1\n\n    elsif x_layer == 5\n      gLayer5 -= gLayer5\n      gLayer6 += x_pos\n\n      puts gameBoard[gLayer1]\n      puts gameBoard[gLayer2]\n      puts gameBoard[glayer3]\n      puts gameBoard[gLayer4]\n      puts gameBoard[gLayer5]\n\n      x_layer += 1\n\n      puts 'you are dead, sorry.'\n      sleep 1\n      exit!\n    end\n\n  elsif move_command == 'a'\n\n  elsif move_command == 'w'\n\n    x_layer += 1\n\n  end\nend\n</code></pre>\n\n<p>The part that comes first is fine. its just the s controller. When I go down to layer 3, it gives me that error.</p>\n\n<p>I'm pretty sure is has to do with adding two negatives together, but I still don't know how that would trigger an error. I have no clue what's wrong with this code.</p>\n\n<p>Please don't add anything; just explain it and fix the part that needs fixing.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 6000823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7686b78edd7b327f5c0ed7bb9636d59c?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor Thomas", "link": "https://stackoverflow.com/users/6000823/trevor-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1532372574, "creation_date": 1532372574, "answer_id": 51485594, "question_id": 51485417, "link": "https://stackoverflow.com/questions/51485417/how-to-add-uniqueness-validation-for-one-model-depending-on-another-model/51485594#51485594", "title": "How to add uniqueness validation for one model depending on another model?", "body": "<p>I had a similar problem a while back. There are two solutions depending on how you have it setup. </p>\n\n<ol>\n<li>In your <code>user.rb</code> you can add a custom method like so (assuming User has an array called <code>house_names</code>: </li>\n</ol>\n\n<p><code>validate :house_name_is_unique</code></p>\n\n<pre><code>def house_name_is_unique\n        unless (house_names.length == houses.uniq.length)\n            errors.add(:house_names, :blank, message: \"name taken\")\n        end\nend\n</code></pre>\n\n<p>The above code will check the array of house names, and the <code>uniq</code> method filters out duplicates so if they are the same length, there were no duplicates so do nothing, otherwise complain. </p>\n\n<ol start=\"2\">\n<li>Use <code>scope</code> (untested) You can add the following to your <code>house.rb</code> class</li>\n</ol>\n\n<p><code>validates :name, uniqueness: { scope: :user_id,  message: \"no duplicate house name\" }</code></p>\n\n<p>You can read more about scope here: <a href=\"http://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_validations.html#uniqueness</a></p>\n"}, {"tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1532376836, "creation_date": 1532376836, "answer_id": 51486595, "question_id": 51485417, "link": "https://stackoverflow.com/questions/51485417/how-to-add-uniqueness-validation-for-one-model-depending-on-another-model/51486595#51486595", "title": "How to add uniqueness validation for one model depending on another model?", "body": "<p>Assuming your <code>user</code> model has <code>has_many: houses</code> association, you can try this:</p>\n\n<pre><code>validate :house_uniqueness\n\ndef house_uniqueness\n  errors.add(:base, \"House name has been taken\") if House.exists?(user: self, name: \n  self.house_name)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "is_accepted": false, "score": 0, "last_activity_date": 1532432499, "creation_date": 1532432499, "answer_id": 51497694, "question_id": 51485417, "link": "https://stackoverflow.com/questions/51485417/how-to-add-uniqueness-validation-for-one-model-depending-on-another-model/51497694#51497694", "title": "How to add uniqueness validation for one model depending on another model?", "body": "<p>Try this:</p>\n\n<pre><code>class User\n  has_many :houses\nend\n\nclass House\n  belongs_to :user\n  validates_uniqueness_of :name, scope: :user_id\nend\n</code></pre>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_uniqueness_of\" rel=\"nofollow noreferrer\">API docs</a></p>\n"}], "owner": {"reputation": 53, "user_id": 10111465, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9TOWSe3ciBI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o9VIKSq1JTvJtC0ar5k31FLj9h7Q/mo/photo.jpg?sz=128", "display_name": "Anonymous2018", "link": "https://stackoverflow.com/users/10111465/anonymous2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1532432499, "creation_date": 1532371709, "question_id": 51485417, "link": "https://stackoverflow.com/questions/51485417/how-to-add-uniqueness-validation-for-one-model-depending-on-another-model", "title": "How to add uniqueness validation for one model depending on another model?", "body": "<p>I want to validate a \"House Name\" for each \"User\" . \nif i just put<br>\n              validates :House_name , uniqueness: true\nthen it will check for all housenames. I want to validate only based on my current user. i.e, one user cannot have multiple house names in same name but other users can have the same house name .</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532369927, "post_id": 51484980, "comment_id": 89938945, "body": "Does <code>example_module.rb</code> have a <code>require</code> statement for <code>example_class</code>? e.g. something like <code>require_relative &quot;example_class&quot;</code>."}, {"owner": {"reputation": 3801, "user_id": 105589, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4f325e95feb5cc5077c8dbcdca22a373?s=128&d=identicon&r=PG", "display_name": "xrd", "link": "https://stackoverflow.com/users/105589/xrd"}, "edited": false, "score": 0, "creation_date": 1532370230, "post_id": 51484980, "comment_id": 89939085, "body": "If you add a require <code>require &#39;.&#47;example_class&#39;</code> (and remove or comment out the ellipsis) it works. But, it isn&#39;t really clear what you want to achieve; can you elaborate?"}, {"owner": {"reputation": 59, "user_id": 8910524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef2b3ba62ec6ecb93df41a04155760?s=128&d=identicon&r=PG&f=1", "display_name": "TuringCreep", "link": "https://stackoverflow.com/users/8910524/turingcreep"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532371052, "post_id": 51484980, "comment_id": 89939516, "body": "@engineersmnky That worked! Thank you. I wish i could mark it as my required answer. Thank you for the help."}, {"owner": {"reputation": 59, "user_id": 8910524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef2b3ba62ec6ecb93df41a04155760?s=128&d=identicon&r=PG&f=1", "display_name": "TuringCreep", "link": "https://stackoverflow.com/users/8910524/turingcreep"}, "reply_to_user": {"reputation": 3801, "user_id": 105589, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4f325e95feb5cc5077c8dbcdca22a373?s=128&d=identicon&r=PG", "display_name": "xrd", "link": "https://stackoverflow.com/users/105589/xrd"}, "edited": false, "score": 0, "creation_date": 1532371159, "post_id": 51484980, "comment_id": 89939564, "body": "@xrd true. Require relative worked for me better, but i guess that&#39;s just syntactic sugar. Thanks for the help."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532371570, "post_id": 51484980, "comment_id": 89939773, "body": "@TuringCreep glad it helped although <code>require_relative</code> is not just syntactic sugar for <code>require &#39;.&#47;xxx&#39;</code>. <code>require_relative</code> will use the path of the file it is called from but <code>require &#39;.&#47;xxxx&#39;</code> will use the current working directory which may or may not be the directory where the files are contained. I would always recommend the former over the latter in this case."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 8910524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef2b3ba62ec6ecb93df41a04155760?s=128&d=identicon&r=PG&f=1", "display_name": "TuringCreep", "link": "https://stackoverflow.com/users/8910524/turingcreep"}, "edited": false, "score": 0, "creation_date": 1532371102, "post_id": 51485216, "comment_id": 89939544, "body": "<code>require_relative</code> worked, but i guess i was missing the concept of class inclusion and how it&#39;s done. Thanks for the answer."}], "tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1532370858, "creation_date": 1532370858, "answer_id": 51485216, "question_id": 51484980, "link": "https://stackoverflow.com/questions/51484980/use-a-class-instance-inside-a-module/51485216#51485216", "title": "Use a class instance inside a module", "body": "<p>Add this on top of your <code>example_module.rb</code> file.</p>\n\n<p><code>require ./example_class'</code></p>\n"}], "owner": {"reputation": 59, "user_id": 8910524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef2b3ba62ec6ecb93df41a04155760?s=128&d=identicon&r=PG&f=1", "display_name": "TuringCreep", "link": "https://stackoverflow.com/users/8910524/turingcreep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532402826, "creation_date": 1532369703, "last_edit_date": 1532402826, "question_id": 51484980, "link": "https://stackoverflow.com/questions/51484980/use-a-class-instance-inside-a-module", "title": "Use a class instance inside a module", "body": "<p>I'm trying to do this:</p>\n\n<h3>example_module.rb</h3>\n\n<pre><code>module ExampleModule\n   def example_method\n     ...\n     ExampleClass.new.do_something(arg_one, arg_two)\n   end\nend\n</code></pre>\n\n<h3>example_class.rb</h3>\n\n<pre><code>class ExampleClass\n  def initialize()\n    ...\n  end\n  def do_something(arg_first, arg_second)\n    ...\n  end\nend\n#&gt;&gt; Runtime error - uninitialized constant ExampleModule::ExampleClass\n</code></pre>\n\n<p>Is it possible to use a class instance inside a module? I found examples that do the opposite; they use a module to extend a class. What am I missing? Is there an article that explains this better?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encoding", "strong-parameters"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1532368420, "post_id": 51484439, "comment_id": 89938226, "body": "I see no reason why <code>#{image_url(&quot;file.png&quot;)}</code> would not be interpolated, <b>unless</b> you&#39;ve used <i>single quotation marks</i> (<code>&#39;</code>) instead of <i>double quotation marks</i> (<code>&quot;</code>) when setting the value."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532368632, "post_id": 51484439, "comment_id": 89938342, "body": "Can we see the code in your controller action, as described in scenario 1? That&#39;s there the value is being set, and I suspect you&#39;re setting it to the wrong thing (i.e. without interpolation)."}, {"owner": {"reputation": 1728, "user_id": 3486743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e65140d4aceb4e836b467f9c6d6c54ed?s=128&d=identicon&r=PG", "display_name": "vmarquet", "link": "https://stackoverflow.com/users/3486743/vmarquet"}, "edited": false, "score": 0, "creation_date": 1532368680, "post_id": 51484439, "comment_id": 89938370, "body": "<code>this is text &lt;img src=&#39;#{image_url(&quot;file.png&quot;)}&#39;</code> is what is stored in the database in the <code>body</code> column of the <code>post</code> table if I understand correctly?"}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "reply_to_user": {"reputation": 1728, "user_id": 3486743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e65140d4aceb4e836b467f9c6d6c54ed?s=128&d=identicon&r=PG", "display_name": "vmarquet", "link": "https://stackoverflow.com/users/3486743/vmarquet"}, "edited": false, "score": 0, "creation_date": 1532369582, "post_id": 51484439, "comment_id": 89938771, "body": "@vmarquet You&#39;re right, it&#39;s actually <code>&lt;img src=&#39;\\#{image_url(\\&quot;file.png\\&quot;)}&#39; &#47;&gt;</code>. I&#39;m not sure why those slashes are there but could that be the reason? When I try to remove the slashes it gives me a &quot;undefined method &#39;image_url&#39;&quot; error."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532420671, "post_id": 51484439, "comment_id": 89956128, "body": "@JoeMorano <i>&quot;I&#39;m not sure why those slashes are there&quot;</i> -- As I wrote above, I&#39;m almost certain this is because of how you are saving the data. I&#39;ll ask again: What code is in the controller, as described in &quot;Scenario 1&quot;, where you create/update the <code>Post</code>? This is the crux of your question, and you haven&#39;t shown us the code."}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532479806, "post_id": 51484439, "comment_id": 89987802, "body": "@TomLord My apologies, I added the code for my form and the corresponding controller code. The fundamental problem really does seem to be the fact that the slashes are added when the form is submitted."}], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1532369852, "post_id": 51484939, "comment_id": 89938906, "body": "How can I run erb manually on the post.body content? Only admins have access to editing and creating posts, so security isn&#39;t an issue."}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1532369955, "post_id": 51484939, "comment_id": 89938958, "body": "Also, do you know how I could save post.body as plain text? Trying to set <code>post.body = &lt;img src=&#39;#{image_url(&quot;file.png&quot;)}&#39; &#47;&gt;</code> gives a nomethod error."}, {"owner": {"reputation": 1728, "user_id": 3486743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e65140d4aceb4e836b467f9c6d6c54ed?s=128&d=identicon&r=PG", "display_name": "vmarquet", "link": "https://stackoverflow.com/users/3486743/vmarquet"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1532371857, "post_id": 51484939, "comment_id": 89939908, "body": "@JoeMorano 1. See <a href=\"https://stackoverflow.com/questions/346380/in-ruby-can-you-perform-string-interpolation-on-data-read-from-a-file\" title=\"in ruby can you perform string interpolation on data read from a file\">stackoverflow.com/questions/346380/&hellip;</a> 2. If you mean using the <code>image_url</code>  helper outside a view, <code>ActionController::Base.helpers.image_url</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 1, "creation_date": 1532375091, "post_id": 51484939, "comment_id": 89941412, "body": "@JoeMorano as a note the general rule of thumb is &quot;NEVER TRUST USER INPUT&quot; this does not mean administrators should be exempt from this rule. How would you feel if a disgruntled admin decided to make the post body <code>User.delete_all</code> and you could have avoided this by taking a small amount of additional time to guard against this?"}], "tags": [], "owner": {"reputation": 1728, "user_id": 3486743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e65140d4aceb4e836b467f9c6d6c54ed?s=128&d=identicon&r=PG", "display_name": "vmarquet", "link": "https://stackoverflow.com/users/3486743/vmarquet"}, "is_accepted": false, "score": 1, "last_activity_date": 1532371945, "last_edit_date": 1532371945, "creation_date": 1532369541, "answer_id": 51484939, "question_id": 51484439, "link": "https://stackoverflow.com/questions/51484439/why-is-rails-code-embedded-in-text-attribute-printing-as-text/51484939#51484939", "title": "Why is rails code embedded in text attribute printing as text?", "body": "<p><strong>Scenario 1</strong></p>\n\n<p>When you do:</p>\n\n<pre><code>Post.each do |post|\n  post.body.html_safe\nend\n</code></pre>\n\n<p>ERB will <strong>not</strong> inspect the <code>post.body</code> content to interpret Ruby code. Code into the <code>#{...}</code> syntax in a string is only interpreted when you declare a string in ruby code, not when it is present in a string coming from database from example.</p>\n\n<p>Formulated another way, when ERB sees <code>post.body</code>, it only understands \"output the content of the string\", but it will <strong>not</strong> parse the string searching for ruby code inside <code>#{}</code>.</p>\n\n<p>The scenario 2 works because it has nothing to do with scenario 1. Scenario 2 isn't about ERB outputting a string. In scenario 2, the line <code>post.body = \"&lt;img src='#{image_url(\"file.png\")}' /&gt;\"</code> is interpreted by the Ruby parser, which will search for <code>#{}</code> in the string being defined, and will execute the code inside those.</p>\n\n<p><strong>Wrong solution</strong></p>\n\n<p>The first solution that comes to mind would be to parse manually the <code>post.body</code> content so it interprets Ruby code inside <code>#{}</code>, but that would be a huge security vulnerability if some untrusted people edit the posts, as they could write any Ruby code in the post and get it executed.</p>\n\n<p>In the same style, you could use ERB <code>&lt;%= ... %&gt;</code> instead of Ruby's <code>#{ ... }</code>. Example: <code>ERB.new(\"My name is &lt;%= name %&gt;\").result</code>.</p>\n\n<p><strong>Better solution</strong></p>\n\n<p>Don't save Ruby code within the <code>post.body</code>. You could save only the image filename in the <code>src</code>, and before rendering the post, apply some preprocessing to replace the filename with the full path. You will need a Ruby library to parse the post html and find all the <code>img</code> tags. One such library is Nokogiri.</p>\n"}], "owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532479723, "creation_date": 1532367570, "last_edit_date": 1532479723, "question_id": 51484439, "link": "https://stackoverflow.com/questions/51484439/why-is-rails-code-embedded-in-text-attribute-printing-as-text", "title": "Why is rails code embedded in text attribute printing as text?", "body": "<p>I have a model Post with a text attribute Body, and I want to be able to insert images into the text, using HTML tags, so an example Body value would look like this:</p>\n\n<pre><code>post.body = \"this is text &lt;img src='file.png'/&gt; that was an image\"\n</code></pre>\n\n<p>and then <code>post.body.html_safe</code> prints as text and an image. But this doesn't work on production, because the file name gets a unique hash during assets precompilation, so the only way to get the file's path is to use <code>image_url</code>. But when </p>\n\n<pre><code>post.body == \"this is text &lt;img src='#{image_url(\"file.png\")}'\"\n</code></pre>\n\n<p>the image's path is just literally \"#{image_url(\"file.png\")}\" in plain text. I'm really confused about this because when I set the <code>post.body</code> in the view, it suddenly works, even though it's set to the same value. The only difference is where the value is set.</p>\n\n<p>Here's a demonstration of what I mean:</p>\n\n<hr>\n\n<p><strong>Scenario 1</strong></p>\n\n<ol>\n<li>A post is created with a click and then edited with a form:</li>\n</ol>\n\n<p>create button:</p>\n\n<pre><code>&lt;%= link_to \"new post\", create_post_path %&gt;\n</code></pre>\n\n<p>edit view:</p>\n\n<pre><code>&lt;%= form_for(@post, url: update_post_path(@post)) do |f| %&gt;\n  &lt;%= f.text_field :title %&gt;\n  &lt;%= f.text_area :body %&gt;\n  &lt;%= f.submit \"save\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>controller:</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  def create\n    @post = Post.create\n    redirect_to edit_post_path(@post)\n  end\n\n  def edit\n    @post = Post.find(params[:id])\n  end\n\n  def update\n    @post = Post.find(params[:id])\n    @post.update_attributes(post_params)\n    @post.save\n    redirect_to root_path\n  end\n\n  private\n\n    def post_params\n      params.require(:post).permit(:title, :body)\n    end\nend\n</code></pre>\n\n<ol start=\"2\">\n<li><p>The saved blog view: </p>\n\n<p><code>&lt;% Post.each do |post| %&gt;\n  &lt;%= post.body.html_safe %&gt;\n&lt;% end %&gt;</code></p></li>\n<li><p>The picture is missing and this is the text in the source code:</p>\n\n<p><code>&lt;img src='#{image_url(\"file.png\")}' /&gt;</code></p></li>\n</ol>\n\n<p><strong>Scenario 2</strong></p>\n\n<ol>\n<li><p>Same thing as in Scenario 1</p></li>\n<li><p>The saved blog view:</p>\n\n\n  \" %>\n  \n  \n</li>\n<li><p>Picture prints normally and in the source code the img src is the full path of the file.</p></li>\n</ol>\n\n<hr>\n\n<p>What's the difference between these two scenarios??? I'm so confused. I feel like it has something to do with Rails security measures when the <code>post_params</code> are being used but I have no idea.</p>\n"}, {"tags": ["sql", "ruby", "if-statement", "conditional"], "comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532366849, "post_id": 51484229, "comment_id": 89937465, "body": "I think the problem is with <code>? ?</code>. Maybe try <code>WHERE thing is not null AND ... ? AND ...?</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8196210"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532367117, "post_id": 51484229, "comment_id": 89937590, "body": "Not having much luck, still getting the exact same syntax error.  <code>SELECT * FROM items WHERE thing IS NOT NULL &#39; AND this_data = ?&#39; AND &#39;470&#39;</code>  Part of the problem seems to be that it&#39;s putting quotes around my where clause."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532367123, "post_id": 51484229, "comment_id": 89937592, "body": "Actually (and I do not recommend this) I think it should be <code>Item.where(&quot;thing IS NOT NULL #{search_string}&quot;,*arguments)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8196210"}, "edited": false, "score": 0, "creation_date": 1532367180, "post_id": 51484229, "comment_id": 89937616, "body": "That would work, except that I absolutely have to avoid using string interpolation."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8196210"}, "is_accepted": false, "score": 0, "last_activity_date": 1532367722, "creation_date": 1532367722, "answer_id": 51484486, "question_id": 51484229, "link": "https://stackoverflow.com/questions/51484229/conditionally-compounding-an-sql-query-in-ruby/51484486#51484486", "title": "conditionally compounding an SQL query in Ruby", "body": "<p>AAAGH I figured it out.</p>\n\n<p>I need to do this:</p>\n\n<pre><code>search_string = Item.where(\"thing IS NOT NULL\")\n\nif params[\"this_data\"] != nil\n    search_string = search_string.where(\"this_data = ?\", params[\"this_data\"])\nend\nif params[\"that_data\"] != nil\n    search_string = search_string.where(\"that_data = ?\", params[\"that_data\"])\nend\n</code></pre>\n\n<p>etc...</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8196210"}, "edited": false, "score": 0, "creation_date": 1532367929, "post_id": 51484492, "comment_id": 89937980, "body": "Nice!  I think something like your second solution will work best in my case. Thank you!"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1532367972, "last_edit_date": 1532367972, "creation_date": 1532367738, "answer_id": 51484492, "question_id": 51484229, "link": "https://stackoverflow.com/questions/51484229/conditionally-compounding-an-sql-query-in-ruby/51484492#51484492", "title": "conditionally compounding an SQL query in Ruby", "body": "<p>Here are a few options </p>\n\n<pre><code>scope = Item.where(\"thing IS NOT NULL\") # rails 5 .where.not(thing: nil)\nscope = scope.where(this_data: params[\"this_data\"]) unless params[\"this_data\"].nil?\nscope = scope.where(that_data: params[\"that_data\"]) unless params[\"that_data\"].nil?\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>search_keys = [\"this_data\",\"that_data\"]\nItem.where(\"thing IS NOT NULL\").where(params.select {|k,v| search_keys.include?(k) &amp;&amp; !v.nil? }) \n</code></pre>\n\n<p>Both of these options will obtain the result you are looking for and will be concatenated with the joining \"AND\" with all the SQL parameter escaping that <code>ActiveRecord</code> provides </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8196210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 51484492, "answer_count": 2, "score": 1, "last_activity_date": 1532367972, "creation_date": 1532366626, "question_id": 51484229, "link": "https://stackoverflow.com/questions/51484229/conditionally-compounding-an-sql-query-in-ruby", "title": "conditionally compounding an SQL query in Ruby", "body": "<p>I have several of if-statements that build a query string and a set of arguments, like so:</p>\n\n<pre><code>search_string = \"\"\narguments = []\n\nif params[\"this_data\"] != nil\n    search_string &lt;&lt; \" AND this_data = ?\"\n    arguments &lt;&lt; params[\"this_data\"]\nend\nif params[\"that_data\"] != nil\n    search_string &lt;&lt; \" AND that_data = ?\"\n    arguments &lt;&lt; params[\"that_data\"]\nend\n</code></pre>\n\n<p>This goes on and on until the <code>search_string</code> is built. Now I'm trying to run the query, and am not having much success.  I am stuck on the following code, which is returning a syntax error:</p>\n\n<pre><code>Item.find_by_sql([\"SELECT * FROM items WHERE thing IS NOT NULL ? ?\", search_string, arguments])\n</code></pre>\n\n<p>I'm still plugging along at it, but so far, I'm not sure how I can compound this SQL string into something that returns a successful result.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 4944651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QdVLr51yOJo/AAAAAAAAAAI/AAAAAAAABNE/Xg2CIoB-czE/photo.jpg?sz=128", "display_name": "Sebastian Meza", "link": "https://stackoverflow.com/users/4944651/sebastian-meza"}, "is_accepted": true, "score": 0, "last_activity_date": 1532366945, "last_edit_date": 1532366945, "creation_date": 1532366231, "answer_id": 51484152, "question_id": 51483959, "link": "https://stackoverflow.com/questions/51483959/select-tag-from-hash-ruby-on-rails/51484152#51484152", "title": "select_tag from hash ruby on rails", "body": "<p>Just use <em>options_for_select</em></p>\n\n<pre><code>&lt;%= select_tag \"col\", options_for_select(hash.map { |k,v| [v,k] }, { required: true, include_blank: false}) %&gt;\n</code></pre>\n\n<p>Note that [v, k] inverted to give the correct value and display name</p>\n"}], "owner": {"reputation": 5, "user_id": 9571449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mahdi Kahia", "link": "https://stackoverflow.com/users/9571449/mahdi-kahia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 51484152, "answer_count": 1, "score": 0, "last_activity_date": 1532366945, "creation_date": 1532365380, "question_id": 51483959, "link": "https://stackoverflow.com/questions/51483959/select-tag-from-hash-ruby-on-rails", "title": "select_tag from hash ruby on rails", "body": "<p>I have a hash </p>\n\n<pre><code>{\"1\":\"value1\",\"2\":\"value 2\",\"4\":\"test\"}\n</code></pre>\n\n<p>I want to have a select_tag like this one</p>\n\n<pre><code>&lt;select&gt;\n&lt;option id=\"1\"&gt;value1&lt;/option&gt;\n&lt;option id=\"2\"&gt;value 2&lt;/option&gt;\n&lt;option id=\"4\"&gt;test/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code>select_tag \"col\", options_from_collection_for_select(col.map { |k,v| [k,v] },:required =&gt; true,:include_blank =&gt; false)\n</code></pre>\n"}, {"tags": ["ruby", "csv"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10106814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2bf380220c256cbcdc2fc28624b5265?s=128&d=identicon&r=PG&f=1", "display_name": "Sagemel", "link": "https://stackoverflow.com/users/10106814/sagemel"}, "edited": false, "score": 0, "creation_date": 1532369002, "post_id": 51484072, "comment_id": 89938503, "body": "Much appreciated!"}], "tags": [], "owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "is_accepted": true, "score": 2, "last_activity_date": 1532365843, "creation_date": 1532365843, "answer_id": 51484072, "question_id": 51483806, "link": "https://stackoverflow.com/questions/51483806/indirizzo-doesnt-recognize-street-names-named-after-states/51484072#51484072", "title": "Indirizzo doesn&#39;t recognize street names named after states", "body": "<p>If Indirizzo doesn't recognize street addresses with names like <code>Washington</code>, that is probably a bug and should be reported on <a href=\"https://github.com/daveworth/Indirizzo/issues\" rel=\"nofollow noreferrer\">Github</a>. That being said, it looks like the gem hasn't been updated since 2013 so I wouldn't hold my breath for a fix.</p>\n\n<p>In the mean time, the gem <a href=\"https://github.com/street-address-rb/street-address\" rel=\"nofollow noreferrer\"><code>StreetAddress</code></a> seems to be able to parse cases like that. The example that is in the README has the address <code>1600 Pennsylvania Ave, Washington, DC, 20500</code>. Furthermore, this gem looks more maintained; it was last updated in 2017.</p>\n"}], "owner": {"reputation": 35, "user_id": 10106814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2bf380220c256cbcdc2fc28624b5265?s=128&d=identicon&r=PG&f=1", "display_name": "Sagemel", "link": "https://stackoverflow.com/users/10106814/sagemel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 51484072, "answer_count": 1, "score": 0, "last_activity_date": 1532365843, "creation_date": 1532364829, "question_id": 51483806, "link": "https://stackoverflow.com/questions/51483806/indirizzo-doesnt-recognize-street-names-named-after-states", "title": "Indirizzo doesn&#39;t recognize street names named after states", "body": "<p>I have an array being generated from a .CSV file full of addresses, and I need to have it just pull out the street names, followed by  Rd, Road, St, etc. and \n the RubyGem Indirizzo does this perfectly except it doesn't recognize streets named after states like Missouri Road or Washington Avenue. Anyone have any idea how to get around this?</p>\n\n<pre><code>#!ruby.exe\nrequire 'Indirizzo'\nrequire 'csv'\n\nfile = \"Reports.csv\"\nbegin\n  File.open(file, 'r')\nrescue\n  print \"Failed to open #{file}\\n\"\n  exit\nend\n\ndata_file = File.new(file)\ndata = [] #initializes array for addresses from .csv\ncounter=0 #set counter up to allow for different sized files to be used without         \nissue\n\nCSV.foreach(data_file, headers: true) do |row|\n  data &lt;&lt; row.to_hash\n  counter+=1\nend #goes through .csv one line at a time\n\ndata.reject!(&amp;:empty?)\n\ni=0\nstreets = []\ncolumn = \"Street Name\"\n\nwhile (i&lt;counter)\n  address = data[i][column]\n  street_name = address.gsub(/^((\\d[a-zA-Z])|[^a-zA-Z])*/, '')\n  new_address = Indirizzo::Address.new(street_name, :expand_streets =&gt; false)\n  streetName = new_address.street\n  puts streetName\n  i+=1\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 129, "user_id": 4944651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QdVLr51yOJo/AAAAAAAAAAI/AAAAAAAABNE/Xg2CIoB-czE/photo.jpg?sz=128", "display_name": "Sebastian Meza", "link": "https://stackoverflow.com/users/4944651/sebastian-meza"}, "edited": false, "score": 0, "creation_date": 1532365116, "post_id": 51483677, "comment_id": 89936600, "body": "Have you tried with <i>skip_before_filter</i> ?"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532366643, "post_id": 51483677, "comment_id": 89937355, "body": "what does your <code>authenticate_usuario!</code> method do?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1532366724, "post_id": 51483677, "comment_id": 89937395, "body": "Do you provide a valid token for <code>DeviseTokenAuth::Concerns::SetUserByToken</code>?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 129, "user_id": 4944651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QdVLr51yOJo/AAAAAAAAAAI/AAAAAAAABNE/Xg2CIoB-czE/photo.jpg?sz=128", "display_name": "Sebastian Meza", "link": "https://stackoverflow.com/users/4944651/sebastian-meza"}, "edited": false, "score": 1, "creation_date": 1532366724, "post_id": 51483677, "comment_id": 89937396, "body": "@Sebasti&#225;nMeza <code>skip_before_filter</code> and the rest of the <code>_filter</code> methods are just aliases."}, {"owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "edited": false, "score": 0, "creation_date": 1532370221, "post_id": 51483677, "comment_id": 89939078, "body": "This error might come from <code>Pundit</code>. Comment <code>include Pundit</code> and try again"}, {"owner": {"reputation": 1, "user_id": 7216668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2ViUkcORM8/AAAAAAAAAAI/AAAAAAAAAA0/Jo1sVGmTEm8/photo.jpg?sz=128", "display_name": "gianpiero mode", "link": "https://stackoverflow.com/users/7216668/gianpiero-mode"}, "reply_to_user": {"reputation": 129, "user_id": 4944651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QdVLr51yOJo/AAAAAAAAAAI/AAAAAAAABNE/Xg2CIoB-czE/photo.jpg?sz=128", "display_name": "Sebastian Meza", "link": "https://stackoverflow.com/users/4944651/sebastian-meza"}, "edited": false, "score": 0, "creation_date": 1532370766, "post_id": 51483677, "comment_id": 89939369, "body": "@Sebasti&#225;nMeza yes, but it did not work"}, {"owner": {"reputation": 1, "user_id": 7216668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2ViUkcORM8/AAAAAAAAAAI/AAAAAAAAAA0/Jo1sVGmTEm8/photo.jpg?sz=128", "display_name": "gianpiero mode", "link": "https://stackoverflow.com/users/7216668/gianpiero-mode"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1532370793, "post_id": 51483677, "comment_id": 89939383, "body": "yes @spickermann"}, {"owner": {"reputation": 1, "user_id": 7216668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2ViUkcORM8/AAAAAAAAAAI/AAAAAAAAAA0/Jo1sVGmTEm8/photo.jpg?sz=128", "display_name": "gianpiero mode", "link": "https://stackoverflow.com/users/7216668/gianpiero-mode"}, "reply_to_user": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "edited": false, "score": 0, "creation_date": 1532370919, "post_id": 51483677, "comment_id": 89939451, "body": "@OthmaneElKesri no, it didn&#39;t work :("}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532376818, "post_id": 51483677, "comment_id": 89942199, "body": "Are you sure the error is occurring in <code>Api::V1::AuthController</code>? Your brief log output does not give us much to go on"}, {"owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 0, "creation_date": 1532384129, "post_id": 51483677, "comment_id": 89944769, "body": "comment out <code>before_action :authenticate_usuario!</code> and try again because it could be that you&#39;re getting the error from elsewhere"}], "owner": {"reputation": 1, "user_id": 7216668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X2ViUkcORM8/AAAAAAAAAAI/AAAAAAAAAA0/Jo1sVGmTEm8/photo.jpg?sz=128", "display_name": "gianpiero mode", "link": "https://stackoverflow.com/users/7216668/gianpiero-mode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532369952, "creation_date": 1532364341, "last_edit_date": 1532369952, "question_id": 51483677, "link": "https://stackoverflow.com/questions/51483677/skip-before-action-does-not-work", "title": "skip_before_action does not work", "body": "<p>I am trying to skip a before action defined in <code>ApplicationController</code> in other controller, but <code>skip_before_action</code> does not work :(</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\ninclude Pundit\ninclude ActionView::Helpers::NumberHelper\n\nprotect_from_forgery with: :null_session\n\nbefore_action :authenticate_usuario!\nbefore_action :configure_permitted_parameters, if: :devise_controller?\nbefore_action :set_paper_trail_whodunnit\nbefore_action :set_default_host_mailer\n...\n\n\nclass Api::V1::AuthController &lt; ApplicationController\n\ninclude DeviseTokenAuth::Concerns::SetUserByToken\nskip_before_action :authenticate_usuario!\n...\n</code></pre>\n\n<p>and this is the server answer</p>\n\n<pre><code>Completed 401 Unauthorized in 25ms (Views: 0.5ms | ActiveRecord: 0.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532360789, "post_id": 51482518, "comment_id": 89934244, "body": "Where do you pre-select a year? Your code doesn&#39;t show any pre-selecting."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532360826, "post_id": 51482518, "comment_id": 89934271, "body": "From the <a href=\"https://api.rubyonrails.org/v5.2.0/classes/ActionView/Helpers/DateHelper.html#method-i-date_select\" rel=\"nofollow noreferrer\">documentation</a>, it seems you can pass a <code>default</code> date to this method. <code>= form.date_select :universtity_start_date, ..., default: xxx</code>"}], "answers": [{"tags": [], "owner": {"reputation": 269, "user_id": 5677587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S2Q4c.png?s=128&g=1", "display_name": "ragurney", "link": "https://stackoverflow.com/users/5677587/ragurney"}, "is_accepted": false, "score": 0, "last_activity_date": 1532361476, "creation_date": 1532361476, "answer_id": 51482926, "question_id": 51482518, "link": "https://stackoverflow.com/questions/51482518/how-to-pre-select-a-day-and-month-in-form-date-select/51482926#51482926", "title": "How to pre-select a day and month in form.date_select?", "body": "<p>You could do something like:</p>\n\n<pre><code>form.date_select :university_start_date, default: Date.today\n</code></pre>\n\n<p>or </p>\n\n<pre><code>form.date_select :university_start_date, default: 2.days.from_now\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10028132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6ebd3c773925eba07f1a6ad2117bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/10028132/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532361476, "creation_date": 1532360096, "question_id": 51482518, "link": "https://stackoverflow.com/questions/51482518/how-to-pre-select-a-day-and-month-in-form-date-select", "title": "How to pre-select a day and month in form.date_select?", "body": "<p>I have this date select form helper:</p>\n\n<pre><code>= form.date_select :universtity_start_date, start_year: Date.current.year - 3, end_year: Date.current.year - 15\n</code></pre>\n\n<p>I pre-select a year. But I also want to pre-select a day and month. How? There's no \"start_date\" in it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "state-machine"], "answers": [{"comments": [{"owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "edited": false, "score": 0, "creation_date": 1532371016, "post_id": 51483504, "comment_id": 89939501, "body": "Thanks for your reply. Unfortunately, I don&#39;t plan to change the gen since the app already uses that for many models."}], "tags": [], "owner": {"reputation": 1410, "user_id": 1507845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9daba84d2a161462310fe5a0eb3ab53c?s=128&d=identicon&r=PG", "display_name": "XML Slayer", "link": "https://stackoverflow.com/users/1507845/xml-slayer"}, "is_accepted": false, "score": 1, "last_activity_date": 1532363660, "creation_date": 1532363660, "answer_id": 51483504, "question_id": 51482421, "link": "https://stackoverflow.com/questions/51482421/statemachine-transitions-based-on-model-attributes/51483504#51483504", "title": "StateMachine transitions based on model attributes", "body": "<p>I'm unfamiliar with that specific gem (more on that later), but I would think you could do something like:</p>\n\n<pre><code>events {\n  self.category.steps.each_cons(2) do |set|\n    event :next, set[0].to_sym =&gt; set[1].to_sym\n  end\n}\n</code></pre>\n\n<p>But with that said, the gem you referenced has not been updated in over a year. I'd recommend going with something more recent such as <a href=\"https://github.com/state-machines/state_machines-activerecord\" rel=\"nofollow noreferrer\">this</a> (if you're using ActiveRecord which is based upon the <a href=\"https://github.com/state-machines/state_machines#static--dynamic-definitions\" rel=\"nofollow noreferrer\">state-machines gem</a>). This last link takes you to a specific section on dynamic definitions, which will certainly give you what you want.</p>\n\n<p>Cheers</p>\n"}], "owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532363660, "creation_date": 1532359821, "question_id": 51482421, "link": "https://stackoverflow.com/questions/51482421/statemachine-transitions-based-on-model-attributes", "title": "StateMachine transitions based on model attributes", "body": "<p>I'm using <a href=\"https://github.com/piotrmurach/finite_machine\" rel=\"nofollow noreferrer\">finite machine</a> to handle the state of <code>Project</code>s. Each project belongs to a <code>Category</code> and each category has many <code>Step</code>s. \nNow I'd like to define in my <code>ProjectStateMachine</code> the <code>next</code> event which transits a project to the next steps according to its current state and category of belonging.</p>\n\n<p>For instance, let's assume I have the \"<code>new lab</code>\" project (in the <code>submitted</code> state) associated with the <code>equipment</code> category. The <code>equipment</code> category has <code>['submitted', 'started', 'completed']</code> steps.</p>\n\n<p>When the <code>next</code> event happens for the <code>new lab</code> project, its state becomes <code>started</code> and then when the <code>next</code> event happens again, the project goes in the <code>completed</code> state.</p>\n\n<p>Is there a way to achieve so?</p>\n"}, {"tags": ["ruby", "binary"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1532358396, "creation_date": 1532358396, "answer_id": 51481986, "question_id": 51481906, "link": "https://stackoverflow.com/questions/51481906/convert-decimal-to-binary-in-ruby/51481986#51481986", "title": "Convert decimal to binary in ruby", "body": "<p><code>decimal</code> comes from <code>stdin</code> as a string. And <code>String#to_s</code> does not accept arguments. You should do instead:</p>\n\n<pre><code>puts decimal.to_i.to_s(2)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10111543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b94c5cf20c44e60d3b2b31cca649afda?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Poirier", "link": "https://stackoverflow.com/users/10111543/dylan-poirier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 51481986, "answer_count": 1, "score": 0, "last_activity_date": 1532402921, "creation_date": 1532358116, "last_edit_date": 1532402921, "question_id": 51481906, "link": "https://stackoverflow.com/questions/51481906/convert-decimal-to-binary-in-ruby", "title": "Convert decimal to binary in ruby", "body": "<p>I am trying to convert a decimal to binary, so I came up with this:</p>\n\n<pre><code>print \"Enter decimal here: \"\ndecimal = gets.chomp\nputs decimal.to_s(2)\n#&gt;&gt; wrong number of arguments (given 1, expected 0)\n#&gt;&gt; (repl):3:in 'to_s'\n</code></pre>\n\n<p>Can someone tell me what I am doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "render"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532377821, "post_id": 51481771, "comment_id": 89942623, "body": "How do you end up at this route? e.g. What view contains the form that is submitted here and what does the controller action look like? It seems like you want the data to show on <code>new</code> and it looks like you have a <code>User</code> in the new action so in order for that data to persist you would also need the <code>@user</code> instance variable in this method. But without the additional context it is difficult to tell"}, {"owner": {"reputation": 315, "user_id": 9624015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2i18bBQgvaM/AAAAAAAAAAI/AAAAAAAATsU/X1FI8dTWdi0/photo.jpg?sz=128", "display_name": "Bonapara", "link": "https://stackoverflow.com/users/9624015/bonapara"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1532458451, "post_id": 51481771, "comment_id": 89980434, "body": "Hey @engineersmnky thanks for your answer ! My route for this devise form is devise <code>users&#47;sign_up</code> associated with <code>registrations&#47;new.html.erb</code>. I have no routes ending at <code>&#47;users</code>. This is what is weird as it is kind of creating a route out of nowhere. I edited my question with more infos ;)"}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1554053787, "post_id": 51481771, "comment_id": 97602654, "body": "facing same issue."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 9624015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2i18bBQgvaM/AAAAAAAAAAI/AAAAAAAATsU/X1FI8dTWdi0/photo.jpg?sz=128", "display_name": "Bonapara", "link": "https://stackoverflow.com/users/9624015/bonapara"}, "edited": false, "score": 0, "creation_date": 1532367389, "post_id": 51482106, "comment_id": 89937714, "body": "Thanks a lot @Igor! But with a redirect_to, will I not lose the benefit of alerts and auto-completion when the form will be rendered for the second time?"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 1, "last_activity_date": 1532358804, "creation_date": 1532358804, "answer_id": 51482106, "question_id": 51481771, "link": "https://stackoverflow.com/questions/51481771/custom-devise-method-render-new-redirect-to-users-instead-of-users-sign-up/51482106#51482106", "title": "Custom devise method : render &#39;new&#39; redirect to /users instead of /users/sign_up", "body": "<p><code>render 'new'</code> renders <code>new</code> template, but url and action stay the same.</p>\n\n<p>For example, you call <code>render 'new'</code> from <code>create</code> method:</p>\n\n<pre><code>def create\n  @model = Model.new(params[:model])\n  if @model.valid?\n    @model.save!\n    redirect_to :some_path\n  else\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>if <code>@model</code> is not valid, it renders <code>new</code> template with <code>@model</code> variable from <code>create</code> method.</p>\n\n<p>Thus, in your case, if you want the user to be redirected to <code>users/sign_up</code> you need to explicitly redirect him to this page:</p>\n\n<p>Either by <code>redirect_to 'users/sign_up'</code> or by using a path helper method.</p>\n"}], "owner": {"reputation": 315, "user_id": 9624015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2i18bBQgvaM/AAAAAAAAAAI/AAAAAAAATsU/X1FI8dTWdi0/photo.jpg?sz=128", "display_name": "Bonapara", "link": "https://stackoverflow.com/users/9624015/bonapara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1532458645, "creation_date": 1532357685, "last_edit_date": 1532458645, "question_id": 51481771, "link": "https://stackoverflow.com/questions/51481771/custom-devise-method-render-new-redirect-to-users-instead-of-users-sign-up", "title": "Custom devise method : render &#39;new&#39; redirect to /users instead of /users/sign_up", "body": "<p>I have a custom protected method in my devise <code>registration_controller.rb</code> :</p>\n\n<pre><code> before_action :check_secret_code, only: [:create]\n  # Method de condition pour cr\u00e9ation du compte\n  include ApplicationHelper\n  # need application_helper.rb or will not work.\n\n  # GET /resource/sign_up\n  def new\n    super\n  end\n\n  # POST /resource\n  def create\n    super\n  end \n\ndef check_secret_code\n   if Invitation.where(:invit_name =&gt; params[:user][\"invit_ref\"]).blank?\n      render 'new'\n   else\n      Invitation.where(:invit_name =&gt; params[:user][\"invit_ref\"]).destroy_all\n      return true\n   end\nend\n</code></pre>\n\n<p>But when the <code>render 'new'</code> is used, it's render <code>/users</code> instead of <code>/users/sign_up</code> with no persistant infos. Do you know why ?</p>\n\n<p>Here is my application_helper.rb</p>\n\n<pre><code>module ApplicationHelper\n  def resource_name\n    :user\n  end\n\n  def resource\n    @user ||= User.new\n  end\n  def devise_mapping\n    @devise_mapping ||= Devise.mappings[:user]\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1532356229, "post_id": 51481031, "comment_id": 89931161, "body": "Thanks a lot buddy! Works perfectly"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1579149217, "post_id": 51481031, "comment_id": 105670976, "body": "Don&#39;t use <code>css(&#39;some_selector&#39;).first</code>. Instead use one of the <code>at</code> variants."}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 1, "last_activity_date": 1532355937, "last_edit_date": 1532355937, "creation_date": 1532355585, "answer_id": 51481031, "question_id": 51480878, "link": "https://stackoverflow.com/questions/51480878/how-to-get-a-a-tag-using-nokogiri/51481031#51481031", "title": "How to get a &lt;a&gt; tag using Nokogiri", "body": "<pre><code>@parse_page.css(\".job\").first.at_css(\"h2 .company span\").text #=&gt; \"The Coral Project @ Mozilla\"\n@parse_page.css(\".job\").first.at_css(\"h2 a\")['href'] #=&gt; \"/jobs/the-coral-project-mozilla-infrastructure-integration-engineer\"\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51481031, "answer_count": 1, "score": -1, "last_activity_date": 1579149148, "creation_date": 1532355139, "last_edit_date": 1579149148, "question_id": 51480878, "link": "https://stackoverflow.com/questions/51480878/how-to-get-a-a-tag-using-nokogiri", "title": "How to get a &lt;a&gt; tag using Nokogiri", "body": "<p>I'm writing a simple scraper with Ruby using Nokogiri. </p>\n\n<pre><code>def processNokogiri\n\n  doc = HTTParty.get(\"https://www.remotelyawesomejobs.com/jobs\")\n  @parse_page ||= Nokogiri::HTML(doc)\n  @jobs = @parse_page.css(\".job\").first.at_css \"h2\"\n  puts '*********************'\n  puts  @jobs\n  puts '*********************'\n  flash[:error] = \"Noko\"\n\nend\n</code></pre>\n\n<p>When I print  <code>@jobs</code>, the console shows me: </p>\n\n<pre><code>&lt;h2&gt;\n&lt;a itemprop=\"title\" href=\"/jobs/the-coral-project-mozilla-infrastructure-integration-engineer\"&gt;Infrastructure &amp;amp; Integration Engineer&lt;/a&gt;\n&lt;span class=\"company\"&gt;\nat\n&lt;span itemprop=\"hiringOrganization\"&gt;The Coral Project @ Mozilla&lt;/span&gt;\n&lt;/span&gt;\n&lt;/h2&gt;\n</code></pre>\n\n<p>I want to access</p>\n\n<pre><code>href=\"/jobs/the-coral-project-mozilla-infrastructure-integration-engineer\" \n</code></pre>\n\n<p>and the name of the Company: \"The Coral Project @ Mozilla\"</p>\n\n<p>How can I filter <code>@jobs</code> entity to access this data? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1532354626, "post_id": 51480574, "comment_id": 89930008, "body": "split by <code>.</code>, take the <code>last</code>, turn it into an integer with <code>to_i</code>, increment, join the parts again.  It&#39;s not really clear what you mean by &quot;without the use of libraries&quot;. <code>Gem::Version</code> is a library, are you trying to remove that code, and just use strings?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1532354881, "post_id": 51480574, "comment_id": 89930199, "body": "I think your &quot;without the use of libraries&quot; restriction is too restrictive. You are going to need to use at least either <code>Gem::Version#to_s</code> or <code>Gem::Version#version</code> from the RubyGems library to even know what the <i>current</i> version is, before you increase it. (And of course, without the core library, you don&#39;t even get <code>String</code> or <code>Integer</code>.)"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1532354736, "creation_date": 1532354736, "answer_id": 51480755, "question_id": 51480574, "link": "https://stackoverflow.com/questions/51480574/increae-a-versions-last-part/51480755#51480755", "title": "Increae a version&#39;s last part", "body": "<p>Use <code>Gem::Version#segments</code>:</p>\n\n<pre><code>Gem::Version.new(\"2.0.31\").\n  segments.\n  dup.\n  tap { |segments| segments.push(segments.pop.succ) }.\n  join('.')\n#\u21d2\u00a0\"2.0.32\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532354977, "post_id": 51480761, "comment_id": 89930270, "body": "Your <code>bump(&quot;2.1.31&quot;, :minor)</code> is implemented natively by <code>Gem::Version#bump</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532355057, "post_id": 51480761, "comment_id": 89930324, "body": "I&#39;m not using <code>Gem::Version</code>, though. This is dealing with plain old strings. For example, you can use this for NPM package versions."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532355119, "post_id": 51480761, "comment_id": 89930360, "body": "I\u2019d better commit a suicide rather than <i>dealing with NPM</i> :)"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1532354768, "creation_date": 1532354768, "answer_id": 51480761, "question_id": 51480574, "link": "https://stackoverflow.com/questions/51480574/increae-a-versions-last-part/51480761#51480761", "title": "Increae a version&#39;s last part", "body": "<p>Here's a helper method I've used as part of <code>rake</code> tasks before, for version bumping.</p>\n\n<p>Feel free to extend it as per your needs - e.g. if you want to add a forth number; or support versions named <code>alpha-x</code> or <code>pre-x</code>; or support an option for 'bump the last digit' (regardless of how many digits there are).</p>\n\n<p>However, I'd be inclined not to support a 'bump the last digit' option, as this is quite ambiguous.</p>\n\n<pre><code>def bump(version, type)\n  major, minor, patch = version.split('.').map(&amp;:to_i)\n\n  bumped = case type\n           when :major\n             [major + 1, 0, 0]\n           when :minor\n             [major, minor + 1, 0]\n           when :patch\n             [major, minor, patch + 1]\n           else\n             raise \"Don't know how to bump for #{type}\"\n           end \n  bumped.join('.')\nend\n\n\nbump(\"2.1.31\", :patch) #=&gt; \"2.1.32\"\nbump(\"2.1.31\", :minor) #=&gt; \"2.2.0\"\nbump(\"2.1.31\", :major) #=&gt; \"3.0.0\"\n</code></pre>\n"}], "owner": {"reputation": 17680, "user_id": 386738, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VfaLu.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/386738/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51480755, "answer_count": 2, "score": -2, "last_activity_date": 1532354768, "creation_date": 1532354189, "last_edit_date": 1532354635, "question_id": 51480574, "link": "https://stackoverflow.com/questions/51480574/increae-a-versions-last-part", "title": "Increae a version&#39;s last part", "body": "<p>What is the best way to increase the last part of a version by 1 (without the use of libraries).</p>\n\n<p>Examples:</p>\n\n<p><code>Gem::Version.new(\"2.0.31\")</code> to <code>Gem::Version.new(\"2.0.32\")</code>\n<code>Gem::Version.new(\"2.0.3.0\")</code> to <code>Gem::Version.new(\"2.0.3.1\")</code></p>\n\n<p>If the output is a string, that's ok too</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "date", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 1, "last_activity_date": 1532349310, "creation_date": 1532349310, "answer_id": 51478958, "question_id": 51478673, "link": "https://stackoverflow.com/questions/51478673/prevent-user-edits-to-posts-on-certain-days-on-any-month/51478958#51478958", "title": "Prevent User Edits to Posts on Certain Days on Any Month", "body": "<pre><code>(1..7).to_a + (Date.civil(Date.curent.year, Date.curent.month, -3)..Date.civil(Date.curent.year, Date.curent.month, -1)).to_a #disabled days\n(8..Date.civil(Date.curent.year, Date.curent.month, -4)) #allowed days\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7278582, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c9bc85c54152c3e0966ebf279ee08f98?s=128&d=identicon&r=PG&f=1", "display_name": "railsRabbit", "link": "https://stackoverflow.com/users/7278582/railsrabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 51478958, "answer_count": 1, "score": 0, "last_activity_date": 1532349310, "creation_date": 1532348533, "last_edit_date": 1532349030, "question_id": 51478673, "link": "https://stackoverflow.com/questions/51478673/prevent-user-edits-to-posts-on-certain-days-on-any-month", "title": "Prevent User Edits to Posts on Certain Days on Any Month", "body": "<p>My goal in <code>ruby</code> is to not allow a <code>user</code> to <code>edit</code> on <code>posts</code> during certain days of the month throughout the year.</p>\n\n<p>The <code>first 7 days</code> of the <code>month</code> will be <code>excluded</code> as well as the <code>last 3 days</code> of any given month.</p>\n\n<p>I see that I can hard code days with each month via the docs, but haven't found if there's a more flexible way than going through each month at a time <code>excluding</code> an <code>array of dates</code> that aren't hard coded with a particular month.</p>\n\n<p>Using <code>jQuery UI date-picker</code> in <code>active admin</code> on <code>rails 5</code></p>\n\n<p>If there is an example or someone already asked on how to accomplish this please point me to it. </p>\n\n<p>Thank you for your time.</p>\n\n<p>Edit: I may have found my solution via <a href=\"https://github.com/ankane/groupdate\" rel=\"nofollow noreferrer\">GroupDate Gem</a></p>\n"}, {"tags": ["ruby", "rake", "rake-task"], "answers": [{"comments": [{"owner": {"reputation": 4386, "user_id": 922016, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3e4ded635f3ccfc9b5676b8cfbfa515?s=128&d=identicon&r=PG", "display_name": "pmichna", "link": "https://stackoverflow.com/users/922016/pmichna"}, "edited": false, "score": 0, "creation_date": 1532516263, "post_id": 51478723, "comment_id": 90002756, "body": "Sorry but it didn&#39;t work. This code (saved in initializers) does not even get executed."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4386, "user_id": 922016, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3e4ded635f3ccfc9b5676b8cfbfa515?s=128&d=identicon&r=PG", "display_name": "pmichna", "link": "https://stackoverflow.com/users/922016/pmichna"}, "edited": false, "score": 0, "creation_date": 1532516910, "post_id": 51478723, "comment_id": 90003171, "body": "Then discover what is being definitely loaded during task initialization and put the code there. I have a little clue about Rails."}, {"owner": {"reputation": 730, "user_id": 2973441, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/vmIHG.png?s=128&g=1", "display_name": "Mateus Pires", "link": "https://stackoverflow.com/users/2973441/mateus-pires"}, "edited": false, "score": 0, "creation_date": 1592864719, "post_id": 51478723, "comment_id": 110572856, "body": "You can put it in the Rakefile."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1532348956, "last_edit_date": 1532348956, "creation_date": 1532348651, "answer_id": 51478723, "question_id": 51478505, "link": "https://stackoverflow.com/questions/51478505/how-to-add-exception-handling-to-an-existing-rake-task/51478723#51478723", "title": "How to add exception handling to an existing Rake task?", "body": "<p>This would be an overkill, but it should work:</p>\n\n<pre><code>Rake::Task.prepend(Module.new do\n  def invoke(*args)\n    case name\n    when \"original_namespace:original_task\"\n      begin\n        super(*args)\n      rescue =&gt; e\n        Logger.warn(\"Task failed, rescued\")\n      end\n    else super(*args)\n    end\n  end\nend)\n</code></pre>\n\n<p>Once added somewhere in the initializer, it should make it rescuing the respective exception automagically.</p>\n"}], "owner": {"reputation": 4386, "user_id": 922016, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3e4ded635f3ccfc9b5676b8cfbfa515?s=128&d=identicon&r=PG", "display_name": "pmichna", "link": "https://stackoverflow.com/users/922016/pmichna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532348956, "creation_date": 1532347924, "question_id": 51478505, "link": "https://stackoverflow.com/questions/51478505/how-to-add-exception-handling-to-an-existing-rake-task", "title": "How to add exception handling to an existing Rake task?", "body": "<p>I want to rescue an exception thrown by a rake task provided by an external gem.</p>\n\n<p>Ideally, I would like to create a rake task with the same name that invokes the original one and just handles the exception. Something like:</p>\n\n<pre><code>original_task = Rake.application.tasks.find { |t| t.name == \"original_namespace:original_task\" }\nRake::Task[\"original_namespace:original_task\"].clear\n\nnamespace :original_namespace do\n  task original_task: :environment do\n    begin\n      original_task.invoke\n    rescue SystemExit\n      # do something\n    end\n  end\nend\n</code></pre>\n\n<p>This doesn't work because it seems that you can't just copy a rake task and hold it in memory.</p>\n"}, {"tags": ["ruby", "facebook", "api", "httpresponse", "facebook-messenger"], "comments": [{"owner": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 0, "creation_date": 1532352544, "post_id": 51476369, "comment_id": 89928466, "body": "If it takes you 14 seconds to figure out what to respond with in the first place, then you can not send an \u201cOK\u201d response any earlier; that would only make sense if you can respond to the user\u2019s message quicker, but have additional operations to perform on the received data that take longer (but can be performed in the background, or after responding and closing the connection.)"}, {"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "reply_to_user": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 0, "creation_date": 1532361906, "post_id": 51476369, "comment_id": 89934931, "body": "@CBroe right that is what I was thinking. I thought maybe I run some background jobs to speed up the 14 seconds. Not sure if that may ruin the instant &#39;chat&#39; experience though.   Still not convinced it&#39;s the 14 seconds that is causing FB to resend though as the timeout is apparently 20?"}, {"owner": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 0, "creation_date": 1532363037, "post_id": 51476369, "comment_id": 89935552, "body": "<a href=\"https://developers.facebook.com/docs/messenger-platform/policy/responsiveness#policy\" rel=\"nofollow noreferrer\">developers.facebook.com/docs/messenger-platform/policy/&hellip;</a> mentions 30 seconds within which automated bots must respond - but that is more a policy regarding user experience, not necessarily regarding technical limitations. Maybe try to log your response times (diff between webhook udpate received and your 200 response), and check if there is any time-based correlation to what you get &quot;double updates&quot; for as a first measure, to verify whether that&#39;s the reason or something else?"}, {"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "reply_to_user": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 0, "creation_date": 1532364791, "post_id": 51476369, "comment_id": 89936425, "body": "Yup I did the above and the correlation I found was that all &quot;double updates&quot; happen because the initial webhook always takes about 12 + seconds to send out a 200 OK.   I&#39;m sending multiple messages in response to the first webhook in my methods and I&#39;m guessing it will only return 200 OK once my app is finished sending all those messages. Seem like the only way to speed it up is to use delayed jobs and thus send 200 OK response quicker?"}, {"owner": {"reputation": 501, "user_id": 856145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26a2d4ccf8540a41f00c9aaca72ee3df?s=128&d=identicon&r=PG", "display_name": "sLedgem", "link": "https://stackoverflow.com/users/856145/sledgem"}, "edited": false, "score": 0, "creation_date": 1589795990, "post_id": 51476369, "comment_id": 109425103, "body": "Did you ever find the cause? I&#39;m facing the same issue"}], "answers": [{"tags": [], "owner": {"reputation": 496, "user_id": 6760642, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001839393414/picture?type=large", "display_name": "Egalicia", "link": "https://stackoverflow.com/users/6760642/egalicia"}, "is_accepted": false, "score": 0, "last_activity_date": 1532409055, "creation_date": 1532409055, "answer_id": 51490864, "question_id": 51476369, "link": "https://stackoverflow.com/questions/51476369/fb-messenger-api-receiving-double-requests/51490864#51490864", "title": "FB Messenger API - Receiving double requests", "body": "<p>You also ensure that \"Echo\" is disabled.</p>\n\n<p>Go to Settings>Webhooks, edit events.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0aRuE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0aRuE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Asyncronous language like NodeJS is recomended, in my case y work with AWS SQS, I have workers that process the requests witout blocking (dont wait), I return 200,\"ok\" to FB to avoid that FB send again the message to my webhook.</p>\n\n<p>Anothe apporach maybe store the <em>mid</em> in database, and check in each request if the <em>mid</em> exists, if exists the dont process the message. I was use Dynamo DB (AWS) with TTL enabled, thus with TTL my database <em>autoclean</em> every hour erasing old request.</p>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 856145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26a2d4ccf8540a41f00c9aaca72ee3df?s=128&d=identicon&r=PG", "display_name": "sLedgem", "link": "https://stackoverflow.com/users/856145/sledgem"}, "is_accepted": false, "score": 0, "last_activity_date": 1589913182, "creation_date": 1589913182, "answer_id": 61898262, "question_id": 51476369, "link": "https://stackoverflow.com/questions/51476369/fb-messenger-api-receiving-double-requests/61898262#61898262", "title": "FB Messenger API - Receiving double requests", "body": "<p>I think it is the 15 second wait before replying, was also happening to me as Facebook auto retries when you don't reply fast enough. Te EEe Te's idea is solid, write some mechanism to cache mids and check if it is a duplicate before processing</p>\n"}], "owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 748, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1589913182, "creation_date": 1532340843, "question_id": 51476369, "link": "https://stackoverflow.com/questions/51476369/fb-messenger-api-receiving-double-requests", "title": "FB Messenger API - Receiving double requests", "body": "<p>I have a working FB Bot built with Ruby which allows players to play a scavenger hunt. </p>\n\n<p>Sometimes though, when I have multiple players in a team, FB is sending me a players 'Answer' webhook twice. I have looked into it and at first thought it was to do with the 20 second timeout if FB gets no 200 OK response (<a href=\"https://developers.facebook.com/docs/messenger-platform/webhook#response\" rel=\"nofollow noreferrer\">Docs here</a>). After checking the logs though, I am receiving the second webhook from FB only 14 seconds later. See below:</p>\n\n<pre><code># Webhook #1 \n{\"object\"=&gt;\"page\", \"entry\"=&gt;[{\"id\"=&gt;\"252445748474312\", \"time\"=&gt;1532153642358, \"messaging\"=&gt;[{\"sender\"=&gt;{\"id\"=&gt;\"1709242109154907\"}, \"recipient\"=&gt;{\"id\"=&gt;\"252445748474312\"}, \"timestamp\"=&gt;1532153641935, \"message\"=&gt;{\"mid\"=&gt;\"0FeOChulGjuPgg3YJqEgajNsY8kMfNRt_bpIdeegEeE54h-KB8szcd-EQ-UHUT3850RwHgH4TxVYFkoFwxqhtg\", \"seq\"=&gt;402953, \"text\"=&gt;\"Larrikins\"}}]}]}\n\n# Webhook #2 (14 seconds later)\n{\"object\"=&gt;\"page\", \"entry\"=&gt;[{\"id\"=&gt;\"252445748474312\", \"time\"=&gt;1532153656901, \"messaging\"=&gt;[{\"sender\"=&gt;{\"id\"=&gt;\"1709242109154907\"}, \"recipient\"=&gt;{\"id\"=&gt;\"252445748474312\"}, \"timestamp\"=&gt;1532153641935, \"message\"=&gt;{\"mid\"=&gt;\"0FeOChulGjuPgg3YJqEgajNsY8kMfNRt_bpIdeegEeE54h-KB8szcd-EQ-UHUT3850RwHgH4TxVYFkoFwxqhtg\", \"seq\"=&gt;402953, \"text\"=&gt;\"Larrikins\"}}]}]}\n</code></pre>\n\n<p>Notice both are exactly the same apart from the first \"time\" attribute (14 secs later).</p>\n\n<p>Due to a number of methods and calls that I process after receiving the first webhook, the 200 OK response is only being sent back to FB once I have finished sending my messages in response (hence the 14 second delay).</p>\n\n<p>So I have two questions:</p>\n\n<ol>\n<li><p>Is the 14 second delay too long and that is why FB is resending? If so, how can I send a 200OK response straight away (<code>head :ok</code>)?</p></li>\n<li><p>Is it another issue entirely? </p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1532340461, "post_id": 51476243, "comment_id": 89920731, "body": "Please provide an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 8937642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677745c2ebda486da271d4d33ed6fce2?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Marti", "link": "https://stackoverflow.com/users/8937642/alejandro-marti"}, "is_accepted": false, "score": 0, "last_activity_date": 1532341746, "last_edit_date": 1532341746, "creation_date": 1532341312, "answer_id": 51476518, "question_id": 51476243, "link": "https://stackoverflow.com/questions/51476243/cant-import-csv-file-using-ruby-on-rails/51476518#51476518", "title": "Can&#39;t import .csv file using Ruby on Rails", "body": "<p>You are setting the product_code to \"CSV Import...\" in this line</p>\n\n<pre><code>product = Product.new product_code: \"CSV Import #{Time.zone.now.strftime('%m/%d/%Y %I:%M %p')}\", color_id: color_id, category_id: category_id, supplier_id: supplier_id, unit_id: unit_id\n</code></pre>\n\n<p>You should change this bit </p>\n\n<pre><code>product_code: row[\"Product Code\"].to_s.downcase.strip\n</code></pre>\n\n<p>I do not understand the purpose of this part</p>\n\n<pre><code>if product.save\n        CSV.foreach(file.path, headers: true) do |row|\n          product = Product.where([\"LOWER(product_code) = ?\", row[\"Product Code\"].downcase]).first\n          unless product.nil?\n             product = Product.new product_code: product.id, color: color_id.id, category_id: category_id, supplier_id: supplier_id, unit_id: unit_id\n            if product.save\n              imported += 1\n            end\n    end\n</code></pre>\n\n<p>I would set imported = 0 at the beggining of the method and then do</p>\n\n<pre><code>    if product.save\n      imported += 1\n    end\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8232142, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QsFoBpHy3aU/AAAAAAAAAAI/AAAAAAAAAA4/0ul4AlalmTc/photo.jpg?sz=128", "display_name": "Arjay Legaspi", "link": "https://stackoverflow.com/users/8232142/arjay-legaspi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532348201, "creation_date": 1532340395, "question_id": 51476243, "link": "https://stackoverflow.com/questions/51476243/cant-import-csv-file-using-ruby-on-rails", "title": "Can&#39;t import .csv file using Ruby on Rails", "body": "<p>I'm trying to import the <strong>Product</strong> list from the .csv file but I'm cannot import the data from the csv file to the MySQL database. On the csv product file, there are 7 columns which are <strong>Product Code</strong>, <strong>Description</strong>, &amp; <strong>Size</strong>. <a href=\"https://i.stack.imgur.com/WJdXN.png\" rel=\"nofollow noreferrer\">(Please click to see the expample)</a> Those are from the table Product itself. The other columns are from other tables which are <strong>Color</strong>, <strong>Category Code</strong>, <strong>Supplier</strong> and <strong>Unit</strong>. My problem is it keeps inserting \"<strong>CSV Import 07/23/2018 05:06 PM</strong>\"  (or whatever the time/date is) on the Product Code field. It supposed to be a the product code value from the CSV file (e.g. 100778). But the message says it imported successfully <a href=\"https://i.stack.imgur.com/Nj1vH.png\" rel=\"nofollow noreferrer\">(here)</a> but there's nothing has change on the database. What do you think is the problem here? </p>\n\n<hr>\n\n<p>Here's my model:</p>\n\n<p><strong>product.rb:</strong></p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  require 'csv'\n  belongs_to :category, optional:true\n  belongs_to :supplier, optional:true\n  belongs_to :color, optional:true\n  belongs_to :unit, optional:true\n  accepts_nested_attributes_for :serial, allow_destroy: true\n\n  validates :product_code, presence: true, uniqueness: true\n\n   def import file\n      status = true\n      message = \"\"\n      last_location = \"\"\n      color_id, unit_id, category_id, supplier_id = \"\"\n\n      index = 2\n        CSV.foreach(file.path, headers: true) do |row|\n            if row[\"Product Code\"].nil? || row[\"Product Code\"].blank?\n                  status = false\n                  message = \"Error: Product Code is required on row #{index}.\"\n                break\n            elsif row[\"Category Code\"].nil? || row[\"Category Code\"].blank?\n                  status = false\n                  message = \"Error: Category Code is required on row #{index}.\"\n                break\n            elsif row[\"Supplier\"].nil? || row[\"Supplier\"].blank?\n                  status = false\n                  message = \"Error: Supplier is required on row #{index}.\"\n                break\n            elsif row[\"Unit\"].nil? || row[\"Unit\"].blank?\n                  status = false\n                  message = \"Error: Supplier is required on row #{index}.\"\n                break\n            else\n              stock_no = row[\"Product Code\"].to_s.downcase.strip\n              product = Product.where(\"LOWER(product_code) = '#{stock_no}'\").first\n              if product.nil?\n                  status = false\n                  message = \"Error: No matching item #{stock_no} on row #{index}.\"\n                break\n              end\n              color_name = row[\"Color\"].to_s.downcase.strip\n              color = Color.where(\"LOWER(name) = '#{color_name}'\").first\n              if color.nil?\n                  status = false\n                  message = \"Error: No matching color #{color_name} on row #{index}.\"\n                break\n              end \n              category_name = row[\"Category Code\"].to_s.downcase.strip\n              category = Category.where(\"LOWER(name) = '#{category_name}'\").first\n              if category.nil?\n               status = false\n               message = \"Error: No matching category #{category_name} on row #{index}.\"\n               break\n             end\n             supplier_name = row[\"Supplier\"].to_s.downcase.strip\n                  supplier = Supplier.where(\"LOWER(name) = '#{supplier_name}'\").first\n              if supplier.nil?\n                  status = false\n                  message = \"Error: No matching supplier #{supplier_name} on row #{index}.\"\n                break\n              end\n\n                  unit_name = row[\"Unit\"].to_s.downcase.strip\n                  unit = Unit.where(\"LOWER(name) = '#{unit_name}'\").first\n              if unit.nil?\n                  status = false\n                  message = \"Error: No matching unit on row #{index}.\"\n                break\n              end\n\n            end\n          index += 1\n          last_location = row[\"Location\"]\n      end \n      if status\n        imported = 0\n\n          color = Color.where([\"LOWER(name) = ?\", 'row[color]'.downcase]).first\n          color_id = color.nil? ? nil : color.id\n\n          unit = Unit.where([\"LOWER(name) = ?\", 'row[unit]'.downcase]).first\n          unit_id = unit.nil? ? nil : unit.id\n\n          category = Category.where([\"LOWER(name) = ?\", 'row[category]'.downcase]).first\n          category_id = category.nil? ? nil : category.id\n\n          supplier = Supplier.where([\"LOWER(name) = ?\", 'row[supplier]'.downcase]).first\n          supplier_id = supplier.nil? ? nil : supplier.id\n\n\n          product = Product.new product_code: \"CSV Import #{Time.zone.now.strftime('%m/%d/%Y %I:%M %p')}\", color_id: color_id, category_id: category_id, supplier_id: supplier_id, unit_id: unit_id\n        if product.save\n            CSV.foreach(file.path, headers: true) do |row|\n              product = Product.where([\"LOWER(product_code) = ?\", row[\"Product Code\"].downcase]).first\n              unless product.nil?\n                 product = Product.new product_code: product.id, color: color_id.id, category_id: category_id, supplier_id: supplier_id, unit_id: unit_id\n                if product.save\n                  imported += 1\n                end\n        end \n     end \n    message = \"#{imported} record(s) have been imported successfully.\"\n   end\n  end\n     return [status, message]\n\n end\nend\n</code></pre>\n\n<p><strong>products_controller.rb:</strong></p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  def create\n   @product = Product.new(product_params)\n    if params[:todo] == \"import\"\n     import = Product.import params[:product][:file]\n     session[:import_flash] = import[1] \n      if import[0]\n        redirect_to import_product_path\n      else\n        redirect_to import_product_path\n      end\n    else\n      @product = Product.new(product_params)\n    if @product.save\n      redirect_to products_path, notice: \"Product created successfully.\"\n    else\n     flash.now[:error] = \"#{@product.errors.full_messages.first}.\"\n      render :new\n    end\n  end\n end\n\n  def product_params\n    params.require(:product).permit(\n    :product_code, :description, :size, :barcode, :color_id, :unit_id, :category_id, :supplier_id, :qty, :price, \n    :serial_attributes =&gt; [:id, :serial_no, :power, :serial_type, :cyl, :product_id,:_destroy]\n  )\n  end\n\nend\n</code></pre>\n\n<p><strong>import_product_csv.js:</strong></p>\n\n<pre><code>function validateProductCSV(param) {\n if (param == \"product\") {\n  var file = document.getElementById(\"product_file\");\n } \n else {\n  var file = document.getElementById(\"product_file\");\n }\n\n p_error = document.getElementById(\"p_error\");\n no_errors = true;\n err_mes = \"\";\n\n if (file.value == \"\") {\n no_errors = false;\n err_mes = \"CSV file is required.\";\n }\n\n ext = file.value.split('.').pop();\n if ((ext != \"csv\" &amp;&amp; ext != \"CSV\") &amp;&amp; no_errors) {\n no_errors = false;\n err_mes = \"Selected file is not a valid CSV.\";\n }\n\n if (no_errors) {\n  return true;\n } \n else {\n  p_error.innerHTML = err_mes;\n  file.focus();\n  return false;\n }\n}\n</code></pre>\n\n<p>view: <strong>import.html.erb:</strong></p>\n\n<pre><code>&lt;%= form_for Product.new do |f| %&gt;\n &lt;div class=\"header\"&gt;\n &lt;h4 class=\"title\"&gt; &lt;%= link_to \"Products\", products_path %&gt; / Import \n &lt;%= f.submit \"Import\", class:\"btn btn-flat btn-flat pull-right\", data:{disable_with:\"Importing..\"}, style:\"color:#000000;\", onclick: \"return validateProductCSV('product');\" %&gt;&lt;/h4&gt;\n &lt;/div&gt;\n&lt;br&gt;&lt;br&gt;\n&lt;%= render \"form_import\", f:f %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>(form) <strong>_form_import.html.erb:</strong></p>\n\n<pre><code>&lt;%= javascript_include_tag \"import_product_csv\" %&gt;\n &lt;div class=\"content\"&gt;\n  &lt;div class=\"container-fluid\"&gt;\n   &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-12\"&gt;\n     &lt;div class=\"card\"&gt;\n      &lt;div class=\"card-content\"&gt;\n        &lt;div class=\"content\"&gt;\n          &lt;div class=\"row\"&gt;\n            &lt;div class=\"col-md-12\"&gt;\n              &lt;p style=\"font-family:'Calibri'; font-size:12pt; color:red; font-weight:bold; padding-left:15px;\" id=\"p_error\"&gt;&lt;%= session[:import_flash] %&gt;&lt;/p&gt;\n              &lt;% session[:import_flash] = nil %&gt;\n              &lt;div class=\"box box-primary\"&gt;\n                &lt;div class=\"box-body\"&gt;\n                  &lt;div class=\"form-group\"&gt;\n                    &lt;div class=\"col-md-4\"&gt;\n                      &lt;%= f.label :name, \"Choose a CSV file\" %&gt;\n                      &lt;%= f.file_field :file, class:'form-control' %&gt;\n                      &lt;input type=\"hidden\" name=\"todo\" value=\"import\"&gt;\n                    &lt;/div&gt;\n                  &lt;/div&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>\n</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "validation", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2536, "user_id": 3432373, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd9272a0aaa7744349c43b461406b276?s=128&d=identicon&r=PG&f=1", "display_name": "t3__rry", "link": "https://stackoverflow.com/users/3432373/t3-rry"}, "edited": false, "score": 0, "creation_date": 1532340682, "post_id": 51476224, "comment_id": 89920869, "body": "An easy way to achieve this is to add the <code>required</code> attributes to those inputs and you&#39;ll get the browser&#39;s native validation error message. For a more elaborate usage you can use the browser&#39;s <i>validation constraint</i> API, <a href=\"https://www.html5rocks.com/en/tutorials/forms/constraintvalidation/\" rel=\"nofollow noreferrer\">html5rocks.com/en/tutorials/forms/constraintvalidation</a>"}, {"owner": {"reputation": 701, "user_id": 6060606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X4gss.png?s=128&g=1", "display_name": "Chris Satchell", "link": "https://stackoverflow.com/users/6060606/chris-satchell"}, "edited": false, "score": 0, "creation_date": 1532342635, "post_id": 51476224, "comment_id": 89922072, "body": "Please check <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> and provide any code you have to make it easier for others to help you"}, {"owner": {"reputation": 21, "user_id": 10028132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6ebd3c773925eba07f1a6ad2117bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/10028132/jerry"}, "reply_to_user": {"reputation": 2536, "user_id": 3432373, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd9272a0aaa7744349c43b461406b276?s=128&d=identicon&r=PG&f=1", "display_name": "t3__rry", "link": "https://stackoverflow.com/users/3432373/t3-rry"}, "edited": false, "score": 0, "creation_date": 1532345203, "post_id": 51476224, "comment_id": 89923583, "body": "@t3__rry that won&#39;t work"}], "owner": {"reputation": 21, "user_id": 10028132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6ebd3c773925eba07f1a6ad2117bf6?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/10028132/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532365730, "creation_date": 1532340334, "last_edit_date": 1532365730, "question_id": 51476224, "link": "https://stackoverflow.com/questions/51476224/tweaking-a-client-js-validation-error-only-for-a-radio-button-container-on-a-pag", "title": "Tweaking a client/js validation error only for a radio button container on a page", "body": "<p>I have a page where there're several radio buttons. I want to tweak client validation <strong>only for those radio buttons</strong> on that page. Here's what it looks like when it's valid:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LPzq0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LPzq0.png\" alt=\"when it&#39;s valid\"></a></p>\n\n<p>And here's when it's invalid -- doesn't look nice:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WleMP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WleMP.png\" alt=\"when it&#39;s invalid\"></a></p>\n\n<p>I think it'll be better to apply validation to a whole container rather than to an individual radio button -- the validtion error will be placed under the two radio buttons. </p>\n\n<p>How can I do that? </p>\n\n<p>Otherwise, what's the best <strong>and simple</strong> way to make this validation error look nicer?</p>\n\n<p>Note that I won't want to use an additional gem or js library for that.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api"], "comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532328323, "post_id": 51472892, "comment_id": 89914057, "body": "Or should I restructure my models?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1532334630, "post_id": 51472892, "comment_id": 89917337, "body": "<code>match 1 = (team_a: 1, team_b:2)</code> is not valid code. I understand what you&#39;re trying to say, but please try to provide valid code, not pseudocode, when possible. It would have been trivial for you to write this using <code>Match</code> and <code>MatchStat</code> - so that the code is actually valid ruby."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532329044, "post_id": 51473025, "comment_id": 89914365, "body": "Your query is for the first match only im aiming for all matches. I&#39;ve done that already i&#39;ve registered the winning_team and winner_score. And yes i only got 2 participant per match. Should i return it to that model again?"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532330079, "post_id": 51473025, "comment_id": 89914902, "body": "I see no reason to store the stats in separate records. That creates difficulties as you always have to use GROUP queries to find the winner (like in my example). I&#39;d add three attributes: score_team_a, score_team_b &amp; winner_id. That allows you to set-up a double relationship between Team &amp; Match, one to find all the matches they participated and another one to find matches they won."}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532331115, "post_id": 51473025, "comment_id": 89915452, "body": "Thank you for your suggestion. I guess i should revert it back. Including loser_id."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532331442, "post_id": 51473025, "comment_id": 89915626, "body": "That would be redundant... you could create a negation query that gets the loser. If participant but not winner, you are the loser. But for convenience, you could do this."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1532334540, "post_id": 51473025, "comment_id": 89917289, "body": "Shouldn&#39;t that be <code>group(:team_id)</code>, not <code>group(:match_id)</code>?"}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532336528, "post_id": 51473025, "comment_id": 89918355, "body": "I&#39;ve reverted my model again now i got this. I&#39;m having problem on getting the Average points of the winner. Match(id: integer, team_a: integer, team_b: integer, score_team_a: integer, score_team_b: integer, winner_id: integer)  example.  match 1: (team_a: 1, team_b: 2, score_team_a: 46, score_team_b: 65, winner_id: 2) match 2: (team_a: 1, team_b: 2, score_team_a: 87, score_team_b: 54, winner_id: 1)  I&#39;m having trouble because i don&#39;t know what points should i get?"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532338411, "post_id": 51473025, "comment_id": 89919451, "body": "Just create a method in the Match model, that returns the highest of score_team_a and score_team_b: <code>def winning_score [score_team_a, score_team_b].max end;</code>"}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": true, "score": 1, "last_activity_date": 1532328553, "creation_date": 1532328553, "answer_id": 51473025, "question_id": 51472892, "link": "https://stackoverflow.com/questions/51472892/how-to-get-the-winning-team/51473025#51473025", "title": "How to get the winning team?", "body": "<p>Untested, but you should be able to find it with something like:</p>\n\n<pre><code>Match.find(1).match_stats.group(:match_id).select('MAX(points)')\n</code></pre>\n\n<p>I don't see why you should use a separate model in this case. Are you planning on running matches where there are more than 2 participants? Otherwise I'd just store the score and the winnner in the Match model.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532336819, "post_id": 51474768, "comment_id": 89918526, "body": "That&#39;s actually my problem now i can&#39;t find what point should i get? Yes i got the winner but how can i know between those two points? I like your idea about the logic. But I&#39;m saving the match first as score_a = 0 score_b = 0 then update."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532337032, "post_id": 51474768, "comment_id": 89918645, "body": "@something I don&#39;t understand, sorry. What do you mean by <i>&quot;Yes i got the winner but how can i know between those two points?&quot;</i>? Can you explain in more detail? Are you asking about <i>ongoing</i> matches? (In which case, something like a <code>status</code> column would be useful.)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532337124, "post_id": 51474768, "comment_id": 89918695, "body": "You asked for &quot;all winning matches for a team&quot;, and that&#39;s exactly what my solution provides. In some matches, they are <code>team_a</code>; in other matches, they are <code>team_b</code>. But either way, they are the winning team."}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532337373, "post_id": 51474768, "comment_id": 89918833, "body": "First, I restructured my Model to this Match(id: integer, team_a: integer, team_b: integer, score_team_a: integer, score_team_b: integer, winner_id: integer). I can easily get the winner and now i need to get the Average Point for Winning team. Now i can&#39;t get the point because i got two points score_team_a and score_team_b how can i know what point between those two should i get? for example. team_id = 1 is the winner and they&#39;re on team_a so i need score_team_a how can i know that score_team_a is the one that should i get not the score_team_b?"}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532337743, "post_id": 51474768, "comment_id": 89919043, "body": "i&#39;ll follow your advise &quot;This could potentially be a little simpler if you add some logic to always ensure that team_a_points &gt;= team_b_points; but that&#39;s up to you.&quot; thank you!"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532338242, "post_id": 51474768, "comment_id": 89919359, "body": "why not use winner_points and loser_points. Or do you not yet know the winner when creating the record?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1532346349, "post_id": 51474768, "comment_id": 89924260, "body": "@something There is no need for a <code>winner_id</code>. (Besides, if the match is a draw then there&#39;s no winner!!) You&#39;d also be duplicating information."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1532335360, "creation_date": 1532335360, "answer_id": 51474768, "question_id": 51472892, "link": "https://stackoverflow.com/questions/51472892/how-to-get-the-winning-team/51474768#51474768", "title": "How to get the winning team?", "body": "<p>Based on the limited information you have provided, I don't see any need for the <code>MatchStat</code> model; it only complicates matters. I would scrap it, and just store the score inside the <code>matches</code> table:</p>\n\n<pre><code>Match(\n  id: integer,\n  team_a: integer,\n  team_b: integer,\n  team_a_points: integer,\n  team_b_points: integer\n)\n</code></pre>\n\n<p>To get all winning games for <code>team_id = 1</code>, you could then do:</p>\n\n<pre><code>Match.where(team_a: 1).where('team_a_points &gt; team_b_points').or(\n  Match.where(team_b: 1).where('team_b_points &gt; team_a_points'))\n</code></pre>\n\n<p>This could potentially be a little simpler if you add some logic to always ensure that <code>team_a_points &gt;= team_b_points</code>; but that's up to you.</p>\n"}], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1532342504, "accepted_answer_id": 51473025, "answer_count": 2, "score": 0, "last_activity_date": 1532339167, "creation_date": 1532327947, "question_id": 51472892, "link": "https://stackoverflow.com/questions/51472892/how-to-get-the-winning-team", "closed_reason": "Needs details or clarity", "title": "How to get the winning team?", "body": "<p>I've got Match and MatchStat. </p>\n\n<pre><code>Match(id: integer, team_a: integer, team_b: integer)\n\nMatchStat(id: integer, match_id: integer, team_id: integer, points: integer)\n</code></pre>\n\n<p>for example i need to get all of winning match of team_id = 1</p>\n\n<pre><code>match 1 = (team_a: 1, team_b:2)\nmatch_stat 1 = (match_id: 1, team_id: 1, points: 45)\nmatch_stat 2 = (match_id: 1, team_id: 2, points: 67)\n\nmatch 2 = (team_a: 1, team_b:2)\nmatch_stat 3 = (match_id: 2, team_id: 1, points: 54)\nmatch_stat 4 = (match_id: 2, team_id: 2, points: 43)\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1532328591, "creation_date": 1532328591, "answer_id": 51473033, "question_id": 51472800, "link": "https://stackoverflow.com/questions/51472800/why-is-this-string-value-converted-to-an-array/51473033#51473033", "title": "Why is this string value converted to an array?", "body": "<p>Your variable contains <code>[\"(684) 029-6183 x01024\", nil]</code>, not a string. You rely on <code>puts(value)</code> output to determine it\u2019s value which is plain wrong:</p>\n\n<pre><code>puts [\"(684) 029-6183 x01024\", nil]\n#\u21d2\u00a0(684) 029-6183 x01024\n#\n</code></pre>\n\n<p><code>puts(nil)</code> returns an empty string, making you think the original value is a string.</p>\n\n<p>To overcome this issue you might:</p>\n\n<pre><code>value = [*value].compact.join\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 2, "last_activity_date": 1532331663, "last_edit_date": 1532331663, "creation_date": 1532331238, "answer_id": 51473682, "question_id": 51472800, "link": "https://stackoverflow.com/questions/51472800/why-is-this-string-value-converted-to-an-array/51473682#51473682", "title": "Why is this string value converted to an array?", "body": "<p>The following line of code is causing a couple of issues</p>\n\n<pre><code>@number = opts[:number] || @type == \"cell\" ? Faker::PhoneNumber.cell_phone : Faker::PhoneNumber.phone_number,\n</code></pre>\n\n<p>First, the <code>||</code> operator has a higher precedence than the <code>?</code> operator, so it actually looks like:</p>\n\n<pre><code>@number = (opts[:number] || @type == \"cell\") ? Faker::PhoneNumber.cell_phone : Faker::PhoneNumber.phone_number,\n</code></pre>\n\n<p>and you probably were wanting this:</p>\n\n<pre><code>@number = opts[:number] || (@type == \"cell\" ? Faker::PhoneNumber.cell_phone : Faker::PhoneNumber.phone_number),\n</code></pre>\n\n<p>As it stands, it doesn't matter what you pass into <code>opts[:number]</code>, you'll always get a <code>Faker::PhoneNumber</code> assigned. (The line above, assigning type, looks like it would have this same precedence issue)</p>\n\n<p>Second, you have a stray comma at the end of the line. This is turning the entire line into the first element of an array, and doesn't interfere with assigning the variable on the next line, so it's hard to catch:</p>\n\n<pre><code>opts = { number: '123' }\ntype = \"cell\"\nnumber = opts[:number] || type == \"cell\" ? \"truthy\" : \"falsey\",\ncountry = \"some value\"\n\np number  # =&gt; [\"truthy\", \"some value\"]\np country # =&gt; \"some value\"\n</code></pre>\n"}], "owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 51473682, "answer_count": 2, "score": 0, "last_activity_date": 1532332685, "creation_date": 1532327579, "last_edit_date": 1532332685, "question_id": 51472800, "link": "https://stackoverflow.com/questions/51472800/why-is-this-string-value-converted-to-an-array", "title": "Why is this string value converted to an array?", "body": "<p>I have the following function:</p>\n\n<pre><code>def parse_var(var)\n    value = instance_variable_get(var)\n    puts(value)\n    puts(value.to_s)\n    value.is_a?(Numeric) ? value.to_s : \"\\\"#{value}\\\"\"\nend\n</code></pre>\n\n<p>Variables of certain form are converted into an array when they are interpolated. In the above function, when <code>value</code> equals <code>(684) 029-6183 x01024</code>, <code>value.to_s</code> comes out to be <code>[\"(684) 029-6183 x01024\", nil]</code>. The same thing also happens when I try <code>\"#{value}\"</code>.</p>\n\n<p>What is causing this?</p>\n\n<p>Here's the context of the code in question:</p>\n\n<p><strong>Entity.rb (context of above code)</strong></p>\n\n<pre><code>require 'securerandom'\n\n# Entity.rb\nclass Entity\n    def initialize\n        generate_uuid\n    end\n\n    def to_cypher\n        first_char = self.class.name.chr.downcase\n        \"MERGE (#{first_char}:#{self.class.name} {#{attrs_to_cypher.join(', ')}}) RETURN #{first_char};\"\n    end\n\n    protected\n\n    def rand_bool\n        [true, false].sample\n    end\n\n    private\n\n    def attrs_to_cypher\n        self.instance_variables.map do |var|\n            \"#{camelize(var.to_s[1..-1])}:#{parse_var(var)}\"\n        end\n    end\n\n    def generate_uuid\n        @uuid = SecureRandom.uuid\n    end\n\n    def parse_var(var)\n        value = instance_variable_get(var)\n        puts(value)\n        puts(value.to_s)\n        value.is_a?(Numeric) ? value.to_s : \"\\\"#{value}\\\"\"\n    end\n\n    def camelize(s)\n        (s == \"uuid\") ? \"UUID\" : s.downcase.split('_').map(&amp;:capitalize).join\n    end\nend\n</code></pre>\n\n<p><strong>PhoneNumber.rb (where the value is coming from)</strong></p>\n\n<pre><code>require 'faker'\nrequire_relative 'Entity'\n\n# PhoneNumber.rb\nclass PhoneNumber &lt; Entity\n    def initialize(**opts)\n        super()\n        @type         = opts[:type]         || rand_bool ? \"cell\" : \"home\"\n        @number       = opts[:number]       || @type == \"cell\" ? Faker::PhoneNumber.cell_phone : Faker::PhoneNumber.phone_number,\n        @country_code = opts[:country_code] || nil\n        @area_code    = opts[:area_code]    || nil\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "web"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1532322303, "post_id": 51471811, "comment_id": 89911897, "body": "you should look into some pagination solutions, like <a href=\"https://github.com/mislav/will_paginate\" rel=\"nofollow noreferrer\">github.com/mislav/will_paginate</a>"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1532322385, "post_id": 51471811, "comment_id": 89911918, "body": "@Subash I think OP wants to display them in the same page with a different layout (grid instead of list)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10102552"}, "edited": false, "score": 0, "creation_date": 1532322488, "post_id": 51471811, "comment_id": 89911934, "body": "I already have pagination going. I just prefer a grid to a vertical list."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532330916, "post_id": 51471811, "comment_id": 89915342, "body": "Why don&#39;t you just print each in a DIV and use CSS for the positioning? A lot better if you support multiple devices."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10102552"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532370023, "post_id": 51471811, "comment_id": 89938992, "body": "@bo-oz I am using RoR and Bootstrap, both of which provide methods for doing these types of things."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532378494, "post_id": 51471811, "comment_id": 89942864, "body": "Bootstrap = css, why not use that?"}], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532341741, "post_id": 51471984, "comment_id": 89921501, "body": "Does it generate different output than <code>@users.each</code>?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1532349237, "post_id": 51471984, "comment_id": 89926144, "body": "As soon as <code>@users.size &gt; 1</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10102552"}, "edited": false, "score": 0, "creation_date": 1532370282, "post_id": 51471984, "comment_id": 89939114, "body": "Thank you for your help. This was close but I went with the answer provided by @Bodharth because it directly helped me since I am using Bootstrap as well as images for my user profiles."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1532323286, "creation_date": 1532323286, "answer_id": 51471984, "question_id": 51471811, "link": "https://stackoverflow.com/questions/51471811/how-do-i-output-the-contents-of-a-variable-in-grid-form/51471984#51471984", "title": "How do I output the contents of a variable in grid form?", "body": "<p>This is a really simple example and you can customise into a nicer table.\nThe basic idea is to group the array of users in subarrays of n elements, lets say 5.</p>\n\n<pre><code>&lt;% @users.each_slice(5).each do |row| %&gt;\n  &lt;p&gt;&lt;% row.each do |user| %&gt;\n      &lt;%= user.name %&gt; | \n    &lt;% end %&gt;\n &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1532378706, "post_id": 51480890, "comment_id": 89942947, "body": "This is totally useless, what is different from looping over the result set directly?"}], "tags": [], "owner": {"reputation": 432, "user_id": 5529252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b93c1cab573e87ee3080d1baa70ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bodh1004", "link": "https://stackoverflow.com/users/5529252/bodh1004"}, "is_accepted": true, "score": -1, "last_activity_date": 1532355180, "creation_date": 1532355180, "answer_id": 51480890, "question_id": 51471811, "link": "https://stackoverflow.com/questions/51471811/how-do-i-output-the-contents-of-a-variable-in-grid-form/51480890#51480890", "title": "How do I output the contents of a variable in grid form?", "body": "<pre><code>&lt;div class=\"row\"&gt;\n      &lt;% users.in_groups_of(5) do |group| %&gt;\n        &lt;% group.compact.each do |user| %&gt;\n           &lt;div class=\"col-lg-3 col-md-4 col-xs-6 thumb\"&gt;\n             &lt;%= image_tag (user.file_url), class: \"img-sz\" %&gt;\n               &lt;h4&gt;&lt;%= link_to user.title, user %&gt;&lt;/h4&gt;\n             &lt;%= link_to \"Edit\", edit_user_path(user) , remote: true, class: \"btn btn-default btn-xs\" %&gt;\n              &lt;%= link_to \"delete\", user,remote: true, method: :delete, data: { confirm: \"You sure?\" }, class: \"btn btn-danger btn-xs\" %&gt;&lt;/br&gt;&lt;/br&gt;\n           &lt;/div&gt;\n        &lt;% end %&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt; \n&lt;/div&gt;\n</code></pre>\n\n<p>This is example code change the name of attributes according to your structure . This will help you in solving your problem . </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10102552"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 51480890, "answer_count": 2, "score": 2, "last_activity_date": 1532355180, "creation_date": 1532322092, "last_edit_date": 1532323154, "question_id": 51471811, "link": "https://stackoverflow.com/questions/51471811/how-do-i-output-the-contents-of-a-variable-in-grid-form", "title": "How do I output the contents of a variable in grid form?", "body": "<p>I have the following code for my Ruby on Rails project, which outputs a list of users on a page:</p>\n\n<pre><code>&lt;ul class=\"users\"&gt;\n  &lt;%= render @users %&gt;\n&lt;/ul&gt;`\n</code></pre>\n\n<p>The result is a long list of users on the page.</p>\n\n<p>My question is: How can I manipulate <code>@users</code> so that I can output its content in grid form (e.g., a row of 5 users and then next row and then next and so on) on the page? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532322973, "post_id": 51471790, "comment_id": 89912034, "body": "NoMethodError what? Where? Please provide more context (code). Regarding running a method from one controller to another, it&#39;s not generally advised or a best practice at all, but if you must, <a href=\"https://stackoverflow.com/questions/8225518/calling-a-method-from-another-controller\" title=\"calling a method from another controller\">stackoverflow.com/questions/8225518/&hellip;</a>"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532323064, "post_id": 51471790, "comment_id": 89912054, "body": "It&#39;s redirecting to the show action. I am unable to redirect to update. I believe already included all the code that is relevant to the question"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532323099, "post_id": 51471790, "comment_id": 89912063, "body": "What&#39;s the method that&#39;s undefined?"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532323173, "post_id": 51471790, "comment_id": 89912081, "body": "I think I agree with you. I&#39;ll just create a helper method and avoid the monkey patching..."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1532323374, "post_id": 51471790, "comment_id": 89912141, "body": "The public methods of your controllers should only correspond to an HTTP request and nothing more. The protected and private methods should set up the context surrounding that request. If you find yourself trying to do something outside of that scope, you&#39;re probably doing something you&#39;re not supposed to be doing :)"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532335164, "post_id": 51471790, "comment_id": 89917600, "body": "Don&#39;t do that. Redirect is sending a response of the request and invoke new request from the client&#39;s side. So, that need more client&#39;s resources and server&#39;s too. Put all logic to the same action when them related to the same path and only then write a single redirect if redirect needed(in your case any redirect has no sense)."}], "answers": [{"comments": [{"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1532362769, "post_id": 51478584, "comment_id": 89935419, "body": "My UPDATE action in the authors controller is hundreds of lines long. I need to run it for the nested author. My issue is not in updating the author. My problem is that I need to run the author controller UPDATE action via the UPDATE action of the books controller."}], "tags": [], "owner": {"reputation": 72, "user_id": 8808211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6373685ae0874ffca4dd6d803a28505a?s=128&d=identicon&r=PG&f=1", "display_name": "Necrogoru", "link": "https://stackoverflow.com/users/8808211/necrogoru"}, "is_accepted": false, "score": 0, "last_activity_date": 1532365020, "last_edit_date": 1532365020, "creation_date": 1532348205, "answer_id": 51478584, "question_id": 51471790, "link": "https://stackoverflow.com/questions/51471790/rails-redirect-to-update-path-update-url/51478584#51478584", "title": "Rails redirect_to update_path/update_url", "body": "<p>I think that you can do this different, like:</p>\n\n<pre><code>class BookController &lt; ApplicationController\n  def update\n    ...\n\n    #update the author\n    author = Author.find(book.author.id)\n    #if you need, you can use Author.update(fields_to_update_with_values)\n    author.touch\n\n    #later redirect\n    redirect_back fallback_location: root_path\n  end\nend\n</code></pre>\n\n<p>And you can set in your model associations, an auto \"update\".  <a href=\"http://guides.rubyonrails.org/association_basics.html#touch\" rel=\"nofollow noreferrer\">RailsGuides</a> say:</p>\n\n<blockquote>\n  <p>If you set the :touch option to true, then the updated_at or\n  updated_on timestamp on the associated object will be set to the\n  current time whenever this object is saved or destroyed</p>\n</blockquote>\n\n<p><strong>Update</strong> I recommend that you use a service object and migrate you author controller update code to the service. This is a good practice for easify your controller and helpfull for your issue.</p>\n\n<p>You can follow the <a href=\"https://hackernoon.com/service-objects-in-ruby-on-rails-and-you-79ca8a1c946e\" rel=\"nofollow noreferrer\">Service Objects in Ruby on Rails\u2026and you</a> guide by Rob Race.</p>\n"}, {"tags": [], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1532365070, "creation_date": 1532365070, "answer_id": 51483863, "question_id": 51471790, "link": "https://stackoverflow.com/questions/51471790/rails-redirect-to-update-path-update-url/51483863#51483863", "title": "Rails redirect_to update_path/update_url", "body": "<p>For complex actions that need to be shared, I believe the only solution is to extract the actions into a new module. Here is a complete detailed answer for those looking for a similar answer:</p>\n\n<pre><code>class BookController &lt; ApplicationController\n  def update\n    # Find the book and then the author of the book\n    book = Book.find(params[:id])\n    author = book.author\n    # create an instance of the author updater and run the update action\n    author_updater = Modules::AuthorUpdater.new(author)\n    author_updater.update_author\n\n    redirect_back fallback_location: root_path\n  end\nend\n\nclass AuthorController &lt; ApplicationController\n  def update\n    author = Author.find(params[:id])\n    # create an instance of the author updater and run the update action\n    author_updater = Modules::AuthorUpdater.new(author)\n    author_updater.update_author\n\n    redirect_back fallback_location: root_path\n  end\nend\n\n# Place this as author_updater.rb inside lib/modules/\nclass Modules::AuthorUpdater\n    def initialize(author)\n        @author = author\n    end\n    def update_author\n        # update actions go here...\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532365070, "creation_date": 1532321929, "last_edit_date": 1532362980, "question_id": 51471790, "link": "https://stackoverflow.com/questions/51471790/rails-redirect-to-update-path-update-url", "title": "Rails redirect_to update_path/update_url", "body": "<p>In Rails 5, how do you run update on a model, and then execute an update of another controller?\nI know it's done with redirect_to, but not sure how exactly. Here is what I have so far:</p>\n\n<pre><code>class BookController &lt; ApplicationController\n  def update\n    ...\n    redirect_to author_update_path(id: book.author.id.to_s)\n  end\nend\n\nclass AuthorController &lt; ApplicationController\n  def update\n    ...\n    redirect_back fallback_location: root_path\n  end\nend\n</code></pre>\n\n<p>I am on a book page and I updated some fields that belong to the book (like the book title). But then I want to run the update of the author.</p>\n\n<p>I am getting NoMethodError so far...</p>\n\n<p>What do I do?</p>\n\n<p>EDIT</p>\n\n<p>Let me explain it clearly:</p>\n\n<p>My UPDATE action in the authors controller is hundreds of lines long. I need to run it for the nested author. My issue is not in updating the author from within the Books controller update action. My problem is that I need to run the author controller UPDATE action via the UPDATE action of the books controller.\nCopy pasting the UPDATE action of the Author controller into the Update action of the Books controller is not an option.</p>\n"}, {"tags": ["ruby", "database", "error-handling", "dbi"], "answers": [{"tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": true, "score": 0, "last_activity_date": 1532320805, "creation_date": 1532320805, "answer_id": 51471663, "question_id": 51471515, "link": "https://stackoverflow.com/questions/51471515/what-is-the-difference-between-e-err-and-e-errstr/51471663#51471663", "title": "What is the difference between e.err and e.errstr?", "body": "<p>They are provided by the ruby's Database Independent Interface,</p>\n\n<pre><code>e.err -&gt; will give you the error code like 4xx\ne.errstr -&gt; will give you the error message like 'unable to find the specified database'\n</code></pre>\n\n<p>Hope this makes it clear</p>\n"}], "owner": {"reputation": 581, "user_id": 9822083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n7oFg.png?s=128&g=1", "display_name": "Jett", "link": "https://stackoverflow.com/users/9822083/jett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 51471663, "answer_count": 1, "score": 0, "last_activity_date": 1532320805, "creation_date": 1532319405, "question_id": 51471515, "link": "https://stackoverflow.com/questions/51471515/what-is-the-difference-between-e-err-and-e-errstr", "title": "What is the difference between e.err and e.errstr?", "body": "<p>I'm trying to create a database connection using Ruby and have come across some advice that I should put in error notices if I ever come across errors in the future. </p>\n\n<p>Here is a sample code that contains #{e.err} and #{e.errstr}.</p>\n\n<p>What do e.err and e.errstr mean and how are they beneficial when handling with databases?</p>\n\n<pre><code>    require \"dbi\"\n\n    begin\n        # connect to the MySQL server\n        dbh = DBI.connect(\"DBI:Mysql:TESTDB:localhost\", \"username\", \"password\")\n        # get server version string and display it\n        row = dbh.select_one(\"SELECT VERSION()\")\n        puts \"Server version: \" + row[0]\n    rescue DBI::DatabaseError =&gt; e\n        puts \"An error occurred\"\n        puts \"Error code:    #{e.err}\"\n        puts \"Error message: #{e.errstr}\"\n    ensure\n        # disconnect from server\n        dbh.disconnect if dbh\n    end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 2, "creation_date": 1532322110, "post_id": 51471295, "comment_id": 89911841, "body": "I don&#39;t think your description is accurate--there are more restrictions than you&#39;ve mentioned. Here&#39;s the problem link: <a href=\"https://www.hackerrank.com/challenges/abbr/problem\" rel=\"nofollow noreferrer\">hackerrank.com/challenges/abbr/problem</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1532391896, "post_id": 51471295, "comment_id": 89946528, "body": "If this is indeed the problem referred to by @ggorlen, I suggest you give up on it, as the setter of the problem believes, mistakenly, that it can be formulated as a dynamic programming problem and therefore is solvable in reasonable time for <code>a</code> having up to 1,000 characters. I just left a comment at the hackerrank stie that explains why dynamic programming cannot be used here and gave an example where the setter&#39;s proposed approach to solving it has a computation complexity of O(2^<code>n</code>), where <code>n = a.size</code>."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532326011, "post_id": 51471897, "comment_id": 89912979, "body": "I see my answer is very similar to your (earlier) answer. The only real difference is that I report the locations of the letters of <code>b</code> in <code>a</code>. In view of the example it may be that the OP is only concerned about the case where <code>b</code> is a substring of <code>a</code>. I suspect we both rejected that interpretation because it is a less interesting question!"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532326275, "post_id": 51471897, "comment_id": 89913090, "body": "@CarySwoveland: No, we both rejected it because OP explicitly mentioned deletion of characters as a possibility :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1532364952, "post_id": 51471897, "comment_id": 89936512, "body": "Ah, yes. I guess I had it right the first time around. See the link given by @ggorlen in a comment on the question. If that\u2019s the problem it appears more complex than we thought, as capital letters cannot be deleted and both <code>a</code> and <code>b</code> may have duplicate letters"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1532330819, "last_edit_date": 1532330819, "creation_date": 1532322726, "answer_id": 51471897, "question_id": 51471295, "link": "https://stackoverflow.com/questions/51471295/substring-in-string/51471897#51471897", "title": "Substring in string", "body": "<p>The absolutely easiest way is via regular expression:</p>\n\n<pre><code>def abbreviation(a, b)\n  re = Regexp.new(b.each_char.map(&amp;Regexp.method(:quote)).join('.*'), Regexp::IGNORECASE)\n  !!re.match(a)\nend\n\nabbreviation(\"daBcD\", \"ABC\")\n# =&gt; true\nabbreviation(\"daCbD\", \"ABC\")\n# =&gt; false\n</code></pre>\n\n<p>For the input <code>ABC</code>, we'll construct a regular expression <code>/A.*B.*C/i</code>, then test the other string against it. The <code>.*</code> construct will account for \"deletion\"; the <code>IGNORECASE</code> option for \"capitalisation\".</p>\n\n<p>EDIT: If the problem is further constrained that only lowercase letters can be deleted, as suggested by the comments,</p>\n\n<pre><code>def abbreviation(a, b)\n  # (b is uppercase only)\n  re_pat = b.each_char.map { |c| \"[#{c}#{c.downcase}]\"}.join('[[:lower:]]*')\n  re = Regexp.new(re_pat)\n  !!re.match(a)\nend\n\np abbreviation(\"daBcD\", \"ABC\") # =&gt; true\np abbreviation(\"daBdcD\", \"ABC\") # =&gt; true\np abbreviation(\"daBDcD\", \"ABC\") # =&gt; false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1532325437, "last_edit_date": 1532325437, "creation_date": 1532325133, "answer_id": 51472285, "question_id": 51471295, "link": "https://stackoverflow.com/questions/51471295/substring-in-string/51472285#51472285", "title": "Substring in string", "body": "<p>I have assumed the problem is to determine whether the characters in <code>b</code> appear in <code>a</code> (case indifferent), in the same order as in <code>b</code>, but not necessarily contiguous in <code>a</code> (see the second example below). If they do I return an array of the indices at which they appear in <code>a</code>. If there is no match, <code>nil</code> is returned.</p>\n\n<pre><code>def doit(a, b)\n  m = a.match(Regexp.new(b.each_char.map { |c| \"(#{c})\" }.join('.*'),\n                         Regexp::IGNORECASE))\n  return nil if m.nil?\n  (1..b.size).map { |i| m.begin(i) }\nend\n\ndoit \"daBcD\", \"ABC\"\n  #=&gt; [1, 2, 3]\ndoit \"daXBDecf\", \"ABC\"\n  #=&gt; [1, 3, 6]\ndoit \"dacBD\", \"ABC\"\n  #=&gt; nil\n</code></pre>\n\n<p>For the first example the regular expression is as follows.</p>\n\n<pre><code>Regexp.new(\"ABC\".each_char.map { |c| \"(#{c})\" }.join('.*'), Regexp::IGNORECASE)\n  #=&gt; /(A).*(B).*(C)/i\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10113061, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AqaqjXYWbJU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ovThsjoHiCjM1ycDeiaPyCRxbnwQ/mo/photo.jpg?sz=128", "display_name": "Matt Mowris", "link": "https://stackoverflow.com/users/10113061/matt-mowris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1532330819, "creation_date": 1532317106, "last_edit_date": 1532318077, "question_id": 51471295, "link": "https://stackoverflow.com/questions/51471295/substring-in-string", "title": "Substring in string", "body": "<p>This function should take in two strings \"daBcD\" and \"ABC\". It is trying to create the string \"b\" from the letters in \"a\". You can only delete or capitalize letters, you cant change them. b will always contain all uppercase letters.</p>\n\n<pre><code>def abbreviation(a, b)\naArray = a.split('')\nidx = 0\naArray.each do |char|\n    #print \"char: #{char}\\n\"\n    #print \"Before loops: #{aArray}\\n\"\n    if char.casecmp(b[idx]) == 0\n        char.upcase!\n        idx += 1\n        #print \"char: #{char}\\nArry: #{aArray}\\n\"\n        #print \"idx: #{idx}\\n siz: #{b.size}\\n\"\n        if idx == b.size\n            aArray.reject! {|i| i == 'delete'}\n            aArray.slice!(b.size)\n            break\n          end\n    else\n      aArray[aArray.index(char)] = 'delete'\n      #print \"deleted, now is: #{aArray}\\n\"\n    end\n  end\n  res = aArray.join('')\n  if res == b\n    return 'YES'\n  else\n    return 'NO'\n  end\nend\n</code></pre>\n\n<p>This works for a couple test cases, but fails most of them. Can someone describe a better approach?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532319535, "post_id": 51471045, "comment_id": 89911290, "body": "What should I put in the model method to pull the data from the database? Sorry , I&#39;m pretty new in rails development"}, {"owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "reply_to_user": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532322951, "post_id": 51471045, "comment_id": 89912028, "body": "If you don&#39;t have any validations, associations, nor instance methods to put, you can leave it blank. Just make sure you ran the migration."}, {"owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "reply_to_user": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532325756, "post_id": 51471045, "comment_id": 89912880, "body": "What&#39;s the stack trace? It may be because you didn&#39;t run your migration. There are a number ways to get that error. Make sure you read <a href=\"http://guides.rubyonrails.org/active_record_basics.html\" rel=\"nofollow noreferrer\">this</a> before anything else."}, {"owner": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532327279, "post_id": 51471045, "comment_id": 89913540, "body": "The error comes from <code>@category = Category.new</code>. When I replace <code>Category.new</code> by a string , I do not get the error method anymore"}, {"owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "reply_to_user": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532327542, "post_id": 51471045, "comment_id": 89913645, "body": "It should be like this: <code>&lt;%= form_for @category, as: :category, url: [post_form_route_url] do |f| %&gt;</code>. Ideally <code>@category</code> should be an object not a string, but do whatever fits your needs."}, {"owner": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532327683, "post_id": 51471045, "comment_id": 89913713, "body": "I can&#39;t get it to work. I am going to edit so you can take a look at it"}, {"owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "reply_to_user": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "edited": false, "score": 0, "creation_date": 1532329984, "post_id": 51471045, "comment_id": 89914849, "body": "I edited my post too. Watch this <a href=\"https://www.youtube.com/watch?v=pPy0GQJLZUM\" rel=\"nofollow noreferrer\">video</a>. You need to learn the fundamentals first."}], "tags": [], "owner": {"reputation": 86, "user_id": 10098406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123a9e02c196e295c5705d50f273dc14?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron M.", "link": "https://stackoverflow.com/users/10098406/aaron-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1532329910, "last_edit_date": 1532329910, "creation_date": 1532314179, "answer_id": 51471045, "question_id": 51470808, "link": "https://stackoverflow.com/questions/51470808/how-to-fill-dropdown-list-options-with-values-from-database-in-rails/51471045#51471045", "title": "How to fill dropdown list options with values from database in rails?", "body": "<p>You should read more about the <a href=\"http://guides.rubyonrails.org/\" rel=\"nofollow noreferrer\">documentation</a>. This is a pretty basic question, and you'll probably have the answer if you actually take the time to read and learn.</p>\n\n<p>That said, the info you provided is lacking so I'll just assume.</p>\n\n<p>First, I assume you have a <code>Category</code> model. It should be placed in <code>app/models/category.rb</code>:</p>\n\n<pre><code>def Category\n  ...\nend\n</code></pre>\n\n<p>Next, you're not actually querying anything from the database. You can do it this way:</p>\n\n<pre><code>## app/controllers/welcome_controller.rb\nclass WelcomeController &lt; ApplicationController\n\n  def index\n  end\n\n  def apply\n    @category = Category.new\n    @categories = Category.pluck(:name, :id)\n  end\nend\n</code></pre>\n\n<p><code>Category.new</code> generates a new instance of the <code>Category</code> (<code>category.rb</code>) object.\n<code>Category.pluck(:name, :id)</code> generates this array: <code>[['foo', 1], ['bar', 2]]</code>, where <code>name</code> and <code>id</code> are attributes of the <code>Category</code> model (just change it to your liking).</p>\n\n<p>Once you have your array stored in <code>@categories</code>, you can use it in your form like this:</p>\n\n<pre><code>## app/views/welcome/apply.html.erb\n\n&lt;%= form_for @category do |f| %&gt;\n &lt;%= f.label 'parent' %&gt;\n &lt;%= f.select :category, @categories %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You're probably not planning to actually create a form for a <code>Category</code> considering that you have a dropdown for categories so you should just change it to something else. Also, take note of the file names. They're all lowercase and separated by underscores. (<code>Welcome_controller.rb</code> should be <code>welcome_controller.rb</code>)</p>\n\n<p>** EDIT **</p>\n\n<p>Now that you've added an object to the <code>form_for</code>, rails will automatically assign a path for your form unless you change it. For this case, the path is <code>categories_path</code>. Read more <a href=\"http://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>What you need to do is modify your <code>routes.rb</code> and add the following line:</p>\n\n<pre><code>resources :categories\n</code></pre>\n\n<p>That line will automatically generate routes that provide a mapping between HTTP verbs and URLs to controller actions.</p>\n\n<p>Next you need to create a <code>CategoriesController</code>:</p>\n\n<pre><code>## app/controllers/categories_controller.rb\nclass CategoriesController &lt; ApplicationController\n  def create\n    @category = Category.new(category_params)\n\n    if @account_user.save\n      redirect_to apply_path\n    else\n      render :new\n    end\n  end\n\n  private\n\n  def category_params\n    params.require(:category).permit! # MODIFY THIS\n  end\nend\n</code></pre>\n\n<p>Anyway, this is basically a walkthrough and you should be figuring this out yourself. There are a lot of resources out there -- it's not hard to find one. You can also check this out: <a href=\"https://www.youtube.com/watch?v=pPy0GQJLZUM\" rel=\"nofollow noreferrer\">video</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 10119831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d25b334b9b185298d94acf805d54206?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10119831/coco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 1, "accepted_answer_id": 51471045, "answer_count": 1, "score": 1, "last_activity_date": 1532329910, "creation_date": 1532311908, "last_edit_date": 1532328503, "question_id": 51470808, "link": "https://stackoverflow.com/questions/51470808/how-to-fill-dropdown-list-options-with-values-from-database-in-rails", "title": "How to fill dropdown list options with values from database in rails?", "body": "<p>I have a little bit of a newbie question.</p>\n\n<p>I have a basic form with a dropdown list that looks like the following : </p>\n\n<pre><code>## apply.html.erb\n\n&lt;%= form_for @category do |f| %&gt;\n &lt;%= f.label 'parent' , 'Category' %&gt;\n &lt;%= f.select :category, [[\"foo\", 0 ], [\"bar\", 1 ]] %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The dropdown list values are <code>\"foo\"</code> and <code>\"bar\"</code>.</p>\n\n<p>I am trying to pull values directly from a database. The problem is that I have no idea how to organize the <code>controller</code> and the <code>model</code>.</p>\n\n<p>Here is the controller :</p>\n\n<pre><code>## Welcome_controller.rb\nclass WelcomeController &lt; ApplicationController\n\n  def index\n  end\n\n  def apply\n    @category = 'foobar'\n  end\nend\n</code></pre>\n\n<p>I have not generated the controller yet. I can not find any convincing answers to my question or tutorial on the internet.</p>\n\n<p>Any idea how I can make it happen?</p>\n\n<p>** EDIT **</p>\n\n<p>So I have been doing some edits.Here is what I have: </p>\n\n<p>The view</p>\n\n<pre><code>## apply.html.erb    \n&lt;%= form_for @category, as: :category do |f| %&gt;\n &lt;%= f.label 'Categories' %&gt;\n &lt;%= f.select :category, @category %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The controller : </p>\n\n<pre><code>## welcome_controller.rb\ndef apply\n    @category = Category.new\n    @categories = Category.pluck(:id, :name)\n  end\n</code></pre>\n\n<p>The model : </p>\n\n<pre><code>## Category.rb\nclass Category &lt; ApplicationRecord\nend\n</code></pre>\n\n<p>I get the following in the terminal : </p>\n\n<pre><code>ActionView::Template::Error (undefined method `categories_path' for #&lt;#&lt;Class:0x007ffb7c5a2808&gt;:0x007ffb7c2814f8&gt;):\n    3: &lt;div id=\"category_block\"&gt;\n    4:   &lt;span&gt;What would you like to get financed ?&lt;/span&gt;\n    5: \n    6:   &lt;%= form_for @category, as: :category do |f| %&gt;\n    7:     &lt;%= f.label 'Categories' %&gt;\n    8:     &lt;%= f.select :category, @category %&gt;\n    9:   &lt;% end %&gt;\n\napp/views/welcome/apply.html.erb:6:in `_app_views_welcome_apply_html_erb___747255529581383389_70359048261520'\n</code></pre>\n\n<p>It looks like the problem comes from <code>@category = Category.new</code> because when I replace <code>Category.new</code> with a string like <code>' foobar'</code>, the error disappears.</p>\n\n<p>Any idea how to fix this problem?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "reply_to_user": {"reputation": 3, "user_id": 10119791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vLQsEI0SACg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oPmwdU-kMzs4h9bN-iL3zp0JCQ4w/mo/photo.jpg?sz=128", "display_name": "ken", "link": "https://stackoverflow.com/users/10119791/ken"}, "edited": false, "score": 0, "creation_date": 1532312257, "post_id": 51470804, "comment_id": 89909960, "body": "glad to be of help, would you accept the answer if it solved your issue"}], "tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": true, "score": 1, "last_activity_date": 1532311876, "creation_date": 1532311876, "answer_id": 51470804, "question_id": 51470785, "link": "https://stackoverflow.com/questions/51470785/using-ruby-select-method-for-nested-hash/51470804#51470804", "title": "Using Ruby select method for nested Hash", "body": "<p>You are not including the key in the select statement, try this</p>\n\n<pre><code>@ProductionInfoDataHash.select{ |index, item| item[:primSegment] == \"Trad\" }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1532312684, "post_id": 51470863, "comment_id": 89910038, "body": "This should just be a comment about the styleguide on the question, as there is already same answer"}], "tags": [], "owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "is_accepted": false, "score": 1, "last_activity_date": 1532312491, "creation_date": 1532312491, "answer_id": 51470863, "question_id": 51470785, "link": "https://stackoverflow.com/questions/51470785/using-ruby-select-method-for-nested-hash/51470863#51470863", "title": "Using Ruby select method for nested Hash", "body": "<p>You need to consider the key and value on your select query.</p>\n\n<p>Like</p>\n\n<p><code>@ProductionInfoDataHash.select { |key, value| value[:primSegment] == 'Trad' }</code></p>\n\n<p>Also, I recommend you to check the most used <a href=\"https://github.com/rubocop-hq/ruby-style-guide\" rel=\"nofollow noreferrer\">ruby style guide</a></p>\n\n<p>you shouldn't use CamelCase on variables like <code>ProductionInfoDataHash</code></p>\n"}], "owner": {"reputation": 3, "user_id": 10119791, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vLQsEI0SACg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oPmwdU-kMzs4h9bN-iL3zp0JCQ4w/mo/photo.jpg?sz=128", "display_name": "ken", "link": "https://stackoverflow.com/users/10119791/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 51470804, "answer_count": 2, "score": 0, "last_activity_date": 1532312491, "creation_date": 1532311662, "question_id": 51470785, "link": "https://stackoverflow.com/questions/51470785/using-ruby-select-method-for-nested-hash", "title": "Using Ruby select method for nested Hash", "body": "<p>I have a hash that has been parsed from HTML</p>\n\n<p>The hash looks like this except it has 38 nested hashes</p>\n\n<pre><code>@ProductionInfoDataHash = {\n    0=&gt;{:name=&gt;\"Name\", :primSegment=&gt;\"Primary Segment\", :unitsSold=&gt;\"Units Sold\", :unitsInventory=&gt;\"Unit Inven tory\", :revisionDate=&gt;\"Revision Date\", :age=&gt;0.0, :mtbf=&gt;\"MTBF\", :pfmnCoord=&gt;0.0, :sizeCoord=&gt;0.0, :price=&gt;\"rice\", :matirialCost=&gt;\"aterial Cost\", :laborCost=&gt;\"abor Cost\", :contrMarg=&gt;0.0, :overtime=&gt;0.02, :automation=&gt;\"Auto mation Next Round\", :capacity=&gt;\"Capacity Next Round\", :plantUtiliz=&gt;0.0},\n    1=&gt;{:name=&gt;\"\", :primSegment=&gt;\"\", :unitsSold=&gt;\"\", :unitsInventory=&gt;\"\", :revisionDate=&gt;\"\", :age=&gt;0.0, :mtbf=&gt;\"\", :pfmnCoord=&gt;0.0, :sizeCoord=&gt;0.0, :price=&gt;nil, :matirialCost=&gt;nil, :laborCost=&gt;nil, :contrMarg=&gt;0.0, :overtime=&gt;0.0, :automation=&gt;\"\", :capacity=&gt;\"\", :plantUtiliz=&gt;0.0}, \n    2=&gt;{:name=&gt;\"Able\", :primSegment=&gt;\"Trad\", :unitsSold=&gt;\"999\", :unitsInventory=&gt;\"189\", :revisionDate=&gt;\"11/21/2015\", :age=&gt;3.1, :mtbf=&gt;\"17500\", :pfmnCoord=&gt;5.5, :sizeCoord=&gt;14.5, :price=&gt;\"28.00\", :matirialCost=&gt;\"11.59\", :laborCost=&gt;\"7.49\", :contrMarg=&gt;0.29, :overtime=&gt;0.0, :automation=&gt;\"4.0\", :capacity=&gt;\"1,800\", :plantUtiliz=&gt;0.66},\n    3=&gt;{:name=&gt;\"Acre\", :primSegment=&gt;\"Low\", :unitsSold=&gt;\"1,763\", :unitsInventory=&gt;\"39\", :revisionDate=&gt;\"5/25/2014\", :age=&gt;4.6, :mtbf=&gt;\"14000\", :pfmnCoord=&gt;3.0, :sizeCoord=&gt;17.0, :price=&gt;\"21.00\", :matirialCost=&gt;\"7.81\", :laborCost=&gt;\"7.12\", :contrMarg=&gt;0.27, :overtime=&gt;0.3, :automation=&gt;\"5.0\", :capacity=&gt;\"1,400\", :plantUtiliz=&gt;1.29},\n    4=&gt;{:name=&gt;\"Adam\", :primSegment=&gt;\"High\", :unitsSold=&gt;\"366\", :unitsInventory=&gt;\"40\", :revisionDate=&gt;\"4/19/2017\", :age=&gt;1.7, :mtbf=&gt;\"23000\", :pfmnCoord=&gt;8.0, :sizeCoord=&gt;12.0, :price=&gt;\"38.00\", :matirialCost=&gt;\"15.98\", :laborCost=&gt;\"8.57\", :contrMarg=&gt;0.33, :overtime=&gt;0.0, :automation=&gt;\"3.0\", :capacity=&gt;\"900\", :plantUtiliz=&gt;0.45}\n}\n</code></pre>\n\n<p>I want to iterate over the nested hashes based on the value of the :primSegment key.</p>\n\n<p>the relevant part of my code is</p>\n\n<pre><code>def productionInfoData_to_Sheet\n\n    g  = @ProductionInfoDataHash.select{ |item| item[:primSegment] == \"Trad\" } # get all nested hashes that have a [:primSegment] == \"Trad\"\n    puts g                                                                 \n end\n</code></pre>\n\n<p>I get the error \n`[]': no implicit conversion of Symbol into Integer (TypeError)</p>\n"}]