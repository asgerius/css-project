[{"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 0, "creation_date": 1545264934, "post_id": 53860762, "comment_id": 94569766, "body": "What is the route for Comment create action?"}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1545275290, "post_id": 53860762, "comment_id": 94571815, "body": "per @MarkMerritt :   [comment, Comment.new] this is making the path for your form comment_comments_path. Try <code>[@pic, comment, Comment.new]</code> or <code>[@pic, Comment.new]</code> if you have a <code>@pic</code> instance variable defined. or you can add the route explicitly instead of building it from objects.  Can you also show us your route file?"}, {"owner": {"reputation": 1, "user_id": 9230322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5970a4d937d61eb7c14249abca284c?s=128&d=identicon&r=PG&f=1", "display_name": "AlexF", "link": "https://stackoverflow.com/users/9230322/alexf"}, "reply_to_user": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545297375, "post_id": 53860762, "comment_id": 94578497, "body": "@Tom your solution with the pic,comment, Comment.new worked. Thanks a lot"}, {"owner": {"reputation": 1, "user_id": 9230322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5970a4d937d61eb7c14249abca284c?s=128&d=identicon&r=PG&f=1", "display_name": "AlexF", "link": "https://stackoverflow.com/users/9230322/alexf"}, "reply_to_user": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 0, "creation_date": 1545297691, "post_id": 53860762, "comment_id": 94578670, "body": "@mehedi the issue is fixed now. thanks"}, {"owner": {"reputation": 1, "user_id": 9230322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5970a4d937d61eb7c14249abca284c?s=128&d=identicon&r=PG&f=1", "display_name": "AlexF", "link": "https://stackoverflow.com/users/9230322/alexf"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1545297709, "post_id": 53860762, "comment_id": 94578681, "body": "@MarkMerritt it&#39;s all working now. thanks a lot tho"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9230322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5970a4d937d61eb7c14249abca284c?s=128&d=identicon&r=PG&f=1", "display_name": "AlexF", "link": "https://stackoverflow.com/users/9230322/alexf"}, "is_accepted": false, "score": 0, "last_activity_date": 1545312911, "creation_date": 1545312911, "answer_id": 53869787, "question_id": 53860762, "link": "https://stackoverflow.com/questions/53860762/i-have-a-nomethoderror-in-one-of-my-controllers/53869787#53869787", "title": "I have a NoMethodError in one of my controllers", "body": "<p>Everything is fixed now and working properly. Had to pass the @pic variable. Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 9230322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5970a4d937d61eb7c14249abca284c?s=128&d=identicon&r=PG&f=1", "display_name": "AlexF", "link": "https://stackoverflow.com/users/9230322/alexf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545312911, "creation_date": 1545263779, "question_id": 53860762, "link": "https://stackoverflow.com/questions/53860762/i-have-a-nomethoderror-in-one-of-my-controllers", "title": "I have a NoMethodError in one of my controllers", "body": "<p>Just added a new comment feature to my rails app and stumbled upon this issue. I'm getting a NoMethodError in Pics#show which comes from my _comment.html.haml partial. </p>\n\n<p>I can see the comment thread on my show page but after I post the comment I'm getting this. Can go back to uncommented pics, but can't go to the ones I've already commented on.</p>\n\n<p>I've been staring at the code for a while now and I need a fresh pair of eyes.</p>\n\n<pre><code>Started GET \"/pics/14\" for 127.0.0.1 at 2018-12-19 23:44:51 +0000\n(0.5ms)  SELECT \"schema_migrations\".\"version\" FROM       \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\n\u21b3 /Users/alexfurtuna/.rvm/gems/ruby-2.4.0/gems/activerecord-5.2.2/lib/active_record/log_subscriber.rb:98\nProcessing by PicsController#show as HTML\nParameters: {\"id\"=&gt;\"14\"}\nPic Load (0.4ms)  SELECT  \"pics\".* FROM \"pics\" WHERE \"pics\".\"id\" = $1  LIMIT $2  [[\"id\", 14], [\"LIMIT\", 1]]\n\u21b3 app/controllers/pics_controller.rb:53\nCACHE Pic Load (0.0ms)  SELECT  \"pics\".* FROM \"pics\" WHERE \"pics\".\"id\" = $1 LIMIT $2  [[\"id\", 14], [\"LIMIT\", 1]]\n\u21b3 app/controllers/pics_controller.rb:9\nRendering pics/show.html.haml within layouts/application\nUser Load (0.4ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n\u21b3 app/views/pics/show.html.haml:14\n(0.7ms)  SELECT COUNT(*) FROM \"votes\" WHERE \"votes\".\"votable_id\" = $1 AND \"votes\".\"votable_type\" = $2 AND \"votes\".\"vote_flag\" = $3  [[\"votable_id\", 14], [\"votable_type\", \"Pic\"], [\"vote_flag\", true]]\n\u21b3 app/views/pics/show.html.haml:20\nComment Load (0.5ms)  SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"commentable_id\" = $1 AND \"comments\".\"commentable_type\" = $2  [[\"commentable_id\", 14], [\"commentable_type\", \"Pic\"]]\n\u21b3 app/views/pics/show.html.haml:28\nRendered collection of comments/_comment.html.haml [1 times] (153.0ms)\nRendered pics/show.html.haml within layouts/application (220.1ms)\nCompleted 500 Internal Server Error in 267ms (ActiveRecord: 13.0ms)\n\n\n\nActionView::Template::Error (undefined method  `comment_comments_path' for #&lt;#.  &lt;Class:0x007fa535ee08b8&gt;:0x007fa535ee9d50&gt;\nDid you mean?  pic_comment_comments_path):\n2:   = comment.body\n3:   %small\n4:     Submitted #{time_ago_in_words(comment.created_at)} ago\n5:   = form_for [comment, Comment.new] do |f|\n6:     = f.text_area :body, placeholder: \"Add a Reply\"\n7:     %br/\n8:     = f.submit \"Reply\"\n\napp/views/comments/_comment.html.haml:5:in    `_app_views_comments__comment_html_haml___2866288612795974586_70173756400620'\napp/views/pics/show.html.haml:28:in `_app_views_pics_show_html_haml___2738689311384334047_70173775563600'\n</code></pre>\n\n<p>And this is my _comment partial.</p>\n\n<pre><code>%li\n = comment.body\n%small\nSubmitted #{time_ago_in_words(comment.created_at)} ago\n = form_for [comment, Comment.new] do |f|\n = f.text_area :body, placeholder: \"Add a Reply\"\n%br/\n = f.submit \"Reply\"\n%ul\n = render partial: 'comments/comment', collection: comment.comments\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545264017, "post_id": 53860751, "comment_id": 94569570, "body": "wow, a gold <code>ruby</code> and <code>ruby-on-rails</code> member asking a question \ud83c\udfc3\ud83c\udfc3\ud83c\udfc3"}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1545265786, "post_id": 53860751, "comment_id": 94569963, "body": "Is there a reason <a href=\"https://guides.rubyonrails.org/association_basics.html#has-and-belongs-to-many-association-reference\" rel=\"nofollow noreferrer\"><code>has_and_belongs_to_many</code></a> doesn&#39;t work here? (I&#39;m assuming there is, and I just missed it)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545330054, "post_id": 53860751, "comment_id": 94595388, "body": "&quot;model classes that are generated don&#39;t exist on their own&quot; you could use a file in <code>initializers</code> to handle this part. Also have you considered looking into the extend option of a <code>has_many</code> relationship? Seems like you could probably make this logic modular and cross class applicable"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545352045, "post_id": 53860751, "comment_id": 94602795, "body": "@engineersmnky Or just use <code>Model::Thing</code> so that <code>&#39;Model::Thing&#39;.constantize</code> will <code>&#39;Model&#39;.constantize</code> (thus creating <code>Model::Thing</code>) along the way. I prefer the namespacing over making things even more diffuse with an initializer. And yes, I do use the extension blocks in combination with all this, sometimes I&#39;ll capture the extension block in a module that can be mixed into a generated class."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1545352493, "post_id": 53860751, "comment_id": 94602908, "body": "@GarrettMotzner HABTM tends to be cumbersome to deal with, hence the existence of has-many-through. I&#39;m not sure how easy it is to add extra information to the join table with HABTM."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1545354122, "post_id": 53860751, "comment_id": 94603220, "body": "@muistooshort <code>extend</code> can take a complete module as an argument that&#39;s why I suggested it"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545374160, "post_id": 53860751, "comment_id": 94607268, "body": "@engineersmnky I tend to use the extension block (i.e. <code>has_many :things do ... end</code>), convert that to a module, and mix it into something. Seems simpler to me when there are only a couple knobs to frobnicate. That said, creating a module from various bits and pieces and then using <code>extend:</code> to mash it into the association is a nice option to have."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1545270157, "post_id": 53860950, "comment_id": 94570819, "body": "You&#39;re definitely playing around in the same area that I am so you&#39;re making sense. I&#39;ve also been using my <code>ModuleUtil.find_or_create</code> chicanery to avoid the unpleasantness that polymorphic associations do in the database (tying your database to a single application is a bit of an abomination in my mind so things like polymorphic association and STI are rarely applicable). In my case, the <code>Foo::Event</code> class could be generated by <code>acts_as_having</code>. The real underlying idea is to not write boilerplate by hand."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1545275094, "post_id": 53860950, "comment_id": 94571784, "body": "Interesting stuff. Oh that there were a way to have a longer, more detailed discussion. SO Q&amp;A doesn&#39;t quite do it. Would love to hear more."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 4, "last_activity_date": 1545265433, "creation_date": 1545265433, "answer_id": 53860950, "question_id": 53860751, "link": "https://stackoverflow.com/questions/53860751/automatically-creating-missing-join-models/53860950#53860950", "title": "Automatically creating missing join models", "body": "<p>I have no idea if I'm following you or not. So, if this is way off target, please say so and I'll delete. </p>\n\n<p>Focusing in on the join model bit, I also got tired of that flim flam. So, I created a model like: </p>\n\n<pre><code>module ActsAsHaving\n  class HasA &lt; ActiveRecord::Base\n    validates :haser_type, :haser_id, :hased_type, :hased_id, presence: true\n    belongs_to :hased, polymorphic: true\n    belongs_to :haser, polymorphic: true\n\n    acts_as_taggable\n\n    def haser=(thing)\n      self.haser_type = thing.class.name\n      self.haser_id   = thing.id\n    end\n\n    def haser\n      haser_type.constantize.find_by(id: haser_id)\n    end\n\n    def hased=(thing)\n      self.hased_type = thing.class.name\n      self.hased_id   = thing.id\n    end\n\n    def hased\n      hased_type.constantize.find_by(id: hased_id)\n    end\n\n  end\nend\n</code></pre>\n\n<p>I didn't use the built-in accessors and validations because I sometimes use this to join non-AR records (which I grab from remote API services some of which belong to me and some of which don't but that's a longer story).</p>\n\n<p>Anyway, I then wrote an <code>acts_as_having</code> macro that let me do stuff like: </p>\n\n<pre><code>class Person &lt; ActiveRecord::Base\n\n  acts_as_having :health_events, class_name: \"Foo::Event\", tag_with: \"health_event\", remote: true\n  acts_as_having :program_events, class_name: \"Foo::Event\", tag_with: \"program_event\", remote: true\n  acts_as_having :email_addresses, :phone_numbers, :physical_addresses\n\nend\n</code></pre>\n\n<p>Which gives me stuff like: </p>\n\n<pre><code>@person.email_addresses\n@person.email_addresses &lt;&lt; @email_address \netc...\n</code></pre>\n\n<p>I can do the inverse like:</p>\n\n<pre><code>class EmailAddress &lt; ActiveRecord::Base\n\n  acts_as_had_by :person\n\nend\n</code></pre>\n\n<p>Which gives me stuff like: </p>\n\n<pre><code>@email_address.person\netc...\n</code></pre>\n\n<p>Then, I wrapped all that junk up into a gem. Now I rarely create join models unless they have some specific requirements that I can't shoe horn into my <code>acts_as_having</code> bit. </p>\n\n<p>Anyway, I don't know if it's playing with fire or not. I don't even know if I'm making sense or addressing your concept. But, I started my gem about three years ago and I haven't regretted it. So, there's that.</p>\n"}], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 53860950, "answer_count": 1, "score": 1, "last_activity_date": 1545265433, "creation_date": 1545263678, "question_id": 53860751, "link": "https://stackoverflow.com/questions/53860751/automatically-creating-missing-join-models", "title": "Automatically creating missing join models", "body": "<p>Lately I've grown weary of littering my <code>app/models</code> directory with pointless boilerplate models such as:</p>\n\n<ul>\n<li>Join models that always contain a couple <code>belongs_to</code>s and nothing else.</li>\n<li>Status log models that just <code>include SomeConcern</code> and make a couple macro calls.</li>\n<li>Revision tracking models that again, just include a concern and call a macro.</li>\n</ul>\n\n<p>These models only exist to support <code>has_many</code> and <code>has_many ... through:</code> associations.</p>\n\n<p>Adding model concerns that generate these models as needed clears simplifies the <code>app/models</code> directory. So instead of:</p>\n\n<pre><code>has_many :model_things\nhas_many :things, through: :model_things\n</code></pre>\n\n<p>and a trivial <code>app/models/model_thing.rb</code> that says:</p>\n\n<pre><code>class ModelThing &lt; ApplicationRecord\n  belongs_to :model\n  belongs_to :thing\nend\n</code></pre>\n\n<p>I can have a <code>ThingSupport</code> concern with a <code>has_things</code> macro that:</p>\n\n<ol>\n<li><p>Creates the <code>has_many :model_things</code> association based on the class name and some options to <code>has_things</code>.</p></li>\n<li><p>Creates the <code>has_many :things, through: :model_things</code> association.</p></li>\n<li><p>Find or create the <code>Model::Thing</code> (see below for why this name is used) class with a call like:</p>\n\n<pre><code> ModuleUtil.find_or_create(join_model_name) do\n  Class.new(ApplicationRecord) do\n    # Set the table name, call belongs_to as needed, call concern methods, ...\n  end\nend\n</code></pre>\n\n<p>where <code>ModuleUtil.find_or_create</code> is a simple method that uses <code>String#constantize</code> to find the desired module (if it exists) or create it using the block and <code>Object#const_set</code> if it can't be found.</p></li>\n</ol>\n\n<p>All the model and association names can be built using the usual Rails conventions from the caller's class name and some options to <code>has_things</code> for special cases.</p>\n\n<p>The question is am I playing with fire here? What can go wrong with this sort of chicanery?</p>\n\n<p>One problem that I've already come across is that the model classes that are generated don't exist on their own so they cannot be directly referenced from an ActiveJob (such as a <code>deliver_later</code> mailer). For example, if loading <code>Model</code> creates the <code>ModelThing</code> association model then you can't reference a <code>ModelThing</code> in a mailer argument because ActiveJob won't know that you have to load the <code>Model</code> class before <code>ModelThing</code> exists. However, this can be solved by using <code>Model::Thing</code> instead so that <code>constantize</code> will look for <code>Model</code> (and find it in <code>app/models/model.rb</code>) before trying to find <code>Model::Thing</code> (which will exist because <code>constantize</code> will have just loaded <code>Model</code> which creates <code>Model::Thing</code>). Am I missing something else?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 2, "creation_date": 1545263207, "post_id": 53860678, "comment_id": 94569394, "body": "It&#39;s usually easier to look at string results with <code>puts</code> because then the output doesn&#39;t include escaping. It gets confusing fast."}, {"owner": {"reputation": 81, "user_id": 3064000, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RjOTM.jpg?s=128&g=1", "display_name": "sthoward", "link": "https://stackoverflow.com/users/3064000/sthoward"}, "reply_to_user": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1545263373, "post_id": 53860678, "comment_id": 94569433, "body": "Hey @GarrettMotzner, yes the <code>puts</code> does display \\&#39;Newegg.com\\&#39; &lt;Promo@email.newegg.com&gt;... but I want to store this exact value."}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1545264001, "post_id": 53860678, "comment_id": 94569565, "body": "By &quot;store this exact value displayed on the last line&quot; do you mean &quot;store the value with the quotes and stuff added by inspect&quot;?"}, {"owner": {"reputation": 81, "user_id": 3064000, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RjOTM.jpg?s=128&g=1", "display_name": "sthoward", "link": "https://stackoverflow.com/users/3064000/sthoward"}, "reply_to_user": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1545268180, "post_id": 53860678, "comment_id": 94570438, "body": "thanks @GarrettMotzner, that helped. Looks like another field in the stored values is the actual issue after I broke it down more as per your below answer."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 3064000, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RjOTM.jpg?s=128&g=1", "display_name": "sthoward", "link": "https://stackoverflow.com/users/3064000/sthoward"}, "edited": false, "score": 0, "creation_date": 1545263557, "post_id": 53860717, "comment_id": 94569466, "body": "thanks, @lenin. See Update 1. I don&#39;t want to display... I want to store that output."}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1545263684, "last_edit_date": 1545263684, "creation_date": 1545263354, "answer_id": 53860717, "question_id": 53860678, "link": "https://stackoverflow.com/questions/53860678/gsub-escaped-double-quote-to-an-escaped-single-quote-in-string/53860717#53860717", "title": "gsub escaped double quote to an escaped single quote in string", "body": "<p>Your actual string doesn't include <code>\\</code></p>\n\n<pre><code>puts \"\\\"Newegg.com\\\" &lt;Promo@email.newegg.com&gt;\"\n&gt; \"Newegg.com\" &lt;Promo@email.newegg.com&gt;\n</code></pre>\n\n<p>This will replace <code>\"</code> with <code>'</code> as you wished:</p>\n\n<pre><code>puts \"\\\"Newegg.com\\\" &lt;Promo@email.newegg.com&gt;\".gsub('\"', \"'\")\n&gt; 'Newegg.com' &lt;Promo@email.newegg.com&gt;\n</code></pre>\n\n<p>If you really wanted <code>\\\"</code>, try another escape character like:</p>\n\n<pre><code>puts \"\\\\\\\"Newegg.com\\\\\\\" &lt;Promo@email.newegg.com&gt;\"\n&gt; \\\"Newegg.com\\\" &lt;Promo@email.newegg.com&gt;\n</code></pre>\n\n<p>Same replace should work:</p>\n\n<pre><code>puts \"\\\\\\\"Newegg.com\\\\\\\" &lt;Promo@email.newegg.com&gt;\".gsub('\"', \"'\")\n&gt; \\'Newegg.com\\' &lt;Promo@email.newegg.com&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "is_accepted": false, "score": 0, "last_activity_date": 1545264690, "last_edit_date": 1545264690, "creation_date": 1545263591, "answer_id": 53860742, "question_id": 53860678, "link": "https://stackoverflow.com/questions/53860678/gsub-escaped-double-quote-to-an-escaped-single-quote-in-string/53860742#53860742", "title": "gsub escaped double quote to an escaped single quote in string", "body": "<p>Looks like your getting a bit confused (understandably so) by the returned result.\nKeep in mind that in irb, the last result is formatted using <code>.inspect</code>, which means that it wraps strings in double quotes, and then escapes characters (backslashes and double quotes)' that would need to be escaped in a double quoted string. This is to distinguish between strings and other values such as numbers, arrays, hashes, etc.</p>\n\n<p>However, that is just the result of inspect. if you use puts to output the value, it will output it without any escaping - it is a more accurate representation of your value.The value displayed by puts is the real value, and what would be stored if you saved the value to a variable.</p>\n\n<p>If you still can't tell what your string looks like, try this:</p>\n\n<pre><code>temp = string.gsub(/\\\"/,%q(\\\\\\'))\n\ntemp.split('')\n=&gt; [\"\\\\\", \"'\", \"N\", \"e\", \"w\", \"e\", \"g\", \"g\", \".\", \"c\", \"o\", \"m\", \"\\\\\", \"'\", \" \", \"&lt;\", \"P\", \"r\", \"o\", \"m\", \"o\", \"@\", \"e\", \"m\", \"a\", \"i\", \"l\", \".\", \"n\", \"e\", \"w\", \"e\", \"g\", \"g\", \".\", \"c\", \"o\", \"m\", \"&gt;\"]\n</code></pre>\n\n<p>This explodes your string into an array of single characters, and can make it easier to see exactly what is in your string. Notice you have a <code>\\</code> character (displayed as <code>\"\\\\\"</code>, but since each string is guaranteed to be exactly one character long, you know it is being displayed that way because of inspect) and a <code>'</code> character at the beginning. </p>\n"}], "owner": {"reputation": 81, "user_id": 3064000, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RjOTM.jpg?s=128&g=1", "display_name": "sthoward", "link": "https://stackoverflow.com/users/3064000/sthoward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545288528, "creation_date": 1545262937, "last_edit_date": 1545288528, "question_id": 53860678, "link": "https://stackoverflow.com/questions/53860678/gsub-escaped-double-quote-to-an-escaped-single-quote-in-string", "title": "gsub escaped double quote to an escaped single quote in string", "body": "<p>I have the following input string:</p>\n\n<pre><code>string = \"\\\"Newegg.com\\\" &lt;Promo@email.newegg.com&gt;\"\n</code></pre>\n\n<p>I want to replace the <code>\\\"</code> with <code>\\'</code>. I tried this:</p>\n\n<pre><code>string.gsub(/\\\"/) {|i| \"\\\\'\" }\n# =&gt; \"\\\\'Newegg.com\\\\' &lt;Promo@email.newegg.com&gt;\"\n\nstring.gsub(/\\\"/,%q(\\\\\\'))\n# =&gt; \"\\\\'Newegg.com\\\\' &lt;Promo@email.newegg.com&gt;\"\n</code></pre>\n\n<p>In both ways, it actually has two instances of <code>\\</code>, but I want only one. It seems to be an issue with the backslash and escaping b/c this works otherwise:</p>\n\n<pre><code>string.gsub(/\\\"/,%q('))\n# =&gt; \"'Newegg.com' &lt;Promo@email.newegg.com&gt;\"\n</code></pre>\n\n<p>-- Update 1--\nyes, puts does display the \"correct\" value</p>\n\n<pre><code>temp = string.gsub(/\\\"/,%q(\\\\\\'))\n# =&gt; \"\\\\'Newegg.com\\\\' &lt;Promo@email.newegg.com&gt;\"\nputs temp\n# &gt;&gt; \\'Newegg.com\\' &lt;Promo@email.newegg.com&gt;\n</code></pre>\n\n<p>but I want to store this exact value displayed on the last line. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mailer"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 2, "creation_date": 1545261319, "post_id": 53860431, "comment_id": 94568899, "body": "I think the error comes from <code>link_to promo_url</code>, what&#39;s <code>promo_url</code> ?, shouldn&#39;t that be <code>promo.url</code> ?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 2, "creation_date": 1545261654, "post_id": 53860431, "comment_id": 94568993, "body": "You need to do <code>link_to promo_url(promo)</code>. That&#39;s a member route so it requires an <code>:id</code>, and Rails can&#39;t provide the id without an object to tell it what id to use."}, {"owner": {"reputation": 349, "user_id": 7915241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3903b2d1221e55e6fb21f0842390cd50?s=128&d=identicon&r=PG&f=1", "display_name": "Juanse Cora", "link": "https://stackoverflow.com/users/7915241/juanse-cora"}, "edited": false, "score": 0, "creation_date": 1545264247, "post_id": 53860431, "comment_id": 94569631, "body": "Guys, you both were right. I added no parameters. It is specifically moveson&#39;s answer. Thanks for your help."}, {"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "edited": false, "score": 0, "creation_date": 1545269336, "post_id": 53860431, "comment_id": 94570671, "body": "Make this an answer to mark as answered"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1545276495, "post_id": 53860431, "comment_id": 94572048, "body": "@JuanseCora I submitted it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 1, "last_activity_date": 1545276462, "creation_date": 1545276462, "answer_id": 53862047, "question_id": 53860431, "link": "https://stackoverflow.com/questions/53860431/action-view-error-in-ruby-on-rails-mailer/53862047#53862047", "title": "Action view error in Ruby on Rails Mailer", "body": "<p>You need to do <code>link_to promo_url(promo)</code>. The helper method <code>promo_url</code> is a member route, so it requires an <code>:id</code>, and Rails can't provide the id without an object to tell it what id to use.</p>\n"}], "owner": {"reputation": 349, "user_id": 7915241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3903b2d1221e55e6fb21f0842390cd50?s=128&d=identicon&r=PG&f=1", "display_name": "Juanse Cora", "link": "https://stackoverflow.com/users/7915241/juanse-cora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53862047, "answer_count": 1, "score": 0, "last_activity_date": 1545276462, "creation_date": 1545261043, "question_id": 53860431, "link": "https://stackoverflow.com/questions/53860431/action-view-error-in-ruby-on-rails-mailer", "title": "Action view error in Ruby on Rails Mailer", "body": "<p>I am trying to code a weekly digest as the ones used by quora or medium.</p>\n\n<p>I want to sent a weekly selection of promos to a verified list of suscribers. To do that, I plan to create the mailer, and a rake task that I will run weekly.</p>\n\n<p>I keep getting an error about the template of @promos, which I have check to be in place.</p>\n\n<p><strong>Task.rake</strong></p>\n\n<pre><code>desc 'send digest email'\ntask send_weekly_email: :environment  do\n\n  @promociones = Promo.where(\"validez &lt;= ?\", Time.zone.now).order(\"created_at DESC\")\n  @suscriptors = Suscriptor.where(email_confirmation: true)\n\n  @suscriptors.each do |suscriptor|\n      WeeklyDigestMailer.weekly_promos(suscriptor, @promociones).deliver_now\n  end\nend\n</code></pre>\n\n<p><strong>WeeklyDigestMailer</strong></p>\n\n<pre><code>class WeeklyDigestMailer &lt; ApplicationMailer\n  default :from =&gt; \"info@adeter.org\"\n  # Subject can be set in your I18n file at config/locales/en.yml\n  # with the following lookup:\n  #\n  #   en.weekly_digest_mailer.weekly_promos.subject\n  #\n  def weekly_promos(suscriptor, promos)\n      @promos = promos\n      mail(:to =&gt; \"&lt;#{suscriptor.email}&gt;\", :subject =&gt; \"Mercadillo digital semanal de Guia#{ENV['CURRENT_CITY_CAP']}.es\")\n  end\nend\n</code></pre>\n\n<p><strong>weekly_promos.html.erb</strong></p>\n\n<pre><code>&lt;p&gt;\n  &lt;% @promos.each do |promo| %&gt;\n\n      &lt;% link_to promo_url do %&gt;\n\n      &lt;p&gt;&lt;h2&gt;&lt;%= promo.title %&gt;&lt;/h2&gt;&lt;/p&gt;\n      &lt;p&gt;&lt;%= promo.texto %&gt;&lt;/p&gt;\n      &lt;p&gt;&lt;%= promo.imgpromo %&gt;&lt;/p&gt;\n      &lt;p&gt;hasta: &lt;span&gt;&lt;%= promo.validez %&gt;&lt;/span&gt; &lt;/p&gt; --&gt;\n\n     &lt;% end %&gt;\n\n  &lt;% end %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>Rake::Task['send_weekly_email'].execute\n<strong>Console output</strong></p>\n\n<pre><code>  Suscriptor Load (0.2ms)  SELECT \"suscriptors\".* FROM \"suscriptors\" WHERE \"suscriptors\".\"email_confirmation\" = $1  [[\"email_confirmation\", \"t\"]]\n  Rendering weekly_digest_mailer/weekly_promos.html.erb within layouts/mailer\n  Promo Load (2.0ms)  SELECT \"promos\".* FROM \"promos\" WHERE (validez &lt;= '2018-12-19 22:37:51.784767') ORDER BY \"promos\".\"created_at\" DESC, created_at DESC\n  Rendered weekly_digest_mailer/weekly_promos.html.erb within layouts/mailer (15.4ms)\nWeeklyDigestMailer#weekly_promos: processed outbound mail in 25.4ms\nActionView::Template::Error: No route matches {:action=&gt;\"show\", :controller=&gt;\"promos\"} missing required keys: [:id]\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby", "post"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545256486, "post_id": 53859200, "comment_id": 94567270, "body": "Can you clarify your question? Are you saying you want to visit <code>example.com&#47;page1.asp</code> programmatically, and on that page there is a form that you want to submit, and then after you submit that form you expect to be redirected to a different page, and on that different page there is another form that you want to submit, and after submitting you expect it to send you <code>example.xlsx</code>?"}, {"owner": {"reputation": 11, "user_id": 10812861, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pHw-eObvzIw/AAAAAAAAAAI/AAAAAAAAAzA/NTdlz6sOhWE/photo.jpg?sz=128", "display_name": "Calvin Cartano", "link": "https://stackoverflow.com/users/10812861/calvin-cartano"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545321984, "post_id": 53859200, "comment_id": 94591583, "body": "I visit the first page which has a form. Ive used my code above to submit the first form, which is a post request, so the URL does not change. On the new page, there is a link to download <code>example.xlsx</code> but that download performs a post request also. So I have to do a post request on a post request."}], "answers": [{"tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": false, "score": 0, "last_activity_date": 1545273155, "last_edit_date": 1545273155, "creation_date": 1545270206, "answer_id": 53861434, "question_id": 53859200, "link": "https://stackoverflow.com/questions/53859200/submit-two-post-requests-from-same-url-with-ruby/53861434#53861434", "title": "Submit two POST requests from same URL with Ruby", "body": "<p>You\u2019ll need to read the values from the form and then submit them back:</p>\n\n<pre><code>uri = URI.parse('example.com/download.asp')\nhttps = Net::HTTP.new(uri.host, uri.port)\nhttps.use_ssl = true \nreq = Net::HTTP::Post.new(uri.request_uri)\nreq.set_form_data({\"Submit\" =&gt; \"Download\", \"filename\" =&gt; \"example.xlsx\"})\n</code></pre>\n\n<p>Now, either the response is going to be the file data, in which case we do this:</p>\n\n<pre><code>File.open(\u201cdownload/filepath.xslx\u201d, \u2018w\u2019) do |f|\n  f.write res.body\nend\n</code></pre>\n\n<p>Or, it\u2019s going to redirect you to a new URL and you\u2019ll have to call a GET request once you arrive at the final file.</p>\n"}], "owner": {"reputation": 11, "user_id": 10812861, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pHw-eObvzIw/AAAAAAAAAAI/AAAAAAAAAzA/NTdlz6sOhWE/photo.jpg?sz=128", "display_name": "Calvin Cartano", "link": "https://stackoverflow.com/users/10812861/calvin-cartano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545273155, "creation_date": 1545253938, "question_id": 53859200, "link": "https://stackoverflow.com/questions/53859200/submit-two-post-requests-from-same-url-with-ruby", "title": "Submit two POST requests from same URL with Ruby", "body": "<p>I am trying to submit two POST requests from one page. The code below submits the first form, and leads to the next page at the same URL. </p>\n\n<p>On the next page, I need to activate a download button to get a xlsx file back. </p>\n\n<pre><code>require 'net/https'\nrequire 'uri'\n\nuri = URI.parse('example.com/page1.asp')\nhttps = Net::HTTP.new(uri.host, uri.port)\nhttps.use_ssl = true\nreq = Net::HTTP::Post.new(uri.request_uri)\nreq.set_form_data({\"Firstname\" =&gt; \"name\", \"Lastname\" =&gt; \"lname\", \"submit1\" =&gt; \"Submit\"})\n\n\nputs res.body\n</code></pre>\n\n<p>This is the section that is returned from <code>puts res.body</code> I'm looking for:</p>\n\n<pre><code>&lt;form  action=\"download.asp\" method=\"post\"  &gt;\n&lt;input type=\"submit\" value=\"Download\"  name=\"Submit\" /&gt;\n&lt;input type =\"hidden\" value=\"example.xlsx\"  name=\"filename\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Is there a way to trigger the Submit button, and then the Download button with ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "devise", "axios"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1545250184, "post_id": 53858443, "comment_id": 94564723, "body": "Would you please be so kind as to replace all the images with the actual text? Images can be difficult to view on some devices. And, images make it impossible to copy code into answers in which case you are asking us to view all your images, find potential problems, generate potential solutions, and retype corrected code in our answers. Which is not all that much fun."}, {"owner": {"reputation": 1, "user_id": 10252674, "user_type": "registered", "profile_image": "https://graph.facebook.com/1999972406700395/picture?type=large", "display_name": "Dallas Parker", "link": "https://stackoverflow.com/users/10252674/dallas-parker"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1545254136, "post_id": 53858443, "comment_id": 94566325, "body": "I&#39;d be happy to! I&#39;m still new at this. When I tried the first time (to put just the code in) it didn&#39;t seem to recognize it as actual code. Maybe because it was Ruby, I&#39;m not sure. Suggestions, so that the indentation/highlighting is maintained? I&#39;ll fiddle with it in the meanwhile."}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1545262744, "post_id": 53858443, "comment_id": 94569265, "body": "Your <code>binding.pry</code> is never reached because of the halt that&#39;s happening. The <code>authenticate_user!</code> is returning the <code>401</code>, hence you&#39;ll never get to your <code>pry.</code> In short, it looks like you&#39;re not logged in."}, {"owner": {"reputation": 1, "user_id": 10252674, "user_type": "registered", "profile_image": "https://graph.facebook.com/1999972406700395/picture?type=large", "display_name": "Dallas Parker", "link": "https://stackoverflow.com/users/10252674/dallas-parker"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1545262855, "post_id": 53858443, "comment_id": 94569300, "body": "@jvillian Unfortunately, I&#39;ve closed/repoened the terminal since then. Copy/pasting the terminal output wouldn&#39;t help debug the issues anyway. A more productive approach would be to read over the information and add suggestions based on your own experience."}, {"owner": {"reputation": 1, "user_id": 10252674, "user_type": "registered", "profile_image": "https://graph.facebook.com/1999972406700395/picture?type=large", "display_name": "Dallas Parker", "link": "https://stackoverflow.com/users/10252674/dallas-parker"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1545263050, "post_id": 53858443, "comment_id": 94569353, "body": "@fanta You&#39;re right, I came to that same conclusion. On refresh, I&#39;m redirected to login. My confusion is WHY the halt is happening to begin with. It&#39;s a head-scratcher. Whats worse is that when I came back from lunch and tried it again, it was working PERFECTLY fine, without any changes on my part. I still think it would be beneficial to leave the post up for the sake of anyone that might have an explanation as to why its happening in the first place, especially considering the actual problem was never figured out."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10252674, "user_type": "registered", "profile_image": "https://graph.facebook.com/1999972406700395/picture?type=large", "display_name": "Dallas Parker", "link": "https://stackoverflow.com/users/10252674/dallas-parker"}, "edited": false, "score": 0, "creation_date": 1545263941, "post_id": 53860672, "comment_id": 94569551, "body": "That makes sense. Although it doesn\u2019t stand as an answer to the problem itself. Why would it would try that SELECT statement to begin with? I mentioned in the comments above, after getting back from lunch, the POST request started working just fine without me having to make any edits. As far as I know, the SQL side of things is handled by the Axios/Rails/whatever handles that."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1545262897, "creation_date": 1545262897, "answer_id": 53860672, "question_id": 53858443, "link": "https://stackoverflow.com/questions/53858443/hitting-filter-chain-unauthorized-during-post-request-in-react-ruby-on-rail/53860672#53860672", "title": "Hitting &quot;Filter Chain Unauthorized&quot; during POST request, in React / Ruby on Rails Feature", "body": "<p>I note that your console output includes:</p>\n\n<pre><code>User Load (50.0ms) SELECT \"users\".* FROM \"users\" WHERE \"users\".\"uid\" = $1 LIMIT $2 [[\"uid\", \"admin@admin.com\"], [\"LIMIT\", 1]]\n</code></pre>\n\n<p>(notwithstanding any typing errors on my part.)</p>\n\n<p>It appears that you are trying to find the user with a <code>uid</code> of <code>admin@admin.com</code>. In your comments (deleted now, I think), you had said that you don't have such a user. If that's the case, then I assume that is what's causing your:</p>\n\n<pre><code>Filter chain halted as :authenticate_user! rendered or redirected\n</code></pre>\n\n<p>I think I would start with researching that bit.</p>\n"}], "owner": {"reputation": 1, "user_id": 10252674, "user_type": "registered", "profile_image": "https://graph.facebook.com/1999972406700395/picture?type=large", "display_name": "Dallas Parker", "link": "https://stackoverflow.com/users/10252674/dallas-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545262897, "creation_date": 1545249968, "last_edit_date": 1545261610, "question_id": 53858443, "link": "https://stackoverflow.com/questions/53858443/hitting-filter-chain-unauthorized-during-post-request-in-react-ruby-on-rail", "title": "Hitting &quot;Filter Chain Unauthorized&quot; during POST request, in React / Ruby on Rails Feature", "body": "<p>First stack overflow question, so I apologize ahead of time for forgetting things.</p>\n\n<p>Project:</p>\n\n<ul>\n<li>Announcement Feature, which allows admin / moderators to post announcements on website.</li>\n</ul>\n\n<p>Tools/Languages Used:</p>\n\n<ul>\n<li>React / Ruby on Rails, Devise (for login)</li>\n</ul>\n\n<p>History:</p>\n\n<ul>\n<li>The announcement feature was UP and RUNNING; until I added a \"Username\" field to my Announcement table. I properly updated the migration/schema, and made adjustments to the controller, to permit the new field, as well as the React form, to pass the new field into the announcements object.</li>\n</ul>\n\n<p>Error:</p>\n\n<ul>\n<li>After updating migration/schema files with new fields, updating announcement_controller to permit the new field, and updating the React form to capture and POST the new \"Announcement\" object through an AXIOS POST request, I get the following error: \"Filter chain halted as :authenticate_user! rendered or redirected\" 401 unauthorized, etc. </li>\n</ul>\n\n<p>Things I've Tried So Far:</p>\n\n<ul>\n<li><p>I've verified all the data the SHOULD be in the announcement object, just before being pushed through the POST request, is where it should be. (See images below)</p></li>\n<li><p>I tried using a Binding.Pry, which works like Javascript's \"Debugger\" except for Ruby, but my binding.pry wasn't stopping ANYWHERE in the announcements controller, which leads me to believe the POST request isn't even making it to the announcements_controller before the error below.</p></li>\n<li><p>I've verified the Announcements table is what it should be.</p></li>\n<li><p>I've set the new field to to be permitted in the announcement_controller</p></li>\n</ul>\n\n<p>Code Examples / Images:</p>\n\n<p>handleSubmit POST request</p>\n\n<pre><code>  handleSubmit = (announcement) =&gt; { axios.post(`/api/announcements`, announcement)}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XAfqj.png\" rel=\"nofollow noreferrer\">Contents of \"announcement\" JUST before being passed into handleSubmit()</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fXLA3.png\" rel=\"nofollow noreferrer\">Filter Chain Halted as :authenticate_user! rendered or redirect: Error Message AFTER POST request</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2ARsf.png\" rel=\"nofollow noreferrer\">Announcements schema / database / table</a></p>\n\n<p>ActiveRecord::Schema.define(version: 2018_12_19_224825) do</p>\n\n<pre><code>    # These are extensions that must be enabled in order to support this \n  database\n    enable_extension \"plpgsql\"\n\n    create_table \"accounts\", force: :cascade do |t|\n      t.string \"account_name\"\n      t.bigint \"users_id\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.index [\"users_id\"], name: \"index_accounts_on_users_id\"\n    end\n\n    create_table \"announcements\", force: :cascade do |t|\n      t.string \"body\"\n      t.bigint \"user_id\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.index [\"user_id\"], name: \"index_announcements_on_user_id\"\n    end\n\n    create_table \"games\", force: :cascade do |t|\n      t.string \"game_name\"\n      t.bigint \"accounts_id\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.index [\"accounts_id\"], name: \"index_games_on_accounts_id\"\n    end\n\n    create_table \"team_has_tournaments\", force: :cascade do |t|\n      t.bigint \"tournament_id\"\n      t.bigint \"team_id\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.index [\"team_id\"], name: \"index_team_has_tournaments_on_team_id\"\n      t.index [\"tournament_id\"], name: \"index_team_has_tournaments_on_tournament_id\"\n    end\n\n    create_table \"teams\", force: :cascade do |t|\n      t.string \"team_name\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n    end\n\n    create_table \"tournaments\", force: :cascade do |t|\n      t.text \"tournament_description\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.string \"tournament_name\"\n    end\n\n    create_table \"user_has_teams\", force: :cascade do |t|\n      t.bigint \"user_id\"\n      t.bigint \"team_id\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.index [\"team_id\"], name: \"index_user_has_teams_on_team_id\"\n      t.index [\"user_id\"], name: \"index_user_has_teams_on_user_id\"\n    end\n\n    create_table \"users\", force: :cascade do |t|\n      t.string \"provider\", default: \"email\", null: false\n      t.string \"uid\", default: \"\", null: false\n      t.string \"encrypted_password\", default: \"\", null: false\n      t.string \"reset_password_token\"\n      t.datetime \"reset_password_sent_at\"\n      t.boolean \"allow_password_change\", default: false\n      t.datetime \"remember_created_at\"\n      t.integer \"sign_in_count\", default: 0, null: false\n      t.datetime \"current_sign_in_at\"\n      t.datetime \"last_sign_in_at\"\n      t.string \"current_sign_in_ip\"\n      t.string \"last_sign_in_ip\"\n      t.string \"confirmation_token\"\n      t.datetime \"confirmed_at\"\n      t.datetime \"confirmation_sent_at\"\n      t.string \"unconfirmed_email\"\n      t.string \"firstName\"\n      t.string \"lastName\"\n      t.string \"username\"\n      t.string \"image\"\n      t.string \"email\"\n      t.json \"tokens\"\n      t.datetime \"created_at\", null: false\n      t.datetime \"updated_at\", null: false\n      t.integer \"level\", default: 1\n      t.index [\"confirmation_token\"], name: \"index_users_on_confirmation_token\", unique: true\n      t.index [\"email\"], name: \"index_users_on_email\", unique: true\n      t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n      t.index [\"uid\", \"provider\"], name: \"index_users_on_uid_and_provider\", unique: true\n    end\n\n    add_foreign_key \"accounts\", \"users\", column: \"users_id\"\n    add_foreign_key \"announcements\", \"users\"\n    add_foreign_key \"games\", \"accounts\", column: \"accounts_id\"\n    add_foreign_key \"team_has_tournaments\", \"teams\"\n    add_foreign_key \"team_has_tournaments\", \"tournaments\"\n    add_foreign_key \"user_has_teams\", \"teams\"\n    add_foreign_key \"user_has_teams\", \"users\"\n  end\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MLD7x.png\" rel=\"nofollow noreferrer\">Announcements controller that should be handling POST request (1)</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/JXgKp.png\" rel=\"nofollow noreferrer\">Announcements controller that should be handling POST request (2)</a></p>\n\n<pre><code>    class Api::AnnouncementsController &lt; ApplicationController\n    before_action :set_announcement, only: [:show, :update, :destroy]\n\n    def index\n      render json: Announcement.all.order(\"created_at DESC\")\n    end\n\n    def show\n      render json: @announcement\n    end\n\n\n    def new\n      @announcement = Announcement.new\n    end\n\n    def edit\n    end\n\n    def create\n      announcement = Announcement.new(announcement_params)\n\n      if announcement.save\n        render json: build_announcement(announcement)\n      else\n        render json: announcement.errors, status: 422\n      end\n    end\n\n    def update\n      if @announcement.update(announcement_params)\n        render json: @announcement\n      else\n        render json: @announcement.errors, status: 422\n      end\n    end\n\n    def destroy\n      @announcement.destroy\n    end\n\n    private\n\n    def build_announcement(announcement)\n      {\n        id: announcement.id,\n        body: announcement.body,\n        username: announcement.username,\n        user_id: announcement.user_id,\n        created_at: announcement.created_at,\n        updated_at: announcement.updated_at,\n      }\n    end\n\n    def set_announcement\n      @announcement = Announcement.find(params[:id])\n    end\n\n    def announcement_params\n      params.require(:announcement).permit(:body, :username, :user_id)\n    end\n    end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545266549, "post_id": 53857697, "comment_id": 94570123, "body": "Note that <code>gets</code> returns a string, so you need <code>n = gets.to_i</code>. Also <code>gets</code> always appends <code>&quot;\\n&quot;</code> to the end of the string entered by the user, so in other other applications you often need to remove that character. For example, if <code>&quot;cats&quot;</code> is entered, <code>str = gets #=&gt; &quot;cats\\n&quot;</code>, whereas <code>str = gets.chomp #=&gt; &quot;cats&quot;</code>. <code>chomp</code> is not needed when <code>to_i</code> is used because <code>to_i</code> stops converting the string as soon as a character is encountered that is not a digit. For example, <code>&quot;314159abc\\n&quot;.to_i #=&gt; &quot;314159&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "edited": false, "score": 0, "creation_date": 1545248743, "post_id": 53857928, "comment_id": 94564123, "body": "The first method doesnt seem to work. n is not defined in seq(n*4-2). Replacing it with num gives an incorrect answer"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "edited": false, "score": 0, "creation_date": 1545249147, "post_id": 53857928, "comment_id": 94564318, "body": "@RafehIshtiaq the <code>n</code> should have been <code>num</code> that was a typo. What do you mean an incorrect answer you said <i>&quot;if i enter 2 the o/p should be [2, 6, 22, 86, 342]&quot;</i> and <code>seq(2) #=&gt; [2, 6, 22, 86, 342]</code>"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 3, "last_activity_date": 1545249018, "last_edit_date": 1545249018, "creation_date": 1545247432, "answer_id": 53857928, "question_id": 53857697, "link": "https://stackoverflow.com/questions/53857697/recursive-sequence-of-integers/53857928#53857928", "title": "Recursive sequence of integers", "body": "<p>This should do it for you:</p>\n\n<pre><code>def seq(num,limit=5) \n  return [] if limit &lt; 1\n  [num] + seq(num*4-2,limit - 1)\nend\n</code></pre>\n\n<p>Then </p>\n\n<pre><code>seq(2,5)\n#=&gt; [2, 6, 22, 86, 342]\n</code></pre>\n\n<p>I would add some kind of an explanation but I am not really sure what to say. This is a recursive version of your proposed methodology.</p>\n\n<p>We could also make this an Enumerator like so </p>\n\n<pre><code>enum= -&gt;(num) { Enumerator.new do |y|\n                  loop do \n                    y &lt;&lt; num \n                    num = num*4-2\n                  end\n                end } \nseq = enum.(2)\nseq.take(7)\n#=&gt; [2, 6, 22, 86, 342, 1366, 5462]\nenum.(3).take(4)\n#=&gt; [3, 10, 38, 150]\n</code></pre>\n\n<p>Not exactly recursive per se but it is a common practice for building a number generator that can be reused.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": -1, "last_activity_date": 1545253908, "creation_date": 1545253908, "answer_id": 53859192, "question_id": 53857697, "link": "https://stackoverflow.com/questions/53857697/recursive-sequence-of-integers/53859192#53859192", "title": "Recursive sequence of integers", "body": "<p>Other option:</p>\n\n<pre><code>def sequence(n, res=[])\n  return res if res.size == 5\n  sequence(n*4-2, res &lt;&lt; n)\nend\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 53857928, "answer_count": 2, "score": 0, "last_activity_date": 1545286515, "creation_date": 1545246374, "last_edit_date": 1545286515, "question_id": 53857697, "link": "https://stackoverflow.com/questions/53857697/recursive-sequence-of-integers", "title": "Recursive sequence of integers", "body": "<p>I want to generate a sequence of integers using recursion. If I enter <code>2</code>, the o/p should be <code>[2, 6, 22, 86, 342]</code>. I want to achieve this by using a recursive function. I have done the following using iteration:</p>\n\n<pre><code>n = gets\ni = 0\na = Array.new\na.push(n)\nwhile i &lt; 4\n  n = n * 4 - 2\n  a.push(n)\n  i = i + 1\nend\np a\n</code></pre>\n\n<p>What changes should be made?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 1, "creation_date": 1545246264, "post_id": 53857444, "comment_id": 94563093, "body": "can you show the <code>Post.per_page</code> method definition please and tell me... when you load the app what is the value of <code>@per_page</code> variable? try to print it on the view with  <code>puts @per_page.inspect</code> and tell me what is the result on the first load"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10697391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a0b74e390d94493896646718c87c5e9?s=128&d=identicon&r=PG&f=1", "display_name": "O. Zak", "link": "https://stackoverflow.com/users/10697391/o-zak"}, "edited": false, "score": 0, "creation_date": 1545248614, "post_id": 53857759, "comment_id": 94564050, "body": "Hey psantos, thanks for the response. I tried your code but the issue is the same."}, {"owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "reply_to_user": {"reputation": 1, "user_id": 10697391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a0b74e390d94493896646718c87c5e9?s=128&d=identicon&r=PG&f=1", "display_name": "O. Zak", "link": "https://stackoverflow.com/users/10697391/o-zak"}, "edited": false, "score": 0, "creation_date": 1545248763, "post_id": 53857759, "comment_id": 94564133, "body": "@O.Zak take a look at my comments at your post"}], "tags": [], "owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "is_accepted": false, "score": 0, "last_activity_date": 1545246663, "creation_date": 1545246663, "answer_id": 53857759, "question_id": 53857444, "link": "https://stackoverflow.com/questions/53857444/ruby-on-rails-show-default-result-before-using-dropdown-filter-with-will-pagina/53857759#53857759", "title": "Ruby on Rails: Show default result before using dropdown filter with will_paginate", "body": "<p>Try this code:</p>\n\n<pre><code>@per_page = params[:per_page] || Post.per_page\n@posts= Post.paginate(per_page: @per_page, page: params[:page])\n</code></pre>\n\n<p>Note that I call paginate without on <code>Post</code> class itself and not on result of <code>Post.all</code>.</p>\n\n<p>I also removed the last <code>|| 10</code> part. I think you don't need it there as you already set this value on <code>Post</code> model.</p>\n"}], "owner": {"reputation": 1, "user_id": 10697391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a0b74e390d94493896646718c87c5e9?s=128&d=identicon&r=PG&f=1", "display_name": "O. Zak", "link": "https://stackoverflow.com/users/10697391/o-zak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545249276, "creation_date": 1545245202, "last_edit_date": 1545249276, "question_id": 53857444, "link": "https://stackoverflow.com/questions/53857444/ruby-on-rails-show-default-result-before-using-dropdown-filter-with-will-pagina", "title": "Ruby on Rails: Show default result before using dropdown filter with will_paginate", "body": "<p>I can display the results by 10, 15, or 20 by using a drop-down. The issue is when the app loads it displays all results. I would like to display only 10 results by default before using the drop-down filter to display more results. </p>\n\n<p>Can someone help please? </p>\n\n<p>Thank you! </p>\n\n<p>This is my VIEW:</p>\n\n<pre><code>&lt;%= select_tag :per_page, options_for_select([10,15,20], @per_page), :onchange =&gt; \"if(this.value){window.location='?per_page='+this.value;}\" %&gt;\n</code></pre>\n\n<p>This is my CONTROLLER: </p>\n\n<pre><code>@per_page = params[:per_page] || Post.per_page\n    @posts= Post.all.paginate(:per_page =&gt; @per_page, :page =&gt; params[:page])\n</code></pre>\n"}, {"tags": ["ios", "ruby", "macos", "cocoapods"], "comments": [{"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 0, "creation_date": 1545245771, "post_id": 53857166, "comment_id": 94562859, "body": "Format question properly please."}, {"owner": {"reputation": 17713, "user_id": 1801544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CcSB.jpg?s=128&g=1", "display_name": "Larme", "link": "https://stackoverflow.com/users/1801544/larme"}, "edited": false, "score": 0, "creation_date": 1545249341, "post_id": 53857166, "comment_id": 94564396, "body": "macOs version? <a href=\"https://stackoverflow.com/questions/53856625/ruby-error-after-upgrading-os-to-mojave-and-installing-xcode-10-1\" title=\"ruby error after upgrading os to mojave and installing xcode 10 1\">stackoverflow.com/questions/53856625/&hellip;</a> ?"}, {"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 0, "creation_date": 1545253029, "post_id": 53857166, "comment_id": 94565865, "body": "I agree: use rbenv to install an up to date Ruby. I find the Mac OS ruby 2.3.0 pretty much useless."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545255676, "post_id": 53857166, "comment_id": 94566968, "body": "Install RVM with <code>\\curl -sSL https:&#47;&#47;get.rvm.io | bash -s stable</code>; install Ruby with <code>rvm install 2.5.3</code>. <a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">Don&#39;t</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>."}, {"owner": {"reputation": 135, "user_id": 5722529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IFZUv.jpg?s=128&g=1", "display_name": "Bhavesh Patel", "link": "https://stackoverflow.com/users/5722529/bhavesh-patel"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545279487, "post_id": 53857166, "comment_id": 94572610, "body": "OS version is macOS-Mojave, and @anothermh I have tried given command giving same error."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545279669, "post_id": 53857166, "comment_id": 94572642, "body": "If you&#39;re getting the same exact error then I&#39;m guessing you have not correctly installed RVM. It&#39;s hard to help you when you haven&#39;t explained what you&#39;re doing, how the error gets generated, or asked a question."}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1545393460, "post_id": 53857166, "comment_id": 94615135, "body": "Someone post an <a href=\"https://stackoverflow.com/questions/53856625/ruby-error-after-upgrading-os-to-mojave-and-installing-xcode-10-1\">answer here</a> to this question (that seems this exact one). Have you tried it? <code>running sudo gem update --system 2.7.4</code>"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1545393619, "post_id": 53857166, "comment_id": 94615202, "body": "It seems like downgrading to 2.7.4 is a workaround ..."}], "answers": [{"tags": [], "owner": {"reputation": 4939, "user_id": 201911, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dfca2a252bb0313ec21a60c39abde0f0?s=128&d=identicon&r=PG", "display_name": "jwadsack", "link": "https://stackoverflow.com/users/201911/jwadsack"}, "is_accepted": false, "score": -1, "last_activity_date": 1545923974, "creation_date": 1545923974, "answer_id": 53947239, "question_id": 53857166, "link": "https://stackoverflow.com/questions/53857166/getting-error-cannot-load-such-file-rubygems-core-ext-kernel-warn-loaderror/53947239#53947239", "title": "Getting error cannot load such file -- rubygems/core_ext/kernel_warn (LoadError), when performing any gem command", "body": "<p>This is likely related to issue <a href=\"https://github.com/rubygems/rubygems/issues/2535\" rel=\"nofollow noreferrer\">#2535</a> in rubygems fixed in <a href=\"https://blog.rubygems.org/2018/12/23/3.0.1-released.html\" rel=\"nofollow noreferrer\">release 3.0.1</a>.</p>\n\n<p>Try <code>gem update --system</code></p>\n"}], "owner": {"reputation": 135, "user_id": 5722529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IFZUv.jpg?s=128&g=1", "display_name": "Bhavesh Patel", "link": "https://stackoverflow.com/users/5722529/bhavesh-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 784, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545923974, "creation_date": 1545243800, "last_edit_date": 1545280204, "question_id": 53857166, "link": "https://stackoverflow.com/questions/53857166/getting-error-cannot-load-such-file-rubygems-core-ext-kernel-warn-loaderror", "title": "Getting error cannot load such file -- rubygems/core_ext/kernel_warn (LoadError), when performing any gem command", "body": "<p>I am trying to create cocoa-pod framework and trying to create pod spec file but it is giving following error.</p>\n\n<pre><code>/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- rubygems/core_ext/kernel_warn (LoadError)\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /Library/Ruby/Site/2.3.0/rubygems.rb:1395:in `&lt;top (required)&gt;'\n    from &lt;internal:gem_prelude&gt;:4:in `require'\n    from &lt;internal:gem_prelude&gt;:4:in `&lt;internal:gem_prelude&gt;'\n\nruby -v : ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]\n\nwhich ruby : /usr/bin/ruby\n</code></pre>\n\n<p>I have tried following command, but same result.</p>\n\n<pre><code>\\curl -sSL https://get.rvm.io | bash -s stable \ninstall Ruby with rvm install 2.5.3\n\n    /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- rubygems/core_ext/kernel_warn (LoadError)\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /Library/Ruby/Site/2.3.0/rubygems.rb:1395:in `&lt;top (required)&gt;'\n    from &lt;internal:gem_prelude&gt;:4:in `require'\n    from &lt;internal:gem_prelude&gt;:4:in `&lt;internal:gem_prelude&gt;'\nInstalling requirements for osx.\nUpdating system...........Failed to update Homebrew, follow instructions here:\n    https://github.com/Homebrew/homebrew/wiki/Common-Issues\nand make sure `brew update` works before continuing.\n.\nError running 'requirements_osx_brew_update_system ruby-2.5.3',\nplease read /Users/Bhavesh_Mac/.rvm/log/1545279328_ruby-2.5.3/update_system.log\nRequirements installation failed with status: 1.\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 5079711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-kCSuj4yBA38/AAAAAAAAAAI/AAAAAAAACR0/PK1hqIJ97Mk/photo.jpg?sz=128", "display_name": "Anand Jose", "link": "https://stackoverflow.com/users/5079711/anand-jose"}, "edited": false, "score": 0, "creation_date": 1545244352, "post_id": 53856907, "comment_id": 94562241, "body": "The error happen when i move the data from one  table column to another table column. if it not supported at all how get saved in existing table"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 508, "user_id": 5079711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-kCSuj4yBA38/AAAAAAAAAAI/AAAAAAAACR0/PK1hqIJ97Mk/photo.jpg?sz=128", "display_name": "Anand Jose", "link": "https://stackoverflow.com/users/5079711/anand-jose"}, "edited": false, "score": 0, "creation_date": 1545247803, "post_id": 53856907, "comment_id": 94563753, "body": "It depends on the encoding you&#39;re using and how you&#39;re moving it. Make sure everything is <code>utf8m4b</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1545242645, "creation_date": 1545242645, "answer_id": 53856907, "question_id": 53856883, "link": "https://stackoverflow.com/questions/53856883/how-to-solve-unicode-character-issue-in-mysql-with-rails-functionality/53856907#53856907", "title": "How to solve Unicode character issue in mysql with rails functionality", "body": "<p>You need two things in order for this to work:</p>\n\n<ul>\n<li>All character columns must be set to type <code>utf8mb4</code></li>\n<li>The database connection must be <code>encoding: utf8mb4</code> in your <code>config/database.yml</code></li>\n</ul>\n\n<p>Once both of those are set the data should flow through correctly. There's no alternative but to set the encoding correctly. You can't \"escape\" these as they're valid data, or would be if the column type is <code>utf8mb4</code>. The MySQL database engine is rejecting them as being invalid for that encoding.</p>\n\n<p>MySQL supports 4-byte UTF-8 if and only if you set encoding as <code>utf8mb4</code>. This is unusual as other databases like Postgres do this out of the box without differentiating between 1-3 byte UTF-8 and 4-byte UTF-8.</p>\n"}, {"tags": [], "owner": {"reputation": 508, "user_id": 5079711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-kCSuj4yBA38/AAAAAAAAAAI/AAAAAAAACR0/PK1hqIJ97Mk/photo.jpg?sz=128", "display_name": "Anand Jose", "link": "https://stackoverflow.com/users/5079711/anand-jose"}, "is_accepted": true, "score": 0, "last_activity_date": 1545383408, "creation_date": 1545383408, "answer_id": 53881952, "question_id": 53856883, "link": "https://stackoverflow.com/questions/53856883/how-to-solve-unicode-character-issue-in-mysql-with-rails-functionality/53881952#53881952", "title": "How to solve Unicode character issue in mysql with rails functionality", "body": "<p>Not have an option to escape the data.</p>\n\n<p>but we can set encode type utf8bin for a specific column in db instead of migrate whole db.</p>\n\n<p>Add a migration to change the column</p>\n\n<pre><code>reversible do |dir|\n      dir.up {\n        change_column :transaction_details, :merchant, \"VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_bin\"\n      }\nend\n</code></pre>\n"}], "owner": {"reputation": 508, "user_id": 5079711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-kCSuj4yBA38/AAAAAAAAAAI/AAAAAAAACR0/PK1hqIJ97Mk/photo.jpg?sz=128", "display_name": "Anand Jose", "link": "https://stackoverflow.com/users/5079711/anand-jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 53881952, "answer_count": 2, "score": 0, "last_activity_date": 1545383408, "creation_date": 1545242546, "question_id": 53856883, "link": "https://stackoverflow.com/questions/53856883/how-to-solve-unicode-character-issue-in-mysql-with-rails-functionality", "title": "How to solve Unicode character issue in mysql with rails functionality", "body": "<p>I got an error <code>Mysql2::Error: Incorrect string value: '\\xE0\\xA4\\xAE\\xE0\\xA5\\x81...</code> in log while running a query.</p>\n\n<p>I identified the reason for the error is MySql database not fully support the Unicode character. some blog suggest to migrate the database to utf8mb4.</p>\n\n<p>But i want a solution with minimum change by using rails or ruby functionality. How we can use escape the unicode character before trying write in DB?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "imagemagick", "watermark"], "comments": [{"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 1, "creation_date": 1545245150, "post_id": 53856425, "comment_id": 94562551, "body": "Do you have libpng installed as a delegate in your ImageMagick. <code>convert version</code> should list png. If not, then you do not have png inststalled. Sorry, I do not know Rails. Also do you have a correct path to your PNG image?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545265962, "post_id": 53856425, "comment_id": 94570004, "body": "Please make a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, verifiable example</a>. I looked at the gems <code>image_magick</code>, <code>rmagick</code>, and <code>mini_magick</code> and none of them have a method <code>variant</code>. What kind of object is <code>photo</code>? What gem are you using?"}], "owner": {"reputation": 67, "user_id": 10107025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63537a2a48ca6609d1d04a3b30ab7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10107025/johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545265412, "creation_date": 1545240531, "last_edit_date": 1545265412, "question_id": 53856425, "link": "https://stackoverflow.com/questions/53856425/draw-with-imagemagick-on-rails-not-working-with-png", "title": "Draw with ImageMagick on Rails not working with PNG", "body": "<p>I'm trying to add a watermark on images in a Rails app. It works when the watermark is a JPG but not when it's a PNG.</p>\n\n<pre><code>&lt;% @photo = photo.variant(\n  combine_options: {\n    gravity: 'center',\n    resize: '770x578',\n    draw: 'image Over 0,0 0,0 \"' + Property::WATERMARK_PATH.to_s + '\"'\n  }\n) %&gt;\n</code></pre>\n\n<p>In the model:</p>\n\n<pre><code>WATERMARK_PATH = Rails.root.join('app','assets', 'images', 'watermark.png')\n</code></pre>\n\n<p>Can anyone tell me why that's happening and how to fix it?\nThanks a lot.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "post"], "comments": [{"owner": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 1, "creation_date": 1545239748, "post_id": 53856116, "comment_id": 94560164, "body": "Can you please check if you&#39;re getting valid data in <code>calculation_params</code> ?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545244352, "post_id": 53856116, "comment_id": 94562242, "body": "Can you post the full stack trace?"}, {"owner": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "reply_to_user": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 0, "creation_date": 1545296883, "post_id": 53856116, "comment_id": 94578210, "body": "@mehedi I get valid params. When accessing and printing the members of the calculation object I get correct values."}, {"owner": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545297215, "post_id": 53856116, "comment_id": 94578401, "body": "@engineersmnky updated the post"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "edited": false, "score": 0, "creation_date": 1545302450, "post_id": 53856269, "comment_id": 94581200, "body": "Thank you for your suggestion, but I found out more about how ActiveRecords <a href=\"https://stackoverflow.com/a/33682931/9926929\">work</a> and how to access the fields of it. Together with after_initialize everything works fine. I will now post my own answer and accept it. Thank you nonetheless!"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "reply_to_user": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "edited": false, "score": 0, "creation_date": 1545302715, "post_id": 53856269, "comment_id": 94581334, "body": "@PhilippB upvote is the best <i>thank you</i> you can say."}, {"owner": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "edited": false, "score": 0, "creation_date": 1545303310, "post_id": 53856269, "comment_id": 94581649, "body": "I upvoted, but since I&#39;m low on repution it&#39;s not shown."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 3, "last_activity_date": 1545240287, "last_edit_date": 1545240287, "creation_date": 1545239953, "answer_id": 53856269, "question_id": 53856116, "link": "https://stackoverflow.com/questions/53856116/rails-save-returns-nomethoderror/53856269#53856269", "title": "Rails: :save returns NoMethodError", "body": "<p>Don't override <code>initialize</code> in the <code>AR</code>. It could possibly break a lot of stuff in your models. </p>\n\n<p>You can use <a href=\"https://guides.rubyonrails.org/active_record_callbacks.html#after-initialize-and-after-find\" rel=\"nofollow noreferrer\"><code>after_initialize</code></a>.</p>\n\n<blockquote>\n  <p>The <code>after_initialize</code> callback will be called whenever an Active Record\n  object is instantiated, either by <strong>directly using new or when a record\n  is loaded from the database.</strong> It can be useful to avoid the need to\n  directly override your Active Record <code>initialize</code> method.</p>\n</blockquote>\n\n<pre><code>def after_initialize\n  # Gets called right after Calculation.new\n  # Do some stuff here\nend\n</code></pre>\n\n<p>If you still want to use <code>initialize</code> you must do something like this:</p>\n\n<pre><code>def initialize(attributes = {})\n  super\n  self.attributes = attributes\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1545303193, "creation_date": 1545303193, "answer_id": 53867247, "question_id": 53856116, "link": "https://stackoverflow.com/questions/53856116/rails-save-returns-nomethoderror/53867247#53867247", "title": "Rails: :save returns NoMethodError", "body": "<p>I did find out (thanks to @\u0417\u0435\u043b\u0451\u043d\u044b\u0439), that to create values for the model after creating it (<code>new</code>) I need to use the <code>after_initialize</code> callback Rails provides. Together with <a href=\"https://stackoverflow.com/a/33682931/9926929\">this comment</a> on how to access model instance variables, I was able to achieve the functionality I wanted. \nThe original NoMethodError was a result of my incorrect use of the <code>initialize</code> method. The following code is the final result, which works with the default controller.</p>\n\n<pre><code>require 'digest'\n\nclass Calculation &lt; ApplicationRecord\n\n  @@known_algorithms = ['SHA2_256', 'SHA2_384', 'SHA2_512']\n\n  after_initialize :init\n\n  private\n\n  def init\n    validate!\n    calculate!\n  end\n\n  def calculate!\n    self.hash_value, self.timestamp = digest\n  end\n\n  def digest\n    case algorithm\n    when 'SHA2_256'\n      result = Digest::SHA2.hexdigest(value)\n    when 'SHA2_384'\n      result = Digest::SHA2.new(384).hexdigest(value)\n    when 'SHA2_512'\n      result = Digest::SHA2.new(512).hexdigest(value)\n    end\n    return result, DateTime.now\n  end\n\n  def validate!\n    raise ArgumentError.new('Value cannot be empty or NIL!') if value.nil? or value.empty?\n    raise ArgumentError.new('Unknown hashing algorithm!') unless @@known_algorithms.include? algorithm\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9926929, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d5927SviDzA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1I5me0KD53kmlRTpcwyspPbYGJ2Q/mo/photo.jpg?sz=128", "display_name": "Philipp B", "link": "https://stackoverflow.com/users/9926929/philipp-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53856269, "answer_count": 2, "score": 1, "last_activity_date": 1545303193, "creation_date": 1545239398, "last_edit_date": 1545297156, "question_id": 53856116, "link": "https://stackoverflow.com/questions/53856116/rails-save-returns-nomethoderror", "title": "Rails: :save returns NoMethodError", "body": "<p>I am programming a small rails api for practice. The goal is to POST some data and then save it (after further processing) in a database. The object is being created successfuly. On the save method appears an error which I cannot explain:</p>\n\n<pre><code>NoMethodError (undefined method `[]' for nil:NilClass): app/controllers/api/v1/calculations_controller.rb:19:in `create'\n</code></pre>\n\n<p>It appears in the :create method (on POST):</p>\n\n<pre><code>  # POST /calculations\n  def create\n    @calculation = Calculation.new(calculation_params)\n    if @calculation.save # &lt;- This is line 19\n      render json: @calculation, status: :created, location: @calculation\n    else\n      render json: @calculation.errors, status: :unprocessable_entity\n    end\n  end\n</code></pre>\n\n<p>The model looks like this:</p>\n\n<pre><code>require 'digest'\n\nclass Calculation &lt; ApplicationRecord\n\n  attr_reader :value, :hash_value, :algorithm, :timestamp\n  @@known_algorithms = ['SHA2_256', 'SHA2_384', 'SHA2_512']\n\n  def initialize (params)\n    @value = params[:value]\n    @algorithm = params[:algorithm]\n    validate!\n    @hash_value, @timestamp = digest\n  end\n\n  private\n\n  def digest\n    case @algorithm\n    when 'SHA2_256'\n      result = Digest::SHA2.hexdigest(@value)\n    when 'SHA2_384'\n      result = Digest::SHA2.new(384).hexdigest(@value)\n    when 'SHA2_512'\n      result = Digest::SHA2.new(512).hexdigest(@value)\n    end\n    return result, DateTime.now\n  end\n\n  def validate!\n    raise ArgumentError.new('Value cannot be empty or NIL!') if @value.nil? or @value.empty?\n    raise ArgumentError.new('Unknown hashing algorithm!') unless @@known_algorithms.include? @algorithm\n  end\nend\n</code></pre>\n\n<p>Why does the <code>NoMethodError</code> appear? Did I override some important part in the model class?</p>\n\n<p>Full stack trace as requested:</p>\n\n<pre><code>/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:424:in `clear_transaction_record_state'\n/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:330:in `ensure in rollback_active_record_state!'\n/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:330:in `rollback_active_record_state!'\n/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:309:in `save'\n/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/suppressor.rb:44:in `save'\n/home/pbz/RubymineProjects/hasher_api/app/controllers/api/v1/calculations_controller.rb:20:in `create'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/abstract_controller/base.rb:194:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal/rendering.rb:30:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/abstract_controller/callbacks.rb:42:in `block in process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:132:in `run_callbacks'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/abstract_controller/callbacks.rb:41:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal/rescue.rb:22:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications.rb:168:in `block in instrument'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications/instrumenter.rb:23:in `instrument'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications.rb:168:in `instrument'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal/instrumentation.rb:32:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/railties/controller_runtime.rb:24:in `process_action'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/abstract_controller/base.rb:134:in `process'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal.rb:191:in `dispatch'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_controller/metal.rb:252:in `dispatch'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/routing/route_set.rb:34:in `serve'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/journey/router.rb:52:in `block in serve'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/journey/router.rb:35:in `each'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/journey/router.rb:35:in `serve'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/routing/route_set.rb:840:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/rack-2.0.6/lib/rack/etag.rb:25:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/rack-2.0.6/lib/rack/conditional_get.rb:38:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/rack-2.0.6/lib/rack/head.rb:12:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/activerecord-5.2.2/lib/active_record/migration.rb:559:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:98:in `run_callbacks'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/callbacks.rb:26:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/executor.rb:14:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/railties-5.2.2/lib/rails/rack/logger.rb:38:in `call_app'\n/home/pbz/.gem/ruby/2.5.0/gems/railties-5.2.2/lib/rails/rack/logger.rb:26:in `block in call'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/tagged_logging.rb:71:in `block in tagged'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/tagged_logging.rb:28:in `tagged'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/tagged_logging.rb:71:in `tagged'\n/home/pbz/.gem/ruby/2.5.0/gems/railties-5.2.2/lib/rails/rack/logger.rb:26:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/request_id.rb:27:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/rack-2.0.6/lib/rack/runtime.rb:22:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/activesupport-5.2.2/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/executor.rb:14:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/actionpack-5.2.2/lib/action_dispatch/middleware/static.rb:127:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/rack-2.0.6/lib/rack/sendfile.rb:111:in `call'\n/home/pbz/.gem/ruby/2.5.0/gems/railties-5.2.2/lib/rails/engine.rb:524:in `call'\n/home/pbz/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/configuration.rb:225:in `call'\n/home/pbz/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/server.rb:658:in `handle_request'\n/home/pbz/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/server.rb:472:in `process_client'\n/home/pbz/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/server.rb:332:in `block in run'\n/home/pbz/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/puma-3.12.0/lib/puma/thread_pool.rb:133:in `block in spawn_thread'\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 4, "creation_date": 1545234207, "post_id": 53854577, "comment_id": 94556858, "body": "First split into words. Then check first/last char. Which of those two things is causing a problem?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1545234553, "post_id": 53854577, "comment_id": 94557114, "body": "<i>&quot;to find 1.&quot;</i> \u2013 is there a 2.?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1545234703, "post_id": 53854577, "comment_id": 94557223, "body": "Furthermore, why is your string wrapped in an array? Can there be more than one string? What&#39;s your expected result for the given example?"}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "edited": false, "score": 0, "creation_date": 1545240066, "post_id": 53854577, "comment_id": 94560342, "body": "Correct it is not an array."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1545244441, "post_id": 53854577, "comment_id": 94562290, "body": "Regardless of how you do it, as a first step you may wish to remove any punctuation: <code>&quot;My, oh my!&quot;.gsub(&#47;[[:punct:]]&#47;, &#39;&#39;)  =&gt; &quot;My oh my&quot;</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1545247724, "post_id": 53854577, "comment_id": 94563715, "body": "&quot;I want to check if the first and last letter of each word are same.&quot; What does that mean? Do you wish to return an array containing words that have that property? A count of words having that property?  Display (<code>puts</code>) each word having that property? What about case? Does &quot;Label&quot; have that property? Note that because you stated that the string is a sentence it must contain punctuation, at least a sentence terminator."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1545235027, "post_id": 53854814, "comment_id": 94557452, "body": "Normally in Ruby you&#39;d do this with <code>words.select</code> and move the <code>puts</code> outside of the filtering operation, perhaps chained on with <code>.each</code>"}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "edited": false, "score": 0, "creation_date": 1545239823, "post_id": 53854814, "comment_id": 94560206, "body": "Yep, thats what I was thinking. How would I go about tallying up the total number of words that meet this parameter? Would I need to use .map to create a new array and then count? Or can I do a .split.count?"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "edited": false, "score": 0, "creation_date": 1545246781, "post_id": 53854814, "comment_id": 94563322, "body": "@AlfatahKader Yes <code>split.count</code> (with a block) works. See added answer."}], "tags": [], "owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1545234723, "creation_date": 1545234723, "answer_id": 53854814, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby/53854814#53854814", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<p>This will print out all words that start with and end with the same letter (not case-sensitive)</p>\n\n<pre><code>sentence_one = \"Label the bib numbers in red\"\nwords = sentence_one.split(' ')\n\nwords.each do |word|\n  if word[0].downcase == word[-1].downcase\n    puts word\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545249102, "post_id": 53854952, "comment_id": 94564291, "body": "What about &quot;Label a bib numbers in red&quot;?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545258451, "post_id": 53854952, "comment_id": 94568003, "body": "@CarySwoveland left as an exercise ;-)"}, {"owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "edited": false, "score": 0, "creation_date": 1545282049, "post_id": 53854952, "comment_id": 94573105, "body": "This is a bit advanced but much more detailed."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 4, "last_activity_date": 1545235277, "creation_date": 1545235277, "answer_id": 53854952, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby/53854952#53854952", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<p>You could use a regex:</p>\n\n<pre><code>sentence_one = \"Label the bib numbers in red\"\n\nsentence_one.scan(/(\\b(\\w)\\w*(\\2)\\b)/i)\n#=&gt; [[\"Label\", \"L\", \"l\"], [\"bib\", \"b\", \"b\"]]\n</code></pre>\n\n<p><code>\\b</code> is a word boundary, <code>\\w</code> matches a letter (you may have to adjust this). There are 3 captures: (1) the whole word, (2) the first letter and (3) the last letter. Using <code>\\2</code> requires the last letter to match the first.</p>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 0, "last_activity_date": 1545246704, "creation_date": 1545246704, "answer_id": 53857768, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby/53857768#53857768", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<pre><code>sentence_one = \"Label the bib numbers in red\"\nputs sentence_one.split(' ').count{|word| word[0] == word[-1]} # =&gt; 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1545294084, "last_edit_date": 1545294084, "creation_date": 1545249977, "answer_id": 53858447, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby/53858447#53858447", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<p>In a comment the OP asked how one could obtain a count of words having the desired property. Here's one way to do that. I assume that the desired property is that a word's first and last characters are the same, though possibly of different case. Here is a way to do that that does not produce an intermediate array whose elements would be counted.</p>\n\n<pre><code>r = /\n    \\b            # match a word break\n    (?:           # begin a non-capture group\n      \\p{Alpha}   # match a letter\n      |           # or\n      (\\p{Alpha}) # match a letter in capture group 1\n      \\p{Alpha}*  # match zero or more letters\n      \\1          # match the contents of capture group 1\n    )             # end the non-capture group\n    \\b            # match a word break\n    /ix           # case-indifferent and free-spacing regex definition modes\n\nstr = \"How, now is that a brown cow?\"\n\nstr.gsub(r).count\n  #=&gt; 2\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">String#gsub</a>, in particular the case where there is only one argument and no block is provided.</p>\n\n<p>Note</p>\n\n<pre><code>str.gsub(r).to_a\n  #=&gt; [\"that\", \"a\"]\n\nstr.scan(r)\n  #=&gt; [[\"t\"], [nil]]\n</code></pre>\n\n<p>Sometimes it is awkward to use <code>scan</code> when the regular expression contains capture groups (see <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a>). Those problems often can be avoided by instead using <code>gsub</code> followed by <code>to_a</code> (or <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-entries\" rel=\"nofollow noreferrer\">Enumerable#entries</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 0, "last_activity_date": 1545255150, "creation_date": 1545255150, "answer_id": 53859449, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby/53859449#53859449", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<p>Just to add one option more splitting to array (skipping one letter words):</p>\n\n<pre><code>sentence_one =  \"Label the bib numbers in a red color\"\n\nsentence_one.split(' ').keep_if{ |w| w.end_with?(w[0].downcase) &amp; (w.size &gt; 1) }\n\n#=&gt; [\"Label\", \"bib\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1545286898, "creation_date": 1545286898, "answer_id": 53863406, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby/53863406#53863406", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<pre><code>sentence_one.scan(/\\S+/).select{|s| s[0].downcase == s[-1].downcase}\n# =&gt; [\"Label\", \"bib\"]\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 5219792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207554199792913/picture?type=large", "display_name": "Alfatah Kader", "link": "https://stackoverflow.com/users/5219792/alfatah-kader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 53859449, "answer_count": 6, "score": -1, "last_activity_date": 1545441954, "creation_date": 1545233973, "last_edit_date": 1545441954, "question_id": 53854577, "link": "https://stackoverflow.com/questions/53854577/how-to-check-if-the-first-and-last-character-of-a-word-are-the-same-in-ruby", "title": "How to check if the first and last character of a word are the same in Ruby?", "body": "<p>If I have a string that's a sentence, I want to check if the first and last letter of each word are the same and find which of the words have their first and last letter the same. For example: </p>\n\n<pre><code>sentence_one = \"Label the bib numbers in red.\"\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-lambda"], "comments": [{"owner": {"reputation": 156, "user_id": 10811769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BXs9OUkoq9s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i29HKeaqs8clAJ4OK9bbX7DQOr5A/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10811769/james"}, "edited": false, "score": 0, "creation_date": 1545236738, "post_id": 53854487, "comment_id": 94558503, "body": "Haven&#39;t had a chance to read it entirely yet but seems like I can use Docker to build the gem and its extensions in an environment similar to that which Lambda uses. See <a href=\"https://blog.honeybadger.io/using-ruby-on-aws-lamba/\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 9514635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e774d62ca96d56fc41a4b486cd85d30?s=128&d=identicon&r=PG&f=1", "display_name": "momwhocode", "link": "https://stackoverflow.com/users/9514635/momwhocode"}, "edited": false, "score": 0, "creation_date": 1579785930, "post_id": 54674741, "comment_id": 105888461, "body": "like RUN yum -y install mysql-devel is there any command for postgres10"}], "tags": [], "owner": {"reputation": 121, "user_id": 1437362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/icbsF.jpg?s=128&g=1", "display_name": "Dhanabal", "link": "https://stackoverflow.com/users/1437362/dhanabal"}, "is_accepted": true, "score": 0, "last_activity_date": 1552666234, "last_edit_date": 1552666234, "creation_date": 1550074477, "answer_id": 54674741, "question_id": 53854487, "link": "https://stackoverflow.com/questions/53854487/cannot-load-file-mysql2-on-aws-lambda/54674741#54674741", "title": "Cannot load file mysql2 on AWS Lambda", "body": "<p>Prerequesties:\n* Docker </p>\n\n<p>Create a docker file like this</p>\n\n<pre><code>    FROM lambci/lambda:build-ruby2.5\n    RUN yum -y install mysql-devel\n    RUN gem update bundler\n    CMD \"/bin/bash\"\n</code></pre>\n\n<p>Build the docker</p>\n\n<pre><code>    docker build -t lambda-ruby2.5-mysqldep .\n</code></pre>\n\n<p>Docker run in your source code folder with the below command</p>\n\n<pre><code>    docker run --rm -it -v $PWD:/var/task -w /var/task lambda-ruby2.5-mysqldep\n</code></pre>\n\n<p>It will get you into the bash\nInside the bash</p>\n\n<ul>\n<li>move the mysql folder from /usr/lib64/mysql to /usr/mysql</li>\n<li>mkdir -p /var/task/lib </li>\n<li>cp -a /usr/mysql/<em>.so.</em> /var/task/lib/</li>\n<li>bundle config --local build.mysql --with-mysql-config=/usr/local/mysql/bin/mysql_config</li>\n<li>bundle install with and without deployment</li>\n</ul>\n\n<p>Then exit the bash. And create a lambda deployment package and upload it to AWS. It worked for me</p>\n"}, {"comments": [{"owner": {"reputation": 156, "user_id": 10811769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BXs9OUkoq9s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i29HKeaqs8clAJ4OK9bbX7DQOr5A/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10811769/james"}, "edited": false, "score": 0, "creation_date": 1551083791, "post_id": 54807816, "comment_id": 96495069, "body": "Thanks, Sam. Excellent point on giving the why as well as the how."}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1591376515, "post_id": 54807816, "comment_id": 110042871, "body": "When I bash into the docker container <code>var&#47;task&#47;lib</code> I see the <code>*.so</code> files. But when I exit the docker container I see <code>lib</code> directory is empty. Do I need to map them ? I get <code>libmysqlclient.so.18: cannot open shared object file: No such file or directory</code> when I execute the lambda function. <a href=\"https://stackoverflow.com/questions/62218696/libmysqlclient-so-18-cannot-open-shared-object-file-no-such-file-or-directory\" title=\"libmysqlclient so 18 cannot open shared object file no such file or directory\">stackoverflow.com/questions/62218696/&hellip;</a>"}, {"owner": {"reputation": 438, "user_id": 1713808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aaf6d7ad53a6f469bd5368f06944e9b?s=128&d=identicon&r=PG", "display_name": "Curious Sam", "link": "https://stackoverflow.com/users/1713808/curious-sam"}, "edited": false, "score": 0, "creation_date": 1591460884, "post_id": 54807816, "comment_id": 110067041, "body": "Docker is kinda complicated. I cannot speak for your setup but for me, I used docker-compose for development. I mount my entire code dir into the container in the development environment. I have Makefile for packing the zip file, I perform the copy operation there. Here some observe from my Makefile <code>docker-compose run --rm application cp $(shell docker-compose run --rm application realpath &#47;usr&#47;lib64&#47;libnettle.so.4) .&#47;lib&#47;libnettle.so.4</code> it is not the MySQL library though, but hope this helps."}], "tags": [], "owner": {"reputation": 438, "user_id": 1713808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aaf6d7ad53a6f469bd5368f06944e9b?s=128&d=identicon&r=PG", "display_name": "Curious Sam", "link": "https://stackoverflow.com/users/1713808/curious-sam"}, "is_accepted": false, "score": 2, "last_activity_date": 1550754302, "creation_date": 1550754302, "answer_id": 54807816, "question_id": 53854487, "link": "https://stackoverflow.com/questions/53854487/cannot-load-file-mysql2-on-aws-lambda/54807816#54807816", "title": "Cannot load file mysql2 on AWS Lambda", "body": "<p>Dhanabal's answer works but lets me elaborate more since the answer is too procedural for me.  </p>\n\n<p>Basically, a gem with native extension should build on the same environment as AWS Lambda.<br>\nSo we need to build native extension inside <code>lambci/lambda:build-ruby2.5</code> docker image that mimics Lambda environment.</p>\n\n<p>Also, we need to copy dynamic libraries into the load path.<br>\nFirst, let's find out where can we place the libraries.<br>\n<code>echo $LD_LIBRARY_PATH</code> in the container and you'll get\n<code>/var/lang/lib:/lib64:/usr/lib64:/var/runtime:/var/runtime/lib:/var/task:/var/task/lib:/opt/lib</code>.<br>\nSo, I simply copy the library from <code>/usr/lib64/mysql</code> to <code>[function dir]/lib</code> and deploy.</p>\n\n<p>That's it.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 1157033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa582faa598e30186a55d43678cd3808?s=128&d=identicon&r=PG", "display_name": "user1157033", "link": "https://stackoverflow.com/users/1157033/user1157033"}, "is_accepted": false, "score": 0, "last_activity_date": 1560185301, "creation_date": 1560185301, "answer_id": 56530408, "question_id": 53854487, "link": "https://stackoverflow.com/questions/53854487/cannot-load-file-mysql2-on-aws-lambda/56530408#56530408", "title": "Cannot load file mysql2 on AWS Lambda", "body": "<p>2 things about Dhanabal's answer</p>\n\n<p>1) cp -a /usr/mysql/.so step is missing a *\n2) Make sure there are no sym links in the lib directory, you need actual files because symlinks break after they are zipped up.</p>\n"}], "owner": {"reputation": 156, "user_id": 10811769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BXs9OUkoq9s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i29HKeaqs8clAJ4OK9bbX7DQOr5A/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10811769/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 1, "accepted_answer_id": 54674741, "answer_count": 3, "score": 3, "last_activity_date": 1563779109, "creation_date": 1545233680, "last_edit_date": 1545256605, "question_id": 53854487, "link": "https://stackoverflow.com/questions/53854487/cannot-load-file-mysql2-on-aws-lambda", "title": "Cannot load file mysql2 on AWS Lambda", "body": "<p>Trying to have a Lambda connect to an RDS database but can't get the mysql2 gem to load. Tried the <strong>pristine</strong> instruction but that didn't resolve the issue.</p>\n\n<p>I've got the built mysql2 gem in the vendor directory. Did this using <strong>bundle install --deployment</strong>.</p>\n\n<p>Presumably this is a problem because of the compiled extensions used by mysql2. Not sure how I can sort this for AWS Lambda though. Thoughts?</p>\n\n<p>Here's the log output:</p>\n\n<pre><code>START RequestId: 62f35c49-039f-11e9-be04-1fd1111df42b Version: $LATEST\nIgnoring mysql2-0.5.2 because its extensions are not built. Try: gem pristine mysql2 --version 0.5.2\nInit error when loading handler lambda_function.lambda_handler\n{\n  \"errorMessage\": \"cannot load such file -- mysql2\",\n  \"errorType\": \"Init&lt;LoadError&gt;\",\n  \"stackTrace\": [\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/task/lambda_function.rb:3:in `&lt;top (required)&gt;'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\"\n  ]\n}\nEND RequestId: 62f35c49-039f-11e9-be04-1fd1111df42b\nREPORT RequestId: 62f35c49-039f-11e9-be04-1fd1111df42b  Duration: 1439.17 ms    Billed Duration: 1500 ms    Memory Size: 128 MB Max Memory Used: 17 MB  \nUnknown application error occurred\nInit&lt;LoadError&gt;\n</code></pre>\n\n<p>Here's my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'mysql2', '~&gt; 0.5.2'\ngem 'sequel', '~&gt; 5.15.0'\n</code></pre>\n\n<p>Gemfile.lock</p>\n\n<pre><code>GEM\nremote: https://rubygems.org/\nspecs:\n  mysql2 (0.5.2)\n  sequel (5.15.0)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  mysql2 (~&gt; 0.5.2)\n  sequel (~&gt; 5.15.0)\n\nBUNDLED WITH\n  1.17.2\n</code></pre>\n\n<p>Here's the top of my lambda_function.rb file</p>\n\n<pre><code>require 'json'\nrequire 'logger'\nrequire 'mysql2'\nrequire 'sequel'\n</code></pre>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545235138, "post_id": 53854200, "comment_id": 94557532, "body": "First stop for things like this is the <a href=\"https://github.com/rubygems/rubygems/issues\" rel=\"nofollow noreferrer\">Rubygems issues</a> page, presuming this is actually a bug and not a limitation of newer versions of Rubygems which it appears to be. For historical versions of Ruby you&#39;re stuck with historical versions of Rubygems."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545235200, "post_id": 53854200, "comment_id": 94557578, "body": "Ruby 2.3.0 was released in 2015, so presumably the Rubygems team is moving forward and cutting support for much older versions like 2.1. Ruby updates quickly enough now that updating Rubygems itself manually like this is no longer really necessary. The update procedure is a by-product of the 1.9.2-1.9.3 era where Ruby wasn&#39;t evolving as quickly as Rubygems itself was."}, {"owner": {"reputation": 131, "user_id": 3706827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIAOS.png?s=128&g=1", "display_name": "Felixoid", "link": "https://stackoverflow.com/users/3706827/felixoid"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545235326, "post_id": 53854200, "comment_id": 94557658, "body": "thank you for a link, @tadman. I&#39;ll create an issue. Unfortunately, the 2.1.9 version is the part of puppet 4 and each module should be checked for compatibility with it.  <a href=\"https://github.com/puppetlabs/pdk-templates/blob/master/config_defaults.yml#L71\" rel=\"nofollow noreferrer\">github.com/puppetlabs/pdk-templates/blob/master/&hellip;</a>"}, {"owner": {"reputation": 131, "user_id": 3706827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIAOS.png?s=128&g=1", "display_name": "Felixoid", "link": "https://stackoverflow.com/users/3706827/felixoid"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545295861, "post_id": 53854200, "comment_id": 94577716, "body": "The permanent link to the <a href=\"https://github.com/puppetlabs/pdk-templates/blob/12824103f4b054d2672e3f1ed1f4b9689643ea34/config_defaults.yml#L71\" rel=\"nofollow noreferrer\">broken check</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545321975, "post_id": 53854200, "comment_id": 94591578, "body": "Puppet really needs to get with the program and upgrade to 2.3 as a baseline."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 3706827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIAOS.png?s=128&g=1", "display_name": "Felixoid", "link": "https://stackoverflow.com/users/3706827/felixoid"}, "is_accepted": true, "score": 5, "last_activity_date": 1545295623, "creation_date": 1545295623, "answer_id": 53865161, "question_id": 53854200, "link": "https://stackoverflow.com/questions/53854200/is-gem-update-system-broken-for-ruby-2-3/53865161#53865161", "title": "Is `gem update --system` broken for ruby &lt; 2.3?", "body": "<p>So, there is an <a href=\"https://github.com/rubygems/rubygems/issues/2534\" rel=\"noreferrer\">issue</a>. The requirement for ruby newer or equal to 2.3 is a new reality and everyone has to adopt the project to it. E.g. <a href=\"https://github.com/puppetlabs/pdk-templates/pull/171\" rel=\"noreferrer\">https://github.com/puppetlabs/pdk-templates/pull/171</a>.</p>\n\n<p><strong>TL;DR</strong>: <code>gem update --system 2.7.8</code></p>\n"}], "owner": {"reputation": 131, "user_id": 3706827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIAOS.png?s=128&g=1", "display_name": "Felixoid", "link": "https://stackoverflow.com/users/3706827/felixoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1658, "favorite_count": 0, "accepted_answer_id": 53865161, "answer_count": 1, "score": 4, "last_activity_date": 1546162748, "creation_date": 1545232763, "last_edit_date": 1546162748, "question_id": 53854200, "link": "https://stackoverflow.com/questions/53854200/is-gem-update-system-broken-for-ruby-2-3", "title": "Is `gem update --system` broken for ruby &lt; 2.3?", "body": "<p>Today after the upgrade of <a href=\"https://rubygems.org/gems/rubygems-update\" rel=\"nofollow noreferrer\">rubygems-update</a> the <code>gem update --system</code> with ruby older than 2.3 has started to fail permanently with the next error:</p>\n\n<pre><code># gem update --system\nUpdating rubygems-update\nFetching: rubygems-update-3.0.0.gem (100%)\nERROR:  Error installing rubygems-update:\n    rubygems-update requires Ruby version &gt;= 2.3.0.\nERROR:  While executing gem ... (Errno::ENOENT)\n    No such file or directory @ dir_chdir - /usr/local/bundle/gems/rubygems-update-2.6.6\n# ruby --version\nruby 2.1.9p490 (2016-03-30 revision 54437) [x86_64-linux]\n</code></pre>\n\n<p>Is there any way to do it or it's just a new reality and I have to adjust any place which has used <code>gem update</code> to it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 6, "last_activity_date": 1545232791, "creation_date": 1545232791, "answer_id": 53854211, "question_id": 53854141, "link": "https://stackoverflow.com/questions/53854141/rspec-testing-destroy-action/53854211#53854211", "title": "RSpec testing destroy action", "body": "<p>You need to specify id of a comment you want to remove:</p>\n\n<pre><code>it \"deletes comment\" do\n  comment = FactoryBot.create(:comment, movie: movie, user: user)\n\n  expect do\n    delete :destroy, params { id: comment.id, movie_id: movie.id }\n  end.to change(Comment, :count).by(-1)\n  # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7396091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e42e7c68957071a36120693f6d690cd6?s=128&d=identicon&r=PG&f=1", "display_name": "aleko_js", "link": "https://stackoverflow.com/users/7396091/aleko-js"}, "is_accepted": false, "score": 1, "last_activity_date": 1618919077, "creation_date": 1618919077, "answer_id": 67178279, "question_id": 53854141, "link": "https://stackoverflow.com/questions/53854141/rspec-testing-destroy-action/67178279#67178279", "title": "RSpec testing destroy action", "body": "<p>I want to contribute here with one more approach. Sometimes you have to be sure that you've deleted the exact instance (comment_1, not comment_2).</p>\n<pre><code>it &quot;deletes comment&quot; do\n  comment_1 = FactoryBot.create(:comment, movie: movie, user: user)\n  comment_2 = FactoryBot.create(:comment, movie: movie, user: user)\n\n  delete :destroy, params { id: comment_1.id, movie_id: movie.id }\n\n  expect { comment_1.reload }.to raise_error(ActiveRecord::RecordNotFound)\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2252, "favorite_count": 1, "accepted_answer_id": 53854211, "answer_count": 2, "score": 2, "last_activity_date": 1618919077, "creation_date": 1545232576, "question_id": 53854141, "link": "https://stackoverflow.com/questions/53854141/rspec-testing-destroy-action", "title": "RSpec testing destroy action", "body": "<p>I'm trying to test the 'destroy' action for my nested comments controller.</p>\n\n<p>User model <code>has_many :comments, dependent: :destroy</code> \nMovie model <code>has_many :comments, dependent: :destroy</code>\nComments model <code>belongs_to :user and :movie</code>\nHere is my comments controller</p>\n\n<pre><code>  def create\n    @comment = @movie.comments.new(comment_params.merge(user: current_user))\n\n    if @comment.save\n      flash[:notice] = 'Comment successfully added'\n      redirect_to @movie\n    else\n      flash.now[:alert] = 'You can only have one comment per movie'\n      render 'movies/show'\n    end\n  end\n\n  def destroy\n    @comment = @movie.comments.find(params[:id])\n\n    if @comment.destroy\n      flash[:notice] = 'Comment successfully deleted'\n    else\n      flash[:alert] = 'You are not the author of this comment'\n    end\n    redirect_to @movie\n  end\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:body)\n  end\n  def set_movie\n    @movie = Movie.find(params[:movie_id])\n  end\n</code></pre>\n\n<p>Of course there is also <code>before_action :set_movie, only: %i[create destroy]</code> at the top.</p>\n\n<p>Here are my specs, I'm using FactoryBot and all factories works fine in other examples so I think the issue is somewhere else.</p>\n\n<pre><code>  describe \"DELETE #destroy\" do\n    let(:user) { FactoryBot.create(:user) }\n    let(:movie) { FactoryBot.create(:movie) }\n    before do\n      sign_in(user)\n    end\n\n    it \"deletes comment\" do\n      FactoryBot.create(:comment, movie: movie, user: user)\n\n      expect do\n        delete :destroy, params { movie_id: movie.id }\n      end.to change(Comment, :count).by(-1)\n      expect(response).to be_successful\n      expect(response).to have_http_status(:redirect)\n    end\n  end\n</code></pre>\n\n<p>I've got an error <code>ActionController::UrlGenerationError: No route matches {:action=&gt;\"destroy\", :controller=&gt;\"comments\", :movie_id=&gt;1}</code>\nI think my address in specs destroy action is wrong but how to define it in a good way?</p>\n"}, {"tags": ["ruby", "authentication", "sqlite"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1545236308, "post_id": 53854045, "comment_id": 94558220, "body": "<b>WARNING</b>: If you&#39;re creating an authentication system, please <b>encrypt all user passwords</b> and <b>never store them as plain-text</b>. At the absolute least use a password-specific hash like <a href=\"https://en.wikipedia.org/wiki/Bcrypt\" rel=\"nofollow noreferrer\">Bcrypt</a>."}, {"owner": {"reputation": 37, "user_id": 6538133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-dawTQrO3TDc/AAAAAAAAAAI/AAAAAAAAAFg/4rhGCroZwKE/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/6538133/ali-kesserwani"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1545249523, "post_id": 53854045, "comment_id": 94564466, "body": "Thank you tadman, i will check out bcrypt"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6538133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-dawTQrO3TDc/AAAAAAAAAAI/AAAAAAAAAFg/4rhGCroZwKE/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/6538133/ali-kesserwani"}, "edited": false, "score": 0, "creation_date": 1545241252, "post_id": 53855837, "comment_id": 94560916, "body": "Thanks varro. I tried it out but it still did not print yes. I am probably doing something wrong, Could you post a sample of the correct code?"}, {"owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "reply_to_user": {"reputation": 37, "user_id": 6538133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-dawTQrO3TDc/AAAAAAAAAAI/AAAAAAAAAFg/4rhGCroZwKE/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/6538133/ali-kesserwani"}, "edited": false, "score": 0, "creation_date": 1545242153, "post_id": 53855837, "comment_id": 94561323, "body": "I don&#39;t know why it didn&#39;t work for you, but I will expand my answer above to give a complete example."}, {"owner": {"reputation": 37, "user_id": 6538133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-dawTQrO3TDc/AAAAAAAAAAI/AAAAAAAAAFg/4rhGCroZwKE/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/6538133/ali-kesserwani"}, "edited": false, "score": 0, "creation_date": 1545249368, "post_id": 53855837, "comment_id": 94564406, "body": "Thank you so much, it worked. I used db.get_first_value incorrectly but this method worked perfectly."}, {"owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "reply_to_user": {"reputation": 37, "user_id": 6538133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-dawTQrO3TDc/AAAAAAAAAAI/AAAAAAAAAFg/4rhGCroZwKE/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/6538133/ali-kesserwani"}, "edited": false, "score": 0, "creation_date": 1545250089, "post_id": 53855837, "comment_id": 94564688, "body": "@AliKesserwani Glad to have helped.  Please consider hitting the check button to accept the answer."}], "tags": [], "owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "is_accepted": true, "score": 0, "last_activity_date": 1545243262, "last_edit_date": 1545243262, "creation_date": 1545238473, "answer_id": 53855837, "question_id": 53854045, "link": "https://stackoverflow.com/questions/53854045/sqlite3-value-in-ruby-script-not-working-as-string/53855837#53855837", "title": "Sqlite3 value in Ruby Script not working as string", "body": "<p>I think you're getting back an array representing the list of matches, although in this case there's only one row returned.  Furthermore, the row itself is an array of values, although in this case the row will be an array of only one value.  So you should be comparing <code>t[0][0]</code> rather than just <code>t</code></p>\n\n<p>You could use the function <code>db.get_first_value</code> instead to simplify this.</p>\n\n<p>(This assumes that <code>name</code> is unique; you probably want to use a <code>UNIQUE</code> constraint in the database schema for both <code>id</code> and <code>name</code>.)</p>\n\n<p>(And, yes, you should take @tadman's warning to heart.)</p>\n\n<p>So here's a minimally altered version of the code you posted above (<em>without</em> the suggested improvements) that gives the desired result:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'sqlite3'\n\ndb = SQLite3::Database.new(':memory:')\n\ndb.execute(\"CREATE TABLE IF NOT EXISTS auth(id int, name text, password text)\")\n\ndb.execute(\"INSERT INTO auth(id, name, password) VALUES(?, ?, ?)\",\n           [1, 'Bugs', 'Carrots'])\n\n\nt = db.execute(\"SELECT password FROM auth WHERE name = 'Bugs'\")\n\nif t[0][0] == 'Carrots'\n  puts \"yes\"\nend\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6538133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-dawTQrO3TDc/AAAAAAAAAAI/AAAAAAAAAFg/4rhGCroZwKE/photo.jpg?sz=128", "display_name": "Ali Kesserwani", "link": "https://stackoverflow.com/users/6538133/ali-kesserwani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53855837, "answer_count": 1, "score": 1, "last_activity_date": 1545243262, "creation_date": 1545232197, "question_id": 53854045, "link": "https://stackoverflow.com/questions/53854045/sqlite3-value-in-ruby-script-not-working-as-string", "title": "Sqlite3 value in Ruby Script not working as string", "body": "<p>I am trying to create a user-auth system and have run into a problem. In this code, I am trying to check if a certain value matches another value in the same row. It prints but does not work as a string when I set it equal to another string. </p>\n\n<pre><code>    db.execute(\"CREATE TABLE IF NOT EXISTS auth(id int, name text, password text)\")\n\n    db.execute(\"INSERT INTO auth(id, name, password) VALUES(?, ?, ?)\", [1, 'Bugs', 'Carrots'])    \n\n\n   t = db.execute(\"SELECT password FROM auth WHERE name = 'Bugs'\") \n\n   if t == 'Carrots'\n     puts \"yes\"\n   end\n\n   #i am trying to print yes to the console \n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "helper", "collection-select"], "comments": [{"owner": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 0, "creation_date": 1545235075, "post_id": 53853160, "comment_id": 94557480, "body": "Don&#39;t know whether its possible with <code>collection_select</code> but it achievable usning ruby&#39;s <code>select</code> view helper. <a href=\"https://stackoverflow.com/a/22801275/2570423\">Here</a> is an example."}, {"owner": {"reputation": 15, "user_id": 8149857, "user_type": "registered", "profile_image": "https://graph.facebook.com/1787270031528324/picture?type=large", "display_name": "Yuting", "link": "https://stackoverflow.com/users/8149857/yuting"}, "reply_to_user": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 0, "creation_date": 1545387695, "post_id": 53853160, "comment_id": 94612512, "body": "@mehedi thnaks , it works ."}], "owner": {"reputation": 15, "user_id": 8149857, "user_type": "registered", "profile_image": "https://graph.facebook.com/1787270031528324/picture?type=large", "display_name": "Yuting", "link": "https://stackoverflow.com/users/8149857/yuting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545231720, "creation_date": 1545229197, "last_edit_date": 1545231720, "question_id": 53853160, "link": "https://stackoverflow.com/questions/53853160/how-to-set-a-option-id-in-collection-select-in-ruby-on-rails", "title": "How to set a option id in collection_select in Ruby on rails?", "body": "<p>Recently, I met an issue on how to set an option id in collection_select. because I want to use some js to hide some options .</p>\n\n<p>For example there are 2 modules, user belongs to Tenant.When I click the radio box tenant1 , I want for the page to only show the users in tenant1. </p>\n\n<p>This is what I write for the check box but how to do the same things for selecting?</p>\n\n<p><strong>js</strong></p>\n\n<pre><code>function toggleTenants() {\n  $('#tenant_panel input[type=\"radio\"]').click(function () {\n    const selectedTenantId = $(this).val();\n    $('.checkbox[data-tenant-id]').hide();\n    $('.checkbox[data-tenant-id=\"' + selectedTenantId + '\"]').show();\n  })\n}\n</code></pre>\n\n<p><strong>Application helper</strong> </p>\n\n<pre><code>  collection_check_boxes(object, method, collection.all, :id , value_method) do |c|\n    content_tag(:div, :class =&gt; 'checkbox', \"data-tenant-id\" =&gt; c.object.tenant_id) do\n      c.label(\"data-value\" =&gt; c.value) { c.check_box + \" \" + c.text }\n    end\n  end\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "post", "get"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1545228928, "post_id": 53852925, "comment_id": 94553529, "body": "<i>&quot;But is not clear enough for me&quot;</i> \u2013 what is unclear in particular? Please be more specific. What does your endpoint do? What makes you think it should be GET, or POST?"}, {"owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545240514, "post_id": 53852925, "comment_id": 94560569, "body": "@Stefan I updated my description, I think it&#39;s more explanatory now"}], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1251220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ef0b83959c5ad0bf18f1dcd57c678792?s=128&d=identicon&r=PG", "display_name": "Walid Da.", "link": "https://stackoverflow.com/users/1251220/walid-da"}, "is_accepted": false, "score": 1, "last_activity_date": 1545245084, "last_edit_date": 1545245084, "creation_date": 1545228635, "answer_id": 53853017, "question_id": 53852925, "link": "https://stackoverflow.com/questions/53852925/if-a-controller-method-causes-an-external-service-to-modify-the-database-should/53853017#53853017", "title": "If a controller method causes an external service to modify the database, should I use GET or POST?", "body": "<p>You are saving to your database, so for me, logically it's a POST.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545232009, "post_id": 53853374, "comment_id": 94555374, "body": "<i>&quot;It will be POST method because [...]&quot;</i> \u2013 the reason doesn&#39;t seem to be obvious to me. Which aspects make it a POST method? (1) get data (2) external source (3) in a array (4) extract it (5) save it (6) database"}, {"owner": {"reputation": 26, "user_id": 9805643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7Kk_PjnvlHg/AAAAAAAAAAI/AAAAAAAAADU/n04CBrJP8SM/photo.jpg?sz=128", "display_name": "rAnA bilAl", "link": "https://stackoverflow.com/users/9805643/rana-bilal"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545250440, "post_id": 53853374, "comment_id": 94564825, "body": "because he just want to save data in database its simple there is no need to use GET method."}], "tags": [], "owner": {"reputation": 26, "user_id": 9805643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7Kk_PjnvlHg/AAAAAAAAAAI/AAAAAAAAADU/n04CBrJP8SM/photo.jpg?sz=128", "display_name": "rAnA bilAl", "link": "https://stackoverflow.com/users/9805643/rana-bilal"}, "is_accepted": false, "score": 1, "last_activity_date": 1545229933, "creation_date": 1545229933, "answer_id": 53853374, "question_id": 53852925, "link": "https://stackoverflow.com/questions/53852925/if-a-controller-method-causes-an-external-service-to-modify-the-database-should/53853374#53853374", "title": "If a controller method causes an external service to modify the database, should I use GET or POST?", "body": "<p>It will be POST method because you get data from external source in a array and you will extract it and save it to your database. there is no need to use GET method. </p>\n"}, {"comments": [{"owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "edited": false, "score": 0, "creation_date": 1545240558, "post_id": 53854031, "comment_id": 94560593, "body": "I updated my description, I think it&#39;s more explanatory now"}, {"owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "edited": false, "score": 1, "creation_date": 1545245571, "post_id": 53854031, "comment_id": 94562756, "body": "Thank you, now I think that GET is the best option. My crawler class is placed on <code>lib</code> folder, so it&#39;s already a separate service, it&#39;s that what you suggest ?"}], "tags": [], "owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "is_accepted": true, "score": 3, "last_activity_date": 1545244392, "last_edit_date": 1545244392, "creation_date": 1545232156, "answer_id": 53854031, "question_id": 53852925, "link": "https://stackoverflow.com/questions/53852925/if-a-controller-method-causes-an-external-service-to-modify-the-database-should/53854031#53854031", "title": "If a controller method causes an external service to modify the database, should I use GET or POST?", "body": "<p>Based upon the still limited knowledge I have, I would change the way you are doing this.</p>\n\n<p>Good:\nChange method to <code>user_info</code> and make it a GET. The fact that it does some extra loading the first time you call it is a side-effect an is not relevant.</p>\n\n<p>Better:\nChange the method to <code>show</code> (one of the standard Rails methods) and use a GET.</p>\n\n<p>Maybe best:\nMove the crawl logic to the model or a separate service. Normally, a controller method would not be the best place to do this, but you know your app better than I do.</p>\n"}], "owner": {"reputation": 2274, "user_id": 7390929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WPB1g.jpg?s=128&g=1", "display_name": "Lucas Andrade", "link": "https://stackoverflow.com/users/7390929/lucas-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 53854031, "answer_count": 3, "score": 0, "last_activity_date": 1545245084, "creation_date": 1545228351, "last_edit_date": 1545244608, "question_id": 53852925, "link": "https://stackoverflow.com/questions/53852925/if-a-controller-method-causes-an-external-service-to-modify-the-database-should", "title": "If a controller method causes an external service to modify the database, should I use GET or POST?", "body": "<p>I have a Rails API and my endpoint to load some user info is:</p>\n\n<pre><code># at user controller\ndef load_user_info\n  user = User.find_by(id: params[:id])\n  if user.blank?\n    # Here I call an external service to crawl user info from \n    # some webpage, and after get this info I save it in my database\n  else\n    user\n  end\nend\n</code></pre>\n\n<p>In this situation, should my route for load_user_info should be a GET or a POST ?</p>\n\n<p>I already took a look in these two questions, but is not clear enough for me because I only save some data if the user doesn't exist, and if my user doesn't exist is not this method of my controller that will save something in my database, it'll be my external crawler class, this crawler class will get the info from website and than do <code>User.create(attributes)</code>, so to my front end page (that will use this API) this endpoint is just responsible to return user info, my client doesn't know about any insert in my database</p>\n\n<p><a href=\"https://stackoverflow.com/questions/46585/when-do-you-use-post-and-when-do-you-use-get\">When do you use POST and when do you use GET?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/504947/when-should-i-use-get-or-post-method-whats-the-difference-between-them\">When should I use GET or POST method? What&#39;s the difference between them?</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1545226192, "post_id": 53852118, "comment_id": 94551836, "body": "Wait, all the filters are in OR or AND between them?"}, {"owner": {"reputation": 31, "user_id": 5385193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e93b191b54ed50bf1fed696148bc64?s=128&d=identicon&r=PG&f=1", "display_name": "swapnilpatil24", "link": "https://stackoverflow.com/users/5385193/swapnilpatil24"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1545226528, "post_id": 53852118, "comment_id": 94552071, "body": "Some are in OR and some are in AND"}, {"owner": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "edited": false, "score": 0, "creation_date": 1545226634, "post_id": 53852118, "comment_id": 94552126, "body": "If possible use a gem. I recommend <a href=\"https://github.com/activerecord-hackery/ransack\" rel=\"nofollow noreferrer\">ransack</a>. If you want avoid gem take a params hash of attribute and value. Then loop through that hash and build your desired query string."}, {"owner": {"reputation": 31, "user_id": 5385193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e93b191b54ed50bf1fed696148bc64?s=128&d=identicon&r=PG&f=1", "display_name": "swapnilpatil24", "link": "https://stackoverflow.com/users/5385193/swapnilpatil24"}, "edited": false, "score": 0, "creation_date": 1545226816, "post_id": 53852118, "comment_id": 94552244, "body": "ok, thanks, I can try that"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5385193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e93b191b54ed50bf1fed696148bc64?s=128&d=identicon&r=PG&f=1", "display_name": "swapnilpatil24", "link": "https://stackoverflow.com/users/5385193/swapnilpatil24"}, "edited": false, "score": 0, "creation_date": 1545227474, "post_id": 53852592, "comment_id": 94552645, "body": "it won&#39;t solve dynamic attribute passing to where like"}, {"owner": {"reputation": 885, "user_id": 1251220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ef0b83959c5ad0bf18f1dcd57c678792?s=128&d=identicon&r=PG", "display_name": "Walid Da.", "link": "https://stackoverflow.com/users/1251220/walid-da"}, "reply_to_user": {"reputation": 31, "user_id": 5385193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e93b191b54ed50bf1fed696148bc64?s=128&d=identicon&r=PG&f=1", "display_name": "swapnilpatil24", "link": "https://stackoverflow.com/users/5385193/swapnilpatil24"}, "edited": false, "score": 0, "creation_date": 1545228382, "post_id": 53852592, "comment_id": 94553202, "body": "You should treat it as the above, I think what I&#39;ve already wrote could help"}], "tags": [], "owner": {"reputation": 885, "user_id": 1251220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ef0b83959c5ad0bf18f1dcd57c678792?s=128&d=identicon&r=PG", "display_name": "Walid Da.", "link": "https://stackoverflow.com/users/1251220/walid-da"}, "is_accepted": false, "score": 0, "last_activity_date": 1545228279, "last_edit_date": 1545228279, "creation_date": 1545227158, "answer_id": 53852592, "question_id": 53852118, "link": "https://stackoverflow.com/questions/53852118/rails-where-like-pass-dynamic-attribute-with-there-values/53852592#53852592", "title": "Rails where LIKE pass dynamic attribute with there values", "body": "<p>This logic could help</p>\n\n<pre><code>level_one_result = Product.where('first_name like ? OR last_name like ?',\"%#{params[:first_nm]}%\", \"%#{params[: last_nm]}%\")\nif (params[:age_end].to_i &gt; 0 or params[:age_end].to_i &gt; 0)\n  if params[:age_start].to_i &gt; 0 and params[:age_end].to_i &gt; 0\n     result = level_one_result.where('age &gt;= ? AND age &lt;= ?',params[:age_start].to_i,params[:age_end].to_i)\n  elsif params[:age_end].to_i &gt; 0\n     result = level_one_result.where('age &lt;= ?',params[:age_end].to_i)\n  else\n     result = level_one_result.where('age &gt;= ?',params[:age_start].to_i)\n  end\nelse\n  result = level_one_result\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1813, "user_id": 1047730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2435beed6cd3c5be09b77e213e4184?s=128&d=identicon&r=PG", "display_name": "codenamev", "link": "https://stackoverflow.com/users/1047730/codenamev"}, "is_accepted": false, "score": 0, "last_activity_date": 1545229385, "last_edit_date": 1545229385, "creation_date": 1545228780, "answer_id": 53853062, "question_id": 53852118, "link": "https://stackoverflow.com/questions/53852118/rails-where-like-pass-dynamic-attribute-with-there-values/53853062#53853062", "title": "Rails where LIKE pass dynamic attribute with there values", "body": "<p>If you can, I would update your form to submit the params to reflect the columns to search on.  Then you can make this a bit easier with a scope:</p>\n\n<pre><code>ALLOWED_SEARCH_TERMS = %i(first_name last_name).freeze\n\nscope :search, -&gt;(terms) {\n  result = all\n  terms.slice(*ALLOWED_SEARCH_TERMS).each { |term, value| result = result.where(:\"#{term}\" =&gt; value) }\n  result = result.where(\"age BETWEEN :age_start AND :age_end\", terms.slice(:age_start, :age_end)) if terms.key?(:age_start) &amp;&amp; terms.key?(:age_end)\n  result\n}\n</code></pre>\n\n<p>Then in your controller you can:</p>\n\n<pre><code>Product.search(params)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5385193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e93b191b54ed50bf1fed696148bc64?s=128&d=identicon&r=PG&f=1", "display_name": "swapnilpatil24", "link": "https://stackoverflow.com/users/5385193/swapnilpatil24"}, "is_accepted": true, "score": 1, "last_activity_date": 1545229756, "creation_date": 1545229756, "answer_id": 53853319, "question_id": 53852118, "link": "https://stackoverflow.com/questions/53852118/rails-where-like-pass-dynamic-attribute-with-there-values/53853319#53853319", "title": "Rails where LIKE pass dynamic attribute with there values", "body": "<p>Thanks guys for inputs, Following solution worked for me.\nI think its pretty easy</p>\n\n<pre><code>params_hash = {}\nif first_name\n  where_str = 'first_name Ilike :ft_nm'\n  params_hash[:ft_nm] = \"swapnil\"\nend\n\nif last_name\n  where_str += 'last_name Ilike :lt_nm'\n  params_hash[:lt_nm] = \"patil\"\nend \n\nProduct.where(where_str, params_hash)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5385193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e93b191b54ed50bf1fed696148bc64?s=128&d=identicon&r=PG&f=1", "display_name": "swapnilpatil24", "link": "https://stackoverflow.com/users/5385193/swapnilpatil24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 53853319, "answer_count": 3, "score": 0, "last_activity_date": 1545229756, "creation_date": 1545225585, "last_edit_date": 1545226286, "question_id": 53852118, "link": "https://stackoverflow.com/questions/53852118/rails-where-like-pass-dynamic-attribute-with-there-values", "title": "Rails where LIKE pass dynamic attribute with there values", "body": "<p>I have search query and there I need to pass dynamic search attribute and values. Following query I am passing all field but those are not dynamic means Some time only first_name will be in search or some time first_name and last_name or some time first_name with age.</p>\n\n<p>How the best way to pass those attributes and values as per found in search method.</p>\n\n<pre><code>Product.where(\n  'first_name like ? OR last_name like ? OR age BETWEEN ? AND ?',\n  params[:first_nm],\n  params[:last_nm],\n  params[:age_start],\n  params[:age_end]\n)\n</code></pre>\n"}, {"tags": ["ruby", "thread-safety", "connection-pooling", "sequel"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545228371, "post_id": 53852069, "comment_id": 94553196, "body": "<i>&quot;How to use timeout limit in threads&quot;</i> \u2013 does the timeout limit work outside of <code>Thread.new { ... }</code>? If not, the problem is a general one and not related to threads."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1545228217, "creation_date": 1545228217, "answer_id": 53852879, "question_id": 53852069, "link": "https://stackoverflow.com/questions/53852069/how-to-use-timeout-limit-in-threads/53852879#53852879", "title": "How to use timeout limit in threads", "body": "<p>The <code>_timeout</code> parameters are for the TCPSocket used by the client and do not set a maximum wait time for query results.</p>\n\n<p>You could use the <code>Timeout</code> from ruby stdlib:</p>\n\n<pre><code>t = Thread.new do\n  Timeout.timeout(10) do\n    Sequel.connect(CONF)['select sleep(100)'].all\n  end\nend\n</code></pre>\n\n<p>Note: The <code>Timeout</code> does have widely known problems as shown <a href=\"https://www.mikeperham.com/2015/05/08/timeout-rubys-most-dangerous-api/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>You could also consider something like the <a href=\"https://github.com/mperham/connection_pool\" rel=\"nofollow noreferrer\">connection_pool gem</a> which has a timeout feature and would do the connection pooling for you.</p>\n"}], "owner": {"reputation": 13, "user_id": 1973970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ae4f86ddc70bfdb8b6c8a2001f1ce7d?s=128&d=identicon&r=PG", "display_name": "kudrin", "link": "https://stackoverflow.com/users/1973970/kudrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545228217, "creation_date": 1545225444, "question_id": 53852069, "link": "https://stackoverflow.com/questions/53852069/how-to-use-timeout-limit-in-threads", "title": "How to use timeout limit in threads", "body": "<p>I want to run someone sql request at new thread:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'mysql2'\nrequire 'sequel'\n\nCONF = {\n  adapter: 'mysql2',\n  encoding: 'utf8',\n  username: 'ruby',\n  password: 'ruby',\n  host: 'localhost',\n  port: 3306,\n  pool: 4,\n  read_timeout:     10,\n  write_timeout:    10,\n  connect_timeout:  10,\n  pool_timeout:     10,\n  database: 'demo',\n  max_conns: 7\n}\n\nconn = Sequel.connect(CONF)\n\nt = Thread.new { conn['select sleep(100)'].all }\nsleep 2\n\nt.kill\nsleep 15\n</code></pre>\n\n<p>When I run this code, I expect request will stop after 10 seconds, but it does not. When view mysql process list with:</p>\n\n<pre><code>SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != 'Sleep' \n</code></pre>\n\n<p>I see - it is still processing (41 sec):</p>\n\n<pre><code>| TIME | QUERY             |  \n|------|-------------------|\n| 41   | select sleep(100) |\n</code></pre>\n\n<p>How to change my code to get expected result?</p>\n"}, {"tags": ["ruby", "shoes"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1545224921, "post_id": 53851504, "comment_id": 94551162, "body": "<code>copy.para</code> should probably be <code>copy.write(new_box.text)</code>"}, {"owner": {"reputation": 95, "user_id": 7772943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62039f2e6a8e20871ea8037866c56f19?s=128&d=identicon&r=PG", "display_name": "Shurikan117", "link": "https://stackoverflow.com/users/7772943/shurikan117"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1545225936, "post_id": 53851504, "comment_id": 94551709, "body": "Still nothing no. The file created appears empty."}], "answers": [{"tags": [], "owner": {"reputation": 184, "user_id": 3800524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7478fdb5e644d85e0875f8200b33a279?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastjan Hribar", "link": "https://stackoverflow.com/users/3800524/sebastjan-hribar"}, "is_accepted": false, "score": 0, "last_activity_date": 1574948762, "creation_date": 1574948762, "answer_id": 59090307, "question_id": 53851504, "link": "https://stackoverflow.com/questions/53851504/save-or-copy-text-in-edit-box-or-line-to-an-external-file-in-ruby-shoes/59090307#59090307", "title": "Save or copy text in Edit_box or line to an external file in Ruby Shoes", "body": "<p>you have to use instance variables in such cases:</p>\n\n<pre><code>Shoes.app do\n  stack do\n    flow do\n      @new_box = edit_box \"placeholdertext\"\n    end\n\n    flow do\n      button \"Save\" do\n        note_save = ask_save_file\n        File.open(\"#{note_save}\", \"w\") do |file|\n          file.write @new_box.text\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Best, seba</p>\n"}], "owner": {"reputation": 95, "user_id": 7772943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62039f2e6a8e20871ea8037866c56f19?s=128&d=identicon&r=PG", "display_name": "Shurikan117", "link": "https://stackoverflow.com/users/7772943/shurikan117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574948762, "creation_date": 1545223329, "last_edit_date": 1545269778, "question_id": 53851504, "link": "https://stackoverflow.com/questions/53851504/save-or-copy-text-in-edit-box-or-line-to-an-external-file-in-ruby-shoes", "title": "Save or copy text in Edit_box or line to an external file in Ruby Shoes", "body": "<p>Using Shoes 3.3.7</p>\n\n<p>How do I go about grabbing the text typed in an Edit_box and saving it to a file on a button click? </p>\n\n<p>This is what i used. It created the file but it just stays empty...</p>\n\n<pre><code>Shoes.app do\n  Stack do\n    flow do\n      new_box = edit_box \"placeholdertext\"\n    end\n\n    flow do\n      button \"Save\" do\n        note_save = ask_save_file\n        File.open(\"#{note_save}\", \"a\") do |copy|\n          copy.para \"#{new_box.text}\"\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Edit : setting code to,</p>\n\n<pre><code>copy.write(new_box.text)\n</code></pre>\n\n<p>Still creates a file with empty content</p>\n\n<p>I'm pretty new to all this. Any help is appreciated \ud83d\ude0a</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1545220092, "post_id": 53850393, "comment_id": 94548531, "body": "When using <code>has_secure_password</code> then you do not write directly into the <code>password_digest</code> attribute/column instead you set <code>password</code> and <code>password_confirmation</code> and Rails calculates and handles the digest for you. I advise reading the <a href=\"https://api.rubyonrails.org/classes/ActiveModel/SecurePassword/ClassMethods.html\" rel=\"nofollow noreferrer\"><code>has_secure_password</code> docs</a> and about <a href=\"https://guides.rubyonrails.org/active_model_basics.html#securepassword\" rel=\"nofollow noreferrer\">SecurePassword in the Rails Guides</a>."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10810701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q2ciHATHWWE/AAAAAAAAAAI/AAAAAAAAAFc/uJ8-0AnOqBY/photo.jpg?sz=128", "display_name": "antonio vazquez", "link": "https://stackoverflow.com/users/10810701/antonio-vazquez"}, "edited": false, "score": 0, "creation_date": 1545223891, "post_id": 53851372, "comment_id": 94550545, "body": "Two days looking around and dont realise. Thank you very much. This fix my problem!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1545228756, "post_id": 53851372, "comment_id": 94553435, "body": "attr_accessor has nothing to do with strong_params. You&#39;re thinking of attr_accessible."}], "tags": [], "owner": {"reputation": 95, "user_id": 9361533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-skZgtkXNKK4/AAAAAAAAAAI/AAAAAAAAAVw/ChuLDYzLJpI/photo.jpg?sz=128", "display_name": "Bhargav Reddy", "link": "https://stackoverflow.com/users/9361533/bhargav-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1545222809, "creation_date": 1545222809, "answer_id": 53851372, "question_id": 53850393, "link": "https://stackoverflow.com/questions/53850393/ruby-mysql-not-saving-password-field/53851372#53851372", "title": "ruby - mysql - Not saving password field", "body": "<p>I don't know but i think you should not use below code if you are using rails 4 or above version as there is a concept of strong parameters. once check guides </p>\n\n<pre><code>attr_accessor :password_digest\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10810701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q2ciHATHWWE/AAAAAAAAAAI/AAAAAAAAAFc/uJ8-0AnOqBY/photo.jpg?sz=128", "display_name": "antonio vazquez", "link": "https://stackoverflow.com/users/10810701/antonio-vazquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545222809, "creation_date": 1545219328, "question_id": 53850393, "link": "https://stackoverflow.com/questions/53850393/ruby-mysql-not-saving-password-field", "title": "ruby - mysql - Not saving password field", "body": "<p>I'm having a problem that I have never found. I have a form to create a new user, in it, I have the field to save my password with has_secure_password</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-4\"&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;%= form.label \"Contrase\u00f1a\" %&gt;\n      &lt;%= form.password_field :password_digest, class:\"form-control\", id: :user_password_digest %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The question is that all the fields are been saved correctly, but password field is always NULL.</p>\n\n<p>My model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one :rol\n\n  #attr_accessible :email, :password\n  attr_accessor :password_digest\n\n  validates_confirmation_of :password_digest\n  #validates_presence_of :password, :on =&gt; :createrail\n  validates :password_digest, presence: true, length: {minimum: 5}, allow_nil: false\n  validates_presence_of :email, :on =&gt; :create\n  validates_uniqueness_of :email\n  has_secure_password\n\n  def self.authenticate(email, password_digest)\n    user = find_by_email(email)\n    p user\n    if user &amp;&amp; user.password_digest\n      p \"Me he logueado\"\n      user\n    else\n      p \"No hace hash\"\n      nil\n    end\n  end\n\n  def logged_in\n    !current_user.nil?\n  end\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>def create\n@user = User.new(user_params)\n\np \"Parametros\"\np user_params\np @user\nrespond_to do |format|\n  if @user.valid?\n\n    @user.active = 1\n    if @user.save\n      p \"El usuario es\"\n      p @user\n\n      session[:usuario_id] = @user.id\n      p \"Test\"\n      p @user.password_digest\n\n      p \"EndTest\"\n      format.html { redirect_to @user, notice: 'Usuario creado correctamente.' }\n      format.json { render :show, status: :created, location: @user }\n    else\n      format.html { render :new }\n      format.json { render json: @user.errors, status: :unprocessable_entity }\n    end\n  end\nend  \nend\n</code></pre>\n\n<p>In test, I can see that the password_digest field has content, but later, it is not saving. Any help?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-lambda", "rubygems"], "comments": [{"owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "edited": false, "score": 0, "creation_date": 1545222972, "post_id": 53849966, "comment_id": 94550055, "body": "Make sure, that the files are there... for example can you run there some code, which show the files? for example: What deos this command print? <code>`ls #{Dir.pwd + &quot;&#47;vendor&#47;bundle&#47;ruby&#47;2.5.0&#47;gems&quot;}`</code>"}, {"owner": {"reputation": 429, "user_id": 7617687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0c380ac37c50e2c0574e0ecec1a98?s=128&d=identicon&r=PG&f=1", "display_name": "radoAngelov", "link": "https://stackoverflow.com/users/7617687/radoangelov"}, "edited": false, "score": 0, "creation_date": 1545225984, "post_id": 53849966, "comment_id": 94551739, "body": "Have you tried installing the <code>libmysql-ruby</code> and <code>libmysqlclient-dev</code> libraries? I think the gem is just not installed under your bundle but may be wrong."}, {"owner": {"reputation": 51, "user_id": 8070579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8b848080ebd37cd3a81c5729cb4ebf?s=128&d=identicon&r=PG&f=1", "display_name": "sdas199421", "link": "https://stackoverflow.com/users/8070579/sdas199421"}, "reply_to_user": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "edited": false, "score": 0, "creation_date": 1545285233, "post_id": 53849966, "comment_id": 94573945, "body": "@DonPaulie it showed this &quot;mysql2-0.5.2\\n&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 13964745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa6e4b40758aaaf3297ce22254271e3?s=128&d=identicon&r=PG&f=1", "display_name": "G SB", "link": "https://stackoverflow.com/users/13964745/g-sb"}, "is_accepted": false, "score": 0, "last_activity_date": 1597078835, "creation_date": 1597078835, "answer_id": 63344688, "question_id": 53849966, "link": "https://stackoverflow.com/questions/53849966/how-to-require-local-project-library-into-ruby-aws-lambda-function/63344688#63344688", "title": "How to require local project library into ruby aws lambda function?", "body": "<p>Apparently other answers do not work for Ruby 2.7.0.</p>\n<p>It worked for me with</p>\n<pre><code>$LOAD_PATH.unshift *Dir['/var/task/app_name/vendor/ruby/2.7.0/gems/**/lib']\n</code></pre>\n<p>Be sure to change <code>app_name</code> to the name of your lambda function.</p>\n"}], "owner": {"reputation": 51, "user_id": 8070579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8b848080ebd37cd3a81c5729cb4ebf?s=128&d=identicon&r=PG&f=1", "display_name": "sdas199421", "link": "https://stackoverflow.com/users/8070579/sdas199421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1597078835, "creation_date": 1545217616, "last_edit_date": 1545218931, "question_id": 53849966, "link": "https://stackoverflow.com/questions/53849966/how-to-require-local-project-library-into-ruby-aws-lambda-function", "title": "How to require local project library into ruby aws lambda function?", "body": "<p>I have a ruby lambda function and now it needs database connection using mysql2.</p>\n\n<p>Now, using lambda function console editor I uploaded my zip file with my library inside vendor/bundle.</p>\n\n<p>I installed the library in my local using below command</p>\n\n<blockquote>\n  <p>bundle install --path vendor/bundle</p>\n</blockquote>\n\n<p>to install mysql2 ~> 0.5.2 from the Gemfile.</p>\n\n<p>Now, I wrote below code to get data from db</p>\n\n<pre><code>require 'json'\nload_paths = Dir.pwd + \"/vendor/bundle/ruby/2.5.0/gems/**/lib\"\n$LOAD_PATH.unshift(*load_paths)\nrequire 'mysql2'\ndef lambda_handler()\n  @db_host  = \"host\"\n  @db_user  = \"user\"\n  @db_pass  = \"pass\"\n  @db_name = \"db\"\n\n  client = Mysql2::Client.new(:host =&gt; @db_host, :username =&gt; @db_user, :password =&gt; @db_pass, :database =&gt; @db_name)\n  @cdr_result = client.query(\"SELECT count(*) from names\")\n  puts @cdr_result\n  { statusCode: 200, body: JSON.generate('Hello from Lambda!') }\nend\nlambda_handler\n</code></pre>\n\n<p>but throwing this error in aws lambda</p>\n\n<pre><code>Response:\n{\n  \"errorMessage\": \"cannot load such file -- mysql2\",\n  \"errorType\": \"Init&lt;LoadError&gt;\",\n  \"stackTrace\": [\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/task/replaceFile.rb:4:in `&lt;top (required)&gt;'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\",\n    \"/var/lang/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\"\n  ]\n}\n</code></pre>\n\n<p>Is there any way that I can require the local directory mysql2 gem into my script file having my gems inside vendor/bundle and use these libraries in my ruby script, which is in aws lambda deployment package.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "visual-studio-code"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 5909738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jNscA.jpg?s=128&g=1", "display_name": "Tashows", "link": "https://stackoverflow.com/users/5909738/tashows"}, "edited": false, "score": 0, "creation_date": 1585087398, "post_id": 53909829, "comment_id": 107641811, "body": "That is very helpful. If anyone knows a way to switch gemset from inside a GUI opened window of VS Code, please post an answer as well."}], "tags": [], "owner": {"reputation": 143, "user_id": 10573008, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-80rib0nzR_0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCz_HIZ5IR0D3555DPEClLqna8tnw/mo/photo.jpg?sz=128", "display_name": "radtemporary", "link": "https://stackoverflow.com/users/10573008/radtemporary"}, "is_accepted": false, "score": 8, "last_activity_date": 1545632040, "creation_date": 1545632040, "answer_id": 53909829, "question_id": 53849628, "link": "https://stackoverflow.com/questions/53849628/rvm-not-working-properly-in-vs-code-debugger/53909829#53909829", "title": "RVM not working properly in VS Code Debugger", "body": "<p>Found the solution for the version issue. Turns out that if you open VS Code through the GUI, then VS Code uses the default version of Ruby. But if you open it with the CLI by going inside the directory of the project and then typing <code>code .</code>, it works with the version specified in the Gemfile.</p>\n\n<p>My guess is that RVM does a Ruby version switch when you <code>cd</code> into the project directory and because of which VS Code uses that switched version because the instance of VS Code was created by the same process which did the switch. <em><strong>Note:</strong> I don't know much about Linux processes so feel free to correct me if I'm wrong.</em></p>\n"}, {"comments": [{"owner": {"reputation": 596, "user_id": 6176274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EEWV25AeTD0/AAAAAAAAAAI/AAAAAAAAAMs/gfyEkEOkDjc/photo.jpg?sz=128", "display_name": "Alexey Novakov", "link": "https://stackoverflow.com/users/6176274/alexey-novakov"}, "edited": false, "score": 1, "creation_date": 1588367466, "post_id": 61547329, "comment_id": 108877790, "body": "Is it answer or additional question?"}], "tags": [], "owner": {"reputation": 51, "user_id": 6621187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36fc6f31fc7bc2f84362f488f3039460?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6621187/steve"}, "is_accepted": false, "score": 1, "last_activity_date": 1588353554, "creation_date": 1588353554, "answer_id": 61547329, "question_id": 53849628, "link": "https://stackoverflow.com/questions/53849628/rvm-not-working-properly-in-vs-code-debugger/61547329#61547329", "title": "RVM not working properly in VS Code Debugger", "body": "<p>There is a setting for the command path of the ruby interpreter that defaults to just \"ruby\".  I'm just getting into vscode, but it may be possible to use a vscode variable interpolation to the rvm command and set the ruby interpreter value to the rvm result.</p>\n\n<p>Has anyone used <a href=\"https://github.com/ngetahun/vscode-rvm\" rel=\"nofollow noreferrer\">https://github.com/ngetahun/vscode-rvm</a>?</p>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 3442759, "user_type": "registered", "profile_image": "https://graph.facebook.com/1237562817/picture?type=large", "display_name": "tomkra", "link": "https://stackoverflow.com/users/3442759/tomkra"}, "is_accepted": false, "score": 0, "last_activity_date": 1609693459, "creation_date": 1609693459, "answer_id": 65552565, "question_id": 53849628, "link": "https://stackoverflow.com/questions/53849628/rvm-not-working-properly-in-vs-code-debugger/65552565#65552565", "title": "RVM not working properly in VS Code Debugger", "body": "<p>With <code>rvm</code> you have two choices:</p>\n<ol>\n<li>Open workspace from your terminal with <code>code .</code> command. This ensures that appropriate paths are set. But when you open another workspace from UI, appropriate paths will not be set.</li>\n<li>Set paths inside your <code>launch.json</code> yourself as follows:</li>\n</ol>\n<pre class=\"lang-json prettyprint-override\"><code>{\n    &quot;name&quot;: &quot;Rails server&quot;,\n    &quot;type&quot;: &quot;Ruby&quot;,\n    &quot;request&quot;: &quot;launch&quot;,\n    &quot;program&quot;: &quot;${workspaceRoot}/bin/rails&quot;,\n    &quot;env&quot;: {\n        &quot;PATH&quot;: &quot;&quot;,\n        &quot;GEM_HOME&quot;: &quot;&quot;,\n        &quot;GEM_PATH&quot;: &quot;&quot;,\n        &quot;RUBY_VERSION&quot;: &quot;ruby-2.5.3&quot;\n    },\n    &quot;args&quot;: [\n        &quot;server&quot;\n    ]\n}\n</code></pre>\n<p>Both solutions are cumbersome and what I recommend is to uninstall <code>rvm</code> and use <code>rbenv</code> for ruby versions management instead.</p>\n<p>With <code>rbenv</code> you don't have to specify paths and you can open your worskpaces directly from UI - correct ruby versions and paths will be always set. Using <code>rbenv</code> even resolved other issues with vscode I previously had with rubocop and solargraph extensions.</p>\n<p>Interesting article for other benefits replacing <code>rvm</code> with <code>rbenv</code>:\n<a href=\"https://dev.to/krtb/why-and-how-i-replaced-rvm-with-rbenv-23ad\" rel=\"nofollow noreferrer\">https://dev.to/krtb/why-and-how-i-replaced-rvm-with-rbenv-23ad</a></p>\n"}], "owner": {"reputation": 143, "user_id": 10573008, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-80rib0nzR_0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCz_HIZ5IR0D3555DPEClLqna8tnw/mo/photo.jpg?sz=128", "display_name": "radtemporary", "link": "https://stackoverflow.com/users/10573008/radtemporary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2019, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1609693459, "creation_date": 1545216590, "question_id": 53849628, "link": "https://stackoverflow.com/questions/53849628/rvm-not-working-properly-in-vs-code-debugger", "title": "RVM not working properly in VS Code Debugger", "body": "<p>I'm using RVM to manage Ruby versions where I work. We have two Rails repos, one Desktop and one Mobile. The Desktop repo uses Ruby 2.2.4 and the Mobile repo uses 2.2.2.</p>\n\n<p>I know that RVM has the functionality of automatically switching the appropriate Ruby version which is specified in the Gemfile (which is specified in our case in both the Gemfiles).</p>\n\n<p>Now, when I use the default terminal, and run the <code>ruby -v</code> command, inside individual project root directories, it displays the appropriate versions. But when I do the same in VS terminal, it displays the default version, which is 2.2.4.</p>\n\n<p>Now my main problem was that the Rails debugger was giving me the following error: <code>Your Ruby version is 2.2.4, but your Gemfile specified 2.2.2</code> for the Mobile repo whenever I tried to use the VS Debugger. And I suspect that it is because of whatever I've mentioned above.</p>\n\n<p>Is that the case or is it a different issue? Also provide the solution for whatever the issue is.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "bundler", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 1252, "user_id": 7220501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2RC3.jpg?s=128&g=1", "display_name": "James Mulholland", "link": "https://stackoverflow.com/users/7220501/james-mulholland"}, "edited": false, "score": 1, "creation_date": 1545217256, "post_id": 53849574, "comment_id": 94547107, "body": "My <code>Gemfile</code> and <code>.ruby-version</code> were correct, but it apperas I needed to run <code>rbenv rehash</code>. For anyone else trying, I ran <code>rbenv rehash</code> before but this did not work. My best guesses are that I needed to re-clone the repo, restart, or do something else to get this working."}], "tags": [], "owner": {"reputation": 1452, "user_id": 3182171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f212461e884c83b6a0542289a8562dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego D", "link": "https://stackoverflow.com/users/3182171/diego-d"}, "is_accepted": true, "score": 6, "last_activity_date": 1545216405, "creation_date": 1545216405, "answer_id": 53849574, "question_id": 53849374, "link": "https://stackoverflow.com/questions/53849374/rbenv-not-using-the-correct-version/53849574#53849574", "title": "Rbenv not using the correct version", "body": "<p>Try with this.</p>\n\n<p>In your rails project folder check the presence of <code>.ruby-version</code> file and put inside the same ruby version specified into Gemfile.\n(if this file is not present, create it.)</p>\n\n<p><strong>~/your-rails-project/.ruby-version</strong> file:</p>\n\n<pre><code>2.5.3\n</code></pre>\n\n<p><strong>~/your-rails-project/Gemfile</strong> file:</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.5.3'\n...\n</code></pre>\n\n<p>Then install that version with rbenv:</p>\n\n<pre><code>$ rbenv install 2.5.3\n$ rbenv rehash\n$ rbenv local 2.5.3\n$ rbenv global 2.5.3\n</code></pre>\n\n<p>Now check that you are using the right version with:</p>\n\n<pre><code>$ ruby -v\n</code></pre>\n"}], "owner": {"reputation": 1252, "user_id": 7220501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2RC3.jpg?s=128&g=1", "display_name": "James Mulholland", "link": "https://stackoverflow.com/users/7220501/james-mulholland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3146, "favorite_count": 0, "accepted_answer_id": 53849574, "answer_count": 1, "score": 1, "last_activity_date": 1545216964, "creation_date": 1545215783, "last_edit_date": 1545216964, "question_id": 53849374, "link": "https://stackoverflow.com/questions/53849374/rbenv-not-using-the-correct-version", "title": "Rbenv not using the correct version", "body": "<p>In my rails project, when I try to run <code>bundle install</code>, I get the following error:</p>\n\n<p><code>Your Ruby version is 2.3.7, but your Gemfile specified 2.5.3</code></p>\n\n<p>However, when I run <code>ruby --version</code> I get:</p>\n\n<p><code>ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-darwin18]</code></p>\n\n<p>...and running <code>rbenv version</code> gives me:</p>\n\n<p><code>2.5.3 (set by /Users/jamesmulholland/proj/repo-name/.ruby-version)</code></p>\n\n<p><strong><em>What is cauing this the wrong version of Ruby to be used here, and how do I fix it?</em></strong></p>\n\n<hr>\n\n<h3>Other Context and Failed Fixes</h3>\n\n<ul>\n<li><p>Running <code>rbenv versions</code> gives:\n<code>\nsystem\n2.5.3 (set by /Users/jamesmulholland/proj/repo-name/.ruby-version)`\n</code></p></li>\n<li><p>This issue has occurred during a move from Ruby 2.5.1 to Ruby 2.5.3. At the same time, I moved from rvm to rbenv. I suspect I may have uninstalled rvm incorrectly as I ran <code>rm -rf ~/.rvm</code> rather than <code>rvm implode</code> but <code>/etc/rbenv/</code> is empty and running <code>rvm</code> commands fails. <code>rvm</code> is removed from my <code>.zshrc</code>. When I continued to run into this issue after this method of uninstalling rvm, I reinstalled rvm and uninstalled using the <code>rvm implode</code> process in case there were any other traces of rvm left that were causing issues. This also failed to fix the issue.</p></li>\n<li>I completely removed the directory and pulled a fresh copy from GitHub. No success.</li>\n<li>Checking out an old commit does not fix the error (I get <code>Your Ruby version is 2.3.7, but your Gemfile specified 2.5.1</code> instead)</li>\n<li>The application runs fine on my colleague's computer.</li>\n<li>Potentially relevant section of my .zshrc (the rvm equivalent is commented out):\n<code>\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\n</code></li>\n<li><code>.ruby-version</code> is 2.5.3</li>\n<li><code>Gemfile</code> contains:\n<code>\nsource 'https://rubygems.org'\nruby \"2.5.3\"\n</code></li>\n</ul>\n"}, {"tags": ["ruby", "github-api", "octokit"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545203196, "post_id": 53845488, "comment_id": 94539875, "body": "You should include in your question the code you&#39;re using to generate an API response and then the output you get from ocktokit. See <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 0, "creation_date": 1545224350, "post_id": 53847160, "comment_id": 94550847, "body": "I tried <code>auto_paginate = true</code> that didn&#39;t work. The documentation mentions that all deployments will be listed but the function only returns the first 30 even when auto_paginate is true. I tried to do it manually in a loop by concat that works but how can i know how many pages to loop through?"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 0, "creation_date": 1545224745, "post_id": 53847160, "comment_id": 94551068, "body": "@sparkstar Which version of the gem are you using? And are you hitting the v3 API, or v4? I would just do a while loop until I hit an error. Then once you figure out what that error is modify your code to rescue from it. I don&#39;t have time to work up an example right now but will this evening."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 0, "creation_date": 1545224967, "post_id": 53847160, "comment_id": 94551195, "body": "@sparkstar can you try setting the results per. Page also? <a href=\"https://github.com/octokit/octokit.rb/blob/master/README.md#default-results-per_page\" rel=\"nofollow noreferrer\">github.com/octokit/octokit.rb/blob/master/&hellip;</a> see if you can even change that"}, {"owner": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 0, "creation_date": 1545280477, "post_id": 53847160, "comment_id": 94572794, "body": "<code>octokit (4.13.0)</code> and <code>v3</code> API"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 0, "creation_date": 1545312040, "post_id": 53847160, "comment_id": 94585905, "body": "@sparkstar I tested the gem myself and updated my answer. auto paginate doesn&#39;t work for deployments per the docs. You can put the get in a <code>while true</code>. My code sample is updated to reflect that and an early quit method."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 1, "creation_date": 1545312207, "post_id": 53847160, "comment_id": 94586012, "body": "Also, it doesn&#39;t appear to respect the client level per_page settings either"}, {"owner": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "edited": false, "score": 0, "creation_date": 1545643950, "post_id": 53847160, "comment_id": 94667076, "body": "Yup! I checked it as well using the loop for the time being hope they update it!"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 2, "last_activity_date": 1545312112, "last_edit_date": 1545312112, "creation_date": 1545207778, "answer_id": 53847160, "question_id": 53845488, "link": "https://stackoverflow.com/questions/53845488/how-to-fetch-all-the-deployed-commits-from-octokit-github-client-for-ruby/53847160#53847160", "title": "How to fetch all the deployed commits from octokit github client for ruby?", "body": "<p>Octokit provides <a href=\"https://github.com/octokit/octokit.rb#pagination\" rel=\"nofollow noreferrer\">pagination</a> but also auto-pagination.</p>\n\n<p>You may be able to do something like:</p>\n\n<pre><code>client.auto_paginate = true\ndeployments = client.deployments 'username/repository' # same as list_deployments\ndeployments.length\n</code></pre>\n\n<p>Update: I tested this locally and pagination in this manner, while documented, doesn't work as expected for deployments. You'll need to fetch the deployments manualy.</p>\n\n<p>The <a href=\"http://octokit.github.io/octokit.rb/Octokit/Client/Deployments.html\" rel=\"nofollow noreferrer\">deployment documentation</a> indicated that listing all deployments should be available in the latest version.</p>\n\n<p>If that doesn't work you may need to do it manually:</p>\n\n<pre><code># fetch your first list of deployments\ndeployments = client.deployments 'username/repository'\n\nwhile true\n  begin\n    deployments.concat client.last_response.rels[:next].get.data\n    puts deployments.length\n    break if deployments.length &gt; 500\n  rescue StandardError\n    puts 'quitting'\n  end\nend\n\nputs deployments.length\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 7125235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f17b4979ae1fda0c75e53599edf2b0?s=128&d=identicon&r=PG&f=1", "display_name": "sparkstar", "link": "https://stackoverflow.com/users/7125235/sparkstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 53847160, "answer_count": 1, "score": 0, "last_activity_date": 1545312112, "creation_date": 1545199865, "last_edit_date": 1545222062, "question_id": 53845488, "link": "https://stackoverflow.com/questions/53845488/how-to-fetch-all-the-deployed-commits-from-octokit-github-client-for-ruby", "title": "How to fetch all the deployed commits from octokit github client for ruby?", "body": "<p>I am using the ruby <code>Ocktokit</code> to fetch deployments (list_deployments). At present it only lists the latest 30. I need to filter this on the basis of payload and need to access all deployments till date.</p>\n\n<p>The Github Api provides a link in the header to access the next page. Is there something similar in Ocktokit?</p>\n\n<pre><code>client = Octokit::Client.new(\n  :access_token =&gt; ENV.fetch(\"GITHUB_TOKEN\"),\n)\n\nrepo = \"repo_name\"\nenv  = \"env_name\"\noptions = {\n    :environment =&gt; env,\n    :task =&gt; \"task_name\"\n  }\n\ndeployments = client.deployments(repo, options)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "variables", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "edited": false, "score": 0, "creation_date": 1545206231, "post_id": 53845337, "comment_id": 94541148, "body": "That looks good. But how would I write the second example if I only want &#39;record&#39; returned as a variable and not &#39;another_record&#39;?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "edited": false, "score": 0, "creation_date": 1545206286, "post_id": 53845337, "comment_id": 94541174, "body": "<code>record = ActiveRecord::Base.transaction { another_method() }</code>."}, {"owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "edited": false, "score": 0, "creation_date": 1545206706, "post_id": 53845337, "comment_id": 94541342, "body": "I&#39;m not sure that would work. I&#39;ve updated the complexity I&#39;m facing into my question. Essentially I still want to run &#39;another_method&#39; twice, but &#39;record&#39; is the variable name for only the first time it is run. Then when it is run the second time, &#39;record&#39; is also passed in as a variable into that. Sorry if that causes confusion."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "edited": false, "score": 2, "creation_date": 1545207012, "post_id": 53845337, "comment_id": 94541462, "body": "I do not follow. Assign the local variable inside a block and return it from the block, assigning the outer variable as shown above. <code>record = ActiveRecord::Base.transaction { r = another_method(1); another_method(r); r }</code>."}, {"owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "edited": false, "score": 0, "creation_date": 1545207176, "post_id": 53845337, "comment_id": 94541542, "body": "Ah okay, I think that is the most suitable way to write it. Thanks!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 12, "last_activity_date": 1545198920, "creation_date": 1545198920, "answer_id": 53845337, "question_id": 53845052, "link": "https://stackoverflow.com/questions/53845052/how-to-access-a-variable-that-was-created-in-a-transaction/53845337#53845337", "title": "How to access a variable that was created in a transaction?", "body": "<p>Declare <code>record</code> within method scope:</p>\n\n<pre><code>def method_name\n  record = nil # \u21d0 THIS\n\n  ActiveRecord::Base.transaction do\n    record = another_method(1)\n  end\n  puts record.id #\u21d2 ID or NoMethodError if `another_method` did not succeed\nend\n</code></pre>\n\n<hr>\n\n<p>Generally speaking, this approach is a code smell and is prohibited in most modern languages (where inner <code>record</code> would be closured and the outer remain unchanged.) The correct approach would be probably to make <code>transaction</code> to return a value and assign it to the record:</p>\n\n<pre><code>def method_name\n  record, another_record =\n    ActiveRecord::Base.transaction do\n      [another_method(1), another_method(2)]\n    end\n  puts record.id if record\nend\n</code></pre>\n"}], "owner": {"reputation": 690, "user_id": 2390233, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8cd867dfd775e56b1944f6f9af465bc?s=128&d=identicon&r=PG", "display_name": "ecki", "link": "https://stackoverflow.com/users/2390233/ecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 1, "accepted_answer_id": 53845337, "answer_count": 1, "score": 5, "last_activity_date": 1545206494, "creation_date": 1545197044, "last_edit_date": 1545206494, "question_id": 53845052, "link": "https://stackoverflow.com/questions/53845052/how-to-access-a-variable-that-was-created-in-a-transaction", "title": "How to access a variable that was created in a transaction?", "body": "<p>I'm using rails 4.2</p>\n\n<p>I have two db calls that both need to exist OR both not exist, so I'm using transactions inside a method in order to do that. I also want the variable I am creating to be accessible by other places in the same method. Do I just need to use an instance variable instead of a local variable? (for this I am using <code>puts</code> as an example of other code, the code am planning to execute is much more complicated than that).</p>\n\n<pre><code>def method_name\n  ActiveRecord::Base.transaction do\n    record = another_method(1)\n    another_method(record)\n  end\n  puts record.id\nend\n</code></pre>\n\n<p>If I ran this code, it throws this:</p>\n\n<pre><code>undefined local variable or method `record' for #&lt;Class:...&gt;\n</code></pre>\n\n<p>but changing <code>record</code> to <code>@record</code> will alleviate this. Is that really the best option? Or is there a better/more elegant way?</p>\n"}, {"tags": ["ruby", "therubyracer", "railsinstaller-windows"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1545195528, "post_id": 53844778, "comment_id": 94537294, "body": "In order to be traceable online you need to add the errors inside the question, not as an image."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545195797, "post_id": 53844778, "comment_id": 94537359, "body": "One of the dependencies listed in your error message for therubyracer is python2 (you have python3 installed it says). You should try installing python2 and then try to re-install therubyracer."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1545196302, "post_id": 53844778, "comment_id": 94537491, "body": "Like @JeroenHeier said, don&#39;t post screenshots of images. Screenshots are not helpful (for a lot of reasons). The errors you received are in plaintext; copy and paste the errors into your question and format them as a code block so we can see them directly in your post."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545199331, "post_id": 53844778, "comment_id": 94538362, "body": "The error message says that you don&#39;t have Python 2 installed. Did you try installing Python 2?"}, {"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545200771, "post_id": 53844778, "comment_id": 94538850, "body": "I have installed Python 2.7, but the error still persists."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545272691, "post_id": 53844973, "comment_id": 94571344, "body": "I followed the link you sent me and I followed the options, and then I required the files, and I got this error when running it...  C:\\Users\\joelg\\Desktop\\GitMe\\RubySinatra\\SinatraExcercise\\Si&zwnj;&#8203;natraCH6&gt;ruby main.rb C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/rubygems/core_ext&zwnj;&#8203;/kernel_require.rb:6&zwnj;&#8203;8:in `require&#39;: 126: The specified module could not be found.   - C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/theruby&zwnj;&#8203;racer-0.11.0beta1-x8&zwnj;&#8203;6-mingw32/lib/v8/ini&zwnj;&#8203;t.so (LoadError)"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545273306, "post_id": 53844973, "comment_id": 94571451, "body": "Does the file <code>C:&#47;RailsInstaller&#47;Ruby2.3.3&#47;lib&#47;ruby&#47;gems&#47;2.3.0&#47;gems&#47;theruby&zwnj;&#8203;racer-0.11.0beta1-x8&zwnj;&#8203;6-mingw32&#47;lib&#47;v8&#47;ini&zwnj;&#8203;t.so</code> exist?"}, {"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545273617, "post_id": 53844973, "comment_id": 94571516, "body": "Yes it does, I followed the directory and still nothing, and its right there"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545275093, "post_id": 53844973, "comment_id": 94571783, "body": "Try adding <code>C:&#47;RailsInstaller&#47;Ruby2.3.3&#47;lib&#47;ruby&#47;gems&#47;2.3.0&#47;gems&#47;theruby&zwnj;&#8203;racer-0.11.0beta1-x8&zwnj;&#8203;6-mingw32&#47;lib&#47;v8&#47;</code> to your <code>PATH</code> and retry the operation."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545283345, "post_id": 53844973, "comment_id": 94573463, "body": "This is the point where I recommend you install <a href=\"https://docs.microsoft.com/en-us/windows/wsl/install-win10\" rel=\"nofollow noreferrer\">WSL</a> and do this on Linux because the problems you&#39;re experiencing are the exact reason people don&#39;t use Windows and Ruby together."}, {"owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "edited": false, "score": 0, "creation_date": 1545514241, "post_id": 53844973, "comment_id": 94644317, "body": "Thank you for the advice, I switched to WSL, and everything works, but now I have another issue with LoadError regarding dm-postgres-adapter, already posted a question about it if you want to look, thanks again."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545203356, "last_edit_date": 1545203356, "creation_date": 1545196534, "answer_id": 53844973, "question_id": 53844778, "link": "https://stackoverflow.com/questions/53844778/gem-install-therubyracer-fails-with-error-message-libv8-requires-python-2-to/53844973#53844973", "title": "&quot;gem install therubyracer&quot; fails with error message &quot;libv8 requires python 2 to be installed in order to build&quot;", "body": "<p>Download the python 2.7 installer for Windows from <a href=\"https://www.python.org/downloads/release/python-2715/\" rel=\"nofollow noreferrer\">https://www.python.org/downloads/release/python-2715/</a> and run it. After python 2.7 has been installed, retry <code>gem install therubyracer</code>.</p>\n\n<p>Update:</p>\n\n<p>Since you said you have done this and it still doesn't work, please consider reading the options at <a href=\"https://stackoverflow.com/questions/16514758/gem-install-libv8-version-3-11-8-17-on-ruby-windows\">this question</a> as well.</p>\n"}], "owner": {"reputation": 139, "user_id": 10809113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6At-0l8lnSc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g9X6dY7bVguQPi1yhCXLM6iYHudA/mo/photo.jpg?sz=128", "display_name": "JHero23", "link": "https://stackoverflow.com/users/10809113/jhero23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545203356, "creation_date": 1545195088, "last_edit_date": 1545196563, "question_id": 53844778, "link": "https://stackoverflow.com/questions/53844778/gem-install-therubyracer-fails-with-error-message-libv8-requires-python-2-to", "title": "&quot;gem install therubyracer&quot; fails with error message &quot;libv8 requires python 2 to be installed in order to build&quot;", "body": "<p>I am following a tutorial for using Ruby and Sinatra.</p>\n\n<p>I am using Windows 10. I downloaded RailsInstaller and I was following a section where I need to install the gems <code>coffee-script</code> and <code>therubyracer</code>. <code>coffee-script</code> installed but not <code>therubyracer</code>, I get an error like this...\n<a href=\"https://i.stack.imgur.com/LgPvn.png\" rel=\"nofollow noreferrer\">'therubyracer' error installation image</a></p>\n\n<p>I tried to install the gem <code>libv8</code> but that didn't work for me either. I get this error...\n<a href=\"https://i.stack.imgur.com/LDeTn.png\" rel=\"nofollow noreferrer\">'libv8' error installation image</a></p>\n\n<p>How can I resolve these errors and install <code>therubyracer</code> on Windows 10?</p>\n"}, {"tags": ["ruby", "process", "fork", "sinatra"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545194282, "post_id": 53844598, "comment_id": 94537028, "body": "<code>system(&quot;ruby app.rb &amp;&quot;)</code> to start it in a separate process"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545195106, "post_id": 53844598, "comment_id": 94537209, "body": "Thanks, but that above doesn&#39;t actually solve the problem. I&#39;m still getting the same error message: <code>app.rb:1:in &#39;require&#39;: cannot load such file -- sinatra (LoadError) \tfrom app.rb:1:in &#39;&lt;main&gt;&#39;</code>"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545195200, "post_id": 53844598, "comment_id": 94537228, "body": "I would guess that the <code>system</code> call ends up not being in the directory that you expect (probably whatever folder that ruby is actually installed in), and you should instead provide an absolute path to the app.rb file. In the Rails world, I\u2019d try prefixing it with <code>Rails.root</code>. Not sure if Sinatra has anything similar to get your app root dir easily."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1545199770, "post_id": 53844598, "comment_id": 94538495, "body": "Looks like a versioning issue. Do you use some ruby version manager, like <code>rvm</code>, <code>rbenv</code> or like? If yes, I\u2019d suggest you should export the respective <code>PATH</code> from your script, since <code>system</code> would not load all your dotfiles."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "reply_to_user": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545361551, "post_id": 53844598, "comment_id": 94604514, "body": "I suspect @Nate is onto something. I&#39;d check the environment for both. For example, when a bundle is installed with --path, bundler sets the GEM_HOME environment variable to point to the path given, tools maybe a factor. If Sinatra isn&#39;t in the current gem home then the interpreter isn&#39;t going to find it. You could add it to the load path yourself but that&#39;s obviously a bother. Forking won&#39;t change the environment. You might check by <code>cd</code>ing to the app dir first with your system command, or manipulating the load path in the Sinatra app just to see."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545940796, "post_id": 53844598, "comment_id": 94738995, "body": "@Nate: I tried <code>&#47;Users&#47;lsanger&#47;.rvm&#47;rubies&#47;ruby-2.5.0&#47;bin&#47;ruby app.rb</code> -- is that what you mean? I also tried spelling out the full path of <code>app.rb</code> in case that&#39;s what you meant. It didn&#39;t make any difference in any case. The command line script (Revuu) does <code>cd</code> to the app directory before running <code>ruby</code> on the app file."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1545941102, "post_id": 53844598, "comment_id": 94739089, "body": "@AlekseiMatiushkin, yes, I do use rvm. Sorry, but I just don&#39;t know how I&#39;d go about exporting the respective <code>PATH</code> from my script. Can you explain a bit more so I can search about how to do what you&#39;re suggesting?"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1545941490, "post_id": 53844598, "comment_id": 94739213, "body": "@iain, as with Aleksei, I just don&#39;t know how to implement your suggestions. How do I check the environment? What would I be looking for? What does it mean to say Sinatra is or isn&#39;t in the &quot;current gem home&quot;? Clearly something is missing from my Ruby education...please give me a pointer to necessary background. TIA..."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545952860, "post_id": 53844598, "comment_id": 94742446, "body": "@globewalldesk I was thinking you would want an absolute path on the \u201capp.rb\u201d part, since that\u2019s the file that it can\u2019t seem to find. But the point about the ruby file is interesting as well. Can you output <code>which ruby</code> from inside your system call? That would let you know the path to the ruby executable that it\u2019s using (theoretically it\u2019s the rvm one you posted in the comments). I\u2019m not sure exactly what you\u2019re trying to do, but if it were me, I\u2019d use Ruby on Rails and a Rake task. I think it would make your life easier. I know that\u2019s a big change though, and not what you are asking for."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545957482, "post_id": 53844598, "comment_id": 94743439, "body": "@Nate I&#39;m pretty sure it&#39;s finding app.rb, because it&#39;s complaining that it can&#39;t find <code>sinatra</code> in <code>app.rb:1</code>. Line 1 of app.rb is where Sinatra is required. So it&#39;s locating the file.  <code>which ruby</code> output = <code>&#47;home&#47;globewalldesk&#47;.rvm&#47;rubies&#47;ruby-2.4.0&#47;bin&#47;ruby</code> (on a diff computer from above).  The app is <a href=\"https://github.com/globewalldesk/revuu\" rel=\"nofollow noreferrer\">here</a>. I can easily set up a Rakefile and a Gemfile (I&#39;ve tried the latter in the course of working on this issue). The app basically runs code snippets the user types in in answer to coding challenges. Some snippets start servers, so..."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545957715, "post_id": 53844598, "comment_id": 94743483, "body": "Oh crap. How did I not realize this...? Finding app.rb was never the problem... So, how do you have Sinatra installed? Is it via bundler or a global gem install? Maybe you need to do <code>system(&#39;bundle exec ruby app.rb&#39;)</code>?"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1545958287, "post_id": 53844598, "comment_id": 94743564, "body": "Makes sense. Let me try that out (again? I&#39;ve tried a lot).  Sinatra is a global gem install and I just require it on the first line of the Sinatra script. I can make a Gemfile and use <code>bundle exec</code>...thought I did this, but maybe not.  As I said in the question, when I include Sinatra in the command line (Revuu) app&#39;s Gemfile, it actually works when I call system(&quot;ruby app.rb&quot;), but this results in a Sinatra server running in the background of Revuu. Very weird..."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1545963649, "post_id": 53844598, "comment_id": 94744479, "body": "Update: I put the Sinatra requirement in a Gemfile, and the command now executed by <code>system()</code> is: <code>cd data&#47;repos&#47;movies&amp;&amp;bundle exec ruby app.rb</code>. I even put <code>bundle install</code> in there just before <code>bundle exec</code>, and it made no difference. Now the error is, unsurprisingly, <code>app.rb:3:in </code>&lt;main&gt;&#39;: undefined method <code>enable&#39; for main:Object (NoMethodError)</code>. Line 3 = <code>enable :sessions</code>, a Sinatra method call."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1545963760, "post_id": 53844598, "comment_id": 94744502, "body": "Update 2: To replicate the problem with a different gem: I required Colorize in the Gemfile and added a new line 3: <code>puts &quot;I am yellow!&quot;.colorize(:yellow)</code>. As expected, the interpreter says, <code>app.rb:3:in </code>&lt;main&gt;&#39;: undefined method <code>colorize&#39; for &quot;I am yellow!&quot;:String (NoMethodError)</code>. So it&#39;s not a Sinatra issue."}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1545966975, "post_id": 53844598, "comment_id": 94744948, "body": "<a href=\"https://medium.com/@connorstack/understanding-ruby-load-require-gems-bundler-and-rails-autoloading-from-the-bottom-up-3b422902ca0\" rel=\"nofollow noreferrer\">medium.com/@connorstack/&hellip;</a> Scroll down to the \u201cHow does Rails load all my gems?\u201d section. Can you try adding those two lines to your app.rb file before the require sinatra line? I think the real problem is that the gems are not loaded in yet, and these two lines should help."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1546000377, "post_id": 53844598, "comment_id": 94754834, "body": "Thanks for the help. I added those two lines (the <code>ENV</code> line was new), but...no difference."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1546140721, "post_id": 53844598, "comment_id": 94787808, "body": "Hi again, globewalldesk. Some quick questions - 1) Is the revuu app installed as a gem (via Bundler or not) and then run from the same directory as the Sinatra app? 2) Have you sandboxed the Bundle? e.g. <code>bundle install --binstubs --path=vendor.noindex</code>. You could remove the <code>.bundle</code> and <code>Gemfile.lock</code> to start with a clean slate."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1546140891, "post_id": 53844598, "comment_id": 94787825, "body": "To see the env either put <code>warn ENV.inspect</code> in the calling revuu&#39;s file, or you could use <code>echo $GEM_ROOT</code>, <code>echo $GEM_PATH</code> and <code>echo $GEM_HOME</code> in the directory you run it from. There&#39;s also <code>bundle env</code> to look at. <a href=\"https://stackoverflow.com/a/11277228/335847\">stackoverflow.com/a/11277228/335847</a>"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1546825248, "post_id": 53844598, "comment_id": 94968376, "body": "@iain and all: Thanks very much. You set me on the right path. I figured it out. See my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 1, "creation_date": 1546829146, "post_id": 54067699, "comment_id": 94969053, "body": "Glad you found the answer (and should we feel proud or scared that a 12 year old beat us to the punch? (0_&#186;) :)  Take a look at <a href=\"https://stackoverflow.com/a/37329716/335847\">this flow chart</a> and <a href=\"https://ruby-doc.org/core-2.6/Process.html#method-c-kill\" rel=\"nofollow noreferrer\"><code>Process.kill</code></a>."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 1, "creation_date": 1546829823, "post_id": 54067699, "comment_id": 94969137, "body": "Wow, that&#39;s a fantastic flow chart. OK, I think I know what I&#39;m going to have to do."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 1, "creation_date": 1546834701, "post_id": 54067699, "comment_id": 94969964, "body": "I probably use it daily, so helpful. I can also recommend Jesse Storimer&#39;s book Working with Unix Processes, but there&#39;s other good stuff out there on the subject."}], "tags": [], "owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "is_accepted": true, "score": 1, "last_activity_date": 1546828668, "last_edit_date": 1546828668, "creation_date": 1546825944, "answer_id": 54067699, "question_id": 53844598, "link": "https://stackoverflow.com/questions/53844598/how-to-run-app-via-ruby-shell-command-when-same-command-works-on-command-line/54067699#54067699", "title": "How to run app via Ruby shell command, when same command works on command line", "body": "<p><em>Self-answered, since I found a solution, and nobody else has answered it:</em></p>\n\n<p>Instead of executing just <code>ruby app.rb</code>, which by itself runs in the same environment as the surrounding program and hence uses the same Gemfile (ignoring the one referred to in the spawned script), execute:</p>\n\n<pre><code>system(\"BUNDLE_GEMFILE='./Gemfile' &amp;&amp; ruby app.rb\")\n</code></pre>\n\n<p>That's all there was to it! This tells Ruby to load the correct gemfile when it runs the program.</p>\n\n<hr>\n\n<p><em>Personal note:</em> Many thanks to all of you in the discussion, above, on the question, as well as the local Ruby group, my best friend, and my 12-year-old coder son (who actually supplied the exact code). Now I just have to figure out how to <em>stop</em> the spawned process without stopping the surrounding program. Can't just use \"Ctrl-C.\" But that's a different problem!</p>\n"}], "owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 54067699, "answer_count": 1, "score": 2, "last_activity_date": 1546828668, "creation_date": 1545193679, "last_edit_date": 1545930591, "question_id": 53844598, "link": "https://stackoverflow.com/questions/53844598/how-to-run-app-via-ruby-shell-command-when-same-command-works-on-command-line", "title": "How to run app via Ruby shell command, when same command works on command line", "body": "<p>I have a simple Ruby (Sinatra) server that starts up without issue from the command line with <code>ruby app.rb</code>. But when I execute the same command via my <a href=\"https://github.com/globewalldesk/revuu\" rel=\"nofollow noreferrer\">command line app</a>, either with <code>`ruby app.rb`</code> or with <code>system(\"ruby app.rb\")</code>, I get this error:</p>\n\n<pre><code>app.rb:1:in `require': cannot load such file -- sinatra (LoadError)\n    from app.rb:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>The opening line of <code>app.rb</code> is simply <code>require 'sinatra'</code>. The Sinatra gem is installed in my system, of course; I don't understand why the interpreter is acting as if it's not there.</p>\n\n<p>While troubleshooting, I decided to add Sinatra to the Gemfile of the command line app that is calling <code>app.rb</code>. Lo and behold, now that the parent process has access to Sinatra, now it works (i.e., <code>system(app.rb)</code> successfully starts the Sinatra server). But when I exit the command line app, a Sinatra server is always there, saying:</p>\n\n<pre><code>[2018-12-18 23:17:37] INFO  WEBrick 1.3.1\n[2018-12-18 23:17:37] INFO  ruby 2.4.0 (2016-12-24) [x86_64-linux]\n== Sinatra (v2.0.4) has taken the stage on 4567 for development with backup from WEBrick\n[2018-12-18 23:17:37] INFO  WEBrick::HTTPServer#start: pid=27384 port=4567\n</code></pre>\n\n<p>So I have to Ctrl-c to exit the command line app.</p>\n\n<p>Question: Is there a way to spawn an independent Sinatra process/server, as I was trying to do with <code>system(\"ruby app.rb\")</code>, without installing it in the parent app (the command line app)? I also tried using Process.fork followed by Process.wait, but that didn't help.</p>\n"}, {"tags": ["ruby", "rubygems", "compass"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545193772, "post_id": 53844381, "comment_id": 94536927, "body": "Are you using bundler at all? I feel like none of this should break as long as you&#39;ve installed rb-inotify and specified the version (either in your Gemfile or on your system). Compass is deprecated and hasn&#39;t been updated in 4 years and Ruby 1.9.3 was EOL years ago"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545194007, "post_id": 53844381, "comment_id": 94536967, "body": "Just run <code>gem install rb-inotify -v 0.9.10</code> then run <code>gem install compass</code>. Works perfectly. It even tells you to do this in the error message when installing compass before rb-inotify is installed: <code>The last version of rb-inotify (&gt;= 0.9) to support your Ruby &amp; RubyGems was 0.9.10. Try installing it with gem install rb-inotify -v 0.9.10 and then running the current command again</code>"}, {"owner": {"reputation": 1863, "user_id": 1038564, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001218360944/picture?type=large", "display_name": "Tyler V.", "link": "https://stackoverflow.com/users/1038564/tyler-v"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545198983, "post_id": 53844381, "comment_id": 94538248, "body": "@anothermh I did try that, but never had any luck, almost as if installing compass tried to reinstall rb-inotify despite me explicitly installing an older version."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545199770, "post_id": 53844381, "comment_id": 94538496, "body": "Then do gem uninstall for both and start from scratch."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 5, "last_activity_date": 1545202451, "creation_date": 1545202451, "answer_id": 53846021, "question_id": 53844381, "link": "https://stackoverflow.com/questions/53844381/did-the-update-to-rb-inotify-just-break-compass-on-ruby-1-x/53846021#53846021", "title": "Did the update to rb-inotify just break compass on Ruby 1.x?", "body": "<blockquote>\n  <p>Have I understood this correctly? Has <code>rb-inotify</code> now broken simple commands like <code>gem install compass</code> on Ruby 1.x?</p>\n</blockquote>\n\n<p>No, it is not <code>rb-inotify</code> that has broken anything.</p>\n\n<p>The <code>compass</code> gem has a dependency on <code>rb-inotify &gt;= 0.9</code>, which means that the author of the <code>compass</code> gem claims that Compass will work with <em>every version ever released in the future, even 10000 years from now, no matter how many changes there are</em>. As you have discovered, this claim is wrong, so the problem is with Compass, not with rb-inotify.</p>\n\n<p>I couldn't find a versioning policy on the rb-inotify homepage, so relying on any particular versioning policy (and in particular relying on \"there will never be backwards-incompatible changes, ever\") is just wrong. Even if we assume that rb-inotify follows SemVer, SemVer actually allows arbitrary changes before 1.0.</p>\n\n<p>In short: the gem dependency in Compass is wrong. It should be something like <code>rb-inotify == 0.9.0</code> or <em>at most</em> <code>rb-inotify ~&gt; 0.9.0</code>, but clearly not \"any version newer than 0.9.0, no matter how many changes there are\".</p>\n\n<blockquote>\n  <p>What is the best way to fix this without updating Ruby?</p>\n</blockquote>\n\n<p>If you install <code>rb-inotify</code> version 0.9.0 <em>and only that version</em> (or at least no newer version) <em>before</em> installing Compass, then the gem requirement will already be satisfied, and RubyGems will not try to install any newer version of <code>rb-inotify</code> (unless and until you install another gem that requires a higher version).</p>\n\n<hr>\n\n<p>Now, a question you didn't ask:</p>\n\n<blockquote>\n  <p>What is the best way to fix this?</p>\n</blockquote>\n\n<p>You should really consider updating your Ruby installation. I am assuming by \"Ruby 1.9.3\", you actually mean \"YARV 1.9.3\", which has not been maintained, updated, received bugfixes, and most importantly, received security fixes, since February 23rd, 2015.</p>\n"}], "owner": {"reputation": 1863, "user_id": 1038564, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001218360944/picture?type=large", "display_name": "Tyler V.", "link": "https://stackoverflow.com/users/1038564/tyler-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2024, "favorite_count": 0, "accepted_answer_id": 53846021, "answer_count": 1, "score": 0, "last_activity_date": 1545202451, "creation_date": 1545191966, "last_edit_date": 1545193603, "question_id": 53844381, "link": "https://stackoverflow.com/questions/53844381/did-the-update-to-rb-inotify-just-break-compass-on-ruby-1-x", "title": "Did the update to rb-inotify just break compass on Ruby 1.x?", "body": "<p>On December 15th <a href=\"https://rubygems.org/gems/rb-inotify\" rel=\"nofollow noreferrer\">the <code>rb-inotify</code> gem</a> was updated to the version <code>0.10.0</code> which now requires <code>Ruby 2.2</code> or later. <a href=\"https://rubygems.org/gems/compass/\" rel=\"nofollow noreferrer\">The <code>compass</code> gem</a> has a runtime dependency of <code>rb-inotify &gt;= 0.9</code> which appears to now automatically include version <code>0.10.0</code>. Thus on Ruby 1.9.3 when you install <code>compass</code>, the installation of <code>rb-inotify</code> fails, causing the installation of <code>compass</code> to fail.</p>\n\n<p>Have I understood this correctly? Has <code>rb-inotify</code> now broken simple commands like <code>gem install compass</code> on Ruby 1.x? What is the best way to fix this without updating Ruby?</p>\n"}, {"tags": ["javascript", "ruby", "cucumber", "cucumberjs"], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 3431558, "user_type": "registered", "profile_image": "https://graph.facebook.com/531587817/picture?type=large", "display_name": "twomarktwo", "link": "https://stackoverflow.com/users/3431558/twomarktwo"}, "edited": false, "score": 0, "creation_date": 1563409537, "post_id": 53853253, "comment_id": 100694073, "body": "Thanks! I have been searching for ages on how to do this, but I guess it&#39;s time to give up.  It would have been nice to group some common assertions together simply by creating an aggregate statement in the feature file... Ahh well"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1545246739, "last_edit_date": 1545246739, "creation_date": 1545229508, "answer_id": 53853253, "question_id": 53843747, "link": "https://stackoverflow.com/questions/53843747/how-can-i-combine-steps-in-cucumber-js-as-described-in-the-ruby-cucumber-documen/53853253#53853253", "title": "How can I combine steps in Cucumber.js as described in the Ruby Cucumber documentation?", "body": "<p>In short you can't, and most likely wont ever be able to do this directly in cucumber-js. </p>\n\n<p>Matt Wynne and Aslak Hellesoy seem to have regrets about ever implementing this concept in cucumber-ruby and suggest using helper methods instead. </p>\n\n<blockquote>\n  <p>aslakhellesoy commented on Oct 16, 2012</p>\n  \n  <p>Calling steps from stepdefs is one of those features I wish I never added to Cucumber(-Ruby), because it provides so much rope for people to hang themselves with. It came to be because Ruby stepdefs use anonymous closures that you can't call from elsewhere (unless you go through hoops).</p>\n  \n  <p>With JavaScript it's a different situation; Step Definitions use first class functions!</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>mattwynne commented on Aug 27, 2014</p>\n  \n  <p>I suggest you use helper methods on your World to achieve this kind of reuse. We implemented this feature (we call it \"nested steps\") in the Ruby Cucumber, and it's been hard to maintain, and led to some very complex dependencies in people's test code.</p>\n</blockquote>\n\n<p>Apparently Julien Biezemans agrees </p>\n\n<blockquote>\n  <p>jbpros commented on Aug 13, 2014</p>\n  \n  <p>Thanks @cono for the PR. However, as has been discussed before this will not be implemented in Cucumber.js.</p>\n</blockquote>\n\n<p>More on the subject: </p>\n\n<ul>\n<li><a href=\"https://github.com/cucumber/cucumber-js/issues/11\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber-js/issues/11</a></li>\n<li><a href=\"https://github.com/cucumber/cucumber-js/issues/237\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber-js/issues/237</a> </li>\n<li><a href=\"https://github.com/cucumber/cucumber-js/issues/473\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber-js/issues/473</a></li>\n<li><a href=\"https://github.com/cucumber/cucumber-js/pull/223\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber-js/pull/223</a></li>\n</ul>\n"}], "owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545246739, "creation_date": 1545186561, "question_id": 53843747, "link": "https://stackoverflow.com/questions/53843747/how-can-i-combine-steps-in-cucumber-js-as-described-in-the-ruby-cucumber-documen", "title": "How can I combine steps in Cucumber.js as described in the Ruby Cucumber documentation?", "body": "<p>Here: <a href=\"https://relishapp.com/cucumber/cucumber/docs/defining-steps/nested-steps#use-#steps-to-call-several-steps-at-once\" rel=\"nofollow noreferrer\">https://relishapp.com/cucumber/cucumber/docs/defining-steps/nested-steps#use-#steps-to-call-several-steps-at-once</a></p>\n\n<p>I don't have a code sample for what I mean except to say that I'd like to combine and execute multiple steps in aggregate within a single step (think: code reuse). I have no clue of how to accomplish this using Cucumber.js; the documentation is a bit sketchy. :-\\</p>\n"}, {"tags": ["ruby", "hash", "each"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545187151, "post_id": 53843659, "comment_id": 94535607, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/812541/how-to-change-hash-values\">How to change Hash values?</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545191420, "post_id": 53843659, "comment_id": 94536430, "body": "@anothermh, a dup? Yes, I think so, but it nicely illustrates the pitfalls of closing a question for that reason. In this case the method <code>transform_values!</code> would not make it into the Ruby core until eight years after the original question was asked. Also, we&#39;ve all seen answers offered to questions that were far superior to the answers given to the earlier question. Of course, the great answer could always be added to those given to the duped question, but it won&#39;t have much visibility, particularly when, as here, the duped question is ancient. I don&#39;t have an answer, but it is a problem."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545192044, "post_id": 53843659, "comment_id": 94536562, "body": "@CarySwoveland I would prefer seeing this question closed as a duplicate so users are directed to the one linked above, where you will find <code>transform_values</code> as the second highest voted answer with a score of 61. It would seem that the issue of &quot;visibility&quot; for that answer is non-existent; I don&#39;t agree that there is any problem with closing this."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545200004, "post_id": 53843659, "comment_id": 94538567, "body": "I hadn&#39;t noticed that answer, which was submitted eight years after the question wss posted, but yes, you have a point."}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 0, "last_activity_date": 1545192580, "last_edit_date": 1545192580, "creation_date": 1545186776, "answer_id": 53843776, "question_id": 53843659, "link": "https://stackoverflow.com/questions/53843659/update-values-in-a-hash/53843776#53843776", "title": "Update values in a hash", "body": "<p>Within the block, make sure you are modifying the hash by using <code>=</code>:</p>\n\n<pre><code>extinct_animals.each { |animal, year| extinct_animals[animal] = year - 3 }\n=&gt; {\n  \"Passenger Pigeon\" =&gt; 1911,\n  \"Tasmanian Tiger\" =&gt; 1933,\n  \"Eastern Hare Wallaby\" =&gt; 1887,\n  \"Dodo\" =&gt; 1659,\n  \"Pyrenean Ibex\" =&gt; 1997,\n  \"West African Black Rhinoceros\" =&gt; 2008,\n  \"Laysan Crake\" =&gt; 1920\n}\n</code></pre>\n\n<p>Don't use <code>puts</code>. That just writes out to the console.</p>\n\n<p>A more brief version of this solution would be:</p>\n\n<pre><code>extinct_animals.each { |animal, _year| extinct_animals[animal] -= 3 }\n</code></pre>\n\n<p>Here we prefix <code>year</code> with an underscore to indicate that the variable is not used within the block.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1545188823, "last_edit_date": 1545188823, "creation_date": 1545188480, "answer_id": 53843992, "question_id": 53843659, "link": "https://stackoverflow.com/questions/53843659/update-values-in-a-hash/53843992#53843992", "title": "Update values in a hash", "body": "<p>You'll want to use <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_values-21\" rel=\"noreferrer\">Hash#transform_values!</a>, which made its debut in MRI v2.4:</p>\n\n<pre><code>extinct_animals.transform_values! { |v| v - 3 }\n  #=&gt; {\"Passenger Pigeon\"=&gt;1911, \"Tasmanian Tiger\"=&gt;1933,\n  #    \"Eastern Hare Wallaby\"=&gt;1887, \"Dodo\"=&gt;1659, \"Pyrenean Ibex\"=&gt;1997,\n  #    \"West African Black Rhinoceros\"=&gt;2008, \"Laysan Crake\"=&gt;1920}\n\nextinct_animals\n  #=&gt; {\"Passenger Pigeon\"=&gt;1911, \"Tasmanian Tiger\"=&gt;1933,\n  #    \"Eastern Hare Wallaby\"=&gt;1887, \"Dodo\"=&gt;1659, \"Pyrenean Ibex\"=&gt;1997,\n  #    \"West African Black Rhinoceros\"=&gt;2008, \"Laysan Crake\"=&gt;1920}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10271891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47453134efa76e9a9cac7281925137ba?s=128&d=identicon&r=PG&f=1", "display_name": "jmk929", "link": "https://stackoverflow.com/users/10271891/jmk929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53843776, "answer_count": 2, "score": 2, "last_activity_date": 1545195373, "creation_date": 1545185620, "last_edit_date": 1545195373, "question_id": 53843659, "link": "https://stackoverflow.com/questions/53843659/update-values-in-a-hash", "title": "Update values in a hash", "body": "<p>I am trying to update my hash's values after subtracting the values by three. For example,</p>\n\n<pre><code>extinct_animals = {\n  \"Passenger Pigeon\" =&gt; 1914,\n  \"Tasmanian Tiger\" =&gt; 1936,\n  \"Eastern Hare Wallaby\" =&gt; 1890,\n  \"Dodo\" =&gt; 1662,\n  \"Pyrenean Ibex\" =&gt; 2000,\n  \"West African Black Rhinoceros\" =&gt; 2011,\n  \"Laysan Crake\" =&gt; 1923\n}\n</code></pre>\n\n<p>I have this code, which sets the values to subtract three:</p>\n\n<pre><code>extinct_animals.each {|animal, year| puts year - 3}\n</code></pre>\n\n<p>and the output:</p>\n\n<pre><code>1911\n1933\n1887\n1659\n1920\n</code></pre>\n\n<p>How do I return the entire hash with the keys and new values?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 0, "creation_date": 1545243713, "post_id": 53843480, "comment_id": 94561971, "body": "First of all: thank you very much for your answer. I really appreciate it, since It solves my concrete problem, I upvote it, and I&#39;ll eventually use your approach. However, in addition to the fact that the meta generation approach would take fewer lines (at least one), I still wonder how could one forward an entire block to a meta generator. Just for enriching the knowledge."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 0, "creation_date": 1545261932, "post_id": 53843480, "comment_id": 94569058, "body": "@Irlean Added the metaprogramming approach as well. If you are happy, mark it the right answer."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545277135, "post_id": 53843480, "comment_id": 94572174, "body": "You are not checking the arguments so you can call method1 with 0 or 100 arguments. Also as in my post I believe this should be <code>yield(*args)</code> as right now you are yielding a single Array"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545277305, "post_id": 53843480, "comment_id": 94572199, "body": "@engineersmnky The number of arguments for each method is not dynamic as per OP. They are fixed, but different for each method. Reg <code>yield</code>, I think <code>yield(args)</code> should pass multiple parameters. Please check the 2nd fiddle link in my answer"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545278889, "post_id": 53843480, "comment_id": 94572500, "body": "Yes, what&#39;s the issue in param2 (<a href=\"http://rubyfiddle.com/riddles/81b9d/2\" rel=\"nofollow noreferrer\">rubyfiddle.com/riddles/81b9d/2</a>):?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1545308993, "post_id": 53843480, "comment_id": 94584417, "body": "Sorry you were correct about the yielding. My point with the arguments was when <code>define_operation</code> defines a method it  accepts 0+ arguments so <code>MyClass.new.method1</code> is equally as acceptable as <code>MyClass.new.method1(*(1..100).to_a)</code>"}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": false, "score": 7, "last_activity_date": 1545278876, "last_edit_date": 1545278876, "creation_date": 1545183925, "answer_id": 53843480, "question_id": 53843397, "link": "https://stackoverflow.com/questions/53843397/how-to-forward-a-block-to-a-method-that-generates-methods/53843480#53843480", "title": "How to forward a block to a method that generates methods", "body": "<p>You do not need metaprogramming to achieve this. Just add a new method that wraps the common logic like below:</p>\n\n<pre><code>class MyClass\n\n  def method1(param1)\n    run_with_recovery(param1) do |param1|\n       # implementation method1\n    end\n  end\n\n  def method2(param1, param2)\n    run_with_recovery(param1, param2) do |param1, param2|\n       # implementation method2\n    end\n  end\n\n  private\n\n  def run_with_recovery(*params)\n    preamble\n    yield(*params)\n    rescue StandardError =&gt; e\n      recovery\n  end\nend\n</code></pre>\n\n<p>Test it here: <a href=\"http://rubyfiddle.com/riddles/4b6e2\" rel=\"nofollow noreferrer\">http://rubyfiddle.com/riddles/4b6e2</a></p>\n\n<hr>\n\n<p>If you really wanted to do metaprogramming, this will work:</p>\n\n<pre><code>class MyClass\n\n  def self.define_operation(op_name)\n    define_method(op_name.to_s) do |*args|\n      begin\n        puts \"preamble\"\n        yield(args)\n      rescue StandardError =&gt; e\n        puts \"recovery\"\n      end\n    end\n  end\n\n  define_operation :method1 do |param1|\n    puts param1\n  end\n\n  define_operation :method2 do |param1, param2|\n    puts param1\n    puts param2\n  end\n\nend\n\nMyClass.new.method1(\"hi\")\nMyClass.new.method2(\"hi\", \"there\")\n</code></pre>\n\n<p>Test this here: <a href=\"http://rubyfiddle.com/riddles/81b9d/2\" rel=\"nofollow noreferrer\">http://rubyfiddle.com/riddles/81b9d/2</a></p>\n"}, {"comments": [{"owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "edited": false, "score": 0, "creation_date": 1545495521, "post_id": 53859118, "comment_id": 94640194, "body": "I think this clarifies my doubts. Thanks"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1545312180, "last_edit_date": 1545312180, "creation_date": 1545253417, "answer_id": 53859118, "question_id": 53843397, "link": "https://stackoverflow.com/questions/53843397/how-to-forward-a-block-to-a-method-that-generates-methods/53859118#53859118", "title": "How to forward a block to a method that generates methods", "body": "<p>If I understand correctly you are looking for something like:</p>\n\n<pre><code>class Operation\n  def self.op(name,&amp;block)\n    define_method(name) do |*args|\n      op_wrap(block.arity,*args,&amp;block)\n    end\n  end\n\n  def op_wrap(arity=0,*args)\n    if arity == args.size || (arrity &lt; 0  &amp;&amp; args.size &gt;= arity.abs - 1) \n      begin\n        preamble \n        yield *args\n      rescue StandardError =&gt; e\n        recovery \n      end  \n    else \n      raise ArgumentError, \"wrong number of arguments (given #{args.size}, expected #{arity &lt; 0 ? (arity.abs - 1).to_s.+('+') : arity })\"\n    end\n  end\n\n  def preamble\n    puts __method__\n  end\n\n  def recovery\n    puts __method__\n  end\nend\n</code></pre>\n\n<p>So your usage would be </p>\n\n<pre><code>class MyClass &lt; Operation\n\n  op :thing1 do |a,b,c| \n    puts \"I got #{a},#{b},#{c}\"\n  end\n\n  op :thing2 do |a,b|\n    raise StandardError\n  end\n\n  def thing3\n    thing1(1,2,3) \n  end\nend\n</code></pre>\n\n<p>Additionally this offers you both options presented as you could still do </p>\n\n<pre><code>def thing4(m1,m2,m3) \n   @m1 = m1\n   op_wrap(1,'inside_wrapper') do |str| \n     # no need to yield because the m1,m2,m3 are in scope \n     # but you could yield other arguments\n     puts \"#{str} in #{__method__}\" \n   end\nend\n</code></pre>\n\n<p>Allowing you to pre-process arguments and decide what to yield to the block </p>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>m = MyClass.new\n\nm.thing1(4,5,6)\n# preamble\n# I got 4,5,6\n#=&gt; nil\nm.thing2('A','B')\n# preamble\n# recovery\n#=&gt; nil\nm.thing3  \n# preamble\n# I got 1,2,3\n#=&gt; nil\nm.thing1(12)\n#=&gt; #&lt;ArgumentError: wrong number of arguments (given 1, expected 3)&gt;\n</code></pre>\n"}], "owner": {"reputation": 2480, "user_id": 1561081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/acd9e93464c089acdf36bf1d8ce793c9?s=128&d=identicon&r=PG", "display_name": "lrleon", "link": "https://stackoverflow.com/users/1561081/lrleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53859118, "answer_count": 2, "score": 2, "last_activity_date": 1545312180, "creation_date": 1545183064, "question_id": 53843397, "link": "https://stackoverflow.com/questions/53843397/how-to-forward-a-block-to-a-method-that-generates-methods", "title": "How to forward a block to a method that generates methods", "body": "<p>In my current project, I am having the following repetitive pattern in some classes:</p>\n\n<pre><code>class MyClass\n\n  def method1(pars1, ...)\n    preamble\n\n    # implementation method1\n\n    rescue StandardError =&gt; e\n      recovery\n  end\n\n  def method2(pars2, ...)\n    preamble\n\n    # implementation method2\n\n    rescue StandardError =&gt; e\n      recovery\n  end\n\n  # more methods with the same pattern\nend\n</code></pre>\n\n<p>So, I have been thinking about how to dry that repetive pattern. My goal is to have something like this:</p>\n\n<pre><code>class MyClass\n\n  define_operation :method1, pars1, ... do\n    # implementation method1\n  end\n\n  define_operation :method2, pars2, ... do\n    # implementation method2\n  end\n\n  # more methods with the same pattern but generated with define_wrapper_method\n  end\n</code></pre>\n\n<p>I have tried to implement a kind of metagenerator but I have had problems for forwarding the block that would receive the generator. This is more or less what I have tried:</p>\n\n<pre><code>def define_operation(op_name, *pars, &amp;block)\n  define_method(op_name.to_s) do |*pars|\n    preamble\n    yield # how can I do here for getting the block? &lt;-----\n    rescue StandardError =&gt; e\n      recovery\n  end\nend\n</code></pre>\n\n<p>Unfortunately, I cannot find a way for forwarding <code>block</code> to the <code>define_method</code> method. Also, it is very possible that the parameters, whose number is variable, are being passed to <code>define_method</code> in a wrong way.</p>\n\n<p>I would appreciate any clue, help, suggestion.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1545182694, "post_id": 53843226, "comment_id": 94534752, "body": "<code>site.site_placements.map { |sp| (sp.native_ad_placement.ad_type != &quot;video&quot;) }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545211015, "post_id": 53844103, "comment_id": 94543415, "body": "I think <code>where.not</code> wasn&#39;t introduced until Rails 4 and he&#39;s on 3.2. I&#39;m not sure if it was backported? Either way, this is still a solid recommendation. he may just need to build part of the query by hand"}, {"owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "edited": false, "score": 0, "creation_date": 1545219476, "post_id": 53844103, "comment_id": 94548219, "body": "thx - y - <code>reject!</code> works. would normally do this via query but have to work with results directly in this case for legacy code reasons."}], "tags": [], "owner": {"reputation": 387, "user_id": 1745871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68a94567d3e98a35e6c01adb9132f79?s=128&d=identicon&r=PG", "display_name": "\u0110&#244;n Nguy\u1ec5n", "link": "https://stackoverflow.com/users/1745871/%c4%90%c3%b4n-nguy%e1%bb%85n"}, "is_accepted": true, "score": 2, "last_activity_date": 1545189505, "creation_date": 1545189505, "answer_id": 53844103, "question_id": 53843226, "link": "https://stackoverflow.com/questions/53843226/how-to-reject-from-an-ar-association-where-a-specific-condition-exists/53844103#53844103", "title": "how to reject from an AR association where a specific condition exists", "body": "<p>You should use <code>.reject!</code> instead of <code>.reject</code>.</p>\n\n<p>But really, you shouldn't use reject at all. If I am not wrong, you can totally achieve the same thing at querying level, and it is even much more effective. Something like below:</p>\n\n<pre><code>Site.includes(site_placements: [: native_ad_placement]).where.not(native_ad_placements: { ad_type: \"video\" })\n</code></pre>\n"}], "owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53844103, "answer_count": 1, "score": 0, "last_activity_date": 1545189505, "creation_date": 1545181411, "question_id": 53843226, "link": "https://stackoverflow.com/questions/53843226/how-to-reject-from-an-ar-association-where-a-specific-condition-exists", "title": "how to reject from an AR association where a specific condition exists", "body": "<p>I'd like to remove items from the following association (where a site_placement has a native_ad_placement.ad_type == \"video\") and have the following code but this doesn't seem to work </p>\n\n<pre><code># not an array but an association\n@sites.each do |site|\n  site.site_placements.reject { |sp| (sp.native_ad_placement.ad_type == \"video\") }\nend\n</code></pre>\n\n<p>How could I achieve this? I'm using Rails 3.2. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "edited": false, "score": 0, "creation_date": 1545178287, "post_id": 53842771, "comment_id": 94533889, "body": "Ok that solves half the problem, it only tries to create the user if it doesn&#39;t exist. But then, <b>candidate_ids.concat new_users.map(&amp;:id)</b> is empty then it crashes without sending any invite."}], "tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": false, "score": 0, "last_activity_date": 1545177265, "creation_date": 1545177265, "answer_id": 53842771, "question_id": 53842498, "link": "https://stackoverflow.com/questions/53842498/rails-sending-invitations-to-users-that-already-exist/53842771#53842771", "title": "Rails - sending invitations to users that already exist", "body": "<p>You could use <code>first_or_initialize</code>. The block only gets run if the <code>User</code> does not already exist. Here's an example...</p>\n\n<pre><code>user = User.where(email: email).first_or_initialize do |usr|\n  usr.email = email\n  usr.password = SecureRandom.hex\n  usr.role = :shadow\n  usr.skip_confirmation_notification!\nend\n\nuser.add_role :recruiter\nuser.save!\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545177265, "creation_date": 1545174976, "question_id": 53842498, "link": "https://stackoverflow.com/questions/53842498/rails-sending-invitations-to-users-that-already-exist", "title": "Rails - sending invitations to users that already exist", "body": "<p>I have an invite method that sends users emails to be part of a team. I have a modal that displays some users that already have an account and a textfield to input more emails and sends an invite for the person to join the platform.\nBut if I type an email that already exists in the database I get:</p>\n\n<blockquote>\n  <p>Validation failed: Email has already been taken</p>\n</blockquote>\n\n<p>But want to send an email even if the person already has an account.</p>\n\n<p>Here's what I have: </p>\n\n<pre><code>  def invite\n    invite = params.dig(:invite) || {}\n    candidate_ids = invite.dig(:candidate_ids) || []\n    extra_emails = invite.dig(:extra_emails) || \"\"\n    emails = extra_emails\n      .split(/,|;/)\n      .map(&amp;:strip)\n\n    new_users = emails.map { |email| team_email_invite(email) }\n\n    candidate_ids.concat new_users.map(&amp;:id)\n\n    invite_data = candidate_ids.map { |uid| {\n      :user_id =&gt; uid,\n      :team_id =&gt; @team.id,\n    } }\n\n    TeamInvite.create(invite_data)\n      .map!(&amp;:email)\n\n    respond_to do |format|\n      format.html { redirect_to overviews_url, notice: 'Invites sent.' }\n      format.json { head :no_content }\n    end\n  end\n\n  def team_email_invite(email)\n    user = User.new({\n      :email =&gt; email,\n      :password =&gt; SecureRandom.hex,\n      :role =&gt; :shadow,\n    })\n    user.add_role :recruiter\n    user.skip_confirmation_notification!\n    user.save!\n  end\n</code></pre>\n\n<p>candidate_ids - It's the users that I display on the list(all good)\nextra_emails - emails in the textfield </p>\n\n<p>So when I write a user that already has an account in the textfield, team_email_invite tries to create a new user and crashes.</p>\n\n<p>I don't want to do something like </p>\n\n<pre><code>begin\n  new_users = emails.map { |email| team_email_invite(email) }\nrescue\n  new_users=[]\nend\n</code></pre>\n\n<p>because then it doesn't send the invite.\nAny idea how to solve this? </p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1545175425, "post_id": 53842423, "comment_id": 94533214, "body": "This <code>(?! [\\d{1,2}&#47;\\d{1,2}]* [ ] - )</code> is problematic. What is that intended to do ?"}], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": true, "score": 2, "last_activity_date": 1545176092, "creation_date": 1545176092, "answer_id": 53842630, "question_id": 53842423, "link": "https://stackoverflow.com/questions/53842423/regex-ruby-rails/53842630#53842630", "title": "REGEX Ruby Rails", "body": "<p>Try this regexp:</p>\n\n<pre><code>(\\d{1,2}\\/\\d{1,2}.+?(?:(?=\\d{1,2}\\/\\d{1,2} - )|\\z))\n</code></pre>\n\n<p>Check the result here <a href=\"http://rubular.com/r/04VL4Qs7Kb\" rel=\"nofollow noreferrer\">http://rubular.com/r/04VL4Qs7Kb</a></p>\n\n<p>It returns this matches:</p>\n\n<pre><code>Match 1\n1.  4/28 - Declined\nMatch 2\n1.  4/19 - Call with Bob, Joe and Steve\nMatch 3\n1.  4/10 - Call scheduled for 10a on 4/18\nMatch 4\n1.  4/9 - Wants to meet with Jay on 4/28 at 10:30a\n</code></pre>\n\n<p>The important parts:</p>\n\n<p>it starts with a \"date\" and then anything else (note the last <code>?</code>, it makes the <code>.+</code> or <code>.*</code> be \"non-greedy\")</p>\n\n<pre><code>\\d{1,2}\\/\\d{1,2}.+?\n</code></pre>\n\n<p>up until the next \"date followed by a dash\" OR the end of the line (this OR is important, or you won't get the last match)</p>\n\n<pre><code>(?=\\d{1,2}\\/\\d{1,2} - )|\\z)\n</code></pre>\n\n<p>that <code>?:</code> is there to ignore the group on the result</p>\n\n<pre><code>(?:(...))\n</code></pre>\n\n<p>otherwise you get a blank second group on each match</p>\n\n<pre><code>Match 1\n1.  4/28 - Declined\n2.   \nMatch 2\n1.  4/19 - Call with Bob, Joe and Steve\n2.   \nMatch 3\n1.  4/10 - Call scheduled for 10a on 4/18\n2.   \nMatch 4\n1.  4/9 - Wants to meet with Jay on 4/28 at 10:30a\n2.   \n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": false, "score": 0, "last_activity_date": 1545176320, "creation_date": 1545176320, "answer_id": 53842659, "question_id": 53842423, "link": "https://stackoverflow.com/questions/53842423/regex-ruby-rails/53842659#53842659", "title": "REGEX Ruby Rails", "body": "<p>It looks like the <em>natural separator</em> is this <code>\\d{1,2}+ / \\d{1,2} \\s? [-:]+</code>  </p>\n\n<p>So you can use that in a negative assertion to get the body of the message.  </p>\n\n<p><code>\\d{1,2}+/\\d{1,2}\\s?[-:]+(?:(?!\\d{1,2}+/\\d{1,2}\\s?[-:]+)[\\S\\s])*</code></p>\n\n<p><a href=\"https://regex101.com/r/o8Grdx/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/o8Grdx/1</a></p>\n\n<p>Formatted  </p>\n\n<pre><code> \\d{1,2}+ / \\d{1,2} \\s? [-:]+ \n (?:\n      (?! \\d{1,2}+ / \\d{1,2} \\s? [-:]+ )\n      [\\S\\s] \n )*\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1545210029, "creation_date": 1545210029, "answer_id": 53847708, "question_id": 53842423, "link": "https://stackoverflow.com/questions/53842423/regex-ruby-rails/53847708#53847708", "title": "REGEX Ruby Rails", "body": "<pre><code>string.split(%r{(\\d+/\\d+ - )}).drop(1).each_slice(2).map(&amp;:join)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[\n  \"4/28 - Declined \",\n  \"4/19 - Call with Bob, Joe and Steve \",\n  \"4/10 - Call scheduled for 10a on 4/18 \",\n  \"4/9 - Wants to meet with Jay on 4/28 at 10:30a\"\n]\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 331165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f8882d59bc93b08fb953040ce6de8428?s=128&d=identicon&r=PG", "display_name": "james", "link": "https://stackoverflow.com/users/331165/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53842630, "answer_count": 3, "score": 0, "last_activity_date": 1545210029, "creation_date": 1545174535, "last_edit_date": 1545209521, "question_id": 53842423, "link": "https://stackoverflow.com/questions/53842423/regex-ruby-rails", "title": "REGEX Ruby Rails", "body": "<p>I have:</p>\n\n<pre><code>string = \"4/28 - Declined 4/19 - Call with Bob, Joe and Steve 4/10 - Call scheduled for 10a on 4/18 4/9 - Wants to meet with Jay on 4/28 at 10:30a\"\n</code></pre>\n\n<p>I am trying to produce an array that gives an array of four elements:</p>\n\n<pre><code>4/28 - Declined\n4/19 - Call with Bob, Joe and Steve\n4/10 - Call scheduled for 10a on 4/18\n4/9 - Wants to meet with Jay on 4/28 at 10:30a\n</code></pre>\n\n<p>I'm having trouble with the following:</p>\n\n<pre><code>string.scan(/\\d{1,2}+\\/\\d{1,2}[\\s]?[-|:]+\\s[A-Za-z\\s\\d]+ (?![\\d{1,2}\\/\\d{1,2}]* -)/)\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>[\"4/19 - Call with \", \"4/10 - Call scheduled for 10a on \", \"4/9 - Wants to meet with Jay on \"]\n</code></pre>\n"}, {"tags": ["ruby", "ansible", "vagrant", "vagrantfile"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8790982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UKu6r.jpg?s=128&g=1", "display_name": "RoboCD", "link": "https://stackoverflow.com/users/8790982/robocd"}, "edited": false, "score": 0, "creation_date": 1545234712, "post_id": 53842768, "comment_id": 94557233, "body": "Thanks so much, the first solution there works and is exactly what I needed!  For some reason, I still couldn&#39;t get the variable to pass through to ansible, but using <code>ansible_virtualization_type</code> is a much cleaner solution to my problem anyway."}], "tags": [], "owner": {"reputation": 1808, "user_id": 3178962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37r2s.jpg?s=128&g=1", "display_name": "clockworknet", "link": "https://stackoverflow.com/users/3178962/clockworknet"}, "is_accepted": true, "score": 0, "last_activity_date": 1545179575, "last_edit_date": 1545179575, "creation_date": 1545177248, "answer_id": 53842768, "question_id": 53842146, "link": "https://stackoverflow.com/questions/53842146/how-to-run-ansible-task-based-on-the-vagrant-provider/53842768#53842768", "title": "How to run ansible task based on the Vagrant provider", "body": "<p>For this specific case, I think there is an easier way of achieving what you want. Ansible creates a series of facts for each host it runs against, which includes collecting virtualisation information for guests.Try adding the following task in one of your playbooks to see what I mean:</p>\n\n<pre><code>- name: Display Virtualisation Type fact\n  debug:\n    var: ansible_virtualization_type\n</code></pre>\n\n<p>That should mean you don't need to pass the variable in from Vagrant. If you want to see all the facts, in the directory containing your Vagrantfile, just run (you can add '-l host' to limit to one of your VM's):</p>\n\n<pre><code>ansible -m setup all\n</code></pre>\n\n<p>To answer your specific question, I think this will work for you:</p>\n\n<pre><code># In this case I don't believe you need the '$' prefix for your variables\nansible_provider = ''\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.define vmconf[:name] do |vagrantconf|\n\n      vagrantconf.vm.provider :virtualbox do |vb|\n        ansible_provider = \"virtualbox\"\n      end\n\n      vagrantconf.vm.provider :vsphere do |vb|\n        ansible_provider = \"vsphere\"\n      end\n  end  \n  config.vm.provision :ansible do |ansible|    \n    ansible.playbook = \"provision.yml\"\n    ansible.extra_vars = { ansible_ssh_user: \"test\",\n                           ansible_provider:  \"#{ansible_provider}\" }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8790982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UKu6r.jpg?s=128&g=1", "display_name": "RoboCD", "link": "https://stackoverflow.com/users/8790982/robocd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 53842768, "answer_count": 1, "score": 0, "last_activity_date": 1545179575, "creation_date": 1545172663, "question_id": 53842146, "link": "https://stackoverflow.com/questions/53842146/how-to-run-ansible-task-based-on-the-vagrant-provider", "title": "How to run ansible task based on the Vagrant provider", "body": "<p>I have a vagrant job to create new VMs. Depending on the provider I pass to it, this could be created locally on Virtualbox, or on a Vsphere cluster with the vagrant-vsphere plugin. </p>\n\n<p>Because of this, there are times when I want to run certain tasks on Virtualbox, and certain tasks on Vsphere. I figured the easiest way to do so would be to just pass a variable from Vagrant to ansible based on the provider. Roughly, this is what I have in my Vagrantfile so far.</p>\n\n<pre><code>$ansible_provider = ''\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.define vmconf[:name] do |vagrantconf|\n\n\n      vagrantconf.vm.provider :virtualbox do |vb|\n        $ansible_provider = \"virtualbox\"\n      end\n\n      vagrantconf.vm.provider :vsphere do |vb|\n        $ansible_provider = \"vsphere\"\n      end\n  end  \n  config.vm.provision :ansible do |ansible|    \n    ansible.playbook = \"provision.yml\"\n    ansible.extra_vars = { ansible_ssh_user: 'test',\n                             ansible_provider:  $ansible_provider }\n  end\nend\n</code></pre>\n\n<p>I added a print statement that shows the two extra_vars and <code>ansible_ssh_user</code> works correctly, but <code>ansible_provider</code> is just blank. When I remove the first line and change it to a local variable, I get the following error:\n<code>Message: undefined local variable or method 'ansible_provider'</code></p>\n\n<p>I haven't used ruby all that much, so I figured I'm doing something wrong there. Any help with this would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "unit-testing", "rspec"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545169016, "post_id": 53841404, "comment_id": 94531082, "body": "Why would you write a test for another (builtin) class&#39;s methods? And from a style perspective, <a href=\"https://github.com/rubocop-hq/ruby-style-guide#single-line-blocks\" rel=\"nofollow noreferrer\">avoid using <code>{}</code> for multi-line blocks</a>. Trying to decipher your example is making my head hurt."}, {"owner": {"reputation": 9, "user_id": 10286515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2jMTmVjNGs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMXz7fM1aCyYHFB4bJQUx49Eu3s0g/mo/photo.jpg?sz=128", "display_name": "shitgetsreal", "link": "https://stackoverflow.com/users/10286515/shitgetsreal"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545170113, "post_id": 53841404, "comment_id": 94531516, "body": "I am getting the following error when I run my unit tests.   <code>NoMethodError:        undefined method &#39;[]&#39; for nil:NilClass</code>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545170666, "post_id": 53841404, "comment_id": 94531752, "body": "Your example is way, way too complex. Simplify it first. You&#39;re making something like ten method calls, chaining multiple method calls, including a conditional, and including a rescue all in a single line. The error you&#39;re showing doesn&#39;t help decipher it at all because you haven&#39;t included the code for the test, and on top of that you&#39;re calling <code>[]</code> <i>four times</i> in that one line. Make your life easier: refactor this code into something readable and sensible, <i>then</i> test it."}, {"owner": {"reputation": 9, "user_id": 10286515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2jMTmVjNGs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMXz7fM1aCyYHFB4bJQUx49Eu3s0g/mo/photo.jpg?sz=128", "display_name": "shitgetsreal", "link": "https://stackoverflow.com/users/10286515/shitgetsreal"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545171049, "post_id": 53841404, "comment_id": 94531900, "body": "I am modifying my code( providing a simpler example)."}, {"owner": {"reputation": 9, "user_id": 10286515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2jMTmVjNGs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMXz7fM1aCyYHFB4bJQUx49Eu3s0g/mo/photo.jpg?sz=128", "display_name": "shitgetsreal", "link": "https://stackoverflow.com/users/10286515/shitgetsreal"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545171649, "post_id": 53841404, "comment_id": 94532076, "body": "@anothermh i just added a different piece of code"}, {"owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "edited": false, "score": 0, "creation_date": 1545208652, "post_id": 53841404, "comment_id": 94542202, "body": "Can you show the failing test, too?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10286515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2jMTmVjNGs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMXz7fM1aCyYHFB4bJQUx49Eu3s0g/mo/photo.jpg?sz=128", "display_name": "shitgetsreal", "link": "https://stackoverflow.com/users/10286515/shitgetsreal"}, "edited": false, "score": 0, "creation_date": 1545249538, "post_id": 53842249, "comment_id": 94564473, "body": "appreciate your reply, but how do I ensure that? I am very new to ruby so having a lot of trouble figuring this out"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 9, "user_id": 10286515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2jMTmVjNGs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMXz7fM1aCyYHFB4bJQUx49Eu3s0g/mo/photo.jpg?sz=128", "display_name": "shitgetsreal", "link": "https://stackoverflow.com/users/10286515/shitgetsreal"}, "edited": false, "score": 0, "creation_date": 1545254413, "post_id": 53842249, "comment_id": 94566451, "body": "@shitgetsreal I have updated my answer to explain an approach to doing that."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545254395, "last_edit_date": 1545254395, "creation_date": 1545173343, "answer_id": 53842249, "question_id": 53841404, "link": "https://stackoverflow.com/questions/53841404/rspec-unit-testing-for-the-merge-method-in-ruby-hash/53842249#53842249", "title": "Rspec: unit testing for the merge! method in Ruby hash", "body": "<p>Let's assume that in the example you gave <code>rqst</code> is returning an empty hash <code>{}</code>.</p>\n\n<p>When you set <code>selected_unit_req</code> it is set to an empty hash:</p>\n\n<pre><code>selected_unit_req = rqst.select { |m| select_keys.include?(m) }\n=&gt; {}\n</code></pre>\n\n<p>When you subsequently call <code>selected_unit_req[\"author\"]</code> the hash is checked for a key named <code>author</code>, and this returns <code>nil</code>:</p>\n\n<pre><code>selected_unit_req[\"author\"]\n=&gt; nil\n</code></pre>\n\n<p>So running the full call <code>selected_unit_req[\"author\"][\"username\"]</code> can be seen to be equivalent to the following:</p>\n\n<pre><code>nil[\"username\"]\nNoMethodError: undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>That's why the error is being raised; you expect <code>selected_unit_req[\"author\"]</code> to return a hash with a key <code>username</code> but it is instead returning <code>nil</code>.</p>\n\n<p>Ensure that <code>selected_unit_req</code> has the hash keys and values that you expect first.</p>\n\n<p><strong>Update</strong></p>\n\n<p>In the comments below you asked how to verify it has the keys you require. The answer to that depends on a few things, like what behavior you want to see in the event it doesn't have it and the version of Ruby you're using.</p>\n\n<p>I'm going to assume that it's okay to skip <code>rqst</code> if it doesn't have the keys and that you're using a modern version of Ruby (>= 2.3.0).</p>\n\n<p>Here's one way to do it using the <a href=\"https://stackoverflow.com/a/34348418/3784008\"><code>dig</code></a> method for the Hash class:</p>\n\n<pre><code>request.each do |rqst|\n  next unless rqst.dig('author', 'username') &amp;&amp; rqst.dig('author', 'name')\n  user = Etl::Models::User.where(username: rqst['author']['username'] )\n  user.merge!({ author_name: rqst['author']['name'] })\nend\n</code></pre>\n\n<p>What we're doing is calling <code>next</code> if <code>rqst</code> does not have the key <code>author</code> with a sub-key named <code>username</code> and another sub-key named <code>name</code>. This works because <code>dig</code> will return <code>nil</code> if the hash does not have those keys in it.</p>\n\n<p>Let's pretend for a moment that <code>rqst == {}</code>. How that line would be interpreted is:</p>\n\n<pre><code>next unless nil &amp;&amp; nil\n</code></pre>\n\n<p>Since <code>nil</code> is <a href=\"https://stackoverflow.com/questions/23068834/what-evaluates-to-false-in-ruby\">falsy</a> in Ruby, it ends up calling <code>next</code> to skip over the current <code>rqst</code> value and move on to the next one in the iteration.</p>\n\n<p>I've also removed <code>selected_unit_req</code> because it's unnecessarily repetitive; since you already know exactly what keys/values you want out of <code>rqst</code> there is no need to create a new hash with just those values; instead, you can just extract those values and use them directly where needed.</p>\n"}], "owner": {"reputation": 9, "user_id": 10286515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y2jMTmVjNGs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMXz7fM1aCyYHFB4bJQUx49Eu3s0g/mo/photo.jpg?sz=128", "display_name": "shitgetsreal", "link": "https://stackoverflow.com/users/10286515/shitgetsreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545254395, "creation_date": 1545168776, "last_edit_date": 1545172046, "question_id": 53841404, "link": "https://stackoverflow.com/questions/53841404/rspec-unit-testing-for-the-merge-method-in-ruby-hash", "title": "Rspec: unit testing for the merge! method in Ruby hash", "body": "<p>I have a piece of code which has:</p>\n\n<pre><code>requests.each do |request|\n  request.each do |rqst|\n    select_keys = [\"author\", \"author_name\"]\n    selected_unit_req = rqst.select { |m| select_keys.include?(m) }\n    user = Etl::Models::User.where(username: selected_unit_req[\"author\"][\"username\"] )\n    user.merge!({ author_name: selected_unit_req[\"author\"][\"name\"] })\n  end\nend\n</code></pre>\n\n<p>I am unable to test the merge! method , getting <code>NoMethodError:undefined method '[]' for nil:NilClass</code> when I run my existing unit tests. Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545201452, "post_id": 53841592, "comment_id": 94539135, "body": "Thanks!  I added <code>&lt;%= f.hidden_field :view, :value =&gt; @view %&gt;</code> to my form and added <code>@view = @diary.view</code> to the <code>update</code> action, but it still renders all fields.  I was wondering if I need to change <code>format.html { render :edit }</code>?  Thanks!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545202847, "post_id": 53841592, "comment_id": 94539727, "body": "Can you add your console output  when you&#39;re hitting the <code>edit</code> action to your question? In particular, your <code>params</code> values?"}, {"owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545203574, "post_id": 53841592, "comment_id": 94540021, "body": "Yes, in edit when I have, <code>puts params[:view]</code>, then close shows in the console (no parenthesis around close).  Thanks!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545203654, "post_id": 53841592, "comment_id": 94540053, "body": "And update? (Please add to your question, don&#39;t put in comments.)"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545204390, "post_id": 53841592, "comment_id": 94540403, "body": "You should really put your actual params from your console in your question, not your <code>puts params[:view]</code> output. Either your <code>hidden_field</code> is malformed, or your <code>view</code> value is nested. But, since you don&#39;t show either your <code>html</code> or your <code>params</code>, it&#39;s hard to say."}, {"owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545204920, "post_id": 53841592, "comment_id": 94540623, "body": "Sorry, I misunderstood what you meant with the parameters.  I&#39;ve updated the answer."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545204995, "post_id": 53841592, "comment_id": 94540650, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/185465/discussion-between-jvillian-and-yellowreign\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1545205245, "last_edit_date": 1545205245, "creation_date": 1545169748, "answer_id": 53841592, "question_id": 53841387, "link": "https://stackoverflow.com/questions/53841387/rails-can-i-show-different-partials-in-a-view-after-an-error/53841592#53841592", "title": "Rails - Can I Show Different Partials in a View After an Error?", "body": "<p>In your <code>update</code> action, you never set <code>@view</code> and so it is always <code>nil</code> in which case your <code>if... elsif... else</code> statement always resolves to <code>&lt;%= render 'all_fields' %&gt;</code>.</p>\n\n<p>If you want your <code>if</code> statement in <code>edit.html.erb</code> to resolve to something other than <code>else</code>, then set your <code>@view</code> variable in your <code>update</code> action.</p>\n\n<p>Based on the update to your question, the problem is now that <code>:view</code> is nested inside <code>:diary</code>: </p>\n\n<pre><code>\"diary\"=&gt;{\"last_date\"=&gt;\"\", \"notes\"=&gt;\"hi, hi!\", \"update_type\"=&gt;\"close\", \"view\"=&gt;\"close\"}\n</code></pre>\n\n<p>So, you need to do <code>@view = params[:diary][:view]</code> instead of <code>@view = params[:view]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545202473, "post_id": 53842198, "comment_id": 94539555, "body": "I added <code>&lt;%= f.hidden_field :view, :value =&gt; @view %&gt;</code> to my form and added <code>@view = @diary.view</code> to the update action, but it still renders all fields."}, {"owner": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "reply_to_user": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "edited": false, "score": 0, "creation_date": 1545203149, "post_id": 53842198, "comment_id": 94539852, "body": "@yellowreign Can you use <code>byebug</code> and see what is the value it&#39;s getting when rendering error form"}], "tags": [], "owner": {"reputation": 436, "user_id": 2570423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVptB.png?s=128&g=1", "display_name": "mehedi", "link": "https://stackoverflow.com/users/2570423/mehedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1545173012, "creation_date": 1545173012, "answer_id": 53842198, "question_id": 53841387, "link": "https://stackoverflow.com/questions/53841387/rails-can-i-show-different-partials-in-a-view-after-an-error/53842198#53842198", "title": "Rails - Can I Show Different Partials in a View After an Error?", "body": "<p>In your diary_controller</p>\n\n<pre><code>before_action :load_view, only: [:edit, :update]\n\n# Your action methods here\n\nprivate\n\ndef load_view\n  @view = params[:view]\nend  \n</code></pre>\n\n<p>And make sure in all your forms (close_fields, new_fields, all_fields), you have a hidden filed named <code>view</code> which value is set to @view.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 9361533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-skZgtkXNKK4/AAAAAAAAAAI/AAAAAAAAAVw/ChuLDYzLJpI/photo.jpg?sz=128", "display_name": "Bhargav Reddy", "link": "https://stackoverflow.com/users/9361533/bhargav-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1545202031, "creation_date": 1545202031, "answer_id": 53845934, "question_id": 53841387, "link": "https://stackoverflow.com/questions/53841387/rails-can-i-show-different-partials-in-a-view-after-an-error/53845934#53845934", "title": "Rails - Can I Show Different Partials in a View After an Error?", "body": "<p>Once try like this in your<br>\nedit.html.erb</p>\n\n<pre><code>&lt;% if @view.to_s == 'close' %&gt;\n &lt;%= render :partial =&gt; 'close_fields'%&gt;\n&lt;% elsif @view.to_s == 'new'%&gt;\n &lt;%= render :partial =&gt; 'new_fields' %&gt;\n&lt;% else %&gt;\n &lt;%= render :partial =&gt;'all_fields' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Note :your partial  file name should have an underscore like this: _all_fields.html.erb</p>\n"}], "owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 1, "accepted_answer_id": 53841592, "answer_count": 3, "score": 0, "last_activity_date": 1545205245, "creation_date": 1545168672, "last_edit_date": 1545204866, "question_id": 53841387, "link": "https://stackoverflow.com/questions/53841387/rails-can-i-show-different-partials-in-a-view-after-an-error", "title": "Rails - Can I Show Different Partials in a View After an Error?", "body": "<p>I have a Rails 5 app that has a view that shows different forms based on params.  The correct form is shown when the view first shows</p>\n\n<p>However, when there's an error, it always shows the same partial.</p>\n\n<p>diary_controller</p>\n\n<pre><code>def edit\n  @view = params[:view]\nend\n\ndef update\n  respond_to do |format|\n    if @diary.update(diary_params)\n      format.html { redirect_to @diary, notice: 'Diary was successfully updated.' }\n      format.json { render :show, status: :ok, location: @diary }\n    else\n      format.html { render :edit }\n      format.json { render json: @diary.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>edit.html.erb</p>\n\n<pre><code>&lt;% if @view == 'close' %&gt;\n  &lt;%= render 'close_fields'%&gt;\n&lt;% elsif @view == 'new'%&gt;\n  &lt;%= render 'new_fields' %&gt;\n&lt;% else %&gt;\n  &lt;%= render 'all_fields' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Currently, it always shows the <code>'all_fields'</code> partial when there's an error.  </p>\n\n<p>Is it possible to show the partial originally shown while retaining the data the user entered in the fields, along with the error messages (currently shown under the text field because I use simple_form)?</p>\n\n<p>------------UPDATE------------</p>\n\n<p>When I add <code>puts params[:view]</code> in <code>:edit</code>, it returns <code>close</code> in the console.</p>\n\n<p>When I add <code>puts params[:view]</code> in <code>:update</code>, it returns nothing in the console.  I also tried putting <code>@view = \"close\"</code> in update.  When I did this, the correct view was shown after an error.</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"f7JoOucLkUlOyt31NW9HaJIWyXKVSu7q91kspfZYjgdF3hJneRKapnCPtgJn+R5NOC5nDhNvkB8PzzHNs9aLkg==\", \"diary\"=&gt;{\"last_date\"=&gt;\"\", \"notes\"=&gt;\"hi, hi!\", \"update_type\"=&gt;\"close\", \"view\"=&gt;\"close\"}, \"reason_list_select2\"=&gt;\"going on vacation\", \"season_reason_list_select2\"=&gt;\"\", \"temp_reason_list_select2\"=&gt;\"\", \"area\"=&gt;[{\"id\"=&gt;\"4\", \"action\"=&gt;\"Not Applicable\"}], \"commit\"=&gt;\"Close Diary\", \"id\"=&gt;\"27\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "singleton"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 3, "creation_date": 1545167367, "post_id": 53841021, "comment_id": 94530468, "body": "If the syntax of a totally normal part of the language \u201cbothers\u201d you then I suggest rethinking your position, because the language ain\u2019t gonna change, and the people who write in that language ain\u2019t gonna change, and millions of lines of code already written in that language ain\u2019t gonna change."}, {"owner": {"reputation": 49, "user_id": 9488501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ef304d62bc957764b5973bdac66033?s=128&d=identicon&r=PG&f=1", "display_name": "PuckXY", "link": "https://stackoverflow.com/users/9488501/puckxy"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545167684, "post_id": 53841021, "comment_id": 94530578, "body": "It&#39;s a valid point, but see, there may be many ways to do this, and I&#39;d like to see them so I can decide which one is the best one for some situation, you know? Say in some situation putting self in the methods makes sense but there&#39;s a better way to do it... That&#39;s what I&#39;m looking for, you know? Trying to learn more about the language here, sorry if it seemed rude or something ;D"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545167964, "post_id": 53841021, "comment_id": 94530696, "body": "Those are the two most common ways of defining class methods. Beyond some extremely esoteric metaprogramming tricks (and I can&#39;t think of any off the top of my head), that&#39;s it. Doing anything else makes your code more complex and harder to understand. Besides, the <a href=\"https://github.com/rubocop-hq/ruby-style-guide#def-self-class-methods\" rel=\"nofollow noreferrer\">style guide</a> makes it clear that the preferred syntax is <code>self.method</code>, and on top of that you should <a href=\"https://github.com/rubocop-hq/ruby-style-guide#modules-vs-classes\" rel=\"nofollow noreferrer\">use modules and not classes</a> in your given example."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1545167980, "post_id": 53841021, "comment_id": 94530703, "body": "I would always go with the <code>def self.bar</code> version. IMHO \u2013 especially when you have many class methods \u2013 is it much easier to read and understand. Btw. when your class won&#39;t be instantiated at all you might want to consider a module instead."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1545168469, "post_id": 53841021, "comment_id": 94530867, "body": "@spickermann you would go with <code>self.method_name</code> when you have many class methods? I have always taken the approach of abstracting class methods out into <code>class ClassName; module ClassMethods; #...; end; end;</code> when I have many of them because I find the encapsulation to be nicer and more readable and a simple <code>extend ClassMethods</code> takes care of the implementation. Also I find it lends to organization and discovery when I have <code>class_name.rb</code> and <code>class_name&#47;class_methods.rb</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545170220, "post_id": 53841021, "comment_id": 94531565, "body": "Personally, I go with either the <code>class &lt;&lt; self</code> or <code>extend ClassMethods</code> (as @engineersmnky says) approach. In my personal aesthetic, <code>self.method</code> is yucky. But, I&#39;m an odd one."}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545170563, "post_id": 53841021, "comment_id": 94531712, "body": "@engineersmnky I would also use \u2018self.method\u2019. The other way you have one more tab, and you can\u2019t tell if it\u2019s static or not only from reading the function, which I learned that it makes it harder to maintain (at least for me). As been said, it\u2019s good for meta programming,. One pitfall for this though, is that you can\u2019t define private methods. I\u2019m going with hybrid solution, using mostly \u2018class &lt;&lt; self\u2019 only for private methods. I find it\u2019s better to read the code, which takes most of my time anyway"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 0, "creation_date": 1545170678, "post_id": 53841021, "comment_id": 94531759, "body": "@oren nothing is static :)"}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1545171972, "post_id": 53841021, "comment_id": 94532178, "body": "@engineersmnky oops meant class level methods :) Actually now I\u2019m wondering if it\u2019s wrong to use \u2018class &lt;&lt; self\u2019 for private methods while other method are \u2018self.method\u2019"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1545172259, "post_id": 53841021, "comment_id": 94532259, "body": "You could also write <code>singleton_class.define_method(:bar) { puts &quot;me, bar&quot; }</code>. That&#39;s normally only used to create methods dynamically, but it does read well. Perhaps Ruby could benefit from keywords <code>class_methods</code> and <code>instance_methods</code>, used in conjunction with <code>public</code>, <code>protected</code> and <code>private</code>. @engineersmnky, what about plumbing technology? Where I live it hasn&#39;t changed much in decades."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545179971, "post_id": 53841021, "comment_id": 94534227, "body": "@CarySwoveland ain&#39;t broke don&#39;t fix it :P"}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 1, "last_activity_date": 1545184902, "creation_date": 1545184902, "answer_id": 53843574, "question_id": 53841021, "link": "https://stackoverflow.com/questions/53841021/not-use-self-in-every-class-method-and-not-use-singleton-model-in-ruby/53843574#53843574", "title": "Not use self in every class method and not use singleton model in ruby", "body": "<p>Here's an example of an esoteric metaprogramming technique that I mentioned in the comments:</p>\n\n<pre><code>module Foo\n  instance_eval do\n    def bar\n      'baz'\n    end\n  end\nend\n</code></pre>\n\n<p>Now call the new method:</p>\n\n<pre><code>Foo.bar\n=&gt; 'baz'\n</code></pre>\n\n<p><code>instance_eval</code>'s use is <a href=\"https://www.jimmycuadra.com/posts/metaprogramming-ruby-class-eval-and-instance-eval/\" rel=\"nofollow noreferrer\">unintuitive</a> because it's meant for defining class methods, whereas <code>class_eval</code> is for instance methods.</p>\n\n<p>There's a similar approach for the technique Cary mentioned (although he used <code>define_method</code> which is for instance methods versus <code>define_singleton_method</code> for class methods):</p>\n\n<pre><code>module Foo\n  define_singleton_method(:bar) do\n    'baz'\n  end\nend\n</code></pre>\n\n<p>Calling the method works the same:</p>\n\n<pre><code>Foo.bar\n=&gt; 'baz'\n</code></pre>\n\n<p>But again, these are advanced techniques that you'll never see used in this way, because there are much simpler standard ways of accomplishing the same task (and you gave two examples in your question). If you tried defining all your class methods this way it would be ugly and repetitive and confusing to anyone reading it.</p>\n\n<p>The techniques shown are typically used by code <em>outside</em> the defined module/class so that you can externally manipulate it without having to directly modify the source code for it, sometimes referred to as <a href=\"https://stackoverflow.com/q/394144/3784008\">monkey patching</a>.</p>\n\n<p>For example, if the module is defined with no methods:</p>\n\n<pre><code>module Foo\nend\n</code></pre>\n\n<p>You could in some other code anywhere else say <code>Foo.instance_eval {}</code> or <code>Foo.define_singleton_method(:bar) {}</code> and it would apply to <code>Foo</code> thereafter. This is useful when you want to frustrate the author of <code>Foo</code>'s attempt at <a href=\"https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)\" rel=\"nofollow noreferrer\">encapsulation</a>.</p>\n\n<p>And in case I'm not being clear, the examples I've shown here are what you should <strong>not</strong> do. They're used when dynamic changes to classes/modules are needed. That's not what you described.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1545209235, "creation_date": 1545209235, "answer_id": 53847512, "question_id": 53841021, "link": "https://stackoverflow.com/questions/53841021/not-use-self-in-every-class-method-and-not-use-singleton-model-in-ruby/53847512#53847512", "title": "Not use self in every class method and not use singleton model in ruby", "body": "<p>(this was already mentioned by <a href=\"https://stackoverflow.com/questions/53841021/not-use-self-in-every-class-method-and-not-use-singleton-model-in-ruby#comment94530867_53841021\">engineersmnky in the comments</a>)</p>\n\n<p>You could extend your class with a module that holds your class methods (that module can be nested right within your class):</p>\n\n<pre><code>class Foo\n  module ClassMethods\n    def bar\n      # Do something\n    end\n  end\n\n  extend ClassMethods\nend\n</code></pre>\n\n<p>You can also move it outside your class, even in its own file (this can be useful structure-wise or if there are <em>many</em> class methods):</p>\n\n<pre><code># foo/class_methods.rb\nclass Foo\n  module ClassMethods\n    def bar\n      # Do something\n    end\n  end\nend\n\n# foo.rb\nclass Foo\n  extend ClassMethods\nend\n</code></pre>\n\n<p>Methods defined via <code>extend</code> can even be overridden in the base class:</p>\n\n<pre><code>class Foo\n  module ClassMethods\n    def bar\n      123\n    end\n  end\nend\n\nclass Foo\n  extend ClassMethods\n\n  def self.bar\n    super * 2\n  end\nend\n\nFoo.bar #=&gt; 246\n</code></pre>\n\n<p>This is especially useful if you want to add custom functionality when extending multiple classes with the same module (think of shared class methods).</p>\n"}], "owner": {"reputation": 49, "user_id": 9488501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ef304d62bc957764b5973bdac66033?s=128&d=identicon&r=PG&f=1", "display_name": "PuckXY", "link": "https://stackoverflow.com/users/9488501/puckxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1545212820, "accepted_answer_id": 53847512, "answer_count": 2, "score": -4, "last_activity_date": 1545209235, "creation_date": 1545167021, "question_id": 53841021, "link": "https://stackoverflow.com/questions/53841021/not-use-self-in-every-class-method-and-not-use-singleton-model-in-ruby", "closed_reason": "Opinion-based", "title": "Not use self in every class method and not use singleton model in ruby", "body": "<p>I'm having trouble with nice and beautiful code. Basically, if I define a class that won't be instantiated at all, I'd do something like this:</p>\n\n<pre><code>class Foo\n  def self.bar\n    # Do something\n  end\nend\n</code></pre>\n\n<p>but this syntax bothers me (having to put <code>self.</code> in every method), so singleton solves my problem:</p>\n\n<pre><code>class Foo\n  class &lt;&lt; self\n    def bar\n      # Do something, but in better code\n    end\n  end\nend\n</code></pre>\n\n<p>In both ways I can do <code>Foo.bar</code> and it'll do something, but the first one doesn't look good and in the second one I still don't get how singleton works exactly, so better be careful and not to use it.</p>\n\n<p>So, in the end... What I'd like to ask: is there a way to do <code>Foo.bar</code> other than the mentioned above?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1545167666, "post_id": 53840805, "comment_id": 94530575, "body": "Don\u2019t use system Ruby. Install Ruby with RVM, then retry <code>gem install rails</code>."}, {"owner": {"reputation": 55, "user_id": 6389300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KHvwQ.png?s=128&g=1", "display_name": "shodak", "link": "https://stackoverflow.com/users/6389300/shodak"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545167856, "post_id": 53840805, "comment_id": 94530646, "body": "Thank you. Should I remove this question? Does leaving it up help the next person? And is there a reason you didn&#39;t post a reply rather than a comment?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545168385, "post_id": 53840805, "comment_id": 94530837, "body": "Because I make the same comment several times a week on nearly identical questions. The answer is always: <a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">don&#39;t</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>, and short/glib responses are better suited to comments."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545168482, "post_id": 53840805, "comment_id": 94530871, "body": "Going forward, never post your error message by supplying a link to an external website. Post it <b>here</b>, in your question. Links die; external sites may be blocked; etc."}, {"owner": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545179478, "post_id": 53840805, "comment_id": 94534133, "body": "@anothermh so do you have a dupe to flag against?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545182767, "post_id": 53840805, "comment_id": 94534766, "body": "I could find dozens of questions where the gist is &quot;I&#39;m having trouble installing a gem with system Ruby&quot; but I&#39;m not sure it&#39;s worth the time to look for even one. The answer is simple: don&#39;t use system Ruby."}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 1, "last_activity_date": 1545272577, "last_edit_date": 1545272577, "creation_date": 1545185557, "answer_id": 53843650, "question_id": 53840805, "link": "https://stackoverflow.com/questions/53840805/trying-to-install-rails-but-i-get-the-error-i386-architecture-is-deprecated-on/53843650#53843650", "title": "Trying to install rails, but I get the error &quot;i386 architecture is deprecated on macOS.&quot;", "body": "<p>As @anothermh mentioned, you shouldn't use system ruby. I'd mention further that you don't want to, and shouldn't need to, run <code>sudo</code> to install gems.</p>\n\n<p>Use a ruby version manager such as <a href=\"https://github.com/asdf-vm/asdf\" rel=\"nofollow noreferrer\">asdf</a> (my recommended), rvm (probably one of the most popular), or rbenv (also a solid choice).</p>\n\n<p>I'd also recommend, if you haven't done it already, that you grab homebrew because you'll need a few dependencies. Highly recommend at least:</p>\n\n<pre><code>brew install gcc libxml2 readline\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6598123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xvVIB7taOEM/AAAAAAAAAAI/AAAAAAAAAA4/UsTeDatjdSg/photo.jpg?sz=128", "display_name": "Roman Koshynskyi", "link": "https://stackoverflow.com/users/6598123/roman-koshynskyi"}, "edited": false, "score": 1, "creation_date": 1577452667, "post_id": 59501237, "comment_id": 105174990, "body": "<a href=\"https://stackoverflow.com/questions/53528115/i386-arch-error-installing-old-scrypt-gem-version-with-os-x-mojave\" title=\"i386 arch error installing old scrypt gem version with os x mojave\">stackoverflow.com/questions/53528115/&hellip;</a> - this will work for Mojave"}], "tags": [], "owner": {"reputation": 1, "user_id": 6598123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xvVIB7taOEM/AAAAAAAAAAI/AAAAAAAAAA4/UsTeDatjdSg/photo.jpg?sz=128", "display_name": "Roman Koshynskyi", "link": "https://stackoverflow.com/users/6598123/roman-koshynskyi"}, "is_accepted": false, "score": 0, "last_activity_date": 1577451854, "creation_date": 1577451854, "answer_id": 59501237, "question_id": 53840805, "link": "https://stackoverflow.com/questions/53840805/trying-to-install-rails-but-i-get-the-error-i386-architecture-is-deprecated-on/59501237#59501237", "title": "Trying to install rails, but I get the error &quot;i386 architecture is deprecated on macOS.&quot;", "body": "<p>I've tried to bundle install and had issue like this. In my case upgrading rails from 4.2.5. to 4.2.9 fixed error. Maybe it will help someone to not lose time.</p>\n"}], "owner": {"reputation": 55, "user_id": 6389300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KHvwQ.png?s=128&g=1", "display_name": "shodak", "link": "https://stackoverflow.com/users/6389300/shodak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 53843650, "answer_count": 2, "score": 1, "last_activity_date": 1577451854, "creation_date": 1545166015, "last_edit_date": 1545179488, "question_id": 53840805, "link": "https://stackoverflow.com/questions/53840805/trying-to-install-rails-but-i-get-the-error-i386-architecture-is-deprecated-on", "title": "Trying to install rails, but I get the error &quot;i386 architecture is deprecated on macOS.&quot;", "body": "<p><strong><a href=\"https://textuploader.com/d8aj5\" rel=\"nofollow noreferrer\">The full text of the error</a></strong></p>\n\n<p>The most important line, to my untrained eye, seems to be: <code>ld: warning: The i386 architecture is deprecated for macOS (remove from the Xcode build setting: ARCHS)</code><br>\nBut am I really supposed to modify the Xcode build settings?</p>\n\n<p>I am trying <code>$ sudo gem install rails</code>.</p>\n\n<p><strong>My specs:</strong><br>\nmacOS High Sierra 10.13.6<br>\nXcode version: 10.0 (10A255)<br>\nRuby version: 2.3.7p456<br>\nGem version: 2.7.8</p>\n\n<p><strong>Recommendations I've found so far:</strong><br>\n1) Install xcode command line tools. They are installed.<br>\n2) <code>bundle config build.nokogiri --use-system-libraries</code>.<br>\n/\\ I've read that I should not do this.  </p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["ruby", "serialization", "openssl", "tlv", "asn1"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1545164284, "post_id": 53840379, "comment_id": 94529200, "body": "Can you show us the code where <code>ans1_object</code> is defined?"}, {"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1545164652, "post_id": 53840379, "comment_id": 94529366, "body": "@SaraTibbetts I used <code>asn1 = OpenSSL::ASN1.decode(der)</code> from <a href=\"http://ruby-doc.org/stdlib-2.5.0/libdoc/openssl/rdoc/OpenSSL/ASN1/ASN1Data.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1545164721, "post_id": 53840379, "comment_id": 94529397, "body": "I think the main issue is whether or not they are meant to be accessed like JSON/YAML (probably not). If not, I&#39;m not familiar with the best way to find what you want in an ASN1 structure."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1545183796, "post_id": 53842634, "comment_id": 94534965, "body": "Thanks for taking a look here. How did you know it was DER encoded (other than being the more popular choice)? This was created in java bouncy castle, but it doesn&#39;t say an encoding <a href=\"https://www.bouncycastle.org/docs/pkixdocs1.5on/org/bouncycastle/tsp/TimeStampResponse.html\" rel=\"nofollow noreferrer\">here</a> for getEncoded()."}, {"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1545184958, "post_id": 53842634, "comment_id": 94535186, "body": "Also see update with printout. This is from about halfway into the data, I can pick out pieces of data, but it&#39;s still near non-sensical. I have not yet found &#39;serialNumber&#39; or &#39;genTime&#39;, although there was &#39;signingTIme&#39;.... And the signingTime value is two below the declaration. Strange."}, {"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "reply_to_user": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1545244973, "post_id": 53842634, "comment_id": 94562484, "body": "@user8897013, no worries. As it happened I didn&#39;t know RFC3161 used DER, though having taken a look at the RFC itself it seems that DER is what is used. The example code you linked to is handling DER, which is what I was primarily referring to, seems I got lucky!"}, {"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "reply_to_user": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1545245880, "post_id": 53842634, "comment_id": 94562900, "body": "@user8897013 If you look at Appendix C of <a href=\"https://www.ietf.org/rfc/rfc3161.txt\" rel=\"nofollow noreferrer\">ietf.org/rfc/rfc3161.txt</a>, you can see the entire ASN.1 schema for RFC3161. ASN.1 schema syntax is pretty easy to follow. One of the types defined in this schema will be for the data you&#39;re decoding: TimeStampResp? Note that this schema imports things from other schemas, which I&#39;m guessing are defined elsewhere in the wider PKI specs."}], "tags": [], "owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "is_accepted": false, "score": 0, "last_activity_date": 1545176107, "creation_date": 1545176107, "answer_id": 53842634, "question_id": 53840379, "link": "https://stackoverflow.com/questions/53840379/how-to-parse-asn1-in-ruby/53842634#53842634", "title": "How to parse ASN1 in Ruby", "body": "<p>Openssl.ASN1.decode(der) in the example you linked to is exploiting the cannonical nature of DER to reconstruct a structure from the wire data, and isn't using the ASN.1 schema at all. Thus whilst it can deduce what shape, composition and content of that structure from what it's reading from the wire data (especially if it was encoded with explicit tagging, which also gives data type), it has no idea what the field names would have been in the original schema (these are not in the wire format data). </p>\n\n<p>If you look at the original ASN.1 schema for an RFC3161 timestamp, you can work out what fields are where.</p>\n\n<p>Using ASN.1 with C/C++, Java and C# one generally uses an ASN.1 compiler to generate source code. This source code defines classes that contain fields with field names taken from the schema. Apologies, I've no idea if this is possible in Ruby's Openssl.ASN1</p>\n\n<p><strong>Implicit / Explicit.</strong></p>\n\n<p>The example you provided a link for takes a minor liberty with the implicit tagging example. It interprets the value as an integer; strictly speaking it should be interpretted as more ASN.1 to be decoded. It just so happens that those bytes are an integer.</p>\n"}, {"tags": [], "owner": {"reputation": 438, "user_id": 1713808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aaf6d7ad53a6f469bd5368f06944e9b?s=128&d=identicon&r=PG", "display_name": "Curious Sam", "link": "https://stackoverflow.com/users/1713808/curious-sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1612889965, "creation_date": 1612889965, "answer_id": 66123521, "question_id": 53840379, "link": "https://stackoverflow.com/questions/53840379/how-to-parse-asn1-in-ruby/66123521#66123521", "title": "How to parse ASN1 in Ruby", "body": "<p>Let me clarify something here; I just spotted a contradiction.\nThe OP said that he <code>knows the specification</code> but also mentioned that <code>the signingTime value is two below the declaration</code> is <code>strange</code>.<br />\nThis leads me to conclude that OP means he knows that the format is due to the specification but doesn't actually know the specification itself.</p>\n<p>Let read some of them together so you'll know-how.<br />\nLet answer the question of why does the time value is there?</p>\n<p>The signing time was mentioned in <a href=\"https://tools.ietf.org/html/rfc5652#section-11.3\" rel=\"nofollow noreferrer\">RFC5652 section 11.3</a>; from there, we'll know that it is a type of attribute (since it is under section 11). The structure of the attribute type is also mentioned in the same document in <a href=\"https://tools.ietf.org/html/rfc5652#section-5.3\" rel=\"nofollow noreferrer\">section 5.3</a></p>\n<blockquote>\n<p>Attribute ::= SEQUENCE {<br />\nattrType OBJECT IDENTIFIER,<br />\nattrValues SET OF AttributeValue }</p>\n</blockquote>\n<p>So it is basically a sequence of an object identifier followed by a set.<br />\n<a href=\"https://tools.ietf.org/html/rfc5652#section-11.3\" rel=\"nofollow noreferrer\">Section 11.3</a> also specified that the set must contain exactly 1 member.</p>\n<p>This is exactly what are we seeing here:</p>\n<pre><code>[\n  #&lt;OpenSSL::ASN1::ObjectId:0x000055fdee1a3190\n    @indefinite_length=false,\n    @tag=6,\n    @tag_class=:UNIVERSAL,\n    @tagging=nil,\n    @value=&quot;signingTime&quot;&gt;,\n  #&lt;OpenSSL::ASN1::Set:0x000055fdee1a30f0\n    @indefinite_length=false,\n    @tag=17,\n    @tag_class=:UNIVERSAL,\n    @tagging=nil,\n    @value=[\n      #&lt;OpenSSL::ASN1::UTCTime:0x000055fdee1a3118\n        @indefinite_length=false,\n        @tag=23,\n        @tag_class=:UNIVERSAL,\n        @tagging=nil,\n        @value=2018-12-19 01:49:08 UTC&gt;\n    ]&gt;\n]\n</code></pre>\n<p>As mentioned already, <code>OpenSSL::ASN1.decode</code> decoded der into just structured ruby objects and did not takes into account the meaning of each field. So you need to read the specification and work out the fields yourself. It is tedious but not impossibly hard by any means.</p>\n<p>Since the traverse function provided by the official library is pretty much useless, I end up implementing it myself. It is still just a working prototype, though.</p>\n<pre><code>class TraverseASN1\n  class StopIteration &lt; ::StandardError\n    def initialize(result = nil)\n      super(nil)\n      @result = result\n    end\n\n    attr_reader :result\n  end\n\n  def call(\n    decoded,\n    _depth: 0,\n    _sequence: nil,\n    _parents: [],\n    &amp;traversal_block\n  )\n    traversal_block.call(\n      decoded,\n      depth: _depth,\n      sequence: _sequence,\n      parents: _parents\n    )\n    value = decoded.value\n    return unless value.is_a?(::Array)\n    value.each_with_index do |sub_token, sequence|\n      call(\n        sub_token,\n        _depth: (_depth + 1),\n        _sequence: sequence,\n        _parents: [*_parents, decoded],\n        &amp;traversal_block\n      )\n    end\n  end\nend\n</code></pre>\n<p>And this is how I use it:</p>\n<pre><code>target_element = begin\n  TraverseASN1.new.call(asn1) do |current, depth:, parents:, **_unused_args|\n    next unless depth == 2\n    next unless current.is_a?(::OpenSSL::ASN1::ObjectId)\n    next unless current.value == 'pkcs7-signedData'\n    raise TraverseASN1::StopIteration.new(parents.last)\n  end\nrescue TraverseASN1::StopIteration =&gt; e\n  e.result\nend\n</code></pre>\n<p>Once you know the format, it is fairly trivial to starts hacking things.</p>\n"}], "owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1612889965, "creation_date": 1545164036, "last_edit_date": 1545185103, "question_id": 53840379, "link": "https://stackoverflow.com/questions/53840379/how-to-parse-asn1-in-ruby", "title": "How to parse ASN1 in Ruby", "body": "<p>Still a little confused with ASN1. I am parsing a RFC3161 timestamp response with ruby openssl, so I know the specification. I am pretty sure the structure is getting loaded correctly but I'm confused on how to find the pieces/keys that I want. I understand there are sequences (ordered) and sets (unordered/unique).</p>\n\n<p>I see we can call <code>asn1_object.value[0].value[0]</code>, but this is clumsy and <strong>I was hoping if I know the keys or headers, I can treat it like JSON or YAML and just call</strong> <code>asn1_object['TSTInfo']['serialNumber']</code>. <strong>Does it not work this way?</strong></p>\n\n<p>Are we supposed to use the properties of the sequence which are expected to be in order and know their position already since we also have specifications and lengths? This is strange to me, but maybe that's because I haven't used a whole lot of TLV formats before. Unfortunately, openssl has minimal documentation, just how to load the object with <code>OpenSSL::ASN1.decode(der)</code> and access a value by index. There is also <code>traverse</code> method, but this does not yield header names or anything I would think to use in this case.\n<br></p>\n\n<pre><code>                #&lt;OpenSSL::ASN1::Sequence:0x000055fdee1a2c68\n                   @indefinite_length=false,\n                   @tag=16,\n                   @tag_class=:UNIVERSAL,\n                   @tagging=nil,\n                   @value=\n                    [#&lt;OpenSSL::ASN1::ObjectId:0x000055fdee1a2ec0\n                      @indefinite_length=false,\n                      @tag=6,\n                      @tag_class=:UNIVERSAL,\n                      @tagging=nil,\n                      @value=\"1.2.840.113549.1.9.52\"&gt;,\n                     #&lt;OpenSSL::ASN1::Set:0x000055fdee1a2c90\n                      @indefinite_length=false,\n                      @tag=17,\n                      @tag_class=:UNIVERSAL,\n                      @tagging=nil,\n                      @value=\n                       [#&lt;OpenSSL::ASN1::Sequence:0x000055fdee1a2cb8\n                         @indefinite_length=false,\n                         @tag=16,\n                         @tag_class=:UNIVERSAL,\n                         @tagging=nil,\n                         @value=\n                        [#&lt;OpenSSL::ASN1::Sequence:0x000055fdee1a2da8\n                            @indefinite_length=false,\n                            @tag=16,\n                            @tag_class=:UNIVERSAL,\n                            @tagging=nil,\n                            @value=\n\n                   @value=\n                    [#&lt;OpenSSL::ASN1::ObjectId:0x000055fdee1a3190\n                      @indefinite_length=false,\n                      @tag=6,\n                      @tag_class=:UNIVERSAL,\n                      @tagging=nil,\n                      @value=\"signingTime\"&gt;,\n                     #&lt;OpenSSL::ASN1::Set:0x000055fdee1a30f0\n                      @indefinite_length=false,\n                      @tag=17,\n                      @tag_class=:UNIVERSAL,\n                      @tagging=nil,\n                      @value=\n                       [#&lt;OpenSSL::ASN1::UTCTime:0x000055fdee1a3118\n                         @indefinite_length=false,\n                         @tag=23,\n                         @tag_class=:UNIVERSAL,\n                         @tagging=nil,\n                         @value=2018-12-19 01:49:08 UTC&gt;]&gt;]&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "rubular"], "comments": [{"owner": {"reputation": 2110, "user_id": 2146879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMsq7.jpg?s=128&g=1", "display_name": "Ho Man", "link": "https://stackoverflow.com/users/2146879/ho-man"}, "edited": false, "score": 2, "creation_date": 1545161794, "post_id": 53839754, "comment_id": 94528097, "body": "does <code>privacy_policy_link</code> variable include <code>https:&#47;&#47;</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 10807830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718a0a629c403b87c375fb61712afc73?s=128&d=identicon&r=PG&f=1", "display_name": "pixelcandy", "link": "https://stackoverflow.com/users/10807830/pixelcandy"}, "edited": false, "score": 0, "creation_date": 1545162780, "post_id": 53839942, "comment_id": 94528521, "body": "ahh ok that makes total sense! Thank you for explaining that and for providing a working solution. I really appreciate that!"}, {"owner": {"reputation": 5980, "user_id": 60131, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/axDcf.jpg?s=128&g=1", "display_name": "John Gallagher", "link": "https://stackoverflow.com/users/60131/john-gallagher"}, "edited": false, "score": 1, "creation_date": 1545164164, "post_id": 53839942, "comment_id": 94529138, "body": "Little suggestion - to make your regular expression a bit more readable you can use <code>%r{}</code> like so: <code>%r{^(http[s]?:&#47;&#47;|)(www.)?#{domain}($|&#47;$)}</code>"}], "tags": [], "owner": {"reputation": 963, "user_id": 3311489, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a07a3d565ce06b5428c193379d869be3?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Ellis", "link": "https://stackoverflow.com/users/3311489/nick-ellis"}, "is_accepted": false, "score": 2, "last_activity_date": 1545169828, "last_edit_date": 1545169828, "creation_date": 1545161935, "answer_id": 53839942, "question_id": 53839754, "link": "https://stackoverflow.com/questions/53839754/regex-url-validation-in-ruby/53839942#53839942", "title": "Regex URL validation in Ruby", "body": "<p>Your issue is the <code>.</code> character is any character so it matched the <code>-</code> in <code>example-com</code>.</p>\n\n<p>If you chain it to the beginning of the line it will match correctly without trying to escape the <code>.</code> in the domain.</p>\n\n<pre><code>if privacy_policy_link.match(%r{^(http[s]?://|)(www.)?#{domain}($|/$)})\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 10807830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718a0a629c403b87c375fb61712afc73?s=128&d=identicon&r=PG&f=1", "display_name": "pixelcandy", "link": "https://stackoverflow.com/users/10807830/pixelcandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1545169828, "creation_date": 1545161050, "last_edit_date": 1545161533, "question_id": 53839754, "link": "https://stackoverflow.com/questions/53839754/regex-url-validation-in-ruby", "title": "Regex URL validation in Ruby", "body": "<p>I have the following ruby code in a model:</p>\n\n<p><code>if privacy_policy_link.match(/#{domain}($|\\/$)/)\n  errors.add(:privacy_policy_link, 'Link to a specific privacy policy page on your site instead of your homepage.')\nend</code></p>\n\n<p>This worked until a user tried to save a privacy policy link that looked like this:</p>\n\n<p><code>https://example.com/about-me/privacy-policy-for-example-com/</code></p>\n\n<p>The goal is that I don't want them linking to their base homepage (example.com or www.example.com etc) for this privacy policy link (for some random, complicated reasons I won't go into). The link provided above <em>should</em> pass the matcher (meaning that because they are linking to a separate page on their site, it shouldn't be considered a match and they shouldn't see any errors when saving the form) - but because they reference their base domain in second half of the url, it comes up as a match. </p>\n\n<p>I cannot, for the life of me, figure out how the correct regex on rubular to get this url to pass the matching algorithm. And of course I cannot just ask the user to rename their privacy policy link to remove the \"com\" from it at the end - because this: <code>https://example.com/about-me/privacy-policy-for-example</code> would pass. :) </p>\n\n<p>I would be incredibly grateful for any assistance that could help me understand how to solve this problem! </p>\n\n<p>Rubular link: <a href=\"http://rubular.com/r/G5OmYfzi6t\" rel=\"nofollow noreferrer\">http://rubular.com/r/G5OmYfzi6t</a></p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "materialize"], "comments": [{"owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "edited": false, "score": 0, "creation_date": 1545644114, "post_id": 53839487, "comment_id": 94667125, "body": "What does your <code>setting_params</code> method in your controller look like?"}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "reply_to_user": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "edited": false, "score": 0, "creation_date": 1545645107, "post_id": 53839487, "comment_id": 94667445, "body": "Added that to the question - I have added <code>profession_name</code> there.. thinking that it would be a security risk? Thanks for you help"}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 1, "creation_date": 1545839388, "post_id": 53839487, "comment_id": 94708494, "body": "Your HABTM relation needs to be pluralized <code>teams</code>. I also highly recommend removing HABTM and using <code>has_many :through</code> so that you can add a field for <code>defaut_team</code>.  Problem 1 can be fixed by adding <code>:team_name</code> and <code>:profession_name</code> to <code>settings_controller#setting_params</code> in the <code>permit</code> argument hash.  For problem 2 I would read <a href=\"https://guides.rubyonrails.org/form_helpers.html#nested-forms\" rel=\"nofollow noreferrer\">Rails Nested Forms</a> and <a href=\"https://materializecss.com/chips.html\" rel=\"nofollow noreferrer\">Materialize Chips</a>.  There are multiple issues concerning both.  The scope of changes needed is honestly beyond  a single question."}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1545839741, "post_id": 53839487, "comment_id": 94708600, "body": "Thanks for the pointers Tom. I will never want a user to create a team from within this form, only create associations with existing ones. Is a nested approach still the best? Happy to look into it in more detail if it is. Thanks again"}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545842752, "post_id": 53839487, "comment_id": 94709616, "body": "If you are not modifying or creating tags then you will not need to do a nested form.  Sorry for the misunderstanding. The <code>team_ids: []</code> is correct.  You will need your autocomplete input to return the chips under <code>name=&quot;setting[team_ids][]&quot;</code>.  The empty brackets are necessary for Rails to parse it into an array.  Out of curiosity, why are you not using form helpers?"}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1546105491, "post_id": 53839487, "comment_id": 94781366, "body": "Thanks for your help Tom, I&#39;ve now worked out the autocomplete element of the form, and am currently working on the chips (i.e. the team array). The current issue I am googling is getting Rails to see a <code>&lt;div&gt;</code> as the form input (Materialize adds the chips to this div, and uses an input within it to allow the user to add more chips, so the form is just seeing this empty div at the moment)."}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1546105646, "post_id": 53839487, "comment_id": 94781405, "body": "I wasn&#39;t using form helpers because I was struggling to assign the JSON to a custom data attribute... the code is subtly different depending on the type of input within simple_form (i.e. <code>input_html: { data: { autocomplete: @professions_json  } } </code> works for <code>f.input</code> but you need to use  <code>data: { autocomplete: @professions_json  }</code> for <code>f.text_field</code>.  I have now worked this out... but it wasn&#39;t the most obvious thing to a beginner! I am now back to form helpers (with the exception of the chips which needs to be a div for Materialize to initialise)"}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1546164608, "post_id": 53839487, "comment_id": 94791101, "body": "Managed to it out! I was doing a few things wrong... thanks for your help Tom"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2638169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/162d82774b33e5831bb9e9fe27d427ba?s=128&d=identicon&r=PG", "display_name": "swiknaba", "link": "https://stackoverflow.com/users/2638169/swiknaba"}, "edited": false, "score": 1, "creation_date": 1546180202, "post_id": 53976401, "comment_id": 94794324, "body": "Depending on the column count of your tables, you can greatly improve performance by pulling only the necessary fields with your query instead of filtering this out later in rails: <code>@teams = Team.all</code>  ==&gt; <code>@teams = Team.select(:id, :name)</code>."}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "reply_to_user": {"reputation": 83, "user_id": 2638169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/162d82774b33e5831bb9e9fe27d427ba?s=128&d=identicon&r=PG", "display_name": "swiknaba", "link": "https://stackoverflow.com/users/2638169/swiknaba"}, "edited": false, "score": 0, "creation_date": 1546180294, "post_id": 53976401, "comment_id": 94794347, "body": "There aren&#39;t that many extra columns in most of my use cases, but will make that change. Every little helps! Thanks"}], "tags": [], "owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "is_accepted": true, "score": 4, "last_activity_date": 1546180374, "last_edit_date": 1546180374, "creation_date": 1546160962, "answer_id": 53976401, "question_id": 53839487, "link": "https://stackoverflow.com/questions/53839487/using-materialize-chip-and-autocomplete-in-ruby-on-rails-form-with-associate/53976401#53976401", "title": "Using Materialize `chip` and `autocomplete` in Ruby on Rails Form with Associated Models", "body": "<blockquote>\n  <p><strong>This is almost certainly not the best way of doing this, <em>but it does work</em></strong>. Please offer suggestions and I will update this, or if someone adds a better answer I will happily mark it as correct. This solution doesn't require much in the way of controller/model changes and is largely done with a (comparatively) short bit of jquery/JS so can be easily repeated within a project.</p>\n</blockquote>\n\n<hr>\n\n<p>I've managed to get both autocomplete and chips working with Ruby on Rails, utilising simple_form form helpers where possible.</p>\n\n<p>Effectively I am storing the JSON into a custom attribute for each case and then parsing this with some jquery/javascript when the view is loaded before using this to initialise either <code>autocomplete</code> or <code>chips</code>. </p>\n\n<p>Autocomplete values are translated from name to id within the controller.</p>\n\n<p>Chip values are recognised client side with some JS, and inputs created with the correct <code>name</code> and <code>id</code> for simpleform to automatically save the values as an array to the hash.</p>\n\n<p>Full explaination and code is below.</p>\n\n<p>Thank you to <a href=\"https://stackoverflow.com/users/5399937/tom\">Tom</a> for his helpful comments and input.</p>\n\n<hr>\n\n<h2><strong><code>autocomplete</code></strong></h2>\n\n<p>Requires you to create an input under <strong><em>variable</em>_name</strong> and then add additional functions in the model to translate the name into an id for saving. Effectively following this <a href=\"https://rubyplus.com/articles/3701-Auto-Complete-Association-in-Rails-5\" rel=\"nofollow noreferrer\">tutorial</a>.</p>\n\n<pre><code>&lt;%= f.input :profession_name,  input_html: { data: { autocomplete: @professions_json  } } %&gt;\n</code></pre>\n\n<p>As you can see above, the only real difference from adding a typical simple_form association is the following:</p>\n\n<ul>\n<li><code>f.input</code> rather than <code>f.association</code> - ensures a textbox is rendered rather than a drop down</li>\n<li><code>:model_name</code> rather than <code>:model</code> - ensures that the controller recognises this is a name that needs to be converted into an object</li>\n<li><code>input_html: { data: { autocomplete: @model_json  } }</code> - this adds a custom attribute with all your JSON data, this is parse by</li>\n</ul>\n\n<p><strong>You need to ensure the names of your model are unique.</strong></p>\n\n<hr>\n\n<h2><strong><code>chips</code></strong></h2>\n\n<p>This is a little more involved, requiring extra javascript functions. The code attachs a callback to the event of adding or removing a chip, before cycling through each and adding a hidden <code>input</code>. Each input has a name attribute which matches what simple_form expects, so it is correctly added to the hash params before being submitted to the controller. I couldn't get it to translate multiple names in an array, so just got it to re-read the id from the original JSON and add that as the value of the input.</p>\n\n<pre><code>  &lt;div id=\"team_ids\" placeholder=\"Add a team\" name=\"setting[team_ids]\" class=\"chips\" data-autocomplete=\"&lt;%=  @teams_json %&gt;\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>From above you can see there are the following deviations from simple_form convention:</p>\n\n<ul>\n<li><code>&lt;div&gt;</code> rather than a <code>&lt;% f.input %&gt;</code> as Materialize chips needs to be called on a div</li>\n<li><code>placeholder=\"...\"</code> this text is used as a placeholder once the chips is initialised, this can be left blank / not included</li>\n<li><code>name=\"setting[team_ids]\"</code> helps simple_form understand which model this applies to</li>\n<li><code>class=\"chips\"</code> ensures that our javascript later knows to initialise <code>chips</code> on this element</li>\n<li><code>data-autocomplete=\"&lt;%=  @teams_json %&gt;\"</code> saves the JSON data as an attribute of the div for parsing later </li>\n</ul>\n\n<blockquote>\n  <p><strong>Currently the code re-parses the original JSON attribute</strong>, it is possible to reference the JSON data that is created on initialisation of the chips, this is likely better but I could not get it to work.</p>\n  \n  <p><strong>Custom Input Element</strong> - someone more experience than myself might be able to play around with this and create a custom element for simple_form... it was beyond me unfortunately.</p>\n</blockquote>\n\n<p><hr></p>\n\n<h1>Ruby on Rails Code</h1>\n\n<p><strong>settings_controller.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class SettingsController &lt; ApplicationController\n\n  ...\n\n  def new\n\n    @user = current_user\n    @setting = Setting.new\n    @professions = Profession.select(:name)\n    @teams = Team.select(:id, :name)\n\n    # Prepare JSON for autocomplete and chips\n    @teams_json = @teams.to_json(:only =&gt; [:id, :name] )\n    @professions_json = @professions.to_json(:only =&gt; [:name] )\n\n  end\n\n\n  ....\n\n private\n    def setting_params\n      params.require(:setting).permit( :profession_name, :user_id,  :profession_id, team_ids: [])\n    end\n</code></pre>\n\n<p><strong>setting.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Setting &lt; ApplicationRecord\n\n  has_and_belongs_to_many :teams, optional: true    \n  belongs_to :user\n  belongs_to :profession, optional: true\n\n  def profession_name\n    profession.try(:name)\n  end\n\n  def profession_name=(name)\n    self.profession = Profession.find_by(name: name) if name.present?\n  end\n</code></pre>\n\n<p><strong>_form.html.erb</strong> <em>N.B. this is a partial, as denoted by the preceding underscore</em></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= simple_form_for @setting, validate: true, remote: true  do |f| %&gt;\n\n  &lt;%= f.input :profession_name,  input_html: { data: { autocomplete: @professions_json  } } %&gt;\n\n  &lt;div id=\"team_ids\" placeholder=\"Add a team\" name=\"setting[team_ids]\" class=\"chips\" data-autocomplete=\"&lt;%=  @teams_json %&gt;\"&gt;&lt;/div&gt;\n\n  &lt;%= f.submit %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<h1>Demo</h1>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(document).ready(function() {\r\n\r\n  // Cycle through anything with an data-autocomplete attribute\r\n  // Cannot use 'input' as chips must be innitialised on a div\r\n  $(\"[data-autocomplete]\").each(function() {\r\n\r\n    var dataJSON = JSON.parse($(this).attr(\"data-autocomplete\"));\r\n\r\n    // Prepare array for items and add each\r\n    var items = [];\r\n    var i;\r\n    for (i = 0; i &lt; dataJSON.length; ++i) {\r\n      items[dataJSON[i].name] = null; // Could assign id to image url and grab this later? dataJSON[i].id\r\n    }\r\n\r\n\r\n    // Check if component needs to be a chips\r\n    if ($(this).hasClass(\"chips\")) {\r\n\r\n      // Initialise chips\r\n      // Documentation: https://materializecss.com/chips.html\r\n      $(this).chips({\r\n        placeholder: $(this).attr(\"placeholder\"),\r\n        autocompleteOptions: {\r\n          data: items,\r\n          limit: Infinity,\r\n          minLength: 1\r\n        },\r\n        onChipAdd: () =&gt; {\r\n          chipChange($(this).attr(\"id\")); // See below\r\n        },\r\n        onChipDelete: () =&gt; {\r\n          chipChange($(this).attr(\"id\")); // See below\r\n        }\r\n      });\r\n\r\n\r\n      // Tweak the input names, etc\r\n      // This means we can style the code within the view as we would a simple_form input\r\n      $(this).attr(\"id\", $(this).attr(\"id\") + \"_wrapper\");\r\n\r\n      $(this).attr(\"name\", $(this).attr(\"name\") + \"_wrapper\");\r\n\r\n    } else {\r\n\r\n      // Autocomplete is much simpler! Just initialise with data\r\n      // Documentation: https://materializecss.com/autocomplete.html\r\n      $(this).autocomplete({\r\n        data: items,\r\n      });\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n  });\r\n\r\n});\r\n\r\n\r\nfunction chipChange(elementID) {\r\n\r\n  // Get chip element from ID\r\n  var elem = $(\"#\" + elementID);\r\n\r\n  // In theory you can get the data of the chips instance, rather than re-parsing it\r\n  var dataJSON = JSON.parse(elem.attr(\"data-autocomplete\"));\r\n\r\n  // Remove any previous inputs (we are about to re-add them all)\r\n  elem.children(\"input[auto-chip-entry=true]\").remove();\r\n\r\n  // Find the wrapping element\r\n  wrapElement = elem.closest(\"div[data-autocomplete].chips\")\r\n\r\n  // Get the input name we need, [] tells Rails that this is an array\r\n  formInputName = wrapElement.attr(\"name\").replace(\"_wrapper\", \"\") + \"[]\";\r\n\r\n  // Start counting entries so we can add value to input\r\n  var i = 0;\r\n\r\n  // Cycle through each chip\r\n  elem.children(\".chip\").each(function() {\r\n\r\n    // Get text of chip (effectively just excluding material icons 'close' text)\r\n    chipText = $(this).ignore(\"*\").text();\r\n\r\n    // Get id from original JSON array\r\n    // You should be able to check the initialised Materialize data array.... Not sure how to make that work\r\n    var chipID = findElement(dataJSON, \"name\", chipText);\r\n\r\n    // ?Check for undefined here, will be rejected by Rails anyway...?\r\n\r\n    // Add input with value of the selected model ID\r\n    $(this).parent().append('&lt;input value=\"' + chipID + '\"  multiple=\"multiple\" type=\"hidden\" name=\"' + formInputName + '\" auto-chip-entry=\"true\"&gt;');\r\n\r\n\r\n  });\r\n\r\n}\r\n\r\n\r\n// Get object from array of objects using property name and value\r\nfunction findElement(arr, propName, propValue) {\r\n  for (var i = 0; i &lt; arr.length; i++)\r\n    if (arr[i][propName] == propValue)\r\n      return arr[i].id; // Return id only\r\n  // will return undefined if not found; you could return a default instead\r\n}\r\n\r\n\r\n// Remove text from children, etc\r\n$.fn.ignore = function(sel) {\r\n  return this.clone().find(sel || \"&gt;*\").remove().end();\r\n};\r\n\r\n\r\n// Print to console instead of posting\r\n$(document).on(\"click\", \"input[type=submit]\", function(event) {\r\n\r\n  // Prevent submission of form\r\n  event.preventDefault();\r\n\r\n  // Gather input values\r\n  var info = [];\r\n  $(this).closest(\"form\").find(\"input\").each(function() {\r\n    info.push($(this).attr(\"name\") + \":\" + $(this).val());\r\n  });\r\n\r\n  // Prepare hash in easy to read format\r\n  var outText = \"&lt;h6&gt;Output&lt;/h6&gt;&lt;p&gt;\" + info.join(\"&lt;/br&gt;\") + \"&lt;/p&gt;\";\r\n  \r\n  // Add to output if exists, or create if it does not\r\n  if ($(\"#output\").length &gt; 0) {\r\n    $(\"#output\").html(outText);\r\n  } else {\r\n    $(\"form\").append(\"&lt;div id='output'&gt;\" + outText + \"&lt;/div&gt;\");\r\n  }\r\n\r\n\r\n});</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!-- jquery --&gt;\r\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;!-- Materialize CSS --&gt;\r\n&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css\"&gt;\r\n\r\n&lt;!-- Materialize JavaScript --&gt;\r\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;!-- Material Icon Webfont --&gt;\r\n&lt;link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\"&gt;\r\n\r\n\r\n\r\n&lt;form class=\"simple_form new_setting\" id=\"new_setting\" novalidate=\"novalidate\" data-client-side-validations=\"\" action=\"/settings\" accept-charset=\"UTF-8\" data-remote=\"true\" method=\"post\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"\u2713\"&gt;\r\n\r\n\r\n  &lt;div class=\"input-field col string optional setting_profession_name\"&gt;\r\n  &lt;input data-autocomplete='[{\"id\":1,\"name\":\"Consultant Doctor\"},{\"id\":2,\"name\":\"Junior Doctor (FY1)\"}]' class=\"string optional\" type=\"text\" name=\"setting[profession_name]\" id=\"setting_profession_name\"\r\n      data-target=\"autocomplete-options-30fe36f7-f61c-b2f3-e0ef-c513137b42f8\" data-validate=\"true\"&gt;\r\n      &lt;label class=\"string optional\" for=\"setting_profession_name\"&gt;Profession name&lt;/label&gt;&lt;/div&gt;\r\n\r\n  &lt;div id=\"team_ids\" name=\"setting[team_ids]\" class=\"chips input-field\" placeholder=\"Add a team\" data-autocomplete='[{\"id\":1,\"name\":\"Miss T\"},{\"id\":2,\"name\":\"Surgical Take\"}]'&gt;&lt;/div&gt;\r\n\r\n\r\n  &lt;input type=\"submit\" name=\"commit\" value=\"Create Setting\" data-disable-with=\"Create Setting\"&gt;\r\n\r\n&lt;/form&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1079, "favorite_count": 3, "accepted_answer_id": 53976401, "answer_count": 1, "score": 8, "last_activity_date": 1546180374, "creation_date": 1545159637, "last_edit_date": 1545645061, "question_id": 53839487, "link": "https://stackoverflow.com/questions/53839487/using-materialize-chip-and-autocomplete-in-ruby-on-rails-form-with-associate", "title": "Using Materialize `chip` and `autocomplete` in Ruby on Rails Form with Associated Models", "body": "<p>I am trying to create a form so a user can save a <code>setting</code> which has their default <code>teams</code> (multiple) and their <code>professions</code> (single). I can do this using <code>simple_form</code> and the lines of code below, but I am trying to use autocomplete as the dropdown lists do not work well with my design.</p>\n\n<ul>\n<li><code>&lt;%= f.association :profession %&gt;</code></li>\n<li><code>&lt;%= f.association :team, input_html: { multiple: true } %&gt;</code></li>\n</ul>\n\n<p>I am loading the JSON from a collection into an attribute <code>data-autocomplete-source</code> within my <code>inputs</code>, a short bit of <code>jquery</code> then cycles through each of these and then initialises the materialize <code>.autocomplete</code>, I also need to do this with <code>.chips</code> for many associations. </p>\n\n<p>The UI element is working as I would like, but I cannot work out how to save a new record. I have two problems:</p>\n\n<ol>\n<li><code>Unpermitted parameters: :team_name, :profession_name</code> - I've been trying to adapt this <a href=\"https://rubyplus.com/articles/3701-Auto-Complete-Association-in-Rails-5\" rel=\"noreferrer\">tutorial</a> and believed that Step 11 would effectively translate this within the model, but am clearly not understanding something...</li>\n<li><code>\"setting\"=&gt;{\"team_name\"=&gt;\"\", \"profession_name\"=&gt;\"Consultant Doctor\"}</code> - the <code>team_name</code> values (i.e. the <code>chips</code>) are not being recognised when attempting to save the record. I've got some nasty jquery that transfers the <code>id</code> from the <code>div</code> to the generated <code>input</code> which I was hoping would work...</li>\n</ol>\n\n<p>I've also checked many previous questions on Stack Overflow (some of which seem to be similar to this question, generally using jqueryui) but cannot work out how to adapt the answers.</p>\n\n<p><strong>How can I use the names from a model in a materialize <code>chip</code> and <code>autocomplete</code> input and save the selections by their associated <code>id</code> into a record?</strong></p>\n\n<p>Any help or guidance would be much appreciated.</p>\n\n<hr>\n\n<p><strong>setting.rb</strong></p>\n\n<pre><code>class Setting &lt; ApplicationRecord\n\n  has_and_belongs_to_many :team, optional: true\n\n  belongs_to :user\n  belongs_to :profession\n\n  def team_name\n    team.try(:name)\n  end\n\n  def team_name=(name)\n    self.team = Team.find_by(name: name) if name.present?\n  end\n\n  def profession_name\n    profession.try(:name)\n  end\n\n  def profession_name=(name)\n    self.profession = Profession.find_by(name: name) if name.present?\n  end\n\n\nend\n</code></pre>\n\n<p><strong>settings_controller.rb</strong></p>\n\n<pre><code>  def new\n\n    @user = current_user\n    @professions = Profession.all\n    @teams = Team.all\n    @setting = Setting.new\n\n    @teams_json = @teams.map(&amp;:name)\n    @professions_json = @professions.map(&amp;:name)\n\n    render layout: \"modal\"\n\n  end\n\n\n  def create\n\n    @user = current_user\n    @setting = @user.settings.create(setting_params)\n\n    if @setting.save \n      redirect_to action: \"index\"\n    else\n      flash[:success] = \"Failed to save settings\"\n      render \"new\"   \n    end\n\n  end\n\n\n  private\n\n    def setting_params\n      params.require(:setting).permit(:user_id, :contact, :view, :taketime, :sortname, :sortlocation, :sortteam, :sortnameorder, :sortlocationorder, :sortteamorder, :location_id, :profession_id, :department_id, team_ids: [])\n    end\n</code></pre>\n\n<p><strong>views/settings/new.html.erb</strong></p>\n\n<pre><code>&lt;%= simple_form_for @setting do |f| %&gt;\n\n\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"col s12\"&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"input-field autocomplete_dynamic col s12\"&gt;\n        &lt;i class=\"material-icons prefix\"&gt;group&lt;/i&gt;\n\n        &lt;div data-autocomplete-source='&lt;%= @teams_json %&gt;' class=\"string optional chips\" type=\"text\" name=\"setting[team_name]\" id=\"setting_team_name\"&gt;&lt;/div&gt;\n\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n\n\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"col s12\"&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"input-field autocomplete_dynamic col s12\"&gt;\n        &lt;i class=\"material-icons prefix\"&gt;group&lt;/i&gt;\n\n          &lt;%= f.input :profession_name, wrapper: false, label: false, as: :search, input_html: {:data =&gt; {autocomplete_source: @professions_json} } %&gt;\n\n        &lt;label for=\"autocomplete-input\"&gt;Select your role&lt;/label&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n\n\n  &lt;%= f.submit %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(\"*[data-autocomplete-source]\").each(function() {\r\n\r\n  var items = [];\r\n  var dataJSON = JSON.parse($(this).attr(\"data-autocomplete-source\"));\r\n\r\n  var i;\r\n  for (i = 0; i &lt; dataJSON.length; ++i) {\r\n    items[dataJSON[i]] = null;\r\n  }\r\n\r\n  if ($(this).hasClass(\"chips\")) {\r\n\r\n    $(this).chips({\r\n      placeholder: $(this).attr(\"placeholder\"),\r\n      autocompleteOptions: {\r\n        data: items,\r\n        limit: Infinity,\r\n        minLength: 1\r\n      }\r\n    });\r\n\r\n\r\n    // Ugly jquery to give the generated input the correct id and name\r\n    idStore = $(this).attr(\"id\");\r\n    $(this).attr(\"id\", idStore + \"_wrapper\");\r\n    nameStore = $(this).attr(\"name\");\r\n    $(this).attr(\"name\", nameStore + \"_wrapper\");\r\n\r\n    $(this).find(\"input\").each(function() {\r\n      $(this).attr(\"id\", idStore);\r\n      $(this).attr(\"name\", nameStore);\r\n    });\r\n\r\n\r\n  } else {\r\n\r\n    $(this).autocomplete({\r\n      data: items,\r\n    });\r\n\r\n  }\r\n\r\n});</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.prefix~.chips {\r\n  margin-top: 0px;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!-- jquery --&gt;\r\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;!-- Materialize CSS --&gt;\r\n&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css\"&gt;\r\n\r\n&lt;!-- Materialize JavaScript --&gt;\r\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;!-- Material Icon Webfont --&gt;\r\n&lt;link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\"&gt;\r\n\r\n\r\n\r\n\r\n&lt;div class=\"row\"&gt;\r\n  &lt;div class=\"col s12\"&gt;\r\n    &lt;div class=\"row\"&gt;\r\n      &lt;div class=\"input-field autocomplete_dynamic col s12\"&gt;\r\n        &lt;i class=\"material-icons prefix\"&gt;group&lt;/i&gt;\r\n\r\n        &lt;div data-autocomplete-source='[\"Miss T\",\"Mr C\",\"Mr D\",\"Medicine Take\",\"Surgery Take\"]' class=\"string optional chips\" type=\"text\" name=\"setting[team_name]\" id=\"setting_team_name\"&gt;&lt;/div&gt;\r\n\r\n\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;\r\n\r\n\r\n\r\n\r\n&lt;div class=\"row\"&gt;\r\n  &lt;div class=\"col s12\"&gt;\r\n    &lt;div class=\"row\"&gt;\r\n      &lt;div class=\"input-field autocomplete_dynamic col s12\"&gt;\r\n        &lt;i class=\"material-icons prefix\"&gt;group&lt;/i&gt;\r\n\r\n        &lt;input class=\"string optional input-field\" data-autocomplete-source='[\"Consultant Doctor\",\"Ward Clerk\",\"Nurse\",\"Foundation Doctor (FY1)\",\"Foundation Doctor (FY2)\",\"Core Trainee Doctor (CT2)\",\"Core Trainee Doctor (CT1)\"]' type=\"text\" name=\"setting[profession_name]\"\r\n          id=\"setting_profession_name\"&gt;\r\n\r\n\r\n        &lt;label for=\"autocomplete-input\"&gt;Select your role&lt;/label&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><strong>Gems and versions</strong></p>\n\n<ul>\n<li>ruby '2.5.0'</li>\n<li>gem 'rails', '~> 5.2.1'</li>\n<li>gem 'materialize-sass' </li>\n<li>gem 'material_icons'  </li>\n<li>gem\n'materialize-form' </li>\n<li>gem 'simple_form', '>= 4.0.1' </li>\n<li>gem\n'client_side_validations'</li>\n<li>gem 'client_side_validations-simple_form'</li>\n</ul>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545170808, "post_id": 53839265, "comment_id": 94531817, "body": "You may wish to look at <a href=\"https://blog.honeybadger.io/avoid-these-traps-when-nesting-ruby-modules/\" rel=\"nofollow noreferrer\">this article</a>, though @Max provides a good explanation."}], "answers": [{"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1545261925, "post_id": 53839700, "comment_id": 94569054, "body": "Can you define what you mean by &quot;semantic object relationships&quot;?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1545312906, "post_id": 53839700, "comment_id": 94586423, "body": "I mean things like inheritance, included modules, singleton classes. All of the ways that objects relate to each other in meaning, not just how they&#39;re organized in your source code."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1545161091, "last_edit_date": 1545161091, "creation_date": 1545160745, "answer_id": 53839700, "question_id": 53839265, "link": "https://stackoverflow.com/questions/53839265/understanding-module-nesting-in-ruby-and-the-types-of-module-nestings/53839700#53839700", "title": "Understanding Module.nesting in Ruby and the types of Module Nestings", "body": "<p>In Ruby, nesting is a <em>syntactic</em> construct. In other words, it has to do with how the code is actually written out in the script. The difference in nesting is obvious if you ignore the <em>semantics</em> by removing the names, and just look at the syntax:</p>\n\n<pre><code>module ...\n  class ...\n    ...\n  end\nend\n\n# as opposed to\n\nclass ...\n  ...\nend\n</code></pre>\n\n<p>One is a class inside a module, the other one is just a class. Semantically, both can refer to the same <em>object</em> <code>XML::SAXParser</code>, but nesting doesn't care about that.</p>\n\n<p>This matters in Ruby because constant lookup is performed using nesting, as opposed to method lookup which uses the semantic object relationships.</p>\n\n<pre><code>A = \"top level\"\nmodule XML\n  A = \"module level\"\n  class SAXParser\n    puts A # module level\n\n    def self.a\n      \"defined in a class in a module\"\n    end\n  end\nend\n\nclass XML::SAXParser\n  puts A # top level\n  puts a # defined in a class in a module\nend\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 53839700, "answer_count": 1, "score": 1, "last_activity_date": 1545161091, "creation_date": 1545158634, "last_edit_date": 1545159122, "question_id": 53839265, "link": "https://stackoverflow.com/questions/53839265/understanding-module-nesting-in-ruby-and-the-types-of-module-nestings", "title": "Understanding Module.nesting in Ruby and the types of Module Nestings", "body": "<p>What I know about Modules: Modules cannot be instantiated, do not create objects, and do not support inheritance. Now I am reading <a href=\"https://guides.rubyonrails.org/autoloading_and_reloading_constants.html\" rel=\"nofollow noreferrer\">Rails Guides</a> to fully understand the Rails autoload feature. And it introduces a topic on Ruby constants, particularly Modules and Classes.</p>\n\n<p>Class and module definitions can be nested to create namespaces:</p>\n\n<pre><code>module XML\n  class SAXParser\n    Module.nesting.inspect\n  end\nend\n\n =&gt; \"[XML::SAXParser, XML]\"\n</code></pre>\n\n<p>Rails Guides states that the nesting at any given place (e.g. Module.nesting shown above) is the collection of enclosing nested class and module objects outwards. I think this means that it expands as it goes outward, so inner would be C::B::A, then next level up would be B::A, and next level up would be A, assuming:</p>\n\n<pre><code>module A \n  module B\n    class C\n    end\n  end\nend\n</code></pre>\n\n<p>Then another case is given:</p>\n\n<pre><code>class XML::SAXParser\n  Module.nesting.inspect\nend\n =&gt; \"[XML::SAXParser]\"\n</code></pre>\n\n<p>As you can see, the nesting is different. The Rails Guide states \"XML does not belong to it\". What does this statement mean? Does not belong to it? There is no inheritance in Modules. Can someone better explain the difference between these two cases?</p>\n"}, {"tags": ["ruby", "rake", "hanami", "hanami-model", "rom-rb"], "comments": [{"owner": {"reputation": 1146, "user_id": 498386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76aa5b311fb40fdc2bb70c0282d66af3?s=128&d=identicon&r=PG", "display_name": "Luca Guidi", "link": "https://stackoverflow.com/users/498386/luca-guidi"}, "edited": false, "score": 0, "creation_date": 1545244261, "post_id": 53838913, "comment_id": 94562202, "body": "Hello, which Rake tasks?"}, {"owner": {"reputation": 533, "user_id": 3311451, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/uISPr.jpg?s=128&g=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/3311451/dimitri"}, "reply_to_user": {"reputation": 1146, "user_id": 498386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76aa5b311fb40fdc2bb70c0282d66af3?s=128&d=identicon&r=PG", "display_name": "Luca Guidi", "link": "https://stackoverflow.com/users/498386/luca-guidi"}, "edited": false, "score": 0, "creation_date": 1545245496, "post_id": 53838913, "comment_id": 94562717, "body": "Hi, Luca. Mostly all stuff about migrations. Generating models+, migrations up-down."}, {"owner": {"reputation": 1146, "user_id": 498386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76aa5b311fb40fdc2bb70c0282d66af3?s=128&d=identicon&r=PG", "display_name": "Luca Guidi", "link": "https://stackoverflow.com/users/498386/luca-guidi"}, "edited": false, "score": 0, "creation_date": 1545253199, "post_id": 53838913, "comment_id": 94565932, "body": "Those aren&#39;t Rake tasks, but CLI subcommands of <code>hanami</code> executable. Eg. <code>bundle exec hanami db migrate</code>. For now, those are shipped with the <code>hanami</code> gem. We&#39;re planning to migrate to <code>hanami-model</code> on 2.0."}], "answers": [{"tags": [], "owner": {"reputation": 287, "user_id": 3171006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7dfc74cd6e3194a22ef6fac2c51f0ae?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/3171006/anton"}, "is_accepted": false, "score": 1, "last_activity_date": 1545237597, "creation_date": 1545237597, "answer_id": 53855581, "question_id": 53838913, "link": "https://stackoverflow.com/questions/53838913/using-hanami-model-and-rake-tasks-without-a-router-etc/53855581#53855581", "title": "Using Hanami model and rake tasks without a router etc", "body": "<p>hello. If I understand you right, you want to use interactors only with models. Interactors you can use as a regular ruby library.</p>\n\n<p>For model, you need to configure all this staff and load to memory. You can check the example from our playbook. Hope it'll be helpful for you</p>\n\n<p><a href=\"https://github.com/hanami/playbook/blob/master/development/bug_templates/model_psql.rb\" rel=\"nofollow noreferrer\">https://github.com/hanami/playbook/blob/master/development/bug_templates/model_psql.rb</a></p>\n"}, {"tags": [], "owner": {"reputation": 1146, "user_id": 498386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76aa5b311fb40fdc2bb70c0282d66af3?s=128&d=identicon&r=PG", "display_name": "Luca Guidi", "link": "https://stackoverflow.com/users/498386/luca-guidi"}, "is_accepted": true, "score": 3, "last_activity_date": 1545308550, "creation_date": 1545308550, "answer_id": 53868610, "question_id": 53838913, "link": "https://stackoverflow.com/questions/53838913/using-hanami-model-and-rake-tasks-without-a-router-etc/53868610#53868610", "title": "Using Hanami model and rake tasks without a router etc", "body": "<p>Alternatively, you can add <code>hanami</code> as a development gem. That gives you access to the code generators. At the deploy stage, you don't bundle <code>hanami</code>, so the app will only have <code>hanami-model</code> and <code>hanami-utils</code> in production.</p>\n"}], "owner": {"reputation": 533, "user_id": 3311451, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/uISPr.jpg?s=128&g=1", "display_name": "Dimitri", "link": "https://stackoverflow.com/users/3311451/dimitri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 2, "accepted_answer_id": 53868610, "answer_count": 2, "score": 1, "last_activity_date": 1545308550, "creation_date": 1545157029, "last_edit_date": 1545157661, "question_id": 53838913, "link": "https://stackoverflow.com/questions/53838913/using-hanami-model-and-rake-tasks-without-a-router-etc", "title": "Using Hanami model and rake tasks without a router etc", "body": "<p>I'm going to write a service that will using amqp protocol, without http at all. I like hanami's paradigm of repository-entity-model-interactors and I wonder to use those in my project. Generating all that stuff by hand, sure, is boring.</p>\n\n<p>So, I wonder to grab rake tasks. Looking into config/environment etc, ughhhh. What is the best method, shortly, to use those tools without hanami router and controllers? Or, it is all integrated tightly?</p>\n\n<p>As I think for that moment, there are two ways:</p>\n\n<p>a) To include only hanami-model into my Gemfile, then copy by hand every needed file from gem hanami.</p>\n\n<p>b) To create hanami project and do not use rackup.</p>\n\n<p>I'm disappointed.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1545154844, "post_id": 53838298, "comment_id": 94524939, "body": "How do you determine which values to concatenate? And is the key supposed to be <code>value1</code>? Could you give an example with clear inputs and the output you&#39;d like? Finally, why are you deconstructing the hash like this?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545159369, "post_id": 53838298, "comment_id": 94527031, "body": "It would be helpful if you would provide a fuller example to show what you want to do. Examples should be complete (no <code>...</code>, for example) and all inputs should be valid Ruby objects (strings should be in quotes, for example). That enables readers to test their code against your example to confirm that it provides the desired result. When giving examples please assign a variable to each input (e.g., <code>str = &quot;...&quot;</code> or <code>h = { ... }</code>) so that readers can refer to those variables in answers and comments. Always show the desired result (as you have) and make examples as concise as possible."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545159389, "post_id": 53838298, "comment_id": 94527039, "body": "As the first step is obviously to create a hash from the JSON string, it would have been be simpler to begin with that hash and make no mention of JSON."}, {"owner": {"reputation": 187, "user_id": 1481788, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/bfbefacea1ada3dac058bad1168d04d2?s=128&d=identicon&r=PG", "display_name": "Kickasstimus", "link": "https://stackoverflow.com/users/1481788/kickasstimus"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545235332, "post_id": 53838298, "comment_id": 94557661, "body": "@CarySwoveland Thanks! I updated it and ended up solving the problem while I was editing this."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 1481788, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/bfbefacea1ada3dac058bad1168d04d2?s=128&d=identicon&r=PG", "display_name": "Kickasstimus", "link": "https://stackoverflow.com/users/1481788/kickasstimus"}, "edited": false, "score": 0, "creation_date": 1545156392, "post_id": 53838581, "comment_id": 94525705, "body": "Thanks -- this is close, but I need to be able to select certain keys by name and create the hash from those specific keys. I apologize if that wasn&#39;t clear. There are about 50 key:value pairs per item in result. I need to create a hash from where the hash key is the value of a json key called &quot;sys_created_on&quot; (a date) and map that to a hash value created from json key values &quot;number&quot; and &quot;short_description&quot; ... {&quot;(value of) sys_created_on&quot; =&gt; &quot;(value of) number + (value of)short_description&quot;} ... I think I see where you are going though and I&#39;m working through some ideas now."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 187, "user_id": 1481788, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/bfbefacea1ada3dac058bad1168d04d2?s=128&d=identicon&r=PG", "display_name": "Kickasstimus", "link": "https://stackoverflow.com/users/1481788/kickasstimus"}, "edited": false, "score": 3, "creation_date": 1545158688, "post_id": 53838581, "comment_id": 94526727, "body": "I suggest you edit your question to incorporate the content of your comment. In general, clarifications of questions should be done by editing the question rather than elaborating in comments, in part because not all readers read all comments."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1545155975, "last_edit_date": 1545155975, "creation_date": 1545155604, "answer_id": 53838581, "question_id": 53838298, "link": "https://stackoverflow.com/questions/53838298/in-ruby-how-do-i-use-the-value-of-a-key-from-json-as-the-key-for-a-ruby-hash-th/53838581#53838581", "title": "In Ruby, how do I use the value of a key from JSON as the key for a ruby hash that has it&#39;s values composed of two concatenated values?", "body": "<pre><code>require 'json'\n\njson = '{ \"result\":[{ \"key1\":\"value1\", \"key2\":\"value2\", \"keyN\":\"valueN\" }] }'\n\nh = JSON.parse(json)\n  #=&gt; {\"result\"=&gt;[{\"key1\"=&gt;\"value1\", \"key2\"=&gt;\"value2\", \"keyN\"=&gt;\"valueN\"}]}\narr = h[\"result\"].first.values\n  #=&gt; [\"value1\", \"value2\", \"valueN\"]\n{ arr.shift=&gt;arr.reduce(:+) }\n  #=&gt; {\"value1\"=&gt;\"value2valueN\"}\n</code></pre>\n\n<p>The first two statements can of course be chained:</p>\n\n<pre><code>arr = JSON.parse(json)[\"result\"].first.values\n  #=&gt; [\"value1\", \"value2\", \"valueN\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 1481788, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/bfbefacea1ada3dac058bad1168d04d2?s=128&d=identicon&r=PG", "display_name": "Kickasstimus", "link": "https://stackoverflow.com/users/1481788/kickasstimus"}, "is_accepted": false, "score": 0, "last_activity_date": 1545310210, "creation_date": 1545310210, "answer_id": 53869095, "question_id": 53838298, "link": "https://stackoverflow.com/questions/53838298/in-ruby-how-do-i-use-the-value-of-a-key-from-json-as-the-key-for-a-ruby-hash-th/53869095#53869095", "title": "In Ruby, how do I use the value of a key from JSON as the key for a ruby hash that has it&#39;s values composed of two concatenated values?", "body": "<p>Here's what I ended up with:</p>\n\n<pre><code>  new_old = result.each_with_object({}) do |item, hash|\n      hash[item['sys_created_on']] = item['number'] + \" | \" + \n      item['short_description']\n  end\n</code></pre>\n\n<p>This iterates over the given collection passing each element and the given object to the block. Perfect for building hashes. </p>\n"}], "owner": {"reputation": 187, "user_id": 1481788, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/bfbefacea1ada3dac058bad1168d04d2?s=128&d=identicon&r=PG", "display_name": "Kickasstimus", "link": "https://stackoverflow.com/users/1481788/kickasstimus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545310210, "creation_date": 1545154422, "last_edit_date": 1545235273, "question_id": 53838298, "link": "https://stackoverflow.com/questions/53838298/in-ruby-how-do-i-use-the-value-of-a-key-from-json-as-the-key-for-a-ruby-hash-th", "title": "In Ruby, how do I use the value of a key from JSON as the key for a ruby hash that has it&#39;s values composed of two concatenated values?", "body": "<p>I have JSON from an API of the form:</p>\n\n<pre><code>{  \n\"result\":[  \n  {  \"sys_created_on\":\"2018-10-10\",\n     \"number\":\"NUM54321\", \n     \"short_description\":\"This is a short description.\",\n     \"other\":\"this is other stuff\"\n  },{\n     \"sys_created_on\":\"2018-10-12\",\n     \"number\":\"NUM12345\", \n     \"short_description\":\"This is another short description.\",\n     \"other\":\"more extra stuff\"\n  },{\n     ... and so on for 1000's of lines\n</code></pre>\n\n<p>In Ruby, what I'd like to do, is create a structure that is of the form</p>\n\n<pre><code>{\"sys_created_on(1)\" =&gt; \"number(1) + \" | \" + short_description(1)\",  \n \"sys_created_on(2)\" =&gt; \"number(2) + \" | \" + short_description(2)\",\n \"sys_created_on(3)\" =&gt; \"number(3) + \" | \" + short_description(3)\",\n etc...\n}\n</code></pre>\n\n<p>specifically, using the example data:</p>\n\n<pre><code>{\"2018-10-10\" =&gt; \"NUM54321 | This is a short description.\",\n \"2018-10-12\" =&gt; \"NUM12345 | This is another short description.\",\n etc...\n}\n</code></pre>\n\n<p>That is ... use the value of a key from the JSON as the key for a ruby hash that has it's values composed of two concatenated values from the same JSON. </p>\n\n<p>I ended up solving this problem using the following code:</p>\n\n<pre><code>my_list = result.each_with_object({}) do |item, hash|\n   hash[item['sys_created_on']] = item['number'] + \" | \" + item['short_description']\nend\n</code></pre>\n\n<p>That gave me what I needed in the way I needed it.</p>\n"}, {"tags": ["ruby", "faker"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1545157496, "creation_date": 1545157496, "answer_id": 53839013, "question_id": 53838001, "link": "https://stackoverflow.com/questions/53838001/how-to-see-how-many-unique-strings-fakercategory-here-whatever-will-provide/53839013#53839013", "title": "How to see how many unique strings Faker::Category_Here.whatever will provide?", "body": "<p>Looking into <a href=\"https://github.com/stympy/faker/tree/master/lib/locales\" rel=\"nofollow noreferrer\">faker's I18n files</a> might be a good start.</p>\n\n<p>For example, in the English I18n file for the compass namespace there are <a href=\"https://github.com/stympy/faker/blob/master/lib/locales/en/compass.yml\" rel=\"nofollow noreferrer\">32 different directions</a> listed.</p>\n"}], "owner": {"reputation": 33, "user_id": 9211117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cyPX1.jpg?s=128&g=1", "display_name": "S. Argentina", "link": "https://stackoverflow.com/users/9211117/s-argentina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545157496, "creation_date": 1545153155, "question_id": 53838001, "link": "https://stackoverflow.com/questions/53838001/how-to-see-how-many-unique-strings-fakercategory-here-whatever-will-provide", "title": "How to see how many unique strings Faker::Category_Here.whatever will provide?", "body": "<p>Having trouble figuring out how to take all examples of a string from a specific Faker class. For instance, in Ruby I can use, Faker::Compass.direction, and it will give a random direction. I can't do Faker::Compass.direction.all or .count to show me what's present within this class. Is there any way for me to access all the examples at once as an array?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "image-processing", "rails-activestorage", "minimagick"], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 4, "last_activity_date": 1545158473, "creation_date": 1545158473, "answer_id": 53839241, "question_id": 53837727, "link": "https://stackoverflow.com/questions/53837727/rails-5-2-activestorage-save-and-then-read-exif-data/53839241#53839241", "title": "Rails 5.2 ActiveStorage save and then read Exif data", "body": "<p>I think you want to use a variant when displaying the image rather than trying to edit the stored image. To fix the orientation, you could say:</p>\n\n<pre><code>user.avatar.variant(auto_orient: true)\n</code></pre>\n\n<p>And if you want to do several operations at once (rather than in a pipeline), use <code>combine_options</code>:</p>\n\n<pre><code>user.avatar.variant(combine_options: {\n  auto_orient: true,\n  gravity:     'center',\n  resize:      '23x42',    # Using real dimensions of course.\n  crop:        '23x42+0+0'\n})\n</code></pre>\n\n<p>The edited image will be cached so you only do the transformation work on first access. You might want to put your <code>variant</code>s into view helpers (or maybe even a model concern depending on your needs) so that you can isolate the noise.</p>\n\n<p>You might want to refer to the API docs as well as the guide:</p>\n\n<ul>\n<li><a href=\"https://api.rubyonrails.org/classes/ActiveStorage/Variant.html\" rel=\"nofollow noreferrer\">ActiveStorage::Variant</a></li>\n<li><a href=\"https://api.rubyonrails.org/classes/ActiveStorage/Variation.html\" rel=\"nofollow noreferrer\">ActiveStorage::Variation</a></li>\n</ul>\n"}], "owner": {"reputation": 320, "user_id": 6501234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e980b8b7894381f8d85eb060b7b0cbf?s=128&d=identicon&r=PG", "display_name": "Corey Gibson", "link": "https://stackoverflow.com/users/6501234/corey-gibson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "accepted_answer_id": 53839241, "answer_count": 1, "score": 3, "last_activity_date": 1545158473, "creation_date": 1545152081, "question_id": 53837727, "link": "https://stackoverflow.com/questions/53837727/rails-5-2-activestorage-save-and-then-read-exif-data", "title": "Rails 5.2 ActiveStorage save and then read Exif data", "body": "<p>On Rails 5.2 I am trying to save an avatar via ActiveStorage but it seems as though not image oriantation data is being saved in the active storage blob. </p>\n\n<p>I am saving the avatar via a file_field on a create action my</p>\n\n<pre><code>#user model \n\nhas_one_attached :avatar\n\nprivate\n\ndef avatar_validation\n  if avatar.attached?\n    if avatar.blob.byte_size &gt; 1000000\n      avatar.purge\n      errors.add(:avatar, 'file is too large')\n    elsif !avatar.blob.content_type.in?(%w[image/png image/jpg \n          image/jpeg])\n      avatar.purge\n      errors.add(:avatar, 'file type needs to be JPEG, JPG, or PNG')\n    end\n  end\nend\n</code></pre>\n\n<p>I have been reading some documentation for minimagick <a href=\"https://github.com/minimagick/minimagick\" rel=\"nofollow noreferrer\">https://github.com/minimagick/minimagick</a> but have not figured out how I can associate </p>\n\n<pre><code>user.avatar.blob \n</code></pre>\n\n<p>with </p>\n\n<pre><code>image = MiniMagick::Image.open(\"input.jpg\")\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>image = MiniMagick::Image.open(\"user.avatar.blob\")\n</code></pre>\n\n<p>but have had no luck</p>\n\n<p>I need to try and figure this out because some avatars stored in active storage are being displayed rotated 90 degrees. </p>\n\n<p><a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_storage_overview.html</a>\ntalks of image processing but I have also had no luck with the gem rails recommends </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1545151346, "post_id": 53837488, "comment_id": 94523062, "body": "<code>foo.delete_if { |k, v| v.size == 1 }</code> would work."}, {"owner": {"reputation": 41223, "user_id": 175836, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3b5a5015d8459c645abe6e906b9e77b?s=128&d=identicon&r=PG", "display_name": "randombits", "link": "https://stackoverflow.com/users/175836/randombits"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545151776, "post_id": 53837488, "comment_id": 94523303, "body": "@Stefan want to put the answer below so I can give you credit?"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1545163338, "post_id": 53839395, "comment_id": 94528769, "body": "What makes <code>inner.size == 1</code> a  <i>&quot;negative condition&quot;</i>?"}, {"owner": {"reputation": 5980, "user_id": 60131, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/axDcf.jpg?s=128&g=1", "display_name": "John Gallagher", "link": "https://stackoverflow.com/users/60131/john-gallagher"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545163774, "post_id": 53839395, "comment_id": 94528958, "body": "Good question - I wasn&#39;t clear enough. That&#39;s not a negative condition. I meant a negative operator - I was referring to <code>delete_if</code>. :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1545164520, "post_id": 53839395, "comment_id": 94529304, "body": "<i>&quot;it&#39;s telling you what you <b>don&#39;t</b> want&quot;</i> \u2013 if you think of &quot;keeping&quot; as positive and &quot;deleting&quot; as negative then you&#39;re right. I think of it as <code>&lt;action&gt;_if</code> which to me is always positive \u2013 it decides which elements are chosen for <code>&lt;action&gt;</code>. It would be something else if the method was called <code>delete_unless</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1545164594, "post_id": 53839395, "comment_id": 94529336, "body": "Since you included <code>many?</code> why not <code>reject {|_, v| v.one? }</code> which is part of ruby <code>Enumerable</code>"}, {"owner": {"reputation": 5980, "user_id": 60131, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/axDcf.jpg?s=128&g=1", "display_name": "John Gallagher", "link": "https://stackoverflow.com/users/60131/john-gallagher"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545164872, "post_id": 53839395, "comment_id": 94529471, "body": "@Stefan - wow. That&#39;s a great point. I&#39;d never thought of it like that. It&#39;s really not a negative operator at all. I&#39;ll update my answer."}], "tags": [], "owner": {"reputation": 5980, "user_id": 60131, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/axDcf.jpg?s=128&g=1", "display_name": "John Gallagher", "link": "https://stackoverflow.com/users/60131/john-gallagher"}, "is_accepted": true, "score": 4, "last_activity_date": 1545164958, "last_edit_date": 1545164958, "creation_date": 1545159190, "answer_id": 53839395, "question_id": 53837488, "link": "https://stackoverflow.com/questions/53837488/ruby-2-5-efficient-way-to-delete-ruby-key-if-it-contains-a-hash-with-only-one-ke/53839395#53839395", "title": "Ruby 2.5 efficient way to delete ruby key if it contains a hash with only one key/val pair", "body": "<h3>Option 1 - <code>delete_if</code></h3>\n\n<pre><code>foo.delete_if { |_, inner| inner.one? }\n</code></pre>\n\n<ul>\n<li><code>delete_if</code> is destructive so it mutates the original hash</li>\n<li>This will let through empty hashes</li>\n</ul>\n\n<h3>Option 2 - <code>reject</code></h3>\n\n<p>This doesn't mutate any more:</p>\n\n<pre><code>foo = foo.reject { |_, inner| inner.one? }\n</code></pre>\n\n<ul>\n<li>This will let through empty hashes</li>\n</ul>\n\n<h3>Option 3 - <code>select</code></h3>\n\n<p>No mutation plus different operator:</p>\n\n<pre><code>foo = foo.select { |_, inner| inner.size &gt; 1 }\n</code></pre>\n\n<h3>Option 4 - <code>many?</code> - Rails only</h3>\n\n<pre><code>foo = foo.select { |_, inner| inner.many? }\n</code></pre>\n\n<ul>\n<li>If you're using Rails it defines <code>#many?</code> for you which is any array with more than 1 item</li>\n</ul>\n\n<h3>Other Notes</h3>\n\n<ul>\n<li>Used <code>_</code> for unused variables as that's a way of showing \"this is irrelevant\"</li>\n<li>Named the variable <code>inner</code> - convinced there's a better name but <code>value</code> could be confusing</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1545201305, "creation_date": 1545201305, "answer_id": 53845775, "question_id": 53837488, "link": "https://stackoverflow.com/questions/53837488/ruby-2-5-efficient-way-to-delete-ruby-key-if-it-contains-a-hash-with-only-one-ke/53845775#53845775", "title": "Ruby 2.5 efficient way to delete ruby key if it contains a hash with only one key/val pair", "body": "<p>Just a pair of option more, letting apart the way to check the condition.</p>\n\n<p>Using <strong><a href=\"https://ruby-doc.org/core-2.5.1/Hash.html#method-i-keep_if\" rel=\"nofollow noreferrer\">Hash#keep_if</a></strong></p>\n\n<pre><code>foo.keep_if{ |_, v| v.size &gt; 1 }\n</code></pre>\n\n<p>And a more complicated, <strong><a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a></strong>:</p>\n\n<pre><code>foo.each_with_object({}){ |(k,v), h| h[k] = v if v.size &gt; 1 }\n</code></pre>\n"}], "owner": {"reputation": 41223, "user_id": 175836, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3b5a5015d8459c645abe6e906b9e77b?s=128&d=identicon&r=PG", "display_name": "randombits", "link": "https://stackoverflow.com/users/175836/randombits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53839395, "answer_count": 2, "score": 1, "last_activity_date": 1545201305, "creation_date": 1545151118, "question_id": 53837488, "link": "https://stackoverflow.com/questions/53837488/ruby-2-5-efficient-way-to-delete-ruby-key-if-it-contains-a-hash-with-only-one-ke", "title": "Ruby 2.5 efficient way to delete ruby key if it contains a hash with only one key/val pair", "body": "<p>Assuming a data structure that looks like the following:</p>\n\n<pre><code>foo = {\n    'first': {\n        'bar': 'foo'\n    },\n    'second': {\n        'bar': 'foobar',\n        'foo': 'barfoo'\n    },\n    'third': {\n        'test': 'example'\n    }\n}\n</code></pre>\n\n<p>I want to remove all keys from the Hash <code>foo</code> that contain an entry that has only one key/val pair. In this particular case, after the operation is done, <code>foo</code> should only have left:</p>\n\n<pre><code>foo = {\n    'second': {\n        'bar': 'foobar',\n        'foo': 'barfoo'\n    }\n}\n</code></pre>\n\n<p>as <code>foo['first']</code> and <code>foo['third']</code> only contain one key/val pair.</p>\n"}, {"tags": ["javascript", "ruby", "reactjs", "web-frameworks"], "comments": [{"owner": {"reputation": 3352, "user_id": 1121345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ee603e2729cd5f1c147c850e4f6d70?s=128&d=identicon&r=PG", "display_name": "Aur&#233;lien", "link": "https://stackoverflow.com/users/1121345/aur%c3%a9lien"}, "edited": false, "score": 1, "creation_date": 1545150380, "post_id": 53836956, "comment_id": 94522488, "body": "Did you search the Web for &quot;server side virtual DOM&quot;? What about <code>ReactDOMServer</code>? Why doesn&#39;t it fit your needs?"}, {"owner": {"reputation": 461, "user_id": 9119379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4c145c166f7a8b1071dbf53c4df36e?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertS", "link": "https://stackoverflow.com/users/9119379/alberts"}, "edited": false, "score": 0, "creation_date": 1545150987, "post_id": 53836956, "comment_id": 94522862, "body": "Great! Need to try it))"}, {"owner": {"reputation": 9563, "user_id": 231624, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/pU5YW.jpg?s=128&g=1", "display_name": "Alex Craft", "link": "https://stackoverflow.com/users/231624/alex-craft"}, "reply_to_user": {"reputation": 3352, "user_id": 1121345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ee603e2729cd5f1c147c850e4f6d70?s=128&d=identicon&r=PG", "display_name": "Aur&#233;lien", "link": "https://stackoverflow.com/users/1121345/aur%c3%a9lien"}, "edited": false, "score": 0, "creation_date": 1545151321, "post_id": 53836956, "comment_id": 94523048, "body": "@Aur&#233;lien as far as I know <code>ReactDOMServer</code> does different thing - it renders react into static DOM, usually for initial page load. It does not handles interactivity."}, {"owner": {"reputation": 3352, "user_id": 1121345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ee603e2729cd5f1c147c850e4f6d70?s=128&d=identicon&r=PG", "display_name": "Aur&#233;lien", "link": "https://stackoverflow.com/users/1121345/aur%c3%a9lien"}, "edited": false, "score": 0, "creation_date": 1545213576, "post_id": 53836956, "comment_id": 94544973, "body": "@AlexeyPetrushin I&#39;m not myself familiar to <code>ReactDomServer</code> but it seems that you can <code>hydrate</code> a component so that the server-rendered HTML is linked to the server-side state. <a href=\"https://github.com/reduxjs/redux/blob/master/docs/recipes/ServerRendering.md\" rel=\"nofollow noreferrer\">github.com/reduxjs/redux/blob/master/docs/recipes/&hellip;</a>"}, {"owner": {"reputation": 545, "user_id": 3156509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E5THb.jpg?s=128&g=1", "display_name": "Beeno Tung", "link": "https://stackoverflow.com/users/3156509/beeno-tung"}, "edited": false, "score": 1, "creation_date": 1611251351, "post_id": 53836956, "comment_id": 116397473, "body": "You may checkout <a href=\"https://github.com/beenotung/ts-liveview\" rel=\"nofollow noreferrer\">ts-liveview</a>, which is heavily inspired by Phoenix Liveview but implemented in Typescript (you can use it with javascript as well). It&#39;s not production ready, I&#39;m rewriting in pre-v2 branch for more modulized and flexible structure."}], "answers": [{"comments": [{"owner": {"reputation": 9563, "user_id": 231624, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/pU5YW.jpg?s=128&g=1", "display_name": "Alex Craft", "link": "https://stackoverflow.com/users/231624/alex-craft"}, "edited": false, "score": 0, "creation_date": 1545151720, "post_id": 53837474, "comment_id": 94523274, "body": "Thanks, but <code>marko</code> server rendering does only half the story, it only renders the initial state of the page. It does not handles the interactivity."}], "tags": [], "owner": {"reputation": 3684, "user_id": 2186639, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cdc7804e9b5848a50abf9977969ab705?s=128&d=identicon&r=PG", "display_name": "Do\u011fancan Arabac\u0131", "link": "https://stackoverflow.com/users/2186639/do%c4%9fancan-arabac%c4%b1"}, "is_accepted": false, "score": 0, "last_activity_date": 1545151059, "creation_date": 1545151059, "answer_id": 53837474, "question_id": 53836956, "link": "https://stackoverflow.com/questions/53836956/interactive-web-apps-with-react-js-on-the-server/53837474#53837474", "title": "Interactive web apps with react.js on the server", "body": "<p>You can take a look at marko by ebay (<a href=\"https://markojs.com/docs/server-side-rendering/\" rel=\"nofollow noreferrer\">https://markojs.com/docs/server-side-rendering/</a>) but I don't think you can find a framework/library with all your requirements.</p>\n\n<blockquote>\n  <p>Because of the first law of distributed systems - \"Don't build distributed systems\". It's simpler to build web app as one instead of distributing it into client and server.</p>\n</blockquote>\n\n<p>The code you send to user with react or any other single page application framework is defining view. So you shouldn't consider it as a system. It's just html, css, js + user's data</p>\n\n<blockquote>\n  <p>Virtual DOM on the Server is important because it allows to update DOM\n  automatically.</p>\n</blockquote>\n\n<p>Why the goal is to update DOM? DOM is just a view of your state/data. And your frontend application is just a mapper/hash function from your state to DOM. So if you only have your state in your server, you kind of have your DOM as well.</p>\n\n<p><strong>If you don't want to write both server and client</strong>, but still you want to have fancy frontend features with thousands of open source repos, you can try react + firebase.  </p>\n"}], "owner": {"reputation": 9563, "user_id": 231624, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/pU5YW.jpg?s=128&g=1", "display_name": "Alex Craft", "link": "https://stackoverflow.com/users/231624/alex-craft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1545151421, "creation_date": 1545149300, "last_edit_date": 1545151421, "question_id": 53836956, "link": "https://stackoverflow.com/questions/53836956/interactive-web-apps-with-react-js-on-the-server", "title": "Interactive web apps with react.js on the server", "body": "<p>I'm looking for web framework for <strong>interactive, real-time web apps without writing the Client (Browser), everything will be done by the Server</strong>. </p>\n\n<p>There's such framework - <a href=\"https://dockyard.com/blog/2018/12/12/phoenix-liveview-interactive-real-time-apps-no-need-to-write-javascript\" rel=\"nofollow noreferrer\">LiveView</a> in Phoenix (Elixir/Erlang), see demos below. <strong>I'm looking for something similar in JavaScript/TypeScript or Ruby</strong>.</p>\n\n<p><img src=\"https://i.imgur.com/KycXyTx.gif\" alt=\"\"></p>\n\n<p>How it works, it's better to demonstrate by example. Let's imagine we already have such framework in JavaScript and building an Autocomplete component. It would look almost like React.JS, but with the huge difference - it will be run on the Server: </p>\n\n<pre><code>class Autocomplete extends MagicServerSideReactComponent {\n  state = { \n    query:       '',\n    suggestions: []\n  }\n\n  async search(e) {\n    const query = e.target.value\n\n    // This whole component runs on the Server, not in the Browser.\n    // So it has full access to the Server infrastructure and Database.\n    const suggestions = await db.find(`select like '${query}'`)\n\n    this.setState({ query, suggestions })\n  }\n\n  render() {\n    return &lt;div&gt;\n      &lt;input value={this.state.query} onKeyPress={this.search}/&gt;\n      {this.state.suggestions.map((name) =&gt; &lt;div&gt;{name}&lt;/div&gt;)}\n    &lt;/div&gt;\n  }\n}\n</code></pre>\n\n<p>How it works:</p>\n\n<pre><code>When rendered first time:\n\n- Autocomplete component get rendered on the Server and final HTML sent \n  to the Browser. \n  The Server remembers the `state` and the Virtual DOM - i.e. it's a \n  statefull Server, not usual Stateless node.js Server.\n- Browser gets the HTML and renders it into DOM.\n\nWhen user type something in the input: \n\n- Browser serializes the Event and sends it to the Server, \n  something like  `{ method: 'Autocomplete.search', event: '...' }`\n- Server get the serialized Event and the previously stored Virtual DOM \n  for the given Web Page.\n  Then Server process the Event, and as a result the Virtual DOM \n  on the Server gets updated.\n  Then Server finds out the difference between the new and old Virtual DOM \n  and generates the DIFF.\n  Then Server sends the DOM DIFF to the Browser\n- Browser gets the DOM DIFF and modify its DOM.\n  And the user see its Web Page updated with the search suggestions.\n</code></pre>\n\n<p>Do you know any such <strong>web frameworks in JavaScript or Ruby</strong>?</p>\n\n<p>Please don't suggest frameworks that do something like that - but where you have to mutate DOM manually. <strong>Virtual DOM on the Server is important</strong> because it allows to update DOM automatically. It doesn't have to be exactly like React.JS but it should update DOM automatically, like React does.</p>\n\n<p>P.S. </p>\n\n<ul>\n<li>Why? Because of the first law of distributed systems - \"Don't build distributed systems\". <strong>It's simpler</strong> to build web app as one instead of distributing it into client and server.</li>\n<li>Latency - yes, nothing is free, you have to pay for the simplicity and the latency will be the price. The interactions would be delayed - to travel to the server and back.</li>\n<li>Performance - yes, Server is not stateless anymore, it's stateful, runs Virtual DOM and consume more resources.</li>\n</ul>\n"}, {"tags": ["arrays", "ruby", "loops", "while-loop"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1545161452, "post_id": 53836816, "comment_id": 94527939, "body": "It&#39;s usually easier to get an answer if you post an attempt you made rather than a completely open-ended problem. Try it out and edit your question to include your attempt, what you expected to work, and what happened instead."}, {"owner": {"reputation": 11, "user_id": 4682131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XlGsXNgBGxQ/AAAAAAAAAAI/AAAAAAAAAuA/7Il_uDB1oW0/photo.jpg?sz=128", "display_name": "andrew johnston", "link": "https://stackoverflow.com/users/4682131/andrew-johnston"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1545162532, "post_id": 53836816, "comment_id": 94528418, "body": "Thanks @Max ! I hope my new description is more useful. Cheers"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 11361101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba3c228ec2fbff05546efc94ca8131a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11361101/steve"}, "is_accepted": true, "score": 0, "last_activity_date": 1555296607, "creation_date": 1555296607, "answer_id": 55682018, "question_id": 53836816, "link": "https://stackoverflow.com/questions/53836816/how-to-solve-ruby-wizardry-staying-in-the-loop-example-program/55682018#55682018", "title": "How to solve Ruby Wizardry &quot;Staying in the loop&quot; example program?", "body": "<p>Here is how I solved this challenge.  It works but is rather lengthy.  More advanced ruby coders may be able to provide a shorter solution:</p>\n\n<pre><code>    we_wanna_ride = true\nstops = [\"East Bumpspark\", \"Endertromb Avenue\", \"New Mixico\", \"Mal Abochny\"]\n\nwhile we_wanna_ride\n  print \"Where do you wish to depart from?: \"\n  depart = gets.chomp.split.map(&amp;:capitalize).join(' ')\n  depart_index = stops.index(depart)\n#  puts depart_index\n\n  print \"Where ya headin' friend?: \"\n  destination = gets.chomp.split.map(&amp;:capitalize).join(' ')\n  destination_index = stops.index(destination)\n#  puts destination_index\n\n  index_diff1 = depart_index - destination_index\n  index_diff2 = destination_index - depart_index\n\n  if stops.include? destination &amp;&amp; depart\n    puts \"\\nI know how to get to #{destination}! Here's the station list:\"\n\n    if destination_index &gt; depart_index &amp;&amp; index_diff2 &lt; 3\n      stops[depart_index..-1].each do |stop|\n        puts stop\n        break if stop == destination\n      end\n    we_wanna_ride = false\n\n    elsif destination_index &gt; depart_index &amp;&amp; index_diff2 &gt;= 3\n      dubstops = stops.concat(stops)\n      dubstops[0..depart_index+4].reverse_each do |stop|\n        puts stop\n        break if stop == destination\n      end\n    we_wanna_ride = false\n\n    elsif destination_index &lt; depart_index &amp;&amp; index_diff1 &lt; 3\n      stops[0..depart_index].reverse_each do |stop|\n        puts stop\n        break if stop == destination\n      end\n    we_wanna_ride = false\n\n    elsif destination_index &lt; depart_index &amp;&amp; index_diff1 &gt;= 3\n      dubstops = stops.concat(stops)\n      dubstops[depart_index..-1].each do |stop|\n        puts stop\n        break if stop == destination\n      end\n    we_wanna_ride = false\n    end\n\n  else\n    puts \"Sorry, we don't service that station. Maybe another time!\"\n    we_wanna_ride = false\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4682131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XlGsXNgBGxQ/AAAAAAAAAAI/AAAAAAAAAuA/7Il_uDB1oW0/photo.jpg?sz=128", "display_name": "andrew johnston", "link": "https://stackoverflow.com/users/4682131/andrew-johnston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55682018, "answer_count": 1, "score": 0, "last_activity_date": 1555296607, "creation_date": 1545148805, "last_edit_date": 1545162469, "question_id": 53836816, "link": "https://stackoverflow.com/questions/53836816/how-to-solve-ruby-wizardry-staying-in-the-loop-example-program", "title": "How to solve Ruby Wizardry &quot;Staying in the loop&quot; example program?", "body": "<p>The book Ruby Wizardry Chapter 4 includes the following sample program</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>we_wanna_ride = true\nstops = [\"East Bumpspark\", \"Endertromb Avenue\", \"New Mixico\", \"Mal Abochny\"]\n\nwhile we_wanna_ride\n    print \"Where ya headin', friend?\"\n    destination = gets.chomp\n    if stops.include? destination\n    puts \"I know how to get to #{destination}! Here's the station list:\"\n        stops.each do |stop|\n            puts stop\n            break if stop == destination\n        end\n    else\n        puts \"Sorry, we don't stop at that station. Maybe another time!\"\n        we_wanna_ride = false\n    end\nend\n</code></pre>\n\n<p>It then goes on to pose a few additional challenges:</p>\n\n<p>\"What if a passenger is going the other way on the train (for instance, from Mal Abochny to East Bumpspark)? How could you update your program to work in both directions? Even trickier, what if the train route is a big circle (meaning if a passenger goes from East Bumpspark to Mal Abochny, the next stop after Mal Abochny should be East Bumpspark again)? How could you update your program to print out the right list of train stops if a passenger wants to go all the way around the circle?\"</p>\n\n<p>Does anybody have any ideas how to proceed here ? I'm a beginning programmer so any help would be greatly appreciated. Here's my progress so far. I figured I would get a <code>departure</code> from the user and then use to.i to get the input into an integer. I could then use the integer value to compare to the index position in the array. If the rider wants to go in the opposite direction I could use something like stops.each.reverse to print out the array items in reverse order. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>we_wanna_ride = true\nstops = [\"East Bumpspark(1)\", \"Endertromb Avenue(2)\", \"New Mixico(3)\", \"Mal Abochny(4)\"]\nputs \"#{stops}\"\n\nwhile we_wanna_ride\n    print \"Select a destination number\"\n    destination = gets.chomp.to_i\n    print \"Select a departure number\"\n    departure = gets.chomp.to_i\n    if departure &lt;= destination\n        stops.each do |stop|\n            puts stop\n            break if stop == destination\n        end\n    else puts \"Sorry\"\n    we_wanna_ride = false\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "thor", "vcr"], "answers": [{"tags": [], "owner": {"reputation": 5980, "user_id": 60131, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/axDcf.jpg?s=128&g=1", "display_name": "John Gallagher", "link": "https://stackoverflow.com/users/60131/john-gallagher"}, "is_accepted": true, "score": 2, "last_activity_date": 1545166456, "last_edit_date": 1545166456, "creation_date": 1545166080, "answer_id": 53840821, "question_id": 53836815, "link": "https://stackoverflow.com/questions/53836815/testing-a-thor-script-with-rspec-and-vcr/53840821#53840821", "title": "Testing a Thor script with rspec and vcr", "body": "<h3>Thor is a wrapper</h3>\n\n<ul>\n<li>I tend to see Rake, Thor and friends as another interface to your code</li>\n<li>I keep my Thor/Rake code as tiny as possible</li>\n<li>All production code is kept in a standard Ruby class</li>\n<li>That means unit testing via VCR becomes dead easy</li>\n<li>Also allows you to reuse your production code in another interface: e.g. a Rails controller</li>\n</ul>\n\n<h2>Example</h2>\n\n<h3>Thor wrapper</h3>\n\n<p><strong><code>bin/seed</code></strong></p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire \"thor\"\n\nclass Seed &lt; Thor\n  desc \"budgets\", \"Seeds budgets\"\n  def budgets\n    puts 'Seeding currencies...'\n    SeedBudgets.new.call\n    puts 'Done.'\n  end\nend\n\nSeed.start\n</code></pre>\n\n<p><a href=\"https://github.com/erikhuda/thor/wiki/Making-An-Executable\" rel=\"nofollow noreferrer\">For more details on command line Thor see this excellent walkthrough</a></p>\n\n<h3>Production code</h3>\n\n<p><strong><code>lib/services/seed_budgets.rb</code></strong></p>\n\n<pre><code>class SeedBudgets\n  def initialize\n    # I find an initialize helpful for injecting dependencies\n  end\n\n  def call\n    # Code goes here\n  end\nend\n</code></pre>\n\n<h3>Unit tests</h3>\n\n<p><strong><code>test/services/seed_budgets_test.rb</code></strong></p>\n\n<pre><code>require 'minitest/autorun'\nrequire 'vcr'\n\nVCR.configure do |config|\n  config.cassette_library_dir = 'fixtures/vcr_cassettes'\n  config.hook_into :webmock\nend\n\nclass SeedBudgetsTest &lt; Minitest::Test\n  def test_seeds_one_budget\n    VCR.use_cassette('one_budget_from_api') do\n      SeedBudgets.new.call\n      assert_equal 1, Budget.count\n    end\n  end\nend\n</code></pre>\n\n<p>That will allow you to decouple the command line interface from the actual code.</p>\n\n<p>Then Thor becomes a very thin wrapper around your actual code.</p>\n\n<p>Feel free to post more detailed code and I can help more. :)</p>\n"}], "owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 53840821, "answer_count": 1, "score": 1, "last_activity_date": 1545166456, "creation_date": 1545148799, "question_id": 53836815, "link": "https://stackoverflow.com/questions/53836815/testing-a-thor-script-with-rspec-and-vcr", "title": "Testing a Thor script with rspec and vcr", "body": "<p>I built a Thor script that connects to an HTTP API to perform some very simple actions. I've coded tests for the backend but the Thor script is basically untested, which is quite suboptimal.</p>\n\n<p>My first approach was to capture the output of the commands itself and write test against such output, the resulting tests are unsurprisingly slow.</p>\n\n<pre><code>expect(`bin/script foo`).to eq('bar')\n</code></pre>\n\n<p>I then tried to use both <code>webmock</code> and <code>vcr</code> but using this approach none of these frameworks are invoked, even if I mock the exact request the mock is unused, most probably because both <code>webmock</code> and <code>vcr</code> are unable to hook into the thor script.</p>\n\n<p>Has anybody found a nice solution for this? Invoking the Thor script directly (<code>Thorclass.action('bar')</code>) would be enough for my taste, but I haven't found a way to do it.\nAny suggestion? Thanks in advance.</p>\n"}, {"tags": ["ruby", "selenium-webdriver"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1545147521, "post_id": 53836356, "comment_id": 94520836, "body": "Are you looking for <a href=\"https://pt.stackoverflow.com\">Stack Overflow em Portugu\u00eas</a>?"}, {"owner": {"reputation": 1, "user_id": 10780701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-McGttYGZLwc/AAAAAAAAAAI/AAAAAAAABJE/H0F5fsiKKm8/photo.jpg?sz=128", "display_name": "Maycon Silva", "link": "https://stackoverflow.com/users/10780701/maycon-silva"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545147967, "post_id": 53836356, "comment_id": 94521086, "body": "The above script generates the following error:  Traceback (most recent call last): teste.rb:4:in `&lt;main&gt;&#39;: uninitialized constant Selenium::Webdriver (NameError) Did you mean?  Selenium::WebDriver"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1545148026, "post_id": 53836356, "comment_id": 94521133, "body": "Please, <a href=\"https://stackoverflow.com/posts/53836356/edit\">edit</a> your question to include the error message. However, did you try what the error message suggests?"}], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 7907670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71871495381e48ecbcb2060b15da56ae?s=128&d=identicon&r=PG&f=1", "display_name": "rs007", "link": "https://stackoverflow.com/users/7907670/rs007"}, "is_accepted": false, "score": 2, "last_activity_date": 1545157643, "creation_date": 1545157643, "answer_id": 53839052, "question_id": 53836356, "link": "https://stackoverflow.com/questions/53836356/ruby-script-build-error-with-selenium-webdriver/53839052#53839052", "title": "Ruby script build error with Selenium WebDriver", "body": "<p>Looks like you have a typo here, just checked on my IDE, it should be uppercase D:</p>\n\n<pre><code>driver = Selenium::WebDriver.for :chrome\n</code></pre>\n\n<p>see if that helps</p>\n"}], "owner": {"reputation": 1, "user_id": 10780701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-McGttYGZLwc/AAAAAAAAAAI/AAAAAAAABJE/H0F5fsiKKm8/photo.jpg?sz=128", "display_name": "Maycon Silva", "link": "https://stackoverflow.com/users/10780701/maycon-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1545179489, "creation_date": 1545147200, "last_edit_date": 1545179489, "question_id": 53836356, "link": "https://stackoverflow.com/questions/53836356/ruby-script-build-error-with-selenium-webdriver", "title": "Ruby script build error with Selenium WebDriver", "body": "<p>[Ruby script build error with Selenium WebDriver]    </p>\n\n<pre><code>require 'rubygems'\nrequire 'selenium-webdriver'\n\ndriver = Selenium::Webdriver.for :chrome\ndriver.navigate.to \"https://www.linkedin.com/\"\nputs \"Linkedin rede de profissionais\"\n</code></pre>\n\n<p>Error message: </p>\n\n<pre><code>uninitialized constant Selenium::Webdriver (NameError) Did you mean? Selenium::WebDriver\n</code></pre>\n"}, {"tags": ["ruby", "compilation", "virtual-machine"], "comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1545144996, "post_id": 53835605, "comment_id": 94519359, "body": "Well, since everything in Ruby is an expression with a value, I don&#39;t think you will find the result useful. In REPLs, the value of each entered line of code is retained which is not at all the same thing."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1545146956, "post_id": 53835605, "comment_id": 94520514, "body": "Perhaps you&#39;re looking for <a href=\"https://ruby-doc.org/core-2.5.3/Object.html#method-i-tap\" rel=\"nofollow noreferrer\"><code>tap</code></a> which can be used to avoid the extra <code>result</code> after <code># do something with result</code>? There&#39;s a good example of this use in my <a href=\"https://stackoverflow.com/a/47890832/63034\">answer</a> to a different question."}, {"owner": {"reputation": 20004, "user_id": 458137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/578d634d7ce34d89570ba1b85a4cf118?s=128&d=identicon&r=PG", "display_name": "megas", "link": "https://stackoverflow.com/users/458137/megas"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1545167580, "post_id": 53835605, "comment_id": 94530539, "body": "@mikej tap is just another version of begin/end block - tap requires the same begin/end block"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545173621, "post_id": 53835605, "comment_id": 94532693, "body": "Consider <a href=\"http://ruby-doc.org/core-2.5.1/Object.html#method-i-yield_self\" rel=\"nofollow noreferrer\">Object#yield_self</a>."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1545212833, "post_id": 53835605, "comment_id": 94544512, "body": "@megas my comment was mostly about wrapping the <code># do something with result</code> in a <code>tap</code> and then avoiding the need for the <code>result</code> on the last line of the method. But perhaps I&#39;ve misunderstood which aspect of the code you&#39;d like to avoid? When you&#39;ve written <i>avoid to write construction like this</i>, can you clarify which bit you&#39;d like to avoid? or maybe give a more concrete example, or an example of how you&#39;d like the code to look if you <i>could</i> do what you wanted?"}, {"owner": {"reputation": 20004, "user_id": 458137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/578d634d7ce34d89570ba1b85a4cf118?s=128&d=identicon&r=PG", "display_name": "megas", "link": "https://stackoverflow.com/users/458137/megas"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1545214808, "post_id": 53835605, "comment_id": 94545724, "body": "@mikej Thanks for your concern, I&#39;d like to have the same variable like <code>_</code>. Maybe Ruby VM can give me this variable. I&#39;m trying to extend Ruby syntax by <code>load_iseq</code> <a href=\"https://ruby-doc.org/core-2.5.0/RubyVM/InstructionSequence.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.0/RubyVM/InstructionSequence.html</a>"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1545215279, "post_id": 53835605, "comment_id": 94545980, "body": "maybe update the example in the question with a bit more detail? when you wrote <i>can I get the result of last expression</i> it isn&#39;t clear which expression you&#39;re referring to or how you&#39;d use it."}], "owner": {"reputation": 20004, "user_id": 458137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/578d634d7ce34d89570ba1b85a4cf118?s=128&d=identicon&r=PG", "display_name": "megas", "link": "https://stackoverflow.com/users/458137/megas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545167645, "creation_date": 1545144633, "last_edit_date": 1545167645, "question_id": 53835605, "link": "https://stackoverflow.com/questions/53835605/access-to-variable-of-last-expression", "title": "Access to variable of last expression", "body": "<p>As you may know, there's a special variable <code>_</code> of last expression in REPL's like <code>irb</code> and <code>pry</code>.</p>\n\n<p>But can I get the result of last expression from Ruby platform? </p>\n\n<p>Because of Ruby's dynamic nature and flexible compiler/virtual machine, maybe it's possible to get it from the Ruby's guts. </p>\n\n<p>So I can avoid to write construction like this:</p>\n\n<pre><code>def some_method\n  result = begin\n    # some code\n  end\n  # do something with result\n  result\nend\n</code></pre>\n\n<p>P.S. <a href=\"https://ruby-doc.org/core-2.5.3/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">tap</a> is not a solution for me</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1686, "user_id": 7264341, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oz5dfb6ASr8/AAAAAAAAAAI/AAAAAAAAAC8/33rQJBMPZZI/photo.jpg?sz=128", "display_name": "Javier Men&#233;ndez Rizo", "link": "https://stackoverflow.com/users/7264341/javier-men%c3%a9ndez-rizo"}, "is_accepted": false, "score": 1, "last_activity_date": 1545146743, "last_edit_date": 1545146743, "creation_date": 1545145133, "answer_id": 53835756, "question_id": 53835178, "link": "https://stackoverflow.com/questions/53835178/disable-with-to-prevent-double-clicks/53835756#53835756", "title": "`disable_with` to prevent double clicks", "body": "<p>What you need to use is the button_tag helper:</p>\n\n<pre><code>&lt;% content_for :cancel_button do %&gt;\n  &lt;%= button_tag \"#{cancel_shift_path(@shift)\", data: { disable_with: \"Please wait...\"} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the api reference: <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-button_tag\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-button_tag</a></p>\n"}], "owner": {"reputation": 51, "user_id": 7509565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51168050702128b8f694a1e5d6796d9a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Sinko", "link": "https://stackoverflow.com/users/7509565/mr-sinko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545146743, "creation_date": 1545143240, "question_id": 53835178, "link": "https://stackoverflow.com/questions/53835178/disable-with-to-prevent-double-clicks", "title": "`disable_with` to prevent double clicks", "body": "<p>I am trying to add a disable_with to one of my button, however I can't get the correct syntax. Here's what I have tried so far.</p>\n\n<p>before adding disable_with //this one work before however I can click cancel button multiple times</p>\n\n<pre><code>- content_for :cancel_button do\n    #{cancel_shift_path(@shift)}\n</code></pre>\n\n<p>After adding disable_with //incorrect syntax</p>\n\n<pre><code>- content_for :cancel_button do\n    #{cancel_shift_path(@shift), data: {disable_with: \"Please wait\"}}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1545138648, "post_id": 53833683, "comment_id": 94515616, "body": "Hey! I am actually not using postgres, so should I use the column type json perhaps?   <code>Transaction</code> is it&#39;s own model but what I&#39;m thinking is that for each instance of <code>Share</code> I&#39;d like to track which Transactions it has been associated with."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 1, "creation_date": 1545138777, "post_id": 53833683, "comment_id": 94515680, "body": "I&#39;d create relation between those two models 1:n if you have one share per transaction (then keep share ids in transaction) or n:m if there could be many records on both sides (you need a linking model or <code>has_and_belongs_to_many</code> then)."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1545138307, "creation_date": 1545138307, "answer_id": 53833683, "question_id": 53833629, "link": "https://stackoverflow.com/questions/53833629/how-to-append-to-a-string-on-an-activerecord-column-in-rails/53833683#53833683", "title": "How to append to a string on an ActiveRecord column in Rails", "body": "<p>You can use an array column type (if you use postgres). But what I'd do is to move transaction ids to a separate DB table. It will let you easily add new ids and query them fast.</p>\n"}, {"comments": [{"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1545139147, "post_id": 53833797, "comment_id": 94515862, "body": "Really like this solution, thanks so much! Gives lots of future flexibility."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 1, "creation_date": 1545139525, "post_id": 53833797, "comment_id": 94516079, "body": "@JP89 I don&#39;t know if you plan on having a lot more &quot;logging&quot; to do in your project, but you may want to go deeper with this configuration and make <code>ShareTransfer</code> a little bit more abstract (polymorphism), use a different DB schema (example: <code>logs</code> instead of <code>public</code>), use DB partitioning for perf optimization, etc."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 1, "creation_date": 1545139647, "post_id": 53833797, "comment_id": 94516161, "body": "BTW, as an experienced Web developer, I can tell you that storing several <code>id</code> in a column - could it be a string of <code>id</code>s joined with a coma or an array of integers - is not a clean solution: DBs have foreign keys since forever, use it :) It is preferable to have several tables rather than only one doing everything (for obvious performance reasons)"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 2, "last_activity_date": 1545139861, "last_edit_date": 1545139861, "creation_date": 1545138701, "answer_id": 53833797, "question_id": 53833629, "link": "https://stackoverflow.com/questions/53833629/how-to-append-to-a-string-on-an-activerecord-column-in-rails/53833797#53833797", "title": "How to append to a string on an ActiveRecord column in Rails", "body": "<p>I suggest creating another model to \"log\" the transactions that happened for a specific <code>Share</code> object.</p>\n\n<p>For example:</p>\n\n<pre><code>class ShareTransfer &lt; ApplicationRecord\n  belongs_to :share\n  belongs_to :transaction\n  # don't forget to enforce the presence of \n  # both foreign keys share_id and transaction_id\n\n  # bonus: \"freezing\" the object after creation so you can never\n  # update the logged object (= data integrity)\n  before_save(on: :update) do\n    errors.add(:base, :immutable, \"Cannot update a frozen object\")\n  end\nend\n</code></pre>\n\n<p>And change your current <code>Share#transaction_ids</code> to a simple <code>integer</code> column with a foreign key to the <code>transactions</code> table - an probably rename it as well - to end up with something like:</p>\n\n<pre><code>class Share &lt; ApplicationRecord\n  belongs_to :transaction # implies you have renamed the column transaction_ids to transaction_id (and changed the column type)\n  has_many :share_transfers\nend\n</code></pre>\n\n<p>Which enables you to do the following when a <code>Share</code> is transferred:</p>\n\n<pre><code>@share_numbers_on_cap.each do |share|\n  # [your previous logic to change ownership]\n  share.share_transfers.create!(transaction_id: share.transaction_id)\n  # ^ to create history of the ownership change\nend\n</code></pre>\n\n<p>This schema allows you to add extra fields to the <code>ShareTransfer</code> model, for example, the exact time when the transfer occurred (ex: <code>occurred_at</code>), the IP of both parties when the transfer was validated, etc. You can even <code>lock</code> the <code>ShareTransfer</code> table to be \"insert only\", preventing any user (or code) to update the data in there and ensuring the integrity of your logs.</p>\n"}], "owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "accepted_answer_id": 53833797, "answer_count": 2, "score": 2, "last_activity_date": 1566467448, "creation_date": 1545138127, "last_edit_date": 1566467448, "question_id": 53833629, "link": "https://stackoverflow.com/questions/53833629/how-to-append-to-a-string-on-an-activerecord-column-in-rails", "title": "How to append to a string on an ActiveRecord column in Rails", "body": "<p>I have a concept of a Share which represents a specific stock owned by a particular shareholder. What I am trying to add now is functionality that supports tracking the \"history\" of this Share over time, given it can be transferred to other shareholders etc. </p>\n\n<p>In my database, for each <code>Share</code> record there is currently a column <code>t.string \"transaction_ids\"</code>. I should probably change the column type I am assuming to something easier to work with. Open to suggestions here.  </p>\n\n<p>The two relevant methods are when creating new shares and then transferring ownership of the shares. </p>\n\n<p>Here is how the Share is created initially. </p>\n\n<pre><code>@number_of_share_numbers_to_create.times do |i|\n      Share.create(\n        owner_id: params[:buying_shareholder_id], \n        captable_id: @transaction.captable.id, \n        company_id: @transaction.company.id, \n        share_number: @latest_share += 1,\n        transaction_ids: @transaction.id #Save transaction id to DB\n      )\nend\n</code></pre>\n\n<p>Then when a <code>Share</code> is transferred, I have the following method. </p>\n\n<pre><code>@share_numbers_on_cap.each do |share|\n      share.update_attribute(:owner_id, @buying_shareholder.id)\n      # TODO Capture share history by pushing @transaction.id into the transaction_ids column. \n      # Perhaps I could do something like share.transaction_ids &gt;&gt; @transaction.id or something?\nend\n</code></pre>\n\n<p>I know this current solution is not optimal, and I'd love some guidance on how to solve this in a more scalable way. Perhaps I should use a different column type and build an array? Would love some push in the right direction. </p>\n\n<p>Thanks! </p>\n"}, {"tags": ["ruby", "jruby", "sikuli", "sikuli-ide"], "comments": [{"owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "edited": false, "score": 0, "creation_date": 1546856493, "post_id": 53833402, "comment_id": 94977688, "body": "Look this url may its helps you <a href=\"https://stackoverflow.com/questions/17859530/invalid-multibyte-char-utf-8-error-ruby\" title=\"invalid multibyte char utf 8 error ruby\">stackoverflow.com/questions/17859530/&hellip;</a> . Also let me"}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "reply_to_user": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "edited": false, "score": 0, "creation_date": 1546857244, "post_id": 53833402, "comment_id": 94978125, "body": "@Kandy : Problem is in absolute path, but not sure, how should I escape it."}, {"owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "edited": false, "score": 0, "creation_date": 1546857831, "post_id": 53833402, "comment_id": 94978469, "body": "on which operating system you are working"}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "reply_to_user": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "edited": false, "score": 0, "creation_date": 1546859503, "post_id": 53833402, "comment_id": 94979325, "body": "@Kandy : I use it on Windows."}, {"owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "edited": false, "score": 0, "creation_date": 1546859632, "post_id": 53833402, "comment_id": 94979381, "body": "can you provide your more code so I look what actually happening. I have installed ruby in my system"}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "reply_to_user": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "edited": false, "score": 0, "creation_date": 1546860348, "post_id": 53833402, "comment_id": 94979714, "body": "@Kandy : I just use it in a loop: <code>records.each do |item|</code>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1546894846, "post_id": 53833402, "comment_id": 94996883, "body": "Can you please include in your question example directory names that you expect to be returned? This will allow your example and your error to be recreated by anyone answering this question."}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1546934898, "post_id": 53833402, "comment_id": 95007592, "body": "@anothermh : I added expected output."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1546936399, "post_id": 53833402, "comment_id": 95008212, "body": "I think you are looking for folders only so I posted answer below check"}], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546862158, "post_id": 54073688, "comment_id": 94980660, "body": "It isn&#39;t working, if there are dotted characters in path and first of all I need only full path to subdirectories."}, {"owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "reply_to_user": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546862246, "post_id": 54073688, "comment_id": 94980701, "body": "dotted means can you send your path"}, {"owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "reply_to_user": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546862595, "post_id": 54073688, "comment_id": 94980877, "body": "I am not able to get you.Just edit some more code in your question so that i can reproduce your error at my side."}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546868327, "post_id": 54073688, "comment_id": 94983867, "body": "I edited question. Problem with your output is, that just subfolders are needed, files are not, but it should work recursively to get all the subfolders."}, {"owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "reply_to_user": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546929556, "post_id": 54073688, "comment_id": 95005588, "body": "@plaidshirt I have edited my answer and hope it matches your requirement."}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546935002, "post_id": 54073688, "comment_id": 95007629, "body": "I added sample expected output to question. I need name of subfolders, not filenames."}], "tags": [], "owner": {"reputation": 628, "user_id": 2756832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13404e96c0f0b782d5a72a6a7ce697c?s=128&d=identicon&r=PG&f=1", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2756832/kandy"}, "is_accepted": true, "score": 2, "last_activity_date": 1546955040, "last_edit_date": 1546955040, "creation_date": 1546861071, "answer_id": 54073688, "question_id": 53833402, "link": "https://stackoverflow.com/questions/53833402/get-list-of-subfolders-from-a-given-folder-in-jruby/54073688#54073688", "title": "Get list of subfolders from a given folder in JRuby", "body": "<p>please check new stuff it producing expected result -</p>\n\n<pre><code> records = Dir.glob('/E:/ISSUE_Folder/**/*.*')\n\n records.each do |item|\n   puts File.dirname(item)\n end\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wIuAc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wIuAc.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you see its going to every folder and sub folder</p>\n"}, {"comments": [{"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546938655, "post_id": 54087914, "comment_id": 95009327, "body": "Thanks, but how could I use absolute path in Windows? C:/ notation seems invalid."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1546941837, "post_id": 54087914, "comment_id": 95011038, "body": "@plaidshirt I checked in windows, check if it works."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1546941789, "last_edit_date": 1546941789, "creation_date": 1546936338, "answer_id": 54087914, "question_id": 53833402, "link": "https://stackoverflow.com/questions/53833402/get-list-of-subfolders-from-a-given-folder-in-jruby/54087914#54087914", "title": "Get list of subfolders from a given folder in JRuby", "body": "<p>My rails app have <code>config</code> folder &amp; it have number of files &amp; subfolders, so getting only folders in <code>config</code>,</p>\n\n<p>I used <code>ap</code> below provided by <a href=\"https://github.com/awesome-print/awesome_print\" rel=\"nofollow noreferrer\">awesome_print</a> gem</p>\n\n<pre><code>&gt; ap Dir.glob \"#{Rails.root}/config/**/\"\n[\n    [0] \"/home/ray/projects/example_app/config/\",\n    [1] \"/home/ray/projects/example_app/config/initializers/\",\n    [2] \"/home/ray/projects/example_app/config/locales/\",\n    [3] \"/home/ray/projects/example_app/config/environments/\"\n]\n</code></pre>\n\n<p>I have <code>test</code> folder inside <code>config/locales/</code>, It is also got by following query.</p>\n\n<pre><code>&gt; ap Dir.glob \"#{Rails.root}/config/**/**/\"\n[\n    [0] \"/home/ray/projects/example_app/config/\",\n    [1] \"/home/ray/projects/example_app/config/initializers/\",\n    [2] \"/home/ray/projects/example_app/config/locales/\",\n    [3] \"/home/ray/projects/example_app/config/locales/test/\",\n    [4] \"/home/ray/projects/example_app/config/environments/\"\n]\n</code></pre>\n\n<p>For further search for sub-folders on third level hierarchy, I will use <code>\"#{Rails.root}/config/**/**/**/\"</code></p>\n\n<p><strong>Update:</strong></p>\n\n<p>You can try with following for <strong>windows</strong>,</p>\n\n<pre><code>irb(main):022:0&gt; Dir.glob(\"D:/sd/*/\")  # first hierarchy \n=&gt; [\"D:/sd/df/\", \"D:/sd/dff/\"]   \n\nirb(main):023:0&gt; Dir.glob(\"D:/sd/*\")\n=&gt; [\"D:/sd/351px-Nvidia_logo.png\", \"D:/sd/df\", \"D:/sd/dff\"]\n\nirb(main):024:0&gt; Dir.glob(\"D:/sd/*/*/\") # second hierarchy\n=&gt; [\"D:/sd/dff/ty/\"]\n\nirb(main):025:0&gt; Dir.glob(\"D:/sd/*/*\")\n=&gt; [\"D:/sd/df/351px-Nvidia_logo2.png\", \"D:/sd/dff/ty\"]\n</code></pre>\n\n<p>You can further get result by adding first and second hierarchy (commented in above) subfolders  </p>\n"}, {"tags": [], "owner": {"reputation": 1066, "user_id": 3628295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c87fee58a1e77b9f4ddbae72a87f7f?s=128&d=identicon&r=PG&f=1", "display_name": "ogelacinyc", "link": "https://stackoverflow.com/users/3628295/ogelacinyc"}, "is_accepted": false, "score": 1, "last_activity_date": 1547017115, "creation_date": 1547017115, "answer_id": 54104703, "question_id": 53833402, "link": "https://stackoverflow.com/questions/53833402/get-list-of-subfolders-from-a-given-folder-in-jruby/54104703#54104703", "title": "Get list of subfolders from a given folder in JRuby", "body": "<p>Maybe your JRuby be using less than or equal to ruby 1.9</p>\n\n<p>In Ruby 1.9, the header in your file needs to indicate encoding format.</p>\n\n<p>Add this line at top</p>\n\n<p><code># encoding: UTF-8</code></p>\n"}], "owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 54073688, "answer_count": 3, "score": 1, "last_activity_date": 1547017115, "creation_date": 1545137409, "last_edit_date": 1546934853, "question_id": 53833402, "link": "https://stackoverflow.com/questions/53833402/get-list-of-subfolders-from-a-given-folder-in-jruby", "title": "Get list of subfolders from a given folder in JRuby", "body": "<p>I use <code>JRuby</code> in <code>SikuliX IDE</code> to get list of folders and its subfolders recursively and store its absolute paths(which may contains also dotted characters) in an array. I tried to use following code:</p>\n\n<pre><code>records = Dir.glob 'C:/_private/Files/**/*/'\n</code></pre>\n\n<p>I got error message: </p>\n\n<blockquote>\n  <p>[error] SyntaxError ( invalid multibyte char (UTF-8) )</p>\n</blockquote>\n\n<p>Expected output:</p>\n\n<pre><code>C:/_private/Files/dir1\nC:/_private/Files/dir1/subdir1\nC:/_private/Files/dir1/subdir2\nC:/_private/Files/dir2\nC:/_private/Files/dir2/subdir1\nC:/_private/Files/dir2/subdir2\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545176480, "post_id": 53833265, "comment_id": 94533468, "body": "Suppose <code>str = &quot;Hey, diddle-didle,\\nthe cat and the fiddle.&quot;</code>. Replacing all characters other than spaces with an asterisk produces <code>str.gsub(&#47;[^ ]&#47;,&#39;*&#39;) # =&gt; &quot;**** ***************** *** *** *** *******&quot;</code>. Replacing all characters other than whitespace with an asterisk produces <code>str.gsub(&#47;\\S&#47;,&#39;*&#39;)  #=&gt; &quot;**** *************\\n*** *** *** *** *******&quot;</code>, Those are not the same because <code>&quot;\\n&quot;</code> is a whitespace character. Since you awarded the green to @mrasa I assume you want the latter, but it&#39;s not what you asked for."}], "answers": [{"comments": [{"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 2, "creation_date": 1545137418, "post_id": 53833342, "comment_id": 94514899, "body": "It is worth noting that <code>\\S</code> is a character class, and that it matches any non-whitespace character. A list of all character classes can be found in the documentation of the <code>Regex</code> module: <a href=\"https://ruby-doc.org/core-2.5.3/Regexp.html#class-Regexp-label-Character+Classes\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.3/&hellip;</a>"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 4, "last_activity_date": 1545137704, "last_edit_date": 1545137704, "creation_date": 1545137200, "answer_id": 53833342, "question_id": 53833265, "link": "https://stackoverflow.com/questions/53833265/ruby-replace-characters-in-a-string-with-a-symbol/53833342#53833342", "title": "Ruby - replace characters in a string with a symbol", "body": "<p>What about <code>gsub(/\\S/, '*')</code></p>\n\n<p>It will find all non-whitespace characters and  replace every one of them with <code>*</code>. <code>\\S</code> is a <a href=\"https://ruby-doc.org/core-2.5.3/Regexp.html#class-Regexp-label-Character+Classes\" rel=\"nofollow noreferrer\">regex character class</a> matching non-whitespace chars (thanks @jdno).</p>\n\n<p>E.g. </p>\n\n<pre><code> pry&gt; \"as12 43-\".gsub(/\\S/, '*')\n =&gt; \"**** ***\"\n</code></pre>\n\n<p>So in your case:</p>\n\n<pre><code>def change_word(word)\n   word.gsub(/\\S/, '*')\nend \n</code></pre>\n\n<p>You may also extract the regex outside of the method to optimize it a bit:</p>\n\n<pre><code>CHANGE_WORD_PATTERN = /\\S/\ndef change_word(word)\n   word.gsub(CHANGE_WORD_PATTERN, '*')\nend \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 0, "last_activity_date": 1546730633, "creation_date": 1546730633, "answer_id": 54057224, "question_id": 53833265, "link": "https://stackoverflow.com/questions/53833265/ruby-replace-characters-in-a-string-with-a-symbol/54057224#54057224", "title": "Ruby - replace characters in a string with a symbol", "body": "<p>When the first argument from the <code>tr</code> method of String starts with \"^\", then it means: everything but. So \"^ \" means everything but a space.</p>\n\n<pre><code>word = \"12 34 rfv\"\nword.tr(\"^ \",\"*\")  # =&gt; \"** ** ***\" \n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10754859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1016d42e28cca551d4490c0ff6de953?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/10754859/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2947, "favorite_count": 0, "accepted_answer_id": 53833342, "answer_count": 2, "score": 4, "last_activity_date": 1546730633, "creation_date": 1545136954, "last_edit_date": 1546728740, "question_id": 53833265, "link": "https://stackoverflow.com/questions/53833265/ruby-replace-characters-in-a-string-with-a-symbol", "title": "Ruby - replace characters in a string with a symbol", "body": "<p>I am trying to receive a string of characters and change all characters aside from spaces to \"*\". Here is where I am:</p>\n\n<pre><code>def change_word(word)\n  new_word.each {|replace| replace.gsub!(/./, \"*\") }\n  new_word.to_s\n  new_word.join\nend\n</code></pre>\n\n<p>I'm taking a word, adding the individual characters to an array and assigning this to a new variable, replacing everything in said array with the required symbol, changing everything in the array to a string and then joining everything in the array to output a bunch of *'s.</p>\n\n<p>What I would like to do (and it's not necessary that the solution follows the previous syntax) is take all letters and replace them with *. Spaces should stay as a space, only letters should become *.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord-import"], "comments": [{"owner": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "edited": false, "score": 0, "creation_date": 1545134922, "post_id": 53832590, "comment_id": 94513532, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17954524/retrieve-the-nextval-from-a-sequence-using-activerecord-in-ruby-on-rails-3-2-14\">Retrieve the nextval from a sequence using activerecord in Ruby on Rails 3.2.14 / Ruby 2.0.0 / PostgreSQL 9.2.4</a>"}, {"owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "reply_to_user": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "edited": false, "score": 0, "creation_date": 1545136152, "post_id": 53832590, "comment_id": 94514203, "body": "@AlexeySuslyakov different scenarios, activerecord-import is used to populate large set of data, also this is not about gettting a sequence value, but instruct activerecord-import to generate the right SQL."}, {"owner": {"reputation": 1357, "user_id": 6229122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tQUnBjPGP9o/AAAAAAAAAAI/AAAAAAAACww/wJS82aCB06E/photo.jpg?sz=128", "display_name": "Alex Suslyakov", "link": "https://stackoverflow.com/users/6229122/alex-suslyakov"}, "edited": false, "score": 0, "creation_date": 1545141331, "post_id": 53832590, "comment_id": 94517250, "body": "oh, got it. Sorry then"}], "answers": [{"comments": [{"owner": {"reputation": 824, "user_id": 2743131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TDByo.png?s=128&g=1", "display_name": "tjheslin1", "link": "https://stackoverflow.com/users/2743131/tjheslin1"}, "edited": false, "score": 0, "creation_date": 1590078112, "post_id": 61934922, "comment_id": 109550143, "body": "Hi Marsmust. Can you provide some example code for your new solution?"}, {"owner": {"reputation": 51, "user_id": 9788663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkzdM.jpg?s=128&g=1", "display_name": "marsimus", "link": "https://stackoverflow.com/users/9788663/marsimus"}, "reply_to_user": {"reputation": 824, "user_id": 2743131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TDByo.png?s=128&g=1", "display_name": "tjheslin1", "link": "https://stackoverflow.com/users/2743131/tjheslin1"}, "edited": false, "score": 1, "creation_date": 1590083907, "post_id": 61934922, "comment_id": 109553367, "body": "sure, given I have position field with default sequence value: `  position          | integer                     |  not null default nextval(&#39;file_exports.task_file_item_position_seq&#39;::regclass&zwnj;&#8203;) ` ```     ...   params = file_records.map do |file_record|     build_file_item_params(file_record)   end    FileExports::TaskFileItem.import!(params, validate: true)    def build_file_item_params(file_record)     {       name: &quot;some_name&quot;,       link: file_record.file.url     }   end  ```  (SORRY, can&#39;t add formatting to the comment)"}, {"owner": {"reputation": 824, "user_id": 2743131, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TDByo.png?s=128&g=1", "display_name": "tjheslin1", "link": "https://stackoverflow.com/users/2743131/tjheslin1"}, "edited": false, "score": 0, "creation_date": 1590131572, "post_id": 61934922, "comment_id": 109568933, "body": "That marsmust. Could you edit your answer to include this? There you will able to format it."}], "tags": [], "owner": {"reputation": 51, "user_id": 9788663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkzdM.jpg?s=128&g=1", "display_name": "marsimus", "link": "https://stackoverflow.com/users/9788663/marsimus"}, "is_accepted": false, "score": 1, "last_activity_date": 1590412110, "last_edit_date": 1590412110, "creation_date": 1590065436, "answer_id": 61934922, "question_id": 53832590, "link": "https://stackoverflow.com/questions/53832590/how-to-make-activerecord-import-to-use-an-sequence/61934922#61934922", "title": "How to make activerecord-import to use an sequence", "body": "<p>Faced with same issue today. Just used another way for records import. Instead of importing of collection of AR objects, build a collection of attributes hashes without sequence parameters and then import them through <code>Model.import</code>. This way works for me.</p>\n\n<p>Example. Given I have position column with default sequence value: \n<code>position | integer | not null default nextval('file_exports.task_file_item_position_seq'::regclass)</code> </p>\n\n<p>In this code next sequence value will be set by Postgres automatically in \neach <code>FileExports::TaskFileItem</code> record.</p>\n\n<pre><code>... \nparams = file_records.map do |file_record|\n  build_file_item_params(file_record) \nend \n\ndef build_file_item_params(file_record) \n  { \n    name: \"some_name\", \n    link: file_record.file.url \n  } \nend \n\nFileExports::TaskFileItem.import!(params, validate: true) \n</code></pre>\n"}], "owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1590412110, "creation_date": 1545134538, "last_edit_date": 1545136227, "question_id": 53832590, "link": "https://stackoverflow.com/questions/53832590/how-to-make-activerecord-import-to-use-an-sequence", "title": "How to make activerecord-import to use an sequence", "body": "<p>I have the following model:</p>\n\n<pre><code>                                                  Table \"public.models\"\n        Column        |            Type             | Collation | Nullable |                   Default                   \n----------------------+-----------------------------+-----------+----------+---------------------------------------------\n id                   | bigint                      |           | not null | nextval('models_id_seq'::regclass)\n research_provider_id | bigint                      |           | not null | \n covered_company_id   | bigint                      |           | not null | \n publication_date     | timestamp without time zone |           | not null | \n created_at           | timestamp without time zone |           | not null | \n updated_at           | timestamp without time zone |           | not null | \n insights_id          | bigint                      |           | not null | nextval('models_insights_id_seq'::regclass)\nIndexes:\n    \"models_pkey\" PRIMARY KEY, btree (id)\nForeign-key constraints:\n    \"fk_rails_22d32db7ac\" FOREIGN KEY (covered_company_id) REFERENCES companies(id)\n    \"fk_rails_3a764bb9c1\" FOREIGN KEY (research_provider_id) REFERENCES companies(id)\nReferenced by:\n    TABLE \"model_product_groups\" CONSTRAINT \"fk_rails_1866a14ba0\" FOREIGN KEY (model_id) REFERENCES models(id)\n    TABLE \"model_analysts\" CONSTRAINT \"fk_rails_c7730c705b\" FOREIGN KEY (model_id) REFERENCES models(id)\n</code></pre>\n\n<p>And I'm creating the objects using ActiveRecord, with:</p>\n\n<pre><code>   Model.new(\n        # insights_id: \n        research_provider_id: company.id,\n        covered_company_id: covered_company_id,\n        publication_date:  Time.current - rand(1..20).day,\n    ......\n   )\n</code></pre>\n\n<p>What value should I pass to <code>insights_id</code> to use the <code>models_insights_id_seq</code> sequece? Tried <code>DEFAULT</code> and not passing anything and both fail to use the sequence, ie, making activerecord-import to generate <code>nextval('public.models_insights_id_seq')</code></p>\n\n<p>Note: This question is about to instruct <code>activerecord-import</code> to generate <code>nextval('public.models_insights_id_seq')</code> for the <code>insights_id</code> column, and not about using ActiveRecord to get the sequence next value.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "chef-infra", "inspec"], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 7658550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc3766b70a0917f19d47903b9c5d500?s=128&d=identicon&r=PG&f=1", "display_name": "uwieuwe4", "link": "https://stackoverflow.com/users/7658550/uwieuwe4"}, "is_accepted": false, "score": 0, "last_activity_date": 1545140121, "creation_date": 1545140121, "answer_id": 53834257, "question_id": 53832348, "link": "https://stackoverflow.com/questions/53832348/why-does-inspec-return-expected-to-include-when-checking-for-aws-elbs-ports/53834257#53834257", "title": "Why does Inspec return &quot;expected [] to include&quot; when checking for aws_elbs ports?", "body": "<p>I am now pretty sure that this happens because <strong>Inspec does not support Network Load Balancers</strong>. \nWill leave this here in case someone has the same issue. </p>\n"}], "owner": {"reputation": 83, "user_id": 7658550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc3766b70a0917f19d47903b9c5d500?s=128&d=identicon&r=PG&f=1", "display_name": "uwieuwe4", "link": "https://stackoverflow.com/users/7658550/uwieuwe4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545140147, "creation_date": 1545133628, "last_edit_date": 1592644375, "question_id": 53832348, "link": "https://stackoverflow.com/questions/53832348/why-does-inspec-return-expected-to-include-when-checking-for-aws-elbs-ports", "title": "Why does Inspec return &quot;expected [] to include&quot; when checking for aws_elbs ports?", "body": "<p>This is an Inspec control that checks for the VPC-Id, Ports, Subnets and AZs for a specific Network Loadbalancer:</p>\n<pre><code>control 'Loadbalancer Config' do\n  title 'Checks for correct configuration of LBs'\n  describe aws_elbs.where(arn: 'arn:aws:elasticloadbalancing:eu-central-1:123456789:loadbalancer/app/web-app-alb/1d234567890d') do\n    its('vpc_ids') { should include 'vpc-a12345678' }\n    its('subnet_ids') { should include 'subnet-12345678' }\n    its('internal_ports') { should include 443 }\n    its('availability_zones') { should include 'eu-central-1a' }\n  end\nend\n</code></pre>\n<p>When executing, the tests fail and I get</p>\n<blockquote>\n<p>expected [] to include &quot;vpc-a12345678&quot;</p>\n<p>expected [] to include 443</p>\n<p>expected [] to include &quot;subnet-12345678&quot;</p>\n<p>expected [] to include &quot;eu-central-1a&quot;</p>\n</blockquote>\n<p>I double checked the ARN of the Loadbalancer but I always get this empty array of results.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-3.2", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10728400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xxD9M.jpg?s=128&g=1", "display_name": "divya", "link": "https://stackoverflow.com/users/10728400/divya"}, "edited": false, "score": 0, "creation_date": 1545128349, "post_id": 53830590, "comment_id": 94509937, "body": "i am facing error SQLite3::SQLException: near &quot;from&quot;: syntax error: SELECT &quot;leaves&quot;.&quot;start_date&quot; FROM &quot;leaves&quot; WHERE (extract(month from start_date) = 0)"}, {"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "reply_to_user": {"reputation": 57, "user_id": 10728400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xxD9M.jpg?s=128&g=1", "display_name": "divya", "link": "https://stackoverflow.com/users/10728400/divya"}, "edited": false, "score": 0, "creation_date": 1545161792, "post_id": 53830590, "comment_id": 94528096, "body": "I&#39;ve updated the code for SQLite as well. Please let me know if that works"}], "tags": [], "owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1545161753, "last_edit_date": 1545161753, "creation_date": 1545127387, "answer_id": 53830590, "question_id": 53830223, "link": "https://stackoverflow.com/questions/53830223/how-to-get-duplicate-month-and-year-matched-record-in-rails/53830590#53830590", "title": "How to get duplicate month and year matched record in rails?", "body": "<p>You cannot find duplicate dates by month when you're trying to find for all months in a single array\nThe below can give you an array of objects where your month number and duplicate dates for that month number will be there</p>\n\n<h3>For MySQL / PostgresQL</h3>\n\n<pre><code>class LeaveController &lt; ApplicationController\n  def new\n    @result = []\n    12.times do |i|\n      month_data = {\n        month_number: i,\n        duplicate_dates: Leave.where(\"extract(month from start_date) = ?\", i).pluck(:start_date)\n      }\n      @result.push month_data\n    end\n    #Print and see the result\n    p @result\n  end\nend\n</code></pre>\n\n<h3>Update for SQLite</h3>\n\n<p>Since you're using sqlite, and the above syntax is not supported, here is a way for the same:</p>\n\n<pre><code># In your model you can write a class method so you don't have to write all that\n#   logic in your controller and make it reusable\nclass Leave &lt; ActiveRecord::Base\n  def self.duplicate_dates(current_month)\n    query = \"SELECT * FROM leaves WHERE strftime('%m', start_date) = #{current_month}\"\n    self.find_by_sql query\n  end\nend\n\nclass LeaveController &lt; ApplicationController\n  def new\n    @result = []\n    ('01'..'12').to_a.each do |i|\n      # Get all the records with duplicate month\n      duplicate_data = Leave.duplicate_dates(i)\n      # The above will return a regular array and not an activerecord association,\n      #   so pluck can't be used on it\n\n      # To get only the dates you can use map \n      duplicate_dates = duplicate_data.map {|i| i.start_date}\n\n      month_data = {\n        month_number: i,\n        duplicate_dates: duplicate_dates\n      }\n      @result.push month_data\n    end\n    #Print and see the result\n    p @result\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "is_accepted": false, "score": 0, "last_activity_date": 1545134185, "creation_date": 1545134185, "answer_id": 53832501, "question_id": 53830223, "link": "https://stackoverflow.com/questions/53830223/how-to-get-duplicate-month-and-year-matched-record-in-rails/53832501#53832501", "title": "How to get duplicate month and year matched record in rails?", "body": "<p>On SQLite, you can't. The supported SQL features are really minimal, you'd better have a local postgres/mysql server - the same server and version you will be using in production.</p>\n\n<p>On a real SQL database you have the <code>EXTRACT(YEAR_MONTH from date)</code> function, and you can use it with <code>GROUP BY</code>.</p>\n\n<p>This could be the proper SQL, you can use it with plain <code>Leave.connection.execute(...)</code>:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT\n  GROUP_CONCAT(`leaves`.`id` SEPARATOR ',') AS ids,\n  GROUP_CONCAT(`leaves`.`start_date` SEPARATOR ',') AS start_dates\nFROM `leaves`\nGROUP BY EXTRACT(YEAR_MONTH from `leaves`.`start_date`)\nHAVING COUNT(`leaves`.`id`) &gt; 1\n</code></pre>\n\n<p>With the data in the image, you will have the following result:</p>\n\n<pre><code>ids               | start_dates\n------------------+---------------------------------\n5,6,8             | 2019-01-08,2019-01-31,2019-01-25\n1,2,3,4           | ...\n</code></pre>\n\n<p>and there will be no entry for leaves that don't share month with others.</p>\n"}], "owner": {"reputation": 57, "user_id": 10728400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xxD9M.jpg?s=128&g=1", "display_name": "divya", "link": "https://stackoverflow.com/users/10728400/divya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545161753, "creation_date": 1545126294, "last_edit_date": 1545127303, "question_id": 53830223, "link": "https://stackoverflow.com/questions/53830223/how-to-get-duplicate-month-and-year-matched-record-in-rails", "title": "How to get duplicate month and year matched record in rails?", "body": "<p>I want to fetch duplicate month of record from table\nI have leaves table inside of start_date column have many records my db\n<a href=\"https://imgur.com/a/jdyxTo1\" rel=\"nofollow noreferrer\">https://imgur.com/a/jdyxTo1</a>\nexample I have 3 duplicate record in table \nreturn duplicate record#08.01.2019,31.01.2019,25.01.2019\nHow to do this ?</p>\n\n<pre><code>class LeaveController &lt; ApplicationController\n  def new\n    #your code here \n  end\nend\n</code></pre>\n\n<ul>\n<li>My model name <strong>Leave</strong> my table name <strong>leaves</strong></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "edited": false, "score": 0, "creation_date": 1545125020, "post_id": 53829790, "comment_id": 94507989, "body": "can you try <code>render json: @demojsobs.as_json</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1545125535, "post_id": 53829886, "comment_id": 94508297, "body": "Thankoyou for your answer. Its add same data from Prejob to Demojob but if i want to add some  custom attributies in demojob active record model then how can i do?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1545125910, "post_id": 53829886, "comment_id": 94508481, "body": "Updated the answer"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1545125898, "last_edit_date": 1545125898, "creation_date": 1545125165, "answer_id": 53829886, "question_id": 53829790, "link": "https://stackoverflow.com/questions/53829790/store-values-from-an-array-in-new-array/53829886#53829886", "title": "Store values from an array in new array", "body": "<p>Assuming that both <code>Prejob</code> and <code>Demojob</code> are active record models, you should use <code>attributes</code> in the constructor call. Also rather build a new array with <code>map</code> or append to it than assign to a new value to a var in every iteration step..</p>\n\n<pre><code>@demojobs = @pre.jobs.map do |job|\n  Demojob.new(job.attributes.except(:id))\nend\nrender json: @demojobs\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>To add some custom attributes, you can merge them to the hash or set them manually:</p>\n\n<pre><code>@demojobs = @pre.jobs.map do |job|\n  Demojob.new(job.attributes.except(:id).merge(attr1: val1, attr1: val2))\nend\nrender json: @demojobs\n\n@demojobs = @pre.jobs.map do |job|\n  Demojob.new(job.attributes.except(:id)).tap do |dj|\n    dj.attr1 = val1\n    dj.attr2 = val2\n  end\nend\nrender json: @demojobs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 9361533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-skZgtkXNKK4/AAAAAAAAAAI/AAAAAAAAAVw/ChuLDYzLJpI/photo.jpg?sz=128", "display_name": "Bhargav Reddy", "link": "https://stackoverflow.com/users/9361533/bhargav-reddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545126289, "creation_date": 1545126289, "answer_id": 53830220, "question_id": 53829790, "link": "https://stackoverflow.com/questions/53829790/store-values-from-an-array-in-new-array/53830220#53830220", "title": "Store values from an array in new array", "body": "<p>I think You should try like this</p>\n\n<pre><code>@demojobsarray = Array.new\n    @pre.jobs.map do |job|\n        @demojobsarray.push(job)\n    end\n@demojobs=Demojob.new(@demojobsarray)\nrender json: @demojobs\n</code></pre>\n"}], "owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53829886, "answer_count": 2, "score": -2, "last_activity_date": 1545126289, "creation_date": 1545124865, "last_edit_date": 1545125655, "question_id": 53829790, "link": "https://stackoverflow.com/questions/53829790/store-values-from-an-array-in-new-array", "title": "Store values from an array in new array", "body": "<p>I have an array <code>prejobs</code>, and I want to store some of its elements in a new array <code>demojobs</code>. I tried the following code:</p>\n\n<pre><code>@pre.jobs.map do |job|\n    @demojobs = Demojob.new(job)\nend\nrender json: @demojobs\n</code></pre>\n\n<p>But I get an <code>undefined method 'stringify_keys'</code> error. Is there any good way to perform this?</p>\n"}, {"tags": ["ruby", "gzip"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1545126149, "post_id": 53829143, "comment_id": 94508599, "body": "<code>Zlib::GzipReader.new(StringIO.new(Base64.decode64(&#39;H4sIAAuxG&zwnj;&#8203;FwC&#47;4uuVkrNTczMUbJSU&zwnj;&#8203;MpyyNJLzs9V0lFQSs7PK&zwnj;&#8203;0lMLgGJgrh5ibmpILYXk&zwnj;&#8203;C4GCRRnZ+bkFAOFopW0D&zwnj;&#8203;RXMzS0sLS0NDAzMlWKBk&zwnj;&#8203;qkppUCZaqXSdLCCgMqSj&zwnj;&#8203;Pw8sEwBRMQ5WCm2tlZHY&zwnj;&#8203;eDsjgUA6yqlo&#47;gAAAA&#39;)&zwnj;&#8203;)).read</code> results in : <code>&quot;[{\\&quot;email\\&quot;: \\&quot;j@j.com\\&quot;, \\&quot;contact\\&quot;: \\&quot;\\&quot;, \\&quot;name\\&quot;: \\&quot;James\\&quot;, \\&quot;skills\\&quot;: [\\&quot;+1 7789990007\\&quot;], \\&quot;edu\\&quot;: {\\&quot;ug\\&quot;: [\\&quot;Python\\&quot;], \\&quot;pg\\&quot;: [\\&quot;CS\\&quot;]}}, {\\&quot;email\\&quot;: \\&quot;j@j.com\\&quot;, \\&quot;contact\\&quot;: \\&quot;\\&quot;, \\&quot;name\\&quot;: \\&quot;James\\&quot;, \\&quot;skills\\&quot;: [\\&quot;+1 7789990007\\&quot;], \\&quot;edu\\&quot;: {\\&quot;ug\\&quot;: [\\&quot;Python\\&quot;], \\&quot;pg\\&quot;: [\\&quot;CS\\&quot;]}}]&quot;</code>"}, {"owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1545127189, "post_id": 53829143, "comment_id": 94509223, "body": "Yeah, thanks. But seems like ruby is not seeing the same base64 string (which I can see manually inside RMQ dashboard). It sees that \\xYY\\xYY string somehow."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1545127647, "post_id": 53829143, "comment_id": 94509528, "body": "Hmm, could it be that bunny is decoding the base64 for you for some reason?"}, {"owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1545127884, "post_id": 53829143, "comment_id": 94509680, "body": "If so - seems like it is doing it wrong, because I should unzip message the same way without base64decoding. I&#39;ll take a deeper look at bunny"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1545128947, "post_id": 53829143, "comment_id": 94510342, "body": "I guess when reading from IO the wrong encoding is used. It assumes a certain string encoding while in reality another encoding is used. For example Ruby thinks the encoding is UTF-8 while in reality it is UTF-16le or something. You can force Ruby into a specific encoding with <a href=\"http://ruby-doc.org/core-2.5.3/String.html#method-i-force_encoding\" rel=\"nofollow noreferrer\"><i>String#force_encoding</i></a>."}], "owner": {"reputation": 179, "user_id": 7781443, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3754645e9fa3f3cc8578b0bb58dd0eb3?s=128&d=identicon&r=PG&f=1", "display_name": "ikebastuz", "link": "https://stackoverflow.com/users/7781443/ikebastuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545126822, "creation_date": 1545122344, "last_edit_date": 1545126822, "question_id": 53829143, "link": "https://stackoverflow.com/questions/53829143/unzip-string-with-ruby", "title": "Unzip string with Ruby", "body": "<p>I have compressed gzip data (object->array of objects->json->gzip) emitted with python to rabbitMQ. If I catch it with python - I is being decoded easily.</p>\n\n<p>Encoding python function:</p>\n\n<pre><code>def gzip_str(string_):\n    out = io.BytesIO()\n\n    with gzip.GzipFile(fileobj=out, mode='w') as fo:\n        fo.write(string_.encode())\n\n    bytes_obj = out.getvalue()\n    return bytes_obj\n</code></pre>\n\n<p>Decoding python function:</p>\n\n<pre><code>def gunzip_bytes_obj(bytes_obj):\n    in_ = io.BytesIO()\n    in_.write(bytes_obj)\n    in_.seek(0)\n    with gzip.GzipFile(fileobj=in_, mode='rb') as fo:\n        gunzipped_bytes_obj = fo.read()\n\n    return gunzipped_bytes_obj.decode()\n</code></pre>\n\n<p>The thing is - I have to decode it on logstash, so it should be done with ruby. \nTried different approaches, all similar to this:</p>\n\n<pre><code>#!/usr/bin/env ruby\n# encoding: utf-8\nrequire 'bunny'\nrequire 'base64'\nrequire 'zlib'\nrequire 'stringio'\n\n\nconnection = Bunny.new\nconnection.start\n\nchannel = connection.create_channel\nqueue = channel.queue('kit_logstash', :durable =&gt; true)\n\n\nbegin\n  queue.subscribe(block: true) do |_delivery_info, _properties, body|\n    puts body\n    puts body.encoding\n    puts Base64.decode64(body)\n    puts Base64.decode64(body).encoding\n\n    body_decoded = Base64.decode64(body.to_s)\n    sio = StringIO.new(body_decoded)\n    gz = Zlib::GzipReader.new(sio)\n    result = gz.read.to_s\n  end\nrescue Interrupt =&gt; _\n  connection.close\n\n  exit(0)\nend\n</code></pre>\n\n<p>Message on rabbitMQ looks like this:</p>\n\n<pre><code>H4sIAAuxGFwC/4uuVkrNTczMUbJSUMpyyNJLzs9V0lFQSs7PK0lMLgGJgrh5ibmpILYXkC4GCRRnZ+bkFAOFopW0DRXMzS0sLS0NDAzMlWKBkqkppUCZaqXS\ndLCCgMqSjPw8sEwBRMQ5WCm2tlZHYeDsjgUA6yqlo/gAAAA=\n</code></pre>\n\n<p>And it can be decoded also easily using some online decoders.</p>\n\n<p>But ruby is not handling it in any way\nIt sees whether something like this:</p>\n\n<pre><code>T\\x93\\x10D\\xFA\\xCAQ\\x03\\xC9\\xF8\\x82\\xF2\\x82\\x06\\xE3\\xB4\\xB0\\xFD]Q\\x9A\n</code></pre>\n\n<p>Or something like this:</p>\n\n<pre><code>\ufffd\ufffd-,--VJ\ufffdM\ufffd\ufffdQ\ufffdRP\ufffdr\ufffd\ufffdK\ufffd\ufffdU\ufffdQPJ\ufffd\ufffd+IL.\ufffd\ufffd\ufffdy\ufffd\ufffd\ufffd \ufffd\ufffd.   gg\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n</code></pre>\n\n<p>And of course it says <code>Zlib::GzipFile::Error: not in gzip format</code>\nAm I doing something wrong? Maybe its something with encodings? Or string-bytes difference?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1545198665, "post_id": 53828146, "comment_id": 94538155, "body": "@rubyist : check my answer for your updated question"}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1545120770, "post_id": 53828213, "comment_id": 94505928, "body": "Or use <code>Addressable::URI</code> if you need better UTF-8 support."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1545118126, "creation_date": 1545118126, "answer_id": 53828213, "question_id": 53828146, "link": "https://stackoverflow.com/questions/53828146/replace-host-name-in-a-url-string/53828213#53828213", "title": "Replace host name in a URL string", "body": "<p>Use a URI parser and just return the path:</p>\n\n<pre><code>URI.parse(\"https://www.example.com/user-detail/1231-N-F-Albert\").path\n#=&gt; \"/user-detail/1231-N-F-Albert\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 10232486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9lJZ.png?s=128&g=1", "display_name": "vikram sahu", "link": "https://stackoverflow.com/users/10232486/vikram-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1545123524, "last_edit_date": 1545123524, "creation_date": 1545118589, "answer_id": 53828305, "question_id": 53828146, "link": "https://stackoverflow.com/questions/53828146/replace-host-name-in-a-url-string/53828305#53828305", "title": "Replace host name in a URL string", "body": "<p>Use the following code. Hope it is clean and easy to understand.</p>\n\n<pre><code>require 'uri'\nURI(\"http://www.mydomain.qwe/directory\").path\n# =&gt; \"/directory\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": -1, "last_activity_date": 1545198631, "creation_date": 1545198631, "answer_id": 53845303, "question_id": 53828146, "link": "https://stackoverflow.com/questions/53828146/replace-host-name-in-a-url-string/53845303#53845303", "title": "Replace host name in a URL string", "body": "<p>use <strong><a href=\"https://apidock.com/ruby/URI\" rel=\"nofollow noreferrer\">Ruby#URI</a></strong></p>\n\n<pre><code>&gt; require 'uri'\n# To get path from URL\n&gt; URI.parse(\"https://www.example.com/user-detail/1231-N-F-Albert\").path\n#=&gt; \"/user-detail/1231-N-F-Albert\"\n</code></pre>\n\n<hr>\n\n<pre><code># To get last segment of url\n&gt; URI.parse(\"https://www.example.com/user-detail/1231-N-F-Albert\").path.split('/').last\n#=&gt; \"1231-N-F-Albert\"\n</code></pre>\n"}], "owner": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1545198631, "creation_date": 1545117823, "last_edit_date": 1545196348, "question_id": 53828146, "link": "https://stackoverflow.com/questions/53828146/replace-host-name-in-a-url-string", "title": "Replace host name in a URL string", "body": "<p><strong>Original question</strong></p>\n\n<p>I have a string URL, and I need to extract the subdomains of the url.\nMy URL would look like:</p>\n\n<pre><code>user[:href] = \"https://www.example.com/user-detail/1231-N-F-Albert\"\n</code></pre>\n\n<p>I need to extract:</p>\n\n<pre><code>\"https://www.example.com/\"\n</code></pre>\n\n<p>and return:</p>\n\n<pre><code>\"/user-detail/1231-N-F-Albert\"\n</code></pre>\n\n<p>Is there any method that removes the host name and returns just the subdomain? I tried with:</p>\n\n<pre><code>URI.parse(user[:href]).host.replace(\"\")\n</code></pre>\n\n<p>but it returned empty. Any other way to achieve it?</p>\n\n<hr>\n\n<p><strong>New question</strong></p>\n\n<p>I have changed the question. I need to extract:</p>\n\n<pre><code>\"https://www.example.com/user-detail\"\n</code></pre>\n\n<p>and return:</p>\n\n<pre><code>\"1231-N-F-Albert\"\n</code></pre>\n\n<p>Is there any way to achieve this? I tried with regular expression, but it didn't work.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 927, "user_id": 4590956, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-uXEpJyPD4_s/AAAAAAAAAAI/AAAAAAAAABg/uS9fIkQKJXU/photo.jpg?sz=128", "display_name": "Vikram Singh Jadon", "link": "https://stackoverflow.com/users/4590956/vikram-singh-jadon"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1545117176, "post_id": 53827944, "comment_id": 94504381, "body": "This is selecting the comma that has white space around it. I want to select the other one that does not have any white space around it."}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 2, "creation_date": 1545117339, "post_id": 53827944, "comment_id": 94504445, "body": "That should be a positive lookahead instead <code>(?&lt;=\\S),(?=\\S)</code> <a href=\"http://rubular.com/r/2HWhJHGKYx\" rel=\"nofollow noreferrer\">demo</a>"}, {"owner": {"reputation": 927, "user_id": 4590956, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-uXEpJyPD4_s/AAAAAAAAAAI/AAAAAAAAABg/uS9fIkQKJXU/photo.jpg?sz=128", "display_name": "Vikram Singh Jadon", "link": "https://stackoverflow.com/users/4590956/vikram-singh-jadon"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1545117488, "post_id": 53827944, "comment_id": 94504514, "body": "Yes, this works. Thanks. Didn&#39;t know about lookahead and lookbehind."}, {"owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 0, "creation_date": 1545117492, "post_id": 53827944, "comment_id": 94504520, "body": "Do you want to match things like <code>@,@</code> also ?"}, {"owner": {"reputation": 927, "user_id": 4590956, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-uXEpJyPD4_s/AAAAAAAAAAI/AAAAAAAAABg/uS9fIkQKJXU/photo.jpg?sz=128", "display_name": "Vikram Singh Jadon", "link": "https://stackoverflow.com/users/4590956/vikram-singh-jadon"}, "edited": false, "score": 0, "creation_date": 1545117612, "post_id": 53827944, "comment_id": 94504562, "body": "Yes, everything except for white space. Actually, I have a string that I want to add to a CSV (which has comma separation). But there are many columns that has data which contains &quot;comma and space&quot;. So everything except for white space."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545123547, "post_id": 53827944, "comment_id": 94507209, "body": "What do mean by \u201cselect commas in a string...\u201d? Do you wish to return an array of indices of the commas that have the desired property, the number of commas having the desired property or something else?"}, {"owner": {"reputation": 927, "user_id": 4590956, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-uXEpJyPD4_s/AAAAAAAAAAI/AAAAAAAAABg/uS9fIkQKJXU/photo.jpg?sz=128", "display_name": "Vikram Singh Jadon", "link": "https://stackoverflow.com/users/4590956/vikram-singh-jadon"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545211481, "post_id": 53827944, "comment_id": 94543675, "body": "@CarySwoveland My usecase is to split a string at all the places where a comma is present but without any white spaces around it. I am using ruby. So doing that using a regex."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 10232486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9lJZ.png?s=128&g=1", "display_name": "vikram sahu", "link": "https://stackoverflow.com/users/10232486/vikram-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1545119818, "creation_date": 1545119818, "answer_id": 53828558, "question_id": 53827944, "link": "https://stackoverflow.com/questions/53827944/regex-to-select-all-the-commas-from-string-that-do-not-have-any-white-space-arou/53828558#53828558", "title": "Regex to select all the commas from string that do not have any white space around them", "body": "<p>Check the regex below and use the code hope it will help you!</p>\n\n<pre><code>re = /[^\\s](,)[^\\s]/m\nstr = 'check ,my,domain, qwe,sd'\n\n# Print the match result\nstr.scan(re) do |match|\nputs match.to_s\nend\n</code></pre>\n\n<p>Check <a href=\"https://regex101.com/r/AuvzNa/1\" rel=\"nofollow noreferrer\">LIVE DEMO HERE</a></p>\n"}, {"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 1, "last_activity_date": 1545120023, "creation_date": 1545120023, "answer_id": 53828612, "question_id": 53827944, "link": "https://stackoverflow.com/questions/53827944/regex-to-select-all-the-commas-from-string-that-do-not-have-any-white-space-arou/53828612#53828612", "title": "Regex to select all the commas from string that do not have any white space around them", "body": "<p>In Ruby, you may use <code>[[:space:]]</code> to match any (Unicode) whitespace and <code>[^[:space:]]</code> to match any char other than whitespace. Using these character classes inside <a href=\"https://www.regular-expressions.info/lookaround.html\" rel=\"nofollow noreferrer\"><em>lookarounds</em></a> solves the problem:</p>\n\n<pre><code>/(?&lt;=[^[:space:]]),(?=[^[:space:]])/\n</code></pre>\n\n<p>See the <a href=\"http://rubular.com/r/OXEgVwaV2m\" rel=\"nofollow noreferrer\">Rubular demo</a></p>\n\n<p>Here,</p>\n\n<ul>\n<li><code>(?&lt;=[^[:space:]])</code> - a positive lookbehind that matches a location that is immediately preceded with a non-whitespace char (if the string start position should also be matched, replace with <code>(?&lt;![[:space:]])</code>)</li>\n<li><code>,</code> - a comma</li>\n<li><code>(?=[^[:space:]])</code> - a positive lookahead that matches a location that is immediately followed with a non-whitespace char (if the string end position should also be matched, replace with <code>(?![[:space:]])</code>).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": true, "score": 1, "last_activity_date": 1545120364, "creation_date": 1545120364, "answer_id": 53828684, "question_id": 53827944, "link": "https://stackoverflow.com/questions/53827944/regex-to-select-all-the-commas-from-string-that-do-not-have-any-white-space-arou/53828684#53828684", "title": "Regex to select all the commas from string that do not have any white space around them", "body": "<p>In your regex <code>(,[^(,\\s)(\\s,)])</code> you capture a comma followed by a negated character class that matches not any of the specified characters, which could also be written as <code>(,[^)(,\\s])</code> which will capture for example <code>,s</code> in a group,</p>\n\n<p>What you could do is use a positive <a href=\"https://www.regular-expressions.info/lookaround.html\" rel=\"nofollow noreferrer\">lookahead</a> and a positve lookbehind to check what is on the left and what is on the right is not a <code>\\S</code> whitespace character:</p>\n\n<p><code>(?&lt;=\\S),(?=\\S)</code></p>\n\n<p><a href=\"http://rubular.com/r/2HWhJHGKYx\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n"}], "owner": {"reputation": 927, "user_id": 4590956, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-uXEpJyPD4_s/AAAAAAAAAAI/AAAAAAAAABg/uS9fIkQKJXU/photo.jpg?sz=128", "display_name": "Vikram Singh Jadon", "link": "https://stackoverflow.com/users/4590956/vikram-singh-jadon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53828684, "answer_count": 3, "score": 1, "last_activity_date": 1545121270, "creation_date": 1545116973, "last_edit_date": 1545121270, "question_id": 53827944, "link": "https://stackoverflow.com/questions/53827944/regex-to-select-all-the-commas-from-string-that-do-not-have-any-white-space-arou", "title": "Regex to select all the commas from string that do not have any white space around them", "body": "<p>I want to select all the commas in a string that do not have any white space around. Suppose I have this string:</p>\n\n<pre><code>\"He,she, They\"\n</code></pre>\n\n<p>I want to select only the comma between <code>he</code> and <code>she</code>. I tried this in rubular and came up with this regex:</p>\n\n<pre><code>(,[^(,\\s)(\\s,)])\n</code></pre>\n\n<p>This selects the comma that I want, but also selects an <code>s</code> which is a character after it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0zPue.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0zPue.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "encoding", "character-encoding"], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1545102595, "creation_date": 1545102595, "answer_id": 53825870, "question_id": 53825748, "link": "https://stackoverflow.com/questions/53825748/ruby-encoding-replace-invalid-encoding/53825870#53825870", "title": "Ruby encoding - replace invalid encoding?", "body": "<p>According to the Ruby documentation for <a href=\"http://ruby-doc.org/core-2.5.3/String.html#method-i-encode\" rel=\"nofollow noreferrer\">encode</a> the 2nd argument is the encoding of the source string.</p>\n\n<p>This may be an optional field, because there are 3 forms of this method:</p>\n\n<pre><code>encode(encoding [, options] ) \u2192 str\nencode(dst_encoding, src_encoding [, options] ) \u2192 str\nencode([options]) \u2192 str\n</code></pre>\n\n<p>You may need it, depending on what the source string looks like however:</p>\n\n<p><a href=\"https://stackoverflow.com/a/10466273/2892779\">https://stackoverflow.com/a/10466273/2892779</a></p>\n"}], "owner": {"reputation": 17608, "user_id": 661624, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/347231f8387561ef324e25b48b96ba16?s=128&d=identicon&r=PG&f=1", "display_name": "Henley Chiu", "link": "https://stackoverflow.com/users/661624/henley-chiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545104118, "creation_date": 1545101341, "last_edit_date": 1545104118, "question_id": 53825748, "link": "https://stackoverflow.com/questions/53825748/ruby-encoding-replace-invalid-encoding", "title": "Ruby encoding - replace invalid encoding?", "body": "<p>I think this piece of code replaces invalid UTF-8 characters with blank strings:</p>\n\n<pre><code>title = title.encode('UTF-8', 'binary', invalid: :replace, undef: :replace, replace: '')\n</code></pre>\n\n<p>What is the second argument <code>'binary'</code> for? Is it necessary?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545101426, "post_id": 53825615, "comment_id": 94500343, "body": "I&#39;m not sure this is a good place to use shared example groups.  I don&#39;t see Product and Group sharing much functionality. Shared example groups are more for scenarios such as having Ingredient and Packaging.  Since both can be purchased, you can DRY out your code and make it more easily maintainable with <code>it_should_behave_like :it_is_purchasable</code> or <code>a_purchasable_item</code>.  This is of course just my opinion, and I wanted to put it out there for discussion."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545102140, "post_id": 53825615, "comment_id": 94500449, "body": "We do use shared example groups across a variety of models/controllers. As long as you limit the sharing to what&#39;s actually shared I haven&#39;t run into any issues with readability/refactorability. When you start throwing conditionals into your shared example, looking at args, etc. then it gets crazy. I posted an example as an answer (but I&#39;m not sure if it addresses what you&#39;re looking for). Please feel free to ask any questions for clarification"}, {"owner": {"reputation": 170, "user_id": 5389125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOQuJ.png?s=128&g=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/5389125/rossman"}, "reply_to_user": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545105083, "post_id": 53825615, "comment_id": 94500966, "body": "@Tom I&#39;m trying to use shared example groups for a lot of the really basic test that probably apply to any fully implemented resource.  &quot;Does #index return all my fixture defined records?&quot;, &quot;Does #create actually create a new record?&quot;, etc.  Then use non-shared examples to test the more specific functionality.  I just think it should be possible to setup a basic test suite of shared examples that I can attach to any new resource."}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 5389125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOQuJ.png?s=128&g=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/5389125/rossman"}, "edited": false, "score": 1, "creation_date": 1545105238, "post_id": 53825813, "comment_id": 94500997, "body": "Your response is making me cry (out of joy).  I thought for sure the only answer was restructure your whole test suite.  Also, converting to this pattern is relatively painless.  Thanks!!!"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 0, "last_activity_date": 1545102001, "creation_date": 1545102001, "answer_id": 53825813, "question_id": 53825615, "link": "https://stackoverflow.com/questions/53825615/using-rspec-shared-example-groups-with-belongs-to-associations/53825813#53825813", "title": "Using RSpec shared example groups with belongs_to associations", "body": "<p>I use a <code>let</code> inside of the <code>it_behaves_like</code> block like below:</p>\n\n<pre><code>RSpec.describe \"Products\", type: :request do\n  fixtures :groups, :products\n\n  # This shared example probably lives in another file, which is fine\n  # I don't usually pass in args, instead using everything via `let`\n  shared_example 'modify_data_checks' do\n    # you have access to all your variables via let inside here\n    before do\n      visit(path)\n    end\n\n    expect(model).to be_a(Product)\n    expect(group_id).to eq(1)\n  end\n\n  it_behaves_like 'modify_data_checks' do\n    let(:path) { Rails.application.routes.url_helpers.api_products_path }\n    let(:model) { Product }\n    let(:group_id) { Group.first.id }\n    let(:params) { \n      product: {\n        name: \"New Product\",\n        description: \"Test product to add or modify\",\n        group_id: group_id,\n        label: \"NP\"\n      }\n    }\n  end\nend\n</code></pre>\n\n<p>You should be able to pass data around relatively cleanly like this. We're using a pattern similar to this to test polymorphic relationships using shared examples.</p>\n"}], "owner": {"reputation": 170, "user_id": 5389125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOQuJ.png?s=128&g=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/5389125/rossman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 53825813, "answer_count": 1, "score": 1, "last_activity_date": 1545102001, "creation_date": 1545100120, "question_id": 53825615, "link": "https://stackoverflow.com/questions/53825615/using-rspec-shared-example-groups-with-belongs-to-associations", "title": "Using RSpec shared example groups with belongs_to associations", "body": "<p>In a Rails project (rails 5.2.2, ruby 2.4.1) I have 2 resources defined, one named \"groups\" and one named \"products\".  Product objects have a belongs_to relationship with a Group.  I wanted to created an rspec shared example group which can test both resources, but I'm having some trouble with the \"create\" and \"update\" actions for \"products\".</p>\n\n<p>I wanted to setup a shared set of example groups which take a hash used to create a new record as a parameter.  The example group could then be called within both the \"groups_spec.rb\" and the \"products_spec.rb\".  I have fixtures for both \"groups\" and \"products.  The following is a code example for the \"requests/products_spec.rb\" which calls the shared examples:</p>\n\n<pre><code>RSpec.describe \"Products\", type: :request do\n   fixtures :groups, :products\n   it_should_behave_like(\"modify data checks\",\n         Rails.application.routes.url_helpers.api_products_path,\n         Product,\n         { product: {\n            name: \"New Product\",\n            description: \"Test product to add or modify\",\n            group_id: Group.first.id,\n            label: \"NP\"\n         } })\n   end\nend\n</code></pre>\n\n<p>The problem with products is that the new product data requires a group_id which must be valid inside the context of the example group, but I have to be able to retrieve the group_id from outside the example group in order to pass it in.</p>\n\n<p>I'm guessing the real answer is to reorganize how the example group is structured, so I'll take a recommendation on how to restructure the shared example group.  Of course, if I'm simply just doing something wrong here, I'll take that answer too.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "aggregation-framework", "mongoid"], "comments": [{"owner": {"reputation": 36192, "user_id": 7510657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/jsd77.jpg?s=128&g=1", "display_name": "Ashh", "link": "https://stackoverflow.com/users/7510657/ashh"}, "edited": false, "score": 2, "creation_date": 1545157082, "post_id": 53824679, "comment_id": 94526035, "body": "If you can update the mongo version to 3.4 then the <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/facet/\" rel=\"nofollow noreferrer\">$facet</a> will help you"}, {"owner": {"reputation": 6399, "user_id": 5800592, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/783606718977/picture?type=large", "display_name": "Wylliam Judd", "link": "https://stackoverflow.com/users/5800592/wylliam-judd"}, "reply_to_user": {"reputation": 36192, "user_id": 7510657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/jsd77.jpg?s=128&g=1", "display_name": "Ashh", "link": "https://stackoverflow.com/users/7510657/ashh"}, "edited": false, "score": 0, "creation_date": 1545161334, "post_id": 53824679, "comment_id": 94527888, "body": "I know :( ...soon hopefully"}], "owner": {"reputation": 6399, "user_id": 5800592, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/783606718977/picture?type=large", "display_name": "Wylliam Judd", "link": "https://stackoverflow.com/users/5800592/wylliam-judd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545091446, "creation_date": 1545091446, "question_id": 53824679, "link": "https://stackoverflow.com/questions/53824679/multiple-consecutive-groups-in-one-query-mongodb", "title": "Multiple consecutive groups in one query Mongodb", "body": "<p>Here is my working code:</p>\n\n<pre><code>age_range = DemographicsData.collection.aggregate([\n  { '$match' =&gt; { video_id: { '$in' =&gt; video_ids }}},\n  { '$unwind' =&gt; '$demographics_labels' },\n  { '$group' =&gt; { _id: '$demographics_labels.age_range', count: { '$sum' =&gt; 1 }}}\n])\ngender = DemographicsData.collection.aggregate([\n  { '$match' =&gt; { video_id: { '$in' =&gt; video_ids }}},\n  { '$unwind' =&gt; '$demographics_labels' },\n  { '$group' =&gt; { _id: '$demographics_labels.gender', count: { '$sum' =&gt; 1 }}}\n])\nethnicity = DemographicsData.collection.aggregate([\n  { '$match' =&gt; { video_id: { '$in' =&gt; video_ids }}},\n  { '$unwind' =&gt; '$demographics_labels' },\n  { '$group' =&gt; { _id: '$demographics_labels.ethnicity', count: { '$sum' =&gt; 1 }}}\n])\n{\n  age: age_range,\n  gender: gender,\n  ethnicity: ethnicity,\n}\n</code></pre>\n\n<p>Is there any way to get the same final result in a single query to the Database?</p>\n\n<p>Mongo v2.4.9</p>\n\n<p>Rails v3.2.8</p>\n\n<p>Ruby v1.9.3</p>\n\n<p>MongoId v3.1.0</p>\n\n<p>Looking forward to upgrading those at some point, but solution would have to take these versions into account.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9938579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hMt9bBtK7CM/AAAAAAAAAAI/AAAAAAAAAAA/2GwKhh_cv1c/photo.jpg?sz=128", "display_name": "Werner Adewole", "link": "https://stackoverflow.com/users/9938579/werner-adewole"}, "edited": false, "score": 0, "creation_date": 1545139511, "post_id": 53824347, "comment_id": 94516070, "body": "Hi Tom, thanks for getting back to me, it works! One slight tweak to add for any one viewing is the matching_agents_email method in the mailer needed an instance variable for submissions to pass Desired_Location through. e.g def matching_agents_email (submission) @submission = submission # followed by the rest of the code above.."}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "reply_to_user": {"reputation": 77, "user_id": 9938579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hMt9bBtK7CM/AAAAAAAAAAI/AAAAAAAAAAA/2GwKhh_cv1c/photo.jpg?sz=128", "display_name": "Werner Adewole", "link": "https://stackoverflow.com/users/9938579/werner-adewole"}, "edited": false, "score": 0, "creation_date": 1545144718, "post_id": 53824347, "comment_id": 94519204, "body": "@WernerAdewole I added the explicit instance variable assignment to avoid any future confusion."}], "tags": [], "owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1545146317, "last_edit_date": 1545146317, "creation_date": 1545088687, "answer_id": 53824347, "question_id": 53824052, "link": "https://stackoverflow.com/questions/53824052/rails-mailer-send-emails-to-recipients-based-on-matching-criteria/53824347#53824347", "title": "Rails Mailer: send emails to recipients based on matching criteria", "body": "<pre><code>respond_to do |format|\n  if @submission.save\n    # Tell the UserMailer to send a welcome email after save\n    NewSubmissionMailer.submission_email(@submission).deliver_now\n\n    # Send emails to matching agents\n    NewSubmissionMailer.matching_agents_email(@submission).deliver_now\n</code></pre>\n\n<p>and then in the mailer <code>::matching_agents_email</code>:</p>\n\n<pre><code>def matching_agents_email(submission) \n  @submission = submission\n  agents = Agent.where(:Company_Business_Location =&gt; @submission.Desired_Location)\n  mail(to: agents.pluck(:email) # ... Rest of email logic. )\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9938579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hMt9bBtK7CM/AAAAAAAAAAI/AAAAAAAAAAA/2GwKhh_cv1c/photo.jpg?sz=128", "display_name": "Werner Adewole", "link": "https://stackoverflow.com/users/9938579/werner-adewole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53824347, "answer_count": 1, "score": 1, "last_activity_date": 1545146317, "creation_date": 1545086548, "last_edit_date": 1545095997, "question_id": 53824052, "link": "https://stackoverflow.com/questions/53824052/rails-mailer-send-emails-to-recipients-based-on-matching-criteria", "title": "Rails Mailer: send emails to recipients based on matching criteria", "body": "<p>I have managed to configure my ActionMailer to send emails to recipients based on a new 'submission'. However, the way my app works is that it takes the submissions 'Desired Location' field and matches it up to the 'Company Business location' field in another model called Agents to give an index view that is matched by location depending on user. i.e if i submit a submission with a location of london, then only agents with a location of london will be able to see it. Which brings me to my emails, is there anyway to create a mailer that works in the same way? So only send emails to agents who match the desired location of the submission?</p>\n\n<p>Mailer</p>\n\n<pre><code>class NewSubmissionMailer &lt; ApplicationMailer\n\n  def submission_email(submission)\n    @submission = submission\n    mail(to: @submission.Email, subject: 'Welcome to Ottom8')\n  end\n\nend\n</code></pre>\n\n<p>Submissions Controller </p>\n\n<pre><code>respond_to do |format|\n  if @submission.save\n\n    # Tell the UserMailer to send a welcome email after save       \n    NewSubmissionMailer.submission_email(@submission).deliver_now\n</code></pre>\n\n<p>Code to match both models</p>\n\n<pre><code>def index\n  @submissions = Submission.where(:Desired_Location =&gt; current_agent.Company_Business_Location)\nend\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545096964, "post_id": 53823972, "comment_id": 94499529, "body": "&quot;&quot;there&#39;s always a chance of 2 specs running in parallel trying to access the same product&quot; Have you encountered this issue? I think parallel rspec uses separate instances of your test code to avoid this issue"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545102715, "post_id": 53823972, "comment_id": 94500541, "body": "Does it matter if 2 specs use the same product at approximately the same time? Why are you deleting the product id&#39;s at all?"}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545121756, "post_id": 53823972, "comment_id": 94506356, "body": "@JayDorsey yes it does matter as some specs modify product state which I reset at the end of the test. If the same product is picked by another spec then the state of it will be unexpected"}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545121830, "post_id": 53823972, "comment_id": 94506390, "body": "@LeninRajRajasekaran I have seen a few failures yes but it&#39;s only my preliminary guess that it&#39;s the reason for it. I will need to five deeper to see what&#39;s going on"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545130955, "post_id": 53823972, "comment_id": 94511470, "body": "@Rahul Can you share more about your setup? Are you using database cleaner/rewinder gems at all? What do you mean by &quot;state&quot;; as stored in the database? It sounds like your specs are heavily reliant on production data moreso than fixture/factory data. Even so, parallel spec should be using a different version of the database for each thread (if you configured it correctly) so there should be no collisions. Coupled with database rewinder/cleaner to reset the database before each run it shouldn&#39;t cause issues. Also, sounds like fixture/factory would be useful, are you using any?"}, {"owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1545142024, "post_id": 53823972, "comment_id": 94517646, "body": "@JayDorsey Thanks. The tests are run against a .Net application and run out of process. Not using any DBs what so ever. All tests do is visit a product page(all I have on me is a list of product IDs imported into the system externally) and add/update data using forms on the page and assert some expectations. The main thing here is we want to run these tests against many different products."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545153838, "post_id": 53823972, "comment_id": 94524441, "body": "@Rahul you might be able to <code>shuffle</code> your product ids&#39; global var when you initialize it so you have a consistent order, rather than sampling, then <code>shift </code> values off and  <code>push</code> them back on with your class. If the array is big enough you shouldn&#39;t run into issues as long as the state is setup across the parallel rspec threads"}], "owner": {"reputation": 251, "user_id": 2390047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dd37035180e1036a1e33c709c8049c9c?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2390047/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545086148, "creation_date": 1545086148, "question_id": 53823972, "link": "https://stackoverflow.com/questions/53823972/accessing-data-from-global-queue-in-rspec", "title": "Accessing data from global queue in Rspec", "body": "<p>I have about a hundred spec files that run in parallel using <code>parallel_rspec</code>. Each spec relies on a Product ID that is needed to run the spec. I want to be able to to run specs for different products each time. How can get the spec to pick a product_id from a queue, use it in the spec and put it back in the queue once done for use in another test?\nExample spec:</p>\n\n<pre><code>describe 'Test 1' do\n let(:product) {Product.new(12345)}\n\n  it 'checks something on the product page' do\n    visit(\"/product/#{product.id}\")\n    # assert some data on the page\n  end\nend\n</code></pre>\n\n<p>I want to build a queue where I can store a few hundred product ids from which each example can pick one when running and put it back in the queue for other examples to use it.</p>\n\n<p>I tried something like</p>\n\n<pre><code>class ProductPicker\n  $product_ids = [1,2,3,4.....100]\n\n  def self.pick\n   product_id = $product_ids.sample\n   $product_ids.delete(product_id)\n  end\nend\n</code></pre>\n\n<p>and then in the spec</p>\n\n<pre><code>let(:product) {ProductPicker.pick)}\n</code></pre>\n\n<p>This works but how can I put the product back in the queue? I need to put it back in queue because in 100 spec files I have 1000+ specs and limited products available. Another issue that there's always a chance of 2 specs running in parallel trying to access the same product from the queue. How do I make it safe for this? Open to an alternate implementation too</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545085441, "post_id": 53823763, "comment_id": 94496544, "body": "Via <code>string.html_safe?</code> maybe?"}, {"owner": {"reputation": 21389, "user_id": 12484, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/08f53f1d60bb079c102eb9738f24888d?s=128&d=identicon&r=PG", "display_name": "Jon Schneider", "link": "https://stackoverflow.com/users/12484/jon-schneider"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545085491, "post_id": 53823763, "comment_id": 94496562, "body": "@Stefan I looked into that, but it appears to be deprecated: <a href=\"https://apidock.com/rails/v2.3.8/String/html_safe%3F\" rel=\"nofollow noreferrer\">apidock.com/rails/v2.3.8/String/html_safe%3F</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545085648, "post_id": 53823763, "comment_id": 94496620, "body": "There&#39;s no deprecation notice and it seems to work just fine."}, {"owner": {"reputation": 21389, "user_id": 12484, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/08f53f1d60bb079c102eb9738f24888d?s=128&d=identicon&r=PG", "display_name": "Jon Schneider", "link": "https://stackoverflow.com/users/12484/jon-schneider"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1545086474, "post_id": 53823763, "comment_id": 94496916, "body": "Ah -- I had seen the deprecation notice on Rails 2.3.8 String.html_safe? at <a href=\"https://apidock.com/rails/String/html_safe%3F\" rel=\"nofollow noreferrer\">apidock.com/rails/String/html_safe%3F</a>, but it looks like it was moved to Object.html_safe? in later versions: <a href=\"https://apidock.com/rails/Object/html_safe%3F\" rel=\"nofollow noreferrer\">apidock.com/rails/Object/html_safe%3F</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21389, "user_id": 12484, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/08f53f1d60bb079c102eb9738f24888d?s=128&d=identicon&r=PG", "display_name": "Jon Schneider", "link": "https://stackoverflow.com/users/12484/jon-schneider"}, "is_accepted": false, "score": 3, "last_activity_date": 1545085290, "last_edit_date": 1545085290, "creation_date": 1545084884, "answer_id": 53823764, "question_id": 53823763, "link": "https://stackoverflow.com/questions/53823763/given-a-string-determine-whether-it-is-from-an-html-safe-call/53823764#53823764", "title": "Given a string, determine whether it is from an .html_safe call?", "body": "<p><code>.html_safe</code> actually returns not an object of type <a href=\"https://ruby-doc.org/core-2.4.0/String.html\" rel=\"nofollow noreferrer\">String</a>, but an object of type <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/SafeBuffer.html\" rel=\"nofollow noreferrer\">ActiveSupport::SafeBuffer</a> (which is a derived class of String).</p>\n\n<p>Therefore, calling:</p>\n\n<p><code>my_string.is_a?(ActiveSupport::SafeBuffer)</code> </p>\n\n<p>will return <code>false</code> only when the string is <em>not</em> the result of a call to  <code>.html_string</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1545121896, "last_edit_date": 1545121896, "creation_date": 1545086008, "answer_id": 53823955, "question_id": 53823763, "link": "https://stackoverflow.com/questions/53823763/given-a-string-determine-whether-it-is-from-an-html-safe-call/53823955#53823955", "title": "Given a string, determine whether it is from an .html_safe call?", "body": "<p>There's <code>html_safe?</code>:</p>\n\n<pre><code>s = 'foo'\ns.html_safe? #=&gt; false\n\ns = 'foo'.html_safe\ns.html_safe? #=&gt; true\n</code></pre>\n\n<p>Note that an <code>ActiveSupport::SafeBuffer</code> reverts to unsafe if you call a \"destructive\" method:</p>\n\n<pre><code>s = 'foo'.html_safe\ns.html_safe?  #=&gt; true\ns.capitalize! #=&gt; 'Foo'\ns.html_safe?  #=&gt; false\n</code></pre>\n"}], "owner": {"reputation": 21389, "user_id": 12484, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/08f53f1d60bb079c102eb9738f24888d?s=128&d=identicon&r=PG", "display_name": "Jon Schneider", "link": "https://stackoverflow.com/users/12484/jon-schneider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53823955, "answer_count": 2, "score": 4, "last_activity_date": 1545121896, "creation_date": 1545084884, "question_id": 53823763, "link": "https://stackoverflow.com/questions/53823763/given-a-string-determine-whether-it-is-from-an-html-safe-call", "title": "Given a string, determine whether it is from an .html_safe call?", "body": "<p>In Ruby on Rails, given a string, is it possible to determine whether <a href=\"https://apidock.com/rails/String/html_safe\" rel=\"nofollow noreferrer\">.html_safe</a> has been called on that string?</p>\n\n<p>Reason for asking: I'd like to write a controller unit test that verifies that html_safe has <em>not</em> been called on a particular string, in order to prove that when that string later gets rendered onto a page in a view, Rails will escape the string (avoiding possible XSS vulnerabilities).</p>\n\n<p>I realize that I could instead go ahead and actually render the page in my test, and then inspect the rendered page body, but I'm wondering if there's a more direct way of doing this?</p>\n"}, {"tags": ["ruby", "select", "syntax"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545084683, "post_id": 53823673, "comment_id": 94496242, "body": "You get <i>&quot;undefined method &#39;array&#39;&quot;</i> because of <code>array(...)</code> \u2013 that attempts to call a method named &quot;array&quot; (which doesn&#39;t exist). Maybe you wanted <code>array[...]</code>?"}, {"owner": {"reputation": 47, "user_id": 10218863, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PunnnVm7ygk/AAAAAAAAAAI/AAAAAAAANsQ/9zJwC0klBJA/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10218863/scott"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545084885, "post_id": 53823673, "comment_id": 94496327, "body": "oh my gosh embarrassing! haha thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1493, "user_id": 2236470, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/J8hqM.jpg?s=128&g=1", "display_name": "Paul Byrne", "link": "https://stackoverflow.com/users/2236470/paul-byrne"}, "is_accepted": false, "score": 2, "last_activity_date": 1545084817, "creation_date": 1545084817, "answer_id": 53823745, "question_id": 53823673, "link": "https://stackoverflow.com/questions/53823673/select-undefined-method-for-mainobject-nomethoderror-ruby/53823745#53823745", "title": ".select undefined method for main:Object (NoMethodError) Ruby", "body": "<p>You could do this instead.\n<code>\narray.map(&amp;:squeeze)\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 10218863, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PunnnVm7ygk/AAAAAAAAAAI/AAAAAAAANsQ/9zJwC0klBJA/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10218863/scott"}, "edited": false, "score": 0, "creation_date": 1545085227, "post_id": 53823781, "comment_id": 94496456, "body": "Very very helpful. Worked like a charm. Thanks."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": true, "score": 1, "last_activity_date": 1545085276, "last_edit_date": 1545085276, "creation_date": 1545084991, "answer_id": 53823781, "question_id": 53823673, "link": "https://stackoverflow.com/questions/53823673/select-undefined-method-for-mainobject-nomethoderror-ruby/53823781#53823781", "title": ".select undefined method for main:Object (NoMethodError) Ruby", "body": "<p>To get rid of the error just replace <code>array(array.index(value) + 1)</code> with <code>array[array.index(value) + 1]</code>.</p>\n\n<p>However the solution will still be incorrect. The method <code>index</code> of an array returns the index of the <strong>first</strong> object in <code>array</code> such that the object is == to <code>value</code>. In case of duplicate elements in <code>array</code> there will be an error.</p>\n\n<p>I'd recommend rewriting your method as</p>\n\n<pre><code>def remove_double_spaces(array)\n  array.join.squeeze(' ').split('')\nend\n\nremove_double_spaces([\" \", \" \", \" \", \"w\", \"h\", \"a\", \"t\", \" \", \"s\", \" \", \"m\", \"y\", \" \", \" \", \" \", \" \", \" \", \"l\", \"i\", \"n\", \"e\", \" \"])\n# =&gt; [\" \", \"w\", \"h\", \"a\", \"t\", \" \", \"s\", \" \", \"m\", \"y\", \" \", \"l\", \"i\", \"n\", \"e\", \" \"] \n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10218863, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PunnnVm7ygk/AAAAAAAAAAI/AAAAAAAANsQ/9zJwC0klBJA/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10218863/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "accepted_answer_id": 53823781, "answer_count": 2, "score": 0, "last_activity_date": 1545085276, "creation_date": 1545084431, "last_edit_date": 1545084718, "question_id": 53823673, "link": "https://stackoverflow.com/questions/53823673/select-undefined-method-for-mainobject-nomethoderror-ruby", "title": ".select undefined method for main:Object (NoMethodError) Ruby", "body": "<p>Trying to create a method to remove single space elements from an array if there's a single space element next to it (no double spaces). When I run the below I get this error:</p>\n\n<p>ex5.rb:5:in <code>block in remove_double_spaces': undefined method</code>array' for main:Object (NoMethodError)\nDid you mean?  Array</p>\n\n<p>I'm guessing this is a variable scope issue? How can I call the array itself within the select method?</p>\n\n<p>My logic attempted below (select all elements of the array unless it's a blank element and the next element is also a blank).</p>\n\n<pre><code>def remove_double_spaces(array)\n  # p array.index('w') works fine here.\n  array.select { |value| value unless (value == ' ') &amp;&amp; (array(array.index(value) + 1) != ' ') }\nend\n\nremove_double_spaces([\" \", \" \", \" \", \"w\", \"h\", \"a\", \"t\", \" \", \"s\", \" \", \"m\", \"y\", \" \", \" \", \" \", \" \", \" \", \"l\", \"i\", \"n\", \"e\", \" \"])\n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "edited": false, "score": 0, "creation_date": 1545077051, "post_id": 53822257, "comment_id": 94493140, "body": "Can you show the code that you&#39;re trying to populate the table with? Is it using a form?"}, {"owner": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "reply_to_user": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "edited": false, "score": 0, "creation_date": 1545132135, "post_id": 53822257, "comment_id": 94512122, "body": "@AlecSanger if you could now check nileshkumar&#39;s answer, I believe it answers your question."}], "answers": [{"tags": [], "owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1545078284, "creation_date": 1545078284, "answer_id": 53822494, "question_id": 53822257, "link": "https://stackoverflow.com/questions/53822257/users-and-teams-many-to-many-relationships-ruby/53822494#53822494", "title": "Users and teams - Many to many relationships Ruby", "body": "<p><code>User.in_batches.each_record { |user| UserTeam.create(user: user, team_id: user.team_id) }</code></p>\n\n<p>You are going to need to populate the new <code>UserTeam</code> table after the migration is completed. You can either do this in the migration itself or via console or a rake task.</p>\n\n<p>After you have populated the UserTeam table you will want to drop the <code>users.team_id</code> column.</p>\n\n<p>I would also add <code>index: true</code> to both id columns of UserTeam.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "edited": false, "score": 0, "creation_date": 1545131689, "post_id": 53826032, "comment_id": 94511884, "body": "Yes this seems legit. But now I can&#39;t access methods declared in team.rb. There I have a method called members_and_invites. And I want to access this method in views/overviews/team_members.html.erb , where I have:  &lt;% current_user.teams.members_and_invites.each do |user| %&gt; And it gives me: undefined method `members_and_invites&#39; for #&lt;ActiveRecord::Associations::CollectionProxy []&gt;  How can I make members_and_invites method available there?"}, {"owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "reply_to_user": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "edited": false, "score": 0, "creation_date": 1545140769, "post_id": 53826032, "comment_id": 94516885, "body": "<code>current_user.teams</code> will return a array of teams, how you can call <code>members_and_invites</code> instance method on the teams  array? You need to iterate user&#39;s teams array to access the method <code>members_and_invites</code>"}, {"owner": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "edited": false, "score": 0, "creation_date": 1545150333, "post_id": 53826032, "comment_id": 94522464, "body": "Your initial answer solved my problem. Now I have other problems but i&#39;ll post another questions if I can&#39;t find the answer. Thank you very much!"}], "tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": true, "score": 1, "last_activity_date": 1545104216, "creation_date": 1545104216, "answer_id": 53826032, "question_id": 53822257, "link": "https://stackoverflow.com/questions/53822257/users-and-teams-many-to-many-relationships-ruby/53826032#53826032", "title": "Users and teams - Many to many relationships Ruby", "body": "<p>Make sure your User_Teams table should have <code>user_id</code> and <code>team_id</code> columns. </p>\n\n<p>if you have <code>@user</code> object with you, then</p>\n\n<pre><code>@user.teams &lt;&lt; Team.find(some_team_id)\n</code></pre>\n\n<p>This piece of code will automatically create a new row in the User_Teams table with the right <code>team_id</code> and <code>user_id</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 10802925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ef271f0f672baa074d33b451a54999?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/10802925/paulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53826032, "answer_count": 2, "score": 0, "last_activity_date": 1545104216, "creation_date": 1545076943, "question_id": 53822257, "link": "https://stackoverflow.com/questions/53822257/users-and-teams-many-to-many-relationships-ruby", "title": "Users and teams - Many to many relationships Ruby", "body": "<p>I have a users table and a teams table.\nRight now users can only have one team, there's a column in users.team_id.\nBut now I want to make it possible for users to have multiple teams.\nSo I already created a user_teams table with user_id and team_id.</p>\n\n<p>I ran migrations like so:</p>\n\n<blockquote>\n  <p>migrations/create_users_teams</p>\n</blockquote>\n\n<pre><code>class CreateUsersTeams &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :user_teams do |t|\n      t.belongs_to :user, foreign_key: true, null: false\n      t.references :team, foreign_key: true, null: false\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>And my code is as follows: </p>\n\n<blockquote>\n  <p>models/user.rb</p>\n</blockquote>\n\n<pre><code>    class User &lt; ApplicationRecord\n\n    #belongs_to :team\n\n    # should now have multiple teams\n    has_many :user_teams\n    has_many :teams, through: :user_teams\n</code></pre>\n\n<blockquote>\n  <p>models/team.rb</p>\n</blockquote>\n\n<pre><code>class Team &lt; ApplicationRecord\n\nhas_many :user_teams\nhas_many :users, through: :user_teams\n</code></pre>\n\n<blockquote>\n  <p>models/user_teams.rb   (new file)</p>\n</blockquote>\n\n<pre><code>class UserTeam &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :team\nend\n</code></pre>\n\n<p>From the tutorials I watched that was all I needed to do, but I'm not populating the table. What am I missing here?</p>\n"}, {"tags": ["ruby", "facebook-graph-api", "httprequest"], "comments": [{"owner": {"reputation": 3136, "user_id": 10283047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d3424d98c68472d196cb5534c3f417?s=128&d=identicon&r=PG&f=1", "display_name": "misorude", "link": "https://stackoverflow.com/users/10283047/misorude"}, "edited": false, "score": 0, "creation_date": 1545125629, "post_id": 53821471, "comment_id": 94508330, "body": "Not sure if using arbitrary sample files to test this is a good idea; maybe it was rejected because the time stamps in the file are greater than the actual length of the video, or something like that. Test this with a subtitle file that \u201cbelongs\u201d to the video."}], "owner": {"reputation": 101, "user_id": 4233016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bLnFfKykoCY/AAAAAAAAAAI/AAAAAAAAADQ/m8P7OnLnVq4/photo.jpg?sz=128", "display_name": "Anto Joy", "link": "https://stackoverflow.com/users/4233016/anto-joy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545073421, "creation_date": 1545073100, "last_edit_date": 1545073421, "question_id": 53821471, "link": "https://stackoverflow.com/questions/53821471/facebook-uploading-captions-for-video-via-graph-api-not-working", "title": "Facebook uploading captions for video via Graph API not working", "body": "<p>I am trying to add captions (.srt file) to my video via the graph api but I am getting the following response from Facebook</p>\n\n<pre><code>{\"error\"=&gt;{\"message\"=&gt;\"(#385) The captions file you selected is in a format that we don't support.\", \"type\"=&gt;\"OAuthException\", \"code\"=&gt;385, \"error_user_msg\"=&gt;\"The captions file you selected is in a format that we don't support.\", \"fbtrace_id\"=&gt;\"HIxy-mhlpHo\"}}\n</code></pre>\n\n<p>Below is the code I used to upload the captions in ruby</p>\n\n<pre><code>subtitle_stream = open(subtitle_url)\nsubtitle_file = File.open('subtitle.en_US.srt', 'w+b') do |file|\n      subtitle_stream.respond_to?(:read) ? IO.copy_stream(subtitle_stream, file) : file.write(subtitle_stream)\n      open(file)\n  end\nsubtitle_file_obj = UploadIO.new(\n              subtitle_file,\n              'application/octet-stream',\n              'subtitle.en_US.srt'\n            )\nurl = \"https://graph.facebook.com/v3.2/3344xxxxx/captions\"\nuri = URI.parse(url)\n  http = Net::HTTP.new(uri.host, uri.port)\n  http.use_ssl = true\n  upload_request = Net::HTTP::Post::Multipart.new uri.request_uri, {\n              'access_token' =&gt; access_token,\n              'captions_file'   =&gt; subtitle_file_obj,\n            }\n  upload_response = http.request(upload_request)\n</code></pre>\n\n<p>I have used a sample srt file from the following link for testing</p>\n\n<pre><code>https://fastapi.metacpan.org/source/MIYAGAWA/Video-Subtitle-SRT-0.01/t/sample.srt\n</code></pre>\n"}, {"tags": ["ruby", "macos"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1545078551, "post_id": 53821403, "comment_id": 94493769, "body": "Reinstalling the OS seems like the obvious answer. Why don&#39;t you want to do that? Alternatively, assuming you have backup, restore it to the way it was right before you made the changes you want to undo. I don&#39;t see you have much choice."}, {"owner": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545082116, "post_id": 53821403, "comment_id": 94495172, "body": "I guess it didn&#39;t seem obvious to me, which is why I asked. But if there&#39;s no way to just reset ruby etc. then I suppose I have to. Thanks for the comment."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1586202008, "post_id": 53821403, "comment_id": 108037231, "body": "This isn&#39;t asked well. You&#39;re asking us to imagine every possible thing you could have done without telling us anything useful. Apple installs the system Ruby for their own use; It&#39;s ok to run scripts against it but modifying it can break processes Apple installed. Instead, ALWAYS use a sandbox manager like rbenv, RVM or asdf to install a separate, user-modifiable Ruby. And, don&#39;t ever use <code>sudo</code> until you know exactly what it does and what the command is going to do; <code>sudo</code> is like a surgeon&#39;s scalpel and capable of major damage in the wrong hands, especially when working with system files."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "edited": false, "score": 2, "creation_date": 1545077434, "post_id": 53821768, "comment_id": 94493290, "body": "As I mentioned above, I&#39;ve already uninstalled RVM. That&#39;s not my problem\u2014I&#39;d like to completely reset ruby and everything related to it to the way it would be &quot;out of the box.&quot; RVM is long gone, but a bunch of other subtle things are out of whack."}, {"owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 1, "creation_date": 1545078158, "post_id": 53821768, "comment_id": 94493602, "body": "What @anothermh suggested will work fine. What &quot;subtle&quot; things concern you?"}, {"owner": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "edited": false, "score": 0, "creation_date": 1545078456, "post_id": 53821768, "comment_id": 94493719, "body": "I already did those things, I&#39;m not sure how they help when RVM was already uninstalled that way. I&#39;ve encountered a circle of problems and errors with paths, permission, bundler, etc. I spent several hours reading overflow threads and trying things in terminal, and I&#39;m confident that there isn&#39;t a simple solution. That&#39;s why I was hoping for help with the above question."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "edited": false, "score": 0, "creation_date": 1545084485, "post_id": 53821768, "comment_id": 94496179, "body": "@Forrest Then perhaps you should explain your problem better, because your question says you were having trouble with RVM, Ruby, and Rails, and since RVM does not write outside of ~/.rvm, the ONLY thing you need to do is delete it. If you\u2019re having a problem with <b>system Ruby</b> then <b>be specific</b>. <i>messed up</i> is <b>not specific</b>."}, {"owner": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "edited": false, "score": 0, "creation_date": 1545086519, "post_id": 53821768, "comment_id": 94496935, "body": "I explained that I had already uninstalled RVM and that I wanted to know how to remove Ruby and any related software from my system in order to reinstall it with default settings. I didn&#39;t say that RVM was the sole cause of my problems. That was very clear, but I hadn&#39;t anticipated the extent to which people would think I was mistaken and want me to have asked different questions. Apologies."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545087071, "post_id": 53821768, "comment_id": 94497112, "body": "The level of detail in your question led me to believe that you probably did not know how to properly remove RVM, since you said you removed it but were still having trouble with Ruby and Rails (which is a series of gems, again indicating no expertise with the matter). On Stackoverflow you need to <b>be specific</b> about the problems you&#39;re having. The words <i>messed up</i>, <i>misadventures</i>, <i>out of whack</i>, <i>bewildered</i> are <b>totally meaningless</b>. Saying <i>the problem gets worse</i> but then not describing the problem means no one can help you until you help yourself."}, {"owner": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "edited": false, "score": 1, "creation_date": 1545088072, "post_id": 53821768, "comment_id": 94497495, "body": "I was *specific*\u2014I asked this question: &quot;I want to start fresh without having to reset my computer to factory settings. How can I reset just the ruby-related things (ruby, rails, etc.) without erasing my computer?&quot; What I got was condescension, antagonism, and some pretty obvious confusion about the nature of language&#39;s relationship to meaning."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545089121, "post_id": 53821768, "comment_id": 94497837, "body": "At this point, all I can recommend is that you read <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a> and perhaps <a href=\"https://stackoverflow.com/tour\">take the tour</a>. I have been trying to help you for hours now. I&#39;m not sure there&#39;s anything more I can do to help if you&#39;re unwilling to provide useful information about the problem."}, {"owner": {"reputation": 339, "user_id": 5175885, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10155841049520371/picture?type=large", "display_name": "Corey Holmes", "link": "https://stackoverflow.com/users/5175885/corey-holmes"}, "edited": false, "score": 0, "creation_date": 1570676918, "post_id": 53821768, "comment_id": 102990282, "body": "which ruby returns /Users/coreyholmes/.rbenv/shims/ruby which I&#39;m not sure how to reset/fix. Any ideas?"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545074555, "creation_date": 1545074555, "answer_id": 53821768, "question_id": 53821403, "link": "https://stackoverflow.com/questions/53821403/how-to-reset-anything-related-to-ruby-to-factory-settings-on-mac-os-high-sierra/53821768#53821768", "title": "How to reset anything related to Ruby to factory settings on Mac OS High Sierra", "body": "<p><code>rm -rf ~/.rvm</code>, then edit <code>~/.bash_profile</code> to remove <code>source $HOME/.rvm/scripts/rvm</code>.</p>\n\n<p>Then you can restart with RVM from scratch by following the detailed installation instructions at <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">https://rvm.io/rvm/install</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1586201658, "post_id": 53824663, "comment_id": 108037057, "body": "macOS Catalina has very different permission limitations so I suspect this won&#39;t work."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1586207572, "post_id": 53824663, "comment_id": 108039571, "body": "The OP specified macOS High Sierra in the original question. I haven&#39;t had to do this on macOS Catalina yet but you&#39;re right, the steps (and paths) are likely not exactly the same (but should be similar)"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1586209978, "post_id": 53824663, "comment_id": 108040486, "body": "Catalina has had major changes to protect the system files. I won&#39;t even mess around with it anymore; It&#39;s not worth the effort when we have so many other ways of adding our development systems now."}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 10, "last_activity_date": 1545091291, "creation_date": 1545091291, "answer_id": 53824663, "question_id": 53821403, "link": "https://stackoverflow.com/questions/53821403/how-to-reset-anything-related-to-ruby-to-factory-settings-on-mac-os-high-sierra/53824663#53824663", "title": "How to reset anything related to Ruby to factory settings on Mac OS High Sierra", "body": "<p>I would close &amp; reopen your terminal window before you start all of this to make sure you don't have any old env vars loaded.</p>\n\n<p>General things:</p>\n\n<ul>\n<li>Run <code>env | grep RUBY</code>, <code>env | grep RVM</code> and look for any leftover environment variables that you may have set</li>\n<li>Same for <code>env | grep GEM</code>. Sometimes you'll see <code>GEM_PATH</code>, <code>GEM_HOME</code>, etc. but these aren't necessary for system ruby</li>\n<li>Peek inside your <code>~/.bash_profile</code>, <code>~/.bashrc</code>, and <code>~/.profile</code> files and see if you've added any rvm stuff</li>\n</ul>\n\n<p>If you're running macOS Mojave (I'm comparing against my system):</p>\n\n<p><code>which ruby</code> should return <code>/usr/bin/ruby</code>. If it doesn't, you have something else interfering. Post what that is and we can get it fixed.</p>\n\n<p>Running <code>/usr/bin/ruby --version</code> should return <code>ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]</code></p>\n\n<p>Permissions for system ruby:</p>\n\n<pre><code>-r-xr-xr-x  1 root  wheel  52016 Nov 30 02:38 /usr/bin/ruby\n</code></pre>\n\n<p>This should be something like <code>sudo chmod 555 /usr/bin/ruby</code> to fix this if yours is difference. If you have different owners you'll need to <code>sudo chown root:wheel /usr/bin/ruby</code></p>\n\n<p>You'll also want to check <code>which gem</code>, and see if it reports <code>/usr/bin/gem</code>. Permissions should be the same as <code>/usr/bin/ruby</code>. <code>/usr/bin/gem --version</code> should return <code>2.5.2.3</code></p>\n\n<p>Running <code>/usr/bin/gem env</code> should return something similar-ish to below. Replace <code>jay</code> (my computer user) with yours</p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.5.2.3\n  - RUBY VERSION: 2.3.7 (2018-03-28 patchlevel 456) [universal.x86_64-darwin18]\n  - INSTALLATION DIRECTORY: /Library/Ruby/Gems/2.3.0\n  - USER INSTALLATION DIRECTORY: /Users/jay/.gem/ruby/2.3.0 # this doesn't matter much\n  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby\n  - EXECUTABLE DIRECTORY: /usr/local/bin\n  - SPEC CACHE DIRECTORY: /Users/jay/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Library/Ruby/Site\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - universal-darwin-18\n  - GEM PATHS:\n     - /Library/Ruby/Gems/2.3.0\n     - /Users/jay/.gem/ruby/2.3.0\n     - /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/gems/2.3.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; false\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - :sources =&gt; [\"https://rubygems.org/\"]\n     - \"benchmark\" =&gt; true\n     - \"gem\" =&gt; \"--document=yri\"\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /usr/local/bin\n     - /Users/jay/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n     - /opt/X11/bin\n</code></pre>\n\n<p>From there you've got two directories you probably want to look at:</p>\n\n<p>Run <code>ls -al /Library/Ruby/</code>. You should see this:</p>\n\n<pre><code>drwxr-xr-x   3 root  wheel    96 Aug 17 18:59 Gems\ndrwxr-xr-x   3 root  wheel    96 Aug 17 18:59 Site\n</code></pre>\n\n<p>You may need to chmod/chown each of those directories (with <code>-R</code> for recursive)</p>\n\n<p>When you're done, please note that running <code>/usr/bin/gem install bundler</code> and <code>gem install bundler</code> (assuming you haven't installed a new ruby version manager) should yield an error as below (this means you re-configured the permissions correctly).</p>\n\n<pre><code>Fetching: bundler-1.17.2.gem (100%)\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory.\n</code></pre>\n\n<p>You'll see some tutorials mention changing those permissions, or running sudo to install gems but I don't recommend that. My favorite ruby version manager is <a href=\"https://github.com/asdf-vm/asdf\" rel=\"noreferrer\">asdf</a> which may be worth a look. You'll install the core, and the <a href=\"https://github.com/asdf-vm/asdf-ruby\" rel=\"noreferrer\">ruby plugin</a>.</p>\n\n<p>This should get you a little bit closer. If you see anything else messed up, please post the error.</p>\n"}], "owner": {"reputation": 91, "user_id": 601973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58b47188191e42df04163a58316a5a7?s=128&d=identicon&r=PG", "display_name": "Forrest", "link": "https://stackoverflow.com/users/601973/forrest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3009, "favorite_count": 0, "accepted_answer_id": 53824663, "answer_count": 2, "score": 4, "last_activity_date": 1586200157, "creation_date": 1545072786, "last_edit_date": 1586200157, "question_id": 53821403, "link": "https://stackoverflow.com/questions/53821403/how-to-reset-anything-related-to-ruby-to-factory-settings-on-mac-os-high-sierra", "title": "How to reset anything related to Ruby to factory settings on Mac OS High Sierra", "body": "<p>After a number of misadventures involving RVM, Ruby and Rails on my new laptop have left me completely bewildered. I uninstalled RVM but all the paths, versions and permissions are all messed up.</p>\n\n<p>I searched and couldn't find the right fixes. It feels like each solution makes the problem get worse.</p>\n\n<p>I want to start fresh without having to reset my computer to factory settings. How can I reset just the Ruby-related things like Ruby, Rails, etc., without erasing my computer?</p>\n"}, {"tags": ["ruby", "rubygems", "fastlane"], "comments": [{"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545070882, "post_id": 53820475, "comment_id": 94490428, "body": "Did you open Xcode and accept the license? It&#39;s a one time thing that needs to be done on new installs."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545074745, "post_id": 53820475, "comment_id": 94492182, "body": "How did you install Ruby? If the answer is either \u201cI didn\u2019t, I\u2019m using system Ruby\u201d or \u201cI used brew\u201d then you\u2019re doing it wrong. Use <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">RVM</a>."}, {"owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "reply_to_user": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545079299, "post_id": 53820475, "comment_id": 94494053, "body": "@Tom Yes, license accepted via command line sudo xcodebuild - license"}, {"owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545079332, "post_id": 53820475, "comment_id": 94494066, "body": "@anothermh using brew. Will look into RVM"}, {"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545079871, "post_id": 53820475, "comment_id": 94494309, "body": "Another thought: The first gem is failing on nokogiri.  I&#39;ve had success running brew install libiconv and brew install libyaml to fix nokogiri problems."}, {"owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1545080385, "post_id": 53820475, "comment_id": 94494527, "body": "@anothermh using brew. Will look into RVM... hmm, when trying to install RVM I am getting a similar error message, install does not finish. This is the relevant part I think: compiling dln_find.c In file included from dln_find.c:37: In file included from /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.&zwnj;&#8203;platform/Developer/S&zwnj;&#8203;DKs/MacOSX10.14.sdk/&zwnj;&#8203;usr/include/strings.&zwnj;&#8203;h:92: /usr/local/include/string.h:25:10: fatal error: &#39;plist/Node.h&#39; file not found #include &lt;plist/Node.h&gt;          ^~~~~~~~~~~~~~ 1 error generated."}, {"owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "edited": false, "score": 0, "creation_date": 1545080944, "post_id": 53820475, "comment_id": 94494752, "body": "Weird, in /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.&zwnj;&#8203;platform/Developer/S&zwnj;&#8203;DKs/MacOSX10.14.sdk/&zwnj;&#8203;usr/include/strings.&zwnj;&#8203;h:92 the following is written: #include &lt;string.h&gt; There is a file string.h in the same folder but it seems that somehow the file String.h (with capital S) in folder /usr/local/include/ is referenced. In that file, line 25 states #include &lt;plist/Node.h&gt; which cannot be found."}, {"owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "edited": false, "score": 0, "creation_date": 1545081327, "post_id": 53820475, "comment_id": 94494881, "body": "I think I fixed it by deleting file String.h in /usr/local/include/ folder. The same is written in this SO question: <a href=\"https://stackoverflow.com/questions/49314732/gem-install-libxml-ruby-fatal-error-plist-node-h-file-not-found\" title=\"gem install libxml ruby fatal error plist node h file not found\">stackoverflow.com/questions/49314732/&hellip;</a>  However, I just deleted one file, not all the ones that were shown by brew doctor"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1545091601, "post_id": 53820475, "comment_id": 94498426, "body": "Did you <code>brew install gcc</code> as well? that seems to be another dependency."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "is_accepted": false, "score": 2, "last_activity_date": 1545234996, "creation_date": 1545234996, "answer_id": 53854888, "question_id": 53820475, "link": "https://stackoverflow.com/questions/53820475/error-installing-gems-after-transferring-all-data-to-a-new-mac-error-failed-to/53854888#53854888", "title": "Error installing gems after transferring all data to a new mac: ERROR: Failed to build gem native extension", "body": "<p>I think I fixed it by deleting file String.h in /usr/local/include/ folder. The same is written in this SO question: <a href=\"https://stackoverflow.com/questions/49314732/gem-install-libxml-ruby-fatal-error-plist-node-h-file-not-found\">gem install libxml-ruby: fatal error: &#39;plist/Node.h&#39; file not found</a></p>\n\n<p>Command <code>brew doctor</code> told me that there are lots of files in /usr/local/include/ folder that might be deleted. I deleted file String.h and left all other files in place. This fixed it.</p>\n\n<p>Thanks for everyone commenting and trying to help.</p>\n"}], "owner": {"reputation": 51, "user_id": 3246803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c46f9b72453e757b7d64188cf5d4d02?s=128&d=identicon&r=PG&f=1", "display_name": "leschirmeur", "link": "https://stackoverflow.com/users/3246803/leschirmeur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1545234996, "creation_date": 1545068597, "question_id": 53820475, "link": "https://stackoverflow.com/questions/53820475/error-installing-gems-after-transferring-all-data-to-a-new-mac-error-failed-to", "title": "Error installing gems after transferring all data to a new mac: ERROR: Failed to build gem native extension", "body": "<p>After setting up a new mac and transferring data from my old one, some gems won't install and I am getting error messages such as the following when trying to install spidr:</p>\n\n<pre><code>$ sudo gem install spidr\nPassword:\nFetching: mini_portile2-2.4.0.gem (100%)\nSuccessfully installed mini_portile2-2.4.0\nFetching: nokogiri-1.9.0.gem (100%)\nBuilding native extensions. This could take a while...\nERROR:  Error installing spidr:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /usr/local/lib/ruby/gems/2.5.0/gems/nokogiri-1.9.0/ext/nokogiri\n/usr/local/opt/ruby/bin/ruby -r ./siteconf20181217-24587-ul93i2.rb extconf.rb\nchecking if the C compiler accepts ... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/local/Cellar/ruby/2.5.3_1/bin/$(RUBY_BASE_NAME)\n    --help\n    --clean\n/usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:574:in `block in try_compile'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:521:in `with_werror'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:574:in `try_compile'\n    from extconf.rb:138:in `nokogiri_try_compile'\n    from extconf.rb:162:in `block in add_cflags'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:632:in `with_cflags'\n    from extconf.rb:161:in `add_cflags'\n    from extconf.rb:412:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /usr/local/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-18/2.5.0/nokogiri-1.9.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /usr/local/lib/ruby/gems/2.5.0/gems/nokogiri-1.9.0 for inspection.\nResults logged to /usr/local/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-18/2.5.0/nokogiri-1.9.0/gem_make.out\n</code></pre>\n\n<p>I am also attaching the contents of the referenced mkmf.log file below:</p>\n\n<pre><code>\"clang -o conftest -I/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/x86_64-darwin18 -I/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/backward -I/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0 -I.  -I/usr/local/opt/libyaml/include -I/usr/local/opt/openssl/include -I/usr/local/opt/readline/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE -D_DARWIN_UNLIMITED_SELECT -D_REENTRANT   -O3 -ggdb3 -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Wno-tautological-compare -Wno-parentheses-equality -Wno-constant-logical-operand -Wno-self-assign -Wunused-variable -Wimplicit-int -Wpointer-arith -Wwrite-strings -Wdeclaration-after-statement -Wshorten-64-to-32 -Wimplicit-function-declaration -Wdivision-by-zero -Wdeprecated-declarations -Wextra-tokens  -fno-common -pipe  conftest.c  -L. -L/usr/local/Cellar/ruby/2.5.3_1/lib -L/usr/local/opt/libyaml/lib -L/usr/local/opt/openssl/lib -L/usr/local/opt/readline/lib -L. -fstack-protector -L/usr/local/lib -L/usr/local/opt/libyaml/lib -L/usr/local/opt/openssl/lib -L/usr/local/opt/readline/lib     -lruby.2.5.3  -lpthread -ldl -lobjc  \"\nIn file included from conftest.c:1:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby.h:33:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/ruby.h:29:\n/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/defines.h:131:11: warning: non-portable path to file '&lt;String.h&gt;'; specified path differs in case from file name on disk [-Wnonportable-include-path]\n# include &lt;string.h&gt;\n      ^~~~~~~~~~\n      &lt;String.h&gt;\nIn file included from conftest.c:1:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby.h:33:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/ruby.h:29:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/defines.h:131:\n/usr/local/include/string.h:25:10: fatal error: 'plist/Node.h' file not found\n#include &lt;plist/Node.h&gt;\n     ^~~~~~~~~~~~~~\n1 warning and 1 error generated.\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: int main(int argc, char **argv)\n4: {\n5:   return 0;\n6: }\n/* end */\n</code></pre>\n\n<p>I have done research for quite some hours now and don't know what to do anymore. I am attaching another similar error when trying to install another gem, fastlane:</p>\n\n<pre><code>$ sudo gem install fastlane\nPassword:\nBuilding native extensions. This could take a while...\nERROR:  Error installing fastlane:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /usr/local/lib/ruby/gems/2.5.0/gems/unf_ext-0.0.7.5/ext/unf_ext\n/usr/local/opt/ruby/bin/ruby -r ./siteconf20181217-24788-1jgurro.rb extconf.rb\nchecking for -lstdc++... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/local/Cellar/ruby/2.5.3_1/bin/$(RUBY_BASE_NAME)\n    --with-static-libstdc++\n    --without-static-libstdc++\n    --with-stdc++lib\n    --without-stdc++lib\n/usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:541:in `try_link0'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:559:in `try_link'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:778:in `try_func'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:1005:in `block in have_library'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:948:in `block in checking_for'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:350:in `block (2 levels) in postpone'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:320:in `open'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:350:in `block in postpone'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:320:in `open'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:346:in `postpone'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:947:in `checking_for'\n    from /usr/local/Cellar/ruby/2.5.3_1/lib/ruby/2.5.0/mkmf.rb:1000:in `have_library'\n    from extconf.rb:6:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /usr/local/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-18/2.5.0/unf_ext-0.0.7.5/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /usr/local/lib/ruby/gems/2.5.0/gems/unf_ext-0.0.7.5 for inspection.\nResults logged to /usr/local/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-18/2.5.0/unf_ext-0.0.7.5/gem_make.out\n</code></pre>\n\n<p>The corresponding mkmf.log contents:</p>\n\n<pre><code>\"clang -o conftest -I/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/x86_64-darwin18 -I/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/backward -I/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0 -I.  -I/usr/local/opt/libyaml/include -I/usr/local/opt/openssl/include -I/usr/local/opt/readline/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE -D_DARWIN_UNLIMITED_SELECT -D_REENTRANT   -O3 -ggdb3 -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Wno-tautological-compare -Wno-parentheses-equality -Wno-constant-logical-operand -Wno-self-assign -Wunused-variable -Wimplicit-int -Wpointer-arith -Wwrite-strings -Wdeclaration-after-statement -Wshorten-64-to-32 -Wimplicit-function-declaration -Wdivision-by-zero -Wdeprecated-declarations -Wextra-tokens  -fno-common -pipe conftest.c  -L. -L/usr/local/Cellar/ruby/2.5.3_1/lib -L/usr/local/opt/libyaml/lib -L/usr/local/opt/openssl/lib -L/usr/local/opt/readline/lib -L. -fstack-protector -L/usr/local/lib -L/usr/local/opt/libyaml/lib -L/usr/local/opt/openssl/lib -L/usr/local/opt/readline/lib     -lruby.2.5.3  -lpthread -ldl -lobjc \"\nIn file included from conftest.c:1:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby.h:33:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/ruby.h:29:\n/usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/defines.h:131:11: warning: non-portable path to file '&lt;String.h&gt;'; specified path differs in case from file name on disk [-Wnonportable-include-path]\n# include &lt;string.h&gt;\n          ^~~~~~~~~~\n          &lt;String.h&gt;\nIn file included from conftest.c:1:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby.h:33:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/ruby.h:29:\nIn file included from /usr/local/Cellar/ruby/2.5.3_1/include/ruby-2.5.0/ruby/defines.h:131:\n/usr/local/include/string.h:25:10: fatal error: 'plist/Node.h' file not found\n#include &lt;plist/Node.h&gt;\n         ^~~~~~~~~~~~~~\n1 warning and 1 error generated.\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: int main(int argc, char **argv)\n4: {\n5:   return 0;\n6: }\n/* end */\n</code></pre>\n\n<p>Xcode Developer Tools are installed using xcode-select --install.</p>\n\n<p>Does anyone maybe have a hint what to do?</p>\n\n<p>Thanks very much in advance for any help and best regards\nSebastian</p>\n"}, {"tags": ["ruby", "selenium-webdriver"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "edited": false, "score": 0, "creation_date": 1545068419, "post_id": 53820268, "comment_id": 94489309, "body": "Thanks Alec Sanger! Works perfectly! TY!"}], "tags": [], "owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1545067763, "creation_date": 1545067763, "answer_id": 53820268, "question_id": 53819777, "link": "https://stackoverflow.com/questions/53819777/how-to-trigger-a-double-click-with-selenium-ruby/53820268#53820268", "title": "How to trigger a double click with Selenium / Ruby", "body": "<p>You should be able to use actions to perform a double click.</p>\n\n<pre><code>el = @driver.find_element(:id, \"ctl00_ContentPlaceHolder1_ucConsultaCliente_grdResultadoCliente_ctl00__0\")\n\n@driver.action.double_click(el).perform\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 53820268, "answer_count": 1, "score": 0, "last_activity_date": 1548355176, "creation_date": 1545065850, "last_edit_date": 1548355176, "question_id": 53819777, "link": "https://stackoverflow.com/questions/53819777/how-to-trigger-a-double-click-with-selenium-ruby", "title": "How to trigger a double click with Selenium / Ruby", "body": "<p>It's my first time asking. I'm trying to make a double click using ruby but I don't know why I can't do that.</p>\n\n<p>The code is this one (sorry, but I needed to change the code and links due to my job).</p>\n\n<p>Tried to double click on the last code line. I already tried to copy paste the last line 2 and 4 times trying to double click, but does not work.</p>\n\n<pre><code>require 'selenium-webdriver'\nSelenium::WebDriver::Chrome.driver_path=\"C:/chromedriver.exe\"\n@driver = Selenium::WebDriver.for :chrome\n@driver.get 'http://www.google.com\u2019'\nsleep 3\n@driver.find_element(:id, \"Y_UserName\").send_keys(\"pb\")\n@driver.find_element(:id, \"Y_Password\").send_keys(\"pb\")\n@driver.find_element(:id, \"Y_LoginButton\").click\nsleep 3\n@driver.find_element(:id, \"MenuID_1\").click\nsleep 3\n@driver.find_element(:id, \"ctl00_ContentPlaceHolder1_ucConsultClient_rbCPF\").click \n@driver.find_element(:id, \"ctl00_ContentPlaceHolder1_ucConsultClient_maskTxtCPF\").send_keys(\"number\")\n@driver.find_element(:id, \"ctl00_ContentPlaceHolder1_ucConsultClient_btnLocalize_input\").click\nsleep 2\n@driver.find_element(:id, \"ctl00_ContentPlaceHolder1_ucConsultClient_grdResultClient_ctl00__0\").click **#(I tried to double click here)**\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1545065099, "post_id": 53819509, "comment_id": 94487537, "body": "When I try your existing solution it appears to work as expected. One key is removed and the value is given a new name. Which version of Ruby are you using?"}, {"owner": {"reputation": 61, "user_id": 7665211, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/386279b2a2ce73bf1f4e8c84b10c6adb?s=128&d=identicon&r=PG&f=1", "display_name": "stuckoverflow24", "link": "https://stackoverflow.com/users/7665211/stuckoverflow24"}, "reply_to_user": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1545065169, "post_id": 53819509, "comment_id": 94487577, "body": "yes it works but it will insert a new hash at the last index which i dont like. I want to maintain the order of the key value pairs in my hash"}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1545065641, "post_id": 53819509, "comment_id": 94487856, "body": "I can&#39;t find one easily, it might be possible to iterate through and drop all options into a new hash and modify one with a select, but that&#39;ll get messy very fast. Just in case it helps, here&#39;s the methods available for a Hash <a href=\"https://docs.ruby-lang.org/en/2.0.0/Hash.html\" rel=\"nofollow noreferrer\">docs.ruby-lang.org/en/2.0.0/Hash.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1545065891, "creation_date": 1545065891, "answer_id": 53819786, "question_id": 53819509, "link": "https://stackoverflow.com/questions/53819509/rename-hash-key-but-maintain-order-without-doing-an-insert-new/53819786#53819786", "title": "Rename hash key but maintain order (without doing an insert new)", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.5.3/Hash.html#method-i-transform_keys-21\" rel=\"nofollow noreferrer\"><code>transform_keys!</code></a>:</p>\n\n<pre><code>h = { foo: 1, bar: 2, baz: 3 }\n\nh.transform_keys! { |k| k == :bar ? :qux : k }\n#=&gt; {:foo=&gt;1, :qux=&gt;2, :baz=&gt;3}\n</code></pre>\n\n<p>Just make sure that the new key isn't already present in the hash.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1545076555, "last_edit_date": 1545076555, "creation_date": 1545068439, "answer_id": 53820435, "question_id": 53819509, "link": "https://stackoverflow.com/questions/53819509/rename-hash-key-but-maintain-order-without-doing-an-insert-new/53820435#53820435", "title": "Rename hash key but maintain order (without doing an insert new)", "body": "<p>I second @Stefen's answer, with the proviso that it is not necessary to support Ruby versions prior to 2.5, when <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-transform_keys-21\" rel=\"nofollow noreferrer\">Hash#transform_keys!</a> made its debut. If earlier versions must be supported, here is one way (that does not create a new hash), an extension of the approach mentioned by the OP.</p>\n\n<pre><code>h = { foo: 1, bar: 2, baz: 3 }\n\nh.keys.each { |k| h[k == :bar ? :qux : k] = h.delete(k) }\n  #=&gt; [:foo, :bar, :baz] \nh #=&gt; {:foo=&gt;1, :qux=&gt;2, :baz=&gt;3}\n</code></pre>\n\n<p>Note that the enumerators <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-each\" rel=\"nofollow noreferrer\">Hash#each_key</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-each\" rel=\"nofollow noreferrer\">Hash#each</a> cannot be used because keys are being deleted during the iteration.</p>\n\n<p>Another choice is the following.</p>\n\n<pre><code>keys = h.keys\nkeys[keys.index(:bar)] = :qux\nh.replace(keys.zip(h.values).to_h)\n  #=&gt; {:foo=&gt;1, :qux=&gt;2, :baz=&gt;3}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": false, "score": 0, "last_activity_date": 1545107510, "last_edit_date": 1545107510, "creation_date": 1545107144, "answer_id": 53826381, "question_id": 53819509, "link": "https://stackoverflow.com/questions/53819509/rename-hash-key-but-maintain-order-without-doing-an-insert-new/53826381#53826381", "title": "Rename hash key but maintain order (without doing an insert new)", "body": "<pre><code>myhash.to_a.each { |a| a[0] = preferred_name if a[0] == old_name }.to_h\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>h.map { |k, v| [k == old_name ? preferred_name : k, v] }.to_h\n</code></pre>\n\n<p>Unfortunately, both solutions will scan the entire structure\u2014even after a match is found\u2014so if your hash has many entries you might prefer one of the other options. </p>\n"}], "owner": {"reputation": 61, "user_id": 7665211, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/386279b2a2ce73bf1f4e8c84b10c6adb?s=128&d=identicon&r=PG&f=1", "display_name": "stuckoverflow24", "link": "https://stackoverflow.com/users/7665211/stuckoverflow24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53819786, "answer_count": 3, "score": 1, "last_activity_date": 1545107510, "creation_date": 1545064885, "last_edit_date": 1545106418, "question_id": 53819509, "link": "https://stackoverflow.com/questions/53819509/rename-hash-key-but-maintain-order-without-doing-an-insert-new", "title": "Rename hash key but maintain order (without doing an insert new)", "body": "<p>I want to rename a hash key. This:</p>\n\n<pre><code>myhash[preferred_name] = myhash.delete old_name \n</code></pre>\n\n<p>inserts a new key value pair at the last index of my hash. Is there a way to rename a hash without adding a new one?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545059519, "post_id": 53817938, "comment_id": 94484249, "body": "What does <code>String#include?</code> return? If it&#39;s not a number, then no, you can&#39;t do this. There are other methods, though."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1545059801, "post_id": 53817938, "comment_id": 94484398, "body": "As already pointed out, you can use <code>count</code> for your immediate issue. But really, you need something more robust for email validation. It&#39;s not so simple. You&#39;ll have to use regex."}, {"owner": {"reputation": 25, "user_id": 5626414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869882005773ad22e17cfe62fbf3e3c3?s=128&d=identicon&r=PG&f=1", "display_name": "TarenDay", "link": "https://stackoverflow.com/users/5626414/tarenday"}, "edited": false, "score": 0, "creation_date": 1545060099, "post_id": 53817938, "comment_id": 94484586, "body": "I understand, this is just for an example I am working through, and wanted to see if there was a way to check against same types of characters in a string."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1545065574, "post_id": 53817938, "comment_id": 94487812, "body": "BTW, your example address <code>joey@g@mail.com</code> doesn&#39;t contain <i>more</i> than 2 <code>@</code> symbols, it contains <i>exactly</i> 2. You probably want <code>&gt;= 2</code>. And regarding the <code>.</code> \u2013 it&#39;s perfectly fine for email addresses to have several dots, e.g. <code>joey.doe@mail.example.com</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1545067297, "post_id": 53817938, "comment_id": 94488770, "body": "For testing email addresses you probably want a loose RFC822-style validator."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1545069328, "post_id": 53817938, "comment_id": 94489716, "body": "Consider adding a question mark to the method name (<code>is_email_address?</code> ). Better, perhaps: <code>valid_email_address?</code>"}], "answers": [{"tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": true, "score": 5, "last_activity_date": 1545060861, "last_edit_date": 1545060861, "creation_date": 1545059720, "answer_id": 53818050, "question_id": 53817938, "link": "https://stackoverflow.com/questions/53817938/can-you-use-include-in-greater-than-statements/53818050#53818050", "title": "Can you use `include?` in greater than statements?", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-count\" rel=\"nofollow noreferrer\"><code>String#count</code></a>. Also, there's not much point in an <code>if</code> statement that just returns <code>true</code> or <code>false</code>; the boolean condition itself is already <code>true</code> or <code>false</code>, so you can simply return it directly. In this case, since the <code>if</code> part returns <code>false</code> and the <code>else</code> returns <code>true</code>, you can negate the condition:</p>\n\n<pre><code>return !(string.count('@') &gt;= 2)\n</code></pre>\n\n<p>Or use the opposite condition:</p>\n\n<pre><code>return string.count('@') &lt; 2\n</code></pre>\n\n<p>But if you're validating that a string looks like an email address, it seems like you would want to make sure it contains exactly one \"@\":</p>\n\n<pre><code>return string.count('@') == 1\n</code></pre>\n\n<p>You can leave the <code>return</code> keyword off as long as there's no additional code after this check in the method body; a method automatically returns the value of its last expression.</p>\n"}], "owner": {"reputation": 25, "user_id": 5626414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869882005773ad22e17cfe62fbf3e3c3?s=128&d=identicon&r=PG&f=1", "display_name": "TarenDay", "link": "https://stackoverflow.com/users/5626414/tarenday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53818050, "answer_count": 1, "score": 0, "last_activity_date": 1545106549, "creation_date": 1545059328, "last_edit_date": 1545106549, "question_id": 53817938, "link": "https://stackoverflow.com/questions/53817938/can-you-use-include-in-greater-than-statements", "title": "Can you use `include?` in greater than statements?", "body": "<p>I am trying to find out if a string includes more than two occurrences of a certain symbol. For example,</p>\n\n<pre><code>is_valid_email(\"joey@g@mail.com\")\n</code></pre>\n\n<p>should return <code>false</code> if there are more than two <code>\"@\"</code> or <code>\".\"</code>. Can I use something like this?</p>\n\n<pre><code>if string.include?(\"@\") &gt; 2\n  return false\nelse\n  return true\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4662, "user_id": 2456549, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9Uz71.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2456549/justin"}, "edited": false, "score": 1, "creation_date": 1545061378, "post_id": 53817740, "comment_id": 94485402, "body": "Be careful on what is updated in <code>Gemfile.lock</code>, especially if this is a production application, but <code>bundle update</code> could solve your problem here."}, {"owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "edited": false, "score": 0, "creation_date": 1545064639, "post_id": 53817740, "comment_id": 94487286, "body": "can you provide your Gemfile"}, {"owner": {"reputation": 13, "user_id": 9120585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b9f03472668379eebf092f7c332212?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitriy Balovnev", "link": "https://stackoverflow.com/users/9120585/dmitriy-balovnev"}, "edited": false, "score": 0, "creation_date": 1545255009, "post_id": 53817740, "comment_id": 94566665, "body": "Problem with old gems"}], "owner": {"reputation": 13, "user_id": 9120585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b9f03472668379eebf092f7c332212?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitriy Balovnev", "link": "https://stackoverflow.com/users/9120585/dmitriy-balovnev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545064551, "creation_date": 1545058625, "question_id": 53817740, "link": "https://stackoverflow.com/questions/53817740/problem-with-install-bundles-ruby-on-rails", "title": "Problem with install bundles ruby on rails", "body": "<p>Bundler could not find compatible versions for gem \"pg\":\n  In Gemfile:\n    pg (= 0.18.4)</p>\n\n<pre><code>multilang-hstore (= 1.0.0) was resolved to 1.0.0, which depends on\n  pg (&gt;= 0.0.1)\n</code></pre>\n\n<p>Bundler could not find compatible versions for gem \"responders\":\n  In Gemfile:\n    responders (= 1.1.2)</p>\n\n<pre><code>devise (= 3.4.1) was resolved to 3.4.1, which depends on\n  responders\n</code></pre>\n\n<p>Bundler could not find compatible versions for gem \"rubyzip\":\n  In Gemfile:\n    axlsx (= 2.0) was resolved to 2.0.0, which depends on\n      rubyzip (= 0.9.9)</p>\n\n<pre><code>zip-zip was resolved to 0.3, which depends on\n  rubyzip (&gt;= 1.0.0)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler"], "comments": [{"owner": {"reputation": 2780, "user_id": 2259237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a85077190b4ee090e7e1495ee556384?s=128&d=identicon&r=PG", "display_name": "rderoldan1", "link": "https://stackoverflow.com/users/2259237/rderoldan1"}, "edited": false, "score": 0, "creation_date": 1545057950, "post_id": 53817535, "comment_id": 94483349, "body": "Can you post your Gemfile and Gemfile.lock"}, {"owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "reply_to_user": {"reputation": 2780, "user_id": 2259237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a85077190b4ee090e7e1495ee556384?s=128&d=identicon&r=PG", "display_name": "rderoldan1", "link": "https://stackoverflow.com/users/2259237/rderoldan1"}, "edited": false, "score": 0, "creation_date": 1545058358, "post_id": 53817535, "comment_id": 94483585, "body": "@rderoldan1 Done, thanks."}, {"owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "edited": false, "score": 0, "creation_date": 1545060228, "post_id": 53817535, "comment_id": 94484685, "body": "Are you using an environment manager like rbenv or rvm? If so, make sure that the gem is installed for the version that your app is running in."}, {"owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "edited": false, "score": 0, "creation_date": 1545062010, "post_id": 53817535, "comment_id": 94485751, "body": "I don&#39;t think so. I&#39;m in the Flatiron bootcamp so these are projects downloaded from their lessons."}, {"owner": {"reputation": 1493, "user_id": 2236470, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/J8hqM.jpg?s=128&g=1", "display_name": "Paul Byrne", "link": "https://stackoverflow.com/users/2236470/paul-byrne"}, "edited": false, "score": 0, "creation_date": 1545085642, "post_id": 53817535, "comment_id": 94496615, "body": "Be sure to use bundle exec before your Rails and rake commands"}, {"owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "edited": false, "score": 0, "creation_date": 1545139293, "post_id": 53817535, "comment_id": 94515941, "body": "bundle exec isn&#39;t helping for, say, <code>rspec</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545206902, "creation_date": 1545206902, "answer_id": 53846953, "question_id": 53817535, "link": "https://stackoverflow.com/questions/53817535/loaderror-on-gem-that-is-definitely-installed/53846953#53846953", "title": "LoadError on gem that is definitely installed", "body": "<p>You must require it in <code>spec/rails_helper.rb</code>:</p>\n\n<pre><code># spec/rails_helper.rb\n\nrequire 'spec_helper'\nENV['RAILS_ENV'] ||= 'test'\nrequire File.expand_path('../config/environment', __dir__)\nabort('The Rails environment is running in production mode!') if Rails.env.production?\nrequire 'rspec/rails'\n\n# Add additional requires below this line. Rails is not loaded until this point!\nrequire 'capybara/rails'\n</code></pre>\n\n<p>This is explained prominently in the <a href=\"https://github.com/teamcapybara/capybara#setup\" rel=\"nofollow noreferrer\">capybara README</a>:</p>\n\n<blockquote>\n  <p>If the application that you are testing is a Rails app, add this line to your test helper file:</p>\n  \n  <p><code>require 'capybara/rails'</code></p>\n</blockquote>\n\n<p>For future reference, saying \"<em>I'm starting to frequently get errors</em>\" is not descriptive. You should <a href=\"https://stackoverflow.com/help/mcve\">explain in detail the exact circumstances under which the error occurs</a>. Just saying that you get errors is not enough to reproduce the problem. I'm assuming this issue only occurs when using rspec based on the gem being capybara.</p>\n"}], "owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545206902, "creation_date": 1545057886, "last_edit_date": 1545058346, "question_id": 53817535, "link": "https://stackoverflow.com/questions/53817535/loaderror-on-gem-that-is-definitely-installed", "title": "LoadError on gem that is definitely installed", "body": "<p>I've recently started working with Rails, and I'm starting to frequently get errors like \n<code>LoadError: cannot load such file -- capybara</code></p>\n\n<p>But capybara is definitely in my gemfile, and when I do <code>bundle list</code>, it's definitely there. This has happened with <code>thor</code> and with <code>tilt</code> and some others. </p>\n\n<p>My gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 4.2'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3'\n# Use SCSS for stylesheets\n# gem 'sass-rails', '~&gt; 5.0'    (Commented out because of Loaderror --thin)\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.1.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use jquery as the JavaScript library\ngem 'jquery-rails'\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\ngem 'turbolinks'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.0'\n# bundle exec rake doc:rails generates the API under doc/api.\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\n\n\ngroup :development, :test do\n  gem 'byebug'\n  gem 'spring'\n  gem 'rspec-rails'\n  gem 'factory_bot_rails'\n  gem 'capybara'\n  gem 'capybara-rails'    (Added because of LoadError capybara/rails)\n  gem 'database_cleaner'\nend\n</code></pre>\n\n<p>What's going on here?</p>\n\n<p>gemfile.lock</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actionmailer (4.2.11)\n      actionpack (= 4.2.11)\n      actionview (= 4.2.11)\n      activejob (= 4.2.11)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n    actionpack (4.2.11)\n      actionview (= 4.2.11)\n      activesupport (= 4.2.11)\n      rack (~&gt; 1.6)\n      rack-test (~&gt; 0.6.2)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (4.2.11)\n      activesupport (= 4.2.11)\n      builder (~&gt; 3.1)\n      erubis (~&gt; 2.7.0)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.3)\n    activejob (4.2.11)\n      activesupport (= 4.2.11)\n      globalid (&gt;= 0.3.0)\n    activemodel (4.2.11)\n      activesupport (= 4.2.11)\n      builder (~&gt; 3.1)\n    activerecord (4.2.11)\n      activemodel (= 4.2.11)\n      activesupport (= 4.2.11)\n      arel (~&gt; 6.0)\n    activesupport (4.2.11)\n      i18n (~&gt; 0.7)\n      minitest (~&gt; 5.1)\n      thread_safe (~&gt; 0.3, &gt;= 0.3.4)\n      tzinfo (~&gt; 1.1)\n    addressable (2.5.2)\n      public_suffix (&gt;= 2.0.2, &lt; 4.0)\n    arel (6.0.4)\n    builder (3.2.3)\n    byebug (10.0.2)\n    capybara (3.12.0)\n      addressable\n      mini_mime (&gt;= 0.1.3)\n      nokogiri (~&gt; 1.8)\n      rack (&gt;= 1.6.0)\n      rack-test (&gt;= 0.6.3)\n      regexp_parser (~&gt; 1.2)\n      xpath (~&gt; 3.2)\n    capybara-console (0.0.4)\n      capybara\n      rails (&gt;= 3.0)\n    capybara-rails (0.0.2)\n      capybara\n      capybara-console\n      database_cleaner\n      exception_notification\n    coffee-rails (4.1.1)\n      coffee-script (&gt;= 2.2.0)\n      railties (&gt;= 4.0.0, &lt; 5.1.x)\n    coffee-script (2.4.1)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.12.2)\n    concurrent-ruby (1.1.4)\n    crass (1.0.4)\n    database_cleaner (1.7.0)\n    diff-lcs (1.3)\n    erubis (2.7.0)\n    exception_notification (4.3.0)\n      actionmailer (&gt;= 4.0, &lt; 6)\n      activesupport (&gt;= 4.0, &lt; 6)\n    execjs (2.7.0)\n    factory_bot (4.11.1)\n      activesupport (&gt;= 3.0.0)\n    factory_bot_rails (4.11.1)\n      factory_bot (~&gt; 4.11.1)\n      railties (&gt;= 3.0.0)\n    globalid (0.4.1)\n      activesupport (&gt;= 4.2.0)\n    i18n (0.9.5)\n      concurrent-ruby (~&gt; 1.0)\n    jbuilder (2.8.0)\n      activesupport (&gt;= 4.2.0)\n      multi_json (&gt;= 1.2)\n    jquery-rails (4.3.3)\n      rails-dom-testing (&gt;= 1, &lt; 3)\n      railties (&gt;= 4.2.0)\n      thor (&gt;= 0.14, &lt; 2.0)\n    json (1.8.6)\n    loofah (2.2.3)\n      crass (~&gt; 1.0.2)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.7.1)\n      mini_mime (&gt;= 0.1.1)\n    mini_mime (1.0.1)\n    mini_portile2 (2.3.0)\n    minitest (5.11.3)\n    multi_json (1.13.1)\n    nokogiri (1.8.5)\n      mini_portile2 (~&gt; 2.3.0)\n    public_suffix (3.0.3)\n    rack (1.6.11)\n    rack-test (0.6.3)\n      rack (&gt;= 1.0)\n    rails (4.2.11)\n      actionmailer (= 4.2.11)\n      actionpack (= 4.2.11)\n      actionview (= 4.2.11)\n      activejob (= 4.2.11)\n      activemodel (= 4.2.11)\n      activerecord (= 4.2.11)\n      activesupport (= 4.2.11)\n      bundler (&gt;= 1.3.0, &lt; 2.0)\n      railties (= 4.2.11)\n      sprockets-rails\n    rails-deprecated_sanitizer (1.0.3)\n      activesupport (&gt;= 4.2.0.alpha)\n    rails-dom-testing (1.0.9)\n      activesupport (&gt;= 4.2.0, &lt; 5.0)\n      nokogiri (~&gt; 1.6)\n      rails-deprecated_sanitizer (&gt;= 1.0.1)\n    rails-html-sanitizer (1.0.4)\n      loofah (~&gt; 2.2, &gt;= 2.2.2)\n    railties (4.2.11)\n      actionpack (= 4.2.11)\n      activesupport (= 4.2.11)\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.18.1, &lt; 2.0)\n    rake (12.3.2)\n    rdoc (4.3.0)\n    regexp_parser (1.3.0)\n    rspec-core (3.8.0)\n      rspec-support (~&gt; 3.8.0)\n    rspec-expectations (3.8.2)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.8.0)\n    rspec-mocks (3.8.0)\n      diff-lcs (&gt;= 1.2.0, &lt; 2.0)\n      rspec-support (~&gt; 3.8.0)\n    rspec-rails (3.8.1)\n      actionpack (&gt;= 3.0)\n      activesupport (&gt;= 3.0)\n      railties (&gt;= 3.0)\n      rspec-core (~&gt; 3.8.0)\n      rspec-expectations (~&gt; 3.8.0)\n      rspec-mocks (~&gt; 3.8.0)\n      rspec-support (~&gt; 3.8.0)\n    rspec-support (3.8.0)\n    sdoc (0.4.2)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      rdoc (~&gt; 4.0)\n    spring (2.0.2)\n      activesupport (&gt;= 4.2)\n    sprockets (3.7.2)\n      concurrent-ruby (~&gt; 1.0)\n      rack (&gt; 1, &lt; 3)\n    sprockets-rails (3.2.1)\n      actionpack (&gt;= 4.0)\n      activesupport (&gt;= 4.0)\n      sprockets (&gt;= 3.0.0)\n    sqlite3 (1.3.13)\n    thor (0.20.3)\n    thread_safe (0.3.6)\n    turbolinks (5.2.0)\n      turbolinks-source (~&gt; 5.2)\n    turbolinks-source (5.2.0)\n    tzinfo (1.2.5)\n      thread_safe (~&gt; 0.1)\n    uglifier (4.1.20)\n      execjs (&gt;= 0.3.0, &lt; 3)\n    xpath (3.2.0)\n      nokogiri (~&gt; 1.8)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  byebug\n  capybara\n  capybara-rails\n  coffee-rails (~&gt; 4.1.0)\n  database_cleaner\n  factory_bot_rails\n  jbuilder (~&gt; 2.0)\n  jquery-rails\n  rails (~&gt; 4.2)\n  rspec-rails\n  sdoc (~&gt; 0.4.0)\n  spring\n  sqlite3\n  turbolinks\n  uglifier (&gt;= 1.3.0)\n\nBUNDLED WITH\n   1.17.1\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "rubygems", "devise-invitable"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1545082339, "post_id": 53817054, "comment_id": 94495281, "body": "but my boss doesn&#39;t understand and he said. <code>No security concerns. Users are signing up to our service and we&#39;re sending invite emails on their behalf.</code> <code>Lots of products do this</code>"}, {"owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "reply_to_user": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1545085693, "post_id": 53817054, "comment_id": 94496631, "body": "Unfortunately your boss is mistaken. Ask him to give you a solid, concrete example of what he&#39;s looking for in the wild. I&#39;m pretty certain that he won&#39;t be able to find one. Here&#39;s a site that lists your only real options when sending &quot;on behalf&quot; of your users: <a href=\"https://postmarkapp.com/support/article/846-how-can-i-send-on-behalf-of-my-users\" rel=\"nofollow noreferrer\">postmarkapp.com/support/article/&hellip;</a>"}, {"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1545086188, "post_id": 53817054, "comment_id": 94496814, "body": "Thanks for your great guidance. Now my boss said okay if this works only this ways so you have to make \u2018reply-to\u2019 be the senders email instead of our configure email."}, {"owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1545086206, "post_id": 53817054, "comment_id": 94496823, "body": "Is it possible??"}, {"owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "reply_to_user": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "edited": false, "score": 0, "creation_date": 1545088523, "post_id": 53817054, "comment_id": 94497645, "body": "I&#39;ve updated my answer to show how to add a <code>reply to</code>. Just pass that in with your <code>mail(...)</code> method as an extra parameter."}], "tags": [], "owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1545088466, "last_edit_date": 1545088466, "creation_date": 1545056098, "answer_id": 53817054, "question_id": 53816659, "link": "https://stackoverflow.com/questions/53816659/how-display-current-user-invited-by-user-email-display-of-devise-invitable-invit/53817054#53817054", "title": "how display current_user/invited_by user email display of devise invitable invitation", "body": "<p>This isn't possible. Think about the consequences if anybody could send email using anybody else's email address! Your best option is to set the Sender's name in the <code>from</code> header while keeping your standard email address. You can set it with </p>\n\n<pre><code>:from =&gt; \"#{user.first_name} #{user.last_name} &lt;#{from}&gt;\"\n</code></pre>\n\n<p>Basically just get the from to be formatted as <code>Sender's name &lt;your@email.com&gt;</code></p>\n\n<p>If you want to add a <code>reply-to</code> with the user's email address, you can pass it in as a parameter with this format:</p>\n\n<pre><code>:reply_to =&gt; user.email\n</code></pre>\n\n<p>To use the example you gave, it'd look like this:</p>\n\n<pre><code>mail(:reply_to =&gt; from, :bcc =&gt; from, :to =&gt; @user.email, :subject =&gt; subject) do |format|\n</code></pre>\n\n<p>(this assumes that you've already got the <code>from</code> param set as a default somewhere, which I believe you do)</p>\n"}], "owner": {"reputation": 147, "user_id": 6889551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151127b7cf7df34b62b2c7dc4b1be359?s=128&d=identicon&r=PG&f=1", "display_name": "Rana. Amir", "link": "https://stackoverflow.com/users/6889551/rana-amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 53817054, "answer_count": 1, "score": 0, "last_activity_date": 1545088466, "creation_date": 1545054834, "question_id": 53816659, "link": "https://stackoverflow.com/questions/53816659/how-display-current-user-invited-by-user-email-display-of-devise-invitable-invit", "title": "how display current_user/invited_by user email display of devise invitable invitation", "body": "<p>I use my own mailer instead of having devise email things for me, as per <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3A-Use-custom-mailer\" rel=\"nofollow noreferrer\">devise</a> documentation.</p>\n\n<p>Here is how I do it:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_reader :raw_invitation_token\nend\n\nclass InvitationsController &lt; Devise::InvitationsController\n  def create\n    @from    = params[:from]\n    @subject = params[:invite_subject]\n    @content = params[:invite_content]\n\n    @user = User.invite!(params[:user], current_user) do |u|\n      u.skip_invitation = true\n    end\n\n\n    email = NotificationMailer.invite_message(@user, @from, @subject, @content)\n  end\nend\n\nclass NotificationMailer &lt; ActionMailer::Base\n  def invite_message(user, venue, from, subject, content)\n    @user = user\n    @token = user.raw_invitation_token\n    invitation_link = accept_user_invitation_url(:invitation_token =&gt; @token)\n\n    mail(:from =&gt; from, :bcc =&gt; from, :to =&gt; @user.email, :subject =&gt; subject) do |format|\n      content = content.gsub '{{first_name}}', user.first_name\n      content = content.gsub '{{last_name}}', user.first_name\n      content = content.gsub '{{full_name}}', user.full_name\n      content = content.gsub('{{invitation_link}}', invitation_link)\n      format.text do\n        render :text =&gt; content\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>but when I received email that <code>from</code> is <code>demo@gmail.com</code> and that is defined in <code>development.rb</code> for configration of mailer. however I wana <code>email</code> of <code>from</code> should be <code>current user</code> means that who is inviting someone when I \n received.</p>\n\n<p>please help me.</p>\n"}, {"tags": ["ruby", "gitlab", "jekyll"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 3621015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GU7FT.png?s=128&g=1", "display_name": "Ljutgu Las", "link": "https://stackoverflow.com/users/3621015/ljutgu-las"}, "edited": false, "score": 1, "creation_date": 1545055074, "post_id": 53816305, "comment_id": 94481668, "body": "Makes sense. Thank you! Changing the repo to private now"}], "tags": [], "owner": {"reputation": 3968, "user_id": 403952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0f74ab3bacb6f344bfea131bbdca3a70?s=128&d=identicon&r=PG", "display_name": "Alec Sanger", "link": "https://stackoverflow.com/users/403952/alec-sanger"}, "is_accepted": true, "score": 2, "last_activity_date": 1545054034, "last_edit_date": 1545054034, "creation_date": 1545053571, "answer_id": 53816305, "question_id": 53815238, "link": "https://stackoverflow.com/questions/53815238/jekyll-blog-theme-now-showing-blog-posts-on-gitlab-pages/53816305#53816305", "title": "Jekyll blog theme now showing blog posts on GitLab Pages", "body": "<p>Just add a <code>.html</code> extension to your links.</p>\n\n<p><a href=\"https://remieditor.gitlab.io/blog/plausible-gitlab-moving.html\" rel=\"nofollow noreferrer\">https://remieditor.gitlab.io/blog/plausible-gitlab-moving.html</a></p>\n\n<p>Github provides an option for serving without the extension, however I don't believe that Gitlab allows this yet. See this thread: <a href=\"https://gitlab.com/gitlab-org/gitlab-pages/issues/95\" rel=\"nofollow noreferrer\">https://gitlab.com/gitlab-org/gitlab-pages/issues/95</a></p>\n\n<p>Change your permalink configuration:</p>\n\n<pre><code>permalink: /:title:output_ext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1554182542, "last_edit_date": 1592644375, "creation_date": 1554181905, "answer_id": 55467354, "question_id": 53815238, "link": "https://stackoverflow.com/questions/53815238/jekyll-blog-theme-now-showing-blog-posts-on-gitlab-pages/55467354#55467354", "title": "Jekyll blog theme now showing blog posts on GitLab Pages", "body": "<p><a href=\"https://about.gitlab.com/2019/02/22/gitlab-11-8-released/#html-extensions-are-now-automatically-resolved-for-pages-sites\" rel=\"nofollow noreferrer\">Since GitLab 11.8 (February 2019)</a> this should work</p>\n<blockquote>\n<h2><code>.html</code> extensions are now automatically resolved for Pages sites</h2>\n<p>A file in your Pages site called <code>/sub-page.html</code> can now also be accessed as <code>/sub-page</code>, giving you more options over how your site appears to your users.</p>\n</blockquote>\n<p>See <a href=\"https://docs.gitlab.com/ee/user/project/pages/\" rel=\"nofollow noreferrer\">documentation</a> and <a href=\"https://gitlab.com/gitlab-org/gitlab-pages/issues/95\" rel=\"nofollow noreferrer\"><code>gitlab-org/gitlab-pages</code> issue 95</a></p>\n"}], "owner": {"reputation": 75, "user_id": 3621015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GU7FT.png?s=128&g=1", "display_name": "Ljutgu Las", "link": "https://stackoverflow.com/users/3621015/ljutgu-las"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 53816305, "answer_count": 2, "score": 1, "last_activity_date": 1554182542, "creation_date": 1545049615, "question_id": 53815238, "link": "https://stackoverflow.com/questions/53815238/jekyll-blog-theme-now-showing-blog-posts-on-gitlab-pages", "title": "Jekyll blog theme now showing blog posts on GitLab Pages", "body": "<p>I've been using the <a href=\"https://github.com/KingFelix/emerald\" rel=\"nofollow noreferrer\">Emerald jekyll theme</a> for my blog on GitHub Pages. It all works great on GitHub, but I've wanted to move to GitLab.</p>\n\n<p>I got the blog working with all necessary gems (like jekyll and jekyll-paginate), but the blog posts aren't working and I get 404.</p>\n\n<p>Test it live <a href=\"https://remieditor.gitlab.io/blog\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I made the <a href=\"https://gitlab.com/remieditor/blog\" rel=\"nofollow noreferrer\">repo</a> public so everyone can have a look and possibly identify my problem.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "edited": false, "score": 0, "creation_date": 1545051346, "post_id": 53815168, "comment_id": 94479516, "body": "Can you try adding <code>headers:  {&#39;X-CSRF-Token&#39;: $(&#39;meta[name=&quot;csrf-token&quot;]&#39;).attr(&#39;content&#39;))}</code> and removing the <code>beforeSend</code> key?  I&#39;ve had that work before, but I&#39;m not sure if that is the issue here."}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 6037583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b584584fd12f81a98eb924a1df66bfed?s=128&d=identicon&r=PG&f=1", "display_name": "eurodo061", "link": "https://stackoverflow.com/users/6037583/eurodo061"}, "is_accepted": false, "score": 0, "last_activity_date": 1545054566, "creation_date": 1545054566, "answer_id": 53816589, "question_id": 53815168, "link": "https://stackoverflow.com/questions/53815168/how-can-i-verify-authenticity-token-when-submitting-form-through-ajax-success/53816589#53816589", "title": "How can I verify authenticity token when submitting form through ajax success?", "body": "<p>Please check whether your form has a hidden input field named <code>authenticity_token</code> or not, for forms generated with rails helpers this field is included by default.</p>\n\n<p>If not then this is what is causing error as rails expects a param called <code>authenticity_token</code> when you post a form.</p>\n\n<p>You can add this on the fly in your success callback as shown below:</p>\n\n<pre><code>     success: function(data) {\n        if(data['goto'] == true){\n          host = data[\"host\"];\n          url = host + \"/users/sign_in\";\n          var form = $(\"form\");\n          var authenticityToken = document.createElement(\"input\");\n          authenticityToken.setAttribute(\"type\", \"hidden\");\n          authenticityToken.setAttribute(\"name\", \"authenticity_token\");\n          authenticityToken.setAttribute(\"value\", $('meta[name=\"csrf-token\"]').attr('content'));\n          form.append(authenticityToken);\n          form.attr(\"action\", url);\n          form.trigger('submit.rails');\n        } else {\n          location.reload();\n        }\n      }\n</code></pre>\n\n<p>Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 630, "user_id": 5763672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ca5c235400320ab800200c6677574?s=128&d=identicon&r=PG", "display_name": "Sebastian Scholl", "link": "https://stackoverflow.com/users/5763672/sebastian-scholl"}, "is_accepted": false, "score": 0, "last_activity_date": 1545064811, "creation_date": 1545064811, "answer_id": 53819479, "question_id": 53815168, "link": "https://stackoverflow.com/questions/53815168/how-can-i-verify-authenticity-token-when-submitting-form-through-ajax-success/53819479#53819479", "title": "How can I verify authenticity token when submitting form through ajax success?", "body": "<p>If you're on Rails 5.1+ I'd recommend using <code>form_with</code> helper to handle the ajax request [<a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActionView/Helpers/FormHelper.html#method-i-form_with]\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/v5.2.1/classes/ActionView/Helpers/FormHelper.html#method-i-form_with]</a>. </p>\n\n<p>You'll still be able to hook into the success and error callbacks using code as I've shared below.</p>\n\n<p>```</p>\n\n<pre><code>let form = document.getElementById('my_form')\n\nform.addEventListener('ajax:error', (event) =&gt; {\n  let form                  = event.target\n  let [errors, status, xhr] = event.detail\n\n  // DO SOMETHING\n})\n\nform.addEventListener('ajax:success', (event) =&gt; {\n  let form = event.target\n\n  // DO SOMETHING\n})\n\nform.addEventListener('ajax:before', (event) =&gt; {\n  let form = event.target\n\n  // DO SOMETHING\n})\n</code></pre>\n\n<p>```</p>\n\n<p>This way rails will handle the authenticity token/csrf yet you'll still be able to use Ajax - with option <code>data: { remote: true }</code> to ensure no page reload.</p>\n\n<p>Hope this helps.  </p>\n"}], "owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545064811, "creation_date": 1545049387, "question_id": 53815168, "link": "https://stackoverflow.com/questions/53815168/how-can-i-verify-authenticity-token-when-submitting-form-through-ajax-success", "title": "How can I verify authenticity token when submitting form through ajax success?", "body": "<p>I have a condition in which firstly the ajax request is triggered to fetch respective host url. In case the condition returned is true I want to submit the rails form. The form is submitted correctly but I get the error can't verify authenticity token.</p>\n\n<pre><code>$(document).ready(function() {\n      var url, email;\n      $(\"form#new_user\").submit(function(e){\n        e.preventDefault();\n        email = document.getElementById(\"user_email\").value;\n        $.ajax(\"/return_host\", {\n          type: \"GET\",\n          data: {\n            email: email\n          },\n          beforeSend: function(xhr) {\n            xhr.setRequestHeader('X-CSRF-Token', $('meta[name=\"csrf-token\"]').attr('content'));\n          },\n          success: function(data) {\n            if(data['goto'] == true){\n              host = data[\"host\"];\n              url = host + \"/users/sign_in\";\n              $(\"form\").attr(\"action\", url);\n              $(\"form\").trigger('submit.rails');\n            } else {\n              location.reload();\n            }\n          }\n        });\n      });\n    });\n</code></pre>\n\n<p>How can I send authenticity token when triggering rails form through ajax success?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545054559, "post_id": 53814767, "comment_id": 94481379, "body": "You can define a <code>show.js.erb</code> (or <code>show.js.haml</code>), to <b>replace the contents of a container</b> (probably a <code>div</code>) with the search results. Something along the lines of: <a href=\"https://stackoverflow.com/a/35900332/1954610\">stackoverflow.com/a/35900332/1954610</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545054624, "post_id": 53814767, "comment_id": 94481420, "body": "Additionally, note the <code>remote: true</code> in the form. You want this to be an AJAX request, not a full page reload."}, {"owner": {"reputation": 1062, "user_id": 4353740, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f9037390e86c2e64105c15a4fb76a5?s=128&d=identicon&r=PG&f=1", "display_name": "tmo", "link": "https://stackoverflow.com/users/4353740/tmo"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545126327, "post_id": 53814767, "comment_id": 94508693, "body": "Hi @TomLord, thanks for the input. I&#39;ve edited my post and updated the code."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545150084, "post_id": 53814767, "comment_id": 94522303, "body": "The idea is that you pace a &quot;results <code>div</code>&quot; on the index page. Let&#39;s call that <code>.results</code>. Then in the <code>show.js.haml</code>, you update the contents of this container. So something like: <code>$(&quot;.results&quot;).html(&quot;#{escape_javascript(......</code>. You can call this container whatever you like (<code>#main</code>?), but it needs to be present on that page."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545150252, "post_id": 53814767, "comment_id": 94522406, "body": "Also, in your case, it&#39;s the <b>form</b> that needs to send data remotely; there&#39;s no need for a <code>link_to</code> here. For example, see <a href=\"http://www.korenlc.com/remote-true-in-rails-forms/\" rel=\"nofollow noreferrer\">korenlc.com/remote-true-in-rails-forms</a>. We&#39;re not changing the way that your form works; we&#39;re only changing what gets rendered at the end. Originally, you were rendering a new page; now, we&#39;re replacing the contents of a <code>div</code>, on the same page."}, {"owner": {"reputation": 1062, "user_id": 4353740, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f9037390e86c2e64105c15a4fb76a5?s=128&d=identicon&r=PG&f=1", "display_name": "tmo", "link": "https://stackoverflow.com/users/4353740/tmo"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545230422, "post_id": 53814767, "comment_id": 94554384, "body": "Dear @TomLord, thanks again! The <code>GET</code> method to the API now works, the index page is able to load and pressing the button actually results in a request to the API which responds correctly. Hurray! However, I am still not able to make the result appear correctly. It seems that it is looking for a template, despite <code>{render layout: false}</code> in the controller. I have changed the code in my question to a updated version."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545241642, "post_id": 53814767, "comment_id": 94561098, "body": "Yes, it&#39;s looking for a template -- that&#39;s correct. You&#39;ve named the controller <code>ModelrequestController</code>, which means it&#39;s looking for <code>app&#47;views&#47;modelrequest&#47;result.js.erb</code>. However, you&#39;ve named the file <code>app&#47;views&#47;model_requests&#47;result.js.erb</code>. Either rename the folder, or rename the controller to <code>ModelRequestsController</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545241714, "post_id": 53814767, "comment_id": 94561124, "body": "This is what the error message is telling you :)"}, {"owner": {"reputation": 1062, "user_id": 4353740, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f9037390e86c2e64105c15a4fb76a5?s=128&d=identicon&r=PG&f=1", "display_name": "tmo", "link": "https://stackoverflow.com/users/4353740/tmo"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1545249585, "post_id": 53814767, "comment_id": 94564493, "body": "Great. Stupid mistake. Now everything seems to work, just need to figure out how to display the result in index.html.haml. If you write your comments up as an answer (just partially) I will be happy to accept it. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1062, "user_id": 4353740, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f9037390e86c2e64105c15a4fb76a5?s=128&d=identicon&r=PG&f=1", "display_name": "tmo", "link": "https://stackoverflow.com/users/4353740/tmo"}, "edited": false, "score": 0, "creation_date": 1545398801, "post_id": 53882941, "comment_id": 94617572, "body": "Hi Tom! I&#39;ve accepted your answer. I think I understand the overall structure, and I have made it work if I don&#39;t use the <code>respond_to do |format| ...</code> but simply call <code>@result</code> in with a <code>link_from(...</code> so the result pops up in a message when I click the link. However, rendering the partial still does not work, even though I am defining a container to display the result (see code above). The only difference I can see is <code>_results.html.erb</code> where mine is simply <code>&lt;div id=&quot;display_result&quot;&gt; &lt;%= @result %&gt; &lt;&#47;div&gt;</code>. My suspicion is that my container is defined wrong in <code>index.html.erb</code>."}, {"owner": {"reputation": 186, "user_id": 6759431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb40b68c16728a10a291126fef1cbd3b?s=128&d=identicon&r=PG", "display_name": "mudl", "link": "https://stackoverflow.com/users/6759431/mudl"}, "edited": false, "score": 0, "creation_date": 1572660420, "post_id": 53882941, "comment_id": 103638267, "body": "Just spent half an hour trying to figure out why my partial stopped working and it was this:  &quot;$(&quot;#display_result&quot;).html(&quot;... I deleted or changed the ID of the container rendering the js. <i>smacks forehead</i> Cheers!"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1545389520, "last_edit_date": 1545389520, "creation_date": 1545387516, "answer_id": 53882941, "question_id": 53814767, "link": "https://stackoverflow.com/questions/53814767/rails-ajax-partial-not-displaying/53882941#53882941", "title": "Rails/AJAX: Partial not displaying?", "body": "<p>In a \"normal\" rails site, a search form works as follows -</p>\n\n<p>You define a form in the view. This will, by default, <code>POST</code> data to an endpoint - but you can also do this via a <code>GET</code> request. In your case, you originally chose:</p>\n\n<pre><code>form_tag(\"/search\", method: \"get\")\n</code></pre>\n\n<p>This will send the form data to <code>GET /search</code>, synchronously, and therefore perform a full page reload.</p>\n\n<p>This is a perfectly valid thing to do. However, you wanted to <em>remain on the index page</em> - therefore the request needs to be asynchronous:</p>\n\n<pre><code>form_tag(\"/search\", method: \"get\", remote: true)\n</code></pre>\n\n<p>...But now, that endpoint needs to do something different. Instead of rendering a new page, it needs to <em>partially update the current page</em>.</p>\n\n<p>The standard approach for this in a rails application is to do something along the lines of:</p>\n\n<pre><code># In the controller action, e.g. SearchController\ndef show\n  @results = # ...\n\n  respond_to do |format|\n    format.js {render layout: false}\n  end\nend\n\n# In the view, e.g. `search/show.js.erb`\n$(\"#display_result\").html(\"&lt;%= escape_javascript(render partial: 'results', locals: { results: @results } ) %&gt;\");\n\n# In an HTML partial, e.g. `search/_results.html.erb`\n&lt;% results.each do %&gt;\n  ...\n</code></pre>\n\n<p>The key idea is that on your main page (<code>index.html.erb</code>?), you must have a <strong>container</strong> to display the results. Then, rather than rendering a new page, you are merely rendering an HTML update inside that container.</p>\n\n<hr>\n\n<p>This is, of course, not the only way of doing it. Modern websites will often instead fetch JSON data for a search result and then determine how to display that via JavaScript.</p>\n\n<p>However, the above approach is the most \"minimal\" change from your current design - without needing to add additional design patterns, you can leave most of your existing <code>haml</code>/<code>erb</code> templates as-is, and just add a little code to render the results as a partial.</p>\n"}], "owner": {"reputation": 1062, "user_id": 4353740, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f9037390e86c2e64105c15a4fb76a5?s=128&d=identicon&r=PG&f=1", "display_name": "tmo", "link": "https://stackoverflow.com/users/4353740/tmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 1, "accepted_answer_id": 53882941, "answer_count": 1, "score": 0, "last_activity_date": 1545398864, "creation_date": 1545047820, "last_edit_date": 1545398864, "question_id": 53814767, "link": "https://stackoverflow.com/questions/53814767/rails-ajax-partial-not-displaying", "title": "Rails/AJAX: Partial not displaying?", "body": "<p><strong>Background</strong> (changed after correspondance with @TomLord):</p>\n\n<p>I am building a simple site with only a index page and no subpages. The index page has a \"search\" field that takes input (<code>id</code>) and sends a GET request to a RESTful API running in the background. The response from the API is JSON <code>{\"market price\": \"4306057.0\", \"retail price\": \"4995000.0\"}</code>.</p>\n\n<p>I want to display this result on the index page, together with the search field. However, <strong>when I press the button the result is not displayed anywhere</strong>.</p>\n\n<hr>\n\n<p><strong>Code</strong>:</p>\n\n<p><code>index.html.erb</code></p>\n\n<pre><code>&lt;section id=\"search\"&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;%= form_tag({controller: \"model_request\", action: \"result\"}, method: \"get\", remote: true) do %&gt;\n      &lt;%= label_tag(:q, \"Search for\") %&gt;\n      &lt;%= text_field_tag(:q, \"913384637\") %&gt;\n      &lt;%= submit_tag(\"Get the price!\") %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/section&gt;\n\n&lt;section id=\"display_result\"&gt;\n  &lt;div class=\"container\"&gt;\n  &lt;/div&gt;\n&lt;/section&gt;\n</code></pre>\n\n<p>And the <code>modelrequest_controller.rb</code> looks like this:</p>\n\n<pre><code>class ModelrequestController &lt; ApplicationController\n\n  def result\n    id = params['q'].capitalize\n    response = RestClient::Request.execute(\n      method:  :get,\n      url:     \"http://0.0.0.0:80/?id=#{id}\")\n    @result = JSON.parse response\n\n    respond_to do |format|\n      format.js {render layout: false}\n    end\n  end\n\n  end\n</code></pre>\n\n<p>My <code>routes.rb</code></p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'index#index'\n\n  match \"/modelrequest\", to: \"modelrequest#result\", via: 'get'\n\nend\n</code></pre>\n\n<p>The javascript for results looks like this:</p>\n\n<p><code>result.js.erb</code></p>\n\n<pre><code>$(\"#display_result\").html(\"&lt;%= escape_javascript(render partial: 'modelrequest/result', locals: { result: @result } ) %&gt;\");\n</code></pre>\n\n<p>And the simple <code>_result.html.erb</code> for displaying the partial is </p>\n\n<pre><code>&lt;div id=\"display_result\"&gt;\n  &lt;%= @result %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<hr>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>Started GET \"/model_request?utf8=%E2%9C%93&amp;q=913384637&amp;commit=Get%20the%20price!\" for 127.0.0.1 at 2018-12-19 20:55:33 +0100\nProcessing by ModelRequestController#result as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"q\"=&gt;\"913384637\", \"commit\"=&gt;\"Get the price!\"}\n  Rendering model_request/result.js.erb\n  Rendered model_request/_result.html.erb (0.8ms)\n  Rendered model_request/result.js.erb (6.8ms)\nCompleted 200 OK in 383ms (Views: 11.6ms | ActiveRecord: 0.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "security", "devise", "two-factor-authentication"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545046570, "post_id": 53814361, "comment_id": 94476963, "body": "I implemented OTP step recently. I did pass email/password as hidden fields in the OTP form. Worked great. Our site is using TLS, so passing password in cleartext one more time is not a big deal."}, {"owner": {"reputation": 21, "user_id": 7339266, "user_type": "registered", "profile_image": "https://graph.facebook.com/1209294969158211/picture?type=large", "display_name": "Akash Manhas", "link": "https://stackoverflow.com/users/7339266/akash-manhas"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1545046764, "post_id": 53814361, "comment_id": 94477070, "body": "@SergioTulentsev Can you send me your Site Url."}, {"owner": {"reputation": 405, "user_id": 4543085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fL4LJ.jpg?s=128&g=1", "display_name": "Shira Elitzur", "link": "https://stackoverflow.com/users/4543085/shira-elitzur"}, "edited": false, "score": 0, "creation_date": 1545051245, "post_id": 53814361, "comment_id": 94479469, "body": "Another thing you can do is two steps authentication like you can see in gmail, where as first step the user insert his email and as a second step he needs to insert password or password + otp (than in the first step you can check if the 2fa is enabled for this user)."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 405, "user_id": 4543085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fL4LJ.jpg?s=128&g=1", "display_name": "Shira Elitzur", "link": "https://stackoverflow.com/users/4543085/shira-elitzur"}, "edited": false, "score": 0, "creation_date": 1545061106, "post_id": 53814361, "comment_id": 94485232, "body": "@ShiraElitzur: gmail/google asks for otp in the third step, no? If it did on the second, it would disclose information about whether a user has otp enabled or not."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11442767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZFWih.jpg?s=128&g=1", "display_name": "KSoftware", "link": "https://stackoverflow.com/users/11442767/ksoftware"}, "is_accepted": false, "score": 0, "last_activity_date": 1603223279, "creation_date": 1603223279, "answer_id": 64452352, "question_id": 53814361, "link": "https://stackoverflow.com/questions/53814361/implementing-two-factor-authentication-using-devise/64452352#64452352", "title": "Implementing Two Factor Authentication Using Devise", "body": "<p>If you want a 2FA in two steps you can try to use the gem <a href=\"https://github.com/Houdini/two_factor_authentication\" rel=\"nofollow noreferrer\">https://github.com/Houdini/two_factor_authentication</a>.</p>\n<p>The default workflow of this gem is this:</p>\n<ol>\n<li>Insert username and password</li>\n<li>If username and password are correct notifies the otp to user</li>\n<li>Insert otp</li>\n<li>If otp is correct, the login is right</li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 7339266, "user_type": "registered", "profile_image": "https://graph.facebook.com/1209294969158211/picture?type=large", "display_name": "Akash Manhas", "link": "https://stackoverflow.com/users/7339266/akash-manhas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 976, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1603223279, "creation_date": 1545046303, "question_id": 53814361, "link": "https://stackoverflow.com/questions/53814361/implementing-two-factor-authentication-using-devise", "title": "Implementing Two Factor Authentication Using Devise", "body": "<p>I am trying to Implement Two Factor Authentication on <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">Devise</a> Using a Gem <a href=\"https://github.com/tinfoil/devise-two-factor\" rel=\"nofollow noreferrer\">devise-two-factor</a>. I want the Authentication to be in 2 Steps for that in First i am going to ask for Username and Password. if the User passes this step then he will be redirected to Next page of OTP if 2FA is Activated else the Session will be verified by Devise.</p>\n\n<p>If the User has opted for 2FA then I want to use the Devise to do all the Authentication and don't want to use sign_in(user) function to create session if user.validate_and_consume_otp(CURRENT_OTP) is true. I want to Pass Username Password and OTP to Devise as Params, So that Devise will handle the Authentication of all the three params without my intervention.</p>\n\n<p>For doing so I have came up with some workflows :-</p>\n\n<ol>\n<li><p>If username and Password are Valid and Correct i will Pass these as Post Params and Have Username and Password as hidden fields along With OTP that the User will Fill and After the Submit, These three params will be sent to Devise for Validation.</p></li>\n<li><p>I first verify the Username whether that exist in users table or no, If it exists I will check for the Valid Password using the Devise default function user.valid_password?(\"YOUR_PASSWORD_COMES_HERE\") if both these conditions are true i will be Passing the email of User as Session Variable to Next step and In second Step i only verify for Correct OTP (as username &amp; password validation is done in step 1) if OTP is correct we create Session for the User with the Email passed as Session variable and Delete Session after succesfull login, else we will again ask for OTP.</p></li>\n</ol>\n\n<p>Can you Suggest any Better Work Flow ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "dictionary"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1545046754, "post_id": 53814339, "comment_id": 94477059, "body": "If you have problem with <code>create</code> action, you should show <code>create</code> code. Backtrace would also be helpful. That said, I bet you don&#39;t set <code>@categories</code> in <code>create</code> and that&#39;s why it crashes when your record fails validation."}], "answers": [{"tags": [], "owner": {"reputation": 842, "user_id": 1386619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HOcXi.png?s=128&g=1", "display_name": "kevcha", "link": "https://stackoverflow.com/users/1386619/kevcha"}, "is_accepted": true, "score": 2, "last_activity_date": 1560274871, "last_edit_date": 1560274871, "creation_date": 1545046730, "answer_id": 53814493, "question_id": 53814339, "link": "https://stackoverflow.com/questions/53814339/what-causes-undefined-method-map-for-nilnilclass/53814493#53814493", "title": "What causes undefined method `map&#39; for nil:NilClass?", "body": "<p>When you submit the form, the navigator will make a new HTTP request (a <code>POST /movies</code>) that will lead you to the method create of your <code>MoviesController</code>. Then the error comes from that method. Double check your <code>create</code> method.</p>\n\n<p>Also, we usually do something like this in create method : </p>\n\n<pre><code>def create\n  @movie = Movie.new(movie_params)\n\n  if @movie.save\n    redirect_to '/somewhere'\n  else\n    render :new\n  end\nend\n</code></pre>\n\n<p>If it is the case for you, then it's possible that you <code>render :new</code> from the create method. The thing is that the <code>new.html.erb</code> view needs a <code>@categories</code> variable, which is not defined if you're coming from the <code>create</code> method. To fix that, just create the <code>@categories</code> variable within the <code>create</code>method :</p>\n\n<pre><code>def create\n  @movie = Movie.new(movie_params)\n\n  if @movie.save\n    redirect_to '/somewhere'\n  else\n    @categories = Category.all.map { |c| [c.name, c.id] }\n    render :new\n  end\nend\n</code></pre>\n\n<p>Your question doesn't bring enough context, so I hope I spotted the right problem (which for sure is happening in movies#create method, not movies#new) ;)</p>\n"}], "owner": {"reputation": 63, "user_id": 10658300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6f164d3ffc4a040412c552ed693bc0?s=128&d=identicon&r=PG&f=1", "display_name": "pfc", "link": "https://stackoverflow.com/users/10658300/pfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 1, "accepted_answer_id": 53814493, "answer_count": 1, "score": -3, "last_activity_date": 1560274871, "creation_date": 1545046205, "question_id": 53814339, "link": "https://stackoverflow.com/questions/53814339/what-causes-undefined-method-map-for-nilnilclass", "title": "What causes undefined method `map&#39; for nil:NilClass?", "body": "<p>I have defined @categories in controller</p>\n\n<pre><code>#MoviesController\ndef new\n    @movie = current_user.movies.build\n    @categories = Category.all.map {|c| [c.name, c.id] }\n  end\n</code></pre>\n\n<p>and in new.html.erb</p>\n\n<pre><code>&lt;%= simple_form_for @movie do |f| %&gt;\n  &lt;%= select_tag(:category_id, options_for_select(@categories), prompt: \"Select a Category\") %&gt;\n  &lt;%= f.input :name %&gt;\n  &lt;%= f.input :director %&gt;\n  &lt;%= f.input :description %&gt;\n  &lt;%= f.button :submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I submit to create new Movie I got an error undefined method `map' for nil:NilClass</p>\n\n<p>In console it's work fine...</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "validation"], "answers": [{"tags": [], "owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "is_accepted": false, "score": 2, "last_activity_date": 1545053584, "creation_date": 1545053584, "answer_id": 53816308, "question_id": 53813745, "link": "https://stackoverflow.com/questions/53813745/how-to-validate-uniqueness-in-json/53816308#53816308", "title": "How to validate uniqueness in json?", "body": "<p>I believe there is no built-in validator for this. But it is quite easy to write it: </p>\n\n<pre><code>class JsonUniqValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attribute, value)\n    records = record.class.select(attribute)\n    value.keys.each do |key| \n      if records.any? { |record| record.public_send(attribute)[key] == value[key] }\n        record.errors[attribute] &lt;&lt; options[:message] || \"variant #{key} is not unique\"\n  end\nend\n\nclass Person &lt; ApplicationRecord\n  validates :name, :json_uniq =&gt; true\nend\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8925446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b404d72617e9a62f490c9ab7711f77?s=128&d=identicon&r=PG&f=1", "display_name": "Gvenetadze Mate", "link": "https://stackoverflow.com/users/8925446/gvenetadze-mate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1545053584, "creation_date": 1545044169, "last_edit_date": 1545050448, "question_id": 53813745, "link": "https://stackoverflow.com/questions/53813745/how-to-validate-uniqueness-in-json", "title": "How to validate uniqueness in json?", "body": "<p>How can i validate name field in my User class? </p>\n\n<p><strong>example</strong>:</p>\n\n<pre><code>User.create(name: { en: \"name\", ka: \"1\" }) // =&gt; ok\nUser.create(name: { en: \"name\", ka: \"2\" }) // =&gt; error\n</code></pre>\n\n<p>Here is class:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  validates :name, presence: true, json: { schema: NAME_SCHEMA }\nend\n</code></pre>\n\n<p>here is name schema:</p>\n\n<pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"en\": {\n      \"type\": \"string\",\n      \"maxLength\": 150\n    },\n    \"ka\": {\n      \"type\": \"string\",\n      \"maxLength\": 150\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby", "pervasive-sql"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2606741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f699d85db0585fbdb8b097c681b63d52?s=128&d=identicon&r=PG", "display_name": "user2606741", "link": "https://stackoverflow.com/users/2606741/user2606741"}, "edited": false, "score": 0, "creation_date": 1545466472, "post_id": 53815438, "comment_id": 94634252, "body": "I tried with ODBC connection, but it fails every time. I installed PSQL v11.30 on a windows machine which is running on a network. And then get connected it to Razor SQL using ODBC data source on the same machine. Now I am trying to access PSQL Database from linux machine on different network using freetds and ODBC for Ruby application. But not succeeded yet. Please guide me on same."}, {"owner": {"reputation": 8184, "user_id": 314193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209f20f0c2134cf9d01ba863feb96a8a?s=128&d=identicon&r=PG", "display_name": "mirtheil", "link": "https://stackoverflow.com/users/314193/mirtheil"}, "reply_to_user": {"reputation": 51, "user_id": 2606741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f699d85db0585fbdb8b097c681b63d52?s=128&d=identicon&r=PG", "display_name": "user2606741", "link": "https://stackoverflow.com/users/2606741/user2606741"}, "edited": false, "score": 0, "creation_date": 1545483664, "post_id": 53815438, "comment_id": 94637496, "body": "Can&#39;t guide you if you don&#39;t give more information.  Does the Pervasive ODBC drive on Linux connect to the Pervasive Server on Windows?  If not, get that working before trying in Ruby.  If it isn&#39;t working, post the error."}], "tags": [], "owner": {"reputation": 8184, "user_id": 314193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209f20f0c2134cf9d01ba863feb96a8a?s=128&d=identicon&r=PG", "display_name": "mirtheil", "link": "https://stackoverflow.com/users/314193/mirtheil"}, "is_accepted": false, "score": 0, "last_activity_date": 1545603699, "last_edit_date": 1545603699, "creation_date": 1545050329, "answer_id": 53815438, "question_id": 53813709, "link": "https://stackoverflow.com/questions/53813709/how-to-connect-to-pervasive-sql-server-in-ruby-application/53815438#53815438", "title": "How to connect to Pervasive SQL server in Ruby Application?", "body": "<p>As far as I know, the only way to access Pervasive PSQL from Ruby would be through ODBC. You need to use the Pervasive Client ODBC driver. Don't use the FreeTDS driver. I've never heard of using the FreeTDS driver to connect to Pervasive PSQL. In fact, this <a href=\"https://stackoverflow.com/questions/37104045/using-unixodbc-and-freetds-to-connect-to-pervasive-sql-server-in-ubuntu\">question</a> mentions that FreeTDS doesn't work to Pervasive PSQL.  Pervasive PSQL and Microsoft SQL Server are not the same product and the client for one cannot connect to the server of the other.  </p>\n\n<p>The short answer would be to install the Pervasive PSQL client on the Ubuntu machine, create the ODBC Datasource name pointing to the database on the Windows machine and then use ODBC from within Ruby to access the data.<br>\nYou'll want to be on at least Pervasive PSQL v11.30, preferably Actian PSQL v13 (current version as of December 2018).  You'll need to download and install the client appropriate for the application.  If the Ruby application is 32 bit, you need the 32 bit ODBC driver.  If the application is 64 bit, you'll need the 64 bit driver.  The 'bitness' of the OS is not as important.  You need to use the same PSQL client version as server version.  You cannot use the v13 client with a  v11 server.  </p>\n"}], "owner": {"reputation": 51, "user_id": 2606741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f699d85db0585fbdb8b097c681b63d52?s=128&d=identicon&r=PG", "display_name": "user2606741", "link": "https://stackoverflow.com/users/2606741/user2606741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545603699, "creation_date": 1545044045, "last_edit_date": 1545511165, "question_id": 53813709, "link": "https://stackoverflow.com/questions/53813709/how-to-connect-to-pervasive-sql-server-in-ruby-application", "title": "How to connect to Pervasive SQL server in Ruby Application?", "body": "<p>I am trying to connect to a Pervasive Sql Server which is running on Windows machine from my Ruby application which is on Ubuntu Machine. Can Someone please help me on same. Thanks in advance</p>\n\n<p>Below is my configuration on linux machine</p>\n\n<blockquote>\n  <p>/etc/freetds/freetds.conf</p>\n</blockquote>\n\n<pre><code>[pserver]\n  host = XXX.XXX.XX.XXX\n  port = 1583\n  tds version = 8.0\n</code></pre>\n\n<p>Under /etc/odbcinst.ini, I have saved the driver info like below</p>\n\n<pre><code>[freetds]\n  Description=freetds Driver\n  Driver=/usr/lib/x86_64-linux-gnu/odbc/libtdsodbc.so\n  Setup=/usr/lib/x86_64-linux-gnu/odbc/libtdsS.so\n  Trace=Yes\n  TraceFile=/tmp/freetds.log\n  ForceTrave=Yes\n  UsageCount=10\n  fileusage=1\n  dontdlclose=1\n  TDS_Version = 8.0\n</code></pre>\n\n<p>In /etc/odbc.ini, client and database details</p>\n\n<pre><code>[pclient]\n    Description     = Pervasive SQL Server\n    Driver          = freetds\n    Trace           = Yes\n    Servername      = pserver\n    Port            = 1583\n    Database        = \"MyDatabasename\"\n    TDS_Version     = 8.0\n</code></pre>\n\n<blockquote>\n<pre><code>tsql -S pserver -U db_username -P db_password -d MyDatabasename\n</code></pre>\n</blockquote>\n\n<p>above cmd gives error saying\n    Error 20009 (severity 9):\n        Unable to connect: Adaptive Server is unavailable or does not exist\n        OS error 111, \"Connection refused\"\n    There was a problem connecting to the server</p>\n\n<blockquote>\n<pre><code> iodbctest [\"DSN=pclient;UID=db_username;PWD=db_password\"]\n</code></pre>\n</blockquote>\n\n<pre><code>this results in\niODBC Demonstration program\nThis program shows an interactive SQL processor\nDriver Manager: 03.52.0812.0326\n\n(iodbctest:6672): Gtk-WARNING **: 20:40:38.693: cannot open display:\n</code></pre>\n\n<p>Not able to understand the above result and how to handle this. Please help</p>\n"}, {"tags": ["ruby", "input", "console", "jetbrains-ide", "rubymine"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1545040824, "post_id": 53812716, "comment_id": 94473874, "body": "It works on MRI. Something must be wrong with RubyMine, or your setting."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1545044247, "post_id": 53812716, "comment_id": 94475725, "body": "It works. Test on terminal. Maybe the IDE doesn&#39;t accept user input. Or check here: <a href=\"https://stackoverflow.com/questions/31147082/ruby-debugger-fails-on-stdin-gets-user-input\" title=\"ruby debugger fails on stdin gets user input\">stackoverflow.com/questions/31147082/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10707341, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cm7F5WhroYU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gtmDqgEXofnr5EBMAH1kjeTo-Cpw/mo/photo.jpg?sz=128", "display_name": "Romy", "link": "https://stackoverflow.com/users/10707341/romy"}, "is_accepted": false, "score": 0, "last_activity_date": 1545054961, "creation_date": 1545054961, "answer_id": 53816706, "question_id": 53812716, "link": "https://stackoverflow.com/questions/53812716/program-doesnt-proceed-after-reading-input-from-console/53816706#53816706", "title": "Program doesn&#39;t proceed after reading input from console", "body": "<p>I have contacted the support team of IntelliJ and this is a known issue. The link <a href=\"https://youtrack.jetbrains.com/issue/RUBY-23100\" rel=\"nofollow noreferrer\">1</a> describes exactly what I'm encountering. It will be fixed in RubyMine 2018.3.2 RC. </p>\n"}], "owner": {"reputation": 11, "user_id": 10707341, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cm7F5WhroYU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gtmDqgEXofnr5EBMAH1kjeTo-Cpw/mo/photo.jpg?sz=128", "display_name": "Romy", "link": "https://stackoverflow.com/users/10707341/romy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545054961, "creation_date": 1545040465, "last_edit_date": 1545041295, "question_id": 53812716, "link": "https://stackoverflow.com/questions/53812716/program-doesnt-proceed-after-reading-input-from-console", "title": "Program doesn&#39;t proceed after reading input from console", "body": "<p>In the code below, I used the <code>gets</code> method to read input from the console.</p>\n\n<pre><code>puts \"Give me a number\"\nnum = gets\nputs \"puts #{num.to_i * 2}\"\n</code></pre>\n\n<p>Although it works and terminates on other environments, with Jetbrains RubyMine 2018.3.1 x64, the program doesn't proceed or terminate after reading the input I gave it. After I run the program, this appears on the console:</p>\n\n<pre><code>Give me a number\n12\n12\n</code></pre>\n\n<p>I have tried to uninstall and install it again, but the problem is not solved. Please help me to fix this.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 1276, "user_id": 5399937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ctCqj.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5399937/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1545080182, "last_edit_date": 1545080182, "creation_date": 1545078979, "answer_id": 53822630, "question_id": 53812421, "link": "https://stackoverflow.com/questions/53812421/i-want-to-update-my-user-list-on-submitting-the-club-form-which-automatically-cr/53822630#53822630", "title": "I want to update my user list on submitting the club form which automatically creates a club admin which in turn is a user in activeadmin", "body": "<p><code>$('#form_id').on('ajax:success', function(event, data, status, xhr){});</code></p>\n\n<p><code>ajax:success</code> and other <a href=\"https://github.com/rails/jquery-ujs/wiki/ajax\" rel=\"nofollow noreferrer\">custom events</a> can be used to handle responses from <code>remote: true</code> forms.  You would need to send the updated user list with the response data and then append or replace the user list.</p>\n"}], "owner": {"reputation": 75, "user_id": 10549885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zmCkO.jpg?s=128&g=1", "display_name": "Pujan Soni", "link": "https://stackoverflow.com/users/10549885/pujan-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545141842, "creation_date": 1545039434, "last_edit_date": 1545141842, "question_id": 53812421, "link": "https://stackoverflow.com/questions/53812421/i-want-to-update-my-user-list-on-submitting-the-club-form-which-automatically-cr", "title": "I want to update my user list on submitting the club form which automatically creates a club admin which in turn is a user in activeadmin", "body": "<p>My dashboard.rb is:</p>\n\n<pre><code>ActiveAdmin.register_page \"Dashboard\" do\n\n  menu priority: 1, label: proc{ I18n.t(\"active_admin.dashboard\") }\n\n  content title: proc{ I18n.t(\"active_admin.dashboard\") } do\n    # form render 'form'\n    # Here is an example of a simple dashboard with columns and panels.\n\n    columns do\n      column class: \"users\" do\n        table_for User.all.order(:created_at), input_html: { class: \"table table-bordered\" } do\n          column \"User Id\", :id\n          column \"Email\", :email\n          column \"User Role\" do |role|\n            role.profile.role\n          end\n        end\n      end\n\n      column do\n        render partial: 'form', locals: { club: Club.new }\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>My form partial is in app/views/admin/dashboard/_form.html.erb and it is:</p>\n\n<pre><code>&lt;%= semantic_form_for :club, url: admin_clubs_url, method: :post, builder: ActiveAdmin::FormBuilder, remote: true do |club| %&gt;\n&lt;%= club.inputs \"Details\" do %&gt;\n    &lt;%= club.input :name, label: 'Club Name' %&gt;\n    &lt;%= club.input :email, label: 'Club Admin Email', input_html: { value: '' } %&gt;\n    &lt;%= club.inputs for: [:club_profile_attributes] do |ff| %&gt;\n        &lt;%= ff.input :country_id, as: :select, collection: Country.get_id_and_name, include_blank: false %&gt;\n        &lt;%= ff.input :logo, as: :file %&gt;\n        &lt;%= ff.input :email, label: 'Club Email' %&gt;\n        &lt;%= ff.input :phone_number_1, label: 'Phone Number' %&gt;\n    &lt;% end %&gt;\n    &lt;%= club.actions %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n\n\n<p>Now how do I use an ajax request to update my users in dashboard.rb file, so whenever I create a club my user list gets updated using the ajax request/response.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "group-by"], "comments": [{"owner": {"reputation": 429, "user_id": 7617687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0c380ac37c50e2c0574e0ecec1a98?s=128&d=identicon&r=PG&f=1", "display_name": "radoAngelov", "link": "https://stackoverflow.com/users/7617687/radoangelov"}, "edited": false, "score": 0, "creation_date": 1545040078, "post_id": 53812397, "comment_id": 94473454, "body": "Firstly, are you talking about this gem - <a href=\"https://github.com/ankane/groupdate\" rel=\"nofollow noreferrer\">github.com/ankane/groupdate</a> ? If yes - you have to update your question.   To answer your question, try passing a <code>series</code> parameter to the <code>group_by_month</code> method and test again: <code>...group_by_month(:created_at, series: false).count</code>. I will post this as an answer if it is what you are searching for."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 429, "user_id": 7617687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb0c380ac37c50e2c0574e0ecec1a98?s=128&d=identicon&r=PG&f=1", "display_name": "radoAngelov", "link": "https://stackoverflow.com/users/7617687/radoangelov"}, "edited": false, "score": 0, "creation_date": 1545042826, "post_id": 53812397, "comment_id": 94474959, "body": "Yes thanks, thats what I mean, updated it.  &quot;series: false&quot; didn&#39;t end up working though.  The same problem with the date information showing up.  i tried just about everything on the gem git hub page.  I&#39;ve tried a few other ways that gives me numbers with no dates but the numbers are never correct"}], "answers": [{"tags": [], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "is_accepted": false, "score": 0, "last_activity_date": 1545057025, "creation_date": 1545057025, "answer_id": 53817287, "question_id": 53812397, "link": "https://stackoverflow.com/questions/53812397/what-in-my-controller-code-is-incorrect-using-group-by-with-the-gem/53817287#53817287", "title": "What in my controller code is incorrect using group_by with the gem?", "body": "<p>Couldn't find a simple way to remove the date info - the way i \"solved\" it was by creating a loop with a break so only one result appears.</p>\n\n<pre><code>&lt;% @orders_day.each do |day, orders| %&gt;\n   &lt;%= orders.count %&gt;\n   &lt;% break if orders.first %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It's in DESC order in the controller.</p>\n\n<p>Although, this works for months as well, I couldn't get it to work correctly with weeks.  Maybe my internal computers clock was off but the daily would show 3, which is correct, but the weekly would show 1, which makes no sense.  Code is code so it's right somehow.</p>\n\n<p>This isn't going to be an accepted response so if someone does have an answer for this questions, feel free to let me know because I will definitely want to hear how you can solve this question.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545057025, "creation_date": 1545039384, "last_edit_date": 1545041073, "question_id": 53812397, "link": "https://stackoverflow.com/questions/53812397/what-in-my-controller-code-is-incorrect-using-group-by-with-the-gem", "title": "What in my controller code is incorrect using group_by with the gem?", "body": "<p><strong>Question:</strong> How can I display the count for how many \"orders\" there are on a group_by basis (day, week, month)?  </p>\n\n<p>I am using the groupdate gem and can't see how I can take out the date information to only display the count or sum.  I need the sum of all of the counts added up.</p>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>@clients = User.all.where(affiliate_id: current_affiliate)\n@orders_e = Order.all.where(seller: @clients ).where(order_status: [2] )\n....\n@orders_week = @orders_e.all.group_by { |week|  week.created_at.beginning_of_week }\n....\n@orders_month_2 = @orders_e.all.group_by_month(:created_at)\n@orders_day_2 = @orders_h.all.group_by_day(:created_at, last: 1)\n@orders_week_2 = @orders_h.all.group_by_day(:created_at, last: 7)\n....\n@orders_week_count = @orders_week.values.sum\n</code></pre>\n\n<p><strong>View:</strong></p>\n\n<pre><code>&lt;%= @orders_month_2.count.sum() %&gt;\n</code></pre>\n\n<p><strong>Output:</strong> [\"2018-12-01 00:00:00 UTC\", 18]</p>\n\n<p>When I do this for group_by_day, or group_by_week, it gives this:</p>\n\n<pre><code>[Tue, 11 Dec 2018, 0, Wed, 12 Dec 2018, 0, Thu, 13 Dec 2018, 0, Fri, 14 Dec 2018, 0, Sat, 15 Dec 2018, 0, Sun, 16 Dec 2018, 0, Mon, 17 Dec 2018, 0] \n</code></pre>\n\n<p>What I need is all of \"0\"'s added up.</p>\n\n<p><strong>Alternative I have working as well:</strong></p>\n\n<p><strong>view:</strong></p>\n\n<pre><code>&lt;% @clients.each do |user| %&gt;\n  &lt;h3 class=\"center\"&gt;&lt;%= user.sales.where(order_status: [2] ).group_by_month(:created_at).count.sum() %&gt;&lt;/h3&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Output:</strong> [Sat, 01 Dec 2018, 18]</p>\n\n<p>I have done more attempt but I don't think listing all of them will help much as it will end up being way too much information.</p>\n\n<p>How can I get back the information:</p>\n\n<ul>\n<li>Orders today </li>\n<li>Orders this week  </li>\n<li>Orders this month</li>\n</ul>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1545035400, "post_id": 53811211, "comment_id": 94470959, "body": "Here is the doc for the keyword <a href=\"https://docs.ruby-lang.org/en/2.2.0/keywords_rdoc.html\" rel=\"nofollow noreferrer\">retry</a>. <a href=\"https://blog.appsignal.com/2018/06/05/redo-retry-next.html\" rel=\"nofollow noreferrer\">Here</a> is one of many articles that explains its use. You will see that <code>retry</code> is only used after an exception has occurred."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1545035517, "post_id": 53811211, "comment_id": 94471006, "body": "Which version of Ruby are you using? <code>retry</code> stopped working on loops in 1.9, and if there\u2019s nothing else around it should be an error on 2.5."}, {"owner": {"reputation": 10133, "user_id": 5156075, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5z8FN.jpg?s=128&g=1", "display_name": "John Joe", "link": "https://stackoverflow.com/users/5156075/john-joe"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1545035653, "post_id": 53811211, "comment_id": 94471072, "body": "@Ry- ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux-gnu]"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1545035654, "post_id": 53811211, "comment_id": 94471073, "body": "@Ry- Check the <a href=\"https://www.tutorialspoint.com/ruby/ruby_overview.htm\" rel=\"nofollow noreferrer\">second page</a>, it is talking about 1.8.5."}, {"owner": {"reputation": 10133, "user_id": 5156075, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5z8FN.jpg?s=128&g=1", "display_name": "John Joe", "link": "https://stackoverflow.com/users/5156075/john-joe"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1545035810, "post_id": 53811211, "comment_id": 94471139, "body": "@muistooshort thanks for pointing out the version.I never think of the different version will give different result"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1545038596, "post_id": 53811211, "comment_id": 94472621, "body": "@muistooshort: Sorry, I was asking about the OP\u2019s Ruby version, not the tutorial\u2019s."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1545043792, "post_id": 53811211, "comment_id": 94475500, "body": "You can find some good Ruby resources on the <a href=\"https://ruby-community.com/pages/links\" rel=\"nofollow noreferrer\">Ruby community website</a>. This includes resources for learning Ruby."}], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1545080356, "last_edit_date": 1545080356, "creation_date": 1545079917, "answer_id": 53822821, "question_id": 53811211, "link": "https://stackoverflow.com/questions/53811211/ruby-retry-statement/53822821#53822821", "title": "Ruby retry statement", "body": "<p>You missed this: from The Ruby Programming Language, (a book from 2008, co-authored by Matz, which covers Ruby 1.8 and 1.9):\"(...) In Ruby 1.8 however, <code>retry</code> has another use: it starts an iterator based iteration (or any method invocation) from the beginning. This use of the <code>retry</code> statement is extremely rare, and has been removed from the language in Ruby 1.9. It should, therefor, be considered a deprecated language feature and should not be used in new code.\"(page 152).\nRunning OP's code results in a syntax error, at least since Ruby 2.3.\n<code>Invalid retry (SyntaxError)</code></p>\n"}, {"tags": [], "owner": {"reputation": 1813, "user_id": 1047730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2435beed6cd3c5be09b77e213e4184?s=128&d=identicon&r=PG", "display_name": "codenamev", "link": "https://stackoverflow.com/users/1047730/codenamev"}, "is_accepted": true, "score": 3, "last_activity_date": 1545081199, "creation_date": 1545081199, "answer_id": 53823059, "question_id": 53811211, "link": "https://stackoverflow.com/questions/53811211/ruby-retry-statement/53823059#53823059", "title": "Ruby retry statement", "body": "<p>As others have stated, <code>retry</code> is limited to <code>rescue</code> blocks now.  If you want to re-produce your example, you'll have to wrap it in a begin...rescue:</p>\n\n<pre><code>begin\n  for i in 0..5\n    raise \"too big\" if i &gt; 2\n    puts \"Value of local variable is #{i}\"\n  end\nrescue\n  retry\nend\n</code></pre>\n"}], "owner": {"reputation": 10133, "user_id": 5156075, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5z8FN.jpg?s=128&g=1", "display_name": "John Joe", "link": "https://stackoverflow.com/users/5156075/john-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53823059, "answer_count": 2, "score": 4, "last_activity_date": 1545081199, "creation_date": 1545034661, "last_edit_date": 1545035498, "question_id": 53811211, "link": "https://stackoverflow.com/questions/53811211/ruby-retry-statement", "title": "Ruby retry statement", "body": "<p>I am following this <a href=\"https://www.tutorialspoint.com/ruby/ruby_loops.htm\" rel=\"nofollow noreferrer\">tutorial</a> and read until <code>loops</code>. From the tutorial, I expected to get:</p>\n\n<blockquote>\n<pre><code>Value of local variable is 1\nValue of local variable is 2\nValue of local variable is 1\nValue of local variable is 2\nValue of local variable is 1\nValue of local variable is 2\n............................\n</code></pre>\n</blockquote>\n\n<p>but I get this instead</p>\n\n<pre><code>Value of local variable is 0\nValue of local variable is 1\nValue of local variable is 2\n</code></pre>\n\n<p>This is the code I use, which exactly same with the tutorial</p>\n\n<pre><code>#!/usr/bin/ruby\n\nfor i in 0..5\n  retry if i &gt; 2\n  puts \"Value of local variable is #{i}\"\nend\n</code></pre>\n\n<p>Did I miss anything?</p>\n"}, {"tags": ["ruby", "boolean", "return-value"], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1545033423, "last_edit_date": 1545033423, "creation_date": 1545032397, "answer_id": 53810763, "question_id": 53810713, "link": "https://stackoverflow.com/questions/53810713/returning-boolean-instead-of-value-re-creating-select-method/53810763#53810763", "title": "Returning boolean instead of value, re-creating .select method", "body": "<p>It's because you push the result of <code>yield</code> (which can, but doesn't have to be boolean) instead of actual collection element. You should more add element based on what <code>yield</code> returns, like this:</p>\n\n<pre><code>element = collection[count]\nnewColl.push(element) if yield(element)\n</code></pre>\n\n<p>BTW I don't really get why you're checking the number parity inside of <code>my_select</code> method? It makes no sense.</p>\n"}, {"comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1545032485, "post_id": 53810767, "comment_id": 94469756, "body": "You inlined the condition to the loop, whereas you should use the one provided in the block"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1545032682, "post_id": 53810767, "comment_id": 94469821, "body": "based on the OP&#39;s code, I assumed his intention is to have an inline condition within my_select and he wants to use further block condition to filter. Obviously, I don&#39;t understand the intention here."}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": false, "score": 1, "last_activity_date": 1545237422, "last_edit_date": 1545237422, "creation_date": 1545032417, "answer_id": 53810767, "question_id": 53810713, "link": "https://stackoverflow.com/questions/53810713/returning-boolean-instead-of-value-re-creating-select-method/53810767#53810767", "title": "Returning boolean instead of value, re-creating .select method", "body": "<p>Change it to:</p>\n\n<pre><code>def my_select(collection)\n  count = 0\n  newColl = []\n  while collection.length &gt; count\n    if (collection[count] % 2 == 0)\n      result = yield collection[count] # yield first\n      newColl.push(collection[count]) if result # then push to newColl if required\n    end\n    count += 1\n  end\n  newColl\nend\n\narr = [1, 2, 3, 4, 5]\nmy_select(arr) {|num| num.even? }\n#=&gt; [2,4]\n</code></pre>\n\n<p>Though, your <code>newColl</code> collection is pretty much useless here.</p>\n\n<p><strong>Edit</strong>:\nSince you mentioned about re-creating <code>select</code>, this might be an alternative:</p>\n\n<pre><code>def my_select(collection)\n  # it iterates on the collection and filters the item for which the block return true, at the end, I compact the collection to remove nils\n  collection.map do |item|\n    item if yield(item)\n  end.compact\nend\n\n# or \ndef my_select(collection)\n  # start with a blank array\n  coll = []\n  # iterate on collection\n  collection.each do |item|\n    # insert all those items for which the block returns true by yield(item)\n    coll &lt;&lt; item if yield(item)\n  end\n  # return the array\n  coll\nend\n\narr = [1, 2, 3, 4, 5]\nmy_select(arr) {|num| num.even? }\n#=&gt; [2, 4]\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10799925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156912028782679/picture?type=large", "display_name": "Joseph Cake", "link": "https://stackoverflow.com/users/10799925/joseph-cake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545237422, "creation_date": 1545032152, "last_edit_date": 1545033072, "question_id": 53810713, "link": "https://stackoverflow.com/questions/53810713/returning-boolean-instead-of-value-re-creating-select-method", "title": "Returning boolean instead of value, re-creating .select method", "body": "<p>I'm trying to re-create the <code>select</code> method using a <code>while</code> loop and <code>yield</code>. Below is my code:</p>\n\n<pre><code>def my_select(collection)\n  count = 0\n  newColl = []\n  while collection.length &gt; count\n    if (collection[count] % 2 == 0)\n      newColl.push(yield (collection[count]))\n    end\n    count += 1\n  end\n  newColl\nend\n</code></pre>\n\n<p>When I run the following:</p>\n\n<pre><code>arr = [1, 2, 3, 4, 5]\nmy_select(arr) do |num|\n  num.even?\nend\n</code></pre>\n\n<p>I want this result:</p>\n\n<pre><code>[2, 4]\n</code></pre>\n\n<p>but I get this:</p>\n\n<pre><code>[true, true]\n</code></pre>\n\n<p>I get a boolean return instead of the actual value.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 8540055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d4c940ad6c96e49b919ffc37bd85c14?s=128&d=identicon&r=PG&f=1", "display_name": "adarsh", "link": "https://stackoverflow.com/users/8540055/adarsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545138666, "creation_date": 1545138666, "answer_id": 53833788, "question_id": 53810199, "link": "https://stackoverflow.com/questions/53810199/geocorder-gem-issue-due-to-http-in-rails/53833788#53833788", "title": "Geocorder Gem Issue due to http in rails", "body": "<p>you need to work with geographic data, Geocoder is an excellent gem for converting addresses and coordinates, finding nearby locations, determining distances,</p>\n\n<p><a href=\"http://railscasts.com/episodes/273-geocoder\" rel=\"nofollow noreferrer\">railscast</a></p>\n"}], "owner": {"reputation": 113, "user_id": 8911505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-WySgKRBvZKE/AAAAAAAAAAI/AAAAAAAACHU/776Teb8aUMs/photo.jpg?sz=128", "display_name": "Binod Paneru", "link": "https://stackoverflow.com/users/8911505/binod-paneru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545138666, "creation_date": 1545029595, "last_edit_date": 1545030848, "question_id": 53810199, "link": "https://stackoverflow.com/questions/53810199/geocorder-gem-issue-due-to-http-in-rails", "title": "Geocorder Gem Issue due to http in rails", "body": "<p>I used Geocorder gem to get a location. It runs fine only in https. I used lvh.me in place of localhost due to sub domain issue. Can it run in http?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spreadsheet", "roo"], "comments": [{"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 0, "creation_date": 1545042590, "post_id": 53809799, "comment_id": 94474826, "body": "You want to validate the file extension when the user uploads the file. The implementation depends a bit on your controller, model, and library you use for uploads. <a href=\"https://github.com/carrierwaveuploader/carrierwave#securing-uploads\" rel=\"nofollow noreferrer\">Carrierwave</a> for example allows you to define a <code>extension_whitelist</code>. If the extension doesn&#39;t match the list, the validations fail and the user should see an error."}, {"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "reply_to_user": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 0, "creation_date": 1545111611, "post_id": 53809799, "comment_id": 94502490, "body": "I used accept attributes to accept xls and xlsx for now."}, {"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "reply_to_user": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "edited": false, "score": 0, "creation_date": 1545111623, "post_id": 53809799, "comment_id": 94502495, "body": "How do i validate the headers value"}], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1545037354, "post_id": 53810554, "comment_id": 94471927, "body": "It doesn&#39;t show the error message and it doesn&#39;t validate the extensions too."}, {"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1545111649, "post_id": 53810554, "comment_id": 94502500, "body": "How to validate the headers of the sheet?"}], "tags": [], "owner": {"reputation": 3852, "user_id": 1802527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THq66.png?s=128&g=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/1802527/alexis"}, "is_accepted": false, "score": 0, "last_activity_date": 1545031288, "creation_date": 1545031288, "answer_id": 53810554, "question_id": 53809799, "link": "https://stackoverflow.com/questions/53809799/rails-roo-gem-excel-upload-validate-file-extension/53810554#53810554", "title": "Rails ROO Gem Excel upload validate file extension", "body": "<p>try something like this:</p>\n\n<pre><code>def open_spreadsheet\n    case File.extname self.file.original_filename\n    when \".xls\"\n        Roo::Excel.new self.file.path\n    when \".xlsx\"\n        Roo::Excelx.new self.file.path\n    else\n        self.errors[:file] &lt;&lt; I18n.t(\"errors.messages.invalid_file_format\", extension: File.extname(file.original_filename))\n        return nil\n    end\nend\n</code></pre>\n\n<p>You could hard-code the message there, but is nice to have it in the correct I18n tag</p>\n"}], "owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545031288, "creation_date": 1545027247, "last_edit_date": 1545027747, "question_id": 53809799, "link": "https://stackoverflow.com/questions/53809799/rails-roo-gem-excel-upload-validate-file-extension", "title": "Rails ROO Gem Excel upload validate file extension", "body": "<p>The code below checks and raises a Run Time error for unknown file formats.</p>\n\n<pre><code>def open_spreadsheet\n    case File.extname(file.original_filename)\n        when \".csv\" then CSV.new(file.path)\n        when \".xls\" then Roo::Excel.new(file.path, nil, :ignore)\n        when \".xlsx\" then Roo::Excelx.new(file.path)\n    else \n        raise \"Unknown file type: #{file.original_filename}\"\n    end\nend\n</code></pre>\n\n<p>I want to show the error message rather than runtime error. </p>\n\n<pre><code>attr_accessor :file\n</code></pre>\n\n<p>How can I validate the uploaded spreadsheet header field and show the error message if there is any modification in header from standard format?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545023827, "post_id": 53809314, "comment_id": 94466946, "body": "you cannot prevent the browser from sending you cookies"}, {"owner": {"reputation": 89, "user_id": 10691978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e8becc69dd0d98b53e959c9489fd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Maddani", "link": "https://stackoverflow.com/users/10691978/maddani"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545024056, "post_id": 53809314, "comment_id": 94466998, "body": "@LeninRajRajasekaran I can"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1545024369, "post_id": 53809314, "comment_id": 94467070, "body": "I didn&#39;t know.. how did you do it?"}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 8211949, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5973d3bcc3861af6f9b9fd17b4cebaf3?s=128&d=identicon&r=PG&f=1", "display_name": "kuwantum", "link": "https://stackoverflow.com/users/8211949/kuwantum"}, "is_accepted": false, "score": 1, "last_activity_date": 1545030772, "last_edit_date": 1545030772, "creation_date": 1545030514, "answer_id": 53810388, "question_id": 53809314, "link": "https://stackoverflow.com/questions/53809314/how-to-disable-sending-cookies-for-a-certain-route-only/53810388#53810388", "title": "How to disable sending cookies for a certain route only?", "body": "<p>Doesn't work in the routes file, but you can always use this in associated controllers:</p>\n\n<pre><code>before_action :skip_cookies\n</code></pre>\n\n<p>and as a private method:</p>\n\n<pre><code>def skip_cookies\n  request.session_options[:skip] = true\nend\n</code></pre>\n\n<p>That should avoid including any cookies for the actions inside the controller</p>\n"}], "owner": {"reputation": 89, "user_id": 10691978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e8becc69dd0d98b53e959c9489fd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Maddani", "link": "https://stackoverflow.com/users/10691978/maddani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545030772, "creation_date": 1545023730, "question_id": 53809314, "link": "https://stackoverflow.com/questions/53809314/how-to-disable-sending-cookies-for-a-certain-route-only", "title": "How to disable sending cookies for a certain route only?", "body": "<p>I've been searching for this information and haven't found anything.</p>\n\n<p>I want to disable cookies only for a particular route. Is there a way to do that? </p>\n"}, {"tags": ["ruby", "shoes"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1545021736, "post_id": 53808874, "comment_id": 94466499, "body": "You are more likely to get an answer if you link to said documentation and explain exactly what is unclear about it. You&#39;ve obviously done some research on this topic; how about you share it? And how about saying what version of Shoes you&#39;re using?"}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 1, "last_activity_date": 1545038836, "last_edit_date": 1545038836, "creation_date": 1545025748, "answer_id": 53809590, "question_id": 53808874, "link": "https://stackoverflow.com/questions/53808874/load-fonts-on-ruby-shoes/53809590#53809590", "title": "Load fonts on Ruby Shoes", "body": "<p>You can do the following in Shoes3, for example:</p>\n\n<pre><code>font 'relative/path/to/fonts/Arial.ttf' unless Shoes::FONTS.include?('Arial')\nShoes.app do\n  ...\nend\n</code></pre>\n\n<p>This example exists in the <a href=\"https://github.com/shoes/shoes3/blob/e2ffb4e12e5e44759cb83c1ec4123e2c88cd6ab7/lib/shoes.rb#L149-L181\" rel=\"nofollow noreferrer\">Shoes3 source</a>.</p>\n"}], "owner": {"reputation": 95, "user_id": 7772943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62039f2e6a8e20871ea8037866c56f19?s=128&d=identicon&r=PG", "display_name": "Shurikan117", "link": "https://stackoverflow.com/users/7772943/shurikan117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53809590, "answer_count": 1, "score": 2, "last_activity_date": 1545038836, "creation_date": 1545020064, "last_edit_date": 1545024098, "question_id": 53808874, "link": "https://stackoverflow.com/questions/53808874/load-fonts-on-ruby-shoes", "title": "Load fonts on Ruby Shoes", "body": "<p>How would I go about loading a .ttf file on my Shoes app and set that as my default font?</p>\n\n<p>Shoes version is 3.3.7 </p>\n\n<p>The documentation from <a href=\"http://shoesrb.com/manual/Built-in.html\" rel=\"nofollow noreferrer\">http://shoesrb.com/manual/Built-in.html</a> and <a href=\"http://shoesrb.com/manual/Styles.html\" rel=\"nofollow noreferrer\">http://shoesrb.com/manual/Styles.html</a> mention font sections but dont mention an example of loading fonts.</p>\n\n<p>Instead of installing the ttf file manually, I would like to know possible methods I could use to bundle and load it in Shoes (shy).</p>\n\n<p>Something like below would be helpful.</p>\n\n<pre><code>font('./fontfile.ttf')\n</code></pre>\n\n<p>I would also like to avoid calling the font for each para individual ly. A workaround for that would be helpful too. </p>\n\n<p>Sorry about this, I'm pretty new to programming. </p>\n"}]