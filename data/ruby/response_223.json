[{"tags": ["ruby-on-rails", "ruby", "minitest"], "comments": [{"owner": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "edited": false, "score": 0, "creation_date": 1555668282, "post_id": 55737283, "comment_id": 98195054, "body": "The difference seems rather insignificant to me. I feel like the &quot;difference&quot; is also likely due to something else. For example, perhaps the disk happened to be busy on one run, and took 0.5s to unblock before reading the file for execution."}, {"owner": {"reputation": 12074, "user_id": 103753, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/de716468d94286320d1efdb0c0b78ab9?s=128&d=identicon&r=PG", "display_name": "Kevin Brown", "link": "https://stackoverflow.com/users/103753/kevin-brown"}, "reply_to_user": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "edited": false, "score": 0, "creation_date": 1555671222, "post_id": 55737283, "comment_id": 98196135, "body": "You mean visually? Or you ran a similar test and it\u2019s indistinguishable. The times I shared were repeatable and not a one-off."}, {"owner": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "edited": false, "score": 0, "creation_date": 1555671875, "post_id": 55737283, "comment_id": 98196372, "body": "add <code>class Foo &lt; Minitest::Spec; end</code> to bottom of the <code>ActiveSupport</code> test and <code>class Foo &lt; ActiveSupport::TestCase; end</code> to the bottom of the <code>Minitest::Spec</code> test. What are the average runtimes then? Is there any spring caching going on?"}, {"owner": {"reputation": 12074, "user_id": 103753, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/de716468d94286320d1efdb0c0b78ab9?s=128&d=identicon&r=PG", "display_name": "Kevin Brown", "link": "https://stackoverflow.com/users/103753/kevin-brown"}, "reply_to_user": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "edited": false, "score": 0, "creation_date": 1556025038, "post_id": 55737283, "comment_id": 98290811, "body": "@Kache, runtimes are comparable. I can only assume that the run time is due to metaprogramming building tests cases from Spec -&gt; TestCase? I&#39;d probably be better off having a split suite w/ rspec."}, {"owner": {"reputation": 2266, "user_id": 390534, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/g9gVH.jpg?s=128&g=1", "display_name": "Andrea Salicetti", "link": "https://stackoverflow.com/users/390534/andrea-salicetti"}, "edited": false, "score": 0, "creation_date": 1611660515, "post_id": 55737283, "comment_id": 116516737, "body": "I&#39;ve experienced the same thing!  On a class with 50 tests / 203 assertion:  - describe style --&gt; ~ 65sec - test style --&gt; ~16sec"}, {"owner": {"reputation": 12074, "user_id": 103753, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/de716468d94286320d1efdb0c0b78ab9?s=128&d=identicon&r=PG", "display_name": "Kevin Brown", "link": "https://stackoverflow.com/users/103753/kevin-brown"}, "reply_to_user": {"reputation": 2266, "user_id": 390534, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/g9gVH.jpg?s=128&g=1", "display_name": "Andrea Salicetti", "link": "https://stackoverflow.com/users/390534/andrea-salicetti"}, "edited": false, "score": 0, "creation_date": 1611755435, "post_id": 55737283, "comment_id": 116552300, "body": "@AndreaSalicetti yeah; I just don&#39;t have the time/interest to dive deep into this, but there are some obvious drawbacks. I recall zenspider <i>somewhere</i> saying, whether at a conference or in github, that this was a possible extension to minitest, but not preferred for these reasons."}, {"owner": {"reputation": 2266, "user_id": 390534, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/g9gVH.jpg?s=128&g=1", "display_name": "Andrea Salicetti", "link": "https://stackoverflow.com/users/390534/andrea-salicetti"}, "edited": false, "score": 0, "creation_date": 1613148184, "post_id": 55737283, "comment_id": 116995354, "body": "@KevinBrown I see... what a pity!"}], "owner": {"reputation": 12074, "user_id": 103753, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/de716468d94286320d1efdb0c0b78ab9?s=128&d=identicon&r=PG", "display_name": "Kevin Brown", "link": "https://stackoverflow.com/users/103753/kevin-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555543682, "creation_date": 1555543682, "question_id": 55737283, "link": "https://stackoverflow.com/questions/55737283/minitestspec-syntax-slow-compared-to-activesupporttestcase", "title": "Minitest::Spec syntax slow? (compared to ActiveSupport::TestCase)", "body": "<p>I've been comparing the run times of writing tests with the normal rails <code>ActiveSupport::TestCase</code> versus <code>Minitest::Spec</code></p>\n\n<p>Take the following example:</p>\n\n<pre><code>class MyDecoratorTest &lt; Minitest::Spec\n  describe('#human_duration') do\n    before do\n      @runner = build_stubbed(:runner, { status: 'completed', duration: 121 })\n      @decorator = MyDecorator.new(@booking)\n    end\n\n    it('is TBA when #completed? falsey') do\n      @decorator.stubs({ completed?: false })\n      assert_equal('TBA', @decorator.human_duration)\n    end\n\n    it('is properly displayed when #compelted? truthy') do\n      assert_equal('121 min (2 hours and 1 min)', @decorator.human_duration)\n    end\n  end\nend\n</code></pre>\n\n<p>versus</p>\n\n<pre><code>class MyDecoratorTest &lt; ActiveSupport::TestCase\n  setup do\n    @runner = build_stubbed(:runner, { status: 'completed', duration: 121 })\n    @decorator = MyDecorator.new(@booking)\n  end\n\n  test('is TBA when #completed? falsey') do\n    @decorator.stubs({ completed?: false })\n    assert_equal('TBA', @decorator.human_duration)\n  end\n\n  test('is properly displayed when #completed truthy') do\n    assert_equal('121 min (2 hours and 1 min)', @decorator.human_duration)\n  end\nend\n</code></pre>\n\n<p><code>Minitest::Spec</code> completes in ~ 0.9s</p>\n\n<p><code>ActiveSupport::TestCase</code> completes in ~ 0.4s</p>\n\n<p>The disparity is so large, I don't feel inclined to do a proper bench...but I'm wondering if/how I should go about that <em>and</em> if this is similar to other experiences on the internet???</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "rspec"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1555542827, "post_id": 55736828, "comment_id": 98152174, "body": "did this start recently?  has your Gemfile.lock changed ?"}, {"owner": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1555543575, "post_id": 55736828, "comment_id": 98152326, "body": "@lacostenycoder I added the offending code today so yes it has started recently but I did not change my <code>Gemfile.lock</code> in the meantime. I edited my question with relevant gem versions."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1555546174, "post_id": 55736828, "comment_id": 98152777, "body": "Is there anything helpful here?  <a href=\"https://github.com/rspec/rspec-mocks/blob/7dc2a431101172d31b780458eb168e05d20fb3aa/lib/rspec/mocks/configuration.rb\" rel=\"nofollow noreferrer\">github.com/rspec/rspec-mocks/blob/&hellip;</a>"}, {"owner": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1555547186, "post_id": 55736828, "comment_id": 98152944, "body": "@lacostenycoder basically the config options which I don&#39;t want to change because I want to be warned in other places. I&#39;ve found a workaround tough which only costs a little bit of performance. Thanks for your help!!"}], "answers": [{"tags": [], "owner": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "is_accepted": false, "score": 1, "last_activity_date": 1555547120, "creation_date": 1555547120, "answer_id": 55737608, "question_id": 55736828, "link": "https://stackoverflow.com/questions/55736828/rspec-stub-deprecation-warning-for-stub-method-of-another-library/55737608#55737608", "title": "RSpec stub deprecation warning for stub method of another library", "body": "<p>I've found a workaround now if I use:</p>\n\n<pre><code>before { FooContainer.stub 'foo.key', stubbed_operation }\n\nafter { FooContainer.unstub 'foo.key' }\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>before(:context) { FooContainer.stub 'foo.key', stubbed_operation }\n\nafter(:context) { FooContainer.unstub 'foo.key' }\n</code></pre>\n\n<p>It works. The only drawback I can see is that it will cost a little performance and that it could break in the future.</p>\n"}, {"comments": [{"owner": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "edited": false, "score": 0, "creation_date": 1555703242, "post_id": 55765174, "comment_id": 98208417, "body": "I think you need to swap <code>before(:each)</code> with <code>before(:context)</code> in your first paragraph since the workaround I use now uses <code>before</code>/ <code>before(:each)</code> instead of  <code>before(:context)</code>."}, {"owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "reply_to_user": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "edited": false, "score": 1, "creation_date": 1555704361, "post_id": 55765174, "comment_id": 98208790, "body": "@wintersolutions my indent was, to replied to your question (not to your workaround). Anyway, the point is you need to call <code>.enable_stubs!</code> before you can use <code>.stub</code> from <code>dry-container</code>. It depends on your setup, if you like to do this within a <code>before(:context)</code> or a <code>before(:each) </code> block."}, {"owner": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "edited": false, "score": 0, "creation_date": 1555709268, "post_id": 55765174, "comment_id": 98210330, "body": "Yep I understand now and agree 100%. Gr&#252;&#223;e"}], "tags": [], "owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "is_accepted": true, "score": 1, "last_activity_date": 1555692883, "creation_date": 1555692883, "answer_id": 55765174, "question_id": 55736828, "link": "https://stackoverflow.com/questions/55736828/rspec-stub-deprecation-warning-for-stub-method-of-another-library/55765174#55765174", "title": "RSpec stub deprecation warning for stub method of another library", "body": "<p>I think the problem is, that you enabled the stub in the <code>before(:each)</code> block not within the <code>before(:context)</code> block, which is execuded before the <code>before(:each)</code> block. At this point the <code>stub</code> method from <code>dry-container</code> is unknown to rspec/ruby and therefore it tries to use the default <code>stub</code> method from <code>rspec-mock</code>.</p>\n\n<pre><code>require 'dry/container/stub'\n\nbefore(:context) { FooContainer.enable_stubs! }\nbefore(:context) { FooContainer.stub 'foo.key', stubbed_operation }\n\n# or better\nbefore(:context) do\n  FooContainer.enable_stubs!\n  FooContainer.stub 'foo.key', stubbed_operation\nend\n\nafter(:context) { FooContainer.unstub 'foo.key' }\n\ncontext \"my context\" do\n  it \"my test\" do\n    ...\n  end\nend \n</code></pre>\n\n<p>From the <a href=\"https://dry-rb.org/gems/dry-container/testing/\" rel=\"nofollow noreferrer\">dry-container testing documentation</a></p>\n\n<pre><code># before stub you need to enable stubs for specific container\ncontainer.enable_stubs!\ncontainer.stub(:redis, \"Stubbed redis instance\")\n</code></pre>\n"}], "owner": {"reputation": 4845, "user_id": 745359, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/25da42a68fcf79b0842fbc1607259092?s=128&d=identicon&r=PG", "display_name": "wintersolutions", "link": "https://stackoverflow.com/users/745359/wintersolutions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 55765174, "answer_count": 2, "score": 1, "last_activity_date": 1555692883, "creation_date": 1555540369, "last_edit_date": 1555543761, "question_id": 55736828, "link": "https://stackoverflow.com/questions/55736828/rspec-stub-deprecation-warning-for-stub-method-of-another-library", "title": "RSpec stub deprecation warning for stub method of another library", "body": "<p>I have a spec that runs without issues except when I try to run single <code>it</code> blocks. In this case I get a <code>Failure/Error: before(:context)</code> with the explanation:</p>\n\n<blockquote>\n  <p>The use of doubles or partial doubles from rspec-mocks outside of the\n  per-test lifecycle is not supported. Using <code>stub</code> from rspec-mocks'\n  old <code>:should</code> syntax without explicitly enabling the syntax is\n  deprecated. Use the new <code>:expect</code> syntax or explicitly enable\n  <code>:should</code> instead.</p>\n</blockquote>\n\n<p>The issue is that I don't use the <code>rspec-mocks</code> <code>stub</code> method but the one defined by <code>dry-container</code>:</p>\n\n<ul>\n<li><a href=\"https://dry-rb.org/gems/dry-container/testing/\" rel=\"nofollow noreferrer\">https://dry-rb.org/gems/dry-container/testing/</a></li>\n<li><a href=\"https://github.com/dry-rb/dry-container/blob/8fc95d0fe3a2f2c779bc4c3238265cb45353d245/lib/dry/container/stub.rb#L12\" rel=\"nofollow noreferrer\">https://github.com/dry-rb/dry-container/blob/8fc95d0fe3a2f2c779bc4c3238265cb45353d245/lib/dry/container/stub.rb#L12</a></li>\n</ul>\n\n<p>Like so:</p>\n\n<pre><code>require 'dry/container/stub'\n\nbefore { FooContainer.enable_stubs! }\n\nbefore(:context) { FooContainer.stub 'foo.key', stubbed_operation }\n\nafter(:context) { FooContainer.unstub 'foo.key' }\n</code></pre>\n\n<p>Is there a way to disable this RSpec behaviour without enabling the old <code>rspec-mocks</code> syntax?</p>\n\n<hr>\n\n<pre><code>rspec --version\nRSpec 3.8\n  - rspec-core 3.8.0\n  - rspec-expectations 3.8.2\n  - rspec-mocks 3.8.0\n  - rspec-rails 3.8.2\n  - rspec-support 3.8.0\n\n\nrails -v\nRails 5.2.2.1\n\nruby -v\nruby 2.6.2p47 (2019-03-13 revision 67232) [x86_64-linux]\n\ndry-container (0.6.0)\n</code></pre>\n"}, {"tags": ["mysql", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1555539966, "post_id": 55736290, "comment_id": 98151495, "body": "Don&#39;t forget to use <a href=\"https://github.com/sidorares/node-mysql2/blob/master/documentation/Extras.md\" rel=\"nofollow noreferrer\">placeholder values</a> and avoid string interpolation that creates <a href=\"http://bobby-tables.com/\" rel=\"nofollow noreferrer\">SQL injection bugs</a>."}, {"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 1, "creation_date": 1555541949, "post_id": 55736290, "comment_id": 98151991, "body": "Why is there a space after USER in <code>&#39;USER &#39;</code>?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1555543173, "post_id": 55736290, "comment_id": 98152257, "body": "can you output the string value of the query before you try to pass it?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1555561861, "post_id": 55736290, "comment_id": 98155580, "body": "How are the columns named in the database? Are they really all upcase?"}], "owner": {"reputation": 7, "user_id": 11374585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LvS2WAPCbgM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhrXCPMLpuw3zZnKhNTjlhDatn5Q/mo/photo.jpg?sz=128", "display_name": "Dusan Jolovic", "link": "https://stackoverflow.com/users/11374585/dusan-jolovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555579304, "creation_date": 1555536834, "last_edit_date": 1555579304, "question_id": 55736290, "link": "https://stackoverflow.com/questions/55736290/logging-pc-data-into-database-via-ruby-problem", "title": "Logging PC data into database via Ruby problem", "body": "<pre><code>require 'os'\nrequire 'socket'    \nrequire 'mysql2'    \nrequire 'etc'    \nrequire 'time'\n\ndef getBits    \n    return OS.bits.to_s    \nend\n\ndef getPCName\n    return Socket.gethostname\nend\n\ndef getUser    \n    return Etc.getlogin    \nend    \n\ninfo = Hash[\"SYSBITS \" =&gt; getBits,\"PCN \" =&gt; getPCName,\"USER \" =&gt; getUser]\n\nfor h in info.keys    \n    print h.chomp    \nend\n\nfor b in info.values    \n    print b.chomp    \nend\n\nconnection = Mysql2::Client.new(:host =&gt; \"localhost\", :username =&gt; \"root\",:password =&gt; \"\",:database =&gt; \"ruby\")\n\nresult = connection.query(\"INSERT INTO `mydata`(`#{h}`) VALUES ('#{b}')\")\n</code></pre>\n\n<p>So the idea here is to make Hash of information returned and then use Hash keys as columns and hash values as rows in mysql query but it doesn't work.\nI added separation manually because I can't see any other way.</p>\n\n<p>This is the error I'm getting:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>_query': Unknown column 'USER ' in 'field list' (Mysql2::Error)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise-token-auth"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1555541129, "post_id": 55735895, "comment_id": 98151759, "body": "Check that your migration includes the proper column definition, and if not you may need to either rebuild your database, or add a new migration to add that column."}, {"owner": {"reputation": 91, "user_id": 11220601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZPb262uEbl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoJEnH9qMb0Zny44RRat6HZQYgSg/mo/photo.jpg?sz=128", "display_name": "Wilson Varghese", "link": "https://stackoverflow.com/users/11220601/wilson-varghese"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555693160, "post_id": 55735895, "comment_id": 98204958, "body": "thank you, the columns for trackable was not generated in the migration, that was the reason why it was giving me the error, thanks for the help"}], "answers": [{"comments": [{"owner": {"reputation": 848, "user_id": 958091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KUsJH.jpg?s=128&g=1", "display_name": "Adam Pearlman", "link": "https://stackoverflow.com/users/958091/adam-pearlman"}, "edited": false, "score": 0, "creation_date": 1610507086, "post_id": 56396764, "comment_id": 116153339, "body": "If you are using a DB that doesn&#39;t support the inet type, you can use string."}], "tags": [], "owner": {"reputation": 3263, "user_id": 5736786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZV2Ai.png?s=128&g=1", "display_name": "olivrg", "link": "https://stackoverflow.com/users/5736786/olivrg"}, "is_accepted": true, "score": 19, "last_activity_date": 1559312118, "creation_date": 1559312118, "answer_id": 56396764, "question_id": 55735895, "link": "https://stackoverflow.com/questions/55735895/nomethoderror-undefined-method-current-sign-in-at-for-user0x000055ce01dcf0a/56396764#56396764", "title": "NoMethodError: undefined method `current_sign_in_at&#39; for #User:0x000055ce01dcf0a8 by using Devise_token_auth rails gem is not working", "body": "<p>I had this issue recently and it turns out I didn't have the trackable fields in my migration. There are two ways to fix this:</p>\n\n<p>Option one. Add a new migration that adds the trackable fields to User</p>\n\n<pre><code>## Trackable\nt.integer  :sign_in_count, default: 0, null: false\nt.datetime :current_sign_in_at\nt.datetime :last_sign_in_at\nt.inet     :current_sign_in_ip\nt.inet     :last_sign_in_ip\n</code></pre>\n\n<p>Run rake db:migrate</p>\n\n<p>The second option: run a down migration</p>\n\n<p>Start with this command - add your migration version number</p>\n\n<pre><code>rake db:migrate:down VERSION=xxxxxxxxxxxxxx\n</code></pre>\n\n<p>You should then be able to add the trackable fields to the migration file and then run </p>\n\n<pre><code>rake db:migrate up VERSION=xxxxxxxxxxxxxx\n</code></pre>\n\n<p>Run rake db:migrate</p>\n"}, {"tags": [], "owner": {"reputation": 479, "user_id": 3343716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3b08042f0eddaa9f2ba323e13ceb33?s=128&d=identicon&r=PG", "display_name": "BillFienberg", "link": "https://stackoverflow.com/users/3343716/billfienberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1569133068, "creation_date": 1569133068, "answer_id": 58046556, "question_id": 55735895, "link": "https://stackoverflow.com/questions/55735895/nomethoderror-undefined-method-current-sign-in-at-for-user0x000055ce01dcf0a/58046556#58046556", "title": "NoMethodError: undefined method `current_sign_in_at&#39; for #User:0x000055ce01dcf0a8 by using Devise_token_auth rails gem is not working", "body": "<p><a href=\"https://stackoverflow.com/a/56396764/3343716\">@olivrg's suggestion to run a migration to add the trackable fields to the <code>User</code> model</a> worked for me. </p>\n\n<p>My migration looked like this:</p>\n\n<pre><code>class AddTrackableFieldsToUser &lt; ActiveRecord::Migration[6.0]\n  def change\n    change_table :users do |t|\n      t.integer  :sign_in_count, default: 0, null: false\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.inet     :current_sign_in_ip\n      t.inet     :last_sign_in_ip\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 11220601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZPb262uEbl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoJEnH9qMb0Zny44RRat6HZQYgSg/mo/photo.jpg?sz=128", "display_name": "Wilson Varghese", "link": "https://stackoverflow.com/users/11220601/wilson-varghese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4709, "favorite_count": 0, "accepted_answer_id": 56396764, "answer_count": 2, "score": 6, "last_activity_date": 1569133068, "creation_date": 1555534857, "question_id": 55735895, "link": "https://stackoverflow.com/questions/55735895/nomethoderror-undefined-method-current-sign-in-at-for-user0x000055ce01dcf0a", "title": "NoMethodError: undefined method `current_sign_in_at&#39; for #User:0x000055ce01dcf0a8 by using Devise_token_auth rails gem is not working", "body": "<p>NoMethodError: undefined method `current_sign_in_at' for #User:0x000055ce01dcf0a8 </p>\n\n<p>I think it is a session method error of some sort</p>\n\n<p>I have an angular6 app for frontend and rails for backend, so the best option for me was to opt for devise_token_auth and ng_token_auth for user authentication.</p>\n\n<p>I installed devise_token_auth gem followed by executing this line of code in terminal</p>\n\n<blockquote>\n  <p>\"rails generate devise_token_auth:install User auth\"</p>\n</blockquote>\n\n<p>and on migration there was an error, I solved the issue by adding </p>\n\n<blockquote>\n  <p>\"extend Devise::Models\"</p>\n</blockquote>\n\n<p>to the USER model and then migration had worked, then I created a user in the backend and tried to call sign_in using postman and the error \"NoMethodError: undefined method `current_sign_in_at' for #User:0x000055ce01dcf0a8\" came</p>\n\n<p>I want the user to get authenticated using this gem or some other gem if they exist</p>\n"}, {"tags": ["ruby", "xelatex", "popen3"], "answers": [{"tags": [], "owner": {"reputation": 1233, "user_id": 1216878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/frkIL.png?s=128&g=1", "display_name": "contradictioned", "link": "https://stackoverflow.com/users/1216878/contradictioned"}, "is_accepted": true, "score": 2, "last_activity_date": 1555671927, "last_edit_date": 1555671927, "creation_date": 1555667165, "answer_id": 55759862, "question_id": 55735773, "link": "https://stackoverflow.com/questions/55735773/why-does-xelatex-not-want-to-be-called-by-popen3-in-vararg-form/55759862#55759862", "title": "Why does xelatex not want to be called by popen3 in vararg form?", "body": "<pre class=\"lang-rb prettyprint-override\"><code>Open3.popen3(\n  'xelatex', '-interaction=nonstopmode', 'minimal.tex'\n)\n</code></pre>\n\n<p>works fine.</p>\n\n<p>The error message tells you, the file <code>\"minimal.tex\"</code> does not exist.</p>\n\n<p>With the varargs form of popen3, the <code>commands</code> array is passed to <code>Process#spawn</code> where <code>xelatex</code> is called with <code>arg1=-interaction=nonstopmode</code> and <code>arg2=minimal.tex</code>. The arguments are not passed to the shell. Side note, this way you can also call other processes with \"complex\" args, e.g. <code>Open3.popen3('mkdir', 'directory with spaces and $SHELL')</code>.</p>\n\n<p>Ad <code>Open3.popen3('xelatex -interaction=nonstopmode \"minimal.tex\"')</code>: here, the entire string is considered a command that is sent to the standard shell, and this shell takes care of the double quotes.</p>\n\n<p>Ad <code>Open3.popen3('lualatex', '-interaction=nonstopmode', '\"minimal.tex\"')</code>: here I can only guess that lualatex ignores the double quotes.</p>\n\n<p>See also: <a href=\"https://ruby-doc.org/core-2.2.0/Process.html#method-c-exec\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/Process.html#method-c-exec</a></p>\n"}], "owner": {"reputation": 6434, "user_id": 539599, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iB0U.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/539599/raphael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55759862, "answer_count": 1, "score": 2, "last_activity_date": 1555671927, "creation_date": 1555534201, "question_id": 55735773, "link": "https://stackoverflow.com/questions/55735773/why-does-xelatex-not-want-to-be-called-by-popen3-in-vararg-form", "title": "Why does xelatex not want to be called by popen3 in vararg form?", "body": "<p>Take this minimal LaTeX document:</p>\n\n<pre><code>% minimal.tex\n\\documentclass{article}\n\n\\begin{document}\n    Hello World!\n\\end{document}\n</code></pre>\n\n<p>And this Ruby (2.5.1) script:</p>\n\n<pre><code>require 'open3'\n\nOpen3.popen3(\n  'xelatex', '-interaction=nonstopmode', '\"minimal.tex\"'\n) do |_stdin, stdout, stderr, wait_thr|\n    log = stdout.readlines + stderr.readlines\n    exit_status = wait_thr.value\n\n    puts exit_status\n    puts log.join('').strip!\nend\n</code></pre>\n\n<p>Running the script, we get:</p>\n\n<pre><code>This is XeTeX, Version 3.14159265-2.6-0.99999 (TeX Live 2018) (preloaded format=xelatex)\n...\n! I can't find file `'\"minimal.tex\"''.\n</code></pre>\n\n<p>This is surprising. Not only because the file <em>is</em> there, but because both</p>\n\n<ul>\n<li><code>Open3.popen3('xelatex -interaction=nonstopmode \"minimal.tex\"') do ...</code> <em>and</em></li>\n<li><code>Open3.popen3('lualatex', '-interaction=nonstopmode', '\"minimal.tex\"') do ...</code></li>\n</ul>\n\n<p>work just fine!</p>\n\n<p>What is special about the combination of <code>xelatex</code> and <code>popen3</code>?</p>\n"}, {"tags": ["ruby", "memoization"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555540708, "post_id": 55735695, "comment_id": 98151671, "body": "I don&#39;t understand why you didn&#39;t get a <i>void value exception</i> <code>SyntaxError</code>. That occurs when the parser is unable to determine how a value would be assigned, here caused by the <code>return</code> statement (even if it had been <code>return &quot;leaving early&quot; if false</code>). That&#39;s what I got with v2.6.1. What Ruby version are you using?"}, {"owner": {"reputation": 6059, "user_id": 1197246, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1c752a51e48f7574720d80c2468006e7?s=128&d=identicon&r=PG", "display_name": "Tom Prats", "link": "https://stackoverflow.com/users/1197246/tom-prats"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555606129, "post_id": 55735695, "comment_id": 98177678, "body": "@CarySwoveland Good catch. Looks like it works if you have something after the return, like a <code>puts &quot;finished&quot;</code> or just some value to return"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555629669, "post_id": 55735695, "comment_id": 98185915, "body": "Yes, but it&#39;s still weird."}], "answers": [{"comments": [{"owner": {"reputation": 6059, "user_id": 1197246, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1c752a51e48f7574720d80c2468006e7?s=128&d=identicon&r=PG", "display_name": "Tom Prats", "link": "https://stackoverflow.com/users/1197246/tom-prats"}, "edited": false, "score": 0, "creation_date": 1555536373, "post_id": 55736076, "comment_id": 98150492, "body": "That&#39;s some great insight. Using another method makes a lot of sense here, but having the option to use a anonymous proc is an interesting possibility"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555629613, "post_id": 55736076, "comment_id": 98185904, "body": "This is good advice but it doesn&#39;t answer the question: &quot;Does anything work within a begin block the way I&#39;m thinking?&quot;."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555630688, "post_id": 55736076, "comment_id": 98186104, "body": "@CarySwoveland I believe I&#39;ve answered it implicitly, but here&#39;s the answer explicitly: No, not to the best of my knowledge."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555632041, "post_id": 55736076, "comment_id": 98186331, "body": "The OP has answered that question in the affirmative in a recent comment on the question, though we agree it&#39;s not good coding practice"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555632364, "post_id": 55736076, "comment_id": 98186382, "body": "@CarySwoveland That solves the SyntaxError, but it doesn&#39;t actually solve the problem."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555633048, "post_id": 55736076, "comment_id": 98186499, "body": "True. I must work harder on my bad habits, that one failing to consider questions in their entirety."}], "tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": true, "score": 12, "last_activity_date": 1555537207, "last_edit_date": 1555537207, "creation_date": 1555535753, "answer_id": 55736076, "question_id": 55735695, "link": "https://stackoverflow.com/questions/55735695/break-out-of-a-begin-end-block-early/55736076#55736076", "title": "Break out of a begin/end block early", "body": "<p>I think you're going to save yourself a whole heck of a lot of strife if you just put all that logic into its own method:</p>\n\n<pre><code>def foo\n  @foo ||= compute_foo\nend\n\ndef compute_foo\n  puts \"running\"\n\n  return \"leaving early\" if true # would be some sort of calculation\n\n  # Other calculations\nend\n</code></pre>\n\n<p>This decouples the computation from the memoization, making it easier to test and reason about, and it's a fairly common design pattern in Ruby and other languages.</p>\n\n<p>Of course, there are ways of doing what you're asking. The most obvious solution being an immediately-invoked anonymous proc:</p>\n\n<pre><code>def foo\n  @foo ||= (proc do\n    puts \"running\"\n\n    next \"leaving early\" if true # would be some sort of calculation\n\n    # Other calculations\n  end)[] # or .call or .()\nend\n</code></pre>\n\n<p>But you certainly wouldn't be doing yourself or any future maintainers of this code any favors. </p>\n"}], "owner": {"reputation": 6059, "user_id": 1197246, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1c752a51e48f7574720d80c2468006e7?s=128&d=identicon&r=PG", "display_name": "Tom Prats", "link": "https://stackoverflow.com/users/1197246/tom-prats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 55736076, "answer_count": 1, "score": 8, "last_activity_date": 1555537207, "creation_date": 1555533815, "question_id": 55735695, "link": "https://stackoverflow.com/questions/55735695/break-out-of-a-begin-end-block-early", "title": "Break out of a begin/end block early", "body": "<p>I want a way to exit a begin/end block while still assigning the variable that its result is assigned to.</p>\n\n<pre><code>def foo\n  @foo ||= begin\n    puts \"running\"\n\n    return \"leaving early\" if true # would be some sort of calculation\n\n    # Other calculations\n  end\nend\n</code></pre>\n\n<p>What I hope to happen</p>\n\n<pre><code>&gt; foo\nrunning\n=&gt; leaving early\n&gt; foo\n=&gt; leaving early\n</code></pre>\n\n<p>What actually happens</p>\n\n<pre><code>&gt; foo\nrunning\n=&gt; leaving early\n&gt; foo\nrunning\n=&gt; leaving early\n</code></pre>\n\n<p>The code doesn't work because <code>return</code> exits the entire method without setting <code>@foo</code>. Using <code>break</code> or <code>next</code> only work in loops. Does anything work within a begin block the way I'm thinking?</p>\n\n<p>Current ways I can do it but was hoping to avoid:</p>\n\n<ul>\n<li>Assigning the variable within the begin block and returning</li>\n<li>Putting the remaining portion of the begin block in an if statement</li>\n<li>Performing the calculation before the begin block</li>\n</ul>\n\n<p>There seem to be a lot of related questions about breaking out of blocks but I couldn't find one that answers this specific version (maybe because it's not possible).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1555528655, "post_id": 55734302, "comment_id": 98147541, "body": "Fix the incorrect single quote character at the end of content-type and test-header"}, {"owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "reply_to_user": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1555528759, "post_id": 55734302, "comment_id": 98147585, "body": "@infused thanks, thats just a typo. I also tested with Postman and through the UI. The header value is still not accessible through <code>request.headers</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1555532020, "post_id": 55734302, "comment_id": 98148902, "body": "Only thing I found in github issues was this, might be related <a href=\"https://github.com/rails/rails/issues/28564\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/28564</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1555532397, "post_id": 55734302, "comment_id": 98149053, "body": "Perhaps might be related to <a href=\"https://github.com/rails/rails/issues/9940\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/9940</a> not sure"}, {"owner": {"reputation": 76, "user_id": 3425069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2QSZ.jpg?s=128&g=1", "display_name": "Josie McClellan", "link": "https://stackoverflow.com/users/3425069/josie-mcclellan"}, "edited": false, "score": 0, "creation_date": 1555573117, "post_id": 55734302, "comment_id": 98159591, "body": "The header was present for me with both curls using 3.2.22.1 (or it was when I added <code>-d &#39;{}&#39;</code> to avoid a 411 Length Required before it even hit the controller). So the problem must involve some info we don&#39;t have..."}, {"owner": {"reputation": 76, "user_id": 3425069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2QSZ.jpg?s=128&g=1", "display_name": "Josie McClellan", "link": "https://stackoverflow.com/users/3425069/josie-mcclellan"}, "edited": false, "score": 0, "creation_date": 1555573176, "post_id": 55734302, "comment_id": 98159624, "body": "Have you inspected <code>request.headers</code> and seen that it&#39;s not represented in any way? Or just tried the bracket access you showed in the question? It should have the key <code>&quot;HTTP_ACCEPT_LANGUAGE&quot;</code>."}, {"owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "edited": false, "score": 0, "creation_date": 1555596558, "post_id": 55734302, "comment_id": 98172519, "body": "I figured it out. There was a merge issue in a pass through server which modified the headers. Making it a deep merge fixed it. Was hard to find simply because i wasn&#39;t running the pass through server locally. thanks for the help!"}], "owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555528840, "creation_date": 1555527452, "last_edit_date": 1555528840, "question_id": 55734302, "link": "https://stackoverflow.com/questions/55734302/rails-api-app-ignores-accept-language-header-value", "title": "Rails API App ignores Accept-Language header value", "body": "<p>This is all at the Controller level, ie ApplicationController.</p>\n\n<p>This is a really strange issue which may only be occurring to me.</p>\n\n<p>Basically, as the title says Rails is ignoring the <code>Accept-Language</code> header value. <strong>But</strong> get this, order matters apparently. </p>\n\n<p>So if I curl</p>\n\n<pre><code>curl -X POST \\\n http://localhost:1234/signin \\\n -H 'Accept-Language: de' \\\n -H 'content-type: application/json' \\\n -H 'Test-Header: Test' \\\n</code></pre>\n\n<p>I can access the <code>Accept-Language</code> value with <code>request.headers['Accept-Language']</code> perfectly fine.</p>\n\n<p>However, if I change the order</p>\n\n<pre><code>curl -X POST \\\n http://localhost:1234/signin \\\n -H 'content-type: application/json' \\\n -H 'Accept-Language: de' \\\n -H 'Test-Header: Test' \\\n</code></pre>\n\n<p><code>request.headers['Accept-Language']</code> returns nil.</p>\n\n<p>Any idea as to why this may happen? I'm on Rails 3.2.22.1</p>\n\n<p>Things I've done:</p>\n\n<ul>\n<li>Checked the Rack::Cors middleware</li>\n<li>Pulled out my hair</li>\n<li>Verified header is sent both on curl and web, also verified my findings with Postman</li>\n<li>Global search to see if it gets overwritten anywhere (I couldn't find anything)</li>\n<li>Other header values are fine. I didn't test all of them but did test custom and a handful of others.</li>\n</ul>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5", "subdomain"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1555527251, "post_id": 55734175, "comment_id": 98146922, "body": "for <code>documents_path</code>? <code>documents_url(host: &quot;sub.example.com&quot;)</code> \u2014 note that you&#39;ll need to use <code>_url</code> and not <code>path</code> to get the <code>host</code> key to work correctly."}, {"owner": {"reputation": 138, "user_id": 3602175, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0e2991f27bcfa4f66100afb1ae8bd460?s=128&d=identicon&r=PG&f=1", "display_name": "akaimo", "link": "https://stackoverflow.com/users/3602175/akaimo"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1555527811, "post_id": 55734175, "comment_id": 98147156, "body": "Thanks.  This would be for all authenticated paths."}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 3602175, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0e2991f27bcfa4f66100afb1ae8bd460?s=128&d=identicon&r=PG&f=1", "display_name": "akaimo", "link": "https://stackoverflow.com/users/3602175/akaimo"}, "edited": false, "score": 0, "creation_date": 1555537751, "post_id": 55735482, "comment_id": 98150938, "body": "This code is currently in my application controller, I just need an approach to handle the subdomain routing on login/logout."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 138, "user_id": 3602175, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0e2991f27bcfa4f66100afb1ae8bd460?s=128&d=identicon&r=PG&f=1", "display_name": "akaimo", "link": "https://stackoverflow.com/users/3602175/akaimo"}, "edited": false, "score": 0, "creation_date": 1555542039, "post_id": 55735482, "comment_id": 98152009, "body": "see updated answer, you need config in session_store.rb"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1555541980, "last_edit_date": 1555541980, "creation_date": 1555532773, "answer_id": 55735482, "question_id": 55734175, "link": "https://stackoverflow.com/questions/55734175/devise-redirect-authenticated-users-to-a-single-subdomain-in-rails-5/55735482#55735482", "title": "Devise: Redirect authenticated users to a single subdomain in Rails 5", "body": "<p>It's ok to override the devise method, however you probably wanna move it to your application_controller where you will have access to Rails path helpers</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  def after_sign_in_path_for(resource)\n    if current_user.try(:guest?)\n      documents_path\n    else\n      stored_location_for(resource) || dashboard_path\n    end\n  end\n\n  def after_sign_out_path_for(resource)\n    #send them somehwere\n  end\n\nend\n</code></pre>\n\n<p>Then you will need something like this in <code>config/initializers/session_store.rb</code></p>\n\n<pre><code>MyApp::Application.config.session_store :cookie_store, domain: '.maindomain.com'\n</code></pre>\n\n<p>Or if you only want sessions for one specific subdomain:</p>\n\n<pre><code>MyApp::Application.config.session_store :cookie_store, domain: 'something.rootdomain.com'\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 3602175, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0e2991f27bcfa4f66100afb1ae8bd460?s=128&d=identicon&r=PG&f=1", "display_name": "akaimo", "link": "https://stackoverflow.com/users/3602175/akaimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555541980, "creation_date": 1555526914, "question_id": 55734175, "link": "https://stackoverflow.com/questions/55734175/devise-redirect-authenticated-users-to-a-single-subdomain-in-rails-5", "title": "Devise: Redirect authenticated users to a single subdomain in Rails 5", "body": "<p>I have a Rails 5 app that uses Devise for user authentication and currently shares the user session across the primary and sub domain.</p>\n\n<p>I would like to change this behavior so that authenticated users are routed to the subdomain <code>sub.example.com</code> while non-authenticated users are kept on the primary domain <code>example.com</code>.</p>\n\n<p>The solutions I've found are focused around multi-tenant implementations, however this is not a multi-tenant app and I only need to redirect users to a single subdomain at this point.</p>\n\n<p>I am currently using a custom Devise method to redirect authenticated users to the requested resource as determined by his or her role:</p>\n\n<pre><code>def after_sign_in_path_for(resource)\n  if current_user.try(:guest?)\n    documents_path\n  else\n    stored_location_for(resource) || dashboard_path\n  end\nend\n</code></pre>\n\n<p>Is this something that would be handled with an additional application controller filter or perhaps another way?</p>\n"}, {"tags": ["ruby", "git", "bundler"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1555521551, "post_id": 55732199, "comment_id": 98144402, "body": "This sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\">XY problem</a>. It sounds like you&#39;re having a bundler problem and you suspect that it&#39;s not &quot;putting the git repos of gems into the correct path.&quot; If you describe that problem in detail you might get a more straightforward solution than poring over git logs."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1555523092, "post_id": 55732199, "comment_id": 98145137, "body": "I think you may be right @JordanRunning digging deeper into this and not seeing anyone else reporting this issue with bundler+git."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1555523775, "post_id": 55732199, "comment_id": 98145436, "body": "That&#39;s very strange. Is there a reason you&#39;re using it as a git dependency and not an ordinary rubygems dependency (<code>gem &quot;activerecord-import&quot;</code>)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1555523991, "post_id": 55732199, "comment_id": 98145523, "body": "@JordanRunning it&#39;s listed in the Gemfile: <code>gem &#39;activerecord-import&#39;, &#39;0.19.0&#39;, :git =&gt; &#39;git@github-private-repo:private-repo&#47;activerecord-import.gi&zwnj;&#8203;t&#39;, :ref =&gt; &#39;10b18879201608f3ee83d0c4fd700e6f13ce021a&#39;</code> that&#39;s why I&#39;m very confused. thanks for the GIT_TRACE, it looks like nothing is amiss (bundle install with git seems to use git sub-modules and the gem causing issues is that last gem installed from git)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "edited": false, "score": 0, "creation_date": 1555526722, "post_id": 55733425, "comment_id": 98146704, "body": "I think I figured out my issue and it looks like you were right. In the specific gem that&#39;s being checked out, the gemspec file has this line <code>`git ls-files`.split($\\)</code>"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 2, "last_activity_date": 1555523618, "creation_date": 1555523618, "answer_id": 55733425, "question_id": 55732199, "link": "https://stackoverflow.com/questions/55732199/are-there-logs-to-see-git-commands-from-bundler/55733425#55733425", "title": "Are there logs to see git commands from bundler?", "body": "<p>I don't know if this will help you solve your actual problem, but the answer to your question is that you can see all of the <code>git</code> commands being executed by setting the <code>GIT_TRACE</code> environment variable. On macOS, Linux, etc. that looks like <code>GIT_TRACE=1 bundle install</code>. The method will be different on Windows.</p>\n\n<p>Here's the output for a brand new <code>Gemfile</code> with one dependency:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>$ cat Gemfile\n# frozen_string_literal: true\nsource \"https://rubygems.org\"\ngem 'rack', git: 'https://github.com/rack/rack'\n\n$ GIT_TRACE=1 bundle install\nFetching https://github.com/rack/rack\n12:43:02.753769 git.c:415               trace: built-in: git clone https://github.com/rack/rack /Users/jordanr/.rbenv/gems/2.6.0/cache/bundler/git/rack-02d63969ed912ff0486a199e1ea3aa78127fbb67 --bare --no-hardlinks --quiet\n12:43:02.800426 run-command.c:637       trace: run_command: unset GIT_DIR; ssh git@github.com 'git-upload-pack '\\''rack/rack'\\'''\n12:43:06.059759 run-command.c:637       trace: run_command: git index-pack --stdin --fix-thin '--keep=fetch-pack 23789 on jordanr.local' --check-self-contained-and-connected\n12:43:06.067881 git.c:415               trace: built-in: git index-pack --stdin --fix-thin '--keep=fetch-pack 23789 on jordanr.local' --check-self-contained-and-connected\n12:43:06.945711 run-command.c:637       trace: run_command: git rev-list --objects --stdin --not --all --quiet\n12:43:06.951101 git.c:415               trace: built-in: git rev-list --objects --stdin --not --all --quiet\n12:43:06.974513 git.c:415               trace: built-in: git rev-parse --verify master\n12:43:06.991681 git.c:415               trace: built-in: git fetch --force --quiet --tags /Users/jordanr/.rbenv/gems/2.6.0/cache/bundler/git/rack-02d63969ed912ff0486a199e1ea3aa78127fbb67\n12:43:06.993341 run-command.c:637       trace: run_command: unset GIT_PREFIX; 'git-upload-pack '\\''/Users/jordanr/.rbenv/gems/2.6.0/cache/bundler/git/rack-02d63969ed912ff0486a199e1ea3aa78127fbb67'\\'''\n12:43:07.000949 git.c:415               trace: built-in: git upload-pack /Users/jordanr/.rbenv/gems/2.6.0/cache/bundler/git/rack-02d63969ed912ff0486a199e1ea3aa78127fbb67\n12:43:07.012806 run-command.c:637       trace: run_command: git rev-list --objects --stdin --not --all --quiet\n12:43:07.022792 run-command.c:637       trace: run_command: git rev-list --objects --stdin --not --all --quiet\n12:43:07.027701 git.c:415               trace: built-in: git rev-list --objects --stdin --not --all --quiet\n12:43:07.034718 run-command.c:1553      run_processes_parallel: preparing to run up to 1 tasks\n12:43:07.034753 run-command.c:1585      run_processes_parallel: done\n12:43:07.034796 run-command.c:637       trace: run_command: git gc --auto --quiet\n12:43:07.039832 git.c:415               trace: built-in: git gc --auto --quiet\n12:43:07.050538 git.c:415               trace: built-in: git reset --hard 23580211825877c7ed3be5dd4f2996e67aa40a4e\n12:43:07.074736 git.c:415               trace: built-in: git version\n12:43:07.085179 git.c:659               trace: exec: git-submodule deinit --all --force\n12:43:07.086081 run-command.c:637       trace: run_command: git-submodule deinit --all --force\n12:43:07.124885 git.c:659               trace: exec: git-sh-i18n--envsubst --variables 'usage: $dashless $USAGE'\n12:43:07.125490 run-command.c:637       trace: run_command: git-sh-i18n--envsubst --variables 'usage: $dashless $USAGE'\n12:43:07.138222 git.c:659               trace: exec: git-sh-i18n--envsubst 'usage: $dashless $USAGE'\n12:43:07.138930 run-command.c:637       trace: run_command: git-sh-i18n--envsubst 'usage: $dashless $USAGE'\n12:43:07.158914 git.c:415               trace: built-in: git rev-parse --git-dir\n12:43:07.166961 git.c:415               trace: built-in: git rev-parse --git-path objects\n12:43:07.173881 git.c:415               trace: built-in: git rev-parse -q --git-dir\n12:43:07.187418 git.c:415               trace: built-in: git rev-parse --show-prefix\n12:43:07.193585 git.c:415               trace: built-in: git rev-parse --show-toplevel\n12:43:07.203435 git.c:415               trace: built-in: git submodule--helper deinit --force --all\nFetching gem metadata from https://rubygems.org/\nResolving dependencies...\nUsing bundler 2.0.1\nUsing rack 2.1.0 from https://github.com/rack/rack (at master@2358021)\nBundle complete! 1 Gemfile dependency, 2 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "is_accepted": false, "score": 1, "last_activity_date": 1555528196, "creation_date": 1555528196, "answer_id": 55734457, "question_id": 55732199, "link": "https://stackoverflow.com/questions/55732199/are-there-logs-to-see-git-commands-from-bundler/55734457#55734457", "title": "Are there logs to see git commands from bundler?", "body": "<p>It looks like the issue was with the gem and with bundler at one time recommending the usage of <code>git ls-files</code> to get the list of all files that belong to a gem for the gemspec file.</p>\n\n<p>Changing gemspec.files to use Dir.glob appears to be the solution.</p>\n\n<p>There's more info on the bundler github repo: <a href=\"https://github.com/bundler/bundler/issues/2287\" rel=\"nofollow noreferrer\">https://github.com/bundler/bundler/issues/2287</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555528196, "creation_date": 1555518396, "last_edit_date": 1555523054, "question_id": 55732199, "link": "https://stackoverflow.com/questions/55732199/are-there-logs-to-see-git-commands-from-bundler", "title": "Are there logs to see git commands from bundler?", "body": "<p>I am using <code>bundle install</code> to install some Ruby gems from a mix of public and private git repos.</p>\n\n<p>The issue is that after one particular gem is installed through git, the local directory is polluted with that gem's source code. It's like the git repo has completely changed.</p>\n\n<p>Is there a way to log all the git commands that bundler is running and to make sure it is putting the git repos of gems into the correct path?</p>\n\n<ol>\n<li>add a new gem to Gemfile</li>\n<li>run <code>bundle install</code></li>\n<li><p>check the README.markdown and it now has completely different text in it:</p>\n\n<pre><code># activerecord-import [![Build Status](https://travis-ci.org/zdennis/activerecord-import.svg?branch=master)](https://travis-ci.org/zdennis/activerecord-import)\n</code></pre></li>\n</ol>\n\n<p>To restore my repo, I run <code>git reflog</code> and then <code>git reset --hard</code> to get the right commit back. It looks like during bundle install, the git command run is doing a checkout of a particular branch that overwrites all of the files in my git repo.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1555520365, "post_id": 55732315, "comment_id": 98143880, "body": "The <code>&quot;#{}&quot;</code> around <code>table.table_print</code> here isn&#39;t doing anything. <code>#{}</code> is for string interpolation, but you&#39;re not interpolating <i>with</i> anything. <code>puts table.table_print</code> is all you need here."}], "tags": [], "owner": {"reputation": 21, "user_id": 11375022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EL6BZGzGuro/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rchSYr0OLYyLh1yqA0lyS-IWnkyUA/mo/photo.jpg?sz=128", "display_name": "David Balazs", "link": "https://stackoverflow.com/users/11375022/david-balazs"}, "is_accepted": false, "score": 2, "last_activity_date": 1555523104, "last_edit_date": 1555523104, "creation_date": 1555518886, "answer_id": 55732315, "question_id": 55732096, "link": "https://stackoverflow.com/questions/55732096/capture-output-of-table-print/55732315#55732315", "title": "Capture output of table_print", "body": "<p>as of table_print gem version </p>\n\n<p>you can do this:</p>\n\n<pre><code>table = TablePrint::Printer.new(my_string_data)\ntp_output = table.table_print\nputs tp_output\nHEADER1 | HEADER2 | HEADER3\n--------|---------|--------\nelem1   | elem2   | elem3\nelem1   | elem2   | elem3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 3, "last_activity_date": 1555520785, "creation_date": 1555520785, "answer_id": 55732762, "question_id": 55732096, "link": "https://stackoverflow.com/questions/55732096/capture-output-of-table-print/55732762#55732762", "title": "Capture output of table_print", "body": "<p>There's no need to create an instance of <code>TablePrint::Printer</code> as in the accepted answer. That class has a <code>table_print</code> static method that does the work for you:</p>\n\n<pre><code>data = [\n  {'header1' =&gt; 'elem1', 'header2' =&gt; 'elem2', 'header3' =&gt; 'elem3'},\n  {'header1' =&gt; 'elem1', 'header2' =&gt; 'elem2', 'header3' =&gt; 'elem3'}\n]\n\nstr = TablePrint::Printer.table_print(data)\n\nputs str\n# =&gt; HEADER1 | HEADER2 | HEADER3\n#    --------|---------|--------\n#    elem1   | elem2   | elem3  \n#    elem1   | elem2   | elem3\n</code></pre>\n\n<p>See it in action on repl.it: <a href=\"https://repl.it/@jrunning/CrimsonVibrantMath\" rel=\"nofollow noreferrer\">https://repl.it/@jrunning/CrimsonVibrantMath</a></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1555525984, "creation_date": 1555525984, "answer_id": 55733965, "question_id": 55732096, "link": "https://stackoverflow.com/questions/55732096/capture-output-of-table-print/55733965#55733965", "title": "Capture output of table_print", "body": "<p>You could temporarily redirect <code>STDOUT</code>.</p>\n\n<pre><code>str = &lt;&lt;_\n# =&gt; HEADER1 | HEADER2 | HEADER3\n#    --------|---------|--------\n#    elem1   | elem2   | elem3  \n#    elem1   | elem2   | elem3\n_\n\nio = StringIO.new\n  #=&gt; #&lt;StringIO:0x0000557df4b227b8&gt;\n$stdout = io\n\nputs str\n$stdout = STDOUT\n\ns = io.string.lines[1..-2]\nputs s\n# =&gt; HEADER1 | HEADER2 | HEADER3\n#    --------|---------|--------\n#    elem1   | elem2   | elem3  \n#    elem1   | elem2   | elem3\n</code></pre>\n"}], "owner": {"reputation": 1833, "user_id": 2564199, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e7de6198991a53a6c0da7ef3f5011725?s=128&d=identicon&r=PG", "display_name": "Pauline", "link": "https://stackoverflow.com/users/2564199/pauline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55732762, "answer_count": 3, "score": 0, "last_activity_date": 1555525984, "creation_date": 1555518023, "last_edit_date": 1555519236, "question_id": 55732096, "link": "https://stackoverflow.com/questions/55732096/capture-output-of-table-print", "title": "Capture output of table_print", "body": "<p><code>table_print</code> is a gem to format your strings in a table.</p>\n\n<p>I would like to capture the output of <code>table_print</code> in a variable to eventually write it to a file.</p>\n\n<p>Taking the below string:</p>\n\n<pre><code>my_string_data = [\n   {'header1' =&gt; 'elem1', 'header2' =&gt; 'elem2', 'header3' =&gt; 'elem3'},\n   {'header1' =&gt; 'elem1', 'header2' =&gt; 'elem2', 'header3' =&gt; 'elem3'}\n]\n</code></pre>\n\n<p>I can print it nicely with <code>table_print</code>:</p>\n\n<pre><code>tp my_string_data\nHEADER1 | HEADER2 | HEADER3\n--------|---------|--------\nelem1   | elem2   | elem3\nelem1   | elem2   | elem3\n=&gt; 0.00036\n</code></pre>\n\n<p>However I can't seem to be able to capture the output because <code>tp</code> actually returns a <code>float</code>:</p>\n\n<pre><code>tp_output = tp my_string_data\nHEADER1 | HEADER2 | HEADER3\n--------|---------|--------\nelem1   | elem2   | elem3\nelem1   | elem2   | elem3\n=&gt; 0.000367\n\ntp_output\n=&gt; 0.000367\n</code></pre>\n\n<p>Is there a way to return the string, not the float, so that I can have a variable containing my string?</p>\n"}, {"tags": ["ruby", "unit-testing", "private-methods"], "comments": [{"owner": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "edited": false, "score": 0, "creation_date": 1555516412, "post_id": 55731560, "comment_id": 98141906, "body": "Why would you think testing private methods is not good practice?"}, {"owner": {"reputation": 9845, "user_id": 119822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/wnqih.jpg?s=128&g=1", "display_name": "Andy Waite", "link": "https://stackoverflow.com/users/119822/andy-waite"}, "reply_to_user": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "edited": false, "score": 2, "creation_date": 1555518360, "post_id": 55731560, "comment_id": 98142922, "body": "@CarlMarkham because doing so means you tests are coupled to a particular implementation, which can make it more difficult to refactor."}, {"owner": {"reputation": 4501, "user_id": 5747415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WgeaU.jpg?s=128&g=1", "display_name": "Dirk Herrmann", "link": "https://stackoverflow.com/users/5747415/dirk-herrmann"}, "edited": false, "score": 0, "creation_date": 1555805344, "post_id": 55731560, "comment_id": 98229277, "body": "The goal of unit-testing is to find bugs.  Different implementations, different bugs.  For example, coverage looks at implementation, not at interface.  Thus, tests should be designed to (also) test implementation details.  Certainly, fragile tests are not desirable, but don&#39;t revert the priorities: Primary goal is finding bugs, secondary goal is avoiding unnecessarily fragile tests."}], "answers": [{"tags": [], "owner": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "is_accepted": false, "score": 2, "last_activity_date": 1557434787, "last_edit_date": 1557434787, "creation_date": 1555669366, "answer_id": 55760358, "question_id": 55731560, "link": "https://stackoverflow.com/questions/55731560/how-to-avoid-overtesting-of-a-private-methods-behavior/55760358#55760358", "title": "How to avoid overtesting of a private method&#39;s behavior?", "body": "<p><strong>Direct answer</strong></p>\n\n<p>Test the module directly:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def test_redis_key_namespacing\n  dummy_class = Class.new do # this anonymous class will not pollute namespace\n    include RedisHelper\n\n    public :key_for\n\n    def self.name\n      'Dummy'\n    end\n  end\n\n  assert_equal 'Dummy-hello', dummy_class.new.key_for('hello')\nend\n</code></pre>\n\n<p><strong>Overall Suggestion</strong></p>\n\n<p>I recommend not using a <code>RedisHelper</code> module. It's good that you're trying to keep \"Redis namespacing code\" logic together and separated from other code, but what you really have is \"Redis namespacing code\" all over the place.</p>\n\n<p><code>key_for</code> is in both <code>X</code> and <code>Y</code> -- they have to handle the namespacing themselves every call to redis. Also, both <code>key_for</code> &amp; <code>prefix</code> can be called in any of those classes (<em>and</em> subclasses <em>and</em> any other included modules) even though they're both internal to \"Redis namespacing\".</p>\n\n<p>It looks like \"Redis key namespacing\" is an important concept in your application. It's reused in multiple places by different unrelated areas. Make it \"a thing\":</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class NsRedis\n  key_methods = Redis.instance_methods(false).select do |m|\n    Redis.instance_method(m).parameters.first == [:req, :key]\n  end\n\n  # some metaprogramming, but it's static, much better than method_missing!\n  key_methods.each do |m_name|\n    define_method(m_name) do |key, *args|\n      Redis.current.public_send(\"#{@namespace}:#{key}\", *args)\n    end\n  end\n\n  def initialize(namespace)\n    @namespace = namespace\n  end\nend\n\n# Now, anywhere you're going to need it, including tests:\nclass X\n  def initialize\n    @redis = NsRedis.new(self.class.name)\n  end\n\n  def do_something\n    @redis.set(:my_key, 'my_val') # \"unaware\" of the namespacing at usage\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1555672427, "creation_date": 1555672427, "answer_id": 55760976, "question_id": 55731560, "link": "https://stackoverflow.com/questions/55731560/how-to-avoid-overtesting-of-a-private-methods-behavior/55760976#55760976", "title": "How to avoid overtesting of a private method&#39;s behavior?", "body": "<p>In RSpec you can use <a href=\"https://relishapp.com/rspec/rspec-core/docs/example-groups/shared-examples\" rel=\"nofollow noreferrer\">shared examples</a>:</p>\n\n<pre><code>RSpec.shared_examples \"Redis namespacing helper\" do\n  # your tests for key_for, prefix and what-have-you\nend\n\nRSpec.describe X do\n  it_behaves_like \"Redis namespacing helper\"\nend\n\nRSpec.describe Y do\n  it_behaves_like \"Redis namespacing helper\"\nend\n</code></pre>\n\n<p>In minitest this is probably handled by simply including the module with shared tests.</p>\n"}], "owner": {"reputation": 1667, "user_id": 1519240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/93e7c3474b4ee4d36d761eb18d648bc6?s=128&d=identicon&r=PG", "display_name": "user1519240", "link": "https://stackoverflow.com/users/1519240/user1519240"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1557434787, "creation_date": 1555516247, "last_edit_date": 1555517878, "question_id": 55731560, "link": "https://stackoverflow.com/questions/55731560/how-to-avoid-overtesting-of-a-private-methods-behavior", "title": "How to avoid overtesting of a private method&#39;s behavior?", "body": "<p><strong>Given that:</strong></p>\n\n<ul>\n<li>Testing private methods is not a good practice.</li>\n<li>An interface with many public methods is not a good practice either.</li>\n</ul>\n\n<p>Suppose I have the following code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module RedisHelper\n  private\n\n  def key_for(id)\n    [prefix, id].join('-')\n  end\n\n  def prefix\n    self.class.name.split('::').last.underscore\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class X\n  include RedisHelper\n\n  def perform(id)\n    key = key_for(id)\n    redis.sadd(key, [:bar])\n  end\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Y\n  include RedisHelper\n\n  def perform(id)\n    key = key_for(id)\n    redis.set(key, :foo)\n  end\nend\n</code></pre>\n\n<p>What would be the best way to test the behavior of <code>key_for</code>/<code>prefix</code> methods without overtesting them? I wouldn't like to repeat its logic when testing classes <code>X</code> and <code>Y</code>.</p>\n\n<p>I don't think that turning <code>RedisHelper</code>'s methods public is good, because they would be public in <code>X</code> and <code>Y</code> also.</p>\n"}, {"tags": ["mysql", "ruby", "mysql2"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1555514439, "post_id": 55730711, "comment_id": 98140755, "body": "Shouldn&#39;t you call a function without <code>=</code> in between?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1555513533, "creation_date": 1555513533, "answer_id": 55730746, "question_id": 55730711, "link": "https://stackoverflow.com/questions/55730711/cant-connect-to-database-via-ruby-and-mysql2/55730746#55730746", "title": "Can&#39;t connect to database via Ruby and MySQL2", "body": "<p>The error message is pretty clear: it does not exist a <code>query=</code> method, but <code>query</code> does. Try</p>\n\n<pre><code>result = connection.query(\"INSERT INTO datacheck(#{info.keys}) VALUES #{info.values}\")\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11374585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LvS2WAPCbgM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdhrXCPMLpuw3zZnKhNTjlhDatn5Q/mo/photo.jpg?sz=128", "display_name": "Dusan Jolovic", "link": "https://stackoverflow.com/users/11374585/dusan-jolovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555513533, "creation_date": 1555513427, "last_edit_date": 1555513459, "question_id": 55730711, "link": "https://stackoverflow.com/questions/55730711/cant-connect-to-database-via-ruby-and-mysql2", "title": "Can&#39;t connect to database via Ruby and MySQL2", "body": "<p>When I try to connect to database via Ruby I'm getting this error :</p>\n\n<pre><code>conn.rb:16:in `&lt;main&gt;': undefined method `query=' for #&lt;Mysql2::Client:0x2ee5190&gt; (NoMethodError)\nDid you mean?  query\n               _query\n</code></pre>\n\n<p>My code is :</p>\n\n<pre><code>require 'mysql2'\n\nconnection = Mysql2::Client.new(:host =&gt; \"localhost\", :username =&gt; \"root\",:password =&gt; \"\",:database =&gt; \"ruby\")\n\nresult = connection.query = (\"INSERT INTO datacheck(#{info.keys}) VALUES #{info.values}\")\n</code></pre>\n\n<p>Seems that everything is working until this line </p>\n\n<pre><code>result = connection.query = (\"INSERT INTO datacheck(#{info.keys}) VALUES #{info.values}\")\n</code></pre>\n\n<p>I'm looking for someone who can help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1555513496, "post_id": 55729823, "comment_id": 98140119, "body": "Each engine (gem) should run its test suite as part of its <i>own</i> deployment process - i.e. you do not publish a new version of the engine (gem) unless the tests pass."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1555513584, "post_id": 55729823, "comment_id": 98140193, "body": "You don&#39;t need to run tests for gems as part of the main application deployment, because these have already been tested. Just like you don&#39;t run the test suite for every other gem in your <code>Gemfile.lock</code>."}, {"owner": {"reputation": 510, "user_id": 1681160, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e63ad19a0af6a6de9341425dfc537b95?s=128&d=identicon&r=PG", "display_name": "Sixers17", "link": "https://stackoverflow.com/users/1681160/sixers17"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1555529298, "post_id": 55729823, "comment_id": 98147821, "body": "Thanks @TomLord that totally makes sense. Thanks for clearing that up."}], "owner": {"reputation": 510, "user_id": 1681160, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e63ad19a0af6a6de9341425dfc537b95?s=128&d=identicon&r=PG", "display_name": "Sixers17", "link": "https://stackoverflow.com/users/1681160/sixers17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555511027, "creation_date": 1555511027, "question_id": 55729823, "link": "https://stackoverflow.com/questions/55729823/running-rspecs-from-mounted-gems", "title": "Running Rspecs From Mounted Gems", "body": "<p>I have a Ruby on Rails monolithic project that incorporates several mounted engines. Each mounted engine (gem) has its own test suite. I want to know if there's a way that when I push code up in the parent project, it runs the rspecs in all of the engines in addition to its own.</p>\n\n<p>Here's what the structure looks like:</p>\n\n<pre><code>- Core\n  - Engine_1\n  - Engine_2\n</code></pre>\n\n<p><code>Core</code> has a <code>spec/</code> folder with its own tests relative to its codebase, and each engine has its own <code>spec/</code> folder within the gem.</p>\n\n<p>When I deploy code changes from core, and run it through a CI, I want to be able to run a <code>rspec</code> command that runs the test from <code>Core</code> but also from all its engine parts. Is there a way to accomplish this? I hope it makes sense.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555520748, "post_id": 55730018, "comment_id": 98144051, "body": "Hello! Thanks for your response. I have amended my code and now it does indeed redirect to the right page (my show page) which is great! However the strange thing is that the comments do not show up on my show page :S Also when I go to the console and do Rails c  - Comment.all it shows as an empty array, strange no? Any ideas. Thank you Angela"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555522033, "post_id": 55730018, "comment_id": 98144602, "body": "Is this what you mean: <code>Hairstyle Load (0.9ms)  SELECT  &quot;hairstyles&quot;.* FROM &quot;hairstyles&quot; WHERE &quot;hairstyles&quot;.&quot;id&quot; = $1 LIMIT $2  [[&quot;id&quot;, 2], [&quot;LIMIT&quot;, 1]]  \u21b3 app&#47;controllers&#47;comments_controller.rb:9    (0.2ms)  BEGIN   \u21b3 app&#47;controllers&#47;comments_controller.rb:10    (0.6ms)  ROLLBACK   \u21b3 app&#47;controllers&#47;comments_controller.rb:10    (0.7ms)  BEGIN   \u21b3 app&#47;controllers&#47;comments_controller.rb:11    (0.4ms)  ROLLBACK   \u21b3 app&#47;controllers&#47;comments_controller.rb:11 Redirected to http:&#47;&#47;localhost:3000&#47;hairstyles&#47;2 Completed 302 Found in 160ms (ActiveRecord: 2.9ms)</code>"}, {"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555522359, "post_id": 55730018, "comment_id": 98144744, "body": "Typically, when you&#39;re experiencing bugs, it&#39;s helpful to repeat your action (eg. CREATE a comment) and look at your logs. Don&#39;t post logs in comments but append them to your original question. I can see from your logs that it&#39;s performing a &quot;ROLLBACK&quot;. Your comments are not being saved."}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555523286, "post_id": 55730018, "comment_id": 98145224, "body": "Oh ok oops newbie here. I was thinking how I could avoid pasting all of that in a comment. I will do that next time. Yes it&#39;s rolling back at line 9 which is this  <code>@hairstyle.comments &lt;&lt; @comment</code> I&#39;ll keep looking.Thanks"}, {"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555523542, "post_id": 55730018, "comment_id": 98145325, "body": "I can tell you that it&#39;s probably because model validation failed. Does the model <code>Hairstyle</code> have the line <code>has_many :comments</code> in it? Does the <code>Comment</code> model have special validations that are failing (eg. must have text inside it)?"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555582990, "post_id": 55730018, "comment_id": 98164755, "body": "Hello yes my validations are correct. I am pulling my hair out about this. I am not sure if this is allowed on here but if you could quickly check my repo on github I&#39;d be forever grateful. I do not know what the issue is :( <a href=\"https://github.com/Angela-Inniss/hair-do\" rel=\"nofollow noreferrer\">github.com/Angela-Inniss/hair-do</a>"}, {"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555599118, "post_id": 55730018, "comment_id": 98174018, "body": "Check my updated solution. I&#39;ve edited my original answer after testing your app"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555695672, "post_id": 55730018, "comment_id": 98205796, "body": "Hi! Thank you so much for your detailed response. I am  a baby rubyist and things still aren&#39;t making that much sense at the moment so I just try things out and see ( which you can see). I will add the hairdresser migration. One last question: when you say &quot; everything is required by you&quot; do you mean that I have validations on everything? I.e&quot; validates xx presence true&quot;&quot;. Are you saying that you only validate what is necessary and less is more? Thanks! Angela :)"}, {"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555696664, "post_id": 55730018, "comment_id": 98206152, "body": "Yes, this is more a matter of subjectivity, but I believe validating the &quot;presence true&quot; on everything is really restrictive. Users don&#39;t like having to fill out 10 fields in a form to get started. Like, for example, StackOverflow doesn&#39;t require that you fill out your entire profile before you can save and move on. If you put &quot;presence true&quot; on all of those fields, it&#39;s going to be cumbersome! Plus, why force people to add data? That only means you have to pay for that extra storage! I generally only require the things that would be breaking my app if they didn&#39;t exist."}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555742671, "post_id": 55730018, "comment_id": 98215178, "body": "Hehe ok good advice ill take that on board going forward! I think ill stop adding features for now and tidy up my code first. Thanks for the help and advice again. I&#39;ll test when I&#39;m back at a computer and post if it works. Until then... :)"}], "tags": [], "owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "is_accepted": false, "score": 0, "last_activity_date": 1555599092, "last_edit_date": 1555599092, "creation_date": 1555511517, "answer_id": 55730018, "question_id": 55729319, "link": "https://stackoverflow.com/questions/55729319/no-route-matches-so-i-cannot-display-my-comments-on-my-show-page/55730018#55730018", "title": "No route matches so I cannot display my comments on my show page", "body": "<p>This is the error message which indicates your problem.</p>\n\n<pre><code>No route matches {:action=&gt;\"show\", :controller=&gt;\"hairstyles\", :id=&gt;nil}, \nmissing required keys: [:id]\n</code></pre>\n\n<p>It is trying to go to the <em>show</em> action in the <em>hairstyles</em> controller without an ID param.  Why is it trying to go there?</p>\n\n<pre><code>def create\n  @comment = Comment.new(comment_params)\n  @hairstyle = Hairstyle.find(params[:hairstyle_id])\n  @comment.save\n  redirect_to hairstyle_path(@comment.hairstyle) # this line\nend\n</code></pre>\n\n<p><code>@comment</code> does not have a hairstyle. You need to add the association with something like:</p>\n\n<pre><code>def create\n  @comment = Comment.new(comment_params)\n  @hairstyle = Hairstyle.find(params[:hairstyle_id])\n  @hairstyle.comments &lt;&lt; @comment\n  @comment.save\n  redirect_to hairstyle_path(@comment.hairstyle)\nend\n</code></pre>\n\n<p><strong>Edit</strong> after seeing the repo I was able to track down the issues and sort it out.</p>\n\n<p>Quick tips:</p>\n\n<ol>\n<li>Your logs are not telling you why your model validation is failing. So, you want to make sure you're running this in development, catch errors, and log them. (eg. you can user <code>save!</code> instead of <code>save</code> to ensure it throws errors. </li>\n<li>Your code is a little wiry. I recommend reading up on best practices for Ruby on Rails. You should really also have tests in your repo. </li>\n</ol>\n\n<p><strong>Solution</strong> (as far as I could test without doing it all):</p>\n\n<p>in <code>hairstyle.rb</code> model you have these lines:</p>\n\n<pre><code>validates :content, presence: true\nvalidates :content, length: { minimum: 20 }\n</code></pre>\n\n<p>But <code>Hairstyle</code> doesn't have a content field. So right off the bat, you can't save any Hairstyles (at least I couldn't).</p>\n\n<p>in <code>comment.rb</code> model you have this line:</p>\n\n<pre><code> belongs_to :hairdresser\n</code></pre>\n\n<p>But in your Schema, <code>Comment</code> does not have a <code>hairdresser_id</code> field. So validation fails because <code>Hairdresser must exist</code> is thrown. But then when I include a Hairdresser, it throws <code>(can't write unknown attribute hairdresser_id)</code>. So, you're going to want to run this migration:</p>\n\n<pre><code>rails g migration AddHairdresserToComments hairdresser:references\n</code></pre>\n\n<p>That should just about fix it. </p>\n\n<p>Of course, you'll need to make sure that you're passing all of the correct parameters along the way. I had a tough time testing your models because <em>everything</em> is required by you. Personally, I like to keep it simple. <em>Only</em> require that which is absolutely necessary. Everything else should be left up to the user.</p>\n"}, {"tags": [], "owner": {"reputation": 15480, "user_id": 229688, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FVcL0.jpg?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/229688/arnaud"}, "is_accepted": false, "score": 0, "last_activity_date": 1555511577, "creation_date": 1555511577, "answer_id": 55730050, "question_id": 55729319, "link": "https://stackoverflow.com/questions/55729319/no-route-matches-so-i-cannot-display-my-comments-on-my-show-page/55730050#55730050", "title": "No route matches so I cannot display my comments on my show page", "body": "<p>At no point do you associate the comment to the hairstyle, so when you write</p>\n\n<pre><code>def create\n  `\u2026`\n  redirect_to hairstyle_path(@comment.hairstyle)\nend\n</code></pre>\n\n<p>@comment.hairstyle is nil, hence your error.</p>\n\n<p>Update your create method to the following and that should do it</p>\n\n<pre><code>def create\n  @hairstyle = Hairstyle.find(params[:hairstyle_id])\n  @comment = @hairstyle.comments.new(comment_params)\n  @comment.save\n  redirect_to hairstyle_path(@comment.hairstyle)\nend\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555599092, "creation_date": 1555509608, "question_id": 55729319, "link": "https://stackoverflow.com/questions/55729319/no-route-matches-so-i-cannot-display-my-comments-on-my-show-page", "title": "No route matches so I cannot display my comments on my show page", "body": "<p>Hello I am trying to display my comments on my show page. </p>\n\n<p>I have created the comments controller and rendered a page to display the comments on the show page however when I create a comment I get a routing error. Please see error below:</p>\n\n<p>error message: \n<code>No route matches {:action=&gt;\"show\", :controller=&gt;\"hairstyles\", :id=&gt;nil}, missing required keys: [:id]</code></p>\n\n<p>The behaviour I would like is for when the user creates a comment it redirects to the show page and shows the comment.</p>\n\n<p>Thank you in advance!</p>\n\n<p>comments controller:</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def new\n    @hairstyle = Hairstyle.find(params[:hairstyle_id])\n    @comment = Comment.new\n  end\n\n\ndef create\n    @comment = Comment.new(comment_params)\n    @hairstyle = Hairstyle.find(params[:hairstyle_id])\n    @comment.save\n    redirect_to hairstyle_path(@comment.hairstyle)\nend\n\n\n  def destroy\n  end\nend\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:content)\n  end\n\n\n</code></pre>\n\n<p>show page:</p>\n\n<pre><code>show.html.erb\n\n&lt;div class=\"container\"&gt;\n  &lt;div&gt;\n    &lt;%= cl_image_tag @hairstyle.photo, width: 300, height: 200, crop: :fill %&gt;\n    &lt;h1&gt;&lt;%= @hairstyle.name %&gt;&lt;/h1&gt;\n    &lt;p&gt;&lt;%= @hairstyle.description%&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;%= @hairstyle.category%&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;%= @hairstyle.video_url %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n &lt;div&gt;\n    &lt;%= link_to 'Back', hairstyles_path %&gt;\n &lt;/div&gt;\n\n&lt;h6&gt;Comments for: &lt;%= @hairstyle.name %&gt; &lt;small&gt;&lt;%= %&gt;&lt;/small&gt;&lt;/h6&gt;\n&lt;h2&gt;\n  &lt;%= pluralize @hairstyle.comments.size, \"comment\" %&gt;\n&lt;/h2&gt;\n\n&lt;div id=\"comments\"&gt;\n  &lt;% if @hairstyle.comments.blank? %&gt;\n    Be the first to leave a comment for &lt;%= @hairstyle.name %&gt;\n  &lt;% else %&gt;\n    &lt;% @hairstyle.comments.each do |comment| %&gt;\n      &lt;%= render 'comments/show', comment: comment %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;%= render 'comments/form', comment: @comment %&gt;\n\n</code></pre>\n\n<p>comments/show page which is rendered above:</p>\n\n<pre><code>&lt;p&gt;&lt;%= comment.content %&gt;&lt;/p&gt;\n\n\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n  root to: 'pages#home'\n  devise_for :users\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  resources :hairstyles do\n  resources :comments, only: [:new, :create ]\n  resources :saved_hairstyles, only: [:new, :create]\nend\n\n  resources :saved_recipes, only: :destroy\n  resources :comments, only: :destroy\n  resources :hairdressers\nend\n\n</code></pre>\n\n<p>thanks in advance :)</p>\n"}, {"tags": ["arrays", "ruby", "duplicates"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555537428, "post_id": 55728379, "comment_id": 98150843, "body": "<code>&#39;_nodes&#39;</code> is a string. Strings don&#39;t have a method <code>each</code>, so <code>(&#39;_nodes&#39;).each</code> will raise a no-method exception. All of us giving answers assumed that strings were contained in an array. Your edit suggests otherwise, but you haven&#39;t told us where they are coming from. Are they being returned one at a time by some unstated method, being read from a file, or what? As an aside, it&#39;s almost never a good idea to use global variables, except perhaps when debugging."}, {"owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555540397, "post_id": 55728379, "comment_id": 98151596, "body": "As per engineersmnky&#39;s question: (&#39;_node&#39;) is referring to a table within a database that I&#39;m editing - should have made this clearer!"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "edited": false, "score": 0, "creation_date": 1555536245, "post_id": 55728687, "comment_id": 98150447, "body": "Hello and thank you for the reply. All the responses so far have been helpful - I have updated my original post at the bottom to elaborate further and enquire more if you have a moment!"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1555515979, "last_edit_date": 1555515979, "creation_date": 1555507716, "answer_id": 55728687, "question_id": 55728379, "link": "https://stackoverflow.com/questions/55728379/ruby-how-to-append-unique-values-to-duplicates-e-g-value-value-2-value-3/55728687#55728687", "title": "Ruby: How to append unique values to duplicates? E.g (value, value_2, value_3)", "body": "<p>This is just an idea, maybe can help.</p>\n\n<p>Let's say this is your array of <code>names</code>:</p>\n\n<pre><code>names = ['a', 'b', 'c', 'a', 'a', 'c', 'b', 'e']\n</code></pre>\n\n<p>This is one option to rename the elements:</p>\n\n<pre><code>tmp = names.each_with_object(Hash.new(0)) { |e, h| h[e] += 1 }\n#=&gt; {\"a\"=&gt;3, \"b\"=&gt;2, \"c\"=&gt;2, \"e\"=&gt;1}\n</code></pre>\n\n<p>So basically it counts the element and generates the hash above. Then map the hash to rebuild the array appending the variation:</p>\n\n<pre><code>tmp.each_with_object([]) { |(k, v), a| a &lt;&lt; ([k]*v).map.with_index { |e, i| e + \"_#{i}\" }  }\n#=&gt; [[\"a_0\", \"a_1\", \"a_2\"], [\"b_0\", \"b_1\"], [\"c_0\", \"c_1\"], [\"e_0\"]]\n</code></pre>\n\n<p>Of course, you can skip appending the index if <code>v == 1</code>:</p>\n\n<pre><code>{ |e, i| v == 1 ? e : e + \"_#{i}\" }\n</code></pre>\n\n<p>The methods used are explained here: <a href=\"https://ruby-doc.org/core-2.6.2/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a>, <a href=\"https://ruby-doc.org/core-2.6.2/Hash.html\" rel=\"nofollow noreferrer\">Hash</a>, <a href=\"https://ruby-doc.org/core-2.6.2/Array.html\" rel=\"nofollow noreferrer\">Array</a>\n<hr>\nThe second part can be refactored to:</p>\n\n<pre><code>tmp.flat_map { |k, v| v.times.map { |i| v == 1 ? k : k + \"_#{i}\" } }\n#=&gt; [\"a_0\", \"a_1\", \"a_2\", \"b_0\", \"b_1\", \"c_0\", \"c_1\", \"e\"]\n</code></pre>\n\n<p>And a one liner, just for fun:</p>\n\n<pre><code>names.each_with_object(Hash.new(0)) { |e, h| h[e] += 1 }.flat_map { |k, v| v.times.map { |i| v == 1 ? k : k + \"_#{i}\" } }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1555516552, "post_id": 55729634, "comment_id": 98141981, "body": "I like <code>.group_by(&amp;:itself)</code>, which is also the fastest."}, {"owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "edited": false, "score": 0, "creation_date": 1555536161, "post_id": 55729634, "comment_id": 98150401, "body": "Hi there, thanks for the response - definitely useful. I have updated my original post at the bottom to elaborate further and enquire more."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "edited": false, "score": 0, "creation_date": 1555537603, "post_id": 55729634, "comment_id": 98150900, "body": "@Ryan when you say &quot;table&quot; are you referring to a database? This could be alot simpler if so."}, {"owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "edited": false, "score": 0, "creation_date": 1555540363, "post_id": 55729634, "comment_id": 98151588, "body": "Yes (&#39;_node&#39;) is referring to a table within a database that I&#39;m editing - should have made this clearer!"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1555514455, "last_edit_date": 1555514455, "creation_date": 1555510424, "answer_id": 55729634, "question_id": 55728379, "link": "https://stackoverflow.com/questions/55728379/ruby-how-to-append-unique-values-to-duplicates-e-g-value-value-2-value-3/55729634#55729634", "title": "Ruby: How to append unique values to duplicates? E.g (value, value_2, value_3)", "body": "<p>Different twists on the same concept posted by @iGian</p>\n\n<pre><code>names = ['a', 'b', 'c', 'a', 'a', 'c', 'b', 'e']\n\nnames.group_by(&amp;:itself).flat_map do |k,v| \n  v.size.times.map {|n| n.zero? ? k : \"#{k}_#{n}\"}\nend\n</code></pre>\n\n<p>The sort order will change based on the occurrence of unique elements in the list</p>\n\n<p>OR </p>\n\n<pre><code>names.sort.chunk_while {|a,b| a == b }.flat_map do |a| \n  a.map.with_index {|b,idx| idx.zero? ? b : \"#{b}_#{idx}\"}\nend\n</code></pre>\n\n<p>The sort order will change based on natural sorting of the element list.</p>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "edited": false, "score": 0, "creation_date": 1555536321, "post_id": 55732372, "comment_id": 98150471, "body": "Hello! Thanks for your input - another useful technique which definitely looks promising. I was having a bit of an issue with the word count so I have updated my initial post at the bottom for further elaboration/queries!"}, {"owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "edited": false, "score": 0, "creation_date": 1555540520, "post_id": 55732372, "comment_id": 98151616, "body": "Thanks for the additional information, I&#39;ll have a look into it in the morning - assuming my other comment doesn&#39;t have an effect on it!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1555540993, "last_edit_date": 1555540993, "creation_date": 1555519145, "answer_id": 55732372, "question_id": 55728379, "link": "https://stackoverflow.com/questions/55728379/ruby-how-to-append-unique-values-to-duplicates-e-g-value-value-2-value-3/55732372#55732372", "title": "Ruby: How to append unique values to duplicates? E.g (value, value_2, value_3)", "body": "<p>This approach makes a single pass through the array and maintains order.</p>\n\n<pre><code>names = ['21_1', '34', '49_2', '21_1', '21_1', '49_2', '14_2']\n\nnxt_hash = {}\nnames.map do |name|\n  next name unless name.include?('_')\n  prefix, _, suffix = name.partition('_')\n  nxt = nxt_hash[name] || suffix.to_i\n  nxt_hash[name] = nxt + 1\n  \"%s_%d\" % [prefix, nxt]\nend\n  #=&gt; [\"21_1\", \"34\", \"49_2\", \"21_2\", \"21_3\", \"49_3\", \"14_2\"]\n</code></pre>\n\n<p>When finished,</p>\n\n<pre><code>nxt_hash\n  #=&gt; {\"21_1\"=&gt;4, \"49_2\"=&gt;4, \"14_2\"=&gt;3}\n</code></pre>\n\n<p>This approach would be modified ever-so-slightly if you are processing strings one-at-a-time, as you would if you were reading from a file or a database, or they were being returned individually by a method.</p>\n\n<p>Let's define an enumerator that will generate names one at a time.</p>\n\n<pre><code>enum = names.to_enum\n  #=&gt; #&lt;Enumerator: [\"21_1\", \"34\", \"49_2\", \"21_1\", \"21_1\", \"49_2\", \"14_2\"]:each&gt;\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>enum.next  #=&gt; \"21_1\" \nenum.next  #=&gt; \"34\" \nenum.next  #=&gt; \"49_2\" \nenum.next  #=&gt; \"21_1\" \nenum.next  #=&gt; \"21_1\" \nenum.next  #=&gt; \"49_2\" \nenum.next  #=&gt; \"14_2\" \nenum.next  #=&gt; StopIteration (iteration reached an end)\n</code></pre>\n\n<p>and so on. We can now build the desired array (<code>arr</code>) as follows.</p>\n\n<pre><code>enum = names.to_enum\narr = []\nnxt_hash = {}\nloop do\n  name = enum.next\n  unless name.include?('_')\n    arr &lt;&lt; name\n    next\n  end\n  prefix, _, suffix = name.partition('_')\n  nxt = nxt_hash[name] || suffix.to_i\n  nxt_hash[name] = nxt + 1\n  arr &lt;&lt; \"%s_%d\" % [prefix, nxt]\nend\narr\n  #=&gt; [\"21_1\", \"34\", \"49_2\", \"21_2\", \"21_3\", \"49_3\", \"14_2\"] \n</code></pre>\n\n<p>Here <code>enum.next</code> (see <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\">Enumerator#next</a>) returns a <code>StopIteration</code> exception when it has no more elements to generate. <a href=\"http://ruby-doc.org/core-2.5.1/Kernel.html#method-i-loop\" rel=\"nofollow noreferrer\">Kernel#loop</a> handles that expression by breaking out of the loop. If each <code>name</code> is supplied by a method or forms a line that is read from a file or database, you will have other ways of breaking out of the loop, but my use of an enumerator simulates all ways of generating <code>name</code>s one at a time.</p>\n\n<p>This approach can modified to address a more general problem.</p>\n\n<pre><code>names = ['a', 'b', 'c', 'a', 'a', 'c', 'b', 'e']\n\nnxt_hash = {}\nnames.map do |name|\n  nxt = nxt_hash[name]\n  nxt_hash[name] = nxt.to_i + 1\n  nxt.nil? ? name : \"%s_%s\" % [name, nxt]\nend\n  #=&gt; [\"a\", \"b\", \"c\", \"a_1\", \"a_2\", \"c_1\", \"b_1\", \"e\"]  \n</code></pre>\n\n<p>When finished,</p>\n\n<pre><code>nxt_hash\n  #=&gt; {\"a\"=&gt;3, \"b\"=&gt;2, \"c\"=&gt;2, \"e\"=&gt;1}\n</code></pre>\n\n<p>Note: <code>nil.to_i #=&gt; 0</code>.</p>\n"}], "owner": {"reputation": 141, "user_id": 8471055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba8a6001aa89e2865082b57e05efc2?s=128&d=identicon&r=PG&f=1", "display_name": "rpg", "link": "https://stackoverflow.com/users/8471055/rpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 55732372, "answer_count": 3, "score": 0, "last_activity_date": 1555540993, "creation_date": 1555506809, "last_edit_date": 1555536109, "question_id": 55728379, "link": "https://stackoverflow.com/questions/55728379/ruby-how-to-append-unique-values-to-duplicates-e-g-value-value-2-value-3", "title": "Ruby: How to append unique values to duplicates? E.g (value, value_2, value_3)", "body": "<p>I'm using software that won't allow duplicate values for the field \"Node_ID\", the nodes are a collection of objects with multiple fields (e.g X co-ordinate, Y co-ordinate, elevation). I am looking to rename the Node_Ids for all the nodes to a new format, but struggling to append a unique number for any duplicates encountered.</p>\n\n<p>Based on other threads I've read, I have tried to located any duplicates using the following:</p>\n\n<pre><code>array.include?(node)\n\nduplicates = array.select{|element| array.count(element) &gt; 1}\n</code></pre>\n\n<p>I'm at a point where the code appears to recognise a duplicate and appends \"_1\" to the duplicate node, however if there is yet another duplicate it also appends \"_1\"...</p>\n\n<pre><code>$array = Array.new    # this is a temporary array I have been using to store the written Node_IDs, to check against for duplicates.\nxy_nodes = ('_nodes').each do |xy|\n    x1 = xy.x.to_i\n    y1 = xy.y.to_i\n    x = x1.to_s.rjust(7, \"0\")\n    y = y1.to_s.rjust(7, \"0\")\n    node = x+y\n        # the above was just getting it to the correct format, no issues there\n    if $array.include?(node)\n        i=0\n        node = node + \"_#{i+1}\"    # this is where things need sorted, clearly as it stands this would only result in _1 being added for the duplicates, however I'm struggling to iterate and check against duplicates after the first to continue adding _1, _2, _3 as suffixes.\n        $array &lt;&lt; node\n        $checkmsg &lt;&lt; node    # this array is used later\n        xy.user_text = node    # used for writing to as this field can accept duplicates\n        xy.write\n    else\n        puts \"...iteration found no duplicates\"\n        $array &lt;&lt; node\n        xy.user_text = node\n        xy.write        \n    end\n    puts \"************ END OF ITERATION **************\"\n    puts \"\"\nend\n</code></pre>\n\n<p>This results in something similar to below (in \"user_text\" field):</p>\n\n<pre><code>05555550333333\n04444440222222\n05555550333333_1\n05555550333333_1\n</code></pre>\n\n<p>Just wondering how best to get the code to assess the new duplicate and count upward for each one found and get:</p>\n\n<pre><code>05555550333333\n04444440222222\n05555550333333_1\n05555550333333_2\n</code></pre>\n\n<p>Thanks.</p>\n\n<p><strong>UPDATE: In response to answers</strong></p>\n\n<p>I was having trouble squeezing in info to the comments so I thought I'd write here. First off, thanks for answering so far. All three techniques appear to work well in making $array look what I'm hoping for the finished article of the Node_IDs (or user_text whilst testing) to be.</p>\n\n<p>For example, using these methods I'm able to get the $array output:</p>\n\n<pre><code>02511160678961\n02735510688965\n02966900697649\n03216480682699\n02735510688965_1\n02735510688965_2\n02735510688965_3\n03355411149097\n</code></pre>\n\n<p>However, the $array in my code was originally just used as something I was throwing \"node\" into, in order to check against to see if it had been used before, rather than being an array I wanted to format/write itself.</p>\n\n<p>Each node is an object within the table ('_nodes'). And I'm hoping to iteratively write the new user_text (Node_ID) checking for duplicates each iteration, rather than at the end of a completed array.</p>\n\n<p>My aim was to update each object's user_text (eventually Node_ID once solved) and add it to the $array for checking for duplicates when the next object's user_text is going to be written. Not sure if there is an obvious way to apply the suggestions so far to each object before writing - rather than to a completed array like I have managed with your help.</p>\n\n<p>Also not sure if I am being entirely clear - please ask if not and I can edit my initial post further. Also happy to abandon my initial thought process if it seems like its the wrong train of thought.  Thanks again.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rails-engines"], "comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1555506399, "post_id": 55728170, "comment_id": 98135412, "body": "I\u2019m not at a computer, but your Engine has a class name to it. Something like GemName::Engine. Try using the engine class instead of Rails in the above method calls."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1555506452, "post_id": 55728170, "comment_id": 98135442, "body": "Did you check <a href=\"https://guides.rubyonrails.org/engines.html#routes\" rel=\"nofollow noreferrer\">6.3 Routes</a> guide for engine?"}, {"owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "reply_to_user": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1555506733, "post_id": 55728170, "comment_id": 98135612, "body": "I tried that also, it throws an error undefined method &#39;application&#39;, but thanks - @Nate"}, {"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1555506815, "post_id": 55728170, "comment_id": 98135663, "body": "I see the docs and the new answer. Dang. I was close. Haha"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555507326, "post_id": 55728354, "comment_id": 98136027, "body": "no, my question was not to get routes of Engine to get routes of app from engine, I tried using Rails.application.routes.routes in engine, I didn&#39;t gave me any defined resource routes eg: resources :books in app, if i use Rails.application.routes.routes in engine I&#39;m not able to fetch routes of books controller @vasfed"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555507668, "post_id": 55728354, "comment_id": 98136233, "body": "@NarayananV engine runs in the same ruby process, there&#39;s nothing stopping you from accessing these once the app is initialised and has loaded routes. If that&#39;s not working - please give more context on when you&#39;re trying to access these"}, {"owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555507813, "post_id": 55728354, "comment_id": 98136352, "body": "ok, I have created a rake task in engine, i&#39;m trying to access the app routes from that task file @vasfed"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555508377, "post_id": 55728354, "comment_id": 98136705, "body": "@NarayananV app needs to be loaded, rake by default does not load it, you need your task to be dependent on <code>:environment</code>"}, {"owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555508865, "post_id": 55728354, "comment_id": 98137034, "body": "it&#39;s already made to be dependent on :environment <code>namespace :user_namespace do   desc &quot;load new routes&quot;   task routes_setup: :environment do                                       route_details = Rails.application.routes.routes.map do |route|{ path: route.path.spec.to_s, controller: route.defaults[:controller], action: route.defaults[:action] }     end</code> @vasfed"}, {"owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555509011, "post_id": 55728354, "comment_id": 98137137, "body": "sorry for the illegiblity, the point even though i put it under :environment its not fetching the routes - @vasfed"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555509210, "post_id": 55728354, "comment_id": 98137279, "body": "just tried your code in a mounted engine - and it works"}, {"owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "edited": false, "score": 0, "creation_date": 1555509324, "post_id": 55728354, "comment_id": 98137360, "body": "can you post it, the configuration that you made in both app and engine @vasfed"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 1, "last_activity_date": 1555508293, "last_edit_date": 1555508293, "creation_date": 1555506689, "answer_id": 55728354, "question_id": 55728170, "link": "https://stackoverflow.com/questions/55728170/how-to-get-the-routes-of-my-app-in-which-my-engine-is-mounted-from-the-engine/55728354#55728354", "title": "how to get the routes of my app in which my engine is mounted from the engine?", "body": "<p>In engine <code>Rails.application.routes.routes</code> will be routes of its parent application.</p>\n\n<p><code>YourEngineClass::Engine.routes.routes</code> will be routes of the engine (keep in mind that these will not have route prefix, that comes from main app)</p>\n\n<p><strong>Update:</strong> routes are available after app initialisation. For them to be available in rake, you need to make your task dependent on <code>:environment</code>:</p>\n\n<pre><code>namespace :your_engine do\n  desc \"test\"\n  task some_task: :environment do\n    puts \"Routes:\"\n    puts Rails.application.routes.routes.collect {|r| r.path.spec.to_s }.join(\"\\n\")\n  end \nend\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4593210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39b16583a084adad736b7af4ca39c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan V", "link": "https://stackoverflow.com/users/4593210/narayanan-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555508293, "creation_date": 1555506111, "last_edit_date": 1555507733, "question_id": 55728170, "link": "https://stackoverflow.com/questions/55728170/how-to-get-the-routes-of-my-app-in-which-my-engine-is-mounted-from-the-engine", "title": "how to get the routes of my app in which my engine is mounted from the engine?", "body": "<p>I want to list all the routes present in application from an engine through code written in engine, like fetching routes of application in application by using:</p>\n\n<pre><code>routes = Rails.application.routes.routes\nroutes.collect {|r| r.path.spec.to_s }\n</code></pre>\n\n<p>the above command lists down the routes available in main application</p>\n\n<p><strong>1. What is the code to be used in engine to fetch the routes of application \"in engine\"?</strong></p>\n\n<p>I'm not able to fetch the routes if I use the above code in engine</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "syntax-error", "sendgrid-ruby"], "answers": [{"comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506017, "post_id": 55728037, "comment_id": 98135122, "body": "if i used ruby version <code>1.9.3p547</code> then gem <code>sendgrid-ruby</code> should also take version based on ruby version. right?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506063, "post_id": 55728037, "comment_id": 98135152, "body": "Nope, they wrote the code with a specific ruby&#39;s version"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506145, "post_id": 55728037, "comment_id": 98135217, "body": "Look at the link. Each version has a specific <code>REQUIRED RUBY VERSION</code>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506218, "post_id": 55728037, "comment_id": 98135270, "body": "I&#39;d try version 3.0.3 for sendgrid-ruby gem"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506264, "post_id": 55728037, "comment_id": 98135308, "body": "yes, i checked but look at this <code>https:&#47;&#47;rubygems.org&#47;gems&#47;sendgrid-ruby&#47;versions</code> for version 3.0.4 ruby version should be 2.2 or higher but for gem version 3.0.3 ruby version should be higher then 0.0 ."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506347, "post_id": 55728037, "comment_id": 98135371, "body": "Yes, I saw that. Try 3.0.3, it seems the last one before they had used ruby 2.2"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506417, "post_id": 55728037, "comment_id": 98135426, "body": "Yes, that might happen. but it should take version 3.0.3 . based on ruby version."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506503, "post_id": 55728037, "comment_id": 98135480, "body": "You choose the versions of the gems. It&#39;s not something automatic"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506763, "post_id": 55728037, "comment_id": 98135636, "body": "I used version 3.0.3, then also it&#39;s giving me the same syntax error. `  * sendgrid-ruby (3.0.3) `"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555506995, "post_id": 55728037, "comment_id": 98135782, "body": "Change tag, and see if they used keyword arguments or not. In fact it seems they used even in 3.0.3. but older versions not"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1555510740, "post_id": 55728037, "comment_id": 98138343, "body": "You can see the code for a specific tag. And tags match to versions usually. You can see if they use keyworkd arguments for a specific version."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 4, "last_activity_date": 1555505724, "creation_date": 1555505724, "answer_id": 55728037, "question_id": 55727937, "link": "https://stackoverflow.com/questions/55727937/syntax-error-unexpected-tlabel-expecting-syntaxerror/55728037#55728037", "title": "Syntax error, unexpected tLABEL, expecting &#39;)&#39; (SyntaxError)", "body": "<p>Keyword arguments require Ruby's version 2.0.0 or higher. <a href=\"https://thoughtbot.com/blog/ruby-2-keyword-arguments\" rel=\"nofollow noreferrer\">https://thoughtbot.com/blog/ruby-2-keyword-arguments</a></p>\n"}], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 55728037, "answer_count": 1, "score": 1, "last_activity_date": 1555505724, "creation_date": 1555505384, "question_id": 55727937, "link": "https://stackoverflow.com/questions/55727937/syntax-error-unexpected-tlabel-expecting-syntaxerror", "title": "Syntax error, unexpected tLABEL, expecting &#39;)&#39; (SyntaxError)", "body": "<h2>Environment</h2>\n\n<ul>\n<li>Ruby <strong>[1.9.3p547]</strong></li>\n<li>Rails <strong>[3.2.22.5]</strong></li>\n<li>sendgrid-ruby <strong>[4.0.8]</strong></li>\n</ul>\n\n<p>I used sendgrid-ruby gem in my application whenever I run rails server it's giving me below error which comes from gems/sendgrid-ruby-4.0.8/lib/sendgrid/client.rb:17</p>\n\n<blockquote>\n  <p>/.rvm/gems/ruby-1.9.3-p547@demo/gems/sendgrid-ruby-4.0.8/lib/sendgrid-ruby.rb:1:in\n  `require_relative':\n  /.rvm/gems/ruby-1.9.3-p547@demo/gems/sendgrid-ruby-4.0.8/lib/sendgrid/client.rb:17:\n  syntax error, unexpected tLABEL, expecting ')' (SyntaxError)\n      def initialize(api_key: nil, host: nil, request_head...\n                             ^ /.rvm/gems/ruby-1.9.3-p547@demo/gems/sendgrid-ruby-4.0.8/lib/sendgrid/client.rb:17:\n  Can't assign to nil ...   def initialize(api_key: nil, host: nil,\n  request_headers: ... ...                               ^\n  /.rvm/gems/ruby-1.9.3-p547@demo/gems/sendgrid-ruby-4.0.8/lib/sendgrid/client.rb:17:\n  Can't assign to nil ...ialize(api_key: nil, host: nil,\n  request_headers: nil, versio... ...                               ^\n  /.rvm/gems/ruby-1.9.3-p547@demo/gems/sendgrid-ruby-4.0.8/lib/sendgrid/client.rb:17:\n  Can't assign to nil ...ost: nil, request_headers: nil, version: nil)</p>\n</blockquote>\n\n<p>I checked the same file and same line of gem sengrid-ruby.\nit has below the line</p>\n\n<pre><code>def initialize(api_key: nil, host: nil, request_headers: nil, version: nil)\n</code></pre>\n\n<p>if I replace this to below it isn't giving me.</p>\n\n<pre><code>def initialize(api_key, host, request_headers, version)\n</code></pre>\n\n<p>is this syntax error of rails or ruby related version? \nThere are other lots of error which contain the same syntax in other gems. \nWhat should I do with this type of syntax errors?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "edited": false, "score": 0, "creation_date": 1555514453, "post_id": 55730863, "comment_id": 98140765, "body": "Very interesting. Thanks for this. I will check this out and report back very shortly"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558647098, "post_id": 55730863, "comment_id": 99180343, "body": "Please use appropriate capitalization and grammar. Remember, SO is like an online encyclopedia and those things matter."}], "tags": [], "owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "is_accepted": false, "score": 2, "last_activity_date": 1558647400, "last_edit_date": 1558647400, "creation_date": 1555513889, "answer_id": 55730863, "question_id": 55727833, "link": "https://stackoverflow.com/questions/55727833/memory-consumption-when-using-nokogiri-and-xml/55730863#55730863", "title": "Memory consumption when using Nokogiri and XML", "body": "<p>Nokogiri uses system libraries like <code>libxml</code> and <code>libxslt</code> under the hood. Because of that I would assume that it's probably not an issue in Ruby's garbage collection but somewhere else.</p>\n\n<p>If you are working with large files, it's usually a good idea to stream-process them, so that you do not load the whole file into memory, which in itself will result in huge memory consumption as large strings are very memory consuming.</p>\n\n<p>Because of this, when working with large XML files, you should use a stream parser. In Nokogiri this is <a href=\"https://nokogiri.org/rdoc/Nokogiri/XML/SAX.html\" rel=\"nofollow noreferrer\"><code>Nokogiri::XML::SAX</code></a>.</p>\n"}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1581291209, "creation_date": 1555505014, "last_edit_date": 1581291209, "question_id": 55727833, "link": "https://stackoverflow.com/questions/55727833/memory-consumption-when-using-nokogiri-and-xml", "title": "Memory consumption when using Nokogiri and XML", "body": "<p>I have been trying to figure out what's up with my Rails app as it relates to memory and Nokogiri's XML parsing. For some reason, this one function alone consumes up about 1GB of memory and does not release it when it's completed. I'm not quite sure what's going on here.</p>\n\n<pre><code>def split_nessus\n    # To avoid consuming too much memory, we're going to split the Nessus file\n    # if it's over 10MB into multiple smaller files.\n    file_size = File.size(@nessus_files[0]).to_f / 2**20\n    files = []\n\n    if file_size &gt;= 10\n        file_num = 1\n        d = File.open(@nessus_files[0])\n        content = Nokogiri::XML(d.read)\n        d.close\n        data = Nokogiri::XML(\"&lt;data&gt;&lt;/data&gt;\")\n        hosts_num = 1\n\n        content.xpath(\"//ReportHost\").each do |report_host|\n            data.root &lt;&lt; report_host\n            hosts_num += 1\n\n            if hosts_num == 100\n                File.open(\"#{@nessus_files[0]}_nxtmp_#{file_num}\", \"w\") {|f| f.write(data.to_xml)}\n                files &lt;&lt; \"#{@nessus_files[0]}_nxtmp_#{file_num}\"\n                data = Nokogiri::XML(\"&lt;data&gt;&lt;/data&gt;\")\n                hosts_num = 1\n                file_num += 1\n            end\n        end\n\n        @nessus_files = files\n    end\nend\n</code></pre>\n\n<p>Since Rails crashes when trying to parse a 100MB+ XML file, I've decided to break XML files into separate files if they're over 10MB, and just trying to handle them individually.</p>\n\n<p>Any thoughts as to why this will not release about 1GB of memory when it's completed?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1555527498, "post_id": 55727146, "comment_id": 98147039, "body": "something to keep in mind: Rails has a special convenience method for rendering collections (<code>@hairstyle.comments</code> in your example): <a href=\"https://guides.rubyonrails.org/layouts_and_rendering.html#rendering-collections\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a> \u2014 better performance and more concise."}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555507533, "post_id": 55727453, "comment_id": 98136153, "body": "Hi there, OK I see so once my comment is created if I do not tell it to redirect to the a specific page it will not. OK understood. I have now added the code you provided above in my create method and I get the following error: <code>No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;hairstyles&quot;, :id=&gt;nil}, missing required keys: [:id]</code> here are my routes: <code>resources :hairstyles do &lt;br&#47;&gt;   resources :comments, only: [:new, :create ]&lt;br&#47;&gt;   resources :saved_hairstyles, only: [:new, :create]&lt;br&#47;&gt; end</code> to me they look fine... Any ideas?"}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555507967, "post_id": 55727453, "comment_id": 98136482, "body": "I mean that explicitly redirect to your hairstyle show path I don&#39;t know how you configure that path, so use that path instead of mine :)"}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555508075, "post_id": 55727453, "comment_id": 98136532, "body": "your error saying that hairstyle is nil, please provide particular hairstly id"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555508261, "post_id": 55727453, "comment_id": 98136630, "body": "Hello Vishal, arr ok but hairstyle_path is my SHOW page, it is the page I want to redirect to...........  I don&#39;t know what you mean by provide particular hairstyle id, as hairstyle id is nil  :S I think I am not understanding but I will play around and see what I come up with thanks!!"}], "tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": false, "score": 0, "last_activity_date": 1555503709, "creation_date": 1555503709, "answer_id": 55727453, "question_id": 55727146, "link": "https://stackoverflow.com/questions/55727146/comments-not-displaying-from-rendered-form/55727453#55727453", "title": "Comments not displaying from rendered form", "body": "<p>The default behavior of rails controllers is it will redirect to the index page after the create method. that's why you are redirected to that path.</p>\n\n<p>you can simply use <code>redirec_to</code> in your <code>create</code>  method in your comment controller like below</p>\n\n<pre><code>def create\n    @comment = Comment.new(comment_params)\n    @hairstyle = Hairstyle.find(params[:hairstyle_id])\n    @comment.save   \n    redirect_to hairstyle_path(@comment.hairstyle)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555507266, "post_id": 55727595, "comment_id": 98135988, "body": "Hi Vincent thank you for your response, when you say I didn&#39;t link my comment to my hairstyle is this what you are doing on line 2 of the create method above? <code>@hairstyle.comments.build(comment_params)</code> I&#39;ve never seen the method .build before"}, {"owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555507758, "post_id": 55727595, "comment_id": 98136307, "body": "Yes it is! i have edited my answer to feature a more understandable approach"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555507856, "post_id": 55727595, "comment_id": 98136392, "body": "Oh great makes sense now. So if I do this it should work? Let me see what happens. Thank you!"}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555508182, "post_id": 55727595, "comment_id": 98136592, "body": "Hello there ok so now I am back to where I started. It works but when I click create comment it redirects to <code>http:&#47;&#47;localhost:3000&#47;hairstyles&#47;2&#47;comments</code> which is not what I want, I want it to redirect to the hairstyle show page and display the comments below the hairstyle. :S so weird, in my terminal it says rollback at line 32 of my comments controller which is the line <code>if comment.save</code> I will play around with the redirect path and see..."}, {"owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "reply_to_user": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555508700, "post_id": 55727595, "comment_id": 98136923, "body": "I think this is because your comment is probably not valid (case to handle in the else branch above) ."}, {"owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "edited": false, "score": 0, "creation_date": 1555509702, "post_id": 55727595, "comment_id": 98137623, "body": "oh ok I see, I will write some logic in the &#39;else&#39; statement above then, great thanks!"}], "tags": [], "owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "is_accepted": false, "score": 0, "last_activity_date": 1555507707, "last_edit_date": 1555507707, "creation_date": 1555504183, "answer_id": 55727595, "question_id": 55727146, "link": "https://stackoverflow.com/questions/55727146/comments-not-displaying-from-rendered-form/55727595#55727595", "title": "Comments not displaying from rendered form", "body": "<p>You never link your comment to your hairstyle, your <code>hairstyle_id</code> from your comment is <code>nil</code> this is why <code>@hairstyle.comments</code> returns an empty array</p>\n\n<pre><code>def create\n  @hairstyle = Hairstyle.find(params[:hairstyle_id])\n  @comment = @hairstyle.comments.build(comment_params)\n  # equivalent to:\n  # comment = Comment.new(comment_params)\n  # comment.hairstyle = @hairstyle\n\n  if comment.save\n    redirect_to hairstyle_path(@hairstyle)\n  else \n    # handle errors\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 9100910, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155886857833433/picture?type=large", "display_name": "Angela Inniss", "link": "https://stackoverflow.com/users/9100910/angela-inniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555507707, "creation_date": 1555502549, "question_id": 55727146, "link": "https://stackoverflow.com/questions/55727146/comments-not-displaying-from-rendered-form", "title": "Comments not displaying from rendered form", "body": "<p>I am new to Ruby and I am trying to display comments on my show page but when I create a comment it does not display. I have rendered a partial on my show page in order to display the comments but they do not appear. </p>\n\n<p>The strange thing is that the create action works but it takes me to this page: <code>http://localhost:3000/hairstyles/2/comments</code> which has nothing on it (in my app this page is under views>comments>create.html.erb) instead i'd like it to go to the view page for the hairstyle and display the comment..........</p>\n\n<p>If anyone can help and see if there are any errors in my code I'd be grateful. Thanks in advance.</p>\n\n<p>Comments Controller:</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def new\n    @hairstyle = Hairstyle.find(params[:hairstyle_id])\n    @comment = Comment.new\n  end\n\n  def create\n    @comment = Comment.new(comment_params)\n    @hairstyle = Hairstyle.find(params[:hairstyle_id])\n    @comment.save   \n\n  end\n\n  def destroy\n  end\nend\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:content)\n  end\n</code></pre>\n\n<p>Hairstyle view page where I want to display the comments:</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div&gt;\n    &lt;%= cl_image_tag @hairstyle.photo, width: 300, height: 200, crop: :fill %&gt;\n    &lt;h1&gt;&lt;%= @hairstyle.name %&gt;&lt;/h1&gt;\n    &lt;p&gt;&lt;%= @hairstyle.description%&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;%= @hairstyle.category%&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;%= @hairstyle.video_url %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n &lt;div&gt;\n    &lt;%= link_to 'Back', hairstyles_path %&gt;\n &lt;/div&gt;\n\n&lt;h6&gt;Comments for: &lt;%= @hairstyle.name %&gt; &lt;small&gt;&lt;%= %&gt;&lt;/small&gt;&lt;/h6&gt;\n&lt;h2&gt;\n  &lt;%= pluralize @hairstyle.comments.size, \"comment\" %&gt;\n&lt;/h2&gt;\n\n&lt;div id=\"comments\"&gt;\n  &lt;% if @hairstyle.comments.blank? %&gt;\n    Be the first to leave a comment for &lt;%= @hairstyle.name %&gt;\n  &lt;% else %&gt;\n    &lt;% @hairstyle.comments.each do |comment| %&gt;\n      &lt;%= render 'comments/show', comment: comment %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;%= render 'comments/form', comment: @comment %&gt;\n\n</code></pre>\n\n<p>Comments form i am rendering which does work and is displayed:\nviews>comments>_form.html.erb</p>\n\n<pre><code>&lt;div class=\"flex-box\"&gt;\n  &lt;%= simple_form_for([ @hairstyle, comment ]) do |form| %&gt;\n    &lt;%= form.input :content, as: :text %&gt;\n    &lt;%= form.button :submit %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n</code></pre>\n\n<p>Comments content that I am rendering that does not display once I have added a comment to my hairstyle on the show page:</p>\n\n<p>views>comments>_show.html.erb</p>\n\n<pre><code>&lt;p&gt;&lt;%= comment.content %&gt;&lt;/p&gt;\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1555501298, "post_id": 55726542, "comment_id": 98132193, "body": "Can you explain, why I want to ensure such a pattern? In each Rails application there are counter-examples like <code>application.html.erb</code>. What is wrong with that? What about names like <code>.profile</code>? Valid? Or <code>.profile.sh</code>? Still valid?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1555501396, "post_id": 55726542, "comment_id": 98132245, "body": "Additionally, there is absolutely nothing &quot;invalid&quot; about a filename containing dots. <code>this.is.a.spreadsheet.xlsx</code> is perfectly valid."}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1555501434, "post_id": 55726542, "comment_id": 98132261, "body": "@spicekermann am not using rails templates here so I need to check it at my controllers and send json response to react-redux Api call"}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1555501862, "post_id": 55726542, "comment_id": 98132508, "body": "@Tom Lord. I have check your string syntax and it shows invalid when passed through the code. so you are wrong on this The counter is working perfectly"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1555505318, "post_id": 55726542, "comment_id": 98134668, "body": "I think what Tom was trying to say is that his example is a valid file name and it has only one extension. Your assumption is wrong: A dot doesn&#39;t always separate a filename from an extension because a dot might be part of the name or have special meaning like the dot at the beginning of the name)."}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1555505786, "post_id": 55726542, "comment_id": 98134981, "body": "@spickermann okay I now understand Please let me ask you is checking files dot extensions not part of the security measures. if a user tries to upload nancy.php.jpg. is there anything wrong in asking the user to rename his uploading filename by removing the dots before uploading"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1555507914, "post_id": 55726542, "comment_id": 98136437, "body": "@NancyMooree Correct. Requiring a filename to only contain one <code>.</code> does not make your system secure.Just because you&#39;ve prevented someone uploading <code>my_file.jpg.exe</code> or whatever, this has got nothing to do with preventing them from actually uploading a malicious file!"}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1555508122, "post_id": 55726542, "comment_id": 98136564, "body": "Thanks Sir Tom Lord, am sorry i mis-interpreted your comment above. Thank You"}], "answers": [{"comments": [{"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1555501330, "post_id": 55726645, "comment_id": 98132208, "body": "It does not work if you need .tar.gz :) Just saying"}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1555501514, "post_id": 55726645, "comment_id": 98132317, "body": "these types of exceptions should be handled for this solution :P"}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1555501556, "post_id": 55726645, "comment_id": 98132340, "body": "I&#39;d rather use <code>File#extname</code> and validate the extension against a list of whitelisted extensions. I know is not what you asked @NancyMooree but I think is a better approach on whatever are you trying to solve."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1555501616, "post_id": 55726645, "comment_id": 98132377, "body": "@Vishal Agree, your solution works perfectly fine on the question. I think the question is bad. There is nothing wrong with .tar.gz or having <code>.</code> in the filename."}, {"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "reply_to_user": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1555502332, "post_id": 55726645, "comment_id": 98132758, "body": "@radubogdan  is anything wrong in getting file extension name like this when you try to upload files as part of the form params[&#39;file&#39;].original_filename.split(&quot;.&quot;).last"}], "tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": true, "score": 1, "last_activity_date": 1555500859, "creation_date": 1555500859, "answer_id": 55726645, "question_id": 55726542, "link": "https://stackoverflow.com/questions/55726542/how-to-validate-files-for-multiple-extension-name-checking-in-ruby-or-ruby-on-ra/55726645#55726645", "title": "How to validate files for multiple extension name checking in ruby or ruby on rails", "body": "<p>You can simply count the '.' if it occurs more than once means its invalid. You can do the following for that.</p>\n\n<pre><code>if filename.count('.') &gt; 1 # assuming filename is string \n  print 'Invalid'\nelse\n  print 'Valid'\nend\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 55726645, "answer_count": 1, "score": 0, "last_activity_date": 1555543367, "creation_date": 1555500550, "last_edit_date": 1555543367, "question_id": 55726542, "link": "https://stackoverflow.com/questions/55726542/how-to-validate-files-for-multiple-extension-name-checking-in-ruby-or-ruby-on-ra", "title": "How to validate files for multiple extension name checking in ruby or ruby on rails", "body": "<p>Am trying to check file for multiple extension name</p>\n\n<p>To check character length, I can do it like below</p>\n\n<pre><code> s= 'hello welcome to stackoverflow'\n  if s.length &lt;= 35\n     print('okay')\n  else\n     print('not accepted')\n  end\n</code></pre>\n\n<p><strong>What i want to achieve:</strong></p>\n\n<p>Now I have a file that i want to check for single, double or multiple extension name.</p>\n\n<p>I only want to allow file names with single extension name. if files has more than one extension name throw error not allowed as can be seen in the code below.</p>\n\n<p>My issue is that I cannot get <strong>dot()</strong> function equivalent of <strong>length()</strong> function</p>\n\n<pre><code>   filename = 'nancy.png'\n\n  if filename.length == 1\n     print('good file because it has only one dot extension name')\n  else\n     print('files with two or multiple extension name not allowed')\n  end\n</code></pre>\n"}, {"tags": ["ruby", "windows", "shell", "command-line", "interop"], "comments": [{"owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 1, "creation_date": 1555509551, "post_id": 55725954, "comment_id": 98137533, "body": "I can&#39;t test under Windows, but maybe help: <code>pipe = IO.popen(&#39;your.exe&#39;, &#39;w+&#39;, :err =&gt; [:child, :out])</code> and then <code>pipe.each_line do |line|</code> and test for question, then <code>pipe.puts(&#39;Yes&#39;)</code> finally <code>pipe.close</code>"}, {"owner": {"reputation": 548, "user_id": 5308185, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hdHbk.jpg?s=128&g=1", "display_name": "Finfa811", "link": "https://stackoverflow.com/users/5308185/finfa811"}, "reply_to_user": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "edited": false, "score": 0, "creation_date": 1556266486, "post_id": 55725954, "comment_id": 98387169, "body": "@lojza that works! Haven&#39;t tried <code>IO</code> before, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "is_accepted": true, "score": 1, "last_activity_date": 1556270883, "creation_date": 1556270883, "answer_id": 55864613, "question_id": 55725954, "link": "https://stackoverflow.com/questions/55725954/ruby-calling-commands-and-interact-with-shell-in-windows-environment/55864613#55864613", "title": "Ruby - Calling commands and interact with shell in Windows environment", "body": "<p>Seems this is working under Windows too</p>\n\n<pre><code>pipe = IO.popen('your.exe', 'w+', :err =&gt; [:child, :out])\n@pipe.each_line do |line|\n  if /pattern matching question/ =~ line\n    break\n  end\nend\npipe.puts('Yes')\n# another test can be here\npipe.close\n</code></pre>\n\n<p>Wise to use with <a href=\"https://ruby-doc.com/stdlib/libdoc/timeout/rdoc/Timeout.html\" rel=\"nofollow noreferrer\">https://ruby-doc.com/stdlib/libdoc/timeout/rdoc/Timeout.html</a></p>\n"}], "owner": {"reputation": 548, "user_id": 5308185, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hdHbk.jpg?s=128&g=1", "display_name": "Finfa811", "link": "https://stackoverflow.com/users/5308185/finfa811"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55864613, "answer_count": 1, "score": 0, "last_activity_date": 1556270883, "creation_date": 1555498611, "question_id": 55725954, "link": "https://stackoverflow.com/questions/55725954/ruby-calling-commands-and-interact-with-shell-in-windows-environment", "title": "Ruby - Calling commands and interact with shell in Windows environment", "body": "<p>I am running an .exe file in the command line from a Ruby script that asks the user for a Yes/No response. I would like to know how the user can interact with it in Windows environment.</p>\n\n<p>I have tried all the possible options: <code>system</code>, backticks, <code>%x()</code>, Open3, Open4... and none of them work.</p>\n\n<p>Some posts (<a href=\"https://stackoverflow.com/questions/10645173/run-system-command-in-ruby-and-interact-with-it\">[1]</a>, <a href=\"https://stackoverflow.com/questions/31854180/ruby-interactive-shell-commands\">[2]</a>) resolve the issue using PTY, but as to my knowledge there is no implementation of the PTY module in Windows. Any other idea?</p>\n"}, {"tags": ["ruby", "jwt", "app-store-connect"], "answers": [{"comments": [{"owner": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "edited": false, "score": 0, "creation_date": 1555500407, "post_id": 55726002, "comment_id": 98131671, "body": "It is required to use ES256, so I guess I have to stick to that. What do you mean by &quot;or that you&#39;d probably need a new private key, though&quot;. Can I not use my downloaded private key?"}, {"owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "reply_to_user": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "edited": false, "score": 0, "creation_date": 1555502623, "post_id": 55726002, "comment_id": 98132937, "body": "Well, I don&#39;t know how iTunes key generation stuff works. If you have generated an RSA key pair and uploaded your public key to iTunes -- then you need to generate an ECDSA key and re-upload. If you download the private key from iTunes -- then it&#39;s probably already an ECDSA key, just use <code>OpenSSL::PKey::EC</code> and hopefully it will work. :-)"}, {"owner": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "edited": false, "score": 0, "creation_date": 1555502822, "post_id": 55726002, "comment_id": 98133082, "body": "I generated a private key in iTunes and downloaded it. The thing is that <code>OpenSSL::PKey::EC</code> is still complaining: &gt;in `initialize&#39;: unknown curve name (-----BEGIN RSA PRIVATE KEY----- (OpenSSL::PKey::ECError)"}, {"owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "reply_to_user": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "edited": false, "score": 0, "creation_date": 1555502913, "post_id": 55726002, "comment_id": 98133140, "body": "Then it&#39;s an RSA key and you need to use RS256. Where is the requirement for ES256 coming from?"}, {"owner": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "edited": false, "score": 0, "creation_date": 1555502980, "post_id": 55726002, "comment_id": 98133181, "body": "<a href=\"https://developer.apple.com/documentation/appstoreconnectapi/generating_tokens_for_api_requests\" rel=\"nofollow noreferrer\">developer.apple.com/documentation/appstoreconnectapi/&hellip;</a>"}, {"owner": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "edited": false, "score": 0, "creation_date": 1555504477, "post_id": 55726002, "comment_id": 98134105, "body": "I found the root problem. My p8 file got corrupted and therefore was not able to generate a new EC key. Now is solved and I&#39;m able to generate a token (still failing to fetch from iTunes but that&#39;s a different issue). So your answer indeed solved the issue. Thanks a lot!"}], "tags": [], "owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "is_accepted": true, "score": 1, "last_activity_date": 1555498772, "creation_date": 1555498772, "answer_id": 55726002, "question_id": 55725570, "link": "https://stackoverflow.com/questions/55725570/generating-jwt-with-ruby-for-itunes-connect-api/55726002#55726002", "title": "Generating JWT with Ruby for iTunes Connect API", "body": "<p>Seems like it's caused by using RSA key with ECDSA encryption algorithm. Either use <code>RS256</code> algo instead of <code>ES256</code>, or use <code>OpenSSL::PKey::EC</code> instead of <code>OpenSSL::PKey::RSA</code> (for that you'd probably need a new private key, though).</p>\n"}, {"tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1555500955, "creation_date": 1555500955, "answer_id": 55726690, "question_id": 55725570, "link": "https://stackoverflow.com/questions/55725570/generating-jwt-with-ruby-for-itunes-connect-api/55726690#55726690", "title": "Generating JWT with Ruby for iTunes Connect API", "body": "<p>There is <code>Apnotic</code> gem, which implements Apple push notifications in modern Apple way:<br>\n<code>HTTP2.0</code> + <code>JWT</code> + <code>p8</code>.</p>\n\n<p>Probably, you could find the solution in its <a href=\"https://github.com/ostinelli/apnotic/blob/master/lib/apnotic/provider_token.rb\" rel=\"nofollow noreferrer\">ProviderToken class</a>.</p>\n"}], "owner": {"reputation": 1170, "user_id": 4473187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/H9pFE.jpg?s=128&g=1", "display_name": "gmoraleda", "link": "https://stackoverflow.com/users/4473187/gmoraleda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 55726002, "answer_count": 2, "score": 0, "last_activity_date": 1555500955, "creation_date": 1555497261, "question_id": 55725570, "link": "https://stackoverflow.com/questions/55725570/generating-jwt-with-ruby-for-itunes-connect-api", "title": "Generating JWT with Ruby for iTunes Connect API", "body": "<p>I'm trying to generate a token to sign my requests to the iTunes Connect API. That's my Ruby file:</p>\n\n<pre><code>require \"jwt\"\nrequire 'openssl'\n\nISSUER_ID = \"my issuer string\"\nKEY_ID = \"my key id string\"\n\nkey_file = File.read('my p8 file containing my private key') # Located at the same folder than my ruby file\nprivate_key = OpenSSL::PKey::RSA.new(key_file)\n\npayload = {\n      'iss': ISSUER_ID,\n      'exp': 1528408800,\n      'aud': 'appstoreconnect-v1'\n  }\n\nheader = {\n      'alg': 'ES256',\n      'kid': KEY_ID,\n      'typ': 'JWT'\n  }\n\n  jwt = JWT.encode(payload, private_key, algorithm='ES256', header)\n  puts jwt\n</code></pre>\n\n<p>If I run this file <code>ruby jwt.rb</code> I get the following output:</p>\n\n<blockquote>\n  <p>/Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt/algos/ecdsa.rb:15:in sign': undefined method group' for # (NoMethodError)\n      from /Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt/signature.rb:35:in sign'\n      from /Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt/encode.rb:39:in encoded_signature'\n      from /Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt/encode.rb:47:in encode_segments'\n      from /Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt/encode.rb:20:in initialize'\n      from /Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt.rb:21:in new'\n      from /Library/Ruby/Gems/2.3.0/gems/jwt-2.1.0/lib/jwt.rb:21:in encode'\n      from jwt.rb:22:in '</p>\n</blockquote>\n\n<p>From the console output it is hard to tell what's failing, but if I were to use RS256 as algorithm and omit the header, the script generates a token successfully. </p>\n"}, {"tags": ["ruby", "redis", "cluster-computing", "ruby-on-rails-5.2"], "answers": [{"tags": [], "owner": {"reputation": 29579, "user_id": 316700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f952bee7570a3db2ecba5b06c0062b3?s=128&d=identicon&r=PG", "display_name": "fguillen", "link": "https://stackoverflow.com/users/316700/fguillen"}, "is_accepted": false, "score": 4, "last_activity_date": 1555497405, "creation_date": 1555497405, "answer_id": 55725611, "question_id": 55725529, "link": "https://stackoverflow.com/questions/55725529/how-to-set-up-aws-elasticache-cluster-in-rails-problem-with-the-moved-response/55725611#55725611", "title": "How to set up AWS ElastiCache cluster in Rails? (problem with the MOVED response)", "body": "<p>I had to use the <code>cluster</code> attribute:</p>\n\n<pre><code>irb(main):004:0&gt; redis = Redis.new(cluster: [\"redis://ec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com:6379/0\"])\n=&gt; #&lt;Redis client v4.1.0 for redis://10.30.128.168:6379/0 redis://10.30.129.116:6379/0 redis://10.30.130.76:6379/0&gt;\nirb(main):005:0&gt; redis.get(\"test\")\n=&gt; nil\nirb(main):006:0&gt; redis.set(\"test\", \"test001\")\n=&gt; \"OK\"\nirb(main):007:0&gt; redis.get(\"test\")\n=&gt; \"test001\"\n</code></pre>\n\n<p>And be sure I am passing an Array</p>\n"}], "owner": {"reputation": 29579, "user_id": 316700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f952bee7570a3db2ecba5b06c0062b3?s=128&d=identicon&r=PG", "display_name": "fguillen", "link": "https://stackoverflow.com/users/316700/fguillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555497405, "creation_date": 1555497098, "question_id": 55725529, "link": "https://stackoverflow.com/questions/55725529/how-to-set-up-aws-elasticache-cluster-in-rails-problem-with-the-moved-response", "title": "How to set up AWS ElastiCache cluster in Rails? (problem with the MOVED response)", "body": "<p>I am using:</p>\n\n<ul>\n<li>rails (5.2.2)</li>\n<li>redis (4.1.0)</li>\n</ul>\n\n<p>And I have a Elasticache cluster in AWS. </p>\n\n<p>AWS gave me a self-discoverable DNS record:</p>\n\n<pre><code>$ dig ec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com\n\n; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; ec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 1728\n;; flags: qr rd ra; QUERY: 1, ANSWER: 6, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;ec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. IN A\n\n;; ANSWER SECTION:\nec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. 15 IN A 10.30.130.70\nec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. 15 IN A 10.30.129.116\nec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. 15 IN A 10.30.130.76\nec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. 15 IN A 10.30.128.168\nec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. 15 IN A 10.30.130.130\nec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com. 15 IN A 10.30.129.105\n\n;; Query time: 6 msec\n;; SERVER: 192.168.200.1#53(192.168.200.1)\n;; WHEN: Wed Apr 17 12:28:00 CEST 2019\n;; MSG SIZE  rcvd: 183\n\n</code></pre>\n\n<p>But when I try to use it in my Rails app it doesn't work:</p>\n\n<pre><code>irb(main):002:0&gt; redis = Redis.new(url: \"redis://ec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com:6379/0\")\n=&gt; #&lt;Redis client v4.1.0 for redis://ec-cluster-test.44cbxh.clustercfg.euw1.cache.amazonaws.com:6379/0&gt;\nirb(main):003:0&gt; redis.get(\"test\")\nTraceback (most recent call last):\n        1: from (irb):3\nRedis::CommandError (MOVED 6918 10.30.129.116:6379)\n</code></pre>\n\n<p>How can I make my redis configuration to manage the <code>MOVED</code> responses?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1555496520, "post_id": 55725075, "comment_id": 98129412, "body": "Which data and how to retrieve? How to match arguments <code>begin</code>, <code>end</code> for selecting the required data? Chaining <code>end</code> with <code>begin</code>? Suggestion don&#39;t use reserved words as variable name: <code>begin</code>, <code>end</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9409769"}, "edited": false, "score": 0, "creation_date": 1555500821, "post_id": 55725604, "comment_id": 98131917, "body": "Yes, dude)) Thank you a lot :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9409769"}, "edited": false, "score": 0, "creation_date": 1555589856, "post_id": 55725604, "comment_id": 98168453, "body": "Hey dude) I stucked at this point: tmp = ary.find { |h| h[&#39;begin&#39;] == start } - this code breaks down with error <code>in </code>[]&#39;: no implicit conversion of String into Integer (TypeError)`. Could you help me convert this to array type or with way to fix it?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1555593747, "post_id": 55725604, "comment_id": 98170755, "body": "I cannot reproduce the error. Add <code>p start</code> right after <code>loop do</code> to print out the value of the variable. Then post it here with the value of <code>ary</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9409769"}, "edited": false, "score": 0, "creation_date": 1555596870, "post_id": 55725604, "comment_id": 98172708, "body": "Actually i fixed some issue, but now my code starting without error and without necessary results a = Train.new(&quot;my_path_to yml&quot;, &quot;my_path.yml) a.calc(begin: &#39;:washington&#39;, end: &#39;:dallas&#39;) p print - &quot;:washington&quot; first value of .yml file :washington."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9409769"}, "edited": false, "score": 0, "creation_date": 1555596964, "post_id": 55725604, "comment_id": 98172776, "body": "It breaks on this line &quot;break unless tmp&quot; and that is all"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9409769"}, "edited": false, "score": 0, "creation_date": 1555598893, "post_id": 55725604, "comment_id": 98173913, "body": "It&#39;s strange, but I changed loop method:       for i in arry       if i[&#39;start&#39;] == &#39;washington&#39;         puts &quot;good&quot;       else         puts &quot;no way&quot;       end     end  And it all time prints &quot;else&quot; condition. I&#39;m already sick of this code"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 1, "last_activity_date": 1555497385, "creation_date": 1555497385, "answer_id": 55725604, "question_id": 55725075, "link": "https://stackoverflow.com/questions/55725075/how-to-iterate-through-nested-array-hash-and-retrieve-data-from-there/55725604#55725604", "title": "How to iterate through nested array/hash and retrieve data from there", "body": "<p>If I get the point, see my comment, given the variable <code>@time</code>:</p>\n\n<pre><code>@time = {\"time\"=&gt;[{\"begin\"=&gt;:washington, \"end\"=&gt;:briston, \"min\"=&gt;6, \"price\"=&gt;3}, {\"begin\"=&gt;:briston, \"end\"=&gt;:dallas, \"min\"=&gt;4, \"price\"=&gt;2}, {\"begin\"=&gt;:dallas, \"end\"=&gt;:tokyo, \"min\"=&gt;3.5, \"price\"=&gt;3}, {\"begin\"=&gt;:tokyo, \"end\"=&gt;:chicago, \"min\"=&gt;3.5, \"price\"=&gt;3}]}\n</code></pre>\n\n<p>One way to chain, to be refactored:</p>\n\n<pre><code>ary = @time['time']\nstart = :washington\nstop = :tokyo\nres = []\nloop do\n  tmp = ary.find { |h| h['begin'] == start }\n  break unless tmp\n  res &lt;&lt; tmp\n  start = tmp['end']\n  break if start == stop\nend\n</code></pre>\n\n<p>Then you have <code>res</code>:</p>\n\n<pre><code>#=&gt; [{\"begin\"=&gt;:washington, \"end\"=&gt;:briston, \"min\"=&gt;6, \"price\"=&gt;3}, {\"begin\"=&gt;:briston, \"end\"=&gt;:dallas, \"min\"=&gt;4, \"price\"=&gt;2}, {\"begin\"=&gt;:dallas, \"end\"=&gt;:tokyo, \"min\"=&gt;3.5, \"price\"=&gt;3}]\n</code></pre>\n\n<p>To get for example the sum of <code>min</code>:</p>\n\n<pre><code>res.sum { |h| h['min'] } #=&gt; 13.5\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9409769"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55725604, "answer_count": 1, "score": 0, "last_activity_date": 1555497385, "creation_date": 1555495653, "question_id": 55725075, "link": "https://stackoverflow.com/questions/55725075/how-to-iterate-through-nested-array-hash-and-retrieve-data-from-there", "title": "How to iterate through nested array/hash and retrieve data from there", "body": "<p>I stacked with a problem - solving a task where I have .yml file like this:</p>\n\n<pre><code>time:\n  -\n    begin: :washington\n    end: :briston\n    min: 6\n    price: 3\n  -\n    begin: :briston\n    end: :dallas\n    min: 4\n    price: 2\n  -\n    begin: :dallas\n    end: :tokyo\n    min: 3.5\n    price: 3\n  -\n    begin: :tokyo\n    end: :chicago\n    min: 3.5\n    price: 3\n</code></pre>\n\n<p>and a class Train, where I want to loop through this .yml file and extract neccessary information and operate with these values(start station, end station, price and duration).</p>\n\n<pre><code>class Train \n  require 'yaml'\n\n  def initialize(time, line)\n    @time = YAML.load_file(time)\n    @line = YAML.load_file(line)\n  end\n\n  def calc(begin, end)\n    @time.select do |key, value|\n      puts key, value\n    end\n  end\nend\n</code></pre>\n\n<p>In 'calc' method I defined 'select' method to retrieve keys and values, but it just printing all hash like this: </p>\n\n<pre><code>time\n{\"begin\"=&gt;:washington, \"end\"=&gt;:briston, \"min\"=&gt;6, \"price\"=&gt;3}\n{\"begin\"=&gt;:briston, \"end\"=&gt;:dallas, \"min\"=&gt;4, \"price\"=&gt;2}\n{\"begin\"=&gt;:dallas, \"end\"=&gt;:tokyo, \"min\"=&gt;3.5, \"price\"=&gt;3}\n</code></pre>\n\n<p>How could I loop through this hash to extact neccessary data? Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "graphql"], "answers": [{"comments": [{"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 0, "creation_date": 1559231331, "post_id": 55730226, "comment_id": 99363357, "body": "It does not look like answers the questions"}], "tags": [], "owner": {"reputation": 54, "user_id": 10586948, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gm_mIMtvliw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDQojomkgfckbo-HLH3F2f6szsGLg/mo/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/10586948/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1555512025, "creation_date": 1555512025, "answer_id": 55730226, "question_id": 55724826, "link": "https://stackoverflow.com/questions/55724826/test-with-rspec-if-graphql-field-method-argument-default-value-is-set/55730226#55730226", "title": "Test with RSpec if graphQL field method argument default value is set", "body": "<p>If <code>foo</code> is calling another method, you could use <code>recieve</code> and <code>with</code>. Something like...</p>\n\n<pre><code>class Foo\n  def bar(my_other_argument: true)\n    baz(my_other_argument)\n  end\n\n  def baz(val)\n    # Stuff\n  end\nend\n\ndescribe :bar do\n  context 'default values' do\n    it 'defaults to true' do\n      @foo = Foo.new\n      expect(@foo).to receive(:baz).with(true)\n\n      @foo.bar\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 3999144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgoyt.jpg?s=128&g=1", "display_name": "Colin Lee", "link": "https://stackoverflow.com/users/3999144/colin-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1564624585, "creation_date": 1564624585, "answer_id": 57300911, "question_id": 55724826, "link": "https://stackoverflow.com/questions/55724826/test-with-rspec-if-graphql-field-method-argument-default-value-is-set/57300911#57300911", "title": "Test with RSpec if graphQL field method argument default value is set", "body": "<p>Let's think about the <a href=\"https://graphql-ruby.org/fields/resolvers.html\" rel=\"nofollow noreferrer\">Resolvers</a>. \nYou can defined a resolvers for <code>foo</code>.</p>\n\n<pre><code>class Resolvers::Foo &lt; Resolvers::Base\n  argument :my_argument, Int, required: true\n  argument :my_other_argument, Boolean, required: false\n\n  def resolve(my_argument:, my_other_argument: true)\n    &lt;some code&gt;\n  end\nend\n</code></pre>\n\n<p>And use it in query file as</p>\n\n<pre><code>field :foo, String, resolver: Resolvers::Foo, null: false \n</code></pre>\n\n<p>On the other hand, if you want to test some fields with arguments, it will be better if you make a query with such arguments like:</p>\n\n<pre><code>foo(my_argument: $my_argument, my_other_argument: $my_other_argument)\n</code></pre>\n\n<p><code>$my_argument</code> and <code>$my_other_argument</code> are the arguments you want to test with.\nThere are more details in the doc of <a href=\"https://graphql-ruby.org/testing/integration_tests.html\" rel=\"nofollow noreferrer\">Graphql testing</a></p>\n"}], "owner": {"reputation": 1659, "user_id": 5090346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HXbu3.png?s=128&g=1", "display_name": "Brainmaniac", "link": "https://stackoverflow.com/users/5090346/brainmaniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1564624585, "creation_date": 1555494850, "question_id": 55724826, "link": "https://stackoverflow.com/questions/55724826/test-with-rspec-if-graphql-field-method-argument-default-value-is-set", "title": "Test with RSpec if graphQL field method argument default value is set", "body": "<p>How do I write a test to check the default values of a field methods argument?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    field :foo, String, null: false do\n      argument my_argument, Int, required: true\n      argument my_other_argument, Boolean, required: false\n    end\n\n    def foo(my_argument:, my_other_argument: true)\n      &lt;some code&gt;\n    end\n</code></pre>\n\n<p>My attempts at RSpec test:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    field :foo, \"String!\" do\n      it \"test that my_other_argument has a default value of true\"\n       resolve(args: {my_argument: 10}) # Note that my_other_argument is not given a value\n\n       expect(args[:my_other_argument]).to eq(true)\n      end\n    end\n</code></pre>\n\n<p>The above example fails and throws this error:</p>\n\n<pre><code>undefined local variable or method `args'\n</code></pre>\n\n<p>So to boil it down - can't seem to figure out how this row should be written:</p>\n\n<pre><code>expect(args[:my_other_argument]).to eq(true)\n</code></pre>\n\n<p>... or maybe I am at the complete wrong path?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "metaprogramming"], "answers": [{"tags": [], "owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "is_accepted": true, "score": 3, "last_activity_date": 1555496068, "last_edit_date": 1555496068, "creation_date": 1555495745, "answer_id": 55725107, "question_id": 55724748, "link": "https://stackoverflow.com/questions/55724748/ruby-automatically-initialize-class-instance-variables-of-child-classes-withou/55725107#55725107", "title": "Ruby - automatically initialize class instance variables of child classes without inheriting the value", "body": "<p>You don't have to initialize the class variable when it is being inherited. The Ruby style is to return and assign default value when the variable has not been set and is being accessed for the first time.</p>\n\n<p>Just create another class method for that:</p>\n\n<pre><code>class AbstractClass\n  def self.metadata\n    @metadata ||= []\n  end\n\n  def self.add_metadata(metadata)\n    self.metadata &lt;&lt; metadata\n  end\nend\n\nclass ChildClass1 &lt; AbstractClass\n  add_metadata(:child_class1)\nend\n\nclass ChildClass2 &lt; AbstractClass\n  add_metadata(:child_class2)\nend\n\nAbstractClass.metadata # =&gt; []\nChildClass1.metadata # =&gt; [:child_class1]\nChildClass2.metadata # =&gt; [:child_class2]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1555496626, "last_edit_date": 1555496626, "creation_date": 1555495956, "answer_id": 55725178, "question_id": 55724748, "link": "https://stackoverflow.com/questions/55724748/ruby-automatically-initialize-class-instance-variables-of-child-classes-withou/55725178#55725178", "title": "Ruby - automatically initialize class instance variables of child classes without inheriting the value", "body": "<p>Hooks are a great idea, you're just working off of the wrong one :) If you want to run code every time something <em>inherits</em> your class, then <code>inherited</code> is the one to use:</p>\n\n<pre><code>class AbstractClass\n  class &lt;&lt; self\n    attr_accessor :metadata\n\n    def inherited(child)\n      child.instance_variable_set(:@metadata, [child.name])\n    end\n  end\nend\n\nclass ChildClass1 &lt; AbstractClass; end\nclass ChildClass2 &lt; AbstractClass; end\n\nChildClass1.metadata\n# =&gt; [\"ChildClass1\"]\nChildClass2.metadata\n# =&gt; [\"ChildClass2\"]\n</code></pre>\n\n<p>Given that the question is tagged <a href=\"/questions/tagged/rails\" class=\"post-tag\" title=\"show questions tagged &#39;rails&#39;\" rel=\"tag\">rails</a>, you should also have <code>String#underscore</code> available; replace <code>child.name</code> with <code>child.name.underscore.to_s</code> to get <code>[:child_class1]</code>.</p>\n\n<p>EDIT: I might have misunderstood the question. If you just want to start with an empty array that you can add to, chumakoff's answer is simpler.</p>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 55725107, "answer_count": 2, "score": 1, "last_activity_date": 1555496626, "creation_date": 1555494586, "last_edit_date": 1555495321, "question_id": 55724748, "link": "https://stackoverflow.com/questions/55724748/ruby-automatically-initialize-class-instance-variables-of-child-classes-withou", "title": "Ruby - automatically initialize class instance variables of child classes without inheriting the value", "body": "<p>I am looking for a solution to automatically initialize a class variable through inheritance (make it available as an accessor and initialize it to some value). But I do NOT want to inherit the value, just start with a new fresh object each time on each class. </p>\n\n<p>I have been looking at <code>class_attributes</code> and thought I had found a workaround but it does not seem to be working as I thought (and even if it worked, it would most likely not do the thing I want since the same array would be used everywhere so it would behave like a @@ variable)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class AbstractClass\n  class_attribute :metadata\n  @metadata = [] # initialize metadata to an empty array\n\n  def self.add_metadata(metadata)\n    @metadata &lt;&lt; metadata\n  end\nend\n\ndef ChildClass &lt; AbstractClass\n  add_metadata(:child_class1)\nend\n\ndef ChildClass2 &lt; AbstractClass\n  add_metadata(:child_class2)\nend \n</code></pre>\n\n<p>I'd like to have the following : </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>AbstractClass.metadata # Don't really care about this one\nChildClass1.metadata # =&gt; [:child_class1]\nChildClass2.metadata # =&gt; [:child_class2]\n</code></pre>\n\n<p>I can think of a way to do this using modules with AS::Support</p>\n\n<pre><code>module InitializeClassInstanceVars\n  extend ActiveSupport::Concern \n\n  included do \n    class_attribute :metadata\n    self.metadata = []\n  end\nend\n</code></pre>\n\n<p>...and include this module in every nested class (and I believe this is what mongoid actually does for instance)</p>\n\n<p>but I was hoping I could do this directly via inheritance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows", "libxml2", "ovirt"], "comments": [{"owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1555495229, "post_id": 55724680, "comment_id": 98128689, "body": "The &quot;libxml2&quot; package isn&#39;t available. <a href=\"https://stackoverflow.com/questions/6834366/rails-installing-libxml2-on-windows\" title=\"rails installing libxml2 on windows\">stackoverflow.com/questions/6834366/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "is_accepted": true, "score": 2, "last_activity_date": 1555508425, "creation_date": 1555508425, "answer_id": 55728912, "question_id": 55724680, "link": "https://stackoverflow.com/questions/55724680/ruby-on-rails-bundle-update-giving-errors-in-windows/55728912#55728912", "title": "Ruby on rails : Bundle update giving errors in Windows", "body": "<p>I know this might not be a good answer for you, but running Ruby on Rails on windows is a pain, and going to be terrible experience, try to set a dual boot with Ubuntu, Debian or any other linux distribution along side with windows and then you can develop with RoR as it should.</p>\n"}], "owner": {"reputation": 223, "user_id": 6810066, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9a929ff73c337574f3c5c2fee84675e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vishnukk", "link": "https://stackoverflow.com/users/6810066/vishnukk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 55728912, "answer_count": 1, "score": 1, "last_activity_date": 1555508425, "creation_date": 1555494398, "question_id": 55724680, "link": "https://stackoverflow.com/questions/55724680/ruby-on-rails-bundle-update-giving-errors-in-windows", "title": "Ruby on rails : Bundle update giving errors in Windows", "body": "<p>I am trying to run my rails server. When I first ran, I got an error like this</p>\n\n<p><b>No timezone data source could be found. To resolve this, either install TZInfo:</b></p>\n\n<p>I resolve the error by updating the x64 version of tzinfo-data in the gem file. After that when I ran <b>bundle update</b>, I am getting the following error</p>\n\n<blockquote>\n  <p><strong>* extconf.rb failed *</strong> Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers.  Check\n  the mkmf.log file for more details.  You may need configuration\n  options.</p>\n  \n  <p>Provided configuration options:\n          --with-opt-dir\n          --without-opt-dir\n          --with-opt-include\n          --without-opt-include=${opt-dir}/include\n          --with-opt-lib\n          --without-opt-lib=${opt-dir}/lib\n          --with-make-prog\n          --without-make-prog\n          --srcdir=.\n          --curdir\n          --ruby=C:/Ruby24-x64/bin/$(RUBY_BASE_NAME)\n          --with-libxml2-config\n          --without-libxml2-config\n          --with-pkg-config\n          --without-pkg-config extconf.rb:29:in `': The \"libxml2\" package isn't available. (RuntimeError)</p>\n  \n  <p>To see why this extension failed to compile, please check the mkmf.log\n  which can be found here:</p>\n  \n  <p>C:/Ruby24-x64/lib/ruby/gems/2.4.0/extensions/x64-mingw32/2.4.0/ovirt-engine-sdk-4.3.0/mkmf.log</p>\n  \n  <p>extconf failed, exit code 1</p>\n  \n  <p>Gem files will remain installed in\n  C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/ovirt-engine-sdk-4.3.0 for\n  inspection. Results logged to\n  C:/Ruby24-x64/lib/ruby/gems/2.4.0/extensions/x64-mingw32/2.4.0/ovirt-engine-sdk-4.3.0/gem_make.out</p>\n  \n  <p>An error occurred while installing ovirt-engine-sdk (4.3.0), and\n  Bundler cannot continue. Make sure that <code>gem install ovirt-engine-sdk\n  -v '4.3.0' --source 'https://rubygems.org/'</code> succeeds before bundling.</p>\n  \n  <p>In Gemfile:   fog was resolved to 2.1.0, which depends on\n      fog-ovirt was resolved to 1.1.6, which depends on\n        ovirt-engine-sdk</p>\n</blockquote>\n\n<p>What could have possibly gone wrong? How to resolve this in Windows machines?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1555493604, "creation_date": 1555493604, "answer_id": 55724402, "question_id": 55724184, "link": "https://stackoverflow.com/questions/55724184/how-to-add-default-headers-to-each-mailer-rails-5-2/55724402#55724402", "title": "How to add default headers to each mailer rails 5.2", "body": "<p>I would expect that <a href=\"https://guides.rubyonrails.org/action_mailer_basics.html#edit-the-mailer\" rel=\"nofollow noreferrer\"><code>default</code></a> works for headers too:</p>\n\n<pre><code>class ApplicationMailer\n  default headers: { foo: 'bar' }\nend\n\ndef BazMailer &lt; ApplicationMailer\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 748, "user_id": 6344764, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f899d724ee6f570d62b02416abc5c9d9?s=128&d=identicon&r=PG&f=1", "display_name": "JohnSmith", "link": "https://stackoverflow.com/users/6344764/johnsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555493604, "creation_date": 1555492991, "last_edit_date": 1555493355, "question_id": 55724184, "link": "https://stackoverflow.com/questions/55724184/how-to-add-default-headers-to-each-mailer-rails-5-2", "title": "How to add default headers to each mailer rails 5.2", "body": "<p>Is there a way to add default headers to each mailer. I have a helper where I create the header but I still need to call the helper (<code>add_headers</code>) in each mailer seperatly. Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "redmine"], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 8229753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22660980995e03dfd59812c9acf93db8?s=128&d=identicon&r=PG&f=1", "display_name": "Ketan Mangukiya", "link": "https://stackoverflow.com/users/8229753/ketan-mangukiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1555494196, "last_edit_date": 1555494196, "creation_date": 1555493830, "answer_id": 55724475, "question_id": 55723959, "link": "https://stackoverflow.com/questions/55723959/actionviewtemplateerror-no-route-matches-action-in-button-to-link-to-cal/55724475#55724475", "title": "ActionView::Template::Error - No route matches action in button_to \\ link_to calling controller action", "body": "<p>Add routes in <strong>routes.rb</strong> file</p>\n\n<pre><code>resources :redmine_as do \n  collections do \n    post :a\n  end\nend\n</code></pre>\n\n<p>After that, Please fine the Routes url by typing on terminal below command</p>\n\n<pre><code>rake routes | grep p\n</code></pre>\n\n<p>Set the url in Link or button</p>\n\n<pre><code>link_to \"Your Link Name\", p_redmine_as_path\n</code></pre>\n\n<p><strong>p_redmines_path</strong> it will be return by that \"rake routes \n | grep p\" command.</p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 9272737, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E_FNFd54uV4/AAAAAAAAAAI/AAAAAAAAAYI/Zr70ZKLdUgc/photo.jpg?sz=128", "display_name": "Fed C", "link": "https://stackoverflow.com/users/9272737/fed-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1555886327, "creation_date": 1555886327, "answer_id": 55787356, "question_id": 55723959, "link": "https://stackoverflow.com/questions/55723959/actionviewtemplateerror-no-route-matches-action-in-button-to-link-to-cal/55787356#55787356", "title": "ActionView::Template::Error - No route matches action in button_to \\ link_to calling controller action", "body": "<p>As Ketan indicated, I was missing a route!</p>\n\n<p>I put in my routes.rb: </p>\n\n<pre><code>resources :important_user do \n    collection do \n      post :u_update\n    end\n  end\n</code></pre>\n\n<p>and in my controller: </p>\n\n<pre><code>  def u_update\n      puts params[:p_id] \n      puts \"update!\"\n  end\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 9272737, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E_FNFd54uV4/AAAAAAAAAAI/AAAAAAAAAYI/Zr70ZKLdUgc/photo.jpg?sz=128", "display_name": "Fed C", "link": "https://stackoverflow.com/users/9272737/fed-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555886327, "creation_date": 1555492339, "question_id": 55723959, "link": "https://stackoverflow.com/questions/55723959/actionviewtemplateerror-no-route-matches-action-in-button-to-link-to-cal", "title": "ActionView::Template::Error - No route matches action in button_to \\ link_to calling controller action", "body": "<p>I'm trying to create a view with a button calling a controller action for a Redmine Plugin (unfortunately, I'm quite new at Rails). I'd need to create a method for my controller (here A Controller) so i can update some Active Records.</p>\n\n<p>I created a controller:</p>\n\n<p>redmine_a_controller.rb</p>\n\n<pre><code>class RedmineAController &lt; ApplicationController\n\n  def prova(input)\n    puts input\n    return input\n  end\n\n  def p\n    puts 'vuoto'\n    returns 'vuoto'\n  end\n\nend\n</code></pre>\n\n<p>The actions work correctly when called from the console. Unfortunately, when called from my view _a.html.erb:</p>\n\n<pre><code>  &lt;%= \n      button_to l(:imp_update), {\n        :controller =&gt; 'RedmineAController',\n        :action =&gt; 'p',\n        method: :post\n      }\n  %&gt;\n</code></pre>\n\n<p>It returns this error:</p>\n\n<pre><code>ActionView::Template::Error (No route matches {:action=&gt;\"p\", :controller=&gt;\"RedmineAController\", :id=&gt;\"prova\", :method=&gt;:post, :tab=&gt;\"important_users\"}):\n</code></pre>\n\n<p>I tried by calling the action on a new instance:</p>\n\n<pre><code>  &lt;%= \n      button_to l(:imp_update), {\n        :action =&gt; RedmineImportantUsersController.new.prova(1),\n        method: :post\n      }\n  %&gt;\n</code></pre>\n\n<p>but it looks for the action in the Projects controller</p>\n\n<pre><code>ActionView::Template::Error (No route matches {:action=&gt;\"1\", :controller=&gt;\"projects\", :id=&gt;\"prova\", :method=&gt;:post}):\n</code></pre>\n\n<p>How can I make button_to call the correct <code>prova</code> method in the <code>RedmineAController</code> controller?</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1555491211, "post_id": 55723528, "comment_id": 98126305, "body": "Your code is working fine, it&#39;s not the issue it may be something else. please cross check it."}], "answers": [{"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1555499715, "post_id": 55723582, "comment_id": 98131238, "body": "my pleasure @NancyMooree :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1555491672, "last_edit_date": 1555491672, "creation_date": 1555491147, "answer_id": 55723582, "question_id": 55723528, "link": "https://stackoverflow.com/questions/55723528/how-to-properly-check-if-a-variable-is-in-array-using-ruby/55723582#55723582", "title": "How to properly check if a variable is in array using Ruby?", "body": "<p>I tried these two lines</p>\n\n<pre><code>var_tea = 'Tea'\nmycheck = ['Soap', 'Tea', 'Sugar'].include? var_tea\n</code></pre>\n\n<p>and <code>mycheck</code> is <code>true</code></p>\n\n<p>My guess is that you obviously don't have that variable in the line above, it's probably coming from a request, and that's not exactly <code>Tea</code>, maybe <code>tea</code>. Try to print <code>var_tea</code> before that check.</p>\n\n<pre><code>puts var_tea.inspect\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 9066380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f127b4af4d9fc36044bb117a2d9db4?s=128&d=identicon&r=PG&f=1", "display_name": "Cdalbergue", "link": "https://stackoverflow.com/users/9066380/cdalbergue"}, "is_accepted": false, "score": 0, "last_activity_date": 1555494065, "creation_date": 1555494065, "answer_id": 55724561, "question_id": 55723528, "link": "https://stackoverflow.com/questions/55723528/how-to-properly-check-if-a-variable-is-in-array-using-ruby/55724561#55724561", "title": "How to properly check if a variable is in array using Ruby?", "body": "<p>Your code seems right, but you could make it better.</p>\n\n<p>First of all, you're checking if a variable is true. A better way to do it in ruby would be:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>if mycheck\n  print(\"yes present\")\nelse\n  print(\"not present\")\nend\n</code></pre>\n\n<p>You can also try:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>my_check = var_tea.in? ['Soap', 'Tea', 'Sugar']\n</code></pre>\n\n<p>If you have the same issue, make sure that you double check your code, and that you don't have any <code>my_check=</code> method or something.</p>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 55723582, "answer_count": 2, "score": 1, "last_activity_date": 1567292950, "creation_date": 1555490940, "last_edit_date": 1567292950, "question_id": 55723528, "link": "https://stackoverflow.com/questions/55723528/how-to-properly-check-if-a-variable-is-in-array-using-ruby", "title": "How to properly check if a variable is in array using Ruby?", "body": "<p>I am trying to check if variable is in array so I used a solution <a href=\"https://stackoverflow.com/questions/1986386/check-if-a-value-exists-in-an-array-in-ruby/1986398\">found here</a>.</p>\n\n<p>The code below works fine if I pass value of tea direct in the include function as per below.</p>\n\n<pre><code>mycheck= ['Soap', 'Tea', 'Sugar'].include? 'Tea'\n      if mycheck == true\n        print(\"yes present\")\n      else\n        print(\"not present\")\n      end\n</code></pre>\n\n<p><strong>My issues:</strong>\nMy issue if I set value tea to a variable as per code below, it returns false</p>\n\n<pre><code>var_tea = 'Tea'\nmycheck= ['Soap', 'Tea', 'Sugar'].include? var_tea\n      if mycheck == true\n        print(\"yes present\")\n      else\n        print(\"not present\")\n      end\n</code></pre>\n\n<p>Is there any other alternative way like using <code>is_array()</code>, etc?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1555488075, "post_id": 55722571, "comment_id": 98124567, "body": "I suggest studying a bit of SQL if you are interested in writing good active record&#39;s queries"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1555530230, "post_id": 55722571, "comment_id": 98148175, "body": "What way can I make it so only 1 copy of the category appears?  For instance, if 2 listings use the same category, it&#39;s appearing twice"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1555530411, "post_id": 55722571, "comment_id": 98148253, "body": "Looks like <code>.distinct</code> does the job.  Is that the best way in your ways?"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1555487605, "creation_date": 1555487605, "answer_id": 55722571, "question_id": 55722525, "link": "https://stackoverflow.com/questions/55722525/view-all-records-which-exist-in-associated-record/55722571#55722571", "title": "View all records which exist in associated record", "body": "<p>You just need a join for that. Try</p>\n\n<pre><code>Category.joins(:listings)\n</code></pre>\n\n<p>In this way you should see just rows which have a match in listings</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 55722571, "answer_count": 1, "score": 0, "last_activity_date": 1555487605, "creation_date": 1555487444, "question_id": 55722525, "link": "https://stackoverflow.com/questions/55722525/view-all-records-which-exist-in-associated-record", "title": "View all records which exist in associated record", "body": "<p><strong>Goal:</strong>\nI want to show all Category that are currently in existence in the Listing model.</p>\n\n<p>For instance, a Listing can have many categories.  Say I have 100 categories and 10 listings but only 20 of those categories are currently being used in the Listing.category_ids, I only want those to appear.</p>\n\n<p><strong>I have tried:</strong></p>\n\n<pre><code>@categories = Category.all.where(id: @listings.each {|listing| listing.category_ids})\n\n@categories = Category.where(id: Listing.all.includes(:category_ids)).order(name: :asc)\n\n@categories = Category.where(id: [@listings.each {|listing| listing.category_ids}])\n</code></pre>\n\n<p>And some other similar ways.  BTW, i use Postgres.</p>\n\n<p>Both of these attempts have only appeared the first category within the Category model, even though that category isn't being used.</p>\n\n<p>Models:</p>\n\n<p>Listing</p>\n\n<pre><code>has_and_belongs_to_many :categories\n</code></pre>\n\n<p>Categories:</p>\n\n<pre><code>has_and_belongs_to_many :listings\n</code></pre>\n\n<p>I then have a Categories_Listings join table too t for it all.  That is where the associations are stored.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "selenium-chromedriver", "google-chrome-headless"], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 9973539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2yTUF.jpg?s=128&g=1", "display_name": "G. Kolev", "link": "https://stackoverflow.com/users/9973539/g-kolev"}, "is_accepted": false, "score": 0, "last_activity_date": 1555574990, "creation_date": 1555574990, "answer_id": 55741704, "question_id": 55722310, "link": "https://stackoverflow.com/questions/55722310/full-screen-mode-is-not-working-in-selenium-chromedriver-headless-mode/55741704#55741704", "title": "Full screen mode is not working in selenium chromedriver headless mode", "body": "<p>How do you run headless? Some X emulators like Xvfb require that you specify a resolution of your display, otherwise apps won't be able to go fullscreen or maximized. See this example:</p>\n\n<pre><code>export DISPLAY=:1  \nXvfb $DISPLAY -screen 0 1024x768x16 &amp;  \nruby mytest.rb\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1555881564, "creation_date": 1555881564, "answer_id": 55786844, "question_id": 55722310, "link": "https://stackoverflow.com/questions/55722310/full-screen-mode-is-not-working-in-selenium-chromedriver-headless-mode/55786844#55786844", "title": "Full screen mode is not working in selenium chromedriver headless mode", "body": "<p>Chrome in its native headless mode doesn't support fullscreen mode because it doesn't really know about the screen.  You can resize it to any size you like, but it won't see that as full screen.</p>\n"}], "owner": {"reputation": 21, "user_id": 1768734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff9b9051e30ace175fadad03475a688?s=128&d=identicon&r=PG", "display_name": "Elangovan", "link": "https://stackoverflow.com/users/1768734/elangovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1555881564, "creation_date": 1555486668, "last_edit_date": 1555492222, "question_id": 55722310, "link": "https://stackoverflow.com/questions/55722310/full-screen-mode-is-not-working-in-selenium-chromedriver-headless-mode", "title": "Full screen mode is not working in selenium chromedriver headless mode", "body": "<p>For example, I need to check is full screen is enabled or not after clicking the \"Full Screen\" icon in youtube.</p>\n\n<p>When we run the script in UI, we can check with using of executing this \"document.fullscreenElement\" script. It is working. </p>\n\n<p>But I need to run same in headless mode. It returns null and I have checked with using of taking a screenshot.</p>\n\n<p>Is this possible in headless mode?</p>\n\n<p>I have written a script in \"ruby\" using \"selenium-webdriver\".</p>\n\n<p>Below script is running in UI mode successfully. But when we use -headless to chromeoptions it is not working.</p>\n\n<pre><code>require \"selenium-webdriver\"\ndriver = Selenium::WebDriver.for :chrome\ndriver.get(\"https://youtube.com/&lt;any video url&gt;\")\ndriver.action.move_to(driver.find_element(:css,\".ytp-right-controls\")).perform\ndriver.find_element(:css,\".ytp-fullscreen-button\").click\ndriver.execute_script('return document.fullscreenElement').nil?\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 15480, "user_id": 229688, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FVcL0.jpg?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/229688/arnaud"}, "reply_to_user": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "edited": false, "score": 0, "creation_date": 1555488039, "post_id": 55722420, "comment_id": 98124546, "body": "well if it does, don&#39;t forget to upvote/accept the solution ;)"}], "tags": [], "owner": {"reputation": 15480, "user_id": 229688, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FVcL0.jpg?s=128&g=1", "display_name": "Arnaud", "link": "https://stackoverflow.com/users/229688/arnaud"}, "is_accepted": true, "score": 1, "last_activity_date": 1555487122, "creation_date": 1555487122, "answer_id": 55722420, "question_id": 55722302, "link": "https://stackoverflow.com/questions/55722302/how-to-check-if-user-already-rated-a-book/55722420#55722420", "title": "How to check if user already rated a book", "body": "<p>What you want is to add a validation constraint on your review model.</p>\n\n<pre><code>class Review\n  belongs_to :user\n  belongs_to :book\n\n  validates :book_id, uniqueness: { scope: :user_id }\nend\n</code></pre>\n\n<p>The validation clause can be read as \"validate the uniqueness of book_id for a given user_id\".</p>\n\n<p>So validation will be false if a user tries to create a review for a book he/she already reviewed.</p>\n"}], "owner": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55722420, "answer_count": 1, "score": 1, "last_activity_date": 1555487122, "creation_date": 1555486639, "question_id": 55722302, "link": "https://stackoverflow.com/questions/55722302/how-to-check-if-user-already-rated-a-book", "title": "How to check if user already rated a book", "body": "<p>I want to make a review system like Google Play for my Library app, which mean 1 user just can submit review 1 time, the next time will be edit review</p>\n\n<p><a href=\"https://imgur.com/a/RciVuln\" rel=\"nofollow noreferrer\">https://imgur.com/a/RciVuln</a></p>\n\n<p>This is what I have so far:</p>\n\n<p>In Book/show.html.erb</p>\n\n<pre><code>     &lt;div class=\"col-md-7 col-md-offset-1\"&gt;\n      &lt;% @book.reviews.each do |r| %&gt;\n        &lt;div class = \"reviews\" &gt;\n          &lt;div class=\"star-rating\" data-score= &lt;%= r.rating %&gt;&lt;/div&gt;\n          &lt;%= link_to r.user.name, r%&gt;\n          &lt;p&gt;&lt;%= r.comment %&gt;&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;    \n     &lt;/div&gt;\n     &lt;/div&gt;\n\n     &lt;script&gt;\n $('.star-rating').raty({\n    path: '/assets/',\n    readOnly: true,\n    score: function() {\n      return $(this).attr('data-score');\n    }\n  });\n     &lt;/script&gt;\n</code></pre>\n\n<p>In reviews_controller</p>\n\n<pre><code>    def update\n    @reviews = Reviews.find_by(params[:id])\n    @review.update_attributes(reviews_params)\n    @book  = Book.find(@review.book_id)\n    flash[:success] = \"Comment updated\"\n    redirect_to @book\n    end\n\n    def edit\n    @review = Review.find(params[:id])\n    end\n</code></pre>\n\n<p>In reviews/edit.html.erb:</p>\n\n<pre><code>    &lt;%= form_for(@review) do |f| %&gt;\n    &lt;%= f.error_notification message: \n     f.object.errors[:base].to_sentence if \n     f.object.errors[:base].present? %&gt;\n    &lt;div class=\"field\"&gt;\n    &lt;div id=\"star-rating\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;%= f.label :comment %&gt;\n    &lt;%= f.text_area :comment, class: 'text-area' %&gt;\n    &lt;%= f.hidden_field :book_id%&gt;\n   &lt;div&gt;\n\n   &lt;div class=\"form-actions\"&gt;\n   &lt;%= f.button :submit, class:\"btn btn-primary\" %&gt;\n   &lt;/div&gt;\n   &lt;% end %&gt;\n   &lt;script&gt;\n   $('#star-rating').raty({\n    path: '/assets/',\n    scoreName: 'review[rating]'\n   });\n   &lt;/script&gt;\n</code></pre>\n\n<p>I don't know if rails have a function to check the  current user's id with the user review's id for that book</p>\n"}, {"tags": ["ruby", "closures", "string-parsing", "idioms", "readability"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4614771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6640adea5d6a13d44c490839a5f6a032?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Ph", "link": "https://stackoverflow.com/users/4614771/ben-ph"}, "edited": false, "score": 0, "creation_date": 1555488214, "post_id": 55722399, "comment_id": 98124646, "body": "Thank you! Those are goo. I&#39;m not familiar with <code>do-end</code>, but I&#39;m sure I can figure it out"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1555494511, "post_id": 55722399, "comment_id": 98128223, "body": "Yes, but it does not remove the <code>\\n</code>. I don&#39;t know"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 0, "last_activity_date": 1555487076, "creation_date": 1555487076, "answer_id": 55722399, "question_id": 55722189, "link": "https://stackoverflow.com/questions/55722189/in-ruby-idiomatically-and-cleanly-improve-on-this-use-of-split-and-map-to-turn/55722399#55722399", "title": "In Ruby, Idiomatically and cleanly improve on this use of split and map to turn string input to a 2d int array (i.e. a matrix)", "body": "<p>Your code looks fine to me.</p>\n\n<pre><code>in_string.split(/\\n/).map { |row| row.split.map(&amp;:to_i) }\n</code></pre>\n\n<p>We usually just avoid multiline blocks with <code>{}</code>. Use <code>do-end</code> for multiline blocks.</p>\n\n<p>Two small improvements I found</p>\n\n<ul>\n<li><code>split</code> default parameter is <code>' '</code></li>\n<li>If you don't need a block don't use it. Just pass the proc to it <code>map(&amp;:to_i)</code></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 4614771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6640adea5d6a13d44c490839a5f6a032?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Ph", "link": "https://stackoverflow.com/users/4614771/ben-ph"}, "edited": false, "score": 0, "creation_date": 1555488119, "post_id": 55722407, "comment_id": 98124593, "body": "This is the first I&#39;ve heard about <code>do end</code>. Is it one of the things that can easily be found, or is it worth asking for an example?"}, {"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "reply_to_user": {"reputation": 9, "user_id": 4614771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6640adea5d6a13d44c490839a5f6a032?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Ph", "link": "https://stackoverflow.com/users/4614771/ben-ph"}, "edited": false, "score": 0, "creation_date": 1555488432, "post_id": 55722407, "comment_id": 98124751, "body": "@BenPh, there are ruby style guides in github, like this <a href=\"https://github.com/airbnb/ruby#syntax\" rel=\"nofollow noreferrer\">github.com/airbnb/ruby#syntax</a>. &quot;Avoid using {...} for multi-line blocks&quot;"}], "tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": 0, "last_activity_date": 1555487097, "creation_date": 1555487097, "answer_id": 55722407, "question_id": 55722189, "link": "https://stackoverflow.com/questions/55722189/in-ruby-idiomatically-and-cleanly-improve-on-this-use-of-split-and-map-to-turn/55722407#55722407", "title": "In Ruby, Idiomatically and cleanly improve on this use of split and map to turn string input to a 2d int array (i.e. a matrix)", "body": "<p>I think it is good enough. if you think the nested block is not good to read. you can define a method like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def to_int_arr(str)\n  str.split(' ').map(&amp;:to_i)\nend\n\nin_string.split(/\\n/).map{|str| to_int_arr(str)}\n</code></pre>\n\n<p>BTW, better to use <code>do end</code> in multiline block</p>\n"}, {"tags": [], "owner": {"reputation": 11603, "user_id": 234593, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8e2ee1b00d372ad8f6ed5e87385ffef5?s=128&d=identicon&r=PG", "display_name": "Kache", "link": "https://stackoverflow.com/users/234593/kache"}, "is_accepted": false, "score": 0, "last_activity_date": 1555569088, "creation_date": 1555569088, "answer_id": 55740289, "question_id": 55722189, "link": "https://stackoverflow.com/questions/55722189/in-ruby-idiomatically-and-cleanly-improve-on-this-use-of-split-and-map-to-turn/55740289#55740289", "title": "In Ruby, Idiomatically and cleanly improve on this use of split and map to turn string input to a 2d int array (i.e. a matrix)", "body": "<p>Ruby has a lot of convenience built-ins for \"clean readability\", e.g</p>\n\n<ul>\n<li>the default arguments to <code>each_line</code> and <code>split</code></li>\n<li>symbols with the <code>.to_proc</code> shortcut, <code>&amp;</code></li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>input = \"2 6 4\\n7 9 8\"\n\ninput.each_line.map { |line| line.split.map(&amp;:to_i) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1555626348, "creation_date": 1555626348, "answer_id": 55754412, "question_id": 55722189, "link": "https://stackoverflow.com/questions/55722189/in-ruby-idiomatically-and-cleanly-improve-on-this-use-of-split-and-map-to-turn/55754412#55754412", "title": "In Ruby, Idiomatically and cleanly improve on this use of split and map to turn string input to a 2d int array (i.e. a matrix)", "body": "<pre><code>str = \"2 6 4\\n7 9 8\\n\"\n\narr = str.split.map(&amp;:to_i)\n  #=&gt; [2, 6, 4, 7, 9, 8]\narr.each_slice(arr.size/str.lines.size).to_a\n  #=&gt; [[2, 6, 4], [7, 9, 8]]\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4614771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6640adea5d6a13d44c490839a5f6a032?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Ph", "link": "https://stackoverflow.com/users/4614771/ben-ph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55722399, "answer_count": 4, "score": 0, "last_activity_date": 1555626348, "creation_date": 1555486248, "last_edit_date": 1555557361, "question_id": 55722189, "link": "https://stackoverflow.com/questions/55722189/in-ruby-idiomatically-and-cleanly-improve-on-this-use-of-split-and-map-to-turn", "title": "In Ruby, Idiomatically and cleanly improve on this use of split and map to turn string input to a 2d int array (i.e. a matrix)", "body": "<p>I suspect there's a cleaner, more idiomatic, Ruby-way to solve this puzzle than what I've made. I'm too new to Ruby, though, to confirm. All my searches have not addressed the question of how to best write Ruby in the examples I give below. </p>\n\n<p>The puzzle, is I need to take a string-input and turn it into a matrix. Lines are separated by <code>'\\n'</code>, row-elements are separated by <code>' '</code> </p>\n\n<p>E.g. the string input <code>\"2 6 4\\n7 9 8\"</code> has output <code>[[2, 6, 4], [7, 9, 8]]</code> I.e. the matrix:</p>\n\n<pre><code>2 6 4\n7 9 8\n</code></pre>\n\n<p>This is my solution:</p>\n\n<pre><code>@rows = in_string.split(/\\n/).map{|str| str.split(' ').map{|ch| ch.to_i}}\n</code></pre>\n\n<p>Explanation of what is happening</p>\n\n<ol>\n<li><code>\"2 6 4\\n7 9 8\"</code> => split by new-line => <code>[\"2 6 4\", \"7 9 8\"]</code></li>\n<li>map over elements from 1. to split by <code>' '</code>=> <code>[[\"2\", \"6\", \"4\"], [\"7\", \"9\", \"8\"]]</code></li>\n<li>map over elements of 2. to become <code>int</code>s (this occurs once for each row)</li>\n<li>Fin. We have the result we are after</li>\n</ol>\n\n<p>I feel like this code is not very readable, but I come from rust, so I'm not used to the good style </p>\n\n<p>I'm not familiar enough with Ruby to understand good ways to write these sort of solutions. I've tried using more lines like so</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@rows = in_string.split(/\\n/).map{\n            |str| str.split(' ').map{\n                |ch| ch.to_i\n            }\n         }\n</code></pre>\n\n<p>But I still feel left in the dark on what might be considered good style, or what other options are available. </p>\n\n<p>The correctness of the code is fine. For me, a great answer is one that will give me an insight in what to look out for when diving into similar problems in the future, and to have more confidence in my understanding of what makes elegant Ruby code.</p>\n\n<p><strong>EDIT from answers</strong>\nSuggestions so far</p>\n\n<ul>\n<li>use default for split</li>\n<li>use defaults on the map</li>\n<li>use <code>do-end</code> (I'm yet to learn). If someone wants to edit this in, fantastic.</li>\n</ul>\n\n<p>This is what I ended up with:\n<code>@rows = in_string.split(/\\n/).map( |chrs| chrs.split.map( &amp;:to_i ) )</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1555486226, "post_id": 55722107, "comment_id": 98123537, "body": "Your production environment probably works on more than one process, I suspect this to be the problem here."}, {"owner": {"reputation": 17647, "user_id": 5515060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BXWsz.png?s=128&g=1", "display_name": "Lino", "link": "https://stackoverflow.com/users/5515060/lino"}, "edited": false, "score": 0, "creation_date": 1555486287, "post_id": 55722107, "comment_id": 98123571, "body": "What about when multiple users trying to submit a form at the same time?"}, {"owner": {"reputation": 25, "user_id": 2582234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82aa1649c750b1c7238fc158ce89f34c?s=128&d=identicon&r=PG", "display_name": "user2582234", "link": "https://stackoverflow.com/users/2582234/user2582234"}, "edited": false, "score": 0, "creation_date": 1555486313, "post_id": 55722107, "comment_id": 98123586, "body": "Yes, that&#39;s true. How could I solve this problem? Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "is_accepted": true, "score": 1, "last_activity_date": 1555489429, "last_edit_date": 1555489429, "creation_date": 1555487783, "answer_id": 55722628, "question_id": 55722107, "link": "https://stackoverflow.com/questions/55722107/rails-variables-in-production-environment/55722628#55722628", "title": "rails variables in production environment", "body": "<p>Your solution will create conflicts when more than two users try to edit simultaneously, So basically what idea I have is:</p>\n\n<ol>\n<li><p>Add one virtual attribute in your model <code>edit_start_time</code> You don't need attribute for <code>endtime</code> because it can be directly fetched by <code>Time.now</code> at any time.</p></li>\n<li><p>Set <code>edit_start_time</code> value in <code>edit</code> method like:</p>\n\n<pre><code>  @model.edit_start_time = Time.now.utc #you can use any  \n</code></pre></li>\n<li><p>In <code>update</code> method directly calculate edit time like:</p>\n\n<pre><code>total_update_time = Time.now.utc - @model.edit_start_time.utc\n</code></pre></li>\n</ol>\n\n<p>If you are unaware of how to create virtual attributes then there are so many questions on StackOverflow as well as docs. I am not explaining how to do it here because its the different topic.</p>\n\n<p>All the best</p>\n"}, {"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1555491548, "creation_date": 1555491548, "answer_id": 55723703, "question_id": 55722107, "link": "https://stackoverflow.com/questions/55722107/rails-variables-in-production-environment/55723703#55723703", "title": "rails variables in production environment", "body": "<p>You're using class variables that can interfer with each other. Your <code>Test</code> class will only ever have one class variable called <code>@@start_time</code> associated with it.</p>\n\n<p>This means if another user sees the form, they will reset the @@start_time for every user currently on it.</p>\n\n<p>To prevent this, use instance varaibles. When a new user sees the form, they will make a new instance variable that is tied to their instance of the class, rather than the class itself. This will allow users to have different start and end times.0</p>\n\n<p>All you need to do is change every <code>@@</code> to <code>@</code>. So instead of <code>@@start_time', try</code>@start_time` throughout your code, and the same for end_time.</p>\n"}], "owner": {"reputation": 25, "user_id": 2582234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82aa1649c750b1c7238fc158ce89f34c?s=128&d=identicon&r=PG", "display_name": "user2582234", "link": "https://stackoverflow.com/users/2582234/user2582234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55722628, "answer_count": 2, "score": 0, "last_activity_date": 1555550978, "creation_date": 1555485970, "last_edit_date": 1555550978, "question_id": 55722107, "link": "https://stackoverflow.com/questions/55722107/rails-variables-in-production-environment", "title": "rails variables in production environment", "body": "<p>I am developing a rails app. Most of the parts work fine, but I got one weird problem when I tried to calculate the time an user used to edit and submit one form.</p>\n\n<p>I thought it would be good to do it in the following order:\n1. in the controller \"edit\" method, record the time the user start to see the form.\n2. in the \"update\" method, record the submit time, then do the math and get how long the user had spent on the form.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Test\n  @@start_time = 0\n  @@end_time = 0\n\n  def edit\n    @@start_time = Time.now\n  end\n\n  def update\n    @@end_time = Time.now\n    time_used = @@end_time - @@start_time\n    puts time_used.to_i\n  end\nend\n</code></pre>\n\n<p>The code above actually works fine while running on my own developing computer, the output is what I expected. But when I upload the code to the production environment(multicore cpus), sometime the output is right, sometime it is not. I debugged the code and found in some case, the @@start_time is set to 0 when submitting the form. I am confused what was going on, maybe I just misused the @@ for the variable. Please help me out, any idea would be appreciated, thanks.</p>\n\n<p>Edit:\nThe problem is solved by adding a virtual attribute to the model as hinted by Vishal. In addition, I added a hidden field in the submit form, and in the strong parameter part added the corresponding parameter to allow it to be passed from edit to update method.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1555487697, "post_id": 55722077, "comment_id": 98124311, "body": "That&#39;s just an example in a series of examples building up to the final point, it isn&#39;t meant to be read or understood in isolation. The construct in question generally appears when the logic takes more than one line to clearly express and even then it is often written as an <code>if</code> (depending on the author&#39;s preferred style of course)."}], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 3, "last_activity_date": 1555516771, "last_edit_date": 1555516771, "creation_date": 1555489396, "answer_id": 55723063, "question_id": 55722077, "link": "https://stackoverflow.com/questions/55722077/what-is-the-purpose-of-using-ruby-begin-without-rescue/55723063#55723063", "title": "What is the purpose of using ruby begin without rescue?", "body": "<p>This example is just bad - for the described case, there is no difference in behavior (and the bytecode will look very similar if not the same).</p>\n\n<p><code>begin ... end</code> block can be used for grouping <em>several</em> expressions - for example, for memoizing the intermediate result of some heavy calculations without additional intermediate assignments, like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>some_var = begin\n  # a bunch of expressions goes there\nend\n\n# continue calculations using some_var\n\n</code></pre>\n\n<p>Actually, <code>begin ... end</code> block acts in pretty much the same way as <code>def ... end</code> does to define a method. And because of this similarity <code>begin .... end</code> is not used very often in the production code - in most practical cases it's better to move the group of closely related expressions into a separate method.</p>\n\n<p>There is one case when this block can make the difference - consider</p>\n\n<pre><code>some_method while false\n</code></pre>\n\n<p>vs</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>begin\n  some_method\nend while false\n</code></pre>\n\n<p>In the former snippet <code>some_method</code> isn't called at all, while in the latter it will be called once. But this usage is kind of discouraged - it makes the code trickier (the same can be done in a much more readable way with <code>loop</code> and explicit <code>break</code>)</p>\n"}], "owner": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 55723063, "answer_count": 1, "score": 0, "last_activity_date": 1555516771, "creation_date": 1555485892, "question_id": 55722077, "link": "https://stackoverflow.com/questions/55722077/what-is-the-purpose-of-using-ruby-begin-without-rescue", "title": "What is the purpose of using ruby begin without rescue?", "body": "<p>In looking at <a href=\"http://vaidehijoshi.github.io/blog/2015/08/25/unlocking-ruby-keywords-begin-end-ensure-rescue/\" rel=\"nofollow noreferrer\">http://vaidehijoshi.github.io/blog/2015/08/25/unlocking-ruby-keywords-begin-end-ensure-rescue/</a> I don't understand the example</p>\n\n<pre><code>def create_or_update_batch\n  @batch ||= begin\n    BookBatch.create(book_batch.batch_attrs)\n  end\n\n  @batch.update\nend\n</code></pre>\n\n<p>What if I had</p>\n\n<pre><code>def create_or_update_batch\n  @batch ||= BookBatch.create(book_batch.batch_attrs)\n\n  @batch.update\nend\n</code></pre>\n\n<p>How is this different?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2026, "user_id": 4473406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f14727fcdc211ea5921ef8116b5f6d?s=128&d=identicon&r=PG", "display_name": "Siim Liiser", "link": "https://stackoverflow.com/users/4473406/siim-liiser"}, "edited": false, "score": 1, "creation_date": 1555492062, "post_id": 55721996, "comment_id": 98126779, "body": "You&#39;re never assigning the parameters you get in the controller to the model in the code you provided. In the model validation you&#39;re checking if started_at and ended_at are present, but then comparing started_at and signed_at. signed_at is nil and throws an error.  If you just assign the hash to the attributes of the model, rails will parse the hash to the proper datetime value for you, no need to call .to_datetime on it afterwards."}, {"owner": {"reputation": 21, "user_id": 11270209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YND2jA7wMto/AAAAAAAAAAI/AAAAAAAAACg/8XDuS9KSE5A/photo.jpg?sz=128", "display_name": "XueSong_Zhang", "link": "https://stackoverflow.com/users/11270209/xuesong-zhang"}, "reply_to_user": {"reputation": 2026, "user_id": 4473406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f14727fcdc211ea5921ef8116b5f6d?s=128&d=identicon&r=PG", "display_name": "Siim Liiser", "link": "https://stackoverflow.com/users/4473406/siim-liiser"}, "edited": false, "score": 0, "creation_date": 1555557687, "post_id": 55721996, "comment_id": 98154777, "body": "Thank you for your reply. I have used the method you provided to achieve the goal. Thank you again."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11270209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YND2jA7wMto/AAAAAAAAAAI/AAAAAAAAACg/8XDuS9KSE5A/photo.jpg?sz=128", "display_name": "XueSong_Zhang", "link": "https://stackoverflow.com/users/11270209/xuesong-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1555646091, "creation_date": 1555646091, "answer_id": 55756389, "question_id": 55721996, "link": "https://stackoverflow.com/questions/55721996/how-to-get-the-date-from-date-select-and-verify-it/55756389#55756389", "title": "How to get the date from &quot;date_select&quot; and verify it?", "body": "<p>Thanks to Siim Liiser for his help, I have been able to verify it successfully.</p>\n\n<pre><code># Order::Entered &lt; Order\nvalidate :check_ended_at\n\ndef check_ended_at\n  if self.started_at.present? &amp;&amp; self.ended_at.present?\n    if self.ended_at &lt; (self.started_at + signed_years_count.year)\n      errors.add :started_at, 'error message...'\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11270209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YND2jA7wMto/AAAAAAAAAAI/AAAAAAAAACg/8XDuS9KSE5A/photo.jpg?sz=128", "display_name": "XueSong_Zhang", "link": "https://stackoverflow.com/users/11270209/xuesong-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555646091, "creation_date": 1555485597, "question_id": 55721996, "link": "https://stackoverflow.com/questions/55721996/how-to-get-the-date-from-date-select-and-verify-it", "title": "How to get the date from &quot;date_select&quot; and verify it?", "body": "<p>I'm a beginner of ruby.\nI want to get dates from forms and validate them in subclasses, but I don't know how to implement them. Maybe I don't know how to get dates from hash. Please help me.</p>\n\n<pre><code># HTML\n&lt;%= form_with model: @order, scope: :order, url: update_signed_in_show_employer_url(order.employer, order_id: order.id) , method: :put, class: '' do |f| %&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label&gt;start date:&lt;/label&gt;\n    &lt;% if order.signed_at.present? %&gt;\n    &lt;%= f.date_select :started_at, {default: order.signed_at}, { class: 'form-control m-b' } %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<pre><code># controller\ndef update_signed_in_show\n  @employer = Employer.find(params[:id])\n  logger.debug \"singned_params: #{signed_params}\"\n  @order = Order::Signed.find(params[:order_id])\n\n  ......\nend\n</code></pre>\n\n<pre><code># class Order::Signed &lt; Order\nvalidate :check_started_at\ndef check_started_at\n  if self.started_at.present? &amp;&amp; self.ended_at.present?\n    if self.started_at.to_datetime &lt; self.signed_at.to_datetime\n      errors.add :started_at, 'xoxoxoxoxo.......'\n    end\n  end\nend\n</code></pre>\n\n<p>In the controller, I can read the parameters in the form.\nhash:\n{\"started_at(1i)\"=>\"2019\", \"started_at(2i)\"=>\"4\", \"started_at(3i)\"=>\"17\", \"ended_at(1i)\"=>\"2022\", \"ended_at(2i)\"=>\"4\", \"ended_at(3i)\"=>\"17\", \"remark_of_signed\"=>\"\", \"status\"=>\"signed\"}</p>\n\n<p>I wanted to validate in subclasses, but I received an error:</p>\n\n<p>NoMethodError (undefined method <code>to_datetime' for nil:NilClass):\napp/models/order/signed.rb:20:in</code>check_started_at'</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encryption"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1555485368, "post_id": 55721846, "comment_id": 98123103, "body": "Your question has no relation to your code. &quot;I have tried using <code>SecureRandom</code> and <code>Digest</code> but I still seem to be unable to get the desired output.&quot; What did you do, and what was the desired output? The concept of hashing is easy, but particulars of any decently strong algorithm that would be okay to use in practice are quite complex. Basically, for real world, the golden rule of cryptography is to only ever use cryptography libraries written by professional cryptographers, never make your own (unless you happen to be one of the small minority of people who understand it thoroughly)."}, {"owner": {"reputation": 1, "user_id": 11372263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52932d13b702da77afbe046c35f1ae2?s=128&d=identicon&r=PG&f=1", "display_name": "JamalTheProgrammer", "link": "https://stackoverflow.com/users/11372263/jamaltheprogrammer"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1555492515, "post_id": 55721846, "comment_id": 98127027, "body": "@Amadan Hello thank you for your response. Perhaps I phrase it wrongly. The desired output is that when a user signs up, their password will be automatically hashed instead of it being spelled out in the Database. That was the desired output. Also, right now I am lost as where to find documentations on cryptography regarding ruby. Either I am not proficient at googling or I am just a noob.."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1555492619, "post_id": 55721846, "comment_id": 98127090, "body": "We cannot see what you did wrong in your hashing code if we can&#39;t see your hashing code. You can see documentation on Ruby&#39;s crypto methods in the API docs for individual hashing methods; for example, in docs for BCrypt gem."}, {"owner": {"reputation": 1, "user_id": 11372263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52932d13b702da77afbe046c35f1ae2?s=128&d=identicon&r=PG&f=1", "display_name": "JamalTheProgrammer", "link": "https://stackoverflow.com/users/11372263/jamaltheprogrammer"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1555507448, "post_id": 55721846, "comment_id": 98136096, "body": "@Amadan hey, i have edited my post so you can see what i was trying to do. I hope that can shed some light in what I am trying to accomplish.."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10423470, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j23rPi5L6bo/AAAAAAAAAAI/AAAAAAAAACk/0WH3nMpUHKU/photo.jpg?sz=128", "display_name": "Bodik", "link": "https://stackoverflow.com/users/10423470/bodik"}, "is_accepted": false, "score": 0, "last_activity_date": 1555495779, "creation_date": 1555495779, "answer_id": 55725117, "question_id": 55721846, "link": "https://stackoverflow.com/questions/55721846/password-hashing-in-ruby-ruby-on-rails/55725117#55725117", "title": "Password Hashing in Ruby/ Ruby on Rails", "body": "<p>My team always use Devise gem for work with users. It simple for using and have \ngreat functional as: password encrypt, send email, authorization and other</p>\n"}], "owner": {"reputation": 1, "user_id": 11372263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52932d13b702da77afbe046c35f1ae2?s=128&d=identicon&r=PG&f=1", "display_name": "JamalTheProgrammer", "link": "https://stackoverflow.com/users/11372263/jamaltheprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555507377, "creation_date": 1555485051, "last_edit_date": 1555507377, "question_id": 55721846, "link": "https://stackoverflow.com/questions/55721846/password-hashing-in-ruby-ruby-on-rails", "title": "Password Hashing in Ruby/ Ruby on Rails", "body": "<p>this is my first post on stack. I am just curious as I have read regarding password hashing and more often I was told to use BCrypt instead. However, are there any documentations that I can use in order for me to try and hash the passwords on my own? I know using BCrypt is optimal for safety reasons but I would like to play around and understand the codes or functions surrounding hashing a password when the user signs up without using BCrypt or any other gems.</p>\n\n<p>For this, I have tried using 'SecureRandom' and 'Digest' but I still seem to be unable to get the desired output. Perhaps I am still new at this.</p>\n\n<p>This is my codes. I am very new at this.</p>\n\n<pre><code>require 'digest'\n\nclass UsersController &lt; ApplicationController\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)\n    if @user.save\n      redirect_to root_url\n    else\n\n    end\n  end\n\n  private\n\n  def user_params\n    params.require(:user).permit(:first_name, :last_name, :email, password_hash([:password]))\n  end\n\n  def password_hash(password)\n    hash = Digest::SHA256.hexdigest(password)\n  end\nend\n</code></pre>\n\n<p>Once I convert it into strings, the password column in the database will be empty after the user sign up. I know my codes are a messy but I would like to try to encrypt the passwords without using gems.</p>\n"}, {"tags": ["ruby", "amazon-s3", "aws-sdk", "carrierwave"], "comments": [{"owner": {"reputation": 962, "user_id": 6895607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BMhRG.jpg?s=128&g=1", "display_name": "Gaudam Thiyagarajan", "link": "https://stackoverflow.com/users/6895607/gaudam-thiyagarajan"}, "edited": false, "score": 0, "creation_date": 1555484933, "post_id": 55721704, "comment_id": 98122914, "body": "did you try deleting the s3 object before creating one in the same name"}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1555485660, "post_id": 55721704, "comment_id": 98123259, "body": "Did you try clearing your browser cache to see whether it is the cause? If so, then you can change some metadata that tells the browser how long to cache an object."}, {"owner": {"reputation": 583, "user_id": 6003901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670460d23edc4b03e848c32cd07cdc38?s=128&d=identicon&r=PG&f=1", "display_name": "abby37", "link": "https://stackoverflow.com/users/6003901/abby37"}, "edited": false, "score": 0, "creation_date": 1555486384, "post_id": 55721704, "comment_id": 98123630, "body": "i am hitting the url with okhttp:3.11 from android application. This isn&#39;t the case"}], "owner": {"reputation": 583, "user_id": 6003901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670460d23edc4b03e848c32cd07cdc38?s=128&d=identicon&r=PG&f=1", "display_name": "abby37", "link": "https://stackoverflow.com/users/6003901/abby37"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555492530, "creation_date": 1555484517, "last_edit_date": 1555492530, "question_id": 55721704, "link": "https://stackoverflow.com/questions/55721704/aws-s3-giving-different-versions-of-file-for-visual-hosted-style-and-path-style", "title": "AWS S3 giving different versions of file for visual hosted style and path style URL", "body": "<p>I have a rails application that use carrier-wave to upload file to S3. So after uploading a file through attachmentuploader. I am saving public url for given object in database. Public url returned by <code>aws-sdk ruby gem</code> is in <strong>visual-hosted-style</strong></p>\n\n<p><code>https://BUCKETNAME.s3.REGION.amazonaws.com/tests/TESTNAME.zip</code></p>\n\n<p>If I check object url in s3 it is in <strong>path style</strong> format -</p>\n\n<p><code>https://s3.REGION.amazonaws.com/BUCKETNAME/tests/TESTNAME.zip</code></p>\n\n<p>Docs regarding <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/VirtualHosting.html\" rel=\"nofollow noreferrer\">url style</a></p>\n\n<p>The problem here is that, if I access public url that is stored in my db after updating assets it points to previous version instead of latest version as done by object_url. So why public url is not updating to latest version and this issue came up 2 days before. Any insight will be helpful</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Now this issue is resolved automatically. So if someone faced this issue or have any understanding. Please let me know</p>\n"}, {"tags": ["arrays", "ruby", "symbols"], "comments": [{"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 3, "creation_date": 1555481638, "post_id": 55720976, "comment_id": 98121587, "body": "<code>is_a?</code> returns true or false, but <code>select</code> returns the items in your sequence that matched the given predicate. You&#39;re printing the output of <code>select</code>, not the output of <code>is_a?</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555481795, "post_id": 55720976, "comment_id": 98121659, "body": "Try <code>map</code> rather than <code>select</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1555482141, "post_id": 55721078, "comment_id": 98121797, "body": "<code>collect</code> is an alias of <code>map</code>. Some people (and robots) prefer <code>map</code>."}], "tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1555481912, "creation_date": 1555481912, "answer_id": 55721078, "question_id": 55720976, "link": "https://stackoverflow.com/questions/55720976/why-does-the-method-is-a-returning-other-values-other-than-true-or-false/55721078#55721078", "title": "Why does the method .is_a? returning other values other than true or false?", "body": "<p>Use collect to get your desired output</p>\n\n<pre><code>my_array = [\"raindrops\", :kettles, \"whiskers\", :mittens, :packages]\n\nsymbol_filter = lambda {|x| x.is_a? Symbol}\nsymbols = my_array.collect(&amp;symbol_filter)\nputs symbols\n</code></pre>\n\n<p>O/p</p>\n\n<pre><code>2.4.0 :066 &gt;     symbols = my_array.collect(&amp;symbol_filter)\n=&gt; [false, true, false, true, true] \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10882699, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X5NJjpBPn3I/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwca1mmfE-738TMfMuujPMIpNfpI4bw/mo/photo.jpg?sz=128", "display_name": "Mrwn mohd", "link": "https://stackoverflow.com/users/10882699/mrwn-mohd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555486754, "creation_date": 1555481436, "last_edit_date": 1555486754, "question_id": 55720976, "link": "https://stackoverflow.com/questions/55720976/why-does-the-method-is-a-returning-other-values-other-than-true-or-false", "title": "Why does the method .is_a? returning other values other than true or false?", "body": "<p>I was expecting symbols to return true or false in the array,but why does it return the values of of the elements that are true. More specifically, how does .is_a? work, I thought it returns true or false. </p>\n\n<pre><code>my_array = [\"raindrops\", :kettles, \"whiskers\", :mittens, :packages]\n\nsymbol_filter = lambda {|x| x.is_a? Symbol}\nsymbols = my_array.select(&amp;symbol_filter)\nputs symbols\n</code></pre>\n\n<p>I expected the output of true or false, but the output was </p>\n\n<pre><code>[:kettles, :mittens, :packages].\n</code></pre>\n"}, {"tags": ["ruby", "windows-10", "rubymine", "ruby-2.5"], "comments": [{"owner": {"reputation": 2082, "user_id": 7861394, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/862t3.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/7861394/saurabh"}, "edited": false, "score": 0, "creation_date": 1555477673, "post_id": 55720142, "comment_id": 98120272, "body": "Where is your project directory located? on <code>Desktop</code> folder?"}, {"owner": {"reputation": 43, "user_id": 6247029, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x7MMoGvJtf4/AAAAAAAAAAI/AAAAAAAAABI/rKvwlj9lQxU/photo.jpg?sz=128", "display_name": "Tanveer Dey", "link": "https://stackoverflow.com/users/6247029/tanveer-dey"}, "reply_to_user": {"reputation": 2082, "user_id": 7861394, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/862t3.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/7861394/saurabh"}, "edited": false, "score": 0, "creation_date": 1555477779, "post_id": 55720142, "comment_id": 98120305, "body": "its in <code>C:&#47;Users&#47;tanveer.dey&#47;RubymineProjects&#47;src&#47;Assignment9.rb</code>"}, {"owner": {"reputation": 2082, "user_id": 7861394, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/862t3.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/7861394/saurabh"}, "edited": false, "score": 0, "creation_date": 1555477860, "post_id": 55720142, "comment_id": 98120332, "body": "Try moving the project to <code>C:&#47;</code> and then execute the code."}, {"owner": {"reputation": 43, "user_id": 6247029, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x7MMoGvJtf4/AAAAAAAAAAI/AAAAAAAAABI/rKvwlj9lQxU/photo.jpg?sz=128", "display_name": "Tanveer Dey", "link": "https://stackoverflow.com/users/6247029/tanveer-dey"}, "reply_to_user": {"reputation": 2082, "user_id": 7861394, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/862t3.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/7861394/saurabh"}, "edited": false, "score": 0, "creation_date": 1555480613, "post_id": 55720142, "comment_id": 98121208, "body": "This too results in same error."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6247029, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x7MMoGvJtf4/AAAAAAAAAAI/AAAAAAAAABI/rKvwlj9lQxU/photo.jpg?sz=128", "display_name": "Tanveer Dey", "link": "https://stackoverflow.com/users/6247029/tanveer-dey"}, "is_accepted": false, "score": 1, "last_activity_date": 1555921962, "creation_date": 1555921962, "answer_id": 55791458, "question_id": 55720142, "link": "https://stackoverflow.com/questions/55720142/permission-denied-rb-sysopen-errno-eacces-error-when-trying-to-execute-ru/55791458#55791458", "title": "Permission denied @ rb_sysopen (Errno :: EACCES) error when trying to execute Ruby program via RubyMine 2019.1", "body": "<p>Found the fix! The issue occurs because the file <code>result.txt</code>, to which the contents are being \"written\" to, is specified \"with\" the extension <code>(.txt)</code>. Removing the extension from the file operations which involves writing solves the issue. Below code without the extension now works perfectly.</p>\n\n<pre><code>\nfile_array.each do |x|\n  file = File.open(x,'r')\n  file.each do |h|\n  open('result', 'a') do |f|\n    puts f &lt;&lt; h\n  end\n  end\n  open('result','a') do |f|\n    puts f &lt;&lt; \"\\n\"\n  end\n  end\n\nnew_array = File.readlines('result').sort\nFile.open('result','w') do |file|\n  new_array.each {|n| file.puts(n)}\nend\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6247029, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x7MMoGvJtf4/AAAAAAAAAAI/AAAAAAAAABI/rKvwlj9lQxU/photo.jpg?sz=128", "display_name": "Tanveer Dey", "link": "https://stackoverflow.com/users/6247029/tanveer-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1471, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555921962, "creation_date": 1555476800, "last_edit_date": 1555507032, "question_id": 55720142, "link": "https://stackoverflow.com/questions/55720142/permission-denied-rb-sysopen-errno-eacces-error-when-trying-to-execute-ru", "title": "Permission denied @ rb_sysopen (Errno :: EACCES) error when trying to execute Ruby program via RubyMine 2019.1", "body": "<p>I'm trying to execute a Ruby program <code>(Ruby v2.5.3)</code> on Windows 10 where I basically open a file <code>(sample1.txt, sample2.txt)</code> and append its contents (a list of 3 names) to an empty file <code>(result.txt)</code> and later sort the contents of file <code>result.txt</code> (entire code below). However, when I run this code on RubyMine 2019.1, I get an error as</p>\n\n<pre><code>Traceback (most recent call last):\n        6: from C:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:5:in `&lt;main&gt;'\n        5: from C:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:5:in `each'\n        4: from C:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:7:in `block in &lt;main&gt;'\n        3: from C:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:7:in `each'\n        2: from C:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:8:in `block (2 levels) in &lt;main&gt;'\n        1: from C:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:8:in `open'\nC:/Users/tanveer.dey/RubymineProjects/src/Assignment9.rb:8:in `initialize': Permission denied @ rb_sysopen - result.txt (Errno::EACCES)\n</code></pre>\n\n<p>All files have full permissions. However, when I execute the same code via the IRB terminal it works perfectly fine.</p>\n\n<p>I've just started working on Ruby and I couldn't find the solution to this problem anywhere. Your help is greatly appreciated.</p>\n\n<pre><code>file_array = [\"sample1.txt\", \"sample2.txt\"]\n\nfile_array.each do |x|\n  file = File.open(x,'r')\n  file.each do |h|\n  open('result.txt', 'a') do |f|\n    puts f &lt;&lt; h\n  end\n  end\n  open('result.txt','a') do |f|\n    puts f &lt;&lt; \"\\n\"\n  end\n  end\n\nnew_array = File.readlines('result.txt').sort\nFile.open('result.txt','w') do |file|\n  new_array.each {|n| file.puts(n)}\nend\n</code></pre>\n"}, {"tags": ["ruby", "process", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555478051, "post_id": 55720279, "comment_id": 98120392, "body": "am not forking child processes for now , am running the same script in multiple shells.Also i forgot to add , those files am processing are not constant and not under my control. So every time i check for files to process there maybe more files than the last time."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555478265, "post_id": 55720279, "comment_id": 98120468, "body": "If you use the Redis approach, it&#39;s the same thing. If you want to distribute the files evenly, without Redis, then just make multiple manifest files, each containing a portion of the filenames of the files to be processed, and let each &quot;worker process&quot; read a unique manifest file."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555478363, "post_id": 55720279, "comment_id": 98120489, "body": "The reason am not forking is not to garble log messages , though i may start forking once the code gets stable. But how do you propose determining the file that needs to be processed from the parent process, am not sure i got that"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555478655, "post_id": 55720279, "comment_id": 98120575, "body": "In that case, each &quot;worker process&quot; may push filenames to another Redis list (let&#39;s call it the &quot;done list&quot;) when a file processing is done. When the &quot;controller process&quot; starts up, it first works out a diff of the current files and the previous &quot;done list&quot;."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555478748, "post_id": 55720279, "comment_id": 98120610, "body": "If you want to do file processing on the fly when files are continuously added, then you may want an MQ."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555480449, "post_id": 55720279, "comment_id": 98121143, "body": "i simplified the scenario while describing my situation , there are also other constraints involved, like i have a 2 separate list of files , list1 and list2 from which to process. I have to process list1 first. It can hold the max 6 files. Then i have to move files from list2 to list1 to process. List1 and list2 can have additional files in the next run ..things like that.  I think what your suggesting is to have a script collect all the file names and add it to redis and then another script(multiple) to pop file  names from redis and process them ...."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555480458, "post_id": 55720279, "comment_id": 98121148, "body": "i dunno am still thinking , it may not work with the constraints i have , also there has to be a good ol&#39; ruby way to do this , i mean redis is synchronizing it some way too..."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555483706, "post_id": 55720279, "comment_id": 98122381, "body": "Well, if you insist using only Ruby, then you can make a controlling process that accesses the manifest file (or &quot;done&quot; file) and make sure no other process can access that file. The &quot;worker processes&quot; only <b>ask</b> the controlling process for what file should be processed next. You may need a <code>Queue</code> to queue up the requests from the worker processes."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555484515, "post_id": 55720279, "comment_id": 98122740, "body": "sorry what i meant was that the constraints are such that the decision of which  file to process can only be made at runtime. I cannot keep the information of what files to process separate from processing. Only once i have locked the file for processing can i be certain that i can process it. And there are only few files i can lock at a time."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555484768, "post_id": 55720279, "comment_id": 98122840, "body": "what i want is a global lock while a process is running the algo to pick up the file to process and then lock it for processing. Other processes should not be allowed to run that code while one process is going thru it so that same file is not locked by multiple processes"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 1, "creation_date": 1555485007, "post_id": 55720279, "comment_id": 98122941, "body": "Have a look at <code>File#flock</code>."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555488926, "post_id": 55720279, "comment_id": 98125021, "body": "awesome Aetherus, this is exactly what i was looking for ! tested with 10 concurrent processes and didn&#39;t see any race conditions yet.... So instead of creating and deleting .lock file to synchronize access to code am using File#flock instead now."}, {"owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "edited": false, "score": 0, "creation_date": 1555489247, "post_id": 55720279, "comment_id": 98125205, "body": "thanks very much for your time and help , much appreciated :) . Also do you wanna put this as a answer so i accept that as the correct answer ?"}], "tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": true, "score": 0, "last_activity_date": 1555477546, "creation_date": 1555477546, "answer_id": 55720279, "question_id": 55720032, "link": "https://stackoverflow.com/questions/55720032/ruby-multi-process-synchronization/55720279#55720279", "title": "Ruby Multi-Process Synchronization", "body": "<ol>\n<li><p>You can determine which files need to be processed <strong>before</strong> you spawn child processes.</p></li>\n<li><p>If you have access to a Redis server, then put those filenames into a Redis list, and then spawn child processes and let them pop one filename at a time and process it, until the list gets empty. If you don't have access to Redis, then you can evenly assign the files to the child processes. In neither case do you need a global lock or a mutex.</p></li>\n</ol>\n"}], "owner": {"reputation": 149, "user_id": 2093967, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rM0j.jpg?s=128&g=1", "display_name": "orange", "link": "https://stackoverflow.com/users/2093967/orange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 55720279, "answer_count": 1, "score": 0, "last_activity_date": 1555477546, "creation_date": 1555476173, "last_edit_date": 1555477390, "question_id": 55720032, "link": "https://stackoverflow.com/questions/55720032/ruby-multi-process-synchronization", "title": "Ruby Multi-Process Synchronization", "body": "<p>I have a piece of ruby code which processes multiple files . It's works roughly like this, </p>\n\n<pre><code>1)check the 'done' json file to ignore files which have already been processed.\n2)Pick up a file from remaining files to process\n3)process the file\n4)write a entry in 'done' file\n5)repeat\n</code></pre>\n\n<p>i am trying to make it run in a multi process environment, the goal is to run the ruby file multiple times in different shells.</p>\n\n<p>First problem i encountered was at part 1. There is a race condition there when multiple processes are trying to get the next file to process.Aka when the entry is not in the 'done' file , then multiple processes can pick up the same file to process.(to this end i introduced a .lock file)</p>\n\n<p>Also a process needs to know which file is currently being processed by another process so to ignore it too.(for this i introduced a 'concurrent file')</p>\n\n<p>Now my algorithm looks likes this,</p>\n\n<pre><code>1)wait for the .lock file to be not there\n2)create the .lock file\n3)read and ignore the files listed in the 'done' file\n4)read and ignore the files listed in the 'concurrent' file\n5)choose a file to process\n6)write a entry in the 'concurrent' file\n7)delete the .lock file\n8)process the file\n9)remove the entry from 'concurrent' file\n10)add a entry in 'done' file\n11)repeat\n</code></pre>\n\n<p>Now it seemed to work  , until i started creating more than 5 processes.</p>\n\n<p>After bit of debugging i found that multiple processes are creating the .lock file at the same time.</p>\n\n<p>here is my sychronization code,</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def wait_for_key\n  loop do\n    if File.exists? \"#{file_path}/.lock\"\n      puts \"waiting for lock to be released\"\n      sleep 1\n    else\n      break\n    end\n  end\nend\n\ndef lock\n  FileUtils.touch \"#{file_path}/.lock\"\n  puts \"download method locked #{Time.now}\"\nend\n\ndef release_lock\n  FileUtils.rm \"#{file_path}/.lock\"\n  puts \"lock released #{Time.now}\"\n  sleep 1\nend\n</code></pre>\n\n<p>so the concurrent algo runs roughly like this,</p>\n\n<pre><code>wait_for_key\nlock\n.....do some stuff \nrelease_lock\n</code></pre>\n\n<p>So if multiple processes are hitting the lock method at the same time, it seems there is a race condition in wait_for_key method.That is multiple processes see that the .lock file is not present than they call the lock method at the same time. </p>\n\n<p>I don't know really where to go from here, i looked into ruby mutex but it looks like it only works for multiple threads.</p>\n\n<p>Any ideas will be appreciated !</p>\n"}, {"tags": ["ruby", "macos", "rubygems", "textmate", "chruby"], "comments": [{"owner": {"reputation": 6367, "user_id": 4451732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UQN4l.jpg?s=128&g=1", "display_name": "Franklin Yu", "link": "https://stackoverflow.com/users/4451732/franklin-yu"}, "edited": false, "score": 0, "creation_date": 1560392896, "post_id": 55719818, "comment_id": 99723622, "body": "I suspect that there is a mismatch between your Ruby and RubyGems. In second line it says <code>2.6.2p47</code> but I see Ruby 2.3.7 in <code>gem env</code>."}, {"owner": {"reputation": 1803, "user_id": 2565086, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/4bbf81bfc2e7edf541834050eeea37e5?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2565086/greg"}, "reply_to_user": {"reputation": 6367, "user_id": 4451732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UQN4l.jpg?s=128&g=1", "display_name": "Franklin Yu", "link": "https://stackoverflow.com/users/4451732/franklin-yu"}, "edited": false, "score": 0, "creation_date": 1560448500, "post_id": 55719818, "comment_id": 99750124, "body": "Thanks for the comments. Ruby 2.3.7 is the macOS system Ruby, but I think the script in the top example is running in 2.6.2. TextMate puts up this in the window (Apparently can&#39;t add an image here, I&#39;ll update the original."}], "answers": [{"comments": [{"owner": {"reputation": 6367, "user_id": 4451732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UQN4l.jpg?s=128&g=1", "display_name": "Franklin Yu", "link": "https://stackoverflow.com/users/4451732/franklin-yu"}, "edited": false, "score": 1, "creation_date": 1560491084, "post_id": 56591682, "comment_id": 99761137, "body": "Glad that you found the solution. Nitpick: <code>$GEM_HOME</code> is supposed to contain only one path, while <code>$GEM_PATH</code> can hold multiple (similar to <code>$PATH</code>)."}, {"owner": {"reputation": 1803, "user_id": 2565086, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/4bbf81bfc2e7edf541834050eeea37e5?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2565086/greg"}, "reply_to_user": {"reputation": 6367, "user_id": 4451732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UQN4l.jpg?s=128&g=1", "display_name": "Franklin Yu", "link": "https://stackoverflow.com/users/4451732/franklin-yu"}, "edited": false, "score": 0, "creation_date": 1560522034, "post_id": 56591682, "comment_id": 99775972, "body": "Point taken. I had read that, but most people use the same for both. I&#39;ve changed now to <code>GEM_HOME</code> to <code>$HOME&#47;.gem&#47;ruby&#47;2.6.2</code>. I barely understand this and <code>$PATH</code> and in fact I don&#39;t have <code>PATH</code> set in TextMate (even though I&#39;ve read many places what to set these to)."}], "tags": [], "owner": {"reputation": 1803, "user_id": 2565086, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/4bbf81bfc2e7edf541834050eeea37e5?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2565086/greg"}, "is_accepted": true, "score": 0, "last_activity_date": 1560488922, "creation_date": 1560488922, "answer_id": 56591682, "question_id": 55719818, "link": "https://stackoverflow.com/questions/55719818/gem-locations-in-macos-with-chruby-and-textmate-preferences/56591682#56591682", "title": "gem locations in macOS with chruby and TextMate preferences", "body": "<p>Changed <code>GEM_HOME</code> and <code>GEM_PATH</code> to <code>$HOME/.gem/ruby/2.6.2:$HOME/.rubies/ruby-2.6.2/lib/ruby/gems/2.6.0</code> based on copying the those variables from what showing up when running from the terminal. Lu's comment made me look a little harder at what was being reported. Basically I was missing <code>$HOME/</code> in the second path (after the colon). I have been fiddling with this for months</p>\n"}], "owner": {"reputation": 1803, "user_id": 2565086, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/4bbf81bfc2e7edf541834050eeea37e5?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2565086/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 56591682, "answer_count": 1, "score": 0, "last_activity_date": 1560488922, "creation_date": 1555474837, "last_edit_date": 1560448723, "question_id": 55719818, "link": "https://stackoverflow.com/questions/55719818/gem-locations-in-macos-with-chruby-and-textmate-preferences", "title": "gem locations in macOS with chruby and TextMate preferences", "body": "<p>I having trouble getting Ruby gems to work right with TextMate (TM) and chruby on macOS.</p>\n\n<p>Clean install of Mojave (now v10.14.4) on a 2017 iMac about six months ago.</p>\n\n<p>Trying to use Ruby-2.6.2, although earlier versions have been installed. System Ruby is v2.3.7</p>\n\n<p>I have ended up with gems in at least three locations:</p>\n\n<p><code>~/.rubies/ruby-2.6.2/lib/ruby/gems/2.6.0/gems/</code><br>\n<code>~/.gem/ruby/2.6.2/gems/</code><br>\n<code>/Library/Ruby/Gems/2.3.0/gems/</code></p>\n\n<p>TextMate relies on its Preferences for gem and Ruby locations. As a start I have the following: \n <a href=\"https://i.stack.imgur.com/udPpr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/udPpr.png\" alt=\"enter image description here\"></a>\nGEM_HOME is unset because I don't see why it's needed, although I've frequently read to set it as shown or similar. <a href=\"https://stackoverflow.com/questions/11277227/whats-the-difference-between-gem-home-and-gem-path\">GEM_HOME and GEM_PATH</a> are defined as</p>\n\n<p>GEM_PATH provides the locations (there may be several) where gems can be found.</p>\n\n<p>GEM_HOME is where gems will be installed (by default).</p>\n\n<p>The problem is that when I run this script (after the error not included) in TM</p>\n\n<pre><code>#!/usr/bin/env ruby\nsystem ('gem env') # for debugging\nputs \"\\nGem.path: #{Gem.path}\"\nputs \"\\ngem list:\"\nsystem ('gem list') # for debugging \nrequire 'fileutils'\ninclude FileUtils\nrequire 'find'\nrequire 'yaml'\nrequire \"time\"\nrequire 'irb'\nrequire 'mini_exiftool'\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>Running \u201cPhotoName-GPScoord.rb\u201d\u2026\nruby 2.6.2p47 (2019-03-13 revision 67232) [x86_64-darwin18]\nTheme:  \nRubyGems Environment:\n  - RUBYGEMS VERSION: 3.0.3\n  - RUBY VERSION: 2.3.7 (2018-03-28 patchlevel 456) [universal.x86_64-darwin18]\n  - INSTALLATION DIRECTORY: /Library/Ruby/Gems/2.3.0\n  - USER INSTALLATION DIRECTORY: /Users/gscar/.gem/ruby/2.3.0\n  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby\n  - GIT EXECUTABLE: /usr/bin/git\n  - EXECUTABLE DIRECTORY: /usr/bin\n  - SPEC CACHE DIRECTORY: /Users/gscar/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Library/Ruby/Site\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - universal-darwin-18\n  - GEM PATHS:\n     - /Library/Ruby/Gems/2.3.0\n     - /Users/gscar\n     - /.rubies/ruby-2.6.2/lib/ruby/gems/2.6.0\n     - /.gem/ruby/2.6.2/gems/\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - \"gem\" =&gt; \"--no-document\"\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n     - /Users/gscar/Library/Application Support/TextMate/Managed/Bundles/Bundle Support.tmbundle/Support/shared/bin\n     - /usr/local/bin\n     - /usr/texbin\n     - /opt/local/bin\n\nGem.path: [\"/Users/gscar\", \"/.rubies/ruby-2.6.2/lib/ruby/gems/2.6.0\", \"/.gem/ruby/2.6.2/gems/\", \"/Users/gscar/.rubies/ruby-2.6.2/lib/ruby/gems/2.6.0\"]\n\ngem list:\n&lt;about 100 gems&gt;\nmimemagic (0.3.3)\nmini_exiftool (2.9.0)\nmini_magick (4.6.1)\n&lt;about 20 gems&gt;\n\nLoadError: cannot load such file \u2014 mini_exiftool\n\nmethod require  in kernel_require.rb at line 54\nmethod require  in kernel_require.rb at line 54\nmethod &lt;main&gt;   in PhotoName-GPScoord.rb at line 19\n  copy output \n</code></pre>\n\n<p>TextMate puts this in the top right of the output <a href=\"https://i.stack.imgur.com/VUSnX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VUSnX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Line 19 is <code>require 'mini_exiftool'</code></p>\n\n<p><code>mini_exiftool</code> is in the gem list, but why the error?</p>\n\n<p>If I run the script using the system Ruby (taking defaults, nothing set in TM)\n<a href=\"https://i.stack.imgur.com/FsEKR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FsEKR.png\" alt=\"System Ruby\"></a></p>\n\n<p>The script runs with the following output:</p>\n\n<pre><code>Running \u201cPhotoName-GPScoord.rb\u201d\u2026\nruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]\nTheme:  \nRubyGems Environment:\n  - RUBYGEMS VERSION: 3.0.3\n  - RUBY VERSION: 2.3.7 (2018-03-28 patchlevel 456) [universal.x86_64-darwin18]\n  - INSTALLATION DIRECTORY: /Library/Ruby/Gems/2.3.0\n  - USER INSTALLATION DIRECTORY: /Users/gscar/.gem/ruby/2.3.0\n  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby\n  - GIT EXECUTABLE: /usr/bin/git\n  - EXECUTABLE DIRECTORY: /usr/bin\n  - SPEC CACHE DIRECTORY: /Users/gscar/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Library/Ruby/Site\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - universal-darwin-18\n  - GEM PATHS:\n     - /Library/Ruby/Gems/2.3.0\n     - /Users/gscar/.gem/ruby/2.3.0\n     - /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/gems/2.3.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - \"gem\" =&gt; \"--no-document\"\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n     - /Users/gscar/Library/Application Support/TextMate/Managed/Bundles/Bundle Support.tmbundle/Support/shared/bin\n\nGem.path: [\"/Users/gscar/.gem/ruby/2.3.0\", \"/Library/Ruby/Gems/2.3.0\", \"/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/gems/2.3.0\"]\n\ngem list:\n\n&lt;long list of gems including mini_exiftool (2.9.0)&gt;\n</code></pre>\n\n<p>This particular script is OK with 2.3.7, but others may not be.</p>\n\n<p>Thanks for any help.</p>\n\n<p>This posting is a simplification of an <a href=\"https://stackoverflow.com/posts/53202164/edit\">earlier posting from me</a>. I think I've boiled the problem down. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555478734, "post_id": 55720025, "comment_id": 98120607, "body": "Readers: I confess I was not aware of the <code>du</code> command before penning this answer. After reviewing the docs I believe I have it correct, but please let me know if I&#39;ve erred."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1557177048, "last_edit_date": 1557177048, "creation_date": 1555476147, "answer_id": 55720025, "question_id": 55719522, "link": "https://stackoverflow.com/questions/55719522/how-to-get-the-total-size-of-files-in-a-directory-in-ruby/55720025#55720025", "title": "How to get the total size of files in a Directory in Ruby", "body": "<p>For Unix-flavoured OS's, it may be easiest to simply shell out to the operating system to use the <a href=\"http://www.linfo.org/du.html\" rel=\"nofollow noreferrer\">du</a> command.</p>\n\n<p>For example</p>\n\n<pre><code>du -bs #=&gt; 1214674782\n</code></pre>\n\n<p>is the disk space in bytes consumed by my computer's current directory and its nested subdirectories.</p>\n\n<pre><code>du ../.rvm/src -bs #=&gt; 722526755\n</code></pre>\n\n<p>is the same for a specified directory. Within Ruby, you can use the <a href=\"http://ruby-doc.org/core-2.5.1/Kernel.html#method-i-system\" rel=\"nofollow noreferrer\">Kernel#system</a> command:</p>\n\n<pre><code>s = system(\"du -bs\") #=&gt; 1214674782\n</code></pre>\n\n<p>To obtain the bytes consumed by the current directory only (and not nested subdirectories) remove <code>\"b\"</code> from the flags.</p>\n\n<pre><code>s = system(\"du -s\") #=&gt; 1301136\n</code></pre>\n\n<p>Note disk space consumption is somewhat more than the total of all file sizes, but that could be a better measure of what you are looking for.</p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1555477857, "last_edit_date": 1555477857, "creation_date": 1555477471, "answer_id": 55720271, "question_id": 55719522, "link": "https://stackoverflow.com/questions/55719522/how-to-get-the-total-size-of-files-in-a-directory-in-ruby/55720271#55720271", "title": "How to get the total size of files in a Directory in Ruby", "body": "<p>Just <code>mydir</code>:</p>\n\n<pre><code>Dir['mydir/*'].select { |f| File.file?(f) }.sum { |f| File.size(f) }\n</code></pre>\n\n<p><code>mydir</code> and all subdirectories:</p>\n\n<pre><code>Dir['mydir/**/*'].select { |f| File.file?(f) }.sum { |f| File.size(f) }\n</code></pre>\n\n<p>However, it's the sum of exact file sizes, not the space they occupy on the disk. For disk usage, this is more accurate:</p>\n\n<pre><code>Dir['mydir/*'].select { |f| File.file?(f) }.sum { |f| File.stat(f).blocks * 512 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1555480806, "post_id": 55720741, "comment_id": 98121276, "body": "Obviously, only on a Windows system."}], "tags": [], "owner": {"reputation": 172, "user_id": 1389297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a01a118cb2582c77316ee026d36540?s=128&d=identicon&r=PG", "display_name": "Ali Akbar", "link": "https://stackoverflow.com/users/1389297/ali-akbar"}, "is_accepted": true, "score": 0, "last_activity_date": 1555498226, "last_edit_date": 1555498226, "creation_date": 1555480270, "answer_id": 55720741, "question_id": 55719522, "link": "https://stackoverflow.com/questions/55719522/how-to-get-the-total-size-of-files-in-a-directory-in-ruby/55720741#55720741", "title": "How to get the total size of files in a Directory in Ruby", "body": "<p>In Windows, You can use win32ole gem to calculate the same</p>\n\n<pre><code> require 'win32ole'\n\n fso = WIN32OLE.new('Scripting.FileSystemObject')\n\n folder = fso.GetFolder('directory path')\n\n  p folder.name\n\n  p folder.size\n\n p folder.path\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10720777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4be6VJeY4sA/AAAAAAAAAAI/AAAAAAAADOg/KTefmvtRgEw/photo.jpg?sz=128", "display_name": "Vaishakh K P", "link": "https://stackoverflow.com/users/10720777/vaishakh-k-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1122, "favorite_count": 0, "accepted_answer_id": 55720741, "answer_count": 3, "score": 4, "last_activity_date": 1557177048, "creation_date": 1555472366, "question_id": 55719522, "link": "https://stackoverflow.com/questions/55719522/how-to-get-the-total-size-of-files-in-a-directory-in-ruby", "title": "How to get the total size of files in a Directory in Ruby", "body": "<p>I am trying to copy some files into a directory  using Ruby, i need to assure the  files inside  the directory not exceed 2GB. is there any way to check the total size of files inside the directory.</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1555467455, "post_id": 55718403, "comment_id": 98118044, "body": "Every attribute in <code>attributes</code> should a method that can be invoked in user, make sure user does respond to all of them."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1555469916, "post_id": 55718403, "comment_id": 98118494, "body": "Seconding above comment. you can make a method <code>email</code> on the pdfform model which just delegates to <code>user.email</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1555485563, "last_edit_date": 1555485563, "creation_date": 1555484736, "answer_id": 55721759, "question_id": 55718403, "link": "https://stackoverflow.com/questions/55718403/export-csv-records-with-association-data/55721759#55721759", "title": "Export CSV records with association data", "body": "<p>I'd probably avoid such kind of code in production in favor of something more explicit and easier to read/debug (like defining <code>user_email</code> method on the model in question and referring it in the list of attributes to export, or calling <code>email</code> and delegating it to the association or whatever else), but if you prefer this kind of concise solutions this might work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def self.as_csv \n  attrs = %w{user.email date_start date_finish location event_name description acct_num sub reason impact uuid topic}\n\n  CSV.generate(write_headers: true, headers: attrs) do |csv|\n    method_chains = attrs.map { |a| a.split('.') }\n\n    find_each do |user|\n      csv &lt;&lt; method_chains.map do |chain| \n        chain.reduce(user) { |obj, method_name| obj = obj.try(method_name.to_sym) }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>It's almost the same as yours with additional <code>reduce</code> that \"folds\" methods chains and a couple of other minor improvements:</p>\n\n<ul>\n<li>instead of writing headers explicitly via <code>csv &lt;&lt; attributes</code> I set the headers via the options to <code>CSV.generate</code></li>\n<li>instead of <code>all.each</code> I fetch records in batches via <code>find_each</code> - it can make a huge difference in case of really large tables</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 11371080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed63d84c0e6788389f2620a4c1ef64eb?s=128&d=identicon&r=PG&f=1", "display_name": "Trenton", "link": "https://stackoverflow.com/users/11371080/trenton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55721759, "answer_count": 1, "score": 0, "last_activity_date": 1555485563, "creation_date": 1555462085, "question_id": 55718403, "link": "https://stackoverflow.com/questions/55718403/export-csv-records-with-association-data", "title": "Export CSV records with association data", "body": "<p>I am creating a CSV export for pdforms in my Rails application. At the moment, I have this method in my <code>pdform</code> model.</p>\n\n<pre><code>def self.as_csv \n  attributes = %w{user date_start date_finish location event_name description acct_num sub reason impact uuid topic}\n  CSV.generate(headers: true) do |csv|\n    csv &lt;&lt; attributes\n\n    all.each do |user|\n      csv &lt;&lt; attributes.map { |attr| user.send(attr) }\n      binding.pry\n    end\n  end\nend\n</code></pre>\n\n<p>This works as intended, however, as shown in <code>attributes</code>, I have a user. I when exporting this CSV I am shown the User object. I would like to show the email of the user in the exported CSV.</p>\n\n<p>I attempted to replace it with <code>attributes = %w{user.email date_start date_finish location event_name description acct_num sub reason impact uuid topic}</code> however I just get this error:</p>\n\n<blockquote>\n  <p>undefined method `user.email' for # Did you\n  mean? user_id</p>\n</blockquote>\n\n<p>I can do <code>user_id</code> however. But this is no help to the person who is glossing over this CSV as they do not know who the user associated with that ID is. How can I get the Users email to display in the CSV row rather than the id or the object itself? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "haml", "partial"], "answers": [{"tags": [], "owner": {"reputation": 712, "user_id": 929251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ef9fdd5a6cd663670253f5a73527a4?s=128&d=identicon&r=PG", "display_name": "Igor Kasyanchuk", "link": "https://stackoverflow.com/users/929251/igor-kasyanchuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1555498175, "creation_date": 1555498175, "answer_id": 55725813, "question_id": 55717964, "link": "https://stackoverflow.com/questions/55717964/faster-rails-single-partial-render/55725813#55725813", "title": "Faster Rails single partial render", "body": "<p>For example, I'm solving such problem with <a href=\"https://github.com/igorkasyanchuk/embed_view\" rel=\"nofollow noreferrer\">https://github.com/igorkasyanchuk/embed_view</a></p>\n\n<p>but it requires to have ERB views</p>\n"}], "owner": {"reputation": 388, "user_id": 2572790, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c0f745b29e610fbf2d4298e3bec8e14f?s=128&d=identicon&r=PG", "display_name": "user2572790", "link": "https://stackoverflow.com/users/2572790/user2572790"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581308741, "creation_date": 1555458089, "last_edit_date": 1581308741, "question_id": 55717964, "link": "https://stackoverflow.com/questions/55717964/faster-rails-single-partial-render", "title": "Faster Rails single partial render", "body": "<p>I need to avoid an often repeat of the same code block into template.\nExample:</p>\n\n<pre><code>%a{href:item_path(item.web_title,@relative_link_options)}\n  =item.show_field_locale('title')\n  -unless item.get_image_path('has_image',\"item_#{item.id}.png\").blank?\n    =image_tag(item.get_image_path('has_image',\"item_#{item.id}.png\"))\n</code></pre>\n\n<p>So, I describe many items, <strong>NOT</strong> from collection @items. That are has-one relations or small has-many relations. \nI have a lot of such pages, so too many different content for caching.</p>\n\n<p>To display every item I need to repeat an above code block.\nAlso I could use partial <code>_item.html.haml</code> and use it via <code>render partial: 'item'</code>\nBut it slows an application (time to prepare Views in ms).\nHow could I avoid it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication", "devise", "admin"], "comments": [{"owner": {"reputation": 295, "user_id": 3343781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sqNo1.jpg?s=128&g=1", "display_name": "ashusvirus", "link": "https://stackoverflow.com/users/3343781/ashusvirus"}, "edited": false, "score": 0, "creation_date": 1555480742, "post_id": 55717660, "comment_id": 98121257, "body": "what kind of specific IDs are you talking about? is it emails or primary key from the user&#39;s model"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8702213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099caf15a5389286503bb56dec9ee607?s=128&d=identicon&r=PG&f=1", "display_name": "Alien", "link": "https://stackoverflow.com/users/8702213/alien"}, "edited": false, "score": 0, "creation_date": 1555461301, "post_id": 55717972, "comment_id": 98116831, "body": "How/where do I manually manage who is an admin user and who isn&#39;t?"}, {"owner": {"reputation": 58, "user_id": 6777894, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154529072342502/picture?type=large", "display_name": "Caitlin Palmer-Bright", "link": "https://stackoverflow.com/users/6777894/caitlin-palmer-bright"}, "reply_to_user": {"reputation": 75, "user_id": 8702213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099caf15a5389286503bb56dec9ee607?s=128&d=identicon&r=PG&f=1", "display_name": "Alien", "link": "https://stackoverflow.com/users/8702213/alien"}, "edited": false, "score": 0, "creation_date": 1555463650, "post_id": 55717972, "comment_id": 98117275, "body": "Sorry, that wasn&#39;t clear - we do this by using the rails console to update the user. It doesn&#39;t allow anyone to do it from the actual website, but in the cases where we do it this way this doesn&#39;t matter. We create the admin user accounts that they need and then that&#39;s that, they don&#39;t need to edit any others"}], "tags": [], "owner": {"reputation": 58, "user_id": 6777894, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154529072342502/picture?type=large", "display_name": "Caitlin Palmer-Bright", "link": "https://stackoverflow.com/users/6777894/caitlin-palmer-bright"}, "is_accepted": false, "score": 0, "last_activity_date": 1555458188, "creation_date": 1555458188, "answer_id": 55717972, "question_id": 55717660, "link": "https://stackoverflow.com/questions/55717660/i-am-trying-to-create-a-secure-way-to-make-specific-users-admins/55717972#55717972", "title": "I am trying to create a secure way to make specific users admins", "body": "<p>I'd recommend adding an admin field to the user form to select if they're an admin user, but do a check in the update/create actions on your users controller to check if the current_user (if using Devise) is another admin user (or whatever role type they need to be to update other admin permissions). </p>\n\n<p>You would also probably want to do a check to make sure they can't set themselves as admin=false, otherwise you could end up with no admin users left on the site and no-one with permission to change this. That said, depending on the app you could always just manually manage admin users - my company will do this depending on the client and their needs. </p>\n"}, {"tags": [], "owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "is_accepted": false, "score": 0, "last_activity_date": 1555477601, "creation_date": 1555477601, "answer_id": 55720286, "question_id": 55717660, "link": "https://stackoverflow.com/questions/55717660/i-am-trying-to-create-a-secure-way-to-make-specific-users-admins/55720286#55720286", "title": "I am trying to create a secure way to make specific users admins", "body": "<p>You can use <a href=\"https://github.com/RolifyCommunity/rolify\" rel=\"nofollow noreferrer\">Rolify</a> to give roles to the user's and <a href=\"https://github.com/CanCanCommunity/cancancan\" rel=\"nofollow noreferrer\">CanCanCan</a> for access control.</p>\n\n<p>You can assign roles to user either from rails console or you can generate a view for it, and restrict it to admin and assign roles to each individual user.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9137421"}, "is_accepted": false, "score": 0, "last_activity_date": 1555530790, "creation_date": 1555530790, "answer_id": 55735051, "question_id": 55717660, "link": "https://stackoverflow.com/questions/55717660/i-am-trying-to-create-a-secure-way-to-make-specific-users-admins/55735051#55735051", "title": "I am trying to create a secure way to make specific users admins", "body": "<p>You could add an admin boolean to your user model, and update it through the rails console</p>\n\n<pre><code>rails g migration add_admin_to_users admin:boolean\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8702213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099caf15a5389286503bb56dec9ee607?s=128&d=identicon&r=PG&f=1", "display_name": "Alien", "link": "https://stackoverflow.com/users/8702213/alien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555530790, "creation_date": 1555455309, "question_id": 55717660, "link": "https://stackoverflow.com/questions/55717660/i-am-trying-to-create-a-secure-way-to-make-specific-users-admins", "title": "I am trying to create a secure way to make specific users admins", "body": "<p>I have a functioning rails app with devise Admins and Users, and I want to create a secure way that will only allow users with specific IDs to become authorized to become admins. Currently, I have a static link that is not very secure that will make the current user an admin(website.com/make_admin), but I want to find the most secure method to turn specific users into administrators (I am open to all options that could accomplish this). What would be the best way for me to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1556468601, "post_id": 55718076, "comment_id": 98441247, "body": "<i>Feel free to post a link to this project on Github</i> -  I generally recommend caution around this sort of recommendation. While it is useful for readers who are happy to offer extensive help, it should not become the primary expression of a problem. Questions should mostly be self-contained, so that the question might be useful for future readers even if external links (like GitHub) are deleted or change."}], "tags": [], "owner": {"reputation": 58, "user_id": 6777894, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154529072342502/picture?type=large", "display_name": "Caitlin Palmer-Bright", "link": "https://stackoverflow.com/users/6777894/caitlin-palmer-bright"}, "is_accepted": true, "score": 1, "last_activity_date": 1555459000, "creation_date": 1555459000, "answer_id": 55718076, "question_id": 55717456, "link": "https://stackoverflow.com/questions/55717456/how-to-create-a-form-that-would-create-a-user-a-sandwich-a-join-table-san/55718076#55718076", "title": "How to create a form that would create a &quot;User&quot;, a &quot;Sandwich&quot;, a join table &quot;SandwichIngredient&quot;, on the &quot;Restaurant&quot; show page?", "body": "<p>Lots of areas to comment on here, and the question is quite vague but I'll give some tips\n<br></p>\n\n<ol>\n<li><p>Your 'new' action on your restaurant controller should be for a new restaurant, not a new sandwich. \n<br></p></li>\n<li><p>Your 'new sandwich' form should probably be directing to the create action on your sandwiches controller. You're trying to do too much on the restaurants controller.\n<br></p></li>\n<li><p>If your ingredients belong to a restaurant, they need a restaurant_id field\n<br></p></li>\n<li><p>You probably don't want to create a new user each time you create a sandwich, perhaps you want to add devise or a similar user management gem to your project and have them sign in, and assign the sandwich to the current user, or have a drop down select of the users in the system as part of the sandwich form\n<br></p></li>\n<li><p>As a general tip, I would completely ignore your stocks model for now, focus on getting sandwiches working first. \n<br></p></li>\n<li><p>Not super related but would be good to have either one 'name' field for a user or 'first_name' and 'last_name' to avoid confusion\n<br></p></li>\n<li><p>You may need to add a hidden field in the form to contain the restaurant_id to be able to pass this value through when you submit the form\n<br></p></li>\n<li><p>Make sure you have a field on the sandwich form for the name of the sandwich\n<br></p></li>\n<li>I would probably recommend sticking with 'form_for' for @sandwich, which by default should go to the sandwiches create action as mentioned above.</li>\n</ol>\n\n<p><br>\nFeel free to post a link to this project on github or similar if you need further help.</p>\n"}], "owner": {"reputation": 15, "user_id": 8870009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6132acdfea044637695d87cfeef0babe?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/8870009/gio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "closed_date": 1556470297, "accepted_answer_id": 55718076, "answer_count": 1, "score": 0, "last_activity_date": 1556468234, "creation_date": 1555453815, "last_edit_date": 1556468234, "question_id": 55717456, "link": "https://stackoverflow.com/questions/55717456/how-to-create-a-form-that-would-create-a-user-a-sandwich-a-join-table-san", "closed_reason": "Needs more focus", "title": "How to create a form that would create a &quot;User&quot;, a &quot;Sandwich&quot;, a join table &quot;SandwichIngredient&quot;, on the &quot;Restaurant&quot; show page?", "body": "<p>I have 6 modules (1. ingredients; 2. restaurants; 3. sandwich_ingredients; 4. sandwiches; 5. stocks; 6. users) and the user should be able to create/personalise a sandwich using the ingredients of that specific restaurant. Therefore, I would like to create a form on the show.html.erb of the restaurant so that the user can pick up several ingredients and create their own sandwich. </p>\n\n<p>I feel comfortable working with 3 modules in a many-to-many relationship but with 6 tables I just get confused and lost.</p>\n\n<p>I tried form_for, form_tag, collection_check_boxes. When I used to work with a smaller project, I had no issues but now I'm not sure what approach should I take. I tried to create the form on the user show page first and then on the sandwich show page but it didn't seem quite right. </p>\n\n<p>This is the code from the restaurant show.html.erb page:</p>\n\n<pre><code>&lt;ul&gt;\n&lt;%= form_tag('/restaurants/create_sandwich') do %&gt;\n&lt;%= label_tag 'Ingredients' %&gt;\n  &lt;li&gt;&lt;%= collection_check_boxes(:ingredient, :id, @restaurant.ingredients, :id, :name) %&gt;&lt;/li&gt;\n  &lt;%= submit_tag 'Create' %&gt;\n&lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>The restaurants_controller.rb (messed up):</p>\n\n<pre><code>class RestaurantsController &lt; ApplicationController\n  def index\n    @restaurants = Restaurant.all\n  end\n\n  def show\n    @restaurant = Restaurant.find(params[:id])\n    @user = User.new\n    @sandwich = Sandwich.new\n  end\n  def new\n    @sandwich = Sandwich.new\n    # res = Restaurant.find(params[:id])\n    # @restaurant_ingredients = res.ingredients\n  end\n\n  def select_ingredients\n    # byebug\n    #\n    # @restaurant_ingredients = Restaurant.find(params[:id]).ingredients\n    # byebug\n    # @restaurant_ingredients = res.ingredients\n    # @ingredients = Ingredient.all\n\n  end\n\n  def create_sandwich\n    # byebug\n    @user = User.find_or_create_by({name: params[:user_name]})\n    @sandwich = Sandwich.new({name: params[:recipe_name], user_id: @user.id})\n    @sandwich.sandwich_ingredient_ids = params[:ingredients]\n    if @sandwich.save\n      redirect_to sandwich_path(@sandwich)\n    else\n      render :new\n    end\n\n  end\n\n  def edit\n    #code\n  end\n\n  def update\n    #code\n  end\n\n  def delete\n    #code\n  end\n\n\nend\n</code></pre>\n\n<p>If it can help, these are the routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n  # get '/restaurants/:id', to: 'restaurants#create_sandwich'\n  post '/restaurants/create_sandwich', to: 'restaurants#create_sandwich'\n  resources :stocks\n  resources :restaurants\n  resources :sandwich_ingredients\n  resources :ingredients\n  resources :sandwiches\n  resources :users\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n\n<p>and this is my schema: </p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2019_04_15_174308) do\n\n  create_table \"ingredients\", force: :cascade do |t|\n    t.string \"name\"\n    t.integer \"quantity\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"restaurants\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"location\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"sandwich_ingredients\", force: :cascade do |t|\n    t.integer \"sandwich_id\"\n    t.integer \"ingredient_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"sandwiches\", force: :cascade do |t|\n    t.string \"name\"\n    t.integer \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"stocks\", force: :cascade do |t|\n    t.integer \"restaurant_id\"\n    t.integer \"ingredient_id\"\n    t.integer \"count\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"surname\"\n    t.string \"email\"\n    t.string \"phone_number\"\n    t.integer \"age\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\nend\n</code></pre>\n\n<p>What I'm trying to achieve is a form that would create the association \"SandwichIngredient\" and to do so, the \"User\" and the \"Sandwich\" but at this point I feel just lost.</p>\n"}, {"tags": ["ruby", "if-statement"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1555448421, "post_id": 55716506, "comment_id": 98113526, "body": "Why would you want to do this? The code you have is perfectly logical"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1555448478, "post_id": 55716506, "comment_id": 98113545, "body": "Can you? Sure you can, with some parentheses and semicolons. Should you? Absolutely not."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555451524, "post_id": 55716506, "comment_id": 98114672, "body": "Consider <code>redirect_to new_... unless  @invoice.reason?; pay_later; redirect_to admin_...</code>. The first statement (here) is sometimes call a <i>guard clause</i>."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449107, "post_id": 55716664, "comment_id": 98113827, "body": "You assume <code>pay_later</code> returns a truthy value."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449128, "post_id": 55716664, "comment_id": 98113840, "body": "@SergioTulentsev I specified!"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449193, "post_id": 55716664, "comment_id": 98113871, "body": "Let&#39;s see what the OP says :)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449325, "post_id": 55716664, "comment_id": 98113921, "body": "Try now @SergioTulentsev :D"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449339, "post_id": 55716664, "comment_id": 98113925, "body": "Yes, now better :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449551, "post_id": 55716664, "comment_id": 98114000, "body": "BTW, it&#39;s really easy to change this code to not depend on <code>pay_later</code>&#39;s return value. Then you wouldn&#39;t need that caveat."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555449670, "post_id": 55716664, "comment_id": 98114046, "body": "How? Semicolon?"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1555450181, "post_id": 55716664, "comment_id": 98114246, "body": "Thanks everyone for the answers. @Ursus code works great."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1555459774, "post_id": 55716664, "comment_id": 98116527, "body": "The readability here is really, really low. The original code, while more verbose, leaves it abundantly clear what&#39;s going on. This is just a jumbled mess of confusion by comparison. It works, but at what cost? <i>Just because you can doesn&#39;t mean you should.</i>"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1555485301, "post_id": 55716664, "comment_id": 98123071, "body": "I was just trying to answer the OP question. I even said that is not cool at all."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555508475, "post_id": 55716664, "comment_id": 98136769, "body": "@Ursus: yep, semicolon and parentheses."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1555449289, "last_edit_date": 1555449289, "creation_date": 1555449082, "answer_id": 55716664, "question_id": 55716506, "link": "https://stackoverflow.com/questions/55716506/is-it-possible-to-have-a-one-line-if-with-more-than-one-result/55716664#55716664", "title": "Is it possible to have a one line if with more than one result?", "body": "<p>Sure, you ca try</p>\n\n<pre><code>def invoice\n  @invoice.reason? ? pay_later &amp;&amp; redirect_to(admin_invoices_path, notice: t(\".success_delay\")) : redirect_to(new_admin_invoice_payment_path(@invoice))\nend\n</code></pre>\n\n<p>But it's not cool at all. And it works only if <code>pay_later</code> does not return a falsey value</p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1555481643, "creation_date": 1555481643, "answer_id": 55721019, "question_id": 55716506, "link": "https://stackoverflow.com/questions/55716506/is-it-possible-to-have-a-one-line-if-with-more-than-one-result/55721019#55721019", "title": "Is it possible to have a one line if with more than one result?", "body": "<p>Yes but you probably don't want to.</p>\n\n<pre><code>def invoice\n  (pay_later; return redirect_to admin_invoices_path, notice: t(\".success_delay\")) if @invoice.reason?\n  redirect_to new_admin_invoice_payment_path(@invoice)\nend\n</code></pre>\n\n<p>A common way to avoid placing your whole method body inside an <code>if..else</code> block is to use a guard clause:</p>\n\n<pre><code>def invoice\n  return redirect_to new_admin_invoice_payment_path(@invoice) unless @invoice.reason?\n\n  pay_later\n  redirect_to admin_invoices_path, notice: t(\".success_delay\")\nend    \n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555481643, "creation_date": 1555448286, "question_id": 55716506, "link": "https://stackoverflow.com/questions/55716506/is-it-possible-to-have-a-one-line-if-with-more-than-one-result", "title": "Is it possible to have a one line if with more than one result?", "body": "<p>I have a method with an if statement that i want to get onto one line if possible. However one part of the condition has two results - <code>pay later</code> and a <code>redirect_to</code>. Is is possible to have this on one line?\nIt doesnt like the syntax when i do it. (I know this will be very long if on one line)</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>    def invoice\r\n      if @invoice.reason?\r\n        pay_later\r\n        redirect_to admin_invoices_path, notice: t(\".success_delay\")\r\n      else\r\n        redirect_to new_admin_invoice_payment_path(@invoice)\r\n      end\r\n    end</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "nested-attributes", "destroy"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 11255747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OAmc4sMUtyI/AAAAAAAAAAI/AAAAAAAAACE/I-rwjsc3r8o/photo.jpg?sz=128", "display_name": "Richard Legacy", "link": "https://stackoverflow.com/users/11255747/richard-legacy"}, "is_accepted": false, "score": 0, "last_activity_date": 1555517274, "last_edit_date": 1555517274, "creation_date": 1555516694, "answer_id": 55731674, "question_id": 55715482, "link": "https://stackoverflow.com/questions/55715482/rails-nested-attributes-destroy-not-working-on-patch/55731674#55731674", "title": "rails nested attributes destroy not working on patch", "body": "<p>In your test you have:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>params: { id: agreement.id, \n         agreement: { status: 'X', \n                      attachments: agreement_attachments } \n        }\n</code></pre>\n\n<p>Shouldn't it be: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>params: { id: agreement.id, \n          agreement: { status: 'X',\n                       attachments_attributes: agreement_attachments }\n        }\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3888561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c290eb53312c791102d58105824dada5?s=128&d=identicon&r=PG&f=1", "display_name": "jharr13", "link": "https://stackoverflow.com/users/3888561/jharr13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555517274, "creation_date": 1555443379, "last_edit_date": 1555444426, "question_id": 55715482, "link": "https://stackoverflow.com/questions/55715482/rails-nested-attributes-destroy-not-working-on-patch", "title": "rails nested attributes destroy not working on patch", "body": "<p>On an update of my agreement model, i might need to update 1 to many attachments, this could involve deleting an attachment. I have set up rails nested attributes on the model and everything seems to be working for it, such as adding and updating. but i can't seem to get deleting working. </p>\n\n<p>I have read the docs and have added all the necessary bits of code to enable this feature. but nothing seems to be sticking. </p>\n\n<p>Using Rails 5.0.7.1 and ruby 2.4.2</p>\n\n<pre><code>here is my agreement model \n\n  has_many :attachments,\n           :class_name =&gt; 'Attachment',\n           :foreign_key =&gt; 'attachable_id'\n\n  accepts_nested_attributes_for :services\n  accepts_nested_attributes_for :attachments, allow_destroy: true\n</code></pre>\n\n<pre><code>here is the relevant controller code\n\n  def update\n    agreement = Contract::Agreement.find(params[:id])\n\n    if agreement.update_attributes(agreement_params)\n      render json: agreement, serializer: Contract::Agreement::Agreement\n    else\n      render json: {}, status: :bad_request\n    end\n  end\n\ndef agreement_params\n    byebug\n    unless params[:agreement][:attachments].blank?\n\n      params[:agreement][:attachments_attributes] = params[:agreement][:attachments].map { |attachment|\n\n        new_attachment = {}\n\n        attachment.each do |key, value|\n          new_attachment[:key] = value\n        end\n      }\n      params[:agreement].delete :attachments\n    end\n\n    # byebug\n\n    unless params[:agreement][:services].blank?\n      params[:agreement][:services_attributes] = params[:agreement][:services]\n      params[:agreement].delete :services\n    end\n\n    params.require(:agreement).permit(\n      :status,\n      :start_date,\n      :end_date,\n      :description,\n      :parent,\n      :level_id,\n      :term_id,\n      :service_provider_id,\n      attachments_attributes: [\n        :id,\n        :file,\n        :file_name,\n        :file_size,\n        :file_type,\n        :attachable_type,\n        :attachable_id,\n        :_destroy\n      ],\n      services_attributes: [\n        :id,\n        :currency,\n        :price,\n        :facguid,\n        :service_type_id,\n        :agreement_id\n      ]\n    )\n  end\n</code></pre>\n\n<pre><code>and here is the test\n\nit 'successfully deletes attachments', :attachments_testes =&gt; true do\n        agreement = FactoryBot.create(:contract_agreement)\n\n        attachment = FactoryBot.create(:agreement_attachment)\n        attachment.attachable_id = agreement.id\n        attachment.save\n\n        expect(Attachment.count).to eq(1)\n\n        agreement_attachments = [{id: attachment.id, _destroy: '1'}]\n        patch :update, params: {id: agreement.id, agreement: {\n            status: 'X',\n            attachments: agreement_attachments\n        }\n        }\n        agreement_response = JSON.parse(response.body)\n\n        expect(response).to be_success\n        expect(agreement_response['status']).to eq('X')\n        byebug\n        expect(Attachment.count).to eq(0)\n      end\n</code></pre>\n\n<p>obviously, the attachment should be deleted from my db. WHen i do my initial check on attachments in the middle of test i do have 1 attachment in the db and it is linked to the agreement. But in the last expect after the response successfully comes back everything is updated, but the attachment is still there, as if it ignored the _destroy.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "active-model-serializers", "serialization"], "comments": [{"owner": {"reputation": 812, "user_id": 2034213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09835300056e6e3f54e25c35e9e89a3?s=128&d=identicon&r=PG", "display_name": "igneus", "link": "https://stackoverflow.com/users/2034213/igneus"}, "edited": false, "score": 0, "creation_date": 1555446394, "post_id": 55715378, "comment_id": 98112669, "body": "It will be a constant autoloading problem. Where&#39;s your serializer located?"}, {"owner": {"reputation": 7547, "user_id": 1609496, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Rssof.jpg?s=128&g=1", "display_name": "Mini John", "link": "https://stackoverflow.com/users/1609496/mini-john"}, "reply_to_user": {"reputation": 812, "user_id": 2034213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09835300056e6e3f54e25c35e9e89a3?s=128&d=identicon&r=PG", "display_name": "igneus", "link": "https://stackoverflow.com/users/2034213/igneus"}, "edited": false, "score": 0, "creation_date": 1555446584, "post_id": 55715378, "comment_id": 98112747, "body": "@igneus <code>app&#47;serializers&#47;api&#47;v1&#47;schedule_serializer.rb</code>"}, {"owner": {"reputation": 812, "user_id": 2034213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09835300056e6e3f54e25c35e9e89a3?s=128&d=identicon&r=PG", "display_name": "igneus", "link": "https://stackoverflow.com/users/2034213/igneus"}, "edited": false, "score": 0, "creation_date": 1555449943, "post_id": 55715378, "comment_id": 98114154, "body": "Have you tried to reference the fully qualified name <code>each_serializer: Api::V1::ScheduleSerializer</code> ?"}], "owner": {"reputation": 7547, "user_id": 1609496, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Rssof.jpg?s=128&g=1", "display_name": "Mini John", "link": "https://stackoverflow.com/users/1609496/mini-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555442880, "creation_date": 1555442880, "question_id": 55715378, "link": "https://stackoverflow.com/questions/55715378/in-namespaced-api-apiv1-i-cant-access-serializers", "title": "In namespaced api (Api::V1) I can&#39;t access serializers", "body": "<p><code>Api::V1</code> is the namespacing of my <code>schedules#index</code> resource. But the controller won't access the serializer.</p>\n\n<pre><code>module Api\n  module V1\n    class ApiController &lt; ApplicationController\n      include ActionController::Serialization\n      include Concerns::ErrorHandler\n\n      before_action do\n        namespace_for_serializer = Api::V1\n      end\n    end\n  end\nend\n</code></pre>\n\n<pre><code>module Api\n  module V1\n    class SchedulesController &lt; ApiController\n\n      def index\n        @schedules = current_user.schedules\n        render json: @schedules\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<pre><code>module Api\n  module V1\n    class ScheduleSerializer &lt; ActiveModel::Serializer\n      attributes :id\n    end\n  end\nend\n</code></pre>\n\n<p>I've tried everything. Declare the serializer directly vs <code>each_serializer: ScheduleSerializer</code> which just returns an \"uninitialized constant\" error.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 3, "creation_date": 1555443061, "post_id": 55715367, "comment_id": 98111263, "body": "one way is <code>ad_source_ids = logged_one[&#39;migrated&#39;].map {|mig| mig[&#39;id&#39;] }</code>"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1555443143, "post_id": 55715367, "comment_id": 98111292, "body": "BTW, you can use <code>JSON.parse(some_json_str, symbolize_names: true)</code> to get symbols instead of strings as keys. source: <a href=\"https://apidock.com/ruby/JSON/parse\" rel=\"nofollow noreferrer\">apidock.com/ruby/JSON/parse</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1555444543, "post_id": 55715434, "comment_id": 98111896, "body": "It&#39;s worth noting that <code>collect</code> is an alias for <code>map</code> and (anecdotally) most Ruby developers prefer the latter."}], "tags": [], "owner": {"reputation": 239, "user_id": 4821424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc8186d6f94ce1d06a3fb0f0aff90fc?s=128&d=identicon&r=PG", "display_name": "chanko", "link": "https://stackoverflow.com/users/4821424/chanko"}, "is_accepted": true, "score": 1, "last_activity_date": 1555443144, "creation_date": 1555443144, "answer_id": 55715434, "question_id": 55715367, "link": "https://stackoverflow.com/questions/55715367/possible-to-do-this-as-a-one-liner-in-ruby-or-rails/55715434#55715434", "title": "possible to do this as a one-liner in Ruby or Rails", "body": "<p>You're almost there. Try this:</p>\n\n<pre><code>ad_source_ids = logged_one['migrated'].collect { |mig| mig['id'] }\n</code></pre>\n"}], "owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1555443893, "accepted_answer_id": 55715434, "answer_count": 1, "score": 1, "last_activity_date": 1555443144, "creation_date": 1555442806, "question_id": 55715367, "link": "https://stackoverflow.com/questions/55715367/possible-to-do-this-as-a-one-liner-in-ruby-or-rails", "closed_reason": "Duplicate", "title": "possible to do this as a one-liner in Ruby or Rails", "body": "<p>I have a rails app that does a lot of JSON parsing (ie using strings as keys rather than symbols). </p>\n\n<p>I have the following code:</p>\n\n<pre><code>ad_source_ids = []\nlogged_one['migrated'].each { |mig| ad_source_ids &lt;&lt; mig['id'] }\n</code></pre>\n\n<p>I'd like to do </p>\n\n<pre><code>ad_source_ids = logged_one['migrated'].map(&amp;:id)\n</code></pre>\n\n<p>but don't think I can. What is an alternative? I'd like to removed the <code>ad_source_ids</code> tmp variable. </p>\n"}, {"tags": ["html", "ruby", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1555443166, "creation_date": 1555443166, "answer_id": 55715439, "question_id": 55715128, "link": "https://stackoverflow.com/questions/55715128/how-to-select-from-a-selection-box-with-a-variable-in-the-name/55715439#55715439", "title": "How to select from a selection box with a variable in the name?", "body": "<p>From the docs for <code>select</code> - <a href=\"https://www.rubydoc.info/github/teamcapybara/capybara/Capybara/Node/Actions#select-instance_method\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/github/teamcapybara/capybara/Capybara/Node/Actions#select-instance_method</a> - we can see that the <code>from</code> option takes \"The id, Capybara.test_id atrtribute, name or label of the select box\".  </p>\n\n<p>Neither 'mb1' or 'vehicle_attrs[1]' are any of those so they would be expected to fail.  </p>\n\n<p>'vehicle_attrs[position_count]' is the name so assuming the box is actually visible on the page (not replaced with a JS driven select widget, etc), that should work.  If it doesn't, then edit your question and add the full exact error message you get when trying to use it. Of course if there is only one select box on the page with an option of 'Front' then you don't need to specify the <code>from</code> option at all and can just do</p>\n\n<pre><code>select 'Front'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 434, "user_id": 10588784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0kEOeApeXxw/AAAAAAAAAAI/AAAAAAAAA6M/zWCooX9aX1U/photo.jpg?sz=128", "display_name": "Nathaniel C", "link": "https://stackoverflow.com/users/10588784/nathaniel-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1555536778, "creation_date": 1555536778, "answer_id": 55736278, "question_id": 55715128, "link": "https://stackoverflow.com/questions/55715128/how-to-select-from-a-selection-box-with-a-variable-in-the-name/55736278#55736278", "title": "How to select from a selection box with a variable in the name?", "body": "<p>I've never liked how restrictive Capybara's concept of a 'locator' is (i.e. must have a name/id/label), but if you dig into the source code, those helpful methods like <code>select</code>, <code>click_on</code>, and <code>fill_in</code> are just wrappers for <code>find</code> and some native method of <a href=\"https://www.rubydoc.info/github/jnicklas/capybara/Capybara/Node/Element\" rel=\"nofollow noreferrer\">Element</a>, which takes arbitrary CSS, and works in almost all situations.  In this case, you could use:</p>\n\n<pre><code>find('[name=\"vehicle_attrs[position_count]\"]').find('option', text: 'Front').select_option\n</code></pre>\n\n<p>Since dropdowns often have multiple similar options, where one is a substring of the other, you might consider using an exact string match, like</p>\n\n<pre><code>find('[name=\"vehicle_attrs[position_count]\"]').find('option', text: /\\AFront\\z/).select_option\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7487360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28649b6af139729c61aa4a174778777?s=128&d=identicon&r=PG&f=1", "display_name": "ToedStorm", "link": "https://stackoverflow.com/users/7487360/toedstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 55736278, "answer_count": 2, "score": 0, "last_activity_date": 1555536778, "creation_date": 1555441906, "last_edit_date": 1555442385, "question_id": 55715128, "link": "https://stackoverflow.com/questions/55715128/how-to-select-from-a-selection-box-with-a-variable-in-the-name", "title": "How to select from a selection box with a variable in the name?", "body": "<p>I am having trouble using selecting from this select element.</p>\n\n<pre><code>&lt;select name=\"vehicle_attrs[position_count]\" class=\"mb1\"&gt;&lt;option&gt;Position / Quantity&lt;/option&gt;&lt;option&gt;Front&lt;/option&gt;&lt;option&gt;Rear&lt;/option&gt;&lt;/select&gt;\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>select('Front', :from=&gt;'mb1')\nselect('Front', :from=&gt;'vehicle_attrs[position_count]')\nselect('Front', :from=&gt;'vehicle_attrs[1]')\n</code></pre>\n\n<p>All of them result in a can not find selection box error</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 0, "creation_date": 1555437254, "post_id": 55713700, "comment_id": 98108560, "body": "For sure using @player_name or PLAYER_NAME would work"}, {"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 0, "creation_date": 1555437361, "post_id": 55713700, "comment_id": 98108602, "body": "If you have to use a local variable in method, you can pass it as a method argument. <code>def start(player_name)</code> and than <code>start(player_name)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 45, "user_id": 11262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff275d7be4c4f02a5648c68a9b28034?s=128&d=identicon&r=PG&f=1", "display_name": "newkidontheblock", "link": "https://stackoverflow.com/users/11262304/newkidontheblock"}, "edited": false, "score": 0, "creation_date": 1555596124, "post_id": 55714293, "comment_id": 98172272, "body": "My pleasure @astarisborn :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1555438790, "last_edit_date": 1555438790, "creation_date": 1555438462, "answer_id": 55714293, "question_id": 55713700, "link": "https://stackoverflow.com/questions/55713700/error-when-calling-a-method-with-command-line-argument/55714293#55714293", "title": "Error when calling a method with command line argument", "body": "<p>Your usage of <code>ARGV</code> is correct. Simply <code>player_name</code> is not defined in the <code>start</code> method. If you want to keep your method pass to it the variable</p>\n\n<pre><code>def start(player_name)\n  puts \"Hey #{player_name}, do you want to go left or right?\"\n  print \"&gt; \"\nend\n\nfirst_argument = ARGV.first\nstart(first_argument)\n</code></pre>\n\n<p>Note: I changed a variable name and moved a line to show you that they're not the same variables. You're passing it around. I think it's clearer now</p>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "is_accepted": false, "score": 0, "last_activity_date": 1555438725, "creation_date": 1555438725, "answer_id": 55714361, "question_id": 55713700, "link": "https://stackoverflow.com/questions/55713700/error-when-calling-a-method-with-command-line-argument/55714361#55714361", "title": "Error when calling a method with command line argument", "body": "<p>In addition to previous answer checkout this explanation of variable scopes in ruby: <a href=\"https://www.natashatherobot.com/ruby-variable-scope/\" rel=\"nofollow noreferrer\">https://www.natashatherobot.com/ruby-variable-scope/</a></p>\n"}], "owner": {"reputation": 45, "user_id": 11262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff275d7be4c4f02a5648c68a9b28034?s=128&d=identicon&r=PG&f=1", "display_name": "newkidontheblock", "link": "https://stackoverflow.com/users/11262304/newkidontheblock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 55714293, "answer_count": 2, "score": 0, "last_activity_date": 1555438790, "creation_date": 1555435971, "question_id": 55713700, "link": "https://stackoverflow.com/questions/55713700/error-when-calling-a-method-with-command-line-argument", "title": "Error when calling a method with command line argument", "body": "<p>I want to pass a command line argument to my program and then  reference the argument in a method I'm calling but I'm receiving the <code>undefined local variable or method error player_name</code>.</p>\n\n<p>I'm very new to Ruby, so this might be a basic question but I try to understand how to use ARGV properly. \nIs it not possible to use the input the user provides as a command line argument in a method and then call this method? What am I missing?</p>\n\n<pre><code>player_name = ARGV.first\n\ndef start\n    puts \"Hey #{player_name}, do you want to go left or right?\"\n    print \"&gt; \"\nend\n\nstart\n</code></pre>\n"}, {"tags": ["ruby", "substitution"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555441086, "post_id": 55713671, "comment_id": 98110405, "body": "Though not the most direct approach, you actually could use <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-tr\" rel=\"nofollow noreferrer\">String#tr</a> here. Starting with @tadman&#39;s hash <code>MAP</code>, one could write <code>g={&quot;no&quot;=&gt;128.chr, &quot;el&quot;=&gt;129.chr}; gi=g.invert; s1,s2 = MAP.to_a.transpose.map{ |a| a.map {|s| g.fetch(s, s)}.join}; &quot;ienoay&quot;.tr(s1, s2).each_char.map {|s| gi.fetch(s, s)}.join #=&gt; &quot;oyniuel&quot;</code>. Here <code>s1 #=&gt; &quot;aioue\\x80y&quot;; s2  #=&gt; &quot;uoiaye\\x81&quot;</code>. See <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html\" rel=\"nofollow noreferrer\">Hash#fetch</a>, quite a useful method. Just sayin&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "reply_to_user": {"reputation": 33, "user_id": 5699065, "user_type": "registered", "profile_image": "https://graph.facebook.com/1717181065168395/picture?type=large", "display_name": "kaolincash", "link": "https://stackoverflow.com/users/5699065/kaolincash"}, "edited": false, "score": 2, "creation_date": 1555438129, "post_id": 55713776, "comment_id": 98108954, "body": "@kaolincash The Stack Overflow way to express your thanks is to <i>accept</i> this answer (click the checkmark at the left so it turns green)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1555438270, "post_id": 55713776, "comment_id": 98109028, "body": "@matt There&#39;s usually a waiting period for new users before they can accept it. Rules are different for &lt;100 rep."}, {"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1555438374, "post_id": 55713776, "comment_id": 98109067, "body": "@tadman Yes, I don&#39;t mean to speak for you, just making sure the OP knows about this, as new users often do not. By the way, awesome answer; I had no idea about this. One wonders: &quot;how long has <i>this</i> been going on&quot;? :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1555441771, "post_id": 55713776, "comment_id": 98110725, "body": "Just have to be careful about how you build the &quot;map&quot; in this case so that you don&#39;t end up with premature matches like say <code>{ &quot;o&quot; =&gt; &quot;i&quot;, &quot;oh&quot; =&gt; &quot;no&quot;}</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1555445196, "post_id": 55713776, "comment_id": 98112163, "body": "@engineersmnky that&#39;s a very good point. The matches should either be non-overlapping on the first letter, or ordered from longest to shortest. This could be done in a pre-Regexp pass with <code>sort_by</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 0, "creation_date": 1555445341, "post_id": 55713776, "comment_id": 98112227, "body": "@matt The <code>gsub(pattern, hash)</code> variant of <code>gsub</code> has been around since at least <a href=\"https://ruby-doc.org/core-1.9.3/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">Ruby 1.9</a>, so presumably since about 2007."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 6, "last_activity_date": 1555436431, "last_edit_date": 1555436431, "creation_date": 1555436243, "answer_id": 55713776, "question_id": 55713671, "link": "https://stackoverflow.com/questions/55713671/how-to-translate-multiple-words-simultaneously-in-ruby/55713776#55713776", "title": "How to translate multiple words simultaneously in Ruby?", "body": "<p>First you define a substitution map:</p>\n\n<pre><code>MAP = {\n  'a' =&gt; 'u',\n  'i' =&gt; 'o',\n  'o' =&gt; 'i',\n  'u' =&gt; 'a',\n  'y' =&gt; 'el',\n  'no' =&gt; 'e',\n  'e' =&gt; 'y'\n}\n</code></pre>\n\n<p>Then you can make this into a regular expression to match all the \"keys\" in one shot:</p>\n\n<pre><code>SUBST = Regexp.union(MAP.keys)\n</code></pre>\n\n<p>This is handy because <a href=\"https://ruby-doc.org/core-2.5.1/String.html#method-i-gsub\" rel=\"noreferrer\"><code>gsub</code></a> can use these mapping tables to do substitution:</p>\n\n<pre><code>def translate(words)\n  words.gsub(SUBST, MAP)\nend\n</code></pre>\n\n<p>Which means you can do this:</p>\n\n<pre><code>puts translate(\"translate multiple words simultaneously\")\n# =&gt; trunsluty maltoply wirds somaltunyiaslel\n</code></pre>\n\n<p><code>tr</code> is a great tool, but it's limited to single character substitutions. <code>gsub</code> can do everything <code>tr</code> can and more.</p>\n"}], "owner": {"reputation": 33, "user_id": 5699065, "user_type": "registered", "profile_image": "https://graph.facebook.com/1717181065168395/picture?type=large", "display_name": "kaolincash", "link": "https://stackoverflow.com/users/5699065/kaolincash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 2, "accepted_answer_id": 55713776, "answer_count": 1, "score": 3, "last_activity_date": 1555451562, "creation_date": 1555435856, "last_edit_date": 1555451562, "question_id": 55713671, "link": "https://stackoverflow.com/questions/55713671/how-to-translate-multiple-words-simultaneously-in-ruby", "title": "How to translate multiple words simultaneously in Ruby?", "body": "<p>I'm attempting to create a substitution translator for a language my friend and I created. In this language, certain things have to happen simultaneously and I can't figure out how to do that in Ruby.</p>\n\n<p>With simple things like swapping the vowels around, i.e.</p>\n\n<pre><code>a --&gt; u\ni --&gt; o\no --&gt; i\nu --&gt; a\n</code></pre>\n\n<p>I've just done this:</p>\n\n<pre><code>input.tr(\"aiou\", \"uoia\")\n</code></pre>\n\n<p>But I can't figure out a way to make the following translations occur simultaneously:</p>\n\n<pre><code>no --&gt; e\ne --&gt; y\ny --&gt; el\n</code></pre>\n\n<p>so that the phrase \"yellow rhino\" would become \"elyllow rhie\".</p>\n\n<p>Any suggestions or examples for what I can do? <code>gsub</code>? <code>tr</code>? Another method altogether?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "on-duplicate-key", "activerecord-import"], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 1, "last_activity_date": 1555437644, "last_edit_date": 1555437644, "creation_date": 1555437018, "answer_id": 55713971, "question_id": 55713531, "link": "https://stackoverflow.com/questions/55713531/active-record-import-on-duplicate-key-update-sum-existing-value/55713971#55713971", "title": "Active-record-import on_duplicate_key_update SUM existing value", "body": "<p>As mentioned in the <a href=\"https://github.com/zdennis/activerecord-import/#duplicate-key-update\" rel=\"nofollow noreferrer\">README</a> of <a href=\"https://github.com/zdennis/activerecord-import/\" rel=\"nofollow noreferrer\">activerecord-import</a> </p>\n\n<p>This works on MySQL</p>\n\n<pre><code>Book.import [book], on_duplicate_key_update: \"quantity = quantity + VALUES(quantity)\"\n</code></pre>\n\n<p>Change the format accordingly for PostgreSQL</p>\n\n<pre><code>Book.import [book], on_duplicate_key_update: {\n  conflict_target: [:id], columns: \"quantity = books.quantity + excluded.quantity\"\n}\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "accepted_answer_id": 55713971, "answer_count": 1, "score": 0, "last_activity_date": 1555437644, "creation_date": 1555435284, "last_edit_date": 1555435374, "question_id": 55713531, "link": "https://stackoverflow.com/questions/55713531/active-record-import-on-duplicate-key-update-sum-existing-value", "title": "Active-record-import on_duplicate_key_update SUM existing value", "body": "<p>How is possible to SUM the value of array to my existing row field during on_duplicate_key_update?</p>\n\n<p>For example:\nModel.import array, on_duplicate_key_update: [ :column_value + array_value]</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "rubymine", "gherkin", "folding", "code-folding"], "answers": [{"tags": [], "owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "is_accepted": true, "score": 2, "last_activity_date": 1555505942, "creation_date": 1555505942, "answer_id": 55728114, "question_id": 55713160, "link": "https://stackoverflow.com/questions/55713160/rubymine-code-folding-surround-with-is-inactive-for-feature-files/55728114#55728114", "title": "Rubymine: Code folding: &quot;Surround with&quot; is inactive for *.feature files", "body": "<p>At the moment it's not supported in RubyMine so others who'd like to see this option implemented might refer to the request you've submitted: <a href=\"https://youtrack.jetbrains.com/issue/RUBY-24080\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/RUBY-24080</a></p>\n"}], "owner": {"reputation": 191, "user_id": 2878233, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Ok3Qo.jpg?s=128&g=1", "display_name": "laechoppe", "link": "https://stackoverflow.com/users/2878233/laechoppe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55728114, "answer_count": 1, "score": 0, "last_activity_date": 1555505942, "creation_date": 1555433781, "question_id": 55713160, "link": "https://stackoverflow.com/questions/55713160/rubymine-code-folding-surround-with-is-inactive-for-feature-files", "title": "Rubymine: Code folding: &quot;Surround with&quot; is inactive for *.feature files", "body": "<p>I wanted to created a custom folding region (like  it's described <a href=\"https://stackoverflow.com/questions/46901353/manual-markers-for-code-folding-in-rubymine\">here</a>), however \"Surround with\" is inactive for *.feature files.\nIt's enabled for *.rb (but still no custom folding option in the menu). \nFor *.rb files I successfully use #region #endregion, but what about feature files? Any options to have the same #regions?</p>\n\n<p><a href=\"https://i.stack.imgur.com/0CgPx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0CgPx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 8305823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b967ef75647b62890a16d79acdd2b869?s=128&d=identicon&r=PG", "display_name": "jojitoon", "link": "https://stackoverflow.com/users/8305823/jojitoon"}, "is_accepted": false, "score": 3, "last_activity_date": 1555429283, "creation_date": 1555429283, "answer_id": 55711950, "question_id": 55711694, "link": "https://stackoverflow.com/questions/55711694/rails-modules-conflict-with-model-class-names/55711950#55711950", "title": "Rails modules conflict with model class names", "body": "<p>My guess is that because they are both in the same namespace you can't give them same name. Try changing the module name from <code>StoreBuild</code> to something else. it should solve your problem. would share more docs for this.</p>\n"}, {"comments": [{"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1555431930, "post_id": 55712435, "comment_id": 98106024, "body": "So are we saying you can&#39;t have a module and model with the same name under the same module?"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1555433200, "post_id": 55712435, "comment_id": 98106655, "body": "No. Rails only wants one kind of name per thing (module, class). Usually what I do is pluralize for modules with similar names, such as <code>ProductName::StoreBuild::StoreBuildWorker</code> would become <code>ProductName::StoreBuilds::StoreBuildWorker</code>. It&#39;s not the prettiest, but it gets the point across."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 1, "creation_date": 1555433684, "post_id": 55712435, "comment_id": 98106918, "body": "@Cameron This is Ruby more than specifically rails. This is a naming conflict because a Module class is Module and a Class class is Class. If they were in different namespaces then this would be acceptable but no inside the same namespace. That being said nothing stops you from declaring <code>StoreBuildWorker</code> inside the class <code>StoreBuild</code>"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 3, "last_activity_date": 1555430940, "creation_date": 1555430940, "answer_id": 55712435, "question_id": 55711694, "link": "https://stackoverflow.com/questions/55711694/rails-modules-conflict-with-model-class-names/55712435#55712435", "title": "Rails modules conflict with model class names", "body": "<p>This is failing due to Rails' autoloading hierarchy. Brush up on <a href=\"https://guides.rubyonrails.org/autoloading_and_reloading_constants.html\" rel=\"nofollow noreferrer\">Autoloading and Reloading Constants</a> to see how this works.</p>\n\n<p>Rails sees <code>ProductName::StoreBuild</code>, and then caches its reference as a class and not a  module. When you then have <code>ProductName::StoreBuild::StoreBuildWorker</code>, it says \"huh, it's a module now\" and freaks out.</p>\n\n<p>Anecdotal: your app is probably very-well organized. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2700856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b74da63a8e5e0f829049320a42e37dc?s=128&d=identicon&r=PG", "display_name": "davefreiman", "link": "https://stackoverflow.com/users/2700856/davefreiman"}, "is_accepted": false, "score": 0, "last_activity_date": 1555456242, "creation_date": 1555456242, "answer_id": 55717757, "question_id": 55711694, "link": "https://stackoverflow.com/questions/55711694/rails-modules-conflict-with-model-class-names/55717757#55717757", "title": "Rails modules conflict with model class names", "body": "<p>The error message is telling you that there is a conflict since you are redefining <code>ProductName::StoreBuild</code> as a module where you have previously defined the same thing as a class.</p>\n\n<p>If you don't want to rename anything, you can nest modules within a class if it makes sense in the namespacing of your app.</p>\n\n<p>So if you have a class:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module ProductName\n  class StoreBuild\n  end\nend\n</code></pre>\n\n<p>You can embed another class underneath it like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module ProductName\n  class StoreBuild\n    class StoreBuildWorker\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1555456242, "creation_date": 1555428488, "last_edit_date": 1555429164, "question_id": 55711694, "link": "https://stackoverflow.com/questions/55711694/rails-modules-conflict-with-model-class-names", "title": "Rails modules conflict with model class names", "body": "<p>In our Rails app we have some models like:</p>\n\n<pre><code>module ProductName\n  class StoreBuild\n  end\nend\n</code></pre>\n\n<p>And then we have some workers like:</p>\n\n<pre><code>module ProductName\n  module StoreBuild\n    class StoreBuildWorker\n    end\n  end\nend\n</code></pre>\n\n<p>We then call these workers like:</p>\n\n<pre><code>ProductName::StoreBuild::StoreBuildWorker.perform_async(@store_build.id)\n</code></pre>\n\n<p>However we sometimes have encountered an error:</p>\n\n<pre><code>TypeError:\n  StoreBuild is not a module\n</code></pre>\n\n<p>When we inspect the StoreBuild from that last line it, it thinks it's the model class and not the worker module we are referencing which is causing the error...</p>\n\n<p>How do you stop modules conflicting with class names?</p>\n\n<p>Annoyingly Rails doesn't use namespaces for top-level folders so it means Models and Workers that want to use the same namespaces conflict because they don't have any namespaces themselves.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1555427631, "post_id": 55711249, "comment_id": 98103586, "body": "Whne you say &quot;not clicking&quot; do you mean you get an error (if so add it to the question) or do you just mean the behavior you expect from the click isn&#39;t happening (if so add the following code that isn&#39;t seeing what you expect, and the error that generates).  Also please add the relevant portion of HTML you&#39;re working with.  Note: if you&#39;re testing an app/site you should never be using <code>trigger</code> or clicks triggered via <code>execute_script</code> - they do not replicate what a user could do on the page"}, {"owner": {"reputation": 1, "user_id": 11369230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219247022750393/picture?type=large", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/11369230/zach-smith"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1555428071, "post_id": 55711249, "comment_id": 98103848, "body": "@ThomasWalpole updated, thanks! The error I receive is the element is not found but that is because the drop down is never clicked"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1555428327, "post_id": 55711249, "comment_id": 98104008, "body": "Without knowing what other code is being run that error really doesn&#39;t tell much except that the click is happening (otherwise Capybara would have errored on the initial click), you&#39;re just not seeing the results of the click you expect. I would guess the answer by @Bodhish is correct and you&#39;re running in a different screen resolution/window size on browserstack than locally."}, {"owner": {"reputation": 434, "user_id": 10588784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0kEOeApeXxw/AAAAAAAAAAI/AAAAAAAAA6M/zWCooX9aX1U/photo.jpg?sz=128", "display_name": "Nathaniel C", "link": "https://stackoverflow.com/users/10588784/nathaniel-c"}, "edited": false, "score": 0, "creation_date": 1555439980, "post_id": 55711249, "comment_id": 98109865, "body": "Are you running headless on browserstack and with a real browser locally?  I&#39;ve seen that cause discrepancies, that and window size.  If you can&#39;t get the click to open the dropdown, you might try putting focus on it and sending a down arrow key.  It&#39;s a workaround, but I&#39;ve used it for really stubborn/flaky dropdowns."}], "owner": {"reputation": 1, "user_id": 11369230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219247022750393/picture?type=large", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/11369230/zach-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555482701, "creation_date": 1555426947, "last_edit_date": 1555428353, "question_id": 55711249, "link": "https://stackoverflow.com/questions/55711249/automated-test-works-locally-but-fails-on-browser-stack-due-to-not-clicking", "title": "Automated test works locally but fails on browser stack due to not clicking", "body": "<p>Created a test case that passes locally then fails when running in browser stack. The root cause is that an element is not being clicked. When I run this locally the element is always clicked. Using capybara, rspec and ruby to write the tests. The reason the test fails is because the next step is to click an element. Since the drop down is never clicked, the element is not found, it is in the drop down.</p>\n\n<p>Here is an image of the error</p>\n\n<p><a href=\"https://i.stack.imgur.com/8y6SP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8y6SP.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried a few different methods for clicking that will work locally but not solve the issue. Running on OSX Chrome, Mojave version 73. </p>\n\n<p>Some code that I have tried:</p>\n\n<pre><code>  def language_dropdown\n    find('div', id:'user_locale_chzn').click\n  end\n</code></pre>\n\n<pre><code>  def language_dropdown\n    within(:css, \"div#user_locale_chzn\") do\n      find('a', class: 'chzn-single').trigger(:click)\n    end\n  end\n</code></pre>\n\n<pre><code>  def language_dropdown\n    within(:css, \"div#user_locale_chzn\") do\n      locale = find('a', class: 'chzn-single')\n      execute_script(\"arguments[0].click();\", locale)\n    end\n  end\n</code></pre>\n\n<p>I expect that the language drop down element is clicked to expand options so the test can continue to run but this only happens locally and again does not work on browserstack.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 4, "creation_date": 1555426050, "post_id": 55710785, "comment_id": 98102651, "body": "Consider using <code>elsif</code> or <code>case</code> instead of inventing new methods that the reader has to look up in order to understand."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555432956, "post_id": 55710785, "comment_id": 98106533, "body": "Your code is unnecessarily complex. Combine the lines <code>else</code> and <code>if Environ == :linux</code> to <code>elsif Environ == :linux</code> and remove the final <code>end</code>. When learning a new language being overly-distracted by diversions is a time-waster."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555432565, "post_id": 55710914, "comment_id": 98106338, "body": "You can collapse the <code>case</code> a little by moving the <code>puts</code> outside of the <code>case</code>."}, {"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1555438751, "post_id": 55710914, "comment_id": 98109242, "body": "@tadman I suspect the <code>puts</code> is there only to demonstrate branching, and are not present in the actual code - much less as lone statements"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1555441581, "post_id": 55710914, "comment_id": 98110643, "body": "@tadman This is placeholder code. If the objective were to just <code>puts</code> something, the whole question could be replaced with <code>puts Environ.to_s</code>"}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 2, "last_activity_date": 1555425933, "creation_date": 1555425933, "answer_id": 55710914, "question_id": 55710785, "link": "https://stackoverflow.com/questions/55710785/is-there-a-way-to-remove-ifs-and-use-functions-instead/55710914#55710914", "title": "Is there a way to remove Ifs and use functions instead", "body": "<p>You can define a function that accepts a block, but it makes no sense (and isn't really possible) to nest <code>other</code> inside <code>linux</code>.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def windows\n  yield if Environ == :windows\nend\n\ndef linux\n  yield if Environ == :linux\nend\n\ndef other\n  yield if Environ != :windows &amp;&amp; Environ != :linux\nend\n\nwindows {\n  puts 'windows'\n}\n\nlinux {\n  puts 'linux'\n}\n\nother {\n  puts 'other'\n}\n\n</code></pre>\n\n<p>The better solution in this case might be a simple <code>case</code> statement:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>case Environ\nwhen :windows then puts \"windows\"\nwhen :linux then puts \"linux\"\nelse puts \"other\"\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11369083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--RTGuR9HY90/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdjtHWYM1g2KvgFUR9P2arzKw7cJQ/mo/photo.jpg?sz=128", "display_name": "Ezequiel278", "link": "https://stackoverflow.com/users/11369083/ezequiel278"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55710914, "answer_count": 1, "score": -2, "last_activity_date": 1555438579, "creation_date": 1555425539, "last_edit_date": 1555438579, "question_id": 55710785, "link": "https://stackoverflow.com/questions/55710785/is-there-a-way-to-remove-ifs-and-use-functions-instead", "title": "Is there a way to remove Ifs and use functions instead", "body": "<p>Is there a way in Ruby to replace 'if' statements for a function to make the code more readable?</p>\n\n<pre><code>if Environ == :windows\n    puts 'windows'\nelse\n    if Environ == :linux \n        puts 'linux'\n    else\n        puts 'other environment'\n    end\nend\n</code></pre>\n\n<p>I want to replace the above with blocks like:</p>\n\n<pre><code>windows{\n    puts 'windows'\n}\n\nlinux{\n    puts 'linux'\n    others{\n        puts 'other environment'\n    }\n}\n</code></pre>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 7, "creation_date": 1555422124, "post_id": 55709355, "comment_id": 98099951, "body": "Why do you need this hash ordered? I am asking because, in theory, a hash is a data structure that doesn&#39;t have a specific order. Although in Ruby&#39;s implementation of a hash key/value pairs are order in the order in which they were added to the hash."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1555433626, "post_id": 55709428, "comment_id": 98106884, "body": "sawa enjoys showing off newish Ruby methods, which I applaud for its education value. <a href=\"http://ruby-doc.org/core-2.6.2/Hash.html#method-i-slice\" rel=\"nofollow noreferrer\">Hash#slice</a>, which is perfect here, made its debut in v2.5. I had forgotten about it and appreciated the reminder."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555433666, "post_id": 55709428, "comment_id": 98106906, "body": "This is something that ActiveSupport introduced into Rails, but it&#39;s good to see that core Ruby has adopted it as well."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 5, "last_activity_date": 1555421467, "creation_date": 1555421467, "answer_id": 55709428, "question_id": 55709355, "link": "https://stackoverflow.com/questions/55709355/how-do-i-change-the-order-in-a-hash/55709428#55709428", "title": "How do I change the order in a hash?", "body": "<pre><code>{\"match\"=&gt;0, \"reach\"=&gt;1, \"safe\"=&gt;2, \"undecided\"=&gt;3}\n.slice(\"reach\", \"match\", \"safe\", \"undecided\")\n# =&gt; {\"reach\"=&gt;1, \"match\"=&gt;0, \"safe\"=&gt;2, \"undecided\"=&gt;3}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9534498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb25ac055944ca9d647b88d24012c824?s=128&d=identicon&r=PG&f=1", "display_name": "Hardika Desai", "link": "https://stackoverflow.com/users/9534498/hardika-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 55709428, "answer_count": 1, "score": 0, "last_activity_date": 1555423113, "creation_date": 1555421274, "last_edit_date": 1555423113, "question_id": 55709355, "link": "https://stackoverflow.com/questions/55709355/how-do-i-change-the-order-in-a-hash", "title": "How do I change the order in a hash?", "body": "<p>I have the following hash:</p>\n\n<pre><code>{\"match\"=&gt;0, \"reach\"=&gt;1, \"safe\"=&gt;2, \"undecided\"=&gt;3}\n</code></pre>\n\n<p>I want to change the order like below:</p>\n\n<pre><code>{\"reach\"=&gt;1, \"match\"=&gt;0, \"safe\"=&gt;2, \"undecided\"=&gt;3}\n</code></pre>\n\n<p>What is the most effective solution for this?</p>\n"}, {"tags": ["ruby", "return", "main"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555433773, "post_id": 55708459, "comment_id": 98106964, "body": "In both cases, from file and from <code>irb</code>, the <code>self</code> context is <code>main</code>. This is a peculiar quirk."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1555490662, "last_edit_date": 1555490662, "creation_date": 1555434278, "answer_id": 55713282, "question_id": 55708459, "link": "https://stackoverflow.com/questions/55708459/return-in-main-environment/55713282#55713282", "title": "`return` in main environment", "body": "<p>Top-level return was added as a feature in ruby 2.4.0: <a href=\"https://bugs.ruby-lang.org/issues/4840\" rel=\"nofollow noreferrer\">https://bugs.ruby-lang.org/issues/4840</a></p>\n\n<p>It was never mentioned in the <a href=\"https://www.ruby-lang.org/en/news/2016/12/25/ruby-2-4-0-released/\" rel=\"nofollow noreferrer\">release announcement</a>, but you can see it listed under the \"language changes\" in the more detailed <a href=\"https://github.com/ruby/ruby/blob/v2_4_0/NEWS\" rel=\"nofollow noreferrer\">news post</a>.</p>\n\n<p>If you run a file which contains <code>return \"foo\"</code> in ruby version <code>&lt; 2.4.0</code>, you will indeed see an error like:</p>\n\n<pre><code>foo.rb:1:in `&lt;main&gt;': unexpected return (LocalJumpError)\n</code></pre>\n\n<p>The intended use case (as you can see from the above link) was for \"cancelling a <code>require</code>\" - e.g. if the file is platform-specific, such as:</p>\n\n<pre><code>require \"test/unit\"\n\nreturn unless /mswin|cygwin|mingw|bccwin/\n\n# ...\n</code></pre>\n\n<p>There was much discussion and debate over proposed syntax and behaviour; but the chosen implementation can perhaps be best understood by reading the implementation's <a href=\"https://github.com/ruby/ruby/pull/1043/files#diff-4216bbf6387c50d56b418c67768dcccb\" rel=\"nofollow noreferrer\">test cases</a>:</p>\n\n<pre><code>def test_return_toplevel\n  feature4840 = '[ruby-core:36785] [Feature #4840]'\n  code = &lt;&lt;~'CODE'\n  return; raise\n  begin return; rescue SystemExit; exit false; end\n  begin return; ensure exit false; end\n  begin ensure return; end\n  begin raise; ensure; return; end\n  begin raise; rescue; return; end\n  return false; raise\n  return 1; raise\n  CODE\n  all_assertions(feature4840) do |a|\n    code.each_line do |s|\n      s.chomp!\n      a.for(s) {assert_ruby_status([], s)}\n    end\n  end\nend\n</code></pre>\n\n<p>Since writing <code>return</code> inside a REPL like <code>pry</code> is not at the \"top level\", this results in a <code>LocalJumpError</code> instead of the above special behaviour for \"top-level <code>return</code>\".</p>\n"}], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 55713282, "answer_count": 1, "score": 2, "last_activity_date": 1555490662, "creation_date": 1555418614, "last_edit_date": 1555420192, "question_id": 55708459, "link": "https://stackoverflow.com/questions/55708459/return-in-main-environment", "title": "`return` in main environment", "body": "<p>When I run the following in the main environment in irb or pry,</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>return \"foo\"\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>LocalJumpError: unexpected return\n</code></pre>\n\n<p>which is expected. But when I write this code in a separate file <code>foo.rb</code>, and do:</p>\n\n<pre><code>$ ruby foo.rb\n</code></pre>\n\n<p>in the console, it terminates without any error message.</p>\n\n<p>What is happening in the latter case?</p>\n\n<p>I thought a raised error might be silently disposed with, and tried the following in a separate file:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>begin\n  return \"foo\"\nrescue Exception =&gt; e\n  p e\nend\n</code></pre>\n\n<p>and executed it from the console, but this also resulted in no error.</p>\n\n<p>When I put the code in an environment such as a module, it returns the error:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module A\n  return \"foo\" # &gt;&gt; Invalid return in class/module body\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1555415680, "post_id": 55707472, "comment_id": 98095897, "body": "I can&#39;t check right now, but try printing out (<code>p</code>) the variable <code>c</code> in both cases, maybe you find out why."}, {"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1555416447, "post_id": 55707472, "comment_id": 98096343, "body": "I tried it, in both cases the attribute is changed on <code>c</code> object."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 1, "creation_date": 1555418009, "post_id": 55707472, "comment_id": 98097218, "body": "Does using <code>assign_attribute(:active, false)</code> help?"}, {"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "edited": false, "score": 0, "creation_date": 1555418304, "post_id": 55707472, "comment_id": 98097382, "body": "same result sadly, it isn&#39;t saved"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1555418661, "post_id": 55707472, "comment_id": 98097626, "body": "By the way, does your code have <code>if c.active = true</code> or <code>if c.active == true</code>?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1555418670, "post_id": 55707472, "comment_id": 98097629, "body": "rather than updating the children and saving the parent try <code>update_all(active: false)</code> e.g. <code>object.children.where(active: true).update_all(active: false)</code>. This will avoid all callbacks, validations, and model instantiation as well as being far more efficient"}, {"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1555418865, "post_id": 55707472, "comment_id": 98097770, "body": "ops, my mistake, it&#39;s <code>if c.active == true</code> @engineersmnky that would work, but I can&#39;t do that, since I need to run the validations on the parent model before doing so and also run the same code when it&#39;s a new object being created"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 1, "creation_date": 1555419211, "post_id": 55707472, "comment_id": 98097985, "body": "Can you share the logs? Do you see any <code>Rollback</code> in there?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1555419338, "post_id": 55707472, "comment_id": 98098076, "body": "@xSlok if your are validating the parent are you sure the validation is not failing? The code posted just shows that you call <code>save</code> but does not show that the return value is <code>true</code> generally one would save <code>if object.save</code> to ensure that save actually worked. If the <code>object.save</code> is failing the cascading saves would not occur."}, {"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "edited": false, "score": 0, "creation_date": 1555419730, "post_id": 55707472, "comment_id": 98098337, "body": "in both cases the <code>.save</code> returns true, prints of the running code added to the question"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1555420732, "post_id": 55707472, "comment_id": 98098987, "body": "Try the following <code>object.includes(:children).where(&#39;children.active&#39; =&gt; true).each..</code>"}, {"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "edited": false, "score": 0, "creation_date": 1555421143, "post_id": 55707472, "comment_id": 98099266, "body": "tried it, same result sadly"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1555421306, "post_id": 55707472, "comment_id": 98099383, "body": "The issue is as you stated due to the fact that <code>where.</code> is going to created a clone of Relation (&quot;spawn&quot;) thus appears to disconnect it from <code>object</code>. I have no idea what the purpose of this code is as it is unclear in this context so it is difficult to propose alternative solutions."}, {"owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "edited": false, "score": 0, "creation_date": 1555421547, "post_id": 55707472, "comment_id": 98099554, "body": "the child object in this case is a <code>join table</code> that binds <code>table 1</code> and <code>table 2</code>, and this join table has an <code>active</code> attribute, that defines the state of the relation between them. I need to set <code>active</code> to false when a <code>table 2</code> id is not in a specific list, and save it to database when I save the parent object."}], "owner": {"reputation": 460, "user_id": 6336045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/dWWGM.png?s=128&g=1", "display_name": "xSlok", "link": "https://stackoverflow.com/users/6336045/xslok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555419698, "creation_date": 1555415345, "last_edit_date": 1555419698, "question_id": 55707472, "link": "https://stackoverflow.com/questions/55707472/rails-not-saving-child-object-if-where-or-scopes-are-used", "title": "Rails - Not saving child object if &quot;where&quot; or scopes are used", "body": "<p>I'm trying to change a child object and if I use scopes or where to filter it, the change isn't saved when I call .save on the parent object.</p>\n\n<pre><code>object = Object.find(@id)\nobject.children.where(active: true).each do |c|\n   c.active = false\nend \nobject.save\n</code></pre>\n\n<p>like this, the object isn't saved, but if I do this:</p>\n\n<pre><code>object = Object.find(@id)\nobject.children.each do |c|\n   c.active = false if c.active == true\nend \nobject.save\n</code></pre>\n\n<p>it works properly, what am I doing wrong?</p>\n\n<p>Ruby v2.4.5p335</p>\n\n<p>Rails v5.2.3</p>\n\n<p>@Edit</p>\n\n<p>Working: \n<a href=\"https://i.stack.imgur.com/rToPa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rToPa.png\" alt=\"enter image description here\"></a>\nNot Working: \n<a href=\"https://i.stack.imgur.com/FNqFR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FNqFR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "httparty"], "comments": [{"owner": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "edited": false, "score": 0, "creation_date": 1555416415, "post_id": 55707035, "comment_id": 98096323, "body": "Could you tell us where you stuck :)"}, {"owner": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "reply_to_user": {"reputation": 928, "user_id": 2724228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uGNiO.jpg?s=128&g=1", "display_name": "Manoj Menon", "link": "https://stackoverflow.com/users/2724228/manoj-menon"}, "edited": false, "score": 0, "creation_date": 1555416805, "post_id": 55707035, "comment_id": 98096540, "body": "@Manoj articles are show on page now, but every time on refresh page  it call API method I want save it to db and call it from db. stuck on saving to db"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "edited": false, "score": 0, "creation_date": 1555441479, "post_id": 55708310, "comment_id": 98110588, "body": "I think that what I need but where exacly I should put this save method that it works?  I realy do not understud if it call somewhere or what, because now it do now save to DB anithing.   If i take all code inside of class and put it in Article model it still don&#39;t work"}, {"owner": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "edited": false, "score": 0, "creation_date": 1555450100, "post_id": 55708310, "comment_id": 98114209, "body": "it almost work but get this error ActiveRecord::AssociationTypeMismatch: Source(#70117389054060) expected, got {&quot;id&quot;=&gt;nil, &quot;name&quot;=&gt;&quot;Espn.com&quot;} which is an instance of Hash(#47345000114540)"}, {"owner": {"reputation": 274, "user_id": 10955127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218700697293587/picture?type=large", "display_name": "Bryan", "link": "https://stackoverflow.com/users/10955127/bryan"}, "reply_to_user": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "edited": false, "score": 0, "creation_date": 1555489722, "post_id": 55708310, "comment_id": 98125464, "body": "could you update your question with the code you try to ran which produced the   <code>ActiveRecord::AssociationTypeMismatch</code>? I think it may be possibly you passing in the  <code>source_id</code> from the api call as a string inside of an integer.. for example: <code>(source_id: k[&#39;id&#39;])</code> <code>k[&#39;id&#39;]</code>(the id coming from the api) should be coerced to an integer by doing <code>k[&#39;id&#39;].to_i</code> .. but I can&#39;t verify this until you update :)"}, {"owner": {"reputation": 274, "user_id": 10955127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218700697293587/picture?type=large", "display_name": "Bryan", "link": "https://stackoverflow.com/users/10955127/bryan"}, "reply_to_user": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "edited": false, "score": 0, "creation_date": 1555677318, "post_id": 55708310, "comment_id": 98198399, "body": "so when you <code>Article.create!</code> with your validation, you&#39;ll have a rollback that doesn&#39;t allow you to save it (first example) and in the second example it does save because you don&#39;t have a validation to verify if your <code>Article</code> needs the fields to be populated. when you create <code>Article.create!</code> you&#39;re also not adding any fields to it. you&#39;re not adding anything so the fields will be blank.. if you wanted to add fields you&#39;d have to do <code>Article.create!(tittle: &quot;This is my article title&quot;, description: &quot;This is the description of the article)</code> and also include whatever other fields must be there."}], "tags": [], "owner": {"reputation": 274, "user_id": 10955127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218700697293587/picture?type=large", "display_name": "Bryan", "link": "https://stackoverflow.com/users/10955127/bryan"}, "is_accepted": true, "score": 2, "last_activity_date": 1555418186, "creation_date": 1555418186, "answer_id": 55708310, "question_id": 55707035, "link": "https://stackoverflow.com/questions/55707035/how-to-save-httparty-response-to-dbupdate/55708310#55708310", "title": "How to save HTTParty response to db?(Update!)", "body": "<p>from what it looks like to me: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>pars_json.each do |k|\n  art = ParserService.new('us')\n  res = response.body\n  art.title = res[\"title\"]\n  art.save\nend\n</code></pre>\n\n<p>this piece is where you're trying to save it to the DB? I don't think ParserService is a model you've created that reflects a table from your DB.</p>\n\n<p>if you have the <code>Article</code> model that you're wanting to use to save each object parsed from API call you'd want to do something as such instead of the above:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>pars_json.each do |k|\n  article = Article.create(title: k[\"title\"], k[\"description\"]...)\nend\n</code></pre>\n\n<p>Try to first print out what <code>k</code> is exactly and line up the object keys to correspond to the correct <code>Article</code> fields.</p>\n\n<p>Again, to save to the DB, you need to use a model you've created that reflects a table on the DB. if you have the <code>articles</code> table on your DB where you'd like to save your API response data, then you should create instances of <code>Article</code> and save those. </p>\n\n<p>Then in the controller it's just calling it by <code>@articles = Article.all</code> or whichever query you'd like to run to have your list of articles. </p>\n\n<p>I'd recommend running the <code>ParserService</code> in a Background job to have the API fetch the data on a parallel process without having it affect too much the rails process</p>\n"}], "owner": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 55708310, "answer_count": 1, "score": 0, "last_activity_date": 1555492643, "creation_date": 1555413876, "last_edit_date": 1555492643, "question_id": 55707035, "link": "https://stackoverflow.com/questions/55707035/how-to-save-httparty-response-to-dbupdate", "title": "How to save HTTParty response to db?(Update!)", "body": "<p>Need to save httparty response to db and call it in view file</p>\n\n<p>this is what httrparty get</p>\n\n<p><a href=\"https://i.stack.imgur.com/u5ZS5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u5ZS5.png\" alt=\"enter\"></a></p>\n\n<p>in services folder/</p>\n\n<pre><code> class ParserService\n      include HTTParty\n      API_KEY = '882e10dd2b474a23bb7a3efa85e66b61'.freeze\n      base_uri 'https://newsapi.org/v2/'\n      default_params fielsd: \"title, description, ulr, content\"\n      format :json\n\n      def self.top_headlines(country_name='us') \n        new(country_name).top_headlines\n      end\n\n      def initialize(country_name='us')\n        @options = { query: { country: country_name, apiKey: API_KEY} }\n      end\n\n        def top_headlines \n          response = self.class.get(\"/top-headlines\", @options)\n          pars_json = response.parsed_response\n          pars_json[\"articles\"].each do |k|\n            @source = ActiveModel::Source.create(google_id: k[\"id\"], name: k[\"name\"])\n\n            @article = Article.create(title: k[\"title\"], source_id: @source.id,\n                                      description: k[\"description\"], content: k[\"content\"])\n\n          end\n        end  \n    end\n</code></pre>\n\n<p>ArticleController</p>\n\n<pre><code>class ArticlesController &lt; ApplicationController\n\n\n    def index\n        @articles = Article.all\n    end\nend\n</code></pre>\n\n<p>and model </p>\n\n<pre><code>class Article &lt; ApplicationRecord\n    belongs_to :source, class_name: \"Source\", optional: true\n    validates :title, presence: true\n    validates :source_id, uniqueness: true \n\nend\n</code></pre>\n\n<p>and schema.rb</p>\n\n<p><a href=\"https://i.stack.imgur.com/pdNq9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pdNq9.png\" alt=\"enter image description here\"></a></p>\n\n<p>That what I done now\nif try to save Article in (rails c) console have this error, validation</p>\n\n<p><a href=\"https://i.stack.imgur.com/o78BF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o78BF.png\" alt=\"enter image description here\"></a></p>\n\n<p>when try to comment validation it save but....it save empty fields</p>\n\n<p><a href=\"https://i.stack.imgur.com/PEbFL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PEbFL.png\" alt=\"enter image description here\"></a></p>\n\n<p>and I realy do not understand why it empy, when I call JSOn directlly, without saving to db, on view it show all what I need, but now I have this...\non index page</p>\n\n<p><a href=\"https://i.stack.imgur.com/AOdvz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AOdvz.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/FVZ9u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FVZ9u.png\" alt=\"enter image description here\"></a></p>\n\n<p>and in console later got errors</p>\n\n<p><a href=\"https://i.stack.imgur.com/qdTfn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qdTfn.png\" alt=\"enter image description here\"></a></p>\n\n<p>I can image how to fix this and what and where go wrong</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 666, "user_id": 2686232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXFw3.jpg?s=128&g=1", "display_name": "Leandro Figueredo", "link": "https://stackoverflow.com/users/2686232/leandro-figueredo"}, "edited": false, "score": 0, "creation_date": 1555445662, "post_id": 55706271, "comment_id": 98112355, "body": "What version of Ruby are you using?"}, {"owner": {"reputation": 1, "user_id": 6076252, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KziESyzGwDA/AAAAAAAAAAI/AAAAAAAAAQs/ak3lzkwuvac/photo.jpg?sz=128", "display_name": "Rishi Rawat", "link": "https://stackoverflow.com/users/6076252/rishi-rawat"}, "reply_to_user": {"reputation": 666, "user_id": 2686232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXFw3.jpg?s=128&g=1", "display_name": "Leandro Figueredo", "link": "https://stackoverflow.com/users/2686232/leandro-figueredo"}, "edited": false, "score": 0, "creation_date": 1556113218, "post_id": 55706271, "comment_id": 98327570, "body": "Im using v2.5 ."}], "answers": [{"tags": [], "owner": {"reputation": 3066, "user_id": 999047, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/07fc85c967ba7466aa3d739e6b87a8bb?s=128&d=identicon&r=PG", "display_name": "dpaluy", "link": "https://stackoverflow.com/users/999047/dpaluy"}, "is_accepted": false, "score": 0, "last_activity_date": 1556115003, "creation_date": 1556115003, "answer_id": 55832123, "question_id": 55706271, "link": "https://stackoverflow.com/questions/55706271/how-to-insert-images-in-pdf-using-origami-gem-in-ruby2-5/55832123#55832123", "title": "How to insert images in PDF using origami gem in Ruby(2.5)?", "body": "<p>In order to add an image to Origami, you should use this method: <code>add_xobject(xobject, name = nil)</code>\nwhere <code>xobject</code> is an image.</p>\n\n<p><a href=\"https://github.com/gdelugre/origami/blob/7d3f6fcdc32345a458e91d91a0172349f10aaac8/lib/origami/page.rb#L132\" rel=\"nofollow noreferrer\">https://github.com/gdelugre/origami/blob/7d3f6fcdc32345a458e91d91a0172349f10aaac8/lib/origami/page.rb#L132</a></p>\n\n<p>For example:</p>\n\n<pre><code>pdf = PDF.read('pdf-sample.pdf')\npage = pdf.get_page(1)\nimg = Graphics::ImageXObject.from_image_file('sample.jpeg', 'jpg')\npage.add_xobject(img, 'sample_image_name')\n</code></pre>\n\n<p>See another reference here: <a href=\"https://github.com/gdelugre/origami/issues/17\" rel=\"nofollow noreferrer\">https://github.com/gdelugre/origami/issues/17</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6076252, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KziESyzGwDA/AAAAAAAAAAI/AAAAAAAAAQs/ak3lzkwuvac/photo.jpg?sz=128", "display_name": "Rishi Rawat", "link": "https://stackoverflow.com/users/6076252/rishi-rawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556115003, "creation_date": 1555411323, "last_edit_date": 1556113178, "question_id": 55706271, "link": "https://stackoverflow.com/questions/55706271/how-to-insert-images-in-pdf-using-origami-gem-in-ruby2-5", "title": "How to insert images in PDF using origami gem in Ruby(2.5)?", "body": "<p>I'm using origami <code>gem</code> in order to create PDF files. Its confusing as to how I can add an image in the <code>PDF</code> at a particular location(x, y) coordinates in the pages.</p>\n\n<p>I'm using this method but it only reads the image:</p>\n\n<pre><code>Origami::Graphics::ImageXObject.from_image_file(path, format = nil)\n</code></pre>\n\n<p>How do I add this image object to the PDF pages?</p>\n"}, {"tags": ["ruby", "dsl"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1555408009, "post_id": 55704817, "comment_id": 98091348, "body": "Not without parsing the code using a lexer (ripper, ruby_parser, ...)."}], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1555411184, "creation_date": 1555406820, "last_edit_date": 1555411184, "question_id": 55704817, "link": "https://stackoverflow.com/questions/55704817/in-ruby-ensure-only-certain-methods-are-available", "title": "In ruby ensure only certain methods are available", "body": "<p>I was reading an <a href=\"https://medium.com/@farsi_mehdi/parsing-a-dsl-in-ruby-in-less-that-30-loc-2c651a3f2e19\" rel=\"nofollow noreferrer\">article</a> on how to build a simple DSL and parse the file but it does (and rightfully so) point out how dangerous this is as you can't really trust what get's eval'ed.</p>\n\n<p>So it got me thinking, is it possible to make it safe?</p>\n\n<p>To that end, <strong>is it possible to ensure that within the execution context, only the methods of the DSL (and what's specifically been allowed) are available and that calls to other things will just not do anything or error?</strong></p>\n\n<p>The code used in the example is:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class OrdersDsl\n  def initialize\n    @orders = { to_perform: [], to_schedule: [] }.freeze\n  end\n\n  def parse(order_filename)\n    instance_eval File.read(order_filename)\n  end\n\n  private\n\n  def order_now(order_name, *order_options)\n    @orders[:to_perform] &lt;&lt; serialize_order(order_name, *order_options)\n  end\n\n  def schedule(order_name, *order_options)\n    @orders[:to_schedule] &lt;&lt; serialize_order(order_name, *order_options)\n  end\n\n  def serialize_order(name, *options)\n    [name, *options]\n  end\n\n  def OrdersDsl.run(order_filename = 'Orders')\n    OrdersDsl.new.parse(order_filename)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "parameter-passing"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1555406767, "post_id": 55704482, "comment_id": 98090548, "body": "<code>:something != &quot;something&quot;</code>. One is a <code>Symbol</code>, the other is a <code>String</code>."}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 7445342, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eh0s6.jpg?s=128&g=1", "display_name": "SiGe", "link": "https://stackoverflow.com/users/7445342/sige"}, "edited": false, "score": 0, "creation_date": 1555411857, "post_id": 55704539, "comment_id": 98093656, "body": "And a not to myself: <code>&quot;something&quot;</code> isn&#39;t working. Just <code>&#39;something&#39;</code>."}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 2, "last_activity_date": 1555405870, "last_edit_date": 1555405870, "creation_date": 1555405813, "answer_id": 55704539, "question_id": 55704482, "link": "https://stackoverflow.com/questions/55704482/how-to-pass-an-optional-method-parameter-as-string-in-ruby/55704539#55704539", "title": "How to pass an optional method parameter as string in Ruby", "body": "<p>It doesn't work because you are sending <code>symbol</code> (<code>:something</code>) instead of <code>string</code> key (<code>'something'</code>). They are different objects.</p>\n\n<p>Change:</p>\n\n<pre><code>method(\"param1\", \"param2\", :something =&gt; true)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>method(\"param1\", \"param2\", 'something' =&gt; true)\n\n</code></pre>\n\n<p>or handle in method by <code>if options[:something]</code></p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1555411232, "creation_date": 1555411232, "answer_id": 55706244, "question_id": 55704482, "link": "https://stackoverflow.com/questions/55704482/how-to-pass-an-optional-method-parameter-as-string-in-ruby/55706244#55706244", "title": "How to pass an optional method parameter as string in Ruby", "body": "<p>Call your method with the same param type, or if you want to be able to pass either symbol or string key you can handle that in your method.</p>\n\n<pre><code>def foo(a,b, opt={})\n  if opt[:something] || opt['something']\n    puts 'something'\n  end\nend\n</code></pre>\n\n<p>Now you can call this with string or symbol keys:</p>\n\n<pre><code>foo('a','b', 'something' =&gt; true )\n#or \nfoo('a','b', something: true )\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 7445342, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eh0s6.jpg?s=128&g=1", "display_name": "SiGe", "link": "https://stackoverflow.com/users/7445342/sige"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 55704539, "answer_count": 2, "score": 0, "last_activity_date": 1555411232, "creation_date": 1555405641, "question_id": 55704482, "link": "https://stackoverflow.com/questions/55704482/how-to-pass-an-optional-method-parameter-as-string-in-ruby", "title": "How to pass an optional method parameter as string in Ruby", "body": "<p>I would like to call a method in Ruby, which has an optional parameter. </p>\n\n<p>I tried some ways, but none of them is working. \nCan you help me, how can I call this method?\nI never used Ruby before, so please help me refine the question itself. I tried to googling the problem, but I think I use the wrong terms.</p>\n\n<p>I read this: <a href=\"https://stackoverflow.com/questions/10234406/ruby-methods-and-optional-parameters\">Ruby Methods and Optional parameters</a> and this: <a href=\"https://stackoverflow.com/questions/35747905/a-method-with-an-optional-parameter\">A method with an optional parameter</a>, but with no luck.</p>\n\n<p>The method looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def method(param1, param2, options={})\n\n    ...\n\n    if options[\"something\"]\n        ...\n    end\n\n    ...\n\nend\n</code></pre>\n\n<p>I tried the call, for example, like this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>method(\"param1\", \"param2\", :something =&gt; true)\n</code></pre>\n\n<p>With my tries the code is runs, but does not enter in the <code>if</code> condition.\nI would like to call this method in the way, that the codes in the <code>if</code> statement would be run.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "iteration", "prawn"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10778804, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8U64XI4JQ2Q/AAAAAAAAAAI/AAAAAAAAABw/l671muj_mIo/photo.jpg?sz=128", "display_name": "Digital Spartan", "link": "https://stackoverflow.com/users/10778804/digital-spartan"}, "edited": false, "score": 0, "creation_date": 1555404395, "post_id": 55703935, "comment_id": 98089100, "body": "You write &quot;def deltakere_rows(course)&quot;.  How would you pass &quot;course&quot; from the &quot;@courses.each do&quot; iteration from the header to the table?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 3, "user_id": 10778804, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8U64XI4JQ2Q/AAAAAAAAAAI/AAAAAAAAABw/l671muj_mIo/photo.jpg?sz=128", "display_name": "Digital Spartan", "link": "https://stackoverflow.com/users/10778804/digital-spartan"}, "edited": false, "score": 0, "creation_date": 1555404501, "post_id": 55703935, "comment_id": 98089161, "body": "My pleasure! :)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 0, "last_activity_date": 1555404005, "creation_date": 1555404005, "answer_id": 55703935, "question_id": 55703749, "link": "https://stackoverflow.com/questions/55703749/prawn-how-to-iterate-from-a-table-inside-an-iteration-in-the-header/55703935#55703935", "title": "Prawn: How to iterate from a table inside an iteration in the header?", "body": "<p>Does a partecipation contain a course reference? If so, it could be something like this</p>\n\n<pre><code>def deltakere_rows(course)\n  [[\"ID\", \"Name\"]] +\n    @participations.select do |p|\n      p.course_id == course.id\n    end.map do |p|\n      [p.participant.id, p.participant.full_name]\n    end\nend\n</code></pre>\n\n<p>And pass the course to <code>deltakere_rows</code></p>\n\n<pre><code>table deltakere_rows(course) do\n  self.header = true\nend\n</code></pre>\n\n<p>This could be the idea with the info we have</p>\n"}], "owner": {"reputation": 3, "user_id": 10778804, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8U64XI4JQ2Q/AAAAAAAAAAI/AAAAAAAAABw/l671muj_mIo/photo.jpg?sz=128", "display_name": "Digital Spartan", "link": "https://stackoverflow.com/users/10778804/digital-spartan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55703935, "answer_count": 1, "score": 0, "last_activity_date": 1555404005, "creation_date": 1555403368, "question_id": 55703749, "link": "https://stackoverflow.com/questions/55703749/prawn-how-to-iterate-from-a-table-inside-an-iteration-in-the-header", "title": "Prawn: How to iterate from a table inside an iteration in the header?", "body": "<p>I pass 3 @course ID's to courses.pdf. \nThen Prawn generates a PDF of 3 pages - one course pr page.</p>\n\n<p>The problem: currently it prints all @participants from all 3 courses in all 3 pages.</p>\n\n<p>It should only print the @participants for the current course in a table.</p>\n\n<p>I have spend several hours trying different methods, asked in Facebook groups and searched Stackoverflow + Google for solutions.</p>\n\n<pre><code>class CoursesToPrintPdf &lt; Prawn::Document\n\n    def initialize(courses, participations)\n        @courses = courses\n        @participations = participations\n        header\n    end\n\n    def header\n        @courses.order('day ASC').each do |course|\n\n            text_box(\"#{course.course_day_pdf}\",\n            :align =&gt; :right)\n            text \"#{course.round.round_name_simple}\"\n\n            table deltakere_rows do\n                self.header = true\n            end\n        end\n    end\n\n    def deltakere_rows\n        [[\"ID\", \"Name\"]] +\n        @participations.map do |p|\n            [p.participant.id, p.participant.full_name]\n        end\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "edited": false, "score": 1, "creation_date": 1555402221, "post_id": 55701885, "comment_id": 98087895, "body": "Can you please check<code>puts options[:autocomplete]</code> what it returns"}, {"owner": {"reputation": 105, "user_id": 2377414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f063ba9681f796b0a5489c9a099044db?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/2377414/justin"}, "reply_to_user": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "edited": false, "score": 0, "creation_date": 1555457249, "post_id": 55701885, "comment_id": 98116036, "body": "@sk1712 I&#39;ve added it to the post."}], "owner": {"reputation": 105, "user_id": 2377414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f063ba9681f796b0a5489c9a099044db?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/2377414/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1555457272, "creation_date": 1555396272, "last_edit_date": 1555457272, "question_id": 55701885, "link": "https://stackoverflow.com/questions/55701885/updated-to-rails-4-0-getting-error-no-implicit-conversion-of-symbol-into-integ", "title": "Updated to Rails 4.0, getting error: no implicit conversion of Symbol into Integer", "body": "<p>Upgraded gems (Rails 4.0 from Rails 3.2) and now am facing an error. This is the line causing the problem.</p>\n\n<pre><code>options[:autocomplete] ||= 'off'\n</code></pre>\n\n<p>options[:autocomplete] specifically is throwing the error when I use binding.pry.\nIt seems that the a string is getting passed in as 'options', but this code is also used for hashes. The code worked fine before I upgraded to Rails 4.0 and upgraded a number of gems and deprecated code.</p>\n\n<p>Another error that's related is 2 lines down: </p>\n\n<pre><code>label(name, options.delete(:label), :class =&gt; 'control-label')\n</code></pre>\n\n<p>which throws the error: wrong number of arguments (3 for 1..2).\nBoth errors are from ActionView::Template::Error.</p>\n\n<p>Here is the full method:</p>\n\n<pre><code>def #{selector}(name, options = {})\n        options[:autocomplete] ||= 'off' #options = String ('Property')\n        @template.content_tag(:div,\n            label(name, options.fetch(:label, {}), :class =&gt; 'control-label') +          \n            @template.content_tag(:div,\n            super(name, options_with_errors(name, options)),\n          :class =&gt; 'controls'),\n        :class =&gt; class_with_errors(name, 'control-group'))\n      end\n</code></pre>\n\n<p>I have changed options.delete to options.fetch as suggested in an answer by someone on the site.</p>\n\n<p>I have also tried commenting parts out to test and changing parts of it, but it either throws more errors or removes large parts of the webpage form. E.g. When I remove one of the arguments in 'label()', I get the error: stack level too deep.</p>\n\n<p>And here is my gemlist:</p>\n\n<pre><code> $\ue0b0 bundle list\nGems included by the bundle:\n  * actionmailer (4.0.0)\n  * actionpack (4.0.0)\n  * activemodel (4.0.0)\n  * activerecord (4.0.0)\n  * activerecord-deprecated_finders (1.0.4)\n  * activesupport (4.0.0)\n  * addressable (2.3.6)\n  * annotate (2.6.3)\n  * arel (4.0.2)\n  * authlogic (3.4.1)\n  * autoparse (0.3.3)\n  * awesome_print (1.2.0)\n  * aws-eventstream (1.0.2)\n  * aws-partitions (1.149.0)\n  * aws-sdk (1.38.0)\n  * aws-sdk-core (3.48.3)\n  * aws-sdk-kms (1.16.0)\n  * aws-sdk-s3 (1.36.0)\n  * aws-sigv4 (1.1.0)\n  * bcrypt (3.1.7)\n  * bcrypt-ruby (3.1.5)\n  * builder (3.1.4)\n  * bundler (1.17.3)\n  * capybara (2.2.1)\n  * celluloid (0.15.2)\n  * celluloid-io (0.15.0)\n  * ckeditor (4.0.6 f0d175a)\n  * climate_control (0.0.3)\n  * cocaine (0.5.4)\n  * coderay (1.1.0)\n  * coffee-rails (4.2.2)\n  * coffee-script (2.4.1)\n  * coffee-script-source (1.12.2)\n  * concurrent-ruby (1.1.5)\n  * daemons (1.1.9)\n  * dalli (2.7.0)\n  * database_cleaner (1.2.0)\n  * delayed_job (4.0.1)\n  * delayed_job_active_record (4.0.1)\n  * diff-lcs (1.2.5)\n  * dotenv (0.7.0)\n  * erubis (2.7.0)\n  * eventmachine (1.0.3)\n  * exception_notification (4.0.1)\n  * execjs (2.7.0)\n  * extlib (0.9.16)\n  * factory_girl (4.4.0)\n  * factory_girl_rails (4.4.1)\n  * faraday (0.9.0)\n  * ffi (1.9.0)\n  * ffi-compiler (0.1.3)\n  * font_assets (0.1.11)\n  * foreigner (1.6.1)\n  * foreman (0.64.0)\n  * formatador (0.2.4)\n  * google-api-client (0.7.1)\n  * grocer (0.5.0)\n  * guard (2.6.0)\n  * guard-rspec (4.2.8)\n  * haml (4.0.5)\n  * haml-rails (0.4)\n  * heroku-rglpk (0.2.1 760859c)\n  * hike (1.2.3)\n  * i18n (0.9.5)\n  * jmespath (1.4.0)\n  * jquery-rails (3.1.0)\n  * jquery-ui-rails (4.2.1)\n  * json (1.8.6)\n  * jwt (0.1.11)\n  * launchy (2.4.2)\n  * listen (2.7.1)\n  * lumberjack (1.0.5)\n  * mail (2.5.5)\n  * memcachier (0.0.2)\n  * method_source (0.8.2)\n  * mime-types (1.25.1)\n  * mini_portile (0.5.3)\n  * minitest (4.7.5)\n  * multi_json (1.13.1)\n  * multipart-post (2.0.0)\n  * newrelic_rpm (3.7.3.204)\n  * nio4r (1.2.1)\n  * nokogiri (1.6.1)\n  * oauth (0.5.3)\n  * orm_adapter (0.5.0)\n  * paperclip (3.5.4)\n  * pg (0.17.1)\n  * pg_array_parser (0.0.9)\n  * polyglot (0.3.5)\n  * postgres_ext (3.0.1)\n  * protected_attributes (1.0.3)\n  * pry (0.9.12.6)\n  * quiet_assets (1.0.2)\n  * rack (1.5.5)\n  * rack-cors (0.2.9)\n  * rack-test (0.6.3)\n  * rails (4.0.0)\n  * rails_12factor (0.0.2)\n  * rails_serve_static_assets (0.0.2)\n  * rails_stdout_logging (0.0.3)\n  * railties (4.0.0)\n  * rake (12.3.2)\n  * rb-fsevent (0.9.4)\n  * rb-inotify (0.9.3)\n  * request_store (1.0.5)\n  * retriable (1.4.1)\n  * rspec (2.14.1)\n  * rspec-core (2.14.8)\n  * rspec-expectations (2.14.5)\n  * rspec-mocks (2.14.6)\n  * rspec-rails (2.14.2)\n  * rubyzip (1.1.7)\n  * sass (3.4.25)\n  * sass-rails (5.0.7)\n  * scrypt (1.2.1)\n  * shortener (0.3.0)\n  * signet (0.5.0)\n  * slop (3.5.0)\n  * spork (0.9.2)\n  * sprockets (2.12.5)\n  * sprockets-rails (2.0.1)\n  * strip_attributes (1.5.1)\n  * thin (1.6.2)\n  * thor (0.20.3)\n  * thread_safe (0.3.6)\n  * tilt (1.4.1)\n  * timers (1.1.0)\n  * treetop (1.4.15)\n  * trim_blobs (0.0.1)\n  * twilio-ruby (3.11.5)\n  * tzinfo (0.3.55)\n  * uglifier (2.5.0)\n  * uuidtools (2.1.4)\n  * xeroizer (2.16.5)\n  * xpath (2.0.0)\n  * yui-compressor (0.12.0)\n</code></pre>\n\n<p>This is what I get when I use pry:</p>\n\n<pre><code>[1] pry(#&lt;BootstrapFormBuilder&gt;)&gt; options\n=&gt; {:class=&gt;\"span12\"}\n[2] pry(#&lt;BootstrapFormBuilder&gt;)&gt; options[:autocomplete]\n=&gt; nil\n[3] pry(#&lt;BootstrapFormBuilder&gt;)&gt; options[:autocomplete] ||= 'off'\n=&gt; \"off\"\n[4] pry(#&lt;BootstrapFormBuilder&gt;)&gt; options.class\n=&gt; Hash\n[5] pry(#&lt;BootstrapFormBuilder&gt;)&gt; :autocomplete\n=&gt; :autocomplete\n[6] pry(#&lt;BootstrapFormBuilder&gt;)&gt; :autocomplete.class\n=&gt; Symbol\n[7] pry(#&lt;BootstrapFormBuilder&gt;)&gt; autocomplete\nNameError: undefined local variable or method `autocomplete' for #&lt;BootstrapFormBuilder:0x007ffe1030c878&gt;\nfrom (pry):7:in `text_field'\n[8] pry(#&lt;BootstrapFormBuilder&gt;)&gt; options[:autocomplete].clas\nNoMethodError: undefined method `clas' for \"off\":String\nfrom (pry):8:in `text_field'\n[9] pry(#&lt;BootstrapFormBuilder&gt;)&gt; options[:autocomplete].class\n=&gt; String\n</code></pre>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555380657, "post_id": 55699423, "comment_id": 98080955, "body": "Your criterion for matching the first line is reflected in your regex. What is your criterion for matching the second line? For example, must it start with letters, then spaces then digits, then spaces, then more digits, or must it end with two times separated by a space, or something else? Please edit to explain your matching criterion for the second line"}], "answers": [{"tags": [], "owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "is_accepted": false, "score": 1, "last_activity_date": 1555480425, "last_edit_date": 1555480425, "creation_date": 1555380388, "answer_id": 55699572, "question_id": 55699423, "link": "https://stackoverflow.com/questions/55699423/using-regex-on-a-file-to-pull-data-out-having-issues-with-multi-line/55699572#55699572", "title": "Using regex on a file to pull data out. Having issues with multi-line", "body": "<p>Your current regex:</p>\n\n<pre><code>^.*?\\d{4}\\s+[A-Z]+\\s+\\d{3}.+$\n</code></pre>\n\n<p>matches in this order:</p>\n\n<ul>\n<li>the  beginning of the line (<code>^</code>)</li>\n<li>zero or more characters non-greedy <code>.*?</code></li>\n<li>four digits (<code>\\d{4}</code>)</li>\n<li>one or more spaces (<code>\\s+</code>)</li>\n<li>one or more capital letters (<code>[A-Z]+</code>)</li>\n<li>one or more spaces</li>\n<li><strong>three digits</strong> (<code>\\d{3}</code>)</li>\n<li>one or more characters (<code>.+</code>)</li>\n<li>the end of the line (<code>$</code>)</li>\n</ul>\n\n<p>The second line of your file is:</p>\n\n<pre><code>Somestuff 011 0145  MTWTh      12:30P  1:30P\n</code></pre>\n\n<p>starts matching <code>0145  MTWT</code> but then fails to match <code>\\d{3}</code> </p>\n"}, {"tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": false, "score": 1, "last_activity_date": 1555381064, "creation_date": 1555381064, "answer_id": 55699641, "question_id": 55699423, "link": "https://stackoverflow.com/questions/55699423/using-regex-on-a-file-to-pull-data-out-having-issues-with-multi-line/55699641#55699641", "title": "Using regex on a file to pull data out. Having issues with multi-line", "body": "<p>Try something like this: the <code>\\n</code> captures the new line, and you can apply your own rules to capture anything you want which comes after <code>\\n</code> - see below pls:</p>\n\n<pre><code>^.*\\d{4}\\s+[A-Z]+\\s+\\d{3}.+\\n.*$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1555397929, "last_edit_date": 1555397929, "creation_date": 1555383317, "answer_id": 55699908, "question_id": 55699423, "link": "https://stackoverflow.com/questions/55699423/using-regex-on-a-file-to-pull-data-out-having-issues-with-multi-line/55699908#55699908", "title": "Using regex on a file to pull data out. Having issues with multi-line", "body": "<p>I've made an arbitrary assumption about the requirements for matching the second line. It is more demanding than the requirements for matching the first that are reflected in your regex, but I thought the additional complexity would have some educational value for you.</p>\n\n<p>Here is a regular expression (untested) for matching both lines. Note you don't need <code>^.*?</code> at the beginning of the regex and for the part of the regex that matches the first line <code>.+$</code> adds nothing, so I removed it. After all you are just matching each line separately (<code>line</code>), and will display the entire line if there's a match. As well, the end-of-string anchor <code>\\z</code> is more appropriate than the end-of-line anchor (<code>$</code>), though either can be used.</p>\n\n<pre><code>r = /\n    (?:             # begin non-capture group   \n      \\d{4}         # match 4 digits\n      \\s+           # match &gt; 0 whitespaces\n      [A-Z]+        # match &gt; 0 uppercase letters\n      \\s+           # match &gt; 0 whitespaces\n      \\d{3}         # match 3 digits\n    |               # or\n      \\b            # match a (zero-width) word break\n      [A-Z]         # match 1 uppercase letter\n      [a-z]*        # match &gt;= 0 lowercase letter\n      \\s+           # match &gt; 0 whitespaces\n      \\d{3}         # match 3 digits\n      \\s+           # match &gt; 0 whitespaces\n      \\d{4}         # match 4 digits\n      \\s+           # match &gt; 0 whitespaces\n      [A-Za-z]+     # match &gt; 0 letters\n      (?:           # begin non-capture group\n        \\s+         # match &gt; 0 whitespaces\n        (?:         # begin a non-capture group\n          0\\d       # match 0 followed by any digit\n        |           # or\n          1[012]    # match 1 followed by 0, 1 or 2\n        )           # end non-capture group\n        :           # match a colon\n        [0-5][0-9]  # match 0-5 followed by 0-9     \n      ){2}          # end non-capture group and execute twice\n    )               # end non-capture group  \n    /x              # free-spacing regex definition mode\n</code></pre>\n\n<p>This regular expression is conventionally written as follows.</p>\n\n<pre><code>r = /(?:\\d{4}\\s+[A-Z]+\\s+\\d{3}|\\b[A-Z][a-z]*\\s+\\d{3}\\s+\\d{4}\\s+[A-Za-z]+(?:\\s+(?:0\\d|1[012]):[0-5][0-9]){2})/\n</code></pre>\n\n<p>You might go through the file <code>puts</code>ing matching lines as follows:</p>\n\n<pre><code>File.foreach(fname) { |line| puts line if line.match? r }\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a>, which is a very convenient method for reading files line-by-line. Note <code>IO</code> class methods (such <code>foreach</code>) are commonly invoked with <code>File</code> as their receiver. That's OK, as <code>File.superclass #=&gt; IO</code>, so <code>File</code> inherits those methods from <code>IO</code>.</p>\n\n<p>When used without a block <code>foreach</code> returns an enumerator, which is often convenient as well. If, for example, you wished to return an array of matching lines (rather than <code>puts</code> them), you could write:</p>\n\n<pre><code>File.foreach(fname).with_object([]) do |line, arr|\n  arr &lt;&lt; line.chomp if line.match? r\nend\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10621442, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dPv1aJqdw7I/AAAAAAAAAAI/AAAAAAAABpA/t4PCNz4YscU/photo.jpg?sz=128", "display_name": "Jem", "link": "https://stackoverflow.com/users/10621442/jem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1555480425, "creation_date": 1555379100, "last_edit_date": 1555379921, "question_id": 55699423, "link": "https://stackoverflow.com/questions/55699423/using-regex-on-a-file-to-pull-data-out-having-issues-with-multi-line", "title": "Using regex on a file to pull data out. Having issues with multi-line", "body": "<p>I am looking to get to the next line of data within a text file. Here is an example of data from the file I am working with. </p>\n\n<pre><code>0519 ABF   244  AN        A1  ADV STUFF    1.0  2.0 Somestuff 018 0155  MTWTh      10:30A 11:30A    20     20     0  6.7                                                           \nSomestuff 011 0145  MTWTh      12:30P  1:30P\n</code></pre>\n\n<p>I have been trying to move to the next line by utilizing a variety of code such as.. carriage return \\n using \\s+ to replace the large space after 6.7. using m like so //m  not finding a result just yet.</p>\n\n<p>Here is some example code</p>\n\n<pre><code>while !regex_file.eof?\nline = regex_file.gets.chomp\nif line =~ ^.*?\\d{4}\\s+[A-Z]+\\s+\\d{3}.+$\nputs line\n  end\nend\n</code></pre>\n\n<p>Using <a href=\"https://rubular.com/\" rel=\"nofollow noreferrer\">https://rubular.com/</a> this particular set of code matches my desired output for the first line </p>\n\n<pre><code>0519 ABF   244  AN        A1  ADV STUFF    1.0  2.0 Somestuff 018 0155  MTWTh      10:30A 11:30A    20     20     0  6.7\n</code></pre>\n\n<p>but does not match and haven't figured out how to match the next line. </p>\n\n<pre><code>Somestuff 011 0145  MTWTh      12:30P  1:30P\n</code></pre>\n"}, {"tags": ["ruby", "mongodb", "ruby-on-rails-3", "puma", "puma-dev"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1555393855, "post_id": 55698999, "comment_id": 98084031, "body": "Is this in development or on production? How do you start your puma server? How does the start script or command look like? Do you use any tools to automatically restart the app server? Why do you think that changing a file named <code>local_env.yml</code> would change ENV variables, do you use a gem or some code that reads that file? How does that file look like? Did you restart the whole server or just the puma instance? In <code>ENV[MONGO]</code> what is <code>MONGO</code>, a constant?"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1555413098, "creation_date": 1555413098, "answer_id": 55706830, "question_id": 55698999, "link": "https://stackoverflow.com/questions/55698999/how-can-i-found-out-were-my-ror-app-is-getting-its-env-variables/55706830#55706830", "title": "How can I found out were my ROR app is getting its ENV variables", "body": "<p>There is nothing specific in ruby to find out where environment variables are set because they are <a href=\"https://superuser.com/questions/284342/what-are-path-and-other-environment-variables-and-how-can-i-set-or-use-them\">ENVIRONMENT VARIABLES</a> so first understand what that means.</p>\n\n<p>You could try to grep recursive </p>\n\n<pre><code>grep -rnw 'base/path/to/search/' -e 'MONGO'\n</code></pre>\n\n<p>There may be other ways to hunt them down depending on what shell you use. But if they are loaded from a file that is not loaded by the shell, but by your ruby app i.e. a yaml file , these may not help you. \n For more info see <a href=\"https://unix.stackexchange.com/questions/813/how-to-determine-where-an-environment-variable-came-from\">this answer</a></p>\n"}], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55706830, "answer_count": 1, "score": -1, "last_activity_date": 1555413098, "creation_date": 1555375078, "last_edit_date": 1555376401, "question_id": 55698999, "link": "https://stackoverflow.com/questions/55698999/how-can-i-found-out-were-my-ror-app-is-getting-its-env-variables", "title": "How can I found out were my ROR app is getting its ENV variables", "body": "<p>I took over a ROR app and I have changed ENV vars in <code>local_env.yml</code> and in .env to point to a new MongoDB server on MongoDB Atlas and away from MLab.However, the app is still hitting the db on MLab. </p>\n\n<p>So I also did the following:</p>\n\n<ol>\n<li>I checked the computer and there were the same ENV in <code>bash_profile</code>, which I have changed. </li>\n<li>I then did a source <code>~/.bash_profile</code> </li>\n<li>I restarted Puma but the app is still using Mlab DB which is reached via ENV[MONGO].</li>\n</ol>\n\n<p>Is there a way to find out where the app is pulling the ENV variables from?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1555414630, "post_id": 55698902, "comment_id": 98095262, "body": "Where did you see <code>hash.try(:a)</code>? It doesn&#39;t make much sense if <code>hash</code> is indeed a hash. Could it have been <code>hash.dig(:a)</code>?"}, {"owner": {"reputation": 660, "user_id": 4111992, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dJJD7.png?s=128&g=1", "display_name": "catlovespurple", "link": "https://stackoverflow.com/users/4111992/catlovespurple"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1555544926, "post_id": 55698902, "comment_id": 98152545, "body": "@EricDuminil <code>hash.try(:a)</code> is what I typed in irb console to see if I can get value from it."}], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 4111992, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dJJD7.png?s=128&g=1", "display_name": "catlovespurple", "link": "https://stackoverflow.com/users/4111992/catlovespurple"}, "edited": false, "score": 0, "creation_date": 1555375099, "post_id": 55698946, "comment_id": 98079895, "body": "Thanks for your clear response. Just to clarify if I understand correctly -  <code>try</code> views the first passed argument as a <code>method</code>, and the second, third and following arguments as the input params for the <code>first param</code>?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 660, "user_id": 4111992, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dJJD7.png?s=128&g=1", "display_name": "catlovespurple", "link": "https://stackoverflow.com/users/4111992/catlovespurple"}, "edited": false, "score": 0, "creation_date": 1555375159, "post_id": 55698946, "comment_id": 98079913, "body": "Yes, that&#39;s it. <i>Arguments and blocks are forwarded to the method if invoked</i>."}, {"owner": {"reputation": 660, "user_id": 4111992, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dJJD7.png?s=128&g=1", "display_name": "catlovespurple", "link": "https://stackoverflow.com/users/4111992/catlovespurple"}, "edited": false, "score": 0, "creation_date": 1555375933, "post_id": 55698946, "comment_id": 98080031, "body": "Thanks, it helps me understand a lot!"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 4, "last_activity_date": 1555375090, "last_edit_date": 1555375090, "creation_date": 1555374560, "answer_id": 55698946, "question_id": 55698902, "link": "https://stackoverflow.com/questions/55698902/ruby-two-ways-using-try-in-hash/55698946#55698946", "title": "Ruby: two ways using try in Hash", "body": "<pre><code>hash.try(:[], :a)\n# 1\n</code></pre>\n\n<p>Tries to invoke the public method <code>[]</code> on <code>hash</code> passing as <code>:a</code> as argument to <code>[]</code>. As <code>:a</code> is an existing key in the hash, it returns its value.</p>\n\n<pre><code>hash.try(:a)\n# nil\n</code></pre>\n\n<p>Tries to invoke the public method <code>:a</code> on <code>hash</code>. As <code>hash</code> as the receiver doesn't respond to <code>:a</code> then it returns <code>nil</code>.</p>\n\n<p>As a clarification, the arguments for <code>try</code> are as first the method to be invoked on the receiver, and all the other arguments are the arguments for the method being invoked.</p>\n\n<hr>\n\n<p>If your hash could respond to the method <code>:a</code>, <code>hash.try(:a)</code> would return the value of that method being called on <code>hash</code>:</p>\n\n<pre><code># Just for example purposes\nclass Hash; def a; :a_monkey_patched_value_for_a; end\n\nhash.try(:a)\n# :a_monkey_patched_value_for_a\n</code></pre>\n"}], "owner": {"reputation": 660, "user_id": 4111992, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/dJJD7.png?s=128&g=1", "display_name": "catlovespurple", "link": "https://stackoverflow.com/users/4111992/catlovespurple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 55698946, "answer_count": 1, "score": 3, "last_activity_date": 1555375090, "creation_date": 1555374092, "last_edit_date": 1555374791, "question_id": 55698902, "link": "https://stackoverflow.com/questions/55698902/ruby-two-ways-using-try-in-hash", "title": "Ruby: two ways using try in Hash", "body": "<p>I want to extract a value by using <code>try</code> in Ruby.</p>\n\n<p>I found there are two ways of doing this and was playing around with it in irb.</p>\n\n<pre><code>&gt;&gt; hash = { a: 1, b: 2 }\n=&gt; {:a=&gt;1, :b=&gt;2}\n&gt;&gt; hash.try(:a)\n=&gt; nil\n&gt;&gt; hash.try(:[], :a)\n=&gt; 1\n</code></pre>\n\n<p>I have two questions,</p>\n\n<ol>\n<li>What is the difference between <code>hash.try(:[], :a)</code> and <code>hash.try(:a)</code>? I searched around and found people use both ways.</li>\n<li>I saw a lot of places using hash.try(:a) to retrieve values, but why my trial returns nil? </li>\n</ol>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1555369999, "post_id": 55698326, "comment_id": 98078909, "body": "what is the name of the file with the <code>class Run</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1555370386, "last_edit_date": 1555370386, "creation_date": 1555370078, "answer_id": 55698439, "question_id": 55698326, "link": "https://stackoverflow.com/questions/55698326/nomethoderror-but-did-require-relative/55698439#55698439", "title": "NoMethodError but did &#39;require_relative&#39;", "body": "<p>You required the file, but in that file you have a class definition. <code>separate</code> is inside that class (and that's an instance method), so you need an object to call the method on.</p>\n\n<pre><code>separated = Run.new.separate(to_separate)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": true, "score": 0, "last_activity_date": 1555370288, "creation_date": 1555370288, "answer_id": 55698457, "question_id": 55698326, "link": "https://stackoverflow.com/questions/55698326/nomethoderror-but-did-require-relative/55698457#55698457", "title": "NoMethodError but did &#39;require_relative&#39;", "body": "<p>In order to call the method within the class Run you have to instantiate it. Since is an instance method. The way your calling the class is giving you the error <code>undefined</code> because it can not find it with in the scope of your current file</p>\n\n<pre><code>run_instance = Run.new \nto_separate = IO.readlines(ARGV[0])\nsperated = run_instance.separate(to_separate)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9430798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6rtA.png?s=128&g=1", "display_name": "Terry Yen", "link": "https://stackoverflow.com/users/9430798/terry-yen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 55698457, "answer_count": 2, "score": 0, "last_activity_date": 1555370386, "creation_date": 1555369247, "question_id": 55698326, "link": "https://stackoverflow.com/questions/55698326/nomethoderror-but-did-require-relative", "title": "NoMethodError but did &#39;require_relative&#39;", "body": "<p>I did the 'requir_relative' but still got the NoMethodError.</p>\n\n<p>There are 2 ruby files, under 'run.rb' I have this</p>\n\n<pre><code>class Run\n  def separate(data)\n    hash_block = []\n    (0...data.count).each do |i|\n      f = data[i].split('|')\n      hash_block[i] = Hashing.new(f[0].to_i, f[1], f[2], f[3], f[4])\n    end\n    hash_block\n  end\nend\n</code></pre>\n\n<p>and then in the main file, I did these:</p>\n\n<pre><code>require_relative 'run'\n\n...some codes...\n\nto_separate = IO.readlines(ARGV[0])\nseparated = separate(to_separate)\n\n...some codes...\n</code></pre>\n\n<p>but I still get this:</p>\n\n<pre><code>in `block in &lt;main&gt;': undefined method `separate' for main:Object (NoMethodError)\n</code></pre>\n\n<p>If I cut the method and paste it in the main file it will work as expected but that is something I wanted to avoid.</p>\n"}, {"tags": ["ruby", "oop", "object"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1555368800, "post_id": 55698143, "comment_id": 98078635, "body": "<code>initialize</code> is a private instance method. After assigning the value of <code>name</code> to <code>@name</code> you can refer to <code>@name</code> within <code>initialize</code>. For example, <code>if @name == &quot;Suzie&quot; ...</code>."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555368638, "post_id": 55698158, "comment_id": 98078595, "body": "I think the OP is just looking for <code>@name</code>."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1555368806, "post_id": 55698158, "comment_id": 98078636, "body": "I&#39;m not sure @CarySwoveland. Let&#39;s see what the OP says"}, {"owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 0, "creation_date": 1555370403, "post_id": 55698158, "comment_id": 98078995, "body": "Thanks @Ursus. Could you try to answer my other questions in your answer. Also, why is it not possible to use conventional dot notation such as <code>test = TestClass.new(&#39;Foo&#39;); puts test.initialize;</code> like in the case of a normal getter method."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1555370529, "post_id": 55698158, "comment_id": 98079019, "body": "You can&#39;t call <code>initialize</code> directly. It&#39;s a special method. It&#39;s called when you call <code>new</code> on a class."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1555370573, "post_id": 55698158, "comment_id": 98079031, "body": "The <code>initialize</code> method doesn&#39;t even have a return value"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1555481112, "post_id": 55698158, "comment_id": 98121404, "body": "@Ursus you can <code>return</code> from initialize, but the return value is not used for anything normally. <code>send(:initialize)</code> or calling it from inside the class will give the return value like any method."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1555369195, "last_edit_date": 1555369195, "creation_date": 1555368000, "answer_id": 55698158, "question_id": 55698143, "link": "https://stackoverflow.com/questions/55698143/accessing-an-instance-variable-within-the-initialize-method/55698158#55698158", "title": "Accessing an instance variable within the `initialize` method", "body": "<p>Yes, there is a way. But it's not a traditional one. It's more like querying the object to know</p>\n\n<pre><code>TestClass.new(\"foo\").instance_variable_get(:@name)\n=&gt; \"foo\"\n</code></pre>\n\n<p>The <code>initialize</code> method does not \"cease to exsist\". It's executed, that's it. What your method do, in your case, is that the variable is set. </p>\n"}, {"comments": [{"owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 0, "creation_date": 1555452957, "post_id": 55703690, "comment_id": 98115019, "body": "Thanks for your extremely thorough and brilliant answer Kimmo. Could I just ask for additional context around &#39;why&#39; the <code>send</code> method is required/necessary to access a private instance method such as <code>initialize</code>? I know you receive a <code>NoMethodError</code> otherwise, but could you explain what <code>send</code> method does that allows you to access the <code>initialize</code> method from outside the class. Thanks."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 0, "creation_date": 1555480547, "post_id": 55703690, "comment_id": 98121179, "body": "Ruby 1.9 was going to make <code>send</code> act like <code>public_send</code> which only allows access to public methods, there was supposed to be <code>funccall</code> for calling private methods if you really want to (for unit testing purposes perhaps?). I don&#39;t know why it was left that way."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 2, "last_activity_date": 1555480971, "last_edit_date": 1555480971, "creation_date": 1555403183, "answer_id": 55703690, "question_id": 55698143, "link": "https://stackoverflow.com/questions/55698143/accessing-an-instance-variable-within-the-initialize-method/55703690#55703690", "title": "Accessing an instance variable within the `initialize` method", "body": "<p>The \"getter method\" is defined so that you can use the variable from outside the class:</p>\n\n<pre><code>class TestClass\n  attr_reader :name\n\n  def initialize(name)\n    @name = name\n  end\nend\n# TestClass.new('Ben').name  # =&gt; 'Ben'\n</code></pre>\n\n<p>If you don't need to access it from outside the class, you can just use <code>@name</code>:</p>\n\n<pre><code>class TestClass\n  def initialize(name)\n    @name = name\n  end\n\n  def greet\n    puts \"Hello, %s\" % @name\n  end\nend\n# TestClass.new('Ben').greet # outputs: Hello, Ben\n</code></pre>\n\n<p>You can use the <code>@name</code> inside initialize:</p>\n\n<pre><code>class TestClass\n  def initialize(name)\n    @name = name\n    puts \"Name backwards: %s\" % @name.reverse\n  end\nend\n# TestClass.new('Ben') # outputs neB\n</code></pre>\n\n<p>Initialize is a special method, when you define <code>initialize</code> instance method, it is automatically marked <code>private</code>. The class method <code>new</code> calls it after creating an instance of your class.</p>\n\n<p>Nothing stops you from calling private methods from inside the class:</p>\n\n<pre><code>class TestClass\n  def initialize(name)\n    @name = name\n    puts \"Name is now %s\" % @name\n  end\n\n  def flip_name\n    initialize(@name.reverse)\n  end\nend\n# t = TestClass.new('Ben') # outputs \"Name is now Ben\"\n# t.flip_name # outputs \"Name is now neB\"\n# t.instance_variable_get(:@name) # =&gt; 'neB'\n</code></pre>\n\n<p>The <code>flip_name</code> method that calls <code>initialize</code> works just fine, but of course this is quite unconventional and almost never used, because it does not make much sense.</p>\n\n<p>It's possible to call private methods from outside the class using <code>send</code>:</p>\n\n<pre><code># t.send(:initialize, 'Bill') # outputs \"Name is now Bill\"\n# t.instance_variable_get(:@name) # =&gt; 'Bill'\n</code></pre>\n\n<p>Without send, you get <code>NoMethodError</code>:</p>\n\n<pre><code>&gt; t.initialize('Jack')\nNoMethodError: private method `initialize' called for #&lt;TestClass:0x00007fa2df8e4570&gt;\n</code></pre>\n\n<p>Ruby 1.9 beta releases changed <code>send</code> to act like <code>public_send</code> does today, allowing access to only public methods and there was going to be <code>funccall</code> for calling private methods if you really want to, for unit testing purposes for example. I think it caused too much compatibility issues and the change was reverted.</p>\n\n<p>So in conclusion, yes, you can call <code>initialize</code> again and it does not cease to exist, but it is almost never done because it makes very little sense. To access instance variables from inside the class, you use <code>@</code> notation like <code>@name</code>, to access them from outside of the class, you define a getter.</p>\n"}], "owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 55703690, "answer_count": 2, "score": 2, "last_activity_date": 1555480971, "creation_date": 1555367810, "last_edit_date": 1555453066, "question_id": 55698143, "link": "https://stackoverflow.com/questions/55698143/accessing-an-instance-variable-within-the-initialize-method", "title": "Accessing an instance variable within the `initialize` method", "body": "<p>Given this basic class in Ruby:</p>\n\n<pre><code>class TestClass\n  def initialize(name)\n    @name = name\n  end\nend\n</code></pre>\n\n<p>How do I then access the instance variable name directly from within the <code>initialize</code> method without creating a getter function? is this even possible? (i.e. using dot notation) or does the <code>initialize</code> method cease to exist once a class is instantiated, hence the need to define a getter method?</p>\n\n<p>I think what I'm trying to ask is <code>initialize</code> a class or instance method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1555368634, "post_id": 55697852, "comment_id": 98078592, "body": "What did you upgrade from ? Also maybe, if your Sendgrid gem was not versioned and been upgraded to match Rails app, some changes have been made and this key deprecated ..."}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1555368836, "post_id": 55697852, "comment_id": 98078645, "body": "Ruby 2.3 and Rails 4.2.11"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1555369219, "post_id": 55697852, "comment_id": 98078737, "body": "Are you sure Sendrig has not been updated from 2.x.x to 3.x.x It seems the syntax has changed to <code>SendGrid:: API</code> (really just a guess as I don&#39;t use Sendgrid)"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1555369313, "post_id": 55697852, "comment_id": 98078766, "body": "Using sendgrid-ruby (5.3.0)"}], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 793, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555369413, "creation_date": 1555366022, "last_edit_date": 1555369413, "question_id": 55697852, "link": "https://stackoverflow.com/questions/55697852/why-is-ruby-erroring-with-argumenterror-unknown-keyword-api-key", "title": "Why is Ruby erroring with ArgumentError (unknown keyword: api_key)", "body": "<p>Just upgraded to:</p>\n\n<pre><code>ruby '2.4.2'\ngem 'rails', '5.0'\n</code></pre>\n\n<p>Trying to test app and getting the following:</p>\n\n<pre><code>ArgumentError (unknown keyword: api_key):\n\napp/models/user.rb:225:in `new'\napp/models/user.rb:225:in `send_approval_code'\napp/models/user.rb:292:in `create_new'\napp/controllers/ms_controller.rb:249:in `create_dude'\n\n\ndef create_dude\nattributes = {}\nif params[:email].blank?\n  render :js =&gt; \"error('email2', 'required');\"\n  return\nelsif params[:phone].blank?\n  render :js =&gt; \"error('phone2', 'required');\"\n  return\nelsif User.where(:email =&gt; params[:email]).count &gt; 0\n  render :js =&gt; \"error('email2', 'already exists');\"\n  return\nelsif !params[:password].blank?\n  if params[:password].length &lt; 6\n    render :js =&gt; \"error('password2', 'must be at least 6 characters');\"\n    return\n  elsif params[:password_confirmation].blank?\n    render :js =&gt; \"error('password_confirmation2', 'required');\"\n    return\n  elsif params[:password] != params[:password_confirmation]\n    render :js =&gt; \"error('password_confirmation2', 'does not match');\"\n    return\n  else\n    attributes[:password] = params[:password]\n  end\nend\nattributes[:email] = params[:email] if params[:email]\nattributes[:password] = params[:password] if params[:password]\nattributes[:password_confirmation] = params[:password] if params[:password]\nattributes[:first_name] = params[:first_name] if params[:first_name]\nattributes[:last_name] = params[:last_name] if params[:last_name]\nattributes[:last_4_soc] = params[:last_4_soc] if params[:last_4_soc]\nattributes[:drivers_license] = params[:drivers_license] if params[:drivers_license]\nattributes[:phone] = params[:phone] if params[:phone]\nattributes[:type] = User::PLOTTER\nattributes[:emrt_id] = @emrt.id.to_s\nattributes[:approved] = true\nattributes[:verified_phone_number] = false\nif @ems.type == Nms::MURSE\n  attributes[:stand_alone_type] = params[:type]\nend\nr = User.create_new(attributes)\nif r[:status] == 'OK'\n  if @ems.type == Nms::MURSE\n    u = User.where(:email =&gt; params[:email]).first\n    u.create_stand_alone_amb(params[:plate_number]) if u\n    u.stand_alone_amb.update_attributes(:icon_color =&gt; params[:color])\n  end\n  render :js =&gt; \"location.reload();\"\nelse\n  render :js =&gt; \"error('email2', 'error. please try again');\"\nend\n</code></pre>\n\n<p>end</p>\n\n<p>The only reference to api_key I see is in SendGrid method.</p>\n\n<pre><code>client = SendGrid::Client.new(api_key: SENDGRID_PROD_KEY)\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I commented out the SendGrid code to see what would happen. Now getting</p>\n\n<pre><code>    ArgumentError (wrong number of arguments (given 1, expected 0)):\n\n    app/models/user.rb:228:in `new'\n    app/models/user.rb:228:in `send_approval_code'\n    app/models/user.rb:292:in `create_new'\n    app/controllers/ms_controller.rb:249:in `create_dude'\n</code></pre>\n"}, {"tags": ["ruby", "factory-bot"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1555365339, "post_id": 55697645, "comment_id": 98077772, "body": "Do you have one factory calling another factory, and so on? Fixtures are faster, but they will probably take a lot of work to replace your factories"}, {"owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "edited": false, "score": 0, "creation_date": 1555389509, "post_id": 55697645, "comment_id": 98082771, "body": "Heavy factory cascades and heavy validations / callbacks are usually the pain point. To be really sure, you might want to profile your tests, see <a href=\"https://evilmartians.com/chronicles/testprof-a-good-doctor-for-slow-ruby-tests\" rel=\"nofollow noreferrer\">this article</a>."}], "owner": {"reputation": 27022, "user_id": 182693, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7e4422dd860fce9b9f3c024c8655c7d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/182693/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555364657, "creation_date": 1555364657, "question_id": 55697645, "link": "https://stackoverflow.com/questions/55697645/factorybot-create-function-takes-a-really-long-time", "title": "FactoryBot create function takes a really long time", "body": "<p>I work in a codebase that makes extensive use of FactoryBot to create test objects.  I recently timed how long it took to create some instances of our most commonly-used class, and found that it's on the order of 0.2 seconds apiece.  Some of my tests create around 100 objects, so that's a substantial time sink.</p>\n\n<p>Why might object creation be taking so long?  Does FactoryBot offer any way to break down the time it spends?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "streaming", "sinatra", "thin"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555363241, "post_id": 55696208, "comment_id": 98077096, "body": "How is this deployed? What web server?"}, {"owner": {"reputation": 1, "user_id": 4402701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0babe4cf6f716dd02b3b73a25539cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4402701/justin"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555365394, "post_id": 55696208, "comment_id": 98077789, "body": "I&#39;ve tried both Thin <a href=\"https://github.com/macournoyer/thin\" rel=\"nofollow noreferrer\">github.com/macournoyer/thin</a> and Puma <a href=\"http://puma.io/\" rel=\"nofollow noreferrer\">puma.io</a>"}], "owner": {"reputation": 1, "user_id": 4402701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0babe4cf6f716dd02b3b73a25539cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4402701/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555357283, "creation_date": 1555357283, "question_id": 55696208, "link": "https://stackoverflow.com/questions/55696208/ruby-sinatra-streaming-via-thin-only-works-locally", "title": "Ruby Sinatra streaming via Thin only works locally", "body": "<p>I'm working on streaming plain text back to the client as outlined in <a href=\"http://sinatrarb.com/contrib/streaming.html\" rel=\"nofollow noreferrer\">http://sinatrarb.com/contrib/streaming.html</a>. It works fine when I curl the page locally, but comes back as one big chunk when I curl remotely.</p>\n\n<p>The Sinatra code is very simple:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>get '/stream-test' do\n  stream do |out|\n    out &lt;&lt; \"message 1\\n\"\n    sleep(1)\n    out &lt;&lt; \"message 2\\n\"\n  end\nend\n</code></pre>\n\n<p>I've tried using thin and puma. Running on an AWS EC2 instance and hitting the Elastic IP address, using the exact same command on both the instance and locally:</p>\n\n<pre><code>$curl -i \"http://&lt;elastic-ip&gt;:8080/stream-test\"\n\nHTTP/1.1 200 OK\nContent-Type: text/html;charset=utf-8\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nSet-Cookie: rack.session=*******; path=/; HttpOnly\nTransfer-Encoding: chunked\n\nmessage 1\nmessage 2\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1555353281, "post_id": 55695087, "comment_id": 98073116, "body": "Why don&#39;t you think that&#39;s correct?"}, {"owner": {"reputation": 2233, "user_id": 529524, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/11ddeb78f3a0fcf0fd0075f522df6888?s=128&d=identicon&r=PG", "display_name": "Ahmed Ali", "link": "https://stackoverflow.com/users/529524/ahmed-ali"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1555353364, "post_id": 55695087, "comment_id": 98073146, "body": "because RatingReason contains now 5 rows only, and i need for every rating to know what user selected from them, i don&#39;t care &amp; don&#39;t need RatingReason"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1555354305, "post_id": 55695087, "comment_id": 98073560, "body": "I think you need to backup a few steps and learn how <a href=\"https://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">assocations work</a> and then decide if you are that is even what you need in the first place. You can&#39;t have a an association between two records without storing the foreign keys somewhere. But this question seems very much like an <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">XY problem</a>."}, {"owner": {"reputation": 2233, "user_id": 529524, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/11ddeb78f3a0fcf0fd0075f522df6888?s=128&d=identicon&r=PG", "display_name": "Ahmed Ali", "link": "https://stackoverflow.com/users/529524/ahmed-ali"}, "edited": false, "score": 0, "creation_date": 1555354614, "post_id": 55695087, "comment_id": 98073698, "body": "They&#39;re known now, but may increase with time, I know Enum, but i don&#39;t think it&#39;s the best solution for my case."}, {"owner": {"reputation": 1692, "user_id": 9288619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6IK38.jpg?s=128&g=1", "display_name": "code_aks", "link": "https://stackoverflow.com/users/9288619/code-aks"}, "edited": false, "score": 0, "creation_date": 1555395510, "post_id": 55695087, "comment_id": 98084676, "body": "If you want to do this then you can achieve by implementing like this :-  <b>belongs_to :rating, optional: true</b> put this association in RatingReason model."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1555418946, "post_id": 55695087, "comment_id": 98097816, "body": "Sounds like you need a join table and a has_many through relationship"}], "owner": {"reputation": 2233, "user_id": 529524, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/11ddeb78f3a0fcf0fd0075f522df6888?s=128&d=identicon&r=PG", "display_name": "Ahmed Ali", "link": "https://stackoverflow.com/users/529524/ahmed-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555352187, "creation_date": 1555352187, "question_id": 55695087, "link": "https://stackoverflow.com/questions/55695087/model-has-many-of-anothe-model-set-of-predefind-values", "title": "Model has_many of anothe model ( Set of predefind values )", "body": "<p>I have two models, <code>Rating</code> &amp; <code>RatingReason</code>, <code>RatingReason</code> will contain a list of static values that may increase with time.</p>\n\n<pre><code>class Rating &lt; ApplicationRecord\n  has_many :rating_reasons\nend\n\nclass RatingReason &lt; ApplicationRecord\n\nend\n</code></pre>\n\n<p>but this doesn't work it says that i have to add <code>rating_id</code> on <code>RatingReason</code> model, but i don't think it's correct or that's not what i need to do, how can i acheive Rating has_many RatingReason without adding <code>rating_id</code> to <code>RatingReason</code> &amp;&amp; get <code>rating_reason_ids</code>?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555351990, "post_id": 55695029, "comment_id": 98072614, "body": "Have a look at your generated source to be sure the value is being substituted properly. Usually <code>var fee = &lt;%= JSON.dump(@user.fees) %&gt;</code> is the safest method to include in JavaScript."}, {"owner": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555354885, "post_id": 55695029, "comment_id": 98073827, "body": "With console debugging tools I was able to check the Values of fee and time. <code>time</code> does get converted to integer but fee is <code>NaN</code>. I don&#39;t get why. It&#39;s a decimal in the DB and all users have 100 set up as a default value. So it&#39;s not like it&#39;s would return null"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555363207, "post_id": 55696275, "comment_id": 98077081, "body": "Putting things in <code>data</code> is usually a much more elegant way of doing this."}], "tags": [], "owner": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "is_accepted": false, "score": 1, "last_activity_date": 1555357552, "creation_date": 1555357552, "answer_id": 55696275, "question_id": 55695029, "link": "https://stackoverflow.com/questions/55695029/js-realtime-calculation-with-ruby-variable/55696275#55696275", "title": "js realtime calculation with ruby variable", "body": "<p>The issue was using the <code>&lt;%= %&gt;</code>erb containers to expose the value.</p>\n\n<p>I had to change the code to use <code>data</code></p>\n\n<pre><code>$(document).ready(function() {\n  $(\".total_time\").keyup(function() {\n    var fees = $('#user_fees').data('source');\n    fee = parseFloat(fees);\n    var time = $('.total_time').val();\n    time = parseInt(time);\n    var total = fees*time\n    $(\".total_charge\").text(total);\n  });\n});\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555357552, "creation_date": 1555351854, "last_edit_date": 1555355783, "question_id": 55695029, "link": "https://stackoverflow.com/questions/55695029/js-realtime-calculation-with-ruby-variable", "title": "js realtime calculation with ruby variable", "body": "<p>I'm trying to display in realtime the total between a ruby variable times an input field populated by a user.</p>\n\n<p>I tried the bellow js but I'm getting <code>NaN</code>.</p>\n\n<pre><code>$(document).ready(function() {\n    $(\".total_time\").keypress(function() {\n        var fee = '&lt;%=@user.fees%&gt;';\n        fee = parseFloat(fee);\n        var time = $('.total_time').val();\n        time = parseInt(time);\n        $(\".total_charge\").text(fee * time);\n    });\n});\n</code></pre>\n\n<p>Here are is the input field:</p>\n\n<pre><code>&lt;input class=\"form-control total_time\" name=\"total_time\" placeholder=\"2\" type=\"text\"&gt;&lt;/input&gt;\n</code></pre>\n"}, {"tags": ["ruby", "reactjs", "material-ui", "hyperstack"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10599625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c546081466ec089bd1b34b585b9c580?s=128&d=identicon&r=PG&f=1", "display_name": "chiwowahh", "link": "https://stackoverflow.com/users/10599625/chiwowahh"}, "edited": false, "score": 0, "creation_date": 1555928203, "post_id": 55695171, "comment_id": 98254627, "body": "Thanks a lot, this does seem to work but I have one issue: it somehow render 2 addition &quot;next&quot;, &quot;back&quot; buttons on top of the component, can&#39;t figure out why"}, {"owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "reply_to_user": {"reputation": 25, "user_id": 10599625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c546081466ec089bd1b34b585b9c580?s=128&d=identicon&r=PG&f=1", "display_name": "chiwowahh", "link": "https://stackoverflow.com/users/10599625/chiwowahh"}, "edited": false, "score": 0, "creation_date": 1556372924, "post_id": 55695171, "comment_id": 98421144, "body": "@chiwowahh I think its because you need to add <code>.as_node</code> so that the component does not render - <code>Mui.Button(size: &quot;small&quot;) {&#39;back&#39;}.as_node.to_n)</code>"}], "tags": [], "owner": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "is_accepted": true, "score": 3, "last_activity_date": 1555352611, "creation_date": 1555352611, "answer_id": 55695171, "question_id": 55694753, "link": "https://stackoverflow.com/questions/55694753/how-to-use-materialuis-mobile-stepper-in-hypserstack/55695171#55695171", "title": "How to use MaterialUI&#39;s Mobile-Stepper in HypserStack?", "body": "<p>You want to pass a full ReactNode to the nextButton and backButton props. You also need to convert the component to native javascript. You can call <code>to_n</code> on any Hyperstack component to convert it to a native react class.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Mui.MobileStepper( variant: \"progress\", steps: 6, position: \"static\",\n                   nextButton: Mui.Button(size: \"small\") {'next'}.to_n,\n                   backButton: Mui.Button(size: \"small\") {'back'}.to_n)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10599625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c546081466ec089bd1b34b585b9c580?s=128&d=identicon&r=PG&f=1", "display_name": "chiwowahh", "link": "https://stackoverflow.com/users/10599625/chiwowahh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 55695171, "answer_count": 1, "score": 0, "last_activity_date": 1555352611, "creation_date": 1555350597, "question_id": 55694753, "link": "https://stackoverflow.com/questions/55694753/how-to-use-materialuis-mobile-stepper-in-hypserstack", "title": "How to use MaterialUI&#39;s Mobile-Stepper in HypserStack?", "body": "<p>I try to use the mobile-stepper component (<a href=\"https://material-ui.com/demos/steppers/#mobile-stepper-progress\" rel=\"nofollow noreferrer\">https://material-ui.com/demos/steppers/#mobile-stepper-progress</a>) in Hyperstack but I get this error:</p>\n\n<p><code>Failed prop type: Invalid prop `nextButton` supplied to `MobileStepper`, expected a ReactNode.\n    in MobileStepper</code></p>\n\n<p>It renders just the progress bar but no buttons.</p>\n\n<p>Tried various ways i.e.:</p>\n\n<pre><code>Mui.MobileStepper( variant: \"progress\", steps: 6, position: \"static\",\n                   nextButton: lambda { Mui.Button(size: \"small\") {'next'} },\n                   backButton: lambda { Mui.Button(size: \"small\") {'back'} })\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "compare", "element", "digits"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 2, "creation_date": 1555350749, "post_id": 55694673, "comment_id": 98072116, "body": "Can you provide some more context on your sorting rules? You can use <code>list1.map(&amp;:to_s).sort</code> to convert to strings and that sorts it like what I <i>think</i> you&#39;re asking, but your 2nd example doesn&#39;t have the first half of your list sorted (e.g. why does 50 sort before 2?)"}, {"owner": {"reputation": 21, "user_id": 11364637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d1e90ce19ad39a970911720961fb9d?s=128&d=identicon&r=PG&f=1", "display_name": "Laurenita Ni&#241;a", "link": "https://stackoverflow.com/users/11364637/laurenita-ni%c3%b1a"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1555353833, "post_id": 55694673, "comment_id": 98073350, "body": "Hey! i have to write the biggest number with all the elements of the array. for example : [50, 2, 1, 9] should output the number &quot;95021&quot;. that&#39;s why i have to compare the elements digits by digits. (and sorry for my 2nd example, i didn&#39;t check the beginning of the array ;) )"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1555368267, "post_id": 55694673, "comment_id": 98078517, "body": "&quot;Sorry for my 2nd example&quot;? Are you referring to the example in your question? If so, why haven&#39;t you edited the question to fix it? I see you are new to SO, but isn&#39;t it common sense that you should correct errors in your question? Also, if you want to construct a string (e.g, &quot;95021&quot;), why don&#39;t you say that in your question?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11364637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d1e90ce19ad39a970911720961fb9d?s=128&d=identicon&r=PG&f=1", "display_name": "Laurenita Ni&#241;a", "link": "https://stackoverflow.com/users/11364637/laurenita-ni%c3%b1a"}, "edited": false, "score": 0, "creation_date": 1555360020, "post_id": 55696553, "comment_id": 98075826, "body": "many thanks for your help Jay Dorsey &amp; Hari Gopal! i will try the &quot;double mapping&quot; tomorrow and of course i&#39;ll check your solution, it&#39;s always interesting to read others methods ;)"}, {"owner": {"reputation": 21, "user_id": 11364637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d1e90ce19ad39a970911720961fb9d?s=128&d=identicon&r=PG&f=1", "display_name": "Laurenita Ni&#241;a", "link": "https://stackoverflow.com/users/11364637/laurenita-ni%c3%b1a"}, "edited": false, "score": 0, "creation_date": 1555408089, "post_id": 55696553, "comment_id": 98091399, "body": "i tried it and this is perfect!!!! i was thinking about converting it to string but i wasn&#39;t sure about how to proceed after that! thank you everyone for your help :)"}], "tags": [], "owner": {"reputation": 718, "user_id": 1425158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe9cf6d118847f6a05682972a2d1ea6b?s=128&d=identicon&r=PG", "display_name": "Hari Gopal", "link": "https://stackoverflow.com/users/1425158/hari-gopal"}, "is_accepted": false, "score": -1, "last_activity_date": 1555395005, "last_edit_date": 1555395005, "creation_date": 1555358926, "answer_id": 55696553, "question_id": 55694673, "link": "https://stackoverflow.com/questions/55694673/ruby-how-to-isolate-the-first-digit-of-every-element-in-an-array/55696553#55696553", "title": "Ruby - How to isolate the first digit of every element in an array?", "body": "<p>To extract just the first digit, you just need to map twice:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>list = [50, 2, 99, 1, 958, 9, 6, 80]\n\np list.map(&amp;:to_s).map { |n| n[0] }\n# =&gt; [\"5\", \"2\", \"9\", \"1\", \"9\", \"9\", \"6\", \"8\"]\n</code></pre>\n\n<p><strong>Update:</strong> The solution I've linked below is <strong>incorrect</strong>. The problem isn't as simple as it seemed.</p>\n\n<p>Old answer follows:</p>\n\n<blockquote class=\"spoiler\">\n  <p> However, the problem itself looked interesting, so I gave it a shot - i.e, to form the largest possible number from a list of numbers.\n \n However, I don't want to spoil the fun for you, so here's a <a href=\"https://gist.github.com/harigopal/80cd21c7ac7e0a349746a2e0abc63b7e\" rel=\"nofollow noreferrer\">link to a gist that solves the problem through normalization</a>, in case you're interested.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 718, "user_id": 1425158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe9cf6d118847f6a05682972a2d1ea6b?s=128&d=identicon&r=PG", "display_name": "Hari Gopal", "link": "https://stackoverflow.com/users/1425158/hari-gopal"}, "edited": false, "score": 0, "creation_date": 1555395381, "post_id": 55696648, "comment_id": 98084623, "body": "While this seemed correct, and elegant at first glance, this doesn&#39;t actually work. The <code>&lt;=&gt;</code> comparator assumes that the longer string is greater than the shorter string (when leading characters are the same). However, in this case, the shorter string should be considered greater. <code>[10, 9, 95]</code> is already sorted as per this logic, but <code>95910</code> is less than <code>99510</code>."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1555359764, "last_edit_date": 1555359764, "creation_date": 1555359460, "answer_id": 55696648, "question_id": 55694673, "link": "https://stackoverflow.com/questions/55694673/ruby-how-to-isolate-the-first-digit-of-every-element-in-an-array/55696648#55696648", "title": "Ruby - How to isolate the first digit of every element in an array?", "body": "<p>Try this: compare values converted to string, using <a href=\"https://ruby-doc.org/core-2.6.2/String.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">String#&lt;=></a> with <a href=\"https://ruby-doc.org/core-2.6.2/Array.html#method-i-sort\" rel=\"nofollow noreferrer\">Array#sort</a>:</p>\n\n<pre><code>list1.sort { |a, b| a.to_s &lt;=&gt; b.to_s }\n#=&gt; [1, 2, 50, 6, 80, 9, 958, 99]\n</code></pre>\n\n<p>If I understand the question, even if the first three element of your output are confusing me about the logic.</p>\n"}, {"tags": [], "owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "is_accepted": false, "score": 3, "last_activity_date": 1555368250, "creation_date": 1555368250, "answer_id": 55698191, "question_id": 55694673, "link": "https://stackoverflow.com/questions/55694673/ruby-how-to-isolate-the-first-digit-of-every-element-in-an-array/55698191#55698191", "title": "Ruby - How to isolate the first digit of every element in an array?", "body": "<p>I think what you are looking for is this:</p>\n\n<pre><code>list1.sort_by(&amp;:to_s)\n</code></pre>\n\n<p>So, this will lead to:</p>\n\n<pre><code>[50, 2, 99, 1, 958, 9, 6, 80].sort_by(&amp;:to_s)\n#=&gt; [1, 2, 50, 6, 80, 9, 958, 99]\n\n[50, 2, 1, 9].sort_by(&amp;:to_s)\n#=&gt; [1, 2, 50, 9]\n</code></pre>\n\n<p>If you want reverse order, you can do:</p>\n\n<pre><code>[50, 2, 99, 1, 958, 9, 6, 80].sort_by(&amp;:to_s).reverse\n#=&gt; [99, 958, 9, 80, 6, 50, 2, 1] \n\n[50, 2, 1, 9].sort_by(&amp;:to_s).reverse\n#=&gt; [9, 50, 2, 1] \n</code></pre>\n\n<p>And you can do .<code>join</code> to get the joined string:</p>\n\n<pre><code>[50, 2, 1, 9].sort_by(&amp;:to_s).reverse.join\n#=&gt; \"95021\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11364637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d1e90ce19ad39a970911720961fb9d?s=128&d=identicon&r=PG&f=1", "display_name": "Laurenita Ni&#241;a", "link": "https://stackoverflow.com/users/11364637/laurenita-ni%c3%b1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555407515, "creation_date": 1555350256, "last_edit_date": 1555407515, "question_id": 55694673, "link": "https://stackoverflow.com/questions/55694673/ruby-how-to-isolate-the-first-digit-of-every-element-in-an-array", "title": "Ruby - How to isolate the first digit of every element in an array?", "body": "<p>i have an array with numbers like this:</p>\n\n<p>list1 = [50, 2, 99, 1, 958, 9, 6, 80]</p>\n\n<p>and i need to compare all elements: digit by digit.\nfor exemple, it will be important to compare \"9\", \"99\" and \"958\", because i'll need to put \"99\" at the end like this:</p>\n\n<p>list1 = [1, 2, 50, 6, 80, 9, 958, 99]</p>\n\n<p>Does Ruby has a function for this?\nthank you very much for your help :)</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1555351195, "post_id": 55694618, "comment_id": 98072304, "body": "There no commas in sight.  The dot in the numbers you wrote is called a period."}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "is_accepted": false, "score": 0, "last_activity_date": 1555350704, "creation_date": 1555350704, "answer_id": 55694775, "question_id": 55694618, "link": "https://stackoverflow.com/questions/55694618/float-two-digits-after-comma-how-to/55694775#55694775", "title": "Float - two digits after comma - how to?", "body": "<p>For question 1:</p>\n\n<pre><code>num = 1589.5833333333333\nprintf('%.2f', num)\n=&gt; 1589.58\n</code></pre>\n\n<p>For question 2 to round up to first digit:</p>\n\n<pre><code>num = 1589.5833333333333\nprintf('%.2f', num.round(1))\n=&gt; 1589.60\n</code></pre>\n\n<p>1589.55 is a bit of an arbitrary number, rounding down would usually be calculated as 1589.58. I don't know of any Ruby function that does that off-hand.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 3259939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4auo.jpg?s=128&g=1", "display_name": "Sunny", "link": "https://stackoverflow.com/users/3259939/sunny"}, "edited": false, "score": 0, "creation_date": 1555446915, "post_id": 55696928, "comment_id": 98112864, "body": "using truncate(2) I get an arguement error.  :in <code>truncate&#39;: wrong number of arguments (given 1, expected 0) (ArgumentError) \tfrom immobilienCalc.rb:59:in </code>&lt;main&gt;&#39;"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 21, "user_id": 3259939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4auo.jpg?s=128&g=1", "display_name": "Sunny", "link": "https://stackoverflow.com/users/3259939/sunny"}, "edited": false, "score": 0, "creation_date": 1555478249, "post_id": 55696928, "comment_id": 98120460, "body": "@Sunny Which version of Ruby are you using? <code>ruby -v</code> in terminal. Truncate with arguments was introduced since 2.4.0: <a href=\"http://ruby-doc.org/core-2.4.0/Float.html#method-i-truncate\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.4.0/Float.html#method-i-truncate</a> | <a href=\"http://ruby-doc.org/core-2.3.0/Float.html#method-i-truncate\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.0/Float.html#method-i-truncate</a> | In case, update you Ruby or follow the above comments."}, {"owner": {"reputation": 21, "user_id": 3259939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4auo.jpg?s=128&g=1", "display_name": "Sunny", "link": "https://stackoverflow.com/users/3259939/sunny"}, "edited": false, "score": 0, "creation_date": 1555520319, "post_id": 55696928, "comment_id": 98143854, "body": "@iGian ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin17]"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1555362976, "last_edit_date": 1555362976, "creation_date": 1555360790, "answer_id": 55696928, "question_id": 55694618, "link": "https://stackoverflow.com/questions/55694618/float-two-digits-after-comma-how-to/55696928#55696928", "title": "Float - two digits after comma - how to?", "body": "<p>Other option but keeping the object as <a href=\"https://ruby-doc.org/core-2.6.2/Float.html\" rel=\"nofollow noreferrer\">Float</a>:</p>\n\n<pre><code>n = 1589.5833333333333\nm = n.truncate(2) #=&gt; 1589.58\nh = n.round(1) #=&gt; 1589.6 # for the last zero you need to format the string\n</code></pre>\n\n<p>And a tricky:</p>\n\n<pre><code>k = (n*100).to_i.digits.tap{ |ary| ary.first &gt; 5 ? ary[0] = 5 : ary[0] = 0 }.reverse.join('').to_i/100.0\n    #=&gt; 1589.55\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3259939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4auo.jpg?s=128&g=1", "display_name": "Sunny", "link": "https://stackoverflow.com/users/3259939/sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555395893, "creation_date": 1555350054, "last_edit_date": 1555351056, "question_id": 55694618, "link": "https://stackoverflow.com/questions/55694618/float-two-digits-after-comma-how-to", "title": "Float - two digits after comma - how to?", "body": "<p>I tried to execute a calculation in Ruby. The result I get is 1589.5833333333333. I would like to limitat the numbers of digits after the comma. </p>\n\n<p>The result should always be limited to 2 digits as followed:</p>\n\n<p>1589.58</p>\n\n<ul>\n<li>Question #1 = how can I set the limitation?</li>\n<li>Question #2 = how can I round up 1589.60 or down 1589.55</li>\n</ul>\n\n<p>Many thanks for help. Language is ruby</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 7280636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-isWkcOyRDbA/AAAAAAAAAAI/AAAAAAAASHw/A_Wr0gpWuH8/photo.jpg?sz=128", "display_name": "Prasath Rajasekaran", "link": "https://stackoverflow.com/users/7280636/prasath-rajasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1555351546, "creation_date": 1555351546, "answer_id": 55694960, "question_id": 55694484, "link": "https://stackoverflow.com/questions/55694484/multiple-has-and-belongs-to-many-relationship/55694960#55694960", "title": "Multiple has and belongs to many relationship", "body": "<p>You can have a separate recipient type table and then map messages only with recipients</p>\n\n<pre><code>Recipient          Recipient_type   Message       Message_recipient_map\n----------         ---------------  -------       -------------------\nid                 id               id            message_id  \nrecipient_type_id                                 recipient_id \n</code></pre>\n\n<p>Then you can have has_many_through relationship between message and recipient and can access all recipients of the message by calling message.recipients</p>\n\n<p>Hope this helps you!</p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1555412860, "post_id": 55695098, "comment_id": 98094275, "body": "I would call it a <code>has_many through:</code> association to avoid the confusion."}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 1, "last_activity_date": 1555420942, "last_edit_date": 1555420942, "creation_date": 1555352246, "answer_id": 55695098, "question_id": 55694484, "link": "https://stackoverflow.com/questions/55694484/multiple-has-and-belongs-to-many-relationship/55695098#55695098", "title": "Multiple has and belongs to many relationship", "body": "<p>With explicit has-and-belongs-to-many (aka <code>has_many through:</code>) relation model you'll have more control over the relation and can make one end of it polymorphic:</p>\n\n<pre><code>class Message &lt; ApplicationRecord\n  has_many :message_recipients\n  has_many :internal_recipients, through: :message_recipients, source: :recipient, source_type: \"InternalContact\"\nend\n\nclass InternalContact &lt; ApplicationRecord\n  has_many :message_recipients, as: :recipient\n  has_many :messages, through: :message_recipients, inverse_of: :internal_recipients\nend\n\nclass MessageRecipient &lt; ApplicationRecord\n  belongs_to :message\n  belongs_to :recipient, polymorphic: true\nend\n\n\nmsg = Message.create!\nrec = InternalContact.create!\nmsg.internal_recipients &lt;&lt; rec\nmsg.message_recipients.each{|mr|\n  mr.recipient # here can be any model\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1555416825, "last_edit_date": 1555416825, "creation_date": 1555416304, "answer_id": 55707748, "question_id": 55694484, "link": "https://stackoverflow.com/questions/55694484/multiple-has-and-belongs-to-many-relationship/55707748#55707748", "title": "Multiple has and belongs to many relationship", "body": "<p>One way to do this if you want to avoid a polymorphic association is to use <a href=\"https://en.wikipedia.org/wiki/Single_Table_Inheritance\" rel=\"nofollow noreferrer\">Single Table Inheritance</a>. </p>\n\n<p>One major reason you would want to do this is to be able use a foreign key to ensure referential integrity which is not possible with polymorphism.</p>\n\n<p>Since the types share a table you can also treat them like a homogeneous collection when it comes to ordering.</p>\n\n<p>But single table inheritance is only really suited if the different types are very similar in nature and are interchangeable. </p>\n\n<h2>Setting up STI</h2>\n\n<p>First create a <code>contacts</code> table where you will store all the different types.</p>\n\n<pre><code>class CreateContacts &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :contacts do |t|\n      t.string :type\n      # and whatever columns you need \n      t.string :email\n      # ...\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Pay attention to the <code>type</code> column. ActiveRecord will use this to store the class name of the subclasses. Then setup InternalContact and ExternalContact to inherit from the base <code>Contact</code> class:</p>\n\n<pre><code>class InternalContact &lt; Contact\n  # ...\nend\n\nclass ExternalContact &lt; Contact\n  # ...\nend\n</code></pre>\n\n<p>This lets you implement whatever logic you want (such as validations and callbacks) for each subtype.</p>\n\n<h2>The associations</h2>\n\n<p>Start with the join table:</p>\n\n<pre><code>class CreateMessageRecipients &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :message_recipients do |t|\n      t.belongs_to :message\n      t.belongs_to :recipient, foreign_key: { to_table: :contacts }\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Lets setup the associations with <a href=\"https://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\"><code>has_many through:</code></a> and a join model instead of <code>has_and_belongs_to_many</code> which is very limited: </p>\n\n<pre><code>class Contact &lt; ApplicationRecord\n  has_many :message_recipients, foreign_key: :recipient_id\n  has_many :messages, through: :message_recipients\nend\n\nclass MessageRecipient &lt; ApplicationRecord\n  belongs_to :message\n  belongs_to :recipient, class_name: 'Contact'\nend\n\nclass Message &lt; ApplicationRecord\n  has_many :message_recipients\n  has_many :recipients, through: :message_recipients\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8398727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d18fe78d6f0c57047a60bc79e7a2eca?s=128&d=identicon&r=PG&f=1", "display_name": "JJdinho", "link": "https://stackoverflow.com/users/8398727/jjdinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555420942, "creation_date": 1555349432, "last_edit_date": 1555350538, "question_id": 55694484, "link": "https://stackoverflow.com/questions/55694484/multiple-has-and-belongs-to-many-relationship", "title": "Multiple has and belongs to many relationship", "body": "<p>I have a model that has a <code>has_and_belongs_to_many</code> relationship with two other models. For example, I have a <code>Message</code> model which has recipients. However, the recipients can be one of two different types of models. For example, <code>InternalContact</code>, and <code>ExternalContact</code>.</p>\n\n<p>It is easy to set up relations where I can get either the Message's external contacts (<code>Message.first.external_contacts</code>) or its internal contacts (<code>Message.first.internal_contacts</code>). And then I can, in the same vein, easily add to this relationship array (<code>Message.first.external_contacts &lt;&lt; ExternalContact.first</code>)</p>\n\n<p>What I want is the ability to simply things and make this more efficiently by calling something like:</p>\n\n<pre><code>Message.first.recipients # an array of both external and internal contacts\nMessage.first.recipients &lt;&lt; ExternalContact/InternalContact # (add either model)\n</code></pre>\n\n<p>Any direction is appreciated, I'm definitely stuck!</p>\n"}, {"tags": ["regex", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 11132861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79fa06e304a496a746c2a9ddc28891c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/11132861/brandon"}, "edited": false, "score": 1, "creation_date": 1555351488, "post_id": 55694534, "comment_id": 98072415, "body": "Well organized and explained. Thanks!"}, {"owner": {"reputation": 85, "user_id": 11132861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79fa06e304a496a746c2a9ddc28891c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/11132861/brandon"}, "edited": false, "score": 0, "creation_date": 1555352183, "post_id": 55694534, "comment_id": 98072705, "body": "how would I account for strings with more than one space in between, for example - <code>2781   Boyle Street </code>. Notice two spaces in between <code>2781</code> and <code>Boyle</code> as well as the space at the end of the string. See edit"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "reply_to_user": {"reputation": 85, "user_id": 11132861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79fa06e304a496a746c2a9ddc28891c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/11132861/brandon"}, "edited": false, "score": 0, "creation_date": 1555352404, "post_id": 55694534, "comment_id": 98072790, "body": "@Brandon You could use a quantifier <code>+</code> to repeat 1+ times a space like <code>^\\d+(?: ?[&amp;\\&#47;-] ?\\d+)? +(\\w+(?: +\\w+)*) *</code>  <a href=\"https://rubular.com/r/PWDlHXwaE52sDZ\" rel=\"nofollow noreferrer\">demo</a>"}, {"owner": {"reputation": 85, "user_id": 11132861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79fa06e304a496a746c2a9ddc28891c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/11132861/brandon"}, "edited": false, "score": 0, "creation_date": 1555356013, "post_id": 55694534, "comment_id": 98074287, "body": "hey sorry but I added one more test case that I can&#39;t seem to get passed. The main issue is <code>267 1&#47;2</code>. My current working regex is <code>^\\d+\\w?(?: ?[&amp;\\&#47;-] ?\\d+)? +(\\w+(?: +\\w+)*) *</code>. <a href=\"https://rubular.com/r/hUjlr0mhHkuZCt\" rel=\"nofollow noreferrer\">demo</a>"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "reply_to_user": {"reputation": 85, "user_id": 11132861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79fa06e304a496a746c2a9ddc28891c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/11132861/brandon"}, "edited": false, "score": 0, "creation_date": 1555356661, "post_id": 55694534, "comment_id": 98074571, "body": "Try it like this making the the number at the start optional and add 1+ digits to the group <a href=\"https://rubular.com/r/PLMv6keBKqfJG5\" rel=\"nofollow noreferrer\">rubular.com/r/PLMv6keBKqfJG5</a> Note that when adding more edge cases the pattern can become quite large."}], "tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": true, "score": 1, "last_activity_date": 1555350309, "last_edit_date": 1555350309, "creation_date": 1555349662, "answer_id": 55694534, "question_id": 55694304, "link": "https://stackoverflow.com/questions/55694304/best-regex-to-fetch-street-name-from-a-partial-address/55694534#55694534", "title": "Best regex to fetch street name from a partial address", "body": "<p>One option could be to match the digits at the start with optional spaces and a character class which will match either <code>&amp;</code> or <code>/</code> or <code>-</code> and capture the address in a capturing group:</p>\n\n<pre><code>\\A\\d+(?: ?[&amp;\\/-] ?\\d+)? (\\w+(?: \\w+)*)\n</code></pre>\n\n<p>That will match</p>\n\n<ul>\n<li><code>\\A</code> Start of string</li>\n<li><code>\\d+</code> Match 1+ digits</li>\n<li><code>(?:</code>\n\n<ul>\n<li><code>?[&amp;\\/-] ?\\d+</code> Match optional space, either <code>&amp;</code> or <code>/</code> or <code>-</code>, optional space and 1+ digits</li>\n</ul></li>\n<li><code>)?</code> Close group and make it optional</li>\n<li><code>(</code> Match space and start capturing group\n\n<ul>\n<li><code>\\w+(?: \\w+)*</code> Match 1+ word chars and repeat 0+ times a space and 1+ word chars</li>\n</ul></li>\n<li><code>)</code> Close capturing group</li>\n</ul>\n\n<p><a href=\"https://rubular.com/r/8zIwqME3MClUmr\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 718, "user_id": 1425158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe9cf6d118847f6a05682972a2d1ea6b?s=128&d=identicon&r=PG", "display_name": "Hari Gopal", "link": "https://stackoverflow.com/users/1425158/hari-gopal"}, "is_accepted": false, "score": 0, "last_activity_date": 1555349841, "creation_date": 1555349841, "answer_id": 55694572, "question_id": 55694304, "link": "https://stackoverflow.com/questions/55694304/best-regex-to-fetch-street-name-from-a-partial-address/55694572#55694572", "title": "Best regex to fetch street name from a partial address", "body": "<p>This should do the job: <code>\\d\\s(\\D+)$</code></p>\n\n<p>You can see this in action here: <a href=\"https://rubular.com/r/tcbE7nhNkSQDyS\" rel=\"nofollow noreferrer\">https://rubular.com/r/tcbE7nhNkSQDyS</a></p>\n\n<p>Basically, we're picking just the characters we want, by defining the rule for the string we're looking for. i.e., a string that may contains non-digit characters (<code>\\D+</code>), that ends when the line ends (<code>$</code>), and begins with a number followed by a space (<code>\\d\\s</code>).</p>\n"}], "owner": {"reputation": 85, "user_id": 11132861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e79fa06e304a496a746c2a9ddc28891c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/11132861/brandon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55694534, "answer_count": 2, "score": 1, "last_activity_date": 1555356897, "creation_date": 1555348639, "last_edit_date": 1555356897, "question_id": 55694304, "link": "https://stackoverflow.com/questions/55694304/best-regex-to-fetch-street-name-from-a-partial-address", "title": "Best regex to fetch street name from a partial address", "body": "<p>I am trying to extract the street name from multiple examples containing the number and street</p>\n\n<p>I've tried <code>^\\d+(-\\d+|\\w)? ([EWNS] )?</code> but this doesn't pass the second test case.</p>\n\n<p>I need these test cases to pass</p>\n\n<p><code>2 Main Street -&gt; 'Main Street'</code></p>\n\n<p><code>5 &amp; 6 Shore Lane -&gt; 'Shore Lane'</code></p>\n\n<p><code>7/8 Bay Way -&gt; 'Bay Way'</code></p>\n\n<p><code>73-97 Park Dr E -&gt; 'Park Dr E'</code></p>\n\n<p><code>2781  Boyle Street -&gt; 'Boyle Street'</code></p>\n\n<p><code>267 1/2 Brad St -&gt; 'Brad St'</code></p>\n\n<p><code>433 W. 49th St. -&gt; 'W 49th St'</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 181, "user_id": 9853412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a80bcc603c21ab8e1474266124b58a51?s=128&d=identicon&r=PG&f=1", "display_name": "neversleep", "link": "https://stackoverflow.com/users/9853412/neversleep"}, "edited": false, "score": 0, "creation_date": 1555347722, "post_id": 55694025, "comment_id": 98070767, "body": "Try to remove assignment <code>@round_participations = @winner_ids.each</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1555348712, "post_id": 55694025, "comment_id": 98071184, "body": "I would look for a solution where you use the database to fetch the correct records instead of pulling everything out and doing it in ruby which will not scale at all. If you give us an example of the schema and the data and the desired output we can give you a better answer than fixing your flawed attempt."}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1555355587, "post_id": 55694025, "comment_id": 98074124, "body": "I had obviously spent too long at the computer today... Removing the assignment to round_participation has worked and I now have an array of Tournament Participation objects thanks Bruno below! @max I was under the impression the fewer calls to the database the better therefore you are best pulling data in one call and working with it in Ruby hence the methodology. I have also been recently trying to improve speed further with use of methods like .pluck (used above) to try and only work with the attributes you need... If this is not the case then we could look at another way."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1555355849, "post_id": 55694025, "comment_id": 98074217, "body": "Limiting the number of database calls is in general a good way to improve performance. But pulling all the records out of the database will exhaust the memory in your (application) server and cause it to crash if you have a non-trivial amount of data. Additionally databases are really good at sorting, joining and doing these kind of things really fast while pulling everything out and then doing it in Ruby is quite slow. So your conclusion is not correct."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1555356388, "post_id": 55694025, "comment_id": 98074448, "body": "Additionally this code actually is a really good example of a N+1 query. <code>@tournament_participations.where(user_id: winner_id)</code> will cause an additional round trip to the database for every iteration. What you should be doing instead is a single database query that joins the relevant tables which you can most likely do by just setting up your associations correctly. This quite a bit more important then using <code>pluck</code> to just select the columns you want which is like putting makeup on a pig."}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "edited": false, "score": 0, "creation_date": 1555356666, "post_id": 55694025, "comment_id": 98074573, "body": "Thanks max, would you be interested in looking at the code in my project and running through areas for improvement on speed? I know outside the scope of this site but happy to do something through flattr or something? Whats the best way to contact?"}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "edited": false, "score": 0, "creation_date": 1555356742, "post_id": 55694025, "comment_id": 98074604, "body": "Also the @tournament_participations.where(user_id: winner_id) is outside the iteration and is only called once at the top to return an array of Challenges for the Tournament&#39;s previous round so I can extract the winner ids?"}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 8234403, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155552414000229/picture?type=large", "display_name": "brunoparga", "link": "https://stackoverflow.com/users/8234403/brunoparga"}, "is_accepted": true, "score": 4, "last_activity_date": 1555347855, "creation_date": 1555347855, "answer_id": 55694122, "question_id": 55694025, "link": "https://stackoverflow.com/questions/55694025/iterating-over-2-arrays-and-building-a-new-array-from-matches/55694122#55694122", "title": "Iterating Over 2 Arrays And Building A New Array From Matches", "body": "<p><code>each</code> returns the enumerable it was called on; in this case, <code>@winner_ids.each</code> is returning <code>@winner.ids</code>. You don't need to assign the result of the iteration to <code>@round_participations</code>.</p>\n\n<p>Also, check out <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-map\" rel=\"nofollow noreferrer\">the <code>map</code> method</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "edited": false, "score": 0, "creation_date": 1555365478, "post_id": 55694345, "comment_id": 98077817, "body": "Thanks sk1712! Getting rid of the assignment worked but could also have used .map :)"}], "tags": [], "owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "is_accepted": false, "score": 1, "last_activity_date": 1555348808, "creation_date": 1555348808, "answer_id": 55694345, "question_id": 55694025, "link": "https://stackoverflow.com/questions/55694025/iterating-over-2-arrays-and-building-a-new-array-from-matches/55694345#55694345", "title": "Iterating Over 2 Arrays And Building A New Array From Matches", "body": "<p>Use the map method, instead of .each. </p>\n\n<p>The map method can be used to create a new array based on the original array, but with the values modified by the supplied block. See the below example.</p>\n\n<p>In case of <strong>each</strong> method </p>\n\n<pre><code>irb(main):001:0&gt; arr = [1, 2, 3, 4, 5]\n=&gt; [1, 2, 3, 4, 5]\nirb(main):002:0&gt; arr.each { |a| print a -= 10, \" \" }\n-9 -8 -7 -6 -5 \n=&gt; [1, 2, 3, 4, 5]\n</code></pre>\n\n<p>you can see after iterations it returned the original array. But in the case of <strong>map</strong></p>\n\n<pre><code>irb(main):005:0&gt; arr = [1, 2, 3, 4, 5]\n=&gt; [1, 2, 3, 4, 5]\nirb(main):006:0&gt; arr.map { |a| 2*a }\n=&gt; [2, 4, 6, 8, 10]\n</code></pre>\n\n<p><strong>map</strong> can transform the contents of an array, meaning that it can perform an operation on each element in the array.</p>\n"}], "owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55694122, "answer_count": 2, "score": 0, "last_activity_date": 1555348808, "creation_date": 1555347460, "question_id": 55694025, "link": "https://stackoverflow.com/questions/55694025/iterating-over-2-arrays-and-building-a-new-array-from-matches", "title": "Iterating Over 2 Arrays And Building A New Array From Matches", "body": "<p>Ok so I have an array of 'winner ids' this array represents users who have won in the previous round of a tournament. I then have an array of objects called 'tournament participations', this represents all the users that have participated in the tournament (many to many relationship join table). </p>\n\n<p>For each 'winner id' I want to iterate through the 'tournament participations' array and find the tournament participation with a user_id that matches the 'winner id', then push it into a new array called 'round participations'...</p>\n\n<p>I have tried the code below but I always get returned the original 'winner_ids' array....</p>\n\n<pre><code>@challenges = Challenge.where(tournament_id: @tournament.id)\n@winner_ids = @challenges.pluck(:winner_id)\n@tournament_participations = @tournament.tournament_participations\n@round_participations = []\n@round_participations = @winner_ids.each do |winner_id|\n   @round_participation = @tournament_participations.where(user_id: winner_id)\n   @round_participations &lt;&lt; @round_participation\nend\n</code></pre>\n"}, {"tags": ["ruby", "haml"], "comments": [{"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1555347670, "post_id": 55693980, "comment_id": 98070739, "body": "&quot;And i need it like this <code>&lt;img src=&#39;&quot;ex.jpg&quot;&#39;&#47;&gt;</code>&quot; \u2014 But that is not valid HTML, so why would you need it like that?"}, {"owner": {"reputation": 31, "user_id": 8784836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7befe4a1798a9e56bd53c1cfa1238dd?s=128&d=identicon&r=PG&f=1", "display_name": "txyz", "link": "https://stackoverflow.com/users/8784836/txyz"}, "reply_to_user": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 0, "creation_date": 1555347805, "post_id": 55693980, "comment_id": 98070803, "body": "because i want to use some django tags inside of it. Like this: %img{:src=&#39;{% static &quot;ex.jpg&quot; %}&#39;, so when the HTML will be rendered, i will have the static tag in it automatically."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8784836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7befe4a1798a9e56bd53c1cfa1238dd?s=128&d=identicon&r=PG&f=1", "display_name": "txyz", "link": "https://stackoverflow.com/users/8784836/txyz"}, "edited": false, "score": 0, "creation_date": 1555353975, "post_id": 55694486, "comment_id": 98073416, "body": "if i put i like the first suggestion, it will still not render them like &#39;ex.jpg&#39;, instead it will add the ascii code. I tried :(. The second ideea is much more interesting. :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 31, "user_id": 8784836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7befe4a1798a9e56bd53c1cfa1238dd?s=128&d=identicon&r=PG&f=1", "display_name": "txyz", "link": "https://stackoverflow.com/users/8784836/txyz"}, "edited": false, "score": 0, "creation_date": 1555354634, "post_id": 55694486, "comment_id": 98073703, "body": "If it&#39;s not legit HTML you may need to side-step HAML, but the good news is HAML allows you to write in <i>whatever</i> so you can do that."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1555349440, "creation_date": 1555349440, "answer_id": 55694486, "question_id": 55693980, "link": "https://stackoverflow.com/questions/55693980/haml-converts-html-to-ascii-characters/55694486#55694486", "title": "HAML converts HTML to Ascii characters", "body": "<p>Two ideas. One is to switch quotes:</p>\n\n<pre><code>%img{:src=\"{% static 'ex.jpg' %}\"}\n</code></pre>\n\n<p>Another is to just put in the text as you want it:</p>\n\n<pre><code>&lt;img src='{% static \"ex.jpg\" %}'/&gt;\n</code></pre>\n\n<p>Skipping the HAML part. You can always revert to regular HTML in HAML.</p>\n\n<p>Double quotes are special in HTML and HAML will go out of its way to properly escape them so it produces a valid HTML document. What you're trying to produce isn't valid until Django has done its thing.</p>\n"}], "owner": {"reputation": 31, "user_id": 8784836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7befe4a1798a9e56bd53c1cfa1238dd?s=128&d=identicon&r=PG&f=1", "display_name": "txyz", "link": "https://stackoverflow.com/users/8784836/txyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555349440, "creation_date": 1555347289, "last_edit_date": 1555349322, "question_id": 55693980, "link": "https://stackoverflow.com/questions/55693980/haml-converts-html-to-ascii-characters", "title": "HAML converts HTML to Ascii characters", "body": "<p>I have an issue with HAML, when i want to convert the HAML file to HTML.</p>\n\n<p>More exactly i have this...</p>\n\n<pre><code>%img{:src='{% static \"ex.jpg\" %}'}\n\n</code></pre>\n\n<p>After converting to HTML, will show up like this</p>\n\n<pre><code>\n&lt;img src='{% static &amp;#34;ex.jpg&amp;#34; %}'/&gt;\n\n</code></pre>\n\n<p>What I want is:</p>\n\n<pre><code>&lt;img src='{% static \"ex.jpg\" %}'/&gt;\n</code></pre>\n\n<p>Now, i know that is not the way you would write the <em>%img</em> tag, but i would need the \"ex.jpg\" to be displayed as it is in the rendered HTML file, and not with ASCII Characters.</p>\n\n<p>How can i convert the HAML file to HTML, without the ascii characters?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session", "devise"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1555349123, "post_id": 55693367, "comment_id": 98071370, "body": "Well, the expiry header is not used for authentication. Rather its a cache control mechanism so that the client can cache requests without getting stale."}, {"owner": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1555351125, "post_id": 55693367, "comment_id": 98072269, "body": "It has something to do with devise token authentication, doesn&#39;t it? Here is the related source: <a href=\"https://github.com/lynndylanhurley/devise_token_auth/blob/master/app/models/devise_token_auth/concerns/user.rb#L171\" rel=\"nofollow noreferrer\">github.com/lynndylanhurley/devise_token_auth/blob/master/app&zwnj;&#8203;/&hellip;</a>  But then I completely misunderstand the purpose of that header"}], "answers": [{"comments": [{"owner": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "edited": false, "score": 0, "creation_date": 1555351257, "post_id": 55694614, "comment_id": 98072331, "body": "Thank you, I thought it&#39;s related to timeoutable, but I see it&#39;s something different (found source here: <a href=\"https://github.com/lynndylanhurley/devise_token_auth/blob/master/app/models/devise_token_auth/concerns/user.rb#L171\" rel=\"nofollow noreferrer\">github.com/lynndylanhurley/devise_token_auth/blob/master/app&zwnj;&#8203;/&hellip;</a>)"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "edited": false, "score": 0, "creation_date": 1555351421, "post_id": 55694614, "comment_id": 98072391, "body": "Yeah its more like a basic tennet of how caching in HTTP works. Sure devise token authentication may use expiry headers buts it not more tied to that than a screw is to a rocket."}, {"owner": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "edited": false, "score": 0, "creation_date": 1555351476, "post_id": 55694614, "comment_id": 98072412, "body": "but anyway, how can it be useful for determining when the response should be expired, if it is not updated for newer responses? E.g. it&#39;s <i>9:00pm</i> now, my <code>expiry</code> header might contain outdated timestamp like <i>8:55pm</i> - is it expected behavior or some misconfiguration?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "edited": false, "score": 1, "creation_date": 1555351706, "post_id": 55694614, "comment_id": 98072507, "body": "The thing is that that response has <code>Cache-Control: no-cache</code> which means that the expiry header will not be used anyways."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "edited": false, "score": 1, "creation_date": 1555353375, "post_id": 55694614, "comment_id": 98073152, "body": "Heroku has a pretty decent writeup on how HTTP caching works. <a href=\"https://devcenter.heroku.com/articles/increasing-application-performance-with-http-cache-headers\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/&hellip;</a>"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1555351341, "last_edit_date": 1555351341, "creation_date": 1555350043, "answer_id": 55694614, "question_id": 55693367, "link": "https://stackoverflow.com/questions/55693367/why-isnt-expiry-header-updated-with-each-new-request-to-ruby-on-rails-app/55694614#55694614", "title": "Why isn&#39;t &quot;expiry&quot; header updated with each new request to Ruby on Rails app?", "body": "<p>Devises Timeoutable module has absolutely nothing to do with the expiry headers. Just because two concepts may seem similar does not mean the are related.</p>\n\n<p>Timeoutable stores <code>last_request_at</code> in the session (which is cookie storage by default). </p>\n\n<p>You can get the value with:</p>\n\n<pre><code>ENV['warden'].session(scope)['last_request_at']\n</code></pre>\n\n<p>Where <code>scope</code> is based on the name of your model .</p>\n\n<p>From <a href=\"https://github.com/plataformatec/devise/blob/f39c6fd92774cb66f96f546d8d5e8281542b4e78/lib/devise/hooks/timeoutable.rb\" rel=\"nofollow noreferrer\">the source</a>:</p>\n\n<pre><code>Warden::Manager.after_set_user do |record, warden, options|\n  scope = options[:scope]\n  env   = warden.request.env\n\n  if record &amp;&amp; record.respond_to?(:timedout?) &amp;&amp; warden.authenticated?(scope) &amp;&amp;\n     options[:store] != false &amp;&amp; !env['devise.skip_timeoutable']\n    last_request_at = warden.session(scope)['last_request_at']\n\n    if last_request_at.is_a? Integer\n      last_request_at = Time.at(last_request_at).utc\n    elsif last_request_at.is_a? String\n      last_request_at = Time.parse(last_request_at)\n    end\n\n    proxy = Devise::Hooks::Proxy.new(warden)\n\n    if record.timedout?(last_request_at) &amp;&amp;\n        !env['devise.skip_timeout'] &amp;&amp;\n        !proxy.remember_me_is_active?(record)\n      Devise.sign_out_all_scopes ? proxy.sign_out : proxy.sign_out(scope)\n      throw :warden, scope: scope, message: :timeout\n    end\n\n    unless env['devise.skip_trackable']\n      warden.session(scope)['last_request_at'] = Time.now.utc.to_i\n    end\n  end\nend\n</code></pre>\n\n<p>The expiry header is instead used to control the caching of each separate response. The heuristics of how and when a client should consider a specify response stale are pretty complicated but the expiry header contains a timestamp of when the response should be expired.</p>\n"}], "owner": {"reputation": 1293, "user_id": 2879716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dnv3a.jpg?s=128&g=1", "display_name": "Alexey Grinko", "link": "https://stackoverflow.com/users/2879716/alexey-grinko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 55694614, "answer_count": 1, "score": 0, "last_activity_date": 1555351341, "creation_date": 1555344984, "question_id": 55693367, "link": "https://stackoverflow.com/questions/55693367/why-isnt-expiry-header-updated-with-each-new-request-to-ruby-on-rails-app", "title": "Why isn&#39;t &quot;expiry&quot; header updated with each new request to Ruby on Rails app?", "body": "<p>I'm using Devise <code>:timeoutable</code> module to make session expire after some time of inactivity. Timeout is reset with each new request, so the session expiry date is shifted. But it's just not reflected in the <code>expiry</code> header sent in response to the client.</p>\n\n<p>I noticed that <code>expiry</code> response header is constant for all XHRs that I send to the server. Even after refreshing the page, the <code>expiry</code> header is not updated. In other words, the value of the header is correct only for the very first request I send after sign-in, and then it remains constant.</p>\n\n<p>There is no relevant code to demonstrate since Devise appends auth headers to every response out of the box.</p>\n\n<p>Here is how the <strong>response headers</strong> look like:</p>\n\n<pre><code>access-token: qK5XalnvENIXJDHGCKJ5_A\nCache-Control: no-cache\nclient: c-4_msWmyUFD7PwD7fPW5Q\nConnection: keep-alive\nContent-Encoding: gzip\nContent-Type: application/json; charset=utf-8\nDate: Mon, 15 Apr 2019 15:52:32 GMT\nexpiry: 1556548396\nServer: nginx\ntoken-type: Bearer\nTransfer-Encoding: chunked\nuid: user@email.com\nVary: Origin\nX-Request-Id: 2fa70ebf-dcf2-4680-8c25-68d7b5e12b1b\nX-Runtime: 0.021004\n</code></pre>\n\n<p>And the <strong>request headers</strong> (if relevant):</p>\n\n<pre><code>GET /api/user/context HTTP/1.1\nHost: qa.whiz.ai:9060\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\naccess-token: qK5XalnvENIXJDHGCKJ5_A\nclient: c-4_msWmyUFD7PwD7fPW5Q\nAccept: application/json, text/plain, */*\nexpiry: 1556548396\nuid: user@email.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36\ntoken-type: Bearer\nReferer: https://my-page.example.com/\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.9,uk-UA;q=0.8,uk;q=0.7,ru-UA;q=0.6,ru;q=0.5\nCookie: ...\n</code></pre>\n\n<p>I tried removing <code>expiry</code> from request headers, but it has no effect.</p>\n\n<p>Is it expected behavior? Shouldn't Devise send actual value in that header out of the box?</p>\n\n<p>I would like to know the actual expiration time to be able to perform some actions on the client. For this I could try solution described <a href=\"https://stackoverflow.com/questions/17791626/devise-make-a-request-without-resetting-the-countdown-until-a-user-is-logged-o\">here</a>, but would be much simpler if I could take advantage of the header already present in every response.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1555347044, "post_id": 55693257, "comment_id": 98070441, "body": "If the user is allowed to override it: <code>@user.city_of_birth</code> in the form as predefined value. Otherwise, you can use a callback <code>before_save</code> in <code>Game</code> class and remove the field."}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 10456876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40421f1e126c40b97c8a9378104031e5?s=128&d=identicon&r=PG&f=1", "display_name": "User7777", "link": "https://stackoverflow.com/users/10456876/user7777"}, "edited": false, "score": 0, "creation_date": 1555353707, "post_id": 55694089, "comment_id": 98073282, "body": "Please can you explain this a little."}, {"owner": {"reputation": 718, "user_id": 1425158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe9cf6d118847f6a05682972a2d1ea6b?s=128&d=identicon&r=PG", "display_name": "Hari Gopal", "link": "https://stackoverflow.com/users/1425158/hari-gopal"}, "reply_to_user": {"reputation": 209, "user_id": 10456876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40421f1e126c40b97c8a9378104031e5?s=128&d=identicon&r=PG&f=1", "display_name": "User7777", "link": "https://stackoverflow.com/users/10456876/user7777"}, "edited": false, "score": 0, "creation_date": 1555356437, "post_id": 55694089, "comment_id": 98074471, "body": "@Navroop Which part would you like me to explain? I&#39;ll expand the post, where required."}], "tags": [], "owner": {"reputation": 718, "user_id": 1425158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe9cf6d118847f6a05682972a2d1ea6b?s=128&d=identicon&r=PG", "display_name": "Hari Gopal", "link": "https://stackoverflow.com/users/1425158/hari-gopal"}, "is_accepted": false, "score": 0, "last_activity_date": 1555347717, "creation_date": 1555347717, "answer_id": 55694089, "question_id": 55693257, "link": "https://stackoverflow.com/questions/55693257/store-value-from-another-table-form-in-rails/55694089#55694089", "title": "Store value from another table form in rails", "body": "<p>I'm going to answer this question assuming that this form is meant to create a <code>Game</code>, which <code>belongs_to :user</code>, since there is a <code>user_id</code> in the form, and that <code>user.city_of_birth</code> is a string.</p>\n\n<p>The traditional way to do this would be to use the<code>accepts_nested_attributes_for</code> feature of Rails.</p>\n\n<p><a href=\"https://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html</a></p>\n\n<p><strong>However</strong>, I would strongly suggest that you consider writing a <em>form object</em> to handle this, so that the responsibility for validating this mixed-model form is held cleanly in one place. I suggest using a gem like <a href=\"https://github.com/trailblazer/reform\" rel=\"nofollow noreferrer\">Reform</a> to make this process easier.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/forms/games/new_game_form.rb\nclass Games::NewGameForm &lt; Reform::Form\n  property :user_id, validates: { presence: true }\n  property :city_of_birth, virtual: true, validates: { presence: true }\n  property :game_name, validates: { presence: true }\n\n  def save\n    Game.transaction do\n     user.update!(city_of_birth: city_of_birth)\n     Game.create(user: user, game_name: game_name) \n  end\n\n  def user\n    @user ||= User.find(user_id)\n  end\nend\n</code></pre>\n\n<p>This form object can then be used in place of the <code>Game</code> instance.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># GamesController\ndef new\n  @form = Games::NewGameForm.new(Game.new)\nend\n</code></pre>\n\n<pre><code>&lt;!-- new.html.erb --&gt;\n&lt;%= form_with @form, url: games_path, method: :post do |f| %&gt;\n  &lt;!-- your form fields --&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please note that it appears very <em>odd</em> that you're accepting a <code>user_id</code> in the form, but also reading the <code>city_of_birth</code> from <code>@user</code>. If the <code>@user</code> for whom the game is being created is already known (perhaps the signed in user), then it's useless (and a security risk) to accept the ID in the form - you can simply use the same method that was used to set <code>@user</code>.</p>\n"}], "owner": {"reputation": 209, "user_id": 10456876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40421f1e126c40b97c8a9378104031e5?s=128&d=identicon&r=PG&f=1", "display_name": "User7777", "link": "https://stackoverflow.com/users/10456876/user7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555347717, "creation_date": 1555344577, "question_id": 55693257, "link": "https://stackoverflow.com/questions/55693257/store-value-from-another-table-form-in-rails", "title": "Store value from another table form in rails", "body": "<p>I have a users table and games table. Games table has user_id. The help I want is how can I change/enter the value of city of birth from the game's form which is a field in the user table. I am using the try() method to display the value of city of birth from the user table in the game's form. </p>\n\n<p>user.rb</p>\n\n<pre><code>has_many :games, dependent: :destroy\n</code></pre>\n\n<p>game.rb</p>\n\n<pre><code>belongs_to :user\n</code></pre>\n\n<p>_form.html.erb(game)</p>\n\n<pre><code>&lt;div class=\"custom-hidden field\"&gt;\n    &lt;%= form.label :user_id %&gt;\n    &lt;%= form.number_field :user_id %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :city_of_birth, \"User City of Birth\" %&gt;\n    &lt;%= form.text_field :city_of_birth, :value =&gt; @user.try(:city_of_birth) %&gt;\n  &lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= form.label :game_name %&gt;\n  &lt;%= form.text_field :game_name %&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver"], "comments": [{"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1565728715, "post_id": 55692504, "comment_id": 101441137, "body": "you can set the webdriver to accept all alerts.  The &quot;ignore&quot; setting will throw the unexpected alert error.  See &quot;setUnhandledPromptBehaviour&quot; of ChromeOptions: <a href=\"https://seleniumhq.github.io/selenium/docs/api/java/org/openqa/selenium/chrome/ChromeOptions.html#setUnhandledPromptBehaviour-org.openqa.selenium.UnexpectedAlertBehaviour-\" rel=\"nofollow noreferrer\">seleniumhq.github.io/selenium/docs/api/java/org/openqa/selen&zwnj;&#8203;ium/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11364071, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHVXi644cpI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdePMHIgWx4_wHQDC5lEqXvW4V96Q/mo/photo.jpg?sz=128", "display_name": "Phil Collins", "link": "https://stackoverflow.com/users/11364071/phil-collins"}, "edited": false, "score": 0, "creation_date": 1556028845, "post_id": 55786877, "comment_id": 98293212, "body": "Thank you for your response Thomas! Unfortunately, this doesn&#39;t help. I&#39;ve looked into the issue further and explained it above."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 21, "user_id": 11364071, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHVXi644cpI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdePMHIgWx4_wHQDC5lEqXvW4V96Q/mo/photo.jpg?sz=128", "display_name": "Phil Collins", "link": "https://stackoverflow.com/users/11364071/phil-collins"}, "edited": false, "score": 0, "creation_date": 1556031679, "post_id": 55786877, "comment_id": 98294964, "body": "@PhilCollins what version of Capybara are you using and have you disabled the normal session resetting? In the default configuration a recent version of Capybara should suppress alerts handle alerts when attempting to reset"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1555881854, "creation_date": 1555881854, "answer_id": 55786877, "question_id": 55692504, "link": "https://stackoverflow.com/questions/55692504/how-to-fix-unexpected-alert-open-alert-text-error/55786877#55786877", "title": "How to fix &quot;unexpected alert open: {Alert text : } &quot; error", "body": "<p>The reason you're seeing this is that Poltergesit/PhantomJS used to automatically accept unexpected system modals. The selenium driver doesn't do that because your test should actively either accept or decline it.  Is  <code>find('.sp-advanced-configuration').click</code> the action that opens the alert box?  From the errors you're getting I would guess not. The block <code>accept_alert</code> receives needs to be the block that actually triggers the opening of the system modal. This means your code probably needs to be</p>\n\n<pre><code>accept_alert { # action that triggers the alert }\nfind('.sp-advanced-configuration').click\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11364071, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dHVXi644cpI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdePMHIgWx4_wHQDC5lEqXvW4V96Q/mo/photo.jpg?sz=128", "display_name": "Phil Collins", "link": "https://stackoverflow.com/users/11364071/phil-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 961, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1556028797, "creation_date": 1555341979, "last_edit_date": 1556028797, "question_id": 55692504, "link": "https://stackoverflow.com/questions/55692504/how-to-fix-unexpected-alert-open-alert-text-error", "title": "How to fix &quot;unexpected alert open: {Alert text : } &quot; error", "body": "<p>I have a project in ruby with AngularJS and I'm currently converting tests over to Headless chrome from Phantomjs, and I keep getting an error:</p>\n\n<pre><code>Selenium::WebDriver::Error::UnhandledAlertError:\n            unexpected alert open: {Alert text : }\n</code></pre>\n\n<p>This happens throughout multiple test files..\nI have tried adding </p>\n\n<p>\"accept_alert {} \" before a command :</p>\n\n<pre><code>#from\n\nfind('.sp-advanced-configuration').click\n\n#to\naccept_alert{ find('.sp-advanced-configuration').click  } \n\n</code></pre>\n\n<p>but receive </p>\n\n<pre><code>Failure/Error: accept_alert{ ... }\n\n          Capybara::ModalNotFound:\n            Unable to find modal dialog\n\n</code></pre>\n\n<p>as well as</p>\n\n<pre><code>Selenium::WebDriver::Error::UnhandledAlertError:\n            unexpected alert open: {Alert text : }\n</code></pre>\n\n<p>Not sure what else to try</p>\n\n<p>/*********** *********/</p>\n\n<p>After looking into this further, It seems the issue occurs whenever there are unsaved changes left on the test before moving onto the next test. </p>\n\n<p>Is there a way where you can accept this for every test without having to add </p>\n\n<pre><code> after do \n    execute_script('window.onbeforeunload = undefined')\n  end\n</code></pre>\n\n<p>in every test file?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git"], "comments": [{"owner": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "edited": false, "score": 0, "creation_date": 1555342440, "post_id": 55692039, "comment_id": 98068047, "body": "<a href=\"https://stackoverflow.com/search?q=%5Bruby%5D+pwd+No+such+file+or+directory+getcwd+ENOENT\">stackoverflow.com/&hellip;</a>"}, {"owner": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "edited": false, "score": 0, "creation_date": 1555342484, "post_id": 55692039, "comment_id": 98068074, "body": "The problem seems to be caused by a background process that expects the directory to be in its place."}, {"owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "edited": false, "score": 0, "creation_date": 1555349108, "post_id": 55692039, "comment_id": 98071362, "body": "Possibly duplicate of <a href=\"https://stackoverflow.com/questions/9243548/no-such-file-or-directory-getcwd-error-on-rubygems-on-mac-os-lion\" title=\"no such file or directory getcwd error on rubygems on mac os lion\">stackoverflow.com/questions/9243548/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "reply_to_user": {"reputation": 503, "user_id": 5057085, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/hDmH7.jpg?s=128&g=1", "display_name": "Coder_Nick", "link": "https://stackoverflow.com/users/5057085/coder-nick"}, "edited": false, "score": 0, "creation_date": 1555341241, "post_id": 55692107, "comment_id": 98067333, "body": "Well, we need error codes and more environment information. Your issue could be that you&#39;ve removed the directory (try exiting the console and cd-ing back in). Your issue could be that this is a Vagrant project and you havent&#39; added it back in. You maybe changed your environment and need to restart your bash session."}, {"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1555343811, "post_id": 55692107, "comment_id": 98068825, "body": "You should at least add some explanation to your answer about <b>why</b> that should be tried and how it solves the problem"}], "tags": [], "owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "is_accepted": false, "score": 0, "last_activity_date": 1555340767, "creation_date": 1555340767, "answer_id": 55692107, "question_id": 55692039, "link": "https://stackoverflow.com/questions/55692039/rake-commands-failing-on-cloned-rails-app/55692107#55692107", "title": "Rake commands failing on cloned rails app", "body": "<pre><code>sudo gem update --system\n</code></pre>\n\n<p>Give that a try. </p>\n"}, {"tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": false, "score": 0, "last_activity_date": 1555341272, "creation_date": 1555341272, "answer_id": 55692286, "question_id": 55692039, "link": "https://stackoverflow.com/questions/55692039/rake-commands-failing-on-cloned-rails-app/55692286#55692286", "title": "Rake commands failing on cloned rails app", "body": "<p>It seems something happened to the folder that you were working on, such as renaming, deleting, etc. Try closing your terminal window and <code>cd</code>ing back to the application folder, then re-run the <code>rake db:seed</code> command.</p>\n"}], "owner": {"reputation": 503, "user_id": 5057085, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/hDmH7.jpg?s=128&g=1", "display_name": "Coder_Nick", "link": "https://stackoverflow.com/users/5057085/coder-nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555341272, "creation_date": 1555340550, "question_id": 55692039, "link": "https://stackoverflow.com/questions/55692039/rake-commands-failing-on-cloned-rails-app", "title": "Rake commands failing on cloned rails app", "body": "<p>I removed my local rails directory and git cloned a new one from my git repo.\nWhen I run the command rake db:seeds, I receive the following error.</p>\n\n<pre><code>...rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/rake-12.3.2/lib/rake/application.rb:58:in `pwd': No such file or directory - getcwd (Errno::ENOENT)\n</code></pre>\n\n<p>I've run bundle and can't think of anything that would cause the error. I've searched for this issue but couldn't find anything helpful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "super", "activesupport-concern"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1555336647, "creation_date": 1555336647, "answer_id": 55690812, "question_id": 55690687, "link": "https://stackoverflow.com/questions/55690687/in-rails-how-to-call-same-methods-on-every-concern-and-in-model/55690812#55690812", "title": "In Rails, how to call same methods on every concern and in model?", "body": "<blockquote>\n  <p>Can I run all 3 concerns <code>setup_defaults</code> and then the model\u2019s <code>setup_defaults</code>? Is this possible?</p>\n</blockquote>\n\n<p>Yes, and you already have it. The only bit you're missing is invoking your concerns from each other.</p>\n\n<pre><code>module ConcernOne\n  extend ActiveSupport::Concern\n  def setup_defaults\n    super if defined?(super) # do the same for other concerns and the model\n    puts 'one'\n  end\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Item.new.setup_defaults\n# &gt;&gt; one\n# &gt;&gt; two\n# &gt;&gt; three\n# &gt;&gt; main\n</code></pre>\n"}], "owner": {"reputation": 5735, "user_id": 269404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jHC9T.jpg?s=128&g=1", "display_name": "MintDeparture", "link": "https://stackoverflow.com/users/269404/mintdeparture"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 55690812, "answer_count": 1, "score": 0, "last_activity_date": 1555336647, "creation_date": 1555336267, "question_id": 55690687, "link": "https://stackoverflow.com/questions/55690687/in-rails-how-to-call-same-methods-on-every-concern-and-in-model", "title": "In Rails, how to call same methods on every concern and in model?", "body": "<p>I have a model and quite a few concerns, I want to call the same method from every concern and from the model itself, and I was wondering if this is possible.</p>\n\n<p>So let\u2019s say I have a model like this, it has three concerns and a setup_defaults method. </p>\n\n<pre><code>class Item &lt; ApplicationRecord\n    include ConcernOne\n    include ConcernTwo\n    include ConcernThree\n\n    def setup_defaults\n        # model code here\n    end\nend\n</code></pre>\n\n<p>I want to have a <code>setup_defaults</code> in each concern that runs as well as in the one in the model so it looks like this:</p>\n\n<pre><code>module ConcernOne\n    extend ActiveSupport::Concern\n    def setup_defaults\n        # concern one code\n    end\nend\n\nmodule ConcernTwo\n    extend ActiveSupport::Concern\n    def setup_defaults\n        # concern two code\n    end\nend\n\nmodule ConcernThree\n    extend ActiveSupport::Concern\n    def setup_defaults\n        # concern three code\n    end\nend\n</code></pre>\n\n<p>So I want <code>concern one code</code>, then <code>concern two code</code> then <code>concern one code</code> and then finally <code>model code here</code> to run in that order.</p>\n\n<p>I\u2019ve tried using super like this but it only runs the last concern code and then the model code:</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n    include ConcernOne\n    include ConcernTwo\n    include ConcernThree\n\n    def setup_defaults\n        super\n        # model code here\n    end\nend\n</code></pre>\n\n<p>Can I run all 3 concerns <code>setup_defaults</code> and then the model\u2019s <code>setup_defaults</code>?  Is this possible?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "cucumber", "capybara", "poltergeist"], "comments": [{"owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "edited": false, "score": 0, "creation_date": 1555339122, "post_id": 55690338, "comment_id": 98066038, "body": "poltergeist depends on phantomjs, which is now <a href=\"https://github.com/ariya/phantomjs/issues/15344\" rel=\"nofollow noreferrer\">archived</a>. I&#39;d recommend switching to selenium / headless chrome. As for the issue you&#39;re having, there&#39;s a relate issue <a href=\"https://github.com/teampoltergeist/poltergeist/issues/677#issuecomment-222919584\" rel=\"nofollow noreferrer\">here</a>. Seems a slow asset compile step was the issue for most people in the thread."}, {"owner": {"reputation": 404, "user_id": 1888553, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WznXZ.jpg?s=128&g=1", "display_name": "Derrell Durrett", "link": "https://stackoverflow.com/users/1888553/derrell-durrett"}, "edited": false, "score": 0, "creation_date": 1571434455, "post_id": 55690338, "comment_id": 103253802, "body": "My searches led me here, and I have (tried to) switch to <code>Selenium &#47; headless Chrome</code>, but I&#39;m getting the same answers."}], "owner": {"reputation": 346, "user_id": 2660223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1945cd9c32f2ab8b5efdfcfaffb5aa?s=128&d=identicon&r=PG", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/2660223/amit-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555335082, "creation_date": 1555335082, "question_id": 55690338, "link": "https://stackoverflow.com/questions/55690338/cucumber-poltergeist-strange-error-while-running-code", "title": "Cucumber, poltergeist strange error, while running code", "body": "<p>I am getting below error while executing Cucumber test cases, </p>\n\n<p>Below mentioned error details, when I execute command cucumber </p>\n\n<pre><code>\u279c  cart git:(master) \u2717 cucumber\nFeature: To see cart options\n  Everybody should see all cart menus\n\n  Scenario: should see menu title                          # features/cart_homepage.feature:4\n    Given I am on the home page                            # features/step_definitions/homepage.rb:1\n      Request to '/' failed to reach server, check DNS and/or server status (Capybara::Poltergeist::StatusFailError)\n      ./features/step_definitions/homepage.rb:2:in `\"I am on the home page\"'\n      features/cart_homepage.feature:5:in `Given I am on the home page'\n    When I visit homepage I should see title as Menu Items # features/step_definitions/homepage.rb:5\n\nFailing Scenarios:\ncucumber features/cart_homepage.feature:4 # Scenario: should see menu title\n\n1 scenario (1 failed)\n2 steps (1 failed, 1 skipped)\n</code></pre>\n\n<p>Ruby Code which is creating issues. </p>\n\n<pre><code>Given(\"I am on the home page\") do\n  visit \"/\"\nend\n\nWhen(\"I visit homepage I should see title as Menu Items\") do\n  pending # Write code here that turns the phrase above into concrete actions\nend\n</code></pre>\n"}, {"tags": ["javascript", "ruby", "reactjs", "opalrb", "hyperstack"], "answers": [{"comments": [{"owner": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "edited": false, "score": 0, "creation_date": 1555337178, "post_id": 55690722, "comment_id": 98064866, "body": "Hi, not quite what I&#39;m looking for. Functional components are a little different from class-based components and allow the use of hooks, which libraries are moving towards: <a href=\"https://reactjs.org/docs/hooks-intro.html\" rel=\"nofollow noreferrer\">reactjs.org/docs/hooks-intro.html</a>"}], "tags": [], "owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "is_accepted": false, "score": 0, "last_activity_date": 1555336382, "creation_date": 1555336382, "answer_id": 55690722, "question_id": 55690284, "link": "https://stackoverflow.com/questions/55690284/can-i-make-a-functional-component-in-hyperstack/55690722#55690722", "title": "Can I make a functional component in Hyperstack?", "body": "<pre><code>example = Example().as_node\n# then you can do\nexample.render \n# or anything else you want with the example object\nAnother(example_component: example) # to pass it as a param\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1555345592, "last_edit_date": 1555345592, "creation_date": 1555339530, "answer_id": 55691723, "question_id": 55690284, "link": "https://stackoverflow.com/questions/55690284/can-i-make-a-functional-component-in-hyperstack/55691723#55691723", "title": "Can I make a functional component in Hyperstack?", "body": "<p>No, you cannot.  See <a href=\"https://github.com/hyperstack-org/hyperstack/issues/167\" rel=\"nofollow noreferrer\">https://github.com/hyperstack-org/hyperstack/issues/167</a> for why.  Basic answer: the Hyperstack DSL already solves the major issues solved by functional components, and the negatives of adding functional components (there are some) then outweigh any advantages.</p>\n\n<p>Note that you can import functional components from JS libraries just fine.</p>\n"}], "owner": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55691723, "answer_count": 2, "score": 1, "last_activity_date": 1555345592, "creation_date": 1555334929, "last_edit_date": 1555335399, "question_id": 55690284, "link": "https://stackoverflow.com/questions/55690284/can-i-make-a-functional-component-in-hyperstack", "title": "Can I make a functional component in Hyperstack?", "body": "<p>All of the documentation refers to creating components using classes. Can I make a functional component in order to leverage react hooks, and if so, how?</p>\n\n<p>To clarify, I can only find documentation for creation a class based component like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Example &lt; HyperComponent\n  render do\n    DIV { \"Example\" }\n  end\nend\n</code></pre>\n\n<p>Which would be equivelent to </p>\n\n<pre class=\"lang-js prettyprint-override\"><code>class Example extends React.Component {\n  render() {\n    return &lt;div&gt;Example&lt;/div&gt;\n  }\n}\n</code></pre>\n\n<p>I want to recreate the following:</p>\n\n<pre><code>() =&gt; {\n  return &lt;div&gt;Example&lt;/div&gt;\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "edited": false, "score": 0, "creation_date": 1555330203, "post_id": 55688478, "comment_id": 98060703, "body": "Thanks Umesh. I never guess that.  The regex [^0-9] works very well with my python flask and Django apps.  you saved my time."}], "tags": [], "owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "is_accepted": true, "score": 0, "last_activity_date": 1555328747, "creation_date": 1555328747, "answer_id": 55688478, "question_id": 55688363, "link": "https://stackoverflow.com/questions/55688363/how-to-allow-only-numeric-charaters-using-preg-replace-in-ruby-and-ruby-on-rails/55688478#55688478", "title": "How to allow only numeric charaters using preg_replace in ruby and ruby on rails", "body": "<pre><code>mystring= 'Food1248is read 100'    \nmystring.gsub(/\\D/, '')\n=&gt; \"1248100\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1555330202, "creation_date": 1555330202, "answer_id": 55688904, "question_id": 55688363, "link": "https://stackoverflow.com/questions/55688363/how-to-allow-only-numeric-charaters-using-preg-replace-in-ruby-and-ruby-on-rails/55688904#55688904", "title": "How to allow only numeric charaters using preg_replace in ruby and ruby on rails", "body": "<pre><code>mystring= 'Food1248is read 100'\np mystring.scan(/\\d+/).join\n</code></pre>\n\n<p>output</p>\n\n<pre><code>\"1248100\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 6941553, "user_type": "registered", "profile_image": "https://graph.facebook.com/1264893356888672/picture?type=large", "display_name": "Girish Bhanarkar", "link": "https://stackoverflow.com/users/6941553/girish-bhanarkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1555333112, "creation_date": 1555333112, "answer_id": 55689729, "question_id": 55688363, "link": "https://stackoverflow.com/questions/55688363/how-to-allow-only-numeric-charaters-using-preg-replace-in-ruby-and-ruby-on-rails/55689729#55689729", "title": "How to allow only numeric charaters using preg_replace in ruby and ruby on rails", "body": "<pre><code>mystring= 'Food1248is read 100'\nmystring.gsub(/[a-zA-Z]/, '').delete(' ')\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1248100\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 0, "last_activity_date": 1555334628, "creation_date": 1555334628, "answer_id": 55690193, "question_id": 55688363, "link": "https://stackoverflow.com/questions/55688363/how-to-allow-only-numeric-charaters-using-preg-replace-in-ruby-and-ruby-on-rails/55690193#55690193", "title": "How to allow only numeric charaters using preg_replace in ruby and ruby on rails", "body": "<p>In <code>str.gsub(\"/some regex/\", '')</code> \"/some regex/\" is not a regex, it is a string. <code>/some regex/</code> is a regex; just as <code>/[^0-9]/</code> which would work. </p>\n"}], "owner": {"reputation": 1697, "user_id": 10906068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394ab66161cce95d069d970a4d1f53ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Mooree", "link": "https://stackoverflow.com/users/10906068/nancy-mooree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55688478, "answer_count": 4, "score": 0, "last_activity_date": 1555334628, "creation_date": 1555328273, "question_id": 55688363, "link": "https://stackoverflow.com/questions/55688363/how-to-allow-only-numeric-charaters-using-preg-replace-in-ruby-and-ruby-on-rails", "title": "How to allow only numeric charaters using preg_replace in ruby and ruby on rails", "body": "<p>Am trying to allow and print only numeric characters.\nTo this effect, I have reference solution found here which uses \n<code>str.gsub(\"/some regex/\", '')</code> \nmethod but cannot get it to work.\n<a href=\"https://stackoverflow.com/questions/5791718/preg-match-all-and-preg-replace-in-ruby\">source</a>\nhere is the code</p>\n\n<pre><code> mystring= 'Food1248is read 100'\n    result = mystring.gsub(\"[^0-9]\", '')\n\n    print(result)\n</code></pre>\n\n<p>I need to only get the numbers from the string variable above</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1555333054, "post_id": 55688090, "comment_id": 98062320, "body": "What do you mean by <b>uniq</b> here? Unique as in uuid?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1555344746, "post_id": 55688090, "comment_id": 98069347, "body": "There&#39;s a one in 10^10 chance that will repeat. If that isn&#39;t enough use a larger range. For something very unlikely to repeat consider using a 64-bit random value, or a <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">UUID</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1555332200, "creation_date": 1555332200, "answer_id": 55689485, "question_id": 55688090, "link": "https://stackoverflow.com/questions/55688090/uniq-16-digit-random-number-in-ruby/55689485#55689485", "title": "Uniq 16 digit random number in ruby", "body": "<p>To make your number \"more random\", you should rather use</p>\n\n<pre><code>SecureRandom.random_number(10**16).to_s.rjust(16,'0')\n</code></pre>\n\n<p>Whether this is \"right\" or not would depend on the particular use case, which is not specified in your question.</p>\n\n<p>Note that you would get the same number after 10**16 calls (or earlier), there's no way you can avoid that.</p>\n"}], "owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555335536, "creation_date": 1555327272, "last_edit_date": 1555335536, "question_id": 55688090, "link": "https://stackoverflow.com/questions/55688090/uniq-16-digit-random-number-in-ruby", "title": "Uniq 16 digit random number in ruby", "body": "<p>I want to generate uniq number of 16 digit in ruby</p>\n\n<p>I am using this </p>\n\n<pre><code>SecureRandom.random_number(10**10).to_s.rjust(16,'0')\n</code></pre>\n\n<p>Is this right ?</p>\n\n<p>or it will repeate same number any point.</p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 6316, "user_id": 1184717, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/7f8710cd5754a79df5dc5cd3d5308da2?s=128&d=identicon&r=PG", "display_name": "Mr.", "link": "https://stackoverflow.com/users/1184717/mr"}, "edited": false, "score": 0, "creation_date": 1555480929, "post_id": 55687898, "comment_id": 98121328, "body": "what is the chef-client version and did you check whether your recipes are compatible with that version?"}, {"owner": {"reputation": 71, "user_id": 5740723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d0b27106df0fe56c512cff8cfdd9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Viraj Parab", "link": "https://stackoverflow.com/users/5740723/viraj-parab"}, "edited": false, "score": 0, "creation_date": 1556029484, "post_id": 55687898, "comment_id": 98293601, "body": "Hi looks like your chef-client version is updated and your recipes are not supported, please check you chef client version."}], "owner": {"reputation": 67, "user_id": 5080783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0Y3L5XarF00/AAAAAAAAAAI/AAAAAAAAABo/RbBwRHiy4QY/photo.jpg?sz=128", "display_name": "Leonardo Gialluisi", "link": "https://stackoverflow.com/users/5080783/leonardo-gialluisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555326551, "creation_date": 1555326551, "question_id": 55687898, "link": "https://stackoverflow.com/questions/55687898/after-upgrade-chef-server-cannot-boostrap-application", "title": "After upgrade chef server, cannot boostrap application", "body": "<p>We have chef-server 12.3.1 and all applications can bootstrap with no problems on the nodes.</p>\n\n<p>After upgrade to chef-server 12.19.26 we cannot bootstrap our application. We can install npm, nginx and others but our application raise the error on chef: FrozenError class.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aeGbi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aeGbi.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now we know that we are using Ruby 2.5 and this class was introduced on this verson.</p>\n\n<p>We are checking the problem with no success yet.</p>\n\n<p>We would like to know how to by pass this problem.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 1, "creation_date": 1555324099, "post_id": 55687159, "comment_id": 98057521, "body": "Lexicographic ordering. <code>c</code> is between <code>a</code> and <code>d</code>. What else would you expect?"}, {"owner": {"reputation": 295, "user_id": 6713321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dSYXJ.jpg?s=128&g=1", "display_name": "Tilak Dewangan", "link": "https://stackoverflow.com/users/6713321/tilak-dewangan"}, "reply_to_user": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 0, "creation_date": 1555324450, "post_id": 55687159, "comment_id": 98057715, "body": "Does it check for an only first letter? Because the 2nd letter is not in Lexicographic order. Correct me If I am wrong."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1555324706, "post_id": 55687159, "comment_id": 98057863, "body": "&quot;Does it check for an only first letter?&quot; \u2013 No, it doesn&#39;t. It checks lexicographically, i.e. first the first letter, then the second letter, then the third, and so on. That is what &quot;lexicographic&quot; <i>means</i>: ordered like in a lexicon."}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 2, "creation_date": 1555325901, "post_id": 55687159, "comment_id": 98058443, "body": "Since <code>cat</code> begins with c, it is lexicograhpically after <code>ant</code> and before <code>dog</code>. The second and third letters do not matter. If you had another word beginning with a, such as <code>art</code>, then the second letter would be checked to see if it is before or after the second letter of <code>ant</code>."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 5, "last_activity_date": 1555326621, "creation_date": 1555326621, "answer_id": 55687922, "question_id": 55687159, "link": "https://stackoverflow.com/questions/55687159/how-does-betweenmin-max-method-work-for-string/55687922#55687922", "title": "How does between?(min, max) method work for string?", "body": "<p>From <a href=\"https://ruby-doc.org/core/Comparable.html#method-i-between-3F\" rel=\"noreferrer\">the documentation</a>, <code>Comparable#between?</code> looks at the value of <code>comparable_object.&lt;=&gt;</code> for the min and max values in the range.</p>\n\n<p>In other words, <a href=\"https://ruby-doc.org/core/String.html#method-i-3C-3D-3E\" rel=\"noreferrer\">in this case</a>, it performs a <a href=\"https://en.wikipedia.org/wiki/Lexicographical_order\" rel=\"noreferrer\">lexicographical</a> check - i.e. <strong>\"which word comes first in a dictionary?\"</strong></p>\n\n<p>In a dictionary, those words appear in the order: <code>ant</code>, <code>cat</code>, <code>dog</code>, <code>gnu</code>.</p>\n\n<p>Therefore <code>cat</code> is between <code>ant</code> and <code>dog</code>, but <code>gnu</code> is not.</p>\n"}], "owner": {"reputation": 295, "user_id": 6713321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dSYXJ.jpg?s=128&g=1", "display_name": "Tilak Dewangan", "link": "https://stackoverflow.com/users/6713321/tilak-dewangan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55687922, "answer_count": 1, "score": 1, "last_activity_date": 1555331874, "creation_date": 1555323965, "last_edit_date": 1555331874, "question_id": 55687159, "link": "https://stackoverflow.com/questions/55687159/how-does-betweenmin-max-method-work-for-string", "title": "How does between?(min, max) method work for string?", "body": "<p>I have a doubt on <code>between?(min, max)</code> method. How does it actually work for string? Could anyone of you explain this?</p>\n\n<pre><code>'cat'.between?('ant', 'dog')   #=&gt; why this is true?\n'gnu'.between?('ant', 'dog')   #=&gt; why this is false?\n'acasdsdc'.between?('acaassdc','awadssde') #=&gt; why this is true?\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "edited": false, "score": 0, "creation_date": 1555328875, "post_id": 55686978, "comment_id": 98059997, "body": "try updating you&#39;re <code>bundler</code> version <code>gem update bundler</code> and try bundle."}, {"owner": {"reputation": 557, "user_id": 11191194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLwLO.jpg?s=128&g=1", "display_name": "Nandhini", "link": "https://stackoverflow.com/users/11191194/nandhini"}, "edited": false, "score": 1, "creation_date": 1555331389, "post_id": 55686978, "comment_id": 98061374, "body": "try running <code>spring stop</code> and then <code>bundle install</code>"}, {"owner": {"reputation": 3, "user_id": 9561541, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486788851546855/picture?type=large", "display_name": "Ho&#224;ng Li&#234;n", "link": "https://stackoverflow.com/users/9561541/ho%c3%a0ng-li%c3%aan"}, "edited": false, "score": 0, "creation_date": 1555343377, "post_id": 55686978, "comment_id": 98068581, "body": "sorry, when I run &quot;rails  generate devise:install&quot; it shows errors like up"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9561541, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486788851546855/picture?type=large", "display_name": "Ho&#224;ng Li&#234;n", "link": "https://stackoverflow.com/users/9561541/ho%c3%a0ng-li%c3%aan"}, "edited": false, "score": 0, "creation_date": 1555398792, "post_id": 55694568, "comment_id": 98086088, "body": "thank you, it done. but when i generate a controller , it shows same errors like up, pls help me."}], "tags": [], "owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "is_accepted": true, "score": 0, "last_activity_date": 1555349823, "creation_date": 1555349823, "answer_id": 55694568, "question_id": 55686978, "link": "https://stackoverflow.com/questions/55686978/how-to-fix-errors-when-install-gem-devise/55694568#55694568", "title": "How to fix errors when install gem &quot;devise&quot;?", "body": "<p>Are your RubyGems loaded in your PATH? try running as</p>\n\n<pre><code>bundle exec rails g devise:install\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9561541, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486788851546855/picture?type=large", "display_name": "Ho&#224;ng Li&#234;n", "link": "https://stackoverflow.com/users/9561541/ho%c3%a0ng-li%c3%aan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 55694568, "answer_count": 1, "score": 0, "last_activity_date": 1555349823, "creation_date": 1555323327, "last_edit_date": 1555349527, "question_id": 55686978, "link": "https://stackoverflow.com/questions/55686978/how-to-fix-errors-when-install-gem-devise", "title": "How to fix errors when install gem &quot;devise&quot;?", "body": "<p>I add gem \"devise\" in rails app, then run \"bundle install\", and it shows error like this::   </p>\n\n<blockquote>\n  <p>/home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootstrap-sass-3.3.7/lib/bootstrap-sass/version.rb:2:\n  warning: already initialized constant Bootstrap::VERSION<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootstrap-4.3.1/lib/bootstrap/version.rb:4:\n  warning: previous definition of VERSION was here<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootstrap-sass-3.3.7/lib/bootstrap-sass/version.rb:3:\n  warning: already initialized constant Bootstrap::BOOTSTRAP_SHA<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootstrap-4.3.1/lib/bootstrap/version.rb:5:\n  warning: previous definition of BOOTSTRAP_SHA was here<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/message_encryptor.rb:206:in\n  rescue in _decrypt: ActiveSupport::MessageEncryptor::InvalidMessage<br>\n  (ActiveSupport::MessageEncryptor::InvalidMessage) from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/message_encryptor.rb:183:in\n  `_decrypt' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/message_encryptor.rb:157:in\n  'decrypt_and_verify' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/messages/rotator.rb:21:in\n  'decrypt_and_verify' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/encrypted_file.rb:79:in\n  decrypt from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/encrypted_file.rb:42:in\n  'read' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/encrypted_configuration.rb:21:in\n  read from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/encrypted_configuration.rb:33:in\n  'config' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/encrypted_configuration.rb:38:in\n  'options' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/core_ext/module/delegation.rb:271:in\n  'method_missing' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/devise-4.6.2/lib/devise/secret_key_finder.rb:24:in\n  'key_exists?' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/devise-4.6.2/lib/devise/secret_key_finder.rb:10:in\n  'find' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/devise-4.6.2/lib/devise/rails.rb:37:in\n  'block in ' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:32:in\n  'instance_exec' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:32:in\n  'run' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:61:in\n  'block in run_initializers' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:228:in<br>\n  'block in tsort_each' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:350:in<br>\n  block (2 levels) in each_strongly_connected_component' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:431:in<br>\n  each_strongly_connected_component_from' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:349:in<br>\n  block in each_strongly_connected_component' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:347:in<br>\n  each' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:347:in<br>\n  call' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:347:in<br>\n  each_strongly_connected_component' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:226:in<br>\n  tsort_each' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/tsort.rb:205:in<br>\n  tsort_each' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:60:in\n  run_initializers' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.3/lib/rails/application.rb:361:in\n  initialize!' from<br>\n  /home/hoanglien/Rails/dating-app/config/environment.rb:5:in '<br>\n  from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.4.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in\n  require' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.4.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in\n  block in require_with_bootsnap_lfi' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.4.3/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in\n  register' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.4.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in\n  require_with_bootsnap_lfi' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.4.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in\n  require' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in    block in require' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in    load_dependency' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in    require' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:102:in\n  preload' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:153:in\n  serve' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:141:in\n  block in run' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:135:in\n  loop' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/application.rb:135:in\n  run' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/application/boot.rb:19:in\n  ' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in\n  require' from<br>\n  /home/hoanglien/.rbenv/versions/2.5.1/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in\n  require' from -e:1:in ' **</p>\n</blockquote>\n\n<p>In my gemfile:</p>\n\n<pre><code>    \"https://rubygems.org\" git_source(:github) { |repo|  \"https://github.com/#{repo}.git\" }\nruby \"2.5.1\"\n    gem \"rails\", \"~&gt;5.2.3\"\n    gem \"puma\", \"~&gt; 3.11\"\n    gem \"mysql2\", \"&gt;= 0.4.4\", \"&lt; 0.6.0\"\n    gem \"sass-rails\", \"~&gt; 5.0\"\n    gem \"uglifier\", \"&gt;= 1.3.0\"\n    gem \"turbolinks\",    \"~&gt; 5\"\n    gem \"jbuilder\", \"~&gt; 2.5\"\n    gem \"bootstrap\", \"~&gt; 4.0\"\n    gem \"bootstrap-sass\", \"3.3.7\"\n    gem \"jquery-rails\", \"~&gt; 4.3\", \"&gt;= 4.3.1\"\n    gem \"bootsnap\", \"&gt;= 1.1.0\", require: false\n    gem \"i18n\"\n    gem \"i18n-js\"\n    gem \"config\"\n    gem \"devise\"\n   group :development, :test do\n     gem \"byebug\",    platforms: [:mri, :mingw, :x64_mingw]\n   end\n   group :development do\n     gem \"web-console\", \"&gt;= 3.3.0\"\n     gem \"listen\", \"&gt;= 3.0.5\", \"&lt; 3.2\"\n     gem \"spring\"\n     gem \"spring-watcher-listen\", \"~&gt; 2.0.0\"\n   end\n   group :test do\n     gem \"capybara\", \"&gt;= 2.15\"\n     gem \"selenium-webdriver\"\n     gem \"chromedriver-helper\"\n     gem \"tzinfo-data\", platforms: [:mingw,    :mswin, :x64_mingw, :jruby]\n   end\n</code></pre>\n"}, {"tags": ["ruby", "callback", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 11345395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpEXg.jpg?s=128&g=1", "display_name": "Dmitriy Pankratov", "link": "https://stackoverflow.com/users/11345395/dmitriy-pankratov"}, "is_accepted": false, "score": 0, "last_activity_date": 1555322539, "creation_date": 1555322539, "answer_id": 55686740, "question_id": 55686509, "link": "https://stackoverflow.com/questions/55686509/how-to-set-a-max-wait-time-for-each-response-and-go-to-next-step-if-no-respons/55686740#55686740", "title": "How to set a &quot;max wait time&quot; for each response and go to next step if no response was giving", "body": "<p>You should use Net::HTTP open_timeout and read_timeout</p>\n"}], "owner": {"reputation": 7, "user_id": 10979084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9f9a03749777705cc138386a9bec04?s=128&d=identicon&r=PG&f=1", "display_name": "V alves", "link": "https://stackoverflow.com/users/10979084/v-alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555322609, "creation_date": 1555321687, "last_edit_date": 1555322609, "question_id": 55686509, "link": "https://stackoverflow.com/questions/55686509/how-to-set-a-max-wait-time-for-each-response-and-go-to-next-step-if-no-respons", "title": "How to set a &quot;max wait time&quot; for each response and go to next step if no response was giving", "body": "<p>In my application I'm doing few different calls to some third-party APIs. </p>\n\n<p>How am I able to set a \"max wait time\" for response so after for instance 200 milliseconds, if no response was giving by the service I can go to the next service API, down in the \"ladder\".</p>\n\n<p>One of the methods that can be use in the <code>sleep</code>, like: <code>sleep(0.2)</code>, but sleep just waits 0.2 sec before executing the call instead of let the call happen and if no response, move on.</p>\n\n<p>Any tips or help is very much appreciated and thanks in advance</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1555320229, "post_id": 55686087, "comment_id": 98055669, "body": "Pin is not a number, it&#39;s a string. The rule of thumb is: if you don&#39;t need to do math on it, don&#39;t store it as a number."}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1555320287, "post_id": 55686087, "comment_id": 98055701, "body": "Use a RegExp match, maybe -- <code>self.pin =~ &#47;\\d{4,}&#47;</code>? Also, <code>has_pin?</code> should have returned <code>false</code> for any exception, whereas your code returns <code>nil</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 1, "creation_date": 1555320578, "post_id": 55686087, "comment_id": 98055840, "body": "@31piy <code>pin.size &gt;= 4</code> :shrug: And handle digit validation when saving the pin."}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555320716, "post_id": 55686087, "comment_id": 98055909, "body": "@SergioTulentsev -- Agreed! It should be the correct approach."}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321013, "post_id": 55686087, "comment_id": 98056049, "body": "very valid comments. some users don&#39;t have a PIN set tho, so .size will throw undefined method. Others have some letters in it, I think they pressed their digits for too long on their phone and it entered the letter instead of the digit. This has to be user-proof :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555321064, "post_id": 55686087, "comment_id": 98056073, "body": "@NickM: &quot;so .size will throw undefined method&quot; - trivial to guard against. We give you ideas, it&#39;s your job to make it bullet- and user-proof :)"}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321089, "post_id": 55686087, "comment_id": 98056081, "body": "That&#39;s right Sergio! Cheers"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1555321013, "post_id": 55686295, "comment_id": 98056048, "body": "&quot;as easy to understand as possible&quot; - to that end, maybe extract the regex into a <code>has_at_least_n_digits(pin, 4)</code>, or something. Maybe it&#39;s just me, but I always, always trip on regexes."}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321150, "post_id": 55686295, "comment_id": 98056113, "body": "Thank you! how about cost? won&#39;t matching a regex be a bit more expensive than a .size or a &gt; 1000?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321223, "post_id": 55686295, "comment_id": 98056148, "body": "@NickM: yes, regex is slower. You&#39;ll fix this when you measure it to be a bottleneck."}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321265, "post_id": 55686295, "comment_id": 98056167, "body": "I have over 1000-2000 concurrents at peak business hours, can&#39;t afford the debt. Although my reason for this Q is not performance mainly, but overall code quality."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321380, "post_id": 55686295, "comment_id": 98056232, "body": "@NickM: in any case, don&#39;t do the <code>.to_i &gt; 1000</code>. It&#39;s simply wrong. Here&#39;s a valid pin that will be rejected: <code>0001</code>"}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555321685, "post_id": 55686295, "comment_id": 98056384, "body": "I think they might have wanted it to be a bit more secure than that"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555322093, "post_id": 55686295, "comment_id": 98056598, "body": "@NickM: how is <code>0578</code> is any &quot;less secure&quot; than <code>1234</code>? Don&#39;t be one of those apps we all hate (the kind that rejects my password on the grounds of it not having a number, despite it being a 7-word diceware passphrase)"}, {"owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "edited": false, "score": 0, "creation_date": 1555324587, "post_id": 55686295, "comment_id": 98057797, "body": "You&#39;re right Sergio, no point annoying them users. So maybe: self.pin.size == 4 &amp;&amp; self.pin.to_i &gt; 0?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1555325541, "post_id": 55686295, "comment_id": 98058236, "body": "<code>pin.size == 4</code> doesn&#39;t handle 4+ pins. <code>pin.to_i &gt; 0</code> would fail for <code>0000</code>. You might want to store the regexp in a constant when you want to avoid the performance drawbacks of re-creating the regexp."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1555320852, "creation_date": 1555320852, "answer_id": 55686295, "question_id": 55686087, "link": "https://stackoverflow.com/questions/55686087/validating-a-pin-entered-by-users/55686295#55686295", "title": "Validating a PIN entered by users", "body": "<p>I would go with:</p>\n\n<pre><code>def pin_valid?\n  pin.present? &amp;&amp; pin.match?(/\\A\\d{4,}\\z/)\nend\n</code></pre>\n\n<p>Why do you aim to have your code as short as possible? I would always aim to have my code as easy to understand as possible.</p>\n"}], "owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55686295, "answer_count": 1, "score": 0, "last_activity_date": 1555320852, "creation_date": 1555320128, "last_edit_date": 1555320434, "question_id": 55686087, "link": "https://stackoverflow.com/questions/55686087/validating-a-pin-entered-by-users", "title": "Validating a PIN entered by users", "body": "<p>How would you refactor this code that checks if users have added a 4+ digit PIN so the code will be as short as possible?</p>\n\n<pre><code>def has_pin?\n  return self.pin.to_i &gt; 1000 rescue nil\n  false\nend\n</code></pre>\n\n<p>Ideally without using AR validation on user creation time as they're created with no PIN at first, but may choose to add them later in some specific cases.</p>\n\n<p>PS: the PIN is stored as string for some reason.</p>\n"}]