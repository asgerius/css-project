[{"tags": ["ruby", "nginx", "heroku", "middleman"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1496281600, "post_id": 44296339, "comment_id": 75600349, "body": "long shot... what&#39;s the value of <code>config.force_ssl</code> in your <code>production.rb</code>?"}, {"owner": {"reputation": 392, "user_id": 992620, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/210d24eb9c73f9ec5a0aa594e78e182e?s=128&d=identicon&r=PG", "display_name": "Ben Scheib", "link": "https://stackoverflow.com/users/992620/ben-scheib"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1496286824, "post_id": 44296339, "comment_id": 75601594, "body": "I don&#39;t have a production.rb. This is a Middleman app <a href=\"https://middlemanapp.com/\" rel=\"nofollow noreferrer\">middlemanapp.com</a>. I&#39;m assuming this issue is similar to <a href=\"https://stackoverflow.com/questions/35279994/why-is-heroku-trimming-trailing-slashes/35390428\" title=\"why is heroku trimming trailing slashes\">stackoverflow.com/questions/35279994/&hellip;</a> however slightly different (reversed actually because it&#39;s a lack of trailing slashes causing the problem)"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496292397, "post_id": 44296339, "comment_id": 75602983, "body": "check your <code>application.rb</code> for ssl related stuff/config"}], "owner": {"reputation": 392, "user_id": 992620, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/210d24eb9c73f9ec5a0aa594e78e182e?s=128&d=identicon&r=PG", "display_name": "Ben Scheib", "link": "https://stackoverflow.com/users/992620/ben-scheib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1496279314, "creation_date": 1496274454, "last_edit_date": 1496279314, "question_id": 44296339, "link": "https://stackoverflow.com/questions/44296339/heroku-redirecting-https-urls-without-trailing-slash-to-http", "title": "heroku redirecting https urls without trailing slash to http", "body": "<p>I have a ruby app with an Nginx config on Heroku. there are no rules for https->http or http->https for trailing slashes, however all my urls seem to make several hops unecessarily when trailing slashes are not present.</p>\n\n<p><a href=\"https://www.someurl.com\" rel=\"nofollow noreferrer\">https://www.someurl.com</a></p>\n\n<p>goes to</p>\n\n<p><a href=\"http://www.someurl.com/\" rel=\"nofollow noreferrer\">http://www.someurl.com/</a></p>\n\n<p>Urls with trailing slashes work as expected. Anybody else experience this issue?</p>\n"}, {"tags": ["arrays", "ruby", "regex", "string"], "answers": [{"comments": [{"owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496275436, "post_id": 44296340, "comment_id": 75599036, "body": "One more issue is that the original regex had alternation (created by <code>Regexp.union</code>) inside of a character class (the square brackets)."}, {"owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496275785, "post_id": 44296340, "comment_id": 75599117, "body": "Although this only seems to cause the <code>b</code> to falsely return true when you have the <code>(?-mix:)</code> structure."}, {"owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496276095, "post_id": 44296340, "comment_id": 75599186, "body": "Ah yes, it&#39;s interpreting <code>?-m</code> as a character range inside the character class, which includes <code>b</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496334906, "post_id": 44296340, "comment_id": 75631260, "body": "Alternation can&#39;t occur inside a character set, all characters inside the set are equally important and all are honored, so <code>|</code> has no special meaning. <code>?-m</code> isn&#39;t interpreted as a range, because <code>(?-</code> is a token. See the documentation for &quot;options&quot; mentioned at the bottom of the answer."}, {"owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496360809, "post_id": 44296340, "comment_id": 75642936, "body": "Right, I meant that the output of <code>Regexp.union</code> is supposed to be alternation, but putting it inside of the square brackets makes it so it doesn&#39;t work. I do think it&#39;s being interpreted as a range, at least in the version of Ruby I&#39;ve got open at the moment (2.0). Running <code>&quot;b&quot; =~ &#47;^[(?-mix:m|o)]$&#47;</code> returns 0, while changing the range to exclude <code>b</code> (that is, <code>&quot;b&quot; =~ &#47;^[(?-aix:m|o)]$&#47;</code>) makes it return nil. If that isn&#39;t going on, how do you explain that <code>&#39;b&#39;</code> gets matched by the OP&#39;s original regex? I don&#39;t see anything in the &quot;options&quot; documentation addressing that."}, {"owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496363167, "post_id": 44296340, "comment_id": 75643484, "body": "To be clear, I don&#39;t mean that <code>?-m</code> is interpreted as a range in your regex, just that it seems to work that way inside the character class in OP&#39;s original regex."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 3, "last_activity_date": 1496275199, "last_edit_date": 1496275199, "creation_date": 1496274466, "answer_id": 44296340, "question_id": 44296269, "link": "https://stackoverflow.com/questions/44296269/how-to-match-a-string-from-an-array-at-the-beginning-of-another-string/44296340#44296340", "title": "How to match a string from an array at the beginning of another string", "body": "<p>I'd use:</p>\n\n<pre><code>TOKENS = [\"m\", \"o\"]\nDATA_COL = [\"M\", \"b\", \"Mabc\", \"abc m b\"]\nRE = /^(?:#{Regexp.union(TOKENS).source})(?: |$)/i\n\nDATA_COL.select{ |string| string[RE] }\n# =&gt; [\"M\"]\n</code></pre>\n\n<p>Breaking it down a bit:</p>\n\n<pre><code>Regexp.union(TOKENS).source # =&gt; \"m|o\"\n/^(?:#{Regexp.union(TOKENS).source})(?: |$)/i # =&gt; /^(?:m|o)(?: |$)/i\n</code></pre>\n\n<hr>\n\n<p><code>/^[#{Regexp.union(TOKENS)}]([[:space:]]|$)/i</code> isn't a good idea inside a loop. Each time through you force Ruby to create the pattern; Efficiency is important inside loops, especially big ones, so create the pattern outside the loop then refer to the pattern inside.</p>\n\n<p>The next problem is that <code>Regexp.union</code> has a concept of the correct case it should match:</p>\n\n<pre><code>Regexp.union(TOKENS).to_s        # =&gt; \"(?-mix:m|o)\"\n</code></pre>\n\n<p>The <code>(?-mix:</code> part is how the Regular Expression engine remembers the flags for the pattern. When the pattern is embedded inside another pattern they continue to know what they should look for, causing us to gnash our teeth and weep:</p>\n\n<pre><code>/#{Regexp.union(TOKENS)}/i # =&gt; /(?-mix:m|o)/i\n</code></pre>\n\n<p>The trailing <code>i</code> is telling the pattern it should ignore case, but the embedded <code>i</code> is not set so it's honoring case. And that's what is breaking your pattern.</p>\n\n<p>The fix is to use <code>source</code> when embedding like I did above.</p>\n\n<p>See the Regex \"<a href=\"https://ruby-doc.org/core/doc/regexp_rdoc.html#label-Options\" rel=\"nofollow noreferrer\">options</a>\" section for more information.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44296340, "answer_count": 1, "score": 1, "last_activity_date": 1496285540, "creation_date": 1496273813, "last_edit_date": 1496275716, "question_id": 44296269, "link": "https://stackoverflow.com/questions/44296269/how-to-match-a-string-from-an-array-at-the-beginning-of-another-string", "title": "How to match a string from an array at the beginning of another string", "body": "<p>I want to case-insensitively match a string from my array, <code>TOKENS</code>, at the beginning of another string followed by a space or the end of the line.</p>\n\n<p>My tokens array looks like:</p>\n\n<pre><code>2.4.0 :013 &gt; TOKENS = [\"m\", \"o\"]\n =&gt; [\"m\", \"o\"]\n</code></pre>\n\n<p>When I try to match each element from my array, it is picking out the wrong results:</p>\n\n<pre><code>2.4.0 :009 &gt; data_col = [\"M\", \"b\", \"Mabc\", \"abc m b\"]\n =&gt; [\"M\", \"b\", \"Mabc\", \"abc m b\"]\n...\n2.4.0 :015 &gt; data_col.select{|string| string =~ /^[#{Regexp.union(TOKENS)}]([[:space:]]|$)/i }\n =&gt; [\"M\", \"b\"]\n</code></pre>\n\n<p>This is matching both the \"M\" and the \"b\" entries even though \"b\" does not appear in my list of TOKENS.  How do I modify my regular expression so that only the proper value, \"M\" will be matched?</p>\n\n<p>I'm using Ruby 2.4.  </p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 6, "creation_date": 1496272854, "post_id": 44296102, "comment_id": 75598400, "body": "Request is a really bad model name as you end up masking the request object (the incoming request) and it makes things very confusing to reason about."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8075439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b2745d6560ec506029f84730ffca94?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/8075439/ben"}, "edited": false, "score": 0, "creation_date": 1496347495, "post_id": 44298108, "comment_id": 75637996, "body": "I attempted this and it continued to not work. The links send me to the url &quot;request.1&quot; instead of &quot;requests/1&quot;"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 21, "user_id": 8075439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b2745d6560ec506029f84730ffca94?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/8075439/ben"}, "edited": false, "score": 0, "creation_date": 1496376472, "post_id": 44298108, "comment_id": 75646308, "body": "don&#39;t pluralize then, try this <code>get &#39;&#47;show&#47;:id&#39;, to: &#39;request#show&#39;, as: :request</code>"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": false, "score": 1, "last_activity_date": 1496288339, "creation_date": 1496288339, "answer_id": 44298108, "question_id": 44296102, "link": "https://stackoverflow.com/questions/44296102/ruby-on-rails-index-routing/44298108#44298108", "title": "Ruby on Rails index routing", "body": "<p>Firstly, why do you have multiple routes for <code>requests#show</code> and <code>#new</code>?</p>\n\n<pre><code>get '/request', to: 'requests#new'\nget '/show', to: 'request#show'\nresources :requests\n</code></pre>\n\n<p>Similarly for <code>User</code> too..</p>\n\n<p>Or as I can see, you have a custom route for show action, you should limit your routes for <code>resources</code> like,</p>\n\n<pre><code>resources :requests, except: [:show, :new]\n</code></pre>\n\n<p>Secondly, as suggested by @max, you should think of changing the resource name, <code>Request</code> is not a good choice.</p>\n\n<p>Third, for the solution, try naming your path with <code>as:</code> option which can be used in your <code>link_to</code> option as below,</p>\n\n<pre><code>get '/show/:id', to: 'requests#show', as: :request #notice the :id and plurality of action\n</code></pre>\n\n<p>Then in your view,</p>\n\n<pre><code>&lt;%= link_to request_path request %&gt;\n</code></pre>\n\n<p>You should checkout the <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\"><code>docs</code></a> to understand it better..</p>\n"}], "owner": {"reputation": 21, "user_id": 8075439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b2745d6560ec506029f84730ffca94?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/8075439/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496288339, "creation_date": 1496272512, "question_id": 44296102, "link": "https://stackoverflow.com/questions/44296102/ruby-on-rails-index-routing", "title": "Ruby on Rails index routing", "body": "<p>I have created an index of an object, request. Request has a address and a body. I set the index to show the address as a link, and I am trying to get the link to go to the show page of that certain object, however it routes me to the create object page.</p>\n\n<p>Routes.rb:</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  get 'quote/new'\n\n  get 'quote/create'\n\n  devise_for :admins\n\n  get '/login',   to: 'sessions#new'\n  devise_for :users\n  root 'static_pages#home'\n  resources :users do\n    collection do\n      get :signup\n      get :login\n    post :login\n    get :logout\n  end\nend\n\n  get '/about',   to: 'static_pages#about'\n  get '/contact', to: 'static_pages#contact'\n  get '/signup',  to: 'users#new'\n  get '/request', to: 'requests#new'\n\n  get '/account', to: 'users#show'\n  get '/show',  to: 'request#show'\n\n  resources :users\n  resources :requests\n\n  post '/login',  to: 'users#show'\n  delete '/logout',  to: 'sessions#destroy'\n\nend\n</code></pre>\n\n<p>Index html page:</p>\n\n<pre><code>&lt;h1&gt;All Requests&lt;/h1&gt;\n\n&lt;ul&gt;\n  &lt;% @requests.each do |request| %&gt;\n    &lt;li&gt;\n      &lt;%= link_to request.address, request %&gt;\n    &lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1496271680, "post_id": 44295793, "comment_id": 75598109, "body": "&quot;I don&#39;t want to use Invitation.new because i have reader that it&#39;s not a good practice to do that.&quot; - don&#39;t believe everything you read..."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1496271973, "post_id": 44295793, "comment_id": 75598171, "body": "Additionally you should generate the random token in the model or controller - not in the view. You don&#39;t need to pass it through the form."}], "answers": [{"tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 1, "last_activity_date": 1496271568, "creation_date": 1496271568, "answer_id": 44295941, "question_id": 44295793, "link": "https://stackoverflow.com/questions/44295793/using-a-model-declaration-in-a-different-view-in-rails/44295941#44295941", "title": "Using a model declaration in a different view in Rails", "body": "<p>You need to initialize <code>@invitations</code> from the controller action where this form is rendered..</p>\n\n<p>Suppose it's new, then</p>\n\n<pre><code>def new\n  ...\n  @invitations = Invitation.new\nend\n</code></pre>\n"}], "owner": {"reputation": 1480, "user_id": 3927509, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/078194551f43a33f5110051a3faf3643?s=128&d=identicon&r=PG", "display_name": "exsnake", "link": "https://stackoverflow.com/users/3927509/exsnake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 44295941, "answer_count": 1, "score": -1, "last_activity_date": 1496271568, "creation_date": 1496270541, "question_id": 44295793, "link": "https://stackoverflow.com/questions/44295793/using-a-model-declaration-in-a-different-view-in-rails", "title": "Using a model declaration in a different view in Rails", "body": "<p>I'm Developing an application where a user can be \"sign in\" only with his email and later complete the registration providing a password.</p>\n\n<p>I have the next views:</p>\n\n<blockquote>\n  <p>+views</p>\n  \n  <p>--invitations</p>\n  \n  <p>--layouts</p>\n  \n  <p>--products</p>\n  \n  <p>--users</p>\n</blockquote>\n\n<p>I want to implement a table where I will put the invitations and other table with the full registered users.</p>\n\n<p>I'm having troubles to use the invitation model in another view (tour view).</p>\n\n<pre><code>&lt;%= form_for @invitations, remote:true do |f| %&gt;\n    &lt;%= f.label :email, class:'weight-700'%&gt;\n    &lt;%= f.email_field :email, class: 'form-control',name:'email', placeholder:'email' %&gt;\n    &lt;%= f.hidden_field :code_digest, :value =&gt; random_code %&gt;\n    &lt;%= f.button :submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>That code gives me this error:\n<code>First argument in form cannot contain nil or be empty</code></p>\n\n<p>I don't want to use <code>Invitation.new</code>because i have reader that it's not a good practice to do that.</p>\n\n<p>And I don't know how to link the form with the creation of a new invitation without changing or refreshing the page. I know is something with routes and javascript, but I don't know how to proceed.</p>\n\n<p>I hope I made myself clear. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "file", "rspec", "content-type"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1496272162, "post_id": 44295621, "comment_id": 75598214, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4600679/detect-mime-type-of-uploaded-file-in-ruby\" title=\"detect mime type of uploaded file in ruby\">stackoverflow.com/questions/4600679/&hellip;</a>"}, {"owner": {"reputation": 624, "user_id": 7188109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0d98756028ef12c8cdbf8d89a2a259?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 D\u0105browski", "link": "https://stackoverflow.com/users/7188109/pawe%c5%82-d%c4%85browski"}, "edited": false, "score": 0, "creation_date": 1496310685, "post_id": 44295621, "comment_id": 75613589, "body": "It would be easier to answer the question if you post this code"}], "owner": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496269584, "creation_date": 1496269584, "question_id": 44295621, "link": "https://stackoverflow.com/questions/44295621/how-do-you-test-file-content-type-in-rails-spec", "title": "How do you test File content_type in Rails spec?", "body": "<p>I have a conditional that checks for the <code>content_type</code> off of a <code>ActionDispatch::Http::UploadedFile</code> but the <code>File</code> class in Ruby doesn't have something like that so is it possible to test this rspec?</p>\n"}, {"tags": ["ruby", "resources", "chef-infra"], "comments": [{"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1496329045, "post_id": 44295603, "comment_id": 75627363, "body": "in second resource: <code>index new_resource.index</code> so the interpreter knows the second <code>index</code> is the frist resource property and not the the second resource method. See <a href=\"https://docs.chef.io/custom_resources.html#new-resource-property\" rel=\"nofollow noreferrer\">docs.chef.io/custom_resources.html#new-resource-property</a>"}], "owner": {"reputation": 892, "user_id": 1267625, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/0bc6b89bf58390462a881f6d77aca3ff?s=128&d=identicon&r=PG", "display_name": "jaywhy13", "link": "https://stackoverflow.com/users/1267625/jaywhy13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1496269468, "creation_date": 1496269468, "question_id": 44295603, "link": "https://stackoverflow.com/questions/44295603/pass-custom-resource-parameter-to-custom-resource-in-chef", "title": "Pass custom resource parameter to custom resource in Chef", "body": "<p>First, I'm not expert in Ruby or Chef for that matter. I have a custom resource that takes a parameter that I'm trying to pass to another custom resource. It's not working. The parameter isn't getting set on the second resource, so the second resource is only seeing the default for the parameter.</p>\n\n<pre><code># cookbook/recipes/default/caller.rb\n# Call first_resource and pass 2 as the index\nfirst_resource \"Pass in 2\" do\n  index 2\nend\n\n# cookbook/resources/first_resource.rb\nresource_name :first_resource\nproperty :index, Integer, default: 1\n\naction :execute do\n  # call my second custom resource and pass index to it\n  second_resource \"Call second resource with #{index}\" do\n    index index\n  end\nend\n\n# cookbook/resources/second_resource.rb\nresource_name :second_resource\nproperty :index, Integer, 1\naction :execute do\n  raise \"The index is #{index}\"\nend\n</code></pre>\n\n<p>In essence, my recipe \"caller.rb\" needs to pass a variable (index) to the first resource, which in turn needs to pass said variable to a second resource. The issue I'm having is that the second resource is always getting the default value of 1, even though I'm passing in 2. I figure that the parameter's value for second_resource gets set when Chef does the compilation phase? </p>\n\n<p>I can't pass the value from my recipe all the way through to the second resource. </p>\n\n<p>I've read about <code>load_current_value</code> in the docs but when I use it outside of an action, I can't call any resources. I have also tried using <code>load_current_value</code> inside an action but then I get a <code>NoMethodError</code>. </p>\n\n<p>Help!</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 1, "creation_date": 1496269546, "post_id": 44295593, "comment_id": 75597458, "body": "What do you mean by &quot;no success&quot;?  Did it not work?  Did it give you invalid output?"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1496279289, "post_id": 44295593, "comment_id": 75599874, "body": "As written, this is a &quot;write code for me&quot; question. I want to help you get past where you&#39;re stuck, but unless you share specifics, I can&#39;t help."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6019430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SsKHg.jpg?s=128&g=1", "display_name": "Serhii Fedorchuk", "link": "https://stackoverflow.com/users/6019430/serhii-fedorchuk"}, "edited": false, "score": 0, "creation_date": 1496305763, "post_id": 44295704, "comment_id": 75609896, "body": "This is not my homework!"}], "tags": [], "owner": {"reputation": 708, "user_id": 1384460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lZqUY.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1384460/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1496270066, "creation_date": 1496270066, "answer_id": 44295704, "question_id": 44295593, "link": "https://stackoverflow.com/questions/44295593/array-manipulation-and-counting-ruby/44295704#44295704", "title": "array manipulation and counting ruby", "body": "<p>I'm not going to answer your homework, but here's some pseudo code for you:</p>\n\n<pre><code>output = {}\n\nyourarray.each { |item| \n    // Key will be \"IT\" for the first iteration\n    key = item[0];\n    // Value will be \"Testing\" for the first iteration\n    value = item[1];\n    // Now you want to set Output['IT'] to 1\n    // If Output['IT'] was already set, then you need to increment the number\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 1, "last_activity_date": 1496271093, "creation_date": 1496271093, "answer_id": 44295879, "question_id": 44295593, "link": "https://stackoverflow.com/questions/44295593/array-manipulation-and-counting-ruby/44295879#44295879", "title": "array manipulation and counting ruby", "body": "<p>Not quite what you wanted, but I'm sure this will help:</p>\n\n<pre><code>arr.group_by(&amp;:first).transform_values { |arr| arr.map { |sub| sub.last }\n                                                  .group_by(&amp;:itself)\n                                                  .map { |k,v| [k, v.size] } \n                                       }\n\n\n#=&gt; {  \"IT\"         =&gt; [[\"Testing\", 3],\n#                       [\"Banking Software\", 1],\n#                       [\"ERP\", 2], \n#                       [\"IT Security\", 2]],\n#     \n#      \"Accounting\" =&gt; [[\"Offshore\", 1],\n#                       [\"ACCA\", 1]]\n#    }\n</code></pre>\n\n<p>You can push it in an array I suppose and Bob's your uncle.</p>\n\n<hr>\n\n<p>Key methods: <code>transform_values</code>; <code>group_by</code> and <code>map</code>. See <a href=\"http://www.ruby-doc.org\" rel=\"nofollow noreferrer\">www.ruby-doc.org</a> for more info.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1496278475, "last_edit_date": 1496278475, "creation_date": 1496275026, "answer_id": 44296412, "question_id": 44295593, "link": "https://stackoverflow.com/questions/44295593/array-manipulation-and-counting-ruby/44296412#44296412", "title": "array manipulation and counting ruby", "body": "<p><strong>Code and example</strong></p>\n\n<pre><code>[arr.each_with_object(Hash.new(0)) { |pair, h| h[pair] += 1 }.\n    each_with_object(Hash.new { |h,k| h[k]=[] }) { |((a,b),n),g| g[a] &lt;&lt; [b,n] }]\n  #=&gt; [{\"IT\"=&gt;[[\"Testing\", 3], [\"Banking Software\", 1], [\"ERP\", 2], [\"IT Security\", 2]],\n  #    \"Accounting\"=&gt;[[\"Offshore\", 1], [\"ACCA\", 1]]}]\n</code></pre>\n\n<p>It's not clear why an array containing a single hash (rather than just the hash) is desired. If the hash is all that's needed, simply remove the outer brackets in the code.</p>\n\n<p><strong>Explanation</strong></p>\n\n<p><code>Hash.new(0)</code> is sometimes called a <em>counting hash</em>. (See <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a>.) If <code>h = Hash.new(0)</code> and <code>h</code> does not have a key <code>:cat</code>, <code>h[:cat]</code> returns the default value (here zero), without altering the hash. When Ruby encounters <code>h[:cat] += 1</code>, the first thing it does is expand that expression to<sup>1</sup>:</p>\n\n<pre><code>h[:cat] = h[:cat] + 1\n</code></pre>\n\n<p>If <code>h</code> has a key <code>:cat</code>, <code>h[:cat]</code> on right side of the equality is the current value for that key, say <code>8</code>. We then compute</p>\n\n<pre><code>h[:cat] = 8 + 1 #=&gt; 9\n</code></pre>\n\n<p>On the other hand, if <code>h</code> does not have a key <code>:cat</code>, <code>h[:cat]</code> on the right is set to the default value, so we have</p>\n\n<pre><code>h[:cat] = 0 + 1 #=&gt; 0\n</code></pre>\n\n<p>Therefore, in the first step we compute a hash as follows:</p>\n\n<pre><code>g = arr.each_with_object(Hash.new(0)) { |pair, h| h[pair] += 1 }\n  #=&gt; {[\"IT\", \"Testing\"]=&gt;3, [\"IT\", \"Banking Software\"]=&gt;1, [\"IT\", \"ERP\"]=&gt;2,\n  #    [\"IT\", \"IT Security\"]=&gt;2, [\"Accounting\", \"Offshore\"]=&gt;1, [\"Accounting\", \"ACCA\"]=&gt;1}\n</code></pre>\n\n<p>This is nearly the same as the simpler form</p>\n\n<pre><code>h = {}\narr.each do |pair|\n  h[pair] = 0 unless h.key?(pair)\n  h[pair] += 1\nend\n  #=&gt; [[\"IT\", \"Testing\"], [\"IT\", \"Banking Software\"], [\"IT\", \"ERP\"],\n  #    [\"IT\", \"Testing\"], [\"IT\", \"IT Security\"], [\"IT\", \"ERP\"],\n  #    [\"IT\", \"IT Security\"], [\"Accounting\", \"Offshore\"], [\"IT\", \"Testing\"],\n  #    [\"Accounting\", \"ACCA\"]]\nh #=&gt; {[\"IT\", \"Testing\"]=&gt;3, [\"IT\", \"Banking Software\"]=&gt;1, [\"IT\", \"ERP\"]=&gt;2,\n  #    [\"IT\", \"IT Security\"]=&gt;2,\n  #    [\"Accounting\", \"Offshore\"]=&gt;1, [\"Accounting\", \"ACCA\"]=&gt;1}\n</code></pre>\n\n<p>Notice that <code>each</code> returns its receiver, so we need the line <code>h</code> at the end if this snippet were wrapped in a method.</p>\n\n<p>The second step (using <code>h</code> just computed) is a fancy was of implementing the following.</p>\n\n<pre><code>g = {}\nh.each do |k,n|\n  a, b = k \n  g[a] = [] unless g.key?(a)\n  g[a] &lt;&lt; [b, n]\nend\ng # =&gt; {\"IT\"=&gt;[[\"Testing\", 3], [\"Banking Software\", 1], [\"ERP\", 2], [\"IT Security\", 2]],\n  #     \"Accounting\"=&gt;[[\"Offshore\", 1], [\"ACCA\", 1]]}\n</code></pre>\n\n<p><sup>1 Note that <code>h[k] =</code> is <em>syntactic sugar</em> for the method <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\">Hash#[]=</a>, whereas <code>h[k]</code> on the right of the equality is the method <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">Hash#[]</a>.</sup></p>\n"}], "owner": {"reputation": 35, "user_id": 6019430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SsKHg.jpg?s=128&g=1", "display_name": "Serhii Fedorchuk", "link": "https://stackoverflow.com/users/6019430/serhii-fedorchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1496280935, "accepted_answer_id": 44296412, "answer_count": 3, "score": -4, "last_activity_date": 1496278475, "creation_date": 1496269393, "last_edit_date": 1496272431, "question_id": 44295593, "link": "https://stackoverflow.com/questions/44295593/array-manipulation-and-counting-ruby", "closed_reason": "Not suitable for this site", "title": "array manipulation and counting ruby", "body": "<p>I have such an array. Help me to get desirable output.</p>\n\n<pre><code>arr = [[\"IT\", \"Testing\"], [\"IT\", \"Banking Software\"], [\"IT\", \"ERP\"],\n       [\"IT\", \"Testing\"], [\"IT\", \"IT Security\"], [\"IT\", \"ERP\"],\n       [\"IT\", \"IT Security\"], [\"Accounting\", \"Offshore\"], [\"IT\", \"Testing\"],\n       [\"Accounting\", \"ACCA\"]]\n</code></pre>\n\n<p>I want to construct the following array (containing a single hash) from <code>arr</code>:</p>\n\n<pre><code>[\n {\n   \"IT\" =&gt; [[\"Testing\", 3], [\"ERP\", 2], [\"IT Security\", 2], [\"Banking Software\", 1]],\n   \"Accounting\" =&gt; [[\"Offshore\", 1], [\"ACCA\", 1]]\n }\n]\n</code></pre>\n\n<p>Tried with .map, .group_by, but still no success. Any help appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "sanitize"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 2, "creation_date": 1496269032, "post_id": 44295446, "comment_id": 75597247, "body": "try with <code>.where(&quot;spree_products_taxons.taxon_id in (?)&quot;, params).map(&amp;:id))</code>"}], "owner": {"reputation": 729, "user_id": 5655756, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005069719213/picture?type=large", "display_name": "Catalin", "link": "https://stackoverflow.com/users/5655756/catalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496268592, "creation_date": 1496268592, "question_id": 44295446, "link": "https://stackoverflow.com/questions/44295446/how-to-sanitize-ruby-pg-data-before-select", "title": "How to sanitize ruby-pg data before select?", "body": "<p>I have the following db interogation in ruby-pg:</p>\n\n<p><code>a = product[:id].in(Spree::Product.joins(:taxons).where(\"spree_products_taxons.taxon_id in (params)\").map(&amp;:id))</code></p>\n\n<p>How do I sanitize the <code>params</code> data, so I can sefely pass it to this particular query ? It's passed on as an array and for the database should be a list of integers 2,3,4</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496267571, "post_id": 44295006, "comment_id": 75596773, "body": "For security and to avoid errors, you should check if subdomain is valid before <code>connect_to_database</code>."}, {"owner": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "reply_to_user": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496267807, "post_id": 44295006, "comment_id": 75596849, "body": "@wesley6j thanks for answer, but how can I check if the database exist?"}, {"owner": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 3, "creation_date": 1496268104, "post_id": 44295006, "comment_id": 75596960, "body": "If you have a list of subdomains that you want to use, save the array somewhere in your codebase or config file."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496292954, "post_id": 44295006, "comment_id": 75603138, "body": "Are you able to <code>rescue StandardError render file: &quot;#{Rails.root}&#47;public&#47;404&quot;, layout: true, status: :not_found end</code>"}, {"owner": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "reply_to_user": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496854549, "post_id": 44295006, "comment_id": 75835939, "body": "@wesley6j Thank you very much, it worked"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "edited": false, "score": 0, "creation_date": 1496269678, "post_id": 44295225, "comment_id": 75597509, "body": "Thanks for replying, I pasted the code but it still shows me the same error"}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "reply_to_user": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "edited": false, "score": 0, "creation_date": 1496323457, "post_id": 44295225, "comment_id": 75622809, "body": "Try running this command in the rescue case   &quot;clear_cache!&quot;  editing answer with this"}, {"owner": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "edited": false, "score": 0, "creation_date": 1496342422, "post_id": 44295225, "comment_id": 75635228, "body": "I placed your code and I started the rails server but I still get the same error when I enter the name of an existing database when I first enter a database that does not exist."}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "reply_to_user": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "edited": false, "score": 0, "creation_date": 1496342767, "post_id": 44295225, "comment_id": 75635417, "body": "Then I would suggest what wesley6j suggested, creating a white list of acceptable subdomains, and not even attempting a db connection if the incoming domain isn&#39;t in the whitelist"}, {"owner": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "edited": false, "score": 0, "creation_date": 1496854497, "post_id": 44295225, "comment_id": 75835908, "body": "Thanks, I&#39;ll go for that option."}], "tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": false, "score": 0, "last_activity_date": 1496323542, "last_edit_date": 1496323542, "creation_date": 1496267453, "answer_id": 44295225, "question_id": 44295006, "link": "https://stackoverflow.com/questions/44295006/error-trying-to-change-database/44295225#44295225", "title": "Error trying to change database", "body": "<p>Using something like what is done in this answer <a href=\"https://stackoverflow.com/a/25592558/8088139\">https://stackoverflow.com/a/25592558/8088139</a>\nbuild a catch situation to fail gracefully if the database doesn't exist</p>\n\n<p>something like</p>\n\n<pre><code>def connect_to_user_database(name)\n  config = ActiveRecord::Base.configurations[\"development\"].merge(\"database\" =&gt; \"#{name}\")\n  ActiveRecord::Base.establish_connection(config)\nrescue ActiveRecord::NoDatabaseError\n  clear_cache!\n  #set response to forbidden\n  #log the failure\nend\n</code></pre>\n\n<p>EDIT: added clear_cache! to NoDatabaseError rescue</p>\n"}], "owner": {"reputation": 25, "user_id": 5864993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38704c922ae4c7202c38521d9aeedf07?s=128&d=identicon&r=PG&f=1", "display_name": "Ing.LuisC", "link": "https://stackoverflow.com/users/5864993/ing-luisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496323542, "creation_date": 1496266295, "question_id": 44295006, "link": "https://stackoverflow.com/questions/44295006/error-trying-to-change-database", "title": "Error trying to change database", "body": "<p>I'm following a tutorial to change the database depending on the subdomain, the subdomain must be the name of an existing database to which the system will connect as shown in <a href=\"https://www.youtube.com/watch?v=GRfJ9lni4QA\" rel=\"nofollow noreferrer\">this tutorial</a> at 15:30 minute and works quite well, The problem comes when the system is accessed with a subdomain whose database does not exist, showing me the following error: <code>Cannot open database \"another_database\" requested by the login. The login failed</code>\nand displaying the error does not allow access to the system, regardless of whether it is accessed with the name of an existing database in the subdomain unless the rails server is restarted.</p>\n\n<p>This is my code in my ApplicationController:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :connect_to_database\n\n\n  def connect_to_user_database(name)\n    config = ActiveRecord::Base.configurations[\"development\"].merge(\"database\" =&gt; \"#{name}\")\n    ActiveRecord::Base.establish_connection(config)\n    #auth = name\n    #raise auth.to_yaml #podemos ver los datos que nos ofrece el parametro\n  end\n\n\n  private\n\n  def connect_to_database\n    connect_to_user_database(request.subdomains(0).first)\n  end\n\nend\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "asset-pipeline"], "answers": [{"tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": true, "score": 1, "last_activity_date": 1496266276, "creation_date": 1496266276, "answer_id": 44295003, "question_id": 44294925, "link": "https://stackoverflow.com/questions/44294925/ruby-on-rails-renderin-a-view-with-static-script-files/44295003#44295003", "title": "Ruby on Rails renderin a view with static script files", "body": "<p>It should be </p>\n\n<p><code>&lt;script src=\"/assets/js/myscript.js\"&gt;&lt;/script&gt;</code></p>\n\n<p>Without the starting '/' it assumes the asset path is rooted on the page path.\nWith the starting '/' it assumes the asset path is rooted at the domain.</p>\n"}, {"tags": [], "owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "is_accepted": false, "score": 1, "last_activity_date": 1496268170, "creation_date": 1496268170, "answer_id": 44295364, "question_id": 44294925, "link": "https://stackoverflow.com/questions/44294925/ruby-on-rails-renderin-a-view-with-static-script-files/44295364#44295364", "title": "Ruby on Rails renderin a view with static script files", "body": "<p>If you use <a href=\"http://api.rubyonrails.org/v3.2/classes/ActionView/Helpers/AssetTagHelper/JavascriptTagHelpers.html#method-i-javascript_include_tag\" rel=\"nofollow noreferrer\">the rails helper</a>, it will handle this for you. </p>\n\n<pre><code> &lt;%= javascript_include_tag 'myscript' %&gt;\n</code></pre>\n\n<p>Just don't forget to add this file to the assets initializer <code>config/initializers/assets.rb</code>. </p>\n"}], "owner": {"reputation": 323, "user_id": 1934168, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/a8e85918d3db651edd04097020cbf5f1?s=128&d=identicon&r=PG", "display_name": "Hilmi Yamc\u0131", "link": "https://stackoverflow.com/users/1934168/hilmi-yamc%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44295003, "answer_count": 2, "score": 1, "last_activity_date": 1496268170, "creation_date": 1496265917, "question_id": 44294925, "link": "https://stackoverflow.com/questions/44294925/ruby-on-rails-renderin-a-view-with-static-script-files", "title": "Ruby on Rails renderin a view with static script files", "body": "<p>In my ruby on rails application I have controlled called AnimalsController. At this controller I have a method \"edit\" and a corresponded edit.html.erb view in my animals folder. When I also manually added some static javascript file into the page which are located at public/assets/js/ folder. When I render the view, instead of rails is trying to load these javascripts file in the relative path instead of mydomail.com/assets/js/ folder.</p>\n\n<p>Url:\n    /animals/:id/edit</p>\n\n<p>I have script file myscript.js inside assets/js/</p>\n\n<p>When I send request to htt://0.0.0.0:3000/animals/:id/edit</p>\n\n<p>Rails search for <a href=\"http://0.0.0.0:3000/animals/:id/edit/assets/js/myscript.js\" rel=\"nofollow noreferrer\">http://0.0.0.0:3000/animals/:id/edit/assets/js/myscript.js</a></p>\n\n<p>I want it to seach the script at <a href=\"http://0.0.0.0:3000/animals/js/myscript.js\" rel=\"nofollow noreferrer\">http://0.0.0.0:3000/animals/js/myscript.js</a></p>\n\n<p>This is code is in my edit.html.erb</p>\n\n<pre><code>&lt;script src=\"assets/js/myscript.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Not: I intentionally don't use &lt;%= javascript_include_tag 'application', 'data-turbolinks-track' => true %> </p>\n\n<p>Any suggestions ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 3, "creation_date": 1496265690, "post_id": 44294814, "comment_id": 75596030, "body": "Looking at your <a href=\"https://stackoverflow.com/questions/44273038/check-if-variables-are-null-and-if-not-print\">previous question</a> it&#39;s clear that you misunderstood what tadman was trying to tell you. String interpolation is not an antipattern. The specific construction <code>&quot;#{x}&quot;</code> (in which the string contains nothing other than a single <code>#{...}</code> interpolation expression) is an antipattern, because you&#39;re not interpolating <code>x</code> <i>with</i> anything\u2014it&#39;s equivalent to <code>x.to_s</code>. <code>&quot;#{x}cm x #{y}cm x #{z}cm&quot;</code> is <i>not</i> an antipattern."}], "answers": [{"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": false, "score": 2, "last_activity_date": 1496266577, "last_edit_date": 1496266577, "creation_date": 1496265871, "answer_id": 44294912, "question_id": 44294814, "link": "https://stackoverflow.com/questions/44294814/conditionally-return-attributes-in-ruby/44294912#44294912", "title": "conditionally return attributes in ruby", "body": "<p>You could do something like this:</p>\n\n<pre><code>module ItemsHelper\n  def dimensions_available(length, height, width)\n    if @item.variable_dimensions\n      \"Dimensions variable\"\n    elsif width.nil?\n      \"#{length}cm x #{height}cm\"\n    else\n      \"#{length}cm x #{height}cm x #{width}cm\"\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 3, "last_activity_date": 1496266189, "creation_date": 1496266189, "answer_id": 44294983, "question_id": 44294814, "link": "https://stackoverflow.com/questions/44294814/conditionally-return-attributes-in-ruby/44294983#44294983", "title": "conditionally return attributes in ruby", "body": "<p>Using <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-compact\" rel=\"nofollow noreferrer\"><code>compact</code></a>, you could remove any <code>nil</code> dimension:</p>\n\n<pre><code>module ItemsHelper\n  def dimensions_available(length, height, width)\n    if @item.variable_dimensions\n      \"Dimensions variable\"\n    else\n      [length, height, width].compact.map do |dim|\n        \"#{dim}cm\"\n      end.join(' x ')\n    end\n  end\nend\n</code></pre>\n\n<p>Also, there's no need for <code>return</code> or <code>== true</code>.</p>\n"}], "owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44294983, "answer_count": 2, "score": 2, "last_activity_date": 1496266577, "creation_date": 1496265382, "question_id": 44294814, "link": "https://stackoverflow.com/questions/44294814/conditionally-return-attributes-in-ruby", "title": "conditionally return attributes in ruby", "body": "<p>I have three attributes that I want to display on a page: <code>length</code>, <code>height</code>, and <code>width</code>. </p>\n\n<p>If a fourth attribute (<code>variable_dimensions</code>) is set to true on the object (thus invalidating the need to enter data for the other attributes), I want to return a string that says \"Dimensions variable.\" If <code>width</code> is nil, I want to return <code>length</code> x <code>height</code>. I want to return the full <code>length</code> x <code>height</code> x <code>width</code> otherwise.</p>\n\n<p>I've attempted this as a helper.</p>\n\n<pre><code>module ItemsHelper\n  def dimensions_available(length, height, width)\n    if @item.variable_dimensions == true\n      return \"Dimensions variable\"\n    elseif width.nil?\n      dimensions = length, height\n      return dimensions\n    else\n      dimensions = length, height, width\n      return dimensions\n    end\n  end\nend\n</code></pre>\n\n<p>This works when <code>dimensions_variable</code> is set to true. It does what I want with the objects that have variable dimensions. In the other two cases it's printing to the page as an array that looks like [60.3, 35.4, nil] when <code>width</code> is nil, and [39, 45.3, 30.4] otherwise. How do I remove the array styling so that it it looks like 10cm x 30cm x 48cm? I previously attempted this with string interpolation, but was told that it's an anti-pattern.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1496262848, "post_id": 44293992, "comment_id": 75594819, "body": "A different approach <code>arr.flat_map { |str| [str+&quot;.ads&quot;,str+&quot;.adb&quot;] }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496264018, "post_id": 44294104, "comment_id": 75595320, "body": "...and to eliminate <code>files = []</code> and <code>return files</code>, write <code>packages.each_with_object(files) do |package, files|</code> followed by what you have."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1496264354, "post_id": 44294104, "comment_id": 75595487, "body": "You can also use <code>push</code> here which takes multiple arguments, like <code>files.push(package + &quot;.ads&quot;, package + &quot;.adb&quot;)</code>. Whether it&#39;s better to do so I&#39;m not sure."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1496269638, "post_id": 44294104, "comment_id": 75597498, "body": "The problem is that additional code has to be written if an additional extension is added. Instead, the code should not care."}], "tags": [], "owner": {"reputation": 241, "user_id": 8064724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1506651869367107/picture?type=large", "display_name": "Bartosz Bonis\u0142awski", "link": "https://stackoverflow.com/users/8064724/bartosz-bonis%c5%82awski"}, "is_accepted": true, "score": 4, "last_activity_date": 1496262494, "creation_date": 1496262494, "answer_id": 44294104, "question_id": 44293992, "link": "https://stackoverflow.com/questions/44293992/creating-array-with-two-unique-entries-for-every-entry-from-another-array-in-rub/44294104#44294104", "title": "Creating array with two unique entries for every entry from another array in Ruby", "body": "<p><code>package &lt;&lt; \".ads</code> mutates state of package. Use <code>+</code> for string concatenation in places like that, because it doesn't mutate state. It just returns new string(which is what you really want).</p>\n\n<pre><code>packages.each do |package|\n    files &lt;&lt; (package + \".ads\")\n    files &lt;&lt; (package + \".adb\")\nend\n</code></pre>\n\n<p>this should work for your case</p>\n"}, {"comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1496267603, "post_id": 44294347, "comment_id": 75596786, "body": "This is cool and you get my upvote, but using cartesian product on filenames may just be a little too clever for some teams..."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1496269579, "post_id": 44294347, "comment_id": 75597474, "body": "I&#39;d go with this. It will work if <code>packages</code> or <code>suffixes</code> get new elements without having to write more code."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1496263786, "last_edit_date": 1496263786, "creation_date": 1496263453, "answer_id": 44294347, "question_id": 44293992, "link": "https://stackoverflow.com/questions/44293992/creating-array-with-two-unique-entries-for-every-entry-from-another-array-in-rub/44294347#44294347", "title": "Creating array with two unique entries for every entry from another array in Ruby", "body": "<pre><code>packages = [\"First.Package\", \"Second.Package\"]\nsuffixes = [\".ads\", \".adb\"]\n\npackages.product(suffixes).map(&amp;:join)\n  #=&gt; [\"First.Package.ads\", \"First.Package.adb\",\n  #    \"Second.Package.ads\", \"Second.Package.adb\"]\n</code></pre>\n\n<p>Note that</p>\n\n<pre><code>packages.product(suffixes)\n  #=&gt; [[\"First.Package\", \".ads\"], [\"First.Package\", \".adb\"],\n  #    [\"Second.Package\", \".ads\"], [\"Second.Package\", \".adb\"]]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-product\" rel=\"nofollow noreferrer\">Array#product</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1496264651, "post_id": 44294408, "comment_id": 75595624, "body": "Consider using <code>flat_map</code> instead of the outer <code>map</code>. This will save you having to <code>flatten</code> at the end"}], "tags": [], "owner": {"reputation": 2267, "user_id": 882025, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zK7M6.jpg?s=128&g=1", "display_name": "hoffm", "link": "https://stackoverflow.com/users/882025/hoffm"}, "is_accepted": false, "score": 3, "last_activity_date": 1496263699, "creation_date": 1496263699, "answer_id": 44294408, "question_id": 44293992, "link": "https://stackoverflow.com/questions/44293992/creating-array-with-two-unique-entries-for-every-entry-from-another-array-in-rub/44294408#44294408", "title": "Creating array with two unique entries for every entry from another array in Ruby", "body": "<p>Given </p>\n\n<pre><code>packages = %w(First.Package Second.Package)\nextensions = %w(.ads .adb)\n</code></pre>\n\n<p>You could do it like this:</p>\n\n<pre><code>files = packages.map do |package|\n  extensions.map do |extension|\n    package + extension\n  end\nend.flatten\n</code></pre>\n"}], "owner": {"reputation": 561, "user_id": 4376373, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100006052897811/picture?type=large", "display_name": "Patrick Kelly", "link": "https://stackoverflow.com/users/4376373/patrick-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 44294104, "answer_count": 3, "score": 0, "last_activity_date": 1496263786, "creation_date": 1496262005, "question_id": 44293992, "link": "https://stackoverflow.com/questions/44293992/creating-array-with-two-unique-entries-for-every-entry-from-another-array-in-rub", "title": "Creating array with two unique entries for every entry from another array in Ruby", "body": "<p>I'm trying to take an array like</p>\n\n<pre><code>[ \"First.Package\", \"Second.Package\" ]\n</code></pre>\n\n<p>and turn it into</p>\n\n<pre><code>[ \"First.Package.ads\", \"First.Package.adb\", \"Second.Package.ads\", \"Second.Package.adb\" ]\n</code></pre>\n\n<p>I've tried doing the following:</p>\n\n<pre><code>packages = [ \"First.Package\", \"Second.Package\" ]\nfiles = []\npackages.each do |package|\n    files &lt;&lt; (package &lt;&lt; \".ads\")\n    files &lt;&lt; (package &lt;&lt; \".adb\")\nend\nreturn files\n</code></pre>\n\n<p>Which does not do what I think it should do. I get:</p>\n\n<pre><code>First.Package.ads.adb\nFirst.Package.ads.adb\nSecond.Package.ads.adb\nSecond.Package.ads.adb\n</code></pre>\n\n<p>I want:</p>\n\n<pre><code>First.Package.ads\nFirst.Package.adb\nSecond.Package.ads\nSecond.Package.adb\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "rvm"], "comments": [{"owner": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "edited": false, "score": 0, "creation_date": 1586431794, "post_id": 44293904, "comment_id": 108128417, "body": "<a href=\"https://guides.rubygems.org/faqs/#user-install\" rel=\"nofollow noreferrer\">guides.rubygems.org/faqs/#user-install</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17167, "user_id": 773263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e2581b53db32340d7e1b5be6b99c2bb1?s=128&d=identicon&r=PG", "display_name": "Philip Kirkbride", "link": "https://stackoverflow.com/users/773263/philip-kirkbride"}, "edited": false, "score": 7, "creation_date": 1496262213, "post_id": 44294003, "comment_id": 75594496, "body": "When I <code>echo $GEM_PATH</code> I get back a blank line, despite seeing multiple entries in <code>gem environment</code>."}], "tags": [], "owner": {"reputation": 241, "user_id": 8064724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1506651869367107/picture?type=large", "display_name": "Bartosz Bonis\u0142awski", "link": "https://stackoverflow.com/users/8064724/bartosz-bonis%c5%82awski"}, "is_accepted": false, "score": 3, "last_activity_date": 1496262060, "creation_date": 1496262060, "answer_id": 44294003, "question_id": 44293904, "link": "https://stackoverflow.com/questions/44293904/add-a-gem-path/44294003#44294003", "title": "Add a Gem Path?", "body": "<p>When you run <code>echo $GEM_PATH</code> you'll probably see 2 paths separated with colon. It's standard in setting multiple paths in env variables. </p>\n\n<p>If you want to add more directories then you can add 1 more path without removing old ones with <code>EXPORT GEM_PATH=$GEM_PATH:/your/new/path</code></p>\n"}, {"tags": [], "owner": {"reputation": 3868, "user_id": 2482094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81a0ecf0c7d4d429fafbdbbba490f38c?s=128&d=identicon&r=PG", "display_name": "Piotr Galas", "link": "https://stackoverflow.com/users/2482094/piotr-galas"}, "is_accepted": false, "score": 1, "last_activity_date": 1510052341, "creation_date": 1510052341, "answer_id": 47156216, "question_id": 44293904, "link": "https://stackoverflow.com/questions/44293904/add-a-gem-path/47156216#47156216", "title": "Add a Gem Path?", "body": "<p>I think it is not possible to just add path without override.</p>\n\n<p>Answer your question is in </p>\n\n<p><a href=\"https://github.com/rubygems/rubygems/blob/master/lib/rubygems.rb#L404\" rel=\"nofollow noreferrer\">https://github.com/rubygems/rubygems/blob/master/lib/rubygems.rb#L404</a></p>\n\n<pre><code> when 'GEM_HOME', 'GEM_PATH', 'GEM_SPEC_CACHE'\n .... \n @paths = Gem::PathSupport.new ENV.to_hash.merge(target)\n</code></pre>\n\n<p>Code is complicated, but you can read  that you can set path only by one of these <code>'GEM_HOME', 'GEM_PATH', 'GEM_SPEC_CACHE'</code> variables.</p>\n\n<p>Then gem put these variables as constructor to <code>Gem::PathSupport</code> where paths are set.</p>\n\n<p><a href=\"https://github.com/rubygems/rubygems/blob/master/lib/rubygems/path_support.rb\" rel=\"nofollow noreferrer\">https://github.com/rubygems/rubygems/blob/master/lib/rubygems/path_support.rb</a></p>\n"}, {"tags": [], "owner": {"reputation": 1693, "user_id": 2272825, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/92649bd7e80449a06bf24630eef67928?s=128&d=identicon&r=PG", "display_name": "leavez", "link": "https://stackoverflow.com/users/2272825/leavez"}, "is_accepted": false, "score": 0, "last_activity_date": 1618382811, "creation_date": 1618382811, "answer_id": 67086743, "question_id": 44293904, "link": "https://stackoverflow.com/questions/44293904/add-a-gem-path/67086743#67086743", "title": "Add a Gem Path?", "body": "<p><code>GEM_PATH=XXXX:</code></p>\n<p>(NOTE: should ends with a colon)</p>\n<p><a href=\"https://github.com/rubygems/rubygems/blob/dc86a62ac36f9cb4dea9de93fb9d8f791ef2f08a/lib/rubygems/path_support.rb#L55\" rel=\"nofollow noreferrer\">https://github.com/rubygems/rubygems/blob/dc86a62ac36f9cb4dea9de93fb9d8f791ef2f08a/lib/rubygems/path_support.rb#L55</a></p>\n"}], "owner": {"reputation": 17167, "user_id": 773263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e2581b53db32340d7e1b5be6b99c2bb1?s=128&d=identicon&r=PG", "display_name": "Philip Kirkbride", "link": "https://stackoverflow.com/users/773263/philip-kirkbride"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9130, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1618382811, "creation_date": 1496261664, "question_id": 44293904, "link": "https://stackoverflow.com/questions/44293904/add-a-gem-path", "title": "Add a Gem Path?", "body": "<p>When I run <code>gem environment</code> I get a list which includes the following:</p>\n\n<blockquote>\n  <ul>\n  <li>GEM PATHS:\n  \n  <ul>\n  <li>/home/rescue/.rvm/rubies/ruby-2.3.3/lib/ruby/gems/2.3.0</li>\n  <li>/home/rescue/.gem/ruby/2.3.0</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>I'd like to add a path. I see people <a href=\"https://stackoverflow.com/a/24323310/773263\">suggesting</a> to add something like <code>export GEM_PATH = ...</code> to my <code>.bashrc</code> file, but I fear this would replace the existing gem paths.</p>\n\n<p>How can I add another path in addition to the ones that already exist?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8094194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57df61782ad90bfde4a828932c35e68?s=128&d=identicon&r=PG&f=1", "display_name": "jbirdjavi", "link": "https://stackoverflow.com/users/8094194/jbirdjavi"}, "edited": false, "score": 0, "creation_date": 1496359420, "post_id": 44295614, "comment_id": 75642609, "body": "Thanks, I wish that would&#39;ve helped, but sadly it didn&#39;t."}], "tags": [], "owner": {"reputation": 708, "user_id": 1384460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lZqUY.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1384460/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1496269528, "creation_date": 1496269528, "answer_id": 44295614, "question_id": 44293876, "link": "https://stackoverflow.com/questions/44293876/bundler-1-15-0-omniauth-cas/44295614#44295614", "title": "bundler 1.15.0 omniauth-cas", "body": "<p>Try clearing everything out of your /tmp/cache folder. You could also try running <code>bundle exec rails s</code> to make sure bundler runs the server with the correct context</p>\n"}], "owner": {"reputation": 1, "user_id": 8094194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57df61782ad90bfde4a828932c35e68?s=128&d=identicon&r=PG&f=1", "display_name": "jbirdjavi", "link": "https://stackoverflow.com/users/8094194/jbirdjavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496269528, "creation_date": 1496261526, "question_id": 44293876, "link": "https://stackoverflow.com/questions/44293876/bundler-1-15-0-omniauth-cas", "title": "bundler 1.15.0 omniauth-cas", "body": "<p>I'm suddenly having issues running my rails app after bundler 1.15.0 came out.  I'd prefer not to have to downgrade to bundler 1.14.6 as our deploy tools automatically retrieve the latest version of bundler.</p>\n\n<p>Here's the output I'm seeing when I run <code>rails s</code>:</p>\n\n<pre><code>/Users/justin/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/bundler-1.15.0/lib/bundler/runtime.rb:85:in `rescue in block (2 levels) in require': There was an error while trying to load the gem 'omniauth-cas'. (Bundler::GemRequireError)\nGem Load Error is: undefined method `option' for OmniAuth::Strategies::CAS:Class\nBacktrace for gem load error is:\n/Users/justin/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/omniauth-cas-1.1.1/lib/omniauth/strategies/cas.rb:19:in `&lt;class:CAS&gt;'\n...\n</code></pre>\n"}, {"tags": ["ruby", "string", "unicode", "count"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1496260782, "post_id": 44293667, "comment_id": 75593860, "body": "Can you try with <code>scan</code> and <code>count</code>? <code>string.scan(&#47;\\p{L}&#47;).count</code>"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496261696, "post_id": 44293667, "comment_id": 75594263, "body": "That returns the expected result.  Thanks"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1496269558, "post_id": 44293667, "comment_id": 75597466, "body": "&quot;it should be returning 1&quot; \u2013 Why? According to the documentation, you are counting the number of <code>&#39;\\&#39;</code>s, <code>&#39;p&#39;</code>s, <code>&#39;{&#39;</code>s, <code>&#39;L&#39;</code>s, and <code>&#39;}&#39;</code>s. There are none, ergo, it should be returning <code>0</code>."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1496262208, "last_edit_date": 1496262208, "creation_date": 1496261984, "answer_id": 44293984, "question_id": 44293667, "link": "https://stackoverflow.com/questions/44293667/how-to-count-instances-of-any-unicode-letter-in-my-string/44293984#44293984", "title": "How to count instances of any Unicode letter in my string", "body": "<p>You could try using <code>String#scan</code>, passing your <code>\\p{L}</code> regex, and then chain the <code>count</code> method:</p>\n\n<pre><code>string = \"a\u00e1\"\np string.scan(/\\p{L}/).count\n# 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1496265530, "last_edit_date": 1496265530, "creation_date": 1496265162, "answer_id": 44294767, "question_id": 44293667, "link": "https://stackoverflow.com/questions/44293667/how-to-count-instances-of-any-unicode-letter-in-my-string/44294767#44294767", "title": "How to count instances of any Unicode letter in my string", "body": "<p>This is a way that does not create a temporary array.</p>\n\n<pre><code>str = \"M\u00eame temps l'ann\u00e9e prochaine.\"\n\nstr.size - str.gsub(/[[:alpha:]]/, '').size\n  #=&gt; 24\n</code></pre>\n\n<p>The POSIX bracket expression <code>[[:alpha:]]</code> is the same as <code>\\p{Alpha}</code> (aka <code>\\p{L}</code>).\nNote that</p>\n\n<pre><code>str.gsub(/[[:alpha:]]/, '')\n  #=&gt; \"  ' .\"\n</code></pre>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 44293984, "answer_count": 2, "score": 1, "last_activity_date": 1496265530, "creation_date": 1496260681, "last_edit_date": 1496261789, "question_id": 44293667, "link": "https://stackoverflow.com/questions/44293667/how-to-count-instances-of-any-unicode-letter-in-my-string", "title": "How to count instances of any Unicode letter in my string", "body": "<p>Using Ruby 2.4,  how do I count the number of instances of a Unicode letter in my string?  I'm trying:</p>\n\n<pre><code>2.4.0 :009 &gt; string = \"a\"\n =&gt; \"a\"\n2.4.0 :010 &gt; string.count('\\p{L}')\n =&gt; 0\n</code></pre>\n\n<p>but it's displaying 0, and it should be returning 1.</p>\n\n<p>I want to use the above expression rather than \"a-z\" because \"a-z\" won't cover things like accented e's.</p>\n"}, {"tags": ["ruby", "windows"], "comments": [{"owner": {"reputation": 4000, "user_id": 885844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acd838d39cbf02130ba75ea55e255b6?s=128&d=identicon&r=PG&f=1", "display_name": "w128", "link": "https://stackoverflow.com/users/885844/w128"}, "edited": false, "score": 0, "creation_date": 1496259727, "post_id": 44293390, "comment_id": 75593258, "body": "Are you using a non-admin account to execute the script remotely? I.e. what is the account you are using for WinRM authentication? It is likely that it doesn&#39;t have sufficient permissions for either accessing the file path, or that it&#39;s not configured for WinRM. Can you run a simple &quot;puts&quot; script remotely via WinRM using the same account? Also, how exactly are you making the WinRM call?"}, {"owner": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "reply_to_user": {"reputation": 4000, "user_id": 885844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acd838d39cbf02130ba75ea55e255b6?s=128&d=identicon&r=PG&f=1", "display_name": "w128", "link": "https://stackoverflow.com/users/885844/w128"}, "edited": false, "score": 0, "creation_date": 1496259842, "post_id": 44293390, "comment_id": 75593325, "body": "I am able to run the same script locally with the same account. I am also able to access the file path and read, write, delete files within the directories."}, {"owner": {"reputation": 4000, "user_id": 885844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acd838d39cbf02130ba75ea55e255b6?s=128&d=identicon&r=PG&f=1", "display_name": "w128", "link": "https://stackoverflow.com/users/885844/w128"}, "edited": false, "score": 0, "creation_date": 1496259984, "post_id": 44293390, "comment_id": 75593431, "body": "Can you run a simple &quot;puts&quot; script remotely using the same account? Did you configure the account (in case it&#39;s not the default account) correctly, i.e. put it into the WinRM group, set the WMI namepsace permissions ...? Can you run a PowerShell test-wsman to the host in question sucessfully?"}, {"owner": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "reply_to_user": {"reputation": 4000, "user_id": 885844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acd838d39cbf02130ba75ea55e255b6?s=128&d=identicon&r=PG&f=1", "display_name": "w128", "link": "https://stackoverflow.com/users/885844/w128"}, "edited": false, "score": 0, "creation_date": 1496260417, "post_id": 44293390, "comment_id": 75593668, "body": "When running a simple puts &quot;testing output&quot; script, the output is fine. When running the testDir script locally, I get the following output: Found . Found .. Found Test.txt Found Test.tar.xz I&#39;ve edited my question to reflect this."}], "answers": [{"tags": [], "owner": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1496765534, "creation_date": 1496765534, "answer_id": 44395011, "question_id": 44293390, "link": "https://stackoverflow.com/questions/44293390/ruby-list-all-files-within-a-unc-path-via-winrm/44395011#44395011", "title": "Ruby list all files within a UNC path via WinRM", "body": "<p>The issue I was having was caused by <a href=\"https://blogs.technet.microsoft.com/askds/2008/06/13/understanding-kerberos-double-hop/\" rel=\"nofollow noreferrer\">double-hopping</a>. The command I was running to execute the ruby script was from my local machine via WinRm. </p>\n"}], "owner": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 44395011, "answer_count": 1, "score": 0, "last_activity_date": 1496765534, "creation_date": 1496259537, "last_edit_date": 1496261252, "question_id": 44293390, "link": "https://stackoverflow.com/questions/44293390/ruby-list-all-files-within-a-unc-path-via-winrm", "title": "Ruby list all files within a UNC path via WinRM", "body": "<p>I am attempting to execute a ruby script via WinRM </p>\n\n<pre><code>ruby \"R:\\Scripts\\testDir.rb\"\n</code></pre>\n\n<p>that contains the following code:</p>\n\n<pre><code>Dir.foreach(\"\\\\\\\\FileServer\\\\TestDir\\\\\") { |x| \n    puts \"Found #{x}\" \n}\n</code></pre>\n\n<p>I have no problems executing the script locally on the server, but it fails with the following <em>Permission Denied</em> error via WinRM:</p>\n\n<pre><code>ruby : R:/Scripts/testDir.rb:1:in `open': Permission denied @ dir_initialize - \\\\FileServer\\TestDir\\ (Errno::EACCES)\n    + CategoryInfo          : NotSpecified: (R:/Scripts...(Errno::EACCES):String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n\n    from R:/Scripts/testDir.rb:1:in `foreach'\n    from R:/Scripts/testDir.rb:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>When running the script locally, I get the following output. </p>\n\n<pre><code>Found .\nFound ..\nFound test.txt\nFound test.tar.xz\n</code></pre>\n\n<p>My guess is that my script is failing because of the . and .. returned values being passed through WinRM, but I am not sure why. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1496259392, "post_id": 44293297, "comment_id": 75593062, "body": "It means every time you make a change to your stylesheets, rails assets pipeline is recompiling all sheets affected.  You need to make sure you&#39;re not trying to load too many stylesheets/js libraries.  Make sure any styles being compiled are actually needed."}, {"owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "edited": false, "score": 0, "creation_date": 1496259611, "post_id": 44293297, "comment_id": 75593181, "body": "Are you using iFrames to render those PDFs?"}, {"owner": {"reputation": 74, "user_id": 8019467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78293f8622d8fa0d3476bac53a32f49d?s=128&d=identicon&r=PG&f=1", "display_name": "despin", "link": "https://stackoverflow.com/users/8019467/despin"}, "edited": false, "score": 0, "creation_date": 1496260039, "post_id": 44293297, "comment_id": 75593460, "body": "No Aaron, i&#39;m not. But even when I didn&#39;t have to render these PDFs, I was having the same problem."}, {"owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "edited": false, "score": 0, "creation_date": 1496261082, "post_id": 44293297, "comment_id": 75594000, "body": "Do you have <a href=\"https://github.com/evrone/quiet_assets\" rel=\"nofollow noreferrer\">quiet assets</a> enabled? You might try disabling that to add some logging regarding your assets. If you&#39;re using Rails 5, the <a href=\"https://rossta.net/blog/quiet-assets-in-rails-5.html\" rel=\"nofollow noreferrer\">options have changed</a>."}, {"owner": {"reputation": 74, "user_id": 8019467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78293f8622d8fa0d3476bac53a32f49d?s=128&d=identicon&r=PG&f=1", "display_name": "despin", "link": "https://stackoverflow.com/users/8019467/despin"}, "edited": false, "score": 0, "creation_date": 1496261580, "post_id": 44293297, "comment_id": 75594216, "body": "Yes, I do have it enabled. I`m using Rails 5.0.2"}], "owner": {"reputation": 74, "user_id": 8019467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78293f8622d8fa0d3476bac53a32f49d?s=128&d=identicon&r=PG&f=1", "display_name": "despin", "link": "https://stackoverflow.com/users/8019467/despin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496261713, "creation_date": 1496259173, "last_edit_date": 1496261713, "question_id": 44293297, "link": "https://stackoverflow.com/questions/44293297/rails-why-puma-server-is-taking-too-long-to-respond", "title": "RAILS - Why Puma server is taking too long to respond?", "body": "<p>When I'm trying to change some CSS/SCSS file at my project, the local server (puma) takes too long time to load the page. I'm having this</p>\n\n<pre><code>  Rendering printlists/show.html.erb within layouts/application\n  Rendered partials/_sidebar.html.erb (109.0ms)\n  Rendered printlists/_template.html.erb (1.0ms)\n  Rendered printlists/show.html.erb within layouts/application (439.0ms)\nStarted GET \"/printlists/13.pdf\" for ::1 at 2017-05-31 16:24:04 -0300\nProcessing by PrintlistsController#show as PDF\n  Parameters: {\"id\"=&gt;\"13\"}\n  User Load (161.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 \n***************WICKED***************\n  Rendering printlists/show.pdf.erb\nCompleted 200 OK in 131907ms (Views: 131866.9ms | ActiveRecord: 1.0ms)\n\n\nCompleted 200 OK in 132401ms (Views: 132275.3ms | ActiveRecord: 79.0ms)\n\n\n  Rendered printlists/_template.html.erb (1.0ms)\n  Rendered printlists/show.pdf.erb (81306.7ms)\n\"***************[\\\"C:/Program Files/wkhtmltopdf/bin/wkhtmltopdf.exe\\\", \\\"--encoding\\\", \\\"UTF-8\\\", \\\"--foo\nter-center\\\", \\\"Center\\\", \\\"--footer-left\\\", \\\"Left\\\", \\\"--footer-right\\\", \\\"Right\\\", \\\"file:///C:/Users/\nEVOLUT~1/AppData/Local/Temp/wicked_pdf20170531-6104-vll9bs.html\\\", \\\"C:/Users/EVOLUT~1/AppData/Local/Temp\n/wicked_pdf_generated_file20170531-6104-1yg9cbt.pdf\\\"]***************\"\n  Rendering text template\n  Rendered text template (0.0ms)\nSent data file.pdf.pdf (99.0ms)\nCompleted 200 OK in 83474ms (Views: 98.9ms | ActiveRecord: 210.0ms)\n\n\nCompleted 200 OK in 143922ms (Views: 143651.0ms | ActiveRecord: 153.0ms)\n\n\nCompleted 200 OK in 140215ms (Views: 139404.1ms | ActiveRecord: 186.0ms)\n</code></pre>\n\n<p><strong>All my stylesheets are there, <code>main.scss</code> are importing all the files on <code>estilos's folder</code></strong></p>\n\n<pre><code>---- application.scss\n---- base\n---- bootstrap_and_overrides.css\n---- documents.css.scss\n---- estilos\n------- contato.scss\n------- dashboard.scss\n------- download.scss\n------- home.scss\n------- loginprograma.scss\n------- pgt.scss\n------- pgtcheckout.scss\n------- posters.css.scss\n------- programa.scss\n------- servico.scss\n------- sobres.scs\n---- main.scss\n---- scaffolds.scss\n</code></pre>\n\n<p><strong>main.scss</strong></p>\n\n<pre><code>@import \"bootstrap-sprockets\";\n@import \"bootstrap\";\n@import \"bootstrap/variables\";\n@import \"bootstrap/mixins\";\n@import \"base/modules/variables\";\n\n@import \"base/mixins.scss\";\n@import \"base/normalize.scss\";\n@import \"base/globals.scss\";\n@import \"estilos/home.scss\";\n@import \"estilos/servico.scss\";\n@import \"estilos/sobres.scss\";\n@import \"estilos/contato.scss\";\n@import \"estilos/download.scss\";\n@import \"estilos/programa.scss\";\n@import \"estilos/dashboard.scss\";\n@import \"estilos/pgtcheckout.scss\";\n@import \"estilos/posters.css.scss\";\n@import \"documents.css.scss\";\n</code></pre>\n\n<p><strong>development.rb</strong></p>\n\n<pre><code>Rails.application.configure do\n\n  config.cache_classes = false\n\n  config.eager_load = false\n\n  config.consider_all_requests_local = true\n\n  if Rails.root.join('tmp/caching-dev.txt').exist?\n    config.action_controller.perform_caching = true\n\n    config.cache_store = :memory_store\n    config.public_file_server.headers = {\n      'Cache-Control' =&gt; 'public, max-age=172800'\n    }\n  else\n    config.action_controller.perform_caching = false\n\n    config.cache_store = :null_store\n  end\n\n\n  config.assets.debug = true\n</code></pre>\n\n<p>When I'm trying to change some CSS/SCSS file at my project, the local server (puma) takes too long time to load the page. How can I fix it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": false, "score": 1, "last_activity_date": 1496258914, "creation_date": 1496258914, "answer_id": 44293213, "question_id": 44292947, "link": "https://stackoverflow.com/questions/44292947/how-to-send-user-to-their-profile-as-soon-as-they-sign-in/44293213#44293213", "title": "How to send user to their profile as soon as they sign in?", "body": "<p>As in the answer to this question\n<a href=\"https://stackoverflow.com/questions/11863305/dynamic-path-helpers-rails\">Dynamic path helpers rails</a></p>\n\n<pre><code>def after_sign_in_path_for(resource)\n  if resource.userinfo.info_complete?\n    user_info_path(current_user.userinfo_id)\n  else \n    new_user_info_path\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7903811, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bc9adb95661d3c26781a323c0367c7fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dinukaperera", "link": "https://stackoverflow.com/users/7903811/dinukaperera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496258914, "creation_date": 1496257859, "question_id": 44292947, "link": "https://stackoverflow.com/questions/44292947/how-to-send-user-to-their-profile-as-soon-as-they-sign-in", "title": "How to send user to their profile as soon as they sign in?", "body": "<p>I have a user model that is related to devise. The Userinfo model belongs_to the User model. The userinfo model takes in some information(name, email, school...) through a form. Right now, as soon as the user signs up or signs in, the program checks if the current_user has filled out the information, if not, they will be routed to fill out the info page. If they have filled out the information, they will be routed to the home page, which is the userinfo index page. The index page shows the userinfo of all the users on the site.</p>\n\n<p>The way the routing works:</p>\n\n<p>Userinfo model:</p>\n\n<pre><code>class Userinfo &lt; ActiveRecord::Base\n    belongs_to :user\n    has_many :videos, through: :user\n\n    def info_complete?\n        name? &amp;&amp; email? &amp;&amp; college? &amp;&amp; gpa? &amp;&amp; major?\n    end\nend\n</code></pre>\n\n<p>Application controller:</p>\n\n<pre><code>  def after_sign_in_path_for(resource)\n    if resource.userinfo.info_complete?\n      root_path\n    else \n      new_user_info_path\n    end\n  end\n</code></pre>\n\n<p><strong>PROBLEM</strong></p>\n\n<p>When the user signs in, if the user has the userinfo filled out, I want it to go to the user's profile page, not the index or the root path. The profile path is \"userinfo#show\". For userinfo#index, no id is needed, but to go to the \"userinfo#show\", and id is needed. because userinfo#index is '/userinfos', while userinfos#show is '/userinfos/userinfo_id'. My question is, how do I route the user to the userinfo#show, profile page, as soon as they sign in and if the userinfo data is filled out? </p>\n\n<p>It might be simple but I feel like I'm missing something. How do I get access to the current userinfo_id in the application controller? so I can route it like:</p>\n\n<pre><code> def after_sign_in_path_for(resource)\n    if resource.userinfo.info_complete?\n      userinfo_path(current_user.userinfo_id)\n    else \n      new_user_info_path\n    end\n  end\n</code></pre>\n\n<p>Or something similar to the above?</p>\n"}, {"tags": ["ruby", "capybara", "acceptance-testing"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496259819, "post_id": 44292817, "comment_id": 75593305, "body": "It shouldn&#39;t be passing, are you sure you actually saved the template when adding the comment?  You can output <code>page.html</code> before the expectation to see what the actual page source is.  Also check the string value of <code>quote.industry</code> since if it happens to be an empty string for some reason it would match everything."}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496260894, "post_id": 44292817, "comment_id": 75593910, "body": "aha, I now find that for some reason the actual attr is not saving to the db, see my question here; <a href=\"https://stackoverflow.com/questions/44293291/why-some-model-attributes-not-saved-in-the-db\" title=\"why some model attributes not saved in the db\">stackoverflow.com/questions/44293291/&hellip;</a>. But that still doesn&#39;t solve why this test is passing. Indeed <code>quote.industry</code> is completely empty, so that test should not pass, yet is still does."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1496265138, "post_id": 44292817, "comment_id": 75595820, "body": "If it&#39;s completely empty it will pass -- have_content by default does substring matching and a completely empty string is a substring of anything."}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496267403, "post_id": 44292817, "comment_id": 75596712, "body": "Thanks Thomas, object was nil, so test was still passing, submit your comment as the answer and I will accept it as so."}], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496259741, "post_id": 44292990, "comment_id": 75593268, "body": "The whole <code>tr</code> is being commented out with an HTML comment, the fact that the string is in the source should be irrelevant"}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496260167, "post_id": 44292990, "comment_id": 75593535, "body": "It should not, <code>have_content</code> checks your page for generated content and the content is being generated. BTW, wich version of capybara are you working with?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496260451, "post_id": 44292990, "comment_id": 75593693, "body": "Actually, <code>have_content</code> checks for visible text on the page (it&#39;s just an alias for `have_text). HTML comments are not visible on the page, nor are the contents of them parsed as elements into the DOM, so when something is inside an HTML comment it should be irrelevant to Capybara.  That should be in all versions of Capybara  (I develop Capybara)"}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1496260874, "post_id": 44292990, "comment_id": 75593900, "body": "@ThomasWalpole: You&#39;re absolutely right, it filters everything not visible by the browser, even nodes with <code>display:none</code>, the tests should not be passing"}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "edited": false, "score": 0, "creation_date": 1496261525, "post_id": 44292990, "comment_id": 75594189, "body": "Im using capybara (2.14.0)"}], "tags": [], "owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "is_accepted": false, "score": -1, "last_activity_date": 1496258011, "creation_date": 1496258011, "answer_id": 44292990, "question_id": 44292817, "link": "https://stackoverflow.com/questions/44292817/why-is-this-capbara-have-content-expectation-unexpectedly-passing/44292990#44292990", "title": "Why is this Capbara &#39;have_content&#39; expectation unexpectedly passing?", "body": "<p>The test still passes because the content is still there (check your page source). If you want to comment out the <code>erb</code> output you have to use the proper syntax which is:</p>\n\n<pre><code>&lt;% =begin %&gt;  \n  &lt;% my_code %&gt;\n&lt;%=end %&gt;\n</code></pre>\n\n<p>for multiline comments and</p>\n\n<pre><code>&lt;%# my_code %&gt;\n</code></pre>\n\n<p>for single lines.</p>\n\n<p>This topic (I'm meaning comments, not tests) was discussed <a href=\"https://stackoverflow.com/questions/3127644/block-comments-in-html-erb-templates-in-rails\">here</a> and <a href=\"https://stackoverflow.com/questions/3426671/how-does-one-comment-in-an-erb-template\">here again</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1496268802, "creation_date": 1496268802, "answer_id": 44295482, "question_id": 44292817, "link": "https://stackoverflow.com/questions/44292817/why-is-this-capbara-have-content-expectation-unexpectedly-passing/44295482#44295482", "title": "Why is this Capbara &#39;have_content&#39; expectation unexpectedly passing?", "body": "<p><code>have_content</code> matching (by default) does substring matching.  If <code>quote.industry</code> is nil it will get interpolated to an empty string which is a substring of any content on the page so the test will pass.</p>\n"}], "owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 44295482, "answer_count": 2, "score": 0, "last_activity_date": 1496268802, "creation_date": 1496257448, "last_edit_date": 1496257954, "question_id": 44292817, "link": "https://stackoverflow.com/questions/44292817/why-is-this-capbara-have-content-expectation-unexpectedly-passing", "title": "Why is this Capbara &#39;have_content&#39; expectation unexpectedly passing?", "body": "<p>I am trying to do some acceptance testing and confirm the presence of a model's various attributes being rendered on a Quote#show page. I am using code an expectation as below;</p>\n\n<pre><code>expect(page).to have_content(\"#{quote.industry}\")\n</code></pre>\n\n<p>I am using FactoryGirl to <code>Quote.create</code> with required object attrs. <code>Quote.industry</code> is an <code>enum</code> created on the quote model with a range of options, all works and renders just fine. However wven when I comment out the diaplay of this attribute on the template the test still passes. There is no other element on the page that matches quote.industry. I cannot work out what's going on?</p>\n\n<p>Secondary to actually understanding what's going on with the above, perhaps it' bad form to be interpolating a value into a Capybara matcher argument? Should one stick to giving strings to the <code>have_content</code> matcher?\nBut perhaps the argument given to have_content should just be a string, as opposed to an interpolated FactoryGirl object. Is this acceptable practice?</p>\n\n<p>Thanks</p>\n\n<p>quote_page_spec.rb</p>\n\n<pre><code>require 'rails_helper'\n\nfeature 'quote page' do\n    scenario 'renders all quote attributes' do\n        quote = FactoryGirl.create(:quote)\n        visit(\"/quotes/#{quote.id}\")\n\n        expect(page).to have_content(\"#{quote.industry}\")\n    end\nend\n</code></pre>\n\n<p>factories/quotes.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :quote do\n    sequence(:co_name) { |n| \"Acme Co #{n}\" }\n    industry Quote.industries[:financial_services]\n  end\nend\n</code></pre>\n\n<p>models/quote.rb</p>\n\n<pre><code>class Quote &lt; ApplicationRecord\n    enum industry:          [ :financial_services, :architect, :business_consultancy ]\n    enum payment_frequency: [ :annually, :monthly ]\nend\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n    &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-6\"&gt;\n        &lt;table class=\"table table-bordered table-responsive\"&gt;\n          &lt;thead&gt;\n            &lt;tr&gt;\n              &lt;th&gt;Property&lt;/th&gt;\n              &lt;th&gt;Value&lt;/th&gt;\n            &lt;/tr&gt;\n          &lt;/thead&gt;\n          &lt;tbody&gt;\n            &lt;tr&gt;\n              &lt;td&gt;Company name&lt;/td&gt;\n              &lt;td&gt;&lt;%= @quote.co_name %&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n              &lt;td&gt;Company number&lt;/td&gt;\n              &lt;td&gt;&lt;%= @quote.co_number %&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n              &lt;td&gt;Office postcode&lt;/td&gt;\n              &lt;td&gt;&lt;%= @quote.postcode %&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;!-- &lt;tr&gt;\n              &lt;td&gt;Industry&lt;/td&gt;\n              &lt;td&gt;&lt;%= @quote.industry %&gt;&lt;/td&gt;\n            &lt;/tr&gt; --&gt;\n          &lt;/tbody&gt;\n        &lt;/table&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker"], "comments": [{"owner": {"reputation": 1231, "user_id": 465536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51471b6ab7112ddfdd05548c95146c4d?s=128&d=identicon&r=PG", "display_name": "R Quijano", "link": "https://stackoverflow.com/users/465536/r-quijano"}, "edited": false, "score": 0, "creation_date": 1496257863, "post_id": 44292633, "comment_id": 75592233, "body": "You expose port 3000 but you are trying to reach 32772?"}, {"owner": {"reputation": 121, "user_id": 8093847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220546762eeced3caa046f54e809953b?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/8093847/donald"}, "reply_to_user": {"reputation": 1231, "user_id": 465536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51471b6ab7112ddfdd05548c95146c4d?s=128&d=identicon&r=PG", "display_name": "R Quijano", "link": "https://stackoverflow.com/users/465536/r-quijano"}, "edited": false, "score": 0, "creation_date": 1496258036, "post_id": 44292633, "comment_id": 75592339, "body": "I am exposing 3000 within the container, which is then being mapped to 32772 on my localhost from what I gather (at least per &quot;0.0.0.0:32772-&gt;3000/tcp&quot; displayed via &quot;docker ps&quot;)"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1496258596, "post_id": 44292633, "comment_id": 75592648, "body": "I normally use docker-compose in conjunction with my dockerfile to make sure things are setup in an automated and consistent fashion.  In your dockerfile you would use the &quot;ports&quot; option and do something like ports: &quot;8000:8000&quot; left 8000 is docker host, right 8000 is docker container."}, {"owner": {"reputation": 1231, "user_id": 465536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51471b6ab7112ddfdd05548c95146c4d?s=128&d=identicon&r=PG", "display_name": "R Quijano", "link": "https://stackoverflow.com/users/465536/r-quijano"}, "edited": false, "score": 0, "creation_date": 1496258710, "post_id": 44292633, "comment_id": 75592697, "body": "@Donald didn&#39;t see the port forwarding in the docker run. But have a look into this <a href=\"https://forums.docker.com/t/using-localhost-for-to-access-running-container/3148/6\" rel=\"nofollow noreferrer\">forums.docker.com/t/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 8093847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220546762eeced3caa046f54e809953b?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/8093847/donald"}, "edited": false, "score": 0, "creation_date": 1496265887, "post_id": 44294443, "comment_id": 75596105, "body": "Tried this - &quot;docker-machine ls&quot; gives me a URL of &quot;tcp://192.168.99.100:2376&quot;. But when I go to &quot;<a href=\"http://192.168.99.100:32772\" rel=\"nofollow noreferrer\">192.168.99.100:32772</a>&quot; in my address bar, I still get the same error!"}, {"owner": {"reputation": 881, "user_id": 541432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da1d1a8b11424cc5a2a8fa9c57d54cdd?s=128&d=identicon&r=PG", "display_name": "elvin", "link": "https://stackoverflow.com/users/541432/elvin"}, "reply_to_user": {"reputation": 121, "user_id": 8093847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220546762eeced3caa046f54e809953b?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/8093847/donald"}, "edited": false, "score": 1, "creation_date": 1496266575, "post_id": 44294443, "comment_id": 75596374, "body": "I saw that you&#39;re exposing port 3000 on Dockerfile but your service seems to be listening on port 9292. I think those have to match."}], "tags": [], "owner": {"reputation": 881, "user_id": 541432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da1d1a8b11424cc5a2a8fa9c57d54cdd?s=128&d=identicon&r=PG", "display_name": "elvin", "link": "https://stackoverflow.com/users/541432/elvin"}, "is_accepted": false, "score": 1, "last_activity_date": 1496263867, "creation_date": 1496263867, "answer_id": 44294443, "question_id": 44292633, "link": "https://stackoverflow.com/questions/44292633/err-connection-refused-by-docker-container/44294443#44294443", "title": "ERR_CONNECTION_REFUSED by docker container", "body": "<p>I spend a couple of hours on this as well and this <a href=\"https://github.com/moby/moby/issues/22753#issuecomment-243406719\" rel=\"nofollow noreferrer\">thread</a> was really helpful. What i'm doing right now is accessing those services through the vm's ip address.</p>\n\n<p>You can get your vm's address running: </p>\n\n<pre><code>docker-machine ls\n</code></pre>\n\n<p>then try to access your service using the host mapped port 37772, something like this:</p>\n\n<pre><code>http://&lt;VM IP ADDRESS&gt;:32772\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 8093847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220546762eeced3caa046f54e809953b?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/8093847/donald"}, "is_accepted": true, "score": 1, "last_activity_date": 1496293057, "creation_date": 1496293057, "answer_id": 44298821, "question_id": 44292633, "link": "https://stackoverflow.com/questions/44292633/err-connection-refused-by-docker-container/44298821#44298821", "title": "ERR_CONNECTION_REFUSED by docker container", "body": "<p>The combination of the above tricks worked-- </p>\n\n<p>I had to use <code>http://&lt;VM IP ADDRESS&gt;:32772</code> (localhost:32772 did NOT work), AND I had to fix my exposed port to match the TCP listening port of 9292.</p>\n\n<p>I still don't understand why the TCP listening port defaulted to 9292 instead of 3000, but I'll look into that separately.</p>\n\n<p>Thank you for the help!</p>\n"}], "owner": {"reputation": 121, "user_id": 8093847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220546762eeced3caa046f54e809953b?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/8093847/donald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6462, "favorite_count": 0, "accepted_answer_id": 44298821, "answer_count": 2, "score": 5, "last_activity_date": 1496293057, "creation_date": 1496256798, "last_edit_date": 1496257484, "question_id": 44292633, "link": "https://stackoverflow.com/questions/44292633/err-connection-refused-by-docker-container", "title": "ERR_CONNECTION_REFUSED by docker container", "body": "<p>I'm new to Docker and trying to make a demo Rails app. I made a dockerfile that looks like this:</p>\n\n<pre><code>FROM ruby:2.2 \n\n# Install apt based dependencies required to run Rails as \n# well as RubyGems. As the Ruby image itself is based on a \n# Debian image, we use apt-get to install those.\nRUN apt-get update &amp;&amp; apt-get install -y \\ \n  build-essential \\ \n  nodejs\n\n# Configure the main working directory. This is the base \n# directory used in any further RUN, COPY, and ENTRYPOINT \n# commands.\nRUN mkdir -p /app \nWORKDIR /app\n\n# Copy the Gemfile as well as the Gemfile.lock and install \n# the RubyGems. This is a separate step so the dependencies \n# will be cached unless changes to one of those two files \n# are made.\nCOPY Gemfile Gemfile.lock ./ \nRUN gem install bundler &amp;&amp; bundle install --jobs 20 --retry 5\n\n# Copy the main application.\nCOPY . ./\n\n# Expose port 3000 to the Docker host, so we can access it \n# from the outside.\nEXPOSE 3000\n\n# The main command to run when the container starts. Also \n# tell the Rails dev server to bind to all interfaces by \n# default.\nCMD [\"bundle\", \"exec\", \"rails\", \"server\", \"-b\", \"0.0.0.0\"]\n</code></pre>\n\n<p>I then built it (no errors):</p>\n\n<pre><code>docker build -t demo . \n</code></pre>\n\n<p>And then run it (also no errors):</p>\n\n<pre><code>docker run -itP demo\n=&gt; Booting Puma\n=&gt; Rails 5.1.1 application starting in development on http://0.0.0.0:3000\n=&gt; Run `rails server -h` for more startup options\nPuma starting in single mode...\n* Version 3.8.2 (ruby 2.2.7-p470), codename: Sassy Salamander\n* Min threads: 5, max threads: 5\n* Environment: development\n* Listening on tcp://0.0.0.0:9292\nUse Ctrl-C to stop\n</code></pre>\n\n<p>When I run a <code>docker ps</code> command in a separate terminal to determine the ports, I get:</p>\n\n<pre><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                     NAMES\n55e8224f7c15        demo                \"bundle exec rails...\"   About an hour ago   Up About an hour    0.0.0.0:32772-&gt;3000/tcp   ecstatic_bohr\n</code></pre>\n\n<p>However, when I try to connect to it at either <code>http://localhost:32772</code> or <code>http://192.168.99.100:32772</code> using Chrome or via a curl command, I receive a \"Connection refused\".</p>\n\n<p>When I run the app outside of docker on my local machine via <code>bundle exec rails server</code> command, it works fine. Note that I am using Docker Toolbox on my Win7 machine</p>\n\n<p>What could I be doing wrong ?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496257431, "post_id": 44292183, "comment_id": 75591974, "body": "Why the rush to select an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 1740, "user_id": 1620743, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b752035dcd121d3cedc56d2ab0f9922?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel E.", "link": "https://stackoverflow.com/users/1620743/samuel-e"}, "edited": false, "score": 0, "creation_date": 1496256050, "post_id": 44292347, "comment_id": 75591216, "body": "Hi, thank you for your help, but I forgot to say that I need it to return a boolean"}], "tags": [], "owner": {"reputation": 184, "user_id": 4151328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CFbJ0.jpg?s=128&g=1", "display_name": "Sam Mitchell", "link": "https://stackoverflow.com/users/4151328/sam-mitchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1496255729, "creation_date": 1496255729, "answer_id": 44292347, "question_id": 44292183, "link": "https://stackoverflow.com/questions/44292183/checking-that-a-string-with-multiple-lines-only-contains-a-set-of-specific-chara/44292347#44292347", "title": "Checking that a string with multiple lines only contains a set of specific characters in Ruby", "body": "<p>Ruby has the <code>.scan</code> method for Strings which can allow you to scan through the whole String as needed, and call the regex statement on this as well.</p>\n\n<p>This scans in each section to an array allowing you to check each index.</p>\n\n<p>See here: <a href=\"https://apidock.com/ruby/String/scan\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/String/scan</a></p>\n"}, {"comments": [{"owner": {"reputation": 1740, "user_id": 1620743, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b752035dcd121d3cedc56d2ab0f9922?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel E.", "link": "https://stackoverflow.com/users/1620743/samuel-e"}, "edited": false, "score": 0, "creation_date": 1496256320, "post_id": 44292408, "comment_id": 75591368, "body": "Thank you, it works! i just added <code>!!()</code> around it and it returns a bool too"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 1740, "user_id": 1620743, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b752035dcd121d3cedc56d2ab0f9922?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel E.", "link": "https://stackoverflow.com/users/1620743/samuel-e"}, "edited": false, "score": 0, "creation_date": 1496256507, "post_id": 44292408, "comment_id": 75591472, "body": "@SamuelE. I&#39;m not sure if you saw my edit, but the <code>m</code> flag isn&#39;t necessary after all. Also, if you&#39;re using Ruby 2.4+, instead of <code>=~</code> you can use the <a href=\"https://ruby-doc.org/core-2.4.1/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\"><code>String#match?</code></a> method, which returns a boolean (and is also <i>slightly</i> more efficient for reasons mentioned in the linked docs)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496257576, "post_id": 44292408, "comment_id": 75592058, "body": "<code>nil</code> is a boolean?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496257616, "post_id": 44292408, "comment_id": 75592085, "body": "@CarySwoveland No, it&#39;s not. Perhaps you&#39;re thinking of <code>String#match</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496257756, "post_id": 44292408, "comment_id": 75592158, "body": "What I meant was that the OP asked that it return a boolean (<code>true</code> or <code>false</code>), but you return <code>nil</code>. Perhaps the OP did the edit after you answered."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496257847, "post_id": 44292408, "comment_id": 75592215, "body": "@CarySwoveland Imagine that. Looks like OP figured it out anyway."}, {"owner": {"reputation": 1740, "user_id": 1620743, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b752035dcd121d3cedc56d2ab0f9922?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel E.", "link": "https://stackoverflow.com/users/1620743/samuel-e"}, "edited": false, "score": 0, "creation_date": 1496261072, "post_id": 44292408, "comment_id": 75593995, "body": "Thank you all for the answers, I don&#39;t use the <code>m</code> flag and Im running ruby version 2.3"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1496263795, "last_edit_date": 1496263795, "creation_date": 1496256014, "answer_id": 44292408, "question_id": 44292183, "link": "https://stackoverflow.com/questions/44292183/checking-that-a-string-with-multiple-lines-only-contains-a-set-of-specific-chara/44292408#44292408", "title": "Checking that a string with multiple lines only contains a set of specific characters in Ruby", "body": "<p>Use the the <code>\\A</code> and <code>\\z</code> anchors to match the beginning and end of the string, respectively:</p>\n\n<pre><code>\"|_| _| _ |_ |_|\\n 14sdfsdf\" =~ /\\A[ |_\\n]+\\z/\n# =&gt; nil\n</code></pre>\n\n<p>Note that I've also added <code>\\n</code> to the character class, and removed the escapes that aren't necessary inside a character class.</p>\n\n<p>See it on Rubular: <a href=\"http://rubular.com/r/qR4eVaOVof\" rel=\"nofollow noreferrer\">http://rubular.com/r/qR4eVaOVof</a> or repl.it: <a href=\"https://repl.it/I0IR\" rel=\"nofollow noreferrer\">https://repl.it/I0IR</a></p>\n\n<p>If you're using Ruby 2.4+, instead of <code>=~</code> you can use the <a href=\"https://ruby-doc.org/core-2.4.1/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\"><code>String#match?</code></a> method (note the question mark), which returns a boolean (and doesn't populate the <code>$~</code>, <code>$1</code>, etc. globals, making it <em>very slightly</em> more efficient):</p>\n\n<pre><code>\"|_| _| _ |_ |_|\\n 14sdfsdf\".match?(/\\A[ |_\\n]+\\z/)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1496257404, "creation_date": 1496257404, "answer_id": 44292810, "question_id": 44292183, "link": "https://stackoverflow.com/questions/44292183/checking-that-a-string-with-multiple-lines-only-contains-a-set-of-specific-chara/44292810#44292810", "title": "Checking that a string with multiple lines only contains a set of specific characters in Ruby", "body": "<p>In this case it's easier to check whether the string contains a character other than the given ones:</p>\n\n<pre><code>r = /[^\\s_|]/\n\n\"|_| _| _ |_ |_|\\n _\" !~ r                #=&gt; true\n\"|_| _| _ |_ |_|\\n 14sdfsdf\" !~ /[^\\s_|]/ #=&gt; false\n</code></pre>\n\n<p>Anchors are not needed and <code>!~</code> returns a Boolean.</p>\n"}], "owner": {"reputation": 1740, "user_id": 1620743, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b752035dcd121d3cedc56d2ab0f9922?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel E.", "link": "https://stackoverflow.com/users/1620743/samuel-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44292408, "answer_count": 3, "score": 1, "last_activity_date": 1496263795, "creation_date": 1496255161, "last_edit_date": 1496263759, "question_id": 44292183, "link": "https://stackoverflow.com/questions/44292183/checking-that-a-string-with-multiple-lines-only-contains-a-set-of-specific-chara", "title": "Checking that a string with multiple lines only contains a set of specific characters in Ruby", "body": "<p>I'm trying to validate that a string that might contain more than one line will only contain the next characters:\nwhitespace, underscore or a pipe (\" \", \"_\" \"|\")</p>\n\n<p>I did this:</p>\n\n<pre><code>string =~ /^[\\ \\|\\_]+$/\n</code></pre>\n\n<p>And it's working fine if the string only has one line like for example:</p>\n\n<pre><code>\"|_| _| _ |_ |_| a _\" =~ /^[\\ \\|\\_]+$/ # false\n</code></pre>\n\n<p>But in this case, it will return true, and I don't want that</p>\n\n<pre><code>\"|_| _| _ |_ |_|\\n 14sdfsdf\" =~ /^[\\ \\|\\_]+$/ # true?\n</code></pre>\n\n<p>In other languages, I can add the \"global\" flag, but I don't know how to do it in Ruby.</p>\n\n<p>I need it to return a boolean.</p>\n"}, {"tags": ["ruby", "serialization", "io"], "comments": [{"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 1, "creation_date": 1496255691, "post_id": 44291784, "comment_id": 75591026, "body": "Can you read it in binary mode?  Maybe the contains strange binary data that stops the file reading (EOF). See e.g. <a href=\"https://stackoverflow.com/questions/130948/ruby-convert-file-to-string\" title=\"ruby convert file to string\">stackoverflow.com/questions/130948/ruby-convert-file-to-stri&zwnj;&#8203;ng</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 1, "last_activity_date": 1496256640, "last_edit_date": 1496256640, "creation_date": 1496256014, "answer_id": 44292409, "question_id": 44291784, "link": "https://stackoverflow.com/questions/44291784/how-to-read-a-large-file-into-a-string/44292409#44292409", "title": "How to read a large file into a string", "body": "<p><code>Marshal</code> is a binary format, so you need to read and write in binary mode. The easiest way is to use <code>IO.binread/write</code>.</p>\n\n<pre><code>...\nIO.binwrite('mat_save', mat_dump)\n...\nmat_dump = IO.binread('mat_save')\n@mat = Marshal.load(mat_dump)\n</code></pre>\n\n<p>Remember that Marshaling is Ruby version dependent. It's only <a href=\"http://ruby-doc.org/core-2.4.1/Marshal.html\" rel=\"nofollow noreferrer\">compatible under specific circumstances</a> with other Ruby versions. So keep that in mind:</p>\n\n<blockquote>\n  <p>In normal use, marshaling can only load data written with the same major version number and an equal or lower minor version number. </p>\n</blockquote>\n"}], "owner": {"reputation": 1911, "user_id": 5018771, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dec254b17d75df0cfa8c42806cfca3f?s=128&d=identicon&r=PG&f=1", "display_name": "AdrienW", "link": "https://stackoverflow.com/users/5018771/adrienw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 44292409, "answer_count": 1, "score": 0, "last_activity_date": 1496264295, "creation_date": 1496253779, "last_edit_date": 1496264295, "question_id": 44291784, "link": "https://stackoverflow.com/questions/44291784/how-to-read-a-large-file-into-a-string", "title": "How to read a large file into a string", "body": "<p>I'm trying to save and load the states of Matrices (using <a href=\"https://ruby-doc.org/stdlib-2.3.0/libdoc/matrix/rdoc/Matrix.html\" rel=\"nofollow noreferrer\"><code>Matrix</code></a>) during the execution of my program with the functions <code>dump</code> and <code>load</code> from <a href=\"https://ruby-doc.org/core-2.3.0/Marshal.html\" rel=\"nofollow noreferrer\"><code>Marshal</code></a>. I can serialize the matrix and get a ~275 KB file, but when I try to load it back as a string to deserialize it into an object, Ruby gives me only the beginning of it.</p>\n\n<pre><code># when I want to save\nmat_dump = Marshal.dump(@mat)  # serialize object - OK\nFile.open('mat_save', 'w') {|f| f.write(mat_dump)}  # write String to file - OK\n\n# somewhere else in the code\nmat_dump = File.read('mat_save')  # read String from file - only reads like 5%\n@mat = Marshal.load(mat_dump)  # deserialize object - \"ArgumentError: marshal data too short\"\n</code></pre>\n\n<p>I tried to change the arguments for <code>load</code> but didn't find anything yet that doesn't cause an error.</p>\n\n<p>How can I load the entire file into memory? If I could read the file chunk by chunk, then loop to store it in the String and then deserialize, it would work too. The file has basically one big line so I can't even say I'll read it line by line, the problem stays the same.</p>\n\n<p>I saw some questions about the topic:</p>\n\n<ul>\n<li>\"<a href=\"https://stackoverflow.com/questions/15460423/ruby-serialize-array-and-deserialize-back\">Ruby serialize array and deserialize back</a>\"</li>\n<li>\"<a href=\"https://stackoverflow.com/questions/6472232/whats-a-reasonable-way-to-read-an-entire-text-file-as-a-single-string\">What&#39;s a reasonable way to read an entire text file as a single string?</a>\"</li>\n<li>\"<a href=\"https://stackoverflow.com/questions/3328495/how-to-read-whole-file-in-ruby\">How to read whole file in Ruby?</a>\"</li>\n</ul>\n\n<p>but none of them seem to have the answers I'm looking for.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 1, "creation_date": 1496254564, "post_id": 44291755, "comment_id": 75590378, "body": "Can you show the code in your product model? And do  you have any initializers that read your Product table?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 3, "creation_date": 1496255384, "post_id": 44291755, "comment_id": 75590830, "body": "I didn&#39;t think of that , but it makes sense. I had an integration in for elastic search which was causing the issue and forcing an import when the model was instantiated. I removed it and everything worked as expected. Thanks for pointing that out. @SteveTurczyn"}, {"owner": {"reputation": 1787, "user_id": 2043736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0T846.jpg?s=128&g=1", "display_name": "Giovanni Benussi", "link": "https://stackoverflow.com/users/2043736/giovanni-benussi"}, "edited": false, "score": 0, "creation_date": 1496256277, "post_id": 44291755, "comment_id": 75591336, "body": "Are you using a default scope?"}, {"owner": {"reputation": 4023, "user_id": 396964, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d5d2fc7ebac788a7eca7acd89a96485?s=128&d=identicon&r=PG", "display_name": "chrismanderson", "link": "https://stackoverflow.com/users/396964/chrismanderson"}, "edited": false, "score": 0, "creation_date": 1496283515, "post_id": 44291755, "comment_id": 75600836, "body": "This is a side note, but you should consider renaming <code>&quot;&#47;admin&#47;admin_products&#47;&quot;</code> to just <code>&#47;admin&#47;products</code> to stick to rails convention."}], "answers": [{"tags": [], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "is_accepted": true, "score": 0, "last_activity_date": 1496344222, "creation_date": 1496344222, "answer_id": 44315341, "question_id": 44291755, "link": "https://stackoverflow.com/questions/44291755/speeding-up-rails-queries/44315341#44315341", "title": "Speeding up rails queries", "body": "<p>@SteveTurczyn pointed out my issue which ended up being rather simple. The problem involved calling an import function for Elastic Search which was in my Product model. After I removed the line of code, everything worked as expected. Here is the code that slowed down the process.</p>\n\n<pre><code>Product.includes(normal_model: [:normal_brand]).import force: true\n</code></pre>\n\n<p>I now have a controller method that invokes the import function when needed. </p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44315341, "answer_count": 1, "score": 1, "last_activity_date": 1496344222, "creation_date": 1496253676, "question_id": 44291755, "link": "https://stackoverflow.com/questions/44291755/speeding-up-rails-queries", "title": "Speeding up rails queries", "body": "<p>I've got a table that contains 10k products. When I query the database after a server restart, the server is querying all of the 10k products and then limits to 15 records in the response. Is this normal? It is causing my page to take 23 seconds for the first page to load. Upon the second request, everything looks better, but I still don't understand why the first query is grabbing all of those records. </p>\n\n<p>My Query: </p>\n\n<pre><code>@products = Product.limit(15)\n</code></pre>\n\n<p>The first response:</p>\n\n<pre><code>Started GET \"/admin/admin_products/\" for 50.255.94.246 at 2017-05-31 17:43:49 +0000\nCannot render console from 50.255.94.246! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255\nActiveRecord::SchemaMigration Load (0.6ms)  SELECT \"schema_migrations\".* FROM \"schema_migrations\"\nProcessing by AdminProductsController#index as HTML\n/home/ubuntu/workspace/app/models/product.rb:96: warning: key :description is duplicated and overwritten on line 96\nProduct Load (5.7ms)  SELECT  \"products\".* FROM \"products\" ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (12.2ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 1000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (6.4ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 2000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (9.6ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 3000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (9.2ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 4000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (9.1ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 5000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (9.9ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 6000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (9.4ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 7000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (59.5ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 8000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (131.0ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 9000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\nProduct Load (2.1ms)  SELECT  \"products\".* FROM \"products\" WHERE (\"products\".\"id\" &gt; 10000) ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\n  Rendering admin_products/index.html.erb within layouts/application\n  Rendered layouts/_admin_portal.html.erb (0.6ms)\n  Product Load (0.8ms)  SELECT  \"products\".* FROM \"products\" LIMIT $1  [[\"LIMIT\", 15]]\n  Rendered collection of admin_products/_product.html.erb [15 times] (2.8ms)\n  Rendered admin_products/_paginate.html.erb (0.6ms)\n  Rendered admin_products/index.html.erb within layouts/application (15.9ms)\n  Rendered layouts/_flash_messages.html.erb (0.8ms)\nCompleted 200 OK in 23486ms (Views: 7643.7ms | ActiveRecord: 269.2ms)\n</code></pre>\n\n<p>The second time I execute the query:</p>\n\n<pre><code>Started GET \"/admin/admin_products/\" for 50.255.94.246 at 2017-05-31 \n17:59:00 +0000\nCannot render console from 50.255.94.246! Allowed networks: 127.0.0.1, ::1, \n127.0.0.0/127.255.255.255\nProcessing by AdminProductsController#index as HTML\nRendering admin_products/index.html.erb within layouts/application\nRendered layouts/_admin_portal.html.erb (0.5ms)\nProduct Load (0.9ms)  SELECT  \"products\".* FROM \"products\" LIMIT $1  [[\"LIMIT\", 15]]\nRendered collection of admin_products/_product.html.erb [15 times] (2.7ms)\nRendered admin_products/_paginate.html.erb (0.6ms)\nRendered admin_products/index.html.erb within layouts/application (10.8ms)\nRendered layouts/_flash_messages.html.erb (0.8ms)\nCompleted 200 OK in 26ms (Views: 23.5ms | ActiveRecord: 0.9ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal", "stripe-payments"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496250081, "post_id": 44290511, "comment_id": 75587913, "body": "What&#39;s the full error?"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1496250234, "post_id": 44290511, "comment_id": 75588015, "body": "<code>params[:product_id]</code> hast <code>@product.id</code> in it ?, so, your view is wrong."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1496252412, "post_id": 44290511, "comment_id": 75589271, "body": "Please share your view code."}], "owner": {"reputation": 9, "user_id": 7361574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba79f08e58fb903fc34797047dd608a?s=128&d=identicon&r=PG&f=1", "display_name": "Andre Heslop", "link": "https://stackoverflow.com/users/7361574/andre-heslop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496252337, "creation_date": 1496249351, "last_edit_date": 1496252337, "question_id": 44290511, "link": "https://stackoverflow.com/questions/44290511/stripe-payment-error-couldnt-find-product-with-id-product-id", "title": "Stripe payment error Couldn&#39;t find Product with &#39;id&#39;=@product.id", "body": "<p>Every time I test Stripe it gives me the error:</p>\n\n<pre><code>Couldn't find Product with 'id'=@product.id\n</code></pre>\n\n<p>This is my payment controller:</p>\n\n<pre><code>class PaymentsController &lt; ApplicationController\n    def create\n      @product = Product.find(params[:product_id])\n      @user = current_user\n      token = params[:stripeToken]\n      # Create the charge on Stripe's servers - this will charge the user's card\n      begin\n        charge = Stripe::Charge.create(\n          amount:  product.price, # amount in cents, again\n          currency: \"usd\",\n          source: token,\n          description: params[:stripeEmail]\n        )\n      rescue Stripe::CardError =&gt; e\n        # The card has been declined\n      end\n      redirect_to product_path(@product), notice: \"Payment processed successfully!\"\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "string", "class", "rspec"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1496249600, "post_id": 44290505, "comment_id": 75587639, "body": "Error messages are there to guide you. In your <code>capital_it</code> method, your <code>map</code> <code>do</code> is missing an <code>end</code>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1496250119, "post_id": 44290505, "comment_id": 75587932, "body": "According to your <code>initialize</code> method, when you create a new book with <code>Book.new</code> you have to pass an argument i.e. <code>@book = Book.new(&#39;a title&#39;)</code>."}, {"owner": {"reputation": 187, "user_id": 7993932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/54bdc1c37f603695388ef6a30d848040?s=128&d=identicon&r=PG&f=1", "display_name": "springathing", "link": "https://stackoverflow.com/users/7993932/springathing"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1496250754, "post_id": 44290505, "comment_id": 75588361, "body": "I don&#39;t seem to understand how arguments are passed through classes and what function each method serves based on how it is set up with instance variables. I got the spec to work but I had to do &quot;def initializer&quot; without argument and in the body pass the instance variable through the method like this: capital_it(@title)."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1496251153, "post_id": 44290505, "comment_id": 75588583, "body": "Might be worth following a tutorial of some sort, there are quite a few concepts to understand. This link <a href=\"http://ruby-for-beginners.rubymonstas.org/writing_classes/initializers.html\" rel=\"nofollow noreferrer\">ruby-for-beginners.rubymonstas.org/writing_classes/&hellip;</a> may help in the meantime to understand <code>initialize</code>."}, {"owner": {"reputation": 187, "user_id": 7993932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/54bdc1c37f603695388ef6a30d848040?s=128&d=identicon&r=PG&f=1", "display_name": "springathing", "link": "https://stackoverflow.com/users/7993932/springathing"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1496251357, "post_id": 44290505, "comment_id": 75588698, "body": "Thanks a ton for your help sagarpandya82! It finally passed the checks and I now see that I don&#39;t understand how attr_accessors and initializer methods work exactly and/or how the arguments are inputted into the code"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7993932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/54bdc1c37f603695388ef6a30d848040?s=128&d=identicon&r=PG&f=1", "display_name": "springathing", "link": "https://stackoverflow.com/users/7993932/springathing"}, "edited": false, "score": 0, "creation_date": 1496263898, "post_id": 44292976, "comment_id": 75595262, "body": "what is the point of the &quot;private&quot; I&#39;ve seen it on many solutions yet I can&#39;t find the reasoning behind why its used. I thought it was meant for hiding code from users of your websites or programs"}, {"owner": {"reputation": 735, "user_id": 5775246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rWMQ7_UYyiI/AAAAAAAAAAI/AAAAAAAAADc/xFHc8sFhSWk/photo.jpg?sz=128", "display_name": "DjezzzL", "link": "https://stackoverflow.com/users/5775246/djezzzl"}, "reply_to_user": {"reputation": 187, "user_id": 7993932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/54bdc1c37f603695388ef6a30d848040?s=128&d=identicon&r=PG&f=1", "display_name": "springathing", "link": "https://stackoverflow.com/users/7993932/springathing"}, "edited": false, "score": 0, "creation_date": 1496264069, "post_id": 44292976, "comment_id": 75595353, "body": "@stringathing It&#39;s about <a href=\"https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)\" rel=\"nofollow noreferrer\">encapsulation</a>"}], "tags": [], "owner": {"reputation": 735, "user_id": 5775246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rWMQ7_UYyiI/AAAAAAAAAAI/AAAAAAAAADc/xFHc8sFhSWk/photo.jpg?sz=128", "display_name": "DjezzzL", "link": "https://stackoverflow.com/users/5775246/djezzzl"}, "is_accepted": false, "score": 1, "last_activity_date": 1496257965, "creation_date": 1496257965, "answer_id": 44292976, "question_id": 44290505, "link": "https://stackoverflow.com/questions/44290505/book-capitalization-class-error/44292976#44292976", "title": "Book Capitalization Class Error", "body": "<p>First of all, you have an issue in your <code>def capital_it(title)</code> method. </p>\n\n<ol>\n<li><code>.map</code> method will return a new array which you didn't assign to anything. If you want to reassign it to local variable <code>word_arr</code> use <code>.map!</code> instead.</li>\n<li>You should probably rewrite condition <code>word.capitalize! unless little_words.include?(word)</code> to this <code>little_words.include?(word) ? word : word.capitalize</code></li>\n</ol>\n\n<p>P.S. In your case it works because you use <code>capitalize!</code> on each string of element but the style of writing like that isn't good.</p>\n\n<p>So I'd recommend you to write your class like this one:</p>\n\n<pre><code>class Book\n  SKIP = %w(the a an and in of)\n\n  attr_writer :title\n\n  def initialize(title)\n    @title = title\n  end\n\n  def title\n    capital(@title)\n  end\n\n  private\n\n  def capital(title)\n    array = @title.split(/\\s+/)\n    array.map! do |word|\n      SKIP.include?(word) ? word: word.capitalize\n    end\n    array.join(\" \")\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1496258501, "creation_date": 1496258501, "answer_id": 44293119, "question_id": 44290505, "link": "https://stackoverflow.com/questions/44290505/book-capitalization-class-error/44293119#44293119", "title": "Book Capitalization Class Error", "body": "<blockquote>\n  <p>Where does the argument go to first? The <code>attr_accessor</code> or the <code>def title</code> ... ?</p>\n</blockquote>\n\n<p><code>attr_accessor :title</code> defines two methods for you: <code>title</code> (the \"reader\") and <code>title=</code> (the \"writer\"). When you do <code>def title</code> after <code>attr_accessor</code>, you replace the <code>title</code> method entirely with your new method.</p>\n\n<p>In other words, the method generated by <code>attr_accessor</code> is never called, because you've overwritten it with your own method.</p>\n\n<p>Since you're writing your own \"reader\" method, you should just use <code>attr_writer</code>:</p>\n\n<pre><code>class Book\n  attr_writer :title\n\n  def title\n    capital_it(@title)\n  end\n\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 7993932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/54bdc1c37f603695388ef6a30d848040?s=128&d=identicon&r=PG&f=1", "display_name": "springathing", "link": "https://stackoverflow.com/users/7993932/springathing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44293119, "answer_count": 2, "score": 0, "last_activity_date": 1496258501, "creation_date": 1496249344, "last_edit_date": 1496251231, "question_id": 44290505, "link": "https://stackoverflow.com/questions/44290505/book-capitalization-class-error", "title": "Book Capitalization Class Error", "body": "<p>I'm teaching myself how to code and can't seem to understand how the inputted title is being called by this class. Where does the argument go to first? The attr_accessor or the def title  capital_it(@title)  end? </p>\n\n<pre><code>class Book\n\n    attr_accessor :title\n\n    def title\n        capital_it(@title)\n    end\n\n    def capital_it(title)\n        word_arr = @title.capitalize.split(\" \")\n        word_arr.map do |word|\n            word.capitalize! unless little_words.include?(word)\n            end\n        word_arr.join(\" \")\n    end\n\n    def little_words\n        [\"the\", \"a\", \"an\", \"and\", \"in\", \"of\"]\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "minimagick"], "answers": [{"tags": [], "owner": {"reputation": 14303, "user_id": 29493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bb15b284510700d32de5a68f190c6dc?s=128&d=identicon&r=PG", "display_name": "Tim Scott", "link": "https://stackoverflow.com/users/29493/tim-scott"}, "is_accepted": true, "score": 0, "last_activity_date": 1496599368, "creation_date": 1496599368, "answer_id": 44357218, "question_id": 44290421, "link": "https://stackoverflow.com/questions/44290421/make-multiple-copies-from-original-with-image-minimagick/44357218#44357218", "title": "Make Multiple Copies From Original with image = MiniMagick", "body": "<p>I found one way to do it, which seems fine.</p>\n\n<pre><code># Original image is jpeg\nimage = MiniMagick::Image.open url\nimage.crop dimensions\n\nnew_image = MiniMagick::Image.open image.tempfile.path\n\nimage.format 'pdf'\nupload image\n\nnew_image.format 'png'\nnew_image.resize new_size\nupload new_image\n</code></pre>\n\n<p>Both the PDF and PNG will be cropped but each will only be converted once.</p>\n"}], "owner": {"reputation": 14303, "user_id": 29493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bb15b284510700d32de5a68f190c6dc?s=128&d=identicon&r=PG", "display_name": "Tim Scott", "link": "https://stackoverflow.com/users/29493/tim-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 44357218, "answer_count": 1, "score": 1, "last_activity_date": 1496599368, "creation_date": 1496249094, "question_id": 44290421, "link": "https://stackoverflow.com/questions/44290421/make-multiple-copies-from-original-with-image-minimagick", "title": "Make Multiple Copies From Original with image = MiniMagick", "body": "<p>I need to generate several copies of an image in different formats/sizes. Can I do it without re-opening the source for each format/size?</p>\n\n<p>Take this example:</p>\n\n<pre><code># Original image is jpeg\nimage = MiniMagick::Image.open url\nimage.crop dimensions\nimage.format 'pdf'\nupload image\n# image = MiniMagick::Image.open url # No! Needless network traffic and processing.\nimage.format 'png'\nimage.resize new_size\nupload image\n</code></pre>\n\n<p>This code is no good without the second <code>#open</code> because when <code>image.format 'png'</code> is called the image is a PDF, so I would end up rasterizing it, which is not what I want to do.</p>\n\n<p>There's a method <code>#clone</code>, but it does not make a clone of the image object. Rather it sets a parameter for the converter. I can't figure out if this will somehow suit my purpose.</p>\n"}, {"tags": ["ruby", "image", "api", "search", "bing"], "comments": [{"owner": {"reputation": 59, "user_id": 11006719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbsGP.png?s=128&g=1", "display_name": "SoaringGecko", "link": "https://stackoverflow.com/users/11006719/soaringgecko"}, "edited": false, "score": 0, "creation_date": 1584242801, "post_id": 44290094, "comment_id": 107377727, "body": "I can&#39;t help fix the problem with Bing, but I made <a href=\"https://soaringgecko.github.io/8K-image-search/\" rel=\"nofollow noreferrer\">a website</a> that searches Google Images with a height and width you specify. Sorry I can&#39;t help with the actual problem but... this is the best I can do. <a href=\"https://soaringgecko.github.io/8K-image-search/\" rel=\"nofollow noreferrer\">8K Image Search</a> (a.k.a. the website I was talking about)"}], "owner": {"reputation": 31, "user_id": 8093136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f296d5a6c371774d1d3b9a73e3ed51d1?s=128&d=identicon&r=PG&f=1", "display_name": "yoiko", "link": "https://stackoverflow.com/users/8093136/yoiko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1584242801, "creation_date": 1496248014, "question_id": 44290094, "link": "https://stackoverflow.com/questions/44290094/bing-image-search-api-v5-filter-by-image-size-using-ruby", "title": "Bing Image Search API - V5 filter by image size (using Ruby)", "body": "<p>I would like to limit searching images using \n \"filter query parameters ( <a href=\"https://msdn.microsoft.com/en-us/library/dn760791.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/dn760791.aspx</a> )\". But I always get photos whose size is around 250 - 300 pixel( both of width and height), although I want them, which is bigger than 500 x 500 pixel.\nI know there is already similar question(<a href=\"https://stackoverflow.com/questions/4860173/bing-image-search-api-filter-by-image-size\">Bing Image Search API filter by image size</a>), but I couldn't solve the problem.</p>\n\n<p>I'm using Ruby and the code is following.\nWhat is the problem?</p>\n\n<pre><code>require \"open-uri\"\nrequire \"FileUtils\"\nrequire 'net/http'\nrequire 'json'\n\n\n@dirName = \"/Users/hoge/img\"\nFileUtils.mkdir_p(@dirName) unless FileTest.exist?(@dirName)\n\ndef save_image(url, num)\n  filePath = \"#{@dirName}/christ#{num.to_s}.jpg\"\n  open(filePath, 'wb') do |output|\n    open(url) do |data|\n      output.write(data.read)\n    end\n  end\nend\n\nsearch_word = 'christ painting'\ncount = 5\nsize = 'Large'\n\n\nuri = URI('https://api.cognitive.microsoft.com/bing/v5.0/images/search')\nuri.query = URI.encode_www_form({\n    'q' =&gt; search_word,\n    'count' =&gt; count,\n\n    'size' =&gt; size\n})\nrequest = Net::HTTP::Post.new(uri.request_uri)\nrequest['Content-Type'] = 'multipart/form-data'\nrequest['Ocp-Apim-Subscription-Key'] = 'mykey' # Fix Me\nrequest.body = \"{body}\"\nresponse = Net::HTTP.start(uri.host, uri.port, :use_ssl =&gt; uri.scheme == 'https') do |http|\n  http.request(request)\nend\n\ncount.times do |i|\n  begin\n    image_url = JSON.parse(response.body)[\"value\"][i][\"thumbnailUrl\"]\n    save_image(image_url, i)\n  rescue =&gt; e\n    puts \"image#{i} is error!\"\n    puts e\n  end\nend\n</code></pre>\n"}, {"tags": ["php", "html", "ruby", "forms"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496245390, "post_id": 44288817, "comment_id": 75585013, "body": "Don&#39;t mix languages like this if you can avoid it.... Does that script really need to be in ruby (how hard would it be to rewrite in PHP)? Does your web page really need to be in PHP (how hard would it be to knock something up in ruby)?"}, {"owner": {"reputation": 37458, "user_id": 2734189, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bdd4c02158892b034c80f00eff30e6d5?s=128&d=identicon&r=PG&f=1", "display_name": "Don&#39;t Panic", "link": "https://stackoverflow.com/users/2734189/dont-panic"}, "edited": false, "score": 0, "creation_date": 1496245439, "post_id": 44288817, "comment_id": 75585050, "body": "Can you be more specific about which part you&#39;re uncertain about? Do you know how to get input from a form with PHP?"}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1496256258, "post_id": 44288817, "comment_id": 75591325, "body": "What server are you using?  See here: <a href=\"https://github.com/7stud/ruby_cgi/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/7stud/ruby_cgi/blob/master/README.md</a>"}, {"owner": {"reputation": 3852, "user_id": 1802527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THq66.png?s=128&g=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/1802527/alexis"}, "edited": false, "score": 0, "creation_date": 1496263324, "post_id": 44288817, "comment_id": 75595030, "body": "id you are using rails and dont want to have model you can have a custom class that defines the object to handle the data from the form, check the railscast on contact forms, you can apply the same concept and use your script there. Now if you want to do this with pure ruby, you should pick all the gem necessary to get a server up and running and handle the http requests, but that would be a lot more complicated"}], "owner": {"reputation": 1, "user_id": 6182468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d9856b817ca290d50cd5a550e306d6?s=128&d=identicon&r=PG&f=1", "display_name": "Kendra", "link": "https://stackoverflow.com/users/6182468/kendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "closed_date": 1496245403, "answer_count": 0, "score": 0, "last_activity_date": 1496245465, "creation_date": 1496244373, "last_edit_date": 1496245362, "question_id": 44288817, "link": "https://stackoverflow.com/questions/44288817/input-from-an-html-form-and-pass-it-to-a-ruby-script", "closed_reason": "Duplicate", "title": "Input from an HTML form and pass it to a ruby script", "body": "<p>I need to take the user input from an HTML form and send that data to a Ruby script (not rails). Is there any way to do this? I've read some documentation on potentially doing so with PHP but I'm still unfamiliar on how I'd pass the inputs from PHP to the Ruby script. I know how to call the script from PHP, but am still uncertain on passing the input information. Any adivce?</p>\n"}, {"tags": ["arrays", "ruby", "hash", "null", "key"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496264749, "post_id": 44288599, "comment_id": 75595664, "body": "How would you be getting nil keys? This sounds like an &quot;<a href=\"https://meta.stackexchange.com/q/66377/153968\">XY Problem</a>&quot; where you should ask about the generation of the hash, not how to clean it up."}], "answers": [{"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": true, "score": 2, "last_activity_date": 1496244397, "creation_date": 1496244397, "answer_id": 44288825, "question_id": 44288599, "link": "https://stackoverflow.com/questions/44288599/how-do-i-remove-a-nil-key-from-my-hash/44288825#44288825", "title": "How do I remove a nil key from my hash?", "body": "<p>Use <a href=\"http://ruby-doc.org/core-2.4.1/Array.html#method-i-compact\" rel=\"nofollow noreferrer\"><code>Array#compact</code></a> which removes all <code>nil</code> values before the count.</p>\n\n<pre><code>my_hash = int_data_col.compact.each_with_object(Hash.new(0)) { |i, h| h[i]+=1 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1496246199, "post_id": 44289106, "comment_id": 75585575, "body": "This doesn&#39;t add anything to @sagarpandya82&#39;s answer. Why do you think Natalia would like to remove the <code>nil</code>&#39;s from the array?"}], "tags": [], "owner": {"reputation": 157, "user_id": 2320991, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/49d522e24e66aafeb2a4547c6c5e260d?s=128&d=identicon&r=PG", "display_name": "donvnielsen", "link": "https://stackoverflow.com/users/2320991/donvnielsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1496245185, "creation_date": 1496245185, "answer_id": 44289106, "question_id": 44288599, "link": "https://stackoverflow.com/questions/44288599/how-do-i-remove-a-nil-key-from-my-hash/44289106#44289106", "title": "How do I remove a nil key from my hash?", "body": "<p>If you want to clean up the array prior to hashing it, then </p>\n\n<pre><code>int_data_col.compact! \nint_data_col.each_with_object(Hash.new(0)) {|i, h| h[i]+=1 }\n</code></pre>\n\n<p>If you want to simply create the hash, ignoring nil, without disturbing the original array, then the following as suggested by @sagarpandya82</p>\n\n<pre><code>int_data_col.compact.each_with_object(Hash.new(0)) { |i, h| h[i]+=1 }\n</code></pre>\n\n<p>When you had specified <code>.delete(nil)</code>, I think you were expecting it to return the hash with the nil key removed. But what it did was remove the nil key and returned the count value of the nil key (1). From the Hash Class doc, \"Deletes the key-value pair and returns the value from hash whose key is equal to key.\"</p>\n"}, {"tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1496257707, "creation_date": 1496257707, "answer_id": 44292901, "question_id": 44288599, "link": "https://stackoverflow.com/questions/44288599/how-do-i-remove-a-nil-key-from-my-hash/44292901#44292901", "title": "How do I remove a nil key from my hash?", "body": "<p>In Ruby 2.4, there's a way to do it which is very readable:</p>\n\n<pre><code>arr.compact.group_by(&amp;:itself).transform_values(&amp;:size)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 44288825, "answer_count": 3, "score": 3, "last_activity_date": 1496257707, "creation_date": 1496243788, "question_id": 44288599, "link": "https://stackoverflow.com/questions/44288599/how-do-i-remove-a-nil-key-from-my-hash", "title": "How do I remove a nil key from my hash?", "body": "<p>With Ruby 2.4, I want to count the number of occurrences of an element and store them in a hash.  However, I don't want to include any nil keys in my hash.  So I tried</p>\n\n<pre><code>my_hash = int_data_col.each_with_object(Hash.new(0)) { |i, h| h[i]+=1 }.delete(nil)\n</code></pre>\n\n<p>but this returns \"1\".  If I leave off the \"delete(nil)\", it returns a hash, but then a nil key is included in the hash (assuming a nil was present in the \"int_data_col\" array).  How do I remove the nil key from my hash and still get the correct results?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "scheduled-tasks", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5917002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af995eaac82de2feb2b901e1ffc83516?s=128&d=identicon&r=PG&f=1", "display_name": "raghav_vc", "link": "https://stackoverflow.com/users/5917002/raghav-vc"}, "edited": false, "score": 0, "creation_date": 1496256283, "post_id": 44290165, "comment_id": 75591341, "body": "After debugging a bunch of errors after executing the statement, I have one last error saying  undefined method `relative_url_root=&#39; for ActionDispatch::Routing::RouteSet:Class"}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "reply_to_user": {"reputation": 65, "user_id": 5917002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af995eaac82de2feb2b901e1ffc83516?s=128&d=identicon&r=PG&f=1", "display_name": "raghav_vc", "link": "https://stackoverflow.com/users/5917002/raghav-vc"}, "edited": false, "score": 0, "creation_date": 1496256373, "post_id": 44290165, "comment_id": 75591399, "body": "@raghav_vc It would be more helpful to start a new question with that error and code examples and to mark this question as closed or resolved."}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 0, "last_activity_date": 1496248261, "creation_date": 1496248261, "answer_id": 44290165, "question_id": 44288585, "link": "https://stackoverflow.com/questions/44288585/rails-5-unable-to-access-my-database-while-using-sidekiq-scheduler-with-redis/44290165#44290165", "title": "Rails 5: Unable to access my database while using Sidekiq scheduler with Redis", "body": "<p>The problem is in your sidekiq command:</p>\n\n<pre><code>sidekiq -r ./app/controllers/products_controller.rb\n</code></pre>\n\n<p>You can't directly require a specific controller like that since it doesn't know where the superclass is i.e. your controller doesn't explicitly require the <code>application_controller.rb</code> file, hence that error. </p>\n\n<p>Sidekiq's usage states:</p>\n\n<pre><code>-r, --require [PATH|DIR] Location of Rails application with workers or file to require\n</code></pre>\n\n<p>This is suggesting you give it the directory where your Rails application is, not an individual controller. But, if you run the <code>sidekiq</code> command from the directory of your Rails app then:</p>\n\n<p><strong>you do not need the -r option</strong></p>\n\n<p>Simply run <code>sidekiq</code></p>\n"}], "owner": {"reputation": 65, "user_id": 5917002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af995eaac82de2feb2b901e1ffc83516?s=128&d=identicon&r=PG&f=1", "display_name": "raghav_vc", "link": "https://stackoverflow.com/users/5917002/raghav-vc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 44290165, "answer_count": 1, "score": 0, "last_activity_date": 1496248261, "creation_date": 1496243758, "question_id": 44288585, "link": "https://stackoverflow.com/questions/44288585/rails-5-unable-to-access-my-database-while-using-sidekiq-scheduler-with-redis", "title": "Rails 5: Unable to access my database while using Sidekiq scheduler with Redis", "body": "<p>I am trying to make a method run every minute using the sidekiq scheduler. But when I try to execute the cron job, my database is not accessible. </p>\n\n<p>This is my controller code</p>\n\n<pre><code>#product_controller.rb\n\nrequire 'sidekiq-scheduler'\n\nclass ProductsController &lt; ApplicationController\n  include ApplicationHelper\n  include Sidekiq::Worker\n\n  def task\n    Product.each do |product|\n      product.price.push(get_price_from_link(product.flipkart_link))\n      product.time.push(Time.now)\n      product.save!\n    end\n  end\n\n private\n\n  def product_params\n    params.require(:product).permit(:flipkart_link, :flipkart_id, :name, :category, :image_url, :max_price, :price, :available, :target_price, :user_id)\n  end\nend\n\n\n#sidekiq.yml\n\n:schedule:\n  cron_task:\n    cron: '0 * * * * *'   # Runs once per minute\n  class: ProductsController\n</code></pre>\n\n<p>When I try to execute the cron job like this,</p>\n\n<pre><code>sidekiq -r ./app/controllers/products_controller.rb\n</code></pre>\n\n<p>I get an error saying</p>\n\n<pre><code>uninitialized constant ApplicationController\n/home/raghav/workspace/apps/Shotgun/app/controllers/products_controller.rb:3:in `&lt;top (required)&gt;'\n/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:120:in `require'\n/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:120:in `require'\n/var/lib/gems/2.3.0/gems/sidekiq-5.0.0/lib/sidekiq/cli.rb:262:in `boot_system'\n/var/lib/gems/2.3.0/gems/sidekiq-5.0.0/lib/sidekiq/cli.rb:54:in `run'\n/var/lib/gems/2.3.0/gems/sidekiq-5.0.0/bin/sidekiq:12:in `&lt;top (required)&gt;'\n/usr/local/bin/sidekiq:23:in `load'\n/usr/local/bin/sidekiq:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>Is this error because of the Redis server? If so, how can I access my existing models and database?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1496245581, "creation_date": 1496245581, "answer_id": 44289261, "question_id": 44287978, "link": "https://stackoverflow.com/questions/44287978/spec-style-syntax-with-minitest-in-rails/44289261#44289261", "title": "Spec style syntax with minitest in rails", "body": "<p>I got the spec-style <em>functioning</em>, though the original question as to: \"Why spec style syntax tests don't work out of the box with minitest in rails\" is still unanswered.  Hopefully someone might know and provide an answer.</p>\n\n<p>What I had to do was load in the <a href=\"https://rubygems.org/gems/minitest-spec-rails\" rel=\"nofollow noreferrer\">minitest-spec-rails</a> gem:</p>\n\n<pre><code>#Gemfile\n\ngroup :development, :test do\n  gem 'minitest-spec-rails', '~&gt; 5.4'\nend\n</code></pre>\n\n<p>Then I just had to convert to the MiniTest::Spec assertion syntax.  It appears that the rspec matchers syntax will not work:</p>\n\n<pre><code>#test/models/city_test.rb\ndescribe City do\n  describe \".with_active_schools\" do\n    it \"has no cities have active schools\" do\n      city1 = create(:sequenced_city)\n      city2 = create(:sequenced_city)\n      create(:sequenced_inactive_school, city: city1)\n      create(:sequenced_inactive_school, city: city1)\n      create(:sequenced_inactive_school, city: city2)\n      create(:sequenced_inactive_school, city: city2)\n      City.with_active_schools.size.must_equal(0)\n    end\n    it \"has all cities have active schools\" do\n      city1 = create(:sequenced_city)\n      city2 = create(:sequenced_city)\n      create(:sequenced_active_school, city: city1)\n      create(:sequenced_active_school, city: city1)\n      create(:sequenced_active_school, city: city2)\n      create(:sequenced_active_school, city: city2)\n      City.with_active_schools.size.must_equal(2)\n    end\n  end\nend\n</code></pre>\n\n<p>And now it works when I run <code>rails test test/models/city_test.rb</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6413, "user_id": 129622, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3ad9727f4d85caf19d8d333db9fa6a58?s=128&d=identicon&r=PG", "display_name": "ybakos", "link": "https://stackoverflow.com/users/129622/ybakos"}, "is_accepted": false, "score": 0, "last_activity_date": 1596642721, "creation_date": 1596642721, "answer_id": 63268922, "question_id": 44287978, "link": "https://stackoverflow.com/questions/44287978/spec-style-syntax-with-minitest-in-rails/63268922#63268922", "title": "Spec style syntax with minitest in rails", "body": "<p>You have to <code>require 'minitest/spec'</code> to make the <code>describe</code> function available.</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1038, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1596642721, "creation_date": 1496242255, "question_id": 44287978, "link": "https://stackoverflow.com/questions/44287978/spec-style-syntax-with-minitest-in-rails", "title": "Spec style syntax with minitest in rails", "body": "<p>According to the <a href=\"https://github.com/seattlerb/minitest#specs\" rel=\"nofollow noreferrer\">spec section within the minitest docs</a>: the gem allows you to either use the \"unit_test\" syntax of testing or the \"spec style\" syntax of testing.  </p>\n\n<p>In my rails app: I have two tests on a scope within my model (note: I am using <a href=\"https://rubygems.org/gems/factory_girl\" rel=\"nofollow noreferrer\">factory_girl</a> to build objects within my tests).  The following is, as I understand it, the typical way of writing tests with minitest within the context of rails:</p>\n\n<pre><code># test/models/city_test.rb\nrequire 'test_helper'\n\nclass CityTest &lt; ActiveSupport::TestCase\n  test \".with_active_schools should return none\" do\n    city1 = create(:sequenced_city)\n    city2 = create(:sequenced_city)\n    create(:sequenced_inactive_school, city: city1)\n    create(:sequenced_inactive_school, city: city1)\n    create(:sequenced_inactive_school, city: city2)\n    create(:sequenced_inactive_school, city: city2)\n    assert_equal(0, City.with_active_schools.size)\n  end\n\n\n  test \".with_active_schools should return all\" do\n    city1 = create(:sequenced_city)\n    city2 = create(:sequenced_city)\n    create(:sequenced_active_school, city: city1)\n    create(:sequenced_active_school, city: city1)\n    create(:sequenced_active_school, city: city2)\n    create(:sequenced_active_school, city: city2)\n    assert_equal(2, City.with_active_schools.size)\n  end\nend\n</code></pre>\n\n<p>I then run <code>rails test test/models/city_test.rb</code> and all tests pass.</p>\n\n<p>Now I want to see if it is possible to convert the above tests to the spec-style syntax.  I comment out everything above in the same file.  I then replace it with this code:</p>\n\n<pre><code># test/models/city_test.rb\nrequire 'test_helper'\n\ndescribe City do\n  describe \".with_active_schools\" do\n    it \"returns no cities with active schools\" do\n      city1 = create(:sequenced_city)\n      city2 = create(:sequenced_city)\n      create(:sequenced_inactive_school, city: city1)\n      create(:sequenced_inactive_school, city: city1)\n      create(:sequenced_inactive_school, city: city2)\n      create(:sequenced_inactive_school, city: city2)\n      expect(City.with_active_schools.size).to eq(0)\n    end\n    it \"returns cities with active schools\" do\n      city1 = create(:sequenced_city)\n      city2 = create(:sequenced_city)\n      create(:sequenced_active_school, city: city1)\n      create(:sequenced_active_school, city: city1)\n      create(:sequenced_active_school, city: city2)\n      create(:sequenced_active_school, city: city2)\n      expect(City.with_active_schools.size).to eq(2)\n    end\n  end\nend\n</code></pre>\n\n<p>I then attempt to run the tests: <code>rails test test/models/city_test.rb</code>, however it errors out:</p>\n\n<blockquote>\n  <p>undefined method `describe' for main:Object (NoMethodError)</p>\n</blockquote>\n\n<p>I am not sure why it is throwing this error when the minitest docs says it supports this syntax.  I did look at the rails guides for testing, but there is little content within the <a href=\"http://guides.rubyonrails.org/testing.html#model-testing\" rel=\"nofollow noreferrer\">model testing section</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "axlsx"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 6366329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6e577e7348ffd7d41f05bbf8332eb306?s=128&d=identicon&r=PG&f=1", "display_name": "singard", "link": "https://stackoverflow.com/users/6366329/singard"}, "edited": false, "score": 0, "creation_date": 1496243438, "post_id": 44288005, "comment_id": 75583644, "body": "I see. But my question is if I decide to access the <code>rows</code> values from sheet_a in b, I would do something like <code>sheet_a.rows</code> right? But the value I got from <code>sheet_a.rows</code> in sheet b is different from the value I got from <code>rows</code> in sheet A? I got a huge response from <code>sheet_a.rows</code>. Any idea why?"}], "tags": [], "owner": {"reputation": 445, "user_id": 8018505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b91738cee0a49bbbf95faf11cf9bc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Coleman", "link": "https://stackoverflow.com/users/8018505/paul-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1496242334, "creation_date": 1496242334, "answer_id": 44288005, "question_id": 44287291, "link": "https://stackoverflow.com/questions/44287291/ruby-axlsx-how-to-get-values-from-another-worksheet/44288005#44288005", "title": "Ruby Axlsx: How to get values from another worksheet", "body": "<p>You can do something like:</p>\n\n<pre><code>sheet_a = wb.add_worksheet(name: \"Table A\") do |sheet|\n  sheet\nend\n\nwb.add_worksheet(name: \"Table B\") do |sheet|\n   puts sheet_a.name\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3022, "user_id": 336392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c144b7e260029f00b1efb08fb29bb023?s=128&d=identicon&r=PG", "display_name": "Thomas R. Koll", "link": "https://stackoverflow.com/users/336392/thomas-r-koll"}, "is_accepted": false, "score": 1, "last_activity_date": 1544987895, "creation_date": 1544987895, "answer_id": 53805636, "question_id": 44287291, "link": "https://stackoverflow.com/questions/44287291/ruby-axlsx-how-to-get-values-from-another-worksheet/53805636#53805636", "title": "Ruby Axlsx: How to get values from another worksheet", "body": "<p>Here you go, first keep the sheet A around, and secondly use that when you add the chart on sheet B.</p>\n\n<pre><code>sheet_a = wb.add_worksheet(name: \"Table A\".excel_worksheet) do |sheet|\n  # ...\nend\n\nwb.add_worksheet(name: \"Table B\".excel_worksheet) do |sheet|\n sheet.add_chart(Axlsx::BarChart, start_at: 'A1', end_at: 'F10', title: 'Chart from Table A', ) do |chart|\n    chart.add_series data: sheet_a[\"$'Table A'.$B$2:$F$20\"]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 6366329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6e577e7348ffd7d41f05bbf8332eb306?s=128&d=identicon&r=PG&f=1", "display_name": "singard", "link": "https://stackoverflow.com/users/6366329/singard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1544987895, "creation_date": 1496240380, "question_id": 44287291, "link": "https://stackoverflow.com/questions/44287291/ruby-axlsx-how-to-get-values-from-another-worksheet", "title": "Ruby Axlsx: How to get values from another worksheet", "body": "<p>If I have two worksheets and I am trying to access values from another worksheet. Is there a way from axlsx gem that can do that?</p>\n\n<pre><code>wb.add_worksheet(name: \"Table A\".excel_worksheet) do |sheet|\n\nend\n\nwb.add_worksheet(name: \"Table B\".excel_worksheet) do |sheet|\n\nend\n</code></pre>\n\n<p>If I am inside worksheet B right now, and want to perform some calculations using the values from table A (for example rows in A). Is there a way to do that?</p>\n"}, {"tags": ["ruby", "git", "redmine"], "comments": [{"owner": {"reputation": 1593, "user_id": 7709086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28b5d7ab736b095bbfef50c41148386a?s=128&d=identicon&r=PG", "display_name": "kagmole", "link": "https://stackoverflow.com/users/7709086/kagmole"}, "edited": false, "score": 0, "creation_date": 1496236573, "post_id": 44285803, "comment_id": 75578408, "body": "Downvoters, please explain. I accept the fact that my question may be stupid but just <code>-1</code> will not help."}, {"owner": {"reputation": 2453, "user_id": 800965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fMjbN.jpg?s=128&g=1", "display_name": "Aleksandar Pavi\u0107", "link": "https://stackoverflow.com/users/800965/aleksandar-pavi%c4%87"}, "edited": false, "score": 0, "creation_date": 1496297616, "post_id": 44285803, "comment_id": 75604807, "body": "I&#39;ve up-voted you to correct your downvoter problem :D, please explain more, which OS, Which GIt/redmine version, how is it deployed, is it redminegit hosting plugin or what?"}, {"owner": {"reputation": 1593, "user_id": 7709086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28b5d7ab736b095bbfef50c41148386a?s=128&d=identicon&r=PG", "display_name": "kagmole", "link": "https://stackoverflow.com/users/7709086/kagmole"}, "reply_to_user": {"reputation": 2453, "user_id": 800965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fMjbN.jpg?s=128&g=1", "display_name": "Aleksandar Pavi\u0107", "link": "https://stackoverflow.com/users/800965/aleksandar-pavi%c4%87"}, "edited": false, "score": 0, "creation_date": 1496299027, "post_id": 44285803, "comment_id": 75605530, "body": "Thank you for your concern. I updated my question. I will look for a potential problem with Grack now."}, {"owner": {"reputation": 2453, "user_id": 800965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fMjbN.jpg?s=128&g=1", "display_name": "Aleksandar Pavi\u0107", "link": "https://stackoverflow.com/users/800965/aleksandar-pavi%c4%87"}, "edited": false, "score": 0, "creation_date": 1496314331, "post_id": 44285803, "comment_id": 75616194, "body": "Well I recommend you migrate to newer Redmine and use redminegithosting from jboxweb plugin..."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1496413211, "post_id": 44285803, "comment_id": 75666236, "body": "This has nothing to do with Redmine (which you use as an authenticator only) but only with how git handles and stores objects. In general, you should not store that large files in Git since it results in exactly these issues. Instead, you should store the large files outside of git or use something like <a href=\"https://git-lfs.github.com/\" rel=\"nofollow noreferrer\">Git LFS</a>. For the latter though, there is no support I know of in Redmine or one of the common plugins right now."}, {"owner": {"reputation": 1593, "user_id": 7709086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28b5d7ab736b095bbfef50c41148386a?s=128&d=identicon&r=PG", "display_name": "kagmole", "link": "https://stackoverflow.com/users/7709086/kagmole"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1496413640, "post_id": 44285803, "comment_id": 75666540, "body": "@HolgerJust Yes Git LFS would be great sadly the repository was not created on our server first, we are a new remote, and the developers did not use Git LFS. The <code>git receive-pack</code> is the command taking all RAM and it looks like there is no way to tell it to not eat all the RAM."}], "answers": [{"tags": [], "owner": {"reputation": 1593, "user_id": 7709086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28b5d7ab736b095bbfef50c41148386a?s=128&d=identicon&r=PG", "display_name": "kagmole", "link": "https://stackoverflow.com/users/7709086/kagmole"}, "is_accepted": true, "score": 0, "last_activity_date": 1498045945, "creation_date": 1498045945, "answer_id": 44675324, "question_id": 44285803, "link": "https://stackoverflow.com/questions/44285803/git-receive-upload-pack-takes-all-ram-on-push/44675324#44675324", "title": "Git receive/upload-pack takes all RAM on push", "body": "<p>Since this question is descending into the depths, here is the workaround I used as an answer.</p>\n\n<p>It looks like receive/upload-pack needs to load everything on the RAM. Maybe I am wrong, but I found nothing to reduce the RAM usage into small packets. So what I did is creating a transient swap file.</p>\n\n<pre><code># create a file of 4GB\nsudo dd if=/dev/zero of=/swap bs=1024 count=4194303\n\n# make it a swap file\nsudo mkswap /swap\n\n# enable the swap on this swap file\nsudo swapon /swap\n</code></pre>\n\n<p>2GB was not enough: the push took like ~3.5GB, thus the 4GB swap file.</p>\n\n<p>The push took a long time (no sh*t Sherlock) but at least it succeeded.</p>\n\n<p>I left the new swap file for future similar problems, but if you want to delete it after the push you can do the following:</p>\n\n<pre><code># disable the swap (will automatically move used memory into RAM or another swap)\nsudo swapoff /swap\n\n# delete the file\nsudo rm /swap\n</code></pre>\n\n<p><a href=\"http://www.unixguide.net/linux/faq/04.11.shtml\" rel=\"nofollow noreferrer\">Reference on UNIX guide</a></p>\n"}], "owner": {"reputation": 1593, "user_id": 7709086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28b5d7ab736b095bbfef50c41148386a?s=128&d=identicon&r=PG", "display_name": "kagmole", "link": "https://stackoverflow.com/users/7709086/kagmole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 44675324, "answer_count": 1, "score": 3, "last_activity_date": 1498045945, "creation_date": 1496236331, "last_edit_date": 1496307672, "question_id": 44285803, "link": "https://stackoverflow.com/questions/44285803/git-receive-upload-pack-takes-all-ram-on-push", "title": "Git receive/upload-pack takes all RAM on push", "body": "<p>I have a Redmine server with Git on it. It has 2GB of RAM.</p>\n\n<p>When someone tries to push a repository with data bigger than 2GB, I get the following error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Counting objects: 957, done.\nDelta compression using up to 12 threads.\nCompressing objects: 100% (577/577), done.\nWriting objects: 100% (957/957), 2.18 GiB | 29.66 MiB/s, done.\nTotal 957 (delta 255), reused 862 (delta 229)\nfatal: The remote end hung up unexpectedly\nfatal: The remote end hung up unexpectedly\nEverything up-to-date\n</code></pre>\n\n<p>Before the first <code>fatal: ...</code>, ruby starts to take all the RAM on the server.</p>\n\n<p>When reaching ~2GB of RAM usage, the <code>fatal: ...</code> errors occur. Error on the server:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>App 9339 stderr: Errno::ENOMEM: Cannot allocate memory - git\n</code></pre>\n\n<p>So my guess is that Git or Redmine tries to put those 2.18 GB into RAM, which would obviously not work.</p>\n\n<p>After the error:</p>\n\n<ul>\n<li>the repository on the server is still empty;</li>\n<li>the RAM usage is still at 95+% until I restart Redmine.</li>\n</ul>\n\n<p>How can I make it work? Is it Redmine or Git that eats all the RAM?</p>\n\n<p>Could pushing the data \"part by part\" (<a href=\"https://stackoverflow.com/questions/3230074/how-can-i-pushing-specific-commit-to-a-remote-and-not-the-previous-commits\">like here</a>) be a solution?</p>\n\n<p>I already tried to <a href=\"https://stackoverflow.com/questions/15240815/git-fatal-the-remote-end-hung-up-unexpectedly\">increase the HTTP post buffer size</a> (<code>git config http.postBuffer 524288000</code>) without success.</p>\n\n<hr>\n\n<p><strong>EDIT (2017-06-01):</strong></p>\n\n<p>Some specs:</p>\n\n<ul>\n<li>Ubuntu LTS 12.04.05</li>\n<li>Redmine v2.6.9</li>\n<li>Git v1.7.9.5</li>\n</ul>\n\n<p>Redmine is deployed behind an Apache server (v2.2.22) with the passenger module. It uses <a href=\"https://github.com/schacon/grack\" rel=\"nofollow noreferrer\">Grack</a> (last revision) for its Git integration with the <a href=\"http://www.redmine.org/plugins/redmine_scm\" rel=\"nofollow noreferrer\">Redmine SCM</a> plugin to create repositories.</p>\n\n<p>After re-looking at the logs, it looks like the culprit is Grack.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>App 9339 stderr: Errno::ENOMEM: Cannot allocate memory - git\nApp 29461 stderr:       /opt/grack/lib/git_adapter.rb:24:in ``'\nApp 29461 stderr:       /opt/grack/lib/git_adapter.rb:24:in `command'\nApp 29461 stderr:       /opt/grack/lib/git_adapter.rb:34:in `upload_pack'\nApp 29461 stderr:       /opt/grack/lib/grack.rb:84:in `get_info_refs'\nApp 29461 stderr:       /opt/grack/lib/grack.rb:55:in `call'\nApp 29461 stderr:       /opt/grack/lib/grack.rb:55:in `call'\n</code></pre>\n\n<p>In other words, the error occurs when Grack launch a <code>git upload-pack</code> command.</p>\n\n<hr>\n\n<p><strong>EDIT (2017-06-01) (2):</strong></p>\n\n<p>The local repository had indeed a pack of 2+GB. I repacked it with the following:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>git repack -a -d --window-memory=512m --max-pack-size=512m\n</code></pre>\n\n<p>To reduce that big pack into multiple, smaller packs. I also configured the following client and server side:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>git config pack.windowMemory 512m\ngit config pack.packSizeLimit 512m\n</code></pre>\n\n<p>But the problem still occurs.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>App 30005 stderr: [ 2017-06-01 09:15:04.4393 30122/0x000000019264a8(Worker 1) utils.rb:72 ]: *** Exception Errno::ENOMEM in Rack body object #each method (Cannot allocate memory - git) (process 30122, thread 0x000000019264a8(Worker 1)):\nApp 30005 stderr:       from /opt/grack/lib/git_adapter.rb:19:in `popen'\nApp 30005 stderr:       from /opt/grack/lib/git_adapter.rb:19:in `command'\nApp 30005 stderr:       from /opt/grack/lib/git_adapter.rb:43:in `receive_pack'\nApp 30005 stderr:       from /opt/grack/lib/grack.rb:70:in `block in service_rpc'\n</code></pre>\n\n<p><strong>EDIT (2017-06-01) (3):</strong></p>\n\n<p>Added some logging on Grack to see what it exactly launches:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>git receive-pack --advertise-refs --stateless-rpc /var/git/mygit.git\n</code></pre>\n\n<p>Since it does not launch the command from the Git repository directory, I tried the following:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>git config --global pack.windowMemory 512m\ngit config --global pack.packSizeLimit 512m\n</code></pre>\n\n<p>Sadly still not working.</p>\n\n<p><strong>EDIT (2017-06-01) (4):</strong></p>\n\n<p>Tried again but with <code>64m</code> instead of <code>512m</code>, still no effects.</p>\n\n<p>It looks like Git still needs to take all objects on RAM to start the packaging. Client side, the <code>git repack</code> command does indeed takes 2+GB to execute, even if the resulting output are multiple 512-MB files.</p>\n"}, {"tags": ["ruby", "imap", "read-unread"], "answers": [{"tags": [], "owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1574279224, "last_edit_date": 1574279224, "creation_date": 1496412037, "answer_id": 44330792, "question_id": 44285674, "link": "https://stackoverflow.com/questions/44285674/mark-as-unread-flag-is-not-working-in-imap-ruby/44330792#44330792", "title": "Mark as unread flag is not working in IMAP + ruby", "body": "<p>Unseen is not a flag (it is a search criteria though).  You take away the <code>\\Seen</code> flag with -FLAGS instead.</p>\n"}], "owner": {"reputation": 35, "user_id": 3261842, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001154956/picture?type=large", "display_name": "austinrocks1995", "link": "https://stackoverflow.com/users/3261842/austinrocks1995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574279224, "creation_date": 1496235988, "last_edit_date": 1496248889, "question_id": 44285674, "link": "https://stackoverflow.com/questions/44285674/mark-as-unread-flag-is-not-working-in-imap-ruby", "title": "Mark as unread flag is not working in IMAP + ruby", "body": "<p>Unread to Read</p>\n\n<p>it's working</p>\n\n<pre><code>imap = Net::IMAP.new(account.imap_url, 993, usessl = true, certs = nil, verify = false)\nimap.login(account.client_email, account.client_secret)\nimap.select(\"Inbox\")\nimap.search(['All'])\nimap.store(7665, \"+FLAGS\", [:Seen])\n</code></pre>\n\n<p>Read to Un-read</p>\n\n<p>it's not working</p>\n\n<pre><code>imap = Net::IMAP.new(account.imap_url, 993, usessl = true, certs = nil, verify = false)\nimap.login(account.client_email, account.client_secret)\nimap.select(\"Inbox\")\nimap.search(['All'])\nimap.store(7665, \"+FLAGS\", [:Unseen])\n</code></pre>\n\n<p>I tried with Unseen, Unread, Not seen and I have set a flag as 1, 0 for seen then also I didn't any solution for it.\n<a href=\"https://i.stack.imgur.com/axX8D.png\" rel=\"nofollow noreferrer\">Bad Response Error</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rails-engines"], "answers": [{"comments": [{"owner": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "edited": false, "score": 0, "creation_date": 1496253171, "post_id": 44290332, "comment_id": 75589686, "body": "Yeh, that&#39;s what I ended up going for. My solution looks for a specific partial in each engine (namespaced with the name of the engine)."}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 0, "last_activity_date": 1496248784, "creation_date": 1496248784, "answer_id": 44290332, "question_id": 44285307, "link": "https://stackoverflow.com/questions/44285307/rails-engine-extending-views-not-overriding/44290332#44290332", "title": "Rails engine extending views, not overriding", "body": "<p>There is no way to extend views that way in Rails. You can however, accomplish this by using partials. In your engine, write a partial view file <code>users/_show.html.erb</code> and then render it in your app's view:</p>\n\n<pre><code># app/views/users/show\n\n# will look for a partial called \"_show.html.erb\" in the engine's and app's view paths.\nrender partial: 'show'\n</code></pre>\n\n<p>It's just as easy as your suggestion. </p>\n\n<p>This gem tries to implement partial extension of views, but it works similarly to what I just described: <a href=\"https://github.com/amatsuda/motorhead#partially-extending-views-in-the-main-app\" rel=\"nofollow noreferrer\">https://github.com/amatsuda/motorhead#partially-extending-views-in-the-main-app</a></p>\n"}], "owner": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 44290332, "answer_count": 1, "score": 2, "last_activity_date": 1496248784, "creation_date": 1496234989, "question_id": 44285307, "link": "https://stackoverflow.com/questions/44285307/rails-engine-extending-views-not-overriding", "title": "Rails engine extending views, not overriding", "body": "<p>I am aware that I can override an applications view from within an engine by simply creating the same file within the engine and removing it from the application (eg: 'users/show.html.erb'). </p>\n\n<p>However, what I want is to be able to extend the applications view, not override. </p>\n\n<p>Lets say I have a <code>yield</code> inside 'users/show.html.erb' of the main application:</p>\n\n<p><code>yield :foo</code></p>\n\n<p>What I want is for the engine to specify the same file 'users/show.html.erb' and to have a <code>content_for</code> block</p>\n\n<p><code>content_for :foo {}</code></p>\n\n<p>Thereby, injecting some template data from the engines view, into the applications view.</p>\n\n<p>Obviously, the above won't work as once it has found the template file in the application, it won't look for one in the engine.</p>\n\n<p>Is there a way to make this work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "minitest"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5292389"}, "edited": false, "score": 2, "creation_date": 1496238210, "post_id": 44285356, "comment_id": 75579668, "body": "this is not working. it results in NoMethodError: undefined method `session&#39; for nil:NilClass"}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1496235109, "creation_date": 1496235109, "answer_id": 44285356, "question_id": 44285172, "link": "https://stackoverflow.com/questions/44285172/minitest-integrationtest-argumenterror-unknown-keyword-session/44285356#44285356", "title": "Minitest IntegrationTest ArgumentError: unknown keyword: session", "body": "<p>This should work:</p>\n\n<pre><code>test \"should get index\" do\n  session[:user_id] = @admin_user.id\n  get admin_product_url, params: {}\n  assert_response :success\nend\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5292389"}, "edited": false, "score": 0, "creation_date": 1496238168, "post_id": 44285392, "comment_id": 75579640, "body": "so there is no way to set session variables anymore?"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1496239332, "post_id": 44285392, "comment_id": 75580502, "body": "@StefanSchauer I don&#39;t know any."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 2, "last_activity_date": 1496235207, "creation_date": 1496235207, "answer_id": 44285392, "question_id": 44285172, "link": "https://stackoverflow.com/questions/44285172/minitest-integrationtest-argumenterror-unknown-keyword-session/44285392#44285392", "title": "Minitest IntegrationTest ArgumentError: unknown keyword: session", "body": "<p>In Rails 5 is no longer possible to access session in controller tests. <a href=\"https://github.com/rails/rails/issues/25394#issuecomment-225707180\" rel=\"nofollow noreferrer\">Integration tests doesn't allow you to set session.</a></p>\n\n<p><sub><a href=\"http://blog.bigbinary.com/2016/04/19/changes-to-test-controllers-in-rails-5.html\" rel=\"nofollow noreferrer\"><code>Ref</code></a></sub></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5292389"}, "edited": false, "score": 0, "creation_date": 1496313718, "post_id": 44302829, "comment_id": 75615739, "body": "this solution does not work for me. I don&#39;t get the &quot;NoMethodError: undefined method `session&#39; for nil:NilClass&quot; errror but the session information is ignored"}, {"owner": {"reputation": 1029, "user_id": 655028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca98e75ecd686304f9a4aae2b25ac09?s=128&d=identicon&r=PG", "display_name": "Chris Kottom", "link": "https://stackoverflow.com/users/655028/chris-kottom"}, "edited": false, "score": 0, "creation_date": 1496328800, "post_id": 44302829, "comment_id": 75627167, "body": "Yes, seems like @\u0417\u0435\u043b\u0451\u043d\u044b\u0439 has the right of it. The session Hash exposed to integration tests looks to be immutable. If you want to set up session state, you&#39;ll need to code the necessary preliminary requests into your test."}], "tags": [], "owner": {"reputation": 1029, "user_id": 655028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca98e75ecd686304f9a4aae2b25ac09?s=128&d=identicon&r=PG", "display_name": "Chris Kottom", "link": "https://stackoverflow.com/users/655028/chris-kottom"}, "is_accepted": false, "score": 2, "last_activity_date": 1496307220, "creation_date": 1496307220, "answer_id": 44302829, "question_id": 44285172, "link": "https://stackoverflow.com/questions/44285172/minitest-integrationtest-argumenterror-unknown-keyword-session/44302829#44302829", "title": "Minitest IntegrationTest ArgumentError: unknown keyword: session", "body": "<p>Integration tests approximate a browsing session, so the requests you make can only use pass parameters, headers, etc.  From that perspective, it makes sense that the <code>session</code> accessor only becomes available once you've made an initial request and that you can't pass a Hash of session variables like this. Ideally, you should be testing more complex interactions, not just single requests, and you should be making assertions about the session values that your controller logic is setting. But you could structure the test above like this:</p>\n\n<pre><code>test \"should get index\" do\n  get admin_product_url                  # first request initializes session\n  session[:user_id] = @admin_user.id     # can now update session state\n  get admin_product_url                  # subsequent request\n  assert_response :success               # assertions follow\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5292389"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1496307220, "creation_date": 1496234615, "last_edit_date": 1496239224, "question_id": 44285172, "link": "https://stackoverflow.com/questions/44285172/minitest-integrationtest-argumenterror-unknown-keyword-session", "title": "Minitest IntegrationTest ArgumentError: unknown keyword: session", "body": "<p>I implement an integration test using minitest like that</p>\n\n<pre><code>test \"should get index\" do\n  get admin_product_url, params: {}, session: { user_id: @admin_user.id }\n  assert_response :success\nend\n</code></pre>\n\n<p>but I get this error message</p>\n\n<pre><code>ArgumentError: unknown keyword: session\n</code></pre>\n\n<p>how else can I set session information?</p>\n\n<p>I am using ruby 2.4 and rails 5.0.2</p>\n"}, {"tags": ["ruby", "hyperlink", "dynamically-generated", "middleman"], "answers": [{"comments": [{"owner": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 0, "creation_date": 1496234510, "post_id": 44284701, "comment_id": 75576850, "body": "Great idea! But I have problem with getting it to work with <code>[nil]</code>&#39;s. Without them it works fine, except for the first page as you write. When I use the above example I&#39;m getting: can&#39;t convert Middleman::CoreExtensions::Collections::LazyCollectorStep to Array (Middleman::CoreExtensions::Collections::LazyCollectorStep#t&zwnj;&#8203;o_ary gives Middleman::CoreExtensions::Collections::LazyCollectorStep) (TypeError)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 0, "creation_date": 1496234665, "post_id": 44284701, "comment_id": 75576962, "body": "Ah. Calling <code>to_a</code> on <code>data.generated</code> should help. Could you please check since I have no middleman here."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 0, "creation_date": 1496236141, "post_id": 44284701, "comment_id": 75578090, "body": "OK, I have suggested another hack :)"}, {"owner": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 0, "creation_date": 1496236877, "post_id": 44284701, "comment_id": 75578672, "body": "<code>next</code>is reserved word in Ruby"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 0, "creation_date": 1496237094, "post_id": 44284701, "comment_id": 75578836, "body": "Indeed! What a stupid parser/language. I have updated the answer. Does it work with <code>with_index</code> btw?"}, {"owner": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 0, "creation_date": 1496238201, "post_id": 44284701, "comment_id": 75579662, "body": "Still no luck. No errors though, now it displays loading message and sits and waits."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "edited": false, "score": 1, "creation_date": 1496241545, "post_id": 44284701, "comment_id": 75582213, "body": "I give up, sorry. <code>each_cons</code> looked very promising, but it turned out it brings more pain than profit."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1496237053, "last_edit_date": 1496237053, "creation_date": 1496233335, "answer_id": 44284701, "question_id": 44284578, "link": "https://stackoverflow.com/questions/44284578/how-to-link-dynamically-generated-pages-in-middleman/44284701#44284701", "title": "How to link dynamically generated pages in MIddleman?", "body": "<p>There is an easy way to generate all pages save for the first and last ones:</p>\n\n<pre><code>data.generated.each_cons(3) do |prev, curr, nxt|\n  proxy \"#{curr.id}.html\",\n        \"/generated/template.html\",\n        locals: { prev: prev, curr: curr, next: nxt },\n        ignore: true\nend\n</code></pre>\n\n<p>The above would start with <code>curr</code> being the second page. I can\u2019t find the quick solution to handle these corner cases in an elegant manner, so we\u2019d just produce these pages manually:</p>\n\n<pre><code>def generate_page prev, curr, nxt\n  proxy \"#{curr.id}.html\",\n        \"/generated/template.html\",\n        locals: { prev: prev, curr: curr, next: nxt },\n        ignore: true\nend\n\ndata_generated = data.generated\ndata_generated.each_cons(3).with_index do |(prev, curr, nxt), idx|\n  generate_page(nil, prev, curr) if idx == 0\n  generate_page(prev, curr, nxt)\n  generate_page(curr, nxt, nil) if idx == data_generated.size\nend\n</code></pre>\n\n<hr>\n\n<pre><code>&lt;% prev, curr, nxt = locals.values_at(*%i|prev curr next|) %&gt;\n&lt;h1&gt;&lt;%= curr.title %&gt;&lt;/h1&gt;\n\n  &lt;a href=\"&lt;%= prev.id %&gt;.html\"&gt;\u21d0\u00a0&lt;%= prev.title %&gt;&lt;/a&gt; |\n  &lt;a href=\"&lt;%= nxt.id %&gt;.html\"&gt;&lt;%= nxt.title %&gt;\u00a0\u21d2&lt;/a&gt;\n</code></pre>\n\n<p>It might be needed to apply the additional check for <code>nxt</code>/<code>prev</code> not being <code>nil</code> is required around building links.</p>\n"}], "owner": {"reputation": 750, "user_id": 446557, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/eb7e397a43c04bc34321d579c5e15906?s=128&d=identicon&r=PG", "display_name": "helcim", "link": "https://stackoverflow.com/users/446557/helcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496237053, "creation_date": 1496232957, "question_id": 44284578, "link": "https://stackoverflow.com/questions/44284578/how-to-link-dynamically-generated-pages-in-middleman", "title": "How to link dynamically generated pages in MIddleman?", "body": "<p>I am generating my dynamic pages with the following in <code>config.rb</code></p>\n\n<pre><code>data.generated.each do |i|\n  proxy \"#{i.id}.html\", \"/generated/template.html\", :locals =&gt; { :i =&gt; i }, :ignore =&gt; true\nend\n</code></pre>\n\n<p>and a template in <code>source/generated/template.html.erb</code> </p>\n\n<pre><code>&lt;% i = locals[:i] %&gt;\n&lt;h1&gt;&lt;%= i.title %&gt;&lt;/h1&gt;\n</code></pre>\n\n<p>How can I create links to next and previous of these generated pages dynamically?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activemodel"], "comments": [{"owner": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496230381, "post_id": 44283523, "comment_id": 75573719, "body": "Don&#39;t you validate email uniqueness in user model? Shouldn&#39;t email be a unique identifier for users?"}, {"owner": {"reputation": 367, "user_id": 4523968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d72ee11aa1084aa094cdedb9b60b1774?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia M.", "link": "https://stackoverflow.com/users/4523968/mattia-m"}, "reply_to_user": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496230606, "post_id": 44283523, "comment_id": 75573890, "body": "I need to allow users to be able to subscribe to multiple stores with the same email."}, {"owner": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 1, "creation_date": 1496230699, "post_id": 44283523, "comment_id": 75573951, "body": "It makes more sense that a user can subscribe to multiple stores without register multiple accounts?"}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1496231012, "post_id": 44283763, "comment_id": 75574161, "body": "As @wesley6j allready stated - it makes no sense that users should be able to create multiple accounts with the same email - you allready have a many to many assocation that will allow a single user account to be linked to any number of stores."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1496230713, "creation_date": 1496230713, "answer_id": 44283763, "question_id": 44283523, "link": "https://stackoverflow.com/questions/44283523/rails-4-validates-uniqueness-with-has-many-through/44283763#44283763", "title": "Rails 4 - Validates uniqueness with has_many through", "body": "<p>You don't.</p>\n\n<p>You should validate the uniqueness of the users email in <code>User</code>. And validate the uniqueness of the <code>user_id</code> and <code>store_id</code> in <code>Permission</code>.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # ...\n  validates_uniqueness_of :email\nend\n\nclass Permission &lt; ApplicationRecord\n  validates_uniqueness_of :user_id, scope: 'store_id'\nend\n</code></pre>\n\n<p>This allows a user to have permissions for multiple stores - but does not allow duplicates. In general when linking records together use id's - not something like emails.</p>\n"}], "owner": {"reputation": 367, "user_id": 4523968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d72ee11aa1084aa094cdedb9b60b1774?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia M.", "link": "https://stackoverflow.com/users/4523968/mattia-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 44283763, "answer_count": 1, "score": 2, "last_activity_date": 1496230713, "creation_date": 1496229963, "question_id": 44283523, "link": "https://stackoverflow.com/questions/44283523/rails-4-validates-uniqueness-with-has-many-through", "title": "Rails 4 - Validates uniqueness with has_many through", "body": "<p>I have these three models:</p>\n\n<p>User:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :name, presence: true\n  validates :surname, presence: true\n  validates :email, presence: true, format: { with: /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i }\n\n  has_many :permissions, dependent: :destroy\n  has_many :stores, through: :permissions\nend\n</code></pre>\n\n<p>Store:</p>\n\n<pre><code>class Store &lt; ActiveRecord::Base\n  validates :name, presence: true\n  validates :description, presence: true\n\n  has_many :permissions\n  has_many :users, through: :permissions\nend\n</code></pre>\n\n<p>Permission:</p>\n\n<pre><code>class Permission &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :store\nend\n</code></pre>\n\n<p>How can i validate the uniqueness of the <code>user.email</code> based on the <code>store.id</code>?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 1, "creation_date": 1496227208, "post_id": 44282445, "comment_id": 75571551, "body": "Please post some efforts you made."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1496228116, "post_id": 44282445, "comment_id": 75572184, "body": "What is the code you are having trouble with?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496265084, "post_id": 44282445, "comment_id": 75595796, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked pages. You need to show evidence of your effort, and supply the minimum input that demonstrates the problem."}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1496236187, "post_id": 44282531, "comment_id": 75578131, "body": "Note that both methods fail if <code>No#</code> isn&#39;t present in the string. I don&#39;t know what the desired behaviour is."}], "tags": [], "owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "is_accepted": false, "score": 0, "last_activity_date": 1496227278, "creation_date": 1496227278, "answer_id": 44282531, "question_id": 44282445, "link": "https://stackoverflow.com/questions/44282445/how-do-i-split-a-string-in-ruby/44282531#44282531", "title": "How do I split a string in ruby?", "body": "<p>There are many ways to achieve that. You can, for example, use regular expression and scan method:</p>\n\n<pre><code>[1] pry(main)&gt; \"No#xyz1\".scan(/No#(.+)/).first.first\n=&gt; \"xyz1\"\n</code></pre>\n\n<p>or a \"dummy\" split on string too:</p>\n\n<pre><code>[4] pry(main)&gt; \"No#xyz1\".split(\"No#\")\n=&gt; [\"\", \"xyz1\"]\n[5] pry(main)&gt; \"No#xyz1\".split(\"No#\").last\n=&gt; \"xyz1\"\n</code></pre>\n\n<p>I would recommend the first one, though.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1496248150, "post_id": 44283677, "comment_id": 75586754, "body": "Alternatively <code>text[&#47;No#(.*)&#47;, 1]</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1496230484, "creation_date": 1496230484, "answer_id": 44283677, "question_id": 44282445, "link": "https://stackoverflow.com/questions/44282445/how-do-i-split-a-string-in-ruby/44283677#44283677", "title": "How do I split a string in ruby?", "body": "<p><a href=\"https://ruby-doc.org/core/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>String#[]</code></a> with <a href=\"http://www.regular-expressions.info/lookaround.html\" rel=\"nofollow noreferrer\">positive lookbehind</a> comes to the rescue:</p>\n\n<pre><code>\"No#xyz1\"[/(?&lt;=No#).*/]\n#\u21d2\u00a0\"xyz1\"\n</code></pre>\n\n<p>So in your matcher you can use:</p>\n\n<pre><code>find(:xpath,\"//*[]\").text[/(?&lt;=No#).*/] == \"xyz1\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1496236045, "creation_date": 1496236045, "answer_id": 44285690, "question_id": 44282445, "link": "https://stackoverflow.com/questions/44282445/how-do-i-split-a-string-in-ruby/44285690#44285690", "title": "How do I split a string in ruby?", "body": "<p><a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-partition\" rel=\"nofollow noreferrer\"><code>String#partition</code></a> works fine here.</p>\n\n<blockquote>\n  <p>Searches sep or pattern (regexp) in the string and returns the part\n  before it, the match, and the part after it. If it is not found,\n  returns two empty strings and str.</p>\n</blockquote>\n\n<pre><code>\"No#xyz1\".partition(\"No#\")\n# =&gt; [\"\", \"No#\", \"xyz1\"]\n\"No#xyz1\".partition(\"NotHere\")\n# =&gt; [\"No#xyz1\", \"\", \"\"]\n</code></pre>\n\n<p>So you can use :</p>\n\n<pre><code>\"No#xyz1\".partition(\"No#\").last\n# =&gt; \"xyz1\"\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6893562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o7jVQes2qcg/AAAAAAAAAAI/AAAAAAAABOQ/FNYzzV6_oI4/photo.jpg?sz=128", "display_name": "user6893562", "link": "https://stackoverflow.com/users/6893562/user6893562"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1496264989, "answer_count": 3, "score": -3, "last_activity_date": 1496236045, "creation_date": 1496227029, "last_edit_date": 1496234456, "question_id": 44282445, "link": "https://stackoverflow.com/questions/44282445/how-do-i-split-a-string-in-ruby", "closed_reason": "Not suitable for this site", "title": "How do I split a string in ruby?", "body": "<p>In my test step, I need to split letters.</p>\n\n<pre><code>find(:xpath,\"//*[]\").text\n</code></pre>\n\n<p>gives a string like <code>\"No#xyz1\"</code>, where <code>No#</code> is a static part.</p>\n\n<p>I need <code>xyz1</code>. How do I get that part?</p>\n"}, {"tags": ["ruby", "matrix", "eigenvalue", "eigenvector"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7557010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f6e9c82b5557020a06d7969b460ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ireul", "link": "https://stackoverflow.com/users/7557010/ireul"}, "edited": false, "score": 0, "creation_date": 1496288067, "post_id": 44283902, "comment_id": 75601887, "body": "Thank you for your answer. And could you tell me that why is ruby better than python/numpy on this question in your opinion?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 23, "user_id": 7557010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f6e9c82b5557020a06d7969b460ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ireul", "link": "https://stackoverflow.com/users/7557010/ireul"}, "edited": false, "score": 0, "creation_date": 1496294177, "post_id": 44283902, "comment_id": 75603492, "body": "As I wrote in the summary, I trust <a href=\"https://stackoverflow.com/questions/tagged/r\">r</a> more than both <a href=\"https://stackoverflow.com/questions/tagged/ruby\">ruby</a> and <a href=\"https://stackoverflow.com/questions/tagged/python\">python</a> when it comes to math. And ruby result is the same as the one yielded with R, while python\u2019s one is not."}, {"owner": {"reputation": 23, "user_id": 7557010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f6e9c82b5557020a06d7969b460ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ireul", "link": "https://stackoverflow.com/users/7557010/ireul"}, "edited": false, "score": 0, "creation_date": 1496296774, "post_id": 44283902, "comment_id": 75604426, "body": "OK, I got it. Thanks ^^"}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 23, "user_id": 7557010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f6e9c82b5557020a06d7969b460ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ireul", "link": "https://stackoverflow.com/users/7557010/ireul"}, "edited": false, "score": 0, "creation_date": 1496559249, "post_id": 44283902, "comment_id": 75705181, "body": "@Ireul, you marked this as the correct answer. Does that mean that you checked it from another source (wolfram/by hand) and found that numpy was indeed wrong? If it is, isn&#39;t it even more interesting than your original question? Did you ask a follow up question somewhere or contact the package maintainers or something?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1496231471, "last_edit_date": 1496231471, "creation_date": 1496231137, "answer_id": 44283902, "question_id": 44281924, "link": "https://stackoverflow.com/questions/44281924/is-this-a-rubys-bug-in-class-matrix/44283902#44283902", "title": "Is this a ruby&#39;s bug in class Matrix?", "body": "<p>This would be by no mean an answer, but I\u2019ll put it here for the sake of formatting:</p>\n\n<p>When it comes to math, I would use <a href=\"/questions/tagged/r\" class=\"post-tag\" title=\"show questions tagged &#39;r&#39;\" rel=\"tag\">r</a> to check the <em>correctness</em> of the result:</p>\n\n<pre><code>&gt; entries &lt;- c(0.6868, 0.6067, 0.6067, 0.5978)\n&gt; input &lt;- matrix(entries, nrow=2, byrow=TRUE)\n&gt; input\n\n#        [,1]   [,2]\n# [1,] 0.6868 0.6067\n# [2,] 0.6067 0.5978\n\n&gt; input_eigen &lt;- eigen(input)\n&gt; input_eigen \n\n$values\n# [1] 1.2506298 0.0339702\n\n$vectors\n#            [,1]       [,2]\n# [1,] -0.7325132  0.6807529\n# [2,] -0.6807529 -0.7325132\n</code></pre>\n\n<p>I trust the result above, which means ruby is probably doing better, than python/numpy.</p>\n"}], "owner": {"reputation": 23, "user_id": 7557010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f6e9c82b5557020a06d7969b460ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Ireul", "link": "https://stackoverflow.com/users/7557010/ireul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 44283902, "answer_count": 1, "score": 2, "last_activity_date": 1496234651, "creation_date": 1496225579, "last_edit_date": 1496234651, "question_id": 44281924, "link": "https://stackoverflow.com/questions/44281924/is-this-a-rubys-bug-in-class-matrix", "title": "Is this a ruby&#39;s bug in class Matrix?", "body": "<p>I use Matrix class in ruby to caculate eigenvalues and eigenvectors. With this code:</p>\n\n<pre><code>m = Matrix[[0.6868,0.6067],[0.6067,0.5978]]\nv, d, v_inv = m.eigensystem\n</code></pre>\n\n<p>the correct result should be:</p>\n\n<pre><code>[ 1.25057433  0.03398123]\n[[ 0.73251454 -0.68075138]\n [ 0.68075138  0.73251454]]\n</code></pre>\n\n<p>which I confirmed with <code>numpy</code> using Python.</p>\n\n<p>However, I got the result below:</p>\n\n<pre><code>d=[[0.033970204576497576,   0],\n [0,    1.2506297954235022]]\n\nv=[[0.6807528514962294, 0.7325131774785713],\n [-0.7325131774785713,  0.6807528514962294]]\n</code></pre>\n\n<p>Is this a ruby's bug? My ruby's version below:</p>\n\n<pre><code>ruby 2.1.2p95 (2014-05-08 revision 45877) [x86_64-linux]\n</code></pre>\n"}, {"tags": ["ruby", "variables", "sinatra", "instance-variables"], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 3759528, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/z9Bdw.jpg?s=128&g=1", "display_name": "madcolonel10", "link": "https://stackoverflow.com/users/3759528/madcolonel10"}, "edited": false, "score": 0, "creation_date": 1496377065, "post_id": 44293868, "comment_id": 75646479, "body": "I understand that everytime we are creating a new instance of Time, so the address in memory will be new. My question is say after the first incoming request the address to which test points is a1 and after second incoming request it is a2. If somewhere down in the code for the first request shouldnt test point to a2 (as modified by second request) instead of a1 as the class instance varibale gets shared among every instance of class."}], "tags": [], "owner": {"reputation": 241, "user_id": 8064724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1506651869367107/picture?type=large", "display_name": "Bartosz Bonis\u0142awski", "link": "https://stackoverflow.com/users/8064724/bartosz-bonis%c5%82awski"}, "is_accepted": false, "score": 1, "last_activity_date": 1496261505, "creation_date": 1496261505, "answer_id": 44293868, "question_id": 44281589, "link": "https://stackoverflow.com/questions/44281589/sinatra-multiple-parallel-requests-variable-behaviour/44293868#44293868", "title": "Sinatra Multiple Parallel Requests Variable Behaviour", "body": "<p>You can write ultra-simple script like this:</p>\n\n<pre><code>require 'sinatra'\nclass Foo\n  def self.bar\n    @test = Time.now\n    puts @test\n  end\nend\n\nget '/' do\n  Foo.bar\nend\n</code></pre>\n\n<p>and you'll see it does nothing, because with every call, you're creating new instance of Time(SchemaValidate in your code).</p>\n\n<p>If you used memoization and had something like <code>@validator ||= SchemaValidate.new</code> you would have one instance of SchemaValidate stored between requests. </p>\n\n<p>I don't think that'd change anything in terms of performance and I don't have idea why would anyone do something like that.</p>\n\n<p>You can have some fun with ultra-simple scripts with sinatra to test how it behaves. </p>\n\n<p>Good luck with this code!</p>\n"}], "owner": {"reputation": 647, "user_id": 3759528, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/z9Bdw.jpg?s=128&g=1", "display_name": "madcolonel10", "link": "https://stackoverflow.com/users/3759528/madcolonel10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496465263, "creation_date": 1496224683, "last_edit_date": 1496465263, "question_id": 44281589, "link": "https://stackoverflow.com/questions/44281589/sinatra-multiple-parallel-requests-variable-behaviour", "title": "Sinatra Multiple Parallel Requests Variable Behaviour", "body": "<p>I am fairly new to ruby and would like to understand how class instance variables behave in case of multiple parallel requests.</p>\n\n<p>I have a method inside my controller class which is called everytime for each request for a specific operation (create in this case)</p>\n\n<pre><code>class DeployProvision\n    def self.create(data)\n        raise \"Input JSON not received.\" unless data\n        # $logger.info input_data.inspect\n        failure = false\n        response_result = \"\"\n        response_status = \"200\"\n        @validator = SchemaValidate.new\n        validation = @validator.validate_create_workflow(data.to_json)\n    end\nend\n</code></pre>\n\n<p>This method is called as (DeployProvision.create(data))</p>\n\n<p>I am a little confused on how @validator class instance variable behaves when multiple requests come. Is it shared among multiple requests. Is it a good idea to declare this as class instance variable instead of a local variable ?</p>\n\n<p>I am working on an existing code base and would like to understand the intent of creating @validator as a class instance variable instead of local variable.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "search", "ransack"], "owner": {"reputation": 153, "user_id": 4395548, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c88e07616825c51ebed826143462d316?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4395548/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1496223326, "creation_date": 1496223326, "question_id": 44281053, "link": "https://stackoverflow.com/questions/44281053/ransack-associations-count", "title": "Ransack associations count", "body": "<p>I have 2 tables </p>\n\n<pre><code>Post=&gt;belongs_to: user\n\nUser=&gt;has_many: posts\n</code></pre>\n\n<p>I need to find user with more or lower than N posts</p>\n\n<p>How to do it?\nIs it possible with ransack</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "asana"], "answers": [{"comments": [{"owner": {"reputation": 3821, "user_id": 1000514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bd33755d13025ff0394a92993f23257e?s=128&d=identicon&r=PG", "display_name": "WagnerMatosUK", "link": "https://stackoverflow.com/users/1000514/wagnermatosuk"}, "edited": false, "score": 0, "creation_date": 1496600718, "post_id": 44296118, "comment_id": 75716861, "body": "Thank you Matt! Your very detailed response gave me all the information I need to get the authentication working. Much appreciated!"}], "tags": [], "owner": {"reputation": 9930, "user_id": 53139, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/95057d4c05e1cd82f30bf69b4302a7e6?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/53139/matt"}, "is_accepted": true, "score": 2, "last_activity_date": 1496272637, "creation_date": 1496272637, "answer_id": 44296118, "question_id": 44280518, "link": "https://stackoverflow.com/questions/44280518/how-to-use-omniauth-asana-with-rails-api-only-app/44296118#44296118", "title": "How to use Omniauth Asana with Rails API only app", "body": "<p>OK, I think I see what you're attempting to do here; I think the best way forward is to start with how OAuth's Authorization Code Grant happens in general, then move into specifics for OmniAuth.</p>\n\n<ul>\n<li><p>You send the user to a URL that Asana owns; that is, your goal is to get the user to visit a particular url. For Asana, this is <a href=\"https://app.asana.com/-/oauth_authorize\" rel=\"nofollow noreferrer\">https://app.asana.com/-/oauth_authorize</a>. (Note that we respond with an error if you don't sent a correct <code>client_id</code> param, but feel free to check that link if you want). Do <strong>not</strong> send the <code>client_secret</code> during this request - it is intended to never be involved in client-side code, as this is insecure.</p></li>\n<li><p>If they agree to give access, Asana sends back a redirect request to the user's browser with a short-lived code. That then means that your server will be called from the user's browser with this code as a parameter, so has to handle a <strong>new</strong> incoming request from the browser to whatever you specified as your redirect URI. Also, this location must be accessible by all users of your integration wherever they are.</p></li>\n<li><p>You send this code from your server as a POST request to <a href=\"https://app.asana.com/-/oauth_token\" rel=\"nofollow noreferrer\">https://app.asana.com/-/oauth_token</a> with your <code>client_secret</code> to Asana for a refresh token. This is where your application actually asks for credentials; the token given in the previous phases simply acknowledges that for a short time, the user has given your app permission to ask for these credentials, and your <code>client_secret</code> assures Asana that, for this server-side request, your app really is yours (it's like your application's password).</p></li>\n<li><p>We send back an <code>access_token</code> which represents (approximately) a client-user credential pair that is valid for an hour.\nYou use these credentials to access our API on behalf of this user. We also send back a <code>refresh_token</code> which is long-lived, and used to get new short-lived <code>access_tokens</code> after they expire in a very similar way.</p></li>\n</ul>\n\n<p>OK, so how this works with OmniAuth if I grok it correctly is that it expects to handle almost all of it. I'll be working through our omniauth example in our <code>ruby-asana</code> client library here: <a href=\"https://github.com/Asana/ruby-asana/blob/master/examples/omniauth_integration.rb\" rel=\"nofollow noreferrer\">https://github.com/Asana/ruby-asana/blob/master/examples/omniauth_integration.rb</a> </p>\n\n<ol>\n<li><p>You set up OmniAuth with your client id and client secret</p>\n\n<pre><code>use OmniAuth::Strategies::Asana, &lt;client_id&gt;, &lt;client_secret&gt;\n</code></pre></li>\n<li><p>A request comes in, and you don't have credentials for it.</p>\n\n<pre><code>get '/' do\n  if $client\n    ...\n  else\n    '&lt;a href=\"/sign_in\"&gt;sign in to asana&lt;/a&gt;'\n  end\nend\n</code></pre></li>\n<li><p>The user clicks the sign in link, which (code omitted) sends them to the <code>sign_in</code> endpoint. This endpoint issues a redirect to <code>/auth/asana</code></p></li>\n<li><p>The browser requests <code>/auth/asana</code> from our server. If you look at that example, it's not implemented in our code. That's because the <code>/auth/:provider</code> is magically handled by OmniAuth.</p></li>\n<li><p>This is where all the magic happens. OmniAuth handles the entire login flow above: send browser to our <code>oauth_authorize</code> above, then receive the callback and sticks the relevant params in the environment such that it knows \"we just got the short lived code\". By the time these lines get hit:</p>\n\n<pre><code>creds = request.env[\"omniauth.auth\"][\"credentials\"].tap { |h| h.delete('expires') }\nstrategy = request.env[\"omniauth.strategy\"]\n</code></pre></li>\n</ol>\n\n<p>you are inside a callback that OmniAuth has intercepted, gotten the needed creds, and set the creds in the environment. You shouldn't have to handle the oauth callback and token exchange manually.</p>\n\n<hr>\n\n<p>Now, with the code you provided, I notice a few things right off:</p>\n\n<ol>\n<li>You are causing the popup cycle to happen client side. It may be (and I strongly suspect) that this won't work with OmniAuth - it expects to handle the whole OAuth flow.</li>\n<li>Based on the code snippet you provided, you aren't serving this out of a request-response cycle in the controller, rather, it appears that this is in the controller body and not out of an instance method. It may be a typo, but this needs to be in a method that is called back to outside of Rails (that is, a route must point to this a controller method that Asana can use to handle the browser request).</li>\n<li>You shouldn't have to look at <code>request.headers</code>, I think - I'm not sure what the issues might be with <code>request.env</code>, but I suspect they may be unrelated to the API-only nature of your app. Are you sure that this is because it's API-only? After adding in the middleware, did you double-check that you can't access <code>request.env</code>? My hunch would be that persistent data in <code>request.env</code> will still be there, only <em>it</em> would require on the middleware being added in to do this. The instructions on OmniAuth simply say that you need to have a session store for your API - which makes sense to me, because APIs don't necessarily need to store state across requests, OmniAuth is telling you to put a session store back in.</li>\n</ol>\n\n<p>I know this is a lot of info, but hopefully it helps you get on the right track. Cheers!</p>\n"}], "owner": {"reputation": 3821, "user_id": 1000514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bd33755d13025ff0394a92993f23257e?s=128&d=identicon&r=PG", "display_name": "WagnerMatosUK", "link": "https://stackoverflow.com/users/1000514/wagnermatosuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 44296118, "answer_count": 1, "score": 0, "last_activity_date": 1496272637, "creation_date": 1496222008, "question_id": 44280518, "link": "https://stackoverflow.com/questions/44280518/how-to-use-omniauth-asana-with-rails-api-only-app", "title": "How to use Omniauth Asana with Rails API only app", "body": "<p>I have a Rails 5 API only app and an Angular JS Frontend app and would like to integrate with Asana API. I'm using the <code>ruby-asana</code>, <code>omniauth</code> and <code>omniauth-asana</code> gems.</p>\n\n<p>I start the request using Asana's <a href=\"https://github.com/Asana/node-asana\" rel=\"nofollow noreferrer\">JS library</a> like so:</p>\n\n<pre><code>var client = Asana.Client.create({\n      clientId: 172706773623703,\n      clientSecret: '&lt;client_secret&gt;',\n      redirectUri: '&lt;redirect_url&gt;'\n    });\n    client.useOauth({\n      flowType: Asana.auth.PopFlow\n    });\n</code></pre>\n\n<p>And the above does redirect me to Asana where I can login. On the <code>redirectUri</code> I'm giving a backend route (Rails 5 API only) which should handle the remaining on the authentication (using the JS only I get only a temporary token that cannot be self renewed meaning the user will have to authenticate every time the token expires. This is if I understood the documentation correctly). </p>\n\n<p>So, on the controller I've created to handle the route, I have the following (from an example on Asana's documentation):</p>\n\n<pre><code>require 'omniauth-asana'\nuse OmniAuth::Strategies::Asana, &lt;secret&gt;, &lt;secret&gt;\n\ncreds = request.env[\"omniauth.auth\"][\"credentials\"].tap { |h| h.delete('expires') }\nstrategy = request.env[\"omniauth.strategy\"]\naccess_token = OAuth2::AccessToken.from_hash(strategy.client, creds).refresh!\n$client = Asana::Client.new do |c|\n  c.authentication :oauth2, access_token\nend\n</code></pre>\n\n<p>Now, the above doesn't work because 1) there's no <code>request.env</code> as this is an API only app, so I've followed the instruction on <a href=\"https://github.com/omniauth/omniauth#integrating-omniauth-into-your-rails-api\" rel=\"nofollow noreferrer\">Omniauth</a> and have added the following to my <code>config/application.rb</code>:</p>\n\n<pre><code>config.session_store :cookie_store, key: '_interslice_session'\nconfig.middleware.use ActionDispatch::Cookies # Required for all session management\nconfig.middleware.use ActionDispatch::Session::CookieStore, config.session_options\n</code></pre>\n\n<p>Now, in the <code>request.headers</code> I have <code>_interslice_session</code> which has some numbers. How can I create a <code>Asana client</code> with the above?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments", "stripe-connect"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496221559, "post_id": 44280297, "comment_id": 75567480, "body": "does such api exist in the documentation? what&#39;s the error?"}, {"owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496222934, "post_id": 44280297, "comment_id": 75568489, "body": "From what I can tell, for an account you have connect authorisation for, you should be able to retrieve all the data you could for your own account."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496223647, "post_id": 44280297, "comment_id": 75569042, "body": "are you able fetch 1 <code>BalanceTransaction</code>? if yes how? and are you getting any error?"}], "answers": [{"comments": [{"owner": {"reputation": 7381, "user_id": 7802200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Adik7.png?s=128&g=1", "display_name": "Arya McCarthy", "link": "https://stackoverflow.com/users/7802200/arya-mccarthy"}, "edited": false, "score": 2, "creation_date": 1496640262, "post_id": 44362103, "comment_id": 75725905, "body": "It would be beneficial to include details about how this answers the question, rather than just providing a single line of code."}], "tags": [], "owner": {"reputation": 1, "user_id": 8112702, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/09fb1ffdef9045a5bb484bd5324f1989?s=128&d=identicon&r=PG", "display_name": "user2314", "link": "https://stackoverflow.com/users/8112702/user2314"}, "is_accepted": false, "score": 0, "last_activity_date": 1496639868, "creation_date": 1496639868, "answer_id": 44362103, "question_id": 44280297, "link": "https://stackoverflow.com/questions/44280297/stripe-balance-transactions-for-connect-accounts/44362103#44362103", "title": "Stripe Balance Transactions for connect accounts", "body": "<pre><code>Stripe::BalanceTransaction.all({/*insert params*/},{:stripe_account =&gt; access_token})\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496639868, "creation_date": 1496221449, "question_id": 44280297, "link": "https://stackoverflow.com/questions/44280297/stripe-balance-transactions-for-connect-accounts", "title": "Stripe Balance Transactions for connect accounts", "body": "<p>Hi I'm working on a project where I have to retrieve a users stripe balance transaction history using the stripe connect api. So I have my users access_token, but I'm having trouble working out how to use that with the <code>Stripe::BalanceTransaction</code> request. </p>\n\n<p>For example if I want to retrieve the balance I can do:</p>\n\n<pre><code>Stripe::Balance.retrieve({:stripe_account =&gt; access_token})\n</code></pre>\n\n<p>However The same thing doesn't work for BalanceTransaction</p>\n\n<pre><code>Stripe::BalanceTransaction.all({:stripe_account =&gt; access_token})\n</code></pre>\n\n<p>Obviously I'm missing something, but after looking through the API documentation, I'm not sure what that is.</p>\n"}, {"tags": ["ruby", "automation", "cucumber", "bdd", "gherkin"], "comments": [{"owner": {"reputation": 5799, "user_id": 7128479, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hF0yx.jpg?s=128&g=1", "display_name": "grizzthedj", "link": "https://stackoverflow.com/users/7128479/grizzthedj"}, "edited": false, "score": 0, "creation_date": 1496259462, "post_id": 44279981, "comment_id": 75593102, "body": "If the second scenario fails, how would running it again make it pass?"}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "reply_to_user": {"reputation": 5799, "user_id": 7128479, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hF0yx.jpg?s=128&g=1", "display_name": "grizzthedj", "link": "https://stackoverflow.com/users/7128479/grizzthedj"}, "edited": false, "score": 0, "creation_date": 1496293015, "post_id": 44279981, "comment_id": 75603156, "body": "Intermittent errors are frequent in the second test.. But when you take it as a general question. Is there a possibility to do such? Though I agree it&#39;s not the best practices"}], "answers": [{"comments": [{"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1496293201, "post_id": 44293315, "comment_id": 75603205, "body": "I agree it is not he best practice.. also in case if I want to test an individual feature. My app goes through a sign up process where we receive OTP at the start mandatorily to sign in. Triggering for an OTP each time within 2-5min makes OTP receive time really high and half or more tests fail due to OTP not received. Hence to remove the complete dependency on OTP I had only made first test as signed in and the rest already signed in. I&#39;ll take a look at the framework you have mentioned.   Taking my question as a general one, I would like to just know the possibilities of having it?"}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1496307053, "post_id": 44293315, "comment_id": 75610780, "body": "<code>In the sort term, perhaps you can create a global status variable to hold the status of the test run. The downside is that you would have to check this in every test.</code> Okay! I think I am getting what you are saying...."}, {"owner": {"reputation": 5799, "user_id": 7128479, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hF0yx.jpg?s=128&g=1", "display_name": "grizzthedj", "link": "https://stackoverflow.com/users/7128479/grizzthedj"}, "reply_to_user": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1496324890, "post_id": 44293315, "comment_id": 75623984, "body": "The testing of OTP should be an integration test that is done outside your test environment. You can &quot;fake&quot; the OTP in your test environment(with Factory Girl) since it is complicating your test suite. This will eliminate the intermittent failures, and make your tests independent of one another, which makes your test suite more clean and maintainable."}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "edited": false, "score": 0, "creation_date": 1496346023, "post_id": 44293315, "comment_id": 75637176, "body": "Understood. In test environment too, the application uses account kit to generate OTP, that verifies only real numbers and works only when it is verified with the sim card. You think, this can be faked with the Factory Girl approach? I am not very much having an idea about it"}], "tags": [], "owner": {"reputation": 5799, "user_id": 7128479, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hF0yx.jpg?s=128&g=1", "display_name": "grizzthedj", "link": "https://stackoverflow.com/users/7128479/grizzthedj"}, "is_accepted": false, "score": 2, "last_activity_date": 1496325273, "last_edit_date": 1496325273, "creation_date": 1496259272, "answer_id": 44293315, "question_id": 44279981, "link": "https://stackoverflow.com/questions/44279981/run-cucumber-scenario-again-until-pass/44293315#44293315", "title": "Run cucumber scenario again until pass", "body": "<p>I think you are climbing up a slippery slope having tests that are dependent on each other to pass. You will likely have continuous problems with this approach going forward.</p>\n\n<p>I would recommend writing your tests so that they are not dependent on each other, and use a framework like <a href=\"https://github.com/thoughtbot/factory_girl\" rel=\"nofollow noreferrer\">Factory Girl</a> to stub out test objects etc. There is a lot of flexibility here, and integrates well with cucumber.</p>\n\n<p><strong>UPDATE:</strong> As per your comment, the testing of OTP should be an integration test that is done outside your <code>TEST</code> environment. When you deploy new code to your <code>DEV</code> environment for example, your integration test(that tests OTP) should get run on the code deployed. </p>\n\n<p>In your <code>TEST</code> environment, you can <code>fake</code> the OTP(with Factory Girl). This will eliminate the intermittent failures, and make your tests independent of one another, which makes your test suite more clean and maintainable.</p>\n\n<p>In the short term, perhaps you can create a global status variable to hold the status of the test run. The downside is that you would have to check this in every test.</p>\n"}], "owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496325273, "creation_date": 1496220563, "question_id": 44279981, "link": "https://stackoverflow.com/questions/44279981/run-cucumber-scenario-again-until-pass", "title": "Run cucumber scenario again until pass", "body": "<p>I have 10 tests that to be run in cucumber and I am using ruby to write my codes. The application under tests design, forces me to have tests that are dependent to each other.</p>\n\n<p>So until the previous case is a pass, the next one fails. I have added <code>cucumber_wants_to_quit</code> in case the second scenario fails, to avoid waiting to only get the failure reports. Now, I was looking for something like, running the second scenario again, and keep running it until <code>pass</code> before proceeding to the third scenario.</p>\n\n<p>I know of the command <code>cucumber re-run</code> but will not want to use it, since this basically runs all the scenarios and runs the failed cases once the first complete run is completed. </p>\n\n<p>My requirement is basically, when the second scenario fails, before moving to third, run the second scenario until pass. In coding language something like</p>\n\n<pre><code> After do |scenario.name|\n     if scenario.name == failed?\n         status = scenario.name.run_again until scenario.name == passed\n         if !status\n            Cucumber.wants_to_quit = true\n         end\n     end\n end\n</code></pre>\n\n<p>Any help on this? </p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1496214787, "post_id": 44277994, "comment_id": 75563088, "body": "<code>list == list.sort</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496216652, "post_id": 44277994, "comment_id": 75564276, "body": "Providing an example in a question is generally helpful, but the inclusion of an arbitrary numeric array that is not referenced by the question serves no purpose."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1496215119, "post_id": 44278054, "comment_id": 75563292, "body": "To assert that it is in strictly ascending order, add a separate test <code>expect(array.uniq.size) == array.size</code>."}, {"owner": {"reputation": 12669, "user_id": 1482709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef49d195f8555bdc65d793cf965a2f6f?s=128&d=identicon&r=PG", "display_name": "Prashanth Sams", "link": "https://stackoverflow.com/users/1482709/prashanth-sams"}, "edited": false, "score": 0, "creation_date": 1496215800, "post_id": 44278054, "comment_id": 75563732, "body": "Yes @IIya that makes sense :)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1496226888, "post_id": 44278054, "comment_id": 75571375, "body": "<a href=\"http://ruby-doc.org/core/Array.html#method-i-sort\" rel=\"nofollow noreferrer\"><code>Array#sort</code></a> is <i>not</i> stable, so this does not work if there are equal elements."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 2, "creation_date": 1496227710, "post_id": 44278054, "comment_id": 75571916, "body": "<code>Array#sort</code> is stable in the context of this question (array of ints)."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": true, "score": 6, "last_activity_date": 1543207430, "last_edit_date": 1543207430, "creation_date": 1496214785, "answer_id": 44278054, "question_id": 44277994, "link": "https://stackoverflow.com/questions/44277994/how-to-assert-list-of-values-in-ascending-order/44278054#44278054", "title": "How to assert list of values in ascending order?", "body": "<p>The simplest way is probably:</p>\n\n<pre><code>expect(array.sort).to eq(array)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1496227175, "post_id": 44282387, "comment_id": 75571528, "body": "Could you please provide an instance, when sort does not work, but your answer works?  Also, <code>be_truthy</code> is <b>not nil or false</b>,  <code>be true</code> is enough."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1496227417, "post_id": 44282387, "comment_id": 75571695, "body": "<code>sort</code> is unstable, which means that if there are elements where <code>&lt;=&gt;</code> returns <code>0</code>, there is no guarantee that they will keep their relative order. There is also no guarantee that for elements where <code>&lt;=&gt;</code> returns <code>0</code>, <code>==</code> returns <code>true</code> (although I would consider that very strange if not a bug, but hey, people do strange things). So, if there are two elements which have the same order but are not equal, then they may get swapped by sorting and resulting in the original array and the sorted array to not be equal."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 1, "creation_date": 1496227640, "post_id": 44282387, "comment_id": 75571868, "body": "But there are only integers in the question, I think your answer is overhead in this context, but, of course, makes sense in some (very rare) conditions."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1496226846, "creation_date": 1496226846, "answer_id": 44282387, "question_id": 44277994, "link": "https://stackoverflow.com/questions/44277994/how-to-assert-list-of-values-in-ascending-order/44282387#44282387", "title": "How to assert list of values in ascending order?", "body": "<p>\"Ascending\" means \"the next element is not smaller than the current\". You can encode that into a predicate easily:</p>\n\n<pre><code>expect(array.each_cons(2).all? {|a, b| a &lt;= b }).to be_truthy\n</code></pre>\n\n<p>Note that <a href=\"http://ruby-doc.org/core/Array.html#method-i-sort\" rel=\"nofollow noreferrer\"><code>Array#sort</code></a> is <em>not</em> stable, so something like </p>\n\n<pre><code>expect(array.sort).to eq(array)\n</code></pre>\n\n<p><em>does not work</em>!</p>\n"}], "owner": {"reputation": 12669, "user_id": 1482709, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef49d195f8555bdc65d793cf965a2f6f?s=128&d=identicon&r=PG", "display_name": "Prashanth Sams", "link": "https://stackoverflow.com/users/1482709/prashanth-sams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 44278054, "answer_count": 2, "score": 0, "last_activity_date": 1543207430, "creation_date": 1496214617, "last_edit_date": 1496674341, "question_id": 44277994, "link": "https://stackoverflow.com/questions/44277994/how-to-assert-list-of-values-in-ascending-order", "title": "How to assert list of values in ascending order?", "body": "<p>Here is a list of values in an array:</p>\n\n<pre><code>[463, 246, 216, 194, 154, 152, 147, 140, 129, 128, 123, 118, 118, 102, 102, 101, 97, 96, 93, 85]\n</code></pre>\n\n<p>How can I ensure/assert through RSpec that the array list is in ascending order?</p>\n"}, {"tags": ["html", "mysql", "ruby-on-rails", "ruby", "controller"], "comments": [{"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1496213453, "post_id": 44277564, "comment_id": 75562243, "body": "Write those queries on the <code>helper</code> method."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1496213574, "post_id": 44277564, "comment_id": 75562315, "body": "<i>Controller</i> is a bad place to put those <i>methods</i>. You should move them to <i>model</i> instead."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496213590, "post_id": 44277564, "comment_id": 75562321, "body": "why you <code>order</code>ing it if you just need count?"}, {"owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496213901, "post_id": 44277564, "comment_id": 75562492, "body": "@Md.FarhanMemon because I was using .group and I want to display the result base on dates and in ascending order."}, {"owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "reply_to_user": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1496213942, "post_id": 44277564, "comment_id": 75562521, "body": "@Emu how would I implement this? I mean how would I call helper method to views?"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496214440, "post_id": 44277564, "comment_id": 75562830, "body": "@Aurb you are calling <code>.count</code> on every query and it doesn&#39;t matter in which <code>order</code> it is, result remains same."}, {"owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "reply_to_user": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1496237065, "post_id": 44277564, "comment_id": 75578812, "body": "@Emu yes, there are different queries on every &lt;th&gt;, how would I call every helper method in views?"}, {"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1496242181, "post_id": 44277564, "comment_id": 75582713, "body": "@Aurb, In this case the answer given by Memon is great."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "edited": false, "score": 0, "creation_date": 1496237182, "post_id": 44277905, "comment_id": 75578917, "body": "I&#39;m not yet familiar with scopes, will read the documentation for it. Thanks for the suggestion, will try this one :)"}, {"owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "edited": false, "score": 0, "creation_date": 1496311275, "post_id": 44277905, "comment_id": 75614038, "body": "I already set up all my necessary scope, how would I implement this on my view(calling them)?"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "edited": false, "score": 0, "creation_date": 1496312007, "post_id": 44277905, "comment_id": 75614566, "body": "the e.g section are the calls you have to make to get the result, check update"}, {"owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "edited": false, "score": 0, "creation_date": 1496385430, "post_id": 44277905, "comment_id": 75649659, "body": "yay thanks! I kind of got it working now, but currently, it is only being displayed in one row, I think the query is being called on the column where the query was called. How can I do like, list first all the dates, then count the existence of the record of each date? Anyways, thanks a lot for helping me out :)"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 2, "last_activity_date": 1496312057, "last_edit_date": 1496312057, "creation_date": 1496214355, "answer_id": 44277905, "question_id": 44277564, "link": "https://stackoverflow.com/questions/44277564/call-a-query-controller-action-inside-views/44277905#44277905", "title": "Call a query (controller action) inside views", "body": "<p>I see lots of duplication in your code, you can create <a href=\"http://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"nofollow noreferrer\"><code>scopes</code></a> for each subquery and can have multiple combinations.</p>\n\n<p>In your <code>verification.rb</code>,</p>\n\n<pre><code>scope :date_grouped, -&gt; { group(:Date) }\n\nscope :falsy, -&gt; { where(\"Findings = ? or Findings = ?\", 'False Positive','False Negative') }\n\nscope :truthy, -&gt; { where(\"Findings = ? or Findings = ?\", 'True Positive','True Negative') }\n\nscope :findings_by, -&gt; (value) { where(Findings: value) }\n\nscope :date_asc, -&gt; { order(Date: :asc) }\n</code></pre>\n\n<p>Now you can just call them as required.</p>\n\n<p>e.g.</p>\n\n<pre><code>&lt;%= Verification.date_grouped.falsy.date_asc %&gt;\n&lt;%= Verification.date_grouped.truthy.date_asc %&gt;\n&lt;%= Verification.date_grouped.findings_by('True Positive').date_asc %&gt;\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7725038, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ab2f869211b056a1451f0821915dde6?s=128&d=identicon&r=PG&f=1", "display_name": "Aurb", "link": "https://stackoverflow.com/users/7725038/aurb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44277905, "answer_count": 1, "score": 0, "last_activity_date": 1496312057, "creation_date": 1496213308, "last_edit_date": 1496224417, "question_id": 44277564, "link": "https://stackoverflow.com/questions/44277564/call-a-query-controller-action-inside-views", "title": "Call a query (controller action) inside views", "body": "<p>I am trying to create a table that mostly displays the numbers of each respective field by date. I only have one model for this one</p>\n\n<p>View:</p>\n\n<pre><code>&lt;table class=\"table-table-verif\"&gt;\n      &lt;thead class=\"fixed_headers\"&gt;\n      &lt;tr id = \"thead-title\"&gt;\n        &lt;th&gt;Date&lt;/th&gt;\n        &lt;th&gt;# True Positive&lt;/th&gt;\n        &lt;th&gt;# True Negative&lt;/th&gt;\n        &lt;th&gt;# False Positive&lt;/th&gt;\n        &lt;th&gt;# False Negative&lt;/th&gt;\n      &lt;/tr&gt;\n      &lt;/thead&gt;\n\n      &lt;tbody&gt;\n       &lt;% @verification.each do |s| %&gt;\n        &lt;tr id=\"thead-value\"&gt;\n          // what to do here?\n        &lt;/tr&gt;\n       &lt;% end %&gt;\n      &lt;/tbody&gt;\n    &lt;/table&gt;\n</code></pre>\n\n<p>I want to call these queries in my controller.</p>\n\n<p>Controller:</p>\n\n<pre><code>  def date\n    @verification = Verification.group(:Date).where(\"Findings = ? or Findings = ?\", 'False Positive','False Negative').order(Date: :asc).count\n  end\n\n  def number_true_positive\n    Verification.group(Date).where(\"Findings = ?\", 'True Positive').order(Date: :asc).count\n  end\n\n  def number_false_positive\n    Verification.group(:Date).where(\"Findings = ?\", 'False Positive').order(Date: :asc).count\n  end\n\n  def number_true_negative\n    Verification.group(:Date).where(\"Findings = ?\", 'True Negative').order(Date: :asc).count\n  end\n\n  def number_false_negative\n    Verification.group(:Date).where(\"Findings = ?\", 'False Negative').order(Date: :asc).count\n  end\n</code></pre>\n\n<p>Every column should count the number of respective records, and put the number on their respective <code>&lt;th&gt;</code> based on their date.</p>\n\n<p>What is a better way to approach?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "gmail", "gmail-api"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8090070, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159066485620508/picture?type=large", "display_name": "Tom Hughes", "link": "https://stackoverflow.com/users/8090070/tom-hughes"}, "edited": false, "score": 0, "creation_date": 1496386657, "post_id": 44286276, "comment_id": 75650242, "body": "Ahh that makes sense, thank you! I&#39;ll look into some different hosting options."}], "tags": [], "owner": {"reputation": 343, "user_id": 1336988, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/N9enR.jpg?s=128&g=1", "display_name": "codelitt", "link": "https://stackoverflow.com/users/1336988/codelitt"}, "is_accepted": true, "score": 1, "last_activity_date": 1496237655, "last_edit_date": 1592644375, "creation_date": 1496237655, "answer_id": 44286276, "question_id": 44277395, "link": "https://stackoverflow.com/questions/44277395/gmailclientauthorizationerror-only-in-production-for-rails-app-on-heroku/44286276#44286276", "title": "Gmail::Client::AuthorizationError only in Production for Rails App on Heroku", "body": "<p>Are you deploying to a domain? It could be caused by the fact that:</p>\n<blockquote>\n<p>Heroko will not give you even a range of IP addresses - they can, may and will move dynos between Amazon zones as needs require.</p>\n<p>Your only option would be some sort of proxy node with a static IP that they talk to that securely communicates to your Heroku app - or consider if Heroku is the right fit for you here altogether.</p>\n</blockquote>\n<p>Source: <a href=\"https://stackoverflow.com/questions/15512360/get-a-finite-list-of-ip-addresses-for-my-heroku-app\">Get a finite list of IP addresses for my Heroku App?</a></p>\n<p>It seems like you sign into Google and whitelist what an IP (as far as they're concerned) and then the dyno switches a bit later for whatever reason so then Google no longer has your dyno's IP in the whitelist for this app.</p>\n"}], "owner": {"reputation": 3, "user_id": 8090070, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159066485620508/picture?type=large", "display_name": "Tom Hughes", "link": "https://stackoverflow.com/users/8090070/tom-hughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 44286276, "answer_count": 1, "score": 0, "last_activity_date": 1496237655, "creation_date": 1496212698, "last_edit_date": 1496213069, "question_id": 44277395, "link": "https://stackoverflow.com/questions/44277395/gmailclientauthorizationerror-only-in-production-for-rails-app-on-heroku", "title": "Gmail::Client::AuthorizationError only in Production for Rails App on Heroku", "body": "<p>I have a RoR app that reads emails from my inbox using the gmail gem. I've deployed to Heroku and everything works fine, except connecting to gmail.</p>\n\n<p>On my local machine it connects with no issues (after I allowed access for less secure apps).</p>\n\n<p>Using the basic gmail login method;</p>\n\n<pre><code>Gmail.connect!('my_email@gmail.com','password')\n</code></pre>\n\n<p>I get the following error in production only.</p>\n\n<p><code>Gmail::Client::AuthorizationError: Couldn't login to given Gmail account: my_email@gmail.com (Please log in via your web browser: https://support.google.com/mail/accounts/answer/78754 (Failure))</code></p>\n\n<p>And then I'll go to <a href=\"https://www.google.com/accounts/DisplayUnlockCaptcha\" rel=\"nofollow noreferrer\">https://www.google.com/accounts/DisplayUnlockCaptcha</a> (as other answers have suggested) and it will work fine for a short time period and then suddenly stop working again.</p>\n\n<p>I'm using Ruby v2.4.1, RoR v5.1.1 and the gmail gem v0.6.0 (<a href=\"https://github.com/gmailgem/gmail\" rel=\"nofollow noreferrer\">https://github.com/gmailgem/gmail</a>)</p>\n\n<p>Any help would be great.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1496211689, "post_id": 44276899, "comment_id": 75561311, "body": "<code>f.object.food&amp;.name</code> would 99% solve it (or <code>f.object.food.try(:name)</code> if you&#39;re on Ruby &lt; 2.3)."}, {"owner": {"reputation": 113, "user_id": 2821535, "user_type": "registered", "profile_image": "https://graph.facebook.com/787107371/picture?type=large", "display_name": "LuisFelipe22", "link": "https://stackoverflow.com/users/2821535/luisfelipe22"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1496212572, "post_id": 44276899, "comment_id": 75561772, "body": "That&#39;s a good workaround, thanks. Still puzzles me why such a call to an attribute would raise an error."}], "owner": {"reputation": 113, "user_id": 2821535, "user_type": "registered", "profile_image": "https://graph.facebook.com/787107371/picture?type=large", "display_name": "LuisFelipe22", "link": "https://stackoverflow.com/users/2821535/luisfelipe22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1496210840, "creation_date": 1496210840, "question_id": 44276899, "link": "https://stackoverflow.com/questions/44276899/can-i-get-access-a-form-builder-objects-attribute-in-rails", "title": "Can I get/access a form_builder.object&#39;s ATTRIBUTE in Rails?", "body": "<p>I have resorted to ask a question here since this is something that's puzzling me:</p>\n\n<p>I am trying to create a nested attributes form with the following models:</p>\n\n<pre><code>class Recipe &lt; ApplicationRecord\n  has_many :ingredient_records, dependent: :destroy, inverse_of: :recipe    \n  accepts_nested_attributes_for :ingredient_records, allow_destroy: true\n\nclass IngredientRecord &lt; ApplicationRecord\n  belongs_to :food, inverse_of: :ingredient_records\n  belongs_to :recipe, inverse_of: :ingredient_records\n</code></pre>\n\n<p>I've ommited some parts of the models that are non related. (At least I hope so).</p>\n\n<p>The main problem comes here: When I do this on the :edit view:</p>\n\n<pre><code>&lt;div class=\"nested-fields\"&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :food_id %&gt;\n    &lt;%= f.select :food_id, [[ f.object.food, f.object.food_id ]]%&gt;\n</code></pre>\n\n<p>It outputs a select field with an option like &lt;#Food:x0203400291> (the form_builder object, verified it's the correct object with a breakpoint with byebug)</p>\n\n<p>BUT when I do (it's the <strong>.name</strong> part):</p>\n\n<pre><code>&lt;%= f.select :food_id, [[ f.object.food.name, f.object.food_id ]]%&gt;\n</code></pre>\n\n<p>Rails raises an error screen with: <code>undefined method \u00b4name' for nil:NilClass</code> (name is an attribute on the Food.model).</p>\n\n<p>What do you guys think? Am I actually tryin something that's <strong>not allowed inside a rails view</strong>? (Would be strange since putting a byebug clause just before the select builder and calling <code>f.object.food.name</code> returns the value just fine). Thanks in advance!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "rails-admin"], "answers": [{"comments": [{"owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "edited": false, "score": 0, "creation_date": 1525085157, "post_id": 45338737, "comment_id": 87214169, "body": "Thank you for the help keyword!"}], "tags": [], "owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "is_accepted": false, "score": 2, "last_activity_date": 1501109832, "creation_date": 1501109832, "answer_id": 45338737, "question_id": 44276365, "link": "https://stackoverflow.com/questions/44276365/rails-admin-remove-the-optional-labels/45338737#45338737", "title": "Rails_admin remove the optional labels", "body": "<p>I'll try to answer both your questions with a code snippet please read the\ncomments</p>\n\n<pre><code>class YourObject &lt; ApplicationRecord\n  rails_admin do\n    edit do\n      field :user do\n        help nil # This is the word 'Required' in your screenshot\n        label 'Person' # for rails admin the label might mean something different than to you in this question\n\n        default_value do\n          bindings[:view]._current_user.id # This is what you want as the default\n        end\n\n        read_only true # You can go as far as not letting the current user to change this field\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7800020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad83d7d9342e19be1c7b99dcffae42d?s=128&d=identicon&r=PG&f=1", "display_name": "SherryS", "link": "https://stackoverflow.com/users/7800020/sherrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501109832, "creation_date": 1496208512, "question_id": 44276365, "link": "https://stackoverflow.com/questions/44276365/rails-admin-remove-the-optional-labels", "title": "Rails_admin remove the optional labels", "body": "<p>I am new in ruby on rails and I am using rails_admin gem for admin panel in my application. But it has so many labels for \"Add New\". However, there are some that I do not need.I already read the gem file which is <a href=\"https://github.com/sferik/rails_admin/wiki\" rel=\"nofollow noreferrer\">https://github.com/sferik/rails_admin/wiki</a>. But still confused that how can I remove them?<a href=\"https://i.stack.imgur.com/ovhGW.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>And also I do not know how to add current user id to this post, so that I do not need to select the user here.</p>\n\n<p>Thanks advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "soap", "savon"], "comments": [{"owner": {"reputation": 1903, "user_id": 2578693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a7a908dd876ba5168b5ba618ccae256?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Hasanuzzaman Sumon", "link": "https://stackoverflow.com/users/2578693/engr-hasanuzzaman-sumon"}, "edited": false, "score": 0, "creation_date": 1508855493, "post_id": 44275907, "comment_id": 80773443, "body": "What do mean by &quot;with no soap envelope and body tags?&quot; <i>A SOAP message MUST use the SOAP Envelope namespace</i> other wise it will not be valid soap request."}], "answers": [{"tags": [], "owner": {"reputation": 3271, "user_id": 387177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce58186c9663c82e5fef7fcca045fa57?s=128&d=identicon&r=PG", "display_name": "Steffen Roller", "link": "https://stackoverflow.com/users/387177/steffen-roller"}, "is_accepted": false, "score": 0, "last_activity_date": 1496236142, "creation_date": 1496236142, "answer_id": 44285731, "question_id": 44275907, "link": "https://stackoverflow.com/questions/44275907/savon-2-plain-xml-requests/44285731#44285731", "title": "Savon 2 plain xml requests?", "body": "<p>You can use Nokogiri - which is a dependency of Savon.</p>\n"}], "owner": {"reputation": 931, "user_id": 2788619, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100006561616235/picture?type=large", "display_name": "L457", "link": "https://stackoverflow.com/users/2788619/l457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496236142, "creation_date": 1496206314, "question_id": 44275907, "link": "https://stackoverflow.com/questions/44275907/savon-2-plain-xml-requests", "title": "Savon 2 plain xml requests?", "body": "<p>Is there a way I can use savon to generate a plain xml request from a hash, with no soap envelope and body tags?</p>\n\n<p>The only way I've found to do this so far is directly passing in raw xml using <code>Savon.client.call(:some_action, xml: '&lt;myxml /&gt;')</code></p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1496209199, "post_id": 44275744, "comment_id": 75560090, "body": "You&#39;ve got mismatched quotes in that last example, are you sure that&#39;s what you have?"}, {"owner": {"reputation": 7182, "user_id": 33689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/ceb09c840b0bb7c0a70d722d1c712e89?s=128&d=identicon&r=PG", "display_name": "ThaDon", "link": "https://stackoverflow.com/users/33689/thadon"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1496231561, "post_id": 44275744, "comment_id": 75574617, "body": "@coderanger good catch, fixed that up. It is correct in my attributes file, just transcribed it incorrectly here"}], "answers": [{"comments": [{"owner": {"reputation": 7182, "user_id": 33689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/ceb09c840b0bb7c0a70d722d1c712e89?s=128&d=identicon&r=PG", "display_name": "ThaDon", "link": "https://stackoverflow.com/users/33689/thadon"}, "edited": false, "score": 0, "creation_date": 1496247085, "post_id": 44289667, "comment_id": 75586129, "body": "You are right! I found this in the <code>execute</code> resource documentation: <code>env is an alias for environment</code> changing the method name to <code>enviro</code> worked"}], "tags": [], "owner": {"reputation": 26, "user_id": 8093158, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154424213711861/picture?type=large", "display_name": "Sean Walberg", "link": "https://stackoverflow.com/users/8093158/sean-walberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1496246836, "creation_date": 1496246836, "answer_id": 44289667, "question_id": 44275744, "link": "https://stackoverflow.com/questions/44275744/action-class-class-eval-method-not-working-with-execute-resources-environment-p/44289667#44289667", "title": "action_class.class_eval method not working with execute resource&#39;s environment property", "body": "<p>The \"env\" method name might be a reserved word or is getting stomped later in the run. Try a different name for that method, perhaps?</p>\n"}], "owner": {"reputation": 7182, "user_id": 33689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/ceb09c840b0bb7c0a70d722d1c712e89?s=128&d=identicon&r=PG", "display_name": "ThaDon", "link": "https://stackoverflow.com/users/33689/thadon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 44289667, "answer_count": 1, "score": 0, "last_activity_date": 1496246836, "creation_date": 1496205391, "last_edit_date": 1496245589, "question_id": 44275744, "link": "https://stackoverflow.com/questions/44275744/action-class-class-eval-method-not-working-with-execute-resources-environment-p", "title": "action_class.class_eval method not working with execute resource&#39;s environment property", "body": "<p>I have an interesting problem where I refactored a recipe by creating a Chef resource to handle some tasks I may need in other recipes.  For instance, I've created the following action:</p>\n\n<pre><code>resource_name :my_command\n\naction :run do\n  execute \"Execute my command\" do\n    environment ({\"SETTINGS_FOLDER\" =&gt; node['settings']['folder']})\n    command \"#{command_exe} -some -params\"\n  end\nend\n\naction_class.class_eval do\n  def command_exe\n    \"#{node['command']['folder']}\\\\bin\\\\command.exe\"\n  end\nend\n</code></pre>\n\n<p>When I call <code>my_command</code> from a recipe it works as expected. However I have several other <code>actions</code> that this resource will implement that'll all use the same <code>environment</code>. So what I did was refactor the resource to look like this:</p>\n\n<pre><code>resource_name :command\n\naction :run do\n  execute \"Execute my command\" do\n    environment env\n    command \"#{command_exe} -some -params\"\n  end\nend\n\naction_class.class_eval do\n  def command_exe\n    \"#{node['command']['folder']}\\\\bin\\\\command.exe\"\n  end\n\n  def env\n    {\"SETTINGS_FOLDER\" =&gt; node['settings']['folder']}\n  end\nend\n</code></pre>\n\n<p>What happens now is, once <code>chef-client</code> executes the <code>my_command</code> resource it appears as though the <code>SETTINGS_FOLDER</code> environment variable on the machine winds up looking like this:</p>\n\n<p><code>SETTINGS_FOLDER = \"\"C:\\my\\settings\\folder\"\"</code></p>\n\n<p>Notice the doubled double-quotes?  I'm not sure why this is happening, but it makes my <code>command.exe</code> very angry :(</p>\n\n<p>The <code>['settings']['folder']</code> attribute is defined in the cookbook's <code>attributes/default.rb</code>like so:</p>\n\n<pre><code>default['settings']['folder'] = 'C:\\\\my\\\\settings\\\\folder'\n</code></pre>\n\n<p>My node is running chef-client <code>13.0.118</code></p>\n\n<p><strong>EDIT</strong> I think the doubled double-quotes was a red herring. I think the logger just represented the hash in that way.  My new thought is that perhaps the <code>env</code> method is not being evaluated before being passed to the <code>environment</code>, but rather the function reference itself is being passed.  Bear with me, Ruby isn't my first language...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496203815, "post_id": 44275417, "comment_id": 75558244, "body": "How do you set the <code>property_id </code> in the <code>hidden_field</code>, can you check isn&#39;t <code>nil</code>?"}, {"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496204179, "post_id": 44275417, "comment_id": 75558335, "body": "Honestly, I&#39;m not entirely sure how to check that in this situation, I&#39;m still kind of new to rails, I&#39;d assume it would involve a <code>.nil?</code> call somewhere but I&#39;m not 100% sure where I&#39;d place that in this process. However, I thought I was setting that by passing the local variable into the render call, so maybe thats what I&#39;m missing?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496204285, "post_id": 44275417, "comment_id": 75558357, "body": "Just go by parts, check the form and what&#39;s the value on the hidden input inspecting the source code."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496204301, "post_id": 44275417, "comment_id": 75558362, "body": "you can clearly see here <code>Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;eaj9K...==&quot;, &quot;deed&quot;=&gt;{&quot;property_id&quot;=&gt;&quot;&quot;,...</code> it is nil, you need to set it in <code>new</code>. please share your routes <code>rake routes</code>"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496204437, "post_id": 44275417, "comment_id": 75558392, "body": "try <code>&lt;%= f.hidden_field :property_id, value: @deeds.property_id %&gt;</code>"}, {"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496204660, "post_id": 44275417, "comment_id": 75558450, "body": "Yeah I knew <code>&quot;deed&quot;=&gt;{&quot;property_id&quot;=&gt;&quot;&quot;,...</code> was empty but I thought @Sebasti&#225;nPalma meant something else, my fault. Post edited with routes. and will try . @Farhans suggestion now."}, {"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 0, "creation_date": 1496204922, "post_id": 44275417, "comment_id": 75558520, "body": "Using <code>&lt;%= f.hidden_field :property_id, value: @deeds.property_id %&gt;</code>, <code>&quot;deed&quot;=&gt;{&quot;property_id&quot;=&gt;&quot;&quot;...</code> is still nil."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496205074, "post_id": 44275417, "comment_id": 75558576, "body": "check answer below"}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 0, "creation_date": 1496205634, "post_id": 44275645, "comment_id": 75558761, "body": "Thank you for the insight! Once I passed <code>value: params[:property_id]</code> in with the addition of the <code>@properties = ...</code> line below, everything worked!"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 1, "creation_date": 1496205809, "post_id": 44275645, "comment_id": 75558815, "body": "@cdouble.bhuck well, you have to do either and not both...if you use <code>params[:propery_id]</code> you don&#39;t need to pass <code>@properties</code> locally.."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1496205825, "post_id": 44275645, "comment_id": 75558821, "body": "Glad to help, just you could skip creating the variable in the controller to send it to the view, because is the same value &quot;<code>params[:property_id]</code>&quot; you receive in the <code>new</code> view."}, {"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 0, "creation_date": 1496206265, "post_id": 44275645, "comment_id": 75558972, "body": "Ahhh, I see, it does work without the <code>@properties</code> variable in the controller. However it doesn&#39;t work with <i>only</i> the <code>@properties</code> in controller if I do not pass the <code>params[:property_id]</code> through. I have other things rendering on the <code>new modal</code> page that pull from the <code>:property_id</code> that work now, so is it okay to have both?"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 1, "creation_date": 1496206811, "post_id": 44275645, "comment_id": 75559178, "body": "If you want to use <code>@properties</code> then, this should be your view for locals <code>locals: { property_id: @properties.id }</code> and <code>f.hidden_field :property_id, value: property_id</code>, However, I suggest to use it without <code>@properties</code> if you are not using it anywhere else, it will save you a db fetch else checkout updated answer"}, {"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 0, "creation_date": 1496207827, "post_id": 44275645, "comment_id": 75559576, "body": "Cool, it does work as you suggested. The only thing is in that same modal I have <code>For &lt;%= property_id.address1 %&gt;, &lt;%= property_id.address2 %&gt;, &lt;%= property_id.city %&gt;, &lt;%= property_id.state %&gt;</code> so that way it displays the address for parent <code>property</code> of the <code>deed</code>, which doesn&#39;t work without the <code>@properties</code> in the deeds controller, and I don&#39;t know how else I would display that. But thanks for all your help!"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1496205241, "last_edit_date": 1496205241, "creation_date": 1496204850, "answer_id": 44275645, "question_id": 44275417, "link": "https://stackoverflow.com/questions/44275417/creating-new-object-for-associated-model/44275645#44275645", "title": "Creating new object for associated model", "body": "<p>As the error says <code>Property must exist</code>, so, your intention is to print the <code>property_id</code> for a new record, but for some reason that's not happening.</p>\n\n<p>As that value goes from your <code>form_for</code> directly to create a new \"deed\", then in must be setted on it, you do it, but you don't check if it's printing something or not, and it get's you a <code>nil</code> value that's not allowed because of the relationship between Deeds and Properties.</p>\n\n<p>When you send the form, you can see the value is empty:</p>\n\n<pre><code>\"deed\"=&gt;{\"property_id\"=&gt;\"\"}\n</code></pre>\n\n<p>How do you define which <code>property_id</code> must a new record have? You can create a variable within your <code>new</code> method and set an object to print within your <code>form_for</code>, it'll give you a value to proceed with a new record.</p>\n\n<p>When you make a request to the new method you pass through the params the value for <code>property_id</code>:</p>\n\n<pre><code>Processing by DeedsController#new as JS\nParameters: {\"property_id\"=&gt;\"99\"}\n</code></pre>\n\n<p>So I suppose you could use it instead setting a local variable which hasn't been initialized, maybe you can try with:</p>\n\n<pre><code>&lt;%= f.hidden_field :property_id, value: params[:property_id] %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 0, "creation_date": 1496205511, "post_id": 44275682, "comment_id": 75558720, "body": "Awesome! The <code>@properties = Property.find_by_id(params[:property_id])</code> was definitely the one I needed in the <code>new</code> action. Once added in combination with Sebastian&#39;s answer above, this worked perfectly!"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "edited": false, "score": 0, "creation_date": 1496205615, "post_id": 44275682, "comment_id": 75558757, "body": "glad it worked, please accept the answer since it helped.. :)"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 2, "last_activity_date": 1496207055, "last_edit_date": 1496207055, "creation_date": 1496205051, "answer_id": 44275682, "question_id": 44275417, "link": "https://stackoverflow.com/questions/44275417/creating-new-object-for-associated-model/44275682#44275682", "title": "Creating new object for associated model", "body": "<p>This should be you <code>new</code> action</p>\n\n<pre><code>def new\n  @deeds = Deed.new\n  @deeds.build_property\n  @properties = Property.find_by_id(params[:property_id]) # add this line\n  respond_to do |format|\n    format.html { render 'new'}\n    format.js\n  end\nend\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>If you are not using the <code>associated</code> property anywhere else, you don't need to pass the <code>locals</code> and I don't suggest <code>hidden_field</code> as it can be easily modified, alternately you can do..</p>\n\n<pre><code>def new\n  @deeds = Property.find_by_id(params[:property_id]).deeds.new # add this line\n  @deeds.build_property\n  respond_to do |format|\n    format.html { render 'new'}\n    format.js\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 7286108, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9744811ae6434a0983dbaa76e2921a2a?s=128&d=identicon&r=PG", "display_name": "cdouble.bhuck", "link": "https://stackoverflow.com/users/7286108/cdouble-bhuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 44275682, "answer_count": 2, "score": 1, "last_activity_date": 1496207055, "creation_date": 1496203371, "last_edit_date": 1496204609, "question_id": 44275417, "link": "https://stackoverflow.com/questions/44275417/creating-new-object-for-associated-model", "title": "Creating new object for associated model", "body": "<p>So I've been at this a while and have tried a bunch of different methods. Essentially I have an over-arching <code>property</code> model and an associated <code>deed</code> model. From the <code>properties#show view</code> I have it displaying all associated <code>deeds</code>. I have a button in my <code>property view</code> that displays a modal (using AJAX) to create a <code>deed</code> associated to said model. All the steps work (even 'edit' and 'update' using AJAX from the properties view) except when trying to save the <code>new deed</code> I get an error message: </p>\n\n<pre><code>This form contains 1 error. Property must exist\n</code></pre>\n\n<p>I've tried passing the <code>@properties.id</code> through in different ways and I just can't seem to get it. I'll list all the relevant info I have and if more is needed just let me know.</p>\n\n<p><strong>Property Model</strong></p>\n\n<pre><code>class Property &lt; ApplicationRecord\n  has_many :deeds, dependent: :destroy\n  accepts_nested_attributes_for :deeds\nend\n</code></pre>\n\n<p><strong>Deeds Model</strong></p>\n\n<pre><code>class Deed &lt; ApplicationRecord \n  belongs_to :property\n  accepts_nested_attributes_for :property\nend\n</code></pre>\n\n<p><strong>Deeds Controller</strong> (Included edit and update actions)</p>\n\n<pre><code>def new\n  @deeds = Deed.new\n  @deeds.build_property\n  respond_to do |format|\n    format.html { render 'new'}\n    format.js\n  end\nend\n\ndef create\n  @properties = Property.find(params[:deed][:property_id])\n  @deeds = @properties.deeds.new(deed_params)\n  if @deeds.save\n    flash[:success] = \"Deed created successfully!\"\n    respond_to do |format|\n      format.html { redirect_to deeds_path }\n      format.js\n    end\n  else\n    render 'new'\n  end\nend\n\ndef edit\n  @deeds = Deed.find(params[:id])\n  respond_to do |format|\n    format.html { @deeds.save }\n    format.js\n  end\nend\n\ndef update\n  @deeds = Deed.find(params[:id])\n  @properties = Property.find(@deeds.property.id)\n  @deeds.update_attributes(deed_params)\n  respond_to do |format|\n    format.html { redirect_to deeds_path }\n    format.js\n  end\nend\n\nprivate\n\n def deed_params\n   params.require(:deed).permit(:property_id, :deed_number, :deed_context, :consideration, :recorded_date, :grantor, :grantee, :trustee)\n end\n</code></pre>\n\n<p><strong><code>new deeds</code> link from <code>properties#show</code> view</strong></p>\n\n<pre><code>&lt;%= link_to fa_icon(\"plus\", text: \"Add Deed\"), new_property_deed_path(@properties.id), remote: true, class: \"btn btn-primary btn-large btn-ouline pull-right\", locals: { property_id: @properties } %&gt;\n</code></pre>\n\n<p><strong><code>new.js.erb</code></strong></p>\n\n<pre><code>$('#deeds-modal').modal(\"show\");\n$('#deeds-modal').html('&lt;%= j render partial: \"deeds/deeds_modal\", locals: { property_id: @properties } %&gt;');\n</code></pre>\n\n<p><strong><code>_deeds_modal.html.erb partial</code> Form</strong></p>\n\n<pre><code>&lt;div class=\"modal-body\"&gt;\n  &lt;%= bootstrap_form_for(@deeds, layout: :horizontal, remote: true) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n\n      &lt;%= f.hidden_field :property_id, value: property_id %&gt;\n\n      &lt;%= f.text_field :deed_number, class: 'form-control' %&gt;\n\n      &lt;%= f.text_field :deed_context, class: 'form-control' %&gt;\n\n      &lt;%= f.text_field :consideration, class: 'form-control' %&gt;\n\n      &lt;%= f.text_field :recorded_date,     class: 'form-control' %&gt;\n\n      &lt;%= f.text_field :grantor,    class: 'form-control' %&gt;\n\n      &lt;%= f.text_field :grantee,  class: 'form-control' %&gt;\n\n      &lt;%= f.text_field :trustee,  class: 'form-control' %&gt;\n\n      &lt;%= f.form_group do %&gt;\n          &lt;%= f.submit \"Save\", class: \"btn btn-primary\" %&gt;\n      &lt;% end %&gt;\n\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>server response upon <code>deeds_modal form</code> <code>POST</code></strong></p>\n\n<pre><code>Started GET \"/properties/99/deeds/new\" for 127.0.0.1 at 2017-05-30 \n23:24:48 -0400\nProcessing by DeedsController#new as JS\n  Parameters: {\"property_id\"=&gt;\"99\"}\n  Rendering deeds/new.js.erb\n  Rendered shared/_error_messages.html.erb (0.4ms)\n  Rendered deeds/_deeds_modal.html.erb (5.6ms)\n  Rendered deeds/new.js.erb (7.3ms)\nCompleted 200 OK in 14ms (Views: 10.6ms | ActiveRecord: 0.0ms)\n\n\nStarted POST \"/deeds\" for 127.0.0.1 at 2017-05-30 23:24:55 -0400\nProcessing by DeedsController#create as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"eaj9K...==\", \"deed\"=&gt;{\"property_id\"=&gt;\"\", \"deed_number\"=&gt;\"69696969\", \"deed_context\"=&gt;\"Bagel slaps\", \"consideration\"=&gt;\"Considered\", \"recorded_date\"=&gt;\"2017-05-31\", \"grantor\"=&gt;\"\", \"grantee\"=&gt;\"NipLips\", \"trustee\"=&gt;\"\"}, \"commit\"=&gt;\"Save\"}\n   (0.1ms)  BEGIN\n   (0.1ms)  ROLLBACK\n  Rendering deeds/new.js.erb\n  Rendered shared/_error_messages.html.erb (0.7ms)\n  Rendered deeds/_deeds_modal.html.erb (12.1ms)\n  Rendered deeds/new.js.erb (20.4ms)\nCompleted 200 OK in 32ms (Views: 30.6ms | ActiveRecord: 0.2ms)\n</code></pre>\n\n<p>So as you can see I've tried to pass through a local variable from the <code>new link</code> -> <code>new.js.erb</code> -> <code>deeds modal form</code> but I can't seem to pull the <code>property_id</code> into the <code>new deeds object</code>.</p>\n\n<p>Is this even the correct approach for what I'm trying to do or am I just missing something? Hope this wasn't too long of a read and that I provided enough info... lol.</p>\n\n<p>*Upon writing this post I clicked through some of the 'similar questions' on SO, which is where I got the <code>@properties = Property.find(params[:deed][:property_id])</code> line from but I still get <code>ActiveRecord::RecordNotFound (Couldn't find Property with 'id'=):</code> upon submission. Also, thank you to anyone who takes the time to read this.</p>\n\n<p><strong><code>rails routes</code> Update (only included relevant routes for brevity)</strong></p>\n\n<pre><code>deeds GET    /deeds(.:format)                                      deeds#index\n                   POST   /deeds(.:format)                                      deeds#create\n          new_deed GET    /deeds/new(.:format)                                  deeds#new\n         edit_deed GET    /deeds/:id/edit(.:format)                             deeds#edit\n              deed GET    /deeds/:id(.:format)                                  deeds#show\n                   PATCH  /deeds/:id(.:format)                                  deeds#update\n                   PUT    /deeds/:id(.:format)                                  deeds#update\n                   DELETE /deeds/:id(.:format)                                  deeds#destroy\n...\nproperty_deeds GET    /properties/:property_id/deeds(.:format)              deeds#index\n                   POST   /properties/:property_id/deeds(.:format)              deeds#create\n new_property_deed GET    /properties/:property_id/deeds/new(.:format)          deeds#new\nedit_property_deed GET    /properties/:property_id/deeds/:id/edit(.:format)     deeds#edit\n     property_deed GET    /properties/:property_id/deeds/:id(.:format)          deeds#show\n                   PATCH  /properties/:property_id/deeds/:id(.:format)          deeds#update\n                   PUT    /properties/:property_id/deeds/:id(.:format)          deeds#update\n                   DELETE /properties/:property_id/deeds/:id(.:format)          deeds#destroy\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma"], "comments": [{"owner": {"reputation": 365, "user_id": 5339089, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xynzpKdp1Mw/AAAAAAAAAAI/AAAAAAAAABA/sFBDQdwNN6Q/photo.jpg?sz=128", "display_name": "Rifatul Islam Chayon", "link": "https://stackoverflow.com/users/5339089/rifatul-islam-chayon"}, "edited": false, "score": 0, "creation_date": 1496208296, "post_id": 44274294, "comment_id": 75559760, "body": "have you tried installing an older version? Try <code>3.3.0</code> or <code>3.5.0</code> ."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496220001, "post_id": 44274294, "comment_id": 75566391, "body": "Have you tried <a href=\"https://github.com/puma/puma/issues/1181\" rel=\"nofollow noreferrer\">googling the error</a>? Does installing a <i>newer</i> version (<code>&gt;= 3.8.2</code>) work?"}, {"owner": {"reputation": 2055, "user_id": 120191, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6f8ab061502145dc35168e1b8735e755?s=128&d=identicon&r=PG", "display_name": "Huey", "link": "https://stackoverflow.com/users/120191/huey"}, "edited": false, "score": 0, "creation_date": 1511972696, "post_id": 44274294, "comment_id": 82072182, "body": "Did you ever figure this out? It seems like you can just try modifying your Gemfile to use a newer version of puma."}], "answers": [{"tags": [], "owner": {"reputation": 1982, "user_id": 1081248, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/cd6c70e8b8153eb2cbaec373628ef394?s=128&d=identicon&r=PG", "display_name": "Arihant Godha", "link": "https://stackoverflow.com/users/1081248/arihant-godha"}, "is_accepted": false, "score": 3, "last_activity_date": 1542958414, "creation_date": 1542958414, "answer_id": 53442388, "question_id": 44274294, "link": "https://stackoverflow.com/questions/44274294/ruby-install-fails-for-learn-enough-setup-puma-gem-install-errors-mac-sierra/53442388#53442388", "title": "Ruby install fails for Learn Enough Setup - Puma gem install errors, Mac Sierra", "body": "<p>Try running an older version and try the below commands:</p>\n\n<p><code>gem install puma -v '3.3.0' -- --with-opt-dir=/usr/local/opt/openssl</code></p>\n\n<p>once done then try running bundle install.</p>\n\n<p>You may also consider checking if you have OpenSSL installed or not.</p>\n"}], "owner": {"reputation": 51, "user_id": 8089294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQlT9.png?s=128&g=1", "display_name": "gitmau5", "link": "https://stackoverflow.com/users/8089294/gitmau5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 748, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1542958414, "creation_date": 1496194584, "last_edit_date": 1496195447, "question_id": 44274294, "link": "https://stackoverflow.com/questions/44274294/ruby-install-fails-for-learn-enough-setup-puma-gem-install-errors-mac-sierra", "title": "Ruby install fails for Learn Enough Setup - Puma gem install errors, Mac Sierra", "body": "<p>I ran the gem install puma and it failed with these errors.</p>\n\n<p>I am trying to get Ruby setup for the Learn Enough Ruby Tutorial.</p>\n\n<pre><code>[developer]$gem install puma -v '3.4.0'\nBuilding native extensions.  This could take a while...\nERROR:  Error installing puma:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0/ext/puma_http11\n/Users/Jim/.rvm/rubies/ruby-2.4.0/bin/ruby -r ./siteconf20170530-50736-wm8q2m.rb extconf.rb\nchecking for BIO_read() in -lcrypto... yes\nchecking for SSL_CTX_new() in -lssl... yes\nchecking for openssl/bio.h... yes\ncreating Makefile\n\ncurrent directory: /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0/ext/puma_http11\nmake \"DESTDIR=\" clean\n\ncurrent directory: /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0/ext/puma_http11\nmake \"DESTDIR=\"\ncompiling http11_parser.c\next/http11/http11_parser.rl:111:17: warning: comparison of integers of different signs: 'long' and 'unsigned long' [-Wsign-compare]\n  assert(pe - p == len - off &amp;&amp; \"pointers aren't same distance\");\n         ~~~~~~ ^  ~~~~~~~~~\n/usr/include/assert.h:93:25: note: expanded from macro 'assert'\n    (__builtin_expect(!(e), 0) ? __assert_rtn(__func__, __FILE__, __LINE__, #e) : (void)0)\n                        ^\next/http11/http11_parser.c:43:18: warning: unused variable 'puma_parser_en_main' [-Wunused-const-variable]\nstatic const int puma_parser_en_main = 1;\n                 ^\n2 warnings generated.\ncompiling io_buffer.c\ncompiling mini_ssl.c\nmini_ssl.c:90:5: error: incomplete definition of type 'struct dh_st'\n  dh-&gt;p = BN_bin2bn(dh1024_p, sizeof(dh1024_p), NULL);\n  ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:91:5: error: incomplete definition of type 'struct dh_st'\n  dh-&gt;g = BN_bin2bn(dh1024_g, sizeof(dh1024_g), NULL);\n  ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:93:10: error: incomplete definition of type 'struct dh_st'\n  if ((dh-&gt;p == NULL) || (dh-&gt;g == NULL)) {\n       ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:93:29: error: incomplete definition of type 'struct dh_st'\n  if ((dh-&gt;p == NULL) || (dh-&gt;g == NULL)) {\n                          ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:192:27: warning: 'DTLSv1_method' is deprecated [-Wdeprecated-declarations]\n  conn-&gt;ctx = SSL_CTX_new(DTLSv1_method());\n                          ^\n/usr/local/opt/openssl@1.1/include/openssl/ssl.h:1630:45: note: 'DTLSv1_method' has been explicitly marked deprecated here\nDEPRECATEDIN_1_1_0(__owur const SSL_METHOD *DTLSv1_method(void)) /* DTLSv1.0 */\n                                            ^\nmini_ssl.c:228:20: warning: implicit conversion loses integer precision: 'long' to 'int' [-Wshorten-64-to-32]\n  int verify_err = SSL_get_verify_result(ssl);\n      ~~~~~~~~~~   ^~~~~~~~~~~~~~~~~~~~~~~~~~\nmini_ssl.c:241:13: warning: implicit conversion loses integer precision: 'unsigned long' to 'int' [-Wshorten-64-to-32]\n      err = ERR_get_error();\n          ~ ^~~~~~~~~~~~~~~\n3 warnings and 4 errors generated.\nmake: *** [mini_ssl.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0 for inspection.\nResults logged to /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/extensions/x86_64-darwin-16/2.4.0/puma-3.4.0/gem_make.out\n[developer]$gem install puma -v '3.4.0'\nBuilding native extensions.  This could take a while...\nERROR:  Error installing puma:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0/ext/puma_http11\n/Users/Jim/.rvm/rubies/ruby-2.4.0/bin/ruby -r ./siteconf20170530-51101-sgcz5z.rb extconf.rb\nchecking for BIO_read() in -lcrypto... yes\nchecking for SSL_CTX_new() in -lssl... yes\nchecking for openssl/bio.h... yes\ncreating Makefile\n\ncurrent directory: /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0/ext/puma_http11\nmake \"DESTDIR=\" clean\n\ncurrent directory: /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0/ext/puma_http11\nmake \"DESTDIR=\"\ncompiling http11_parser.c\next/http11/http11_parser.rl:111:17: warning: comparison of integers of different signs: 'long' and 'unsigned long' [-Wsign-compare]\n  assert(pe - p == len - off &amp;&amp; \"pointers aren't same distance\");\n         ~~~~~~ ^  ~~~~~~~~~\n/usr/include/assert.h:93:25: note: expanded from macro 'assert'\n    (__builtin_expect(!(e), 0) ? __assert_rtn(__func__, __FILE__, __LINE__, #e) : (void)0)\n                        ^\next/http11/http11_parser.c:43:18: warning: unused variable 'puma_parser_en_main' [-Wunused-const-variable]\nstatic const int puma_parser_en_main = 1;\n                 ^\n2 warnings generated.\ncompiling io_buffer.c\ncompiling mini_ssl.c\nmini_ssl.c:90:5: error: incomplete definition of type 'struct dh_st'\n  dh-&gt;p = BN_bin2bn(dh1024_p, sizeof(dh1024_p), NULL);\n  ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:91:5: error: incomplete definition of type 'struct dh_st'\n  dh-&gt;g = BN_bin2bn(dh1024_g, sizeof(dh1024_g), NULL);\n  ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:93:10: error: incomplete definition of type 'struct dh_st'\n  if ((dh-&gt;p == NULL) || (dh-&gt;g == NULL)) {\n       ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:93:29: error: incomplete definition of type 'struct dh_st'\n  if ((dh-&gt;p == NULL) || (dh-&gt;g == NULL)) {\n                          ~~^\n/usr/local/opt/openssl@1.1/include/openssl/ossl_typ.h:104:16: note: forward declaration of 'struct dh_st'\ntypedef struct dh_st DH;\n               ^\nmini_ssl.c:192:27: warning: 'DTLSv1_method' is deprecated [-Wdeprecated-declarations]\n  conn-&gt;ctx = SSL_CTX_new(DTLSv1_method());\n                          ^\n/usr/local/opt/openssl@1.1/include/openssl/ssl.h:1630:45: note: 'DTLSv1_method' has been explicitly marked deprecated here\nDEPRECATEDIN_1_1_0(__owur const SSL_METHOD *DTLSv1_method(void)) /* DTLSv1.0 */\n                                            ^\nmini_ssl.c:228:20: warning: implicit conversion loses integer precision: 'long' to 'int' [-Wshorten-64-to-32]\n  int verify_err = SSL_get_verify_result(ssl);\n      ~~~~~~~~~~   ^~~~~~~~~~~~~~~~~~~~~~~~~~\nmini_ssl.c:241:13: warning: implicit conversion loses integer precision: 'unsigned long' to 'int' [-Wshorten-64-to-32]\n      err = ERR_get_error();\n          ~ ^~~~~~~~~~~~~~~\n3 warnings and 4 errors generated.\nmake: *** [mini_ssl.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/gems/puma-3.4.0 for inspection.\nResults logged to /Users/Jim/.rvm/gems/ruby-2.4.0@newgemset/extensions/x86_64-darwin-16/2.4.0/puma-3.4.0/gem_make.out\n</code></pre>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["ruby", "oop", "sinatra", "datamapper"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1496194000, "creation_date": 1496194000, "answer_id": 44274231, "question_id": 44274113, "link": "https://stackoverflow.com/questions/44274113/tracking-wins-losses-with-psql-datamapper/44274231#44274231", "title": "Tracking wins &amp; losses with PSQL/DataMapper", "body": "<p>One way to do it could be to add two integer columsn \"wins\" and \"losses\" to User, and make helper methods to increment:</p>\n\n<pre><code>property :wins, Integer, default: 0\nproperty :losses, Integer, default: 0\n\n# usage: user.increment(:wins) or user.increment(:losses)\ndef increment(type)\n  update({ type =&gt; (send(:type) + 1) })\nend\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 6831572, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d0bdcbb13d6f5b35393b736e4d030f44?s=128&d=identicon&r=PG&f=1", "display_name": "Zonet", "link": "https://stackoverflow.com/users/6831572/zonet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496350716, "creation_date": 1496192777, "last_edit_date": 1496350716, "question_id": 44274113, "link": "https://stackoverflow.com/questions/44274113/tracking-wins-losses-with-psql-datamapper", "title": "Tracking wins &amp; losses with PSQL/DataMapper", "body": "<p>I have a User class which allows people to register and play a game; I also have a Game class, which contains the logic of said game (RPS).</p>\n\n<p>When people register, their information is held in a psql database. The informations is obtained using params. It looks like this: </p>\n\n<pre><code>Class User\n\n  attr_reader :weapon\n\n  include DataMapper::Resource\n\n  property :id,      Serial\n  property :name,    String, required: true\n  property :email,   String, required: true, unique: true\n  property :password_digest, Text\n  attr_reader :password\n  attr_accessor :password_confirmation\n\n  validates_confirmation_of :password\n  validates_format_of :email, as: :email_address\n\n  has n, :games\n</code></pre>\n\n<p>The corresponding Game class, contains this DB logic:</p>\n\n<pre><code>class Game\n\n  include DataMapper::Resource\n\n  property :id,     Serial\n  property :win,    ?\n  property :lose,   ?\n\n  belongs_to :user\n</code></pre>\n\n<p>My issue is that I really don't know how to keep a record of how many games the user has won/lost. Do I need (or should I have separate classes for wins and losses? What key type should I use (serial/int)? All I want is for 'win' or 'lose' to increment by one each time the player...well, wins or loses.</p>\n\n<p>All help/knowledge shared is greatly appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["json", "ruby", "terminal", "apple-news"], "answers": [{"tags": [], "owner": {"reputation": 5117, "user_id": 1694526, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xBDVL.jpg?s=128&g=1", "display_name": "sketchyTech", "link": "https://stackoverflow.com/users/1694526/sketchytech"}, "is_accepted": false, "score": 0, "last_activity_date": 1499765840, "creation_date": 1499765840, "answer_id": 45030771, "question_id": 44274047, "link": "https://stackoverflow.com/questions/44274047/how-to-designate-article-directory-when-publishing-to-apple-news-using-terminal/45030771#45030771", "title": "How to designate Article Directory when publishing to Apple News using Terminal?", "body": "<p>Place the article along with any locally linked, i.e. bundle://, content in a folder then use this folder as the article directory.</p>\n"}], "owner": {"reputation": 365, "user_id": 7887014, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/0b4feab40cba0aabe5a9d7e817ace50b?s=128&d=identicon&r=PG&f=1", "display_name": "TCharb", "link": "https://stackoverflow.com/users/7887014/tcharb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565215074, "creation_date": 1496192333, "last_edit_date": 1565215074, "question_id": 44274047, "link": "https://stackoverflow.com/questions/44274047/how-to-designate-article-directory-when-publishing-to-apple-news-using-terminal", "title": "How to designate Article Directory when publishing to Apple News using Terminal?", "body": "<p>I have an article.json file (named as such) below that I want to connect to Apple News and test: </p>\n\n<pre><code>{\n\"version\": \"1.4\",\n\"identifier\": \"TestArticle\",\n\"title\": \"My First Article\",\n\"language\": \"en\",\n\"layout\": { \"columns\": 1},\n\"components\": [\n    {\n        \"role\": \"title\",\n        \"text\": \"My First Article\"\n    },\n    {\n        \"role\": \"body\",\n        \"text\": \"This is just over the minimum amount of JSON required to create a valid article in Apple News Format. If you were to delete the dictionary enclosing this text, you'd be there.\"\n    }\n],\n\"componentTextStyles\": {\n  \"fontName\": \"Lato\",\n  \"textColor\": \"#000\",\n  \"linkStyle\": {\n    \"highlight\": {\n      \"color\": \"#358fd4\"\n    }\n  }\n}\n</code></pre>\n\n<p>I downloaded XCode and the necessary Ruby gems, to enter relevant command lines. As specified in the documentation, my .papi file is formatted correctly as it fetched my channel information successfully. According to Apple's ReadMe, this is the command I have to enter to publish an article: </p>\n\n<pre><code>papi-client article publish &lt;Article Directory&gt;\n</code></pre>\n\n<p>The problem is, I'm not sure exactly what this article directory is, or how to locate it. As far as I knew, I would create something like the above \"article.json\" file and potentially use that as the directory. I've even tried using the file path for said file, with no success. What could be my next steps to get this off the ground? </p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 6589814, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/FzUlF.png?s=128&g=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/6589814/rubioli"}, "edited": false, "score": 0, "creation_date": 1496188479, "post_id": 44273602, "comment_id": 75554891, "body": "Thanks a bunch @Mahmoud. Appreciate your help :) If you find my question helpful for other, I would appreciate a thumbs-up :)"}], "tags": [], "owner": {"reputation": 628, "user_id": 4643970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwK4h.jpg?s=128&g=1", "display_name": "Mahmoud Sayed", "link": "https://stackoverflow.com/users/4643970/mahmoud-sayed"}, "is_accepted": true, "score": 1, "last_activity_date": 1496188108, "creation_date": 1496188108, "answer_id": 44273602, "question_id": 44273544, "link": "https://stackoverflow.com/questions/44273544/ruby-on-rails-check-if-user-have-added-any-domain-and-if-they-have-been-approv/44273602#44273602", "title": "Ruby on Rails - check if user have added any domain and if they have been approved", "body": "<p>you can do it as below</p>\n\n<pre><code>- if current_user.domains.approved_domains.blank?\n  %p Please add a domain to see all posts\n- else\n  - @posts.each do |post|\n  // each post\n</code></pre>\n\n<p>and add the scope <code>approved_domains</code> to Domain model as follow</p>\n\n<pre><code>scope :approved_domains, -&gt; { where(status: true) } \n</code></pre>\n"}], "owner": {"reputation": 667, "user_id": 6589814, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/FzUlF.png?s=128&g=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/6589814/rubioli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 44273602, "answer_count": 1, "score": 0, "last_activity_date": 1550990330, "creation_date": 1496187788, "last_edit_date": 1550990330, "question_id": 44273544, "link": "https://stackoverflow.com/questions/44273544/ruby-on-rails-check-if-user-have-added-any-domain-and-if-they-have-been-approv", "title": "Ruby on Rails - check if user have added any domain and if they have been approved", "body": "<p>In my application I have models <code>Post</code> &amp; <code>Domain</code>. My application works as, user have to submit a <code>domain</code> to be able to see all <code>posts</code> in <code>posts#index</code>.</p>\n\n<p>Currently I am checking if user has submitted <strong>any</strong> <code>domain</code> &amp; show them all <code>posts</code>. <em>I am doing it by:</em></p>\n\n<pre><code>- if current_user.domains.blank?\n  %p Please add a domain to see all posts\n- else\n  - @posts.each do |post|\n  // each post\n</code></pre>\n\n<p>I want to change how I am doing it currently. All submitted <code>domains</code> needs to be <strong>approved</strong> (<code>status: true</code>) first &amp; sometimes a user submit several domains. </p>\n\n<p>What I am want to achieve now is to check if neither of <code>domains</code> has been <code>approved/status: true</code>, before show them <code>posts</code>.</p>\n\n<p>So basically check if <code>current_user</code> has any <code>domain</code> and if so check it neither of <code>domains</code> has been <em>approved</em> (<code>status: true</code>) before show them <code>posts</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496189134, "post_id": 44273509, "comment_id": 75555041, "body": "Just to be clear, the <code>Employer</code> model has information about the user that only gets filled out if the user is an employer? The names make it sound like the <code>Employer</code> has information about the user&#39;s employer. Also, is it ever possible in your application for a user to have both an <code>employer</code> and a <code>userinfo</code>?"}, {"owner": {"reputation": 97, "user_id": 7903811, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bc9adb95661d3c26781a323c0367c7fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dinukaperera", "link": "https://stackoverflow.com/users/7903811/dinukaperera"}, "reply_to_user": {"reputation": 1607, "user_id": 7151673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257324e88d03e0fd01d7f09f3bd5a788?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7151673/max"}, "edited": false, "score": 0, "creation_date": 1496189405, "post_id": 44273509, "comment_id": 75555107, "body": "@Max Hey Max! Yes, to the first question.Employer model info gets filled out only if that person is an employer. No, it is not possible for a user to have both userinfo AND employer. The way it is setup, as soon as the user signs up, the program checks to see if either userinfo model or employer model is filled out. If neither is filled out, the user gets routed to a page where they have to select if they are an employer or a student(userinfo). Since they can&#39;t change after they choose, a user can only have employer OR userinfo."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496194410, "post_id": 44273509, "comment_id": 75556172, "body": "Could you use the <a href=\"https://github.com/plataformatec/devise#controller-filters-and-helpers\" rel=\"nofollow noreferrer\">authenticate_user!</a> helper provided by Devise?"}, {"owner": {"reputation": 97, "user_id": 7903811, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bc9adb95661d3c26781a323c0367c7fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dinukaperera", "link": "https://stackoverflow.com/users/7903811/dinukaperera"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496194684, "post_id": 44273509, "comment_id": 75556237, "body": "@Sebasti&#225;nPalma Hey brother! Since Employer and Userinfo model both belong to User, I wouldn&#39;t be able to figure out if the user is a student or an employer."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496195087, "post_id": 44273509, "comment_id": 75556324, "body": "What about using <a href=\"https://github.com/RolifyCommunity/rolify/wiki/Devise---CanCanCan---rolify-Tutorial\" rel=\"nofollow noreferrer\"><code>cancancan</code> and <code>devise</code></a>?"}, {"owner": {"reputation": 97, "user_id": 7903811, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bc9adb95661d3c26781a323c0367c7fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dinukaperera", "link": "https://stackoverflow.com/users/7903811/dinukaperera"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496196640, "post_id": 44273509, "comment_id": 75556618, "body": "@Sebasti&#225;nPalma That seems like a long fix, I used Rose&#39;s solution and it worked. I didn&#39;t use any controller code, instead of doing the logic in the controller, I did the logic part in the view."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7903811, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bc9adb95661d3c26781a323c0367c7fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dinukaperera", "link": "https://stackoverflow.com/users/7903811/dinukaperera"}, "edited": false, "score": 0, "creation_date": 1496193559, "post_id": 44273549, "comment_id": 75555990, "body": "Hey Riley, please check the last part of my question. I added it recently."}], "tags": [], "owner": {"reputation": 61, "user_id": 7927990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1425331290823651/picture?type=large", "display_name": "Riley Thompson", "link": "https://stackoverflow.com/users/7927990/riley-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1496187799, "creation_date": 1496187799, "answer_id": 44273549, "question_id": 44273509, "link": "https://stackoverflow.com/questions/44273509/how-to-let-users-from-certain-model-view-a-page-while-the-rest-is-restricted-in/44273549#44273549", "title": "How to let users from certain model view a page while the rest is restricted in rails app?", "body": "<p>Adding a role to your User model could solve this problem. I would suggest using rails' enum feature and adding either a employer/student role, and then writing a helper method in your application controller to check if your current user is an employer/student before displaying the page.</p>\n"}, {"tags": [], "owner": {"reputation": 340, "user_id": 226870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64081065685b992362f0bcb609138a20?s=128&d=identicon&r=PG", "display_name": "Rose", "link": "https://stackoverflow.com/users/226870/rose"}, "is_accepted": true, "score": 3, "last_activity_date": 1496194813, "creation_date": 1496194813, "answer_id": 44274316, "question_id": 44273509, "link": "https://stackoverflow.com/questions/44273509/how-to-let-users-from-certain-model-view-a-page-while-the-rest-is-restricted-in/44274316#44274316", "title": "How to let users from certain model view a page while the rest is restricted in rails app?", "body": "<p>So I'd do it in two parts. First for the model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n     ...\n\n     def user_type\n         return :user if self.userinfo.present?\n         return :employer if self.employer.present?\n         return :no_role\n     end\nend\n</code></pre>\n\n<p>Next for the controller:</p>\n\n<pre><code>def index\n     if current_user.user_type == :no_role\n          redirect_to select_role_path, notice: \"Please select your role before continuing\"\n          return\n     elsif current_user.user_type == :user\n          redirect_to some_safe_path, notice: \"You do not have permission to view this page\"\n          return\n     end\n\n     ... continue with the normal code here\nend\n</code></pre>\n\n<p>For a long term solution if you are having different roles consider looking into one of the role management gems like pundit or cancancan. For short term simple projects this solution will work.</p>\n"}], "owner": {"reputation": 97, "user_id": 7903811, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/bc9adb95661d3c26781a323c0367c7fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dinukaperera", "link": "https://stackoverflow.com/users/7903811/dinukaperera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 44274316, "answer_count": 2, "score": -1, "last_activity_date": 1496194813, "creation_date": 1496187561, "last_edit_date": 1496193538, "question_id": 44273509, "link": "https://stackoverflow.com/questions/44273509/how-to-let-users-from-certain-model-view-a-page-while-the-rest-is-restricted-in", "title": "How to let users from certain model view a page while the rest is restricted in rails app?", "body": "<p>I have a user model that uses devise for authentication. I also have a userinfo(students) model and an employer model. Both employer and userinfo sign up using the registration model. Then they choose \"Continue as employer or student\". </p>\n\n<ol>\n<li>If they continue as student, they will be asked to fill some info.\nThe info each student fills out will be shown to them in their user\nprofile page 'userinfo#show\". Info of all the students will be\ndisplayed in the \"userinfo#index\" page.</li>\n<li>Then if they continue as employer, they have to fill some different\ninfo that applies to them. Their info is only displayed in their\nprofile page \"employer#show\". </li>\n</ol>\n\n<p>If I want ONLY EMPLOYERS to see the \"userinfo#index\" page, how can I do that? That means, if you signed up as a student, you can only see your profile (userinfo#show) and will NOT be able to see \"userinfo#index\". Employers can see userinfo#index and userinfo#show. </p>\n\n<p>User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :userinfo\n  has_one :employer\n\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\nend\n</code></pre>\n\n<p>Userinfo model:</p>\n\n<pre><code>class Userinfo &lt; ActiveRecord::Base\n    belongs_to :user\nend\n\ndef info_complete?\n    name? &amp;&amp; email? &amp;&amp; college? &amp;&amp; gpa? &amp;&amp; major?\nend\n</code></pre>\n\n<p>Employer model:</p>\n\n<pre><code>class Employer &lt; ActiveRecord::Base\n    belongs_to :user\nend\n\ndef info_complete?\n    name? &amp;&amp; company? &amp;&amp; position? &amp;&amp; number? &amp;&amp; email?\nend\n</code></pre>\n\n<p>The migrations I have:</p>\n\n<ol>\n<li>devise_create_users.rb</li>\n<li>create_userinfos.rb</li>\n<li>add_user_id_to_userinfos.rb</li>\n<li>create_employers.rb</li>\n<li>add_user_id_to_employers.rb</li>\n</ol>\n\n<p>Even though it's not shown here, I have a unique function in each model to check if student info has been entered in the userinfo model and if employer info has been entered in the employer model. I have them there because when a user signs up, the program checks if either student information or employer information has been already entered, if so, they don't have to choose \"Employer or student\". Because they have already chosen. My question is, can I not use those two functions to check if they are an employer or a student? Like, if student info has been filled out, they are a student, so they wont be allowed to see the index page.I just don't know how to implement it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "rubygems"], "comments": [{"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1496207751, "post_id": 44273274, "comment_id": 75559545, "body": "Try this one, Define gem definition without giving versioning  <code>gem &#39;sqlite3&#39;</code> in you <code>Gemfile</code>. or with giving versioning try this one <code>gem &#39;sqlite3&#39;, &#39;1.3.12&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7789674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c002fa92a661ffd3bbef3d724e5a6ffa?s=128&d=identicon&r=PG&f=1", "display_name": "abdul muhaimen", "link": "https://stackoverflow.com/users/7789674/abdul-muhaimen"}, "edited": false, "score": 0, "creation_date": 1496269301, "post_id": 44273290, "comment_id": 75597375, "body": "It worked after using your edits and a bundle update. Thanks!"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 3, "user_id": 7789674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c002fa92a661ffd3bbef3d724e5a6ffa?s=128&d=identicon&r=PG&f=1", "display_name": "abdul muhaimen", "link": "https://stackoverflow.com/users/7789674/abdul-muhaimen"}, "edited": false, "score": 0, "creation_date": 1496269399, "post_id": 44273290, "comment_id": 75597413, "body": "@abdulmuhaimen Great! Please don&#39;t forget to accept the answer (by clicking the green tick). Good luck!"}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 1, "last_activity_date": 1496186892, "last_edit_date": 1496186892, "creation_date": 1496185873, "answer_id": 44273290, "question_id": 44273274, "link": "https://stackoverflow.com/questions/44273274/ruby-on-rails-bundle-install-not-working/44273290#44273290", "title": "Ruby on Rails Bundle Install Not working", "body": "<p>There are two typos/errors in the <code>group :development, :test</code> from your <code>Gemfile</code>:</p>\n\n<ol>\n<li><p>You are missing quotes (or double quotes) in your <code>sqlite3</code> gem version:</p>\n\n<pre><code>gem 'sqlite3' , 1.3.12\n               ^      ^ \n</code></pre></li>\n<li><p>There is a missing and trailing comma <code>,</code> in <code>gem 'byebug'</code></p>\n\n<pre><code>gem 'byebug', '9.0.0' platform: :mri,\n                     ^              ^\n</code></pre></li>\n</ol>\n\n<p>So <code>group :development, :test</code> should look like this:</p>\n\n<pre><code>group :development, :test do\n  gem 'sqlite3', '1.3.12'\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', '9.0.0', platform: :mri \nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7789674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c002fa92a661ffd3bbef3d724e5a6ffa?s=128&d=identicon&r=PG&f=1", "display_name": "abdul muhaimen", "link": "https://stackoverflow.com/users/7789674/abdul-muhaimen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1279, "favorite_count": 0, "accepted_answer_id": 44273290, "answer_count": 1, "score": 0, "last_activity_date": 1496187459, "creation_date": 1496185774, "last_edit_date": 1496187459, "question_id": 44273274, "link": "https://stackoverflow.com/questions/44273274/ruby-on-rails-bundle-install-not-working", "title": "Ruby on Rails Bundle Install Not working", "body": "<p>So I am currently learning Ruby on Rails using Michael Hartl tutorial (really noob at the moment - really new to programming). I have tried to edit the gemfiles in the \"hello_app\" that I am making - as told to do so by Michael, however when I go back into Terminal to run the bundle install - I get the following rather than it installing: </p>\n\n<pre><code>Abduls-MacBook-Pro:hello_app Monahim$ bundle install\n\n[!] There was an error parsing `Gemfile`: unexpected fraction part after numeric literal -   gem 'sqlite3' , 1.3.12\n                 ^\n/Users/Monahim/railsmhartl/hello_app/Gemfile:40: syntax error, unexpected tIDENTIFIER, expecting keyword_end\ngem 'byebug', '9.0.0' platform: :mri, end\n                            ^\n/Users/Monahim/railsmhartl/hello_app/Gemfile:55: syntax error, unexpected end-of-input, expecting keyword_end. Bundler cannot continue.\n\n #  from /Users/Monahim/railsmhartl/hello_app/Gemfile:38\n #  -------------------------------------------\n #  group :development, :test do\n &gt;    gem 'sqlite3' , 1.3.12\n#    # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n #  -------------------------------------------\nAbduls-MacBook-Pro:hello_app Monahim$ \n</code></pre>\n\n<p>Can someone please let me know what is going on? And how do I fix it? Here's what I have in my Atom Text Editor: </p>\n\n<pre><code>source 'http://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"ht//githublinkhere /#{repo_name}.git\"\nend\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.0.1'\n# Use sqlite3 as the database for Active Record\n\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.4.0'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0.6'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 3.0.0'\n# See /githubrailsreadmelinkhere for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2.1'\ngem 'jquery-rails', '4.1.1'\n# Turbolinks makes navigating your web application faster. Read more:          /githubturbolinkhere\ngem 'turbolinks', '~&gt; 5.0.1'\n# Build JSON APIs with ease. Read more: linktojbuilder\ngem 'jbuilder', '~&gt; 2.4.1'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  gem 'sqlite3' , 1.3.12\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', '9.0.0' platform: :mri, \nend\n# Adds support for Capybara system testing and selenium driver\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt;   anywhere in the code.\n  gem 'web-console', '&gt;= 3.1.1'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.0.8'\n  # Spring speeds up development by keeping your application running in the background. Read more: /github.com/railsspringlinkhere\n  gem 'spring' , '1.7.2.'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>Thank you very much for going through this.Please do explain what os going on so I learn as well as correcting the errors. Obviously you can tell I am really, really new to this game but am eager to learn! </p>\n\n<p>Please advise,\nThanks! </p>\n"}, {"tags": ["arrays", "ruby", "time-complexity"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1496185986, "post_id": 44273190, "comment_id": 75554279, "body": "Using a Set will probably be faster, but the way to tell for sure is to write some test code, then use Benchmark, Fruity, or Benchmark.ips to tell you. I&#39;d use the command-line and <code>sort -u | wc -l</code> though, as it&#39;ll run circles around Ruby for a task like that. In general your question is premature. You need to research, try, then when you run into a problem write a specific question about that particular problem. &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496194233, "post_id": 44273190, "comment_id": 75556133, "body": "If you would also like to know how many times each word appears, you could use a hash with elements <code>word =&gt; &lt;number of times word appears&gt;</code>. The number of unique words is simply the number of keys in the hash. As sets are implemented with hashes, I would expect the use of a set or a hash would be similar in terms of efficiency."}, {"owner": {"reputation": 2484, "user_id": 2097284, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Md1tZ.jpg?s=128&g=1", "display_name": "Camille Goudeseune", "link": "https://stackoverflow.com/users/2097284/camille-goudeseune"}, "edited": false, "score": 0, "creation_date": 1496242935, "post_id": 44273190, "comment_id": 75583281, "body": "Tin Man is right:  doing as much of the work as possible with shell commands is faster.  I&#39;m still waiting for my sysadmin to install gnu parallel, but a rough benchmark suggests that this will be a dozen times faster."}], "answers": [{"tags": [], "owner": {"reputation": 2484, "user_id": 2097284, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Md1tZ.jpg?s=128&g=1", "display_name": "Camille Goudeseune", "link": "https://stackoverflow.com/users/2097284/camille-goudeseune"}, "is_accepted": true, "score": 1, "last_activity_date": 1496243773, "creation_date": 1496243773, "answer_id": 44288592, "question_id": 44273190, "link": "https://stackoverflow.com/questions/44273190/ruby-accumulate-into-a-set-or-into-an-array-and-sort-afterwards/44288592#44288592", "title": "Ruby: accumulate into a Set, or into an Array and sort afterwards?", "body": "<p>Ruby is the wrong tool.  Much faster is <code>tr \" \" \"\\n\" &lt; *.txt | sort -u</code>, possibly elaborated with GNU <code>parallel</code> if there's some <code>sed</code> to sprinkle in.  If further processing needs Ruby, do only that part in Ruby.</p>\n"}], "owner": {"reputation": 2484, "user_id": 2097284, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Md1tZ.jpg?s=128&g=1", "display_name": "Camille Goudeseune", "link": "https://stackoverflow.com/users/2097284/camille-goudeseune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 44288592, "answer_count": 1, "score": 1, "last_activity_date": 1496245329, "creation_date": 1496185186, "last_edit_date": 1496245329, "question_id": 44273190, "link": "https://stackoverflow.com/questions/44273190/ruby-accumulate-into-a-set-or-into-an-array-and-sort-afterwards", "title": "Ruby: accumulate into a Set, or into an Array and sort afterwards?", "body": "<p>I have a few hundred text files totaling a few million words.  I want the list of unique words, about a hundred thousand.  Everything fits in memory.</p>\n\n<p><strong>Edit</strong>: I want the actual list, not just how long the list is.</p>\n\n<p>One way is to accumulate the words in a <code>Set</code>.</p>\n\n<p>Another is to accumulate in an <code>Array</code>, and only at the end use <code>.sort.uniq</code>.</p>\n\n<p>What considerations would favor one over another?</p>\n"}, {"tags": ["ruby", "oauth", "sinatra"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496184347, "post_id": 44272480, "comment_id": 75553887, "body": "Please indent your code per the Ruby coding guidelines. It helps us help you. You have lines that wrapped and are syntax errors. I&#39;d recommend fixing those as they&#39;re cause for closing questions. &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and the linked pages help."}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 7081280, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e14554db88ef8e9807cfdb73fbbc222?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Mckenzie", "link": "https://stackoverflow.com/users/7081280/joseph-mckenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1496756796, "creation_date": 1496756796, "answer_id": 44391808, "question_id": 44272480, "link": "https://stackoverflow.com/questions/44272480/how-to-have-my-google-oauth-only-try-and-authorize-the-app-on-a-certain-route/44391808#44391808", "title": "How to have my google oauth only try and authorize the app on a certain route", "body": "<p>Figured it out, meant to post way earlier but had an alert on this post so i figured id update to what we did to ake it work.</p>\n\n<pre><code> get '/googleauth' do\n   salesforce_username = params[:salesforce_username] || ''\n   unless session.has_key?(:credentials)\n   redirect to('/oauth2callback')\n end\n   client_opts = JSON.parse(session[:credentials])\n   auth_client = Signet::OAuth2::Client.new(client_opts)\n   redirect to('/googleadx')\n end\n\n get '/oauth2callback' do\n  client_secrets = Google::APIClient::ClientSecrets.load\n  auth_client = client_secrets.to_authorization\n  auth_client.update!(\n  :scope =&gt; 'https://www.googleapis.com/auth/adexchange.seller.readonly',\n:redirect_uri =&gt; url('/oauth2callback'))\n if request['code'] == nil\n  auth_uri = auth_client.authorization_uri.to_s\n  redirect to(auth_uri)\n else\n  auth_client.code = request['code']\n  auth_client.fetch_access_token!\n  session[:access_token] = auth_client.access_token\n  session[:refresh_token] = auth_client.refresh_token\n  session[:expires_in] = auth_client.expires_in\n  session[:issued_at] = auth_client.issued_at\n  auth_client.client_secret = nil\n  session[:credentials] = auth_client.to_json\n  redirect to('/googleadx')\nend\nend\n\nget '/googleadx' do\n\n# configure()\n\nif params[:username]\n    successmessage = params[:username] + \"'s credentials added successfully.\"\nelse\n    message = ''\nend\n\nsalesforce_username = session[:salesforce_username] || ''\naccess_token = session[:access_token]\nrefresh_token = session[:refresh_token]\ngoogleDollarLimit = ''\n\nerb :googleadx, locals: {message: message, successmessage: successmessage, salesforce_username: salesforce_username, access_token: access_token, refresh_token: refresh_token, googleDollarLimit: googleDollarLimit}\nend\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 7081280, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e14554db88ef8e9807cfdb73fbbc222?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Mckenzie", "link": "https://stackoverflow.com/users/7081280/joseph-mckenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 44391808, "answer_count": 1, "score": -1, "last_activity_date": 1496756796, "creation_date": 1496180737, "question_id": 44272480, "link": "https://stackoverflow.com/questions/44272480/how-to-have-my-google-oauth-only-try-and-authorize-the-app-on-a-certain-route", "title": "How to have my google oauth only try and authorize the app on a certain route", "body": "<p>I have a google Oauth that will make the user authorize when a user goes to my webpage, however I only want them to have to authorize the app so that I can get their access and refresh tokens when they go to certain  page to enter a google api information.Google is making them authorize no matter what route they are on any ideas on how to stop this.Ruby wont let me any of this in a route.</p>\n\n<pre><code>def user_credentials\n# Build a per-request oauth credential based on token stored in \nsession\n# which allows us to use a shared API client.\n@authorization ||= (\nauth = settings.authorization.dup\nauth.redirect_uri = to('/oauth2callback')\nauth.update_token!(session)\nauth\n)\nend\n\nconfigure do\n\n Google::Apis::ClientOptions.default.application_name = 'Get Login \n info for Google Ad Exchange'\n Google::Apis::ClientOptions.default.application_version = '1.0.0'\n\n client_secrets = Google::APIClient::ClientSecrets.load\n authorization = client_secrets.to_authorization\n authorization.scope = \n 'https://www.googleapis.com/auth/adexchange.seller.readonly'\n\n  set :authorization, authorization\nend\n\nbefore do\n# Ensure user has authorized the app\nunless user_credentials.access_token || request.path_info =~ \n/^\\/oauth2/\nredirect to('/oauth2authorize')\nend\nend\n\n\n after do\n # Serialize the access/refresh token to the session and credential \n store.\n# We could potentially need to pull back the client_id and \nclient_secret as well and add them to the dynamo database.\n\n#   session[:client_id] = user_credentials.client_id\n#   session[:client_secret] = user_credentials.client_secret\n    session[:access_token] = user_credentials.access_token\n    session[:refresh_token] = user_credentials.refresh_token\n    session[:expires_in] = user_credentials.expires_in\n    session[:issued_at] = user_credentials.issued_at\n\n  end\n\nget '/oauth2authorize' do\n # Request authorization\n redirect user_credentials.authorization_uri.to_s, 303\n end\n\nget '/oauth2callback' do\n # Exchange token\n user_credentials.code = params[:code] if params[:code]\n user_credentials.fetch_access_token!\n redirect to('/')\n\n  end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1496179932, "post_id": 44272197, "comment_id": 75552474, "body": "&quot;I&#39;ve imported the csv file into a hash&quot; Do you mean you&#39;ve imported the CSV file into an <i>array</i> of hashes? Otherwise you&#39;re going to need to be more specific about what format your data is in. Also, what do you mean by &quot;number of items that are over 60&quot;? Do you mean the number of rows have a value greater than 60 in a particular column? Please edit your question to include an example of the data you&#39;re working with and the desired output."}, {"owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1496180483, "post_id": 44272197, "comment_id": 75552679, "body": "Just edited it."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1496180569, "post_id": 44272197, "comment_id": 75552713, "body": "Your CSV file only has one row? Is it all numbers?"}, {"owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1496180723, "post_id": 44272197, "comment_id": 75552775, "body": "It&#39;s all numbers ,but it&#39;s like several pages long and I&#39;m just giving an example of what&#39;s in the csv file."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496180748, "post_id": 44272197, "comment_id": 75552784, "body": "Several pages... of <i>one line</i>? Or multiple lines?"}, {"owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "edited": false, "score": 0, "creation_date": 1496180873, "post_id": 44272197, "comment_id": 75552840, "body": "multiple lines with two items on each line. My enter key makes my computer blue screen so I couldn&#39;t make it look like the csv. It&#39;s several pages of numbers like that."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496180980, "post_id": 44272197, "comment_id": 75552894, "body": "OK... I&#39;ll edit your <i>example</i> above to actually look like your CSV file. It&#39;s not a very good example if it&#39;s in a different format."}, {"owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "edited": false, "score": 0, "creation_date": 1496181190, "post_id": 44272197, "comment_id": 75552970, "body": "Ok. Yeah sorry about that. I need to buy a new keyboard or something. I think its a short causing me to blue screen when I enter."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496181953, "post_id": 44272197, "comment_id": 75553192, "body": "Your question isn&#39;t asked well. Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We need to see what you <i>tried</i>, not just a general framework wrapping what you&#39;d try. See &quot;<a href=\"http://meta.stackoverflow.com/questions/261592\">How much research effort is expected of Stack Overflow users?</a>&quot; and &quot;<a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">Writing the perfect question</a>&quot;. Without that little evidence of effort it looks like you didn&#39;t try and want us to write it for you."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496183865, "post_id": 44272197, "comment_id": 75553763, "body": "You say you want <code>4</code> as a result, but the requirement is for values <i>over</i> 60. There are only three that are <code>&gt; 60</code>."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496182137, "post_id": 44272621, "comment_id": 75553240, "body": "Because CSV files tend to be large, especially when used to transfer data between databases, using <code>read</code> isn&#39;t a good idea as it can kill a running script. <code>foreach</code> is a much better solution. <a href=\"https://stackoverflow.com/questions/25189262\">stackoverflow.com/questions/25189262</a>"}, {"owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "edited": false, "score": 0, "creation_date": 1496182457, "post_id": 44272621, "comment_id": 75553351, "body": "I got a zero when I tried using file.count I&#39;m not sure what I did wrong."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496182513, "post_id": 44272621, "comment_id": 75553368, "body": "If you want us to explain <i>what you did wrong</i>, then you needed to show us <i>what you did</i>!"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 3, "last_activity_date": 1496182611, "last_edit_date": 1496182611, "creation_date": 1496181446, "answer_id": 44272621, "question_id": 44272197, "link": "https://stackoverflow.com/questions/44272197/counting-the-number-of-values-over-a-certain-number-in-ruby/44272621#44272621", "title": "Counting the number of values over a certain number in Ruby", "body": "<p>There are multiple ways to solve this. Here's one approach that does the whole operation in one go, without even looping through each line:</p>\n\n<pre><code>File\n  .read('csv.csv') # Read the file into a ruby String\n  .split(/,|\\n/)   # Convert into an Array of each string (splitting on commas OR newlines) (e.g. ['55', '56', '60', ... ])\n  .map(&amp;:to_i)     # Convert into an Array of each integer (e.g. [55, 56, 60, ... ])\n  .count { |n| n &gt;= 60 }\n</code></pre>\n\n<p>Here's a similar approach, that instead loops through each line and adds the count to a variable. Using <code>foreach</code> like this is especially better if you have a very large file - as you won't be loading it all into memory at once:</p>\n\n<pre><code>total = 0\nFile.foreach('csv.csv') do |line|\n  total += line.split(',').count {|n| n.to_i &gt;= 60 }\nend\n</code></pre>\n\n<p>And here's another approach that actually uses ruby's <a href=\"http://ruby-doc.org/stdlib/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\"><code>CSV</code> library</a>, so you don't need to explicitly split on the commas:</p>\n\n<pre><code>require 'csv'\n\ntotal = 0\nCSV.foreach('csv.csv') do |row|\n  total += row.count {|n| n.to_i &gt;= 60 }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1496181975, "post_id": 44272623, "comment_id": 75553203, "body": "@tadman <code>csv.rb</code> is 2.4kloc (including comments), and using it would not appreciably reduce the amount of code OP would need to write. Even if using the CSV module only saved OP from writing three lines of code I&#39;d probably say they should use it. In this case it doesn&#39;t even save one line of code, so why bother?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1496182766, "post_id": 44272623, "comment_id": 75553448, "body": "2.4KLOC is nothing these days, you should know that. It&#39;s a good tool, it&#39;s bundled with Ruby so it&#39;s dependably there, and it <i>works</i>. I don&#39;t see how <code>scan</code> is any better here, especially if this CSV file gets more ornate in later iterations."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 0, "last_activity_date": 1496181457, "creation_date": 1496181457, "answer_id": 44272623, "question_id": 44272197, "link": "https://stackoverflow.com/questions/44272197/counting-the-number-of-values-over-a-certain-number-in-ruby/44272623#44272623", "title": "Counting the number of values over a certain number in Ruby", "body": "<p>While I usually caution against using na\u00efve means to deal with CSV data, if indeed your CSV file is all numbers, then I think using the CSV module is overkill. You can use <a href=\"https://ruby-doc.org/core-2.4.1/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\"><code>File.foreach</code></a> to iterate over the file's lines and <a href=\"https://ruby-doc.org/core-2.4.1/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>String#scan</code></a> to iterate over the numbers in the file.</p>\n\n<pre><code>n = 0\nFile.foreach(\"csv.csv\") do |line|\n  line.scan(/\\d+/) {|s| num += 1 if s.to_i &gt;= 60 }\nend\n\np n # =&gt; 4\n</code></pre>\n\n<p>This method has the benefit of not reading the entire file into memory at once, nor creating large intermediate arrays.</p>\n\n<p>You can see it (almost) in action on repl.it: <a href=\"https://repl.it/IY5X\" rel=\"nofollow noreferrer\">https://repl.it/IY5X</a> (It's different only because you can't read from files on repl.it.)</p>\n"}, {"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1496182515, "post_id": 44272749, "comment_id": 75553371, "body": "Don&#39;t forget about <code>Enumerable#count</code>."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1496183568, "last_edit_date": 1496183568, "creation_date": 1496182317, "answer_id": 44272749, "question_id": 44272197, "link": "https://stackoverflow.com/questions/44272197/counting-the-number-of-values-over-a-certain-number-in-ruby/44272749#44272749", "title": "Counting the number of values over a certain number in Ruby", "body": "<p>The shortest way I know of to do this is:</p>\n\n<pre><code>File.read('foo.csv').scan(/\\d+/).select { |d| d.to_i &gt; 60 ).size\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Don't forget about Enumerable#count</p>\n</blockquote>\n\n<p>Good point:</p>\n\n<pre><code>DATA.read.scan(/\\d+/).count { |s| s.to_i &gt; 60 }  # =&gt; 3\n</code></pre>\n\n<p>The downside to these is that they're not scalable. See \"<a href=\"https://stackoverflow.com/questions/25189262/why-is-slurping-a-file-not-a-good-practice/25189286?s=1|2.3336#25189286\">Why is &quot;slurping&quot; a file not a good practice?</a>\" for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1496182996, "creation_date": 1496182996, "answer_id": 44272850, "question_id": 44272197, "link": "https://stackoverflow.com/questions/44272197/counting-the-number-of-values-over-a-certain-number-in-ruby/44272850#44272850", "title": "Counting the number of values over a certain number in Ruby", "body": "<p>If the values are all treated equally:</p>\n\n<pre><code>require 'csv'\n\nCSV.read('input.csv').flatten.map(&amp;:to_i).count { |i| i &gt;= 60 }\n# =&gt; 4\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8021363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea88d472c316bb30f706ee235a0a44ab?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Student", "link": "https://stackoverflow.com/users/8021363/confused-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1496183568, "creation_date": 1496179638, "last_edit_date": 1496181161, "question_id": 44272197, "link": "https://stackoverflow.com/questions/44272197/counting-the-number-of-values-over-a-certain-number-in-ruby", "title": "Counting the number of values over a certain number in Ruby", "body": "<p>I'm currently working with a <code>.csv</code> file in ruby and I'm trying to figure out how to count the number of items that are over 60 in the file.</p>\n\n<p>I've imported the csv file into a hash and counted the total number of items, but I want to know how to count the number of items over 60 now. </p>\n\n<p>This is an example of what I'm looking for</p>\n\n<p><code>csv.csv</code>:</p>\n\n<pre><code>55, 56\n60, 61\n63, 9\n3, 62\n</code></pre>\n\n<p>My code so far:</p>\n\n<pre><code>myhash=[]\nmyhash1=[]\ntotal=0\ncount=0\nfile=File.open('csv.csv',\"r\")\n\n???\n\nputs count \n</code></pre>\n\n<p>Expected output: <code>4</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "has-many"], "answers": [{"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 6, "last_activity_date": 1496175386, "last_edit_date": 1496175386, "creation_date": 1496174492, "answer_id": 44270911, "question_id": 44270822, "link": "https://stackoverflow.com/questions/44270822/activerecord-has-many-and-includes/44270911#44270911", "title": "ActiveRecord :has_many and includes", "body": "<p>Each model class, as in your example, represents just one of those instances of a database record i.e. your <code>Meter</code> class represents just one <code>meter</code> row in the <code>meters</code> table. So with this in mind, you can see that the declaration that a <code>meter</code> <code>has_many</code> <code>contracts</code> means that each one of those <code>meter</code> instances has many <code>contracts</code>.</p>\n\n<p>Let's break this line down: <code>@customer.meters.contracts</code> </p>\n\n<p>You have your <code>@customer</code> instance and you're asking it for all of its meters: <code>@customer.meters</code>. The return of that <code>meters</code> method is a collection of <code>meters</code> belonging to that <code>@customer</code>. Since it is the instance of a <code>meter</code> that has many contracts, you cannot ask the collection of meters for their contracts in that way.</p>\n\n<p>You can ask it of an individual meter though: <code>@customer.meters.first.contracts</code> or you can iterate over all the meters and get all the contracts:</p>\n\n<pre><code>@customer.meters.flat_map(&amp;:contracts) # =&gt; an array of all the contracts\n</code></pre>\n\n<p>Or, more generally, you might want to display a list of a customer's contracts in a view:</p>\n\n<pre><code>&lt;% @customer.meters.each do |meter| %&gt;\n  &lt;% meter.contracts.each do |contract|\n    // display the contract\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You can however, associate all the <code>contracts</code> to a <code>customer</code> through the <code>meters</code> association:</p>\n\n<pre><code>class Customer &lt; ApplicationRecord\n  has_many :meters, -&gt; { includes :contracts }\n  # ActiveRecord's shorthand declaration for associating\n  # records through a join table, in this case 'meters'\n  has_many :contracts, through: :meters\nend\n</code></pre>\n\n<p>By adding that <code>has_many X, through: Y</code> you're saying that the customer record is associated to records in another table <code>X</code> by way of a join table <code>Y</code>.</p>\n\n<p>With this, given a <code>customer</code> with existing <code>meters</code> and those meters having existing <code>contracts</code>, you'll be able to call <code>@customer.contracts</code> and ActiveRecord will fetch the <code>contracts</code> by joining the customer's <code>meters</code> with their <code>contracts</code> and return the <code>contracts</code> collection.</p>\n\n<p>More about the Rails Has Many Through association: <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"noreferrer\">http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association</a></p>\n"}], "owner": {"reputation": 89, "user_id": 2228271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df54d53d00b43ed4658e7ba73ecdff8a?s=128&d=identicon&r=PG", "display_name": "potofski", "link": "https://stackoverflow.com/users/2228271/potofski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6816, "favorite_count": 1, "accepted_answer_id": 44270911, "answer_count": 1, "score": 3, "last_activity_date": 1496175386, "creation_date": 1496174059, "question_id": 44270822, "link": "https://stackoverflow.com/questions/44270822/activerecord-has-many-and-includes", "title": "ActiveRecord :has_many and includes", "body": "<p>I am using rails 4.2.0 - this are my Models:</p>\n\n<pre><code>class Customer &lt; ApplicationRecord\n  has_many :meters, -&gt; { includes :contracts }\nend\n\nclass Meter &lt; ApplicationRecord\n  belongs_to :customer\n  has_many :contracts\nend\n\nclass Contract &lt; ApplicationRecord\n  belongs_to :meter\nend\n</code></pre>\n\n<p>Now, I want to display all Contracts of an Customer. According to the <a href=\"http://guides.rubyonrails.org/association_basics.html#has-many-association-reference\" rel=\"nofollow noreferrer\">Rails Guides</a> I should be able to do this:</p>\n\n<pre><code>@customer.meters.contracts\n</code></pre>\n\n<p>However, it doesn't work. This is the error message:</p>\n\n<pre><code>undefined method `contracts' for #&lt;Meter::ActiveRecord_Associations_CollectionProxy:0x007fb0385730b0&gt;\n</code></pre>\n\n<p>What is the best approach in this situation?\nThanks for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496251681, "post_id": 44270439, "comment_id": 75588871, "body": "See your last two routes, you need to separate the URI definition with the method with commas. Try <code>get &quot;&#47;empresa&#47;new&quot;, to: &#39;empresa#new&#39;   post &quot;&#47;empresas&quot;, to: &#39;empresa#create&#39;</code>"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496252162, "post_id": 44270439, "comment_id": 75589142, "body": "That worked, thank you so much!!"}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496173757, "post_id": 44270679, "comment_id": 75549502, "body": "This change the error, now is:   NoMethodError in Empresa#new  Showing /root/projeto/app/views/empresa/new.html.erb where line #4 raised:  undefined method `empresas_path&#39; for #&lt;#&lt;Class:0x007fd70c1cb8b8&gt;:0x007fd719fed1c8&gt; Did you mean?  empresa_new_path"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496173918, "post_id": 44270679, "comment_id": 75549591, "body": "Try setting <code>empresa_new_path</code> instead <code>empresas_path</code>, or add your routes to the question."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496174629, "post_id": 44270679, "comment_id": 75549958, "body": "Routes:      <code>get &quot;&#47;empresa&#47;index&quot; =&gt; &quot;empresa#index&quot;</code>     <code>get &quot;&#47;empresa&#47;new&quot; =&gt; &quot;empresa#new&quot;</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496175186, "post_id": 44270679, "comment_id": 75550219, "body": "Doesn&#39;t <code>empresa_new_path</code> work?, what&#39;s on <code>new.html.erb</code>?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496228057, "post_id": 44270679, "comment_id": 75572148, "body": "How can I do this, include empresa_new_path and where do I do this?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496236087, "post_id": 44270679, "comment_id": 75578042, "body": "Where are you getting such route error? That doesn&#39;t appear in your question, that&#39;s why asked what&#39;s in your new.html.erb."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496237381, "post_id": 44270679, "comment_id": 75579043, "body": "I&#39;m getting it in my browser, when I ask for the application to run. `    &lt;%= form_for @empresa_c do |f| %&gt;            &lt;div class = &quot;form-group&quot;&gt; &lt;%= f.label :nome %&gt;   &lt;%= f.text_field :nome , class: &quot;form-control&quot; %&gt;  &lt;/div&gt;           &lt;div class=&quot;form-group&quot;&gt;   &lt;%= f.label :endereco %&gt;               &lt;%= f.text_field :endereco, class: &quot;form-control&quot; %&gt;           &lt;/div&gt;           &lt;div class=&quot;form-group&quot;&gt;               &lt;div class=&quot;col-sm-offset-2 col-sm-10&quot;&gt;                   &lt;%= f.submit &quot;Criar&quot;, class: &quot;btn btn-primary&quot; %&gt;               &lt;/div&gt;           &lt;/div&gt;  &lt;% end %&gt;`"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496237427, "post_id": 44270679, "comment_id": 75579080, "body": "What&#39;s <code>@empresa_c</code>, how have you defined that variable?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496237976, "post_id": 44270679, "comment_id": 75579512, "body": "@empresa_c =  Empresa.new"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496238060, "post_id": 44270679, "comment_id": 75579574, "body": "In your <code>new</code> method? Have you modified your routes?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496238255, "post_id": 44270679, "comment_id": 75579699, "body": "I did not modify the routes, I do not know how to do it, and this variable I put in the controller."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496238433, "post_id": 44270679, "comment_id": 75579835, "body": "Try instead with <code>Empresa.new</code> in the <code>form_for</code> instead the variable, to see what happens."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496238577, "post_id": 44270679, "comment_id": 75579959, "body": "NoMethodError in Empresa#new  Showing /root/projeto/app/views/empresa/new.html.erb where line #4 raised:  undefined method `empresas_path&#39; for #&lt;#&lt;Class:0x007fd70c366308&gt;:0x007fd70c835ed8&gt; Did you mean?  empresa_new_path"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496238612, "post_id": 44270679, "comment_id": 75579985, "body": "So, now, how does your <code>empresas#new</code> method looks like?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496241006, "post_id": 44270679, "comment_id": 75581796, "body": "The <code>empresa#new</code> would call my controller&#39;s create method, right?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496242929, "post_id": 44270679, "comment_id": 75583278, "body": "Yes, from new to create, you need to make your routes match with your methods in your controllers, that&#39;s the reason of such error. Try with: <code>def new @empresa_c  =  Empresa.new end</code>."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496248996, "post_id": 44270679, "comment_id": 75587261, "body": "So, I put it the way it is there, but it keeps giving error   SyntaxError /root/project/config/routes.rb:9: syntax error, unexpected tIDENTIFIER, expecting keyword_end get &quot;/ company / new&quot; to: &#39;company # new&#39; ^ /root/project/config/routes.rb:10: syntax Error, unexpected tIDENTIFIER, expecting keyword_end post &quot;/ companies&quot; to: &#39;company # create&#39; ^ Extracted source (around line # 9):            &gt;          get &quot;/empresa/index&quot; =&gt; &quot;empresa#index&quot;   get &quot;/empresa/new&quot; to: &#39;empresa#new&#39;   post &quot;/empresas&quot; to: &#39;empresa#create&#39; end  End"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496249266, "post_id": 44270679, "comment_id": 75587413, "body": "You have an syntax error in your routes, I can&#39;t see which one or where. Do you have a repository?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496249736, "post_id": 44270679, "comment_id": 75587722, "body": "A repository? I did not understand. I have several routes configured, but of other classes, this does not influence anything?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1496249818, "post_id": 44270679, "comment_id": 75587773, "body": "It&#39;s just there&#39;s a long thread and I can&#39;t figure out where&#39;s the problem, I&#39;d need to see more details, if you add files involved in the problem. Try adding your routes to the question."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1496252375, "last_edit_date": 1496252375, "creation_date": 1496173462, "answer_id": 44270679, "question_id": 44270439, "link": "https://stackoverflow.com/questions/44270439/nameerror-in-empresanew-uninitialized-constant-actionviewcompiledtemplatese/44270679#44270679", "title": "NameError in Empresa#new uninitialized constant ActionView::CompiledTemplates::Empresas", "body": "<p>Use the singular way for your model when you use the <code>form_for</code> helper:</p>\n\n<pre><code>&lt;%= form_for Empresa.new do |f| %&gt;\n</code></pre>\n\n<p>Also to maintain the MVC pattern you could create an instance variable equal to <code>Empresa.new</code> in your controller and then pass it to the form.</p>\n\n<p>You could take a look to the <a href=\"http://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow noreferrer\">Rails helpers</a>.</p>\n\n<p>Try editing your controller like:</p>\n\n<pre><code># app/controllers/empresa_controller.rb\n...\ndef new\n  @empresa = Empresa.new\nend\n\ndef create\n  valores = params.require(:empresa).permit :nome, :endereco\n  @empresa= Empresa.create  valores\n  if @empresa.save\n    redirect_to root_url\n  else\n    render :new\n  end\nend\n</code></pre>\n\n<p>And be sure in your routes you have both methods:</p>\n\n<pre><code># config/routes.rb\nget '/emp\u0155esa/new', to: 'empresa#new'\npost '/empresas', to: 'empresa#create'\n</code></pre>\n\n<p>Then in your <code>new</code> view you'll have the variable <code>@empresa</code> defined in the <code>new</code> method, you can use it in your form:</p>\n\n<pre><code># app/views/empresa/new.html.erb\n&lt;%= form_for @empresa do |f| %&gt;\n</code></pre>\n\n<p><strong>Update</strong>: The last update to the question shows you were missing the commas in the route definitions.</p>\n"}], "owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 44270679, "answer_count": 1, "score": 1, "last_activity_date": 1496252375, "creation_date": 1496172608, "last_edit_date": 1496251594, "question_id": 44270439, "link": "https://stackoverflow.com/questions/44270439/nameerror-in-empresanew-uninitialized-constant-actionviewcompiledtemplatese", "title": "NameError in Empresa#new uninitialized constant ActionView::CompiledTemplates::Empresas", "body": "<p>Error:</p>\n\n<pre><code>SyntaxError\n/root/projeto/config/routes.rb:9: syntax error, unexpected tIDENTIFIER, expecting keyword_end get \"/empresa/new\" to: 'empresa#new' \n^ /root/projeto/config/routes.rb:10: syntax error, unexpected tIDENTIFIER, expecting keyword_end post \"/empresas\" to: 'empresa#create' ^\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>&lt;%= form_for Empresas.new do |f| %&gt;\n  &lt;div class = \"form-group\"&gt;\n    &lt;%= f.label :nome %&gt;\n    &lt;%= f.text_field :nome , class: \"form-control\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :endereco %&gt;\n    &lt;%= f.text_field :endereco, class: \"form-control\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-offset-2 col-sm-10\"&gt;\n      &lt;%= f.submit \"Criar\", class: \"btn btn-primary\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>    class EmpresaController &lt; ApplicationController\n    def index\n        @empresa = Empresa.order :nome\n    end\n\n   def new\n  @empresa = Empresa.new\nend\n\ndef create\n  valores = params.require(:empresa).permit :nome, :endereco\n  @empresa= Empresa.create  valores\n  if @empresa.save\n    redirect_to root_url\n  else\n    render :new\n  end\nend\nend\n</code></pre>\n\n<p>Routes:\nHere are the routes of user and company.\nUser routes are not called at any time from your company code.</p>\n\n<pre><code>Rails.application.routes.draw do\n        post \"/usuarios\" =&gt; \"usuario#create\"\n        get \"/usuario/new\" =&gt; \"usuario#new\"\n        delete \"/usuario/:id\" =&gt; \"usuario#destroy\", as:  :usuario\n        get \"/usuario/busca\" =&gt; \"usuario#busca\", as: :busca_usuario\n        root to: \"usuario#index\"\n        get \"/usuario/lista\" =&gt; \"usuario#lista\"\n        get \"/empresa/index\" =&gt; \"empresa#index\"\n        get \"/empresa/new\" to: 'empresa#new'\n        post \"/empresas\" to: 'empresa#create'\n    end\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 4416, "user_id": 1186936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R7eyc.jpg?s=128&g=1", "display_name": "degant", "link": "https://stackoverflow.com/users/1186936/degant"}, "edited": false, "score": 0, "creation_date": 1496171040, "post_id": 44269976, "comment_id": 75548005, "body": "Does this work <code>&#47;the (?:(?!the).)+? area&#47;</code>? <a href=\"https://regex101.com/r/qWQ4aS/1/\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1496175285, "post_id": 44269976, "comment_id": 75550258, "body": "<code>&#47;\\b(([A-Z][a-z]+\\s?)+\\b)(?= area)&#47; </code> might be good."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1496176649, "post_id": 44269976, "comment_id": 75550975, "body": "Interesting question. I couldn&#39;t find a satisfying solution with String and Enumerable methods."}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 2, "last_activity_date": 1496171446, "last_edit_date": 1496171446, "creation_date": 1496171113, "answer_id": 44270046, "question_id": 44269976, "link": "https://stackoverflow.com/questions/44269976/how-to-restrict-regular-expression-to-smaller-capture/44270046#44270046", "title": "How to restrict regular expression to smaller capture", "body": "<p>Use a <code>(?:(?!the).)+?</code> <a href=\"http://www.rexegg.com/regex-quantifiers.html#tempered_greed\" rel=\"nofollow noreferrer\"><strong>tempered greedy token</strong></a>:</p>\n\n<pre><code>/the ((?:(?!the).)+?) area/\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/dnq2Xx/1\" rel=\"nofollow noreferrer\">regex demo</a>. It is almost the same as <code>/the ([^t]*(?:t(?!he)[^t]*)*?) area/</code>, but <a href=\"https://regex101.com/r/Ya2XHd/1\" rel=\"nofollow noreferrer\">the latter is a bit more efficient</a> since it is an unrolled pattern.</p>\n\n<p>The <code>(?:(?!the).)+?</code> matches any 1+ chars (as few as possible) that does not start a <code>the</code> character sequence.</p>\n\n<p>To make it safer, add word boundaries to only match whole words:</p>\n\n<pre><code>/\\bthe ((?:(?!\\bthe\\b).)+?) area\\b/\n</code></pre>\n\n<p>Ruby demo:</p>\n\n<pre><code>s = 'I love the acting community in the Orange County area.'\nputs s[/the ((?:(?!the).)+?) area/,1]\n# =&gt; Orange County\n</code></pre>\n\n<p>NOTE: if you expect the match to span across multiple lines, do not forget to add <code>/m</code> modifier:</p>\n\n<pre><code>/the ((?:(?!the).)+?) area/m\n                           ^\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4416, "user_id": 1186936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R7eyc.jpg?s=128&g=1", "display_name": "degant", "link": "https://stackoverflow.com/users/1186936/degant"}, "is_accepted": false, "score": 2, "last_activity_date": 1496171471, "last_edit_date": 1496171471, "creation_date": 1496171131, "answer_id": 44270052, "question_id": 44269976, "link": "https://stackoverflow.com/questions/44269976/how-to-restrict-regular-expression-to-smaller-capture/44270052#44270052", "title": "How to restrict regular expression to smaller capture", "body": "<p>Use a tempered greedy solution, so that the matching text doesn't contain another <code>the</code>. That way it'll always match the last <code>the</code></p>\n\n<pre><code>/the (?:(?!the).)+? area/\n</code></pre>\n\n<ul>\n<li><code>(?:(?!the).)+?</code> represents a tempered greedy dot which matches any character except one that contains the text <code>the</code>. This is mentioned using the negative lookahead <code>(?!the)</code> which tells it to not match the text <code>the</code>. Thus it ensures that the match never contains the text <code>the</code></li>\n<li>This can be further enhanced by using capturing groups to just extract the text between <code>the</code> and <code>area</code> and so on. Another way would be to make <code>the</code> and <code>area</code> as lookbehind and lookahead, though will be a bit slower than a capturing group.</li>\n</ul>\n\n<p><a href=\"https://regex101.com/r/qWQ4aS/1/\" rel=\"nofollow noreferrer\">Regex101 Demo</a></p>\n\n<p><a href=\"http://www.rubular.com/r/yIkH3dJnbR\" rel=\"nofollow noreferrer\">Rubular Demo</a></p>\n\n<p>Read more about <a href=\"http://www.rexegg.com/regex-quantifiers.html#tempered_greed\" rel=\"nofollow noreferrer\">tempered greedy solution and when to use it</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5365397, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wm8nEwQV8uY/AAAAAAAAAAI/AAAAAAAAABw/55hSTbAeE8Y/photo.jpg?sz=128", "display_name": "Mobiusis", "link": "https://stackoverflow.com/users/5365397/mobiusis"}, "is_accepted": false, "score": 2, "last_activity_date": 1496171672, "creation_date": 1496171672, "answer_id": 44270205, "question_id": 44269976, "link": "https://stackoverflow.com/questions/44269976/how-to-restrict-regular-expression-to-smaller-capture/44270205#44270205", "title": "How to restrict regular expression to smaller capture", "body": "<pre><code>(?&lt;=in the)(.*)(?=area)\n</code></pre>\n\n<p>(?&lt;=) : Look behind command\n(?=) : Look ahead command, this will exclude the string you type in after the = sign. In this case, 'in the' and 'area' will be excluded from the result.</p>\n\n<p>(.<em>) is used here which is 'greedy', but you can use (.</em>?) to match to the next word typed in the look ahead command.</p>\n"}], "owner": {"reputation": 41, "user_id": 6397361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07b5b8be32ff5cd89dce3bc0c603cb5?s=128&d=identicon&r=PG&f=1", "display_name": "flpoirier", "link": "https://stackoverflow.com/users/6397361/flpoirier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1496197823, "creation_date": 1496170842, "last_edit_date": 1496197823, "question_id": 44269976, "link": "https://stackoverflow.com/questions/44269976/how-to-restrict-regular-expression-to-smaller-capture", "title": "How to restrict regular expression to smaller capture", "body": "<p>Here's my text:</p>\n\n<pre><code>\"A popular resource for the Christian community in the Asheville area.\"\n\"I love the acting community in the Orange County area.\"\n</code></pre>\n\n<p>I'd like to capture <code>\"Asheville\"</code> and <code>\"Orange County\"</code>. How can I start capturing from the closest <code>\"the\"</code> to <code>\"area\"</code>?</p>\n\n<p>Here's my regex:</p>\n\n<pre><code>/the (.+?) area/\n</code></pre>\n\n<p>They capture:</p>\n\n<pre><code>\"Christian community in the Asheville\"\n\"acting community in the Orange County\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": false, "score": 4, "last_activity_date": 1496174934, "creation_date": 1496174934, "answer_id": 44271038, "question_id": 44269257, "link": "https://stackoverflow.com/questions/44269257/rails-5-1-configuring-built-in-system-tests-with-rspec/44271038#44271038", "title": "Rails 5.1 Configuring Built-in System Tests with RSpec", "body": "<p>According to the RailsConf Talk: <a href=\"https://www.youtube.com/watch?v=jyPfrK1y1nc&amp;feature=youtu.be&amp;t=3m22s\" rel=\"nofollow noreferrer\">Teaching RSpec to Play nice with Rails</a>, as of <code>rspec-rails 3.6.0</code> it is <em>not</em> compatible with rails' system test integration.   </p>\n\n<p>It does appear that compatibility is being worked on via <a href=\"https://github.com/rspec/rspec-rails/pull/1813\" rel=\"nofollow noreferrer\">this pull request</a>.  </p>\n"}, {"tags": [], "owner": {"reputation": 2510, "user_id": 2995613, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3eb082f2910fcc8ebc7bb2f5ce5bc9ce?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2995613/daniel"}, "is_accepted": true, "score": 14, "last_activity_date": 1508374218, "creation_date": 1508374218, "answer_id": 46821325, "question_id": 44269257, "link": "https://stackoverflow.com/questions/44269257/rails-5-1-configuring-built-in-system-tests-with-rspec/46821325#46821325", "title": "Rails 5.1 Configuring Built-in System Tests with RSpec", "body": "<p>Update October 2017:</p>\n\n<p>Rspec-rails 3.7 is now fully compatible with system tests.</p>\n\n<p>Basically, this is all you have to add to your <code>spec_helper.rb</code>:</p>\n\n<pre><code>RSpec.configure do |config|\n  config.before(:each, type: :system) do\n    driven_by :rack_test\n  end\n\n  config.before(:each, type: :system, js: true) do\n    driven_by :selenium_chrome_headless\n  end\nend\n</code></pre>\n\n<p><a href=\"https://medium.com/table-xi/a-quick-guide-to-rails-system-tests-in-rspec-b6e9e8a8b5f6\" rel=\"noreferrer\">https://medium.com/table-xi/a-quick-guide-to-rails-system-tests-in-rspec-b6e9e8a8b5f6</a></p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3526, "favorite_count": 6, "accepted_answer_id": 46821325, "answer_count": 2, "score": 12, "last_activity_date": 1508374218, "creation_date": 1496168334, "last_edit_date": 1496169236, "question_id": 44269257, "link": "https://stackoverflow.com/questions/44269257/rails-5-1-configuring-built-in-system-tests-with-rspec", "title": "Rails 5.1 Configuring Built-in System Tests with RSpec", "body": "<p>After watching a <a href=\"https://www.youtube.com/watch?v=sSn4B8orX70\" rel=\"noreferrer\">RailsConf video on ActionDispatch::systemTestCase</a>, I was excited to incorporate it into my current app.  Currently our test suite setup uses the following:</p>\n\n<ul>\n<li><a href=\"https://rubygems.org/gems/rspec\" rel=\"noreferrer\">rspec</a></li>\n<li><a href=\"https://rubygems.org/gems/factory_girl\" rel=\"noreferrer\">factory_girl</a></li>\n<li><a href=\"https://rubygems.org/gems/capybara\" rel=\"noreferrer\">capybara</a> <code># for feature specs</code></li>\n<li><a href=\"https://rubygems.org/gems/database_cleaner\" rel=\"noreferrer\">database_cleaner</a> <code># for feature specs, mostly for testing js</code></li>\n<li><a href=\"https://rubygems.org/gems/selenium-webdriver\" rel=\"noreferrer\">selenium-webdriver</a> <code># for feature specs</code></li>\n<li><a href=\"https://rubygems.org/gems/capybara&#39;\" rel=\"noreferrer\">capybara-webkit</a> <code># for feature specs</code></li>\n</ul>\n\n<p>It was difficult to get the configuration working for our current setup, but we eventually got it working, thanks largely to an article by Avdi Grimm titled: <a href=\"http://www.virtuouscode.com/2012/08/31/configuring-database_cleaner-with-rails-rspec-capybara-and-selenium/\" rel=\"noreferrer\">Configuring database_cleaner with Rails, RSpec, Capybara, and Selenium</a>.</p>\n\n<p>My hope was to use the built-in system tests of rails released in rails <code>5.1</code>. Since rails now has system testing built in: all I would need to worry about configuring is the following:</p>\n\n<ul>\n<li><code>rspec</code></li>\n<li><code>factory_girl</code></li>\n</ul>\n\n<p>And that is it because <code>ActionDispatch::systemTestCase</code> takes care of <code>capybara</code>, <code>database_cleaner</code>, and it is already configured for the <code>selenium</code> driver.</p>\n\n<p>For example: currently my <code>feature specs</code> are written like so (Capybara within the context of RSpec):</p>\n\n<pre><code>#spec/features/blogs/creating_blogs_spec.rb\nrequire \"rails_helper\"\n\nRSpec.feature \"Logged in User can create a blog\" do\n  before do\n    create(:logged_in_user)\n  end\n\n  scenario \"successfully\", js: true do\n    ...\n  end\nend \n</code></pre>\n\n<p>So this is what a typical integration/feature/system spec might look like for a test suite configured with <code>rspec</code>, <code>database_cleaner</code>, <code>factory_girl</code>, and <code>capybara</code>.  I would like to convert it over to using <code>ActionDispatch::systemTestCase</code>.  </p>\n\n<p>However: I would like to use <code>ActionDispatch::systemTestCase</code> within the context of <code>RSpec</code>.</p>\n\n<p>The RailsConf video above shows how ActionDispatch::systemTestCase works within the context of rails' default test suite layout (ex: <a href=\"https://rubygems.org/gems/minitest&#39;\" rel=\"noreferrer\">minitest</a> with tests located in a <code>test</code> directory), but it did not discuss how to use ActionDispatch::systemTestCase within the context of RSpec.  </p>\n\n<p>I could not find any resources on making rails' built-in system tests configurable with RSpec, including within the <a href=\"http://edgeguides.rubyonrails.org/testing.html#system-testing\" rel=\"noreferrer\">system testing section of the rails guides</a>.  Is this possible?</p>\n"}, {"tags": ["ruby", "selenium", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496176502, "post_id": 44269179, "comment_id": 75550897, "body": "What does <code>@driver.find_element(id: &#39;flash&#39;)</code> return? What if you (temporarily, for now, in lieu of a better solution) <code>sleep(5)</code> first? Is that <code>expect(...)</code> the full code?! You need to write something like <code>expect(....).to be_true</code> -- so what did you actually write, and what is the error message?"}, {"owner": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496177181, "post_id": 44269179, "comment_id": 75551241, "body": "Hey Tom. You were going the right direction. I introduced a sleep before my assert and ta-dah it started working. Got lieu of the idea it would work on account that I printed to terminal the page_content and saw it was the old page_content it was displaying, in previous iterations of the code )-=. Was sad.  That expect as I&#39;ve written it is correct - in most recent RSpec, expect can be put around any old boolean expression i.e. expect(true or false expression). It may not be idiomatic to use expect this way, however - that I&#39;m not as sure."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496177717, "post_id": 44269179, "comment_id": 75551515, "body": "Yep, welcome to <b>the biggest issue</b> with <i>all</i> selenium/related tools. This is <i>the</i> problem that QA testers have to face 100 times a day. There is no &quot;silver bullet&quot; solution -- lazy (bad) way is to cheat and use a <code>sleep()</code>. Better is to poll for the existence of something. Best of all is for your assertion to be <i>triggered</i> by something being loaded. Have a play, and see what you can make work."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496177964, "post_id": 44269179, "comment_id": 75551632, "body": "Normally, Selenium should wait for the page to load before proceeding with the next step... I&#39;m not sure why that&#39;s not working here; possibly because the form submit is happening as an <code>xhr</code>?"}], "owner": {"reputation": 5962, "user_id": 1222564, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/35e05136eb1700834c71d59bb25a1c24?s=128&d=identicon&r=PG", "display_name": "PinkElephantsOnParade", "link": "https://stackoverflow.com/users/1222564/pinkelephantsonparade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496168459, "creation_date": 1496168038, "last_edit_date": 1496168459, "question_id": 44269179, "link": "https://stackoverflow.com/questions/44269179/selenium-with-ruby-cannot-access-html-elements-that-i-want", "title": "Selenium with Ruby - cannot access HTML elements that I want", "body": "<p>I am following SauceLab's Ruby and Selenium guidebook - it's a free book to help teach Selenium in combination with Rspec. In the first real example of the book, the author leads us to write a test script that goes to this link:\n<a href=\"http://the-internet.herokuapp.com/login\" rel=\"nofollow noreferrer\">http://the-internet.herokuapp.com/login</a></p>\n\n<p>Our script then will insert the appropriate uname and pwd (listed in text on the page... it's tomsmith and SuperSecretPassword!), and then submit the form.</p>\n\n<p>All of the above works - then it goes a little further and looks to introduce an assert to ensure that we got to the correct page (the page that results from successful login). This assert, even when I do as per the example in the book, does not work. It can't find the element, and says so as here: </p>\n\n<pre><code> Failure/Error: expect(@driver.find_element(css: '.flash.success').displayed?)\n\n Selenium::WebDriver::Error::NoSuchElementError:\n   Unable to locate element: .flash.success\n # ./ruby_spec.rb:20:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>I was hoping I could get some help from SO in helping me formulate a working assert to ensure I'm on the login page after successful login via test script. Here is my code so far</p>\n\n<pre><code>require 'selenium-webdriver'\n\ndescribe 'Login' do\n\n\nbefore(:each) do\n@driver = Selenium::WebDriver.for :firefox\nend\n\nafter(:each) do\n @driver.quit\nend\n\nit 'test_to_succeed' do\n @driver.get 'http://the-internet.herokuapp.com/login'\n @driver.find_element(id: 'username').send_keys('tomsmith')\n @driver.find_element(id: 'password').send_keys('SuperSecretPassword!')\n @driver.find_element(id: 'login').submit\n expect(@driver.find_element(css: '.flash.success').displayed?) #line that fails every run\nend\nend\n</code></pre>\n\n<p>Minus a little revised rspec syntax, this is exactly as what is listed in the book. The book has for the failing line as below, with some deprecated syntax:</p>\n\n<pre><code>@driver.find_element(css: '.flash.success').displayed?.should be_true\n</code></pre>\n\n<p>But this also fails with the exact same error above. To further suss out it being my expect(), I have tested the expect() syntax for other elements to test that it is working/not the source of the problem. The source of the problem, instead, is that my script is not resolving the css element as the book indicates it would be able to. It can't find '.flash.success', in loose terms.</p>\n\n<p>So I went to page source of the successful login page and found some other things I could assert against. This came as attractive since it is unique to the success page:</p>\n\n<pre><code>&lt;div data-alert id='flash' class='flash success'&gt;\n        You logged into a secure area!\n        &lt;a href=\"#\" class=\"close\"&gt;&amp;times;&lt;/a&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>But alas, I found the exact same failures when trying this in my code:</p>\n\n<pre><code> expect(@driver.find_element(class: 'flash success').displayed?) #line that fails every run\n</code></pre>\n\n<p>or even</p>\n\n<pre><code> expect(@driver.find_element(id: 'flash').displayed?) #line that fails every run\n</code></pre>\n\n<p>Essentially, I'm a little mystified how I am supposed to get a unique element off of the successful login page to assert correctly. All the efforts above (including the one in the sample text that I'm learning from) would seem reasonable to work, to me... but it is not so. Rather than simply switching texts to one with working examples, I thought it would be more instructive for me to work out and try to discover why the examples above do not work.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1496168391, "post_id": 44269117, "comment_id": 75546515, "body": "Why reinvent the wheel when you can do <code>require &quot;erb&quot;</code>?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496170037, "post_id": 44269117, "comment_id": 75547426, "body": "This sounds like an &quot;<a href=\"https://meta.stackexchange.com/q/66377/153968\">XY Problem</a>&quot;. Using regex isn&#39;t the right way to process templates. If you need to modify them, consider having multiple, smaller, templates (&quot;partials&quot;) that you conditionally include."}], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 2, "creation_date": 1496168077, "post_id": 44269167, "comment_id": 75546333, "body": "That said, the syntax you used there looks like an ERB template. Instead of using a regex, you might be much better of when using ERB to render your string."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1496172874, "post_id": 44269167, "comment_id": 75548973, "body": "The problem with this approach is a separate <code>gsub</code> has to be written for every possible target and substitution. That results in a lot of repeated code which then violates the DRY principle."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 2, "last_activity_date": 1496167993, "creation_date": 1496167993, "answer_id": 44269167, "question_id": 44269117, "link": "https://stackoverflow.com/questions/44269117/how-to-replace-words-inside-template-placeholders/44269167#44269167", "title": "How to replace words inside template placeholders", "body": "<p>In your Regex, you have added the <code>\\A</code> and <code>\\z</code> anchors. These ensure that your regex only matches, if the string only contains exactly <code>&lt;%= Name %&gt;</code> with nothing before or after.</p>\n\n<p>To match the your pattern anywhere in the string, you can simply remove the anchors:</p>\n\n<pre><code>parsed_body = body.gsub(/&lt;%= Name %&gt;/, \"Some person\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1496172443, "post_id": 44270329, "comment_id": 75548724, "body": "Hahaha I had the same thought"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1496172507, "post_id": 44270329, "comment_id": 75548760, "body": "It&#39;s the right solution once someone knows how <code>gsub</code> works."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1496186437, "post_id": 44270329, "comment_id": 75554399, "body": "Agreed although it can be done more dynamically without the need to string slice inside the gsub block"}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1496173963, "last_edit_date": 1496173963, "creation_date": 1496172197, "answer_id": 44270329, "question_id": 44269117, "link": "https://stackoverflow.com/questions/44269117/how-to-replace-words-inside-template-placeholders/44270329#44270329", "title": "How to replace words inside template placeholders", "body": "<p>It looks like you're trying to write your own template parser, which is asking for a lot more trouble that it's worth considering those already exist.</p>\n\n<p>However, this is the basic idea for such a thing:</p>\n\n<pre><code>erb = &lt;&lt;EOT\nOwner: &lt;%= name %&gt;\nLocation: &lt;%= address %&gt;\nEOT\n\nFIELD_DATA = {\n  name: 'Olive Oyl',\n  address: '5 Sweethaven Village'\n}\n\nFIELD_RE = Regexp.union(FIELD_DATA.keys.map(&amp;:to_s)).source # =&gt; \"name|address\"\n\nputs erb.gsub(/&lt;%=\\s+(#{FIELD_RE})\\s+%&gt;/) { |k|\n  k # =&gt; \"&lt;%= name %&gt;\", \"&lt;%= address %&gt;\"\n  k[/\\s+(\\S+)\\s+/, 1]  # =&gt; \"name\",        \"address\"\n  FIELD_DATA[k[/\\s+(\\S+)\\s+/, 1].to_sym]  # =&gt; \"Olive Oyl\",   \"5 Sweethaven Village\"\n}\n</code></pre>\n\n<p>Which, when run, outputs:</p>\n\n<pre><code>Owner: Olive Oyl\nLocation: 5 Sweethaven Village\n</code></pre>\n\n<p>This works because <code>gsub</code> can take a regular expression and a block. For every match of the expression it passes in the match to the block, which is then used to return the actual value being substituted in.</p>\n\n<p>If you have a lot of target values, rather than use <code>Regexp.union</code>, instead use the <a href=\"https://github.com/gfx/ruby-regexp_trie\" rel=\"nofollow noreferrer\">RegexpTrie</a> gem. See \"<a href=\"https://stackoverflow.com/questions/5395236/is-there-an-efficient-way-to-perform-hundreds-of-text-substitutions-in-ruby/5395777#5395777\">Is there an efficient way to perform hundreds of text substitutions in Ruby?</a>\" for more information.</p>\n\n<p>Again, template parsers exist, they've been around a long time, they're very well tested, and they handle edge cases you haven't thought about, so don't write a new partially-implemented one, instead reuse an existing one.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1496173335, "last_edit_date": 1496173335, "creation_date": 1496172201, "answer_id": 44270332, "question_id": 44269117, "link": "https://stackoverflow.com/questions/44269117/how-to-replace-words-inside-template-placeholders/44270332#44270332", "title": "How to replace words inside template placeholders", "body": "<p>Just another option considering what I am assuming you are trying to accomplish</p>\n\n<pre><code>tag_pattern = /(?&lt;open_tag&gt;&lt;%=\\s*)(?&lt;key&gt;(\\w+))(?&lt;close_tag&gt;\\s*%&gt;)/\nbody = &lt;&lt;-B\n   Hello, \n    My name is &lt;%= Name %&gt; and I know some things. Just because I am a \n    &lt;%= Occupation %&gt; doesn't mean I know everything, but I sure can \n    &lt;%=Duty%&gt; just as well as anyone else.\n    Also please don't replace &lt;%= This %&gt;\n\n  Thank you,\n    &lt;%= Name %&gt;\nB\ndict = {\"Name\" =&gt; \"engineersmnky\", \"Occupation\" =&gt; \"Monkey\", \"Duty\" =&gt; \"drive a train\"} \n\n body.gsub(tag_pattern) {|m| dict[$2] || m }\n #=&gt;  Hello, \n #   My name is engineersmnky and I know some things. Just because I am a \n #   Monkey doesn't mean I know everything, but I sure can \n #   drive a train just as well as anyone else.\n #   Also please don't replace &lt;%= This %&gt;\n #\n # Thank you,\n #   engineersmnky\n</code></pre>\n\n<p>In this case I used a dictionary of the anticipated portions of the \"erb\" to be replaced and used the block style of <code>String#gsub</code> to handle the replacements where <code>$2</code> is the named capture <code>key</code>. When there is not a matching key it just leaves the match untouched e.g. <code>\"Also please don't replace &lt;%= This %&gt;\"</code></p>\n\n<p>You could implement this with any pattern you choose but if you are going to use \"erb\" style lines maybe try leveraging <code>erb</code> other wise the same will work below: </p>\n\n<pre><code>tag_pattern = (?&lt;open_tag&gt;{!!\\s*)(?&lt;key&gt;(\\w+))(?&lt;close_tag&gt;\\s*!\\?})\nbody = &lt;&lt;-B Hello, \n     My name is {!! Name !?} and I know some things. Just because I am a \n     {!! Occupation !?} doesn't mean I know everything, but I sure can \n     {!!Duty !?} just as well as anyone else.\n\n    Thank you,\n       {!! Name !?}\nB\n</code></pre>\n\n<p>As long as you define <code>tag_pattern</code> correctly the replacement is fairly simple. <a href=\"http://rubular.com/r/VCThNjoTbt\" rel=\"nofollow noreferrer\">Rubular Example</a></p>\n"}], "owner": {"reputation": 2886, "user_id": 1473856, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6744d9d560571836f7c9b8cfb95b373d?s=128&d=identicon&r=PG", "display_name": "Rhs", "link": "https://stackoverflow.com/users/1473856/rhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 44269167, "answer_count": 3, "score": 1, "last_activity_date": 1496174618, "creation_date": 1496167852, "last_edit_date": 1496174618, "question_id": 44269117, "link": "https://stackoverflow.com/questions/44269117/how-to-replace-words-inside-template-placeholders", "title": "How to replace words inside template placeholders", "body": "<p>I'm trying to write a regular expression to replace <code>&lt;%= Name %&gt;</code> with \"Some Person\". </p>\n\n<p>I'm using a regex because I want to modify it so that I don't have to worry about the spaces between <code>=</code> and <code>Name</code> as well as the <code>E</code> in <code>Name</code> and the <code>%&gt;</code></p>\n\n<p>I tried:</p>\n\n<pre><code>body = %q(\n  Hello &lt;%= Name %&gt;,\n  This is a test. hello test\n  some more stuff here \n  and here.\n\n  &lt;%= Name %&gt;\n)\n\nparsed_body = body.gsub(/\\A&lt;%= Name %&gt;\\Z/, \"Some person\")\nputs parsed_body\n</code></pre>\n\n<p>When <code>parsed_body</code> is printed out, the string is unchanged. What is wrong with my regex?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 4, "creation_date": 1496165618, "post_id": 44268441, "comment_id": 75544997, "body": "do a <code>reload!</code> and try again?"}, {"owner": {"reputation": 3439, "user_id": 5665799, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YOrLl.jpg?s=128&g=1", "display_name": "Kieran E", "link": "https://stackoverflow.com/users/5665799/kieran-e"}, "reply_to_user": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496165802, "post_id": 44268441, "comment_id": 75545090, "body": "@wesley6j is right.  To elaborate, every time you add methods in a model or change the DB structure, you need to run <code>reload!</code> in your Rails console to see the changes."}, {"owner": {"reputation": 161, "user_id": 3298118, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/100002022697918/picture?type=large", "display_name": "Eduardorph", "link": "https://stackoverflow.com/users/3298118/eduardorph"}, "reply_to_user": {"reputation": 1173, "user_id": 2422573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d75639d46bda6ad0f8c4b997b5718d0?s=128&d=identicon&r=PG", "display_name": "wesley6j", "link": "https://stackoverflow.com/users/2422573/wesley6j"}, "edited": false, "score": 0, "creation_date": 1496166029, "post_id": 44268441, "comment_id": 75545211, "body": "Nothing change, the same error occurs @wesley6j"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1496166447, "post_id": 44268441, "comment_id": 75545427, "body": "Try quitting the rails console."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 2, "creation_date": 1496166948, "post_id": 44268441, "comment_id": 75545691, "body": "Shouldn&#39;t your model be like <code>class User &lt; ActiveRecord::Base</code>, is it a typo?"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 2, "creation_date": 1496167324, "post_id": 44268441, "comment_id": 75545908, "body": "Or you tagged it wrong, you are on rails 5.."}, {"owner": {"reputation": 161, "user_id": 3298118, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/100002022697918/picture?type=large", "display_name": "Eduardorph", "link": "https://stackoverflow.com/users/3298118/eduardorph"}, "edited": false, "score": 0, "creation_date": 1496169964, "post_id": 44268441, "comment_id": 75547390, "body": "I tried with self.is_admin? and without self, but it did not work. I don&#39;t know what i need to do"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496170598, "post_id": 44268441, "comment_id": 75547758, "body": "Restarted the console? And which version of rails you using?"}, {"owner": {"reputation": 161, "user_id": 3298118, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/100002022697918/picture?type=large", "display_name": "Eduardorph", "link": "https://stackoverflow.com/users/3298118/eduardorph"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496171464, "post_id": 44268441, "comment_id": 75548231, "body": "@Md.FarhanMemon  Rails 5.0.3 | ruby 2.2.4-p230"}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 3298118, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/100002022697918/picture?type=large", "display_name": "Eduardorph", "link": "https://stackoverflow.com/users/3298118/eduardorph"}, "is_accepted": true, "score": 0, "last_activity_date": 1496170782, "creation_date": 1496170782, "answer_id": 44269954, "question_id": 44268441, "link": "https://stackoverflow.com/questions/44268441/undefined-method-is-admin-for-user0x007fc2b3f952e0/44269954#44269954", "title": "undefined method `is_admin?&#39; for #&lt;User:0x007fc2b3f952e0&gt;", "body": "<p>I don't know why, but i solved this issue in this way</p>\n\n<p>I simply created another method and now it worked</p>\n\n<pre><code>  def has_role role\n    self.role.name == role\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 484, "user_id": 5949678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn9j3.jpg?s=128&g=1", "display_name": "Divya Sharma", "link": "https://stackoverflow.com/users/5949678/divya-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1496239084, "creation_date": 1496239084, "answer_id": 44286805, "question_id": 44268441, "link": "https://stackoverflow.com/questions/44268441/undefined-method-is-admin-for-user0x007fc2b3f952e0/44286805#44286805", "title": "undefined method `is_admin?&#39; for #&lt;User:0x007fc2b3f952e0&gt;", "body": "<p>You are using rolify gem for roles? If yes then follow this:</p>\n\n<p>If you want to check for is_admin? then modify your is_admin? method as:-></p>\n\n<pre><code>def is_admin?\n   has_role?('admin')\nend\n</code></pre>\n\n<p>then try this</p>\n\n<pre><code>u = User.find_by_email('teste@teste.com')\nu.is_admin?\n</code></pre>\n\n<p>if user don't have 'admin' role then you can assign by :-></p>\n\n<pre><code>u.add_role :admin\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 3298118, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/100002022697918/picture?type=large", "display_name": "Eduardorph", "link": "https://stackoverflow.com/users/3298118/eduardorph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 44269954, "answer_count": 2, "score": 0, "last_activity_date": 1496239084, "creation_date": 1496165406, "last_edit_date": 1496169323, "question_id": 44268441, "link": "https://stackoverflow.com/questions/44268441/undefined-method-is-admin-for-user0x007fc2b3f952e0", "title": "undefined method `is_admin?&#39; for #&lt;User:0x007fc2b3f952e0&gt;", "body": "<p>I have a model User and Role.</p>\n\n<p>USER belongs_to ROLE as you can see in this models</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  belongs_to :role\n\n  # this method return true or false\n  def is_admin?\n    self.role.name == 'admin'\n  end\n\nend\n\n\nclass Role &lt; ApplicationRecord\n    has_many :users\nend\n</code></pre>\n\n<p>The role_id exists in User table</p>\n\n<p>But when i try access 'is_admin?' method in rails console, the \"undefined method `is_admin?' for #\" appears</p>\n\n<pre><code>u = User.find_by_email('teste@teste.com')\n\n=&gt; #&lt;User id: 2, email: \"teste@teste.com\", created_at: \"2017-05-30 16:57:57\", updated_at: \"2017-05-30 17:00:44\", role_id: 6&gt;\n\nu.is_admin?\n\nNoMethodError: undefined method `is_admin?' for #&lt;User:0x007fd5233c1ab8\n</code></pre>\n\n<p>How can i do this?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 2272439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09fc3f0a0fec024750865851d8c3bf02?s=128&d=identicon&r=PG", "display_name": "dfaulken", "link": "https://stackoverflow.com/users/2272439/dfaulken"}, "edited": false, "score": 0, "creation_date": 1496163741, "post_id": 44267941, "comment_id": 75544095, "body": "Hmm, except <code>text_field</code> needs to be an instance method of <code>PrawnRails::Document</code>, so that it can operate on the document (creating boxes, adding text, styling, etc.)."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 306, "user_id": 2272439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09fc3f0a0fec024750865851d8c3bf02?s=128&d=identicon&r=PG", "display_name": "dfaulken", "link": "https://stackoverflow.com/users/2272439/dfaulken"}, "edited": false, "score": 0, "creation_date": 1496164488, "post_id": 44267941, "comment_id": 75544420, "body": "@dfaulken You may wish to explore how Prawn itself implements similar methods, since it may have an established convention (or even some convenient functionality you can piggyback onto), but I&#39;ve edited my answer to include a couple possible solutions."}, {"owner": {"reputation": 306, "user_id": 2272439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09fc3f0a0fec024750865851d8c3bf02?s=128&d=identicon&r=PG", "display_name": "dfaulken", "link": "https://stackoverflow.com/users/2272439/dfaulken"}, "edited": false, "score": 0, "creation_date": 1496165328, "post_id": 44267941, "comment_id": 75544848, "body": "That&#39;s a great suggestion. Thank you for sharing so many ideas!"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1496164429, "last_edit_date": 1496164429, "creation_date": 1496163504, "answer_id": 44267941, "question_id": 44267665, "link": "https://stackoverflow.com/questions/44267665/how-to-extend-a-ruby-library-with-a-helper-object/44267941#44267941", "title": "How to extend a Ruby library with a helper object", "body": "<blockquote>\n  <p>Is there a nicer way to make sure that my methods are only run in the proper context, e.g. when the <code>FieldRow</code> object is available?</p>\n</blockquote>\n\n<p>APIs like this usually use <a href=\"https://ruby-doc.org/core-2.4.1/BasicObject.html#method-i-instance_eval\" rel=\"nofollow noreferrer\"><code>instance_eval</code></a> so that the methods inside the block are called on the instantiated object:</p>\n\n<pre><code>module PrawnRailsForms\n  class FieldRow\n    def initialize(height:, units:, **)\n      # ...\n    end\n\n    def text_field(field:, **)\n      # ...\n    end\n  end\n\n  module Document\n    def field_row(**args, &amp;block)\n      @field_row = FieldRow.new(**args)\n      @field_row.instance_eval(&amp;block) unless block.nil?\n      @field_row\n    end\n  end\n\n  ::PrawnRails::Document.include(Document)\nend\n</code></pre>\n\n<p>Now when you do this:</p>\n\n<pre><code>doc.field_row(height: 25, units: 8) do\n  text_field field: 'Favorite fruit'\nend\n</code></pre>\n\n<p>...it will instantiate a FieldRow object with <code>height:</code> and <code>units:</code>, then call <code>text_field</code> on that object.</p>\n\n<hr>\n\n<p>If you need FieldRow to operate on the document itself, there are a few approaches you could take. One is to just pass <code>self</code> (the document object) to FieldRow's constructor and store it in an instance variable therein for use by <code>text_field</code> et al:</p>\n\n<pre><code>def field_row(**args, &amp;block)\n  row = FieldRow.new(self, **args)\n  row.instance_eval(&amp;block) unless block.nil?\nend\n</code></pre>\n\n<p>You could also define a method on FieldRow to which you pass the document object. In this scenario, FieldRow's methods (e.g. <code>text_field</code>) \"configure\" the output and <code>render</code> (or whatever you choose to call it) actually creates the output.</p>\n\n<pre><code>def field_row(**args, &amp;block)\n  row = FieldRow.new(**args)\n  row.instance_eval(&amp;block) unless block.nil?\n  row.render(self)\nend\n</code></pre>\n\n<p>I would caution against adding a bunch of methods to Document. Since <code>text_field</code> only works inside the context of <code>field_row</code>, making <code>text_field</code> an instance method on Document doesn't really make sense (and, as you've discovered, has some gotchas).</p>\n"}], "owner": {"reputation": 306, "user_id": 2272439, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09fc3f0a0fec024750865851d8c3bf02?s=128&d=identicon&r=PG", "display_name": "dfaulken", "link": "https://stackoverflow.com/users/2272439/dfaulken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 44267941, "answer_count": 1, "score": 1, "last_activity_date": 1496174833, "creation_date": 1496162429, "last_edit_date": 1496174833, "question_id": 44267665, "link": "https://stackoverflow.com/questions/44267665/how-to-extend-a-ruby-library-with-a-helper-object", "title": "How to extend a Ruby library with a helper object", "body": "<p>I'm extending <a href=\"https://github.com/cortiz/prawn-rails\" rel=\"nofollow noreferrer\">Prawn-Rails</a> with <a href=\"https://github.com/umts/prawn-rails-forms\" rel=\"nofollow noreferrer\">PrawnRailsForms</a>. I want those methods to only be available within a block that gives them some context. For example, usage of my extension might look like:</p>\n\n<pre><code>field_row height: 25, units: 8 do\n  text_field field: 'Favorite fruit', # ...\nend\n</code></pre>\n\n<p>The way this works under the hood in my library is that the <code>field_row</code> method instantiates a helper object, without which the other methods, like  <code>text_field</code>, don't run:</p>\n\n<pre><code>class FieldRow\n  # ...\nend\n\nclass PrawnRails::Document\n\n  attr_accessor :field_row # my helper object\n\n  def field_row(height:, units:, &amp;block)\n     @field_row = FieldRow.new #...\n     block.call\n     @field_row = nil\n  end\n\n  def text_field(**args)\n    unless @field_row.present?\n      raise ArgumentError, 'Must be inside a field row'\n    end\n    # implementation which relies on @field_row...\n  end\nend\n</code></pre>\n\n<p>Is there a nicer way to make sure that my methods are only run when the <code>FieldRow</code> object is available? In particular, having to write <code>@field_row = nil</code> after <code>block.call</code> makes me feel like I'm doing something incorrectly.</p>\n"}, {"tags": ["sql", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 1742, "user_id": 514463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b3572bd73f4727d9eced1aef0a8c66b6?s=128&d=identicon&r=PG", "display_name": "DavidC", "link": "https://stackoverflow.com/users/514463/davidc"}, "edited": false, "score": 1, "creation_date": 1496162235, "post_id": 44267483, "comment_id": 75543249, "body": "Is the dash in &quot;Peters-Koster&quot; ascii 45 or long dash?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496162402, "post_id": 44267483, "comment_id": 75543352, "body": "Something to do with <a href=\"https://www.postgresql.org/docs/9.5/static/locale.html\" rel=\"nofollow noreferrer\">encoding or collation</a> configuration of your Postgres server, perhaps?"}, {"owner": {"reputation": 1021, "user_id": 2533567, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93cb38093ed5a2035387274c49548e8b?s=128&d=identicon&r=PG", "display_name": "Danny Ocean", "link": "https://stackoverflow.com/users/2533567/danny-ocean"}, "reply_to_user": {"reputation": 1742, "user_id": 514463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b3572bd73f4727d9eced1aef0a8c66b6?s=128&d=identicon&r=PG", "display_name": "DavidC", "link": "https://stackoverflow.com/users/514463/davidc"}, "edited": false, "score": 0, "creation_date": 1496165220, "post_id": 44267483, "comment_id": 75544791, "body": "@DavidC Unfortunately, the environment has changed and I can&#39;t retrieve the same results to answer precisely. But I&#39;ve tried to insert into db the same data that I&#39;ve posted here, and I&#39;ve got the same order that time. So I suppose this is because of <a href=\"https://en.wikipedia.org/wiki/Dash\" rel=\"nofollow noreferrer\">unicode dashes</a>? It seems that Ruby normalizes such strings then."}], "answers": [{"tags": [], "owner": {"reputation": 3798, "user_id": 2823853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/InKCu.jpg?s=128&g=1", "display_name": "idej", "link": "https://stackoverflow.com/users/2823853/idej"}, "is_accepted": true, "score": 3, "last_activity_date": 1496179100, "last_edit_date": 1496179100, "creation_date": 1496178760, "answer_id": 44271968, "question_id": 44267483, "link": "https://stackoverflow.com/questions/44267483/why-ruby-sort-array-of-strings-differently-than-sql-order-postgres/44271968#44271968", "title": "Why ruby sort array of strings differently than sql order (postgres)?", "body": "<p>Sort behaviour for strings in ruby based on ASCII codes.</p>\n\n<p>Sort behaviour for text in pg depends on the current collation of your locale. From PostgreSQL wiki - <a href=\"https://wiki.postgresql.org/wiki/FAQ#Why_do_my_strings_sort_incorrectly.3F\" rel=\"nofollow noreferrer\">Why do my strings sort incorrectly?</a>:</p>\n\n<blockquote>\n  <p>It is not in ASCII/byte order. No, it's not, it's not supposed to be.\n  ASCII is an encoding, not a sort order. If you want this, you can use\n  the C locale, but then you use the ability to non-ASCII characters.</p>\n</blockquote>\n\n<p>So in plain SQL to sort by ASCII value, rather than a properly localized sort following your local language rules, you can use the <a href=\"https://www.postgresql.org/docs/current/static/collation.html\" rel=\"nofollow noreferrer\">COLLATE</a> clause in query</p>\n\n<pre><code>order by name COLLATE \"C\" ASC\n</code></pre>\n\n<p>You can check your collate settings in psql with <code>SHOW lc_collate;</code>.</p>\n\n<p>PostgreSQL uses OS collation support, so it's possible for results to vary slightly from host OS to host OS. Some versions of Mac OS X or a BSD-family operating system have problems with locale definitions.</p>\n"}], "owner": {"reputation": 1021, "user_id": 2533567, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93cb38093ed5a2035387274c49548e8b?s=128&d=identicon&r=PG", "display_name": "Danny Ocean", "link": "https://stackoverflow.com/users/2533567/danny-ocean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "accepted_answer_id": 44271968, "answer_count": 1, "score": 3, "last_activity_date": 1496213984, "creation_date": 1496161725, "last_edit_date": 1496213984, "question_id": 44267483, "link": "https://stackoverflow.com/questions/44267483/why-ruby-sort-array-of-strings-differently-than-sql-order-postgres", "title": "Why ruby sort array of strings differently than sql order (postgres)?", "body": "<p>When the code would tell better than words:</p>\n\n<pre><code>[4] pry&gt; Models::Company.order(:name).select_map(:name)\n=&gt; [\"Dekker, Jacobs and Bosch\", \"Koster en Zonen\", \"Peters-Koster\", \"Peters, Vries and Smits\", \"Wal, Linden and Jacobs\"]\n[5] pry&gt; Models::Company.order(:name).select_map(:name).sort\n=&gt; [\"Dekker, Jacobs and Bosch\", \"Koster en Zonen\", \"Peters, Vries and Smits\", \"Peters-Koster\", \"Wal, Linden and Jacobs\"]\n</code></pre>\n\n<p>Because of this my spec randomly failing. I can normalize arrays before comparing them, like this:</p>\n\n<pre><code>result_names.map { |s| s.gsub(/,|-/, '') }\n</code></pre>\n\n<p>I tried to sort the same array in JavaScript, and got the same result as Ruby gave me. I am wondering now, is there some sort of standard for sorting strings, or is it the detail of implementation?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 1, "last_activity_date": 1496237656, "last_edit_date": 1496237656, "creation_date": 1496161236, "answer_id": 44267331, "question_id": 44267158, "link": "https://stackoverflow.com/questions/44267158/incorrect-must-exist-validation-triggered-after-upgrading-to-rails-5-1-1/44267331#44267331", "title": "Incorrect must exist validation triggered after upgrading to rails 5.1.1", "body": "<p>I figured it out.  the <code>application.rb</code> file must be loaded in last, <em>after</em> initializer files because this is in there after upgrading to <code>rails 5.1.1</code>:</p>\n\n<pre><code>#config/application.rb\nrequire_relative 'boot'\n\nrequire 'rails/all'\n\nBundler.require(*Rails.groups)\nmodule MyTestApp\n  class Application &lt; Rails::Application\n\n    config.load_defaults 5.1 # must be taking precedence over my opt-out config file.\n  end\nend\n</code></pre>\n\n<p>The solution was to remove that opt-out initializer file and after that <code>config.load_defaults 5.1</code> line to just add the opting-out line there:</p>\n\n<pre><code>#config/application.rb\nrequire_relative 'boot'\n\nrequire 'rails/all'\n\nBundler.require(*Rails.groups)\nmodule MyTestApp\n  class Application &lt; Rails::Application\n\n    config.load_defaults 5.1\n    Rails.application.config.active_record.belongs_to_required_by_default = false\n\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 44267331, "answer_count": 1, "score": 1, "last_activity_date": 1496237656, "creation_date": 1496160735, "question_id": 44267158, "link": "https://stackoverflow.com/questions/44267158/incorrect-must-exist-validation-triggered-after-upgrading-to-rails-5-1-1", "title": "Incorrect must exist validation triggered after upgrading to rails 5.1.1", "body": "<p>I previously had my rails application using <code>5.0.1</code> and it was working great.  I upgraded to rails <code>5.1.1</code> and now I have a bunch of incorrect rails validations triggering with the message:</p>\n\n<blockquote>\n  <ul>\n  <li>must exist</li>\n  </ul>\n</blockquote>\n\n<p>I found an article by BigBinary titled: <a href=\"http://blog.bigbinary.com/2016/02/15/rails-5-makes-belong-to-association-required-by-default.html\" rel=\"nofollow noreferrer\">Rails 5 makes belongs_to association required by default</a>.  I figured it might be related to that. I attempted opting out of this default behavior by doing the following (as was suggested in the article):</p>\n\n<pre><code># config/initializers/new_framework_defaults.rb\n\nRails.application.config.active_record.belongs_to_required_by_default = false\n</code></pre>\n\n<p>After creating that file I stopped and restarted the server, but the issue persists.  </p>\n\n<p>Any ideas as to why these validations are triggering after upgrading from <code>5.0.1</code> to <code>5.1.1</code>?</p>\n"}, {"tags": ["ruby", "shell"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1496160517, "post_id": 44267039, "comment_id": 75542227, "body": "<code>%Q{}</code>? Also, within the string that should not be interpolated, single quotes rule."}, {"owner": {"reputation": 1, "user_id": 7076338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa22d50b008753a0a611b5be5da46dc?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/7076338/richard"}, "edited": false, "score": 0, "creation_date": 1496160621, "post_id": 44267039, "comment_id": 75544772, "body": "Could you possibly use JSON.stringify?"}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1496160741, "post_id": 44267039, "comment_id": 75542376, "body": "@mudasobwa, The question is not about how to build a string with double quotes inside, it&#39;s mostly about how to pass this string inside backticks (``)."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1496214172, "post_id": 44267039, "comment_id": 75562668, "body": "@theTinMan, 1. I don&#39;t need thousands of files in my system. 2. It&#39;s faster, no need to write/read/delete a file each time, it&#39;s senseless. 3.Your suggestion  actually is more complicate: we need to create a file with the unique name each time because of multithreading."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1496165088, "post_id": 44267203, "comment_id": 75544728, "body": "I wasn&#39;t familiar with the <code>Shellwords</code> module. There&#39;s an informative article about it <a href=\"https://endofline.wordpress.com/2010/12/14/ruby-standard-library-shellwords/\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 8, "last_activity_date": 1496160846, "creation_date": 1496160846, "answer_id": 44267203, "question_id": 44267039, "link": "https://stackoverflow.com/questions/44267039/ruby-shell-command-with-double-quotes/44267203#44267203", "title": "Ruby shell command with double quotes", "body": "<p>Use <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/shellwords/rdoc/Shellwords.html#method-c-escape\" rel=\"noreferrer\"><code>Shellwords.escape</code></a>:</p>\n\n<pre><code>&gt;&gt; require 'shellwords'\n&gt;&gt; puts %x|echo #{Shellwords.escape(stats)}|\n\n[[\"25/01/2017 03:15 PST\",\n  \"26/01/2017 03:15 PST\",\n  \"27/01/2017 03:15 PST\",\n  \"28/01/2017 03:15 PST\"]]\n</code></pre>\n"}], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 44267203, "answer_count": 1, "score": 1, "last_activity_date": 1496160846, "creation_date": 1496160359, "question_id": 44267039, "link": "https://stackoverflow.com/questions/44267039/ruby-shell-command-with-double-quotes", "title": "Ruby shell command with double quotes", "body": "<p>I want to pass JSON-formatted string as script argument inside backtick, e.g.:</p>\n\n<pre><code>stats = \"[[\\\"25/01/2017 03:15 PST\\\",\n           \\\"26/01/2017 03:15 PST\\\",\n           \\\"27/01/2017 03:15 PST\\\",\n           \\\"28/01/2017 03:15 PST\\\"]]\"\n\n`my_executable_script.js \"#{stats}\"`\n</code></pre>\n\n<p>And get a stdout value (it's important). The problem is that JSON argument should be escaped with double quotes, like:</p>\n\n<pre><code>my_executable_script.js \"[[\\\"25/01/2017 03:15 PST.....\"\n</code></pre>\n\n<p>but <code>my_executable_script.js [[\\\"25/01/2017 03:15 PST.....]]</code> is executed instead (without <code>\"\"</code>), which is wrong. I tried different ways of escaping, no success.</p>\n\n<p>I cannot use <code>system()</code> method because I need the result of the script executing.</p>\n"}, {"tags": ["c#", "python", "ruby", "encryption"], "comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1496160831, "post_id": 44266311, "comment_id": 75542438, "body": "Where is your C# output?"}, {"owner": {"reputation": 1606, "user_id": 1182299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e1eeb5ef93430176a06ca211aa7fca8?s=128&d=identicon&r=PG", "display_name": "bsteo", "link": "https://stackoverflow.com/users/1182299/bsteo"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1496160954, "post_id": 44266311, "comment_id": 75542514, "body": "Couldn&#39;t make a C# stand-alone encrypt/decrypt binary, I don&#39;t know any C#"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1496161373, "post_id": 44266311, "comment_id": 75542755, "body": "Maybe you should perform a speed course on that, because this probably also means that you don&#39;t understand how to debug this. We&#39;re not here to help you with that really."}, {"owner": {"reputation": 1606, "user_id": 1182299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e1eeb5ef93430176a06ca211aa7fca8?s=128&d=identicon&r=PG", "display_name": "bsteo", "link": "https://stackoverflow.com/users/1182299/bsteo"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1496161458, "post_id": 44266311, "comment_id": 75542809, "body": "Who is &quot;we&quot;? (I&#39;ll do that, anyway)"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 3, "creation_date": 1496161679, "post_id": 44266311, "comment_id": 75542918, "body": "The SO community. SO is for specific questions and answers. Some members will help with debugging of course, but generally you are supposed to at least have attempted it yourself. These kind of questions have very little value for other users of the system. By the way, I&#39;d use <code>ToArray</code> on the <code>MemoryStream</code> rather than retrieving the underlying buffer."}, {"owner": {"reputation": 1606, "user_id": 1182299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e1eeb5ef93430176a06ca211aa7fca8?s=128&d=identicon&r=PG", "display_name": "bsteo", "link": "https://stackoverflow.com/users/1182299/bsteo"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1496161775, "post_id": 44266311, "comment_id": 75542988, "body": "I know that, I&#39;m an old member here. If you read my question you can see I put a lot of work on it, anyway is your opinion. Thanks for the tip."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1496183810, "post_id": 44266311, "comment_id": 75553748, "body": "There are dozens of questions like this already on <a href=\"https://stackoverflow.com\">Stack Overflow</a>. In 99.9% of cases, the solution turned out to be that the person who asked the question actually encrypted different things (e.g. a UTF-16 encoded string in one language and a UTF-8 encoded string in the other language or a string with normalized line-endings vs a string without normalized line-endings, or a string which ended with a newline vs a string without a trailing newline or whatever). Are you 100000% sure that you are encrypting the same thing in all cases?"}], "answers": [{"tags": [], "owner": {"reputation": 1606, "user_id": 1182299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e1eeb5ef93430176a06ca211aa7fca8?s=128&d=identicon&r=PG", "display_name": "bsteo", "link": "https://stackoverflow.com/users/1182299/bsteo"}, "is_accepted": true, "score": 0, "last_activity_date": 1496179761, "creation_date": 1496179761, "answer_id": 44272231, "question_id": 44266311, "link": "https://stackoverflow.com/questions/44266311/c-tripledes-cbc-pkcs7-hex-not-equivalent-to-ruby-python-tripledes/44272231#44272231", "title": "C# TripleDES CBC/PKCS7/Hex not equivalent to Ruby/Python TripleDES", "body": "<p>Made it work on C# also:</p>\n\n<pre><code>using Microsoft.VisualBasic;\nusing Microsoft.VisualBasic.CompilerServices;\nusing System;\nusing System.IO;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Security.Cryptography;\nusing System.Threading.Tasks;\n\nnamespace _3DES\n{\n    class Program\n    {\n\n        public static string Encrypt(string strValue)\n        {\n            const string DES3_KEY = \"A0498F07C46808173894BB976F9726477CC0913D87DE912A\";\n            const string DES3_IV = \"0A9B11D6FEE830A9\";\n            TripleDESCryptoServiceProvider objCryptoProvider;\n            string str = \"\";\n            if (strValue.Length &gt; 0)\n            {\n                objCryptoProvider = new TripleDESCryptoServiceProvider();\n                objCryptoProvider.Mode = CipherMode.CBC;\n                objCryptoProvider.Padding = PaddingMode.PKCS7;\n                byte[] bytes1 = Encoding.Default.GetBytes(HexDecode(DES3_KEY));\n                byte[] bytes2 = Encoding.Default.GetBytes(HexDecode(DES3_IV));\n                MemoryStream memoryStream = new MemoryStream();\n                CryptoStream cryptoStream = new CryptoStream((Stream)memoryStream, objCryptoProvider.CreateEncryptor(bytes1, bytes2), CryptoStreamMode.Write);\n                StreamWriter streamWriter = new StreamWriter((Stream)cryptoStream);\n                streamWriter.Write(strValue);\n                streamWriter.Flush();\n                cryptoStream.FlushFinalBlock();\n                string strValue1 = Encoding.Default.GetString(memoryStream.GetBuffer(), 0, checked((int)memoryStream.Length));\n                str = HexEncode(strValue1);\n            }\n            return str;\n        }\n\n        public static string Decrypt(string strValue)\n        {\n            const string DES3_KEY = \"A0498F07C46808173894BB976F9726477CC0913D87DE912A\";\n            const string DES3_IV = \"0A9B11D6FEE830A9\";\n            TripleDESCryptoServiceProvider objCryptoProvider;\n            string str = \"\";\n            if (strValue.Length &gt; 0)\n            {\n                objCryptoProvider = new TripleDESCryptoServiceProvider();\n                objCryptoProvider.Mode = CipherMode.CBC;\n                objCryptoProvider.Padding = PaddingMode.PKCS7;\n                byte[] bytes1 = Encoding.Default.GetBytes(HexDecode(DES3_KEY));\n                byte[] bytes2 = Encoding.Default.GetBytes(HexDecode(DES3_IV));\n                string s;\n                s = HexDecode(strValue);\n                str = new StreamReader((Stream)new CryptoStream((Stream)new MemoryStream(Encoding.Default.GetBytes(s)), objCryptoProvider.CreateDecryptor(bytes1, bytes2), CryptoStreamMode.Read)).ReadToEnd();\n            }\n            return str;\n        }\n\n        public static string HexEncode(string strValue)\n        {\n            string str = \"\";\n            if (strValue.Length &gt; 0)\n            {\n                byte[] bytes = Encoding.Default.GetBytes(strValue);\n                int num = 0;\n                int upperBound = bytes.GetUpperBound(0);\n                int index = num;\n                while (index &lt;= upperBound)\n                {\n                    str += Conversion.Hex(bytes[index]).PadLeft(2, '0');\n                    checked { ++index; }\n                }\n            }\n            return str;\n        }\n\n        public static string HexDecode(string strValue)\n        {\n            string str = \"\";\n            if (strValue.Length &gt; 0)\n            {\n                strValue = strValue.ToUpper();\n                int num1 = 0;\n                int num2 = checked(strValue.Length - 2);\n                int startIndex = num1;\n                while (startIndex &lt;= num2)\n                {\n                    str += Conversions.ToString(Strings.Chr(Conversions.ToInteger(\"&amp;H\" + strValue.Substring(startIndex, 2))));\n                    checked { startIndex += 2; }\n                }\n            }\n            return str;\n        }\n\n        static void Main(string[] args)\n        {\n            String encoded = Encrypt(\"test\");\n            Console.WriteLine(encoded);\n            String plain = Decrypt(encoded);\n            Console.WriteLine(plain);\n        }\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>C:\\&gt; 3DES.exe\n33FD6EE287C0F46F\ntest\n</code></pre>\n"}], "owner": {"reputation": 1606, "user_id": 1182299, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e1eeb5ef93430176a06ca211aa7fca8?s=128&d=identicon&r=PG", "display_name": "bsteo", "link": "https://stackoverflow.com/users/1182299/bsteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "accepted_answer_id": 44272231, "answer_count": 1, "score": 1, "last_activity_date": 1496179761, "creation_date": 1496158156, "question_id": 44266311, "link": "https://stackoverflow.com/questions/44266311/c-tripledes-cbc-pkcs7-hex-not-equivalent-to-ruby-python-tripledes", "title": "C# TripleDES CBC/PKCS7/Hex not equivalent to Ruby/Python TripleDES", "body": "<p>I need to port a C# encrypt/decrypt class using 3DES with PKCS7 padding in HEX (with static key and IV) to Ruby or Python but seems the output is totally different.</p>\n\n<p>Here is the C# snippets of the code:</p>\n\n<pre><code>public CryptoDES3()\n{\n  this.objCryptoProvider = new TripleDESCryptoServiceProvider();\n  this.CipherMode = CipherMode.CBC;\n  this.PaddingMode = PaddingMode.PKCS7;\n  this.EncodingType = CryptoDES3.EncodingTypeEnum.Hex;\n}\n\n/* ----- */\n\npublic string Encrypt(string strValue, string strKey, string strIV, CryptoDES3.EncodingTypeEnum intEncodingType)\n{\n  string str = \"\";\n  if (strValue.Length &gt; 0)\n  {\n    this.objCryptoProvider.Mode = this.CipherMode;\n    this.objCryptoProvider.Padding = this.PaddingMode;\n    byte[] bytes1 = Encoding.Default.GetBytes(CryptoDES3.HexDecode(strKey));\n    byte[] bytes2 = Encoding.Default.GetBytes(CryptoDES3.HexDecode(strIV));\n    MemoryStream memoryStream = new MemoryStream();\n    CryptoStream cryptoStream = new CryptoStream((Stream) memoryStream, this.objCryptoProvider.CreateEncryptor(bytes1, bytes2), CryptoStreamMode.Write);\n    StreamWriter streamWriter = new StreamWriter((Stream) cryptoStream);\n    streamWriter.Write(strValue);\n    streamWriter.Flush();\n    cryptoStream.FlushFinalBlock();\n    string strValue1 = Encoding.Default.GetString(memoryStream.GetBuffer(), 0, checked ((int) memoryStream.Length));\n    switch (intEncodingType)\n    {\n      case CryptoDES3.EncodingTypeEnum.Hex:\n        str = CryptoDES3.HexEncode(strValue1);\n        break;\n      case CryptoDES3.EncodingTypeEnum.Base64:\n        str = CryptoDES3.Base64Encode(strValue1);\n        break;\n      default:\n        str = strValue1;\n        break;\n    }\n  }\n  return str;\n}\n\npublic string Decrypt(string strValue, string strKey, string strIV, CryptoDES3.EncodingTypeEnum intEncodingType)\n{\n  string str = \"\";\n  if (strValue.Length &gt; 0)\n  {\n    this.objCryptoProvider.Mode = this.CipherMode;\n    this.objCryptoProvider.Padding = this.PaddingMode;\n    byte[] bytes1 = Encoding.Default.GetBytes(CryptoDES3.HexDecode(strKey));\n    byte[] bytes2 = Encoding.Default.GetBytes(CryptoDES3.HexDecode(strIV));\n    string s;\n    switch (intEncodingType)\n    {\n      case CryptoDES3.EncodingTypeEnum.Hex:\n        s = CryptoDES3.HexDecode(strValue);\n        break;\n      case CryptoDES3.EncodingTypeEnum.Base64:\n        s = CryptoDES3.Base64Decode(strValue);\n        break;\n      default:\n        s = strValue;\n        break;\n    }\n    str = new StreamReader((Stream) new CryptoStream((Stream) new MemoryStream(Encoding.Default.GetBytes(s)), this.objCryptoProvider.CreateDecryptor(bytes1, bytes2), CryptoStreamMode.Read)).ReadToEnd();\n  }\n  return str;\n}\n\n/* ----- */\n\ninternal const string DES3_KEY = \"A0498F07C46808173894BB976F9726477CC0913D87DE912A\";\ninternal const string DES3_IV = \"0A9B11D6FEE830A9\";\n</code></pre>\n\n<p>Here is the Ruby code with it's output to console:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'digest'\nrequire 'openssl'\n\nALG = \"DES-EDE3-CBC\"\nKEY = \"\\xA0\\x49\\x8F\\x07\\xC4\\x68\\x08\\x17\\x38\\x94\\xBB\\x97\\x6F\\x97\\x26\\x47\\x7C\\xC0\\x91\\x3D\\x87\\xDE\\x91\\x2A\"\nIV = \"\\x0A\\x9B\\x11\\xD6\\xFE\\xE8\\x30\\xA9\"\n\ndef encode(data)\n  cipher = OpenSSL::Cipher::Cipher.new(ALG)\n  cipher.key = KEY\n  cipher.iv = IV\n  cipher.encrypt\n  result = cipher.update(data)\n  result &lt;&lt; cipher.final\n  result = result.unpack('H*')\nend\n\ndef decode(data)\n  cipher = OpenSSL::Cipher::Cipher.new(ALG)\n  cipher.key = KEY\n  cipher.iv = IV\n  cipher.decrypt\n  data = data.pack('H*')\n  result = cipher.update(data)\n  result &lt;&lt; cipher.final\nend\n\ndata = \"test\"\n\nencoded = encode(data)\ndecoded = decode(encoded)\n\nputs \"Encrypted: #{encoded[0]}\"\nputs \"Decrypted: #{decoded}\"\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>$ ./3des.rb\nEncrypted: 33fd6ee287c0f46f\nDecrypted: test\n</code></pre>\n\n<p>Python code:</p>\n\n<pre><code>#!/usr/bin/env python\nimport pyDes\n\nk = pyDes.triple_des('A0498F07C46808173894BB976F9726477CC0913D87DE912A'.decode('hex'), mode=pyDes.CBC, IV=\"0A9B11D6FEE830A9\".decode('hex'), pad=None, padmode=pyDes.PAD_PKCS5)\nd = k.encrypt(\"test\")\n\nprint \"Encrypted: \" + d.encode('hex')\n\nprint \"Decrypted: \" + k.decrypt(d)\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>$ ./3des.py\nEncrypted: 33fd6ee287c0f46f\nDecrypted: test\n</code></pre>\n\n<p>Same output in Python using <code>chilkat.CkCrypt2()</code>.</p>\n\n<p>Does MS C# <code>TripleDESCryptoServiceProvider()</code> differ to Ruby,Python,OpenSSL?\nAny idea how can I get the same results?</p>\n"}, {"tags": ["ruby", "rubygems", "bundle", "rvm", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "edited": false, "score": 0, "creation_date": 1496157864, "post_id": 44266166, "comment_id": 75540526, "body": "are you sure that&#39;s the case. look at his error message: <code>&#47;usr&#47;local&#47;rvm&#47;gems&#47;ruby-2.4.0&#47;bin&#47;bundle: &#47;usr&#47;bin&#47;ruby1.9.1: bad interpreter: No such file or directory</code>. looks like the bundler being executed <i>is</i> the gem for 2.4.0."}, {"owner": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "edited": false, "score": 0, "creation_date": 1496157984, "post_id": 44266166, "comment_id": 75540615, "body": "actually, upon further research, it looks like you&#39;re probably right. but why does the error message seem to imply that bundle is already installed for 2.4.0?"}, {"owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "reply_to_user": {"reputation": 4150, "user_id": 7470620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49f3026fe13841e41d1805178eed9a3c?s=128&d=identicon&r=PG", "display_name": "eiko", "link": "https://stackoverflow.com/users/7470620/eiko"}, "edited": false, "score": 0, "creation_date": 1496158249, "post_id": 44266166, "comment_id": 75540800, "body": "It&#39;s not implied. The error just says that bundler expect to find an ruby executable on the same version that you&#39;re working. However, the PATH returns another ruby executable where bundler is not installed."}], "tags": [], "owner": {"reputation": 420, "user_id": 1201862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XMCc.jpg?s=128&g=1", "display_name": "Gustavo Toro", "link": "https://stackoverflow.com/users/1201862/gustavo-toro"}, "is_accepted": true, "score": 1, "last_activity_date": 1496157762, "creation_date": 1496157762, "answer_id": 44266166, "question_id": 44265982, "link": "https://stackoverflow.com/questions/44265982/how-do-i-force-bundle-install-to-use-the-installed-version-of-ruby/44266166#44266166", "title": "How do I force &quot;bundle install&quot; to use the installed version of Ruby?", "body": "<p>Bundle fails because you don't have installed bundler in the 2.4.0 rvm gemset. To fix that, you should do this in your current version of ruby:</p>\n\n<pre><code>gem install bundler\nbundle\n</code></pre>\n\n<p>Make sure that your Ruby version is the same as declared on <code>Gemfile</code>.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 1, "accepted_answer_id": 44266166, "answer_count": 1, "score": -1, "last_activity_date": 1496157762, "creation_date": 1496157269, "question_id": 44265982, "link": "https://stackoverflow.com/questions/44265982/how-do-i-force-bundle-install-to-use-the-installed-version-of-ruby", "title": "How do I force &quot;bundle install&quot; to use the installed version of Ruby?", "body": "<p>I just re-installed Ruby 2.4.0 ...</p>\n\n<pre><code>myuser@myproject:~$ sudo env \"PATH=$PATH\" rvm reinstall ruby-2.4.0\nruby-2.4.0 - #removing rubies/ruby-2.4.0..\nSearching for binary rubies, this might take some time.\nFound remote file https://rubies.travis-ci.org/ubuntu/14.04/x86_64/ruby-2.4.0.tar.bz2\nChecking requirements for ubuntu.\nRequirements installation successful.\nruby-2.4.0 - #configure\nruby-2.4.0 - #download\nruby-2.4.0 - #validate archive\nruby-2.4.0 - #extract\nruby-2.4.0 - #validate binary\nruby-2.4.0 - #setup\nruby-2.4.0 - #gemset created /usr/local/rvm/gems/ruby-2.4.0@global\nruby-2.4.0 - #importing gemset /usr/local/rvm/gemsets/global.gems...................................\nruby-2.4.0 - #generating global wrappers........\nruby-2.4.0 - #gemset created /usr/local/rvm/gems/ruby-2.4.0\nruby-2.4.0 - #importing gemsetfile /usr/local/rvm/gemsets/default.gems evaluated to empty gem list\nruby-2.4.0 - #generating default wrappers........\nMaking gemset ruby-2.4.0 pristine.................................................................\nMaking gemset ruby-2.4.0@global pristine.................................................................\n</code></pre>\n\n<p>However, despite the fact I'm seeing the right version returned by \"ruby -v\", my \"bundle install\" seems to be pointed at an older version of Ruby ...</p>\n\n<pre><code>rails@myproject:~$ ruby -v\nruby 2.4.0p0 (2016-12-24 revision 57164) [x86_64-linux]\nrails@myproject:~$ cd myproject\nrails@myproject:~/myproject$ bundle install\n-su: /usr/local/rvm/gems/ruby-2.4.0/bin/bundle: /usr/bin/ruby1.9.1: bad interpreter: No such file or directory\n</code></pre>\n\n<p>HOw do I force bundle to point at the right version of Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1496225061, "post_id": 44265743, "comment_id": 75570097, "body": "Not clear what you mean by &quot;looking in a select&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496157336, "post_id": 44265789, "comment_id": 75540161, "body": "destructive <code>gsub!</code> is unnecessary there, no?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496157462, "post_id": 44265789, "comment_id": 75540246, "body": "@SergioTulentsev It depends on whether we want to return the original array or the one without prepositions."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1496156693, "creation_date": 1496156693, "answer_id": 44265789, "question_id": 44265743, "link": "https://stackoverflow.com/questions/44265743/how-do-i-sort-by-in-ruby-without-the-initial-prepopsition-a-the-etc/44265789#44265789", "title": "How do I sort_by in Ruby without the initial prepopsition (a, the, etc)", "body": "<p>Use <a href=\"https://ruby-doc.org/core/String.html#method-i-gsub\" rel=\"nofollow noreferrer\"><code>String#gsub</code></a> with explicitly defined <code>\\A</code> anchor for the matches at the beginning of string only:</p>\n\n<pre><code>input = [\"The Moritz\", \"Not The Embroidery Company\"]\ninput.map { |str| str.gsub(/\\AThe\\s+/, '') }\n#\u21d2 [\"Moritz\", \"Not The Embroidery Company\"]\n</code></pre>\n\n<p>One-liner for sorting inplace:</p>\n\n<pre><code>input.sort_by { |str| str.gsub!(/\\AThe\\s+/, '').to_s }\n#\u21d2\u00a0[\"Moritz\", \"Not The Embroidery Company\"]\n</code></pre>\n\n<p>Please note, that the latter mutates an original array.</p>\n"}, {"comments": [{"owner": {"reputation": 480, "user_id": 1121826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IBVOi.jpg?s=128&g=1", "display_name": "John Athayde", "link": "https://stackoverflow.com/users/1121826/john-athayde"}, "edited": false, "score": 0, "creation_date": 1496165420, "post_id": 44266113, "comment_id": 75544887, "body": "Thanks for the deep dive info on Schwartzian transformation."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496167781, "post_id": 44266113, "comment_id": 75546173, "body": "Am I the only one who is puzzled by such a simple concept as &quot;sort-by&quot; being named after a person? Surely coders were performing  &quot;Schwartzian transformations&quot; long before it was given that moniker."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496168686, "post_id": 44266113, "comment_id": 75546702, "body": "@CarySwoveland: no idea about that one. :)"}, {"owner": {"reputation": 480, "user_id": 1121826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IBVOi.jpg?s=128&g=1", "display_name": "John Athayde", "link": "https://stackoverflow.com/users/1121826/john-athayde"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496172368, "post_id": 44266113, "comment_id": 75548676, "body": "@CarySwoveland From the Wikipedia link:  &quot;The idiom is named after Randal L. Schwartz, who first demonstrated it in Perl shortly after the release of Perl 5 in 1994. The term &quot;Schwartzian transform&quot; applied solely to Perl programming for a number of years, but it has later been adopted by some users of other languages, such as Python, to refer to similar idioms in those languages. However, the algorithm was already in use in other languages (under no specific name) before it was popularized among the Perl community in the form of that particular idiom by Schwartz.&quot;"}, {"owner": {"reputation": 480, "user_id": 1121826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IBVOi.jpg?s=128&g=1", "display_name": "John Athayde", "link": "https://stackoverflow.com/users/1121826/john-athayde"}, "edited": false, "score": 0, "creation_date": 1496172458, "post_id": 44266113, "comment_id": 75548730, "body": "Also, FWIW for those who want to do this in ActiveRecord, my implementation in the Rails project:  <code>@manufacturers = Manufacturer.all.sort_by { |man| man.name.gsub(&#47;\\A(A|The)\\s+&#47;, &#39;&#39;).to_s }</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 480, "user_id": 1121826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IBVOi.jpg?s=128&g=1", "display_name": "John Athayde", "link": "https://stackoverflow.com/users/1121826/john-athayde"}, "edited": false, "score": 0, "creation_date": 1496302517, "post_id": 44266113, "comment_id": 75607806, "body": "@JohnAthayde: this implementation doesn&#39;t use any of the activerecord :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1496167366, "last_edit_date": 1496167366, "creation_date": 1496157609, "answer_id": 44266113, "question_id": 44265743, "link": "https://stackoverflow.com/questions/44265743/how-do-i-sort-by-in-ruby-without-the-initial-prepopsition-a-the-etc/44266113#44266113", "title": "How do I sort_by in Ruby without the initial prepopsition (a, the, etc)", "body": "<blockquote>\n  <p>I was looking at taking each name, converting it to an array with .split(\" \") and dropping \"the\" (.delete(\"The\")) and then joining again, and THEN sorting, but that just seems the wrong way to do this.</p>\n</blockquote>\n\n<p>This is called the <a href=\"https://en.wikipedia.org/wiki/Schwartzian_transform\" rel=\"nofollow noreferrer\">Schwartzian transform</a> and it is what powers ruby's sort_by.</p>\n\n<p>(<em>shamelessly <strike>stealing</strike>copying some of @mudasobwa's code</em>)</p>\n\n<pre><code> input = [\"The Moritz\", \"A Moritz\", \"The Embroidery Company\"]\n input.sort # =&gt; naive sort, [\"A Moritz\", \"The Embroidery Company\", \"The Moritz\"]\n input.sort_by { |str| str.gsub(/\\A(The|A)\\s+/, '') } # sort without prepositions\n # =&gt; [\"The Embroidery Company\", \"The Moritz\", \"A Moritz\"]\n</code></pre>\n"}], "owner": {"reputation": 480, "user_id": 1121826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IBVOi.jpg?s=128&g=1", "display_name": "John Athayde", "link": "https://stackoverflow.com/users/1121826/john-athayde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44266113, "answer_count": 2, "score": 1, "last_activity_date": 1496167366, "creation_date": 1496156520, "question_id": 44265743, "link": "https://stackoverflow.com/questions/44265743/how-do-i-sort-by-in-ruby-without-the-initial-prepopsition-a-the-etc", "title": "How do I sort_by in Ruby without the initial prepopsition (a, the, etc)", "body": "<p>I have a series of manufacturers and some of them use \"The\" at the beginning of their official name. People refer to them by the actual name, and looking in a <code>select</code> for the name under \"M\" but it's under \"T\"</p>\n\n<p>e.g. The Moritz Embroidery Company</p>\n\n<p>I was looking at taking each name, converting it to an array with <code>.split(\" \")</code> and dropping \"the\" (<code>.delete(\"The\")</code>) and then joining again, and THEN sorting, but that just seems the wrong way to do this. </p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "google-maps", "model-view-controller"], "comments": [{"owner": {"reputation": 369, "user_id": 870949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3264da8371da7207d599943d8703b2cf?s=128&d=identicon&r=PG", "display_name": "Narayon", "link": "https://stackoverflow.com/users/870949/narayon"}, "edited": false, "score": 1, "creation_date": 1496158006, "post_id": 44265567, "comment_id": 75540629, "body": "Your <code>id</code> of the map element(<code>map-canvas</code>) and the <code>map</code> var (<code>document.getElementById(&#39;map&#39;)</code>) don&#39;t match.  Besides that, try removing the <code>async defer</code> tags to the script and put the <code>script</code> before the <code>body</code> tag and describe what happens.  Moreover, where do you call the <code>initMap</code> function?"}, {"owner": {"reputation": 233, "user_id": 4875656, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Vlt1x.jpg?s=128&g=1", "display_name": "samureira", "link": "https://stackoverflow.com/users/4875656/samureira"}, "reply_to_user": {"reputation": 369, "user_id": 870949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3264da8371da7207d599943d8703b2cf?s=128&d=identicon&r=PG", "display_name": "Narayon", "link": "https://stackoverflow.com/users/870949/narayon"}, "edited": false, "score": 0, "creation_date": 1496158664, "post_id": 44265567, "comment_id": 75541083, "body": "The script before the body tag was irrelevant but all the other chances made it work. Besides that, I called the initMap function after my API key inside the script tag with &quot;MY_KEY&amp;callback=initMap&quot;"}, {"owner": {"reputation": 369, "user_id": 870949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3264da8371da7207d599943d8703b2cf?s=128&d=identicon&r=PG", "display_name": "Narayon", "link": "https://stackoverflow.com/users/870949/narayon"}, "edited": false, "score": 0, "creation_date": 1496159450, "post_id": 44265567, "comment_id": 75541594, "body": "Great! Do you need me to put this in an answer, so you can pick me? :)"}, {"owner": {"reputation": 233, "user_id": 4875656, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Vlt1x.jpg?s=128&g=1", "display_name": "samureira", "link": "https://stackoverflow.com/users/4875656/samureira"}, "reply_to_user": {"reputation": 369, "user_id": 870949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3264da8371da7207d599943d8703b2cf?s=128&d=identicon&r=PG", "display_name": "Narayon", "link": "https://stackoverflow.com/users/870949/narayon"}, "edited": false, "score": 0, "creation_date": 1496160162, "post_id": 44265567, "comment_id": 75542009, "body": "Sure, no problem."}], "answers": [{"tags": [], "owner": {"reputation": 369, "user_id": 870949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3264da8371da7207d599943d8703b2cf?s=128&d=identicon&r=PG", "display_name": "Narayon", "link": "https://stackoverflow.com/users/870949/narayon"}, "is_accepted": true, "score": 2, "last_activity_date": 1496160778, "creation_date": 1496160778, "answer_id": 44267176, "question_id": 44265567, "link": "https://stackoverflow.com/questions/44265567/cant-see-on-a-rails-app-a-map-for-locations-that-i-added-using-google-maps/44267176#44267176", "title": "Can&#39;t see on a Rails app a map for locations that I added using google maps", "body": "<p>Your id of the map element - <code>map-canvas</code> - and the map <code>var</code> -\n <code>document.getElementById('map')</code> - don't match.  </p>\n"}], "owner": {"reputation": 233, "user_id": 4875656, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Vlt1x.jpg?s=128&g=1", "display_name": "samureira", "link": "https://stackoverflow.com/users/4875656/samureira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 44267176, "answer_count": 1, "score": 2, "last_activity_date": 1496160778, "creation_date": 1496156040, "last_edit_date": 1496158136, "question_id": 44265567, "link": "https://stackoverflow.com/questions/44265567/cant-see-on-a-rails-app-a-map-for-locations-that-i-added-using-google-maps", "title": "Can&#39;t see on a Rails app a map for locations that I added using google maps", "body": "<p>While trying to replicate a directory website, I needed my \"Places\" to have a location displayed on the page using the Google Maps. Here what I've done so far:</p>\n\n<p>1\u00ba I got an API key for using Google Maps.</p>\n\n<p>2\u00ba In order to function maps need longitude and latitude, therefore, to convert and adress to coordinates I used a gem called geocoder.</p>\n\n<p>3\u00ba I added the latitude and longitude attributes (as float types) into the database, by running a migration and after inspection of the migration file I migrated it.</p>\n\n<p>4\u00ba According to documentation, I updated my Place.rb model to ensure the geocoded address is validated.</p>\n\n<p>5\u00ba I updated the Places view too with the coordinates fields.</p>\n\n<p>6\u00ba After following the Google Developers Guide, here's what I've done.</p>\n\n<p>@ /app/views/layouts/application.html.erb:</p>\n\n<pre><code>&lt;script src=\"https://maps.googleapis.com/maps/api/js?key=MY_KEY\"\n    async defer&gt;&lt;/script&gt;\n</code></pre>\n\n<p>@ /app/views/places/show.html.erb:</p>\n\n<pre><code>&lt;div id=\"map-canvas\" style = \"width:230px; height:230px\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>@ ./app/views/places/show.html.erb:</p>\n\n<pre><code>&lt;script&gt;\n      var map;\n      function initMap() {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: {lat: &lt;%= @place.latitude %&gt;, lng: &lt;%= @place.longitude %&gt;},\n          zoom: 8\n        });\n      }\n\n      &lt;% @reviews.each do |review| %&gt;\n        $(\".score_&lt;%= review.id %&gt; \").raty({\n          starOn: \"&lt;%= image_path('star-on.png') %&gt;\",\n          starOff: \"&lt;%= image_path('star-off.png') %&gt;\",\n          score: '&lt;%= review.score %&gt;',\n          readOnly: true\n        });\n      &lt;% end %&gt;\n\n        $(\".average\").raty({\n          starOn: \"&lt;%= image_path('star-on.png') %&gt;\",\n          starOff: \"&lt;%= image_path('star-off.png') %&gt;\",\n          score: '&lt;%= @place.total_average_rating %&gt;',\n          readOnly: true\n        });      \n\n&lt;/script&gt;\n</code></pre>\n\n<p>I refresh the page, everything shows up with the exception of the Places location that I was expecting by using Google Maps.</p>\n\n<p>Just in case, here's the full script of the App/Views/Layouts/Application.html file:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;MyYelp App&lt;/title&gt;\n  &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' =&gt; true %&gt;\n  &lt;%= javascript_include_tag 'application', 'data-turbolinks-track' =&gt; true %&gt;\n  &lt;%= csrf_meta_tags %&gt;\n\n  &lt;script src=\"https://maps.googleapis.com/maps/api/js?key=MY_KEY\"\n    async defer&gt;&lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;%= render \"layouts/header\" %&gt;\n\n&lt;% flash.each do | type, message | %&gt;\n    &lt;div class=\"alert alert-info fade-in\"&gt;\n        &lt;button class=\"close\" data-dismiss=\"alert\"&gt;X&lt;/button&gt;\n        &lt;%= message %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;% if current_page?(root_path) %&gt;\n  &lt;div class=\"landing\"&gt;\n&lt;% else %&gt;\n  &lt;div class=\"container\"&gt;\n&lt;% end %&gt;\n\n&lt;%= yield %&gt;\n&lt;/div&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And the App/Views/Places/Show.html file:</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-3\"&gt;\n    &lt;h3&gt;&lt;%= @place.name %&gt;&lt;/h3&gt;\n\n    &lt;div class=\"average\"&gt;\n\n    &lt;/div&gt;\n\n    &lt;p&gt;&lt;strong&gt;Adress&lt;/strong&gt;&lt;%= @place.address %&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;strong&gt;Phone&lt;/strong&gt;&lt;%= @place.phone %&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;strong&gt;Website&lt;/strong&gt;&lt;%= @place.website %&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;%= @place.description %&gt;&lt;/p&gt;\n    &lt;div id=\"map-canvas\" style = \"width:230px; height:230px\"&gt;&lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"col-md-9\"&gt;\n    &lt;h3&gt;Reviews by People&lt;/h3&gt;\n    &lt;% if current_user %&gt;\n    &lt;h5&gt;New Review&lt;/h5&gt;\n    &lt;%= render 'reviews/form' %&gt;\n    &lt;h5&gt;All Reviews&lt;/h5&gt;\n    &lt;%= render @reviews %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n&lt;/div&gt;\n\n&lt;script&gt;\n      var map;\n      function initMap() {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: {lat: &lt;%= @place.latitude %&gt;, lng: &lt;%= @place.longitude %&gt;},\n          zoom: 8\n        });\n      }\n\n      &lt;% @reviews.each do |review| %&gt;\n        $(\".score_&lt;%= review.id %&gt; \").raty({\n          starOn: \"&lt;%= image_path('star-on.png') %&gt;\",\n          starOff: \"&lt;%= image_path('star-off.png') %&gt;\",\n          score: '&lt;%= review.score %&gt;',\n          readOnly: true\n        });\n      &lt;% end %&gt;\n\n        $(\".average\").raty({\n          starOn: \"&lt;%= image_path('star-on.png') %&gt;\",\n          starOff: \"&lt;%= image_path('star-off.png') %&gt;\",\n          score: '&lt;%= @place.total_average_rating %&gt;',\n          readOnly: true\n        });      \n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["android", "ruby", "mobile", "automation", "appium"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 6648469, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kcI_XDTGG3E/AAAAAAAAAAI/AAAAAAAAANU/6EXj3Az6aJ4/photo.jpg?sz=128", "display_name": "Mayank Gupta", "link": "https://stackoverflow.com/users/6648469/mayank-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1496308098, "creation_date": 1496308098, "answer_id": 44303175, "question_id": 44265083, "link": "https://stackoverflow.com/questions/44265083/could-not-find-a-connected-android-device-seleniumwebdrivererrorunknowne/44303175#44303175", "title": "Could not find a connected Android device. (Selenium::WebDriver::Error::UnknownError)", "body": "<p>Try using the command <code>adb kill-server</code> and then try running <code>adb devices</code>.Hope this helps.</p>\n"}], "owner": {"reputation": 131, "user_id": 4537922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://graph.facebook.com/10152973619451597/picture?type=large", "display_name": "Shafiq Ahmed Khan", "link": "https://stackoverflow.com/users/4537922/shafiq-ahmed-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 730, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1496308098, "creation_date": 1496154639, "last_edit_date": 1496218618, "question_id": 44265083, "link": "https://stackoverflow.com/questions/44265083/could-not-find-a-connected-android-device-seleniumwebdrivererrorunknowne", "title": "Could not find a connected Android device. (Selenium::WebDriver::Error::UnknownError)", "body": "<p>I am unable to run my android automation test and I get the following error message:</p>\n\n<pre><code>An unknown server-side error occurred while processing the command. \nOriginal error: Could not find a connected Android device. \n(Selenium::WebDriver::Error::UnknownError)\n</code></pre>\n\n<p>I also get this message on the Appium server logs:</p>\n\n<pre><code>[ADB] Could not find devices, restarting adb server...\n[ADB] Restarting adb\n</code></pre>\n\n<p>I have tried <code>adb devices</code> and I get an empty list. How can I add a few dummie android devices or will the developer do this? </p>\n\n<p>Can somebody please be kind enough to give me some advice?</p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1496159804, "post_id": 44265053, "comment_id": 75541826, "body": "the question title is too broad; however the issue getting errors from Thread.pool is salient. Perhaps you should update the title to be more specific."}], "answers": [{"comments": [{"owner": {"reputation": 1991, "user_id": 574591, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9505b9216fdae1f6735ed821cfa7e7f8?s=128&d=identicon&r=PG", "display_name": "Alina", "link": "https://stackoverflow.com/users/574591/alina"}, "edited": false, "score": 0, "creation_date": 1496176866, "post_id": 44270034, "comment_id": 75551082, "body": "The answer about error handling states:  <i>If you don&#39;t set this variable to true, exception will only be raised when you call Thread#join or Thread#value for the thread.</i>  I do join the threads, so I do catch the errors. Also the answer considers the usage of <code>thread</code>, in my case <code>Thread.pool(4)</code>does not throw the exceptions. So, this answer does not help me.  Regarding GIL, I am not sure I understand you correctly. I did a benchmarking with threads and without. It was much faster with threads. Why did I get such benchmarking results?"}, {"owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "reply_to_user": {"reputation": 1991, "user_id": 574591, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9505b9216fdae1f6735ed821cfa7e7f8?s=128&d=identicon&r=PG", "display_name": "Alina", "link": "https://stackoverflow.com/users/574591/alina"}, "edited": false, "score": 0, "creation_date": 1496211026, "post_id": 44270034, "comment_id": 75560977, "body": "regarding benchmark, its possible that whenever you query external service (db and file) there is a context switch till the io returns."}, {"owner": {"reputation": 1991, "user_id": 574591, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9505b9216fdae1f6735ed821cfa7e7f8?s=128&d=identicon&r=PG", "display_name": "Alina", "link": "https://stackoverflow.com/users/574591/alina"}, "edited": false, "score": 0, "creation_date": 1496222516, "post_id": 44270034, "comment_id": 75568185, "body": "could you please elaborate? A context switch can lead to a longer process time, but according to your message it did speed up the process"}, {"owner": {"reputation": 1991, "user_id": 574591, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9505b9216fdae1f6735ed821cfa7e7f8?s=128&d=identicon&r=PG", "display_name": "Alina", "link": "https://stackoverflow.com/users/574591/alina"}, "edited": false, "score": 0, "creation_date": 1496224029, "post_id": 44270034, "comment_id": 75569314, "body": "so, basically what I am doing wight now is that I am NOT running the tables in parallel, right (not on different processors)?"}], "tags": [], "owner": {"reputation": 19325, "user_id": 67505, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/094c0ec476b95ed7619d6a4cb918da78?s=128&d=identicon&r=PG", "display_name": "Chen Kinnrot", "link": "https://stackoverflow.com/users/67505/chen-kinnrot"}, "is_accepted": false, "score": 0, "last_activity_date": 1496171057, "creation_date": 1496171057, "answer_id": 44270034, "question_id": 44265053, "link": "https://stackoverflow.com/questions/44265053/threading-in-ruby-alternative-to-threadpool/44270034#44270034", "title": "Threading in Ruby. Alternative to ThreadPool", "body": "<p>First,</p>\n\n<p>check <a href=\"https://stackoverflow.com/questions/9095316/handling-exceptions-raised-in-a-ruby-thread\">this</a> out (the answer) about error handling.</p>\n\n<p>second, there is a nice gem called <a href=\"https://github.com/ruby-concurrency/concurrent-ruby\" rel=\"nofollow noreferrer\">concurrent-ruby</a> which have many aspects of multi threading in other languages implemented in ruby.</p>\n\n<p>Another issue to consider is that ruby is not really concurrent, because of the <a href=\"https://en.wikipedia.org/wiki/Global_interpreter_lock\" rel=\"nofollow noreferrer\">GIL</a>. But you got fibers, which do good job for your case, async IO.</p>\n"}], "owner": {"reputation": 1991, "user_id": 574591, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9505b9216fdae1f6735ed821cfa7e7f8?s=128&d=identicon&r=PG", "display_name": "Alina", "link": "https://stackoverflow.com/users/574591/alina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1496171057, "creation_date": 1496154564, "last_edit_date": 1496160261, "question_id": 44265053, "link": "https://stackoverflow.com/questions/44265053/threading-in-ruby-alternative-to-threadpool", "title": "Threading in Ruby. Alternative to ThreadPool", "body": "<p>Lets say I have 2 different tables that needed to be filled. Each table can have different number of source files. I want to fill the tables in parallel but each source file will be read consequently.\nexample: Table A: 3 source files, Table B: 1 source files</p>\n\n<pre><code>tables = {'A': [sourcefileA_1, sourcefileA_2,sourcefileA_3], 'B':[sourcefileB_1]}\nthreads = []\ntables.each do |table,source_files|\n threads &lt;&lt; Thread.new { do_something(table, source_files)}\nend\nthreads.each(&amp;:join)\ndef do_something(table, source_files)\n source_files.each do |s_file|\n #do something\nend\n</code></pre>\n\n<p>So, the number of threads depends on the number of tables I have. Lets say now I have 500.000 tables and just a normal Mac Pro. I thought of using <em>ThreadPool</em>, however, if some error occurs in the <em>thread</em> it is not shown. In comparison if I use just threads the error is still shown.Is there any gem that can help me to use thread pool and that will throw an error if it occurs in one of the threads.</p>\n\n<p>Regarding not showing the error, consider following:</p>\n\n<pre><code>require 'thread/pool' # from the ruby-thread gem\npool = Thread.pool(4)\npool.process do \n puts(b)\nend\n</code></pre>\n\n<p><em>b</em> is not specified but it does not show me the normal error message.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jobs", "rails-activejob"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1496151391, "post_id": 44263566, "comment_id": 75535654, "body": "I doubt you want to sink in <code>Float</code> comparison, which basically has a lot of drawbacks. I would strongly advise to stick with what you currently have, since comparing <code>Date</code>s is way more robust for the test purposes, then comparing <i>milliseconds</i>. OTOH, <code>:at</code> parameter might be anything before <code>tomorrow</code>, so one might use <code>Date.tomorrow.noon</code> or like, as shown in <a href=\"http://api.rubyonrails.org/classes/ActiveJob/TestHelper.html#method-i-assert_enqueued_with\" rel=\"nofollow noreferrer\">Rails docs</a>."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1496151804, "post_id": 44263566, "comment_id": 75535979, "body": "can you show me how <code>start_onboarding</code> enqueues the job please"}, {"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1496152426, "post_id": 44263566, "comment_id": 75536439, "body": "@Anthony <code>start_onboarding</code> is just an event call from AASM gem, but I&#39;ve added the method which actually schedules the mailer"}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1496154876, "post_id": 44264393, "comment_id": 75538347, "body": "That makes a lot of sense. There are some inconsistencies left though. For some reason <code>:at</code> is 1 hour earlier than <code>tomorrow</code>. Not sure why timezones are different as <code>Job</code> has <code>+0100</code> and just adding an hour to <code>tomorrow</code> doesn&#39;t fix it due to timezone differences I assume..."}, {"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1496155098, "post_id": 44264393, "comment_id": 75538517, "body": "Hm even if I get the times the same, it&#39;s still not equal... <code>tomorrow.to_time == Time.at(job_date)</code>, both are of class <code>Time</code> and both are <code>2017-05-31 15:33:38 +0100</code>"}, {"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1496156591, "post_id": 44264393, "comment_id": 75539637, "body": "Alright, it seems it&#39;s due to floats not being the same. I don&#39;t see the way to make them exactly the same and it just seems like a waste of time. Any idea how to not have such strict comparison?"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "reply_to_user": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 1, "creation_date": 1496156682, "post_id": 44264393, "comment_id": 75539716, "body": "Ya, likely that the test is run with one time and then a few milliseconds later the job is enqueued with another time.  You&#39;re better offer to use <a href=\"https://github.com/travisjeffery/timecop#usage\" rel=\"nofollow noreferrer\"><code>Timecop</code></a> to stub time in your tests but at least you found your problem :)"}, {"owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1496157019, "post_id": 44264393, "comment_id": 75539966, "body": "How would you recommend using <code>Timecop</code>? I am not overly familiar with it"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "reply_to_user": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "edited": false, "score": 0, "creation_date": 1496157786, "post_id": 44264393, "comment_id": 75540470, "body": "Added an example"}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 1, "last_activity_date": 1496157720, "last_edit_date": 1496157720, "creation_date": 1496152843, "answer_id": 44264393, "question_id": 44263566, "link": "https://stackoverflow.com/questions/44263566/in-what-format-is-activejob-at-key/44264393#44264393", "title": "In what format is ActiveJob :at key", "body": "<p>The argument for the <code>wait_until</code> method needs to match what your test uses.  The date serialized into the queue does get turned into a float by <a href=\"https://github.com/rails/rails/blob/102ee4055770813c847c95d3d6ff8741c33597d8/activejob/lib/active_job/enqueuing.rb#L44\" rel=\"nofollow noreferrer\">rails</a>.  And in your <code>#notify</code> method, you're passing in a <code>ActiveSupport::TimeWithZone</code> instance when your test is passing in a <code>Date</code> instance.</p>\n\n<p>See here:</p>\n\n<pre><code>1.day.from_now\n=&gt; Wed, 31 May 2017 13:56:36 UTC +00:00\n1.day.from_now.class\n=&gt; ActiveSupport::TimeWithZone\n1.day.from_now.to_date\n=&gt; Wed, 31 May 2017\n1.day.from_now.to_date.class\n=&gt; Date\n1.day.from_now == 1.day.from_now.to_date\n=&gt; false\n</code></pre>\n\n<p>That means your job is getting enqueued with time information but your test is expecting a simple date.  I'm not sure which is more correct the test date or the code date but they need to match for this test to pass.</p>\n\n<p>Per the comments, here's how you might use <a href=\"https://github.com/travisjeffery/timecop#usage\" rel=\"nofollow noreferrer\"><code>Timecop</code></a> to help you out:</p>\n\n<pre><code>  tomorrow = 1.day.from_now.to_date\n  Timecop.freeze(tomorrow)\n  assert_enqueued_with(job: ActionMailer::DeliveryJob, at: tomorrow) do\n    onboarding.start_onboarding\n  end\n  Timecop.return\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 445, "user_id": 8018505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b91738cee0a49bbbf95faf11cf9bc5a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Coleman", "link": "https://stackoverflow.com/users/8018505/paul-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1496152985, "creation_date": 1496152985, "answer_id": 44264452, "question_id": 44263566, "link": "https://stackoverflow.com/questions/44263566/in-what-format-is-activejob-at-key/44264452#44264452", "title": "In what format is ActiveJob :at key", "body": "<p>The <strong>at</strong> option should be a Time.</p>\n\n<p>See an example in the docs <a href=\"http://www.rubydoc.info/gems/activejob/5.0.0/ActiveJob%2FTestHelper%3Aassert_enqueued_with\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 1281, "user_id": 2308531, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/DV29D.jpg?s=128&g=1", "display_name": "Maxim Fedotov", "link": "https://stackoverflow.com/users/2308531/maxim-fedotov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 44264393, "answer_count": 2, "score": 3, "last_activity_date": 1496157720, "creation_date": 1496150684, "last_edit_date": 1496152393, "question_id": 44263566, "link": "https://stackoverflow.com/questions/44263566/in-what-format-is-activejob-at-key", "title": "In what format is ActiveJob :at key", "body": "<p>I am trying to understand in what format <code>:at</code> for <code>ActiveJob</code> is, so I can use <code>assert_enqueued_with</code> with <code>:at</code> parameter. </p>\n\n<p>Currently I've got this test which passes:</p>\n\n<pre><code>tomorrow = 1.day.from_now.to_date\nassert_enqueued_with(job: ActionMailer::DeliveryJob) do\n  onboarding.start_onboarding\n  job_date = ActiveJob::Base.queue_adapter.enqueued_jobs[0][:at]\n  assert_equal tomorrow, Time.at(job_date).to_date\nend\n</code></pre>\n\n<p>But then I've realised that <code>assert_enqueued_with</code> has <code>:at</code> parameter and I would prefer to use it instead of last two lines in the block. Problem is, <code>tomorrow</code> variable seems to be in a different format than <code>:at</code>, which makes this fail: </p>\n\n<pre><code>tomorrow = 1.day.from_now.to_date\nassert_enqueued_with(job: ActionMailer::DeliveryJob, at: tomorrow) do\n  onboarding.start_onboarding\nend\n</code></pre>\n\n<p>with this error:</p>\n\n<pre><code>Minitest::Assertion: No enqueued job found with {:job=&gt;ActionMailer::DeliveryJob, :at=&gt;Wed, 31 May 2017 13:12:05 UTC +00:00}\n</code></pre>\n\n<p>As you can see, <code>tomorrow</code> is a date, say <code>Wed, 31 May 2017</code>, while <code>job_date</code> is some kind of a large number, say <code>1496236366.183789</code>. Hence I am trying to convert <code>tomorrow</code> into the same format.</p>\n\n<p>Would really appreciate some help with this. Perhaps I am using <code>:at</code> wrongly or you know what format <code>:at</code> in and help me convert <code>tomorrow</code>.</p>\n\n<p><code>start_onboarding</code> is just a AASM event, which calls this method to schedule email delivery (a bit modified for privacy reasons):</p>\n\n<pre><code>def notify(id)\n  person = User.find(id) \n  PersonMailer.onboarding_reminder(person).\n    deliver_later(wait_until: 1.day.from_now)\nend\n</code></pre>\n"}, {"tags": ["ruby", "algorithm"], "comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1496149438, "post_id": 44263031, "comment_id": 75534114, "body": "<code>len(x)</code>? That sounds like Python"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1496149552, "post_id": 44263031, "comment_id": 75534197, "body": "@Ursus it sounds like self-implemented method, check the last 3 lines of the snippet."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7394636, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CMJP4.jpg?s=128&g=1", "display_name": "0sfh", "link": "https://stackoverflow.com/users/7394636/0sfh"}, "edited": false, "score": 0, "creation_date": 1496151028, "post_id": 44263335, "comment_id": 75535365, "body": "thanks its working I should have known when it printed <code>[[1, 3], [1, 4], [2, 3], [2, 4]]</code> and stopped"}, {"owner": {"reputation": 13, "user_id": 7394636, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CMJP4.jpg?s=128&g=1", "display_name": "0sfh", "link": "https://stackoverflow.com/users/7394636/0sfh"}, "edited": false, "score": 0, "creation_date": 1496151091, "post_id": 44263335, "comment_id": 75535408, "body": "but why isn&#39;t <code>each</code> working when I have to just iterate over each value and pass it to <code>mult(x,y)</code> method."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 13, "user_id": 7394636, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CMJP4.jpg?s=128&g=1", "display_name": "0sfh", "link": "https://stackoverflow.com/users/7394636/0sfh"}, "edited": false, "score": 0, "creation_date": 1496151252, "post_id": 44263335, "comment_id": 75535537, "body": "Because <code>each</code> returns the iterable itself, while <code>map</code> actually transforms the iterable to new values, returned from the <code>mult</code> method."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1496150069, "creation_date": 1496150069, "answer_id": 44263335, "question_id": 44263031, "link": "https://stackoverflow.com/questions/44263031/method-not-returning-the-expected-value-in-ruby/44263335#44263335", "title": "Method not returning the expected value in Ruby", "body": "<p>The problem is wrong iterator:</p>\n\n<pre><code>#              \u21d3\u21d3\u21d3\u21d3    \nab.product(cd).each{ |num| mult(num[0],num[1]) }\n</code></pre>\n\n<p>What you want is to <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>Enumerable#map</code></a> instead:</p>\n\n<pre><code>ab.product(cd).map { |num| mult(num[0], num[1]) }\n</code></pre>\n\n<p><em>Sidenote:</em> you also don\u2019t need to explicitly call <code>return</code>:</p>\n\n<pre><code>def mult (x,y)\n  if len(x) == 1 &amp;&amp; len(y) == 1\n    x*y\n  elsif len(x) &gt; 1 &amp;&amp; len(y) &gt; 1\n    ab = partition(x)\n    cd = partition(y)\n    ab.product(cd).map { |num| mult(num[0], num[1]) }\n  else\n    raise \"We got a problem\"\n  end\nend\n#method for partitioning works fine..\ndef partition(number)\n  number.divmod( 10**(len(number)/2) )\nend\n#method to find size of integer works fine...\ndef len(value)\n  value.to_s.size\nend\n\np mult 12, 34\n#\u21d2\u00a0[3,4,6,8]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7394636, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CMJP4.jpg?s=128&g=1", "display_name": "0sfh", "link": "https://stackoverflow.com/users/7394636/0sfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44263335, "answer_count": 1, "score": 1, "last_activity_date": 1496150069, "creation_date": 1496149302, "question_id": 44263031, "link": "https://stackoverflow.com/questions/44263031/method-not-returning-the-expected-value-in-ruby", "title": "Method not returning the expected value in Ruby", "body": "<p>I was trying to implement Karatsuba multiplication in Ruby..</p>\n\n<pre><code># takes two integer x and y and partition them to x=a+b and y=c+d\n# example if x = 1234 a=12 and b=34\n# recursively compute a*c,a*d,b*c and b*d\ndef mult (x,y)\n    if len(x) == 1 &amp;&amp; len(y) == 1\n             return  x*y \n       elsif len(x) &gt; 1 &amp;&amp; len(y) &gt; 1\n             ab = partition(x)\n             cd =  partition(y)\n             return ab.product(cd).each{ |num| mult(num[0],num[1]) }\n       end\nend\n#method for partitioning works fine..\ndef partition(number)\n     number.divmod( 10**(len(number)/2) )\nend\n#method to find size of integer works fine...\ndef len(value)\n    value.to_s.split(\"\").compact.size\nend\n</code></pre>\n\n<p>So the expected return for</p>\n\n<pre><code> p mult(12,34) should be 3,4,6,8\n but is [[1, 3], [1, 4], [2, 3], [2, 4]]\n</code></pre>\n\n<p>instead of <code>return x*y</code>, when i use <code>print \"#{x*y}\"</code> in <code>line no:3</code> it prints 3,4,6,8. I am unable to understand why <code>mult</code> method is returning <code>nil</code> for <code>x*y</code>. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1496152110, "post_id": 44262910, "comment_id": 75536210, "body": "<code>protocol</code> is an anticipated key in <code>url_for</code> to specify the web protocol e.g. <code>http</code>,<code>https</code>, <code>ftp</code> etc. if you wanted to implement your own query parameter why not call it something other than &quot;protocol&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 6290418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1397498576945426/picture?type=large", "display_name": "Kapitula Alexey", "link": "https://stackoverflow.com/users/6290418/kapitula-alexey"}, "is_accepted": true, "score": 2, "last_activity_date": 1496149547, "creation_date": 1496149547, "answer_id": 44263120, "question_id": 44262910, "link": "https://stackoverflow.com/questions/44262910/rails-url-for-hash-with-protocol-key/44263120#44263120", "title": "Rails url_for hash with &#39;protocol&#39; key", "body": "<p>I used next oneliner to solve protocol option issue:</p>\n\n<pre><code>url_for() + '?' + @params.merge({:protocol =&gt; 1}).to_query\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 6290418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1397498576945426/picture?type=large", "display_name": "Kapitula Alexey", "link": "https://stackoverflow.com/users/6290418/kapitula-alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 44263120, "answer_count": 1, "score": 1, "last_activity_date": 1496161630, "creation_date": 1496148969, "last_edit_date": 1496161630, "question_id": 44262910, "link": "https://stackoverflow.com/questions/44262910/rails-url-for-hash-with-protocol-key", "title": "Rails url_for hash with &#39;protocol&#39; key", "body": "<p>I'm trying to add parameters to the current path through hash:</p>\n\n<pre><code>url_for(@params.merge({'protocol' =&gt; 1}))\n</code></pre>\n\n<p>but it seems that Rails filters protocol hash key and the result has no protocol parameter.\nHow can I add it to the current path?</p>\n"}, {"tags": ["html", "css", "ruby", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8084696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24974cbc86de72ba52253c48bceaf965?s=128&d=identicon&r=PG&f=1", "display_name": "Dundee", "link": "https://stackoverflow.com/users/8084696/dundee"}, "is_accepted": false, "score": 1, "last_activity_date": 1496175377, "last_edit_date": 1496175377, "creation_date": 1496150400, "answer_id": 44263462, "question_id": 44262548, "link": "https://stackoverflow.com/questions/44262548/nomethoderror-undefined-method-parent-for-nokogirixmlnodeset0x007fbefe/44263462#44263462", "title": "NoMethodError: undefined method `parent&#39; for #&lt;Nokogiri::XML::NodeSet:0x007fbefee5e420&gt;", "body": "<p>I think I found an answer:</p>\n\n<pre><code>doc.css('html').each do |element|\n images = element.css('img.article_img')\n images.each do |node|\n    parent = node.parent\n    parent.before(node)\n end\nend\n</code></pre>\n\n<p>and shorter version</p>\n\n<pre><code>doc.css('html').each do |element|\n  element.css('img.article_img').each do |node|\n    node.parent.before(node)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1496263172, "last_edit_date": 1496263172, "creation_date": 1496262798, "answer_id": 44294192, "question_id": 44262548, "link": "https://stackoverflow.com/questions/44262548/nomethoderror-undefined-method-parent-for-nokogirixmlnodeset0x007fbefe/44294192#44294192", "title": "NoMethodError: undefined method `parent&#39; for #&lt;Nokogiri::XML::NodeSet:0x007fbefee5e420&gt;", "body": "<p>Here's how I'd do it:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML(&lt;&lt;EOT)\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;div&gt;       \n      &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;&lt;/p&gt;\n      &lt;img class=\"article_img\" src=\"image.jpg\"&gt;\n      &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;\n      &lt;img class=\"article_img\" src=\"image.png\"&gt;\n      &lt;/p&gt;        \n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\nEOT\n\nimg = doc.at('img.article_img')\nimg.parent.add_previous_sibling(img)\nputs doc.to_html\n\n# &gt;&gt; &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"&gt;\n# &gt;&gt; &lt;html&gt;\n# &gt;&gt;   &lt;body&gt;\n# &gt;&gt;     &lt;img class=\"article_img\" src=\"image.jpg\"&gt;&lt;div&gt;       \n# &gt;&gt;       &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;&lt;/p&gt;\n# &gt;&gt;       \n# &gt;&gt;       &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;\n# &gt;&gt;       &lt;img class=\"article_img\" src=\"image.png\"&gt;\n# &gt;&gt;       &lt;/p&gt;        \n# &gt;&gt;     &lt;/div&gt;\n# &gt;&gt;   &lt;/body&gt;\n# &gt;&gt; &lt;/html&gt;\n</code></pre>\n\n<p><code>doc.at('img.article_img')</code> finds the first <code>&lt;img class=\"article_img\"...&gt;</code>. </p>\n\n<p>We're left with a gap in the HTML because there's a trailing Text node containing the formatting seen in the \"pretty HTML\". Fixing that is left as an exercise for the reader.</p>\n"}], "owner": {"reputation": 21, "user_id": 8084696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24974cbc86de72ba52253c48bceaf965?s=128&d=identicon&r=PG&f=1", "display_name": "Dundee", "link": "https://stackoverflow.com/users/8084696/dundee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1496263172, "creation_date": 1496147950, "question_id": 44262548, "link": "https://stackoverflow.com/questions/44262548/nomethoderror-undefined-method-parent-for-nokogirixmlnodeset0x007fbefe", "title": "NoMethodError: undefined method `parent&#39; for #&lt;Nokogiri::XML::NodeSet:0x007fbefee5e420&gt;", "body": "<p>I have a problem. I should read a html which contains an image with a class name 'article_img' and I should be able to put it as a sibling of its parent. My code works, but it puts in my test.html both images on the same level with the 'div' instead of putting the other 'img' on the same level with the 'p'</p>\n\n<p>Here is my code:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = File.open('test.html') { |f| Nokogiri::HTML(f)}\n\ndoc.css('html').each do |element|\n    img = element.css('img.article_img')\n    parent = img.first.parent\n    parent.before(img)\nend\n</code></pre>\n\n<p>and here is my example html</p>\n\n<pre><code>&lt;div&gt;       \n    &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;&lt;/p&gt;\n\n    &lt;img class=\"article_img\" src=\"image.jpg\"&gt;\n\n    &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;\n        &lt;img class=\"article_img\" src=\"image.png\"&gt;\n    &lt;/p&gt;        \n\n&lt;/div&gt;\n</code></pre>\n\n<p>Result should be like this:</p>\n\n<pre><code>&lt;img class=\"article_img\" src=\"image.jpg\"&gt;\n\n&lt;div&gt;       \n    &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;&lt;/p&gt;\n\n    &lt;img class=\"article_img\" src=\"image.png\"&gt;\n\n    &lt;p&gt;Lorem ipsum jne...&lt;a href=\"#\"&gt;link&lt;/a&gt;&lt;/p&gt;       \n\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["php", "ruby", "node.js", "smpp"], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 10095046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b611af805e1af779d58f651e71967f?s=128&d=identicon&r=PG&f=1", "display_name": "Kemal Atik", "link": "https://stackoverflow.com/users/10095046/kemal-atik"}, "is_accepted": false, "score": 0, "last_activity_date": 1546507192, "last_edit_date": 1546507192, "creation_date": 1546411379, "answer_id": 54002274, "question_id": 44261906, "link": "https://stackoverflow.com/questions/44261906/creating-a-smpp-server-using-http-api/54002274#54002274", "title": "Creating a SMPP Server using HTTP API", "body": "<p>Actually doing it in vice versa way would be more easier for your <a href=\"https://en.wikipedia.org/wiki/External_Short_Messaging_Entity\" rel=\"nofollow noreferrer\">ESME</a> applications to work; external applications send SMS via HTTP API to your SMPP Gateway, your SMPP Gateway validates external application and message, returns either ACK or NACK with message tracking Id, then forwards it to SMSC using SMPP protocol. Regarding your questions:</p>\n\n<ol>\n<li><p>You need to choose SMPP API implementation, there are many as open source with <a href=\"https://github.com/twitter-archive/cloudhopper-smpp/blob/master/src/test/java/com/cloudhopper/smpp/demo/ServerMain.java\" rel=\"nofollow noreferrer\">samples</a>.</p></li>\n<li><p>If you investigate the source code I provided above, for each successful session creation new SMPP session handler object is created. This handler object has the callback methods that are fired when SMPP message is received from the client. API itself is managing multiple socket connections on behalf of you and you should take care the validating SMPP bind parameters in <em>sessionBindRequested</em> , SMPP messages you get(<em>firePduRequestReceived</em>) and responses Server should sent using the API. There are many other SMPP APIs so it is required to  investigate the messaging model of them with the user application.</p></li>\n<li><p>There are many open source SMPP API implementations but as a complete custom solution you would like to have I don't think you can find as open source.</p></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 6619046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7239406dfdbf819a692943ab03f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijith Nair", "link": "https://stackoverflow.com/users/6619046/abhijith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1089, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1546507192, "creation_date": 1496146253, "question_id": 44261906, "link": "https://stackoverflow.com/questions/44261906/creating-a-smpp-server-using-http-api", "title": "Creating a SMPP Server using HTTP API", "body": "<p>I have a SMS API that supports JSON via HTTP protocol. It receives SMS request from clients in JSON format and forward it to Gateway/SMSC using my own script.\nNow I am trying to develop a SMPP Server for one of our client where the client can connect to us using SMPP protocol.</p>\n\n<p>I am planning to submit the messages to gateways/SMSC using the existing HTTP API. Basically HTTP api inside SMPP server. In that case I don't need to write any addition code for credit management. </p>\n\n<p>It should work like, </p>\n\n<ol>\n<li><p>Receive request from the client via SMPP</p></li>\n<li><p>Validate client information </p></li>\n<li><p>Forward the message to the HTTP API</p></li>\n<li><p>Get the status of message using HTTP API</p></li>\n<li><p>Send status response to the client using SMPP.</p></li>\n</ol>\n\n<p>My questions are,</p>\n\n<ol>\n<li><p>How do I create a SMPP server so that other client could connect to my application using SMPP?</p></li>\n<li><p>How can I manage multiple clients binding to the server?</p></li>\n<li><p>Is there any open source SMPP Server?</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "erd"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 1, "creation_date": 1496145067, "post_id": 44261450, "comment_id": 75530740, "body": "<code>it looks like a spider net.</code> If your DB model is complex enough, what else do you expect?"}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1496145200, "post_id": 44261450, "comment_id": 75530831, "body": "Hi emaillenin, I want it to be easy to view &amp; understand the relationship (for new guy who recently joins to project), or at least adding some color into the ERD file, currently <code>rails-erd</code> only have black &amp; white"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1496145280, "post_id": 44261450, "comment_id": 75530895, "body": "try grouping a smaller set of related tables and generate diagram only for that"}, {"owner": {"reputation": 289, "user_id": 4810811, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vXi1E0cZ7Tw/AAAAAAAAAAI/AAAAAAAAAIE/52imSQINK8Q/photo.jpg?sz=128", "display_name": "Niklas", "link": "https://stackoverflow.com/users/4810811/niklas"}, "edited": false, "score": 1, "creation_date": 1496150679, "post_id": 44261450, "comment_id": 75535102, "body": "Or maybe try <a href=\"http://railroady.prestonlee.com/\" rel=\"nofollow noreferrer\">railroady.prestonlee.com</a>"}, {"owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "reply_to_user": {"reputation": 289, "user_id": 4810811, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vXi1E0cZ7Tw/AAAAAAAAAAI/AAAAAAAAAIE/52imSQINK8Q/photo.jpg?sz=128", "display_name": "Niklas", "link": "https://stackoverflow.com/users/4810811/niklas"}, "edited": false, "score": 0, "creation_date": 1496195665, "post_id": 44261450, "comment_id": 75556426, "body": "@Niklas thank you, this gem works like a charm, it&#39;s perfect"}], "owner": {"reputation": 193, "user_id": 3598009, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bccf5ee83ad1ee0ab64b9cf41de9b395?s=128&d=identicon&r=PG&f=1", "display_name": "BraveVN", "link": "https://stackoverflow.com/users/3598009/bravevn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496144971, "creation_date": 1496144971, "question_id": 44261450, "link": "https://stackoverflow.com/questions/44261450/rails-auto-generated-readable-erd-with-large-database", "title": "Rails - Auto generated readable ERD with large database", "body": "<p>I have a database with ~50 tables and many complicated relationships, I want to generate an ERD of my DB so I use a gem named <code>rails-erd</code> (source: <a href=\"https://github.com/voormedia/rails-erd\" rel=\"nofollow noreferrer\">https://github.com/voormedia/rails-erd</a>).<br>\nHowever because of the large DB so the result ERD is not readable and it looks like a spider net. I wonder is there's any other gem out there which you can suggest me to use ?<br>\nThank you. </p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8085745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f90a3ff9e3a76be34c139db0a245efd?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/8085745/jhj"}, "edited": false, "score": 0, "creation_date": 1496384174, "post_id": 44260791, "comment_id": 75649034, "body": "so I guess the answer then is no, you must search the process tree"}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": false, "score": 2, "last_activity_date": 1496143037, "creation_date": 1496143037, "answer_id": 44260791, "question_id": 44260475, "link": "https://stackoverflow.com/questions/44260475/killing-forked-process-in-ruby-with-child-processes/44260791#44260791", "title": "Killing forked process in ruby with child processes", "body": "<blockquote>\n  <p>Behind the scene both system and backtick operations use fork to fork\n  the current process and then they execute the given operation using\n  exec .</p>\n  \n  <p>Since exec replaces the current process it does not return anything if\n  the operation is a success. If the operation fails then\n  `SystemCallError is raised.</p>\n</blockquote>\n\n<p><a href=\"http://blog.bigbinary.com/2012/10/18/backtick-system-exec-in-ruby.html\" rel=\"nofollow noreferrer\">http://blog.bigbinary.com/2012/10/18/backtick-system-exec-in-ruby.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 1747, "user_id": 1028419, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/7LiDK.png?s=128&g=1", "display_name": "Sam Woods", "link": "https://stackoverflow.com/users/1028419/sam-woods"}, "is_accepted": false, "score": 2, "last_activity_date": 1505940109, "creation_date": 1505940109, "answer_id": 46331426, "question_id": 44260475, "link": "https://stackoverflow.com/questions/44260475/killing-forked-process-in-ruby-with-child-processes/46331426#46331426", "title": "Killing forked process in ruby with child processes", "body": "<p>You can use </p>\n\n<pre><code>pid = Process.spawn('sleep 20')\n</code></pre>\n\n<p>to get the PID of the process immediately.  Your code above would change to:</p>\n\n<pre><code>pid = Process.spawn('sleep 20')\nsleep(1)\nProcess.kill('HUP',pid)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8085745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f90a3ff9e3a76be34c139db0a245efd?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/8085745/jhj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1505940109, "creation_date": 1496142216, "question_id": 44260475, "link": "https://stackoverflow.com/questions/44260475/killing-forked-process-in-ruby-with-child-processes", "title": "Killing forked process in ruby with child processes", "body": "<p>The following code forks the main processes and runs a command in backticks. The kill at the end of the script only kills the forked process but not it's child processes (i.e. the sleep command).</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>pid = fork do\n  Thread.new do\n    `sleep 20`\n  end\nend\nsleep(1)\nProcess.kill(\"HUP\",pid)\n</code></pre>\n\n<p>Is there a way to kill all child processes (generated by backtick commands in threads in the forked process) other than searching through the process tree?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496141961, "post_id": 44260139, "comment_id": 75528569, "body": "A bit of advice for the future: post clean, properly formatted code. That noise from IRB is useless (in fact, it distracts very much from reading the code)"}, {"owner": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "edited": false, "score": 0, "creation_date": 1496142075, "post_id": 44260139, "comment_id": 75528646, "body": "What&#39;s the logic behind that structure? Do you need to filter all keys that have a hash value first, because it seems that you can&#39;t simply access <code>hash[:key2].values</code>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "edited": false, "score": 0, "creation_date": 1496142310, "post_id": 44260139, "comment_id": 75528795, "body": "@Ja\u0362ck: do you mean &quot;you can simply access&quot;? :)"}, {"owner": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496142450, "post_id": 44260139, "comment_id": 75528871, "body": "@SergioTulentsev Yes (because in this example that would be the obvious approach), and no (because it&#39;s probably meant to be more dynamic) :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7826796"}, "edited": false, "score": 0, "creation_date": 1496142998, "post_id": 44260139, "comment_id": 75529245, "body": "Thanks guys! So much to learn still! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7826796"}, "edited": false, "score": 0, "creation_date": 1496148711, "post_id": 44260139, "comment_id": 75533560, "body": "Ow wow, my whole question got rewritten... I fully get the purpose of clean, properly formatted code but I also want to add a remark:  I often feel like there is information missing that experienced programmers perhaps take for granted. As a beginner I often get confused to where code should go. I&#39;ve found that the noise sometimes acts as hints to tell me where it supposed to go. Just my 2 cents not to go overboard with cleaning."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1496171232, "post_id": 44260288, "comment_id": 75548097, "body": "...or <code>val3, val4 = hash[:key2].values_at(:key3, :key4)</code>"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 1, "last_activity_date": 1496142277, "last_edit_date": 1496142277, "creation_date": 1496141698, "answer_id": 44260288, "question_id": 44260139, "link": "https://stackoverflow.com/questions/44260139/looping-through-a-nested-hash/44260288#44260288", "title": "Looping through a nested hash", "body": "<pre><code>{key1: \"value1\", key2: {key3: \"value2\", key4: \"value3\"}}\n</code></pre>\n\n<p>Your hash is not consistent hash of hashes, in the first iteration, <code>value</code> is <code>value1</code> which is a string, and you cannot iterate over a <code>string</code>.</p>\n\n<p>to avoid that, you can check beforehand like,</p>\n\n<pre><code>hash.each do |key,value|\n  p key\n  if value.is_a?(Hash)\n    value.each do |k,v|\n      p k\n      p v\n    end\n  else\n    p value\n  end\nend\n</code></pre>\n\n<blockquote>\n  <p>My goal is to access the values of key3 and key4. (I want to put them in a variable of some kind to be used elsewhere)</p>\n</blockquote>\n\n<p>you can traverse a hash based on key associations. As per your need above, you can simply do:</p>\n\n<pre><code>hash[:key2][:key3]\n#=&gt; \"value2\"\nhash[:key2][:key4]\n#=&gt; \"value3\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7826796"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1942, "favorite_count": 0, "accepted_answer_id": 44260288, "answer_count": 1, "score": 0, "last_activity_date": 1496146588, "creation_date": 1496141275, "last_edit_date": 1496146588, "question_id": 44260139, "link": "https://stackoverflow.com/questions/44260139/looping-through-a-nested-hash", "title": "Looping through a nested hash", "body": "<p>I have:</p>\n\n<pre><code>hash = {key1: \"value1\", key2: {key3: \"value2\", key4: \"value3\"}}\n</code></pre>\n\n<p>My goal is to access the values of <code>key3</code> and <code>key4</code>.</p>\n\n<p>My code is:</p>\n\n<pre><code>hash.each do |key, value|\n  puts key\n  value.each do |k, v|\n    puts k\n    puts v\n  end\nend\n</code></pre>\n\n<p>I get an output with error:</p>\n\n<pre><code>key1\nNoMethodError: undefined method `each' for \"value1\":String\n</code></pre>\n\n<p>Can someone explain what is going on, and why I am getting this error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "wkhtmltopdf"], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 1592591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2d32ac48d24c7313d703b09b9d6ea7?s=128&d=identicon&r=PG", "display_name": "Sujay Gavhane", "link": "https://stackoverflow.com/users/1592591/sujay-gavhane"}, "is_accepted": false, "score": 0, "last_activity_date": 1496147024, "creation_date": 1496147024, "answer_id": 44262181, "question_id": 44259975, "link": "https://stackoverflow.com/questions/44259975/rails-wkhtmltopdf-binary-gem-not-render-images-from-https/44262181#44262181", "title": "rails wkhtmltopdf-binary gem not render images from https", "body": "<p>The wkhtmltopdf binary is run outside of your Rails application; therefore, your normal layouts will not work. If you plan to use any CSS, JavaScript, or image files, you must modify your layout so that you provide an absolute reference to these files. The best option for Rails without the asset pipeline is to use the wicked_pdf_stylesheet_link_tag, wicked_pdf_image_tag, and wicked_pdf_javascript_include_tag helpers or to go straight to a CDN (Content Delivery Network) for popular libraries such as jQuery.</p>\n\n<p>if you want to load images then you can do following</p>\n\n<p><code>&lt;%= wicked_pdf_image_tag 'mysite.jpg' %&gt;</code></p>\n\n<p>Check this link <a href=\"https://github.com/mileszs/wicked_pdf\" rel=\"nofollow noreferrer\">https://github.com/mileszs/wicked_pdf</a></p>\n"}], "owner": {"reputation": 4194, "user_id": 2071433, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d0cb7ef38e8c77c87efe81c2d6e8df30?s=128&d=identicon&r=PG", "display_name": "Learner", "link": "https://stackoverflow.com/users/2071433/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 515, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496147024, "creation_date": 1496140858, "last_edit_date": 1496145185, "question_id": 44259975, "link": "https://stackoverflow.com/questions/44259975/rails-wkhtmltopdf-binary-gem-not-render-images-from-https", "title": "rails wkhtmltopdf-binary gem not render images from https", "body": "<p>I am using <code>wkhtmltopdf-binary</code> gem in my rails application to convert the html pages to pdf and it was working(relative path) until I render the images from https(absolute path).</p>\n\n<p>So it is working if the images are from the application and not working the images coming from http or https when export as pdf.</p>\n\n<p>Is there any way I can get the images from external sites like <code>http, https</code>?</p>\n"}, {"tags": ["ruby", "rspec", "factory-bot"], "answers": [{"comments": [{"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "edited": false, "score": 0, "creation_date": 1496141307, "post_id": 44260046, "comment_id": 75528113, "body": "working solution, i&#39;ll approve it, but isn&#39;t there any other solution to actually reload it manually via RSpec ?"}, {"owner": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "reply_to_user": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "edited": false, "score": 0, "creation_date": 1496141432, "post_id": 44260046, "comment_id": 75528209, "body": "@Laurent Perhaps your example is very minimal, but why test a controller three times, and then check whether it was done three times? Why not just test it once?"}, {"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "edited": false, "score": 0, "creation_date": 1496141625, "post_id": 44260046, "comment_id": 75528341, "body": "Yes the tests set was shortened, I&#39;m already testing with one request before. I&#39;m testing it this way because there&#39;s a fat order assignment logic beneath all that and I need to make sure it acts correctly when you add successively the items .."}, {"owner": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "reply_to_user": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "edited": false, "score": 0, "creation_date": 1496141738, "post_id": 44260046, "comment_id": 75528419, "body": "@Laurent okay, just saying that based on the question alone, there seems to be little merit to testing successive creation"}], "tags": [], "owner": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "is_accepted": true, "score": 2, "last_activity_date": 1496141545, "last_edit_date": 1496141545, "creation_date": 1496141073, "answer_id": 44260046, "question_id": 44259942, "link": "https://stackoverflow.com/questions/44259942/rspec-keeps-instance-variable-between-post-requests/44260046#44260046", "title": "RSpec keeps instance variable between post requests", "body": "<p>What happens here is that RSpec doesn't create new controller instances within your example; you could overcome this by leaking some of that logic into your tests:</p>\n\n<pre><code>controller.instance_variable_set(:@order, nil)\n</code></pre>\n\n<p>Perhaps the code was shortened for this particular question, but would you consider testing the controller for a single action?</p>\n\n<pre><code>package_set = FactoryGirl.create(:package_set)\nexpect do\n  post :create, {'package_set_id': package_set.id }\nend.to change(Order, :count).by(1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "edited": false, "score": 1, "creation_date": 1496141509, "post_id": 44260125, "comment_id": 75528264, "body": "That&#39;s not ideal because it moves the controller logic within the test which might makes problems later on, but the idea is here. I wanted to avoid to do that but I see there&#39;s not much else to do ..."}], "tags": [], "owner": {"reputation": 1362, "user_id": 2320744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ade05a3f9049c069fc845f7529a7423?s=128&d=identicon&r=PG", "display_name": "Mathias Vonende", "link": "https://stackoverflow.com/users/2320744/mathias-vonende"}, "is_accepted": false, "score": 0, "last_activity_date": 1496141256, "creation_date": 1496141256, "answer_id": 44260125, "question_id": 44259942, "link": "https://stackoverflow.com/questions/44259942/rspec-keeps-instance-variable-between-post-requests/44260125#44260125", "title": "RSpec keeps instance variable between post requests", "body": "<p>You could reset the <code>@order</code> variable in a <a href=\"https://relishapp.com/rspec/rspec-core/v/2-2/docs/hooks/before-and-after-hooks#define-before(:each)-block\" rel=\"nofollow noreferrer\">before</a>-block:</p>\n\n<pre><code>describe Class do\n    before(:each) do\n        @order = Order.new()\n    end\n\n    context \"with multiple package sets from different shops\" do\n        #...\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 1998, "user_id": 1920622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e79e2b4b00afb2d10594b1894cb7df87?s=128&d=identicon&r=PG", "display_name": "Laurent", "link": "https://stackoverflow.com/users/1920622/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 44260046, "answer_count": 2, "score": 1, "last_activity_date": 1496141545, "creation_date": 1496140776, "question_id": 44259942, "link": "https://stackoverflow.com/questions/44259942/rspec-keeps-instance-variable-between-post-requests", "title": "RSpec keeps instance variable between post requests", "body": "<p>In a specific test, I want to add multiples items (<code>package_sets</code>) in some orders from my site.</p>\n\n<p>To test it, I do as follow</p>\n\n<pre><code>  context \"with multiple package sets from different shops\" do\n\n    let(:package_sets) { FactoryGirl.create_list(:package_set, 3) }\n\n    it \"adds package sets to multiple orders\" do\n      package_sets.each do |package_set|\n        post :create, {'package_set_id': package_set.id}\n        expect_json(success: true)\n      end\n      expect(Order.count).to eq(3)\n    end\n\n  end\n</code></pre>\n\n<p>In the real world, each time I call <code>post :create</code> it will assign the package set to a different order ; the total number of orders should be 3.</p>\n\n<p>In my controller I memoize the order within a method like this</p>\n\n<pre><code>def order\n   @order ||= cart_manager.order(shop: package_set.shop, call_api: false)\nend\n</code></pre>\n\n<p>Because it's 3 different requests, I was expecting the test to reload this method too without memoization, but it keeps the <code>@order</code> memoized between the the <code>post</code> requests which makes the test fails.</p>\n\n<p>How do you prevent this ?</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "edited": false, "score": 0, "creation_date": 1496143481, "post_id": 44259922, "comment_id": 75529590, "body": "If you&#39;re running this in Rails, it would have added <code>#titleize</code> to your string classes, or <code>#humanize</code>."}, {"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "reply_to_user": {"reputation": 160515, "user_id": 1338292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11fcfcebf1ab436d5b59148ec13e9046?s=128&d=identicon&r=PG", "display_name": "Ja\u0362ck", "link": "https://stackoverflow.com/users/1338292/ja%cd%a2ck"}, "edited": false, "score": 0, "creation_date": 1496162572, "post_id": 44259922, "comment_id": 75543451, "body": "Brilliant Jack, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 4, "last_activity_date": 1496143341, "last_edit_date": 1496143341, "creation_date": 1496142590, "answer_id": 44260605, "question_id": 44259922, "link": "https://stackoverflow.com/questions/44259922/how-best-to-map-split-capitalise-and-join-a-hashs-key/44260605#44260605", "title": "How best to map split capitalise and join a hash&#39;s key", "body": "<p>You can leave out the <code>to_str</code> since your keys are strings anyway. (And besides, no other class than <a href=\"http://ruby-doc.org/core/String.html\" rel=\"nofollow noreferrer\"><code>String</code></a> in the Ruby core library implements <a href=\"http://ruby-doc.org/core/String.html#method-i-to_str\" rel=\"nofollow noreferrer\"><code>to_str</code></a> anyway, so if the keys are not strings, you'll get an exception.)</p>\n\n<p>Also, you can rename your <code>v</code> block parameter to <code>_</code> since you are not using it. <code>_</code> is just as valid a name as <code>v</code>, but it is a convention that says to other programmers \"I'm not using this thing\", and Ruby tools know about this convention and will e.g. not generate an \"unused variable\" warning.</p>\n\n<p>And lastly, you could use <a href=\"http://ruby-doc.org/core/Array.html#method-i-to_h\" rel=\"nofollow noreferrer\"><code>Array#to_h</code></a> instead of <a href=\"http://ruby-doc.org/core/Hash.html#method-c-5B-5D\" rel=\"nofollow noreferrer\"><code>Hash::[]</code></a>.</p>\n\n<pre><code>industries.map {|k, _| [ k.split('_').map(&amp;:capitalize).join(' '), k] }.to_h\n#=&gt; { 'Consultancy Services' =&gt; 'consultancy_services', 'Manufacturing' =&gt; 'manufacturing', 'Retailing Services' =&gt; 'retailing_services' }\n</code></pre>\n\n<p>If you have access to ActiveSupport, you could use <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-titleize\" rel=\"nofollow noreferrer\"><code>ActiveSupport::Inflector::titleize</code></a>:</p>\n\n<pre><code>require 'active_support/inflector'\nindustries.map {|k, _| [ ActiveSupport::Inflector.titleize(k), k] }.to_h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1496147284, "creation_date": 1496147284, "answer_id": 44262307, "question_id": 44259922, "link": "https://stackoverflow.com/questions/44259922/how-best-to-map-split-capitalise-and-join-a-hashs-key/44262307#44262307", "title": "How best to map split capitalise and join a hash&#39;s key", "body": "<pre><code>industries\n.keys\n.group_by{|k| k.gsub(/[^_]+/, &amp;:capitalize).tr(\"_\", \" \")}\n.transform_values(&amp;:first)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>{\n  \"Consultancy Services\"=&gt;\"consultancy_services\", \n  \"Manufacturing\"=&gt;\"manufacturing\",\n  \"Retailing Services\"=&gt;\"retailing_services\"\n}\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 44260605, "answer_count": 2, "score": 0, "last_activity_date": 1496169946, "creation_date": 1496140694, "last_edit_date": 1496169946, "question_id": 44259922, "link": "https://stackoverflow.com/questions/44259922/how-best-to-map-split-capitalise-and-join-a-hashs-key", "title": "How best to map split capitalise and join a hash&#39;s key", "body": "<p>I have a hash:</p>\n\n<pre><code>industries = {'consultancy_services' =&gt; 0, 'manufacturing' =&gt; 1, 'retailing_services' =&gt; 2}\n</code></pre>\n\n<p>whose keys I want to split by an underscore if there is one, each of whose resulting element I want to capitalise.</p>\n\n<p>Is there a nicer way of doing this than:</p>\n\n<pre><code>Hash[industries.map { |k,v| [k.to_str.split('_').map(&amp;:capitalize).join(' '), k] }]\n</code></pre>\n\n<p>V helpful responses, thank you. #humanize seems like neatest way, as below:</p>\n\n<pre><code>industries.map {|k,_| k.humanize }.to_h\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 1986, "user_id": 422131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d46192872b1cab3ef46da47bdd56e12?s=128&d=identicon&r=PG", "display_name": "CppNoob", "link": "https://stackoverflow.com/users/422131/cppnoob"}, "edited": false, "score": 0, "creation_date": 1496141664, "post_id": 44260021, "comment_id": 75528368, "body": "Where do I specify the custom URL? I don&#39;t think this answers the question."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 1986, "user_id": 422131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d46192872b1cab3ef46da47bdd56e12?s=128&d=identicon&r=PG", "display_name": "CppNoob", "link": "https://stackoverflow.com/users/422131/cppnoob"}, "edited": false, "score": 0, "creation_date": 1496141944, "post_id": 44260021, "comment_id": 75528557, "body": "custom URL must be having a <code>controller</code> and an <code>action</code>, that you have to replace there.."}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": false, "score": 1, "last_activity_date": 1496141009, "creation_date": 1496141009, "answer_id": 44260021, "question_id": 44259430, "link": "https://stackoverflow.com/questions/44259430/rails-use-a-custom-url-for-password-reset-with-devise/44260021#44260021", "title": "Rails: Use a custom URL for password reset with Devise", "body": "<p>try this in your <code>routes.rb</code></p>\n\n<pre><code>map.devise_for :users, controllers: {passwords: \"users/passwords\"}, path_names: {\n  new: :new\n}\n</code></pre>\n"}], "owner": {"reputation": 1986, "user_id": 422131, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d46192872b1cab3ef46da47bdd56e12?s=128&d=identicon&r=PG", "display_name": "CppNoob", "link": "https://stackoverflow.com/users/422131/cppnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1496154667, "creation_date": 1496139234, "last_edit_date": 1496154667, "question_id": 44259430, "link": "https://stackoverflow.com/questions/44259430/rails-use-a-custom-url-for-password-reset-with-devise", "title": "Rails: Use a custom URL for password reset with Devise", "body": "<p>I am using Devise for authentication in my Rails app. The password management including reset password mailers, etc. is handled via a controller that derives from Devise::PasswordsController. Something like:</p>\n\n<pre><code>class Users::PasswordsController &lt; Devise::PasswordsController\n  def new\n    if not set_actionmailer_settings\n      error = I18n.t('invalid_paswd_config')\n      redirect_to new_user_session_path, \n                  :flash =&gt; { :error =&gt; error } and return\n    end\n\n    super\n  end\nend\n</code></pre>\n\n<p>I have now moved to a new UI that does not use Rails UI. Instead it calls into the Rails APIs. In the email that is sent to the user for resetting password, if I want to use a use a custom password reset URL, how do I do it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rubyzip"], "answers": [{"tags": [], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "is_accepted": true, "score": 1, "last_activity_date": 1496150952, "last_edit_date": 1496150952, "creation_date": 1496150584, "answer_id": 44263527, "question_id": 44259104, "link": "https://stackoverflow.com/questions/44259104/rubyzip-undefined-method-to-binary-dos-time-for/44263527#44263527", "title": "rubyzip undefined method `to_binary_dos_time&#39; for", "body": "<p>I have created new file named <strong>config/initializers/patch.rb</strong>.</p>\n\n<p>Added below code in it, this solved the issue.</p>\n\n<pre><code>Zip::DOSTime.instance_eval do\n  def now ; Zip::DOSTime.new() ; end\nend\n</code></pre>\n\n<p>The patch I have taken from <a href=\"http://blog.carlosagp.com/\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 14828791, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/cdd8e14b581768ee45d957297a9b3892?s=128&d=identicon&r=PG", "display_name": "Pelton", "link": "https://stackoverflow.com/users/14828791/pelton"}, "is_accepted": false, "score": 2, "last_activity_date": 1608136683, "last_edit_date": 1608136683, "creation_date": 1608021333, "answer_id": 65302465, "question_id": 44259104, "link": "https://stackoverflow.com/questions/44259104/rubyzip-undefined-method-to-binary-dos-time-for/65302465#65302465", "title": "rubyzip undefined method `to_binary_dos_time&#39; for", "body": "<p>Similar problem in both rubyzip and rzip, when trying to change the datetime of the zip entry to the original file datetime:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>zf = Zip::File.open(&quot;myzipfile.zip&quot;, Zip::File::CREATE)\ne = zf.add(&quot;myfiletozip.txt&quot;,&quot;myfiletozip.txt&quot;) # will set the zipfile date to now\ne.time = File.mtime(&quot;myfiletozip.txt&quot;) # will set it to the original file's\n</code></pre>\n<p>So far so well, but when closing the zip file, the proc fails with the same error.\nThe problem is that &quot;time=&quot; creates the &quot;extra&quot; structure in the entry, which is then processed further, and that processing uses the missing method.</p>\n<p>But why does it work without setting the time? The extra structure is not built, and the missing methods not used. As simple as that.</p>\n<p>The to_binary_dos_time / date is present in the Gem: dos_time.rb\nHowever, they seem to be incorrectly referenced by the gem procedures, in my case entry.rb</p>\n<p>My circumvention. I simply copied the two methods into my code, extracted form the gem module dos_time.rb. And - miracle - it works. The gem procedure finds them locally and is happy.</p>\n<p>However, this bug should be reported to the author, but i do not know how. Maybe someone can do this?</p>\n<pre class=\"lang-rb prettyprint-override\"><code>def to_binary_dos_time\n    (sec / 2) +\n      (min &lt;&lt; 5) +\n      (hour &lt;&lt; 11)\nend\n    \ndef to_binary_dos_date\n    day +\n      (month &lt;&lt; 5) +\n      ((year - 1980) &lt;&lt; 9)\nend\n</code></pre>\n<pre><code># source copied out of entry.rb in rubizyp gem, in my case:\n# c:\\Ruby27-x64\\lib\\ruby\\gems\\2.7.0\\gems\\rubyzip-2.3.0\\lib\\zip\\dos_time.rb\n</code></pre>\n"}], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "accepted_answer_id": 44263527, "answer_count": 2, "score": 2, "last_activity_date": 1608136683, "creation_date": 1496138394, "question_id": 44259104, "link": "https://stackoverflow.com/questions/44259104/rubyzip-undefined-method-to-binary-dos-time-for", "title": "rubyzip undefined method `to_binary_dos_time&#39; for", "body": "<p>The below message getting logged when I try to open zip file with write mode. </p>\n\n<p>Full Error Message :</p>\n\n<pre><code>undefined method `to_binary_dos_time' for 2017-05-30 15:07:21 +0530:Time\n</code></pre>\n\n<p>Backtrace :</p>\n\n<pre><code>    [\"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_entry.rb:286:in `write_local_entry'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_output_stream.rb:147:in `block in update_local_headers'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_entry_set.rb:35:in `each'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_entry_set.rb:35:in `each'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_output_stream.rb:145:in `update_local_headers'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_output_stream.rb:64:in `close'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_output_stream.rb:50:in `ensure in open'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_output_stream.rb:50:in `open'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_file.rb:216:in `block in commit'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_file.rb:324:in `on_success_replace'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_file.rb:214:in `commit'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_file.rb:242:in `close'\", \n     \"/usr/local/lib/ruby/gems/2.1.0/gems/rubyzip-0.9.9/lib/zip/zip_file.rb:92:in `open'\", \n     \"/app/zipper_job.rb:36:in `perform'\",  \n</code></pre>\n\n<p>My code is as below.</p>\n\n<pre><code>path=\"#{Rails.root}\"\nnew_zip_name= \"#{Time.now.to_i.to_s}\"\narchive = File.join(path,new_zip_name)+'.zip'\nZip::ZipFile.open(archive, 'w') do |zipfile| #Code breaking on this line\n    #MY Code\nend\n</code></pre>\n\n<p>Any help appriciated!!\nThanks in advance.</p>\n"}, {"tags": ["ruby", "mongodb", "ruby-on-rails-4", "amazon-s3", "backup"], "answers": [{"tags": [], "owner": {"reputation": 2729, "user_id": 1856513, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a66ca1982dc4160d1a1129dbe9f6d31b?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/1856513/abhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1496301971, "last_edit_date": 1496301971, "creation_date": 1496301394, "answer_id": 44300938, "question_id": 44259071, "link": "https://stackoverflow.com/questions/44259071/ruby-backup-gem-s3-upload-not-working/44300938#44300938", "title": "Ruby backup Gem s3 upload not working", "body": "<p>I reconfigured the backup setup and now it is working fine. I don't know why this error came before. </p>\n\n<p>I used the following command to run the backup:</p>\n\n<pre><code>$ backup perform --trigger my_backup\n</code></pre>\n\n<p>The steps that I taken to get it work:</p>\n\n<ol>\n<li><p>I am using rbenv, I created .ruby-gemset and .ruby-version in a new folder and installed backup</p>\n\n<pre><code>$ gem install backup\n</code></pre></li>\n</ol>\n\n<p>It installed all the dependencies of backup.</p>\n\n<ol start=\"2\">\n<li><p>Generated the model with my mongodb</p>\n\n<pre><code>$ backup generate:model --trigger my_backup --storages='s3' --compressor='gzip' --notifiers='mail'  --databases=\"mongodb\"\n</code></pre></li>\n<li><p>And run the backup perform command, it works!</p>\n\n<pre><code>$ backup perform --trigger my_backup\n</code></pre></li>\n</ol>\n\n<p>:)</p>\n"}], "owner": {"reputation": 2729, "user_id": 1856513, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a66ca1982dc4160d1a1129dbe9f6d31b?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/1856513/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496301971, "creation_date": 1496138278, "last_edit_date": 1496214841, "question_id": 44259071, "link": "https://stackoverflow.com/questions/44259071/ruby-backup-gem-s3-upload-not-working", "title": "Ruby backup Gem s3 upload not working", "body": "<p>I am testing the backup gem and the size of the db is very small. I have mongodb with me. </p>\n\n<p>My configuration is:</p>\n\n<pre><code>Backup::Model.new(:backup_db, 'Backup for my db') do\n  split_into_chunks_of 250\n  database MongoDB do |db|\n   db.name               = \"my_dev\"\n   # db.username           = \"\"\n   # db.password           = \"\"\n   db.host               = \"localhost\"\n   db.port               = 27017\n   db.ipv6               = false\n   # db.only_collections   = [\"only\", \"these\", \"collections\"]\n   db.additional_options = []\n   db.lock               = false\n   db.oplog              = false\n end\n\n store_with S3 do |s3|\n   s3.access_key_id     = \"my key\"\n   s3.secret_access_key = \"my key\"\n   s3.region            = \"my region\"\n   s3.bucket            = \"https://region-2.amazonaws.com/bucket-name\"\n   s3.keep              = 10\n   s3.max_retries = 3\n   s3.retry_waitsec = 5\n   s3.chunk_size = 5 # MiB\n end\n sync_with Cloud::S3 do |s3|\n   s3.access_key_id     = \"my key\"\n   s3.secret_access_key = \"my key\"\n   s3.bucket            = \"https://region-2.amazonaws.com/bucket-name\"\n   s3.region            = \"my-region\"\n   # s3.path              = \"\"\n   s3.mirror            = true\n   s3.concurrency_type  = false\n   s3.concurrency_level = 2\n\n   s3.directories do |directory|\n   end\n end \n\n compress_with Gzip\nend\n</code></pre>\n\n<p>When running backup perform, I am getting the following error:</p>\n\n<pre><code>[2017/05/30 14:23:28][error] ModelError: Backup for Backup Gauge Lrs db (backup_db) Failed!\n[2017/05/30 14:23:28][error]   An Error occured which has caused this Backup to abort before completion.\n[2017/05/30 14:23:28][error]   Reason: Excon::Errors::SocketError\n[2017/05/30 14:23:28][error]   break from proc-closure (LocalJumpError)\n[2017/05/30 14:23:28][error]\n[2017/05/30 14:23:28][error] Backtrace:\n</code></pre>\n\n<p>Anyone explain me about this error? I run the command with the log file option. Same log I am getting in the file too. </p>\n\n<p>I am using Rails 4.2 and Ruby 2.2.1</p>\n\n<p>Backup Gem version is 3.4.0</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 5, "creation_date": 1496137936, "post_id": 44258900, "comment_id": 75525924, "body": "Try <code>contacts:</code> instead of <code>contacts_attributes:</code>"}, {"owner": {"reputation": 901, "user_id": 3872380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/wy14q.jpg?s=128&g=1", "display_name": "Mukesh", "link": "https://stackoverflow.com/users/3872380/mukesh"}, "edited": false, "score": 0, "creation_date": 1496138280, "post_id": 44258900, "comment_id": 75526145, "body": "permit it in model also"}, {"owner": {"reputation": 484, "user_id": 5949678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn9j3.jpg?s=128&g=1", "display_name": "Divya Sharma", "link": "https://stackoverflow.com/users/5949678/divya-sharma"}, "edited": false, "score": 0, "creation_date": 1496151911, "post_id": 44258900, "comment_id": 75536063, "body": "check if you using attr_accessible in your model and also strong_params in controller if so then please remove attr_accessible from model in rails 4.  Also check if you are having accept_nested_attributes_for contacts in your model"}], "answers": [{"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 3, "last_activity_date": 1496138395, "creation_date": 1496138395, "answer_id": 44259105, "question_id": 44258900, "link": "https://stackoverflow.com/questions/44258900/rails-unpermitted-params/44259105#44259105", "title": "Rails unpermitted params", "body": "<p>As I said, you are <em>permitting</em> <code>contacts_attributes</code> instead of <code>contacts</code>. Changing the <code>update_params</code> method like below should fix the problem.</p>\n\n<pre><code>def update_params\n  params.permit(\n    :name,\n    contacts: [\n      :id, :first_name, :last_name, :email, :business, :position, :telephone,\n      :cellphone, :address, :city, :state, :country\n    ]\n  )\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 1592591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2d32ac48d24c7313d703b09b9d6ea7?s=128&d=identicon&r=PG", "display_name": "Sujay Gavhane", "link": "https://stackoverflow.com/users/1592591/sujay-gavhane"}, "is_accepted": false, "score": -1, "last_activity_date": 1496150174, "creation_date": 1496150174, "answer_id": 44263373, "question_id": 44258900, "link": "https://stackoverflow.com/questions/44258900/rails-unpermitted-params/44263373#44263373", "title": "Rails unpermitted params", "body": "<p>First check in your model you have written <code>accept_nested_attributes_for :contacts</code> if yes then your code must work.</p>\n"}], "owner": {"reputation": 1166, "user_id": 7044625, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/80daf516453640dcd23184fbf8b8df11?s=128&d=identicon&r=PG&f=1", "display_name": "felipeecst", "link": "https://stackoverflow.com/users/7044625/felipeecst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 44259105, "answer_count": 2, "score": 1, "last_activity_date": 1496150174, "creation_date": 1496137799, "question_id": 44258900, "link": "https://stackoverflow.com/questions/44258900/rails-unpermitted-params", "title": "Rails unpermitted params", "body": "<p>I'm trying to recieve some params within my controller, but I'm having issues when permitting them. This is my request payload:</p>\n\n<pre><code>{\n    contacts: [{\n            id: null,\n            address: null,\n            business: \"Company\",\n            cellphone: \"\",\n            city: null,\n            country: null,\n            email: \"emaill@tes.te\"\n        }],\n    name: \"Entity1\"\n}\n</code></pre>\n\n<p>Inside my controller, I defined:</p>\n\n<pre><code>  def update_params\n    params.permit(\n      :name,\n      contacts_attributes: [\n        :id, :first_name, :last_name, :email, :business, :position, :telephone,\n        :cellphone, :address, :city, :state, :country\n      ]\n    )\n  end\n</code></pre>\n\n<p>But when I call the update_params method, only :name is permitted. Contacts is unpermitted. Am I missing something?</p>\n"}, {"tags": ["arrays", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496139006, "post_id": 44258881, "comment_id": 75526659, "body": "Your code is <i>completely</i> broken... I wouldn&#39;t bother stepping through it to debug; I&#39;d just rewrite it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496139421, "post_id": 44258881, "comment_id": 75526928, "body": "Also, I get that this is an algorithm challenge, but under &quot;normal circumstances&quot; you can just make use of ruby&#39;s extensively expressive language - e.g. <code>list.slice_when { |prev, curr| curr != prev.next }.to_a</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1496139847, "post_id": 44258881, "comment_id": 75527209, "body": "Hint: Try testing your method with a variety of different inputs. Try giving it an empty array, or an array with 1 element, or an array where all elements are consecutive, or where none are consecutive, .... It&#39;s much easier to debug problems with a variety of inputs covering more edge cases."}, {"owner": {"reputation": 508, "user_id": 3108224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pKwqD.jpg?s=128&g=1", "display_name": "Rikkas", "link": "https://stackoverflow.com/users/3108224/rikkas"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496141434, "post_id": 44258881, "comment_id": 75528212, "body": "This is the first time I ran across slice_when method actually and it seems to be fitting perfectly with this kind of sortings. I tried to solve it in an iterative way but it didn&#39;t work. Thanks for this short method."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496143726, "post_id": 44258881, "comment_id": 75529793, "body": "I&#39;d still highly recommend that you try to implement this &quot;manually&quot;, if that was the whole point of the exercise... Ruby&#39;s rich library makes writing concise code very easy, but I was under the impression that this was an <i>algorithm</i> challenge."}, {"owner": {"reputation": 508, "user_id": 3108224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pKwqD.jpg?s=128&g=1", "display_name": "Rikkas", "link": "https://stackoverflow.com/users/3108224/rikkas"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496144490, "post_id": 44258881, "comment_id": 75530348, "body": "Yes, this is part of an algorithm challenge, not all of it but the important part. I will also try to solve it manually so I am trying to improve my natural ability to solve algorithms with arrays. I have to admit that I am amazed to meet slice_when method and I also used it to solve another similar problem. Thanks for your support."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 2, "last_activity_date": 1496145997, "creation_date": 1496145997, "answer_id": 44261840, "question_id": 44258881, "link": "https://stackoverflow.com/questions/44258881/sorting-an-array-by-corresponding-ranges/44261840#44261840", "title": "Sorting an array by corresponding ranges", "body": "<p>You're missing <code>chunk_while</code>.</p>\n\n<pre><code>list.chunk_while{|a, b| a.next == b}.map{|a| a.one? ? a.first : a}\n# =&gt; [-6, [-3, -2, -1, 0, 1], [3, 4, 5], [7, 8, 9, 10], [12, 13], 15]\n</code></pre>\n"}], "owner": {"reputation": 508, "user_id": 3108224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pKwqD.jpg?s=128&g=1", "display_name": "Rikkas", "link": "https://stackoverflow.com/users/3108224/rikkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44261840, "answer_count": 1, "score": 2, "last_activity_date": 1496146085, "creation_date": 1496137714, "last_edit_date": 1496146085, "question_id": 44258881, "link": "https://stackoverflow.com/questions/44258881/sorting-an-array-by-corresponding-ranges", "title": "Sorting an array by corresponding ranges", "body": "<p>My purpose is to populate an array from <code>list</code>:</p>\n\n<pre><code>list = [-6, -3, -2, -1, 0, 1, 3, 4, 5, 7, 8, 9, 10, 12, 13, 15]\n</code></pre>\n\n<p>in an order following this:</p>\n\n<ul>\n<li>Individual integers not followed by its incremented value (by 1) will be added directly to the result array.</li>\n<li>Integers which is followed by its incremented value (by 1) will be added to the range array and this array will then be added to result and will be reset again to be used for the next range.</li>\n</ul>\n\n<p>The correct output should be:</p>\n\n<pre><code>solution(list)\n# =&gt; [-6, [-3, -2, -1, 0, 1], [3, 4, 5], [7, 8, 9, 10], [12, 13], 15]  \n</code></pre>\n\n<p>My code and my output is below.</p>\n\n<pre><code>def solution(list)\n  result = []\n  idx = 0\n  loop do\n    range = []\n    loop do\n      if list[idx+1] - list[idx] == 1\n        range &lt;&lt; list[idx]\n        idx += 1\n      else\n        result &lt;&lt; list[idx]\n        idx += 1\n        break\n      end\n    end\n    result &lt;&lt; range\n  break if idx == list.size - 1\n  end\n  result\nend \n\nsolution(list)\n# =&gt; [-6, [], 1, [-3, -2, -1, 0], 5, [3, 4], 10, [7, 8, 9], 13, [12]]\n</code></pre>\n\n<p>The code is not correct. Can you tell me what I am missing?</p>\n"}, {"tags": ["android", "ruby-on-rails", "ruby", "firebase", "firebase-cloud-messaging"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496137082, "post_id": 44258578, "comment_id": 75525316, "body": "do <code>params.to_json</code>"}, {"owner": {"reputation": 237, "user_id": 3007780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vYPdr.jpg?s=128&g=1", "display_name": "Jimy25", "link": "https://stackoverflow.com/users/3007780/jimy25"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1496137848, "post_id": 44258578, "comment_id": 75525862, "body": "response = self.class.post(&#39;/send&#39;, params.merge(@client_options).to_json) produces error TypeError (can&#39;t convert String into Hash)."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1496137921, "post_id": 44258578, "comment_id": 75525908, "body": "Your code works. There is no error message. I don&#39;t know what you are asking."}, {"owner": {"reputation": 66009, "user_id": 23368, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ace1b52352e1260c6a42df36e36f356?s=128&d=identicon&r=PG", "display_name": "Daniel Rikowski", "link": "https://stackoverflow.com/users/23368/daniel-rikowski"}, "edited": false, "score": 0, "creation_date": 1496137957, "post_id": 44258578, "comment_id": 75525937, "body": "The <code>FCM</code> class is part of the the FCM gem. It&#39;s unlikely that there&#39;s the problem."}, {"owner": {"reputation": 237, "user_id": 3007780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vYPdr.jpg?s=128&g=1", "display_name": "Jimy25", "link": "https://stackoverflow.com/users/3007780/jimy25"}, "edited": false, "score": 0, "creation_date": 1496137984, "post_id": 44258578, "comment_id": 75525954, "body": "My android client app does not receive any notification"}, {"owner": {"reputation": 33081, "user_id": 4625829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tw3Uk.png?s=128&g=1", "display_name": "AL.", "link": "https://stackoverflow.com/users/4625829/al"}, "edited": false, "score": 0, "creation_date": 1496138027, "post_id": 44258578, "comment_id": 75525984, "body": "Could you post your code for handling the message in Android?"}, {"owner": {"reputation": 237, "user_id": 3007780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vYPdr.jpg?s=128&g=1", "display_name": "Jimy25", "link": "https://stackoverflow.com/users/3007780/jimy25"}, "edited": false, "score": 0, "creation_date": 1496138095, "post_id": 44258578, "comment_id": 75526023, "body": "I do exactly as this example <a href=\"http://www.androidhive.info/2012/10/android-push-notifications-using-google-cloud-messaging-gcm-php-and-mysql/\" rel=\"nofollow noreferrer\">androidhive.info/2012/10/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 3007780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vYPdr.jpg?s=128&g=1", "display_name": "Jimy25", "link": "https://stackoverflow.com/users/3007780/jimy25"}, "edited": false, "score": 0, "creation_date": 1496138382, "post_id": 44258929, "comment_id": 75526210, "body": "My Android client App can receive notification when sending by PHP code. But cannot with above Ruby code."}], "tags": [], "owner": {"reputation": 66009, "user_id": 23368, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ace1b52352e1260c6a42df36e36f356?s=128&d=identicon&r=PG", "display_name": "Daniel Rikowski", "link": "https://stackoverflow.com/users/23368/daniel-rikowski"}, "is_accepted": true, "score": 3, "last_activity_date": 1496139318, "last_edit_date": 1496139318, "creation_date": 1496137872, "answer_id": 44258929, "question_id": 44258578, "link": "https://stackoverflow.com/questions/44258578/using-ruby-to-send-notification-to-firebase/44258929#44258929", "title": "Using Ruby to send notification to Firebase", "body": "<p>According to the <a href=\"https://firebase.google.com/docs/cloud-messaging/http-server-ref#table5\" rel=\"nofollow noreferrer\">Firebase API documentation</a> the response you get is the expected response for a successfully queued message.</p>\n\n<p>The fact that you get back a <code>message_id</code> has this meaning:</p>\n\n<blockquote>\n  <p>The topic message ID when FCM has successfully received the request and will attempt to deliver to all subscribed devices.</p>\n</blockquote>\n\n<p>It looks like your code is working, i.e. the problem must be somewhere else.</p>\n\n<p><strong>EDIT:</strong>\nYou are sending a <strong>data</strong> message. (Because no <code>notification</code> key, just a <code>data</code> key) Perhaps your client expects a <strong>notification</strong> message instead? </p>\n\n<p>See the <a href=\"https://firebase.google.com/docs/cloud-messaging/concept-options#notifications_and_data_messages\" rel=\"nofollow noreferrer\">documentation</a> for the distinction between those two message types.</p>\n\n<p>You can try and just add a notification key to the request:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>fcm = FCM.new(FIREBASE_API_KEY, :timeout =&gt; 30)\noptions = {:notification =&gt; \"Test notification\", \n           :data =&gt; {:message =&gt; \"This is a FCM Topic Message!\"}}\nresponse = fcm.send_to_topic('global', options)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1223, "user_id": 3012473, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gSYLc.png?s=128&g=1", "display_name": "buncis", "link": "https://stackoverflow.com/users/3012473/buncis"}, "is_accepted": false, "score": 1, "last_activity_date": 1496138759, "creation_date": 1496138759, "answer_id": 44259262, "question_id": 44258578, "link": "https://stackoverflow.com/questions/44258578/using-ruby-to-send-notification-to-firebase/44259262#44259262", "title": "Using Ruby to send notification to Firebase", "body": "<p>I have this problem before</p>\n\n<p>try to add <code>priority: \"high\"</code> and <code>notification: \"your message\"</code></p>\n\n<p>in your FCM class instatiation options</p>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 2681049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UBM7Z.jpg?s=128&g=1", "display_name": "Qmr", "link": "https://stackoverflow.com/users/2681049/qmr"}, "is_accepted": false, "score": -1, "last_activity_date": 1505019817, "creation_date": 1505019817, "answer_id": 46137465, "question_id": 44258578, "link": "https://stackoverflow.com/questions/44258578/using-ruby-to-send-notification-to-firebase/46137465#46137465", "title": "Using Ruby to send notification to Firebase", "body": "<p>Try this</p>\n\n<pre><code> request = HTTParty.post('http://fcm.googleapis.com/fcm/send', :body =&gt; { \"to\" =&gt; \"#{token}\", \"priority\" =&gt; \"high\", \"data\" =&gt; { \"title\" =&gt;title,\"body\"=&gt;message,'massage_type'=&gt;'text'}}.to_json, :headers =&gt; { 'Content-Type' =&gt; 'application/json', 'Authorization' =&gt; \"key=#{server_token}\" } )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2967, "user_id": 471260, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec07624a89509923683ba0a0b9c9f06d?s=128&d=identicon&r=PG", "display_name": "Mark Fraser", "link": "https://stackoverflow.com/users/471260/mark-fraser"}, "is_accepted": false, "score": 0, "last_activity_date": 1525285872, "creation_date": 1525285872, "answer_id": 50141305, "question_id": 44258578, "link": "https://stackoverflow.com/questions/44258578/using-ruby-to-send-notification-to-firebase/50141305#50141305", "title": "Using Ruby to send notification to Firebase", "body": "<p>I am not sure if this is due to changes in FCM itself but using the syntax from the gem's documentation or using the format from Daniel's answer did not work for me (Daniel's version gives an error response from FCM saying that notification must be a JSON object).</p>\n\n<p>This is what worked for me:</p>\n\n<pre><code>fcm.send_to_topic(topic, notification: { body: \"topic notification\" })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 2662522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/86K7B.jpg?s=128&g=1", "display_name": "Vitali Tsevan", "link": "https://stackoverflow.com/users/2662522/vitali-tsevan"}, "is_accepted": false, "score": 0, "last_activity_date": 1570010426, "creation_date": 1570010426, "answer_id": 58199320, "question_id": 44258578, "link": "https://stackoverflow.com/questions/44258578/using-ruby-to-send-notification-to-firebase/58199320#58199320", "title": "Using Ruby to send notification to Firebase", "body": "<p>Unfortunately the fcm library does not provide support to the rubies &lt; 2.0. According to the git history of the repository that was the case already at the <a href=\"https://github.com/spacialdb/fcm/blob/v0.0.1/fcm.gemspec\" rel=\"nofollow noreferrer\">start</a> of the project.</p>\n"}], "owner": {"reputation": 237, "user_id": 3007780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vYPdr.jpg?s=128&g=1", "display_name": "Jimy25", "link": "https://stackoverflow.com/users/3007780/jimy25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5106, "favorite_count": 1, "accepted_answer_id": 44258929, "answer_count": 5, "score": 3, "last_activity_date": 1570010426, "creation_date": 1496136815, "last_edit_date": 1496138042, "question_id": 44258578, "link": "https://stackoverflow.com/questions/44258578/using-ruby-to-send-notification-to-firebase", "title": "Using Ruby to send notification to Firebase", "body": "<p>I am using Ruby version 1.8.7.</p>\n\n<p>I use this FCM gem <a href=\"https://github.com/spacialdb/fcm\" rel=\"nofollow noreferrer\">https://github.com/spacialdb/fcm</a> and want to send notification message to Android client app but it does not work.</p>\n\n<p>In Controller:</p>\n\n<pre><code>fcm = FCM.new(FIREBASE_API_KEY, :timeout =&gt; 30)\n options = {:data =&gt; {:message =&gt; \"This is a FCM Topic Message!\"}}\n response = fcm.send_to_topic('global', options)\n</code></pre>\n\n<p>Class FCM:</p>\n\n<pre><code>require 'httparty'\nrequire 'cgi'\nrequire 'json'\n\nclass FCM\n  include HTTParty\n  base_uri 'https://fcm.googleapis.com/fcm'\n  default_timeout 30\n  format :json\n\n  attr_accessor :timeout, :api_key\n\n  def initialize(api_key, client_options = {})\n    @api_key = api_key\n    @client_options = client_options\n  end\n\n  def send_with_notification_key(notification_key, options = {})\n    body = { :to =&gt; notification_key }.merge(options)\n\n    params = {\n        :body =&gt; body.to_json,\n        :headers =&gt; {\n        'Authorization' =&gt; \"key=#{@api_key}\",\n        'Content-Type' =&gt; 'application/json'\n    }\n  }\n\n  response = self.class.post('/send', params.merge(@client_options))\n  response.parsed_response\n  end\n\n  def send_to_topic(topic, options = {})\n    if topic =~ /[a-zA-Z0-9\\-_.~%]+/\n        send_with_notification_key('/topics/' + topic, options)\n    end\n  end\nend\n</code></pre>\n\n<ol>\n<li>The server key is correct, because I can send notification successfully by PHP code.</li>\n<li>The response output as below:\n{\"message_id\"=>8885803884270587181}</li>\n</ol>\n\n<p>Could anyone please to point out what wrong with the code. \nAny help would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "closures", "send"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1496133620, "post_id": 44257136, "comment_id": 75522870, "body": "BTW, Ruby has pretty expressive <code>Integer#even?</code> method, which you can pass with an ampersand: <code>[:rindex, :index ].map { |sym| [0,1,2].send(sym, &amp;:even?) }</code>"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1496133705, "post_id": 44257136, "comment_id": 75522915, "body": "@Ilya edited my answer 8 seconds before you posted this comment :D"}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1496133814, "post_id": 44257136, "comment_id": 75522980, "body": "@Andrey, you deleted your answer, then undeleted and so on. Maybe you&#39;ll delete it again, who knows."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1496133857, "post_id": 44257136, "comment_id": 75523010, "body": "no one knows what it&#39;s like to be the bad man"}], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1496133625, "last_edit_date": 1496133625, "creation_date": 1496133212, "answer_id": 44257301, "question_id": 44257136, "link": "https://stackoverflow.com/questions/44257136/how-to-pass-a-closure-to-send-in-ruby-as-an-argument/44257301#44257301", "title": "How to pass a closure to send in Ruby as an argument", "body": "<p>No rocket science option:</p>\n\n<pre><code>%i(rindex index).map { |meth| [0,1,2].public_send(meth) { |x| x % 2 == 0  } }\n#=&gt; [2, 0]\n</code></pre>\n\n<p>A bit shorter (using <a href=\"https://ruby-doc.org/core-2.4.1/Integer.html#method-i-even-3F\" rel=\"nofollow noreferrer\">Integer#<code>even?</code></a>):</p>\n\n<pre><code>%i(rindex index).map { |meth| [0,1,2].public_send(meth, &amp;:even?) }\n#=&gt; [2, 0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1496133329, "creation_date": 1496133329, "answer_id": 44257335, "question_id": 44257136, "link": "https://stackoverflow.com/questions/44257136/how-to-pass-a-closure-to-send-in-ruby-as-an-argument/44257335#44257335", "title": "How to pass a closure to send in Ruby as an argument", "body": "<p>To pass the closure, one should instruct the ruby parser, that it\u2019s a block, using an ampersand character:</p>\n\n<pre><code>[ :rindex, :index ].map do |sym|\n  [0,1,2].send(sym, &amp;-&gt;(x){ x % 2 == 0  })\nend\n#\u21d2 [2, 0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 1, "last_activity_date": 1496143516, "creation_date": 1496143516, "answer_id": 44260966, "question_id": 44257136, "link": "https://stackoverflow.com/questions/44257136/how-to-pass-a-closure-to-send-in-ruby-as-an-argument/44260966#44260966", "title": "How to pass a closure to send in Ruby as an argument", "body": "<blockquote>\n  <p>What am I doing wrong?</p>\n</blockquote>\n\n<p>In Ruby, blocks are being passed <em>after</em> the argument list instead of <em>inside it</em>:</p>\n\n<pre><code>foo(1, { puts 'Hello' }) # wrong\nfoo(1) { puts 'Hello' }  # right\n</code></pre>\n\n<p>So, your code should look like:</p>\n\n<pre><code>[:rindex, :index].map {|sym| [0, 1, 2].send(sym) {|x| x %2 == 0 }}\n</code></pre>\n\n<p>Note: you should always prefer <code>public_send</code> over <code>send</code>. <code>send</code> does two things at once: allow the name of the message to be dynamic, and break encapsulation. If you use <code>send</code>, people who read your code are never quite sure which of the two features you are actually using. In this case, you are not breaking encapsulation at all, you are only using the dynamic message name. That's exactly what <code>public_send</code> does.</p>\n\n<pre><code>%i[rindex index].map {|meth| [0, 1, 2].public_send(meth, &amp;:even?)}\n</code></pre>\n\n<p>This would be a more idiomatic way to write your code.</p>\n"}], "owner": {"reputation": 2689, "user_id": 1134991, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e102cb584a0fba3cd07b0a4d79350ba2?s=128&d=identicon&r=PG", "display_name": "user1134991", "link": "https://stackoverflow.com/users/1134991/user1134991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 44260966, "answer_count": 3, "score": -1, "last_activity_date": 1496143516, "creation_date": 1496132674, "last_edit_date": 1496135519, "question_id": 44257136, "link": "https://stackoverflow.com/questions/44257136/how-to-pass-a-closure-to-send-in-ruby-as-an-argument", "title": "How to pass a closure to send in Ruby as an argument", "body": "<p>I use <code>send</code> like this:</p>\n\n<pre><code>[:last, :first].map { |sym| [0,1,2].send(sym) }\n#=&gt; [2, 0]\n</code></pre>\n\n<p>I am trying to pass to <code>send</code> a symbol of index and rindex, and a closure for their execution:</p>\n\n<pre><code>[:rindex, :index].map { |sym| [0,1,2].send(sym, { |x| x %2 == 0  }) }\n</code></pre>\n\n<p>I get an error message:</p>\n\n<pre><code>SyntaxError: (irb):4: syntax error, unexpected '|', expecting '}'\n...p { |sym| [0,1,2].send(sym, { |x| x %2 == 0  }) }\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby", "markdown", "haml", "middleman"], "answers": [{"comments": [{"owner": {"reputation": 796, "user_id": 1226389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65ee87ab50e1ecd786a47841bffb3681?s=128&d=identicon&r=PG", "display_name": "Rafal", "link": "https://stackoverflow.com/users/1226389/rafal"}, "edited": false, "score": 0, "creation_date": 1497605905, "post_id": 44507008, "comment_id": 76159497, "body": "Your solution would be very good if my template would be plain text, without need for additional structure provided by HAML. Kathryn&#39;s extension of your suggestion works great for me."}], "tags": [], "owner": {"reputation": 234, "user_id": 4371783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1813c3e2d125e66f413cb2976305b4c3?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/4371783/adam"}, "is_accepted": false, "score": 1, "last_activity_date": 1497296352, "last_edit_date": 1497296352, "creation_date": 1497294500, "answer_id": 44507008, "question_id": 44256979, "link": "https://stackoverflow.com/questions/44256979/middleman-referencing-url-stored-in-a-data-file-from-markdown/44507008#44507008", "title": "Middleman: referencing URL stored in a data file from markdown", "body": "<p>I'm not sure exactly what you are encountering here. The following works on my end:</p>\n\n<p>Assuming your data file <code>data/pages.yaml</code> contains</p>\n\n<pre><code>pageA:\n  link: /some-long-url-subject-to-change.html\n  name: PageA name\n  info: Some other related info\n</code></pre>\n\n<p>and your template <code>test.haml.md.erb</code> looks like</p>\n\n<pre><code>---\ntitle: Test\n---\n\nThis is another text with a [&lt;%= data.pages.pageA.name %&gt;](&lt;%= data.pages.pageA.link %&gt;) to that page.\n</code></pre>\n\n<p>the output should be as follows, with <em>PageA name</em> being the clickable link.</p>\n\n<blockquote>\n  <p>This is another text with a <em>PageA name</em> to that page.</p>\n</blockquote>\n\n<p>It seems like you are running into issues with the markdown interpretation. Try adjusting the template filename from <code>test.haml</code> to <code>test.haml.md.erb</code>.</p>\n\n<p>This construction tells Middleman to first interpret the ERB bits, then the Markdown bits, and finally the HAML (or plain HTML if not using HAML).</p>\n"}, {"comments": [{"owner": {"reputation": 796, "user_id": 1226389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65ee87ab50e1ecd786a47841bffb3681?s=128&d=identicon&r=PG", "display_name": "Rafal", "link": "https://stackoverflow.com/users/1226389/rafal"}, "edited": false, "score": 0, "creation_date": 1497602686, "post_id": 44564396, "comment_id": 76157216, "body": "Helper code I am not supposed to use works great as long as there is only one link/data reference or all of the links/references point to the same page. So, for example <code>= myhelper(&quot;This is another text with a [data-referenced link](pageA) to that page and [something else](pageA).&quot;)</code> will create proper links in both occurences of <code>pageA</code>, but <code>= myhelper(&quot;This is another text with a [data-referenced link](pageA) to that page and [something else](pageB).&quot;)</code> won&#39;t replace <code>pageB</code> with <code>data.pages.pageB.link</code>."}, {"owner": {"reputation": 796, "user_id": 1226389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65ee87ab50e1ecd786a47841bffb3681?s=128&d=identicon&r=PG", "display_name": "Rafal", "link": "https://stackoverflow.com/users/1226389/rafal"}, "edited": false, "score": 0, "creation_date": 1498639706, "post_id": 44564396, "comment_id": 76575702, "body": "Using .erb bits does the trick when used directly in HAML template. Unfortunately, my actual use case is a little more complicated (text needs to be passed to Tilt), and this solution doesn&#39;t work then. I have asked another question for that: <a href=\"https://stackoverflow.com/q/44797695/1226389\">stackoverflow.com/q/44797695/1226389</a>"}], "tags": [], "owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "is_accepted": true, "score": 1, "last_activity_date": 1497520390, "creation_date": 1497520390, "answer_id": 44564396, "question_id": 44256979, "link": "https://stackoverflow.com/questions/44256979/middleman-referencing-url-stored-in-a-data-file-from-markdown/44564396#44564396", "title": "Middleman: referencing URL stored in a data file from markdown", "body": "<p>It looks as if you are trying to write your own templating system, which is probably not the best idea. First, you'll need to write a regex that properly parses Markdown and finds link notation. Then you need to eval the string you pulled to get the value from your data. And finally you'll need to substitute the placeholder with that value.  I more or less got that working with this code in config.rb:</p>\n\n<pre><code>helpers do\n  def myhelper(text)\n    page=/\\]\\((.*?)\\)/.match(text)[1]\n    link=eval( \"data.pages.#{page}.link\" )\n    text.gsub(page,link)\n  end\nend\n</code></pre>\n\n<p><strong>But please don't use this code!</strong> It's fragile and error-prone. Worse, there's a much simpler way to do what you are trying to do. Replace your test.haml with test.haml.erb:</p>\n\n<pre><code>.info\n    :markdown\n        This is some text with a [manual link](https://google.com) to somewhere. \n        This is another text with a [data-referenced link](&lt;%= data.pages.pageA.link %&gt;) to that page.\n\n= myhelper(\"This is another text with a [data-referenced link](pageA) to that page.\")\n</code></pre>\n\n<p>The .erb extension tells Middleman to treat the file as an <a href=\"http://www.stuartellis.name/articles/erb/\" rel=\"nofollow noreferrer\">ERB template</a>. In particular, it'll evaluate whatever is between <code>&lt;%=</code> and <code>%&gt;</code> as Ruby code. That means you can skip using a messy helper method. As a bonus, you don't need to write more code to get the other bits of data:</p>\n\n<ul>\n<li><code>&lt;%= data.pages.pageA.name %&gt;</code> => 'PageA name'</li>\n<li><code>&lt;%= data.pages.pageA.info %&gt;</code> => 'Some other related info'</li>\n</ul>\n\n<p>If you <em>need</em> to do some more complex processing, such as iterating over a list, you can do that right in the template itself. It's easier to read and maintain that way. </p>\n\n<p>I also included a call to the helper method as contrast. It's a lot less clear what's going on than just using the existing templating system. Plus, you are bound to forget to wrap all the relevant strings in the method and end up with broken links down the road.</p>\n\n<p>As <a href=\"https://stackoverflow.com/a/44507008/7948068\">Adam suggested</a>, you might be even better off using Markdown directly and skipping <a href=\"http://haml.info/\" rel=\"nofollow noreferrer\">Haml</a>. </p>\n"}], "owner": {"reputation": 796, "user_id": 1226389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65ee87ab50e1ecd786a47841bffb3681?s=128&d=identicon&r=PG", "display_name": "Rafal", "link": "https://stackoverflow.com/users/1226389/rafal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 44564396, "answer_count": 2, "score": 3, "last_activity_date": 1497603458, "creation_date": 1496132145, "last_edit_date": 1497603458, "question_id": 44256979, "link": "https://stackoverflow.com/questions/44256979/middleman-referencing-url-stored-in-a-data-file-from-markdown", "title": "Middleman: referencing URL stored in a data file from markdown", "body": "<p>For my <a href=\"https://middlemanapp.com/advanced/data-files/\" rel=\"nofollow noreferrer\">Middleman-built website I have stored links and other information about all pages in a data file</a>.</p>\n\n<p><code>data/pages.yaml</code>:</p>\n\n<pre><code>pageA:\n  link: /some-long-url-subject-to-change.html\n  name: PageA name\n  info: Some other related info\n</code></pre>\n\n<p>Then, in my HAML template (<code>source/test.haml</code>), I can print relative path to pageA with <code>= data.pages.pageA.link</code>.</p>\n\n<p>Now, I want to use markdown syntax to reference that page by its name (pageA).</p>\n\n<p>Example (<code>source/test.html.haml</code>):</p>\n\n<pre><code>.info\n    :markdown\n        This is some text with a [manual link](https://google.com) to somewhere. \n        This is another text with a [data-referenced link](pageA) to that page.\n</code></pre>\n\n<p>In the same way as first \"manual link\" links to Google, I would like second link to use relative path stored in data file to create a link. One solution that I see to solve this problem would be to replace <code>(pageA)</code> text with evaluation of <code>= data.pages.pageA.link</code> prior to it being rendered by markdown.</p>\n\n<p>I assume this would be possible by creating custom helper, but I can't quite nail it.</p>\n\n<hr>\n\n<h3>My attempt at solution</h3>\n\n<p>I tried to write a custom helper to replace <code>(pageA)</code> text with evaluation of <code>= data.pages.pageA.link</code> prior to it being rendered by markdown.</p>\n\n<p>I was able to replace specific text (<code>pageA</code>) with information from data and I was also able to write more generic case, which replaces all data references with explicit text of typical data reference. But I can't get to replace <code>data.pages.pageA.link</code> in generic case for evaluation of <code>= data.pages.pageA.link</code>.</p>\n\n<p>My helper:</p>\n\n<pre><code># Replace specific text with information from ``data/pages.yaml``\nspecific = text.gsub(\"pageA\",data.pages.pageA.link)\n# Generic case: using explicit text\ngeneric = text.gsub(/\\]\\((.*?)\\)/,'](data.pages.\\1.link)')\n# Generic case: trying to use variable name, but getting explicit text\ngeneric = text.gsub(/\\]\\((.*?)\\)/,'](#{data.pages.\\1.link})')\n</code></pre>\n\n<p>Usage of helper in my <code>test.html.haml</code>:</p>\n\n<pre><code>= myhelper(\"This is another text with a [data-referenced link](pageA) to that page.\")\n</code></pre>\n\n<p>Printing <code>specific</code> variable gives me what I want (<code>/some-long-url-subject-to-change.html</code>). But printing <code>generic</code> variable results in plain text, instead of information from data file.</p>\n\n<p>It is possible that I am lacking some basic Ruby knowledge and solution is indeed very simple.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1496131212, "post_id": 44256658, "comment_id": 75521501, "body": "Controller actions are not your ordinary ruby methods and they don&#39;t accept parameters like that, in the signature. You&#39;re supposed to read <code>params[:produit_id]</code> in the method body."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1496131729, "post_id": 44256658, "comment_id": 75521775, "body": "@SergioTulentsev well, controller actions <i>are ordinary ruby methods</i> after all, they just are called by the engine in some ways that the engine wants to call them."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1496131804, "post_id": 44256658, "comment_id": 75521817, "body": "@mudasobwa: you know what I meant. :)"}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496132373, "post_id": 44256658, "comment_id": 75522159, "body": "@SergioTulentsev what do i need to write to fix the issue? i&#39;m in a hurry :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496132504, "post_id": 44256658, "comment_id": 75522223, "body": "@justinedps26: the answer is in the last sentence of my comment"}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496132573, "post_id": 44256658, "comment_id": 75522253, "body": "@SergioTulentsev i did write your way but nothing changed"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496132650, "post_id": 44256658, "comment_id": 75522304, "body": "@justinedps26 you forgot to remove the parameter from the signature?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496132910, "post_id": 44256658, "comment_id": 75522452, "body": "@justinedps26: <code>def add_item(produit_id)</code> should be <code>def add_item</code>"}, {"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133042, "post_id": 44256658, "comment_id": 75522541, "body": "@justinedps26 as @SergioTulentsev explained, controller actions don&#39;t receive parameters; as you can see you even don&#39;t use such parameter in action body but you access to <code>params</code>. So just remove parameter from method signature and bug will be solved !"}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133263, "post_id": 44256658, "comment_id": 75522679, "body": "@SergioTulentsev now i have <code>undefined local variable or method </code>cart_items&#39;`"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133393, "post_id": 44256658, "comment_id": 75522753, "body": "@justinedps26: well, that&#39;s another issue, which doesn&#39;t have anything to do with the original error."}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133575, "post_id": 44256658, "comment_id": 75522840, "body": "@SergioTulentsev well, i&#39;ll try to figure it out. Thanks for your help"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496135038, "post_id": 44256658, "comment_id": 75523796, "body": "Now the question is wrong. The code given can&#39;t produce stated error. And, as a general rule, you must not edit questions like that (so that it becomes another question entirely). This invalidates existing answers."}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496135184, "post_id": 44256658, "comment_id": 75523892, "body": "@SergioTulentsev okay sorry, i just did that to be more clear in the comments"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496135296, "post_id": 44256658, "comment_id": 75523961, "body": "@justinedps26: no problem. But do keep that in mind."}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496135401, "post_id": 44256658, "comment_id": 75524031, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/145428/discussion-between-justinedps26-and-sergio-tulentsev\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133203, "post_id": 44257256, "comment_id": 75522633, "body": "That&#39;ll be useful, yes, but it&#39;s not the cause of the exact problem in the question."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133627, "post_id": 44257256, "comment_id": 75522874, "body": "? @SergioTulentsev surely it is?  He&#39;s <code>calling carts_add_item_path</code> which resolves into a call to <code>add_item</code> without arguments. HIs definition of the <code>add_item</code> action expects an argument. <i>Wrong number of arguments, given 0, expected 1</i>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496133789, "post_id": 44257256, "comment_id": 75522966, "body": "No, invocation of <code>carts_add_item_path</code> does not end up with a call to <code>add_item</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496134133, "post_id": 44257256, "comment_id": 75523189, "body": "Ah, I see where I could be misunderstood. I was referring to the first part of the answer, the one with <code>carts_add_item_path(produit_id: produit.id)</code>. If you do only that (pass parameter this way) <b>and</b> leave the action signature intact, you&#39;ll still see the error."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496134216, "post_id": 44257256, "comment_id": 75523247, "body": "(<i>took the liberty to format some code. Horizontal scrolling on one-line snippets is horrible</i>)"}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496134291, "post_id": 44257256, "comment_id": 75523300, "body": "@SergioTulentsev the error went away but i now have <code>undefined method </code>[]&#39; for nil:NilClass`"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1496134499, "post_id": 44257256, "comment_id": 75523442, "body": "That&#39;s on line 7?  Did you spell &quot;params&quot; correctly?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1496134551, "post_id": 44257256, "comment_id": 75523480, "body": "I just realised you&#39;re not even using the argument!  Just remove it from the <code>def add_item</code> line."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1496134635, "post_id": 44257256, "comment_id": 75523537, "body": "@SergioTulentsev Yes, my answer was to do both steps, I wasn&#39;t giving OP a choice.  Good improvement on the formatting, I&#39;ll remember that for future."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1496134761, "post_id": 44257256, "comment_id": 75523625, "body": "And which line is the error?  Does it say <code>app&#47;controllers&#47;carts_controller.rb:8:in add_item</code> or `app/controllers/carts_controller.rb:9:in add_item&#39; ?"}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "edited": false, "score": 0, "creation_date": 1496134836, "post_id": 44257256, "comment_id": 75523671, "body": "@SteveTurczyn it says <code>app&#47;controllers&#47;carts_controller.rb:9:in </code>add_item&#39; `"}, {"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1496135216, "post_id": 44257256, "comment_id": 75523911, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/145427/discussion-between-justinedps26-and-steveturczyn\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1496135094, "last_edit_date": 1496135094, "creation_date": 1496133084, "answer_id": 44257256, "question_id": 44256658, "link": "https://stackoverflow.com/questions/44256658/ruby-on-rails-wrong-number-of-arguments-given-0-expected-1/44257256#44257256", "title": "Ruby on Rails: wrong number of arguments (given 0, expected 1)", "body": "<p>You need to pass produit_id as a parameter.</p>\n\n<p>So change this line as so...</p>\n\n<pre><code>&lt;%= link_to 'Ajouter au panier', \n            carts_add_item_path(produit_id: produit.id), method: :post %&gt;\n</code></pre>\n\n<p>And change your controller method as so...</p>\n\n<pre><code>def add_item\n  produit_id = params[:produit_id]\n  ...\n</code></pre>\n\n<p>And change the find_or_create to</p>\n\n<pre><code>@cart_item = CartItem.find_or_create_by(produit_id: produit_id)\n</code></pre>\n\n<p>This does mean that you can only have one CartItem in your entire application that points to a product... strange design.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "edited": false, "score": 0, "creation_date": 1496133523, "post_id": 44257258, "comment_id": 75522818, "body": "Thanks, can you let me know the other things that are wrong please?"}], "tags": [], "owner": {"reputation": 17379, "user_id": 1836143, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/8ddoM.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/1836143/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1496147061, "last_edit_date": 1496147061, "creation_date": 1496133089, "answer_id": 44257258, "question_id": 44256658, "link": "https://stackoverflow.com/questions/44256658/ruby-on-rails-wrong-number-of-arguments-given-0-expected-1/44257258#44257258", "title": "Ruby on Rails: wrong number of arguments (given 0, expected 1)", "body": "<p>There are a lot of things that are wrong with this code, but the simplest thing you could do in order to suppress the error is to change the method signature to:</p>\n\n<pre><code>def add_item\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>def add_item(produit_id)\n</code></pre>\n\n<p>P.S. The controller is not <a href=\"http://www.looah.com/source/view/2284\" rel=\"nofollow noreferrer\">RESTful</a>. It's called <code>CartsController</code>, but in your index action you list the <code>CartItems</code>, not the <code>Carts</code>. The correct name should be <code>CartItemsController</code>. If you rename the controller to <code>CartItemsController</code>, than the <code>index</code> action can stay the same, but the <code>add_item</code> action should better be renamed to simply <code>create</code>. Thus, in your routes you can have:</p>\n\n<pre><code>resources :cart_items, only: [:index, :create]\n</code></pre>\n\n<p>Also, I am not exactly sure, what is going on in the <code>add_item</code> method - at first you assign a new <code>CartItem</code> to @cart_item, but then you override this assignment with <code>find_or_create_by...</code>. Also, the call to <code>save</code> at the end of the method is redundant, as <code>create</code> will save the record and otherwise no modifications have been made between the <code>find_or_create_by</code> line and the <code>save</code> line.</p>\n"}], "owner": {"reputation": 149, "user_id": 5914341, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10208640241620387/picture?type=large", "display_name": "justinedps26", "link": "https://stackoverflow.com/users/5914341/justinedps26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10133, "favorite_count": 0, "accepted_answer_id": 44257256, "answer_count": 2, "score": 2, "last_activity_date": 1496147061, "creation_date": 1496131092, "last_edit_date": 1496134596, "question_id": 44256658, "link": "https://stackoverflow.com/questions/44256658/ruby-on-rails-wrong-number-of-arguments-given-0-expected-1", "title": "Ruby on Rails: wrong number of arguments (given 0, expected 1)", "body": "<p>I have an issue with my <code>add_item</code> method and have trouble to understand why.</p>\n\n<p>Here is my <code>carts_controller.rb</code></p>\n\n<pre><code>class CartsController &lt; ApplicationController\n  def index\n    @cart_items = CartItem.all\n  end\n\n  def add_item\n    @cart_item = CartItem.new\n    produit_id = params[:produit_id]\n    @cart_item = CartItem.find_or_create_by(params[:produit][:produit_id])\n    @cart_item.save\n\n    binding.pry\n  end\nend\n</code></pre>\n\n<p>Here is <code>produits/index.html.erb</code> (where the issue comes from)</p>\n\n<pre><code>&lt;div id=\"produits-column-container\"&gt;\n  &lt;% if @produits %&gt;\n    &lt;% @produits.in_groups_of(4, false).each do |g| %&gt;\n      &lt;% g.each do |produit| %&gt;\n      &lt;div id=\"produits-row-container\"&gt;\n        &lt;div id=\"fiche-produit-container\"&gt;\n            &lt;div id=\"produit-img\"&gt;\n              &lt;%= image_tag produit.photo %&gt;\n            &lt;/div&gt;\n            &lt;div id=\"produit-nom\"&gt;\n              &lt;%= produit.nom %&gt;\n            &lt;/div&gt;\n            &lt;div id=\"produit-prix\"&gt;\n              &lt;%= number_to_currency(produit.prix, unit: '\u20ac', format: \"%n%u\") %&gt;\n            &lt;/div&gt;\n            &lt;div id=\"produit-au-panier\"&gt;\n              &lt;%= image_tag('icon/icon-panier') %&gt;\n              &lt;%= link_to 'Ajouter au panier', carts_add_item_path, method: :post %&gt;\n            &lt;/div&gt;\n         &lt;/div&gt;\n       &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The error i'm given is :</p>\n\n<pre><code>ArgumentError in CartsController#add_item\nwrong number of arguments (given 0, expected 1)\n\nin def add_item(produit_id)\n</code></pre>\n\n<p><code>add_item(produit_id)</code> is related to <code>carts_add_item_path</code></p>\n\n<p>I also give you the routes :</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  match \"/mon-panier\" =&gt; 'carts#index', via: :get\n\n  post 'carts/add_item' =&gt; 'carts#add_item'\n\n  resources :categories do\n    resources :produits\n  end\n\n  resources :order_abonnements, only: [:create, :update, :delete]\n\n  get 'livraisons_type/index'\n\n  match \"/recapitulatif\" =&gt; 'recapitulatif#index', via: :get\n\n  match \"/confirmation-carte-cadeau\" =&gt; 'recapitulatif#confirmation', via: :get\n\n  match \"/livraison-carte-cadeau\" =&gt; 'livraison_carte#index', via: :get\n\n  match '/activation-carte' =&gt; 'code_carte_cadeau#index', via: :get\n\n  match \"/offrir-une-box-bretonne\" =&gt; 'cadeau#index', via: :get\n\n  resources :order_items, only: [:create, :update, :destroy]\n\n  match \"/nos-box\" =&gt; 'nos_box#index', via: :get\n\n  get 'categories/index'\n\n  devise_for :admin_users, ActiveAdmin::Devise.config\n  ActiveAdmin.routes(self)\n\n  match '/informations-penn-ar-box' =&gt; 'informations_penn_ar_box#index', via: :get\n\n  match '/livraison-box-bretonne' =&gt; 'livraison_box_bretonne#index', via: :get\n\n  match '/abonnements' =&gt; 'abonnements#index', via: :get\n\n  devise_for :users, path: '', path_names: { sign_in: 'connexion', sign_out: 'd\u00e9connexion'}\n\n  resources :users do\n    delete 'd\u00e9connexion' =&gt; 'devise/sessions#destroy'\n  end\n\n  match '/mon-marche-breton' =&gt; 'marche_breton#index', via: :get\n\n  root 'home#home'\nend\n</code></pre>\n\n<p>And the logs :</p>\n\n<pre><code>Started POST \"/carts/add_item\" for ::1 at 2017-05-30 09:48:52 +0200\nProcessing by CartsController#add_item as HTML\n  Parameters: {\"authenticity_token\"=&gt;\"QrToQUHVxjuV5cUvZYHd7tj457htfZohOkmsvNDnKv79P413xjsSfR/8RVXtdIU7/wcmhcxjkU85N13CqJkG2w==\"}\n  Cart Load (0.3ms)  SELECT  `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1\nCompleted 500 Internal Server Error in 27ms (ActiveRecord: 14.9ms)\n\nArgumentError (wrong number of arguments (given 0, expected 1)):\n  app/controllers/carts_controller.rb:6:in `add_item'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1496129870, "post_id": 44256154, "comment_id": 75520673, "body": "<a href=\"https://stackoverflow.com/questions/7233218/round-up-to-the-nearest-tenth\">duplicate</a>, at least with <code>to_dime</code>"}, {"owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1496130549, "post_id": 44256154, "comment_id": 75521072, "body": "The <code>to_dime</code> would be <code>(self * 10).round &#47; 10.0</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "edited": false, "score": 0, "creation_date": 1496133547, "post_id": 44256815, "comment_id": 75522824, "body": "And dollar (.00) ?"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1553787, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/lnACv.jpg?s=128&g=1", "display_name": "Vamsi Krishna", "link": "https://stackoverflow.com/users/1553787/vamsi-krishna"}, "is_accepted": false, "score": 0, "last_activity_date": 1496131635, "creation_date": 1496131635, "answer_id": 44256815, "question_id": 44256154, "link": "https://stackoverflow.com/questions/44256154/rails-rounding-float-with-different-options/44256815#44256815", "title": "Rails Rounding float with different options", "body": "<p>I think you can try the following overrides...</p>\n\n<p>Ceil goes with UP and Floor goes with DOWN</p>\n\n<pre><code>class Float\n  def ceil_to_quarter\n    (self * 4).ceil / 4.0\n  end\n\n  def floor_to_quarter\n    (self * 4).floor / 4.0\n  end\n\n  def ceil_to_dime\n    (self * 10).ceil / 10.0\n  end\n\n  def floor_to_dime\n    (self * 10).floor / 10.0\n  end\n\n  def ceil_to_penny\n    (self * 10).ceil / 10.0\n  end \n\n  def floor_to_penny\n    (self * 100).floor / 100.0\n  end \nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 515, "user_id": 4461539, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P1gw5q8RY4Y/AAAAAAAAAAI/AAAAAAAAAO8/vbF-z9SZp44/photo.jpg?sz=128", "display_name": "moyinho20", "link": "https://stackoverflow.com/users/4461539/moyinho20"}, "is_accepted": false, "score": 0, "last_activity_date": 1496131653, "creation_date": 1496131653, "answer_id": 44256821, "question_id": 44256154, "link": "https://stackoverflow.com/questions/44256154/rails-rounding-float-with-different-options/44256821#44256821", "title": "Rails Rounding float with different options", "body": "<p>Round to penny should work fine just like quarters</p>\n\n<pre><code>def round_to_penny\n  ((self * 100).round/100.0)\nend \n</code></pre>\n\n<p>Round to dime would however reduce to 1 decimal place since you are rounding to 1 decimal place. \nYou could change it to 2 decimal places when displaying the value. </p>\n\n<pre><code>def round_to_dime\n  ((self * 10).round/10.0)\nend\n</code></pre>\n\n<p>You could use '%.2f' however:</p>\n\n<pre><code>'%.2f' % 9.25.round_to_dime =&gt; \"9.30\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "edited": false, "score": 0, "creation_date": 1496133896, "post_id": 44257437, "comment_id": 75523040, "body": "The <code>precision</code> would get 4 for Quarter, 10 for Dime and 100 for penny ?"}, {"owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "reply_to_user": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "edited": false, "score": 0, "creation_date": 1496134081, "post_id": 44257437, "comment_id": 75523154, "body": "Default <code>1</code> is no rounding (penny). Use <code>10</code> for dime, <code>25</code> for quarter and <code>100</code> for dollar"}, {"owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "edited": false, "score": 0, "creation_date": 1496134751, "post_id": 44257437, "comment_id": 75523617, "body": "And for dollar (.00) ?"}, {"owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "reply_to_user": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "edited": false, "score": 1, "creation_date": 1496135124, "post_id": 44257437, "comment_id": 75523853, "body": "@Arif: you&#39;ll want to use <code>100</code>. I&#39;ve updated the snippet to clarify this"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1496153892, "post_id": 44257437, "comment_id": 75537496, "body": "Maybe use <code>BigDecimal</code> instead to avoid the floating point precision issues. This could be added easily  <code>integer_value = (BigDecimal.new(self) * 100).round</code>"}], "tags": [], "owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "is_accepted": true, "score": 4, "last_activity_date": 1496135102, "last_edit_date": 1496135102, "creation_date": 1496133589, "answer_id": 44257437, "question_id": 44256154, "link": "https://stackoverflow.com/questions/44256154/rails-rounding-float-with-different-options/44257437#44257437", "title": "Rails Rounding float with different options", "body": "<p>Here's a generic way to do it for any precision:</p>\n\n<pre><code>class Float\n  def round_currency(precision: 1, direction: :none)\n    round_method = case direction\n      when :none then :round\n      when :up   then :ceil\n      when :down then :floor\n    end\n\n    integer_value = (self * 100).round\n    ((integer_value / precision.to_f).send(round_method) * precision / 100.0)\n  end\nend\n\n\n# USAGE\n9.37.round_currency(direction: :none, precision: 10)\n# =&gt; 9.4\n\n9.37.round_currency(direction: :up, precision: 25)\n# =&gt; 9.5\n\n9.37.round_currency(direction: :none)\n# =&gt; 9.37\n\n# Precision is defined in pennies: 10 dime, 25 quarter, 100 dollar. 1 penny is default\n</code></pre>\n\n<p>This code converts the float into an integer first to ensure accuracy. Be wary using <code>ceil</code> and <code>floor</code> with floating number arithmetic - due to accuracy errors you could get odd results e.g. <code>9.37 * 100 = 936.9999999999999</code>. If you <code>floor</code> the result, you'll end up rounding to 9.36</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1496230276, "last_edit_date": 1496230276, "creation_date": 1496160920, "answer_id": 44267226, "question_id": 44256154, "link": "https://stackoverflow.com/questions/44256154/rails-rounding-float-with-different-options/44267226#44267226", "title": "Rails Rounding float with different options", "body": "<p>One more way to handle the situation:</p>\n\n<pre><code>require 'bigdecimal'\nclass Rounder\n  DENOMS = {penny: 0.01, nickel: 0.05, dime: 0.1, quarter: 0.25, half_dollar: 0.5, dollar: 1.0}\n  DENOMS.each do |denom,val|\n    define_method(\"round_to_#{denom}\") do |direction: :nearest|\n        self.send(direction, self.send(:step_def, val))\n    end     \n  end\n  def initialize(v)\n    @v = BigDecimal(v.to_s)\n    @enum_range = (@v.floor..@v.floor + 1)\n  end\n\n  def round_to(denom,direction: :nearest)\n    check_denom(denom)\n    if denom.is_a?(Numeric)\n      self.send(direction, self.send(:step_def, denom))\n    else\n      self.public_send(\"round_to_#{denom}\",direction: direction) \n    end    \n  end\n\n\n  private \n    def down(enum)\n        enum.reverse_each.detect {|f| f &lt;= @v }\n    end\n    def up(enum) \n        enum.detect {|f| f &gt;= @v }\n    end\n    def nearest(enum)\n      [up(enum),down(enum)].min_by {|n| (n - @v).abs}\n    end\n    def step_def(val)\n      @enum_range.step(val)\n    end  \n    def check_denom(denom)\n      if denom.is_a?(Numeric)\n        raise ArgumentError, \"Numeric denom must be greater than 0 and less than or equal to 1\" if (denom &gt; 1 || denom &lt;= 0)\n      elsif denom.respond_to?(:to_sym)\n        raise ArgumentError, \"expecting one of #{DENOMS.keys} got :#{denom.to_sym}\" unless DENOMS.keys.include?(denom.to_sym)\n      else\n        raise ArgumentError,\"expected Numeric, Symbol or String got #{denom.class}\"\n      end\n    end    \nend\n</code></pre>\n\n<p>This allows flexible implementation for predefined denominations as well as rounding to any precision desired. Obviously this could be optimized a bit for longer precision's by scaling down the <code>@enum_range</code>.</p>\n\n<p>You could patch this in to <code>Numeric</code> to allow direct access:</p>\n\n<pre><code>class Numeric\n  def round_to(denom,direction: :nearest)\n    Rounder.new(self).round_to(denom,direction: direction)\n  end\nend\n</code></pre>\n\n<p>Then usage as such </p>\n\n<pre><code>r = Rounder.new(9.22)\nr.round_to_quarter\n#=&gt; 9.25\nr.round_to_dime(direction: :up)\n#=&gt; 9.3\nr.round_to(:nickel)\n#=&gt; 9.2\nr.round_to(0.45, direction: :up)\n#=&gt; 9.45\nr.round_to({})\n#=&gt; ArgumentError: expected Numeric, Symbol or String got Hash\nr.round_to(:pound)\n#=&gt; ArgumentError: expecting one of [:penny, :nickel, :dime, :quarter,\n#     :half_dollar, :dollar] got :pound\n77.43.round_to(:quarter)\n#=&gt; 77.5\nRounder.new(\"123.0000001\").round_to_half_dollar(direction: :up)\n#=&gt; 123.5\n#Obviously a Fixnum is already precise but it does still work \n[:down,:up].each do |dir|\n  puts \"#{dir} =&gt; #{12.round_to(:quarter, direction: dir)}\"\nend\n# down =&gt; 12.0\n# up =&gt; 12.0\n</code></pre>\n"}], "owner": {"reputation": 1239, "user_id": 2134398, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c858429a7d7289246899d678137e7ea0?s=128&d=identicon&r=PG", "display_name": "Arif", "link": "https://stackoverflow.com/users/2134398/arif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 44257437, "answer_count": 4, "score": 0, "last_activity_date": 1496230276, "creation_date": 1496129502, "last_edit_date": 1496133285, "question_id": 44256154, "link": "https://stackoverflow.com/questions/44256154/rails-rounding-float-with-different-options", "title": "Rails Rounding float with different options", "body": "<p>I have a form where user enters a decimal value and a drop down with four options: <code>Dollar (.00)</code>, <code>Quarter (.00, .25, .50, .75)</code>,  <code>Dime (.10, .20, .30 .. .90)</code> and <code>Penny (.01, .02, .03 ... .99)</code>. Also there is an option to select either round <code>UP</code> or <code>DOWN</code>.</p>\n\n<p>These options are used to round the value entered by the user. I monkey patched the <code>Float</code> class and added <code>round_to_quarter</code> that works fine:</p>\n\n<pre><code>class Float\n  def round_to_quarter\n    (self * 4).round / 4.0\n  end\n\n  def round_to_dime\n    #TODO\n  end\n\n  def round_to_penny\n    #TODO\n  end\n\n  def round_to_dollar\n    #TODO\n  end  \nend\n\n9.22.round_to_quarter #=&gt; 9.25\n</code></pre>\n\n<p>How do I round the value for Dime(.10, .20, .30 .. .90) and Penny (.01, .02, .03 ... .99) options and round up and down?</p>\n\n<p>The Ruby version is 2.2.3</p>\n"}]