[{"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1534367006, "post_id": 51866350, "comment_id": 90684941, "body": "It looks like Duck Duck Go is returning an internal link which will redirect to an external link when clicked. Maybe it has detected Nokogiri has no JavaScript, where a real web browser uses JavaScript to ping DDG each time you click a link. Try parsing the URI and extracting the &#39;uddg&#39; parameter for the external link."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1534409509, "post_id": 51866350, "comment_id": 90697666, "body": "Please, don&#39;t post pictures of your data. Post the <i>actual</i> data. This is a programming site, not a photography site. We want to copy&amp;paste&amp;debug&amp;read your data, not critique its use of color and composition. Case in point: on my old laptop with my screen resolution, all I see is two red arrows pointing to a blob that may or may not be text that is actually relevant to the question but is impossible to read."}], "answers": [{"comments": [{"owner": {"reputation": 22618, "user_id": 1555312, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/12c03a0fc2ac25d234882cf93f1d3052?s=128&d=identicon&r=PG", "display_name": "bigpotato", "link": "https://stackoverflow.com/users/1555312/bigpotato"}, "edited": false, "score": 0, "creation_date": 1534371993, "post_id": 51866460, "comment_id": 90686475, "body": "ended up ditching ruby and going with JS + puppeteer for a headless browser"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "reply_to_user": {"reputation": 22618, "user_id": 1555312, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/12c03a0fc2ac25d234882cf93f1d3052?s=128&d=identicon&r=PG", "display_name": "bigpotato", "link": "https://stackoverflow.com/users/1555312/bigpotato"}, "edited": false, "score": 0, "creation_date": 1534376171, "post_id": 51866460, "comment_id": 90687393, "body": "Right - a real browser tells the website it has JavaScript, so you get the real HREF and not the self-directing version..."}], "tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 0, "last_activity_date": 1534367286, "creation_date": 1534367286, "answer_id": 51866460, "question_id": 51866350, "link": "https://stackoverflow.com/questions/51866350/nokogiri-is-returning-odd-hrefs-for-links/51866460#51866460", "title": "Nokogiri is returning odd hrefs for links?", "body": "<p>After reading my comment, now use <code>parts = href.split('?')</code> and <code>CGI.parse(parts.last)['ubbg']</code> to get to the target URI.</p>\n"}], "owner": {"reputation": 22618, "user_id": 1555312, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/12c03a0fc2ac25d234882cf93f1d3052?s=128&d=identicon&r=PG", "display_name": "bigpotato", "link": "https://stackoverflow.com/users/1555312/bigpotato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534367286, "creation_date": 1534366764, "question_id": 51866350, "link": "https://stackoverflow.com/questions/51866350/nokogiri-is-returning-odd-hrefs-for-links", "title": "Nokogiri is returning odd hrefs for links?", "body": "<p>I am using <code>nokogiri (~&gt; 1.8.4)</code> to try to scrape all links on a page. However, it is returning weirdly formatted strings.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\n\ndef all_links\n  doc = Nokogiri::HTML(open(\"https://duckduckgo.com/html/?q=sergey+facebook\"))\n  links = doc.css('a')\n  hrefs = links.map {|link| link.attribute('href').to_s}.uniq.sort.delete_if {|href| href.empty?}\n  hrefs\nend\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre><code>/l/?kh=-1&amp;uddg=https%3A%2F%2Fen%2Dgb.facebook.com%2Fpublic%2FSergey%2DKozhanov\n</code></pre>\n\n<p>The links on that page don't have hrefs like that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HEMWv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HEMWv.png\" alt=\"enter image description here\"></a></p>\n\n<p>What am I doing wrong? I tried using xpaths too and got the same result.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1534366481, "post_id": 51866283, "comment_id": 90684741, "body": "Are you certain you want to use HABTM instead of <code>has_many :through</code>?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1534366564, "post_id": 51866283, "comment_id": 90684773, "body": "@jvillian It&#39;s pretty much the same thing right? Except the join table is a model I&#39;d create? I&#39;ve got several other models using this structure and it works well."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1534366840, "post_id": 51866283, "comment_id": 90684876, "body": "Welp. I suppose if you <i>might</i> what to store data on the association object at some point in the future, you can save yourself another data migration but using <code>has_many :through</code>. Personally, I never use HABTM, but that&#39;s just a personal preference."}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1534368978, "post_id": 51866447, "comment_id": 90685613, "body": "Well stated. I believe, however, the OP&#39;s question is about migrating existing data (<i>I need to change the relationship from has_many to has_and_belongs_to_many without losing my current data</i>)."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1534427403, "post_id": 51866447, "comment_id": 90708661, "body": "@AaronBreckenridge how would I save data to the <code>InvoiceTransaction</code> model? Say I wanted to save the amount for a given invoice there."}, {"owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "edited": false, "score": 0, "creation_date": 1534449423, "post_id": 51866447, "comment_id": 90720499, "body": "That doesn&#39;t seem like the right place to put it (<code>amount</code> sounds like a property of the Transaction), but you&#39;d just add an <code>amount</code> column in your migration."}], "tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": true, "score": 1, "last_activity_date": 1534367237, "creation_date": 1534367237, "answer_id": 51866447, "question_id": 51866283, "link": "https://stackoverflow.com/questions/51866283/change-has-many-to-has-and-belongs-to-many/51866447#51866447", "title": "Change has_many to has_and_belongs_to_many", "body": "<p>I haven't seen a ton of HABTM associations built in the last few years. Usually people go ahead and specify the entire association graph:</p>\n\n<pre><code>class Invoice\n  has_many :invoice_transactions\n  has_many :transactions, through: :invoice_transactions\nend\n\nclass InvoiceTransaction\n  belongs_to :invoice\n  belongs_to :transaction\nend\n\nclass Transaction\n  has_many :invoice_transactions\n  has_many :invoices, through: :invoice_transactions\nend\n\n# in a migration\ncreate_table :invoice_transactions do |t|\n  t.belongs_to :invoice\n  t.belongs_to :transaction\nend\nexecute('INSERT INTO invoice_transactions VALUES (invoice_id, transaction_id) FROM (SELECT id, transaction_id FROM invoices)')\n</code></pre>\n\n<p>This is because InvoiceTransaction is likely to gain some additional behavior, but that's a (very little bit of) speculative programming (and probably worth doing).</p>\n\n<p>What you're asking for exactly can be accomplished with:</p>\n\n<pre><code>class Transaction\n  has_any_belongs_to_many :invoices\nend\n\nclass Invoice\n  has_and_belongs_to_many :transactions\nend\n</code></pre>\n\n<p>This is described further (along with another sample migration) in the <a href=\"https://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow noreferrer\">rails guides</a>.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 51866447, "answer_count": 1, "score": -1, "last_activity_date": 1534367237, "creation_date": 1534366421, "question_id": 51866283, "link": "https://stackoverflow.com/questions/51866283/change-has-many-to-has-and-belongs-to-many", "title": "Change has_many to has_and_belongs_to_many", "body": "<p>I've got a <code>Invoice</code> model that <code>has_many</code> <code>Transactions</code>. I need to change the relationship from <code>has_many</code> to <code>has_and_belongs_to_many</code> without losing my current data so that I can associate a single transaction (payment) with multiple invoices. </p>\n\n<p>My current model structure:</p>\n\n<pre><code>class Invoice\n    has_many :transactions\n\nend\n\n\nclass Transaction\n    belongs_to :invoice\nend\n</code></pre>\n"}, {"tags": ["ruby", "path", "webdriver"], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 1404478, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f8fb5c17fb8b1277051be16083a74990?s=128&d=identicon&r=PG", "display_name": "Martin Marino", "link": "https://stackoverflow.com/users/1404478/martin-marino"}, "is_accepted": false, "score": 0, "last_activity_date": 1534429310, "creation_date": 1534429310, "answer_id": 51879342, "question_id": 51866032, "link": "https://stackoverflow.com/questions/51866032/geckodriver-in-path-but-getting-selenium-webdriver-error/51879342#51879342", "title": "GeckoDriver in PATH, but getting Selenium Webdriver Error", "body": "<p>I figured it out. Instead of using  gem install selenium-webdriver -v 3.2.1, I needed to use gem install selenium-webdriver</p>\n"}], "owner": {"reputation": 355, "user_id": 1404478, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f8fb5c17fb8b1277051be16083a74990?s=128&d=identicon&r=PG", "display_name": "Martin Marino", "link": "https://stackoverflow.com/users/1404478/martin-marino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534429310, "creation_date": 1534365263, "question_id": 51866032, "link": "https://stackoverflow.com/questions/51866032/geckodriver-in-path-but-getting-selenium-webdriver-error", "title": "GeckoDriver in PATH, but getting Selenium Webdriver Error", "body": "<p>I needed to reinstall Ruby 2.3.3. I'm getting selenium webdriver error now though, which I've had before, but all I needed to do was add my geckodriver to path. As you can see in the screenshot below, my geckodriver path is correct.</p>\n\n<p>My terminal output</p>\n\n<pre><code>C:\\development&gt;ruby test.rb\nC:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.2.1/lib/selenium/webdriver/remote/w3c_bridge.rb:114:in `create_session': no sessionId in returned payload (Selenium::WebDriver::Error::WebDriverError)\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.2.1/lib/selenium/webdriver/remote/w3c_bridge.rb:70:in `initialize'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.2.1/lib/selenium/webdriver/firefox/w3c_bridge.rb:35:in `initialize'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.2.1/lib/selenium/webdriver/common/driver.rb:52:in `new'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.2.1/lib/selenium/webdriver/common/driver.rb:52:in `for'\n        from C:/Ruby23-x64/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.2.1/lib/selenium/webdriver.rb:87:in `for'\n        from test.rb:2:in `&lt;main&gt;'\n</code></pre>\n\n<p>Path Image\n<a href=\"https://i.stack.imgur.com/RarYY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RarYY.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried redownloading and installing geckodriver, deleting the old path and adding the new one, restarting after that and also tried creating a new web test. The result is the same everytime. All the gems I need for this to work are installed. What am I missing?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1534362664, "post_id": 51865448, "comment_id": 90683156, "body": "That&#39;s not a valid ruby array."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534374406, "post_id": 51865448, "comment_id": 90687015, "body": "I&#39;ve made assumptions in my edit of your question (e.g., converting strings to integers). If I am in error, edit to correct, of course."}, {"owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "edited": false, "score": 0, "creation_date": 1534836017, "post_id": 51865448, "comment_id": 90836549, "body": "You can try this one  <code>array = array.map { |val| val[&#47;\\d*\\z&#47;].to_i }</code>"}, {"owner": {"reputation": 4609, "user_id": 1111169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43c129d75cbb379dea164181b46deff?s=128&d=identicon&r=PG", "display_name": "KumarHarsh", "link": "https://stackoverflow.com/users/1111169/kumarharsh"}, "edited": false, "score": 0, "creation_date": 1535954925, "post_id": 51865448, "comment_id": 91237671, "body": "IMO,it is very much clear, and good question for beginner. That might not be valid array ,but is very much clear."}], "answers": [{"comments": [{"owner": {"reputation": 2365, "user_id": 1921272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf3458cc27fbf9d342ed77ce79d78ec?s=128&d=identicon&r=PG", "display_name": "yesnik", "link": "https://stackoverflow.com/users/1921272/yesnik"}, "edited": false, "score": 0, "creation_date": 1534402528, "post_id": 51865952, "comment_id": 90693760, "body": "Similar solution: <code>array.map { |x| x.split(&#39;=&#39;).last.to_i }</code>"}], "tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": false, "score": 2, "last_activity_date": 1534364916, "creation_date": 1534364916, "answer_id": 51865952, "question_id": 51865448, "link": "https://stackoverflow.com/questions/51865448/how-to-remove-multiple-elements-from-array-using-splits-in-ruby/51865952#51865952", "title": "How to remove multiple elements from array using splits in Ruby", "body": "<p>Assuming those were actually strings, you could do this:</p>\n\n<pre><code>array = [\"5ms=208\", \"6ms=114\", \"7ms=95\", \"8ms=49\", \"9ms=38\", \"10ms=36\", \"11ms=35\"]\nsplit = array.map { |time| time.split('=')[1] }\n</code></pre>\n\n<p>And the result will be:</p>\n\n<pre><code>[\"208\", \"114\", \"95\", \"49\", \"38\", \"36\", \"35\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534374220, "post_id": 51865965, "comment_id": 90686980, "body": "Note my edit of the question."}, {"owner": {"reputation": 49, "user_id": 6523423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ERWj50Hs1lU/AAAAAAAAAAI/AAAAAAAAB7M/JKgpgxth8WI/photo.jpg?sz=128", "display_name": "Claudiu Balta", "link": "https://stackoverflow.com/users/6523423/claudiu-balta"}, "edited": false, "score": 0, "creation_date": 1536051449, "post_id": 51865965, "comment_id": 91274450, "body": "I went for you suggestion and it worked perfectly! Thank you so much!!! You helped me optimize my time a whole lot better at work :D"}], "tags": [], "owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "is_accepted": false, "score": 1, "last_activity_date": 1534401974, "last_edit_date": 1534401974, "creation_date": 1534364963, "answer_id": 51865965, "question_id": 51865448, "link": "https://stackoverflow.com/questions/51865448/how-to-remove-multiple-elements-from-array-using-splits-in-ruby/51865965#51865965", "title": "How to remove multiple elements from array using splits in Ruby", "body": "<p>Given your array of Strings:</p>\n\n<pre><code>array = [\"5ms=208\", \"6ms=114\", \"7ms=95\", \"8ms=49\", \"9ms=38\", \"10ms=36\", \"11ms=35\", \"12ms=20\", \"13ms=24\", \"14ms=19\", \"15ms=15\", \"16ms=10\", \"4550ms=0\", \"4600ms=0\", \"4650ms=0\", \"4700ms=0\", \"4750ms=0\", \"4800ms=0\", \"4850ms=0\", \"4900ms=0\", \"4950ms=0\"]\n</code></pre>\n\n<p>this should do the job:</p>\n\n<pre><code>array.map { |element| element[/\\d*\\z/].to_i }\n# Array of Integers\n# =&gt; [208, 114, 95, 49, 38, 36, 35, 20, 24, 19, 15, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n</code></pre>\n\n<p>I hope you find that helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1534392266, "last_edit_date": 1534392266, "creation_date": 1534371525, "answer_id": 51867214, "question_id": 51865448, "link": "https://stackoverflow.com/questions/51865448/how-to-remove-multiple-elements-from-array-using-splits-in-ruby/51867214#51867214", "title": "How to remove multiple elements from array using splits in Ruby", "body": "<pre><code>array.map { |s| s[/(?&lt;=\\dms=)\\d+\\z/].to_i }\n  #=&gt; [208, 114, 95, 49, 38, 36, 35, 20, 24, 19, 15, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n</code></pre>\n\n<p><code>(?&lt;=\\dms=)</code> is a <em>positive lookbehind</em>, requiring the match to be immediatelly preceded by the string <code>\"\\dms=\"</code>, where <code>\\d</code> is any digit. <code>\\d\\z</code> ensures that there are only digits in the remainder of the string (<code>\\z</code> being the end-of-string anchor) in order for there to be a match. </p>\n"}], "owner": {"reputation": 49, "user_id": 6523423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ERWj50Hs1lU/AAAAAAAAAAI/AAAAAAAAB7M/JKgpgxth8WI/photo.jpg?sz=128", "display_name": "Claudiu Balta", "link": "https://stackoverflow.com/users/6523423/claudiu-balta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1534393151, "answer_count": 3, "score": -7, "last_activity_date": 1534401974, "creation_date": 1534362448, "last_edit_date": 1534371324, "question_id": 51865448, "link": "https://stackoverflow.com/questions/51865448/how-to-remove-multiple-elements-from-array-using-splits-in-ruby", "closed_reason": "Needs details or clarity", "title": "How to remove multiple elements from array using splits in Ruby", "body": "<p>I have the following array.</p>\n\n<pre><code>array =  [\"5ms=208\", \"6ms=114\", \"7ms=95\", \"8ms=49\", \"9ms=38\", \"10ms=36\",\n          \"11ms=35\", \"12ms=20\", \"13ms=24\", \"14ms=19\", \"15ms=15\", \"16ms=10\", \n          \"4550ms=0\", \"4600ms=0\", \"4650ms=0\", \"4700ms=0\", \"4750ms=0\",\n          \"4800ms=0\", \"4850ms=0\", \"4900ms=0\", \"4950ms=0\"]\n</code></pre>\n\n<p>For each element of the array, I wish to extract the string representation of a number following the equals sign, convert it to an integer and return the following array.</p>\n\n<pre><code>[208, 114, 95, 49, 38, 36, 35, 20, 24, 19, 15, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n</code></pre>\n\n<p>How can I do that?</p>\n"}, {"tags": ["arrays", "ruby", "sorting"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1534359732, "post_id": 51864837, "comment_id": 90681888, "body": "You mean 2 consecutive words? Or words from any distance? Note. <code>#collect</code> gives only item per iteration, so it will be <code>do |a|</code>, not <code>do |a, z|</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1534370217, "post_id": 51864837, "comment_id": 90686024, "body": "&quot;I&#39;ve written the following but just get error messages.&quot; \u2013 And what do they say? What line do they occur on? Often, error messages contain some advice. Did you follow it?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1534391835, "post_id": 51864837, "comment_id": 90690356, "body": "To put some flesh on @J&#246;rgWMittag&#39;s comment, your error message would have been <code>NoMethodError (undefined method &#39;[]&#39; for nil:NilClass)</code> in the line <code>if a[0] == z[0]</code>. The receiver of the method <code>[]</code> is <code>a</code> on the left of <code>==</code> and <code>b</code> on the right. That tells us that <code>a</code> is <code>nil</code> or <code>b</code> is <code>nil</code> (or both), as <code>nil</code> has no method <code>[]</code>. If you rerun your code with the statement  <code>puts &quot;a=#{a}, z=#{z}&quot;</code> you will find that <code>a #=&gt; &quot;I&quot;</code> (the first word) and <code>z #=&gt; nil</code>. <code>z</code> is <code>nil</code> because a single string (`&quot;I&quot;) is being passed to the block, so you should only have one block variable..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534391994, "post_id": 51864837, "comment_id": 90690378, "body": "...Ruby computes <code>a,z = &quot;I&quot;</code>, which assigns <code>&quot;I&quot;</code> to <code>a</code> and <code>nil</code> to <code>z</code>. As you see the (first) error is pinpointed by the error message. Error message deserve careful study."}], "answers": [{"comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 3, "creation_date": 1534360267, "post_id": 51864923, "comment_id": 90682114, "body": "<code>sort</code> isn&#39;t stable"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534390567, "post_id": 51864923, "comment_id": 90690123, "body": "Further to @matthewd&#39;s comment, this only works when the <code>sort</code> algorithm employed has the property that, for every pair of elements <code>a</code> and <code>b</code> in <code>arr</code>, when <code>a &lt;=&gt; b #=&gt; 0</code>, <code>a</code> will precede <code>b</code> in the sorted array if and and only if <code>a</code> precedes <code>b</code> in <code>arr</code>. Here is a simple example of a sort method that does not have that property: <code>class Array; def my_sort; reverse.sort; end; end; &quot;I really love llamas&quot;.split.my_sort do |a,z| a[0] == z[0] ? 0 : a &lt;=&gt; z; end.join(&quot; &quot;) #=&gt; &quot;I llamas love really&quot;</code>,"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": -2, "last_activity_date": 1534360024, "creation_date": 1534360024, "answer_id": 51864923, "question_id": 51864837, "link": "https://stackoverflow.com/questions/51864837/conditional-sorting-of-an-array-ruby/51864923#51864923", "title": "Conditional sorting of an array (Ruby)", "body": "<p>A block need to be specified to <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-sort\" rel=\"nofollow noreferrer\">Array#sort</a> method.</p>\n\n<p>The block must implement a comparison between a and b, and return -1, when a follows b, 0 when a and b are equivalent, or +1 if b follows a.</p>\n\n<p>So the logic is: return <code>0</code> if first letters the same; otherwise compare the whole string using <code>&lt;=&gt;</code>. After the sorting, join the elements to a single string</p>\n\n<pre><code>\"I really love lamas\".split.sort do |a, z|\n  if a[0] == z[0]\n    0\n  else\n    a &lt;=&gt; z\n  end\nend.join(\" \")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1534389384, "creation_date": 1534389384, "answer_id": 51869121, "question_id": 51864837, "link": "https://stackoverflow.com/questions/51864837/conditional-sorting-of-an-array-ruby/51869121#51869121", "title": "Conditional sorting of an array (Ruby)", "body": "<pre><code>str = \"I really love llamas\"   \n\nstr.split.each_with_index.\n          sort { |(a,i),(b,j)| a[0]==b[0] ? i&lt;=&gt;j : a&lt;=&gt;b }.\n          map(&amp;:first)\n  #=&gt; [\"I\", \"love\", \"llamas\", \"really\"]\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = str.split\n  #=&gt; [\"I\", \"really\", \"love\", \"llamas\"]\nb = a.each_with_index\n  #=&gt; #&lt;Enumerator: [\"I\", \"really\", \"love\", \"llamas\"]:each_with_index&gt;\n</code></pre>\n\n<p>We can convert this enumerator to an array to see the values it will generate and pass to the block, to be assigned as values to the block variables <code>a</code> and <code>z</code>.</p>\n\n<pre><code>b.to_a\n  #=&gt; [[\"I\", 0], [\"really\", 1], [\"love\", 2], [\"llamas\", 3]]\n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>c = b.sort { |(a,i),(b,j)| a[0]==b[0] ? i&lt;=&gt;j : a&lt;=&gt;b }\n  #=&gt; [[\"I\", 0], [\"love\", 2], [\"llamas\", 3], [\"really\", 1]]\nc.map(&amp;:first)\n  #=&gt; [\"I\", \"love\", \"llamas\", \"really\"]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10015021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HZGDXF30GOI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bwFSExDCX6ra55V4_FVU9mGMVqA/mo/photo.jpg?sz=128", "display_name": "Jude", "link": "https://stackoverflow.com/users/10015021/jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 51864923, "answer_count": 2, "score": -2, "last_activity_date": 1534389384, "creation_date": 1534359631, "question_id": 51864837, "link": "https://stackoverflow.com/questions/51864837/conditional-sorting-of-an-array-ruby", "title": "Conditional sorting of an array (Ruby)", "body": "<p>I want to sort an array alphabetically, unless two words have the same first letter, in which case the returned array should show them in the order they appeared in the given string.</p>\n\n<p>E.g. \"I really love lamas\" => [\"I\", \"love\", \"lamas\", \"really\"]</p>\n\n<p>I've written the following but just get error messages. Can I tweak this so it works, or am I totally going down the wrong path?</p>\n\n<pre><code>\"I really love lamas\".split.sort.collect do |a, z|\n  if a[0] == z[0]\n  puts a z\n  else \n  z a\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 0, "last_activity_date": 1534360375, "last_edit_date": 1534360375, "creation_date": 1534359993, "answer_id": 51864917, "question_id": 51864471, "link": "https://stackoverflow.com/questions/51864471/how-do-i-get-the-id-of-a-post-from-another-controller-in-rails/51864917#51864917", "title": "How do I get the ID of a post from another controller in Rails?", "body": "<p>An <code>index</code> action is usually used to represent a collection of items. For example:</p>\n\n<pre><code>def index\n  @posts = Post.order(:published_at).all\nend\n</code></pre>\n\n<p>Your <code>index</code> action looks very different though. You're creating a new instance of a <code>Post</code>, and then attempting to lookup a single <code>Post</code> by ID. This combines the role of a <code>new</code> action with a <code>show</code> action. For example:</p>\n\n<pre><code>def new\n  @post = Post.new\nend\n\ndef show\n  @post = Post.find(params[:id])\nend\n</code></pre>\n\n<p>If you're using resourceful routing, your route helpers expect you to be using this pattern. Thus, a request to <code>/posts</code> goes to the PostsController#index, and <code>/posts/1</code> goes to the PostsController#show action with an ID parameter equal to <code>1</code>. </p>\n\n<p>In your view, you would link to the <code>index</code> action with <code>posts_path</code> (plural) and the <code>show</code> action with <code>post_path(1)</code> (singular, where <code>1</code> is the ID of the Post).</p>\n\n<p>I recommend you review your code and adjust it to fit these best practices / the Rails way and see if you can resolve the error. </p>\n"}, {"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1534392610, "creation_date": 1534392610, "answer_id": 51869494, "question_id": 51864471, "link": "https://stackoverflow.com/questions/51864471/how-do-i-get-the-id-of-a-post-from-another-controller-in-rails/51869494#51869494", "title": "How do I get the ID of a post from another controller in Rails?", "body": "<blockquote>\n  <p>And I want to add the contents of the posts controller to the main. I would like to create a link from home/index to posts/show.</p>\n</blockquote>\n\n<p>Based on this, i believe you want to display all the posts on your home page and also have a link against each post to go to show page for that post.</p>\n\n<p>You can achieve that by doing these simple changes in your home action and its view:</p>\n\n<p><em>home_controller.rb</em></p>\n\n<pre><code>def index\n  @posts = Post.all # Use pagination, if you have hundreds or thousands of posts\nend\n</code></pre>\n\n<p><em>home/index.html.erb</em></p>\n\n<pre><code>&lt;% @posts.each do |post| %&gt;\n  &lt;%= post.title %&gt;\n  &lt;%= post.other_details %&gt;\n\n  &lt;!-- Link to visit individual post's show page --&gt;\n  &lt;%= link_to 'See more', post_path(post) %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 9851945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbb5227b025f882757a6859c3b1e49a?s=128&d=identicon&r=PG&f=1", "display_name": "dsfdsf2fafad", "link": "https://stackoverflow.com/users/9851945/dsfdsf2fafad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 51869494, "answer_count": 2, "score": 0, "last_activity_date": 1534392610, "creation_date": 1534357946, "question_id": 51864471, "link": "https://stackoverflow.com/questions/51864471/how-do-i-get-the-id-of-a-post-from-another-controller-in-rails", "title": "How do I get the ID of a post from another controller in Rails?", "body": "<p>The main of my web is home/index. </p>\n\n<p>And I want to add the contents of the posts controller to the main. I would like to create a link from home/index to posts/show. Also I am using scaffold.</p>\n\n<p>But I am getting the error <strong>Could not find Post with 'id' =</strong>.</p>\n\n<p>What can I do?</p>\n\n<p><strong>home_controller.rb</strong></p>\n\n<pre><code>  def index\n    @post = Post.new\n\n    @posts = Post.find(params[:id])\n  end\n</code></pre>\n\n<p><strong>posts_controller.rb</strong></p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  before_action :set_post, only: [:show, :edit, :update, :destroy]\n\n  # GET /posts\n  # GET /posts.json\n  def index\n    @posts = Post.find(params[:id])\n  end\n\n  # GET /posts/1\n  # GET /posts/1.json\n  def show\n  end\n\n  # GET /posts/new\n  def new\n    @post = Post.new\n  end\n\n\n  # GET /posts/1/edit\n  def edit\n  end\n\n  # POST /posts\n  # POST /posts.json\n  def create\n    @post = Post.new(post_params)\n\n    respond_to do |format|\n      if @post.save\n        format.html { redirect_to @post, notice: 'Post was successfully created.' }\n        format.json { render :show, status: :created, location: @post }\n      else\n        format.html { render :new }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /posts/1\n  # PATCH/PUT /posts/1.json\n  def update\n    respond_to do |format|\n      if @post.update(post_params)\n        format.html { redirect_to @post, notice: 'Post was successfully updated.' }\n        format.json { render :show, status: :ok, location: @post }\n      else\n        format.html { render :edit }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /posts/1\n  # DELETE /posts/1.json\n  def destroy\n    @post.destroy\n    respond_to do |format|\n      format.html { redirect_to posts_url, notice: 'Post was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_post\n      @post = Post.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def post_params\n      params.require(:post).permit(:title, :content)\n    end\nend\n</code></pre>\n\n<p><strong>index.html.erb (home_controller)</strong></p>\n\n<pre><code>&lt;%= link_to 'Show', post_path(@posts.id) %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "puts"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 1, "creation_date": 1534357925, "post_id": 51864410, "comment_id": 90681026, "body": "Your guess is right, and it makes sense."}], "answers": [{"tags": [], "owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "is_accepted": true, "score": 2, "last_activity_date": 1534365541, "creation_date": 1534365541, "answer_id": 51866084, "question_id": 51864410, "link": "https://stackoverflow.com/questions/51864410/what-is-ios-in-the-ruby-documentation-for-puts/51866084#51866084", "title": "What is &quot;ios&quot; in the Ruby documentation for puts?", "body": "<p>Your guess is absolutely right. Here is a paragraph in which both terms <code>ios</code> and <code>I/O streams</code> are used: <a href=\"https://ruby-doc.org/core-2.5.0/IO.html#method-i-close\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.5.0/IO.html#method-i-close</a>\nI hope you find that helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1534368292, "creation_date": 1534368292, "answer_id": 51866655, "question_id": 51864410, "link": "https://stackoverflow.com/questions/51864410/what-is-ios-in-the-ruby-documentation-for-puts/51866655#51866655", "title": "What is &quot;ios&quot; in the Ruby documentation for puts?", "body": "<p>It is whatever you're calling <code>puts</code> on:</p>\n\n<pre><code>$stderr.puts(\"Hello from Standard Error\") # $stderr is IO\nputs(\"Hello from Kernel\") # main is IO\nFile.new(\"/tmp/foo\").puts(\"bar\") # File is IO\n</code></pre>\n\n<p>Anything that inherits from <code>IO</code> (or <code>Kernel</code>) will respond to <code>puts</code>.</p>\n\n<pre><code>$stderr.class.ancestors # =&gt; [IO, File::Constants, Enumerable, Object, Kernel, BasicObject]\nself.class.ancestors # =&gt; [Object, Kernel, BasicObject]\nFile.ancestors # =&gt; [File, IO, File::Constants, Enumerable, Object, Kernel, BasicObject]\n</code></pre>\n"}], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 51866084, "answer_count": 2, "score": 0, "last_activity_date": 1534368292, "creation_date": 1534357695, "question_id": 51864410, "link": "https://stackoverflow.com/questions/51864410/what-is-ios-in-the-ruby-documentation-for-puts", "title": "What is &quot;ios&quot; in the Ruby documentation for puts?", "body": "<p>iOS has cluttered up getting good search results for this question. <a href=\"https://ruby-doc.org/core-2.5.0/IO.html#method-i-puts\" rel=\"nofollow noreferrer\">The Ruby docs for <code>puts</code></a> say that it </p>\n\n<blockquote>\n  <p>writes the given object(s) to ios.</p>\n</blockquote>\n\n<p>What is \"ios\". My best guess is that it is \"input/output stream\" but not sure if that makes sense or not.</p>\n"}, {"tags": ["ruby", "console-application"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1534357267, "post_id": 51864261, "comment_id": 90680725, "body": "As it stands this question is far too broad. You read input, you write output. There are many ways you could persist data, but if it&#39;s relational, use a relational DB. If it&#39;s not, it may not matter what you use."}, {"owner": {"reputation": 133, "user_id": 9982796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lo4jkk2s8G0/AAAAAAAAAAI/AAAAAAAAAKU/14RMsiaiHxM/photo.jpg?sz=128", "display_name": "Abhi Ravi", "link": "https://stackoverflow.com/users/9982796/abhi-ravi"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1534513293, "post_id": 51864261, "comment_id": 90744209, "body": "would you please provide any source for me to refer"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1534518502, "post_id": 51864261, "comment_id": 90747483, "body": "Any code that writes to a database using any of the database gems that are available? Or just write to files, or JSON, or... There&#39;s just no way to answer this question in a general way: there are countless options. I&#39;d consider searching the web for available options, picking one, and trying it out."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 9982796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lo4jkk2s8G0/AAAAAAAAAAI/AAAAAAAAAKU/14RMsiaiHxM/photo.jpg?sz=128", "display_name": "Abhi Ravi", "link": "https://stackoverflow.com/users/9982796/abhi-ravi"}, "edited": false, "score": 0, "creation_date": 1534512403, "post_id": 51869021, "comment_id": 90743637, "body": "But I need know how to access and store data."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 133, "user_id": 9982796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lo4jkk2s8G0/AAAAAAAAAAI/AAAAAAAAAKU/14RMsiaiHxM/photo.jpg?sz=128", "display_name": "Abhi Ravi", "link": "https://stackoverflow.com/users/9982796/abhi-ravi"}, "edited": false, "score": 0, "creation_date": 1534532119, "post_id": 51869021, "comment_id": 90753918, "body": "That&#39;s entirely up to you. What data? What access? Every situation is different."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": -1, "last_activity_date": 1534388387, "creation_date": 1534388387, "answer_id": 51869021, "question_id": 51864261, "link": "https://stackoverflow.com/questions/51864261/how-do-i-implement-a-ruby-only-command-line-application/51869021#51869021", "title": "How do I implement a Ruby only command line application?", "body": "<p>Here's a Ruby command-line script:</p>\n\n<pre><code>puts \"Hello world\"\n</code></pre>\n\n<p>This is because Ruby is command-line by default, and only \"web\" when running as part of a web framework.</p>\n\n<p>Now what you probably mean is \"how can I make a useful command-line tool\"? I'd suggest by sticking to command-line conventions and making use of built-in utilities like <a href=\"https://docs.ruby-lang.org/en/2.5.0/OptionParser.html\" rel=\"nofollow noreferrer\">OptionParser</a> so you can have robust command-line arguments. As per the documentation:</p>\n\n<pre><code>require 'optparse'\n\noptions = { }\n\nOptionParser.new do |opts|\n  opts.banner = \"Usage: example.rb [options]\"\n\n  opts.on(\"-v\", \"--[no-]verbose\", \"Run verbosely\") do |v|\n    options[:verbose] = v\n  end\nend.parse!\n</code></pre>\n\n<p>Then you can run your script like:</p>\n\n<pre><code>example -v\n</code></pre>\n\n<p>Which turns on the \"verbose\" flag. Look at how other commands work for examples and conventions, including those offered by <code>ruby</code> itself:</p>\n\n<pre><code>ruby -h\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 9982796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lo4jkk2s8G0/AAAAAAAAAAI/AAAAAAAAAKU/14RMsiaiHxM/photo.jpg?sz=128", "display_name": "Abhi Ravi", "link": "https://stackoverflow.com/users/9982796/abhi-ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552329268, "creation_date": 1534357068, "last_edit_date": 1552329268, "question_id": 51864261, "link": "https://stackoverflow.com/questions/51864261/how-do-i-implement-a-ruby-only-command-line-application", "title": "How do I implement a Ruby only command line application?", "body": "<p>How to implement a ruby application which is completely operated via console (terminal) ? This application may be a calculator . This should also store the results and display it whenever needed.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 1, "creation_date": 1534356956, "post_id": 51864203, "comment_id": 90680607, "body": "use <code>public_send</code>"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1534357309, "last_edit_date": 1534357309, "creation_date": 1534356797, "answer_id": 51864203, "question_id": 51864182, "link": "https://stackoverflow.com/questions/51864182/instance-variable-string-is-not-recognized-inside-ruby-method/51864203#51864203", "title": "@instance_variable.&quot;string&quot; is not recognized inside Ruby method", "body": "<p>Try:</p>\n\n<pre><code>@user.public_send(invit_number) == nil\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534392821, "post_id": 51864424, "comment_id": 90690530, "body": "How is this different from the answer posted by @jvillian?"}, {"owner": {"reputation": 11, "user_id": 5415191, "user_type": "registered", "profile_image": "https://graph.facebook.com/976565312399901/picture?type=large", "display_name": "VinyLimaZ", "link": "https://stackoverflow.com/users/5415191/vinylimaz"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534433816, "post_id": 51864424, "comment_id": 90712904, "body": "Copy both answers, put these in variables and compare yourself :D Ruby will answer you"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534480110, "post_id": 51864424, "comment_id": 90727818, "body": "Ok. It&#39;s the same."}, {"owner": {"reputation": 11, "user_id": 5415191, "user_type": "registered", "profile_image": "https://graph.facebook.com/976565312399901/picture?type=large", "display_name": "VinyLimaZ", "link": "https://stackoverflow.com/users/5415191/vinylimaz"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534516248, "post_id": 51864424, "comment_id": 90746074, "body": "Congratulations!"}], "tags": [], "owner": {"reputation": 11, "user_id": 5415191, "user_type": "registered", "profile_image": "https://graph.facebook.com/976565312399901/picture?type=large", "display_name": "VinyLimaZ", "link": "https://stackoverflow.com/users/5415191/vinylimaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1534357735, "creation_date": 1534357735, "answer_id": 51864424, "question_id": 51864182, "link": "https://stackoverflow.com/questions/51864182/instance-variable-string-is-not-recognized-inside-ruby-method/51864424#51864424", "title": "@instance_variable.&quot;string&quot; is not recognized inside Ruby method", "body": "<p>I don't know if I understood what you want to do, but if you need to call a public method on an object with a custom string you need to use <code>:public_send</code> method.</p>\n\n<p><code>@user.public_send(invit_number)</code>\nOr you can call only <code>:send</code>, this is valid for ANY method (public/protected/private).</p>\n\n<p>This will call the method that has the same name as the string content.</p>\n"}], "owner": {"reputation": 315, "user_id": 9624015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2i18bBQgvaM/AAAAAAAAAAI/AAAAAAAATsU/X1FI8dTWdi0/photo.jpg?sz=128", "display_name": "Bonapara", "link": "https://stackoverflow.com/users/9624015/bonapara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1534390232, "creation_date": 1534356712, "last_edit_date": 1534390232, "question_id": 51864182, "link": "https://stackoverflow.com/questions/51864182/instance-variable-string-is-not-recognized-inside-ruby-method", "title": "@instance_variable.&quot;string&quot; is not recognized inside Ruby method", "body": "<p>I have these two methods:</p>\n\n<pre><code>def index\n  invite_maker(\"invit_one\")\nend\n\ndef invite_maker(invit_number)\n  @user = current_user\n  if @user.invit_number == nil\n    [...]\n  end\nend\n</code></pre>\n\n<p>My problem is that Ruby doesn't recognize <code>@user.\"invit_one\"</code> as it should be <code>@user.invit_one</code>. If I put <code>invite_maker(invit_one)</code>, I get an error. How can I fix this?</p>\n"}, {"tags": ["ruby", "ssl"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10221330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6efac243a0ad47afa8998f7a3f625dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Miles", "link": "https://stackoverflow.com/users/10221330/justin-miles"}, "is_accepted": false, "score": 0, "last_activity_date": 1534368046, "creation_date": 1534368046, "answer_id": 51866603, "question_id": 51864020, "link": "https://stackoverflow.com/questions/51864020/unable-to-install-bundler-gems-after-upgrading-jruby-and-rubymine-version-ssler/51866603#51866603", "title": "Unable to install bundler/gems after upgrading jruby and rubymine version (SSLError)", "body": "<p>So somehow I fixed it.. I'm not able to reproduce the fix but that might be related to some foundation problems the fix caused.</p>\n\n<p>Basic steps I used (any of these might help):</p>\n\n<p>Removed versions from gemfile</p>\n\n<p>Trying to install bundler from outside proxy</p>\n\n<p>Install bundler through command prompt and install gems through RubyMine</p>\n\n<p>Change gemfile source to 'http' instead of 'https'</p>\n\n<p>Will update more if I find how to reproduce fix</p>\n"}], "owner": {"reputation": 1, "user_id": 10221330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6efac243a0ad47afa8998f7a3f625dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Miles", "link": "https://stackoverflow.com/users/10221330/justin-miles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534368046, "creation_date": 1534355955, "last_edit_date": 1534356559, "question_id": 51864020, "link": "https://stackoverflow.com/questions/51864020/unable-to-install-bundler-gems-after-upgrading-jruby-and-rubymine-version-ssler", "title": "Unable to install bundler/gems after upgrading jruby and rubymine version (SSLError)", "body": "<p>So recently I was encountering some SSL cert issues so in order to help fix that, I've upgraded our jruby 1.7.4 to jruby 9.1.15 and our RubyMine to 2018.2.1 (team using Ruby Cucumber).</p>\n\n<p>However, now we're facing an issue installing /updating gems and bundler after the upgrade.</p>\n\n<p>We're trying to install from the command prompt:</p>\n\n<pre><code>$ set HTTP_PROXY=https://username:password@proxyurl.net:port\n\n$ gem install bundler\n</code></pre>\n\n<p>And receiving the error:</p>\n\n<blockquote>\n  <p>ERROR: While executing gem ... (OpenSSL::SSL::SSLError)</p>\n  \n  <p>Received fatal alert: protocol_version</p>\n</blockquote>\n\n<p>Before setting the proxy the error was:</p>\n\n<blockquote>\n  <p>WARNING: Unable to pull data from '<a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a>':\n  SocketError: Failed to open TCP connection to rubygems.org:443\n  (initialize: name or service not known)\n  (<a href=\"https://rubygems.org/specs.4.8.gz\" rel=\"nofollow noreferrer\">https://rubygems.org/specs.4.8.gz</a>)</p>\n</blockquote>\n\n<p>1 gem installed</p>\n\n<p>I've even tried going to a Starbucks to avoid the proxy altogether but am still getting a similar error.</p>\n\n<p>Just to add in trying to install bundler in RubyMine itself doesn't work.</p>\n"}, {"tags": ["ruby", "class", "controller", "ruby-on-rails-5", "helpers"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1534354684, "post_id": 51863407, "comment_id": 90679494, "body": "Helper methods are intended to be called from <i>views</i>, not controllers. If you want this to be a controller method that&#39;s also a helper method, use the <code>helper_method</code> declaration in your controller."}, {"owner": {"reputation": 507, "user_id": 2553326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084b66135f445657401f36c9bf75bb95?s=128&d=identicon&r=PG", "display_name": "JUlinder", "link": "https://stackoverflow.com/users/2553326/julinder"}, "edited": false, "score": 0, "creation_date": 1534355235, "post_id": 51863407, "comment_id": 90679746, "body": "I would change the approach to be something that&#39;s run from a controller since a session is something that follows a CRUDE concept - A session is something you may want to create, delete (or update).  See example <a href=\"https://www.railstutorial.org/book/basic_login\" rel=\"nofollow noreferrer\">railstutorial.org/book/basic_login</a>"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534393056, "post_id": 51863407, "comment_id": 90690581, "body": "May be move method <code>generate_user_session</code> to <code>ApplicationController</code>."}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 9761922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3kTy.jpg?s=128&g=1", "display_name": "Maycon Seidel", "link": "https://stackoverflow.com/users/9761922/maycon-seidel"}, "is_accepted": true, "score": 1, "last_activity_date": 1534361551, "creation_date": 1534361551, "answer_id": 51865227, "question_id": 51863407, "link": "https://stackoverflow.com/questions/51863407/call-a-method-that-is-in-my-helper-on-rails-5/51865227#51865227", "title": "Call a method that is in my helper on rails 5", "body": "<p>You are trying to access a variable (<code>user</code>) that's only available on your controller. You may try to set and use @user as <code>instance_variable</code>.</p>\n\n<p>But as tadman write, you shouldn't use helper to controller propose.</p>\n\n<p>If it is for session proposes you could use a <code>concern</code> or create a new Class to deal with this.</p>\n"}], "owner": {"reputation": 93, "user_id": 10028467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eITkp.jpg?s=128&g=1", "display_name": "Daniel Disblu", "link": "https://stackoverflow.com/users/10028467/daniel-disblu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 51865227, "answer_count": 1, "score": -1, "last_activity_date": 1534361551, "creation_date": 1534353384, "question_id": 51863407, "link": "https://stackoverflow.com/questions/51863407/call-a-method-that-is-in-my-helper-on-rails-5", "title": "Call a method that is in my helper on rails 5", "body": "<p>I have this helper for a session in rails 5 and it's calling to the user table and then session table, that's because I have it related in my database, the code is the following one:</p>\n\n<pre><code>module SessionsHelper\n  def generate_user_session\n    session_build = user.sessions.build\n    session_build.generate_access_token\n    session_build.save!\n  end\nend\n</code></pre>\n\n<p>The problem is when I called the method in a controller it appears this error:</p>\n\n<blockquote>\n  <p><code>undefined local variable or method 'user'</code></p>\n</blockquote>\n\n<p>I know this error is due to I'm not referring well to my helper in my controller, the question is...</p>\n\n<p><strong>How is the correct form I can call a method from a helper in my controller?</strong></p>\n\n<hr>\n\n<p><strong><em>Note:</em></strong> Consider that in my helper I'm calling to my table user that is also calling the table sessions.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1534353568, "post_id": 51863393, "comment_id": 90679030, "body": "Hey, thanks for this but it&#39;s raising an errorr: <code>syntax error, unexpected keyword_nil, expecting &#39;)&#39; @cat_zero = BlogCategory.where(:parent_id nil) ^</code>"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1534354120, "post_id": 51863393, "comment_id": 90679266, "body": "Wow, such a silly mistake when trying out different combinations, I didn&#39;t realise it was still like that! Thank you for pointing this out."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1534353343, "creation_date": 1534353343, "answer_id": 51863393, "question_id": 51863358, "link": "https://stackoverflow.com/questions/51863358/how-to-use-where-null-in-ruby-on-rails/51863393#51863393", "title": "How to use .where NULL in Ruby on Rails", "body": "<p>The spelling you're looking for is:</p>\n\n<pre><code>@cat_zero = BlogCategory.where(parent_id: nil)\n</code></pre>\n\n<p>It's just the same as the spelling for other values, only using <code>nil</code>.</p>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 51863393, "answer_count": 1, "score": 0, "last_activity_date": 1534353343, "creation_date": 1534353207, "question_id": 51863358, "link": "https://stackoverflow.com/questions/51863358/how-to-use-where-null-in-ruby-on-rails", "title": "How to use .where NULL in Ruby on Rails", "body": "<p>I have items in a table that have <code>:parent_id</code> that are empty to signify it being a main category. I was wondering how to iterate over these using <code>.where</code> (if that's even the right method to call).</p>\n\n<p>Here's my controller:</p>\n\n<pre><code>def new\n  @title = 'New Post';\n  @post = Post.new\n  @categories = BlogCategory.all\n  @cat_zero = BlogCategory.where(:parent_id NULL)\n  @cat_one = BlogCategory.where(parent_id: 1)\n  @cat_two = BlogCategory.where(parent_id: 2)\n  @cat_three = BlogCategory.where(parent_id: 3)\n  @cat_four = BlogCategory.where(parent_id: 4)\nend\n</code></pre>\n\n<p>The rest works fine, it's just that NULL isn't working. (The relationship between BlogCategory and Post have been made.)</p>\n\n<p>I have tried doing these, but with no fortune (and a few other versions of these):</p>\n\n<pre><code>@cat_zero = BlogCategory.where(:parent_id == NULL)\n@cat_zero = BlogCategory.where(:parent_id.nil?)\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1534352902, "post_id": 51863267, "comment_id": 90678729, "body": "Where the <code>things_add</code> method is called, add something like <code>puts method(:things_add).source_location</code>. Then, in your console, you should see where the method is defined."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10230378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86d9bb65e7cb356b05fdf8f3f7fbff8?s=128&d=identicon&r=PG&f=1", "display_name": "graial", "link": "https://stackoverflow.com/users/10230378/graial"}, "edited": false, "score": 0, "creation_date": 1534380317, "post_id": 51863369, "comment_id": 90688262, "body": "Thank you! both of these methods worked! it was being defined in thingsholder.rb  :)"}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1534353250, "creation_date": 1534353250, "answer_id": 51863369, "question_id": 51863267, "link": "https://stackoverflow.com/questions/51863267/things-add-method-in-seeds-rb/51863369#51863369", "title": "things_add method in seeds.rb?", "body": "<p><code>*_add</code> is not a standard Rails / Active Record method, so it's either defined somewhere in your application, or it's provided by some other gem.</p>\n\n<p>As @jvillian's commented, you may be able to <code>things_holder.method(:oldthings_add).source_location</code> to learn where the method is defined.</p>\n\n<p>If that doesn't work, you could try passing a blatantly invalid value to the method (e.g. <code>things_holder.oldthings_add(true)</code>), and see where the backtrace points.</p>\n"}], "owner": {"reputation": 59, "user_id": 10230378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86d9bb65e7cb356b05fdf8f3f7fbff8?s=128&d=identicon&r=PG&f=1", "display_name": "graial", "link": "https://stackoverflow.com/users/10230378/graial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 51863369, "answer_count": 1, "score": 1, "last_activity_date": 1534380277, "creation_date": 1534352785, "last_edit_date": 1534353020, "question_id": 51863267, "link": "https://stackoverflow.com/questions/51863267/things-add-method-in-seeds-rb", "title": "things_add method in seeds.rb?", "body": "<p>I'm working some legacy code right now in <code>seeds.rb</code>.  The previous developer used a method like this to add rows to the tables:</p>\n\n<pre><code>things_holder.oldthings_add(name)\n</code></pre>\n\n<p>where:</p>\n\n<h3>oldthings.rb</h3>\n\n<pre><code>belongs_to :things_holder\n</code></pre>\n\n<h3>things_holder.rb</h3>\n\n<pre><code>has_many :oldthings\n</code></pre>\n\n<p>I can manipulate the object they created and adjust the seeds of the models they'd created. However, when I try to do the same to a model that I created myself (newthings), I can't seem to make it work.</p>\n\n<p>Instead I get:</p>\n\n<blockquote>\n  <p>undefined method: newthings_add</p>\n</blockquote>\n\n<p>where does this <code>things_add</code> method come from? I don't see it in any of the <code>oldthings.rb</code> files</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1534346885, "post_id": 51861743, "comment_id": 90675680, "body": "Do you mean it is working or not working?"}, {"owner": {"reputation": 91, "user_id": 10020934, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjMU2UsB0aE/AAAAAAAAAAI/AAAAAAAAA9w/5-GDvq1_ecQ/photo.jpg?sz=128", "display_name": "paul blackmore", "link": "https://stackoverflow.com/users/10020934/paul-blackmore"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1534348480, "post_id": 51861743, "comment_id": 90676579, "body": "It does work but from what I know of Ruby on Rails (which is not a lot) it&#39;s not the correct syntax. I would like to know the correct way of achieving this to improve on what I have and get it right in the future."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534393288, "post_id": 51861743, "comment_id": 90690636, "body": "No, it doesn&#39;t work. There is no <code>.chair-img</code> element in the code you provided."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 10020934, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjMU2UsB0aE/AAAAAAAAAAI/AAAAAAAAA9w/5-GDvq1_ecQ/photo.jpg?sz=128", "display_name": "paul blackmore", "link": "https://stackoverflow.com/users/10020934/paul-blackmore"}, "edited": false, "score": 0, "creation_date": 1534359912, "post_id": 51864119, "comment_id": 90681959, "body": "Thanks for your solution but this will show the image_tag. What I need is for the image to show only when the link_to has mouseenter and change back when mouseleave."}, {"owner": {"reputation": 91, "user_id": 10020934, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjMU2UsB0aE/AAAAAAAAAAI/AAAAAAAAA9w/5-GDvq1_ecQ/photo.jpg?sz=128", "display_name": "paul blackmore", "link": "https://stackoverflow.com/users/10020934/paul-blackmore"}, "edited": false, "score": 0, "creation_date": 1534402049, "post_id": 51864119, "comment_id": 90693522, "body": "I found a jsfiddle of the effect I am trying to replicate with Ruby on Rails. <a href=\"http://jsfiddle.net/J8FJq/105/\" rel=\"nofollow noreferrer\">jsfiddle.net/J8FJq/105</a>. I hope this helps to explain what I am trying to do better."}], "tags": [], "owner": {"reputation": 530, "user_id": 4714655, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/wbq5r.png?s=128&g=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/4714655/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1534356410, "creation_date": 1534356410, "answer_id": 51864119, "question_id": 51861743, "link": "https://stackoverflow.com/questions/51861743/ruby-on-rails-link-to-tag-with-mouseenter-jquery-function/51864119#51864119", "title": "Ruby on Rails link_to tag with mouseenter jQuery function", "body": "<pre><code>&lt;%= link_to '#', class: 'nav-link roll' do %&gt;\n   &lt;%= image_tag(\"chair1.jpg\")\n   Chesterfield Chair Set\n&lt;% end %&gt;\n</code></pre>\n\n<p>I'm not sure this work perfectly but the idea is wrap image an text inside block of <code>link_to</code> helper</p>\n"}], "owner": {"reputation": 91, "user_id": 10020934, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjMU2UsB0aE/AAAAAAAAAAI/AAAAAAAAA9w/5-GDvq1_ecQ/photo.jpg?sz=128", "display_name": "paul blackmore", "link": "https://stackoverflow.com/users/10020934/paul-blackmore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534356410, "creation_date": 1534346825, "last_edit_date": 1534348211, "question_id": 51861743, "link": "https://stackoverflow.com/questions/51861743/ruby-on-rails-link-to-tag-with-mouseenter-jquery-function", "title": "Ruby on Rails link_to tag with mouseenter jQuery function", "body": "<p>I want to have an image appear in a <code>div</code> when <code>mouseenter</code> using <code>link_to</code> in rails. The below code works but I'm not clear on how it's running. </p>\n\n<pre><code>&lt;a href=\"#\" class=\"nav-link roll\"&gt; &lt;%= image_tag(\"chair1.jpg\") %&gt;Chesterfield Chair Set&lt;/a&gt;\n</code></pre>\n\n<p>My jQuery is:</p>\n\n<pre><code>$(\".roll\").hover(function(){\n  $('.chair-img').css({'background':'url('+ $(this).attr('src')\n   });\n});\n</code></pre>\n\n<p>Looking for the correct way to do this. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "upload", "base64", "shrine"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5331998, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1968c3e0f376854e9dbfe92f68d88232?s=128&d=identicon&r=PG", "display_name": "Vinicius Fontoura", "link": "https://stackoverflow.com/users/5331998/vinicius-fontoura"}, "edited": false, "score": 0, "creation_date": 1534423286, "post_id": 51867520, "comment_id": 90705858, "body": "Thanks, works perfectly. There&#39;s a way to change de id too (the actual file name)?"}, {"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "reply_to_user": {"reputation": 153, "user_id": 5331998, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1968c3e0f376854e9dbfe92f68d88232?s=128&d=identicon&r=PG", "display_name": "Vinicius Fontoura", "link": "https://stackoverflow.com/users/5331998/vinicius-fontoura"}, "edited": false, "score": 1, "creation_date": 1534511710, "post_id": 51867520, "comment_id": 90743176, "body": "The upload location is generated in <code>Shrine#upload_location</code>, see <a href=\"https://github.com/shrinerb/shrine#location\" rel=\"nofollow noreferrer\">github.com/shrinerb/shrine#location</a> on how to override it."}], "tags": [], "owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1534373628, "creation_date": 1534373628, "answer_id": 51867520, "question_id": 51861570, "link": "https://stackoverflow.com/questions/51861570/ruby-how-to-set-data-uri-base64-filename-with-shrine/51867520#51867520", "title": "Ruby - How to set data_uri (base64) filename with Shrine", "body": "<p>You can add the filename by updating the <code>file_data</code> column after assigning the data URI:</p>\n\n<pre><code>anex = Anex.new(file_data_uri: data_uri)\nfile = anex.file\nfile.metadata[\"filename\"] = \"test.png\"\nanex.file_data = file.to_json\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5331998, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1968c3e0f376854e9dbfe92f68d88232?s=128&d=identicon&r=PG", "display_name": "Vinicius Fontoura", "link": "https://stackoverflow.com/users/5331998/vinicius-fontoura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "accepted_answer_id": 51867520, "answer_count": 1, "score": 0, "last_activity_date": 1534373628, "creation_date": 1534346201, "question_id": 51861570, "link": "https://stackoverflow.com/questions/51861570/ruby-how-to-set-data-uri-base64-filename-with-shrine", "title": "Ruby - How to set data_uri (base64) filename with Shrine", "body": "<p>I'm trying to set the filename to a base64 file uploaded with the Shrine gem with FileSystem store.</p>\n\n<p>I tried modifying the <code>file.metadata[:filename] = 'test.png'</code>, but the filename still nil.</p>\n\n<pre><code>anex = Anex.new(file_data_uri: file) # file is a base64 string\nresource.anexes &lt;&lt; anex\nresource.save!\n</code></pre>\n\n<p>shrine.rb</p>\n\n<pre><code>require \"shrine\"\nrequire \"shrine/storage/file_system\"\n\nShrine.storages = {\n  cache: Shrine::Storage::FileSystem.new(\"public\", prefix: \"uploads/cache\"), # temporary\n  store: Shrine::Storage::FileSystem.new(\"public\", prefix: \"uploads/store\"), # permanent\n}\n\nShrine.plugin :activerecord\nShrine.plugin :cached_attachment_data # for forms\nShrine.plugin :data_uri # for base_64\nShrine.plugin :infer_extension\n# Shrine.plugin :rack_file # for non-Rails apps\n</code></pre>\n\n<p>FileUploader.rb</p>\n\n<pre><code>class FileUploader &lt; Shrine\n  # plugins and uploading logic\n\nend\n</code></pre>\n\n<p>Anex.rb</p>\n\n<pre><code>class Anex &lt; ApplicationRecord\n  belongs_to :anexable, polymorphic: true\n\n  include FileUploader::Attachment.new(:file) # adds an `file` virtual attribute\n\n  def url\n    \"#{ENV['FILE_STORAGE_URI']}#{self.file.url}\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1534346032, "post_id": 51861445, "comment_id": 90675194, "body": "It seems like that directly translates to <code>AR</code>. Can&#39;t believe I didn&#39;t try to create two joins. Thanks a lot!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1534346103, "last_edit_date": 1534346103, "creation_date": 1534345791, "answer_id": 51861445, "question_id": 51861323, "link": "https://stackoverflow.com/questions/51861323/get-count-of-all-associations-to-a-model-in-rails/51861445#51861445", "title": "Get count of all associations to a model in rails", "body": "<p>I have no single idea about AR so-called \u201chelpers\u201d, but this is perfectly doable:</p>\n\n<pre><code>query = &lt;&lt;-SQL\n  SELECT \n    (SELECT COUNT(*) FROM a LEFT JOIN b ON (a.bp_id = b.id)) +\n    (SELECT COUNT(*) FROM a LEFT JOIN b ON (a.cp_id = b.id))\nSQL\nA.connection.execute(query).to_a.first.first\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3918, "user_id": 1608226, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f75e2877a53e9cd06009cce727235e4?s=128&d=identicon&r=PG&f=1", "display_name": "Nuclearman", "link": "https://stackoverflow.com/users/1608226/nuclearman"}, "is_accepted": false, "score": 0, "last_activity_date": 1573328639, "creation_date": 1573328639, "answer_id": 58782892, "question_id": 51861323, "link": "https://stackoverflow.com/questions/51861323/get-count-of-all-associations-to-a-model-in-rails/58782892#58782892", "title": "Get count of all associations to a model in rails", "body": "<p>Dynamic solution</p>\n\n<pre><code>def self.associations_counts_hash(model, association_types)\n  associations = model.reflections.collect do |a, b| \n    b.plural_name if association_types.include?(b.macro)\n  end.compact\n\n  query = model.all.includes(associations)\n\n  associations.map do |association| \n    [\n      association, \n      query.map { |u| u.send(association).size }.sum\n    ] \n  end.to_h\nend\n\nassociations_counts_hash(User, [:belongs_to])\n</code></pre>\n\n<p>Couldn't work out a good solution to avoid a query for each association though.</p>\n"}], "owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 51861445, "answer_count": 2, "score": 0, "last_activity_date": 1573328639, "creation_date": 1534345437, "last_edit_date": 1534345819, "question_id": 51861323, "link": "https://stackoverflow.com/questions/51861323/get-count-of-all-associations-to-a-model-in-rails", "title": "Get count of all associations to a model in rails", "body": "<p>I have a model <code>A</code> as:</p>\n\n<pre><code>class A &lt; ActiveRecord::Base\n  belongs_to :bp, class_name: \"B\", foreign_key: :bp_id\n  belongs_to :cp, class_name: \"B\", foreign_key: :cp_id\nend\n</code></pre>\n\n<p>I have a query where I am trying to get the size of all the associations to model <code>B</code> from model <code>A</code>.</p>\n\n<p>I made it work by getting the count of all associations through <code>bp</code> and then <code>cp</code> and adding both up.</p>\n\n<pre><code>total_count = bp_size + cp_size\n</code></pre>\n\n<p>Is it possible to get the sum of all associations to <code>B model</code> from <code>A</code> in a single query?</p>\n\n<p>My exact queries are as follows:</p>\n\n<pre><code>bp_size = E.where(f_id: g.joins(:f)).joins(bp: :s).size\n\ncp_size = E.where(f_id: g.joins(:f)).joins(cp: :s).size\n</code></pre>\n\n<p>The above query goes through multiple levels of associations but then I join it through <code>bp</code> and <code>cp</code> to get the appropriate size. I want to avoid running that query twice</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 5, "last_activity_date": 1534342013, "last_edit_date": 1534342013, "creation_date": 1534341511, "answer_id": 51860155, "question_id": 51860007, "link": "https://stackoverflow.com/questions/51860007/rails-scope-according-to-an-attribute-of-its-child-or-having-no-childeren/51860155#51860155", "title": "Rails scope according to an attribute of it&#39;s child (or having no childeren)", "body": "<p>The problem is that <code>joins</code> is <code>INNER JOIN</code> and it filters out the <code>sophead</code> without <code>sophead_issues</code>. You need to use <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-left_joins\" rel=\"nofollow noreferrer\">left_joins</a> here:</p>\n\n<pre><code>scope :no_issue, -&gt; { left_joins(:sophead_issues).where(\"sophead_issues.active != ? OR sophead_issues.sophead_id IS NULL\", true) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1534499824, "last_edit_date": 1534499824, "creation_date": 1534341581, "answer_id": 51860180, "question_id": 51860007, "link": "https://stackoverflow.com/questions/51860007/rails-scope-according-to-an-attribute-of-its-child-or-having-no-childeren/51860180#51860180", "title": "Rails scope according to an attribute of it&#39;s child (or having no childeren)", "body": "<p>I believe the following should work, though I'm unable to test and confirm this at the moment:</p>\n\n<pre><code>scope :active, -&gt; { joins(:sophead_issues).where.not(sophead_issues: { active: true }) }\n\nscope :no_associations, -&gt; { joins(:sophead_issues).where.not(sophead_issues: { sophead_id: nil }) }\n\nscope :no_issue, -&gt; { active.no_associations }) }\n</code></pre>\n\n<p>I've broken this down into a couple of queries for my own sanity, though were I able to test, I imagine you should be able to combine them using <code>or</code> and <code>not</code>. However, I'm not certain how to implement this without testing it out a little.</p>\n\n<p>Basically, the <code>active</code> scope is self explanatory: you find the <code>sophead_issues</code> with <code>active</code> set to <code>true</code>.</p>\n\n<p>The <code>no_associations</code> your <code>sopheads</code> without an association. More on that <a href=\"https://stackoverflow.com/questions/5319400/want-to-find-records-with-no-associated-records-in-rails-3#answer-5570221\">here</a> if you're interested.</p>\n\n<p>Finally, <code>no_issue</code> combines the two methods, returning your collection.</p>\n\n<p>You could refactor this into a class method, or two class methods that chain to form the scope, depending on your preference.</p>\n\n<p>Edit: or use @IgorDrozdov's approach, that's much cleaner :) (Unless you're &lt; Rails 5, where <code>left_joins</code> was introduced.)</p>\n"}], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 51860155, "answer_count": 2, "score": 1, "last_activity_date": 1534499824, "creation_date": 1534340950, "question_id": 51860007, "link": "https://stackoverflow.com/questions/51860007/rails-scope-according-to-an-attribute-of-its-child-or-having-no-childeren", "title": "Rails scope according to an attribute of it&#39;s child (or having no childeren)", "body": "<p>I have 2 models: <code>Sophead</code> and <code>SopheadIssue</code>.</p>\n\n<p><code>SopheadIssue belongs to Sophead</code>,</p>\n\n<p><code>Sophead has many SopheadIssues</code> (optional).</p>\n\n<p>I want to create a scope on the Sophead model for Sopheads that match EITHER of the 2 conditions:</p>\n\n<ol>\n<li>The Sophead has no SopheadIssues at all</li>\n<li>The Sophead has no SopheadIssues with a SopheadIssue attribute of (active=true).</li>\n</ol>\n\n<p>At the moment I have tried the following:</p>\n\n<pre><code>scope :no_issue, -&gt; { joins(:sophead_issues).where.not(\"active = ?\", true) }\n</code></pre>\n\n<p>But this isn't working as it is missing Sopheads without any SopheadIssues.</p>\n\n<p>Any help much appreciated.<br>\nThanks very much!</p>\n"}, {"tags": ["ruby", "exec"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534338889, "post_id": 51859291, "comment_id": 90670977, "body": "<i>&quot;All 3 variables hold Strings&quot;</i> \u2013 can you be more specific? The string values seem to be relevant."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1534339015, "post_id": 51859291, "comment_id": 90671049, "body": "BTW, why do you use <code>&quot; + options[:machines] + &quot;</code> instead of <code>#{options[:machines]}</code> for the middle part?"}, {"owner": {"reputation": 263, "user_id": 8951449, "user_type": "registered", "profile_image": "https://graph.facebook.com/511247505901446/picture?type=large", "display_name": "kaiya", "link": "https://stackoverflow.com/users/8951449/kaiya"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534341500, "post_id": 51859291, "comment_id": 90672494, "body": "Because I am a ruby beginner and have c/p-ed this from another working script I wrote."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1534349486, "post_id": 51859291, "comment_id": 90677093, "body": "Remember that <code>&quot;#{x}&quot;</code> is almost always better expressed as <code>x</code> or, in rare cases, <code>x.to_s</code>. There&#39;s no reason to use string interpolation on a single string value."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1534349551, "post_id": 51859291, "comment_id": 90677135, "body": "Another thing to note is capital letters have specific meaning in Ruby and are reserved for <code>ClassName</code> and <code>CONSTANT_NAME</code> situations. Methods and variables should be <code>lower_case</code> only."}], "answers": [{"comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 263, "user_id": 8951449, "user_type": "registered", "profile_image": "https://graph.facebook.com/511247505901446/picture?type=large", "display_name": "kaiya", "link": "https://stackoverflow.com/users/8951449/kaiya"}, "edited": false, "score": 0, "creation_date": 1534341184, "post_id": 51859443, "comment_id": 90672302, "body": "Is there a missing space between <code>jobserv</code> and <code>options[:machines]</code>? Either way, if it&#39;s not working, you should be getting an at-least-somewhat-useful error message."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 263, "user_id": 8951449, "user_type": "registered", "profile_image": "https://graph.facebook.com/511247505901446/picture?type=large", "display_name": "kaiya", "link": "https://stackoverflow.com/users/8951449/kaiya"}, "edited": false, "score": 0, "creation_date": 1534346831, "post_id": 51859443, "comment_id": 90675650, "body": "I&#39;d focus on that symptom, then... change the command you&#39;re running to something that&#39;ll definitely fail (I&#39;d try both <code>&quot;zzz&quot;</code> and <code>&quot;bash -c zzz&quot;</code>, which should each fail differently), and track until you can see those errors. Until then, it&#39;s unclear whether ruby is failing to run the target command, or the target command is being started but then itself failing silently."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1534349517, "post_id": 51859443, "comment_id": 90677108, "body": "Don&#39;t forget its <b>very important</b> to properly escape any and all variable parameters that are being passed in if using string interpolation or concatenation to compose a single command. <a href=\"http://ruby-doc.org/stdlib-2.5.0/libdoc/shellwords/rdoc/Shellwords.html#method-c-shellescape\" rel=\"nofollow noreferrer\"><code>shellescape</code></a> can handle this. The second method where each argument is specified individually is safer and recommended in this case."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 3, "last_activity_date": 1534338827, "creation_date": 1534338827, "answer_id": 51859443, "question_id": 51859291, "link": "https://stackoverflow.com/questions/51859291/getting-the-ruby-exec-syntax-right/51859443#51859443", "title": "Getting the ruby exec syntax right", "body": "<p>First, check you want <a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-exec\" rel=\"nofollow noreferrer\"><code>exec</code></a>. Several other options, like <a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-system\" rel=\"nofollow noreferrer\"><code>system</code></a>, are more common choices for running a shell command. (Specifically, if <code>exec</code> is successful, the Ruby script will stop executing and be <em>replaced</em> by the command it executes; the rest of the script will never be run.)</p>\n\n<p>You seem to have an extra layer of single quotes in your exec call. You probably want something closer to this:</p>\n\n<pre><code>exec(\"#{jobserv}\" + options[:machines] + \" -c touch #{noautooffPath}\")\n</code></pre>\n\n<p>(assuming the <code>print</code> is showing the value you want)</p>\n\n<hr>\n\n<p>In general, it's safer to avoid the single-string shell form, and pass all the argument individually. That might look more like this:</p>\n\n<pre><code>exec(\"#{jobserv}#{options[:machines]}\", \"-c\", \"touch\", noautooffPath)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>exec(jobserv, options[:machines], \"-c\", \"touch\", noautooffPath)\n</code></pre>\n\n<p>(depending on whether <code>jobserv</code> and <code>options[:machines]</code> are expected to combine. And it'd look different again if any of those are expected to themselves contain a full multi-argument command invocation.)</p>\n"}], "owner": {"reputation": 263, "user_id": 8951449, "user_type": "registered", "profile_image": "https://graph.facebook.com/511247505901446/picture?type=large", "display_name": "kaiya", "link": "https://stackoverflow.com/users/8951449/kaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 51859443, "answer_count": 1, "score": 0, "last_activity_date": 1534341384, "creation_date": 1534338246, "last_edit_date": 1534341384, "question_id": 51859291, "link": "https://stackoverflow.com/questions/51859291/getting-the-ruby-exec-syntax-right", "title": "Getting the ruby exec syntax right", "body": "<p>I want to execute a variable shell command through ruby. I am a ruby beginner. I had the command working without variables, but when I tried to set variables the exec command doesn't work and the script stops running.\nAll 3 variables hold Strings.</p>\n\n<p>The print is working fine, but exec not.</p>\n\n<pre><code>print \"#{jobserv}\" + options[:machines] + \" -c touch #{noautooffPath} \\n\"\n\nexec('\"#{jobserv}\" + options[:machines] + \" -c touch #{noautooffPath}\"')   \n</code></pre>\n\n<p>What do i have to do to make the exec right or to get more hints by the system on how to correct this?</p>\n\n<p>jobserv hold a path to an executable file plus options, options[:machines] holds a parameter I give to the last option flag of jobserv.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534401771, "post_id": 51858952, "comment_id": 90693395, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33082612/creating-a-rails-route-to-an-external-url-in-rails-4\">Creating a rails route to an external URL in Rails 4</a>"}], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 996779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfbb5496684d049b07e9ad4e39299273?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Costa", "link": "https://stackoverflow.com/users/996779/jo%c3%a3o-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1546951193, "creation_date": 1546951193, "answer_id": 54092013, "question_id": 51858952, "link": "https://stackoverflow.com/questions/51858952/how-to-use-a-link-helper-if-i-want-to-create-a-link-for-an-external-url/54092013#54092013", "title": "How to use a link helper if I want to create a link for an external url?", "body": "<p>You can enable subdomain with <a href=\"https://guides.rubyonrails.org/routing.html#request-based-constraints\" rel=\"nofollow noreferrer\">constraints</a>:</p>\n\n<pre><code>constraints subdomain: 'about' do\n    get '/', action: :index, as: :about, controller: :about\n    get :contact_us, controller: :about\nend\n</code></pre>\n\n<p>and then just use a normal url helper</p>\n\n<pre><code>about_url# 'about.localhost:3000/'\n</code></pre>\n\n<p>To test in localhost you will have to add <code>config.action_dispatch.tld_length = 0</code> in <code>config/environments/development.rb</code> as described  <a href=\"https://gist.github.com/indiesquidge/b836647f851179589765\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 167, "user_id": 10034680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fac2f173884d186d88e7f7c8b951f5e?s=128&d=identicon&r=PG&f=1", "display_name": "Rattiku", "link": "https://stackoverflow.com/users/10034680/rattiku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546951193, "creation_date": 1534337046, "last_edit_date": 1534337466, "question_id": 51858952, "link": "https://stackoverflow.com/questions/51858952/how-to-use-a-link-helper-if-i-want-to-create-a-link-for-an-external-url", "title": "How to use a link helper if I want to create a link for an external url?", "body": "<p>If have <strong>about</strong>, <strong>faq</strong> and <strong>contact us</strong> pages on an external domain - a subdomain of my main website, how can I use Rails url helpers to refer to them?</p>\n\n<p>For instance, </p>\n\n<pre><code>about page =&gt; 'about.my_domain123.com'\n\ncontact us page =&gt; 'about.my_domain123.com/contact_us' \n\nfaq page =&gt; 'about.my_domain123.com/faq'\n</code></pre>\n\n<p>How to tell Rails that about_url/path, faq_url/path and contact_us_url/path should point to the pages above, on the domain \"about.my_domain123.com\" that is?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 4781518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jtiKY.jpg?s=128&g=1", "display_name": "ydaniju", "link": "https://stackoverflow.com/users/4781518/ydaniju"}, "is_accepted": false, "score": 0, "last_activity_date": 1534332183, "creation_date": 1534332183, "answer_id": 51857754, "question_id": 51857146, "link": "https://stackoverflow.com/questions/51857146/ror-optionally-filling-form-fields-based-on-external-data/51857754#51857754", "title": "RoR - optionally filling form fields based on external data", "body": "<p>The most important thing you need to check out for is the url of the remote resource and possible need to authenticate your request before having access to the resource. You might then make an ajax request to the resource. Using jQuery</p>\n\n<pre><code>$(\"remote_id\").click(function(event){\n    event.preventDefault()\n    $.ajax(\"http://externalresourceurl.com\", {\n      success: function(data) {\n         // fill each form field with corresponding item in the data object\n         $('#first_name').html($(data).first_name);\n         ...\n      },\n      error: function() {\n         $('#notification-bar').text('An error occurred');\n      }\n    }\n );\n});\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10196942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PuGzxtIH3iQ/AAAAAAAAAAI/AAAAAAAAALM/bn4l7SKsRpk/photo.jpg?sz=128", "display_name": "Marc Hoeppner", "link": "https://stackoverflow.com/users/10196942/marc-hoeppner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534332183, "creation_date": 1534329380, "last_edit_date": 1534329736, "question_id": 51857146, "link": "https://stackoverflow.com/questions/51857146/ror-optionally-filling-form-fields-based-on-external-data", "title": "RoR - optionally filling form fields based on external data", "body": "<p>I recently started with Rails, making some good progress but hit another snag now. </p>\n\n<p>I have a form that users should fill out manually. An example would be something like a human resources pages where one can enter name, address, phone number of an employee. </p>\n\n<p>What I would want to do is have another field \"remote_id\" that is optional and when filled out, will do a REST call to a remote resource to retrieve name/address/phone number and fill out the form on the fly but not immediately submit it. A time saver, if you will.</p>\n\n<p>And I have no clear idea of what that would entail in terms of form filling (the controller action for the remote call is probably not a problem), but it seems to go beyond what rails will do \"out of the box\". JQuery, AJX, something else? A pointer would be really appreciated!</p>\n\n<p>Cheers,\nMarc</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 9851945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbb5227b025f882757a6859c3b1e49a?s=128&d=identicon&r=PG&f=1", "display_name": "dsfdsf2fafad", "link": "https://stackoverflow.com/users/9851945/dsfdsf2fafad"}, "edited": false, "score": 0, "creation_date": 1534358434, "post_id": 51857086, "comment_id": 90681260, "body": "Thank you for your reply.  I want to submit the title, content, and value of the color field in one submit."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1534329092, "creation_date": 1534329092, "answer_id": 51857086, "question_id": 51857013, "link": "https://stackoverflow.com/questions/51857013/how-do-i-use-both-form-with-and-simple-form-for-in-rails/51857086#51857086", "title": "How do I use both form_with and simple_form_for in rails?", "body": "<p>You've not posted your actual code for the submit button so impossible to be certain, however form_tag uses</p>\n\n<pre><code>&lt;%= f.submit %&gt; \n</code></pre>\n\n<p>While simple_form_for uses</p>\n\n<pre><code>&lt;%= f.button :submit %&gt;\n</code></pre>\n\n<p>Try adding f.button :submit to your simple_form_for and it should work</p>\n\n<p><a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/simple_form</a></p>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 9851945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbb5227b025f882757a6859c3b1e49a?s=128&d=identicon&r=PG&f=1", "display_name": "dsfdsf2fafad", "link": "https://stackoverflow.com/users/9851945/dsfdsf2fafad"}, "edited": false, "score": 0, "creation_date": 1534358386, "post_id": 51857221, "comment_id": 90681238, "body": "Thank you for your reply. I tried to run it, but only text_area appears and gem does not run. The script code was written in home.coffee. I also want to submit the title, content, and color field values \u200b\u200bin one submit."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 163, "user_id": 9851945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbb5227b025f882757a6859c3b1e49a?s=128&d=identicon&r=PG&f=1", "display_name": "dsfdsf2fafad", "link": "https://stackoverflow.com/users/9851945/dsfdsf2fafad"}, "edited": false, "score": 0, "creation_date": 1534388541, "post_id": 51857221, "comment_id": 90689750, "body": "@yori, <code>$(&#39;.color-picker&#39;)</code> there was missing a dot. I updated my answer, please try again."}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 0, "last_activity_date": 1534388397, "last_edit_date": 1534388397, "creation_date": 1534329701, "answer_id": 51857221, "question_id": 51857013, "link": "https://stackoverflow.com/questions/51857013/how-do-i-use-both-form-with-and-simple-form-for-in-rails/51857221#51857221", "title": "How do I use both form_with and simple_form_for in rails?", "body": "<p><code>form_with</code> not support futures from <code>simple_form_for</code>. So, in case 2, <code>as</code> and <code>input_html</code> do nothing as invalid attributes. In this case, you must use a script to initialize color picker. Also, gem replace <code>input</code> to the picker, not <code>textarea</code></p>\n\n<pre><code>#field\n&lt;%= f.text_field :color, class: 'color-picker' %&gt;\n\n#coffee script\n$ -&gt; $('.color-picker').minicolors theme: 'bootstrap'\n</code></pre>\n\n<p>Also, in each case you need to add submit button <code>&lt;%= f.submit %&gt;</code> or write a script, that would send form when color selected. </p>\n"}], "owner": {"reputation": 163, "user_id": 9851945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbb5227b025f882757a6859c3b1e49a?s=128&d=identicon&r=PG&f=1", "display_name": "dsfdsf2fafad", "link": "https://stackoverflow.com/users/9851945/dsfdsf2fafad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 51857221, "answer_count": 2, "score": 2, "last_activity_date": 1534388397, "creation_date": 1534328756, "question_id": 51857013, "link": "https://stackoverflow.com/questions/51857013/how-do-i-use-both-form-with-and-simple-form-for-in-rails", "title": "How do I use both form_with and simple_form_for in rails?", "body": "<p>I am creating an rgb table using a gem called <strong>jquery-minicolors-rails</strong>. However, github only shows examples for <strong>simple_form_for</strong>. I am using <strong>form_with</strong>.</p>\n\n<p>Just insert <strong>simple_form_for</strong> in <strong>form_with</strong> and it does not respond when you press submit.</p>\n\n<p><strong>_form_html.erb (Case 1)</strong></p>\n\n<pre><code>&lt;%= simple_form_for @balloon do |f| %&gt;\n  &lt;%= f.input :color, as: :minicolors, input_html: {data: {\n      minicolors: {theme: :bootstrap, position: :right}}} \n  %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<blockquote>\n  <p>Case 1 does not respond when submit is pressed</p>\n</blockquote>\n\n<p><strong>_form_html.erb (Case 2)</strong></p>\n\n<pre><code>  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :color %&gt;\n    &lt;%= f.text_area :color, as: :minicolors, input_html: {data: {\n        minicolors: {theme: :bootstrap, position: :right}}} %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<blockquote>\n  <p>Case 2 only shows text_area without rgb table</p>\n</blockquote>\n\n<p>Thank you for reading and I look forward to lots of advice.</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1534326883, "post_id": 51856533, "comment_id": 90665296, "body": "&quot;So far, I have achieved this&quot; - it usually helps expose what exact problem you have if you post the <i>code</i> that you used to achieve it."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1534327207, "post_id": 51856533, "comment_id": 90665482, "body": "You might want to look at inject, map and with_index"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1534333081, "post_id": 51856533, "comment_id": 90668002, "body": "@Amadan Yup. I was in transit, hence could not paste the code at that point. I have updated what I have tried and it&#39;s messy."}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 2, "last_activity_date": 1534326995, "creation_date": 1534326995, "answer_id": 51856611, "question_id": 51856533, "link": "https://stackoverflow.com/questions/51856533/ruby-converting-multiple-arrays-to-generate-a-hash/51856611#51856611", "title": "Ruby - Converting Multiple arrays to generate a Hash", "body": "<p>What about just iterating with index over <code>@vehicle_numbers</code> and get other values by that index?</p>\n\n<pre><code>@vehicle_numbers.map.with_index do |vehicle_number, index|\n  [index + 1, [vehicle_number,  @vehicle_colors[index], @allocated[index]]]\nend.to_h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 5, "last_activity_date": 1534327277, "creation_date": 1534327277, "answer_id": 51856672, "question_id": 51856533, "link": "https://stackoverflow.com/questions/51856533/ruby-converting-multiple-arrays-to-generate-a-hash/51856672#51856672", "title": "Ruby - Converting Multiple arrays to generate a Hash", "body": "<p>You can do it in one line.</p>\n\n<pre><code>@vehicle_numbers.zip(@vehicle_colors, @allocated).each.with_index(1).to_h.invert\n# =&gt; {1=&gt;[\"Registration Number 1\", \"red\", true], 2=&gt;[\"Registration Number 2\", \"blue\", true], 3=&gt;[\"Registration Number 1\", \"green\", true]}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 5, "creation_date": 1534327922, "post_id": 51856726, "comment_id": 90665854, "body": "<code>with_index</code> accepts an argument: <code>with_index(1) { |a, i| [i, a] }.to_h</code>."}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 4, "last_activity_date": 1534327506, "creation_date": 1534327506, "answer_id": 51856726, "question_id": 51856533, "link": "https://stackoverflow.com/questions/51856533/ruby-converting-multiple-arrays-to-generate-a-hash/51856726#51856726", "title": "Ruby - Converting Multiple arrays to generate a Hash", "body": "<pre><code>[@vehicle_numbers, @vehicle_colors, @allocated].transpose.map.with_index { |a, i| [i + 1, a] }.to_h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1534327870, "creation_date": 1534327870, "answer_id": 51856817, "question_id": 51856533, "link": "https://stackoverflow.com/questions/51856533/ruby-converting-multiple-arrays-to-generate-a-hash/51856817#51856817", "title": "Ruby - Converting Multiple arrays to generate a Hash", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>(1..3).zip(\n  [@vehicle_numbers, @vehicle_colors, @allocated].transpose\n).to_h \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 973, "user_id": 9989384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530602201f9551563176b0b648b7d50b?s=128&d=identicon&r=PG&f=1", "display_name": "Cryptex Technologies", "link": "https://stackoverflow.com/users/9989384/cryptex-technologies"}, "is_accepted": false, "score": 0, "last_activity_date": 1534837415, "creation_date": 1534837415, "answer_id": 51943901, "question_id": 51856533, "link": "https://stackoverflow.com/questions/51856533/ruby-converting-multiple-arrays-to-generate-a-hash/51943901#51943901", "title": "Ruby - Converting Multiple arrays to generate a Hash", "body": "<p>You can try this one. It works for me.</p>\n\n<pre><code>hash = (1..3).zip([@vehicle_numbers.map(&amp;:to_s), @vehicle_colors.map(&amp;:to_s), @allocated].transpose).to_h\n</code></pre>\n"}], "owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1534837415, "creation_date": 1534326681, "last_edit_date": 1534333106, "question_id": 51856533, "link": "https://stackoverflow.com/questions/51856533/ruby-converting-multiple-arrays-to-generate-a-hash", "title": "Ruby - Converting Multiple arrays to generate a Hash", "body": "<p>I'm trying to convert 3 different arrays into a single Hash.</p>\n\n<p>Here are the 3 arrays</p>\n\n<pre><code>@vehicle_numbers = [\"Registration Number 1\", \"Registration Number 2\", \"Registration Number 1\"]\n@vehicle_colors = [\"red\", \"blue\", \"green\"]\n@allocated = [true, true, true]\n</code></pre>\n\n<p>What I'm trying to achieve is</p>\n\n<pre><code>{1=&gt; [\"Registration Number 1\", \"red\", true], 2=&gt; [\"Registration Number 2\", \"blue\", true]}\n</code></pre>\n\n<p>So far, I have achieved this</p>\n\n<pre><code>{1=&gt; [\"Registration Number 1\", \"red\"], 2=&gt;[\"Registration Number 2\", \"red\"]}\n</code></pre>\n\n<p>I'm trying to add allocated key into the existing hash, but I'm not able to figure out, what is wrong with it.</p>\n\n<pre><code>@lines.each do |line|\n      @method_name = line.split[0]\n      if @method_name == \"park\"\n        @vehicle_numbers &lt;&lt; @vehicle_number = line.split[1]\n        @vehicle_colors &lt;&lt; @vehicle_color = line.split[2]\n        @vehicle_info[\"#{@vehicle_number}\"] = @vehicle_color\n        # puts @vehicle_info[\"#{@vehicle_number}\"] = @vehicle_color\n      end\n    end\n    @slots = 1.step(@vehicle_numbers.count, 1).to_a\n    @vehicle_info = Hash[(@slots).zip @vehicle_info ]\n    @slots.each do |slot|\n      puts \"Allocated slot number: #{slot}\"\n    end\n    puts @vehicle_info\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1534340930, "post_id": 51856461, "comment_id": 90672168, "body": "If you don&#39;t mind a form wrapper the the view could also be done with <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to\" rel=\"nofollow noreferrer\"><code>#button_to</code></a> which is probably cleaner. <code>&lt;%= button_to &#39;Your button name&#39;, &#39;&#47;notification&#47;mark&#47;your_id&#39;, remote: true, method: :get %&gt;</code>"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 2, "last_activity_date": 1534326432, "creation_date": 1534326432, "answer_id": 51856461, "question_id": 51856251, "link": "https://stackoverflow.com/questions/51856251/how-to-insert-record-in-database-on-button-click-in-ruby-on-rails/51856461#51856461", "title": "How to insert record in database on button click in ruby on rails", "body": "<p>Try something like this:</p>\n\n<p><em>Also would better use REST routes instead of <code>'/notification/mark/your_id'</code>, that used in code bellow only as an example</em></p>\n\n<pre><code>#view\n&lt;%= link_to '/notification/mark/your_id', remote: true do %&gt;\n  &lt;button&gt;Your button name&lt;/button&gt;\n&lt;% end %&gt;\n\n\n#route.rb\nget '/notification/mark/:id', to: 'notification#mark'\n\n#notification controller\ndef mark\n  Notification.find(params[:id]).update(notify: true)\n  respond_to do |format|\n    format.js { render status: 200 }\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9149537, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1_vJBKmbN54/AAAAAAAAAAI/AAAAAAAAAAs/jv7VxE4hD8Q/photo.jpg?sz=128", "display_name": "dev dap", "link": "https://stackoverflow.com/users/9149537/dev-dap"}, "edited": false, "score": 0, "creation_date": 1534405168, "post_id": 51856856, "comment_id": 90695272, "body": "yes i exactly want this that you did..but the problem is i want button click not check box..simply click on the button and the value is stored true..and when again click on button its value will be false...simple example like play/pause button in media player.when click on the button it play when we click again on the button it will pause it.."}, {"owner": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "reply_to_user": {"reputation": 65, "user_id": 9149537, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1_vJBKmbN54/AAAAAAAAAAI/AAAAAAAAAAs/jv7VxE4hD8Q/photo.jpg?sz=128", "display_name": "dev dap", "link": "https://stackoverflow.com/users/9149537/dev-dap"}, "edited": false, "score": 0, "creation_date": 1534431392, "post_id": 51856856, "comment_id": 90711476, "body": "Have you checked out my project? There is no check box. Download the GitHub project i made, you have a button on it and whenever you click the button it becomes true/false. The code shown above does exactly that, WITHOUT a check box. Greetings!"}], "tags": [], "owner": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "is_accepted": false, "score": 0, "last_activity_date": 1534330529, "last_edit_date": 1534330529, "creation_date": 1534328066, "answer_id": 51856856, "question_id": 51856251, "link": "https://stackoverflow.com/questions/51856251/how-to-insert-record-in-database-on-button-click-in-ruby-on-rails/51856856#51856856", "title": "How to insert record in database on button click in ruby on rails", "body": "<p>It seems like you want to add the true/false logic to your existing :notification table? If so, </p>\n\n<p>you have to run:</p>\n\n<pre><code>rails g migration AddCheckToNotifications check:boolean\n</code></pre>\n\n<p>inside your migration file, add to the boolean a default state:</p>\n\n<pre><code> t.boolean :notify, default: false\n</code></pre>\n\n<p>now there is no 'real' way of toggling your boolean without a form. You normally would always like to create a form in order to be able to talk to your database. </p>\n\n<p>Now since i don't know what exactly you are trying to accomplish, i assume that a method that triggers your boolean is the best solution. So first, create inside your notifications controller a new method:</p>\n\n<pre><code>  def toggle_check\n    @notification = Notification.find(params[:notification_id])\n    if @notification.check == false\n      @check = @notification.update(check: true)\n    else\n      @check = @notification.update(check: false)\n    end\n    redirect_to @notification\n  end\n</code></pre>\n\n<p>Now you need to specify a special route for your method, in routes.rb create a new path like so:</p>\n\n<pre><code>resources :notifications do\n    collection do\n      get :toggle_check\n    end\n  end\n</code></pre>\n\n<p>Now the last step is to create a link that will call the path and the controller with the toggle method:</p>\n\n<pre><code> &lt;%= link_to \"Check Toggle\", :controller =&gt; :notifications, :action =&gt; :toggle_check, notification_id: @notification.id %&gt;\n</code></pre>\n\n<p>Edit: This works now just fine! You don't even need a seperate route for a false statement, the method checks automatically if your boolean is true or false. Just add a </p>\n\n<pre><code>&lt;%= @notification.check %&gt;\n</code></pre>\n\n<p>to your show.html.erb file and you'll see that true/false will be changed whenever you click the link.</p>\n\n<p>Heres a small example of it on my GitHub:</p>\n\n<p><a href=\"https://github.com/Prometheus88/ToggleCheckRails\" rel=\"nofollow noreferrer\">Click</a> </p>\n\n<p>Let me know if this helped you!</p>\n\n<p>Greetings!</p>\n"}], "owner": {"reputation": 65, "user_id": 9149537, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1_vJBKmbN54/AAAAAAAAAAI/AAAAAAAAAAs/jv7VxE4hD8Q/photo.jpg?sz=128", "display_name": "dev dap", "link": "https://stackoverflow.com/users/9149537/dev-dap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1534340481, "creation_date": 1534325571, "last_edit_date": 1534340481, "question_id": 51856251, "link": "https://stackoverflow.com/questions/51856251/how-to-insert-record-in-database-on-button-click-in-ruby-on-rails", "title": "How to insert record in database on button click in ruby on rails", "body": "<p>I want to insert a <code>true</code> value in data base on button click without using forms or form helper. I want simple method when I click on button then a <code>true</code> value will be stored in database using Ruby on Rails. How can I do this. I am not using a check box or radio button. I am using a button.</p>\n\n<p>Here is the Migration File.</p>\n\n<pre><code>class CreateNewTableNotification &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :notifications do |t|\n\n      t.boolean :notify\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "ruby-on-rails-5", "heroku-postgres"], "comments": [{"owner": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1534330959, "post_id": 51856143, "comment_id": 90667061, "body": "Are you migrating via release phase or manually running <code>heroku run rails db:migrate</code>? What&#39;s the log output when migrating? Do you have production data in your DB, or can you run <code>heroku pg:reset</code> to start from scratch?"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1534332816, "post_id": 51856143, "comment_id": 90667880, "body": "yeah, i&#39;m running heroku run rails db:migrate. There isn&#39;t too much data in the production DB so I guess I could reset it. I&#39;ll add the output to the post."}, {"owner": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1534333787, "post_id": 51856143, "comment_id": 90668344, "body": "I&#39;d go the <code>pg:reset</code> route to avoid spending too much time on this. Your DB got into an unexpected state in a previous migration, so it&#39;s hard to diagnose at this point."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534336696, "post_id": 51856143, "comment_id": 90669732, "body": "My guess is what&#39;s happened here is you&#39;ve edited historical migrations, so they no longer make sense to all run sequentially. In particular, perhaps you changed/removed a migration which <i>added</i> <code>stores.toilet_available</code>, and so now the later migration which removes it doesn&#39;t make sense."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534336770, "post_id": 51856143, "comment_id": 90669774, "body": "You could try re-running all migrations from scratch, and add/edit/delete them to make it logical again. But this shouldn&#39;t normally be necessary, since you shouldn&#39;t normally have changed historical migrations in the first place."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534336940, "post_id": 51856143, "comment_id": 90669865, "body": "(Maybe you edited the file, to change <code>stores.toilets_available :string</code> to <code>stores.toilet :boolean</code>? If it&#39;s already been merged to master / deployed to production, then don&#39;t do that. Add a new migration instead.)"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1534338051, "post_id": 51856143, "comment_id": 90670492, "body": "I didn&#39;t change any of the migration files. Would it be possible to run a migration rollback? Or would a reset be better?"}, {"owner": {"reputation": 649, "user_id": 6262799, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fdcfbe1750c5845f84869ae9f741b27b?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/6262799/prometheus"}, "edited": false, "score": 0, "creation_date": 1534339992, "post_id": 51856143, "comment_id": 90671609, "body": "Please update your post and post the RemoveToiletAvailableFromStores file. Have you removed the associations belongs_to/has_many in the model files as well? Also, make sure you commit your project to GitHub and then to heroku, otherwise heroku will not notice any changes from your local project."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1534341400, "post_id": 51856143, "comment_id": 90672432, "body": "No, I haven&#39;t removed the associations. Added the file to the post now."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1534353907, "post_id": 51856143, "comment_id": 90679172, "body": "pg:reset doesn&#39;t change anything either"}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1534358625, "post_id": 51856143, "comment_id": 90681360, "body": "Would dropping the table and then adding it again be a viable option? Or could this cause problems?"}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1535401830, "post_id": 51856143, "comment_id": 91044092, "body": "You can see what&#39;s in the database by running <code>heroku pg:psql</code> you can then see what&#39;s in the table by running <code>\\d stores</code>."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "reply_to_user": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1535539219, "post_id": 51856143, "comment_id": 91100440, "body": "@Schneems When I try <code>heroku pg:psql</code> I get the following message, basically asking me to install postgres:  <code>heroku-cli: update available from 6.14.36-15f8a25 to 6.99.0-ec9edad --&gt; Connecting to postgresql-symmetrical-68602  \u25b8    The local psql command could not be located. For help installing psql, see  \u25b8    https:&#47;&#47;devcenter.heroku.com&#47;articles&#47;heroku-postgresql#loca&zwnj;&#8203;l-setup</code>"}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1535598280, "post_id": 51856143, "comment_id": 91127525, "body": "The error is telling you that you need to install a postgres driver on your local machine. Follow the directions in the link and then run the command again."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1535636428, "post_id": 51856143, "comment_id": 91147415, "body": "When I run <code>heroku pg:info</code> it says the PG version is 10.4, however, when i go to the windows installer, 10.4 is not available to select."}, {"owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "edited": false, "score": 0, "creation_date": 1535637000, "post_id": 51856143, "comment_id": 91147833, "body": "I have another app running fine in Heroku with pg database"}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1537217273, "post_id": 51856143, "comment_id": 91695773, "body": "@catinahat you don&#39;t need that exact same version locally just a version of psql. Also can you run <code>rake db:schema_load</code> successfully on the app?"}], "owner": {"reputation": 31, "user_id": 9067058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6101491b055c936e423ac6d5a076ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "catinahat", "link": "https://stackoverflow.com/users/9067058/catinahat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534353853, "creation_date": 1534325177, "last_edit_date": 1534353853, "question_id": 51856143, "link": "https://stackoverflow.com/questions/51856143/pushing-rails-app-to-heroku-pgundefinedcolumn-error-column-of-relation-doe", "title": "Pushing Rails app to Heroku - PG::UndefinedColumn: ERROR: column of relation does not exist", "body": "<p>I'm trying to push my Rails app to Heroku but getting the following error: \"PG::UndefinedColumn: ERROR:  column \"toilet_available\" of relation \"stores\" does not exist\"</p>\n\n<p>I've then removed the \"toilet_available\" column from the stores table, but I'm still getting the error.</p>\n\n<p>My schema looks like this:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20180814220216) do\n\n  create_table \"stores\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"address\"\n    t.float \"beer_cost\"\n    t.text \"facilities\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.float \"latitude\"\n    t.float \"longitude\"\n    t.boolean \"toilet\"\n    t.string \"address_line2\"\n    t.string \"address_line3\"\n    t.integer \"user_id\"\n    t.integer \"toilet_id\"\n  end\n\n  create_table \"toilets\", force: :cascade do |t|\n    t.string \"toilet_available\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\", default: \"\", null: false\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer \"sign_in_count\", default: 0, null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string \"current_sign_in_ip\"\n    t.string \"last_sign_in_ip\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n  end\n\nend\n</code></pre>\n\n<p>Output after running heroku run rails db:migrate:</p>\n\n<pre><code>Running rails db:migrate on \u2b22 hellospaeti... up, run.5788 (Free)\n   (1.4ms)  SELECT pg_try_advisory_lock(3990924734019646395)\n   (1.8ms)  SELECT \"schema_migrations\".\"version\" FROM \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\nMigrating to RemoveToiletAvailableFromStores (20180627115344)\n   (1.1ms)  BEGIN\n== 20180627115344 RemoveToiletAvailableFromStores: migrating ==================\n-- remove_column(:stores, :toilet_available, :string)\n   (2.8ms)  ALTER TABLE \"stores\" DROP \"toilet_available\"\n   (1.2ms)  ROLLBACK\n   (1.3ms)  SELECT pg_advisory_unlock(3990924734019646395)\nrails aborted!\nStandardError: An error has occurred, this and all later migrations canceled:\n\nPG::UndefinedColumn: ERROR:  column \"toilet_available\" of relation \"stores\" does not exist\n: ALTER TABLE \"stores\" DROP \"toilet_available\"\n</code></pre>\n\n<p>migration file:</p>\n\n<pre><code>class RemoveToiletAvailableFromStores &lt; ActiveRecord::Migration[5.1]\n  def change\n    remove_column :stores, :toilet_available, :string\n  end\nend\n</code></pre>\n\n<p>Can't work out why it's not working and a bit worried I'm messing things up further after trying a couple of different migrations. Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 6, "creation_date": 1534322499, "post_id": 51855356, "comment_id": 90663285, "body": "Do you have a file app/lib/csv.rb? Which does not declare anything named <code>CSV</code>? Rename it. It confuses rails&#39; autoloader."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534323329, "post_id": 51855356, "comment_id": 90663652, "body": "^^ This. And in addition, rails conventions work much better if <i>all</i> filenames match the class/module that they contain. So if <code>app&#47;lib&#47;csv.rb</code> actualy contains something of value, rename the file to match that class/module name."}, {"owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "edited": false, "score": 0, "creation_date": 1534329391, "post_id": 51855356, "comment_id": 90666462, "body": "I am so stupid.... yeh had the <code>csv.rb</code> in my app lib folder -.-"}], "owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534328564, "creation_date": 1534321767, "question_id": 51855356, "link": "https://stackoverflow.com/questions/51855356/impossible-to-use-ruby-csv-into-app", "title": "Impossible to use ruby csv into app", "body": "<p>Trying to use the ruby included csv libary.</p>\n\n<pre><code>2.5.1 :001 &gt; CSV\nTraceback (most recent call last):\n        1: from (irb):1\nLoadError (Unable to autoload constant CSV, expected /home/xxxx/app/lib/csv.rb to define it)\n2.5.1 :002 &gt; ::CSV\nTraceback (most recent call last):\n        1: from (irb):2\nLoadError (Unable to autoload constant CSV, expected /home/XXXX/app/lib/csv.rb to define it)\n</code></pre>\n\n<p><code>require</code> just returns false.</p>\n\n<pre><code>2.5.1 :003 &gt; require 'csv'\n =&gt; false \n</code></pre>\n\n<p>How can I use the default csv libary of ruby in my rails 5 app? </p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534322288, "post_id": 51855346, "comment_id": 90663199, "body": "What&#39;s the problem here? Is the result not what you were expecting? If so, what <i>is</i> your expected result?"}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534323147, "post_id": 51855346, "comment_id": 90663552, "body": "@Stefan No, this is not what I expected. I would like to see &quot;a   b   c&quot;, with an em space in between, instead of several regular spaces."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534323428, "post_id": 51855346, "comment_id": 90663691, "body": "In irb or plain Ruby you would simply write <code>a.join(&quot;\\u2003&quot;)</code>. But since your question is related to Rails, you might want something else (e.g. a named HTML entity like <code>&amp;emsp;</code>). That&#39;s why I was asking."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1534326865, "post_id": 51855346, "comment_id": 90665286, "body": "Once rendered by a browser will this not be correct?"}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1534328203, "post_id": 51855346, "comment_id": 90665966, "body": "@Kris, @Stefan Rendered by a browser my code <code>a.join(&#39;&amp;emsp;&#39;)</code> still spits out <code>a&amp;emsp;b</code>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1534335155, "post_id": 51855346, "comment_id": 90668985, "body": "@JoannaGaudyn Because you&#39;ll have to mark it as html safe. Otherwise html characters are escaped. <code>a.join(&#39;&amp;emsp;&#39;).html_safe</code>"}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1534339524, "post_id": 51855346, "comment_id": 90671350, "body": "Thanks @JohanWentholt, since my method is in the model, that works perfect."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1534339704, "post_id": 51855346, "comment_id": 90671447, "body": "@JoannaGaudyn note that this will mark the whole string as being HTML safe, not just the separator. Don&#39;t do this if the strings in your array may contain special characters (let alone user provided data)."}], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 1, "last_activity_date": 1534324397, "creation_date": 1534324397, "answer_id": 51855965, "question_id": 51855346, "link": "https://stackoverflow.com/questions/51855346/rails-joining-an-array-with-em-space/51855965#51855965", "title": "Rails: joining an array with em space", "body": "<p>All is work as expected. But if you want to see white space instead of a code of HTML entities in your console, you must convert that into UTF-8 character. Try something like this:</p>\n\n<pre><code>CGI.unescapeHTML(%w[a b c].join('&amp;#8195;')) #=&gt; \"a b c\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "edited": false, "score": 0, "creation_date": 1534340575, "post_id": 51857470, "comment_id": 90671966, "body": "Nice tip for using in the view, however I needed something that would work in a method, in which case what @JohanWentholt suggests does the job."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "edited": false, "score": 2, "creation_date": 1534340895, "post_id": 51857470, "comment_id": 90672145, "body": "@JoannaGaudyn <i>&quot;would work in a method&quot;</i> \u2013 you mean in the model? YMMV, but since the method outputs HTML, you might consider turning it into a view helper."}, {"owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "edited": false, "score": 0, "creation_date": 1534506360, "post_id": 51857470, "comment_id": 90739998, "body": "Yes, I meant either model or controller method. Thanks for the hint, might actually consider it."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 5, "last_activity_date": 1534332685, "last_edit_date": 1534332685, "creation_date": 1534330904, "answer_id": 51857470, "question_id": 51855346, "link": "https://stackoverflow.com/questions/51855346/rails-joining-an-array-with-em-space/51857470#51857470", "title": "Rails: joining an array with em space", "body": "<blockquote>\n  <p>Rendered by a browser my code <code>a.join('&amp;emsp;')</code> still spits out <code>a&amp;emsp;b</code></p>\n</blockquote>\n\n<p>That's because Rails escapes special characters by default: <code>&amp;</code> becomes <code>&amp;amp;</code>, <code>&lt;</code> becomes <code>&amp;lt;</code> and so on. You have to explicitly mark a string containing HTML entities (or even tags) as being <a href=\"https://api.rubyonrails.org/classes/String.html#method-i-html_safe\" rel=\"nofollow noreferrer\"><code>html_safe</code></a>:</p>\n\n<pre><code>'&amp;emsp;'.html_safe\n</code></pre>\n\n<p>And since the built-in <code>join</code> would invalidate the HTML safe mark(s), Rails provides <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/OutputSafetyHelper.html#method-i-safe_join\" rel=\"nofollow noreferrer\"><code>safe_join</code></a>:</p>\n\n<pre><code>&lt;%= safe_join(['a', 'b', 'c'], '&amp;emsp;'.html_safe) %&gt;\n</code></pre>\n\n<p>Within a view, you can also use the <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/OutputSafetyHelper.html#method-i-raw\" rel=\"nofollow noreferrer\"><code>raw</code></a> helper:</p>\n\n<pre><code>&lt;%= safe_join(['a', 'b', 'c'], raw('&amp;emsp;')) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 8194624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/toohL.jpg?s=128&g=1", "display_name": "Joanna Gaudyn", "link": "https://stackoverflow.com/users/8194624/joanna-gaudyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1534332685, "creation_date": 1534321738, "last_edit_date": 1534331955, "question_id": 51855346, "link": "https://stackoverflow.com/questions/51855346/rails-joining-an-array-with-em-space", "title": "Rails: joining an array with em space", "body": "<p>Is it possible to join an array with an <a href=\"https://www.w3schools.com/charsets/tryit.asp?deci=8195&amp;ent=emsp\" rel=\"nofollow noreferrer\">em space</a> in RoR?</p>\n\n<p><strong>irb:</strong></p>\n\n<pre><code>a = [\"a\", \"b\", \"c\"]\n#=&gt; [\"a\", \"b\", \"c\"]\n\na.join('    ')\n#=&gt; \"a    b    c\"\n\na.join('&amp;#8195;')\n#=&gt; \"a&amp;#8195;b&amp;#8195;c\"\n\na.join('&amp;#x2003;')\n#=&gt; \"a&amp;#x2003;b&amp;#x2003;c\"\n\na.join('&amp;emsp;')\n#=&gt; \"a&amp;emsp;b&amp;emsp;c\"\n</code></pre>\n\n<p>But rendered by a browser, <code>a.join('&amp;emsp;')</code> still spits out <code>a&amp;emsp;b</code>.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1534329167, "post_id": 51855026, "comment_id": 90666371, "body": "It might help if you could produce a smaller code example to reproduce the problem."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534326883, "post_id": 51855261, "comment_id": 90665297, "body": "Its response false"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534331213, "post_id": 51855261, "comment_id": 90667148, "body": "@Gasem could you elaborate?"}, {"owner": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534333529, "post_id": 51855261, "comment_id": 90668211, "body": "When i use <code>@league</code> in initialize its return nothing and without any error in views , When i use  <code>&lt;%= event.league.present? %&gt;</code> its return <code>false</code>"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534334951, "post_id": 51855261, "comment_id": 90668888, "body": "@Gasem updated my answer, haven&#39;t noticed, that raw value of &quot;league&quot; is a hash, not an array"}, {"owner": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534336202, "post_id": 51855261, "comment_id": 90669465, "body": "thanks its helpful , but still not work  , when use @league  return this error  <code>undefined method &#39;each&#39; for #&lt;Bapi::League:&gt; </code>"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534336238, "post_id": 51855261, "comment_id": 90669486, "body": "@Gasem that&#39;s because you don&#39;t need each there, it&#39;s not an array, updated my answer"}, {"owner": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "edited": false, "score": 0, "creation_date": 1534336748, "post_id": 51855261, "comment_id": 90669758, "body": "its true , now how i can use events league in rails views"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 0, "last_activity_date": 1534336309, "last_edit_date": 1534336309, "creation_date": 1534321304, "answer_id": 51855261, "question_id": 51855026, "link": "https://stackoverflow.com/questions/51855026/how-to-create-an-array-of-objects-from-json-response/51855261#51855261", "title": "How to create an array of objects from json response", "body": "<p>I guess the problem is in this method:</p>\n\n<pre><code>def initialize(args = {})\n  super(args)\n  league = parse_leagues(args)\nend\n</code></pre>\n\n<p>The leagues are parsed and set to a local variable, but is expected to be set to an instance one:</p>\n\n<pre><code>def initialize(args = {})\n  super(args)\n  @league = parse_leagues(args)\nend\n</code></pre>\n\n<p>Otherwise, the default implementation from <code>Base</code> is called and <code>@league</code> is set to a raw value (to a hash)</p>\n\n<p>And also <code>parse_leagues</code> method should be fixed (and probably renamed to <code>parse_league</code>, since the raw value is not an array, but a hash):</p>\n\n<pre><code>def parse_leagues(args = {})\n  League.new(args.fetch(\"league\", {}))\nend\n</code></pre>\n\n<p>And then use it in the view as following:</p>\n\n<pre><code>&lt;% @events.each_slice(3) do |events| %&gt;\n  &lt;% events.each do |event| %&gt;\n    &lt;%= event.league.name %&gt;    \n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6570023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDDnIqOQ4RU/AAAAAAAAAAI/AAAAAAAAARI/QV6yURG0hnE/photo.jpg?sz=128", "display_name": "Qasem", "link": "https://stackoverflow.com/users/6570023/qasem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 51855261, "answer_count": 1, "score": -2, "last_activity_date": 1534336309, "creation_date": 1534320217, "last_edit_date": 1534332932, "question_id": 51855026, "link": "https://stackoverflow.com/questions/51855026/how-to-create-an-array-of-objects-from-json-response", "title": "How to create an array of objects from json response", "body": "<p>I get this error: </p>\n\n<blockquote>\n  <p>undefined method `name' for [\"id\", \"6309\"]:Array</p>\n</blockquote>\n\n<p>I want show league name for each response inplay events</p>\n\n<p>Json Response:</p>\n\n<pre><code>{\n    \"success\": 1,\n    \"pager\": {\n        \"page\": 1,\n        \"per_page\": 50,\n        \"total\": 21\n    },\n    \"results\": [\n        {\n            \"id\": \"222434\",\n            \"time\": \"1489669200\",\n            \"time_status\": \"1\",\n            \"league\": {\n                \"id\": \"4148\",\n                \"name\": \"Viareggio Cup\",\n                \"cc\": null\n            },\n            \"home\": {\n                \"id\": \"43717\",\n                \"name\": \"Fiorentina U19\",\n                \"image_id\": \"42466\",\n                \"cc\": \"it\"\n            },\n            \"away\": {\n                \"id\": \"159690\",\n                \"name\": \"Garden City Panthers FC U19\",\n                \"image_id\": \"320141\",\n                \"cc\": null\n            },\n            \"timer\": {\n                \"tm\": 86,\n                \"ts\": 4,\n                \"tt\": \"1\"\n            },\n            \"scores\": {\n                \"2\": {\n                    \"home\": \"2\",\n                    \"away\": \"0\"\n                }\n            }\n        },\n        {\n            \"id\": \"223265\",\n            \"time\": \"1489669200\",\n            \"time_status\": \"1\",\n            \"league\": {\n                \"id\": \"1501\",\n                \"name\": \"Uganda Division 2\",\n                \"cc\": \"ug\"\n            },\n            \"home\": {\n                \"id\": \"159745\",\n                \"name\": \"Simba FC\",\n                \"image_id\": null,\n                \"cc\": null\n            },\n            \"away\": {\n                \"id\": \"80323\",\n                \"name\": \"Busia Fisheries\",\n                \"image_id\": null,\n                \"cc\": null\n            },\n            \"timer\": {\n                \"tm\": 69,\n                \"ts\": 1,\n                \"tt\": \"1\"\n            },\n            \"scores\": {\n                \"2\": {\n                    \"home\": \"1\",\n                    \"away\": \"2\"\n                }\n            }\n        },\n    ]\n}\n</code></pre>\n\n<hr>\n\n<pre><code>module Bapi\n  class Inplay &lt; Base\n    attr_accessor :id,\n                  :time,\n                  :time_status,\n                  :league\n\n    CACHE_DEFAULTS = { expires_in: 7.days, force: false }\n\n    def self.all(query = {})\n      response = Request.where(\"/v2/events/inplay\",query, CACHE_DEFAULTS)\n      events = response.fetch('results', []).map { |inplay| Inplay.new(inplay) }\n      [ events, response[:errors] ]\n    end\n\n    def initialize(args = {})\n      super(args)\n      league = parse_leagues(args)\n    end\n\n\n     private\n\n    def parse_leagues(args = {})\n      args.fetch(\"league\", []).map { |league| League.new(league) }\n    end\n  end\nend\n</code></pre>\n\n<hr>\n\n<pre><code> module Bap\n     class Base\n        attr_accessor :errors\n\n        def initialize(args = {})\n          args.each do |name, value|\n            attr_name = name.to_s\n            send(\"#{attr_name}=\", value) if respond_to?(\"#{attr_name}=\")\n          end\n        end\n      end\n    end\n</code></pre>\n\n<hr>\n\n<p>League model</p>\n\n<pre><code>module Bapi\n  class League &lt; Base\n    attr_accessor :id,\n                  :name,\n                  :cc\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>Controller :</p>\n\n<pre><code>@events, @errors = Bapi::Inplay.all\n</code></pre>\n\n<hr>\n\n<p>views :</p>\n\n<pre><code>&lt;% @events.each_slice(3) do |events| %&gt;\n    &lt;% events.each do |event| %&gt;\n     &lt;% event.league.each do |leg| %&gt;\n            &lt;%= leg.name %&gt;      \n     &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>[#&lt;Bap::Inplay:0x00007feceede0570 @id=\"873482\", @time=\"1534143600\", @time_status=\"1\", @league={\"id\"=&gt;\"6309\", \"name\"=&gt;\"China Super League Reserves\", \"cc\"=&gt;\"cn\"}&gt;, #&lt;Bap::Inplay:0x00007feceedeb6f0 @id=\"875996\", @time=\"1534147192\", @time_status=\"1\", @league={\"id\"=&gt;\"3653\", \"name\"=&gt;\"Indonesia Cup\", \"cc\"=&gt;\"id\"}&gt;]\n</code></pre>\n\n<p>When i changed code like this it's work fine </p>\n\n<hr>\n\n<pre><code>   &lt;% @events.each_slice(3) do |events| %&gt;\n        &lt;% events.each do |event| %&gt;\n         &lt;%= event.time %&gt;\n         &lt;%= event.time_status %&gt;         \n        &lt;% end %&gt;\n      &lt;% end %&gt;\n     &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>Edited : \nI found this <br> \nNow how i can define a variable to convert arguments to (key value), when i use key its return value</p>\n\n<pre><code>    &lt;% @events.each_slice(3) do |events| %&gt;\n        &lt;% events.each do |event| %&gt;\n     &lt;% event.league.each do |k,v| %&gt;\n            &lt;%= k %&gt; &lt;br&gt;\n            &lt;%= v %&gt;         \n       &lt;% end %&gt;      \n    &lt;% end %&gt;\n  &lt;% end %&gt;\n &lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "sorting"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1534319366, "post_id": 51854759, "comment_id": 90661967, "body": "The <code>desc</code> part may not be as simple as you think. Just for that functionality, the code could be pretty much complicated."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1534319420, "post_id": 51854759, "comment_id": 90661991, "body": "It is a better idea to give the <code>field</code> values in your <code>sort_settings</code> as symbols rather than strings given that the keys in your original hashes are symbols."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1534327308, "post_id": 51854759, "comment_id": 90665529, "body": "For order you could always sort in one direction and then use <code>#reverse</code> to get the opposite. Update: actually that will only help when sorting by multiple fields with different orders."}], "answers": [{"tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1534319541, "creation_date": 1534319541, "answer_id": 51854864, "question_id": 51854759, "link": "https://stackoverflow.com/questions/51854759/dynamically-sorting-an-array-of-hashes-in-ruby/51854864#51854864", "title": "Dynamically sorting an array of hashes in Ruby", "body": "<p>You're going to need a method that transforms a given item into a sort key, using the configuration as a guide:</p>\n\n<pre><code>def build_sort_key_for(item, configuration)\n  configuration.map { |entry|\n    value = item[entry[:field].to_sym]\n    value = -value if entry[:order] == \"desc\" # this will only work on numeric values\n    value\n  }\nend\n</code></pre>\n\n<p>Then you just call that in your sort_by:</p>\n\n<pre><code>persons.sort_by!{ |p| build_sort_key_for(p, configuration) }\n</code></pre>\n\n<p>Making <code>\"desc\"</code> work for strings is a challenge unto itself, and so left to the reader (or a separate question).</p>\n"}, {"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 3, "last_activity_date": 1534320765, "creation_date": 1534320765, "answer_id": 51855128, "question_id": 51854759, "link": "https://stackoverflow.com/questions/51854759/dynamically-sorting-an-array-of-hashes-in-ruby/51855128#51855128", "title": "Dynamically sorting an array of hashes in Ruby", "body": "<p>It's quite challenging to sort strings in desc order using <code>sort_by</code>, it'd be better to use \"lower-level\" <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-sort\" rel=\"nofollow noreferrer\">sort</a> method, which sorts by specified comparator using <code>&lt;=&gt;</code> operator. A quick solution for this looks something like:</p>\n\n<pre><code>persons.sort do |a, b|\n  comparator = 0\n\n  sort_settings.each do |s|\n    a_field = a[s[:field].to_sym]\n    b_field = b[s[:field].to_sym]\n\n    comparator = a_field &lt;=&gt; b_field\n\n    comparator = -comparator if s[:order] == \"desc\"\n\n    break unless comparator == 0\n  end\n\n  comparator\nend\n</code></pre>\n\n<p>The block must implement a comparison between a and b, and return -1, when a follows b, 0 when a and b are equivalent, or +1 if b follows a.</p>\n\n<p>Thus, we iterate over <code>sort_settings</code> and compare specified fields using <code>&lt;=&gt;</code>, which returns <code>1</code>, <code>0</code> or <code>-1</code>. If the specified order is <code>desc</code>, we invert the value. If comparator returns something different to zero, we don't need to continue iterations.</p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1534320865, "creation_date": 1534320865, "answer_id": 51855161, "question_id": 51854759, "link": "https://stackoverflow.com/questions/51854759/dynamically-sorting-an-array-of-hashes-in-ruby/51855161#51855161", "title": "Dynamically sorting an array of hashes in Ruby", "body": "<p>Ignoring the <code>asc</code>/<code>desc</code> functionality and given that the sort keys are given as symbols and are in this format:</p>\n\n<pre><code>sort_settings = [\n  :first_name,\n  :age,\n]\n</code></pre>\n\n<p>you simply can do:</p>\n\n<pre><code>persons.sort_by{|p| p.values_at(sort_settings)}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1534362340, "post_id": 51865206, "comment_id": 90682999, "body": "Great job!! The only working correctly with <code>&quot;asc&quot;</code> and <code>&quot;desc&quot;</code>"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1534381341, "last_edit_date": 1534381341, "creation_date": 1534361487, "answer_id": 51865206, "question_id": 51854759, "link": "https://stackoverflow.com/questions/51854759/dynamically-sorting-an-array-of-hashes-in-ruby/51865206#51865206", "title": "Dynamically sorting an array of hashes in Ruby", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def sort_by_settings(persons, sort_settings)\n  sort_mult_by_field = sort_settings.each_with_object({}) do |g,h|\n    h[g[:field]] = g[:order] == \"asc\" ? 1 : -1\n  end\n\n  longest_string_by_key = persons.each_with_object(Hash.new(0)) do |g,h|\n    g.each { |k,v| h[k] = [h[k], g[k].size].max if sort_mult_by_field.key?(k) &amp;&amp;\n      v.is_a?(String) }\n  end\n\n  sort_by_arr = persons.each_with_object({}) do |g,h|    \n    h[g] = sort_mult_by_field.each_with_object([]) do |(f,m),a|\n      gv = g[f]\n      a &lt;&lt;\n      case gv\n      when Integer\n        m * gv\n      when String\n        gv.chars.map { |c| m * c.ord }.concat([m * -256]*(longest_string_by_key[f]-gv.size))\n      else # rescue...\n      end\n    end\n  end\n\n  persons.sort_by { |g| sort_by_arr[g] }\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<p><code>persons</code> is as defined in the question.</p>\n\n<pre><code>sort_settings = [{field: :first_name, order: \"asc\"}, {field: :age, order: \"desc\"}]\n\nsort_by_settings(persons, sort_settings)\n  #=&gt; [{:id=&gt;2, :first_name=&gt;\"Alexia\",  :last_name=&gt;\"Reyes\",  :age=&gt;70},\n  #    {:id=&gt;3, :first_name=&gt;\"Anthony\", :last_name=&gt;\"Nelson\", :age=&gt;25},\n  #    {:id=&gt;1, :first_name=&gt;\"Bill\",    :last_name=&gt;\"Zamora\", :age=&gt;37}]\n\npersons1 = persons + [{ id: 4, first_name: \"Alexia\", last_name: \"Whoosit\", age: 71 }]\nsort_by_settings(persons1, sort_settings)\n  #=&gt; [{:id=&gt;4, :first_name=&gt;\"Alexia\",  :last_name=&gt;\"Whoosit\", :age=&gt;71},\n  #    {:id=&gt;2, :first_name=&gt;\"Alexia\",  :last_name=&gt;\"Reyes\",   :age=&gt;70},\n  #    {:id=&gt;3, :first_name=&gt;\"Anthony\", :last_name=&gt;\"Nelson\",  :age=&gt;25},\n  #    {:id=&gt;1, :first_name=&gt;\"Bill\",    :last_name=&gt;\"Zamora\",  :age=&gt;37}]\n\nsort_settings1 = [{field: :first_name, order: \"desc\"}, {field: :age, order: \"asc\"}]\nsort_by_settings(persons1, sort_settings1)\n  #=&gt; [{:id=&gt;1, :first_name=&gt;\"Bill\",    :last_name=&gt;\"Zamora\",  :age=&gt;37},\n  #    {:id=&gt;3, :first_name=&gt;\"Anthony\", :last_name=&gt;\"Nelson\",  :age=&gt;25},\n  #    {:id=&gt;2, :first_name=&gt;\"Alexia\",  :last_name=&gt;\"Reyes\",   :age=&gt;70}, \n  #    {:id=&gt;4, :first_name=&gt;\"Alexia\",  :last_name=&gt;\"Whoosit\", :age=&gt;71}]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>In the calculations for the first example, the following intermediate values were computed.</p>\n\n<pre><code>sort_mult_by_field\n  #=&gt; {:first_name=&gt;1, :age=&gt;-1}\n\nlongest_string_by_key\n  #=&gt; {:first_name=&gt;7}\n\nsort_by_arr\n  #=&gt; {{:id=&gt;1, :first_name=&gt;\"Bill\",    :last_name=&gt;\"Zamora\", :age=&gt;37}=&gt;\n  #      [[66, 105, 108, 108, -256, -256, -256], -37],\n  #    {:id=&gt;2, :first_name=&gt;\"Alexia\",  :last_name=&gt;\"Reyes\",  :age=&gt;70}=&gt;\n  #      [[65, 108, 101, 120,  105,   97, -256], -70],\n  #    {:id=&gt;3, :first_name=&gt;\"Anthony\", :last_name=&gt;\"Nelson\", :age=&gt;25}=&gt;\n  #      [[65, 110, 116, 104,  111,  110,  121], -25]}\n</code></pre>\n"}], "owner": {"reputation": 1422, "user_id": 1818469, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f12725057bcd02de350eb20302d1482?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1818469/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 51855128, "answer_count": 4, "score": 3, "last_activity_date": 1534381341, "creation_date": 1534318982, "question_id": 51854759, "link": "https://stackoverflow.com/questions/51854759/dynamically-sorting-an-array-of-hashes-in-ruby", "title": "Dynamically sorting an array of hashes in Ruby", "body": "<p>I would like to sort an array of hashes by several dynamic criteria. Let's say I have this array</p>\n\n<pre><code>persons = [\n  {\n    id: 1,\n    first_name: \"Bill\",\n    last_name: \"Zamora\",\n    age: 37\n  },\n  {\n    id: 2,\n    first_name: \"Alexia\",\n    last_name: \"Reyes\",\n    age: 70\n  },\n  {\n    id: 3,\n    first_name: \"Anthony\",\n    last_name: \"Nelson\",\n    age: 25\n  }\n]\n</code></pre>\n\n<p>I know that you can easily sort an array by multiple criteria with the following code</p>\n\n<pre><code>persons.sort_by!{ |p| [p[:age], p[:first_name]] }\n</code></pre>\n\n<p>However, in this example the number and the order of the fields by which the array is sorted is hard-coded. In my case, this is determined dynamically at runtime. So I do not know by how many fields the array is to be sorted nor what fields are sorted in which order.</p>\n\n<p>I am looking for an elegant solution to sort my array using a configuration object that I don't know before. Such a configuration could look like this:</p>\n\n<pre><code>sort_settings = [\n  {\n    field: \"first_name\",\n    order: \"asc\"\n  },\n  {\n    field: \"age\",\n    order: \"desc\"\n  }\n]\n</code></pre>\n\n<p>I am very grateful for any help on this!</p>\n"}, {"tags": ["ruby", "chef-infra", "cookbook"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10176096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02c7bd646292adbc758ef796d7f7573?s=128&d=identicon&r=PG&f=1", "display_name": "Anish", "link": "https://stackoverflow.com/users/10176096/anish"}, "edited": false, "score": 0, "creation_date": 1534331119, "post_id": 51853231, "comment_id": 90667116, "body": "This works like a charm. Thank you. Saved a lot of time and efforts"}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 0, "last_activity_date": 1534309557, "creation_date": 1534309557, "answer_id": 51853231, "question_id": 51852532, "link": "https://stackoverflow.com/questions/51852532/how-to-provide-attribute-value-in-the-template-erb-file/51853231#51853231", "title": "How to provide attribute value in the template .erb file", "body": "<p>So a few things. First you should use the <code>variables</code> property in your <code>template</code> resource to expose the data to the template:</p>\n\n<pre><code>template '/whatever' do\n  # ...\n  variables hostname: node['logs']['hostname']\nend\n</code></pre>\n\n<p>Then you need to use Erb formatting, which you kind of did but not really:</p>\n\n<pre><code>&lt;%= @hostname %&gt;\n</code></pre>\n\n<p>The variable name matches the key you used with <code>variables</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 10176096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02c7bd646292adbc758ef796d7f7573?s=128&d=identicon&r=PG&f=1", "display_name": "Anish", "link": "https://stackoverflow.com/users/10176096/anish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 51853231, "answer_count": 1, "score": -1, "last_activity_date": 1534311220, "creation_date": 1534303610, "last_edit_date": 1534311220, "question_id": 51852532, "link": "https://stackoverflow.com/questions/51852532/how-to-provide-attribute-value-in-the-template-erb-file", "title": "How to provide attribute value in the template .erb file", "body": "<p>How to provide attribute value in a template .erb file</p>\n\n<pre><code>qradar_logs/\n\u251c\u2500\u2500 Berksfile\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 attributes\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 default.rb\n\u251c\u2500\u2500 chefignore\n\u251c\u2500\u2500 files\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 default\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 default\n\u251c\u2500\u2500 metadata.rb\n\u251c\u2500\u2500 recipes\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 default.rb\n\u251c\u2500\u2500 spec\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 spec_helper.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 unit\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 recipes\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 default_spec.rb\n\u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 rsyslog.conf.erb\n\u2514\u2500\u2500 test\n    \u2514\u2500\u2500 integration\n        \u2514\u2500\u2500 default\n           \u2514\u2500\u2500 default_test.rb\n\n11 directories, 12 files\n</code></pre>\n\n<p>In <code>attribute.rb</code> file, I have the following contents:</p>\n\n<pre><code>default['logs']['hostname'] = \"169.67.89.72:514\"\n</code></pre>\n\n<p>In my recipe, I provided the following:</p>\n\n<pre><code>hostname = node['logs']['hostname']\n</code></pre>\n\n<p>In my templates <code>rsyslog.conf</code> file, I would like to use this value based on the value changed in <code>attributes</code> file.</p>\n\n<p>I tried giving:</p>\n\n<pre><code>&lt;%= \"#{hostname}\" %&gt;\n</code></pre>\n\n<p>It errors out as:</p>\n\n<pre><code>FATAL: Chef::Mixin::Template::TemplateError: undefined local variable or method `hostname'\n</code></pre>\n\n<p>How can I access the attributes defined in attribute file in <code>template.erb</code> file?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "gitlab"], "owner": {"reputation": 1220, "user_id": 5001254, "user_type": "registered", "accept_rate": 98, "profile_image": "https://lh6.googleusercontent.com/-Ojmkk3a2S1g/AAAAAAAAAAI/AAAAAAAAGSU/cGXZe62nlkg/photo.jpg?sz=128", "display_name": "Chaibi Alaa", "link": "https://stackoverflow.com/users/5001254/chaibi-alaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534318656, "creation_date": 1534297268, "last_edit_date": 1534318656, "question_id": 51851830, "link": "https://stackoverflow.com/questions/51851830/gitlab-11-1-4-incompatible-character-encodings-ascii-8bit-and-utf-8", "title": "Gitlab 11.1.4 incompatible character encodings: ASCII-8BIT and UTF-8", "body": "<p>Since the evening, after renewal of the SSL certificate of the subdomain related to Github and may be after an automatic update of Centos7 server and mariadb (while I'm sure it has nothing to do with it) my gitlab stopped working.</p>\n\n<p>I tried reconfigure and restart several times, no chance.</p>\n\n<p>Here is the exact error from the tail </p>\n\n<pre><code>==&gt; /var/log/gitlab/gitlab-rails/production.log &lt;==\nStarted GET \"/users/sign_in\" for 196.229.241.110 at 2018-08-15 01:26:28 +0000\nProcessing by SessionsController#new as HTML\nEncoding::CompatibilityError (incompatible character encodings: ASCII-8BIT and UTF-8):\n  app/views/layouts/_head.html.haml:26:in `_app_views_layouts__head_html_haml___4353105439635492698_70226876228260'\n  app/views/layouts/devise.html.haml:3:in `_app_views_layouts_devise_html_haml__4146057416282651987_70226896429000'\n  app/controllers/sessions_controller.rb:29:in `new'\n  lib/gitlab/i18n.rb:51:in `with_locale'\n  lib/gitlab/i18n.rb:57:in `with_user_locale'\n  app/controllers/application_controller.rb:370:in `set_locale'\n  lib/gitlab/middleware/multipart.rb:97:in `call'\n  lib/gitlab/request_profiler/middleware.rb:14:in `call'\n  ee/lib/gitlab/jira/middleware.rb:15:in `call'\n  lib/gitlab/middleware/go.rb:17:in `call'\n  lib/gitlab/etag_caching/middleware.rb:11:in `call'\n  lib/gitlab/middleware/read_only/controller.rb:38:in `call'\n  lib/gitlab/middleware/read_only.rb:16:in `call'\n  lib/gitlab/request_context.rb:18:in `call'\n  lib/gitlab/metrics/requests_rack_middleware.rb:27:in `call'\n  lib/gitlab/middleware/release_env.rb:10:in `call'\n\nCompleted 500 Internal Server Error in 13ms (Views: 0.4ms | ActiveRecord: 0.9ms | Elasticsearch: 0.0ms)\n</code></pre>\n\n<p>The config-check (gitlab-rake) returned that everything is fine .. I simply can't find anything related to this issue specially for gitlab versions above 10 (mine is 11.1.4, latest one)</p>\n\n<p>Can anyone help ? I'm running this in a Centos7 Plesk server, over Nginx with SSL</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": true, "score": 2, "last_activity_date": 1534300555, "last_edit_date": 1534300555, "creation_date": 1534298312, "answer_id": 51851946, "question_id": 51851544, "link": "https://stackoverflow.com/questions/51851544/retrieving-all-records-in-order-of-precedence-in-rails/51851946#51851946", "title": "Retrieving all records in order of precedence in rails", "body": "<p>Try...</p>\n\n<pre><code>Video.order(\"status = 1, status = 0\")\n</code></pre>\n\n<p>premium has a value of 1, regular has a value of 0. </p>\n\n<p>or...</p>\n\n<pre><code>Video.order(status: :desc)\n</code></pre>\n"}], "owner": {"reputation": 1377, "user_id": 4485127, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IoOC4.jpg?s=128&g=1", "display_name": "Angel Garcia", "link": "https://stackoverflow.com/users/4485127/angel-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 51851946, "answer_count": 1, "score": 1, "last_activity_date": 1534300555, "creation_date": 1534294461, "question_id": 51851544, "link": "https://stackoverflow.com/questions/51851544/retrieving-all-records-in-order-of-precedence-in-rails", "title": "Retrieving all records in order of precedence in rails", "body": "<p>So I have an app that has videos which can be searched for. Some videos are free to watch, while others are premium content. Is it possible to retrieve a list of records like this where the premium content coming first in the list, and the regular coming last:</p>\n\n<pre><code>Video1 - Premium\nVideo3 - Premium\nVideo4 - Premium\nVideo2 - Regular\nVideo5 - Regular\nVideo6 - Regular\n</code></pre>\n\n<p>The videos are not ordered necessarily by <code>id</code> but rather by status, or 'precedence' you could say.\nI'm currently handling <code>premium</code> and <code>regular</code> with an enum called status.</p>\n\n<pre><code>enum status: [:regular, :premium]\n</code></pre>\n\n<p>I was wondering if you get such a result with only one query, or would you have to retrieve all the data first, and then just sort it? The former seems more efficient, and that is why I was wondering if you could do that. </p>\n\n<p>Could you maybe use the <code>.order()</code> method?</p>\n\n<p>I know that <code>Video.all.order(:status)</code> gives an error, but I don't know if you could still use the same query in a slightly different way.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": false, "score": 0, "last_activity_date": 1534292022, "creation_date": 1534292022, "answer_id": 51851294, "question_id": 51850977, "link": "https://stackoverflow.com/questions/51850977/is-an-equivalent-of-singleton-variable-set-available-in-ruby/51851294#51851294", "title": "is an equivalent of singleton_variable_set available in Ruby?", "body": "<p>I don't know if we can do that but if all you need is some method to be available on both instance and class level, you can do something like this with the use of a module,</p>\n\n<pre><code>module SampleModule\n\n  module ClassMethods\n    def sample_method params\n      ...\n    end\n  end\n\n  def sample_method params\n    ...\n  end\n\n  def self.included base\n    base.extend ClassMethods\n  end\n\nend\n</code></pre>\n\n<p>You include this module in your class and it'll expose the instance method and by the <code>self.included</code> block it'll also expose the method at class level.</p>\n\n<p>Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1534296508, "post_id": 51851556, "comment_id": 90656363, "body": "I have not tried it out yet but it looks cleaner than what I have."}], "tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": true, "score": 1, "last_activity_date": 1534296337, "last_edit_date": 1534296337, "creation_date": 1534294602, "answer_id": 51851556, "question_id": 51850977, "link": "https://stackoverflow.com/questions/51850977/is-an-equivalent-of-singleton-variable-set-available-in-ruby/51851556#51851556", "title": "is an equivalent of singleton_variable_set available in Ruby?", "body": "<p>The same could be accomplished within the block using a singleton method to retrieve a value:</p>\n\n<pre><code>Class.new(ActionContainer::Base) do \n  define_singleton_method(:ac_relation) { @ac_relation }\n  @ac_relation = ac_relation\nend\n</code></pre>\n\n<p>If you need a public setter:</p>\n\n<pre><code>define_singleton_method(:ac_relation=) { |value| @ac_relation = value }\n</code></pre>\n\n<p>This would avoid the visibility issues and need to call <code>instance_variable_get</code> on the class within another method.</p>\n\n<p>So you don't really NEED a <code>singleton_variable_set</code> method. The block is executed within the context of the class, so defining an instance variable within it is the same as:</p>\n\n<pre><code>class MyClass\n  class &lt;&lt; self\n    # Defining instance variables here\n  end\nend\n</code></pre>\n\n<p>You simply need a way to access them.</p>\n\n<pre><code>def prepare(some_value)\n  Class.new do \n    define_singleton_method(:ac_relation) { @ac_relation }\n    define_singleton_method(:ac_relation=) { |value| @ac_relation = value }\n    @ac_relation = some_value\n  end\nend\n\nklass = prepare(\"foobar\")\nklass.ac_relation\n#=&gt; \"foobar\"\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 51851556, "answer_count": 2, "score": 0, "last_activity_date": 1534296337, "creation_date": 1534289084, "last_edit_date": 1534291128, "question_id": 51850977, "link": "https://stackoverflow.com/questions/51850977/is-an-equivalent-of-singleton-variable-set-available-in-ruby", "title": "is an equivalent of singleton_variable_set available in Ruby?", "body": "<p>I need the equivalent of a <code>singleton_variable_set</code> in Ruby for my use case. But no such exists:</p>\n\n<pre><code>&gt; A = Class.new\n=&gt; A \n&gt; A.respond_to? :instance_variable_set\n=&gt; true \n&gt; A.respond_to? :class_variable_set\n=&gt; true \n&gt; A.respond_to? :class_instance_variable_set\n=&gt; false \nA.respond_to? :singleton_variable_set\n =&gt; false \n</code></pre>\n\n<p>Why do I need it? I am creating an anonymous class, which has a binding in the containing method to a variable I will need in my anonymous class as both an instance method and a singleton method of the class:</p>\n\n<pre><code>def prepare(ac_relation)\n  Class.new ActionContainer::Base do\n        mattr_accessor :ac_relation\n        instance_variable_set(:@ac_relation, ac_relation)\n        singleton_variable_set(:@ac_relation, ac_relation)\n  end\nend   \n</code></pre>\n\n<p>I need ac_relation available as both an instance and singleton method of the newly created anonymous class. Unfortunately, singleton_variable_set does not exist. How can I achieve what I want?   </p>\n\n<p>This is a working solution I came up with but I don't like it:</p>\n\n<pre><code>val = 2\n\nc = Class.new do\n  attr_accessor :cc\n  class &lt;&lt; self\n    attr_accessor :cc\n  end\n\n  @cc = 2\n  instance_variable_set(:@cc, val)\n\n  def initialize\n    @cc = self.class.instance_variable_get(:@cc)\n  end\nend  \n</code></pre>\n"}, {"tags": ["ruby", "regex", "regex-group"], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1534289595, "creation_date": 1534289595, "answer_id": 51851036, "question_id": 51850913, "link": "https://stackoverflow.com/questions/51850913/ruby-regex-avoid-matching-a-group/51851036#51851036", "title": "Ruby regex avoid matching a group", "body": "<p>You should use a single grouping construct here, the one to match 1 or more occurrences of four hex chars, and omit the inner capturing group that resulted in an extra item in the resulting array:</p>\n\n<pre><code>.scan(/^(?:\\\\u[\\da-fA-F]{4})+/)\n</code></pre>\n\n<p>Note that <code>+</code> is a simpler and shorter way to write <code>{1,}</code> (one or more occurrences).</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>(?:</code> - start of a non-capturing group (what it matches won't be added to the final <code>scan</code> result):  \n\n<ul>\n<li><code>\\\\u</code> - a <code>\\u</code> substring</li>\n<li><code>[\\da-fA-F]{4}</code> - four hex chars</li>\n</ul></li>\n<li><code>)+</code> - 1 or more occurrences (of the group pattern sequence).</li>\n</ul>\n"}], "owner": {"reputation": 4476, "user_id": 735779, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/19ffcd943c2ed18b79482f29f13014f6?s=128&d=identicon&r=PG", "display_name": "Hartator", "link": "https://stackoverflow.com/users/735779/hartator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 51851036, "answer_count": 1, "score": 2, "last_activity_date": 1534301754, "creation_date": 1534288488, "last_edit_date": 1534301754, "question_id": 51850913, "link": "https://stackoverflow.com/questions/51850913/ruby-regex-avoid-matching-a-group", "title": "Ruby regex avoid matching a group", "body": "<p>I have this code running inside a buffer (used to unescape a JS string in Ruby):</p>\n\n<pre><code>  elsif hex_substring =~ /^\\\\u[0-9a-fA-F]{1,4}/\n    hex_substring.scan(/^((\\\\u[\\da-fA-F]{4}){1,})/) do |match|\n      hex_byte = match[0]\n      buffer    &lt;&lt; JSON.load(%Q(\"#{hex_byte}\"))\n      hex_index += hex_byte.length\n    end\n  ...\n</code></pre>\n\n<p>I have a concern that the <code>scan()</code> is matching a bit too much:</p>\n\n<pre><code>hex_substring.scan(/^((\\\\u[\\da-fA-F]{4}){1,})/)\n# =&gt; [[\"\\\\ud83c\\\\udfec\", \"\\\\udfec\"]]\n</code></pre>\n\n<p>I am using only <code>\"\\\\ud83c\\\\udfec\"</code>, not <code>\"\\\\udfec\"</code>. </p>\n\n<p>Is there a way in Ruby or in regex to grab only the first part? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1534289353, "post_id": 51850789, "comment_id": 90655167, "body": "Is there a stack trace to go with that exception?"}, {"owner": {"reputation": 119, "user_id": 8883284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-xmS4vtu8uvM/AAAAAAAAAAI/AAAAAAAAAaI/LgUjMM_2s6c/photo.jpg?sz=128", "display_name": "miklki14567", "link": "https://stackoverflow.com/users/8883284/miklki14567"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1534290119, "post_id": 51850789, "comment_id": 90655306, "body": "Yes, but it&#39;s a little long"}, {"owner": {"reputation": 119, "user_id": 8883284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-xmS4vtu8uvM/AAAAAAAAAAI/AAAAAAAAAaI/LgUjMM_2s6c/photo.jpg?sz=128", "display_name": "miklki14567", "link": "https://stackoverflow.com/users/8883284/miklki14567"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1534290342, "post_id": 51850789, "comment_id": 90655354, "body": "I believe I added it."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1534297269, "post_id": 51850789, "comment_id": 90656501, "body": "So you&#39;re getting a NoMethodError complaining about a method called <code>&#39; &#39;</code> (a single space) at <code>return if @jobs.empty?</code>? Do you have some funky unicode in there?"}], "owner": {"reputation": 119, "user_id": 8883284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-xmS4vtu8uvM/AAAAAAAAAAI/AAAAAAAAAaI/LgUjMM_2s6c/photo.jpg?sz=128", "display_name": "miklki14567", "link": "https://stackoverflow.com/users/8883284/miklki14567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534290156, "creation_date": 1534287424, "last_edit_date": 1534290156, "question_id": 51850789, "link": "https://stackoverflow.com/questions/51850789/nomethod-error-regarding-mailers", "title": "NoMethod Error. Regarding Mailers", "body": "<p>I'm trying to test if a mailer is working correctly via a mailer test but when I try to load the view I get the following error:</p>\n\n<pre><code>undefined method ` ' for #&lt;DailyMailerPreview:0x007fb2bd79af78&gt;\n</code></pre>\n\n<p>Here is the mailer preview code:</p>\n\n<pre><code>class DailyMailerPreview &lt; ActionMailer::Preview\n def new_jobs \n  @jobs = Job.where(\"created_at &gt; ?\", 1.day.ago)\n\n  return if @jobs.empty?\n\n  User.find_each do |user|\n   mail to: user.email, subject: 'New Jobs'\n  end\n  end\n  end\n</code></pre>\n\n<p>The issue is that I don't understand where the NoMethod error is coming from. I'm pretty sure it's a silly typo but I can't seem to understand where the typo is at.</p>\n\n<p>Thank you big time ahead of time.</p>\n\n<p>Edit:</p>\n\n<p>Stack trace:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0bkav.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0bkav.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorting"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1534302051, "post_id": 51850732, "comment_id": 90657367, "body": "Sounds similar, check if it helps: <a href=\"https://stackoverflow.com/questions/26813645/rails-activerecord-sum-then-order\" title=\"rails activerecord sum then order\">stackoverflow.com/questions/26813645/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 566850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c03fdc9fc1f107225b664934e5ff5965?s=128&d=identicon&r=PG", "display_name": "Stefan Daschek", "link": "https://stackoverflow.com/users/566850/stefan-daschek"}, "is_accepted": true, "score": 0, "last_activity_date": 1534289186, "creation_date": 1534289186, "answer_id": 51850995, "question_id": 51850732, "link": "https://stackoverflow.com/questions/51850732/sort-a-table-using-the-total-of-other-tables/51850995#51850995", "title": "Sort a table using the total of other tables", "body": "<p>One way of doing this is with an subselect:</p>\n\n<pre><code>subselect = \"SELECT SUM(score) FROM week_scores WHERE membership_id=memberships.id\"\n@memberships = Membership.\n  select(\"memberships.*, (#{subselect}) AS total_score\").\n  order(\"total_score DESC\")\n</code></pre>\n\n<p>The additional column specified in the select clause (<code>total_score</code>) will be available on the returned membership instances as if it were a \u201creal\u201d attribute, so calling something like <code>@memberships.first.total_score</code> will work.</p>\n\n<p>(Note that I extracted the subselect into a separate variable only to make the code more readable, it is of course also possible to have it inline instead.)</p>\n"}], "owner": {"reputation": 51, "user_id": 8935694, "user_type": "registered", "profile_image": "https://graph.facebook.com/1651932888160314/picture?type=large", "display_name": "David Cantu", "link": "https://stackoverflow.com/users/8935694/david-cantu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 51850995, "answer_count": 1, "score": 1, "last_activity_date": 1534289186, "creation_date": 1534286881, "last_edit_date": 1534287901, "question_id": 51850732, "link": "https://stackoverflow.com/questions/51850732/sort-a-table-using-the-total-of-other-tables", "title": "Sort a table using the total of other tables", "body": "<p>2 tables: <code>memberships</code> and <code>week_scores</code></p>\n\n<p><strong>Membership</strong> <code>has_many :week_scores</code></p>\n\n<p><strong>WeekScore</strong> <code>belongs_to :membership</code></p>\n\n<p>Every membership has 16 <code>week_scores</code></p>\n\n<p>Every <code>week_score</code> table has a <code>score</code> column that has an integer from 0 to 20.</p>\n\n<p>So just to be clear all memberships have 16 week_scores and I want to display a <code>leaderboard table</code> of all members of the group sorted by the total score of all their 16 <code>week_scores</code> tables.</p>\n\n<p>It should look something like this</p>\n\n<p>Username | Score</p>\n\n<ol>\n<li>David  | 114</li>\n<li>Rick   | 97</li>\n<li>Mike   | 95</li>\n<li>...</li>\n</ol>\n\n<p>The score column should be a sum of all the <code>week_scores</code> one user has so in case of David it was  </p>\n\n<pre><code>week_score.score 1: 15  \nweek_score.score 2: 12  \nweek_score.score 3: 14  \n...  \nweek_score.score 16: 9  \ntotal: 114  \n</code></pre>\n\n<p>If the name of the post is not good let me know.</p>\n"}, {"tags": ["ruby", "algorithm", "logarithm"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1534284112, "post_id": 51850085, "comment_id": 90653884, "body": "If someone doesn&#39;t provide an answer you might have better luck in one of the more sciency Stack Exchange websites. Computer Science could be a good fit. See here: <a href=\"https://meta.stackexchange.com/questions/165519/where-should-i-post-questions-about-algorithms-stack-overflow-or-software-engin\" title=\"where should i post questions about algorithms stack overflow or software engin\">meta.stackexchange.com/questions/165519/&hellip;</a>"}, {"owner": {"reputation": 90, "user_id": 9612664, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7FScr6ryYII/AAAAAAAAAAI/AAAAAAAAADA/EH1ZAcd8YbY/photo.jpg?sz=128", "display_name": "aimen alt", "link": "https://stackoverflow.com/users/9612664/aimen-alt"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1534287587, "post_id": 51850085, "comment_id": 90654815, "body": "Thanks @Casper, I&#39;ll definitely be checking those site as well."}, {"owner": {"reputation": 90, "user_id": 9612664, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7FScr6ryYII/AAAAAAAAAAI/AAAAAAAAADA/EH1ZAcd8YbY/photo.jpg?sz=128", "display_name": "aimen alt", "link": "https://stackoverflow.com/users/9612664/aimen-alt"}, "reply_to_user": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1534287647, "post_id": 51850085, "comment_id": 90654832, "body": "@m69 Not Duplicate, I&#39;ve already seen it but it turned out it was using java not ruby."}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1534288418, "post_id": 51850085, "comment_id": 90654969, "body": "Well, the maths is the same, and &quot;my main concern is understanding the mathematical logic behind the solution&quot;."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1534289431, "post_id": 51850085, "comment_id": 90655181, "body": "I&#39;m gonna go with the dupe as well...looks like a pretty detailed explanation, and glancing through the code there doesn&#39;t appear to be anything super java-y in any of the blocks...it shouldn&#39;t take any significant amount of time or effort to convert the code to ruby...and if there is something that doesn&#39;t translate easily we can always help with &quot;here&#39;s a line of java code and I&#39;m having trouble figuring out how to do it in ruby&quot;...I see a fair number of questions like that pop up"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534292988, "post_id": 51850085, "comment_id": 90655785, "body": "Are you asking if there is a way to obtain the 10,001st prime without first computing the first 10,000 primes? See this <a href=\"https://en.wikipedia.org/wiki/Generating_primes\" rel=\"nofollow noreferrer\">Wiki</a>."}], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1534315606, "post_id": 51850811, "comment_id": 90660575, "body": "&quot;(and one of the very few moments I think it&#39;s okay to use a global variable)&quot; - Why? The whole thing could have been wrapped inside a function to make <code>primes</code> local to the outer function, with no loss of functionality, while avoiding polluting the global namespace."}, {"owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1534321274, "post_id": 51850811, "comment_id": 90662824, "body": "I totally agree! I would not create lib or app code that contains a global variable, but I liked the idea of prime numbers being available globally because of there fundamental nature. So, in this example it&#39;s (not great or nice but) &quot;okay&quot; for me :-)"}], "tags": [], "owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "is_accepted": false, "score": 0, "last_activity_date": 1534287640, "creation_date": 1534287640, "answer_id": 51850811, "question_id": 51850085, "link": "https://stackoverflow.com/questions/51850085/finding-the-nth-prime-number-with-logs-or-other-quicks-ways-with-details-on-how/51850811#51850811", "title": "Finding the nth prime number with Logs or other quicks ways with details on how it works (not brute forcing) using ruby", "body": "<p>Here is an example (and one of the very few moments I think it's okay to use a global variable).</p>\n\n<pre><code>$primes = {2 =&gt; nil}  # Hash for constant asymptotic lookup time, 2 for only even prime\n\ndef prime?(num)\n  return false if num &lt;= 1\n  return true if $primes.key?(num)\n  Math.sqrt(num).to_i.downto(2).each {|i| return false if num % i == 0}\n  $primes[num] = nil\n  true\nend\n\nnum = 3  # start with first odd prime\nwhile ($primes.length &lt; 10001)\n  prime?(num)  #  Check if number is prime and add to $primes if it is\n  num += 2     #  Only check odd numbers\nend\n\n$primes.keys[1-1]      # 1st prime number =&gt; 2\n$primes.keys[10001-1]  # 10001st prime number =&gt; 104743\n</code></pre>\n\n<p>In this example line <code>return true if $primes.key?(num)</code> is not needed, but it's useful when checking a number that is already known to be prime.\nI hope you find this helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1534313933, "post_id": 51851085, "comment_id": 90659982, "body": "Of course, you could also do <code>require &#39;prime&#39;; Prime.lazy.drop(10000).first</code> (or <code>Prime.take(10001).last</code>) as a <i>much</i> faster alternative :P On the plus side: pure Ruby, no Java. On the minus side: you learn nothing about maths."}], "tags": [], "owner": {"reputation": 16306, "user_id": 448810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4b14d4a7503a55cb803c049700ed83b?s=128&d=identicon&r=PG", "display_name": "user448810", "link": "https://stackoverflow.com/users/448810/user448810"}, "is_accepted": false, "score": 2, "last_activity_date": 1534290431, "last_edit_date": 1534290431, "creation_date": 1534289994, "answer_id": 51851085, "question_id": 51850085, "link": "https://stackoverflow.com/questions/51850085/finding-the-nth-prime-number-with-logs-or-other-quicks-ways-with-details-on-how/51851085#51851085", "title": "Finding the nth prime number with Logs or other quicks ways with details on how it works (not brute forcing) using ruby", "body": "<p>The <em>n</em>th prime is less than <em>n</em>(log<sub><em>e</em></sub> <em>n</em> + log<sub><em>e</em></sub> log<sub><em>e</em></sub> <em>n</em>), as any number theory textbook will tell you, so you can use the Sieve of Eratosthenes to compute too-many primes, then trim the list to the desired size. Here's a simple version of the Sieve of Eratosthenes:</p>\n\n<pre><code>function primes(n) # primes less than n\n    sieve := makeArray(2..n, True)\n    for p from 2 to n step 1\n        if sieve[p]\n            output p\n            for i from p*p to n step p\n                sieve[i] = False\n</code></pre>\n\n<p>For the 10,000th prime, you will need the primes less than 10000 * (log 10000 + log log 10000) = 10000 * (9.21034 + 2.2203268) = 114307. Your sieve should compute the list of primes and return instantly. I'll leave it to you to translate that pseudocode to Ruby.</p>\n\n<p>There are better ways to compute the <em>n</em>th prime number, but this is sufficient for Project Euler, and will be much faster than using trial division to check numbers for primality.</p>\n"}], "owner": {"reputation": 90, "user_id": 9612664, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7FScr6ryYII/AAAAAAAAAAI/AAAAAAAAADA/EH1ZAcd8YbY/photo.jpg?sz=128", "display_name": "aimen alt", "link": "https://stackoverflow.com/users/9612664/aimen-alt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "closed_date": 1534303964, "answer_count": 2, "score": 0, "last_activity_date": 1534295146, "creation_date": 1534282475, "last_edit_date": 1534287252, "question_id": 51850085, "link": "https://stackoverflow.com/questions/51850085/finding-the-nth-prime-number-with-logs-or-other-quicks-ways-with-details-on-how", "closed_reason": "Duplicate", "title": "Finding the nth prime number with Logs or other quicks ways with details on how it works (not brute forcing) using ruby", "body": "<p>I'm trying to find a way to find the 10001th prime number for project euler #7, I've already brute forced my way to find the answer but I would much prefer to know how to reach the answer with more sophisticated methods that are much quicker to run. Please do explain to me in detail how it works.</p>\n\n<p>I know it all methods require math, so my main concern is understanding the mathematical logic behind the solution to finding the nth prime.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1534282675, "post_id": 51849865, "comment_id": 90653450, "body": "My advice? Don&#39;t jump from Rails 4.0 to 4.2, and from Ruby (whatever you were before) to 2.3.7, blindly, and then be shocked when something stops working. GO one version at a time. Read the <a href=\"https://guides.rubyonrails.org/upgrading_ruby_on_rails.html\" rel=\"nofollow noreferrer\">upgrade guides</a> -- they&#39;re extremely useful. Add tests. (A test should have failed here.) Worst case scenario, you could at least come on StackOverflow and say &quot;when upgrading from Rails <b>4.1.16</b> to <b>4.2.0</b>, this changed&quot;. (Although I&#39;d be shocked if there wasn&#39;t already a warning about that in the upgrade guide.)"}, {"owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534284117, "post_id": 51849865, "comment_id": 90653886, "body": "We did go incrementally."}, {"owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534284763, "post_id": 51849865, "comment_id": 90654074, "body": "If you&#39;re not living life on the edge, you&#39;re taking up too much space!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534322017, "post_id": 51849865, "comment_id": 90663092, "body": "If you went incrementally, then why do you not know whether it was rails 4.1, or rails 4.2, or some ruby version bump, that caused the issue? You should <i>test the application thoroughly</i> after each version bump, especially if you have insufficient test coverage to proceed with confidence."}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "edited": false, "score": 0, "creation_date": 1534285156, "post_id": 51850024, "comment_id": 90654206, "body": "This is working! I am getting 2 emails now, but I think I can take care of that!"}], "tags": [], "owner": {"reputation": 356, "user_id": 566850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c03fdc9fc1f107225b664934e5ff5965?s=128&d=identicon&r=PG", "display_name": "Stefan Daschek", "link": "https://stackoverflow.com/users/566850/stefan-daschek"}, "is_accepted": true, "score": 2, "last_activity_date": 1534282170, "creation_date": 1534282170, "answer_id": 51850024, "question_id": 51849865, "link": "https://stackoverflow.com/questions/51849865/actionmailer-not-working-after-upgrade-rails-ruby-version-only-works-in-termi/51850024#51850024", "title": "ActionMailer not working after upgrade Rails &amp; Ruby version. Only works in terminal", "body": "<p>ActionMailer changed in Rails 4.2, quoting the <a href=\"https://guides.rubyonrails.org/v4.2.10/upgrading_ruby_on_rails.html#action-mailer\" rel=\"nofollow noreferrer\">upgrade guide</a>:</p>\n\n<blockquote>\n  <p>Previously, calling a mailer method on a mailer class will result in the corresponding instance method being executed directly. With the introduction of Active Job and <code>#deliver_later</code>, this is no longer true. In Rails 4.2, the invocation of the instance methods are deferred until either <code>deliver_now</code> or <code>deliver_later</code> is called.</p>\n</blockquote>\n\n<p>So in your case, simply appending <code>.deliver_now</code> to your call should work:</p>\n\n<pre><code>NotificationMailer.send_reset_instructions(self).deliver_now\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 6484367, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/8e9d26d6946fc918749adbefd5dd751c?s=128&d=identicon&r=PG&f=1", "display_name": "dsomel21", "link": "https://stackoverflow.com/users/6484367/dsomel21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 51850024, "answer_count": 1, "score": 1, "last_activity_date": 1534282170, "creation_date": 1534281359, "question_id": 51849865, "link": "https://stackoverflow.com/questions/51849865/actionmailer-not-working-after-upgrade-rails-ruby-version-only-works-in-termi", "title": "ActionMailer not working after upgrade Rails &amp; Ruby version. Only works in terminal", "body": "<p>I just upgraded my app from Rails 4.0 to 4.2.6 and our Ruby version to 2.3.7.</p>\n\n<p>As I am testing my app, I am noticing my reset password emails are NOT being sent out. Take a look.</p>\n\n<blockquote>\n  <p><strong>password_resets_controller.rb</strong></p>\n</blockquote>\n\n<pre><code>def create\n  @user = User.find_by_email(params[:email])\n  if @user\n    @user.deliver_password_reset_instructions!\n  end\n  flash[:notice] = \"Instructions to reset your password have been emailed to you\"\n  render :action =&gt; :new\nend\n</code></pre>\n\n<p>This <code>deliver_password_reset_instructions!</code> exists in my <strong>User</strong> model file. </p>\n\n<blockquote>\n  <p><strong>user.rb</strong> (hasn't been changed in over a year)</p>\n</blockquote>\n\n<pre><code>def deliver_password_reset_instructions!\n  reset_perishable_token! #this method updates the user's perishable_token \n  NotificationMailer.send_reset_instructions(self)\nend\n</code></pre>\n\n<p>But... when I call my <code>send_reset_instructions</code> method in the NotificationMailer model, nothing happens anymore. However... when I put a debugger in my code, as such:</p>\n\n<pre><code>def deliver_password_reset_instructions!\n  reset_perishable_token! #this method updates the user's perishable_token \n  binding.pry # If I call `NotificationMailer.send_reset_instructions(self)` it works\n  NotificationMailer.send_reset_instructions(self)\nend\n</code></pre>\n\n<p>and I run the <code>NotificationMailer.send_reset_instructions(self)</code>, it works, but not without me typing it.</p>\n\n<p>It just seems realyl wierd to me that... it works... but only if it I manually type it in the debugger. So, I can't put my finger on WHERE it is broken.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "ruby-on-rails-5.2", "actiondispatch"], "comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534314090, "post_id": 51849817, "comment_id": 90660044, "body": "Sorry, I&#39;ve had limited blocks of free time lately, and never came back to dig into your issue. This sounds like a good solution. \ud83d\udc4d\ud83c\udffb"}, {"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "reply_to_user": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534315553, "post_id": 51849817, "comment_id": 90660552, "body": "O no worry !! you have been a great help and I have learned so much from what you wrote !!"}], "answers": [{"comments": [{"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534314690, "post_id": 51853828, "comment_id": 90660262, "body": "That works !! Thank you so much !! Through this process I learned so much about the reloader. I guess it&#39;s a unique use case that we have calling a mock engine from a middleware or do you think the reloader should prevent the second reload ?"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534314881, "post_id": 51853828, "comment_id": 90660320, "body": "I still <i>think</i> the second reload should be unnecessary -- because the first one should&#39;ve gotten everything up to date -- in which case the second should be prevented just by not being tried... if it legitimately thinks it needs to reload again, though, I&#39;m not sure what it should do: skipping means the inner request runs on known-outdated code, which could be very confusing. (Here I&#39;m sure it&#39;s fine, because the chances that your dummy session handler have changed seem vanishingly small.)"}, {"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534315300, "post_id": 51853828, "comment_id": 90660457, "body": "The mock engine is a gem that we add on to the app for development so it wouldn&#39;t ever have a code change on the fly. I think the fact that we are calling the mock engine in the middleware is the issue. From looking at the debugger, it seems like the executor call <code>run!</code> on the reloader and pass the request down the next middleware before the reloading is complete."}, {"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534315473, "post_id": 51853828, "comment_id": 90660517, "body": "That request to the mock engine from the middleware hit the middlewares from the top again as if a new requests comes in which then unload all the classes and never make it out the middleware and cause the first request to timeout"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534315587, "post_id": 51853828, "comment_id": 90660564, "body": "When <code>run!</code> returns, the reload is done. (<code>complete!</code> is talking about the request that <i>triggered</i> the reload, not the reload itself. Confusing naming \ud83d\ude15)"}, {"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534316236, "post_id": 51853828, "comment_id": 90660826, "body": "<code>complete!</code> is the one that calls <code>self.class.reloaded!</code> which marks <code>@should_reload = false</code> But that is call after <code>@app.call(env)</code> which pass the request down the middleware. Although the reloading part is done and <code>release_unload_lock!</code> is called, but <code>@should_reload</code> was not mark as false until <code>complete!</code>"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534319279, "post_id": 51853828, "comment_id": 90661925, "body": "Oh! That makes sense, thanks. Seems tricky to solve for the general case (there are some configurations where the actual reloading happens in <code>complete!</code>), but that does sound like something worth fixing."}, {"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534321412, "post_id": 51853828, "comment_id": 90662878, "body": "O .. i am not aware that there is config to make the reloading happens in &#39;complete! &#39;. Do u know what is it call ?  I guess it would be some kind of call back. Not sure what that use case is but i am not sure thats a good idea with our case,  cuz reloading in &#39;complete! &#39; means that the middleware request will hit the old code. But anyhow I am more than happy to submit a pr with your guidance !!"}, {"owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "edited": false, "score": 0, "creation_date": 1534321845, "post_id": 51853828, "comment_id": 90663040, "body": "But what is the reason to call &#39;@app.call(env)&#39; which pass the request down the middlewares after reloading is done but before &#39;complete!&#39; is called ?? Then whats the reason wrapping the reloader with a executor at all ?"}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1534313938, "creation_date": 1534313938, "answer_id": 51853828, "question_id": 51849817, "link": "https://stackoverflow.com/questions/51849817/rail-5-swap-actiondispatchreloader-with-a-custom-reloader/51853828#51853828", "title": "Rail 5 swap ActionDispatch::Reloader with a custom reloader", "body": "<p>You need to pass your middleware's additional argument to the <code>swap</code> call:</p>\n\n<pre><code>app.config.middleware.swap(::ActionDispatch::Reloader, MyModule::CustomReloaderMiddleware, app.reloader)\n</code></pre>\n\n<p>That's the same argument given when <code>ActionDispatch::Reloader</code> is <a href=\"https://github.com/rails/rails/blob/7e3a0a947faeecee03d2714789084addbcf7e414/railties/lib/rails/application/default_middleware_stack.rb#L52\" rel=\"nofollow noreferrer\">first added</a> -- it's the application's reloader, which is a more specifically configured subclass of AS::Reloader (so you were on the right track).</p>\n"}], "owner": {"reputation": 694, "user_id": 2388058, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d0ba321c27f5c1cdeafcbe007145586a?s=128&d=identicon&r=PG", "display_name": "AirWick219", "link": "https://stackoverflow.com/users/2388058/airwick219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 51853828, "answer_count": 1, "score": 1, "last_activity_date": 1534313938, "creation_date": 1534281138, "last_edit_date": 1534281637, "question_id": 51849817, "link": "https://stackoverflow.com/questions/51849817/rail-5-swap-actiondispatchreloader-with-a-custom-reloader", "title": "Rail 5 swap ActionDispatch::Reloader with a custom reloader", "body": "<p>We have a use case for mounting a mock engine to process sessions when developing locally in which a custom session middleware calls the mock engine via Net::http request when a request comes through. </p>\n\n<p>When there is code change, the reloader is triggered and <a href=\"https://github.com/rails/rails/blob/master/activesupport/lib/active_support/reloader.rb#L101\" rel=\"nofollow noreferrer\">here</a> calls the <code>ActiveSupport::Dependencies</code> to start unloading. Then the request is pass down to our custom session middleware and the http request is fired.\n<strong>However since the http request calls to a mountable engine, it goes thought the same middlewares again</strong> and the reloader unloads all the dependencies again which cause the first reload to timeout. So the goal is to be able to skip the reload for the second request.</p>\n\n<p>I added the follow code to <code>ActionDispatch::Reloader</code> <a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/reloader.rb#L11\" rel=\"nofollow noreferrer\">here</a> and it does exactly what I wanted. </p>\n\n<pre><code>class Reloader &lt; Executor\n  def initialize(app, executor)\n    super(app, executor)\n  end\n\n  def call(env)\n    request = ActionDispatch::Request.new(env)\n    return @app.call(env) if skip_request?(request)\n    super(env)\n  end\n\n  def skip_request?(request)        \n    request.path_info.start_with?('/session')\n  end\nend\n</code></pre>\n\n<p>Then I want to make this cleaner figured to pull that out completely to a module and just do a swap like this from an initializer </p>\n\n<pre><code>app.config.middleware.swap(::ActionDispatch::Reloader, MyModule::CustomReloaderMiddleware)\n</code></pre>\n\n<p>Here is the module</p>\n\n<pre><code>require 'action_dispatch'\n\nmodule MyModule\n  class CustomReloaderMiddleware &lt; ActionDispatch::Executor\n    def initialize(app, executor)\n      @app, @executor = app, executor\n    end\n\n    def call(env)\n      request = ActionDispatch::Request.new(env)\n      return @app.call(env) if skip_request?(request)\n      super(env)\n    end\n\n    def skip_request?(request)\n      request.path_info.start_with?('/session')\n    end\n  end\nend\n</code></pre>\n\n<p>But I ran into a couple issues. </p>\n\n<p><code>Uncaught exception: wrong number of arguments (given 1, expected 2)</code> from for the <code>initialize</code> in <code>MyModule</code>, when I starts the server. Then I tried the following</p>\n\n<pre><code>#1\n\ndef initialize(app, executor = nil)\n  @app, @executor = app, executor\nend\n\n#2\n\ndef initialize(app, executor = nil)\n  @app, @executor = app, ActiveSupport::Reloader\nend\n</code></pre>\n\n<p>Both of them starts the service correctly and I see the request going through this middleware but it does not reload the code.. So I wondered what is the correct way of swapping ActionDispatch::Reloader with a custom reloader ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "views", "models", "controllers"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5224838, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207407333846429/picture?type=large", "display_name": "Jonathan V Britannia", "link": "https://stackoverflow.com/users/5224838/jonathan-v-britannia"}, "edited": false, "score": 0, "creation_date": 1534304501, "post_id": 51849696, "comment_id": 90657823, "body": "Thanks, I noticed that I had a few mispellings in my code other than that. The word category is apparently not the easiest to type over and over. Thanks alot."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1534283158, "last_edit_date": 1534283158, "creation_date": 1534280410, "answer_id": 51849696, "question_id": 51849389, "link": "https://stackoverflow.com/questions/51849389/trying-to-render-categories-in-my-product-view-in-rails/51849696#51849696", "title": "Trying to render categories in my product view in rails", "body": "<p>If what you really want is a one-to-one association between products and categories you need to set it up properly:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  belongs_to :category\n  # ...\nend\n\nclass Category &lt; ActiveRecord::Base\n  has_many :products\n  # ...\nend\n</code></pre>\n\n<p>Proper pluralization is really important in Rails. </p>\n\n<p>Its only you want to instead have a many to many association (a product can belong to many categories) that you need a join table:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  has_many :product_categories\n  has_many :categories, through: :product_categories\n  # ...\nend\n\n# the join table\nclass ProductCategory  &lt; ActiveRecord::Base\n  belongs_to :product\n  belongs_to :category\nend\n\nclass Category &lt; ActiveRecord::Base\n  has_many :product_categories\n  has_many :products, through: :product_categories\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5224838, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207407333846429/picture?type=large", "display_name": "Jonathan V Britannia", "link": "https://stackoverflow.com/users/5224838/jonathan-v-britannia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 51849696, "answer_count": 1, "score": 0, "last_activity_date": 1534283158, "creation_date": 1534278885, "last_edit_date": 1534281887, "question_id": 51849389, "link": "https://stackoverflow.com/questions/51849389/trying-to-render-categories-in-my-product-view-in-rails", "title": "Trying to render categories in my product view in rails", "body": "<p>I'm trying to render on my product show/index page what category a specific product belongs to. I don't know if I need to create a join table or if the way that I have set up the models is good enough. I've linked my product model and controllers, and have done the same for my categories.</p>\n\n<p>Product.rb</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n has_many :orders\n belongs_to :categories\n validates :name, :price, presence: true\n mount_uploader :image, ImageUploader\nend\n</code></pre>\n\n<p>Categories.rb</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n has_many :products\n has_many :users, through: :categories\n validates :name, presence: true\n TITLE = %w{ Electronics Home Garden Lifestyle }\nend\n</code></pre>\n\n<p>Categories_controller.rb</p>\n\n<pre><code>   class CategoriesController &lt; ApplicationController\n      before_action :set_category, only: [:show, :edit, :update, :destroy]\n\n    def index\n      @categories = Category.all\n      @products = Product.all.order(\"created_at desc\")\n    end\n\n    def show\n      @products = Product.where(\"category_id = ?\", @product.id)\n      @categories = Category.all\n    end\n\n    def new\n      @catgories = Category.new\n    end\n\n    def create\n      @category = Category.new(category_params)\n\n      respond_to do |format|\n        if @category.save(category_params)\n          format.html { redirect_to categories_path, notice: 'Category was successfully created.' }\n          format.json { render :show, status: :created, location: @category }\n        else\n          format.html {render :new, notice: \"Category failed to be created\" }\n          format.json { render json: @category.errors, status: :unprocessable_entity}\n        end\n      end\n    end\n\n    def electronics\n    end\n\n    def home\n    end\n\n    def update\n      @category = Category.new(category_params)\n\n      respond_to do |format|\n        if @category.update(category_params)\n          format.html { redirect_to categories_path, notice: 'Category was successfully updated.' }\n          format.json { render :show, status: :ok, location: @category }\n        else\n          format.html {render :edit, notice: \"Category failed to be updated\" }\n          format.json { render json: @category.errors, status: :unprocessable_entity}\n        end\n      end\n    end\n\n    def destroy \n      @category.destroy\n      respond_to do |format|\n        format.html { redirect_to categories_path, notice: \"Category has been deleted\" }\n        format.json { head :no_content }\n      end\n    end\n\n\n    private\n\n    def set_category\n      @category = Category.find(params[:id])\n    end\n\n    def category_params\n      params.require(:category).permit(:title)\n    end\n\n  end\n</code></pre>\n\n<p>products_controller.rb</p>\n\n<pre><code> class ProductsController &lt; ApplicationController\n      before_action :set_product, only: [:show, :edit, :update, :destroy]\n      before_action :category_order, only: [:index, :show, :edit, :new]\n      before_action :products_order, only: [:index, :show]\n      before_action :authenticate_user!, except: [:index, :show]\n\n      # GET /products\n      # GET /products.json\n      def index\n        @products = Product.all\n      end\n\n      # GET /products/1\n      # GET /products/1.json\n      def show\n      end\n\n      # GET /products/new\n      def new\n        @product = Product.new\n      end\n\n      # GET /products/1/edit\n      def edit\n      end\n\n      # POST /products\n      # POST /products.json\n      def create\n        @product = Product.new(product_params)\n\n        respond_to do |format|\n          if @product.save\n            format.html { redirect_to @product, notice: 'Product was successfully created.' }\n            format.json { render :show, status: :created, location: @product }\n          else\n            format.html { render :new, notice: \"Product could not be saved\" }\n            format.json { render json: @product.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n\n      # PATCH/PUT /products/1\n      # PATCH/PUT /products/1.json\n      def update\n        respond_to do |format|\n          if @product.update(product_params)\n            format.html { redirect_to @product, notice: 'Product was successfully updated.' }\n            format.json { render :show, status: :ok, location: @product }\n          else\n            format.html { render :edit, notice:\"Product could not be updated\" }\n            format.json { render json: @product.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n\n      # DELETE /products/1\n      # DELETE /products/1.json\n      def destroy\n        @product.destroy\n        respond_to do |format|\n          format.html { redirect_to products_url, notice: 'Product was successfully destroyed.' }\n          format.json { head :no_content }\n        end\n      end\n\n      private\n        # Use callbacks to share common setup or constraints between actions.\n        def set_product\n          @product = Product.find(params[:id])\n        end\n\n        # Never trust parameters from the scary internet, only allow the white list through.\n        def product_params\n          params.require(:product).permit(:name, :price, :image, :category_id, :description)\n        end\n\n        def products_order\n          @products = Product.all.order(\"created_at desc\")\n        end\n\n        #category\n\n        def category_order\n          @categories = Category.all.order(\"created_at desc\")\n        end\n    end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 560, "user_id": 6317812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YfWu.jpg?s=128&g=1", "display_name": "Dmitry Shvetsov", "link": "https://stackoverflow.com/users/6317812/dmitry-shvetsov"}, "edited": false, "score": 0, "creation_date": 1534319136, "post_id": 51848944, "comment_id": 90661872, "body": "Can you explain how <code>A.get_d</code> breaks backward compatibility in your code?"}], "answers": [{"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1534282590, "post_id": 51849267, "comment_id": 90653423, "body": "That is problem. C does not exist in current namespace but I want it available on the current namespace."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1534296258, "post_id": 51849267, "comment_id": 90656320, "body": "I got so used to with the requirements by Rails that it only autoloads if module and class names correspond with file and directory names that I almost forgot that you can place a module and class inside a file without the need to name it after the subdirectory of files in pure ruby."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1534278331, "creation_date": 1534278331, "answer_id": 51849267, "question_id": 51848944, "link": "https://stackoverflow.com/questions/51848944/make-nested-modules-available-globally/51849267#51849267", "title": "Make nested modules available globally", "body": "<p>There is no such thing as a \"nested module\". It's just a module that is assigned to a namespaced constant. If you want to assign to a different constant \u2026 just assign it to a different constant:</p>\n\n<pre><code>C::D = A::B::C::D\n</code></pre>\n\n<p>Note: this assumes that a constant named <code>C</code> exists in the current namespace and that it refers to a module or class. However, that assumption is already present in your question.</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534278331, "creation_date": 1534276775, "question_id": 51848944, "link": "https://stackoverflow.com/questions/51848944/make-nested-modules-available-globally", "title": "Make nested modules available globally", "body": "<p>Given I have the following data structure:</p>\n\n<pre><code>module A\n  module B\n    module C\n      class D\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I want to access it in client code like this:</p>\n\n<pre><code>C::D \n</code></pre>\n\n<p>rather than </p>\n\n<pre><code>A::B::C::D\n</code></pre>\n\n<p>One solution would be to define a method in module A like this:</p>\n\n<pre><code>module A\n  def self.get_d\n    B::C::D\n  end\nend\n\nA.get_d\n</code></pre>\n\n<p>But the thing is that C::D is defined in many places already in system. So I need to be backward compatible. How can I address this situation?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1534279590, "post_id": 51848694, "comment_id": 90652273, "body": "<code>&#39;c,&#39;</code>. Is that a typo?"}, {"owner": {"reputation": 10050, "user_id": 431874, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/IJ6HK.png?s=128&g=1", "display_name": "Tom Rossi", "link": "https://stackoverflow.com/users/431874/tom-rossi"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1534279864, "post_id": 51848694, "comment_id": 90652395, "body": "Yep, thanks @SagarPandya"}], "answers": [{"tags": [], "owner": {"reputation": 10050, "user_id": 431874, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/IJ6HK.png?s=128&g=1", "display_name": "Tom Rossi", "link": "https://stackoverflow.com/users/431874/tom-rossi"}, "is_accepted": false, "score": 0, "last_activity_date": 1534277818, "creation_date": 1534277818, "answer_id": 51849148, "question_id": 51848694, "link": "https://stackoverflow.com/questions/51848694/synchronizing-two-arrays/51849148#51849148", "title": "Synchronizing two arrays", "body": "<p>It ain't pretty!</p>\n\n<pre><code>def array_compare(arr1, arr2)\n  arr2 = arr2.clone\n  add_to = []\n  arr1.each do |el|\n    if index = arr2.index(el)\n      arr2.delete_at(index)\n    else\n      add_to &lt;&lt; el\n    end\n  end\n  return add_to\nend\n\n-&gt; arr1 = ['a', 'a', 'a', 'b', 'c,', 'f']\n[\"a\", \"a\", \"a\", \"b\", \"c,\", \"f\"]\n\n-&gt; arr2 = ['a', 'b', 'b', 'c,', 'd']\n[\"a\", \"b\", \"b\", \"c,\", \"d\"]\n\n-&gt; array_compare(arr1, arr2)\n[\"a\", \"a\", \"f\"]\n\n-&gt; array_compare(arr2, arr1)\n[\"b\", \"d\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1534282342, "creation_date": 1534282342, "answer_id": 51850058, "question_id": 51848694, "link": "https://stackoverflow.com/questions/51848694/synchronizing-two-arrays/51850058#51850058", "title": "Synchronizing two arrays", "body": "<p>Here an implementation of <a href=\"https://stackoverflow.com/questions/4595305/delete-first-instance-of-matching-element-from-array/5768245\">TNT's elegant solution</a> for deleting the first matching element of an array</p>\n\n<pre><code>class Array\n  def delete_first item\n    delete_at(index(item) || length)\n  end\n  def distinct other, own = self.dup\n    other.each{|e| own.delete_first(e)}\n    own\n  end\nend\n\narr1.distinct arr2 # [\"a\", \"a\", \"f\"]\narr2.distinct arr1 # [\"b\", \"d\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "edited": false, "score": 0, "creation_date": 1534285906, "post_id": 51850087, "comment_id": 90654406, "body": "<code>h1</code> could also be written as <code>Hash[arr1.map { |v| [v, arr1.count(v)] }]</code>"}], "tags": [], "owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "is_accepted": false, "score": 0, "last_activity_date": 1534282489, "creation_date": 1534282489, "answer_id": 51850087, "question_id": 51848694, "link": "https://stackoverflow.com/questions/51848694/synchronizing-two-arrays/51850087#51850087", "title": "Synchronizing two arrays", "body": "<p>Here's one approach:</p>\n\n<ol>\n<li>Count all occurrences in each array, and store in 2 hashes</li>\n<li>Iterate through hash 1 and compare each count to hash 2</li>\n<li>Output an array item for each additional count in hash 1</li>\n<li>Flatten and output</li>\n</ol>\n\n<p>Implementation:</p>\n\n<pre><code>h1 = arr1.inject(Hash.new(0)) { |total, e| total[e] += 1 ;total }\n# =&gt; {\"a\"=&gt;3, \"b\"=&gt;1, \"c\"=&gt;1, \"f\"=&gt;1\nh2 = arr2.inject(Hash.new(0)) { |total, e| total[e] += 1 ;total }\n# =&gt; {\"a\"=&gt;1, \"b\"=&gt;2, \"c\"=&gt;1, \"d\"=&gt;1}\n\nh1.map { |k, v| [k] * [v - h2[k], 0].max }.flatten\n# =&gt; [\"a\", \"a\", \"f\"]\nh2.map { |k, v| [k] * [v - h1[k], 0].max }.flatten\n# =&gt; [\"b\", \"d\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1081, "user_id": 1288687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217dd12520210182c093856f60cd376?s=128&d=identicon&r=PG", "display_name": "knugie", "link": "https://stackoverflow.com/users/1288687/knugie"}, "is_accepted": false, "score": 0, "last_activity_date": 1534285198, "creation_date": 1534285198, "answer_id": 51850510, "question_id": 51848694, "link": "https://stackoverflow.com/questions/51848694/synchronizing-two-arrays/51850510#51850510", "title": "Synchronizing two arrays", "body": "<p>When allowing duplicates, Ruby's regular Array arithmetic is pretty much useless.\nTry removing elements individually:</p>\n\n<pre><code># Original example\narr1 = ['a', 'a', 'a', 'b', 'c', 'f']\narr2 = ['a', 'b', 'b', 'c', 'd']\n\n# Removing elements from arr1 that exist in arr2 (\"arr1 - arr2\")\narr1wo2 = arr1.dup\narr2.each { |val| arr1wo2.delete_at(arr1wo2.index(val) || arr1wo2.length) }\narr1wo2  # =&gt; [\"a\", \"a\", \"f\"]\n\n# Removing elements from arr2 that exist in arr1 (\"arr2 - arr1\")\narr2wo1 = arr2.dup\narr1.each { |val| arr2wo1.delete_at(arr2wo1.index(val) || arr2wo1.length) }\narr2wo1  # =&gt; [\"b\", \"d\"]\n</code></pre>\n\n<p>I hope you find that helpful.</p>\n"}], "owner": {"reputation": 10050, "user_id": 431874, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/IJ6HK.png?s=128&g=1", "display_name": "Tom Rossi", "link": "https://stackoverflow.com/users/431874/tom-rossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1534302275, "accepted_answer_id": 51850058, "answer_count": 4, "score": 1, "last_activity_date": 1534302165, "creation_date": 1534275581, "last_edit_date": 1534302165, "question_id": 51848694, "link": "https://stackoverflow.com/questions/51848694/synchronizing-two-arrays", "closed_reason": "Duplicate", "title": "Synchronizing two arrays", "body": "<p>I am comparing arrays for the purpose of synchronizing. With the </p>\n\n<pre><code>arr1 = ['a', 'a', 'a', 'b', 'c', 'f']\narr2 = ['a', 'b', 'b', 'c', 'd']\n</code></pre>\n\n<p>I can't figure out how to synchronize these arrays. I have to figure out what elements would need to be added to one array while keeping in mind that duplicates are allowed. I need the distinct elements in <code>arr1</code> but not in <code>arr2</code>:</p>\n\n<pre><code>['a', 'a', 'f']\n</code></pre>\n\n<p>or the distinct elements in <code>arr2</code> but not in <code>arr1</code>:</p>\n\n<pre><code>['b', 'd']\n</code></pre>\n\n<p>Unfortunately, that isn't the way the <code>-</code> function works with arrays:</p>\n\n<pre><code>arr1 - arr2 # =&gt;  ['f']\narr2 - arr1 # =&gt;  ['d']\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "bootstrap-4", "simple-form"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1534275075, "post_id": 51848531, "comment_id": 90650374, "body": "Sounds like the intended behavior. What is the question?"}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 4713952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb7f02afcdd768e71b03eb8a2b0ebb0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lockard", "link": "https://stackoverflow.com/users/4713952/jacob-lockard"}, "edited": false, "score": 0, "creation_date": 1534336772, "post_id": 51851167, "comment_id": 90669775, "body": "Yay! This is perfect. I do have one question, though. How come the file has a comment at the top saying not to edit it directly?"}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "reply_to_user": {"reputation": 798, "user_id": 4713952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb7f02afcdd768e71b03eb8a2b0ebb0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lockard", "link": "https://stackoverflow.com/users/4713952/jacob-lockard"}, "edited": false, "score": 0, "creation_date": 1534374207, "post_id": 51851167, "comment_id": 90686977, "body": "It&#39;s recommended to follow their <a href=\"https://github.com/plataformatec/simple_form#custom-components\" rel=\"nofollow noreferrer\">guide</a> for creating custom wrappers (by creating seperate component files and including them in the intializer). However, in your case, you want to remove the default class (<code>is-valid</code>) globally, so editing the initializer directly is fine."}], "tags": [], "owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "is_accepted": true, "score": 5, "last_activity_date": 1534291973, "last_edit_date": 1534291973, "creation_date": 1534290723, "answer_id": 51851167, "question_id": 51848531, "link": "https://stackoverflow.com/questions/51848531/rails-simple-form-gem-is-adding-a-green-border-to-inputs-that-are-pre-populated/51851167#51851167", "title": "Rails simple_form gem is adding a green border to inputs that are pre-populated", "body": "<p>In <code>config/initializers/simple_form_bootstrap.rb</code> you have a few different blocks that start with <code>config.wrapper</code>. You can remove any reference to <code>valid_class: 'is-valid'</code> from them so that it is no longer included in your form inputs. i.e....</p>\n\n<p>Change this</p>\n\n<pre><code>config.wrappers :vertical_form, tag: 'div', class: 'form-group', error_class: 'form-group-invalid', valid_class: 'form-group-valid' do |b|\n  ...\n  b.use :input, class: 'form-control', error_class: 'is-invalid', valid_class: 'is-valid'\n  ...\nend\n</code></pre>\n\n<p>To this (by removing <code>valid_class</code>)</p>\n\n<pre><code>config.wrappers :vertical_form, tag: 'div', class: 'form-group', error_class: 'form-group-invalid' do |b|\n  ...\n  b.use :input, class: 'form-control', error_class: 'is-invalid'\n  ...\nend\n</code></pre>\n\n<p>And you can remove references to <code>error_class</code> as well if you don't want that included.</p>\n"}], "owner": {"reputation": 798, "user_id": 4713952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb7f02afcdd768e71b03eb8a2b0ebb0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lockard", "link": "https://stackoverflow.com/users/4713952/jacob-lockard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 0, "accepted_answer_id": 51851167, "answer_count": 1, "score": 3, "last_activity_date": 1534291973, "creation_date": 1534274865, "question_id": 51848531, "link": "https://stackoverflow.com/questions/51848531/rails-simple-form-gem-is-adding-a-green-border-to-inputs-that-are-pre-populated", "title": "Rails simple_form gem is adding a green border to inputs that are pre-populated", "body": "<p>I am having a problem with the rails simple_form gem. I am using bootstrap 4 along with it.</p>\n\n<p>I have installed the gem by adding <code>gem 'simple_form'</code> to the Gemfile. I have also run the generator via <code>rails g simple_form:install --bootstrap</code>.</p>\n\n<p>Simple Form works almost perfectly in my app. Here is an example using a model called 'Store' that has one string attribute: 'name'.</p>\n\n<pre><code>&lt;%= simple_form_for @store do |f| %&gt;\n  &lt;%= f.input :name %&gt;\n  &lt;%= f.button :submit, class: \"btn-primary\" %&gt;\n  &lt;%= link_to \"Cancel\", stores_url, class: %w[btn btn-danger] %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The only problem I'm having with this code is that when the form is used for the update page, simple_form adds an '.is-valid' class to the input element which causes bootstrap to add a green border to the field. This does not happen when the field is not pre-filled such as when using the form for the 'new' action.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-s3"], "comments": [{"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 2, "creation_date": 1534285148, "post_id": 51848392, "comment_id": 90654204, "body": "How did you verify that your credentials are valid? Show your code on how you are using the credentials. The key with STS temporary credentials is to pass the security token correctly. Also, make sure that you are not using Root credentials in the call to Assume Role."}, {"owner": {"reputation": 766, "user_id": 2671192, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Xkv5l.jpg?s=128&g=1", "display_name": "Haider Ali", "link": "https://stackoverflow.com/users/2671192/haider-ali"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1534289889, "post_id": 51848392, "comment_id": 90655257, "body": "I am using chrome S3 Browser extension to upload and view files, also make sure connecting in terminal with those credentials but they aren&#39;t working ....  Yes I am not using root credentials in the call to assume role instead I am using IAM user credentials"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 1, "creation_date": 1534300895, "post_id": 51848392, "comment_id": 90657132, "body": "<i>&quot;The specified access and security key are invalid.&quot;</i>  Where do you see this?  This does not sound like a standard AWS error message, and there&#39;s no such thing as a &quot;security key.&quot;"}, {"owner": {"reputation": 766, "user_id": 2671192, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Xkv5l.jpg?s=128&g=1", "display_name": "Haider Ali", "link": "https://stackoverflow.com/users/2671192/haider-ali"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1534333390, "post_id": 51848392, "comment_id": 90668138, "body": "@Michael-sqlbot &quot;The specified access and security key are invalid.&quot; I am seeing this message in google chrome extension when I use newly created credentials."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1534334092, "post_id": 51848392, "comment_id": 90668500, "body": "It&#39;s confusing to me that when I google that phrase, in quotes, I find exactly one hit -- this question.  I am unfamiliar with the browser extension (though it sounds interesting) but note that the access key and secret from STS are indeed invalid unless the security token is also used with them.  Does this extension accept all three values?  If not, it is only compatible with IAM user credentials, not STS temporary credentials."}, {"owner": {"reputation": 766, "user_id": 2671192, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Xkv5l.jpg?s=128&g=1", "display_name": "Haider Ali", "link": "https://stackoverflow.com/users/2671192/haider-ali"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1534344908, "post_id": 51848392, "comment_id": 90674512, "body": "@Michael-sqlbot Now I tried using access_key, access_secret and session_token to upload file via <code>aws-sdk</code> gem in ruby not I get this error message <b>AWS::S3::Errors::InvalidAccessKeyId The AWS Access Key Id you provided does not exist in our records</b>"}], "owner": {"reputation": 766, "user_id": 2671192, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Xkv5l.jpg?s=128&g=1", "display_name": "Haider Ali", "link": "https://stackoverflow.com/users/2671192/haider-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534345210, "creation_date": 1534274239, "last_edit_date": 1534345210, "question_id": 51848392, "link": "https://stackoverflow.com/questions/51848392/awss3errorsinvalidaccesskeyid-security-token-service-credentials-are-not-w", "title": "AWS::S3::Errors::InvalidAccessKeyId Security Token Service Credentials are not working", "body": "<p>I am using <strong>Security Token Service</strong> to generate credentials <code>access_key_id</code> and <code>secret_access_key</code> to pass it to the client side. I am able to generate credentials successfully. But, when I use dynamically generated credentials I got this error</p>\n\n<pre><code>AWS::S3::Errors::InvalidAccessKeyId The AWS Access Key Id you provided does not exist in our records\n</code></pre>\n\n<p>Followings are the steps I have used to generate credentials with Security Token Service</p>\n\n<p><strong>Create Role</strong><br>\nI have created a role on AWS with following policy (to list and upload files on AWS S3 bucket)</p>\n\n<pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": \"s3:ListBucket\",\n            \"Resource\": \"arn:aws:s3:::&lt;bucket_name&gt;\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\"\n            ],\n            \"Resource\": \"arn:aws:s3:::&lt;bucket_name&gt;/*\"\n        }\n    ]\n}\n</code></pre>\n\n<p><strong>Edit Trust Relationship</strong>\nI have edited trust relationship to assign role to the <code>IAM</code> user</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::&lt;account_id&gt;:user/&lt;user_name&gt;\"\n      },\n      \"Action\": \"sts:AssumeRole\",\n      \"Condition\": {}\n    }\n  ]\n}\n</code></pre>\n\n<p><strong>How I am generating credentials</strong></p>\n\n<pre><code>sts = Aws::STS::Client.new\nsession = sts.assume_role(role_arn: 'arn:aws:iam::&lt;account_id&gt;:role/&lt;role_name&gt;', role_session_name: 'test_session')\n@aws_access_key_id = session.credentials.access_key_id\n@aws_secret_access_key = session.credentials.secret_access_key\n@aws_security_token = session.credentials.session_token\n@expires_at = session.credentials.expiration\n</code></pre>\n\n<p>I am able to generated credentials but credentials are invalid. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "chef-infra", "cookbook"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1534274899, "creation_date": 1534274899, "answer_id": 51848540, "question_id": 51848305, "link": "https://stackoverflow.com/questions/51848305/how-to-update-the-file-with-multiple-lines-without-deleting-the-contents-of-the/51848540#51848540", "title": "How to update the file with multiple lines without deleting the contents of the original file using chef recipe", "body": "<p>The <code>file</code> resource is for managing the whole file at once as you\u2019ve noticed. We recommend not doing partial file updates as it leads to very brittle Chef core but if you must, check out the <code>poise-file</code> and <code>line</code> cookbooks.</p>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 1343713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036b528d6c1a4dcda835bcb30abd32fe?s=128&d=identicon&r=PG", "display_name": "Neal", "link": "https://stackoverflow.com/users/1343713/neal"}, "is_accepted": false, "score": 0, "last_activity_date": 1535437655, "creation_date": 1535437655, "answer_id": 52051405, "question_id": 51848305, "link": "https://stackoverflow.com/questions/51848305/how-to-update-the-file-with-multiple-lines-without-deleting-the-contents-of-the/52051405#52051405", "title": "How to update the file with multiple lines without deleting the contents of the original file using chef recipe", "body": "<p>as @coderander mentioned it's not recommended to do that in chef, as its better to manage the whole file in Chef.</p>\n\n<p>However if you have to, which is sometimes the case, you can achieve it this way:</p>\n\n<pre><code>bash 'append line(s) to file if it doesnt exist' do\n  user 'user'\n  code &lt;&lt;-EOS\n    cat &gt;&gt;/home/file &lt;&lt;EOL\n      *.* @@172.167.189.67:514\n      EOL\n    EOS\n  not_if \"grep -q 172.167.189.67 /home/file\"\nend\n</code></pre>\n\n<p>you may need to run <code>cookstyle</code> on that ^</p>\n"}], "owner": {"reputation": 21, "user_id": 10176096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02c7bd646292adbc758ef796d7f7573?s=128&d=identicon&r=PG&f=1", "display_name": "Anish", "link": "https://stackoverflow.com/users/10176096/anish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535437655, "creation_date": 1534273775, "question_id": 51848305, "link": "https://stackoverflow.com/questions/51848305/how-to-update-the-file-with-multiple-lines-without-deleting-the-contents-of-the", "title": "How to update the file with multiple lines without deleting the contents of the original file using chef recipe", "body": "<p>I would like to append my file /var/rsyslog.conf file with the following lines without having to delete my existing file.</p>\n\n<p>Lines to include in the file are </p>\n\n<pre><code>*************\n#audit log\n$ModLoad imfile\n$InputFileName /var/log/audit/audit.log\n$InputFileTag tag_audit_log:\n$InputFileStateFile audit_log\n$InputFileSeverity info\n$InputFileFacility local6\n$InputRunFileMonitor\n*.* @@172.167.189.67:514\n*************\n</code></pre>\n\n<p>In the recipe I gave the following as a file resourse</p>\n\n<pre><code>****\nfile '/etc/rsyslog.conf' do\n    content ' #audit log\n    $ModLoad imfile\n    $InputFileName /var/log/audit/audit.log\n    $InputFileTag tag_audit_log:\n    $InputFileStateFile audit_log\n    $InputFileSeverity info\n    $InputFileFacility local6\n    $InputRunFileMonitor'\n    *.* @@172.167.189.67:514 --&gt; #This value needs to be dynamically changed using String Intepolation\n    mode '0644'\n    owner 'root'\n    group 'root'\nend\n****\n</code></pre>\n\n<p>Although it updated the file, it only has the above lines and all other file contents are now disappeared </p>\n\n<p>I tried creating a new template file with the .erb extension which incidentally also does the same. Inserts the contents but deletes the older file contents.</p>\n\n<p>What would be the suggested way to append the file along with attribute value interpolation.</p>\n\n<p>Use Case:</p>\n\n<p>Attribute.rb file</p>\n\n<p>default['serverIP']['hostname'] = \"172.167.189.67:514\"\nThis Attribute value will be dynamic and will change periodically.</p>\n\n<p>I would like to use interpolate this in either the file or template so it picks the value provided in the attribute file.</p>\n\n<p>What is the easiest way of achieving this???</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "ruby-2.5"], "answers": [{"comments": [{"owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "edited": false, "score": 0, "creation_date": 1534274211, "post_id": 51848239, "comment_id": 90650038, "body": "hmm, that makes sense."}, {"owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "edited": false, "score": 0, "creation_date": 1534274944, "post_id": 51848239, "comment_id": 90650339, "body": "I omitted the raise part of the code as I dont mind someone passing non existent keys to the method."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 2, "last_activity_date": 1534273489, "creation_date": 1534273489, "answer_id": 51848239, "question_id": 51848130, "link": "https://stackoverflow.com/questions/51848130/splat-operator-on-hash-for-keyword-arguments-in-ruby-method-definition/51848239#51848239", "title": "splat operator on hash for keyword arguments in ruby method definition", "body": "<p>Yeah... that's not a thing you can do.</p>\n\n<p><code>**foo</code> in an argument list is how you <em>collect</em> a kwargs hash, so it can't also be how you inject one.</p>\n\n<p>More importantly, the main point of kwargs is that they explode the hash into local variables -- that can't work if it's expanding a hash at runtime.</p>\n\n<p>The closest you could get would be something like:</p>\n\n<pre><code>def initialize(**values)\n  values = DEFAULTS.merge(values)\n  raise \"...\" unless (values.keys - DEFAULTS.keys).empty?\n  @a = values[:a]\n  @b = values[:b]\nend\n</code></pre>\n"}], "owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 51848239, "answer_count": 1, "score": 1, "last_activity_date": 1534352026, "creation_date": 1534273022, "last_edit_date": 1534352026, "question_id": 51848130, "link": "https://stackoverflow.com/questions/51848130/splat-operator-on-hash-for-keyword-arguments-in-ruby-method-definition", "title": "splat operator on hash for keyword arguments in ruby method definition", "body": "<p>I have a class like this:</p>\n\n<pre><code>class AwesomeService\n  attr_reader :a, :b\n\n  def initialize(a: 30, b: 40)\n    @a = a\n    @b = b\n  end\nend\n</code></pre>\n\n<p>I am trying to do something like this:</p>\n\n<pre><code>class AwesomeService\n  DEFAULTS = {\n    a: 30,\n    b: 40\n  }\n\n  attr_reader *DEFAULTS.keys\n\n  def initialize(**DEFAULTS)\n    @a = a\n    @b = b\n  end\nend\n</code></pre>\n\n<p>so that I can keep the defaults in a separate hash.</p>\n\n<p>But I am getting the error:</p>\n\n<pre><code>SyntaxError ((irb): syntax error, unexpected tCONSTANT, expecting ')')\n  def initialize(**DEFAULTS)\n                   ^~~~~~~~\n</code></pre>\n\n<p>It seems like the splat operator in the initialize is not working as I expected. But it seems to be the logical way of doing that. What am I doing wrong here?</p>\n"}, {"tags": ["ruby", "memoization"], "answers": [{"comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534270457, "post_id": 51847499, "comment_id": 90648408, "body": "I&#39;d be nervous about the thread-safety of all of these, but especially so the last one."}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534271522, "post_id": 51847499, "comment_id": 90648847, "body": "Nifty trick with the first one. So the array automatically gets converted to a string? What&#39;s the issue with threading, exactly? What can go wrong? Two different cache data structures will be built?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1534271977, "post_id": 51847499, "comment_id": 90649064, "body": "No, the array isn&#39;t automatically converted into a string. There is no need to do that. Because every object can be used as a hash key: symbols, integer, or even huge complex data structures."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534272141, "post_id": 51847499, "comment_id": 90649140, "body": "In general at best you could have multiple threads calculating the same value... but with the nested hash form one call could clear out a different width&#39;s calculation [for the same length], for example."}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534273054, "post_id": 51847499, "comment_id": 90649513, "body": "I did some benchmarking. My original function with the join is twice as fast as using an object for a key."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 3, "last_activity_date": 1534270418, "creation_date": 1534270418, "answer_id": 51847499, "question_id": 51847274, "link": "https://stackoverflow.com/questions/51847274/memoizing-functions-with-multiple-parameters-in-ruby/51847499#51847499", "title": "Memoizing functions with multiple parameters in Ruby", "body": "<p>You can use the array directly:</p>\n\n<pre><code>def area(length, width)\n  key = [length, width]\n  if @cache[key]\n    puts 'cache hit!'\n    return @cache[key]\n  end\n  @cache[key] = length * width\nend\n</code></pre>\n\n<p>Or use nested hashes:</p>\n\n<pre><code>def area(length, width)\n  c = (@cache[length] ||= {})\n  if c[width]\n    puts 'cache hit!'\n    return c[width]\n  end\n  c[width] = length * width\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534273229, "post_id": 51847503, "comment_id": 90649607, "body": "Let&#39;s say I change the function to accept three arguments. Is there a good way to automate the generation of the key?"}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534273470, "post_id": 51847503, "comment_id": 90649716, "body": "Your code is 2x faster than my code even with print statement stripped out."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 1, "creation_date": 1534273514, "post_id": 51847503, "comment_id": 90649737, "body": "You mean if you used common named arguments, but do not want to list them all? There might be a way: See this <a href=\"https://stackoverflow.com/a/31234292/2483313\">answer</a>. But would use it..."}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534274298, "post_id": 51847503, "comment_id": 90650063, "body": "I guess hard-coded it shall be. That looks ugly. Is there a Ruby gem that handles multiple parameter memoization?"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534318865, "post_id": 51847503, "comment_id": 90661779, "body": "If performance is an issue, hashing the arguments and using an integer for a key would be far better. Something like <code>length.hash ^ width.hash</code>. It could also be easily adapted to handle variable number of arguments: <code>args.inject { |r, n | r ^ n.hash }</code>. The likelihood of a hash collision would be super rare. You could always throw in a prime number to reduce those odds even more."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 11, "last_activity_date": 1534273373, "last_edit_date": 1534273373, "creation_date": 1534270447, "answer_id": 51847503, "question_id": 51847274, "link": "https://stackoverflow.com/questions/51847274/memoizing-functions-with-multiple-parameters-in-ruby/51847503#51847503", "title": "Memoizing functions with multiple parameters in Ruby", "body": "<p>When you do not need to print <code>Cache hit!</code> than I would do something like this:</p>\n\n<pre><code>def area(length, width)\n  @cache ||= {}\n  @cache[\"#{length},#{width}\"] ||= length * width\nend\n</code></pre>\n\n<p>Or if you need some output, but a <code>Cache miss!</code> is fine too:</p>\n\n<pre><code>def area(length, width)\n  @cache ||= {}\n\n  @cache.fetch(\"#{length},#{width}\") do |key| \n    puts 'Cache miss!'\n    @cache[key] = length * width\n  end\nend\n</code></pre>\n\n<p>If you want to accept even more arguments you might want to use something like this:</p>\n\n<pre><code>def area(*args)\n  @cache ||= {}\n  @cache[args] ||= args.inject(:*)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2936, "user_id": 658651, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e2032cf85e31e19a6758b193782d686?s=128&d=identicon&r=PG", "display_name": "svoop", "link": "https://stackoverflow.com/users/658651/svoop"}, "is_accepted": false, "score": 0, "last_activity_date": 1582290657, "last_edit_date": 1582290657, "creation_date": 1582289769, "answer_id": 60339113, "question_id": 51847274, "link": "https://stackoverflow.com/questions/51847274/memoizing-functions-with-multiple-parameters-in-ruby/60339113#60339113", "title": "Memoizing functions with multiple parameters in Ruby", "body": "<p>On <strong>Ruby 2.7 and up</strong>, positional arguments and keyword arguments are isolated which has an impact on how to implement multi-argument memoization. For a generic implementation, I'd do something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def my_method(*args, **kwargs)\n  (@my_method_cache ||= {})[args.hash ^ kwargs.hash] ||= begin\n    (...)\n  end\nend\n</code></pre>\n\n<p>Replace <code>(...)</code> with the expensive calculation done by <code>my_method</code>.</p>\n"}], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 2, "accepted_answer_id": 51847503, "answer_count": 3, "score": 3, "last_activity_date": 1582290657, "creation_date": 1534269465, "question_id": 51847274, "link": "https://stackoverflow.com/questions/51847274/memoizing-functions-with-multiple-parameters-in-ruby", "title": "Memoizing functions with multiple parameters in Ruby", "body": "<p>I'm wondering if there is a more \"Ruby-like\" way to memoize functions with multiple parameters in Ruby. Here's a way that I came up with that works but not sure if it's the best approach:</p>\n\n<pre><code>@cache = {}\ndef area(length, width)  #Just an example, caching is worthless for this simple function\n  key = [length.to_s, width.to_s].join(',')\n  if @cache[key]\n    puts 'cache hit!'\n    return @cache[key]\n  end\n  @cache[key] = length * width\nend\n\nputs area 5, 3\nputs area 5, 3\nputs area 4, 3\nputs area 3, 4\nputs area 4, 3\n</code></pre>\n\n<p>The parameters are joined with a comma which is then used as a key for storage in the <code>@cache</code> variable.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1534269441, "post_id": 51847068, "comment_id": 90647901, "body": "You could write a simple spec that runs <code>rails db:seed</code> and write expectations about the return value and maybe the database mutations that occur."}, {"owner": {"reputation": 516, "user_id": 4137155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41ea7b6f094186456e12d882ac5e9a2?s=128&d=identicon&r=PG", "display_name": "Sigu Magwa", "link": "https://stackoverflow.com/users/4137155/sigu-magwa"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1534269617, "post_id": 51847068, "comment_id": 90647993, "body": "How do you run <code>rails db:seed </code> from within rspec tests? I am aware of using FactoryBot but not seed files"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1534269721, "post_id": 51847068, "comment_id": 90648049, "body": "<code>expect(system(&quot;rails db:seed&quot;)).to be_truthy</code> - see <a href=\"https://stackoverflow.com/questions/6338908/ruby-difference-between-exec-system-and-x-or-backticks\" title=\"ruby difference between exec system and x or backticks\">stackoverflow.com/questions/6338908/&hellip;</a> for plenty of other options on how to run it."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1534270052, "post_id": 51847068, "comment_id": 90648229, "body": "There are also more fancy ways of testing rake tasks (<code>&quot;rails db:seed&quot;</code> is really just an alias of &quot;rake db:seed&quot;). <a href=\"https://robots.thoughtbot.com/test-rake-tasks-like-a-boss\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/test-rake-tasks-like-a-boss</a>"}], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 4137155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41ea7b6f094186456e12d882ac5e9a2?s=128&d=identicon&r=PG", "display_name": "Sigu Magwa", "link": "https://stackoverflow.com/users/4137155/sigu-magwa"}, "edited": false, "score": 0, "creation_date": 1534269066, "post_id": 51847155, "comment_id": 90647702, "body": "Will it stop the the pipeline from moving to the next step if it fails?"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 516, "user_id": 4137155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41ea7b6f094186456e12d882ac5e9a2?s=128&d=identicon&r=PG", "display_name": "Sigu Magwa", "link": "https://stackoverflow.com/users/4137155/sigu-magwa"}, "edited": false, "score": 1, "creation_date": 1534269220, "post_id": 51847155, "comment_id": 90647798, "body": "Yes, if it encounters an exception, ruby will exit with a non-zero status, which CI will treat as a failure"}, {"owner": {"reputation": 516, "user_id": 4137155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41ea7b6f094186456e12d882ac5e9a2?s=128&d=identicon&r=PG", "display_name": "Sigu Magwa", "link": "https://stackoverflow.com/users/4137155/sigu-magwa"}, "edited": false, "score": 0, "creation_date": 1534269505, "post_id": 51847155, "comment_id": 90647938, "body": "Okay, let me run a parallel job together with <code>rspec</code> an see if it passes"}, {"owner": {"reputation": 516, "user_id": 4137155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41ea7b6f094186456e12d882ac5e9a2?s=128&d=identicon&r=PG", "display_name": "Sigu Magwa", "link": "https://stackoverflow.com/users/4137155/sigu-magwa"}, "edited": false, "score": 0, "creation_date": 1534272640, "post_id": 51847155, "comment_id": 90649344, "body": "This works, I added a parallel job and now it does not deploy if seeding fails"}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1534268940, "creation_date": 1534268940, "answer_id": 51847155, "question_id": 51847068, "link": "https://stackoverflow.com/questions/51847068/testing-validity-of-database-seed-file-in-rails/51847155#51847155", "title": "Testing validity of database seed file in rails", "body": "<p>You can define a separate CI task that runs <code>rails db:seed</code>, next to your existing one that runs <code>rspec</code> (or <code>rails spec</code>, or whatever spelling it uses).</p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1534273208, "post_id": 51848167, "comment_id": 90649595, "body": "This assumes you&#180;re using <code>database_cleaner</code> to clean up."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1534273151, "creation_date": 1534273151, "answer_id": 51848167, "question_id": 51847068, "link": "https://stackoverflow.com/questions/51847068/testing-validity-of-database-seed-file-in-rails/51848167#51848167", "title": "Testing validity of database seed file in rails", "body": "<p>Turns out its actually dead simple to test with RSpec:</p>\n\n<pre><code>require 'rails_helper'\nRSpec.describe \"db:seed\" do\n  it \"works\" do\n    expect { Rails.application.load_seed }.to_not raise_error\n  end\n  it \"creates a foo\" do\n    expect { Rails.application.load_seed }.to change(Foo, :count)\n  end\nend\n</code></pre>\n\n<p>Which can kind of be expected since \"seeding\" really just involves requiring a single ruby file.</p>\n\n<p><a href=\"https://github.com/rails/rails/blob/6a728491b66340345a91264b5983ad81944ab97a/railties/lib/rails/engine.rb#L549\" rel=\"nofollow noreferrer\"><code>Rails.application.load_seed</code></a> is used by the <code>rake db:seed</code> task (aka <code>rails db:seed</code> in Rails 5+).</p>\n"}], "owner": {"reputation": 516, "user_id": 4137155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41ea7b6f094186456e12d882ac5e9a2?s=128&d=identicon&r=PG", "display_name": "Sigu Magwa", "link": "https://stackoverflow.com/users/4137155/sigu-magwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 1, "accepted_answer_id": 51847155, "answer_count": 2, "score": 3, "last_activity_date": 1534273151, "creation_date": 1534268602, "question_id": 51847068, "link": "https://stackoverflow.com/questions/51847068/testing-validity-of-database-seed-file-in-rails", "title": "Testing validity of database seed file in rails", "body": "<p>Seed files can become invalid fast as code grows. I just had a situation where the open merge request had all tests running and passing but when I run <code>rails db:seed</code>  on staging server failed as the seed file did not have all the required fields for that particular model.\nIs there a way we can always test for validity of the seed file?</p>\n\n<p>Maybe relevant: </p>\n\n<ul>\n<li>I am using gitlab CI for running CI and deployment</li>\n<li>rails version - 5.2</li>\n<li>rspec version 3</li>\n</ul>\n"}, {"tags": ["ruby", "hash", "count"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1534266784, "post_id": 51846545, "comment_id": 90646515, "body": "<code>obj.method(:count).owner</code> can be useful."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1534273499, "post_id": 51846545, "comment_id": 90649728, "body": "Further to @muistooshort&#39;s comment, <code>obj.method(:count) #=&gt; #&lt;UnboundMethod: Hash(Enumerable)#count&gt;</code> is sufficient (that is, without <code>.owner</code> tacked on), as the owner (here <code>Enumerable</code>) is shown parenthetically along with <code>Hash</code> if the owner is not <code>obj.class</code>. This is the same as <code>Hash.instance_method(:count)</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1534273911, "post_id": 51846545, "comment_id": 90649919, "body": "@muistooshort, you should make that an answer, as it provides an important tool for locating methods generally."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534274608, "post_id": 51846545, "comment_id": 90650199, "body": "<code>count</code> is documented somewhere since an instance of <code>Hash</code> responds to it. It would be better to say that the docs for instance methods defined on <code>Hash</code> do not include <code>count</code>."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1534279999, "post_id": 51846545, "comment_id": 90652449, "body": "(From the link you provided) It&#39;s always worth checking the sidebar heading <b>Included Modules</b>."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1534267986, "post_id": 51846579, "comment_id": 90647128, "body": "However <code>hsh.keys.count</code> will perform better than <code>hsh.count</code> due to the fact that <code>Array#count</code> without any arguments is the same a <code>length</code>. That being said <code>Hash#length</code> (<code>Hash#size</code>) would be the most performant in this case as it does not require the transformation to an <code>Array</code> of keys first"}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 6, "last_activity_date": 1534266546, "creation_date": 1534266546, "answer_id": 51846579, "question_id": 51846545, "link": "https://stackoverflow.com/questions/51846545/what-is-hashcount/51846579#51846579", "title": "What is Hash#count?", "body": "<p>You seem to have gotten most of the way there... it's <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-count\" rel=\"noreferrer\"><code>Enumerable#count</code></a>.</p>\n\n<p>Technically, <code>hsh.keys.count</code> is counting the keys, and <code>hsh.count</code> is counting the <em>pairs</em> (as would be yielded by <code>hsh.each</code>), but those are identical values in practice, because each pair has a unique key.</p>\n"}], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1833, "favorite_count": 1, "accepted_answer_id": 51846579, "answer_count": 1, "score": 4, "last_activity_date": 1534266546, "creation_date": 1534266392, "question_id": 51846545, "link": "https://stackoverflow.com/questions/51846545/what-is-hashcount", "title": "What is Hash#count?", "body": "<p>I was playing with IRB (Ruby 2.5.1) when I noticed this:</p>\n\n<pre><code>irb(main):020:0&gt; h \n=&gt; {3=&gt;4, :aaa=&gt;false} \nirb(main):021:0&gt; h.count \n=&gt; 2\n</code></pre>\n\n<p>However, this method doesn't exist in <a href=\"https://ruby-doc.org/core-2.5.1/Hash.html\" rel=\"nofollow noreferrer\">Ruby docs</a>.</p>\n\n<p>A quick test shows that <code>hsh.count</code> gives the same result as <code>hsh.keys.count</code>, and <code>Hash.ancestors</code> contains <code>Enumerable</code>.</p>\n\n<p>What exactly is Hash#count?</p>\n"}, {"tags": ["ruby", "pointers", "linked-list", "reference"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1534259647, "post_id": 51844610, "comment_id": 90642704, "body": "&quot;Is there way in Ruby to use C-like pointers or PHP-like references?&quot; - no."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534262863, "post_id": 51844610, "comment_id": 90644516, "body": "@SergioTulentsev there <i>is</i> indeed a way: write an extension and access the memory in a way you like."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1534263591, "post_id": 51844610, "comment_id": 90644881, "body": "@mudasobwa: that would be in C, not in ruby :)"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534263851, "post_id": 51844610, "comment_id": 90645018, "body": "<code>require &quot;fiddle&quot;</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534260327, "post_id": 51844851, "comment_id": 90643126, "body": "So, it&#39;s a &quot;no&quot;? :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1534261575, "post_id": 51844851, "comment_id": 90643849, "body": "No, it isn&#39;t. This isn&#39;t at all like c pointers. The only pointy thing about ruby references is that they point to an object. You can&#39;t do address math or mutate a piece of memory directly. Which is the entire premise of the question."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534262741, "post_id": 51844851, "comment_id": 90644463, "body": "@SergioTulentsev what <code>&quot;foo&quot;[1...2] = &quot;bar&quot;</code> is if not a mutation of a memory directly? Also, I would say, ruby references are like <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> references. not like <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> pointers."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534263074, "post_id": 51844851, "comment_id": 90644627, "body": "I&#39;ll agree the question&#39;s premise is mixed; an <code>a</code>-manipulating version of the first example couldn&#39;t be achieved with C pointers either (NB again, excluding pointer-pointers). The final paragraph <i>asks</i> about pointers, but by context seems to be more interested in pointer-pointers."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534263786, "post_id": 51844851, "comment_id": 90644977, "body": "@mudasobwa: nope, not like c references either. Java references is the closest thing."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534263824, "post_id": 51844851, "comment_id": 90645002, "body": "@matthewd: I am not familiar with term &quot;pointer-pointer&quot;. What did you mean by that?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534264003, "post_id": 51844851, "comment_id": 90645095, "body": "@SergioTulentsev damn, I again messed <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> and <a href=\"https://stackoverflow.com/questions/tagged/cpp\">cpp</a> :( I meant pass by reference as in <code>void func(int&amp; ref) {ref++;}</code> which is obviously <a href=\"https://stackoverflow.com/questions/tagged/cpp\">cpp</a>."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534264147, "post_id": 51844851, "comment_id": 90645167, "body": "@Sergio a pointer to a pointer. A ruby variable reference is a bit like <code>RVALUE*</code> (heh) -- yes, without the ability to do maths on it -- but there&#39;s no way to get an <code>RVALUE**</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1534264282, "post_id": 51844851, "comment_id": 90645236, "body": "@matthewd &quot;n a-manipulating version of the first example couldn&#39;t be achieved with C pointers either&quot; - I haven&#39;t touched C in like 15 years, but I&#39;m pretty sure it <i>is</i> possible. In fact, that&#39;s how C people implement lists (I imagine). Check this: <a href=\"https://eval.in/1047568\" rel=\"nofollow noreferrer\">eval.in/1047568</a>"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534264577, "post_id": 51844851, "comment_id": 90645399, "body": "Yeah, that&#39;s a pointer to an intrinsic.. I was thinking in the context of a malloc-managed struct.. which was maybe too over-specific."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534313855, "post_id": 51844851, "comment_id": 90659958, "body": "Being clever it is quite possible to use <code>__id__</code> to get the real address in memory to the actual underlying struct. Obviously very hack-ish and requires knowing the exact layout each data type, altering memory in a language that seems to purposefully make it difficult, etc, but it is possible. This does not mean it should ever be done. If this is required, make a C extension to do it right."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1534260208, "creation_date": 1534260208, "answer_id": 51844851, "question_id": 51844610, "link": "https://stackoverflow.com/questions/51844610/pointer-in-ruby/51844851#51844851", "title": "Pointer in Ruby", "body": "<p>All ruby variable references are essentially pointers (but not pointers-to-pointers), in C parlance.</p>\n\n<p>You can mutate an object (assuming it's not immutable), and all variables that reference it will thus be pointing at the same (now mutated) object. But the only way to change <em>which</em> object a variable is referring to is with direct assignment to that variable -- and each variable is a separate reference; you can't alias a single reference with two names.</p>\n"}], "owner": {"reputation": 797, "user_id": 8574922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-H7r02ZlEyhE/AAAAAAAAAAI/AAAAAAAAAPc/RiIKejtdmws/photo.jpg?sz=128", "display_name": "Dmitry Dmitriev", "link": "https://stackoverflow.com/users/8574922/dmitry-dmitriev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "accepted_answer_id": 51844851, "answer_count": 1, "score": 0, "last_activity_date": 1569522878, "creation_date": 1534259362, "last_edit_date": 1569522878, "question_id": 51844610, "link": "https://stackoverflow.com/questions/51844610/pointer-in-ruby", "title": "Pointer in Ruby", "body": "<p>I just solved some tasks about linked lists using Ruby. It was very interesting, but it requires a couple of new lines. Because if I pass <code>head</code> in some function, and change the head of the list, I have to return new <code>head</code> from method and reassign it to the variable.</p>\n\n<p>Because if I have <code>a</code> variable and I pass it to method, reassign <code>a</code> inside, outside <code>a</code> dose not changes:</p>\n\n<pre><code> it \"dose not changes if reassign variable in method\" do\n        a = [1,2]\n        def reasign array\n            array = [1]\n            array\n        end\n        assert_equal [1], reasign(a)\n        assert_equal [1,2], a\n    end\n</code></pre>\n\n<p>Of course I able to warp <code>head</code> of list in <code>Hash</code> or <code>Array</code> and save this <code>Hash</code> thus when I change something in object. The variable outside  still pointing on object. And this works. But again requires couple of lines.</p>\n\n<pre><code>it \"method changes the data into a object\" do\n    a = [1,2]\n    def change_object object\n        object.push 3\n        object\n    end\n    assert_equal [1,2,3], change_object(a)\n    assert_equal [1,2,3], a\nend\n</code></pre>\n\n<p>Is there way in Ruby to use C-like pointers or PHP-like references?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "deployment", "rubygems", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 560, "user_id": 6317812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YfWu.jpg?s=128&g=1", "display_name": "Dmitry Shvetsov", "link": "https://stackoverflow.com/users/6317812/dmitry-shvetsov"}, "edited": false, "score": 0, "creation_date": 1534319803, "post_id": 51844609, "comment_id": 90662160, "body": "what version of mina do you using?"}, {"owner": {"reputation": 253, "user_id": 3577013, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426571fdda982a5e6b22aee0b3b365f3?s=128&d=identicon&r=PG", "display_name": "Michael L.", "link": "https://stackoverflow.com/users/3577013/michael-l"}, "reply_to_user": {"reputation": 560, "user_id": 6317812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YfWu.jpg?s=128&g=1", "display_name": "Dmitry Shvetsov", "link": "https://stackoverflow.com/users/6317812/dmitry-shvetsov"}, "edited": false, "score": 0, "creation_date": 1534323054, "post_id": 51844609, "comment_id": 90663510, "body": "1.2.2 but also tested with 1.2.3"}, {"owner": {"reputation": 560, "user_id": 6317812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YfWu.jpg?s=128&g=1", "display_name": "Dmitry Shvetsov", "link": "https://stackoverflow.com/users/6317812/dmitry-shvetsov"}, "edited": false, "score": 0, "creation_date": 1534386902, "post_id": 51844609, "comment_id": 90689439, "body": "You can <code>bundle open mina</code> and make <code>p fetch(:user)</code> in <code>&#47;lib&#47;mina&#47;backend&#47;remote.rb</code> or use <b>byebug</b> or <b>pry</b> before <a href=\"https://github.com/mina-deploy/mina/blob/0fe5beb699f70ac2906546cc021aa2a682997043/lib/mina/backend/remote.rb#L26\" rel=\"nofollow noreferrer\">this line</a> or any other technique that you like to debug the issue. Please share what will user is equal to in the <b>ssh</b> method."}, {"owner": {"reputation": 560, "user_id": 6317812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YfWu.jpg?s=128&g=1", "display_name": "Dmitry Shvetsov", "link": "https://stackoverflow.com/users/6317812/dmitry-shvetsov"}, "edited": false, "score": 0, "creation_date": 1534387151, "post_id": 51844609, "comment_id": 90689488, "body": "Another advice is to remove code that not related to general mina configuration and run mina with a minimal config that literally do nothing. By testing that mina works correctly with your minimal config. This way you can localize the source of the problem."}], "owner": {"reputation": 253, "user_id": 3577013, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/426571fdda982a5e6b22aee0b3b365f3?s=128&d=identicon&r=PG", "display_name": "Michael L.", "link": "https://stackoverflow.com/users/3577013/michael-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534259359, "creation_date": 1534259359, "question_id": 51844609, "link": "https://stackoverflow.com/questions/51844609/cannot-connect-to-server-via-ssh-when-using-mina", "title": "Cannot connect to server via ssh when using Mina", "body": "<p>I try to use <a href=\"https://github.com/mina-deploy/mina\" rel=\"nofollow noreferrer\" title=\"Mina\">Mina</a> to automate the deployment process for a Ruby on Rails application. I defined an user for ssh like this in my <code>config/deploy.rb</code> file:</p>\n\n<pre><code>set :user, 'unix-username'\n</code></pre>\n\n<p>But when I call <code>mina setup</code> the username isn't set so that the script tries to ssh to my server with the windows username of my local dev maschine (which is default behaviour, when no username is given, as I know).</p>\n\n<p>What can I do to use the script successfully?</p>\n\n<p>My <code>deploy.rb</code> file:</p>\n\n<pre><code>require 'mina/rails'\nrequire 'mina/git'\nrequire 'mina/rvm'\n\nset :application_name, 'app-name'\nset :domain, 'ip-address-of-my-server'\nset :user, 'unix-username'\nset :deploy_to, \"/home/#{fetch(:user)}/app\"\nset :repository, 'git@github.com:path/to/repo.git'\nset :branch, 'master'\nset :rvm_use_path, '/etc/profile.d/rvm.sh'\n\nset :execution_mode, :exec if RbConfig::CONFIG['host_os'] =~ /mswin|mingw/\n\n# Optional settings:\n#   set :user, 'foobar'          # Username in the server to SSH to.\n#   set :port, '30000'           # SSH port number.\n#   set :forward_agent, true     # SSH forward_agent.\n\nset :shared_files, fetch(:shared_files, []).push('config/database.yml', 'config/secrets.yml')\n\ntask :remote_environment do\n  ruby_version = File.read('.ruby-version').strip\n  raise \"Couldn't determine Ruby version: Do you have a file .ruby-version in your project root?\" if ruby_version.empty?\n\n  invoke :'rvm:use', ruby_version\nend\n\ntask :setup do\n\n  in_path(fetch(:shared_path)) do\n\n    command %[mkdir -p config]\n\n    # Create database.yml for Postgres if it doesn't exist\n    path_database_yml = \"config/database.yml\"\n    database_yml = %[production:\n  database: #{fetch(:user)}\n  adapter: postgresql\n  pool: 5\n  timeout: 5000]\n    command %[test -e #{path_database_yml} || echo \"#{database_yml}\" &gt; #{path_database_yml}]\n\n    # Create secrets.yml if it doesn't exist\n    path_secrets_yml = \"config/secrets.yml\"\n    secrets_yml = %[production:\\n  secret_key_base:\\n    #{`bundle exec rake secret`.strip}]\n    command %[test -e #{path_secrets_yml} || echo \"#{secrets_yml}\" &gt; #{path_secrets_yml}]\n\n    # Remove others-permission for config directory\n    command %[chmod -R o-rwx config]\n  end\n\nend\n\ndesc \"Deploys the current version to the server.\"\ntask :deploy do\n  deploy do\n    invoke :'git:clone'\n    invoke :'deploy:link_shared_paths'\n    invoke :'bundle:install'\n    invoke :'rails:db_migrate'\n    invoke :'rails:assets_precompile'\n    invoke :'deploy:cleanup'\n\n    on :launch do\n      # command \"sudo service #{fetch(:user)} restart\"\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534254993, "post_id": 51843178, "comment_id": 90639426, "body": "Please be more specific as to how this isn&#39;t a duplicate of the linked question; I can&#39;t advise you on how to make the difference clearer, because I don&#39;t see one."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1534255070, "post_id": 51843178, "comment_id": 90639487, "body": "<code>has_one :trip</code>, needs to mention the FK of the <code>Trip</code> model. or name it like <code>has_one :going_route_trip, class_name: &quot;Trip&quot;</code> and <code>has_one : returning_route_trip, class_name: &quot;Trip&quot;</code>"}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534255808, "post_id": 51843178, "comment_id": 90639973, "body": "@matthewd sorry I had a wrong link.. Updated now. For previous link, well they have a <code>has_many</code> relationship and I have a <code>has_one</code>, as well as many differencies, the accepted answer cannot fit to my issue."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534255914, "post_id": 51843178, "comment_id": 90640064, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24642005/rails-association-with-multiple-foreign-keys\">Rails association with multiple foreign keys</a>"}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1534255929, "post_id": 51843178, "comment_id": 90640079, "body": "@ArupRakshit I&#39;ve tried something similar, but route has ony one trip. So the foreign key may be either <code>returning_route_id</code> or <code>going_route_id</code>. I&#39;ve tried to mention the key dynamically but this doesn&#39;t seems feasable."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534256755, "post_id": 51843178, "comment_id": 90640729, "body": "@matthewd I&#39;ve updated my question as well"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534256863, "post_id": 51843178, "comment_id": 90640822, "body": "I was looking more at the accepted answer. You can&#39;t define a relationship that points at two columns; you need to define two separate associations."}, {"owner": {"reputation": 412, "user_id": 1337348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc986e3c93129ff588d1dfcf8a1ab75a?s=128&d=identicon&r=PG&f=1", "display_name": "Jocko", "link": "https://stackoverflow.com/users/1337348/jocko"}, "edited": false, "score": 0, "creation_date": 1534262124, "post_id": 51843178, "comment_id": 90644150, "body": "Is there functionally any difference between a <code>going</code> and a <code>returning</code> route? Other than one is a route for going and the other is a route for returning.  Do they behave differently?  Or is it just a designation?"}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 412, "user_id": 1337348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc986e3c93129ff588d1dfcf8a1ab75a?s=128&d=identicon&r=PG&f=1", "display_name": "Jocko", "link": "https://stackoverflow.com/users/1337348/jocko"}, "edited": false, "score": 0, "creation_date": 1534263811, "post_id": 51843178, "comment_id": 90644990, "body": "@Jocko It is a designation only."}], "answers": [{"comments": [{"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1534257312, "post_id": 51843866, "comment_id": 90641146, "body": "I&#39;m sorry if my definition was not clear enough, I&#39;m really struggling to get a concise question, but the model you are offering is far from representing our data: a route is, in fact, some polyline and time information, and a trip is the concatenation of two routes (and some other information). For your first answer,  I will use this if I don&#39;t find another way around, but this will enforce the creation of a method <code>trip</code>, that will return whichever of both is not <code>nil</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1534257646, "post_id": 51843866, "comment_id": 90641378, "body": "I found the naming and the model pretty confusing - so while it might not solve your exact domain problem the general principles still apply. <code>has_one &#47; has_many</code> associations need to point to a single foreign key on the model with the <code>belongs_to</code> associations table. There really is no &quot;dynamic&quot; way around this as associations are declared on the class level - not per instance."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1534257824, "post_id": 51843866, "comment_id": 90641502, "body": "And <code>has_one :favorite_trip, -&gt; (route) { where(&quot;going_route_id = :id OR returning_route_id = :id&quot;, id: route.id) }</code> will not work since the pickle is that the foreign key column is referenced in the JOIN clause. Tacking on a where clause does nothing to change that."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1534259345, "post_id": 51843866, "comment_id": 90642515, "body": "I added an alternative solution that borders on STI / polymorpism."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1534264852, "post_id": 51843866, "comment_id": 90645541, "body": "I guess STI is the way to go. Make sure you add that <code>type</code> column. If you have existing records make sure you update them and set the type column to <code>&quot;Routes::Outbound&quot;&#47;&quot;Routes::Return&quot;</code>."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1534264591, "last_edit_date": 1534264591, "creation_date": 1534257050, "answer_id": 51843866, "question_id": 51843178, "link": "https://stackoverflow.com/questions/51843178/how-to-access-model-from-two-distinct-foreign-keys/51843866#51843866", "title": "How to access model from two distinct foreign keys?", "body": "<p>You need to specify the foreign keys on the inverse side of the <code>belongs_to</code> association - meaning the <code>has_one</code> / <code>has_many</code> side that references the foreign key:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n    # specifying foreign_key here is not needed since AR\n    # will deduce that its outbound_route_id\n    belongs_to :outbound_route,\n      class_name: \"Route\"\n    belongs_to :return_route, \n      class_name: \"Route\"\nend\n\nclass Route &lt; ActiveRecord::Base\n  has_one :trip_as_outbound,\n    class_name: 'Trip',\n    foreign_key: :outbound_route_id\n  has_one :trip_as_returning,\n    class_name: 'Trip',\n    foreign_key: :return_route_id\n\n  def trip\n    trip_as_outbound || trip_as_returning\n  end\nend\n</code></pre>\n\n<p>One way around this is to use Single Table Inheritance:</p>\n\n<pre><code>class Route &lt; ApplicationRecord \nend\n\nclass Routes::Outbound &lt; ::Route\n  self.table_name = 'routes'\n  has_one :trip, foreign_key: :outbound_route_id\nend\n\nclass Routes::Return &lt; ::Route\n  self.table_name = 'routes'\n  has_one :trip, foreign_key: :return_route_id\nend\n\nclass Trip &lt; ApplicationRecord\n  belongs_to :outbound_route,\n    class_name: '::Routes::Outbound'\n  belongs_to :return_route,\n    class_name: '::Routes::Return'\nend\n</code></pre>\n\n<p>Which will give you the correct trip but has some strangeness such as that <code>Routes::Return.all</code> will give you the same result as <code>Route.all</code>.</p>\n\n<p>This can be fixed by adding a <code>type</code> string column to the <code>routes</code> table. For performance add a compound index on type and id.</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 1337348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc986e3c93129ff588d1dfcf8a1ab75a?s=128&d=identicon&r=PG&f=1", "display_name": "Jocko", "link": "https://stackoverflow.com/users/1337348/jocko"}, "is_accepted": false, "score": 1, "last_activity_date": 1534265120, "creation_date": 1534265120, "answer_id": 51846220, "question_id": 51843178, "link": "https://stackoverflow.com/questions/51843178/how-to-access-model-from-two-distinct-foreign-keys/51846220#51846220", "title": "How to access model from two distinct foreign keys?", "body": "<p>Being that there is no functional difference between a <code>going</code> and a <code>returning</code> route, consider setting up a has_many relationship between the trip and the route.  This would make routes reusable for other trips, and get you what you're looking for.</p>\n\n<p>NOTE: There are flaws in this approach, because you're using a many-to-many relationship. Which means one trip could have more than one going and/or returning route.  You could manage this through code in the Trip model, or this may not be so bad, if you wanted to generate a \"multi-stop\" route for either direction.</p>\n\n<p>You would generate a model called called <code>trip_routes</code>.</p>\n\n<p>The <code>trip_routes</code> migration might look like this:</p>\n\n<pre><code>create_table :trip_routes do |t|\n   t.integer :trip_id\n   t.integer :route_id\n   t.string  :route_type\n   t.boolean :favorite\nend\n\n# Consider this part based on how you think your indexes are best built, I'm \n# just making note that DB performance can be impacted particularly on these\n# two fields.\nadd_index :trip_routes, :trip_id\nadd_index :trip_routes, :route_id\n</code></pre>\n\n<p>Your <code>trip_route</code> model would look like this:</p>\n\n<pre><code>class TripRoute &lt; ActiveRecord::Base\n    belongs_to :trip\n    belongs_to :route\n\n    # This model knows whether it's the 'going' or 'returning' route, so do your \n    # route functionality here.\nend\n</code></pre>\n\n<p>Then your <code>trip</code> model would look like this:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n    has_many :trip_routes\n    has_many :route, through: trip_routes\n\n    # Helper to get the going route\n    def going_trip_route\n        self.trip_routes.find_by(route_type: \"going\")\n    end\n\n    # Helper to get the going route\n    def returning_trip_route\n        self.trip_routes.find_by(route_type: \"returning\")\n    end\n\nend\n</code></pre>\n\n<p>Your <code>route</code> model would look like this:</p>\n\n<pre><code>class Route &lt; ActiveRecord::Base\n    has_many :trip_routes\n    has_many :trips, through: trip_routes\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 412, "user_id": 1337348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc986e3c93129ff588d1dfcf8a1ab75a?s=128&d=identicon&r=PG&f=1", "display_name": "Jocko", "link": "https://stackoverflow.com/users/1337348/jocko"}, "edited": false, "score": 0, "creation_date": 1534528534, "post_id": 51872734, "comment_id": 90752396, "body": "Is there a scenario where a route could be used for multiple trips?  Seems very possible since you don&#39;t have an association from Route -&gt; Trip that&#39;s managing the data.  In that case, this would be problematic because it will only associate to the first Trip, and you will never see the association to other Trips.  That&#39;s possibly a risk you&#39;re willing to take."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 412, "user_id": 1337348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc986e3c93129ff588d1dfcf8a1ab75a?s=128&d=identicon&r=PG&f=1", "display_name": "Jocko", "link": "https://stackoverflow.com/users/1337348/jocko"}, "edited": false, "score": 0, "creation_date": 1534593137, "post_id": 51872734, "comment_id": 90766826, "body": "Routes can only have one trip. However, we need to be able to quickly access route from a trip for performance issues (that is why <code>going_route_id</code> and <code>returning_route_id</code> where chosen)"}], "tags": [], "owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "is_accepted": true, "score": 0, "last_activity_date": 1534408020, "creation_date": 1534408020, "answer_id": 51872734, "question_id": 51843178, "link": "https://stackoverflow.com/questions/51843178/how-to-access-model-from-two-distinct-foreign-keys/51872734#51872734", "title": "How to access model from two distinct foreign keys?", "body": "<p>After seeing every possible solution, and our needs, we chose this next solution:</p>\n\n<pre><code>class Route\n    def trip\n        @trip ||= Trip.find_by(\"going_route_id = :id OR returning_route_id = :id\", id: id)\n    end\nend\n</code></pre>\n\n<p>I don't think this is the best way around, and it feels hacky. However, this was the fastest to implement, without perf issue. The other issue with this solution is that there is no rails validation.</p>\n"}, {"comments": [{"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 0, "creation_date": 1535031043, "post_id": 51978035, "comment_id": 90923434, "body": "I don&#39;t think this works... For this, I would use one single <code>trip_id</code> key, and there would be an issue with the fact that both tables reference each other. Moreover, as said in the question, I need for performance issues to keep <code>going_route_id</code> and <code>returning_route_id</code> access from my <code>trips</code> table"}], "tags": [], "owner": {"reputation": 79, "user_id": 5017845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-W20TZbtMEm4/AAAAAAAAAAI/AAAAAAAAAFU/3FMqJfAqffY/photo.jpg?sz=128", "display_name": "Christian Angel Galamay", "link": "https://stackoverflow.com/users/5017845/christian-angel-galamay"}, "is_accepted": false, "score": 0, "last_activity_date": 1534995815, "creation_date": 1534995815, "answer_id": 51978035, "question_id": 51843178, "link": "https://stackoverflow.com/questions/51843178/how-to-access-model-from-two-distinct-foreign-keys/51978035#51978035", "title": "How to access model from two distinct foreign keys?", "body": "<p>try adding keys in routes table</p>\n\n<blockquote>\n<pre><code>add_column :routes, :going_key,     :integer\nadd_column :routes, :returning_key, :integer\n</code></pre>\n</blockquote>\n\n<p>then in your Trip and Route model</p>\n\n<pre><code>class Route &lt; ActiveRecord::Base\n  belongs_to :going_route, foreign_key: :going_key, class_name: Trip\n  belongs_to :returning_route, foreign_key: :returning_key, class_name: Trip\nend\n\nclass Trip &lt; ActiveRecord::Base\nend\n\nRoute.first.going_route \nRoute.first.returning_route \n</code></pre>\n"}], "owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 51872734, "answer_count": 4, "score": 1, "last_activity_date": 1555326172, "creation_date": 1534254843, "last_edit_date": 1555326172, "question_id": 51843178, "link": "https://stackoverflow.com/questions/51843178/how-to-access-model-from-two-distinct-foreign-keys", "title": "How to access model from two distinct foreign keys?", "body": "<p>I have two related models, Trip and Ride. A Trip may have a going ride or a returning ride. My ActiveRecord models look like this:</p>\n\n<pre><code>class Route &lt; ActiveRecord::Base\n    has_one :trip\nend\n\nclass Trip &lt; ActiveRecord::Base\n    belongs_to :going_route,     class_name: \"Route\"\n    belongs_to :returning_route, class_name: \"Route\"\nend\n</code></pre>\n\n<p>However this throws me an issue when I want to access a trip from a route:</p>\n\n<pre><code>Route.first.trip\n</code></pre>\n\n<p>This throws a PostgreSQL error:</p>\n\n<blockquote>\n  <p>PG::UndefinedColumn: ERROR:  column trips.route_id does not exist</p>\n</blockquote>\n\n<p>How can I tell to the <code>Route</code> class that his trip is under either <code>going_route_id</code> or <code>returning_route_id</code>? Or maybe there is another way around?</p>\n\n<p><em>P.S: I've been looking for similar questions, there are a lot, but none is exactly like this one and solves my problem. If you have any tip on how to make the difference clearer, especially for the title. <a href=\"https://stackoverflow.com/q/27051450/6320039\">Here</a> is some similar question</em></p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I've also tried using a lambda, as in <a href=\"https://stackoverflow.com/q/24642005/6320039\">matthew's duplicate proposition</a>:</p>\n\n<pre><code>class FavoriteRoute &lt; ActiveRecord::Base\n    has_one :favorite_trip, -&gt; (route) { where(\"going_route_id = :id OR returning_route_id = :id\", id: route.id) }\nend\n</code></pre>\n\n<p>This will throw the same error. And if I assume I should use <code>find_by</code> instead of <code>where</code> since I need only one result, I have another error which I really don't understand:</p>\n\n<blockquote>\n  <p>NoMethodError: undefined method `except' for #&lt;Trip:0x00007f827b9d13e0&gt;</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 10224803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f4f17742ec82f33995ea34732fb0e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco", "link": "https://stackoverflow.com/users/10224803/francisco"}, "edited": false, "score": 0, "creation_date": 1534256094, "post_id": 51843355, "comment_id": 90640221, "body": "Thanks, for trying to help. I already had try with the DateTime.new, with out the *, as a put above and didn&#39;t work. With the * before it work, what that symbol does?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 407, "user_id": 10224803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f4f17742ec82f33995ea34732fb0e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco", "link": "https://stackoverflow.com/users/10224803/francisco"}, "edited": false, "score": 0, "creation_date": 1534256220, "post_id": 51843355, "comment_id": 90640308, "body": "Here it allows the array to be passed as the list of parameters. Here is a <a href=\"https://medium.com/@sarahalder/ruby-s-splat-operator-1edaaad83268\" rel=\"nofollow noreferrer\">good writing</a> or just google \u201cruby splat operator.\u201d"}, {"owner": {"reputation": 407, "user_id": 10224803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f4f17742ec82f33995ea34732fb0e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco", "link": "https://stackoverflow.com/users/10224803/francisco"}, "edited": false, "score": 0, "creation_date": 1534256330, "post_id": 51843355, "comment_id": 90640390, "body": "Thanks, It helps me alot."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1534255427, "creation_date": 1534255427, "answer_id": 51843355, "question_id": 51843126, "link": "https://stackoverflow.com/questions/51843126/parse-date-from-an-array/51843355#51843355", "title": "Parse Date From an Array", "body": "<p>This is a <code>DateTime</code> object, not a <code>Date</code> in the first place. <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/DateTime.html#method-c-new\" rel=\"nofollow noreferrer\"><code>DateTime#new</code></a> accepts seven arguments, hence all you need is to splat an array you have:</p>\n\n<pre><code>DateTime.new(*object[\"beginDate\"])\n</code></pre>\n"}], "owner": {"reputation": 407, "user_id": 10224803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f4f17742ec82f33995ea34732fb0e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco", "link": "https://stackoverflow.com/users/10224803/francisco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 51843355, "answer_count": 1, "score": 0, "last_activity_date": 1534255427, "creation_date": 1534254706, "question_id": 51843126, "link": "https://stackoverflow.com/questions/51843126/parse-date-from-an-array", "title": "Parse Date From an Array", "body": "<p>I am consuming a Rest API and the return of one of the data is a datetime that is return in an Array. Exactly like this:</p>\n\n<pre><code>\"beginDate\": [2018, 7, 24, 8, 22, 0, 0]\n</code></pre>\n\n<p>In my rails app I want to parse this data into a date time format. I already try this way:</p>\n\n<pre><code>Date.new(object[\"beginDate\"].join)\n</code></pre>\n\n<p>And this way:</p>\n\n<pre><code>Date.parse(object[\"beginDate\"].join)\n</code></pre>\n\n<p>Also this:</p>\n\n<pre><code>DateTime.new(object[\"beginDate\"].join)\nDateTime.parse(object[\"beginDate\"].join)\n</code></pre>\n\n<p>Every code return an error like: 'Invalid date'. </p>\n\n<p>How can I parse the data in to a datetime format?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "answers": [{"comments": [{"owner": {"reputation": 374, "user_id": 9290107, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uaazeTb-DBE/AAAAAAAAAAI/AAAAAAAAAC0/bKKxFLCNxYk/photo.jpg?sz=128", "display_name": "Eric Nordelo Galiano", "link": "https://stackoverflow.com/users/9290107/eric-nordelo-galiano"}, "edited": false, "score": 0, "creation_date": 1573243929, "post_id": 51891300, "comment_id": 103832281, "body": "and what is file_image in there ?"}, {"owner": {"reputation": 83, "user_id": 9770980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95ff2b5bc3d66aae44bf2886ed92bb4?s=128&d=identicon&r=PG", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/9770980/vitalii"}, "reply_to_user": {"reputation": 374, "user_id": 9290107, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uaazeTb-DBE/AAAAAAAAAAI/AAAAAAAAAC0/bKKxFLCNxYk/photo.jpg?sz=128", "display_name": "Eric Nordelo Galiano", "link": "https://stackoverflow.com/users/9290107/eric-nordelo-galiano"}, "edited": false, "score": 0, "creation_date": 1573372288, "post_id": 51891300, "comment_id": 103855902, "body": "@Eric Sorry I forgot to add the file_image variable. file_image is the path to the file"}], "tags": [], "owner": {"reputation": 83, "user_id": 9770980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95ff2b5bc3d66aae44bf2886ed92bb4?s=128&d=identicon&r=PG", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/9770980/vitalii"}, "is_accepted": true, "score": 0, "last_activity_date": 1573372166, "last_edit_date": 1573372166, "creation_date": 1534494554, "answer_id": 51891300, "question_id": 51842373, "link": "https://stackoverflow.com/questions/51842373/spreeimage-create-cant-create/51891300#51891300", "title": "Spree::Image.create! - can&#39;t create", "body": "<p>OK, I found decision.\n    Spree::Image.create!(attachment: File.open(Rails.root + \n    'app/assets/images/bottle/1.jpeg'), viewable: product)</p>\n\n<p>need write on</p>\n\n<pre><code>file_image = File.open(Rails.root.join('app', 'assets', 'images', '1.jpg'))\nimage = Spree::Image.create!(attachment: { io: file_image, filename: \"#{rand(1..20)}.jpg\" })\nproduct.images &lt;&lt; image\n</code></pre>\n\n<p>That's all and it's working</p>\n"}], "owner": {"reputation": 83, "user_id": 9770980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95ff2b5bc3d66aae44bf2886ed92bb4?s=128&d=identicon&r=PG", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/9770980/vitalii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 51891300, "answer_count": 1, "score": 0, "last_activity_date": 1573372166, "creation_date": 1534252431, "last_edit_date": 1554409482, "question_id": 51842373, "link": "https://stackoverflow.com/questions/51842373/spreeimage-create-cant-create", "title": "Spree::Image.create! - can&#39;t create", "body": "<p>When I create an application and rake task, cannot run <code>Spree:: Image.create!(attachment: File.open (Rails.root + 'app/assets/images/bottle / 1.jpeg'), viewable: product) - ActiveRecord error:: RecordInvalid: Validation failed: Attachment must be present</code></p>\n\n<p>What kind of information is missing ? Do I need to prescribe additional parameters separately And what kind of validation I can't get through ? ?\nIf check the path manually to the picture, through the rails console, the picture can be seen.</p>\n\n<p>My code</p>\n\n<pre><code>namespace :give_me do\n  desc 'Load 18 products in database'\n  task products: :environment do\n    19.times do |i|\n      kinds_rand = File.new(Rails.root + 'db/mock_data/kinds.md').readlines.sample\n      regions_rand = File.new(Rails.root + 'db/mock_data/regions.md').readlines.sample\n      names_rand = File.new(Rails.root + 'db/mock_data/names.md').readlines.sample\n      product = Spree::Product.create!(\n        name: name = names_rand.chomp,\n        description: \"New wine product #{i + 1}\",\n        available_on: Time.zone.now - 1.day,\n        shipping_category: Spree::ShippingCategory.first,\n        meta_description: 'Wine, is the best drink in the world',\n        meta_keywords: %w[wine drink alcohol bottle expensive drink'],\n        meta_title: name,\n        price: rand(50..800),\n        sku: rand(1_000_000..1_999_999),\n        year: rand(1960..2005),\n        region: regions_rand.chomp,\n        alcohol_percentage: rand(5..15),\n        wine_kind: kinds_rand.chomp\n      )\n      Spree::Image.create!(\n          attachment: File.open(Rails.root + 'app/assets/images/bottle/1.jpeg'), viewable: product\n      )\n    end\n    puts \"Here are your products\"\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1534251377, "post_id": 51841907, "comment_id": 90636954, "body": "The backslash is just for display purposes and is not actually part of the <code>String</code>. e.g. <code>&#39;text#$!text&#39;.include?(&quot;\\\\&quot;) #=&gt; false</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1534252889, "post_id": 51841907, "comment_id": 90638000, "body": "What do you mean by &quot;returns&quot;? There are no method definitions nor method calls in your code, so who is returning what from where to where?"}, {"owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1534253078, "post_id": 51841907, "comment_id": 90638143, "body": "@J&#246;rgWMittag I should&#39;ve used &#39;prints&#39; instead of &#39;returns&#39; coz I am checking it in console."}], "answers": [{"tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 3, "last_activity_date": 1534251410, "creation_date": 1534251410, "answer_id": 51842022, "question_id": 51841907, "link": "https://stackoverflow.com/questions/51841907/string-contains-reserved-builtin-global-variable-name-issue/51842022#51842022", "title": "String contains reserved builtin global variable name issue", "body": "<p>The backslash is part of how the string is represented by <code>inspect</code>, like the quotes; neither are part of the actual string itself.</p>\n\n<p>Note that <code>text[0, 5]</code>, for example, is <code>\"text#\"</code>. </p>\n"}], "owner": {"reputation": 1513, "user_id": 5746504, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-4c57-sWfrFM/AAAAAAAAAAI/AAAAAAAACog/XNKIq-S6CDg/photo.jpg?sz=128", "display_name": "Moamen Naanou", "link": "https://stackoverflow.com/users/5746504/moamen-naanou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 51842022, "answer_count": 1, "score": 0, "last_activity_date": 1534251410, "creation_date": 1534251050, "question_id": 51841907, "link": "https://stackoverflow.com/questions/51841907/string-contains-reserved-builtin-global-variable-name-issue", "title": "String contains reserved builtin global variable name issue", "body": "<p><strong>Given:</strong></p>\n\n<pre><code>text = \"text#$!text\" #Note: #$! is normal string not a variable\n</code></pre>\n\n<p>returns: <code>\"texttext\"</code></p>\n\n<p>And</p>\n\n<pre><code>text = 'text#$!text' # with single quote\n</code></pre>\n\n<p>returns: <code>\"text\\#$!text\"</code></p>\n\n<p><strong>Question:</strong></p>\n\n<p>How can I just get <code>\"text#$!text\"</code> as result because it is required to be hardcoded and used as password, so it can't contain backslashes <code>\\</code></p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "haml"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5197870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02b1021f20ad57d24620f0210d01a4b4?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Grimes", "link": "https://stackoverflow.com/users/5197870/rick-grimes"}, "edited": false, "score": 1, "creation_date": 1534251922, "post_id": 51842131, "comment_id": 90637315, "body": "Thank you, forgot the &#39;,&#39; before name :). Now it&#39;s working!"}], "tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": false, "score": 1, "last_activity_date": 1534251715, "creation_date": 1534251715, "answer_id": 51842131, "question_id": 51841889, "link": "https://stackoverflow.com/questions/51841889/how-to-change-submit-button-name-in-haml/51842131#51842131", "title": "How to change submit button name in HAML?", "body": "<p>Have you tried this?</p>\n\n<pre><code>program_form.submit I18n.t('texts.60A'), name: 'Button2'\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5197870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02b1021f20ad57d24620f0210d01a4b4?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Grimes", "link": "https://stackoverflow.com/users/5197870/rick-grimes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534256251, "creation_date": 1534251010, "question_id": 51841889, "link": "https://stackoverflow.com/questions/51841889/how-to-change-submit-button-name-in-haml", "title": "How to change submit button name in HAML?", "body": "<p>I am new to Haml and have a form with two submit buttons. To differentiate and handle them in the Controller every single button needs a name.</p>\n\n<p>An example from HAML:</p>\n\n<pre><code>= program_form.submit I18n.t('texts.6OA')\n</code></pre>\n\n<p>appears in HTML as:</p>\n\n<pre><code>&lt;input type=\"submit\" name=\"commit\" value=\"Save Template\"&gt;\n</code></pre>\n\n<p>but I want something like this:</p>\n\n<pre><code>&lt;input type=\"submit\" name=\"Button2\" value=\"Save Template\"&gt;\n</code></pre>\n\n<p>Any hints?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1534250841, "post_id": 51841774, "comment_id": 90636564, "body": "Have you tried moving the line <code>$thredded-brand: #9c27b0;</code> below the import line?"}, {"owner": {"reputation": 1, "user_id": 9512219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab28f9a18b9864e06995a3f9b9dc680?s=128&d=identicon&r=PG&f=1", "display_name": "gusm", "link": "https://stackoverflow.com/users/9512219/gusm"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1534259473, "post_id": 51841774, "comment_id": 90642595, "body": "hi, i have now tried it but no dice man. it says in the documentation to override the variables before importing the thredded styles, but thanks for the idea."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1534263780, "post_id": 51841774, "comment_id": 90644973, "body": "You&#39;re correct, I hadn&#39;t seen the documentation or have any experience with &quot;thredded&quot;. I updated your question to include a link to reference the documentation you&#39;re talking about."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1534264042, "post_id": 51841774, "comment_id": 90645115, "body": "One more question, you say in your question you copied the information exactly as above. Am I correct assuming you also changed the extension of your <i>application.css</i> to <i>application.scss</i>?"}, {"owner": {"reputation": 1, "user_id": 9512219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab28f9a18b9864e06995a3f9b9dc680?s=128&d=identicon&r=PG&f=1", "display_name": "gusm", "link": "https://stackoverflow.com/users/9512219/gusm"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1534301196, "post_id": 51841774, "comment_id": 90657195, "body": "hi, yes i had already changed it to application.scss. thank you for adding the link.  my file is in app/stylesheets/application.scss  i havent seen anywhere else to change the css. im still a bit stuck"}], "answers": [{"tags": [], "owner": {"reputation": 17573, "user_id": 181228, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/729f685b8e8d7e9feed18c177c82e59b?s=128&d=identicon&r=PG", "display_name": "glebm", "link": "https://stackoverflow.com/users/181228/glebm"}, "is_accepted": false, "score": 0, "last_activity_date": 1534693256, "creation_date": 1534693256, "answer_id": 51919277, "question_id": 51841774, "link": "https://stackoverflow.com/questions/51841774/thredded-styles-are-not-being-overwritten/51919277#51919277", "title": "thredded styles are not being overwritten", "body": "<p>You need to be using the application layout for this to work.</p>\n\n<p>See <a href=\"https://www.rubydoc.info/gems/thredded/0.15.4#Application_layout\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/thredded/0.15.4#Application_layout</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9512219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab28f9a18b9864e06995a3f9b9dc680?s=128&d=identicon&r=PG&f=1", "display_name": "gusm", "link": "https://stackoverflow.com/users/9512219/gusm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534693256, "creation_date": 1534250671, "last_edit_date": 1534268505, "question_id": 51841774, "link": "https://stackoverflow.com/questions/51841774/thredded-styles-are-not-being-overwritten", "title": "thredded styles are not being overwritten", "body": "<p>I am using the \"thredded\" gem for the forum, which is the nuts btw. However I am having a hard time overriding the styles. The <a href=\"https://www.rubydoc.info/gems/thredded/0.15.4#Styles\" rel=\"nofollow noreferrer\">documentation</a> offers:</p>\n\n<pre><code>// application.scss\n$thredded-brand: #9c27b0;\n@import \"thredded\";\n</code></pre>\n\n<p>as an example. I would welcome any help with understanding why, having copied in the information exactly as above, it is not working.</p>\n\n<p>I am also trying to put my navbar on top of the navbar that comes installed with thredded.</p>\n\n<p>any any help would be greatly appreciated.</p>\n\n<p>cheers</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "nginx"], "comments": [{"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1534251330, "post_id": 51841093, "comment_id": 90636917, "body": "@Gabbar Thanks for response!, I have tried but still doesn&#39;t work!"}, {"owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 0, "creation_date": 1534253274, "post_id": 51841093, "comment_id": 90638285, "body": "Have you tried byebug just below your if statement? What is the value of @course.info?"}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 0, "creation_date": 1534253511, "post_id": 51841093, "comment_id": 90638464, "body": "@course.info is a  hash, if I remove it, still doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "is_accepted": false, "score": 0, "last_activity_date": 1534256209, "creation_date": 1534256209, "answer_id": 51843614, "question_id": 51841093, "link": "https://stackoverflow.com/questions/51841093/rails-request-return-status-200-but-no-response-data/51843614#51843614", "title": "Rails request return status 200 but no response data", "body": "<p>Since course is presumably a hash, try <code>course[\"info\"]</code></p>\n\n<p>if that still isn't working, you may need to convert the info hash to JSON using <code>JSON.parse(course[\"info\"])</code></p>\n"}], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1534256209, "creation_date": 1534248591, "question_id": 51841093, "link": "https://stackoverflow.com/questions/51841093/rails-request-return-status-200-but-no-response-data", "title": "Rails request return status 200 but no response data", "body": "<p>I have a rails action as below:</p>\n\n<pre><code>def create\n  ......\n  if @course.save\n    render json: { success: true, course: @course.info}\n  else\n    render json: { success: false, error_msg: @course.errors.full_messages }\n  end\n</code></pre>\n\n<p>the request return status 200 but no response data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/t9Tdn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t9Tdn.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/iJYUt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iJYUt.png\" alt=\"enter image description here\"></a></p>\n\n<p>the nginx log and rails log looks normal:</p>\n\n<pre><code># nginx log\n100.116.224.40 [14/Aug/2018:18:59:12 +0800] POST \"xxxxx\" 200 200 27 \n\"47.88.138.112\" xxx\n\n# rails log\nmethod=POST path=xxxxformat=*/* controller=xxxx action=create \nstatus=200 duration=45.94 view=0.23 params=\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading"], "comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 1, "creation_date": 1534249847, "post_id": 51840514, "comment_id": 90635926, "body": "So you are running a single ruby process?"}, {"owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1534265015, "post_id": 51840514, "comment_id": 90645636, "body": "No, many processes, a good few clusters but it&#39;s affordable to have a copy of the data structure per process."}], "answers": [{"comments": [{"owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 0, "creation_date": 1534263810, "post_id": 51841714, "comment_id": 90644989, "body": "Perhaps I shouldn&#39;t have said railsy but &quot;a sane way that rails devs might use&quot;. Some context: I had previously been pushing this search microservice in a more nicely railsy AR object oriented direction. But now we&#39;re expecting serious, sudden growth and performance is now the primary concern. Ruby will more than suffice in performance given the right decisions. The data structure is a hash with arrays of ids pointing back to the hash. It typically requires &gt; 1000 key accesses per request. To make redis work I&#39;d need a much more complex and heavily denormalised data structure."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 1, "creation_date": 1534264380, "post_id": 51841714, "comment_id": 90645291, "body": "If the question is purely about the reasonableness of having a thread dedicated to maintaining the freshness of this cache (and we&#39;re hand-waving the thread-safety concerns that come along with that), then yes, that&#39;s a perfectly reasonable thing to do. Active Record has a thread whose only job is to occasionally look for DB connections that have been misplaced. Threads (particularly mostly-idle ones) really aren&#39;t <i>that</i> expensive."}, {"owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 0, "creation_date": 1534264711, "post_id": 51841714, "comment_id": 90645460, "body": "Thank you, that&#39;s helpful. As for the problem of it being multi-process I recognise the weakness is that there will need to be one copy of this data structure per process. It occurs to me that for consistent results they will need to be closely synchronised. The most efficient way of doing this would be to indeed bring in redis to store the result with a worker and have one thread per process deserialize it every 5 minutes. Yeah it&#39;s getting a little more complex than desired. Still less so than alternatives I can see but hmmm.."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1534250490, "creation_date": 1534250490, "answer_id": 51841714, "question_id": 51840514, "link": "https://stackoverflow.com/questions/51840514/rails-how-to-maintain-an-in-memory-in-process-search-index/51841714#51841714", "title": "Rails: How to maintain an in-memory, in-process search index?", "body": "<p>This question is a bit of a contradiction; you're simultaneously asking for a Railsy way to solve your problem, while explicitly discounting all the common solutions and insisting that your invented plan is the best fit.</p>\n\n<p>It sounds like you're going to end up going to a lot of effort to hand-roll a \"less sophisticated\" solution. I strongly recommend against that. However:</p>\n\n<p>Whether you choose timed or evented expiry will largely depend on whether you have a single cache, or multiple independent ones. If it's an in-process cache, and you have more than one process, you have no practical way to trigger expiry on demand, and will have to take the timer approach. (I don't see how event machine would be in any way relevant here.)</p>\n\n<p>Redis is indeed a far more appropriate tool for this job. The point of using Redis is that you don't need to deserialize everything: you do the lookup in Redis, and then only deserialize the part that matches. </p>\n"}, {"comments": [{"owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 0, "creation_date": 1534292533, "post_id": 51848476, "comment_id": 90655719, "body": "Ok, but I use redis caching a lot and explained why it would not fit this bill and you haven&#39;t addressed that explanation. As for questions of stale data, fortunately the part which will get most benefit from this caching is a slowly changing dimension and represents our curated business knowledge about how user attached tags are correlated with each other. The fast changing dimension of which tags users possess is inexpensive to live query. On the question of inconsistency, that&#39;s a theoretical but real concern and you can refer to the conversation beneath matthewd&#39;s answer."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 0, "creation_date": 1534399381, "post_id": 51848476, "comment_id": 90692371, "body": "You &quot;imagine&quot; it is slow. That is not really an explanation. If want to roll your own solution before trying something proven (which would be much easier to use/implement) go ahead, the additional thread will not hurt you."}, {"owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 0, "creation_date": 1534420208, "post_id": 51848476, "comment_id": 90703896, "body": "Indeed, I&#39;ve decided that the syncronisation concern is enough that I will use redis, will confirm that such a deserialization is too slow before adding the further layer of cached deserialized objects."}, {"owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "edited": false, "score": 0, "creation_date": 1534422380, "post_id": 51848476, "comment_id": 90705229, "body": "Please understand that I wouldn&#39;t have come looking for a battle tested alternative to the solutions I know and love if I didn&#39;t have a compelling performance need. This index lookup is just one part of a multi-stage searching process which needs to become reliably at least 6x faster but preferably more so we have headroom for platform growth and can continue to make the search algorithm more sophisticated. Avoiding a gigantic redis call and deserialization really matters in this context."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1534399171, "last_edit_date": 1534399171, "creation_date": 1534274623, "answer_id": 51848476, "question_id": 51840514, "link": "https://stackoverflow.com/questions/51840514/rails-how-to-maintain-an-in-memory-in-process-search-index/51848476#51848476", "title": "Rails: How to maintain an in-memory, in-process search index?", "body": "<p>Since you have multiple processes AND multiple hardware: having stale, out of sync data is innevitable. \nInventing your own caching solution (for lookup, expiry, synchronisation, refresh, preload and guarding it against eating all your memory, ...) will be more complex and error prone than to just use something that already exists (Redis comes to mind, there are others).</p>\n\n<p>I suggest you look at <a href=\"https://guides.rubyonrails.org/caching_with_rails.html\" rel=\"nofollow noreferrer\">Rails caching</a> with the Redis store. \nWhile this will include Network/Deserialization I'd say this is the most Rails way and, in my experience, is fast enough.\nIf you have tried this and it is still to slow, then you can try another solution. Or roll your own. But first measure, don't just assume.</p>\n"}, {"tags": [], "owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "is_accepted": true, "score": 0, "last_activity_date": 1534423852, "last_edit_date": 1534423852, "creation_date": 1534420592, "answer_id": 51876501, "question_id": 51840514, "link": "https://stackoverflow.com/questions/51840514/rails-how-to-maintain-an-in-memory-in-process-search-index/51876501#51876501", "title": "Rails: How to maintain an in-memory, in-process search index?", "body": "<p>I've since found <a href=\"https://github.com/brandonhilkert/sucker_punch\" rel=\"nofollow noreferrer\">sucker punch</a>, a  popular gem which is <a href=\"https://github.com/mperham/girl_friday\" rel=\"nofollow noreferrer\">strongly recommended</a> by the creator of sidekiq.</p>\n\n<p>I wouldn't say it's the perfect answer as it's not designed for long running threads and is maybe overkill when I can just launch my own short lived threads on a controller callback.</p>\n\n<p>Other answerers make the good point that with multiple processes I'll need a synchronisation method. Redis fits the bill and I will use it. However, if we follow the premise of the question that the structure is too big to deserialize from redis on each request then we need some additional in-process concurrency to maintain a shared deserialized cache object.</p>\n\n<p>I understand why other answerers are uncomfortable with such strategies as ruby really isn't geared for in-process parallelism so it isn't a big part of our culture (until the mythical ruby 3.0 we can only do concurrency in-process). This can't mean it's never the right answer.</p>\n\n<p>Suckerpunch addresses the requirement of background processing in a railsy way - a lot like sidekiq - but <em>in-process</em> so with direct shared object access.</p>\n"}], "owner": {"reputation": 1500, "user_id": 2772719, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/emBMW.jpg?s=128&g=1", "display_name": "Adamantish", "link": "https://stackoverflow.com/users/2772719/adamantish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 51876501, "answer_count": 3, "score": 0, "last_activity_date": 1534425092, "creation_date": 1534246680, "last_edit_date": 1534425092, "question_id": 51840514, "link": "https://stackoverflow.com/questions/51840514/rails-how-to-maintain-an-in-memory-in-process-search-index", "title": "Rails: How to maintain an in-memory, in-process search index?", "body": "<p>I believe we can get a massive performance boost in our user matching and search feature if we keep a simple in memory data structure of some nested hashes and arrays. This is not sophisticated enough to use a dedicated in memory search like ElasticSearch and it's not mostly about free text search either. The question is how to keep it updated?</p>\n\n<p>So I'm thinking of reserving one thread at load time to refresh and replace this index stored in a class variable every 5 minutes or so (it only takes a second or two to do this). The trouble is that this feels janky. Reserving a whole thread just to mostly sit there sleeping! Might it be better to just spawn a short lived thread after each request to check if it's time to update? But I don't want this always fighting for CPU with the request at exactly the wrong moment. Short of introducing an evented library like event machine <strong>is there a more standard railsy way to do this?</strong></p>\n\n<p>I understand that such shared state when not managed by some intermediary like redis is generally discouraged but I'm pretty comfortable about mutation risk as I'll be freezing this data structure. Also, this index has a few tens of thousands of hash keys and text items so I imagine deserializing from redis for every request is going to defeat much of the benefit.</p>\n"}, {"tags": ["ruby", "ruby-hash"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 4, "creation_date": 1534247127, "post_id": 51840500, "comment_id": 90634227, "body": "What&#39;s the expected result?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7924652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLCAb.png?s=128&g=1", "display_name": "M\u1ea1nh V\u0169", "link": "https://stackoverflow.com/users/7924652/m%e1%ba%a1nh-v%c5%a9"}, "edited": false, "score": 1, "creation_date": 1534313317, "post_id": 51840762, "comment_id": 90659803, "body": "this does return the number of correct answers, but it returns totals of correct. I want it to return the number of correct of each question. Answer above did the job. Thank anyway"}], "tags": [], "owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "is_accepted": false, "score": 1, "last_activity_date": 1534252517, "last_edit_date": 1534252517, "creation_date": 1534247491, "answer_id": 51840762, "question_id": 51840500, "link": "https://stackoverflow.com/questions/51840500/how-to-count-number-of-appearance-of-a-specific-value-in-ruby-hash/51840762#51840762", "title": "How to count number of appearance of a specific value in Ruby hash?", "body": "<p>If you just want to count how many correct answers are in the hash, you can use <code>inject</code> to do that. Here is a way:</p>\n\n<pre><code># iterate over the questions\nhash['question_bank']['questions_attributes'].values.inject(0) do |count, q|\n  # iterate over the answers\n  count += q['answers_attributes'].values.inject(0) do |a_count, a|\n    a_count += a['correctness'] == 'true' ? 1 : 0\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 7924652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLCAb.png?s=128&g=1", "display_name": "M\u1ea1nh V\u0169", "link": "https://stackoverflow.com/users/7924652/m%e1%ba%a1nh-v%c5%a9"}, "edited": false, "score": 0, "creation_date": 1534313539, "post_id": 51841068, "comment_id": 90659867, "body": "Thanks, this does the job well. Although I still don&#39;t quite understand how <code>reduce</code> work, ruby-doc is a little confusing"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 83, "user_id": 7924652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLCAb.png?s=128&g=1", "display_name": "M\u1ea1nh V\u0169", "link": "https://stackoverflow.com/users/7924652/m%e1%ba%a1nh-v%c5%a9"}, "edited": false, "score": 0, "creation_date": 1534320285, "post_id": 51841068, "comment_id": 90662388, "body": "It can be a confusing method. There&#39;s a good read <a href=\"https://medium.com/@james.a.hughes/using-the-reduce-method-in-ruby-907f3c18ae1f\" rel=\"nofollow noreferrer\">here</a>. In this case, at a very simple level, it simply makes a <code>hash</code> available alongside the values of the loop - similar to how, say, <code>each_with_index</code> makes the index available. Therefore, you use this hash to store the question names as keys, and add up the correct answers as values for this key. Hope that helps at little, and glad the answer worked :)"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": true, "score": 2, "last_activity_date": 1534248524, "creation_date": 1534248524, "answer_id": 51841068, "question_id": 51840500, "link": "https://stackoverflow.com/questions/51840500/how-to-count-number-of-appearance-of-a-specific-value-in-ruby-hash/51841068#51841068", "title": "How to count number of appearance of a specific value in Ruby hash?", "body": "<p>I interpreted this as looking for the number of correct answers to each question. If so, you can achieve this using the following:</p>\n\n<pre><code>your_hash['question_bank']['questions_attributes'].values.reduce(Hash.new(0)) do |hash, question| \n  question['answers_attributes'].each do |_k, answer| \n    hash[question['content']] += 1 if answer['correctness'] == 'true'\n  end\n  hash\nend\n</code></pre>\n\n<p>This gives the result:</p>\n\n<pre><code># =&gt; {\"question 1\"=&gt;1, \"q2\"=&gt;1, \"q3\"=&gt;1}\n</code></pre>\n\n<p>Basically, what the code does is:</p>\n\n<ul>\n<li>iterates through the questions, using <a href=\"https://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>reduce</code></a> to make a hash with a default value of <code>0</code> available</li>\n<li>loops through this question's answers, and adds <code>1</code> to the accompanying <code>hash[question_name]</code> (or <code>hash[question['content']]</code> in the example) when the answer is correct</li>\n<li>returns the accompanying hash</li>\n</ul>\n\n<p>If you're using Rails, which the reference to parameters perhaps hints at, consider using <a href=\"https://apidock.com/rails/Enumerable/each_with_object\" rel=\"nofollow noreferrer\"><code>each_with_object</code></a> rather than <code>reduce</code>; this way you can avoid the trailing <code>hash</code> in the example as it always returns the accumulator.</p>\n\n<p>Hope that helps - let me know if you've any questions.</p>\n"}], "owner": {"reputation": 83, "user_id": 7924652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLCAb.png?s=128&g=1", "display_name": "M\u1ea1nh V\u0169", "link": "https://stackoverflow.com/users/7924652/m%e1%ba%a1nh-v%c5%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 1, "accepted_answer_id": 51841068, "answer_count": 2, "score": 0, "last_activity_date": 1534252517, "creation_date": 1534246624, "question_id": 51840500, "link": "https://stackoverflow.com/questions/51840500/how-to-count-number-of-appearance-of-a-specific-value-in-ruby-hash", "title": "How to count number of appearance of a specific value in Ruby hash?", "body": "<p>I have a Ruby hash (originally was a param in rails)</p>\n\n<p>How can I count the number of <code>correctness</code> in each <code>answers_attributes</code> ?</p>\n\n<p>(Why I was doing this is I am trying to create an multiple-choice quiz by rails. One question may have many answers. I was trying to use <code>multi_correct</code> checkbox to decide which question has many correct answers. But that kinda counter-intuitive. So I want the back end to decide by counting the number of correctness in each question)</p>\n\n<pre><code>{\n  \"utf8\" =&gt; \"\u2713\", \"authenticity_token\" =&gt; \"r5xX46JG/GPF6+drEWmMPR+LpOI0jE0Tta/ABQ0rZJJE+UbbEjvNMLP6y2Z9IsWlXq27PR6Odx0EK4NECPjmzQ==\", \"question_bank\" =&gt; {\n    \"name\" =&gt; \"123213\", \"questions_attributes\" =&gt; {\n      \"0\" =&gt; {\n        \"content\" =&gt; \"question 1\", \"multi_correct\" =&gt; \"no\", \"answers_attributes\" =&gt; {\n          \"0\" =&gt; {\n            \"content\" =&gt; \"as1\", \"correctness\" =&gt; \"false\"\n          }, \"1\" =&gt; {\n            \"content\" =&gt; \"as2\", \"correctness\" =&gt; \"false\"\n          }, \"2\" =&gt; {\n            \"content\" =&gt; \"as3\", \"correctness\" =&gt; \"true\"\n          }, \"3\" =&gt; {\n            \"content\" =&gt; \"as4\", \"correctness\" =&gt; \"false\"\n          }\n        }\n      }, \"1\" =&gt; {\n        \"content\" =&gt; \"q2\", \"multi_correct\" =&gt; \"no\", \"answers_attributes\" =&gt; {\n          \"0\" =&gt; {\n            \"content\" =&gt; \"a1\", \"correctness\" =&gt; \"false\"\n          }, \"1\" =&gt; {\n            \"content\" =&gt; \"a2\", \"correctness\" =&gt; \"false\"\n          }, \"2\" =&gt; {\n            \"content\" =&gt; \"a3\", \"correctness\" =&gt; \"true\"\n          }, \"3\" =&gt; {\n            \"content\" =&gt; \"a4\", \"correctness\" =&gt; \"false\"\n          }\n        }\n      }, \"2\" =&gt; {\n        \"content\" =&gt; \"q3\", \"multi_correct\" =&gt; \"no\", \"answers_attributes\" =&gt; {\n          \"0\" =&gt; {\n            \"content\" =&gt; \"aa1\", \"correctness\" =&gt; \"false\"\n          }, \"1\" =&gt; {\n            \"content\" =&gt; \"aa2\", \"correctness\" =&gt; \"false\"\n          }, \"2\" =&gt; {\n            \"content\" =&gt; \"aa3\", \"correctness\" =&gt; \"false\"\n          }, \"3\" =&gt; {\n            \"content\" =&gt; \"aa4\", \"correctness\" =&gt; \"true\"\n          }\n        }\n      }\n    }\n  }, \"commit\" =&gt; \"Submit\"\n}\n</code></pre>\n"}, {"tags": ["ruby", "replace"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534246095, "post_id": 51840337, "comment_id": 90633611, "body": "Please provide a <b>valid</b> code sample. What is that &quot;variable&quot; supposed to be? A (multi-line) string? A file? A hash? 5 separate variables? (And not that it really matters, but your first mention of the <code>ip</code> is inconsistent/wrong.)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534246154, "post_id": 51840337, "comment_id": 90633656, "body": "What do you mean by &quot;get content of variable&quot;? What is that supposed to be?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534246480, "post_id": 51840337, "comment_id": 90633826, "body": "And what do you mean by &quot;replace 8 or 10 characters&quot;?? Do you actually mean something like &quot;redact the password; replace all of its characters with <code>*</code>&quot;? (Passwords may happen to be 8-10 characters, but I suspect that shouldn&#39;t be any limitation/assumption of your code.)"}], "answers": [{"comments": [{"owner": {"reputation": 80, "user_id": 5313686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7SvWFFK0Lac/AAAAAAAAAAI/AAAAAAAAELQ/Mo3KoyLacmw/photo.jpg?sz=128", "display_name": "Shan Sunny", "link": "https://stackoverflow.com/users/5313686/shan-sunny"}, "edited": false, "score": 0, "creation_date": 1534249121, "post_id": 51840590, "comment_id": 90635513, "body": "This is what I asked and it resolved my issue . Thank you very much Leo"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 1, "last_activity_date": 1534246935, "creation_date": 1534246935, "answer_id": 51840590, "question_id": 51840337, "link": "https://stackoverflow.com/questions/51840337/how-to-replace-charactors-after-a-matching-pattern-in-ruby/51840590#51840590", "title": "How to replace charactors after a matching pattern in Ruby", "body": "<p>Try something like this:</p>\n\n<pre><code>str = \"host = hostname , ip = 192.168.0.1 , username = user1 , password = mypwd , tag = test\"\nupdated_str = str.gsub(/(?&lt;=password\\s=\\s)[^,\\s]*/, 'new_pass')\n\nupdated_str #=&gt; \"host = hostname , ip = 192.168.0.1 , username = user1 , password = new_pas , tag = test\"\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 5313686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7SvWFFK0Lac/AAAAAAAAAAI/AAAAAAAAELQ/Mo3KoyLacmw/photo.jpg?sz=128", "display_name": "Shan Sunny", "link": "https://stackoverflow.com/users/5313686/shan-sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 51840590, "answer_count": 1, "score": -1, "last_activity_date": 1534249276, "creation_date": 1534245982, "last_edit_date": 1534249276, "question_id": 51840337, "link": "https://stackoverflow.com/questions/51840337/how-to-replace-charactors-after-a-matching-pattern-in-ruby", "title": "How to replace charactors after a matching pattern in Ruby", "body": "<p>I have a variable (Multiline string ) content like below </p>\n\n<pre><code>host = hostname ,\nip = 192.168.0.0.1 ,\nusername = user1 ,\npassword = mypwd ,\ntag = test\n</code></pre>\n\n<p>I want to mask\\replace my password, before writing to a file .<br>\nplease note: i may get content of variable like below also ( with single line )</p>\n\n<pre><code>host = hostname , ip = 192.168.0.1 , username = user1 , password = mypwd ,tag = test\n</code></pre>\n\n<p>In fact I want to replace 8 or 10 characters afer matching 'password'\nHow this can be active in Ruby ? (I use 2.5.1)\nAlso , variable content is not in Json format </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534245867, "post_id": 51840178, "comment_id": 90633456, "body": "Is that your actual code?"}, {"owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534245901, "post_id": 51840178, "comment_id": 90633482, "body": "Believe it or not, yes. Which is why I am perplexed"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1534246110, "post_id": 51840178, "comment_id": 90633623, "body": "Can you provide full part from the log?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1534246111, "post_id": 51840178, "comment_id": 90633625, "body": "So if you pry/debug/log/puts just before that line, and see <code>lab_attribs.class</code>, <code>lab_attribs</code>, <code>lab_attribs.method(:merge)</code>, <code>lab_attribs.merge({ full_name: &quot;full name&quot; })</code>... what do you get?"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1534246138, "post_id": 51840178, "comment_id": 90633638, "body": "<code>lab_attribs_to.to_h.merge(full_name: current_user.full_name)</code> try this."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1534246356, "post_id": 51840178, "comment_id": 90633762, "body": "What does <code>Lab.new</code> do? What does <code>Lab#save</code> do?"}, {"owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "edited": false, "score": 0, "creation_date": 1534246624, "post_id": 51840178, "comment_id": 90633899, "body": "Ok, so I modified my code to place debug information before the merge call. It still sees the lab_attribs variable as a hash. Updating post now. I have also tried restarting the server several times."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1534247005, "post_id": 51840178, "comment_id": 90634146, "body": "Could you paste backtrace of your error? (Sorry for endless requests, but this is very weird.)"}, {"owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "edited": false, "score": 0, "creation_date": 1534247572, "post_id": 51840178, "comment_id": 90634509, "body": "added some logs, there is no redacted code between the <code>logger.debug</code> and the usage of <code>lab_attribs.merge</code>"}, {"owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "edited": false, "score": 0, "creation_date": 1534247844, "post_id": 51840178, "comment_id": 90634690, "body": "I tried adding the <code>to_h</code> method as Gabbar suggested and that did not work and still produces the same error"}, {"owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "edited": false, "score": 0, "creation_date": 1534248769, "post_id": 51840178, "comment_id": 90635298, "body": "ok so i tried replacing the merge function with just a regular old lab_attribs[:full_name] = current_user.full_name and removed the merge code. there is definitely some code caching issues going on because it still sees the merge method"}], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "edited": false, "score": 0, "creation_date": 1534249955, "post_id": 51841234, "comment_id": 90635996, "body": "Yup, this was exactly the problem! I should have called the to_json method on the hash that makes up the <code>message</code> parameter of the publish function. The AWS SNS required the message to be a string and I had put the to_json in the wrong place. Unfortunately, Rails logs weren&#39;t verbose enough to make this immediately obvious."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 6, "last_activity_date": 1534249004, "creation_date": 1534249004, "answer_id": 51841234, "question_id": 51840178, "link": "https://stackoverflow.com/questions/51840178/why-is-this-hash-being-seen-as-a-string/51841234#51841234", "title": "Why is this Hash being seen as a String?", "body": "<p>That Hash is not being seen as a String; you're misreading the error.</p>\n\n<p>I'm not sure whether your backtrace is being surprisingly truncated by something, or you've just redacted the important part, but the error is not where you think it is.</p>\n\n<p>The fact you're calling <code>merge</code> is unrelated to your problem, which is that <a href=\"https://github.com/aws/aws-sdk-ruby/blob/a71396921d393d231a2614f82f108996a1a76d30/gems/aws-sdk-sns/lib/aws-sdk-sns/topic.rb#L279\" rel=\"noreferrer\">the <code>publish</code> method you are calling</a> calls <code>merge</code> on its argument... which you are passing as a <code>to_json</code>-built string, instead of the hash it expects.</p>\n\n<p>You need to remove the <code>.to_json</code> in your call.</p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1534250186, "post_id": 51841494, "comment_id": 90636138, "body": "This is provided that you want the message body as a JSON string."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1534250224, "last_edit_date": 1534250224, "creation_date": 1534249865, "answer_id": 51841494, "question_id": 51840178, "link": "https://stackoverflow.com/questions/51840178/why-is-this-hash-being-seen-as-a-string/51841494#51841494", "title": "Why is this Hash being seen as a String?", "body": "<p>Calling <code>to_json</code> on a hash converts it into a string.</p>\n\n<pre><code>irb(main):001:0&gt; { foo: 'bar' }.to_json.class\n=&gt; String\n</code></pre>\n\n<p>WHile the signature is <code>Aws::SNS::Topic#publish(options = {}) \u21d2 Types::PublishResponse</code>.</p>\n\n<p>So you should be calling it as:</p>\n\n<pre><code>topic.publish(\n  subject: 'LAB_COMPLETE', \n  message: lab_attribs.merge(full_name: current_user.full_name).to_json\n)\n</code></pre>\n\n<p>You can clean the whole messy example up by using an Active Job and some basic hash manipulation:</p>\n\n<pre><code># app/jobs/publish_job.rb\nclass PublishJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform(**options)\n    sns = Aws::SNS::Resource.new\n    topic = sns.topic(Rails.application.secrets.lab_results_topic)\n    topic.publish(options)\n  end\nend\n</code></pre>\n\n<hr>\n\n<pre><code># ...\ndef create\n  lab = Lab.new(lab_attributes)\n  if lab.save\n    PublishJob.perform_now(\n     subject: 'LAB_COMPLETE', \n     message: lab_attributes.merge(full_name: current_user.full_name).to_json\n    )\n    render json: { lab_name: lab.name }\n  else\n    render json: { status: 422, errors: lab.errors }\n  end\nend\n\nprivate \n\ndef lab_attributes\n  create_params.slice(:duration, :final_grade, :cpe, :user_id).merge(\n    completed: DateTime.now,\n    name: create_params[:lab_name]\n  )\nend\n</code></pre>\n"}], "owner": {"reputation": 735, "user_id": 2188368, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a0a43b221a642dda68bc5cb3296fdebf?s=128&d=identicon&r=PG", "display_name": "pyRabbit", "link": "https://stackoverflow.com/users/2188368/pyrabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 51841234, "answer_count": 2, "score": 0, "last_activity_date": 1534255818, "creation_date": 1534245475, "last_edit_date": 1534255818, "question_id": 51840178, "link": "https://stackoverflow.com/questions/51840178/why-is-this-hash-being-seen-as-a-string", "title": "Why is this Hash being seen as a String?", "body": "<h1>Problem</h1>\n\n<p>I am having a difficult time understanding why my Hash is being treated as a String when I call the <code>Hash#merge</code> function. When calling the following code, I receive a <code>NoMethodError method 'merge' for #&lt;String:0x000...</code></p>\n\n<p>The line of code that is throwing the error is the following: <code>topic.publish({subject: 'LAB_COMPLETE', message: lab_attribs.merge(full_name: current_user.full_name)}.to_json)</code>. For some reason, Ruby sees the <code>lab_attribs</code> variable as a String instead of a Hash. I can't possibly see how this would be true based on the source below. </p>\n\n<h1>Source</h1>\n\n<pre><code>lab_attribs = {\n    name: create_params['lab_name'],\n    completed: DateTime.now,\n    duration: create_params['duration'],\n    final_grade: create_params['final_grade'],\n    cpe: create_params['cpe'],\n    user_id: create_params['user_id']\n}\n\nlab = Lab.new(lab_attribs)\n\nif lab.save\n  logger.debug(\"lab_attribs class: #{lab_attribs.class}, lab_attribs value: #{lab_attribs}\" )\n  sns = Aws::SNS::Resource.new\n  topic = sns.topic(Rails.application.secrets.lab_results_topic)\n  topic.publish({subject: 'LAB_COMPLETE', message: lab_attribs.merge(full_name: current_user.full_name)}.to_json)\n\n  render json: { lab_name: lab.name }\nelse\n  render json: { status: 422, errors: lab.errors }\nend\n</code></pre>\n\n<h1>Relevant Information</h1>\n\n<p><code>logger.debug</code> outputs the following:</p>\n\n<pre><code>lab_attribs class: Hash, lab_attribs value: {:name=&gt;\"Updating Firewall Rules\", :completed=&gt;Tue, 14 Aug 2018 11:36:01 +0000, :duration=&gt;\"1 minute\", :final_grade=&gt;\"0\", :cpe=&gt;\"0\", :user_id=&gt;\"&lt;snipped&gt;\"}\n</code></pre>\n\n<ul>\n<li><strong>Ruby version</strong>: 2.3.1</li>\n<li><strong>Rails version</strong>: 5.1</li>\n</ul>\n\n<h1>Logs</h1>\n\n<pre><code>I, [2018-08-14T11:36:00.943514 #1930]  INFO -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb] Started POST \"/api/v1/labs\" for 172.68.65.103 at 2018-08-14 11:36:00 +0000\nI, [2018-08-14T11:36:00.946228 #1930]  INFO -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb] Processing by Api::V1::LabsController#create as */*\nI, [2018-08-14T11:36:00.946311 #1930]  INFO -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb]   Parameters: {\"lab\"=&gt;{\"lab_name\"=&gt;\"[FILTERED]\", \"task1\"=&gt;\"Saved a local copy of the firewall rules\", \"score1\"=&gt;\"0\", \"weight1\"=&gt;\"50\", \"task2\"=&gt;\"Blocked port 3600\", \"score2\"=&gt;\"0\", \"weight2\"=&gt;\"50\", \"final_grade\"=&gt;\"0\", \"cpe\"=&gt;\"0\", \"duration\"=&gt;\"1 minute\", \"user_id\"=&gt;\"&lt;snipped&gt;\"}}\n...&lt;snipped DB calls&gt;... \nD, [2018-08-14T11:36:01.408369 #1930] DEBUG -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb] lab_attribs class: Hash, lab_attribs value: {:name=&gt;\"Updating Firewall Rules\", :completed=&gt;Tue, 14 Aug 2018 11:36:01 +0000, :duration=&gt;\"1 minute\", :final_grade=&gt;\"0\", :cpe=&gt;\"0\", :user_id=&gt;\"&lt;snipped&gt;\"}\nI, [2018-08-14T11:36:01.414112 #1930]  INFO -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb] Completed 500 Internal Server Error in 468ms (ActiveRecord: 26.7ms)\nF, [2018-08-14T11:36:01.414612 #1930] FATAL -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb]   \nF, [2018-08-14T11:36:01.414689 #1930] FATAL -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb] NoMethodError (undefined method `merge' for #&lt;String:0x0055e4df9d9558&gt;):\nF, [2018-08-14T11:36:01.414720 #1930] FATAL -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb]   \nF, [2018-08-14T11:36:01.414758 #1930] FATAL -- : [d9f4566a-5b25-4e07-ace3-06f301ecf0cb] app/controllers/api/v1/labs_controller.rb:30:in `create'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "passenger", "phusion"], "comments": [{"owner": {"reputation": 533, "user_id": 2504691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b92de7de2771f0e07a48626a5626c?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/2504691/navin"}, "edited": false, "score": 0, "creation_date": 1534317284, "post_id": 51839576, "comment_id": 90661193, "body": "try with worker_processes  2; passenger_max_pool_size 20;passenger_min_instances 1;"}, {"owner": {"reputation": 75, "user_id": 9261239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31cd18c6e52b1b22980dec7cd9a868a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thomas", "link": "https://stackoverflow.com/users/9261239/robert-thomas"}, "reply_to_user": {"reputation": 533, "user_id": 2504691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b92de7de2771f0e07a48626a5626c?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/2504691/navin"}, "edited": false, "score": 0, "creation_date": 1534929046, "post_id": 51839576, "comment_id": 90876954, "body": "worker_processes 4; #Its set to 4 now and queue looks normal"}, {"owner": {"reputation": 533, "user_id": 2504691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b92de7de2771f0e07a48626a5626c?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/2504691/navin"}, "edited": false, "score": 0, "creation_date": 1535376984, "post_id": 51839576, "comment_id": 91031733, "body": "Before that please calculate optimal NGINX config. Otherwise your memory will overshoot. please check this thread: <a href=\"https://serverfault.com/questions/281199/nginx-how-do-i-calculate-an-optimal-no-of-worker-processes-and-worker-connecti\" title=\"nginx how do i calculate an optimal no of worker processes and worker connecti\">serverfault.com/questions/281199/&hellip;</a>"}], "owner": {"reputation": 75, "user_id": 9261239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31cd18c6e52b1b22980dec7cd9a868a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thomas", "link": "https://stackoverflow.com/users/9261239/robert-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534246114, "creation_date": 1534243436, "last_edit_date": 1534246114, "question_id": 51839576, "link": "https://stackoverflow.com/questions/51839576/requests-in-queue", "title": "Requests in queue", "body": "<p>I am using phusion passenger open source but facing few problems</p>\n\n<p>Passenger Version: 5.1.12\nNginx Version: 1.12.2</p>\n\n<p>The site which we are using have 300+ users at a time, But within 5 minutes\n<code>Requests in queue: 100</code> Sites get unresponsive</p>\n\n<p>After a minute queue reduces to 0. It means no process is going to infinite its completing after a few minutes but this happens continuously. </p>\n\n<p>I have set</p>\n\n<pre><code>passenger_max_pool_size 19;\npassenger_min_instances 5;\n</code></pre>\n\n<p>We have <code>2 m4.xlarge</code> Aws instance with an ELB attached.</p>\n\n<p>Using Rails 4 in backend</p>\n\n<p>Earlier we had used puma and never faced this issue. Please suggest as am not getting any solutions.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 2, "creation_date": 1534244733, "post_id": 51839522, "comment_id": 90632806, "body": "Do you not need to throw the dice inside the loop?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1534245540, "post_id": 51839522, "comment_id": 90633252, "body": "FYI <code>rand(1..6)</code> returns a random number 1 \u2264 n \u2264 6 right away, so you don&#39;t have to adjust it afterwards."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534265985, "post_id": 51839522, "comment_id": 90646148, "body": "What are the rules of each round of the dice game? Are we to figure that out from the code? Please edit to explain how the game works. For example, in each round do both player throw two dice and the winner is the one whose sum of dots on the two dice is greatest? If so, what about ties?"}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 0, "last_activity_date": 1534257458, "creation_date": 1534257458, "answer_id": 51843985, "question_id": 51839522, "link": "https://stackoverflow.com/questions/51839522/ruby-how-do-you-use-a-while-loop-and-conditional-statement-in-a-2-player-dice/51843985#51843985", "title": "Ruby - How do you use a while loop and conditional statement in a 2 Player Dice Game?", "body": "<p>As stated in comments, you need to throw dices inside the loop.</p>\n\n<p>For example defining a method that returns an array with the two results.</p>\n\n<pre><code>def throw_dices\n  return rand(1..6), rand(1..6)\nend\n</code></pre>\n\n<p>You can assign the result to the variables using <a href=\"https://ruby-doc.org/core-2.5.0/doc/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decomposition</a>:</p>\n\n<pre><code>player_1, player_2 = throw_dices\n</code></pre>\n\n<p>Once you have the method you can use it inside the loop.</p>\n\n<pre><code>player_1_score = 0\nplayer_2_score = 0\n\nwhile true do\n  player_1, player_2 = throw_dices # here is the decomposition\n  puts \"player_1: #{player_1} - player_2: #{player_2}\" # print the throw result or whatever\n  player_1_score += 1 if player_1 &gt; player_2\n  player_2_score += 1 if player_2 &gt; player_1\n  break if player_1_score == 2 || player_2_score == 2\nend\n\np player_1_score\np player_2_score\n# do whatever you want with the final score.\n</code></pre>\n\n<p>Note also the use of <a href=\"https://ruby-doc.org/core-2.5.0/doc/syntax/assignment_rdoc.html#label-Abbreviated+Assignment\" rel=\"nofollow noreferrer\">abbreviated assignments</a>: <code>player_1_score += 1</code></p>\n"}], "owner": {"reputation": 85, "user_id": 10223946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l3cVRVRJrg8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oyrALAGfKO1OKyj9PIdBHqe0fKCg/mo/photo.jpg?sz=128", "display_name": "dwalsh91", "link": "https://stackoverflow.com/users/10223946/dwalsh91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 51843985, "answer_count": 1, "score": 0, "last_activity_date": 1534257458, "creation_date": 1534243278, "last_edit_date": 1534243678, "question_id": 51839522, "link": "https://stackoverflow.com/questions/51839522/ruby-how-do-you-use-a-while-loop-and-conditional-statement-in-a-2-player-dice", "title": "Ruby - How do you use a while loop and conditional statement in a 2 Player Dice Game?", "body": "<p>New to programming and trying to create a very basic two player dice throwing game in Ruby using while loops with conditional breaks.</p>\n\n<p>I need it to play several rounds for each game - the first player to win two rounds wins the game (with two dice each)</p>\n\n<p>So far I have come up with:</p>\n\n<pre><code>player_1 = 2 + rand(6) + rand(6) #generates number between 1-12 (simulating two dice being thrown)\nplayer_2 = 2 + rand(6) + rand(6)\n\nputs player_1\nputs player_2\n\nplayer_1_score = 0\nplayer_2_score = 0\n\nwhile true do\n  if player_1 &gt; player_2\n    return player_1_score = player_1_score + 1\n  elsif player_2 &gt; player_1\n    return player_2_score = player_2_score + 1\n  end\n  if player_1_score == 2\n    puts \"Player 1 wins!\"\n    break\n  elsif player_2_score == 2\n    puts \"Player 2 wins!\"\n    break\n  end\nend\n</code></pre>\n\n<p>At the moment it is only producing the two random numbers, no error messages. I need to it to produce a number of rounds and either \"Player 1 wins!\" or \"Player 2 wins!\" when one of them has won two rounds.</p>\n\n<p>Am I on the right track or missing something completely?</p>\n\n<p>Can you have more than one if statement in a while loop?</p>\n\n<p>Any help on understanding while loops would be really appreciated!\nThanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "httparty"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1534234670, "post_id": 51836680, "comment_id": 90626817, "body": "while making the request with some client to external service, ruby(or in general any tcp client) would create a socket and assign port from the <a href=\"https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml\" rel=\"nofollow noreferrer\">dynamic range (49152-65535)</a>. You should probably get them whitelisted as source port."}], "answers": [{"comments": [{"owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1534240846, "post_id": 51837467, "comment_id": 90630519, "body": "Thanks, got it. Now interestingly <code>HTTParty.get &#39;http:&#47;&#47;google.com&#39;</code> works fine, but <code>HTTParty.get &#39;http:&#47;&#47;google.com&#39;, local_port: 60000</code> (or any other valid port) yields &quot;Errno::EHOSTUNREACH: Failed to open TCP connection to google.com:80 (No route to host - connect(2) for &quot;google.com&quot; port 80)&quot;"}, {"owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "reply_to_user": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1534241076, "post_id": 51837467, "comment_id": 90630656, "body": "maybe you simply can&#39;t use port 60000?"}, {"owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1534241183, "post_id": 51837467, "comment_id": 90630725, "body": "For a <b>forbidden</b> port (e.g. 10) I am getting an explicit forbidden error &quot;Errno::EACCES: Failed to open TCP connection to google.com:80 (Permission denied - bind(2) for nil port 10)&quot; vs. the error above."}, {"owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "reply_to_user": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "edited": false, "score": 0, "creation_date": 1534243449, "post_id": 51837467, "comment_id": 90632001, "body": "@AlexanderPresber I was not talking about a forbidden port, but anyway the error is not what I though. I&#39;m still looking for the exact reason <b>why</b> it doesn&#39;t work, but in the mean time I updated my answer with a solution, you have to provide the local_host too ;-)"}], "tags": [], "owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "is_accepted": true, "score": 2, "last_activity_date": 1534246729, "last_edit_date": 1534246729, "creation_date": 1534236825, "answer_id": 51837467, "question_id": 51836680, "link": "https://stackoverflow.com/questions/51836680/outgoing-ports-for-making-http-requests-from-ruby-on-rails-app/51837467#51837467", "title": "Outgoing ports for making HTTP requests from Ruby on Rails app", "body": "<h2>Solution</h2>\n\n<p>I just saw the <a href=\"/questions/tagged/httparty\" class=\"post-tag\" title=\"show questions tagged &#39;httparty&#39;\" rel=\"tag\">httparty</a>, for which you can use the <code>:local_port</code> and <code>:local_host</code> request option:</p>\n\n<p>Apparently, you have to specify the local_host if you want to specify local_port, which is a limitation going all the way down to <code>Socket</code>, and maybe event <code>connect(2)</code></p>\n\n<pre><code># Get the first local IP address which is not the loopback\n# There are far better way of doing this, this is just for the example\naddr = Socket.ip_address_list.select(&amp;:ipv4?).detect{|addr| addr.ip_address != '127.0.0.1'}\n\n# Start a connection using a predefined port\nHTTParty.get 'http://google.com', local_port: 60000, local_host: addr.ip_address\n</code></pre>\n\n<hr>\n\n<p>The reason for which we have to specify both local_host and local_port if we want to override the local port is that Socket uses <code>Addrinfo.getaddrinfo</code>, which returns loopback addresses if only the port is specified.</p>\n\n<p>This is due to <code>getaddrinfo(3)</code>:</p>\n\n<blockquote>\n  <p>If the AI_PASSIVE flag is not set in hints.ai_flags, then the returned socket addresses will be suitable for use with connect(2), sendto(2), or sendmsg(2). If node is NULL, then the network address will be set to the loopback  interface  address  (INADDR_LOOPBACK for IPv4 addresses, IN6ADDR_LOOPBACK_INIT for IPv6 address); this is used by applications that intend to  communicate  with peers running on the same host.</p>\n</blockquote>\n\n<p>And AI_PASSIVE is not set in this case, as we don't want to <code>bind</code> but to <code>connect</code>.</p>\n\n<p>Using the loopback address, the outside network is thus unreachable, which is why we need to specifcy the local_host too.</p>\n\n<hr>\n\n<h3>original answer</h3>\n\n<p>You can do this by first creating the <code>Net::HTTP</code> instance then configuring <code>local_port</code> (a R/W attribute) before starting the connection.</p>\n\n<p>If you use any other mean for establishing the connection, you might want to check the documentation to see if there's such method available.</p>\n\n<pre><code>http = Net::HTTP.new(address, port)\nhttp.local_port = 666\nhttp.local_host = 'your ip address'\nhttp.start do\n  # whatever\nend\n</code></pre>\n\n<p>The <code>local_port</code> is an <code>attr_accessor</code> and <code>@local_port</code> is used directly to open the TCP socket: <code>TCPSocket.open(conn_address, conn_port, @local_host, @local_port)</code></p>\n"}], "owner": {"reputation": 5647, "user_id": 1162143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rLSfS.jpg?s=128&g=1", "display_name": "Alexander Presber", "link": "https://stackoverflow.com/users/1162143/alexander-presber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "accepted_answer_id": 51837467, "answer_count": 1, "score": 1, "last_activity_date": 1534246729, "creation_date": 1534234258, "question_id": 51836680, "link": "https://stackoverflow.com/questions/51836680/outgoing-ports-for-making-http-requests-from-ruby-on-rails-app", "title": "Outgoing ports for making HTTP requests from Ruby on Rails app", "body": "<p>My application (Ruby on Rails using jRuby, on puma, on nginx on CentOS 6) wants to make direct server-to-server requests to a remote REST API service. \nMy app is in a different network from the service's network, meaning the IT department has to configure the firewall so that these requests are allowed. </p>\n\n<p>They want to know</p>\n\n<ul>\n<li>the source (IP and port) and</li>\n<li>the target (IP and port)</li>\n</ul>\n\n<p>Everything is pretty straightforward except the <strong>source port</strong>. Is it even possible to have my application use just one port? If not, can I at least give a range of ports? How is this configured?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1534230185, "post_id": 51835393, "comment_id": 90624494, "body": "What is the role of <code>group_by</code> in your question?"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534232264, "post_id": 51835393, "comment_id": 90625567, "body": "@JagdeepSingh I don&#39;t want to pass queries to db . i want to use a ruby command to fetch the first two record. So can i use group_by for that?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534233660, "post_id": 51835393, "comment_id": 90626277, "body": "Do you want the topics with zero posts to be displayed?"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534233770, "post_id": 51835393, "comment_id": 90626334, "body": "@JagdeepSingh No i want to display the first two posts associated with each topic. But without using any queries like limit,last"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534233894, "post_id": 51835393, "comment_id": 90626407, "body": "I get it you want the first two posts of each topic to be displayed. But what about the topics which have zero posts? Should they be displayed?"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534234331, "post_id": 51835393, "comment_id": 90626649, "body": "@JagdeepSingh Then it should just display the topic"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230408, "post_id": 51835533, "comment_id": 90624623, "body": "I\u2019d also mention that maybe <code>#all</code> is the evilest in this approach."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230542, "post_id": 51835533, "comment_id": 90624689, "body": "@mudasobwa yes , updated my answer. i feel proud when i legend comment on my answer :)"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230781, "post_id": 51835533, "comment_id": 90624825, "body": "@mudasobwa ohh okay. i forget in hurry :)"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534232147, "post_id": 51835533, "comment_id": 90625506, "body": "@mudasobwa i shouldn&#39;t use limit. Can i do by ruby group_by to get first two record"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534232451, "post_id": 51835533, "comment_id": 90625677, "body": "Why do you <i>really</i> want to use <code>group_by</code>? What benefit (do you think) it will provide?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 1, "creation_date": 1534232489, "post_id": 51835533, "comment_id": 90625694, "body": "@NARENPUSHPARAJU there is obviously no way to retrieve a limited amount of whatever without limiting the amount. You might load the whole bunch of everything but this is such an anti-pattern that I reject showing the approach."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534392477, "post_id": 51835533, "comment_id": 90690464, "body": "@NARENPUSHPARAJU can you please accept this answer ?"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534407459, "post_id": 51835533, "comment_id": 90696467, "body": "@Vishal Sorry i can&#39;t. I asked for ruby code. But you gave me using query. This too is a very good solution which i appreciate"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534407651, "post_id": 51835533, "comment_id": 90696583, "body": "@NARENPUSHPARAJU it means code quality, performance and other things arent&#39;t matter for you :) . good . keep it up."}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534407928, "post_id": 51835533, "comment_id": 90696736, "body": "@Vishal It&#39;s been a month i started learning RoR, at this time I don&#39;t want quality but the answer later surely i nee quality and performance."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534408126, "post_id": 51835533, "comment_id": 90696850, "body": "@NARENPUSHPARAJU great thinking . keep it up :)"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534408256, "post_id": 51835533, "comment_id": 90696925, "body": "@NARENPUSHPARAJU and you are accepted -3 voted answer. hahahahhahaha.. keep it up man.. :D"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534408337, "post_id": 51835533, "comment_id": 90696964, "body": "@Vishal It&#39;s very good that you are insisting others to accept your answer. Keep it up"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534408472, "post_id": 51835533, "comment_id": 90697046, "body": "@Vishal Everything is fine with his answer. It doesn&#39;t produce any N+1 query also. Please recheck his answer."}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 4, "last_activity_date": 1534230526, "last_edit_date": 1534230526, "creation_date": 1534230203, "answer_id": 51835533, "question_id": 51835393, "link": "https://stackoverflow.com/questions/51835393/how-to-get-the-first-two-records-by-simply-ruby-codenot-using-queries/51835533#51835533", "title": "How to get the first two records by simply ruby code(not using queries)", "body": "<p>Create new association which takes only 2 records of associated model posts.</p>\n\n<p>topic.rb</p>\n\n<pre><code>has_many :recent_posts, -&gt; { limit(2) }, class_name: 'Post'\n</code></pre>\n\n<p>topics_controller.rb</p>\n\n<pre><code>class TopicsController &lt; ApplicationController\n  before_action :set_topic, only: [:show, :edit, :destroy, :update]\n  def index\n    @topics = Topic.includes(:recent_posts)\n  end\nend\n</code></pre>\n\n<p>In your view </p>\n\n<pre><code>&lt;h1&gt;Topics&lt;/h1&gt;\n&lt;table class=\"table\"&gt;\n  &lt;% @topics.each do |t| %&gt;\n    &lt;%= link_to t.topic,topic_posts_path(topic_id: t.id) %&gt;&lt;%= \"(# . \nt.posts_count})\" %&gt;&lt;br&gt;\n    &lt;% t.recent_posts.each do |p| %&gt;\n      &lt;li&gt;\n        &lt;%=link_to p.title,topic_post_path(topic_id: p.topic_id,id: p.id) %&gt;&lt;br&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;%= link_to \"more..\", topic_posts_path(t.id)%&gt;&lt;br&gt;\n   &lt;% end %&gt;&lt;br&gt;\n  &lt;%= link_to \"Add Topic\",new_topic_path %&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230343, "post_id": 51835551, "comment_id": 90624581, "body": "Without an explicit <code>includes</code> as shown in the correct answer by @Vishal this will produce <code>N+1</code>."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230611, "post_id": 51835551, "comment_id": 90624726, "body": "@mudasobwa Did i misunderstand the question? <code>can I do this using ruby without passing any query to db?</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230683, "post_id": 51835551, "comment_id": 90624778, "body": "The code you have provided passes an additional query to DB here: <code>@posts= t.posts</code>. <code>Topic.all</code> does not load associations from the database by default."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534230954, "post_id": 51835551, "comment_id": 90624910, "body": "@mudasobwa In that way in controller it should be <code>@topics = Topic.includes(:posts)</code>, But so far as user&#39;s question concerned which is without using db query and using simple ruby, my answer should not be down voted. However i appreciate the answer provided in standard way."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1534231167, "post_id": 51835551, "comment_id": 90625010, "body": "Your answer surely should be downvoted because it does not decrease a number of database queries by any mean. Open a console and check. Once again: <code>@posts = t.posts</code> <b>executes a query against database</b>."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534233135, "post_id": 51835551, "comment_id": 90626038, "body": "@NARENPUSHPARAJU Why do you need to us <code>group_by</code> in simple ruby you can use each_with_index to limit first 2 post."}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534233466, "post_id": 51835551, "comment_id": 90626186, "body": "@Gabbar Yeah your&#39;s answer is correct. My guide asked me to use group_by thats&#39;s why i&#39;m so curious about that"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534233835, "post_id": 51835551, "comment_id": 90626365, "body": "@NARENPUSHPARAJU I am curious, how is this an accepted answer even though you really need an answer using <code>group_by</code>. Needless to mention it doesn&#39;t reduce the database queries. So, there are better answers here."}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534234115, "post_id": 51835551, "comment_id": 90626525, "body": "@JagdeepSingh He gave me the answer to use by each_with index which doesn&#39;t pass any query to my db which i wanted. But yeah you are correct his answer doesn&#39;t give the answer i expected. Unaccepted ."}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534234402, "post_id": 51835551, "comment_id": 90626690, "body": "@JagdeepSingh I used includes(:posts) in my topic so N+1 is solved"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534234673, "post_id": 51835551, "comment_id": 90626819, "body": "@JagdeepSingh After using includes(:post) it should reduce N+1 query, which i mentioned in answer, and if you are talking about coding standard, vishal has given good answer in that case, i don&#39;t know why my answer should be down-voted,  although i have answer as per user requirement. please cross check it."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534234724, "post_id": 51835551, "comment_id": 90626855, "body": "@NARENPUSHPARAJU Feel free to accept/upvote answer if you this answer fullfill your requirement. thanks anyway."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534234795, "post_id": 51835551, "comment_id": 90626888, "body": "@Gabbar it was downvoted (at least by me) when there were N+1 queries. Can&#39;t revert it now due to time constraint."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534234990, "post_id": 51835551, "comment_id": 90627005, "body": "@JagdeepSingh By upvote you can revert it :D. believe me i can&#39;t write that dirty answer, i just followed user requirement . anyway leave it  thanks :)"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534235011, "post_id": 51835551, "comment_id": 90627013, "body": "@Gabbar Okay . Your answer worked superbly. But it doesn&#39;t solved what my guide said. Anyway Thank you for your answer. I will discuss your answer with my guide"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534235088, "post_id": 51835551, "comment_id": 90627059, "body": "@NARENPUSHPARAJU Glad to know that, by accepting or upvoting answer you can say me thanks."}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534235184, "post_id": 51835551, "comment_id": 90627129, "body": "@JagdeepSingh His answer doesn&#39;t have N+1 query issue"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534235233, "post_id": 51835551, "comment_id": 90627157, "body": "@NARENPUSHPARAJU check my last comment. That accepts it."}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534235267, "post_id": 51835551, "comment_id": 90627172, "body": "@Gabbar Accepted. But did you know how to use by group_by"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534235454, "post_id": 51835551, "comment_id": 90627283, "body": "@NARENPUSHPARAJU Yes, i do, but so far as i think you don&#39;t have clarity of your requirement, there is no point to use group_by here, but i can give you some references for that   1 =&gt; <a href=\"https://apidock.com/ruby/Enumerable/group_by\" rel=\"nofollow noreferrer\">apidock.com/ruby/Enumerable/group_by</a> 2=&gt; <a href=\"https://stackoverflow.com/questions/18920877/ruby-array-of-hash-group-by-and-modify-in-one-line\" title=\"ruby array of hash group by and modify in one line\">stackoverflow.com/questions/18920877/&hellip;</a> 3=&gt; <a href=\"http://markusjais.com/the-group_by-method-from-rubys-enumerable-mixin-and-compared-with-scal/\" rel=\"nofollow noreferrer\">markusjais.com/&hellip;</a>"}, {"owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "edited": false, "score": 0, "creation_date": 1534235630, "post_id": 51835551, "comment_id": 90627396, "body": "@Gabbar Thank you  i will refer those."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": -3, "last_activity_date": 1534231384, "last_edit_date": 1534231384, "creation_date": 1534230263, "answer_id": 51835551, "question_id": 51835393, "link": "https://stackoverflow.com/questions/51835393/how-to-get-the-first-two-records-by-simply-ruby-codenot-using-queries/51835551#51835551", "title": "How to get the first two records by simply ruby code(not using queries)", "body": "<blockquote>\n  <p>but can I do this using ruby without passing any query to db?</p>\n</blockquote>\n\n<p>yes you can.\nController </p>\n\n<pre><code>  def index\n    @topics = Topic.includes(:posts)\n  end\n</code></pre>\n\n<p>View</p>\n\n<pre><code>&lt;h1&gt;Topics&lt;/h1&gt;\n&lt;table class=\"table\"&gt;\n&lt;% @topics.each do |t| %&gt;\n  &lt;%= link_to t.topic,topic_posts_path(topic_id: t.id) %&gt;&lt;%= \"(# . \nt.posts_count})\" %&gt;&lt;br&gt;\n  &lt;%@posts= t.posts%&gt;\n  &lt;% @posts.each_with_index do |p, index| %&gt;\n    &lt;%if index &lt;= 1%&gt;\n      &lt;li&gt;\n        &lt;%=link_to p.title,topic_post_path(topic_id: p.topic_id,id: p.id) %&gt;&lt;br&gt;\n      &lt;/li&gt;\n    &lt;%end%&gt;\n  &lt;%end%&gt;\n  &lt;%= link_to \"more..\", topic_posts_path(t.id)%&gt;&lt;br&gt;\n  &lt;br&gt;\n&lt;%= link_to \"Add Topic\",new_topic_path %&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 1, "creation_date": 1534231110, "post_id": 51835716, "comment_id": 90624980, "body": "Sorry , but last <code>.last(2)</code> will internally fire <code>limit 2</code>, query which is a sql query."}], "tags": [], "owner": {"reputation": 162, "user_id": 7627958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH5hS.jpg?s=128&g=1", "display_name": "Rashid D R", "link": "https://stackoverflow.com/users/7627958/rashid-d-r"}, "is_accepted": false, "score": -2, "last_activity_date": 1534230994, "creation_date": 1534230994, "answer_id": 51835716, "question_id": 51835393, "link": "https://stackoverflow.com/questions/51835393/how-to-get-the-first-two-records-by-simply-ruby-codenot-using-queries/51835716#51835716", "title": "How to get the first two records by simply ruby code(not using queries)", "body": "<p>You can use <code>@post.last(2)</code> which is a ruby method.</p>\n"}], "owner": {"reputation": 145, "user_id": 9141605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c07479c72cdafae05f442089587400b?s=128&d=identicon&r=PG&f=1", "display_name": "NAREN PUSHPARAJU", "link": "https://stackoverflow.com/users/9141605/naren-pushparaju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 51835551, "answer_count": 3, "score": 0, "last_activity_date": 1534235343, "creation_date": 1534229715, "last_edit_date": 1534235343, "question_id": 51835393, "link": "https://stackoverflow.com/questions/51835393/how-to-get-the-first-two-records-by-simply-ruby-codenot-using-queries", "title": "How to get the first two records by simply ruby code(not using queries)", "body": "<p>My topic model is </p>\n\n<pre><code>class Topic &lt; ActiveRecord::Base\n  has_many :posts\n  accepts_nested_attributes_for :posts\n  validates_presence_of :topic\n  validates :topic, length: { minimum: 3 }\nend\n</code></pre>\n\n<p>My post model is</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  belongs_to :topic, counter_cache: true\n  validates_length_of :title ,:minimum =&gt; 3\n  validates_length_of :description,:minimum =&gt; 5\nend\n</code></pre>\n\n<p>My Topic controller is </p>\n\n<pre><code>class TopicsController &lt; ApplicationController\n  before_action :set_topic, only: [:show, :edit, :destroy, :update]\n  def index\n    @topics = Topic.all\n  end\nend\n</code></pre>\n\n<p>My Topic index is</p>\n\n<pre><code>&lt;h1&gt;Topics&lt;/h1&gt;\n&lt;table class=\"table\"&gt;\n  &lt;% @topics.each do |t| %&gt;\n    &lt;%= link_to t.topic,topic_posts_path(topic_id: t.id) %&gt;&lt;%= \"(# . \nt.posts_count})\" %&gt;&lt;br&gt;\n    &lt;% @post= t.posts.limit(2) %&gt;\n    &lt;% @post.each do |p| %&gt;\n      &lt;li&gt;\n        &lt;%=link_to p.title,topic_post_path(topic_id: p.topic_id,id: p.id) %&gt;&lt;br&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;%= link_to \"more..\", topic_posts_path(t.id)%&gt;&lt;br&gt;\n   &lt;% end %&gt;&lt;br&gt;\n  &lt;%= link_to \"Add Topic\",new_topic_path %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I want to display the first two posts associated with the topic in the topic's index. I used <code>limit</code> for that, but can I do this using ruby without passing any query to db?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1534221701, "last_edit_date": 1534221701, "creation_date": 1534221480, "answer_id": 51833798, "question_id": 51833700, "link": "https://stackoverflow.com/questions/51833700/sql-how-to-check-if-column-contains-letters-in-it/51833798#51833798", "title": "SQL: how to check if column contains letters in it", "body": "<p>PostgreSQL <a href=\"https://www.postgresql.org/docs/9.3/static/functions-matching.html#FUNCTIONS-POSIX-TABLE\" rel=\"noreferrer\">supports</a> POSIX regular expressions:</p>\n\n<pre><code>SELECT applications.ic\nFROM applications\nWHERE applications.ic ~ '^\\d+$'\n</code></pre>\n\n<p>The regular expression here is:</p>\n\n<ul>\n<li><code>^</code>\u00a0\u2014 matches the beginning of the string</li>\n<li><code>\\d</code>\u00a0\u2014 matches a digit</li>\n<li><code>+</code>\u00a0\u2014 one or more modifier applied to the previous matcher</li>\n<li><code>$</code>\u00a0\u2014 matches the end of the string</li>\n</ul>\n"}], "owner": {"reputation": 159, "user_id": 5681091, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/535b627e4c3724560294d4ea3ce585c6?s=128&d=identicon&r=PG&f=1", "display_name": "bilal", "link": "https://stackoverflow.com/users/5681091/bilal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 51833798, "answer_count": 1, "score": 0, "last_activity_date": 1534221827, "creation_date": 1534220771, "last_edit_date": 1534221827, "question_id": 51833700, "link": "https://stackoverflow.com/questions/51833700/sql-how-to-check-if-column-contains-letters-in-it", "title": "SQL: how to check if column contains letters in it", "body": "<p>So basically i have an ic column in my db:\nic only contains numbers but the field is a string so people can add passport also.\ni want to write a query where it only shows me ic which are only numbers:</p>\n\n<pre><code>SELECT applications.ic\nFROM applications\nWHERE applications LIKE '%[^0-9]%'\n</code></pre>\n\n<p>But it dosent work!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1534217709, "post_id": 51833327, "comment_id": 90620568, "body": "You can use <code>before_commit :update_quantity, on: :create</code> or you can use <code>before_create :update_quantity</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8752844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c052ce7984ee9baeedae36da0bc959?s=128&d=identicon&r=PG&f=1", "display_name": "Jean Malan", "link": "https://stackoverflow.com/users/8752844/jean-malan"}, "edited": false, "score": 0, "creation_date": 1534300448, "post_id": 51835274, "comment_id": 90657066, "body": "Yes!! Thanks so much - really appreciate the help. Needed to upgrade to Rails 5 at some point and now you&#39;ve given me all the reason to!"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 3, "user_id": 8752844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c052ce7984ee9baeedae36da0bc959?s=128&d=identicon&r=PG&f=1", "display_name": "Jean Malan", "link": "https://stackoverflow.com/users/8752844/jean-malan"}, "edited": false, "score": 0, "creation_date": 1534303980, "post_id": 51835274, "comment_id": 90657746, "body": "@JeanMalan you can thank me by accepting/upvoting the answer if it helped you. :)"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 3, "user_id": 8752844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c052ce7984ee9baeedae36da0bc959?s=128&d=identicon&r=PG&f=1", "display_name": "Jean Malan", "link": "https://stackoverflow.com/users/8752844/jean-malan"}, "edited": false, "score": 0, "creation_date": 1534997862, "post_id": 51835274, "comment_id": 90906279, "body": "@JeanMalan Kindly accept the answer for future SO searchers as well. thanks"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1534229308, "creation_date": 1534229308, "answer_id": 51835274, "question_id": 51833327, "link": "https://stackoverflow.com/questions/51833327/how-to-update-associated-records-from-nested-form-values/51835274#51835274", "title": "How to update associated records from nested form values", "body": "<blockquote>\n  <p>How do I limit the method to only the entries that have been created?</p>\n</blockquote>\n\n<p>=> <code>before_save</code> is called every time an object is <code>saved</code>. So for new and existing objects. (create and update action)</p>\n\n<p>=> <code>before_create</code> only before creation. So only for new objects (create action)</p>\n\n<p>=> Rails 5 has <code>after_create_commit</code> <code>after_update_commit</code> and <code>after_destroy_commit</code> (<code>after_commit</code> is called after a record has been created, updated or destroyed.)</p>\n\n<p>So, you can do this as: -</p>\n\n<pre><code>class PurchaseEntry &lt; ActiveRecord::Base\n  after_create_commit :update_quantity\n\n  belongs_to :product\n\n  def update_quantity \n    if product.present?\n      product.update_quantity\n    end\n  end \nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8752844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c052ce7984ee9baeedae36da0bc959?s=128&d=identicon&r=PG&f=1", "display_name": "Jean Malan", "link": "https://stackoverflow.com/users/8752844/jean-malan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 51835274, "answer_count": 1, "score": 0, "last_activity_date": 1534229308, "creation_date": 1534217477, "question_id": 51833327, "link": "https://stackoverflow.com/questions/51833327/how-to-update-associated-records-from-nested-form-values", "title": "How to update associated records from nested form values", "body": "<p>I am having difficulties on a callback method I am trying to run. I have an Invoice that has nested forms for Purchase Entries (several invoice entries in one form). Each purchase entry has seperate product, quantity and price.</p>\n\n<p>I have a callback function on the purchase entry to update the quantity of the associated product - such as:</p>\n\n<pre><code>class PurchaseEntry &lt; ActiveRecord::Base\nbefore_save :update_quantity\n\nbelongs_to :product\n\ndef update_quantity \n    if product.present?\n        product.update_quantity\n   end \n  end\n</code></pre>\n\n<p>Then, in my Product model, I have the following</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n\nhas_many :purchase_entries\n\n def update_quantity\n   update(quantity: purchase_entry.sum(:quantity))\n  end\n</code></pre>\n\n<p>This however the update_quantity method updates the db with the total quantities in all purchase entries and not just the new purchase_entries created. How do I limit the method to only the entries that have been created?</p>\n"}, {"tags": ["ruby", "libmagic"], "comments": [{"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534237173, "post_id": 51832768, "comment_id": 90628305, "body": "Perhaps <a href=\"https://stackoverflow.com/questions/3190961/trying-to-install-ruby-filemagic-on-snow-leopard-using-brew-rather-than-ports\">this</a> might be helpful?"}, {"owner": {"reputation": 31, "user_id": 9055203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1009593b654ea6b640b16e0fa7194e9?s=128&d=identicon&r=PG&f=1", "display_name": "HUGO", "link": "https://stackoverflow.com/users/9055203/hugo"}, "reply_to_user": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534301295, "post_id": 51832768, "comment_id": 90657221, "body": "A few hours were cost before I found the problem. Let me write it down here:"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9055203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1009593b654ea6b640b16e0fa7194e9?s=128&d=identicon&r=PG&f=1", "display_name": "HUGO", "link": "https://stackoverflow.com/users/9055203/hugo"}, "is_accepted": false, "score": -1, "last_activity_date": 1534302238, "creation_date": 1534302238, "answer_id": 51852398, "question_id": 51832768, "link": "https://stackoverflow.com/questions/51832768/unable-to-install-ruby-filemagic-0-7-1-on-mac-even-though-libmagic-has-been-inst/51852398#51852398", "title": "Unable to install ruby-filemagic 0.7.1 on Mac even though libmagic has been installed", "body": "<p>A few hours were cost before I found the problem. Let me write down the cause and solution here : </p>\n\n<h3>cause:</h3>\n\n<p>my <code>ruby</code> (<code>$HOME/.rbenv/versions/x.x.x/bin/ruby</code>) was under the control of <code>rbenv</code>, however my <code>bundler</code> was controlled by old <code>ruby</code> (<code>/usr/local/ruby</code>) .\nThe stupid <code>bundler</code> could not find the library for installing <code>ruby_filemagic</code> and wasted so much time.</p>\n\n<h3>solution:</h3>\n\n<p><code>\n$ rbenv exec gem install bundler\n$ rbenv rehash\n</code>\nmake <code>bundler</code>, <code>gem</code>, <code>ruby</code> under the same management.</p>\n\n<p>Sorry for my poor English. I hope this may help more people.</p>\n"}], "owner": {"reputation": 31, "user_id": 9055203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1009593b654ea6b640b16e0fa7194e9?s=128&d=identicon&r=PG&f=1", "display_name": "HUGO", "link": "https://stackoverflow.com/users/9055203/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534302238, "creation_date": 1534212348, "question_id": 51832768, "link": "https://stackoverflow.com/questions/51832768/unable-to-install-ruby-filemagic-0-7-1-on-mac-even-though-libmagic-has-been-inst", "title": "Unable to install ruby-filemagic 0.7.1 on Mac even though libmagic has been installed", "body": "<p>Unable to install ruby-filemagic 0.7.1 on Mac even though libmagic has been installed.</p>\n\n<p>The error is like :</p>\n\n<p>checking for main() in -lgnurx... no</p>\n\n<p>checking for magic_open() in -lmagic... no</p>\n\n<p>*** ERROR: missing required library to compile this module</p>\n\n<p><strong>* extconf.rb failed *</strong></p>\n\n<p>Almost all answers fo ruby-filemagic installation are the <code>brew install libmagic</code>. However, it doesn't work.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 2, "creation_date": 1534209910, "post_id": 51832520, "comment_id": 90619013, "body": "If <code>name</code> is an Employee&#39;s attribute, use pluck over map."}, {"owner": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 0, "creation_date": 1534209967, "post_id": 51832520, "comment_id": 90619027, "body": "name is Employee&#39;s attribute"}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1534210323, "post_id": 51832520, "comment_id": 90619105, "body": "@SebastianPalma yeah, I was torn on that. I just didn&#39;t want to confuse things by doing something that doesn&#39;t really return all the model instances."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1534228853, "post_id": 51832520, "comment_id": 90623882, "body": "Second example should be <code>Employee where(department: &#39;IT&#39;).pluck(:name)</code> (just for reference...already discussed in the comments)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1534252296, "post_id": 51832520, "comment_id": 90637597, "body": "@matthewd then <code>select(:name)</code> would also work. This will return model instances with only 1 attribute (<code>name</code>). However that is a lot of overhead for no real gain"}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 6, "last_activity_date": 1534228597, "last_edit_date": 1534228597, "creation_date": 1534209804, "answer_id": 51832520, "question_id": 51832496, "link": "https://stackoverflow.com/questions/51832496/find-by-returning-only-first-value/51832520#51832520", "title": "find_by returning only first value", "body": "<p>That's what <a href=\"https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/relation/finder_methods.rb#L81\" rel=\"nofollow noreferrer\"><code>find_by(..)</code></a> does; it's a shortcut for <code>where(..).first</code>.</p>\n\n<p>If you want all the records, you need to use <code>where</code>.</p>\n\n<pre><code>Employee.where(department:'IT').map(&amp;:name)\n</code></pre>\n"}], "owner": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 51832520, "answer_count": 1, "score": -1, "last_activity_date": 1534228597, "creation_date": 1534209599, "question_id": 51832496, "link": "https://stackoverflow.com/questions/51832496/find-by-returning-only-first-value", "title": "find_by returning only first value", "body": "<p>I am trying to retrieve all names of employees within a particular department.</p>\n\n<p>Here is what I have done:</p>\n\n<pre><code>Employee.find_by(department:'IT').name\n</code></pre>\n\n<p>But it is returning only first value.</p>\n\n<p>This is what I get in console:</p>\n\n<pre><code>SELECT  \"employee\".* FROM \"employee\" WHERE \"employee\".\"department\" = $1 LIMIT $2  [[\"department\",\"IT\"], [\"LIMIT\", 1]]\n</code></pre>\n\n<p>Why LIMIT 1 is applied?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sass", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 1737, "user_id": 4476186, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3452238962a96a1515d4ab4420aaf35?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard Simpson", "link": "https://stackoverflow.com/users/4476186/gerard-simpson"}, "edited": false, "score": 0, "creation_date": 1534461934, "post_id": 51872464, "comment_id": 90724517, "body": "but then I&#39;m still importing two <code>.scss</code> files, I would like to only import one, is this possible?"}], "tags": [], "owner": {"reputation": 1, "user_id": 9833105, "user_type": "registered", "profile_image": "https://graph.facebook.com/1201841743279704/picture?type=large", "display_name": "Frisko Mayufid", "link": "https://stackoverflow.com/users/9833105/frisko-mayufid"}, "is_accepted": false, "score": 0, "last_activity_date": 1534407146, "creation_date": 1534407146, "answer_id": 51872464, "question_id": 51832399, "link": "https://stackoverflow.com/questions/51832399/how-to-expose-scss-variables-from-a-gem-into-a-rails-project-with-a-single-imp/51872464#51872464", "title": "How to expose SCSS variables from a gem into a rails project with a single `@import`", "body": "<p>you can just paste this <code>@import \"common/variables\";</code> into your application.scss only once.</p>\n\n<pre><code>@import \"common/variables\";\n@import \"gem-styles.scss\";  \n@import \"my-scss-file-that-needs-access-to-variables.scss\"\n</code></pre>\n\n<p>like this</p>\n"}], "owner": {"reputation": 1737, "user_id": 4476186, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f3452238962a96a1515d4ab4420aaf35?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard Simpson", "link": "https://stackoverflow.com/users/4476186/gerard-simpson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1534461978, "creation_date": 1534208657, "last_edit_date": 1534461978, "question_id": 51832399, "link": "https://stackoverflow.com/questions/51832399/how-to-expose-scss-variables-from-a-gem-into-a-rails-project-with-a-single-imp", "title": "How to expose SCSS variables from a gem into a rails project with a single `@import`", "body": "<p>I have a rails project and a gem. The rails project has <code>.scss</code> files that require variables from the gem:</p>\n\n<p><strong>Rails Project</strong></p>\n\n<p>application.scss:</p>\n\n<pre><code>@import \"gem-styles.scss\";  \n@import \"my-scss-file-that-needs-access-to-variables.scss\"\n</code></pre>\n\n<p>my-scss-file-that-needs-access-to-variables.scss:</p>\n\n<pre><code>color: $primary-color;\n</code></pre>\n\n<p><strong>Gem</strong></p>\n\n<p>in gem-styles.scss:</p>\n\n<pre><code>@import \"common/variables\";\n</code></pre>\n\n<p>in common/_variables.scss:</p>\n\n<pre><code>$primary-color: #00d9ff;\n</code></pre>\n\n<p>Doing this, I get the error: <code>Undefined variable: \"$primary-color\".</code></p>\n\n<p>I can include <code>common/variables</code> in <code>my-scss-file-that-needs-access-to-variables.scss</code> to fix the issue:</p>\n\n<p><code>@import \"common/variables\";</code></p>\n\n<p>but I don't find that solution DRY enough. I would have to import <code>common/variables</code> into every <code>.scss</code> file that requires them. I would prefer to be able to only import one <code>.scss</code> file from the gem which contains all of the variables that I need exposed in my parent application, as well as the rest of the styles from <code>gem-styles.scss</code>.</p>\n"}, {"tags": ["python", "ruby", "jwt", "token"], "comments": [{"owner": {"reputation": 4589, "user_id": 2263572, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bea7d4a6d62f5730775d5702cb0c6357?s=128&d=identicon&r=PG", "display_name": "user2263572", "link": "https://stackoverflow.com/users/2263572/user2263572"}, "edited": false, "score": 0, "creation_date": 1534212263, "post_id": 51832272, "comment_id": 90619468, "body": "Does jwt 1.5.6 and jwt 2.1.0 use the same hashing function?  Are you hashing the same data (dicts in python are not JSON)?  Interesting question, but from a design standpoint, you probably shouldn&#39;t be doing this :)"}, {"owner": {"reputation": 143, "user_id": 1531020, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a3b4f67a602f7c93ffa96c01af1af36?s=128&d=identicon&r=PG", "display_name": "thomascrha", "link": "https://stackoverflow.com/users/1531020/thomascrha"}, "reply_to_user": {"reputation": 4589, "user_id": 2263572, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bea7d4a6d62f5730775d5702cb0c6357?s=128&d=identicon&r=PG", "display_name": "user2263572", "link": "https://stackoverflow.com/users/2263572/user2263572"}, "edited": false, "score": 0, "creation_date": 1534212495, "post_id": 51832272, "comment_id": 90619515, "body": "You can only use a dict with the python side (jwt.encode only accepts dicts) - but for the Ruby side that function accepts a dict or a JSON string - both do not match."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534221403, "post_id": 51832272, "comment_id": 90621419, "body": "Didn&#39;t look much at the code, but Python switched to Unicode strings by default in Python3, which was not the case in Python2. Could that be causing the different outputs? Add a <code>u</code> to the string using Python2 and see if the outputs match then."}, {"owner": {"reputation": 11104, "user_id": 7329832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a4e398a7a3d75e8cffbc635860e01a?s=128&d=identicon&r=PG&f=1", "display_name": "jps", "link": "https://stackoverflow.com/users/7329832/jps"}, "edited": false, "score": 3, "creation_date": 1534228136, "post_id": 51832272, "comment_id": 90623585, "body": "if you inspect all JWTs on JWT.io you can see different order of the header fields (but identical values), only the second ruby example is missing the <code>typ</code> header. The payload is <code>&quot;someKey&quot;:&quot;123&quot;</code> but in python3 it changed to <code>&quot;appenId&quot;:&quot;123&quot;</code>. No wonder the result is different.  The idea of JWT is not to produce identical tokens to compare them but to have a signature which enables you to validate the token itself."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 1531020, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a3b4f67a602f7c93ffa96c01af1af36?s=128&d=identicon&r=PG", "display_name": "thomascrha", "link": "https://stackoverflow.com/users/1531020/thomascrha"}, "is_accepted": false, "score": 0, "last_activity_date": 1534289013, "creation_date": 1534289013, "answer_id": 51850968, "question_id": 51832272, "link": "https://stackoverflow.com/questions/51832272/jwt-differences-between-programming-languages/51850968#51850968", "title": "JWT differences between Programming Languages", "body": "<p>So I worked this out and as @jps mentioned the Ruby code doesn't have the header {\"typ\":\"JWT\"} - the python code does. As mentioned in the docs for ruby <a href=\"https://github.com/jwt/ruby-jwt#add-custom-header-fields\" rel=\"nofollow noreferrer\">jwt</a> you can set the header. This was the code that fixed it on the ruby end.</p>\n\n<pre><code>token = JWT.encode(payload=payload, key=key, algorithm='HS256',header_fields={ typ: 'JWT' })\n</code></pre>\n\n<p>With that the tokens now match. BTW the hashes, even though different, are able to be decoded by the same secret - there was just an extra step in auth that double checked if the hash ruby created matched the incoming hash.</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 1531020, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a3b4f67a602f7c93ffa96c01af1af36?s=128&d=identicon&r=PG", "display_name": "thomascrha", "link": "https://stackoverflow.com/users/1531020/thomascrha"}, "edited": false, "score": 0, "creation_date": 1550051135, "post_id": 54471718, "comment_id": 96124272, "body": "I totally agree with you. I didn&#39;t design the auth method, and changing it would break many many parts."}], "tags": [], "owner": {"reputation": 1123, "user_id": 7964557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9W8nHaY7V4Y/AAAAAAAAAAI/AAAAAAAAAGA/aoLc6RbiiRc/photo.jpg?sz=128", "display_name": "Marcelo Fonseca", "link": "https://stackoverflow.com/users/7964557/marcelo-fonseca"}, "is_accepted": false, "score": 0, "last_activity_date": 1548984895, "creation_date": 1548984895, "answer_id": 54471718, "question_id": 51832272, "link": "https://stackoverflow.com/questions/51832272/jwt-differences-between-programming-languages/54471718#54471718", "title": "JWT differences between Programming Languages", "body": "<p>There's no need to create a token in both sides.\nUse JWT strategy with a pub priv key algorithm like <code>RS256</code>. With this you can sign the JWT token in one API and able to verify with a public key in your other API.</p>\n"}], "owner": {"reputation": 143, "user_id": 1531020, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a3b4f67a602f7c93ffa96c01af1af36?s=128&d=identicon&r=PG", "display_name": "thomascrha", "link": "https://stackoverflow.com/users/1531020/thomascrha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1548984895, "creation_date": 1534207293, "last_edit_date": 1534230284, "question_id": 51832272, "link": "https://stackoverflow.com/questions/51832272/jwt-differences-between-programming-languages", "title": "JWT differences between Programming Languages", "body": "<p>I've got an API written in Python and another written in Ruby. We need these to send data between themselves and have decided to use JWT's as an authentication method. Basically generating a token on either end and making sure they match up. Now I'm having issues with matching hashes between python and ruby. Given this code : python (2.7) PyJWT == 1.6.4</p>\n\n<pre><code>&gt;&gt;&gt; import jwt\n&gt;&gt;&gt; jwt.encode({\"someKey\":123}, \"secret\", algorithm='HS256')\n</code></pre>\n\n<blockquote>\n  <p>u'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzb21lS2V5IjoxMjN9.DL8qyWMeqfMMLCTPN3RA9K08e-AkNW_ybPyywvrIIZ8'</p>\n</blockquote>\n\n<p>This also seems to change between python versions - running this as python3 produced this</p>\n\n<blockquote>\n  <p>b'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcHBlbklkIjoxMjN9.YgFKZePJYMRDMgubCeZBy6WaFKiTA9C-TRnnZLFJC8E'</p>\n</blockquote>\n\n<p>Then when I create a similar 'function' in ruby I get a different hash - This is also true between versions of ruby's jwt (I've tested jwt-1.5.6 and jwt-2.1.0) - below is the jwt-1.5.6 result.</p>\n\n<pre><code>require \"jwt\"\nsomeKey = 123\nsecret = \"secret\"\npayload = {\"someKey\" =&gt; someKey}\ntoken = JWT.encode payload, secret, 'HS256'\nputs token\n</code></pre>\n\n<p>The output of that code is </p>\n\n<blockquote>\n  <p>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzb21lS2V5IjoxMjN9.7Ch3o7IXmxqm79AcrTetXuZv6h3suyLD5_IgXdrRlNs</p>\n</blockquote>\n\n<p>With version jwt-2.1.0 I get:</p>\n\n<blockquote>\n  <p>eyJhbGciOiJIUzI1NiJ9.eyJzb21lS2V5IjoxMjN9.QkKm2IuvOz_D5ukIxOsjMYApzV2ZnjLE2HII3ZfP_hsWith</p>\n</blockquote>\n\n<p>Why would the output of these two code set produce two different hashes?</p>\n\n<p>EDIT:\nWhen I use jwt.io </p>\n\n<p><a href=\"https://jwt.io/#debugger-io?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzb21lS2V5IjoxMjN9.DL8qyWMeqfMMLCTPN3RA9K08e-AkNW_ybPyywvrIIZ8\" rel=\"nofollow noreferrer\">https://jwt.io/#debugger-io?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzb21lS2V5IjoxMjN9.DL8qyWMeqfMMLCTPN3RA9K08e-AkNW_ybPyywvrIIZ8</a></p>\n\n<p>i get the same token as for python </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1534205381, "post_id": 51831971, "comment_id": 90618230, "body": "Can you edit your question and add your entire PATH value?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1534210033, "post_id": 51831971, "comment_id": 90619044, "body": "Edited it in.  Put both sections.  Also another thing i am about to edit in.  I also have python under the paths"}], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 7735007, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-148Zy7EZT4I/AAAAAAAAAAI/AAAAAAAAAQU/7vF0QGaNUgs/photo.jpg?sz=128", "display_name": "Achyut", "link": "https://stackoverflow.com/users/7735007/achyut"}, "is_accepted": false, "score": 0, "last_activity_date": 1534222946, "creation_date": 1534222946, "answer_id": 51834015, "question_id": 51831971, "link": "https://stackoverflow.com/questions/51831971/trouble-installing-rails-for-ruby/51834015#51834015", "title": "Trouble installing rails for ruby", "body": "<p>You can try from this <a href=\"https://gorails.com/setup/windows/10\" rel=\"nofollow noreferrer\">link</a> to install rails in windows 10.</p>\n\n<p><a href=\"https://gorails.com/setup/windows/10\" rel=\"nofollow noreferrer\">https://gorails.com/setup/windows/10</a></p>\n"}, {"tags": [], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "is_accepted": false, "score": 1, "last_activity_date": 1534225281, "creation_date": 1534225281, "answer_id": 51834397, "question_id": 51831971, "link": "https://stackoverflow.com/questions/51831971/trouble-installing-rails-for-ruby/51834397#51834397", "title": "Trouble installing rails for ruby", "body": "<p>Um yeah so i did this:</p>\n\n<p>Uninstalled Ruby.  then used <a href=\"http://railsinstaller.org/en\" rel=\"nofollow noreferrer\">http://railsinstaller.org/en</a> to re install ruby</p>\n\n<p>Then re did the process: and heres the CMD</p>\n\n<pre><code>Microsoft Windows [Version 10.0.17134.165]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\jorda&gt;ruby --v\nruby: invalid option --v  (-h will show valid options) (RuntimeError)\n\nC:\\Users\\jorda&gt;ruby -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [i386-mingw32]\n\nC:\\Users\\jorda&gt;sqlite3 --version\n3.24.0 2018-06-04 19:24:41             \nc7ee0833225bfd8c5ec2f9bf62b97c4e04d03bd9566366d5221ac8fb199a87ca\n\nC:\\Users\\jorda&gt;gem install rails\nFetching: activesupport-5.2.1.gem (100%)\nSuccessfully installed activesupport-5.2.1\nFetching: actionview-5.2.1.gem (100%)\nSuccessfully installed actionview-5.2.1\nFetching: actionpack-5.2.1.gem (100%)\nSuccessfully installed actionpack-5.2.1\nFetching: activemodel-5.2.1.gem (100%)\nSuccessfully installed activemodel-5.2.1\nFetching: arel-9.0.0.gem (100%)\nSuccessfully installed arel-9.0.0\nFetching: activerecord-5.2.1.gem (100%)\nSuccessfully installed activerecord-5.2.1\nFetching: activejob-5.2.1.gem (100%)\nSuccessfully installed activejob-5.2.1\nFetching: actionmailer-5.2.1.gem (100%)\nSuccessfully installed actionmailer-5.2.1\nFetching: actioncable-5.2.1.gem (100%)\nSuccessfully installed actioncable-5.2.1\nFetching: mimemagic-0.3.2.gem (100%)\nSuccessfully installed mimemagic-0.3.2\nFetching: marcel-0.3.2.gem (100%)\nSuccessfully installed marcel-0.3.2\nFetching: activestorage-5.2.1.gem (100%)\nSuccessfully installed activestorage-5.2.1\nFetching: railties-5.2.1.gem (100%)\nSuccessfully installed railties-5.2.1\nFetching: rails-5.2.1.gem (100%)\nSuccessfully installed rails-5.2.1\nParsing documentation for activesupport-5.2.1\nInstalling ri documentation for activesupport-5.2.1\nParsing documentation for actionview-5.2.1\nInstalling ri documentation for actionview-5.2.1\nParsing documentation for actionpack-5.2.1\nInstalling ri documentation for actionpack-5.2.1\nParsing documentation for activemodel-5.2.1\nInstalling ri documentation for activemodel-5.2.1\nParsing documentation for arel-9.0.0\nInstalling ri documentation for arel-9.0.0\nParsing documentation for activerecord-5.2.1\nInstalling ri documentation for activerecord-5.2.1\nParsing documentation for activejob-5.2.1\nInstalling ri documentation for activejob-5.2.1\nParsing documentation for actionmailer-5.2.1\nInstalling ri documentation for actionmailer-5.2.1\nParsing documentation for actioncable-5.2.1\nInstalling ri documentation for actioncable-5.2.1\nParsing documentation for mimemagic-0.3.2\nInstalling ri documentation for mimemagic-0.3.2\nParsing documentation for marcel-0.3.2\nInstalling ri documentation for marcel-0.3.2\nParsing documentation for activestorage-5.2.1\nInstalling ri documentation for activestorage-5.2.1\nParsing documentation for railties-5.2.1\nInstalling ri documentation for railties-5.2.1\nParsing documentation for rails-5.2.1\nInstalling ri documentation for rails-5.2.1\nDone installing documentation for activesupport, actionview, actionpack, activemodel,         \narel, activerecord, activejob, actionmailer, actioncable, mimemagic, marcel,     \nactivestorage, railties, rails after 43 seconds\n14 gems installed\n\nC:\\Users\\jorda&gt;ruby\n</code></pre>\n\n<p>If anyone is having the same issue, well, here you go.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1534225281, "creation_date": 1534204191, "last_edit_date": 1534210017, "question_id": 51831971, "link": "https://stackoverflow.com/questions/51831971/trouble-installing-rails-for-ruby", "title": "Trouble installing rails for ruby", "body": "<p>I am new to ruby and just tried installing rails and with the following error in code below.</p>\n\n<p>Ruby is installed with the following version:</p>\n\n<pre><code>ruby 2.4.4p296 (2018-03-28 revision 63013) [x64-mingw32]\n</code></pre>\n\n<p>sqlite3 is installed with the following verions:</p>\n\n<pre><code>3.24.0 2018-06-04 19:24:41 c7ee0833225bfd8c5ec2f9bf62b97c4e04d03bd9566366d5221ac8fb199a87ca\n</code></pre>\n\n<p>I am assuming (from reading other questions with the same issue) that my PATH is messy.  Keep in mind, I am new at ruby and don't know exactly, but i read that a messy path can be the reason.</p>\n\n<p>I have installed both ruby and sqlite3 on my D: drive.</p>\n\n<p>My Environment Variables> system variables> PATH, currently have 22 different folders/paths within it.  I am not sure if this is the best way to do it, but its how it is.  </p>\n\n<p><strong>Things I've tried:</strong></p>\n\n<p>installing rails from from C: instead of D: with the same error code.\nupdating gem with</p>\n\n<pre><code>gem update --system\n</code></pre>\n\n<p>I'm sure someone who knows much more than I do about how this works will have an easy fix for this.</p>\n\n<p>Path Value under System Variables:</p>\n\n<pre><code>C:\\Program Files (x86)\\Intel\\iCLS Client\\;C:\\Program Files\\Intel\\iCLS Client\\;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files (x86)\\Intel\\Intel(R) Management Engine Components\\DAL;C:\\Program Files\\Intel\\Intel(R) Management Engine Components\\DAL;C:\\Program Files (x86)\\Intel\\Intel(R) Management Engine Components\\IPT;C:\\Program Files\\Intel\\Intel(R) Management Engine Components\\IPT;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\Intel\\WiFi\\bin\\;C:\\Program Files\\Common Files\\Intel\\WirelessCommon\\;%SystemRoot%\\system32;%SystemRoot%;%SystemRoot%\\System32\\Wbem;%SYSTEMROOT%\\System32\\WindowsPowerShell\\v1.0\\;%SYSTEMROOT%\\System32\\OpenSSH\\;D:\\Programs\\QuickTime\\QTSystem\\;D:\\Programming\\Ruby Installer\\Ruby24-x64\\bin;D:\\Programming\\sqlite3;D:\\Programming;\n</code></pre>\n\n<p>Here are my PATH value under User variabled for [name]:</p>\n\n<pre><code>D:\\Programming\\Ruby Installer\\Ruby24-x64\\bin;C:\\Users\\jorda\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\jorda\\AppData\\Local\\atom\\bin;D:\\Programming\\sqlite3;D:\\Programming;\n</code></pre>\n\n<p>Here's the error code i am receiving:</p>\n\n<pre><code>D:\\&gt;gem install rails\nTemporarily enhancing PATH for MSYS/MINGW...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\ncurrent directory: D:/Programming/Ruby Installer/Ruby24- \n   x64/lib/ruby/gems/2.4.0/gems/websocket-driver-0.7.0/ext/websocket-driver\n\"D:/Programming/Ruby Installer/Ruby24-x64/bin/ruby.exe\" -r \n./siteconf20180813-11328-m03y6e.rb extconf.rb\ncreating Makefile\n\ncurrent directory: D:/Programming/Ruby Installer/Ruby24- \n   x64/lib/ruby/gems/2.4.0/gems/websocket-driver-0.7.0/ext/websocket-driver\nmake \"DESTDIR=\" clean\nMakefile:267: *** multiple target patterns.  Stop.\n\ncurrent directory: D:/Programming/Ruby Installer/Ruby24- \n   x64/lib/ruby/gems/2.4.0/gems/websocket-driver-0.7.0/ext/websocket-driver\nmake \"DESTDIR=\"\nMakefile:267: *** multiple target patterns.  Stop.\n\nmake failed, exit code 2\n\nGem files will remain installed in D:/Programming/Ruby Installer/Ruby24-        \nx64/lib/ruby/gems/2.4.0/gems/websocket-driver-0.7.0 for inspection.\nResults logged to D:/Programming/Ruby Installer/Ruby24- \n   x64/lib/ruby/gems/2.4.0/extensions/x64-mingw32/2.4.0/websocket-driver- \n   0.7.0/gem_make.out\n\nD:\\&gt;rails --version\n'rails' is not recognized as an internal or external command,\noperable program or batch file.\n</code></pre>\n\n<p>Using Windows 10</p>\n\n<p>Installed ruby with dev kit</p>\n\n<p>This may help as well</p>\n\n<p>My current gem version:</p>\n\n<pre><code>D:\\&gt;gem --version\n2.6.14.1\n</code></pre>\n\n<p>Thank you anyone who is taking the time to read this and help me.  I am grateful for all communities and really appreciate it!</p>\n\n<p>Also, Python is installed as well.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "parameters", "controller"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1534205254, "post_id": 51831792, "comment_id": 90618212, "body": "Can you please edit your question and add the models for Range and Animal. Also if Range is its own model you should normalize your DB by only having <code>range_id</code> in the Animal table, and any reference to that range would look it up in the Range table and get it&#39;s name via something like @range.name."}, {"owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1534206100, "post_id": 51831792, "comment_id": 90618342, "body": "thanks @Beartech I edited those in just now"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 1, "creation_date": 1534206721, "post_id": 51831792, "comment_id": 90618433, "body": "First thing I see is I think your Animal should <code>belongs_to :range</code>."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534219044, "post_id": 51831792, "comment_id": 90620846, "body": "What is the value of <code>range</code> saved in database? Is the problem with creation of animal or with display of animal? Can you show the code for show page of animal? Can you also include server logs for the create request in your question?"}], "answers": [{"tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": false, "score": 0, "last_activity_date": 1534286591, "last_edit_date": 1534286591, "creation_date": 1534210504, "answer_id": 51832585, "question_id": 51831792, "link": "https://stackoverflow.com/questions/51831792/rails-form-helper-not-saving-params-correctly/51832585#51832585", "title": "Rails: Form Helper not saving params correctly", "body": "<p>For one thing you should be setting just the <code>range_id</code> in the animal model:</p>\n\n<pre><code>&lt;%= f.label :rang_id, 'Range' %&gt; &lt;br&gt;\n&lt;%= collection_select(:animal, :range_id, Range.all, :id, :name, {:prompt =&gt; 'Please select'}, class: 'form-control' ) %&gt;\n</code></pre>\n\n<p>Also I think you want your Animal.rb to have the relation:</p>\n\n<pre><code>belongs_to :range\n</code></pre>\n\n<p>As noted in the comments above the problem might be what code you are using to display the range. If you add your web server log of the <code>save</code> call, and show your html.erb code for the display of <code>range</code>.</p>\n"}], "owner": {"reputation": 1512, "user_id": 5513336, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/bc7pn.jpg?s=128&g=1", "display_name": "Leia_Organa", "link": "https://stackoverflow.com/users/5513336/leia-organa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534286591, "creation_date": 1534202491, "last_edit_date": 1534206086, "question_id": 51831792, "link": "https://stackoverflow.com/questions/51831792/rails-form-helper-not-saving-params-correctly", "title": "Rails: Form Helper not saving params correctly", "body": "<p>I'm working on a Rails app which allows users to view and create animals. Users can add in an animal's name and \"range\", which consists of the following:</p>\n\n<p>models/Animal.rb</p>\n\n<pre><code>class Animal &lt; ApplicationRecord\n    has_one :range\n    validates :name, presence:true, length: {minimum:1}\n    validates :name, :presence =&gt; true, :uniqueness =&gt; true\nend\n</code></pre>\n\n<p>models/Range.rb</p>\n\n<pre><code>class Range &lt; ApplicationRecord\n    has_many :animals\nend\n</code></pre>\n\n<p>seeds.rb</p>\n\n<pre><code>ranges = [\n{id: 1, name: \"land\"},\n{id: 2, name: \"sea\"},\n{id: 3, name: \"air\"},\n{id: 4, name: \"underground\"}\n]\n\nanimals = [\n{id: 1, name: \"dolphin\", range_id: 2, range: \"sea\"},\n{id: 2, name: \"ant\", range_id: 4, range: \"underground\"},\n{id: 3, name: \"eagle\", range_id: 3, range: \"air\"}\n]\n</code></pre>\n\n<p>range.id/animal.range_id and range.name and animal.range are connected through a foreign key and associations.</p>\n\n<p>Here is my current animals_controller.rb</p>\n\n<pre><code>class AnimalsController &lt; ApplicationController\n  def index\n    @animals = Animal.all\n    if params[:search]\n      @animal = Animal.search(params[:search]).order(\"created_at DESC\")\n    else\n      @animals = Animal.all.order(\"created_at DESC\")\n    end\n\n  end\n\n  def show\n    @animal = Animal.find(params[:id])\n  end\n\n  def new\n    @animal = Animal.new\n  end\n\n  def create\n    # render plain: animal_params[:animal].inspect\n    @animal = Animal.new(animal_params)\n\n    if(@animal.save)\n      redirect_to @animal\n  end\n\n  private def animal_params\n    params.require(:animal).permit(:id, :name, :range, :range_id)\n  end\n\nend\n</code></pre>\n\n<p>Now here's the issue. The form helper I'm using for Animal.new has a select box that should automatically save the animal's range id AND range name. However, it saves the range name as a direct link to the range/show page instead.</p>\n\n<pre><code>&lt;h1&gt; Add Animal &lt;/h1&gt;\n\n&lt;%= form_for :animal, url: animals_path do |f| %&gt;\n\n    &lt;p&gt;\n    &lt;%= f.label :name %&gt; &lt;br&gt;\n    &lt;%= f.text_field :name %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n    &lt;%= f.label :range_name %&gt; &lt;br&gt;\n     &lt;%= f.select :range_id, options_for_select(Range.all.collect { |range| [range.name, range.id]}), {}, class: 'form-control', include_blank: 'Please Select' %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n    &lt;%= f.submit %&gt;\n    &lt;p&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>So when I go to save a new animal, I get something like this. The range should say \"land\", not just save as a link to the range/show page.</p>\n\n<pre><code>Name: cat\nrange: range/1 \n</code></pre>\n\n<p>I need it to say \"land\" instead. What am I doing wrong here? I suspect it has to do with the form helper but I can't find a definitive answer.</p>\n"}, {"tags": ["ruby", "rubygems", "devkit"], "comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1534200198, "post_id": 51831109, "comment_id": 90617152, "body": "<a href=\"https://github.com/evan/fftw3\" rel=\"nofollow noreferrer\">github.com/evan/fftw3</a> Looks like that gem has native extensions (as ruby calls them), which means its partly written in C code. Gems with native extensions actually have to compile C code when you install them. Additionally, it looks like fftw3 expects the program&#39;s binaries to be installed (<a href=\"http://fftw.org/download.html\" rel=\"nofollow noreferrer\">fftw.org/download.html</a>). Basically, the gem does not install fftw itself, it&#39;s just a ruby interface for a program you should already have installed. Do you for sure have the fftw program installed before attempting to install this gem?"}, {"owner": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "reply_to_user": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1534264953, "post_id": 51831109, "comment_id": 90645607, "body": "I did have the library installed, however, no matter what commands I used to point to the library itself, <code>install</code> couldn&#39;t find it. I did make some progress, see the edit above. I assumed that the gem would bundle the library with it, but this was naive of me."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "edited": false, "score": 0, "creation_date": 1534265109, "post_id": 51831668, "comment_id": 90645684, "body": "Thanks for all the information. Definitely some things I wouldn&#39;t have otherwise learned from this problem.  Work-around was bad word choice on my part. I was looking for a solution to getting the gems installed."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "edited": false, "score": 0, "creation_date": 1534273581, "post_id": 51831668, "comment_id": 90649760, "body": "One another note, and this is just a thought not backed by any knowledge of these particular gems, but the <code>fftw3</code> gem looks incomplete, and at a glance doesn&#39;t look like it had Windows in mind. Are you sure you didn&#39;t intend <code>gem install ruby-fftw3</code>?"}, {"owner": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "edited": false, "score": 0, "creation_date": 1534360234, "post_id": 51831668, "comment_id": 90682103, "body": "I needed fftw3, not ruby-fftw3. I&#39;ve solved the problem though!"}], "tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 0, "last_activity_date": 1534201408, "creation_date": 1534201408, "answer_id": 51831668, "question_id": 51831109, "link": "https://stackoverflow.com/questions/51831109/gem-installation-fails-with-lack-of-necessary-libraries-and-or-headers/51831668#51831668", "title": "Gem installation fails with lack of necessary libraries and/or headers", "body": "<p>To answer your questions in order:</p>\n\n<ol>\n<li>(This is actually a few questions) Typically yes, naming convention is of course going to convey something meaningful, but it is not required. It is quite possible to for the author to have changed the name of a file. Ruby simply looks for an entry-point that must be defined <code>Init_gem_name</code>. Other than that, as long it conforms to C standards and the <code>extconfig.rb</code> is properly configured to tell the compiler where to find source files, anything goes. Any C extension is going to have at least one header to define the entry point, but depending on what the gem does, there may be headers not included. For example, if writing a gem that uses OpenGL, it is not always necessary to include the <code>gl.h</code> header, because it is already included with Windows, OSX, and Linux systems by default (though often outdated).</li>\n<li>This is so highly unlikely that I am just going to say NO.</li>\n<li>You don't need a \"work-around\", you need only follow the directions given to use the gem. Not all gems are self-contained libraries that have no dependencies, especially anything that wraps a library. This particular gem requires that <code>libfft3</code> be installed on your system already, where it can be found, before you install the gem, otherwise all the functions that it thinks it has by reading a header file are not actually defined anywhere. </li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534361367, "post_id": 51865067, "comment_id": 90682589, "body": "Why did you you install Cygwin if you have DevKit?All of this copying and installing amounts to to just configuring paths. You install Cygwin, then take all the MingW folders from it, which is just a slimmed version of what the DevKit has. You literally only had to configure your paths, and all this proves it more."}, {"owner": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "reply_to_user": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534437405, "post_id": 51865067, "comment_id": 90714872, "body": "I agree, configuring paths was the answer to the problem. It was all a matter of using the proper libraries though. I was originally using the <code>fftw3</code> libraries from the FFTW <a href=\"http://www.fftw.org/install/windows.html\" rel=\"nofollow noreferrer\">website</a>, however those didn&#39;t work. MingW packaged with the Devkit doesn&#39;t include the needed fftw3 libraries. So the solution found came down to Cygwin&#39;s installation with the <code>fftw3</code> devel."}], "tags": [], "owner": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "is_accepted": false, "score": 0, "last_activity_date": 1534360754, "creation_date": 1534360754, "answer_id": 51865067, "question_id": 51831109, "link": "https://stackoverflow.com/questions/51831109/gem-installation-fails-with-lack-of-necessary-libraries-and-or-headers/51865067#51865067", "title": "Gem installation fails with lack of necessary libraries and/or headers", "body": "<p>These steps are for a 64-bit OS with Ruby 2.2.4 and Devkit on Windows 10.</p>\n\n<ol>\n<li><p>Run Cygwin setup and select mingw64-x86_64-fftw3 (version 3.3.5) for install</p></li>\n<li><p>Copy <code>C:\\cygwin64\\usr\\x86_64-w64-mingw32\\sys-root\\mingw\\lib\\libfftw3*</code> to\n<code>C:\\fftw3\\lib</code></p></li>\n<li><p>Copy <code>C:\\cygwin64\\usr\\x86_64-w64-mingw32\\sys-root\\mingw\\include\\fftw3*</code> to\n<code>C:\\fftw3\\include</code></p></li>\n<li><p>Copy <code>C:\\COSMOS\\Vendor\\Ruby\\lib\\ruby\\gems\\2.2.0\\gems\\narray-0.6.1.2\\src\\libnarray.a</code>\nto <code>C:\\fftw3\\lib</code></p></li>\n<li><p>Copy both <code>narray.h</code> and <code>narray_config.h</code> from <code>&lt;rubypath&gt;\\lib\\ruby\\gems\\2.2.0\\gems\\narray-0.6.1.2\\src</code> to <code>C:\\fftw3\\include</code></p></li>\n<li><p>run <code>gem install fftw3 -- --with-opt-dir=C:\\fftw3</code></p></li>\n<li><p>Add <code>C:\\cygwin64\\usr\\x86_64-w64-mingw32\\sys-root\\mingw\\bin</code> to PATH</p></li>\n</ol>\n\n<p>These steps will allow the installation of gems that require the <code>fftw3</code>library. You just need to specify the <code>--with-opt-dir</code> option during <code>gem install</code></p>\n"}], "owner": {"reputation": 1, "user_id": 5415940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bacd5308fe4ec15ded41941cc5d55fbb?s=128&d=identicon&r=PG&f=1", "display_name": "abullard", "link": "https://stackoverflow.com/users/5415940/abullard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 534, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534360754, "creation_date": 1534197261, "last_edit_date": 1534265288, "question_id": 51831109, "link": "https://stackoverflow.com/questions/51831109/gem-installation-fails-with-lack-of-necessary-libraries-and-or-headers", "title": "Gem installation fails with lack of necessary libraries and/or headers", "body": "<p>I'm currently trying to install a few Ruby Gems that require the fftw3 library to be installed and linked correctly on Windows 10. It's a one-line fix on Linux, so I'm rather annoyed at this point.</p>\n\n<ul>\n<li>fftw3 ~> 0.3 </li>\n<li>convolver  ~> 0.3.1</li>\n</ul>\n\n<p>I have Ruby 2.2.4 (64-bit) installed and the 64-bit Devkit installed as well. </p>\n\n<p>Running <code>gem install fftw3</code> produces the following: </p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions. This could take a while...\nERROR:  Error installing fftw3:\nERROR: Failed to build gem native extension.\n\ncurrent directory: C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/fftw3-0.3/ext\nC:/Ruby22-x64/bin/ruby.exe -r ./siteconf20180813-7456-1v4icuv.rb extconf.rb\nchecking for narray.h... yes\nchecking for narray_config.h... yes\nchecking for fftw3.h... yes\nchecking for main() in -lfftw3... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You \nmay need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=C:/Ruby22-x64/bin/$(RUBY_BASE_NAME)\n    --with-narray-dir\n    --without-narray-dir\n    --with-narray-include\n    --without-narray-include=${narray-dir}/include\n    --with-narray-lib\n    --without-narray-lib=${narray-dir}/lib\n    --with-fftw3-dir\n    --without-fftw3-dir\n    --with-fftw3-include\n    --without-fftw3-include=${fftw3-dir}/include\n    --with-fftw3-lib\n    --without-fftw3-lib=${fftw3-dir}/lib\n    --with-fftw3lib\n    --without-fftw3lib\n** configure error **\nHeader fftw3.h or the compiled fftw3 library is not found.\nIf you have the library installed under /fftw3dir (that is, fftw3.h is\nin /fftw3dir/include and the library in /fftw3dir/lib/),\ntry the following:\n\n% ruby extconf.rb --with-fftw3-dir=/fftw3dir\n\nAlternatively, you can specify the two directory separately\nwith --with-fftw3-include and --with-fftw3-lib.\n\nTo see why this extension failed to compile, please check the mkmf.log which \ncan be found here:\n\nC:/Ruby22-x64/lib/ruby/gems/2.2.0/extensions/x64-mingw32/2.2.0/fftw3-0.3/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/fftw3-0.3 for inspection.\nResults logged to C:/Ruby22-x64/lib/ruby/gems/2.2.0/extensions/x64-mingw32/2.2.0/fftw3-0.3/gem_make.out\n</code></pre>\n\n<p>There is a lot in here...So far I've been able to get the fftw3.h file to link properly by reading the mkmf.log file and placing the headers in a path that's searched by the gem installation. I've tried using more of the command line options <code>ruby extconf.rb &lt;opts&gt;</code> to generate the makefile (receiving similar errors), I've placed the DLL in the System32 and SysWOW64 folders.</p>\n\n<p>The same error populates with the ruby-termios gem, but instead it's looking for termios.h. Which lead me to believe there may be something wrong with the gems that need the Devkit to install, so I tried reinstalling it with no luck as well.</p>\n\n<p>So I have a few questions:</p>\n\n<ol>\n<li><p>Why do the Devkit gems search for header files that match the gem to be installed? (e.g. fftw3 looks for fftw3.h, ruby-termios looks for termios.h) Shouldn't these come bundled with the gem?</p></li>\n<li><p>Is it possible that libfftw3 is missing a main() function? I'm unsure if the install command can find the dll, or if the dll is missing main(). If this is the case, what would be the work-around for that problem? (I don't want to remove the have_library(\"fftw3\") call from the extconf.rb file as this just feels dirty and all around incorrect.)</p></li>\n<li><p>Does anyone know the work-around for this error? </p></li>\n</ol>\n\n<p>Sorry for throwing so much at you and hopefully this is clear enough. \nThanks in advance.</p>\n\n<p>EDIT: A couple things to note:</p>\n\n<ul>\n<li>On Windows, you can install the fftw3 library during Cygwin's installation</li>\n<li><code>gem install</code> also has an option to install --with-fftw3-dir=\"path\"</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "cancan", "pundit", "cancancan"], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 5891503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/830569e0fa440b692ab80005ef9b00cb?s=128&d=identicon&r=PG", "display_name": "reiallenramos", "link": "https://stackoverflow.com/users/5891503/reiallenramos"}, "edited": false, "score": 0, "creation_date": 1584326487, "post_id": 52292285, "comment_id": 107394151, "body": "will this work work namespaced models like <code>Foo::BarPolicy</code>?"}, {"owner": {"reputation": 128, "user_id": 5713302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303e92715524e5ce04cd28fc449e6f4a?s=128&d=identicon&r=PG", "display_name": "CarlsBad505", "link": "https://stackoverflow.com/users/5713302/carlsbad505"}, "reply_to_user": {"reputation": 1035, "user_id": 5891503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/830569e0fa440b692ab80005ef9b00cb?s=128&d=identicon&r=PG", "display_name": "reiallenramos", "link": "https://stackoverflow.com/users/5891503/reiallenramos"}, "edited": false, "score": 0, "creation_date": 1595440813, "post_id": 52292285, "comment_id": 111478559, "body": "@reiallenramos you can do this for namespaced policies:  <code>Pundit.policy(current_admin, [:foo, Bar]) # ==&gt; Looks in Foo::BarPolicy</code>"}], "tags": [], "owner": {"reputation": 134, "user_id": 1222829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b16cfef450a13f4e58ee7eaba86274?s=128&d=identicon&r=PG", "display_name": "James Wang", "link": "https://stackoverflow.com/users/1222829/james-wang"}, "is_accepted": true, "score": 5, "last_activity_date": 1536745864, "creation_date": 1536745864, "answer_id": 52292285, "question_id": 51830937, "link": "https://stackoverflow.com/questions/51830937/export-all-user-policies-using-pundit-gem/52292285#52292285", "title": "Export all user policies using Pundit gem", "body": "<p>I have the same requirement, I got the following code working per investigation:</p>\n\n<pre><code>def index\n    classes = [Admin, BusNumber, Ticket, :ticket_statistics]     \n\n    permissions = { }                             \n\n    classes.each do |clazz|                       \n        policy =  Pundit.policy(current_admin, clazz)      \n        policy.public_methods(false).sort.each do |m|      \n            result = policy.send m                    \n            permissions[\"#{clazz}.#{m}\"] = result     \n        end\n    end \n\n    render json: permissions\nend  \n</code></pre>\n\n<p>the current_admin is the method to get the current login user, the code gives the following result</p>\n\n<pre><code>{\n    \"Admin.create?\": true,\n    \"Admin.disable?\": true,\n    \"Admin.enable?\": true,\n    \"Admin.index?\": true,\n    \"Admin.show?\": true,\n    \"Admin.update?\": true,\n    \"BusNumber.create?\": true,\n    \"BusNumber.destroy?\": true,\n    \"BusNumber.index?\": true,\n    \"BusNumber.update?\": true,\n    \"Ticket.index?\": true,\n    \"Ticket.refund_by_admin?\": true,\n    \"Ticket.show?\": true,\n    \"ticket_statistics.overall?\": true\n}\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 3618815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf72f74299b87baf87b9b2c5a33d4b2?s=128&d=identicon&r=PG", "display_name": "plcosta", "link": "https://stackoverflow.com/users/3618815/plcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 1, "accepted_answer_id": 52292285, "answer_count": 1, "score": 2, "last_activity_date": 1536745864, "creation_date": 1534196260, "question_id": 51830937, "link": "https://stackoverflow.com/questions/51830937/export-all-user-policies-using-pundit-gem", "title": "Export all user policies using Pundit gem", "body": "<p>How do I can retrieve all user policies and scopes using Pundit Gem? I need to return a json object with all user policies to check permissions in Frontend javascript templates.</p>\n\n<p>Using CanCanCan gem, I can do something like this:</p>\n\n<pre><code>class Ability\n  include CanCan::Ability\n\n  # ....\n\n  def to_list\n    rules.map do |rule|\n      object = { actions: rule.actions, subject: rule.subjects.map{ |s| s.is_a?(Symbol) ? s : s.name } }\n      object[:conditions] = rule.conditions unless rule.conditions.blank?\n      object[:inverted] = true unless rule.base_behavior\n      object\n    end\n  end\nend\n</code></pre>\n\n<p>Is possible to do the same with Pundit?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7838521, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CrHuDNVnxvc/AAAAAAAAAAI/AAAAAAAAAAA/e6o1U_R3nvw/photo.jpg?sz=128", "display_name": "Srinivasulu Chinna", "link": "https://stackoverflow.com/users/7838521/srinivasulu-chinna"}, "is_accepted": false, "score": 0, "last_activity_date": 1534440311, "creation_date": 1534440311, "answer_id": 51882410, "question_id": 51830612, "link": "https://stackoverflow.com/questions/51830612/ssl-certificate-path-with-ruby-eventmachine-httprequest/51882410#51882410", "title": "SSL certificate path with Ruby EventMachine HttpRequest", "body": "<p>I found the working solution for my above question.</p>\n\n<p>I made a monkey patch with EM Http SLL patch provided by Faraday lib and it got solved.</p>\n\n<p><a href=\"https://github.com/lostisland/faraday/blob/a712938071bb0997410b5de4a4f2517d30fc4d3d/lib/faraday/adapter/em_http_ssl_patch.rb\" rel=\"nofollow noreferrer\">https://github.com/lostisland/faraday/blob/a712938071bb0997410b5de4a4f2517d30fc4d3d/lib/faraday/adapter/em_http_ssl_patch.rb</a></p>\n\n<pre><code>options = {:head =&gt; {'Content-Type' =&gt; 'application/json'},\n   :ssl =&gt;{:verify_peer =&gt; true, :cert_chain_file =&gt; \"path/to/PEM/file\"}\n  }\n</code></pre>\n\n<p>And yes, the certificate validation is handled in the callback methods of the monkey patch.</p>\n"}], "owner": {"reputation": 49, "user_id": 7838521, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CrHuDNVnxvc/AAAAAAAAAAI/AAAAAAAAAAA/e6o1U_R3nvw/photo.jpg?sz=128", "display_name": "Srinivasulu Chinna", "link": "https://stackoverflow.com/users/7838521/srinivasulu-chinna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534440311, "creation_date": 1534194669, "last_edit_date": 1534195135, "question_id": 51830612, "link": "https://stackoverflow.com/questions/51830612/ssl-certificate-path-with-ruby-eventmachine-httprequest", "title": "SSL certificate path with Ruby EventMachine HttpRequest", "body": "<p>How to provide SSL certificate file/path in options when making HttpRequest call using EventMachine in Ruby when SSL verify_peer is true?\n(I want to validate the server certificate at the client side)</p>\n\n<p>I have the code this way...</p>\n\n<pre><code>options = {:head =&gt; {'Content-Type' =&gt; 'application/json'},\n   :ssl =&gt;{:verify_peer =&gt; true}\n  }\n</code></pre>\n\n<p><code>http_request = EventMachine::HttpRequest.new(\"URL\", options).get</code></p>\n\n<p>I heard that some ca_file , ca_path is used. \n Also, please suggest the EventMachine gem version that the solution works.</p>\n\n<p>If I am not right, do I need to handle this certificate validation in callback methods?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1534208141, "post_id": 51830124, "comment_id": 90618685, "body": "<a href=\"https://blog.yugui.jp/entry/846\" rel=\"nofollow noreferrer\">This</a> may help. It is written by one of the Ruby core developers."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1534281966, "last_edit_date": 1534281966, "creation_date": 1534193691, "answer_id": 51830409, "question_id": 51830124, "link": "https://stackoverflow.com/questions/51830124/is-there-a-difference-between-using-self-in-instance-eval-block-for-method-defin/51830409#51830409", "title": "Is there a difference between using self in instance_eval block for method definition?", "body": "<p>There's no difference. For precisely the reason you explained in the question.</p>\n\n<p>This is an example of a <em>redundant use of <code>self</code></em>. It's more common to see this when invoking a method, rather than defining it:</p>\n\n<pre><code>class Donald\n  def x\n  end\n\n  def y\n    self.x # &lt;-- `self` is redundant. We could just call `x` directly.\n  end\nend\n</code></pre>\n\n<p>However, if you'll excuse the absurdity of my example, being able to explicitly state the object (even if it's <code>self</code>) can sometimes be useful. Consider:</p>\n\n<pre><code>class Y; end\n\nclass Z; end\n\nZ.instance_eval do\n  def random_class\n    rand &gt; 0.5 ? Y : self\n  end\n\n  def random_class.x\n  end\nend\n</code></pre>\n\n<p>Here, the <code>random_class</code> is evaluated at runtime - so the code is syntactically valid, even though the <code>self</code> may be superfluous.</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51830409, "answer_count": 1, "score": 2, "last_activity_date": 1534281966, "creation_date": 1534192309, "question_id": 51830124, "link": "https://stackoverflow.com/questions/51830124/is-there-a-difference-between-using-self-in-instance-eval-block-for-method-defin", "title": "Is there a difference between using self in instance_eval block for method definition?", "body": "<p>Given that self refers to the object in which instance_eval was invoked on, is there a difference between using self in instance_eval block for method definition?  </p>\n\n<pre><code>Z.instance_eval do\n  def x\n  end\n\n  def self.y\n  end\nend\n\n&gt; Z.x\n =&gt; nil \n&gt; Z.y\n =&gt; nil \n</code></pre>\n\n<p>self seems superfluous given that self refers to Z. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "compilation", "execution", "pundit"], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1534190760, "creation_date": 1534190760, "answer_id": 51829827, "question_id": 51829468, "link": "https://stackoverflow.com/questions/51829468/ruby-loads-the-methods-at-run-time-or-compile/51829827#51829827", "title": "Ruby loads the methods at run time or compile?", "body": "<blockquote>\n  <p>Does Ruby on Rails execute the methods at run time or at compile time?</p>\n</blockquote>\n\n<p>Runtime.</p>\n\n<p>Methods will be <em>parsed</em> when first interpreted, but the actual code does not get evaluated until it is run.</p>\n\n<p>A method definition <em>could</em> contain complete nonsense (e.g. undefined variables) - but unless it contains a <em>syntax error</em>, this won't get exposed until the code is actually invoked.</p>\n\n<p>...And this is purely a \"ruby\" thing; it happens regardless of whether or not you're using the rails framework.</p>\n\n<blockquote>\n  <p>Is it optimal to create dynamic methods or is it better to create 3 methods separately in a static way?</p>\n</blockquote>\n\n<p>The depends what you mean by \"optimal\".</p>\n\n<p>Performance-wise, it's slightly faster to static methods. But unless you're building a core library, the difference is negligible - so I wouldn't worry about that.</p>\n\n<p>However, there are other good reasons to define methods statically when possible. Namely: The code is less confusing, it's easier to navigate to method definitions (e.g. when using an IDE), and it's easier to change method definitions when there's less meta-programming.</p>\n\n<p>Personally, I would probably be inclined to define these methods as:</p>\n\n<pre><code>def action1?\n  user.admin? || user == record.owner\nend\n\ndef action2?\n  action1?\nend\n\ndef action3?\n  action1?\nend\n</code></pre>\n\n<p>(But without knowing what the <code>action</code>s actually are, or how they fit into the wider context of your application, it's hard to give concrete advice.)</p>\n\n<p>Or if you prefer, you could also use <code>alias</code>.</p>\n"}], "owner": {"reputation": 141, "user_id": 5956611, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JyC9N.jpg?s=128&g=1", "display_name": "Jos&#233; Antonio Camus Godoy", "link": "https://stackoverflow.com/users/5956611/jos%c3%a9-antonio-camus-godoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 51829827, "answer_count": 1, "score": 1, "last_activity_date": 1534190760, "creation_date": 1534189100, "question_id": 51829468, "link": "https://stackoverflow.com/questions/51829468/ruby-loads-the-methods-at-run-time-or-compile", "title": "Ruby loads the methods at run time or compile?", "body": "<p>I'm working on a platform and they asked me to integrate the Pundit gem. When creating a policy I realized that many methods had the same access control policy.\nExample:</p>\n\n<pre><code>Action1: Only accessible by the administrator or owner of the resource\nAction2: Only accessible by the administrator or owner of the resource\nAction3: Only accessible by the administrator or owner of the resource\n.\n.\n.\n</code></pre>\n\n<p>Then I thought about creating dynamic methods in the following way</p>\n\n<pre><code>[: Action1 ?,: Action2? ,: Action3?].each do |meth|\n     define_method(meth){@current_user.admin? or @current_user.owner_resource?}\nend\n</code></pre>\n\n<p>But I got a question:\nDoes Ruby on Rails execute the methods at run time or at compile time?\nIs it optimal to create dynamic methods or is it better to create 3 methods separately in a static way?</p>\n\n<p>Thanks!!!</p>\n"}, {"tags": ["ruby", "yarv"], "answers": [{"comments": [{"owner": {"reputation": 598, "user_id": 5149429, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f289f89bc9452c9f9c7080eabbb1dc10?s=128&d=identicon&r=PG&f=1", "display_name": "bsam", "link": "https://stackoverflow.com/users/5149429/bsam"}, "edited": false, "score": 0, "creation_date": 1534188516, "post_id": 51829298, "comment_id": 90613018, "body": "Could you explain what you meant by &quot;You still would have to make sure that you are only performing a single operation each time and avoid read/write constructs&quot;?"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "reply_to_user": {"reputation": 598, "user_id": 5149429, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f289f89bc9452c9f9c7080eabbb1dc10?s=128&d=identicon&r=PG&f=1", "display_name": "bsam", "link": "https://stackoverflow.com/users/5149429/bsam"}, "edited": false, "score": 1, "creation_date": 1534188729, "post_id": 51829298, "comment_id": 90613119, "body": "Well, an operation like <code>array[0] = array[1] +42 </code> is not thread-safe since there could be overlapping threads in between the reads and writes. You also have toi make sure to only access objects stored in the Array / Queue from a single thread at a time (or use a Mutex to enforce this)."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 3, "last_activity_date": 1534188569, "last_edit_date": 1534188569, "creation_date": 1534188427, "answer_id": 51829298, "question_id": 51829201, "link": "https://stackoverflow.com/questions/51829201/are-yarv-arrays-push-pop-methods-thread-safe/51829298#51829298", "title": "Are YARV Arrays&#39; push/pop methods thread-safe?", "body": "<p>Accessing arrays is thread-safe in MRI/YARV (and only there) most of the time due to its global interpreter lock (GIL), thus mostly by accident.</p>\n\n<p>You still would have to make sure that you are only performing a single operation each time and avoid read/write constructs. In other Ruby implementations like Rubinius or JRuby, Arrays are explicitly not thread safe.</p>\n\n<p>With that being said, Ruby ships with a different primitive for inter-thread communication, which co-incidentaly is about the only class in MRI/VARV which is explicitly thread-safe: the <a href=\"http://ruby-doc.org/core/Queue.html\" rel=\"nofollow noreferrer\">Queue</a>. It supports pushing and poping objects in a thread-safe way.</p>\n\n<p>Take this example from Ruby's documentation:</p>\n\n<pre><code>queue = Queue.new\n\nproducer = Thread.new do\n  5.times do |i|\n     sleep rand(i) # simulate expense\n     queue &lt;&lt; i\n     puts \"#{i} produced\"\n  end\nend\n\nconsumer = Thread.new do\n  5.times do |i|\n     value = queue.pop\n     sleep rand(i/2) # simulate expense\n     puts \"consumed #{value}\"\n  end\nend\n</code></pre>\n\n<p>There also exists a well-maintained project called <a href=\"https://github.com/ruby-concurrency/concurrent-ruby\" rel=\"nofollow noreferrer\">concurrent-ruby</a> which offers a lot of powerful primitives for concurrent programming across threads.</p>\n"}], "owner": {"reputation": 598, "user_id": 5149429, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f289f89bc9452c9f9c7080eabbb1dc10?s=128&d=identicon&r=PG&f=1", "display_name": "bsam", "link": "https://stackoverflow.com/users/5149429/bsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 51829298, "answer_count": 1, "score": 3, "last_activity_date": 1534188569, "creation_date": 1534188017, "last_edit_date": 1534188352, "question_id": 51829201, "link": "https://stackoverflow.com/questions/51829201/are-yarv-arrays-push-pop-methods-thread-safe", "title": "Are YARV Arrays&#39; push/pop methods thread-safe?", "body": "<p>Suppose I have a pair of (producer, consumer) YARV threads (<code>Tp</code>,<code>Tc</code>) sharing an <code>Array</code> <code>q</code> - <code>Tp</code> pushes to <code>q</code>, and <code>Tc</code> pops from it. If the order in which the pushes and pops get executed is unimportant, does the code work without any synchronization mechanism?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1534185646, "post_id": 51828619, "comment_id": 90611696, "body": "Because <code>&amp;:length</code> is a symbol. You cannot pass functions that take <i>additional</i> arguments in this fashion. You can <i>create</i> a function that compares its input to <code>4</code> and pass <i>that</i> in, but all you can pass to functions expecting a process/block/method symbol is just that."}], "answers": [{"comments": [{"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534187014, "post_id": 51828749, "comment_id": 90612382, "body": "yea, or even <code>[3, 3].all? { |n| n &gt; 4 }</code>, but I just wanted to show, that you can create a reusable lambda and create a one-liner <code>w.map(&amp;:length).all?(greater_than_four)</code>, but seems it appeared to be quite a vague idea"}, {"owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1534188774, "post_id": 51828749, "comment_id": 90613140, "body": "@CarySwoveland could reproduce it on Ruby &lt;= 2.4.1. Since 2.5.0 seems fixed"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1534208423, "post_id": 51828749, "comment_id": 90618736, "body": "To be precise, the ampersand hasn&#39;t come into play yet. The problem is simply with <code>:length &gt; 4</code>. The ampersand would then apply to the result of it if that step had succeeded."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 1, "last_activity_date": 1534187034, "last_edit_date": 1534187034, "creation_date": 1534186069, "answer_id": 51828749, "question_id": 51828619, "link": "https://stackoverflow.com/questions/51828619/using-ampersand-with-an-enumerator-in-a-comparison/51828749#51828749", "title": "Using ampersand with an enumerator in a comparison", "body": "<p>You receive the following error, because the interpreter actually executes the following piece of code:</p>\n\n<pre><code>&amp;:length &gt; 4\n</code></pre>\n\n<p>and can't compare symbol <code>:length</code> with number <code>4</code>.</p>\n\n<blockquote>\n  <p>Is there a way to get this to work or do I have to do: w.all? { |word| word.length > 4 }</p>\n</blockquote>\n\n<p>You could do something like:</p>\n\n<pre><code>w.map(&amp;:length).all? { |n| n &gt; 4 }\n</code></pre>\n\n<p>But the following code is the simpliest way to go:</p>\n\n<pre><code>w.all? { |word| word.length &gt; 4 }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 0, "last_activity_date": 1534186931, "last_edit_date": 1534186931, "creation_date": 1534186083, "answer_id": 51828754, "question_id": 51828619, "link": "https://stackoverflow.com/questions/51828619/using-ampersand-with-an-enumerator-in-a-comparison/51828754#51828754", "title": "Using ampersand with an enumerator in a comparison", "body": "<blockquote>\n  <p>Is there a way to get this to work this way <code>w.all?(&amp;:length &gt; 4)</code>?</p>\n</blockquote>\n\n<p>There is no way to make it work this way because it will require you to rewrite Ruby's interpreter.</p>\n\n<blockquote>\n  <p>or do I have to do: <code>w.all? { |word| word.length &gt; 4 }</code></p>\n</blockquote>\n\n<p>Yes, this is simple to read yet efficient way to do what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "is_accepted": false, "score": 0, "last_activity_date": 1534190718, "last_edit_date": 1534190718, "creation_date": 1534190002, "answer_id": 51829662, "question_id": 51828619, "link": "https://stackoverflow.com/questions/51828619/using-ampersand-with-an-enumerator-in-a-comparison/51829662#51829662", "title": "Using ampersand with an enumerator in a comparison", "body": "<p>I had to hunt around a bit for a good technical answer to what's going on. <a href=\"https://www.skorks.com/2013/04/ruby-ampersand-parameter-demystified/\" rel=\"nofollow noreferrer\">I found a thorough explanation here.</a> The last section of that page explains what is happening in this particular case (but you should read the top part of the page as well).</p>\n\n<p>Coming from Perl, I imagined the <code>&amp;:length</code> was acting kind of like the <code>$_</code> variable. This is not correct.</p>\n\n<p>What is happening is that instead of passing a block to the <code>all?</code> method, you are passing arguments to the <code>all?</code> method (note the parenthesis instead of curly braces). Here, we are passing the symbol for the method <code>length</code> as an argument to to <code>all?</code>. You put the <code>&amp;</code> in front of the symbol to get it to call the <code>to_proc</code> method (whatever that is) on the <code>length</code> method so it can call the <code>length</code> function inside the <code>all?</code> method for each element.</p>\n"}], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1534208324, "creation_date": 1534185477, "last_edit_date": 1534208324, "question_id": 51828619, "link": "https://stackoverflow.com/questions/51828619/using-ampersand-with-an-enumerator-in-a-comparison", "title": "Using ampersand with an enumerator in a comparison", "body": "<p>I have the following snippet that throws an error:</p>\n\n<pre><code>w = %w[ant dog]\nw.all?(&amp;:length &gt; 4)\n</code></pre>\n\n<p>It throws an error <code>comparison of Symbol with 4 failed (ArgumentError)</code>.</p>\n\n<p>I'm not sure why <code>&amp;:length</code> is a symbol and not a number. I tried:</p>\n\n<pre><code>w.all?((&amp;:length) &gt; 4)\n</code></pre>\n\n<p>but that gives me a syntax error. Is there a way to get this to work or do I have to do: <code>w.all? { |word| word.length &gt; 4 }</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "activerecord", "arel"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1534484417, "post_id": 51828337, "comment_id": 90728972, "body": "hey, have you solved your problem?"}, {"owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1534622308, "post_id": 51828337, "comment_id": 90774278, "body": "Hey, thanks for your help, I wrote two methods in Coin class that will do the job, but I like your version too."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1534186570, "post_id": 51828539, "comment_id": 90612162, "body": "Thanks! I just edited my question to make the associations a bit clearer.  Does that affect your answer?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1534187079, "post_id": 51828539, "comment_id": 90612408, "body": "@user211309 edited the answer, I think (having corresponding <code>belongs_to</code>) you could make it work with <code>Coin.joins(positions: :user)...</code>. But this should do as well"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1534186721, "last_edit_date": 1534186721, "creation_date": 1534185144, "answer_id": 51828539, "question_id": 51828337, "link": "https://stackoverflow.com/questions/51828337/writing-an-activerecord-arel-query-to-select-the-coin-held-by-the-greatest-numbe/51828539#51828539", "title": "Writing an ActiveRecord/AREL query to select the coin held by the greatest numbers of users", "body": "<p>There is a way to achieve what you want:</p>\n\n<pre><code>Coin\n  .joins(positions: { portfolio: :user })\n  .group(\"coins.id\")\n  .order(\"COUNT(DISTINCT(users.id)) DESC\")\n  .first\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 51828539, "answer_count": 1, "score": 0, "last_activity_date": 1534622491, "creation_date": 1534184262, "last_edit_date": 1534622491, "question_id": 51828337, "link": "https://stackoverflow.com/questions/51828337/writing-an-activerecord-arel-query-to-select-the-coin-held-by-the-greatest-numbe", "title": "Writing an ActiveRecord/AREL query to select the coin held by the greatest numbers of users", "body": "<p>Just to explain: I have the following models and associations:</p>\n\n<pre><code>User      has_many   :portfolios\n          has many   :positions, through: portfolios\nPortfolio has_many   :positions\nPosition  belongs_to :coin\nCoin      has_many   :positions\n</code></pre>\n\n<p>I want to select the coin that is held by the greatest number of users, but am struggling a bit to come up with the correct query. I could imagine writing something like 'find the coin that has the most positions, where the user_ids of the positions are distinct'. Is that the right idea, and how does one type that up?  </p>\n\n<p>EDIT: </p>\n\n<pre><code>def number_of_users\n  count = 0\n  User.all.each do |user|\n    if user.positions.any?{|pos| pos.coin_id == self.id}\n      count += 1\n    end\n  end\n  return count\nend\n\ndef self.with_most_holders\n  self.all.max_by {|coin| coin.number_of_users}\nend\n</code></pre>\n"}, {"tags": ["ruby", "mongodb", "automated-tests"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10220786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VaXynt59O5Y/AAAAAAAAAAI/AAAAAAAAEE4/jF5MZxrEdsg/photo.jpg?sz=128", "display_name": "Gabriela Vital", "link": "https://stackoverflow.com/users/10220786/gabriela-vital"}, "edited": false, "score": 0, "creation_date": 1534248742, "post_id": 51838157, "comment_id": 90635278, "body": "It worked! Thanks a lot @v&#225;clav! I really appreciate your help. The weirdest thing is that I&#39;ve found <code>.collection</code> method in <a href=\"http://api.mongodb.com/ruby/1.7.0/file.TUTORIAL.html\" rel=\"nofollow noreferrer\">Mongo API documentation</a>."}, {"owner": {"reputation": 211, "user_id": 4207625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b672c1aaa6bf9e222e114ec0d1384da?s=128&d=identicon&r=PG&f=1", "display_name": "V&#225;clav Pruner", "link": "https://stackoverflow.com/users/4207625/v%c3%a1clav-pruner"}, "reply_to_user": {"reputation": 3, "user_id": 10220786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VaXynt59O5Y/AAAAAAAAAAI/AAAAAAAAEE4/jF5MZxrEdsg/photo.jpg?sz=128", "display_name": "Gabriela Vital", "link": "https://stackoverflow.com/users/10220786/gabriela-vital"}, "edited": false, "score": 0, "creation_date": 1534250657, "post_id": 51838157, "comment_id": 90636466, "body": "@GabrielaVital that is the documentation for mongo 1.7.0 and it looks like a lot of the api has changed, e.g. in the example there is Mongo::Connection which doesn&#39;t exist in newer apis. The readme with tuorials and whatnot can be found <a href=\"http://api.mongodb.com/ruby/2.6.1/index.html\" rel=\"nofollow noreferrer\">here</a> - notice the 2.6.1 in the url."}, {"owner": {"reputation": 3, "user_id": 10220786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VaXynt59O5Y/AAAAAAAAAAI/AAAAAAAAEE4/jF5MZxrEdsg/photo.jpg?sz=128", "display_name": "Gabriela Vital", "link": "https://stackoverflow.com/users/10220786/gabriela-vital"}, "edited": false, "score": 0, "creation_date": 1534252202, "post_id": 51838157, "comment_id": 90637530, "body": "Got it! I&#39;ll take a look at it. Thanks again! =)"}], "tags": [], "owner": {"reputation": 211, "user_id": 4207625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b672c1aaa6bf9e222e114ec0d1384da?s=128&d=identicon&r=PG&f=1", "display_name": "V&#225;clav Pruner", "link": "https://stackoverflow.com/users/4207625/v%c3%a1clav-pruner"}, "is_accepted": true, "score": 0, "last_activity_date": 1534238916, "creation_date": 1534238916, "answer_id": 51838157, "question_id": 51828191, "link": "https://stackoverflow.com/questions/51828191/undefined-method-collection-for-mongoclient-did-you-mean-collections-no/51838157#51838157", "title": "Undefined method `collection&#39; for #&lt;Mongo::Client&gt; Did you mean? collections (NoMethodError). Ruby", "body": "<p>Based on <a href=\"https://api.mongodb.com/ruby/current/Mongo/Client.html\" rel=\"nofollow noreferrer\">documentation</a>, there is indeed no method collection in Mongo::Client. What you are looking for is the <a href=\"https://api.mongodb.com/ruby/current/Mongo/Client.html#[]-instance_method\" rel=\"nofollow noreferrer\">[] method</a>. The code will then look like this:</p>\n\n<pre><code>require 'mongo'\nrequire 'singleton'\n\nclass DBClient\n  include Singleton\n\n  def initialize\n    @db_connection = Mongo::Client.new($env['database']['feature']['url'])\n  end\n\n  def find(collection, value)\n    coll = @db_connection[collection]\n    coll.find(owner: value)\n  end\nend\n</code></pre>\n\n<p>EDIT: I've also changed the line with the find itself. In your original code, it would find documents where owner is 'value' string. I presume you want the documents where owner matches the value send to the function.</p>\n"}], "owner": {"reputation": 3, "user_id": 10220786, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VaXynt59O5Y/AAAAAAAAAAI/AAAAAAAAEE4/jF5MZxrEdsg/photo.jpg?sz=128", "display_name": "Gabriela Vital", "link": "https://stackoverflow.com/users/10220786/gabriela-vital"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 51838157, "answer_count": 1, "score": 0, "last_activity_date": 1534238916, "creation_date": 1534183679, "last_edit_date": 1534184175, "question_id": 51828191, "link": "https://stackoverflow.com/questions/51828191/undefined-method-collection-for-mongoclient-did-you-mean-collections-no", "title": "Undefined method `collection&#39; for #&lt;Mongo::Client&gt; Did you mean? collections (NoMethodError). Ruby", "body": "<p>I am working with automated test. This is the first time I'm working with mongoDB.</p>\n\n<p>So, I am trying to create a generic method to find a document in a desired collection that will be passed as parameter. I've found some examples and all of them use the <code>.collection</code> method. It doesn't seem to work in my project.</p>\n\n<p>Here's my DB client code:</p>\n\n<pre><code>require 'mongo'\nrequire 'singleton'\n\nclass DBClient\ninclude Singleton\n  def initialize\n    @db_connection = Mongo::Client.new($env['database']['feature']['url'])\n  end\n\n  def find(collection, value)\n    coll = @db_connection.collection(collection)\n    coll.find(owner: 'value')\n  end\nend\n</code></pre>\n\n<p>And here's how I instance my method</p>\n\n<pre><code>DBClient.instance.find('collectionTest', 'Jhon')\n</code></pre>\n\n<p>When I run my test I get the following message:</p>\n\n<pre><code>undefined method `collection' for #&lt;Mongo::Client: cluster=localhost:&gt;\n  Did you mean?  collections (NoMethodError)\n</code></pre>\n\n<p>The gem I'm using is mongo (2.6.1).</p>\n\n<p>What I am doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara"], "comments": [{"owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "edited": false, "score": 0, "creation_date": 1534176840, "post_id": 51825657, "comment_id": 90607408, "body": "@thesecretmaster Why delete your comment?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1534176942, "post_id": 51825657, "comment_id": 90607466, "body": "What driver and/or browser are you using with Capybara?"}, {"owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1534177038, "post_id": 51825657, "comment_id": 90607523, "body": "@ThomasWalpole <code>require &#39;capybara&#47;poltergeist&#39;</code> <code>Capybara.javascript_driver = :poltergeist</code>"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1534177122, "post_id": 51825657, "comment_id": 90607565, "body": "What version of Poltergeist? What version of PhantomJS? And where did you get the PhantomJS you\u2019re using from?"}, {"owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1534177228, "post_id": 51825657, "comment_id": 90607630, "body": "@ThomasWalpole <code>poltergeist (1.18.0)</code> / <code>phantomjs -v 2.1.1</code>. I got phantomjs via brew."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1534177593, "post_id": 51825657, "comment_id": 90607795, "body": "Hmm, those should work together unless there is a JS widget playing with the file input which doesn\u2019t work under PhantomJS (ES5 only). Have you tried running the test with Selenium and Chrome to narrow down whether it\u2019s a driver or test issue?"}], "owner": {"reputation": 2704, "user_id": 3968048, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/efc99cf1bee109f5f2d797f32b492ecd?s=128&d=identicon&r=PG&f=1", "display_name": "Peter R", "link": "https://stackoverflow.com/users/3968048/peter-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534176587, "creation_date": 1534173724, "last_edit_date": 1534176587, "question_id": 51825657, "link": "https://stackoverflow.com/questions/51825657/file-upload-is-not-setting-param-as-a-file-but-as-a-string", "title": "File upload is not setting param as a File, but as a String", "body": "<p>I'm testing a form with Capybara like so:</p>\n\n<pre><code>attach_file('csv', File.absolute_path('spec/support/test.csv'))\n</code></pre>\n\n<p>If I print out the params in the controller this way, I get:</p>\n\n<pre><code>{\n  \"csv\"=&gt;\"test.csv\",\n}\n</code></pre>\n\n<p>However if I do it in the browser, and select a file and submit the form that way, I get the following params.</p>\n\n<pre><code>{\n  \"csv\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x00007f90786456f8 @tempfile=#&lt;Tempfile:/var/folders/dd/.../T/RackMultipart20180813-8714-9t8e5.csv&gt;, ...&gt;\n  \"remotipart_submitted\"=&gt;\"true\", \n  \"X-Requested-With\"=&gt;\"IFrame\", \n  \"X-Http-Accept\"=&gt;\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01\",  \n}\n</code></pre>\n\n<p>Why does Capybara give me a file path <code>String</code>, instead of a <code>ActionDispatch::Http::UploadedFile</code>? How can I get capybara to mimic an actual file upload?</p>\n"}, {"tags": ["ruby", "neovim", "rubocop", "linter"], "answers": [{"comments": [{"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534173514, "post_id": 51825564, "comment_id": 90605378, "body": "(though no tools would behave differently if the Array method did not exist -- it still <i>could</i> exist)"}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534173700, "post_id": 51825564, "comment_id": 90605491, "body": "Do I need syntastic at all? Does it do anything RuboCop doesn&#39;t?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1534173828, "post_id": 51825564, "comment_id": 90605563, "body": "What Do you mean by <code>syntastic</code>? Is that a gem you are using?"}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534173919, "post_id": 51825564, "comment_id": 90605613, "body": "It&#39;s s vim plugin that does syntax checking. I just found this comment that may shed some light on things for me: &quot;In languages with a managed runtime such as ruby where you don&#39;t really have the same kind of compile-time checking, a good linter is even more important.&quot; It seems that it&#39;s tougher to catch compile time errors with Ruby. With Perl, it was pretty obvious which errors were compile time and which were run time."}, {"owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "edited": false, "score": 0, "creation_date": 1534174510, "post_id": 51825564, "comment_id": 90605977, "body": "<code>my $r = Array()</code>, <code>my $r = Array.new()</code>, and <code>my $r = one array please, good sir</code> all <code>perl -c</code> as OK for me... I don&#39;t think Ruby&#39;s unique in having a flexible syntax where many spellings have <i>some</i> meaning, even if it&#39;s not the one you intended."}, {"owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 0, "creation_date": 1534176684, "post_id": 51825564, "comment_id": 90607320, "body": "The first one fails because it&#39;s a runtime error, no subroutine called &quot;Array&quot;. The second and third examples fail when <code>use strict;</code> is turned on, which it always should be with Perl."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "edited": false, "score": 1, "creation_date": 1534177594, "post_id": 51825564, "comment_id": 90607797, "body": "@StevieD: When you are interested in checking syntax then yes, you will need both. Because Rubocop isn&#39;t primarily a tool to check syntax but a tool to ensure that certain the code follows defined coding conventions or a code style guide your team agreed on."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1534173521, "last_edit_date": 1592644375, "creation_date": 1534173430, "answer_id": 51825564, "question_id": 51825344, "link": "https://stackoverflow.com/questions/51825344/can-this-ruby-error-be-caught-with-neovim-ale-rubocop-syntastic/51825564#51825564", "title": "Can this Ruby error be caught with NeoVim/ALE/RuboCop/Syntastic?", "body": "<p>Both tools are correct, because there is the <a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-Array\" rel=\"nofollow noreferrer\"><code>Array()</code></a> method defined in <code>Kernel</code>.</p>\n<p>That means this is not a syntax but a runtime error because that method expects at least one argument.</p>\n<p>From the <a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-Array\" rel=\"nofollow noreferrer\">docs</a>:</p>\n<blockquote>\n<p><code>Array(arg) \u2192 array</code>\nReturns <code>arg</code> as an <code>Array</code>.</p>\n<p>First tries to call <code>to_ary</code> on <code>arg</code>, then <code>to_a</code>. If <code>arg</code> does not respond to <code>to_ary</code> or <code>to_a</code>, returns an <code>Array</code> of length 1 containing <code>arg</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 51825564, "answer_count": 1, "score": 0, "last_activity_date": 1534173521, "creation_date": 1534172712, "question_id": 51825344, "link": "https://stackoverflow.com/questions/51825344/can-this-ruby-error-be-caught-with-neovim-ale-rubocop-syntastic", "title": "Can this Ruby error be caught with NeoVim/ALE/RuboCop/Syntastic?", "body": "<p>I'm new to Ruby and doing some experimenting with NeoVim/ALE which I'm also new to. I'm coming from Perl using the syntastic plugin and I'm trying to figure out how to best set up NeoVim/ALE/RuboCop. I've never used a delinter before.</p>\n\n<p>My confusion stems from this bit of code:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nr = Array() # Improper array initialization, should be Array.new()\nputs r\n</code></pre>\n\n<p>When run, I get:</p>\n\n<pre><code>Traceback (most recent call last):\n        1: from /Users/me/ruby/workshop/dink.rb:3:in `&lt;main&gt;'  \n/Users/me/ruby/workshop/dink.rb:3:in `Array': wrong number of arguments (given  \n0, expected 1) (ArgumentError)\n</code></pre>\n\n<p>RuboCop didn't catch this error. I turned syntastic on and it didn't catch the error either. I assume because it's a runtime error and not a compile time error like I thought it would be. Running <code>ruby -c</code> on the script yields no errors either. But perhaps I'm wrong and aren't using the syntax checking tools properly. Can someone please confirm that this is indeed a runtime error and that it's impossible to catch before executing the script?</p>\n\n<p>I have a second question as well: Do I need syntastic with Ruby? Does it do anything more that RuboCop doesn't?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534224507, "post_id": 51825233, "comment_id": 90622268, "body": "Have you considered posting this as an issue on <a href=\"https://github.com/mongodb/mongoid\" rel=\"nofollow noreferrer\">mongoid</a>?"}, {"owner": {"reputation": 226, "user_id": 5108881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rFOwmrmP5_w/AAAAAAAAAAI/AAAAAAAAAIk/6mhJlyeFM6A/photo.jpg?sz=128", "display_name": "Lewis Jones", "link": "https://stackoverflow.com/users/5108881/lewis-jones"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534233140, "post_id": 51825233, "comment_id": 90626040, "body": "alas the repository does not allow the public to raise issues"}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1539157702, "post_id": 51825233, "comment_id": 92395052, "body": "It is very easy to create an account on their JIRA and drop an issue. I also noticed this on mongoid 7 while I did not have this behavior previously"}, {"owner": {"reputation": 226, "user_id": 5108881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rFOwmrmP5_w/AAAAAAAAAAI/AAAAAAAAAIk/6mhJlyeFM6A/photo.jpg?sz=128", "display_name": "Lewis Jones", "link": "https://stackoverflow.com/users/5108881/lewis-jones"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1539171202, "post_id": 51825233, "comment_id": 92403041, "body": "I will add the issue @CyrilDuchon-Doris my company pays for Mongo support so I have access to their Jira"}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1539171573, "post_id": 51825233, "comment_id": 92403238, "body": "Hey @LewisJones I actually just fixed the bug I had, which was caused by a bad inverse declared in my model + changes to the way Mongoid 7 infers class_name from the namespace. So I actually did not confirm your bug on Mongoid 7, and actually I have never tried to set default values based from nested/parent associations using lambdas like you did, sorry for the previous comment."}], "owner": {"reputation": 226, "user_id": 5108881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rFOwmrmP5_w/AAAAAAAAAAI/AAAAAAAAAIk/6mhJlyeFM6A/photo.jpg?sz=128", "display_name": "Lewis Jones", "link": "https://stackoverflow.com/users/5108881/lewis-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1534175696, "creation_date": 1534172301, "last_edit_date": 1534175696, "question_id": 51825233, "link": "https://stackoverflow.com/questions/51825233/mongoid-parent-of-embedded-document-returning-nil-from-field-default-lambda", "title": "Mongoid: Parent of embedded document returning nil from field default lambda", "body": "<p>I have two Mongoid models defined as</p>\n\n<pre><code>class Owner\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embeds_many :pets, class_name: 'Pet', inverse_of: :owner\n\n  field :special_unit, type: String\n\nend\n\n\n\nclass Pet\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n\n  embedded_in :owner, inverse_of: :pets\n\n  field :special_unit, default: lambda {\n    if owner\n      owner.special_unit\n    else\n      'default_value'\n    end\n  }\nend\n</code></pre>\n\n<p>If I create a persisted <code>Owner</code> with <code>special_unit</code> field set.</p>\n\n<pre><code>owner = Owner.create(special_unit: 'foo')\nowner.pets.create\nowner.pets.first.special_unit\n=&gt; 'default_value'\n</code></pre>\n\n<p>The owners pet has <code>default_value</code> as the  value special unit. This is because <code>pet</code> is returning <code>nil</code> inside the lambda that the field default is calling. If I call <code>_parent</code> inside the lambda <code>nil</code> is also returned. Does anyone know why this is?</p>\n\n<p>For further context I am able to call <code>#owner</code> and <code>#_parent</code> on an instance of <code>Pet</code> and return the expected owner. It's during the field default assignment that nil is returned.</p>\n\n<p>I am using mongoid 6.4</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rake"], "comments": [{"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1534172074, "post_id": 51824841, "comment_id": 90604480, "body": "That&#39;s a weird one. I can&#39;t really help you here, but hopefully someone else will be able to."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1534173188, "post_id": 51824841, "comment_id": 90605195, "body": "The error &quot;stack level too deep&quot; is not caused by files being too big (and let&#39;s be honest: 20MB is not very big). &quot;Stack level too deep&quot; means the chain of methods being called (<code>a</code> calls <code>b</code>, <code>b</code> calls <code>c</code>, <code>c</code> calls <code>d</code>, ...) is too long. Typically this is caused by infinite recursion\u2014<code>d</code> calls <code>a</code>, which calls <code>b</code> again, and so on. That&#39;s not apparent in your stack trace, but it might be revealed in the full trace (<code>--trace</code>). Since the error is happening in the <code>bootsnap</code> code, you might also try uninstalling that gem temporarily to see if the error goes away."}, {"owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 0, "creation_date": 1534177574, "post_id": 51824841, "comment_id": 90607784, "body": "Thanks Jordan. Just as a test I commented out any model related code but still got the error. Sucks because bootsnap is required for any/all rake related tasks. Provided the full trace if that helps at all."}], "answers": [{"tags": [], "owner": {"reputation": 580, "user_id": 5041876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942018cf0f020de80bef0fbdf4a882f8?s=128&d=identicon&r=PG&f=1", "display_name": "NiftyAsp", "link": "https://stackoverflow.com/users/5041876/niftyasp"}, "is_accepted": false, "score": 0, "last_activity_date": 1534172212, "creation_date": 1534172212, "answer_id": 51825205, "question_id": 51824841, "link": "https://stackoverflow.com/questions/51824841/best-way-to-populate-db-with-large-ruby-json-files/51825205#51825205", "title": "Best way to populate db with large ruby/json files?", "body": "<p>I would use something like <a href=\"https://github.com/mperham/sidekiq/wiki/Complex-Job-Workflows-with-Batches\" rel=\"nofollow noreferrer\">Sidekiq</a> to break the jobs in to workers that can run concurrently.  </p>\n\n<p>For example:</p>\n\n<pre><code>$restaurants.each_with_index do |r, index|\n    RestaurantParser.perform_async(r, index)\nend\n</code></pre>\n\n<p>In RestaurantParser perform the steps you would normally take.</p>\n\n<p>As long as restaurants don't rely on other restaurants already existing in the DB you can run workers concurrently to speed up the process.</p>\n"}], "owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534177487, "creation_date": 1534170976, "last_edit_date": 1534177487, "question_id": 51824841, "link": "https://stackoverflow.com/questions/51824841/best-way-to-populate-db-with-large-ruby-json-files", "title": "Best way to populate db with large ruby/json files?", "body": "<p>Let's say I have a ruby or json file consisting of hashes and range anywhere from 14-20MB (300K lines unminified). I've created a rake task which loops through each hash and creates an AR object based on the values in each hash.</p>\n\n<p>Unfortunately due to the file's size I get <code>stack level too deep</code> errors each time I run the task. The only way I've actually gotten the script to run is by splitting the file into smaller ones. Although this works, it gets extremely tedious to split the file and repeat the task over and over. Are there any good alternatives for loading/running large files?</p>\n\n<p><strong>Rake Task</strong></p>\n\n<pre><code>namespace :db do\n  task populate: :environment do\n    $restaurants.each_with_index do |r, index|\n      uri = URI(r[:website])\n\n      restaurant = Restaurant.find_or_create_by(name: r[:name], website: \"#{uri.scheme}://#{uri.host}\")\n\n      restaurant.cuisines = r[:cuisines].map { |c| Cuisine.find_or_create_by(name: c) }\n\n      location = Location.create(\n        restaurant: restaurant,\n        city_id: 1,\n        address: r[:address],\n        latitude: r[:latitude],\n        longitude: r[:longitude],\n        phone_number: r[:phone_number]\n      )\n\n      r[:hours].each do |h|\n        Hour.create(\n          location: location,\n          day: Date::DAYNAMES.index(h[:day]),\n          opens: h[:opens],\n          closes: h[:closes]\n        )\n      end\n\n      menu_group = MenuGroup.create(\n        restaurant: restaurant,\n        locations: [location],\n        address: r[:address]\n      )\n\n      r[:menus].each do |m|\n        menu = Menu.create(\n          menu_group: menu_group,\n          position: m[:position],\n          name: m[:name]\n        )\n\n        m[:sections].each do |s|\n          section = Section.create(\n            menu: menu,\n            position: s[:position],\n            name: s[:name]\n          )\n\n          s[:dishes].each do |d|\n            tag = Tag.find_or_create_by(\n              name: d[:name].downcase.strip\n            )\n\n            Dish.find_or_create_by(\n              restaurant: restaurant,\n              sections: [section],\n              tags: [tag],\n              name: d[:name],\n              description: d[:description]\n            )\n          end\n        end\n      end\n\n      puts \"#{index + 1} of #{$restaurants.size} completed\"\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>rake aborted!\nSystemStackError: stack level too deep\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/compile_cache/iseq.rb:12:in`to_binary'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/compile_cache/iseq.rb:12:in`input_to_storage'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/compile_cache/iseq.rb:37:in`fetch'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/compile_cache/iseq.rb:37:in`load_iseq'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n/usr/local/lib/ruby/gems/2.5.0/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `block in require'\n/usr/local/lib/ruby/gems/2.5.0/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:249:in `load_dependency'\n/usr/local/lib/ruby/gems/2.5.0/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `require'\n/Users/user/app/lib/tasks/populate.rake:1:in `&lt;main&gt;'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n/usr/local/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.1/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n/usr/local/lib/ruby/gems/2.5.0/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:277:in `block in load'\n/usr/local/lib/ruby/gems/2.5.0/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:249:in `load_dependency'\n/usr/local/lib/ruby/gems/2.5.0/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:277:in `load'\n/usr/local/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/engine.rb:650:in `block in run_tasks_blocks'\n/usr/local/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/engine.rb:650:in `each'\n/usr/local/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/engine.rb:650:in `run_tasks_blocks'\n/usr/local/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/application.rb:515:in `run_tasks_blocks'\n/usr/local/lib/ruby/gems/2.5.0/gems/railties-5.2.0/lib/rails/engine.rb:459:in `load_tasks'\n/Users/user/app/Rakefile:6:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/gems/2.5.0/gems/rake-12.3.1/exe/rake:27:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n"}, {"tags": ["ruby", "docker", "rubygems", "docker-compose", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 2318, "user_id": 1913726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jEdHu.jpg?s=128&g=1", "display_name": "dmmfll", "link": "https://stackoverflow.com/users/1913726/dmmfll"}, "is_accepted": false, "score": 19, "last_activity_date": 1545342012, "last_edit_date": 1545342012, "creation_date": 1541450001, "answer_id": 53161795, "question_id": 51824689, "link": "https://stackoverflow.com/questions/51824689/rails-could-not-find-concurrent-ruby-1-0-5-in-any-of-the-sources-bundlergemn/53161795#53161795", "title": "Rails: Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)", "body": "<p>I had an issue similar to this outside of Docker.</p>\n\n<p>I deleted the <code>Gemfile.lock</code> and ran <code>bundle</code>.</p>\n\n<p>Issue went away.</p>\n\n<p>Your mileage may vary.</p>\n"}, {"comments": [{"owner": {"reputation": 46162, "user_id": 610573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e385b6ee766f289fe921610c025717c0?s=128&d=identicon&r=PG", "display_name": "Chris Baker", "link": "https://stackoverflow.com/users/610573/chris-baker"}, "edited": false, "score": 1, "creation_date": 1604019865, "post_id": 55001811, "comment_id": 114227233, "body": "I am not sure what aspect of the question caused you to think it is related to metasploit at all. An assumption that the only thing people use docker for is to run metasploit? IDK where you&#39;re coming from with this answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 11153659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e371d0735079f91b8e86b70aa422b5?s=128&d=identicon&r=PG&f=1", "display_name": "hackrz_of_heart", "link": "https://stackoverflow.com/users/11153659/hackrz-of-heart"}, "is_accepted": false, "score": -3, "last_activity_date": 1551787732, "last_edit_date": 1551787732, "creation_date": 1551785440, "answer_id": 55001811, "question_id": 51824689, "link": "https://stackoverflow.com/questions/51824689/rails-could-not-find-concurrent-ruby-1-0-5-in-any-of-the-sources-bundlergemn/55001811#55001811", "title": "Rails: Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)", "body": "<p>Nothing will make it work unless you reinstall the metasploit-framework. I have been facing the issue for 1 week. I have personally tried and its running now.</p>\n\n<blockquote>\n  <p>$ pkg upgrade &amp;&amp; pkg install git &amp;&amp; pkg install curl &amp;&amp; pkg install\n  wget &amp;&amp; pkg install nmap &amp;&amp; curl -LO\n  raw.githubusercontent.com/Hax4us/Metasploit_termux/master/metasploit.sh\n  &amp;&amp; chmod 777 metasploit.sh &amp;&amp; ./metasploit.sh</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 601, "user_id": 895602, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b931f120f71f4622dbb6266cd77f8884?s=128&d=identicon&r=PG", "display_name": "Jose", "link": "https://stackoverflow.com/users/895602/jose"}, "is_accepted": false, "score": 3, "last_activity_date": 1552449087, "creation_date": 1552449087, "answer_id": 55134112, "question_id": 51824689, "link": "https://stackoverflow.com/questions/51824689/rails-could-not-find-concurrent-ruby-1-0-5-in-any-of-the-sources-bundlergemn/55134112#55134112", "title": "Rails: Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)", "body": "<p>I had this same error with docker-compose. Apparently, it was installing the gem, after running <code>docker-compose run backend bundle install</code> the Gemfile.lock file was updated correctly. Still, it would continue displaying this error either for this gem or others.</p>\n\n<p>Turns out that in some cases just running bundle install with docker is not enough. As specified in the documentation here: <a href=\"https://docs.docker.com/compose/rails/\" rel=\"nofollow noreferrer\">https://docs.docker.com/compose/rails/</a> sometimes after running bundle install you need to rebuild the images. This fixed my problem:</p>\n\n<pre><code>docker-compose run backend bundle install\ndocker-compose build\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14127, "user_id": 1181570, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/2ff16cb8b68afeab5160d32abddb753e?s=128&d=identicon&r=PG", "display_name": "sarink", "link": "https://stackoverflow.com/users/1181570/sarink"}, "is_accepted": false, "score": 2, "last_activity_date": 1552780530, "creation_date": 1552780530, "answer_id": 55202645, "question_id": 51824689, "link": "https://stackoverflow.com/questions/51824689/rails-could-not-find-concurrent-ruby-1-0-5-in-any-of-the-sources-bundlergemn/55202645#55202645", "title": "Rails: Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)", "body": "<p>tl;dr: Set <code>GEM_HOME</code> = <code>BUNDLE_PATH</code></p>\n\n<p>Since you're using docker, I also assume you are maybe changing the value of <code>BUNDLE_PATH</code> so you can cache the gems? If so, you'll also want to set the <code>GEM_HOME</code> variable to this value.</p>\n\n<p>I can't exactly explain why. My theory is that.. something.. is incorrectly using the value of <code>GEM_HOME</code> when it should be using <code>BUNDLE_PATH</code>, and thus the gems you installed from your rails project's <code>Gemfile</code> are not there.</p>\n"}, {"tags": [], "owner": {"reputation": 2404, "user_id": 215708, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2b6dacb6c6033af811291e36a81f526a?s=128&d=identicon&r=PG", "display_name": "jacklin", "link": "https://stackoverflow.com/users/215708/jacklin"}, "is_accepted": false, "score": 0, "last_activity_date": 1607729302, "creation_date": 1607729302, "answer_id": 65259999, "question_id": 51824689, "link": "https://stackoverflow.com/questions/51824689/rails-could-not-find-concurrent-ruby-1-0-5-in-any-of-the-sources-bundlergemn/65259999#65259999", "title": "Rails: Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)", "body": "<p>It's common to cache your bundle with docker.  If you're doing that, and you updated some gems you'll bump into this problem.</p>\n<p>Delete volume and docker-compose up again.</p>\n<pre><code>docker volume ls\n</code></pre>\n<p>Then:</p>\n<pre><code>docker volume rm &lt;vol name&gt;\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 10072626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd10aebaa9d8600e89854a420e430f7?s=128&d=identicon&r=PG&f=1", "display_name": "user19230", "link": "https://stackoverflow.com/users/10072626/user19230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12122, "favorite_count": 2, "answer_count": 5, "score": 12, "last_activity_date": 1607729302, "creation_date": 1534170521, "last_edit_date": 1585650131, "question_id": 51824689, "link": "https://stackoverflow.com/questions/51824689/rails-could-not-find-concurrent-ruby-1-0-5-in-any-of-the-sources-bundlergemn", "title": "Rails: Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)", "body": "<p>I've Googled this quite a bit, and haven't found anything useful to my situation.</p>\n\n<p><code>$ docker-compose up abc</code></p>\n\n<p>produces the following in the logs:</p>\n\n<pre><code>/usr/lib/ruby/vendor_ruby/bundler/spec_set.rb:92:in `block in materialize': Could not find concurrent-ruby-1.0.5 in any of the sources (Bundler::GemNotFound)\n   from /usr/lib/ruby/vendor_ruby/bundler/spec_set.rb:85:in `map!'\n   from /usr/lib/ruby/vendor_ruby/bundler/spec_set.rb:85:in `materialize'\n   from /usr/lib/ruby/vendor_ruby/bundler/definition.rb:132:in `specs'\n   from /usr/lib/ruby/vendor_ruby/bundler/definition.rb:177:in `specs_for'\n   from /usr/lib/ruby/vendor_ruby/bundler/definition.rb:166:in `requested_specs'\n   from /usr/lib/ruby/vendor_ruby/bundler/environment.rb:18:in `requested_specs'\n   from /usr/lib/ruby/vendor_ruby/bundler/runtime.rb:13:in `setup'\n   from /usr/lib/ruby/vendor_ruby/bundler.rb:121:in `setup'\n   from /usr/lib/ruby/vendor_ruby/bundler/setup.rb:17:in `&lt;top (required)&gt;'\n   from /usr/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n   from /usr/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n</code></pre>\n\n<p>The relevant bit from my docker-compose.yml file:\n<code>command: bundle exec rails server</code></p>\n\n<p>concurrent-ruby is most definitely installed, exactly where it needs to be. I've run <code>bundle install</code> inside Docker so many times, and I've tried adding <code>gem install concurrent-ruby -v 1.0.5</code> to my docker-compose command, and it installs just fine, and then still complains that it can't find the gem. I tried adding <code>bundle install</code> directly to my docker-compose command, and that fails because of some known issue involving docker-compose and git (I'm using two internal gems). [ EDIT: <a href=\"https://github.com/docker/compose/issues/2856#issuecomment-236625662\" rel=\"noreferrer\">https://github.com/docker/compose/issues/2856#issuecomment-236625662</a> ]</p>\n\n<p>Everything worked fine until I upgraded some Ruby gems, but I'm not sure why or how to fix it.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1534173120, "post_id": 51824856, "comment_id": 90605147, "body": "This is wrong, and both other answers prove that in the context of the class <code>act_id</code> is perfectly visible."}], "tags": [], "owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1534171029, "creation_date": 1534171029, "answer_id": 51824856, "question_id": 51824516, "link": "https://stackoverflow.com/questions/51824516/ruby-variable-from-outer-scope-undefined-within-a-block-why/51824856#51824856", "title": "Ruby variable from outer scope undefined within a block - why?", "body": "<p>The problem here is that the block passed to <code>Class.new</code> is executed in the context of that class. In the context of that class, <code>act_id</code> is not defined. So, to fix this, you can move the method definition outside of the class initialization, like so:</p>\n\n<pre><code>(1..MAX_ACT).each do |act_id|\n  klass = Class.new(ActB)\n  klass.define_method(:initialize) do |trg|\n    super(trg, act_id)\n  end\n  Object.const_set(\"Act#{act_id}\", klass)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 4, "last_activity_date": 1534171044, "creation_date": 1534171044, "answer_id": 51824860, "question_id": 51824516, "link": "https://stackoverflow.com/questions/51824516/ruby-variable-from-outer-scope-undefined-within-a-block-why/51824860#51824860", "title": "Ruby variable from outer scope undefined within a block - why?", "body": "<p><code>def</code> (and <code>class</code> and <code>module</code>) creates a fresh local scope, which doesn't inherit any locals from outside.</p>\n\n<p>So you're right that the <code>Class.new do .. end</code> creates a closure... but the inner <code>def</code> doesn't share it.</p>\n\n<p>If you need standard block behaviour, you can use <code>define_method</code> instead:</p>\n\n<pre><code>(1..MAX_ACT).each do |act_id|\n  klass = Class.new(ActB) do\n    define_method :initialize do |trg|\n      super(trg, act_id)\n    end\n  end\n  Object.const_set(\"Act#{act_id}\", klass)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1534172787, "creation_date": 1534172787, "answer_id": 51825369, "question_id": 51824516, "link": "https://stackoverflow.com/questions/51824516/ruby-variable-from-outer-scope-undefined-within-a-block-why/51825369#51825369", "title": "Ruby variable from outer scope undefined within a block - why?", "body": "<p>Just out of curiosity, there is a hack, allowing to fool scoping and still use <code>def initialize</code> :)</p>\n\n<pre><code>class ActB\n  def initialize(trg, act_id)\n    puts \"ActID: #{act_id}\"\n  end \nend\n(1..MAX_ACT).each do |act_id|\n  klass = Class.new(ActB) do\n    @act_id = act_id\n    def initialize(trg)\n      super(trg, self.class.instance_variable_get(:@act_id))\n    end \n  end \n  Object.const_set(\"Act#{act_id}\", klass)\nend\n\nAct1.new :foo\n#\u21d2\u00a0ActID: 1\nAct2.new :foo\n#\u21d2\u00a0ActID: 2\n</code></pre>\n"}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1534172787, "creation_date": 1534169941, "question_id": 51824516, "link": "https://stackoverflow.com/questions/51824516/ruby-variable-from-outer-scope-undefined-within-a-block-why", "title": "Ruby variable from outer scope undefined within a block - why?", "body": "<p>This part of code dynamically creates several classes:</p>\n\n<pre><code>(1..MAX_ACT).each do |act_id|\n  klass = Class.new(ActB) do\n    def initialize(trg)\n      super(trg, act_id)\n    end\n  end\n  Object.const_set(\"Act#{act_id}\", klass)\nend\n</code></pre>\n\n<p>In this case, the common base class (<code>ActB</code>) has a constructor with two parameters, while the child classes have a constructor with one parameter.</p>\n\n<p>Running this code works well, but when I later try to instantiate one of these classes, for example</p>\n\n<pre><code>Act3.new(4)\n</code></pre>\n\n<p>I get the error message</p>\n\n<pre><code>NameError: undefined local variable or method `act_id' for #&lt;Act3:0x00000006008b7990&gt;\n</code></pre>\n\n<p>The error message must refer to the line  </p>\n\n<pre><code>super(trg, act_id)\n</code></pre>\n\n<p>because this is the only place in my program where I am <strong>using</strong> this variable. However, this variable is defined a few lines above, when it says</p>\n\n<pre><code>(1..MAX_ACT).each do |act_id|\n</code></pre>\n\n<p>I had expected, that the <em>do...end</em> block creates a closure for the constructor, where <em>act_id</em> is bound. However, this doesn't seem to be the case.</p>\n\n<p>Why does my example not work? How do I have to do it correctly?</p>\n"}, {"tags": ["css", "ruby", "jekyll", "liquid", "github-pages"], "comments": [{"owner": {"reputation": 19724, "user_id": 1165509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebdffd5ddb4a98b0cc77117503d2711?s=128&d=identicon&r=PG", "display_name": "marcanuy", "link": "https://stackoverflow.com/users/1165509/marcanuy"}, "edited": false, "score": 0, "creation_date": 1534191423, "post_id": 51824137, "comment_id": 90614241, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51776730/excluding-a-spook-pages-from-marquee-line-made-from-jekyll-list-of-page\">Excluding a &quot;spook&quot; pages from &lt;marquee&gt; line made from Jekyll list of page</a>"}, {"owner": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "edited": false, "score": 0, "creation_date": 1534577620, "post_id": 51824137, "comment_id": 90763170, "body": "Try moving your <code>css&#47;</code> folder with style.css into the <code>public&#47;</code> folder."}], "answers": [{"tags": [], "owner": {"reputation": 1895, "user_id": 5477561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8da372e79dbb466c65a7f8a9b934b7?s=128&d=identicon&r=PG", "display_name": "Ross", "link": "https://stackoverflow.com/users/5477561/ross"}, "is_accepted": false, "score": 2, "last_activity_date": 1535596565, "creation_date": 1535596565, "answer_id": 52088478, "question_id": 51824137, "link": "https://stackoverflow.com/questions/51824137/how-to-stop-style-css-to-be-considered-as-the-jekyll-page/52088478#52088478", "title": "How to stop style.css to be considered as the Jekyll Page?", "body": "<p>You should use <code>site.html_pages</code> instead of <code>site.pages</code>, as it will exclude all pages that don't output with the <code>.html</code> extension (i.e. <code>style.css</code>). You'll find both listed here: </p>\n\n<p><a href=\"https://jekyllrb.com/docs/variables/#site-variables\" rel=\"nofollow noreferrer\">https://jekyllrb.com/docs/variables/#site-variables</a></p>\n"}], "owner": {"reputation": 51, "user_id": 6709673, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fQilC.png?s=128&g=1", "display_name": "Andrei Deinichenko", "link": "https://stackoverflow.com/users/6709673/andrei-deinichenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535596565, "creation_date": 1534168702, "last_edit_date": 1534169459, "question_id": 51824137, "link": "https://stackoverflow.com/questions/51824137/how-to-stop-style-css-to-be-considered-as-the-jekyll-page", "title": "How to stop style.css to be considered as the Jekyll Page?", "body": "<p>I am using expression </p>\n\n<pre><code>{% assign mypages = site.pages | sort: \"order\" %} {% for page in \nmypages %}\n{% unless page.exclude %}\n\n&lt;a href=\"{{page.url|absolute_url}}\"&gt; {{ page.shortname }} &lt;span \nclass=\"rate\"&gt;{% include indexmod.html %}&lt;/a&gt;&lt;/span&gt; &lt;span class=\"rex\"&gt; \n| &lt;/span&gt;\n{% endunless %}\n{% endfor %}\n</code></pre>\n\n<p>for layout, and see unwanted style.css considered as a Jekyll Page</p>\n\n<p>I have try different tricks from <a href=\"https://github.com/jekyll/jekyll/issues/3151\" rel=\"nofollow noreferrer\">GitHub discussion \"/css/main.css considered as a Jekyll:Page? #3151\"</a>, but it does not help. Sometimes I cutting away all styles.</p>\n\n<p>Please, clear how to let the styles to work properly, but exclude it from generating as link to a Jekyll Page.</p>\n"}, {"tags": ["ruby", "matrix"], "comments": [{"owner": {"reputation": 91141, "user_id": 142637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9SiZh.png?s=128&g=1", "display_name": "sloth", "link": "https://stackoverflow.com/users/142637/sloth"}, "edited": false, "score": 0, "creation_date": 1534170269, "post_id": 51824079, "comment_id": 90603293, "body": "The code works fine for me. Are you sure you posted the correct code? Could you post a screenshot of what you think is wrong?"}, {"owner": {"reputation": 1194, "user_id": 8390068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sbzKf.jpg?s=128&g=1", "display_name": "Micheal O&#39;Dwyer", "link": "https://stackoverflow.com/users/8390068/micheal-odwyer"}, "edited": false, "score": 0, "creation_date": 1534170477, "post_id": 51824079, "comment_id": 90603420, "body": "The code reproduces the problem for me, though. It only displays a 4X4 grid, instead of 8X8."}, {"owner": {"reputation": 1194, "user_id": 8390068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sbzKf.jpg?s=128&g=1", "display_name": "Micheal O&#39;Dwyer", "link": "https://stackoverflow.com/users/8390068/micheal-odwyer"}, "edited": false, "score": 0, "creation_date": 1534172393, "post_id": 51824079, "comment_id": 90604687, "body": "I have modified the code you gave to display a chess board. Is this how you&#39;d like the board to look? Your solution doesn&#39;t stay consistent with the original board, so you might want it to look like the old version, just with black and white tiles."}], "answers": [{"comments": [{"owner": {"reputation": 1194, "user_id": 8390068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sbzKf.jpg?s=128&g=1", "display_name": "Micheal O&#39;Dwyer", "link": "https://stackoverflow.com/users/8390068/micheal-odwyer"}, "reply_to_user": {"reputation": 21, "user_id": 5199606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada2bc741a0ce38108fc80fe27fa71d4?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Smith", "link": "https://stackoverflow.com/users/5199606/aaron-smith"}, "edited": false, "score": 0, "creation_date": 1534256799, "post_id": 51825596, "comment_id": 90640765, "body": "Glad I could help! If you found this answer helpful, or it answered your question, remember to <a href=\"https://stackoverflow.com/help/someone-answers\">vote and/or accept</a>. Thanks!"}], "tags": [], "owner": {"reputation": 1194, "user_id": 8390068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sbzKf.jpg?s=128&g=1", "display_name": "Micheal O&#39;Dwyer", "link": "https://stackoverflow.com/users/8390068/micheal-odwyer"}, "is_accepted": true, "score": 1, "last_activity_date": 1535052405, "last_edit_date": 1535052405, "creation_date": 1534173537, "answer_id": 51825596, "question_id": 51824079, "link": "https://stackoverflow.com/questions/51824079/how-to-create-10-by-10-grid/51825596#51825596", "title": "How to create 10 by 10 grid", "body": "<p>The main problem with the original code is that all of the tiles are being displayed as white. I believe the reason there are black borders in the original example is, because of the how the co-ordinates worked out. Many of the co-ordinates end in <code>.5</code>, which are rounded by pygame. So, as a result, your program creates an 8X8 grid, but doesn't display them correctly, and borders are only seen after every 2 tiles.</p>\n"}], "owner": {"reputation": 21, "user_id": 5199606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada2bc741a0ce38108fc80fe27fa71d4?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Smith", "link": "https://stackoverflow.com/users/5199606/aaron-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 51825596, "answer_count": 1, "score": 1, "last_activity_date": 1535100774, "creation_date": 1534168549, "last_edit_date": 1535100774, "question_id": 51824079, "link": "https://stackoverflow.com/questions/51824079/how-to-create-10-by-10-grid", "title": "How to create 10 by 10 grid", "body": "<p>I have created this program which currently creates a grid of x rows and y columns, however always displays a 4X4 grid, even if you enter 10 rows 10 columns. How would you create a 10 by 10 grid?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1534171876, "post_id": 51823846, "comment_id": 90604349, "body": "You <i>could</i> create such method via <code>define_method(&#39;51_bic&#39;) { ... }</code> but it also has to be invoked via <code>public_send(&#39;51_bic&#39;)</code>. It might therefore be more convenient to add a non-numeric prefix, e.g. <code>index_51_bic</code>"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1534172257, "post_id": 51823891, "comment_id": 90604596, "body": "Well, technically one might start method names with a digit, if the name is explicitly converted to a <code>Symbol</code>: <code>define_method :&quot;51_bic&quot; do  puts __callee__ end</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1534173932, "post_id": 51823891, "comment_id": 90605623, "body": "@mudasobwa: I carefully avoided using words &quot;method name&quot; in this answer. :)"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1534208999, "post_id": 51823891, "comment_id": 90618850, "body": "@mudasobwa I don&#39;t think you need to make it a symbol. Just <code>define_method &quot;51_bic&quot; do ... end</code> is fine."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1534168408, "last_edit_date": 1534168408, "creation_date": 1534168003, "answer_id": 51823891, "question_id": 51823846, "link": "https://stackoverflow.com/questions/51823846/ruby-and-integer-in-method-name/51823891#51823891", "title": "Ruby and integer in method name", "body": "<p>Identifiers can have numbers in them, but can't <strong>start</strong> with a number. This is how it is in most programming languages (that I heard of). </p>\n\n<blockquote>\n  <p>What's the nature of the problem that I can't use integer + underscore + string?</p>\n</blockquote>\n\n<p>Because if you allow identifiers to start with a number, you must then mandate that they contain a letter after (to differentiate them from numbers). Now, food for thought. Imagine you <em>can</em> start identifiers with numbers. Which of these are method calls, local variables and which are number literals?</p>\n\n<pre><code>0xa0 + 0b10_100 + 3_456\n</code></pre>\n"}], "owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 51823891, "answer_count": 1, "score": 2, "last_activity_date": 1534208722, "creation_date": 1534167853, "last_edit_date": 1534208722, "question_id": 51823846, "link": "https://stackoverflow.com/questions/51823846/ruby-and-integer-in-method-name", "title": "Ruby and integer in method name", "body": "<p>I have to name methods based on the index number of some external documentation:</p>\n\n<pre><code>def 51_bic\nend\n</code></pre>\n\n<p>This is wrong, as shown by the color with the syntax highlighting. And also the code fails with <code>trailing `_' in number (SyntaxError)</code>.</p>\n\n<p>Using <code>bic_51</code> works just fine. But why is that? What's the nature of the fact that I can't use <code>integer + underscore + string</code>? My understanding is that everything after a <code>def</code> is just a method name as a string.</p>\n"}, {"tags": ["ruby", "group-by"], "comments": [{"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 1, "creation_date": 1534168615, "post_id": 51823800, "comment_id": 90602206, "body": "For code style, I&#39;d recommend using <code>group_by</code> with a block over redefining <code>==</code>, but this is an interesting problem anyways."}, {"owner": {"reputation": 314, "user_id": 2622603, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa2d653dd41f57398314b80cfcb6771c?s=128&d=identicon&r=PG", "display_name": "Eneroth3", "link": "https://stackoverflow.com/users/2622603/eneroth3"}, "reply_to_user": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1534169245, "post_id": 51823800, "comment_id": 90602605, "body": "I&#39;m using the SketchUp Ruby API that already implements == or points, lengths and other classes.  Also I&#39;m not sure how a block could be used for this. The block has no access to the already defined groups or previous elements to compare against. For trivial cases like floats you could of course round to 3 decimals or so, but what about other classes?"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1534169501, "post_id": 51823800, "comment_id": 90602767, "body": "I hope my answer helps you out here, TL;DR under the hood it&#39;s creating a hash, and the output of the block becomes the key to the hash."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1534169971, "post_id": 51823800, "comment_id": 90603069, "body": "If the sketchup API implements a <code>to_h</code> method or some way of converting element to and from a hash, you could <code>group_by(&amp;:to_h)</code>."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1534171719, "post_id": 51823800, "comment_id": 90604247, "body": "In general, include <a href=\"https://ruby-doc.org/core-2.4.0/Comparable.html\" rel=\"nofollow noreferrer\">Comparable</a>  in your class and (re)define <code>&lt;=&gt;</code>"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1534171887, "post_id": 51823800, "comment_id": 90604366, "body": "In this case, not all is clear. if 1.0 == 1.00001 == 1.00002 == 1.00003 then 1.0 == any number"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 2, "creation_date": 1534173105, "post_id": 51823800, "comment_id": 90605139, "body": "@steenslag Here the question is about hash comparison, which uses <code>eql?</code> which <code>Comparable</code> does not touch (AFAIK). So including <code>Comparable</code> would not help here."}], "answers": [{"comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 1, "creation_date": 1534170719, "post_id": 51824363, "comment_id": 90603574, "body": "<code>group_by</code> uses <code>hash</code> + <code>eql?</code>"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1534171086, "post_id": 51824363, "comment_id": 90603811, "body": "Thank you @pascalbetz! I didn&#39;t know that."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 1, "creation_date": 1534171440, "post_id": 51824363, "comment_id": 90604068, "body": "had to look it up as well... the various ways ruby does comparison are confusing :-)"}], "tags": [], "owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "is_accepted": false, "score": 3, "last_activity_date": 1534169441, "creation_date": 1534169441, "answer_id": 51824363, "question_id": 51823800, "link": "https://stackoverflow.com/questions/51823800/ruby-comparison-used-by-group-by/51824363#51824363", "title": "Ruby comparison used by &#39;group_by&#39;", "body": "<p>TL;DR It appears to me that this issue is because group_by doesn't actually check equality anywhere. It generates the hash, and uses the elements of the array as keys.</p>\n\n<p>Long story:</p>\n\n<p>My first guess here was that it was doing something like <code>my_arr.map(&amp;:value).group_by { |i| i }</code>, which would mean that it would be checking the equality of 2 floats instead of 2 MyClasses. To test this, I redefined <code>==</code> on a float, and added debugging puts statements to both of our definitions of <code>==</code>. Interestingly, nothing was printed. So, I went on over to <a href=\"https://ruby-doc.org/core-2.2.2/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">the documentation for <code>group_by</code></a>, and looked at the source code:</p>\n\n<pre><code>               static VALUE\nenum_group_by(VALUE obj)\n{\n    VALUE hash;\n\n    RETURN_SIZED_ENUMERATOR(obj, 0, 0, enum_size);\n\n    hash = rb_hash_new();\n    rb_block_call(obj, id_each, 0, 0, group_by_i, hash);\n    OBJ_INFECT(hash, obj);\n\n    return hash;\n}\n</code></pre>\n\n<p>Notice the last argument to <code>rb_block_call</code> -- It's a hash. This hinted to me that under the hood, ruby is doing this:</p>\n\n<pre><code>def group_by(&amp;:block)\n  h = {}\n  self.each do |ele|\n    key = block_given? ? block.call(ele) : ele\n    h[key] ||= []\n    h[key].push(ele)\n  end\nend\n</code></pre>\n\n<p>When getting a key from a hash, it seems that <code>==</code> is not called, and so this attempt to redefine <code>==</code> didn't do what you wanted. A way to fix this would be like so:</p>\n\n<pre><code>[MyClass.new(1.0), MyClass.new(1.00001)].group_by { |i| i.value.round(2) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1534171384, "last_edit_date": 1534171384, "creation_date": 1534170681, "answer_id": 51824741, "question_id": 51823800, "link": "https://stackoverflow.com/questions/51823800/ruby-comparison-used-by-group-by/51824741#51824741", "title": "Ruby comparison used by &#39;group_by&#39;", "body": "<p>Group By uses <code>hash</code> and <code>eql?</code> to determine if a key inside the <code>Hash</code> is the same. So something like this should work:</p>\n\n<pre><code>class MyClass\n\n\n attr_accessor :value\n\n  def initialize(value)\n    @value = value\n  end\n\n  def ==(other)\n    (@value - other.value).abs &lt; 0.0001\n  end\n\n  def hash\n    rounded_value.hash\n  end\n\n  def eql?(other)\n    self == other\n  end\n\n  def rounded_value\n    @value.round(3)\n  end\nend\n</code></pre>\n\n<p>Please check if this gives you the required precission when marking keys as equal. Otherwise adapt the <code>rounded_value</code> method.</p>\n\n<p>Here is a good summary of the equals operators/methods in ruby: <a href=\"https://stackoverflow.com/questions/7156955/whats-the-difference-between-equal-eql-and\">What&#39;s the difference between equal?, eql?, ===, and ==?</a></p>\n"}], "owner": {"reputation": 314, "user_id": 2622603, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa2d653dd41f57398314b80cfcb6771c?s=128&d=identicon&r=PG", "display_name": "Eneroth3", "link": "https://stackoverflow.com/users/2622603/eneroth3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1534209581, "creation_date": 1534167735, "last_edit_date": 1534209419, "question_id": 51823800, "link": "https://stackoverflow.com/questions/51823800/ruby-comparison-used-by-group-by", "title": "Ruby comparison used by &#39;group_by&#39;", "body": "<p>I want to group objects that are virtually the same but not identical like in this case:</p>\n\n<pre><code>class MyClass\n  attr_accessor :value\n\n  def initialize(value)\n    @value = value\n  end\n\n  def ==(other)\n    (@value - other.value).abs &lt; 0.0001\n  end\nend\n</code></pre>\n\n<p>With the precision relevant for my implementation, two values differing by 0.0001 can be regarded identical:</p>\n\n<pre><code>MyClass.new(1.0) == MyClass.new(1.00001)\n# =&gt; true\n</code></pre>\n\n<p>I want these to be in the same group:</p>\n\n<pre><code>[MyClass.new(1.0), MyClass.new(1.00001)].group_by(&amp;:value)\n# =&gt; {1.0=&gt;[#&lt;MyClass:0x0000000d1183e0 @value=1.0&gt;], 1.00001=&gt;[#&lt;MyClass:0x0000000d118390 @value=1.00001&gt;]}\n</code></pre>\n\n<p>What comparison is used for <code>group_by</code>? Can the built in <code>group_by</code> be made to honor the custom <code>==</code> method, or is a custom <code>group_by</code> method required for this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1534164055, "post_id": 51822564, "comment_id": 90599115, "body": "<code>&quot;#{fileNameFromUser}&quot;</code> is same as <code>fileNameFromUser.clone</code>, but the latter is easier to read. But I see no need in your code for cloning, since the strings are not being mutated; so <code>fileNameFromUser</code> should suffice, no?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1534165844, "post_id": 51822564, "comment_id": 90600370, "body": "If the file contains <code>12</code> initially and the replacements are <code>1 =&gt; 2</code> and <code>2 =&gt; 3</code>, should the final result be <code>23</code> or <code>33</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 696257, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/oN4Zu.png?s=128&g=1", "display_name": "dkulkarni", "link": "https://stackoverflow.com/users/696257/dkulkarni"}, "is_accepted": false, "score": 1, "last_activity_date": 1534164146, "creation_date": 1534164146, "answer_id": 51822658, "question_id": 51822564, "link": "https://stackoverflow.com/questions/51822564/having-issues-searching-through-file-and-replacing/51822658#51822658", "title": "Having issues searching through file and replacing", "body": "<p>You will need to re-use <code>replacedcontent</code> instead of concatenating it to avoid printing it twice.</p>\n\n<pre><code>file_names = [\"#{fileNameFromUser}\"]\n\nfile_names.each do |file_name|\ntext = File.read(file_name)\nreplacedcontent = text.gsub(/textToReplace/, \"#{ReplaceWithThis}\")\nreplacedcontent = replacedcontent.gsub(/textToReplace2/, \"#{ReplaceWithThis2}\")\n\n# To write changes to the file, use:\nFile.open(file_name, \"w\") {|file| file.puts replacedcontent}\nend\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>replacedcontent = text.gsub(/textToReplace/, \"#{ReplaceWithThis}\").gsub(/textToReplace2/, \"#{ReplaceWithThis2}\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1534164231, "creation_date": 1534164231, "answer_id": 51822683, "question_id": 51822564, "link": "https://stackoverflow.com/questions/51822564/having-issues-searching-through-file-and-replacing/51822683#51822683", "title": "Having issues searching through file and replacing", "body": "<blockquote>\n  <p>it print the contents of the file twice and I can only assume its because its inside the <code>do</code> loop</p>\n</blockquote>\n\n<p>Nope, it's because you append it twice:</p>\n\n<pre><code>text = first_replacement_result\ntext += second_replacement_result\n</code></pre>\n\n<p>There's two ways to do this: one with mutation:</p>\n\n<pre><code>text.gsub!(...) # first replacement that changes `text`\ntext.gsub!(...) # second replacement that changes `text` again\n</code></pre>\n\n<p>or chained replacement:</p>\n\n<pre><code>replacedcontent = text.gsub(...).gsub(...) # two replacements one after another        \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9318799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba23394d14dca1f7732ba1d7643e1605?s=128&d=identicon&r=PG&f=1", "display_name": "Manik", "link": "https://stackoverflow.com/users/9318799/manik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534165074, "creation_date": 1534163867, "last_edit_date": 1534165074, "question_id": 51822564, "link": "https://stackoverflow.com/questions/51822564/having-issues-searching-through-file-and-replacing", "title": "Having issues searching through file and replacing", "body": "<p>I'm having a bit of trouble searching through a file and editing certain parameters of the file. The code is below</p>\n\n<pre><code>file_names = [\"#{fileNameFromUser}\"]\n\nfile_names.each do |file_name|\n text = File.read(file_name)\n replacedcontent = text.gsub(/textToReplace/, \"#{ReplaceWithThis}\")\n replacedcontent += text.gsub(/textToReplace2/, \"#{ReplaceWithThis2}\")\n\n# To write changes to the file, use:\nFile.open(file_name, \"w\") {|file| file.puts replacedcontent}\nend\n</code></pre>\n\n<p>so right now what it does is that it print the contents of the file twice and I can only assume its because its inside the <code>do</code> loop. My end goal here is that the file has <code>textToReplace</code> and <code>textToReplace2</code> and I need it to read through the file, replaced both with whatever the user inputs and save/write changes to the file.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara", "ui-automation"], "answers": [{"comments": [{"owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "edited": false, "score": 0, "creation_date": 1534169230, "post_id": 51822522, "comment_id": 90602598, "body": "Removed browser.helperApps.neverAsk.openFile - But no luck. It still shows the window."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "edited": false, "score": 0, "creation_date": 1534180160, "post_id": 51822522, "comment_id": 90609022, "body": "@AnandChavan Did you try with the latest firefox instead of the 2 year old version (and using marionette rather than the old FirefoxDriver)?  Did you try narrowing your profile settings down to the minimum used by Capybaras tests to see if any of the others you&#39;re setting are causing the issue?  Did you try monitoring the traffic (browser console network tab, etc) to make sure the mime type returned is actually what you think it is?"}, {"owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "edited": false, "score": 0, "creation_date": 1535126039, "post_id": 51822522, "comment_id": 90966261, "body": "I don&#39;t have option to upgrade firefox as our VM&#39;s are using RHEL7, which is supports FF52 as uppermost version of FF inbuilt."}, {"owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "edited": false, "score": 0, "creation_date": 1535126081, "post_id": 51822522, "comment_id": 90966283, "body": "MIME Types I have checked manually and are as per mentioned in the code."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "edited": false, "score": 0, "creation_date": 1535139916, "post_id": 51822522, "comment_id": 90972504, "body": "@AnandChavan If you can&#39;t update the version of firefox you may just be out of luck -- it&#39;s possible that version is just broken.  Note that just because you can&#39;t update firefox using yum doesn&#39;t mean you can&#39;t manually install the latest version of firefox - <a href=\"https://tecadmin.net/install-firefox-on-linux/\" rel=\"nofollow noreferrer\">tecadmin.net/install-firefox-on-linux</a>"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1534163698, "creation_date": 1534163698, "answer_id": 51822522, "question_id": 51822100, "link": "https://stackoverflow.com/questions/51822100/save-file-popup-issue/51822522#51822522", "title": "Save File popup issue", "body": "<p>Why are you setting both 'browser.helperApps.neverAsk.openFile' and ''browser.helperApps.neverAsk.saveToDisk' to the same mime types? Those are conflicting settings since one is saying to open those file types in the browser and the other is saying to save them to disk (open in browser takes precedence).  Also - Firefox 52 was released 2 years ago, may be time to upgrade.</p>\n\n<p>Downloading of files is tested in Capybaras own test suite so you can see the minimal settings required there (obviously adjust mime types as needed) - <a href=\"https://github.com/teamcapybara/capybara/blob/master/spec/selenium_spec_marionette.rb#L13\" rel=\"nofollow noreferrer\">https://github.com/teamcapybara/capybara/blob/master/spec/selenium_spec_marionette.rb#L13</a></p>\n"}], "owner": {"reputation": 4248, "user_id": 1036242, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8602754aee7371a7cddb975d549a50d9?s=128&d=identicon&r=PG", "display_name": "Anand Chavan", "link": "https://stackoverflow.com/users/1036242/anand-chavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534163698, "creation_date": 1534162324, "question_id": 51822100, "link": "https://stackoverflow.com/questions/51822100/save-file-popup-issue", "title": "Save File popup issue", "body": "<p><strong>Issue</strong> </p>\n\n<p>I have tried all possibilities by setting profile variables, however the Save dialog in firefox is still appearing every time I try to download a file using my automation framework</p>\n\n<p>Content Type of file which is am trying to download is application/csv (for 1 file, rest are mentioned in below code snipit)</p>\n\n<p><strong>Setup -</strong></p>\n\n<p><strong>Firefox Version -</strong>\n52.8.0 (64 Bit)</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'actionpack', '~&gt; 4.2.4', require: false\ngem 'activemodel', '~&gt; 4.2.4'\ngem 'Ascii85'\ngem 'browserstack-local'\ngem 'cucumber', '&lt; 2.0.0'\ngem 'cukeforker'\ngem 'cukeforker-webdriver'\ngem 'headless'\ngem 'httparty'\ngem 'json'\ngem 'mysql2'\ngem 'nokogiri'\ngem 'pdf-reader'\ngem 'pry'\ngem 'rubocop', '~&gt; 0.52.1', require: false\ngem 'selenium-webdriver', '3.6.0' # Best practice: keep in sync with hub version\ngem 'site_prism'\ngem 'uuid'\n</code></pre>\n\n<p><strong>env.rb</strong></p>\n\n<pre><code>Before do\n\n  firefox_profile = Selenium::WebDriver::Firefox::Profile.new\n  firefox_profile['browser.download.dir'] = ENV['ENV_TEMP_PATH']\n  firefox_profile['browser.download.folderList'] = 2\n\n  firefox_profile['browser.download.panel.shown'] = false\n  firefox_profile['browser.helperApps.alwaysAsk.force'] = false\n  firefox_profile['browser.download.manager.showWhenStarting'] = false\n  firefox_profile['browser.helperApps.neverAsk.openFile'] = 'application/csv, application/octet-stream, text/csv, application/zip, application/pdf, application/xml, application/x-x509-ca-cert'\n  firefox_profile['browser.helperApps.neverAsk.saveToDisk'] = 'application/csv, application/octet-stream, text/csv, application/zip, application/pdf, application/xml, application/x-x509-ca-cert'\n  firefox_profile['timeout'] = 480000\n  firefox_profile['pdfjs.disabled'] = true\n  firefox_profile['resynchronization_timeout'] = 90\n  firefox_profile['resynchronize '] = true\n  firefox_profile['dom.max_chrome_script_run_time'] = 0\n  firefox_profile['dom.max_script_run_time'] = 0\n\n\n  Capybara.default_selector = :css\n  Capybara.ignore_hidden_elements = true\n  Capybara.run_server = false\n  client = Selenium::WebDriver::Remote::Http::Default.new\n  client.timeout = 240\n\n    Capybara.default_driver = :firefox\n\n    Capybara.register_driver :firefox do |app|\n      Capybara::Selenium::Driver.new(app, browser: :firefox, profile: firefox_profile, marionette: false, http_client: client)\n    end\n\nend\n</code></pre>\n\n<p><strong>Please note -</strong></p>\n\n<p>I have tried following as well</p>\n\n<pre><code>firefox_profile['browser.helperApps.neverAsk.openFile'] = 'application/csv; application/octet-stream; text/csv; application/zip; application/pdf; application/xml; application/x-x509-ca-cert'\nfirefox_profile['browser.helperApps.neverAsk.saveToDisk'] = 'application/csv; application/octet-stream; text/csv; application/zip; application/pdf; application/xml; application/x-x509-ca-cert'\n</code></pre>\n\n<p>Looking for help from experts in our automation active community </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1534161809, "post_id": 51821376, "comment_id": 90597643, "body": "Why do you need to <code>include Esty</code>? I just skimmed the gem&#39;s README; that module appears to be used as a namespace, not as something to be <code>include</code>d into the class. In addition, all of your code (above) would work perfectly well without the module inclusion."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1534161848, "post_id": 51821376, "comment_id": 90597667, "body": "For example, you don&#39;t need to <code>include Esty</code> in order to call methods on the module, like <code>Etsy.myself</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1534162114, "post_id": 51821376, "comment_id": 90597825, "body": "To answer your question directly, you can use <code>::Listing</code> instead of <code>Listing</code>, to indicate that the &quot;top level&quot; <code>Listing</code> class should be used. However, as I said, I think the module inclusion is unnecessary in the first place."}, {"owner": {"reputation": 182, "user_id": 6848493, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b004235b4697691e9bc3aab04c58baa7?s=128&d=identicon&r=PG", "display_name": "Maayan Naveh", "link": "https://stackoverflow.com/users/6848493/maayan-naveh"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534187698, "post_id": 51821376, "comment_id": 90612653, "body": "Thank you so much Tom, I&#39;m very new to rails and didn&#39;t realize I didn&#39;t need to include it in order to use it :) Works perfectly! If you&#39;d like to write it as an answer instead of a reply, I&#39;d be happy to accept it :)"}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 6848493, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b004235b4697691e9bc3aab04c58baa7?s=128&d=identicon&r=PG", "display_name": "Maayan Naveh", "link": "https://stackoverflow.com/users/6848493/maayan-naveh"}, "edited": false, "score": 0, "creation_date": 1534241535, "post_id": 51829953, "comment_id": 90630945, "body": "Thanks again, I really appreciate all your help! :)"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1534191447, "creation_date": 1534191447, "answer_id": 51829953, "question_id": 51821376, "link": "https://stackoverflow.com/questions/51821376/differentiating-between-gem-module-and-ar-model/51829953#51829953", "title": "Differentiating between gem module and AR model", "body": "<p>The short answer to your problem is simply not to <code>include Esty</code>:</p>\n\n<pre><code>class ListingWorker\n  include Sidekiq::Worker\n\n  def perform(seller, shop)\n    # ...\n  end\nend\n</code></pre>\n\n<p>The purpose of <code>include</code> is to add methods defined with the module into your class.</p>\n\n<p>For example, if I defined a module:</p>\n\n<pre><code>module Tom\n  def hello\n    puts \"Hello!\"\n  end\nend\n</code></pre>\n\n<p>And you wanted to call <code>hello</code> directly within your <code>ListingWorker</code> class, <strong>then</strong> you'd need to <code>include Tom</code>.</p>\n\n<p>On the other hand, suppose I just define a \"namespaced\" method within a module, such as:</p>\n\n<pre><code>module Maayan\n  def self.example\n    puts \"Example\"\n  end\nend\n</code></pre>\n\n<p>Then, this should be invoked by referencing the module - i.e. <code>Maayan.example</code>.</p>\n\n<p>You can do this from anywhere (provided the file containing this code is loaded); you don't need to <code>include</code> anything.</p>\n\n<p>And that's what you're doing here -- in order to run code such as <code>Etsy.myself</code> or <code>Etsy::Request.get</code>, you don't need to <code>include</code> the module. You're calling methods on the module directly, not mixing the module's methods into your own class.</p>\n\n<hr>\n\n<p>However, if you <em>did</em> find yourself in such a situation, where you have a nested class which conflicts with the top-level definition, note that ruby lets you explicitly access the globally scoped class by prepending <code>::</code> to the class name.</p>\n\n<p>In other words, you can use <code>::Listing</code> to explicitly reference your own class.</p>\n"}], "owner": {"reputation": 182, "user_id": 6848493, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b004235b4697691e9bc3aab04c58baa7?s=128&d=identicon&r=PG", "display_name": "Maayan Naveh", "link": "https://stackoverflow.com/users/6848493/maayan-naveh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 51829953, "answer_count": 1, "score": 0, "last_activity_date": 1534191447, "creation_date": 1534159921, "question_id": 51821376, "link": "https://stackoverflow.com/questions/51821376/differentiating-between-gem-module-and-ar-model", "title": "Differentiating between gem module and AR model", "body": "<p>I'm using the Etsy gem, which as a <code>Listing</code> module.\nI also have a corresponding <code>Listing</code> model in my app.</p>\n\n<p>I'm trying to set up a sidekiq worker to work with the gem, call upon some methods and update the corresponding <code>Listing</code> row, but because I have <code>include Etsy</code> so that I can use the gem, rails gets confused and thinks I'm referring to the module instead of the model.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>class ListingWorker\n  include Sidekiq::Worker\n  include Etsy\n\n  def perform(seller, shop)\n    access_token = {access_token: seller.oauth_token,\n              access_secret: seller.request_secret}\n    myself = Etsy.myself(access_token[:access_token], access_token[:access_secret])\n    limit = 100\n    offset = 0\n    total_results = myself.shop.active_listings_count\nuntil offset &gt; total_results\n  listings = Etsy::Request.get(\"/shops/#{shop.shop_id}/listings/active\",\n                               access_token.merge(limit: limit.to_s,\n                                            offset: offset.to_s,\n                                            include_private: 'true',\n                                            includes: 'Images:1:0'))\n                          .to_hash\n  offset += limit\n\n  listings['results'].each do |l|\n    listing = Listing.find_by(listing_id: l['listing_id'])\n</code></pre>\n\n<p>end\nend</p>\n\n<p>Here's the error I get: </p>\n\n<pre><code>undefined method `find_by' for Etsy::Listing:Class\n</code></pre>\n\n<p>How do I differentiate between the module and the model and make rails understand I mean a db table?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "node.js", "ruby", "amazon-web-services", "npm"], "comments": [{"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1534160003, "post_id": 51821329, "comment_id": 90596516, "body": "Text is searchable, images are not (still). Post the error message as a text, not as an image."}, {"owner": {"reputation": 1, "user_id": 10219030, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NbhOjBLhl-k/AAAAAAAAAAI/AAAAAAAAAAc/a6vwX63TxA8/photo.jpg?sz=128", "display_name": "Vishal Gosia", "link": "https://stackoverflow.com/users/10219030/vishal-gosia"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1534160380, "post_id": 51821329, "comment_id": 90596776, "body": "events.js:141       throw er; // Unhandled &#39;error&#39; event       ^  Error: EMFILE: too many open files, open &#39;/var/www/4free-backend/node_modules/material-ui/package.jso&zwnj;&#8203;n&#39;     at Error (native)"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1534161001, "post_id": 51821329, "comment_id": 90597182, "body": "That&#39;s better. You might as well post the code causing the error."}, {"owner": {"reputation": 1, "user_id": 10219030, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NbhOjBLhl-k/AAAAAAAAAAI/AAAAAAAAAAc/a6vwX63TxA8/photo.jpg?sz=128", "display_name": "Vishal Gosia", "link": "https://stackoverflow.com/users/10219030/vishal-gosia"}, "reply_to_user": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1534161248, "post_id": 51821329, "comment_id": 90597322, "body": "Yes, the code is working fine in my local system but I am getting this error on production."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 0, "creation_date": 1534161413, "post_id": 51821329, "comment_id": 90597426, "body": "I understand that, but it would be easier to have the code from the image as text as well."}], "owner": {"reputation": 1, "user_id": 10219030, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NbhOjBLhl-k/AAAAAAAAAAI/AAAAAAAAAAc/a6vwX63TxA8/photo.jpg?sz=128", "display_name": "Vishal Gosia", "link": "https://stackoverflow.com/users/10219030/vishal-gosia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534165107, "creation_date": 1534159798, "last_edit_date": 1534165107, "question_id": 51821329, "link": "https://stackoverflow.com/questions/51821329/browserifyrailsbrowserifyerror-in-pagesindex", "title": "BrowserifyRails::BrowserifyError in Pages#index", "body": "<p>I am new to Ruby on Rails. I have upload code from local to aws with nginx (passanger). Everytime I facing this error(showing in picture <a href=\"https://i.stack.imgur.com/44xF7.png\" rel=\"nofollow noreferrer\">enter image description here</a>). </p>\n\n<pre><code>Error while running `/var/www/4free-backend/node_modules/.bin/browserifyinc -t babelify --fast --list --cachefile=/var/www/4free-backend/tmp/cache/browserify-rails/browserifyinc-cache.json -o \"/var/www/4free-backend/tmp/cache/browserify-rails/output20180813-6665-tzjoay\" -`:\n\nevents.js:141\n      throw er; // Unhandled 'error' event\n      ^\n\nError: EMFILE: too many open files, open '/var/www/4free-backend/node_modules/material-ui/package.json'\n    at Error (native)\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "cucumber", "watir", "chromium"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1534206812, "post_id": 51821273, "comment_id": 90618447, "body": "instead of option do you  mean?"}], "owner": {"reputation": 855, "user_id": 3759265, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/19a877022888fb56ba9c69541a3f09db?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3759265/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534184652, "creation_date": 1534159595, "last_edit_date": 1534184652, "question_id": 51821273, "link": "https://stackoverflow.com/questions/51821273/ruby-selenium-webdriver-option-to-set-proxy-with-chrome", "title": "Ruby Selenium-Webdriver option to set proxy with Chrome", "body": "<p>Does anyone have a solution to setting a proxy in selenium-webdriver with chrome using <code>add_argument</code>?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "syntax", "jekyll", "liquid"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1534155264, "post_id": 51819762, "comment_id": 90593721, "body": "What is your question?"}, {"owner": {"reputation": 51, "user_id": 6709673, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fQilC.png?s=128&g=1", "display_name": "Andrei Deinichenko", "link": "https://stackoverflow.com/users/6709673/andrei-deinichenko"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1534155433, "post_id": 51819762, "comment_id": 90593824, "body": "I have edited question topic to: &quot;How to exclude .css .json .xml .txt from site.pages in Jekyll?&quot;"}, {"owner": {"reputation": 19724, "user_id": 1165509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebdffd5ddb4a98b0cc77117503d2711?s=128&d=identicon&r=PG", "display_name": "marcanuy", "link": "https://stackoverflow.com/users/1165509/marcanuy"}, "edited": false, "score": 0, "creation_date": 1534191189, "post_id": 51819762, "comment_id": 90614136, "body": "Try using <code>site.posts</code> instead of <code>site.pages</code>."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6709673, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fQilC.png?s=128&g=1", "display_name": "Andrei Deinichenko", "link": "https://stackoverflow.com/users/6709673/andrei-deinichenko"}, "is_accepted": true, "score": -2, "last_activity_date": 1534163116, "creation_date": 1534163116, "answer_id": 51822333, "question_id": 51819762, "link": "https://stackoverflow.com/questions/51819762/how-to-exclude-css-json-xml-txt-from-site-pages-in-jekyll/51822333#51822333", "title": "How to exclude .css .json .xml .txt from site.pages in Jekyll?", "body": "<p>I almost fixed problem by deleting these lines from _config.yml</p>\n\n<p>gems:<br>\n  - jekyll-sitemap<br>\n  - jekyll-mentions \n  - jemoji<br>\n  - jekyll-redirect-from<br>\n  - jekyll-feed</p>\n"}], "owner": {"reputation": 51, "user_id": 6709673, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fQilC.png?s=128&g=1", "display_name": "Andrei Deinichenko", "link": "https://stackoverflow.com/users/6709673/andrei-deinichenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "closed_date": 1534755122, "accepted_answer_id": 51822333, "answer_count": 1, "score": 0, "last_activity_date": 1534163116, "creation_date": 1534154439, "last_edit_date": 1534155751, "question_id": 51819762, "link": "https://stackoverflow.com/questions/51819762/how-to-exclude-css-json-xml-txt-from-site-pages-in-jekyll", "closed_reason": "Duplicate", "title": "How to exclude .css .json .xml .txt from site.pages in Jekyll?", "body": "<p>I am generate page rate \"Indexmod\" with following formula stored in include directory </p>\n\n<pre><code>{% assign number_of_words = content | strip_html | number_of_words %}\n{% assign social = page.facebook | plus: page.instagram | plus: \npage.youtube | plus: page.vimeo | plus: page.vkontakte | plus: \npage.twitter | plus: page.tumblr | plus: page.youtube %}\n{% assign age = site.time | date: \"%Y\" | minus: page.birth %}\n{% assign index = age | times: social | divided_by: 1000000.0 %}\n{% assign indexmod = index | times: number_of_words | divided_by: 100 %}\n\n{{ indexmod | round: 2 }}\n</code></pre>\n\n<p>Then I am inserting the \"Indexmod\" rate value next every page topic on main page on the site using:</p>\n\n<pre><code>{% assign mypages = site.pages | sort: \"order\" %} {% for page in \nmypages %}\n{% unless page.exclude %}\n\n&lt;a href=\"{{page.url|absolute_url | remove: \"/assets/css/style.css\" | \nremove: \"/redirects.json\" | remove: \"/sitemap.xml\" | remove: \n\"/robots.txt\" | remove: \"/feed.xml\"}}\"&gt; {{ page.shortname }} &lt;span \nclass=\"rate\"&gt;{% include indexmod.html %}&lt;/a&gt;&lt;/span&gt; &lt;span class=\"rex\"&gt; \n| &lt;/span&gt;\n{% endunless %}\n{% endfor %}\n</code></pre>\n\n<p>As result I see unwanted files with extensions .css .json .xml .txt as pages </p>\n\n<p><a href=\"https://i.stack.imgur.com/ZaryE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZaryE.png\" alt=\"Blue are page titles, green means rate. 5 last topics are unwanted .css .json .xml .txt files\"></a></p>\n\n<p>So am trying lot of tricks as put in front-mater an exclude line, but it does not work for these 5 files. </p>\n\n<p>My question How to exclude .css .json .xml .txt from site.pages. Thank in advance for your kind attention!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1534150271, "post_id": 51818060, "comment_id": 90590802, "body": "It&#39;s more efficient than writing your own conditional if that&#39;s what you&#39;re asking."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1534151745, "post_id": 51818060, "comment_id": 90591634, "body": "It basically does exactly what your own comparison is going to do: a <code>nil</code> check, but done internally, not &quot;in Ruby&quot;, which reduces the number of Ruby invocations by combining it into one. <code>nil</code> checks are cheap, it is more of just a convenience method, not for &quot;performance&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534154608, "post_id": 51818329, "comment_id": 90593339, "body": "<i>The answer is probably: quiet&quot;</i> -- That&#39;s a very unusual answer! \ud83d\ude02"}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 7, "last_activity_date": 1534161215, "last_edit_date": 1534161215, "creation_date": 1534149603, "answer_id": 51818329, "question_id": 51818060, "link": "https://stackoverflow.com/questions/51818060/how-is-the-ruby-safe-navigation-implemented/51818329#51818329", "title": "How is the Ruby safe navigation (&amp;.) implemented?", "body": "<p>The safe navigation operator was implemented following <a href=\"https://bugs.ruby-lang.org/issues/11537\" rel=\"nofollow noreferrer\">Feature #11537</a>.</p>\n\n<p>It is part of Ruby's core langiage, i.e. is implemented in the language parser, has an op code in the virtual machine. Thus, there is no single place where the operator is implemented. The first version of it was added in commit <a href=\"https://github.com/ruby/ruby/commit/a356fe1c3550892902103f66928426ac8279e072\" rel=\"nofollow noreferrer\">a356fe1c</a> but it has seen multiple extensions since then.</p>\n\n<p>As for how efficient it is, the answer is probably: quite. You might want to run your own benchmarks however to confirm whether it suits your requirements.</p>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 4, "creation_date": 1534154884, "post_id": 51819286, "comment_id": 90593518, "body": "That gem&#39;s behaviour is not the same as <code>&amp;.</code>. For example, <code>false.andand.foo</code> returns <code>false</code>, but <code>false&amp;.foo</code> raises a no method error. The gem&#39;s purpose is pretty much different. It is a common beginner&#39;s mistake to mix up <code>nil</code> and <code>false</code> in discussing <code>&amp;.</code>. It goes without saying that their implementation are pretty much different."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1534156830, "post_id": 51819286, "comment_id": 90594607, "body": "I wouldn&#39;t say the purpose is different. The main purpose of both is to get rid of the annoying check of object existence before calling a method on it. But I agree the implementations are different. I posted this more as a curiosity, because it might be fun to learn something new."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1534157926, "post_id": 51819286, "comment_id": 90595250, "body": "I think a better comparison would be with <code>ActiveSupport</code>&#39;s <code>Object#try!</code>: <a href=\"https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activesupport/lib/active_support/core_ext/object/try.rb#L11-L21\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/&hellip;</a> and <a href=\"https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activesupport/lib/active_support/core_ext/object/try.rb#L145-L147\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/&hellip;</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1534158085, "post_id": 51819286, "comment_id": 90595346, "body": "I <i>think</i> (?) that there&#39;s no behavioural difference between <code>foo&amp;.bar</code> and <code>foo.try!(:bar)</code>. The only difference is the implementation, and the fact that safe navigation (<code>&amp;.</code>) is in the core language, not an extension."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1534164849, "post_id": 51819286, "comment_id": 90599691, "body": "@TomLord <code>&amp;.</code> doesn&#39;t evaluate method arguments if the receiver is <code>nil</code>, whereas <code>try</code> does."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1534168728, "post_id": 51819286, "comment_id": 90602280, "body": "@Stefan Nice! TIL. That&#39;s also a good justification for not using <code>try!</code> in modern ruby."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 2, "last_activity_date": 1534156842, "last_edit_date": 1534156842, "creation_date": 1534152808, "answer_id": 51819286, "question_id": 51818060, "link": "https://stackoverflow.com/questions/51818060/how-is-the-ruby-safe-navigation-implemented/51819286#51819286", "title": "How is the Ruby safe navigation (&amp;.) implemented?", "body": "<p>Before the safe navigation operator was implemented into the core language using C, there used to be a gem with similar functionality called <code>andand</code>. If you want to research how something like this could be implemented using Ruby, then the andand source is a good place to start:</p>\n\n<p><a href=\"https://github.com/raganwald/andand\" rel=\"nofollow noreferrer\">https://github.com/raganwald/andand</a></p>\n\n<pre><code>require 'andand'\n\nnil.andand.some_method\n=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10218189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a0bb8ec0f46f157b7bb3ee652ae1c?s=128&d=identicon&r=PG&f=1", "display_name": "dojo1313", "link": "https://stackoverflow.com/users/10218189/dojo1313"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1534161215, "creation_date": 1534148575, "last_edit_date": 1534149094, "question_id": 51818060, "link": "https://stackoverflow.com/questions/51818060/how-is-the-ruby-safe-navigation-implemented", "title": "How is the Ruby safe navigation (&amp;.) implemented?", "body": "<p>I was trying to figure out how the safe navigation operator is implemented but didn't find the source for it, would love to know how it works and how efficient it is.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "will-paginate"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1534144638, "post_id": 51816956, "comment_id": 90588107, "body": "That is not valid Ruby code."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1534144700, "post_id": 51816956, "comment_id": 90588135, "body": "Just a guess, but I think it is <code>{ &lt;#Floor ...&gt; =&gt; [101, 102, 103], ... }</code> An object of <code>Floor</code>, although nothing provided by OP."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1534144799, "post_id": 51816956, "comment_id": 90588179, "body": "Also, it is a very bad idea to redefine <code>Hash</code>, which is a very basic plain Ruby class."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1534251033, "post_id": 51816956, "comment_id": 90636699, "body": "&quot;it is not working&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1534249174, "post_id": 51820876, "comment_id": 90635556, "body": "This this help at all @AnandShrivastava?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1534164557, "last_edit_date": 1534164557, "creation_date": 1534158235, "answer_id": 51820876, "question_id": 51816956, "link": "https://stackoverflow.com/questions/51816956/how-to-implement-pagination-for-ruby-hash/51820876#51820876", "title": "How to implement pagination for Ruby hash", "body": "<p>Do you mean you want to show the values relating to each <code>floor_x</code> key on a different page?</p>\n\n<p>If so, at a very basic level, you could use the following (for example, in your controller):</p>\n\n<pre><code>def index\n  @hash = { floor_1: [101,102,103], floor_2: [201,203,204], floor_3: [301,302,303] }\nend\n</code></pre>\n\n<p>In your view:</p>\n\n<pre><code>&lt;% params[:floor] ||= 1 %&gt; # show values for floor_1 if param not provided\n&lt;% hash[\"floor_#{params[:floor]\".to_sym].each do |vals| %&gt;\n  # display your values\n&lt;% end %&gt;\n&lt;%= link_to 'Down A Floor', your_path(params[:floor].to_i - 1) if hash[\"floor_#{params[:floor].to_i - 1}\".to_sym] %&gt;\n&lt;%= link_to 'Up A Floor', your_path(params[:floor].to_i + 1) if hash[\"floor_#{params[:floor].to_i + 1}\".to_sym] %&gt;\n</code></pre>\n\n<p>Extremely basic but might get you on the right track. Basically, you make the hash of floors / values available to a view, and display the current floor with links to the floor above and below if they exist.</p>\n\n<p>Very unlikely you'd want it looking like that in your final code, lots of nasty inline logic, though I wanted to keep things very simple. Have look into using a presenter or decorator to handle this.</p>\n"}], "owner": {"reputation": 55, "user_id": 7239868, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/28f0ee80a64deac9adbb048d7add0b12?s=128&d=identicon&r=PG&f=1", "display_name": "Anand Shrivastava", "link": "https://stackoverflow.com/users/7239868/anand-shrivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1534164557, "creation_date": 1534144395, "last_edit_date": 1534144715, "question_id": 51816956, "link": "https://stackoverflow.com/questions/51816956/how-to-implement-pagination-for-ruby-hash", "title": "How to implement pagination for Ruby hash", "body": "<p>I need to implement pagination for the following hash. I need to show the rooms floor wise with pagination.</p>\n\n<pre><code>Hash = { floor_1 : [101,102,103], floor_2: [201,203,204], floor_3: [301,302,303] }\n</code></pre>\n\n<p>Is there any idea on how to do that? I am using will pagination gem and it is not working.</p>\n"}]