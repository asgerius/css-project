[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "ruby-on-rails-5.1"], "answers": [{"tags": [], "owner": {"reputation": 1142, "user_id": 3562561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5455f5135299cdb6b4640148fa176f9f?s=128&d=identicon&r=PG", "display_name": "treiff", "link": "https://stackoverflow.com/users/3562561/treiff"}, "is_accepted": false, "score": 2, "last_activity_date": 1498095544, "creation_date": 1498095544, "answer_id": 44688741, "question_id": 44687983, "link": "https://stackoverflow.com/questions/44687983/where-should-i-place-my-middleware-file-for-rails-5-1/44688741#44688741", "title": "Where should I place my middleware file for Rails 5.1?", "body": "<p>I believe you want to add your middleware to either your <code>config/application.rb</code> or your <code>config/environments</code> file.</p>\n\n<pre><code>config.middleware.use MyMiddleWare\n</code></pre>\n\n<p>This should work and append <code>MyMiddleWare</code> to the bottom of the middleware stack.</p>\n"}, {"comments": [{"owner": {"reputation": 659, "user_id": 172106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0f55f3b9b2cdd268ac9a2ef47e3d684c?s=128&d=identicon&r=PG", "display_name": "turboladen", "link": "https://stackoverflow.com/users/172106/turboladen"}, "edited": false, "score": 5, "creation_date": 1550645324, "post_id": 44689184, "comment_id": 96339515, "body": "I believe specifying your middleware class using a String was valid only before Rails 5. <a href=\"https://github.com/rails/rails/issues/25525\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/25525</a>"}], "tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": false, "score": 1, "last_activity_date": 1498098768, "creation_date": 1498098768, "answer_id": 44689184, "question_id": 44687983, "link": "https://stackoverflow.com/questions/44687983/where-should-i-place-my-middleware-file-for-rails-5-1/44689184#44689184", "title": "Where should I place my middleware file for Rails 5.1?", "body": "<p>Even before app/middleware contents are loaded if 'config.middleware.use' is called, I think you get the 'uninitialized Constant error'. The below should fix</p>\n\n<pre><code>config.middleware.use \"MyMiddleWare\"\n</code></pre>\n\n<p>If the above doesn't work, one of the below might be a no. </p>\n\n<pre><code>Is MyMiddleWare in app/middleware/my_middle_ware.rb ?\n\nIs MyMiddleWare in lib/my_middle_ware.rb ?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4713, "user_id": 56083, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JMY95.jpg?s=128&g=1", "display_name": "Jay P.", "link": "https://stackoverflow.com/users/56083/jay-p"}, "edited": false, "score": 3, "creation_date": 1512757271, "post_id": 44702257, "comment_id": 82400642, "body": "This is the fix I went with also, but it seems like the framework should be loading these.  Maybe it is a bug?"}, {"owner": {"reputation": 36888, "user_id": 293280, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6e6e22d81a1f4f394f62301be40c2e20?s=128&d=identicon&r=PG", "display_name": "Joshua Pinter", "link": "https://stackoverflow.com/users/293280/joshua-pinter"}, "reply_to_user": {"reputation": 4713, "user_id": 56083, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JMY95.jpg?s=128&g=1", "display_name": "Jay P.", "link": "https://stackoverflow.com/users/56083/jay-p"}, "edited": false, "score": 0, "creation_date": 1604277893, "post_id": 44702257, "comment_id": 114290685, "body": "@JayP. I agree. Is this a bug? I&#39;m on Rails 5.2 and this is happening. Surprised there&#39;s not a standard auto-loaded directory for <code>middleware</code>, like there is for <code>models</code>, <code>controllers</code>, <code>views</code>, <code>mailers</code>, etc."}, {"owner": {"reputation": 36888, "user_id": 293280, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6e6e22d81a1f4f394f62301be40c2e20?s=128&d=identicon&r=PG", "display_name": "Joshua Pinter", "link": "https://stackoverflow.com/users/293280/joshua-pinter"}, "edited": false, "score": 1, "creation_date": 1604286613, "post_id": 44702257, "comment_id": 114292171, "body": "For the record, I dug deep into this and here&#39;s the relevant discussion with the Rails Core members about where middleware should go and how to require it: <a href=\"https://github.com/rails/rails/issues/25525#issuecomment-479941866\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/25525#issuecomment-479941866</a>. In short, <i>&quot;middleware can&#39;t be in app because they can&#39;t be reloaded. They should be in lib and if you put them in lib, require_relative will work.&quot;</i>"}], "tags": [], "owner": {"reputation": 996, "user_id": 2387313, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/0f9bb8f3e7a6cf91b8bbe4ec436e6c3d?s=128&d=identicon&r=PG", "display_name": "Siva", "link": "https://stackoverflow.com/users/2387313/siva"}, "is_accepted": true, "score": 7, "last_activity_date": 1498141556, "creation_date": 1498141556, "answer_id": 44702257, "question_id": 44687983, "link": "https://stackoverflow.com/questions/44687983/where-should-i-place-my-middleware-file-for-rails-5-1/44702257#44702257", "title": "Where should I place my middleware file for Rails 5.1?", "body": "<p>Look like rails wasn't looking for it.</p>\n\n<p>I had to do the following for it to work.</p>\n\n<pre><code>Dir[\"./lib/middleware/*.rb\"].each do |file|\n  require file\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7291473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef471625b2f095aca0629c059621f8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Roel4811", "link": "https://stackoverflow.com/users/7291473/roel4811"}, "is_accepted": false, "score": 0, "last_activity_date": 1553704139, "creation_date": 1553704139, "answer_id": 55382154, "question_id": 44687983, "link": "https://stackoverflow.com/questions/44687983/where-should-i-place-my-middleware-file-for-rails-5-1/55382154#55382154", "title": "Where should I place my middleware file for Rails 5.1?", "body": "<p>replacing middleware as a string in <code>config/application.rb</code> to <code>config/environment/{environment}</code> as a constant fixed the issue for me</p>\n"}, {"tags": [], "owner": {"reputation": 2729, "user_id": 1856513, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a66ca1982dc4160d1a1129dbe9f6d31b?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/1856513/abhi"}, "is_accepted": false, "score": 1, "last_activity_date": 1569413650, "creation_date": 1569413650, "answer_id": 58098128, "question_id": 44687983, "link": "https://stackoverflow.com/questions/44687983/where-should-i-place-my-middleware-file-for-rails-5-1/58098128#58098128", "title": "Where should I place my middleware file for Rails 5.1?", "body": "<p>Create a folder <code>app/middlewares</code> and create your middleware file in this folder.</p>\n\n<p>But unfortunately The <code>app/middleware</code>s folder is not loading even if I added to the load paths in <code>Rails v5.2.2</code></p>\n\n<pre><code>config.autoload_paths &lt;&lt; \"#{Rails.root}/app/middlewares\"\nconfig.eager_load_paths &lt;&lt; \"#{Rails.root}/app/middlewares\"\n</code></pre>\n\n<p>So you can use require explicitly as follows, add this line in <code>application.rb</code> </p>\n\n<pre><code>require_relative '../app/middlewares/my_middleware'\n</code></pre>\n\n<p>and load middleware:</p>\n\n<pre><code>config.middleware.use MyMiddleware\n</code></pre>\n\n<p>and call <code>rake middleware</code> to see the middleware stack.</p>\n"}], "owner": {"reputation": 996, "user_id": 2387313, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/0f9bb8f3e7a6cf91b8bbe4ec436e6c3d?s=128&d=identicon&r=PG", "display_name": "Siva", "link": "https://stackoverflow.com/users/2387313/siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3030, "favorite_count": 0, "accepted_answer_id": 44702257, "answer_count": 5, "score": 10, "last_activity_date": 1569413650, "creation_date": 1498089391, "question_id": 44687983, "link": "https://stackoverflow.com/questions/44687983/where-should-i-place-my-middleware-file-for-rails-5-1", "title": "Where should I place my middleware file for Rails 5.1?", "body": "<p>Previously I had my middleware under lib/middleware/my_middle_ware.rb</p>\n\n<p>However when doing this,</p>\n\n<pre><code>config.middleware.use MyMiddleWare\n</code></pre>\n\n<p>I receive a </p>\n\n<pre><code>NameError: uninitialized constant\n</code></pre>\n\n<p>Where is rails looking for the middleware? </p>\n"}, {"tags": ["arrays", "ruby", "merge"], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 6378152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c1193ff68e9f17ed58182ed16a090fa0?s=128&d=identicon&r=PG&f=1", "display_name": "user6378152", "link": "https://stackoverflow.com/users/6378152/user6378152"}, "edited": false, "score": 0, "creation_date": 1498087603, "post_id": 44687631, "comment_id": 76359515, "body": "what if I have to populate an array with this secondarray and 2 strings?eg - thirdarray = String2 + String3+ secondarray"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1498088509, "post_id": 44687631, "comment_id": 76359753, "body": "You could use the splat operator: <code>thirdarray = [*secondarray, &quot;String2&quot;, &quot;String3&quot;]</code>"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "reply_to_user": {"reputation": 247, "user_id": 6378152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c1193ff68e9f17ed58182ed16a090fa0?s=128&d=identicon&r=PG&f=1", "display_name": "user6378152", "link": "https://stackoverflow.com/users/6378152/user6378152"}, "edited": false, "score": 0, "creation_date": 1498092123, "post_id": 44687631, "comment_id": 76360557, "body": "@user6378152 If this doesn&#39;t answer your question then please edit it and clarify."}], "tags": [], "owner": {"reputation": 66, "user_id": 5843742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RsQMd.jpg?s=128&g=1", "display_name": "Vojt\u011bch Pithart", "link": "https://stackoverflow.com/users/5843742/vojt%c4%9bch-pithart"}, "is_accepted": false, "score": 4, "last_activity_date": 1498086818, "creation_date": 1498086818, "answer_id": 44687631, "question_id": 44687601, "link": "https://stackoverflow.com/questions/44687601/how-to-merge-2-arrays-into-third-array/44687631#44687631", "title": "How to merge 2 arrays into third array", "body": "<p>Just use the <code>+</code> operator on those two arrays.</p>\n\n<pre><code>firstarray = [\"1212\",\"3434\"]\nsecondarray = [\"9999\",\"6666\",\"7777\"]\n\nthirdarray = firstarray + secondarray\n\n=&gt; [\"1212\", \"3434\", \"9999\", \"6666\", \"7777\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498099518, "creation_date": 1498099518, "answer_id": 44689294, "question_id": 44687601, "link": "https://stackoverflow.com/questions/44687601/how-to-merge-2-arrays-into-third-array/44689294#44689294", "title": "How to merge 2 arrays into third array", "body": "<p>You can also use concat operator.</p>\n\n<p>Below edits your 'firstarray' by appending your 'secondarray' elements to the end of 'firstarray'. concat is more performant than '+'</p>\n\n<pre><code>firstarray.concat(secondarray)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 0, "last_activity_date": 1498130314, "last_edit_date": 1498130314, "creation_date": 1498128767, "answer_id": 44697317, "question_id": 44687601, "link": "https://stackoverflow.com/questions/44687601/how-to-merge-2-arrays-into-third-array/44697317#44697317", "title": "How to merge 2 arrays into third array", "body": "<p>another way: </p>\n\n<pre><code>&gt; thirdarray = [*firstarray, *secondarray]\n#=&gt; [\"1212\", \"3434\", \"9999\", \"6666\", \"7777\"]\n</code></pre>\n\n<p>if you want to add extra elements:</p>\n\n<pre><code>&gt; thirdarray = [*firstarray, *secondarray, \"additional-1\" ]\n#=&gt; [\"1212\", \"3434\", \"9999\", \"6666\", \"7777\", \"additional-1\"] \n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 6378152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c1193ff68e9f17ed58182ed16a090fa0?s=128&d=identicon&r=PG&f=1", "display_name": "user6378152", "link": "https://stackoverflow.com/users/6378152/user6378152"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1498130314, "creation_date": 1498086622, "last_edit_date": 1498089743, "question_id": 44687601, "link": "https://stackoverflow.com/questions/44687601/how-to-merge-2-arrays-into-third-array", "title": "How to merge 2 arrays into third array", "body": "<p>I have 2 arrays in ruby </p>\n\n<pre><code>firstarray = [\"1212\",\"3434\"]\nsecondarray = [\"9999\",\"6666\",\"7777\"]\n</code></pre>\n\n<p>I want to merge these 2 arrays into thirdarray and thirdarray should have following structure-</p>\n\n<pre><code>thirdarray = [\"1212\",\"3434\",\"9999\",\"6666\",\"7777\"]\n</code></pre>\n\n<p>I was planning to use this:</p>\n\n<p><code>thirdarray = [firstarray, secondarray.join(\", \")]</code></p>\n\n<p>but this gives me below which does not have \" \" around individual values 9999, 6666, 7777.</p>\n\n<pre><code>[\"1212\", \"3434\", \"9999 , 6666 , 7777\"]\n</code></pre>\n\n<p>How can I do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "aes"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 2, "creation_date": 1498084076, "post_id": 44687220, "comment_id": 76358507, "body": "Which example are you referring to?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1498097535, "post_id": 44687220, "comment_id": 76361781, "body": "Do you want the final output hex-encoded or what? Is the example the desired output?"}, {"owner": {"reputation": 1, "user_id": 8196694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589e3449320f38541f4ad3e53677c50a?s=128&d=identicon&r=PG&f=1", "display_name": "Errol Hsu", "link": "https://stackoverflow.com/users/8196694/errol-hsu"}, "edited": false, "score": 0, "creation_date": 1498134824, "post_id": 44687220, "comment_id": 76381876, "body": "final output hex, the example perhaps wrong"}], "owner": {"reputation": 1, "user_id": 8196694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589e3449320f38541f4ad3e53677c50a?s=128&d=identicon&r=PG&f=1", "display_name": "Errol Hsu", "link": "https://stackoverflow.com/users/8196694/errol-hsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498134642, "creation_date": 1498083947, "last_edit_date": 1498134642, "question_id": 44687220, "link": "https://stackoverflow.com/questions/44687220/aes-encrypt-in-rails", "title": "AES encrypt in Rails", "body": "<p>can't get the same value from example</p>\n\n<pre><code> string = \"MerchantID=PG300000000055&amp;TimeStamp=1489630207&amp;Version=1.0&amp;MerchantOrderNo=S_1489630207&amp;Amt=30&amp;ItemDesc=UnitTest\"\n\n key = \"12345678901234567890123456789012\"\n iv = \"1234567890123456\"\n</code></pre>\n\n<p>encrypt by AES CBC</p>\n\n<p>this is my code</p>\n\n<pre><code>def encrypt \n  s = \"MerchantID=PG300000000055&amp;TimeStamp=1489630207&amp;Version=1.0&amp;MerchantOrderNo=S_1489630207&amp;Amt=30&amp;ItemDesc=UnitTest\"\n  cipher = OpenSSL::Cipher::AES.new(128, :CBC)\n  cipher.encrypt\n  cipher.key = \"12345678901234567890123456789012\"\n  cipher.iv  = \"1234567890123456\"\n  encrypted = cipher.update(s) &lt;&lt; cipher.final\nend\n</code></pre>\n\n<p>the example get this</p>\n\n<p>\"89931dedfbc62460c637791dde28cfa465d13c5141dca0e7c5ab75bc66c9d459b6eeb4f0\n71afed1bb41cfc9b25613ae39724e6e3fe7d9223a181c29e580257802b815cc09263032d\n2c804446542a0915d0abc05f9d63072d4397b6e6a81cbd2bd3ac04965755d85c7038a3c\n1838d031a20bd98173b6e57949a48003dffa5521a \"</p>\n\n<p>and i got this</p>\n\n<p>\"\\xB3v\\xE1\\xF8\\xBC\\x9C&amp;A\\b=H\\r\\xF4\\xF9>\\x13+\\x12\\xE5\\x975\\x85m}9\\xCF\\xDEp\\xC5b\\x00s\\xD1\\x1A\\xC9&lt;\\x94^H&amp;\\xB8\\x84!\\xC4\\xB8\\xAA\\x16bB\\rB\\x1C\\xEA\\xA3\\x9CA\\xF4\\x85\\xA8a\\xE5\\xD2\\xC5\\xE7\\xCE\\xDD;|+\\xE6]\\xEDvV\\xF4\\xB2M\\x96:\\xEC\\x18\\\"\\xAC\\xD0\\xB9\\x82\\xCF\\xD7\\t \\xD0a\\xDD\\xCF\\x14^;u\\xB2\\n\\x9DYP\\xE7^*U\\xF9Ko\\x13\\xEC\\xB2\\x9A&lt;7\\x04\\xAEG\\xD4\\x82\\xBE(\\xDA4K\\xD3\\x18\"</p>\n\n<p>if encoded by hex got</p>\n\n<p>\"b376e1f8bc9c2641083d480df4f93e132b12e59735856d7d39cfde70c5620073d11ac93c945e4826b88421c4b8aa1662420d421ceaa39c41f485a861e5d2c5e7cedd3b7c2be65ded7656f4b24d963aec1822acd0b982cfd70920d061ddcf145e3b75b20a9d5950e75e2a55f94b6f13ecb29a3c3704ae47d482be28da344bd318308569170f07115d91d11a636de99dd4\"</p>\n\n<p>how can i do to get the same encrypted</p>\n\n<p>thanks</p>\n"}, {"tags": ["ruby", "struct", "module"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1498083237, "post_id": 44686701, "comment_id": 76358226, "body": "I don&#39;t see how it&#39;s ill-advised from a code-reuse perspective to namespace the <code>new</code> call. That&#39;s how constant lookup works. Even if you defined <code>InternalThing</code> in the <code>ComplicatedClass::Operations</code> namespace, you&#39;d still need to say <code>self.class::InternalThing</code> from <code>#operate_on_object</code> because it&#39;s an instance method. Constants do not become shared even if their parent module is included/extended. Actually it&#39;s sometimes advised to use static methods / namespaces because it&#39;s easier to refactor (granted, the opposite is sometimes recommended too)"}, {"owner": {"reputation": 195, "user_id": 7971210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969765814a12b2d241c6bc39b1356edc?s=128&d=identicon&r=PG&f=1", "display_name": "dgsan", "link": "https://stackoverflow.com/users/7971210/dgsan"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1498237491, "post_id": 44686701, "comment_id": 76435712, "body": "I think on some level InternalThing being a class constant didn&#39;t really register, and that &quot;oh duh&quot; moment has made things a lot clearer. Thanks!"}], "owner": {"reputation": 195, "user_id": 7971210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969765814a12b2d241c6bc39b1356edc?s=128&d=identicon&r=PG&f=1", "display_name": "dgsan", "link": "https://stackoverflow.com/users/7971210/dgsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498081110, "creation_date": 1498081110, "question_id": 44686701, "link": "https://stackoverflow.com/questions/44686701/module-like-inclusion-of-structs-in-ruby", "title": "Module-like inclusion of Structs in Ruby?", "body": "<p>So I tried some code like the following:</p>\n\n<pre><code>ComplicatedClass\n  module InternalObjects\n    InternalThing = Struct.new(:name, :description)\n  end\nend\n\nclass ComplicatedClass\n  module Operations\n    def operate_on_object\n      InternalThing.new\n    end\n  end\nend\n\nclass ComplicatedClass\n  include InternalObjects\n  include Operations\n\n  def other_operate_on_object\n    InternalThing.new\n  end\nend\n</code></pre>\n\n<p>Then with <code>cc = ComplicatedClass.new</code>, <code>cc.other_operate_on_object</code> works just fine, but calling <code>cc.operate_on_object</code> causes a <code>NameError: uninitialized constant ComplicatedClass::Operations::InternalThing</code></p>\n\n<p>Clearly I can just choose to not have an <code>InternalObjects</code> module and just define my Structs in <code>ComplicatedClass</code>:</p>\n\n<pre><code>class ComplicatedClass\n  InternalThing = Struct.new(:name, :description)\n  include Operations\n\n  def other_operate_on_object\n    InternalThing.new\n  end\nend\n</code></pre>\n\n<p>and not have a problem, but then it's obnoxious to reuse the same Struct elsewhere (and probably leads to metaprogramming in an initialization routine as a workaround). </p>\n\n<p>Likewise, I could also namespace the <code>new</code> call in the Operations module (<code>ComplicatedClass::InternalThing.new</code>), but it'd be extremely ill-advised from a code-reuse standpoint IMO.</p>\n\n<ul>\n<li>Is there a way to define a Struct in a module such that you can just include the module in a class, and then have methods included from other modules be able to use said Struct? </li>\n<li>Even if you can, is this a bad idea? </li>\n<li>If I have a handful of Structs I reuse with some frequency throughout my application is there a proper way to define them in a module-like way? Or is there a different approach I should be taking? </li>\n<li>Is metaprogramming actually my best bet? </li>\n<li>Or even if they're very very\nvery very dumb objects should I be making them into their own\nfull-blown classes?</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 1228, "user_id": 4497621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d140bf5c97a7ee616b0f21189fa9373?s=128&d=identicon&r=PG&f=1", "display_name": "John Hayes-Reed", "link": "https://stackoverflow.com/users/4497621/john-hayes-reed"}, "edited": false, "score": 0, "creation_date": 1498096272, "post_id": 44685087, "comment_id": 76361491, "body": "Just as a side note, if consent_forms is a model relation, you can get similar functionality very easily using the relation <code>dependent:</code> option on the relation, like so: <code>has_many :consent_forms, dependent: :restrict_with_error</code>. This will stop the deletion of the parent if children exist, and add an error message to the model for you automatically."}, {"owner": {"reputation": 23, "user_id": 8196282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6f0d0e61aaf1ae0d6ded0e5b0cf1f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirR", "link": "https://stackoverflow.com/users/8196282/vladimirr"}, "reply_to_user": {"reputation": 1228, "user_id": 4497621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d140bf5c97a7ee616b0f21189fa9373?s=128&d=identicon&r=PG&f=1", "display_name": "John Hayes-Reed", "link": "https://stackoverflow.com/users/4497621/john-hayes-reed"}, "edited": false, "score": 0, "creation_date": 1498130030, "post_id": 44685087, "comment_id": 76378356, "body": "Thank you John! :)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8196282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6f0d0e61aaf1ae0d6ded0e5b0cf1f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirR", "link": "https://stackoverflow.com/users/8196282/vladimirr"}, "edited": false, "score": 0, "creation_date": 1498076266, "post_id": 44685511, "comment_id": 76355181, "body": "ok, and what should be in expect?test_cannot_delete is a helper method can you write exactly what should look like test?"}], "tags": [], "owner": {"reputation": 11075, "user_id": 744346, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4d4016d193e6a2ccf2fef223f7eac9db?s=128&d=identicon&r=PG", "display_name": "MrDanA", "link": "https://stackoverflow.com/users/744346/mrdana"}, "is_accepted": false, "score": 0, "last_activity_date": 1498076161, "creation_date": 1498076161, "answer_id": 44685511, "question_id": 44685087, "link": "https://stackoverflow.com/questions/44685087/rspec-before-destroy-callback/44685511#44685511", "title": "Rspec before_destroy callback", "body": "<p>You have to connect the consent_form child to the consent_language parent.</p>\n\n<pre><code>cf = create(:consent_form, :consent_language =&gt; cl2)\n</code></pre>\n\n<p>Otherwise, the relationship isn't set up, and your <code>cf</code> is being attached to a different consent_language.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8196282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6f0d0e61aaf1ae0d6ded0e5b0cf1f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirR", "link": "https://stackoverflow.com/users/8196282/vladimirr"}, "edited": false, "score": 0, "creation_date": 1498078923, "post_id": 44686134, "comment_id": 76356503, "body": "test pass :) yeah,those are associations i think this is good :)"}, {"owner": {"reputation": 23, "user_id": 8196282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6f0d0e61aaf1ae0d6ded0e5b0cf1f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirR", "link": "https://stackoverflow.com/users/8196282/vladimirr"}, "edited": false, "score": 0, "creation_date": 1498080878, "post_id": 44686134, "comment_id": 76357319, "body": "i have more callbacks to test, can you help me? Thanks for this callback :)"}], "tags": [], "owner": {"reputation": 10255, "user_id": 1155142, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c680db41999d478ca34d1a77a470e30d?s=128&d=identicon&r=PG", "display_name": "gabrielhilal", "link": "https://stackoverflow.com/users/1155142/gabrielhilal"}, "is_accepted": true, "score": 1, "last_activity_date": 1498078589, "creation_date": 1498078589, "answer_id": 44686134, "question_id": 44685087, "link": "https://stackoverflow.com/questions/44685087/rspec-before-destroy-callback/44686134#44686134", "title": "Rspec before_destroy callback", "body": "<p>Not sure about your model names and associations, but assuming your <code>ConsentLanguage</code> has_many <code>consent_forms</code> and <code>ConsentForm</code> belongs_to <code>consent_language</code>:</p>\n\n<pre><code>describe \"callbacks\" do\n  it \"#cannot_destroy_if_has_consent_form\" do\n    consent_language = create(:consent_language)\n    create(:consent_form, consent_language: consent_language)\n    expect { consent_language.destroy }.to_not change(ConsentLanguage, :count)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8196282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6f0d0e61aaf1ae0d6ded0e5b0cf1f?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirR", "link": "https://stackoverflow.com/users/8196282/vladimirr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 44686134, "answer_count": 2, "score": 0, "last_activity_date": 1498078589, "creation_date": 1498074560, "last_edit_date": 1498074696, "question_id": 44685087, "link": "https://stackoverflow.com/questions/44685087/rspec-before-destroy-callback", "title": "Rspec before_destroy callback", "body": "<p>Callbacks:</p>\n\n<pre><code>  before_destroy :cannot_destroy_if_has_consent_form\n\n  def cannot_destroy_if_has_consent_form\n    if self.consent_forms.any?\n      errors.add(:base, 'Language is associated with consent form and cannot be deleted')\n      false\n    end\n  end\n</code></pre>\n\n<p>RSpec:</p>\n\n<pre><code> describe \"callbacks\" do\n    it \"#cannot_destroy_if_has_consent_form\" do\n      cl1 = create(:consent_language)\n      test_delete(cl1)\n      cl2 = create(:consent_language, :active)\n      cf = create(:consent_form)\n      expect{(test_cannot_delete.cl2).to be_truthy}\n    end\n  end\n</code></pre>\n\n<p>How to write RSpec test? I started but I don't know how, allways pass test but is it wrong?</p>\n"}, {"tags": ["python", "ruby"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1498073369, "post_id": 44684706, "comment_id": 76353589, "body": "in the error message you get <code>\\extras</code> ? you mean you get a leading backslash? Print <code>filename</code> and post the value please."}, {"owner": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1498074770, "post_id": 44684706, "comment_id": 76354374, "body": "This is the filename print: extras/BZ/config2.txt"}], "answers": [{"tags": [], "owner": {"reputation": 200, "user_id": 7569847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247d0a57e639baa0e227b9268ae5cd65?s=128&d=identicon&r=PG&f=1", "display_name": "doratheexplorer0911", "link": "https://stackoverflow.com/users/7569847/doratheexplorer0911"}, "is_accepted": false, "score": 0, "last_activity_date": 1498073620, "creation_date": 1498073620, "answer_id": 44684835, "question_id": 44684706, "link": "https://stackoverflow.com/questions/44684706/python-unable-to-find-file-in-folder-tree/44684835#44684835", "title": "Python unable to find file in folder tree", "body": "<p>Remember that if your run script.rb from its folder then ALL OF THE CODE gets run as if it were in that folder.\nAnd so I think you should try setting base_path to './root_folder/extras/BZ/' just to check if that's the problem.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "edited": false, "score": 0, "creation_date": 1498075169, "post_id": 44684850, "comment_id": 76354607, "body": "Hi, yes I found some saying to use os.getcwd() but it returns C:\\Users\\user\\Documents If I concatenate with os.path.realpath it will be: C:\\Users\\user\\Documents\\\\extras\\BZ\\config2.txt, missing the root_folder in the middle"}, {"owner": {"reputation": 840, "user_id": 8007221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d995b19900dfec0395dc0c79736c0b8?s=128&d=identicon&r=PG&f=1", "display_name": "olisch", "link": "https://stackoverflow.com/users/8007221/olisch"}, "reply_to_user": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "edited": false, "score": 0, "creation_date": 1498075918, "post_id": 44684850, "comment_id": 76355020, "body": "@FelipeBarbosa well, so now you know, that you are not in your root_folder. so expand your cwd with your root_folder, or extend your base path, in order to reach the directory using a relative path."}, {"owner": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "edited": false, "score": 0, "creation_date": 1498132851, "post_id": 44684850, "comment_id": 76380327, "body": "I guess this is not possible, the name of the root_folder is unknown, it depends on the users PC, also is not possible to change script.rb."}, {"owner": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "edited": false, "score": 0, "creation_date": 1498159952, "post_id": 44684850, "comment_id": 76398690, "body": "Thanks for you input, the trick was to use os.path.dirname(sys.argv[0]), the solution was os.path.join(os.path.dirname(sys.argv[0]), &#39;extras/BZ/&#39;)"}], "tags": [], "owner": {"reputation": 840, "user_id": 8007221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d995b19900dfec0395dc0c79736c0b8?s=128&d=identicon&r=PG&f=1", "display_name": "olisch", "link": "https://stackoverflow.com/users/8007221/olisch"}, "is_accepted": false, "score": 1, "last_activity_date": 1498073674, "creation_date": 1498073674, "answer_id": 44684850, "question_id": 44684706, "link": "https://stackoverflow.com/questions/44684706/python-unable-to-find-file-in-folder-tree/44684850#44684850", "title": "Python unable to find file in folder tree", "body": "<p>your ruby script isn't started inside the root_folder, so your relative base path isn't correct. You can use <code>os.getcwd()</code> to fetch your current working directory. A relative path always starts from there.</p>\n\n<p>In general it is better to always use absolute paths, when possible. For creating absolute pathes, it is good practice to use <code>os.path.join()</code> instead of just concatenating strings.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "is_accepted": true, "score": 0, "last_activity_date": 1498160071, "creation_date": 1498160071, "answer_id": 44707945, "question_id": 44684706, "link": "https://stackoverflow.com/questions/44684706/python-unable-to-find-file-in-folder-tree/44707945#44707945", "title": "Python unable to find file in folder tree", "body": "<p>The solution was:</p>\n\n<pre><code>def run(action):\n    base_path = os.path.join(os.path.dirname(sys.argv[0]), 'extras/BZ/') \n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6510351, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2e9e573fe1b5892076143c65cd0ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Barbosa", "link": "https://stackoverflow.com/users/6510351/felipe-barbosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 44707945, "answer_count": 3, "score": 0, "last_activity_date": 1498160071, "creation_date": 1498073246, "last_edit_date": 1498132964, "question_id": 44684706, "link": "https://stackoverflow.com/questions/44684706/python-unable-to-find-file-in-folder-tree", "title": "Python unable to find file in folder tree", "body": "<p>I'm getting an error when I try to load one of the configuration files. Here is the folder structure:</p>\n\n<ol>\n<li>script.rb </li>\n<li>root_folder\n\n<ul>\n<li>command_line_interface.py</li>\n<li>extras\n\n<ul>\n<li>utils.py</li>\n<li>AZ\n\n<ul>\n<li>config1.txt</li>\n<li>config2.txt</li>\n</ul></li>\n<li>BZ\n\n<ul>\n<li>config1.txt</li>\n<li>config2.txt</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ol>\n\n<p>The query folows: <strong>script.rb > command_line_interface.py > utils.py > config2.txt</strong>\n<br>In <em>script.rb</em>:</p>\n\n<pre><code>IO.popen(\"./root_folder/command_line_interface.py -arg1 5\")\n</code></pre>\n\n<p><br>In <em>command_line_interface.py</em>:</p>\n\n<pre><code>if __name__ == '__main__':\n    sys.path.append(os.path.dirname(sys.argv[0]))\n    parser = argparse.ArgumentParser(description='Test')\n    parser.add_argument('-arg1', '--arg1', action='store', type=int, help='Test', dest='arg1')\n    args = parser.parse_args()\n    if args.arg1:\n        utils.run(action)\n</code></pre>\n\n<p><br>In <em>utils.py</em> dinamically load config.txt according to <em>action</em> parameter using <em>base_path</em>:</p>\n\n<pre><code>def run(action):\n    base_path = 'extras/BZ/'\n    .\n    .\n    .\n    filename = base_path + 'config2.txt'\n    with open(filename) as f:\n        result = json.load(f)\n</code></pre>\n\n<p><br><em>IOError: [Errno 2] No such file or directory: '\\extras\\BZ\\config2.txt'</em>\n<br>It works when called directly in windows prompt inside root_folder, but it does't when called from script.rb. It needs to run on both cases.\nDoes anyone knows what is causing the error?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 1, "creation_date": 1498072871, "post_id": 44684453, "comment_id": 76353300, "body": "How have you gotten your yaml into your script? Did you use YAML.load_file?"}], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1498073758, "post_id": 44684781, "comment_id": 76353838, "body": "<code>require &#39;yaml&#39;</code> needed?"}, {"owner": {"reputation": 247, "user_id": 6378152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c1193ff68e9f17ed58182ed16a090fa0?s=128&d=identicon&r=PG&f=1", "display_name": "user6378152", "link": "https://stackoverflow.com/users/6378152/user6378152"}, "edited": false, "score": 0, "creation_date": 1498074955, "post_id": 44684781, "comment_id": 76354486, "body": "great, it gave me the array [8811,9911]. But I want to append a string to each of these too- eg I want  [ VERSION_8811, VERSION_9911 ]. How can I do that?"}], "tags": [], "owner": {"reputation": 27405, "user_id": 2112633, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c9bf1e5beda923bfc9abb2271c5838e5?s=128&d=identicon&r=PG", "display_name": "usha", "link": "https://stackoverflow.com/users/2112633/usha"}, "is_accepted": false, "score": 2, "last_activity_date": 1498075287, "last_edit_date": 1498075287, "creation_date": 1498073495, "answer_id": 44684781, "question_id": 44684453, "link": "https://stackoverflow.com/questions/44684453/ruby-how-to-iterate-a-yml-and-add-elements-to-an-array/44684781#44684781", "title": "ruby : How to iterate a yml and add elements to an array", "body": "<p>Let's say your file is called <code>example.yml</code></p>\n\n<pre><code># assuming your file is in rails root\ncontents = YAML.load_file('example.yml')\ncontents['instances'].collect{|key, value| value['startup_port']}\n=&gt; [8811, 9911]\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>to append a string</p>\n\n<pre><code>contents['instances'].collect{|key, value| \"VERSION_#{value['startup_port']}\"}\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 6378152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c1193ff68e9f17ed58182ed16a090fa0?s=128&d=identicon&r=PG&f=1", "display_name": "user6378152", "link": "https://stackoverflow.com/users/6378152/user6378152"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498075287, "creation_date": 1498072305, "last_edit_date": 1498072471, "question_id": 44684453, "link": "https://stackoverflow.com/questions/44684453/ruby-how-to-iterate-a-yml-and-add-elements-to-an-array", "title": "ruby : How to iterate a yml and add elements to an array", "body": "<p>I have a hash in .yml which I want to iterate and then add its elements to an array of <code>startup_ports</code>.</p>\n\n<p>E.g. .yml:</p>\n\n<pre><code>instances:\n  instance1:\n    startup_port: 8811\n    shutdown_port: 8822\n  instance2:\n    startup_port: 9911\n    shutdown_port: 9922\n</code></pre>\n\n<p>In my Ruby code:</p>\n\n<pre><code>details['instances'].each do |instancename, attribs|\nstartup_port = attribs[:startup_port]\n</code></pre>\n\n<p>I want to create an array here which stores the <code>startup_port</code> for both instances.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1498071503, "post_id": 44683852, "comment_id": 76352477, "body": "Consider using a hash: <code>h = { :rock=&gt;:scissors, :scissors=&gt;:paper, :paper=&gt;:rock }</code>. Then if player 1 plays <code>c1</code> and player 2 plays <code>c2</code>, where <code>c1</code> and <code>c2</code> are each  <code>:rock</code>, <code>:paper</code> or <code>:scissors</code>, player 1 wins if <code>h[c1] == c2</code>, player 2 wins if <code>h[c2] == c1</code>, else it&#39;s a tie."}], "answers": [{"tags": [], "owner": {"reputation": 1419, "user_id": 3953760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d0864178d8e61e4631091e9c772b86?s=128&d=identicon&r=PG&f=1", "display_name": "AJ Gregory", "link": "https://stackoverflow.com/users/3953760/aj-gregory"}, "is_accepted": false, "score": 0, "last_activity_date": 1498071456, "last_edit_date": 1498071456, "creation_date": 1498071044, "answer_id": 44684009, "question_id": 44683852, "link": "https://stackoverflow.com/questions/44683852/why-am-i-always-getting-a-rock-response-from-p2-p3-and-p4/44684009#44684009", "title": "Why am I always getting a rock response from p2, p3 and p4?", "body": "<p><code>rand</code> returns a number between 0 and 1. Essentially, <code>choices[rand]</code> always becomes <code>choices[0]</code>.</p>\n\n<p>You may want to use <code>choices[rand(0..2)]</code> instead.</p>\n\n<p>Alternatively, you could use <code>choices.sample</code>.</p>\n\n<p>Check the docs for <code>rand</code> <a href=\"https://ruby-doc.org/core-2.2.0/Random.html#method-i-rand\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 8178931, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/QoaZ4.jpg?s=128&g=1", "display_name": "haletothewood", "link": "https://stackoverflow.com/users/8178931/haletothewood"}, "edited": false, "score": 0, "creation_date": 1498239173, "post_id": 44703311, "comment_id": 76436559, "body": "Thanks for all your help and advice, much appreciated."}], "tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1498144365, "creation_date": 1498144365, "answer_id": 44703311, "question_id": 44683852, "link": "https://stackoverflow.com/questions/44683852/why-am-i-always-getting-a-rock-response-from-p2-p3-and-p4/44703311#44703311", "title": "Why am I always getting a rock response from p2, p3 and p4?", "body": "<p>I see two issues. One which has already been pointed out about the default return value of <code>rand</code>. I recommend using <code>choices.sample</code>. The other issue is in <code>rps</code>: note that <code>p1</code> and <code>@p1</code> are different variables. There's no need to use instance variables in <code>rps</code>; I'd change them all to local <code>p1</code> and <code>p2</code>.</p>\n\n<p>Now, some code review style comments:</p>\n\n<p>It's cool that you are experimenting with mixins with the module <code>Promtable</code> (which is missing a 'p' by the way). Of course you have some RPS logic embedded in it, so it isn't really reusable. Maybe you can make it more generic by adding a way to pass in an array of valid values. Speaking of valid values, you are checking them with a regular expression (<code>/rock|paper|scissors/</code>) which just checks a substring. If I were to type \"rocky\" it would pass through and be treated as a draw. You may want to use \n<code>if !valid_values.include? var</code> or <code>unless valid_values.include? var</code> instead of the regex.</p>\n\n<p>The <code>rps</code> method can be simplified in a number of ways. Cary Swoveland had a clever idea in the comments of using a hash to look up the winning combinations. Another way to simplify would be to use a <code>case</code> statement:</p>\n\n<pre><code>case [p1,p2]\nwhen ['rock', 'scissors'], ['paper', 'rock'], ['scissors', 'paper']\n  puts \"Player 1 won!\"\nwhen ['scissors', 'rock'], ['rock', 'paper'], ['paper', 'scissors']\n  puts \"Computer won!\"\nelse\n  puts \"It's a draw!\"\nend\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8178931, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/QoaZ4.jpg?s=128&g=1", "display_name": "haletothewood", "link": "https://stackoverflow.com/users/8178931/haletothewood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 44703311, "answer_count": 2, "score": 1, "last_activity_date": 1498144365, "creation_date": 1498070470, "last_edit_date": 1498142506, "question_id": 44683852, "link": "https://stackoverflow.com/questions/44683852/why-am-i-always-getting-a-rock-response-from-p2-p3-and-p4", "title": "Why am I always getting a rock response from p2, p3 and p4?", "body": "<p>Hi I'm just learning ruby and decided to try and eloborate on codewars Kata to create quick rock, paper, scissors game. At first I was getting random responses but now it's alway rock. Please help and sorry if this is ridiculously easy.   </p>\n\n<pre><code>module Promtable\n  def prompt(message = \"What would you like to do? \", symbol = \":&gt; \")\n    print message\n    print symbol\n    var = gets.chomp.to_s\n    if !var.match /rock|paper|scissors/\n     puts \"I'm sorry that is not a valid response please try again\"\n     print message\n     print symbol\n     gets.chomp\n    else\n     var\n   end\n  end\nend\n\ndef rps(p1, p2)\n    if @p1 == 'rock' &amp;&amp; @p2 == 'scissors'\n      puts \"Player 1 won!\"\n    elsif \n       @p1 == 'paper' &amp;&amp; @p2 == 'rock'\n      puts \"Player 1 won!\"\n    elsif \n       @p1 == 'scissors' &amp;&amp; @p2 == 'paper'\n      puts \"Player 1 won!\"\n    elsif \n       @p1 == 'rock' &amp;&amp; @p2 == 'paper'\n      puts \"Computer won!\"\n    elsif \n       @p1 == 'scissors' &amp;&amp; @p2 == 'rock'\n      puts \"Computer won!\"\n    elsif \n       @p1 == 'paper' &amp;&amp; @p2 == 'scissors'\n      puts \"Computer won!\"\n    else \n       puts \"It's a draw!\" \n    end\nend\n\ndef game\n  include Promtable \n  p1 = prompt(\"Player 1 plays...?\")\n  choices = [\"rock\", \"paper\", \"scissors\"]\n  p2 = choices[rand]\n  p3 = choices[rand]\n  p4 = choices[rand]\n\n  rps(p1, p2)\n  puts \"The computer chose #{p2}!\"\n\n  p1 = prompt(\"What's your second choice...? \")\n  p3 = choices[rand]\n\n  rps(p1, p3)\n  puts \"The computer chose #{p3}!\"\n\n  p1 = prompt(\"What's your final choice...? \")\n  p4 = choices[rand]\n\n  rps(p1, p4)\n  puts \"The computer chose #{p4}!\"\nend\n\nputs \"Hi welcome to Rock, Paper, Scissors\"\ngame\n\nputs \"Would you like to play again? (Y/N)\"\n var = gets.chomp.downcase\n if var.match /y/\n  game\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 379, "user_id": 5389148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKUq8.jpg?s=128&g=1", "display_name": "Ganesh Sagare", "link": "https://stackoverflow.com/users/5389148/ganesh-sagare"}, "edited": false, "score": 0, "creation_date": 1498072483, "post_id": 44683589, "comment_id": 76353081, "body": "As per my understanding you want to find out such room which ll available for given date range(i.e between check in and check out). Am I right?"}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 379, "user_id": 5389148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKUq8.jpg?s=128&g=1", "display_name": "Ganesh Sagare", "link": "https://stackoverflow.com/users/5389148/ganesh-sagare"}, "edited": false, "score": 0, "creation_date": 1498073020, "post_id": 44683589, "comment_id": 76353397, "body": "@GaneshSagare yes..but am not looking for any other rooms. Just one room. The property has many rooms of this same type.So what am looking for is how many rooms are sold out for any day within the check_in and check_out period. As it has many rooms my plan is to find the day with the highest room requirement within the check_in and check_out period and add it to present booking room requirement count. Looping to find the highest room requirement day by totaling bookings for a single day from the array is the issue I face and thats  the question.."}], "answers": [{"comments": [{"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1498070220, "post_id": 44683754, "comment_id": 76351657, "body": "highest rooms needed is the thing am looking for. But not for a single booking. The room will have multiple bookings on a single day. So I need to add room_requirement on each day and find a day with highest room requirement(actually not day but rooms_needed) Thats what am having difficultly in finding..."}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1498070475, "post_id": 44683754, "comment_id": 76351827, "body": "Please post your model, to see if I can help you."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1498070599, "post_id": 44683754, "comment_id": 76351930, "body": "<code>Room has_many Bookings</code>  <code>Booking belongs_to Room</code>   .Its actually simple as this. I finded all bookings that will be within the range already as mentioned in the question. But looping through each for every single day is where i got stuck as its a range instead of a proper date"}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "reply_to_user": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1498072012, "post_id": 44683754, "comment_id": 76352801, "body": "I think you need to iterate over every single date between <code>check_in</code> and <code>check_out</code>, and in every iteration check the capacity."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1498072163, "post_id": 44683754, "comment_id": 76352888, "body": "yes thats what I want and the question is how to do that as its a range.."}], "tags": [], "owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "is_accepted": true, "score": 0, "last_activity_date": 1498070113, "creation_date": 1498070113, "answer_id": 44683754, "question_id": 44683589, "link": "https://stackoverflow.com/questions/44683589/finding-the-busiest-day-within-a-date-range-by-crosschecking-multiple-bookings/44683754#44683754", "title": "finding the busiest day within a date range by crosschecking multiple bookings", "body": "<p>If I undestand this right, what you need is the day with the highest <code>rooms_needed</code>:</p>\n\n<pre><code>array.order(\"rooms_needed DESC\").first\n</code></pre>\n\n<p>And later you can check if that is lower that <code>room_quantity</code>.</p>\n"}], "owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44683754, "answer_count": 1, "score": 1, "last_activity_date": 1498070960, "creation_date": 1498069610, "last_edit_date": 1498070960, "question_id": 44683589, "link": "https://stackoverflow.com/questions/44683589/finding-the-busiest-day-within-a-date-range-by-crosschecking-multiple-bookings", "title": "finding the busiest day within a date range by crosschecking multiple bookings", "body": "<p>Am working on a <code>room</code> <code>booking</code> app. Before making a new booking will search for room <code>availability</code> for the <code>check_in</code> and <code>check_out</code> dates by cross checking with <code>existing bookings</code> for the room</p>\n\n<p>Each <code>room</code> has a field <code>available_quantity</code>. Lets say its <code>5</code> for this room. So I must ensure the <code>bookings</code> for the <code>room</code> wont <code>exceed</code> that on any day between the <code>check_in</code> and <code>check_out</code> period(in other words the total <code>rooms_needed</code> wont exceed <code>5(available_quantity)</code> in any given day)</p>\n\n<p>My plan is first find all bookings that is within <code>check_in</code> and <code>check_out</code> </p>\n\n<pre><code>#find records with check_ins before the new checkout date &amp;&amp; check_outs after the new checkin date\n  scope :bookings_between, lambda {|start_date, end_date| where(\"check_in &lt; ? AND check_out &gt; ?\", end_date, start_date )}\n</code></pre>\n\n<p>This works fine as I will get below output as <code>array</code> as expected</p>\n\n<pre><code>bookings=#&lt;ActiveRecord::Relation [#&lt;Booking id: 20, room_id: 29, buyer_id: 11, rooms_needed: 1,check_in: \"2017-06-20\", check_out: \"2017-06-23\"&gt;, #&lt;Booking id: 21, room_id: 29, buyer_id: 11,rooms_needed: 1, check_in: \"2017-06-20\", check_out: \"2017-06-23\"&gt;, #&lt;Booking id: 22, room_id: 29, buyer_id: 11,rooms_needed: 2, check_in: \"2017-06-22\", check_out: \"2017-06-25\"&gt;, #&lt;Booking id: 23, room_id: 29, buyer_id: 11, rooms_needed: 1, check_in: \"2017-06-22\", check_out: \"2017-06-25\"&gt;]&gt;\n</code></pre>\n\n<p>So basically these are the main values in the <code>array</code> now.</p>\n\n<pre><code>Range: 2017-06-20 .. 2017-06-23, rooms_needed: 1 \nRange: 2017-06-20 .. 2017-06-23, rooms_needed: 1 \nRange: 2017-06-22 .. 2017-06-25, rooms_needed: 2 \nRange: 2017-06-22 .. 2017-06-25, rooms_needed: 1 \n</code></pre>\n\n<p>Now what I want is find a day with <code>highest</code> <code>rooms_needed</code>(to make sure it wont exceed the <code>room_quantity</code>). The problem I find is that I need to consider <code>all the days within the range</code>. Could someone tell me how can I find that from this <code>bookings</code> array? Or am I over complicating this?? Thank you</p>\n\n<blockquote>\n  <p>NB: Basically looking for how to <code>loop</code> through the <code>bookings</code> <code>array</code> and\n  <code>totalling</code> bookings for each day from the <code>check_in</code> day to <code>check_out</code>\n  day(as its a range how can I do this)</p>\n</blockquote>\n"}, {"tags": ["ruby", "session", "sinatra"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1498074833, "post_id": 44683328, "comment_id": 76354418, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28230845/communication-between-tabs-or-windows\">Communication between tabs or windows</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1498074854, "post_id": 44683328, "comment_id": 76354432, "body": "It&#39;s not really a duplicate, but I think that&#39;s where the solution will be."}, {"owner": {"reputation": 1454, "user_id": 5335030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JANvX.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5335030/tim"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1498075824, "post_id": 44683328, "comment_id": 76354959, "body": "thanks- had enough information for me to conclude a result"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1498167918, "post_id": 44683328, "comment_id": 76402567, "body": "maybe you could post your working result here as an answer, or mark it as duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 1454, "user_id": 5335030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JANvX.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5335030/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1498168152, "creation_date": 1498168152, "answer_id": 44709891, "question_id": 44683328, "link": "https://stackoverflow.com/questions/44683328/ruby-sinatra-sessions-across-windows/44709891#44709891", "title": "Ruby Sinatra Sessions Across Windows", "body": "<p>Yes! This will work. I guess sinatra has some listener that always updates the session even if it was updated from a child window.</p>\n"}], "owner": {"reputation": 1454, "user_id": 5335030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JANvX.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5335030/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498168152, "creation_date": 1498068660, "question_id": 44683328, "link": "https://stackoverflow.com/questions/44683328/ruby-sinatra-sessions-across-windows", "title": "Ruby Sinatra Sessions Across Windows", "body": "<p>I have a quick question about using sessions across different windows. I'm currently trying to create a login screen for a web app that I'm creating and I was wondering if this flow will work by enabling sessions:</p>\n\n<ol>\n<li>Window A: User inputs basic account information and is stored inside sessions</li>\n<li>A new popup Window B is open and user is authenticated via Google oauth. I store the token <code>session[:credentials] = generated_credentials</code>. User closes Window B.</li>\n<li>Window A has access to <code>session[:credentials]</code> </li>\n</ol>\n\n<p>I guess my question here is if step 3 is valid because I'm trying to essentially listen for a new cookie</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1498103770, "post_id": 44683271, "comment_id": 76363271, "body": "what happens when you just do <code>&lt;%= form_for(resource, as: resource_name, html: { class: &#39;form-horizontal&#39; }) do |f| %&gt;</code>"}, {"owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "reply_to_user": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1498679609, "post_id": 44683271, "comment_id": 76603290, "body": "This what I get: Routing Error No route matches [DELETE] &quot;/users/106&quot; Rails.root: /home/ubuntu/workspace Application Trace | Framework Trace | Full Trace Routes Routes match in priority from top to bottom. Somehow it&#39;s interpreting it as a delete request \u2013"}], "owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498081443, "creation_date": 1498068421, "last_edit_date": 1498081443, "question_id": 44683271, "link": "https://stackoverflow.com/questions/44683271/devise-treating-update-as-delete-when-editing-user-name-or-password", "title": "Devise treating update as delete when editing User name or password", "body": "<p>So I'm having an issue when the user is trying to update his password/avatar/name. </p>\n\n<p>The problem lies in Devise model registration.</p>\n\n<p>In <code>myapp/views/users/registrations/edit.html.erb</code>:</p>\n\n<pre><code>&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, class: 'form-horizontal' }) do |f| %&gt;     &lt;%= devise_error_messages! %&gt;\n\n  &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :avatar, class: 'col-sm-2 control-label'  %&gt;\n        &lt;div class=\"col-sm-6\"&gt;\n            &lt;%= f.file_field :avatar %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :name, class: 'col-sm-2 control-label'%&gt;\n        &lt;div class=\"col-sm-6\"&gt;\n        &lt;%= f.text_field :name, autofocus: true, class: 'form-control'%&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :email, class: 'col-sm-2 control-label'  %&gt;\n        &lt;div class=\"col-sm-6\"&gt;\n            &lt;%= f.email_field :email, class: 'form-control'  %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :password, class: 'col-sm-2 control-label'  %&gt; &lt;i&gt;(leave blank if you don't want to change it)&lt;/i&gt;\n        &lt;div class=\"col-sm-6\"&gt;\n            &lt;%= f.password_field :password, autocomplete: \"off\", class: 'form-control'  %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :password_confirmation, class: 'col-sm-2 control-label' %&gt;\n        &lt;div class=\"col-sm-6\"&gt;\n            &lt;%= f.password_field :password_confirmation, autocomplete: \"off\", class: 'form-control'  %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :current_password, class: 'col-sm-2 control-label' %&gt; \n         &lt;i&gt;(we need your current password to confirm your changes)&lt;/i&gt;\n        &lt;div class=\"col-sm-6\"&gt;\n            &lt;%= f.password_field :current_password, autocomplete: \"off\", class: 'form-control' %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"col-sm-offset-3 col-sm-6\"&gt;\n            &lt;%= f.submit \"Update\", class: \"btn btn-primary\" %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;hr&gt;\n    &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"col-sm-offset-3 col-sm-6\"&gt;\n           `Unhappy?`                                         \n    &lt;%= button_to \"Cancel my account\", registration_path(resource_name), data: { confirm: \"Are you sure?\" }, method: :delete, class: 'btn btn-default btn-xs' %&gt;\n     &lt;%= link_to \"Back\", :back %&gt;\n\n        &lt;/div&gt;\n    &lt;/div&gt;&lt;% end %&gt;\n</code></pre>\n\n<p>And my development Log is </p>\n\n<pre><code>Started DELETE \"/users\" for 128.224.252.2 at 2017-06-21 17:21:26 +0000 Cannot render console from 128.224.252.2! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255 Processing by Devise::RegistrationsController#destroy as HTML Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"RBkvQWXmVVY5rHEa7t0yh41QmMDS4HBcPCLJkKZ0RQYkpFfPXc7ebF6u3YKuF1BiOs5RDng3cFIWTFoZPmhLAw==\", \"user\"=&gt;{\"name\"=&gt;\"adnan\", \"email\"=&gt;\"adhajar.work@gmail.com\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"current_password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Update\"} User Load (2.9ms) SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT 1 [[\"id\", 104]]  (0.2ms) BEGIN SQL (0.3ms) DELETE FROM \"users_roles\" WHERE \"users_roles\".\"user_id\" = $1 [[\"user_id\", 104]] SQL (0.4ms) DELETE FROM \"users\" WHERE \"users\".\"id\" = $1 [[\"id\", 104]]  (3.0ms) COMMIT Redirected to https://confessionbox-adnanhajar.c9users.io/ Completed 302 Found in 47ms (ActiveRecord: 6.7ms)\n\nStarted GET \"/\" for 128.224.252.2 at 2017-06-21 17:21:26 +0000 Cannot render console from 128.224.252.2! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255 Processing by PagesController#index as HTML Rendered pages/index.html.erb within layouts/application (68.0ms) Completed 200 OK in 74ms (Views: 72.8ms | ActiveRecord: 0.0ms)\n\nStarted GET \"/users/sign_in\" for 128.224.252.2 at 2017-06-21 17:43:01 +0000 Cannot render console from 128.224.252.2! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255 Processing by Devise::SessionsController#new as HTML Rendered users/sessions/new.html.erb within layouts/application (81.2ms) Completed 200 OK in 90ms (Views: 87.9ms | ActiveRecord: 0.0ms)\n\nStarted GET \"/users/auth/facebook\" for 128.224.252.2 at 2017-06-21 17:43:03 +0000 Cannot render console from 128.224.252.2! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255`\n</code></pre>\n\n<p>Any idea why this is happening ?</p>\n\n<p>Thank you prior!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redirect", "testing", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 436, "user_id": 3265888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ad76bb1e69ffbab6dfecb2d61b2aad?s=128&d=identicon&r=PG&f=1", "display_name": "York Yang", "link": "https://stackoverflow.com/users/3265888/york-yang"}, "is_accepted": false, "score": 1, "last_activity_date": 1498068740, "creation_date": 1498068740, "answer_id": 44683353, "question_id": 44683240, "link": "https://stackoverflow.com/questions/44683240/how-to-use-rspec-to-test-if-one-url-redirects-to-another-url/44683353#44683353", "title": "How to use RSpec to test if one URL redirects to another URL?", "body": "<p>In your case, you actually are trying to redirect from /foobar+baz/bar+boo to / with parameters appended. Potentially similar with this post: <a href=\"https://stackoverflow.com/questions/23922934/rspec-testing-redirect-to-url-with-get-params\">RSpec testing redirect to URL with GET params</a></p>\n\n<p>Typically you shouldn't test the parameter with the redirect url syntax cus this is not the url location but the parameter. You can extract the location manually and parse the parameter to see if they are what you want. The first answer in that post gives an example. </p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 4508992, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004214264644/picture?type=large", "display_name": "Kamen Kanev", "link": "https://stackoverflow.com/users/4508992/kamen-kanev"}, "is_accepted": false, "score": 0, "last_activity_date": 1498125171, "creation_date": 1498125171, "answer_id": 44696009, "question_id": 44683240, "link": "https://stackoverflow.com/questions/44683240/how-to-use-rspec-to-test-if-one-url-redirects-to-another-url/44696009#44696009", "title": "How to use RSpec to test if one URL redirects to another URL?", "body": "<p>You should make a request test. RSpec have:</p>\n\n<pre><code>expect(response).to redirect_to(...)\n</code></pre>\n\n<p>but it doesn't make assertions for the params</p>\n\n<p>You use this one:</p>\n\n<pre><code>def expect_to_redirect_to_with_params(expected_url, expected_params)\n  redirect_url = response.location\n  uri = URI.parse(redirect_uri)\n  redirect_params = Rack::Utils.parse_query(uri.query)\n\n  expect(redirect_url).to eq(expected_uri)\n  expect(redirect_params).to eq(expected_params)\nend\n</code></pre>\n\n<p>If you want you can make it to a custom <a href=\"https://relishapp.com/rspec/rspec-expectations/v/2-4/docs/custom-matchers/define-matcher\" rel=\"nofollow noreferrer\">matcher</a> instead of method.</p>\n"}], "owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1598550416, "creation_date": 1498068289, "last_edit_date": 1598550416, "question_id": 44683240, "link": "https://stackoverflow.com/questions/44683240/how-to-use-rspec-to-test-if-one-url-redirects-to-another-url", "title": "How to use RSpec to test if one URL redirects to another URL?", "body": "<p>I want to write a test that verifies that a URL is redirecting to a different one.</p>\n<p>For example:</p>\n<p>http://localhost:3000/news/foobar+baz/bar+boo</p>\n<p>to</p>\n<p>http://localhost:3000/news?tools=foobar+baz&amp;sources=bar+boo</p>\n<hr />\n<p>Using RSpec I can't seem to find a way to do this. Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 0, "creation_date": 1498067357, "post_id": 44682904, "comment_id": 76350034, "body": "Don&#39;t use exceptions for control flow.  It&#39;s more expensive to raise exceptions than it is to do if checks."}, {"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 0, "creation_date": 1498067521, "post_id": 44682904, "comment_id": 76350121, "body": "Related/dupe: <a href=\"https://softwareengineering.stackexchange.com/q/189222/54997\">softwareengineering.stackexchange.com/q/189222/54997</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1498068139, "post_id": 44683028, "comment_id": 76350463, "body": "In your second case <code>save(false)</code> or now <code>save(validate: false)</code> would be better since <code>valid?</code> has already validated the record and <code>save</code> will do so again unnecessarily."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 4, "last_activity_date": 1498067613, "creation_date": 1498067613, "answer_id": 44683028, "question_id": 44682904, "link": "https://stackoverflow.com/questions/44682904/is-this-an-error-handling-anti-pattern/44683028#44683028", "title": "Is this an error-handling anti-pattern?", "body": "<p>This is an antipattern, because there are better ways to check the validity of a record than running <code>save!</code> (which raises an error if it's not valid).</p>\n\n<p>This is probably what your colleague was getting at:</p>\n\n<pre><code>  if record.save\n    do_something_else\n  else\n    puts record.errors.full_messages\n  end\n</code></pre>\n\n<p>You see, there is just no benefit here of using the error as control flow because there are less roundabout ways to do it. </p>\n\n<p>You can also run the validations independently of the save attempt. The <code>errors.full_messages</code> array (of strings) is populated when <code>record.valid?</code> gets called. <code>record.save</code> calls <code>record.valid?</code> internally.</p>\n\n<pre><code>if record.valid?\n  record.save # or save!; by this point you can assume the record is valid\nelse\n  puts record.errors.full_messages\nend\n</code></pre>\n"}], "owner": {"reputation": 11149, "user_id": 706628, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/NICFY.jpg?s=128&g=1", "display_name": "Barry Fruitman", "link": "https://stackoverflow.com/users/706628/barry-fruitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 44683028, "answer_count": 1, "score": 2, "last_activity_date": 1498067613, "creation_date": 1498067198, "question_id": 44682904, "link": "https://stackoverflow.com/questions/44682904/is-this-an-error-handling-anti-pattern", "title": "Is this an error-handling anti-pattern?", "body": "<p>A colleague recently told me this is an anti-pattern (<code>record</code> is an <code>ActiveRecord</code>):</p>\n\n<pre><code>  begin\n    record.save!\n    do_something_else\n  rescue =&gt; e\n    puts \"Unable to save\"\n  end\n</code></pre>\n\n<p>...and I should do this instead:</p>\n\n<pre><code>  if record.save\n    do_something_else\n  else\n    puts \"Unable to save\"\n  end\n</code></pre>\n\n<p>His argument is that I'm using an exception for flow control (which I agree is bad) but I believe this is a typical error-handling pattern.</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["mysql", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498068619, "post_id": 44682188, "comment_id": 76350745, "body": "According <a href=\"https://major.io/2007/08/09/mysql-error-codes/\" rel=\"nofollow noreferrer\">To This</a> Error 65 means package not installed and is an OS error."}], "answers": [{"comments": [{"owner": {"reputation": 514, "user_id": 4613443, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/abfa85562e754636c46ac3dc3f67decd?s=128&d=identicon&r=PG", "display_name": "mohnstrudel", "link": "https://stackoverflow.com/users/4613443/mohnstrudel"}, "edited": false, "score": 0, "creation_date": 1498134347, "post_id": 44684068, "comment_id": 76381499, "body": "Thanks! That led me to the stupidly simple solution - I wasn&#39;t aware of the fact, that our static IP address changed. Besides localhost, I permitted the old one, but not the new one."}], "tags": [], "owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "is_accepted": true, "score": 1, "last_activity_date": 1498071169, "creation_date": 1498071169, "answer_id": 44684068, "question_id": 44682188, "link": "https://stackoverflow.com/questions/44682188/connect-to-mysql-with-ruby-but-without-rails/44684068#44684068", "title": "Connect to mysql with Ruby but without Rails", "body": "<p>You can look up MySQL error codes with <code>perror</code>:</p>\n\n<pre><code>$ perror 65\nOS error code  65:  No route to host\n</code></pre>\n\n<p>That might mean the MySQL server is on a network you can't currently reach. If so, you haven't reached the point where the username and password matters. An easy way to test if the problem is with your code or with accessing the database is to use the <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql.html\" rel=\"nofollow noreferrer\">command-line tool</a>. If you can't reach the database from the command line you are running Ruby from, the problem isn't your code.</p>\n\n<p>Another test would be to run MySQL locally. (Or run your script on the same machine as the MySQL database, if possible.) If the script works as expected, check to see if there's been a recent change in network or database configuration. </p>\n"}], "owner": {"reputation": 514, "user_id": 4613443, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/abfa85562e754636c46ac3dc3f67decd?s=128&d=identicon&r=PG", "display_name": "mohnstrudel", "link": "https://stackoverflow.com/users/4613443/mohnstrudel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 44684068, "answer_count": 1, "score": 1, "last_activity_date": 1498071169, "creation_date": 1498064651, "question_id": 44682188, "link": "https://stackoverflow.com/questions/44682188/connect-to-mysql-with-ruby-but-without-rails", "title": "Connect to mysql with Ruby but without Rails", "body": "<p>I am using my old script, which used to work just fine, but now I'm receiving following error:</p>\n\n<pre><code>Error while connecting to the database.\nCan't connect to MySQL server on 'some.remote.host.com' (65)\n</code></pre>\n\n<p>I can't figure out what the real error is, my connect data is surely correct, because I can login to PhPMyadmin with the given username and password.</p>\n\n<p>Here is my code:</p>\n\n<pre><code># encoding: UTF-8\n\nrequire 'mysql2'\nrequire 'csv'\n\ndef initialize_data\n  puts \"Initializing database, username, password and host...\"\n  @database = \"database_name\"\n  @username = \"database_user\"\n  @password = \"my_secret_password\"\n  @host = \"remote.host.com\"\nend\n\ndef connect\n  puts \"Trying to connect to the database.\"\n  begin \n    @client = Mysql2::Client.new(host: @host, username: @username, password: @password, database: @database)\n  rescue =&gt; e\n    puts \"Error while connecting to the database.\"\n    puts e.message\n  end\nend\n</code></pre>\n\n<p>I wasn't able to find any info on this 65 error. Rescuing with <code>e.message</code> does not help at all. </p>\n\n<p>Can someone point me at least in what direction to dig? I'm struggling with this simple script second day in a row now. Is there any way to receive more detailed error messages? Like Rails' <code>error.full_messages.each</code></p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord", "redmine", "redmine-plugins"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498067709, "post_id": 44682159, "comment_id": 76350233, "body": "This line <code>RbProjectSettings.first(:conditions =&gt; [&quot;project_id = ?&quot;, self.id])</code> can just be <code>RbProjectSettings.where(project_id: self.id).first</code> not sure if that solves all your problems as this is a long question and includes, what is in my opinion, some very ugly code"}, {"owner": {"reputation": 228, "user_id": 2703818, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/897dfc41f9737525e2f36648017b56a4?s=128&d=identicon&r=PG&f=1", "display_name": "taifwa", "link": "https://stackoverflow.com/users/2703818/taifwa"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498121000, "post_id": 44682159, "comment_id": 76371903, "body": "That got rid of the warning - but the relation is not fixed (crux of the issue) so I still have the SQL error ...."}], "answers": [{"tags": [], "owner": {"reputation": 228, "user_id": 2703818, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/897dfc41f9737525e2f36648017b56a4?s=128&d=identicon&r=PG&f=1", "display_name": "taifwa", "link": "https://stackoverflow.com/users/2703818/taifwa"}, "is_accepted": false, "score": 0, "last_activity_date": 1498130476, "creation_date": 1498130476, "answer_id": 44697928, "question_id": 44682159, "link": "https://stackoverflow.com/questions/44682159/rails-activerecord-query-does-not-use-all-required-relations-in-from/44697928#44697928", "title": "Rails ActiveRecord query does not use all required relations in `FROM`", "body": "<p>This issue was very application specific; I post the actual solution here as I managed to track down someone else who has been maintaining this plugin.</p>\n\n<p>The relationship has to be explicitly state in a <code>joins()</code> method call, on to which the rest gets tacked.</p>\n\n<p>That is, stating a relationship <strong>does not</strong> have any sway on this query, as it is a direct query on the <code>Projects</code> object.</p>\n\n<pre><code>    Project.visible.joins('LEFT OUTER JOIN releases ON releases.project_id = projects.id').\n      includes(:releases).\n      where(\"#{RbRelease.table_name}.id = #{id}\" +\n...\n</code></pre>\n"}], "owner": {"reputation": 228, "user_id": 2703818, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/897dfc41f9737525e2f36648017b56a4?s=128&d=identicon&r=PG&f=1", "display_name": "taifwa", "link": "https://stackoverflow.com/users/2703818/taifwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498130476, "creation_date": 1498064529, "last_edit_date": 1498121635, "question_id": 44682159, "link": "https://stackoverflow.com/questions/44682159/rails-activerecord-query-does-not-use-all-required-relations-in-from", "title": "Rails ActiveRecord query does not use all required relations in `FROM`", "body": "<p>I'm trying to maintain/fix an outdated plugin (<a href=\"https://github.com/AlexDAlexeev/redmine_backlogs/\" rel=\"nofollow noreferrer\">redmine_backlogs</a>) in Redmine for my company's productivity workflow; I am not even remotely conversant in the subtleties of Ruby (let alone Rails), but by virtue of having glanced at the code, I am the company guru on the matter... so.</p>\n\n<p>Upfront clarity: <em>I'm looking for help on troubleshooting Ruby on Rails code</em> - namely:</p>\n\n<blockquote>\n  <p>The application I am debugging is doing something like</p>\n  \n  <p><code>SELECT COUNT(*) FROM tableA WHERE tableB.id = ? ...</code></p>\n  \n  <p>whereas I am expecting of course</p>\n  \n  <p><code>SELECT COUNT(*) FROM tableA,tableB WHERE tableB.id = ? ...</code></p>\n</blockquote>\n\n<p>The log reads as follows:</p>\n\n<pre><code>ActiveRecord::StatementInvalid (Mysql2::Error: Unknown column 'releases.id' in 'where clause': SELECT COUNT(*) FROM `projects` WHERE (projects.status &lt;&gt; 9) AND (releases.id = 10 OR (projects.status &lt;&gt; 9 AND ( 'system' = 'none'  OR (projects.lft &gt;= 91 AND projects.rgt &lt;= 92 AND 'none' = 'tree') OR (projects.lft &gt; 91 AND projects.rgt &lt; 92 AND 'none' IN ('hierarchy', 'descendants')) OR (projects.lft &lt; 91 AND projects.rgt &gt; 92 AND 'none' = 'hierarchy'))))):\n  plugins/redmine_backlogs/app/controllers/rb_master_backlogs_controller.rb:43:in `_menu_new'\n  plugins/redmine_backlogs/app/controllers/rb_master_backlogs_controller.rb:62:in `menu'\n  lib/redmine/sudo_mode.rb:63:in `sudo_mode'\n</code></pre>\n\n<p>The active record item comes from this section of code in <code>plugins/redmine_backlogs/app/controllers/rb_master_backlogs_controller.rb</code></p>\n\n<pre><code>...\n      elsif @release #menu for release\n        projects = @release.shared_to_projects(@project)\n\n      else #menu for product backlog\n        projects = @project.projects_in_shared_product_backlog\n\n      end\n      #make the submenu or single link\n      if !projects.empty?                          # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; ----------------------- Line 43 &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n        if projects.length &gt; 1\n          links &lt;&lt; {:label =&gt; l(label_new), :url =&gt; '#', :sub =&gt; []}\n...\n</code></pre>\n\n<p>The <code>projects</code> object being tested for emptiness is generated by the call to <code>@release.shared_to_project</code> which is defined in <code>./app/models/rb_release.rb</code>, whose relevant sections are:</p>\n\n<pre><code>class RbRelease &lt; ActiveRecord::Base\n...\n  unloadable\n\n  belongs_to :project, :inverse_of =&gt; :releases        # &lt;&lt;&lt;&lt;&lt;&lt;&lt;---- Is this where the association is being asserted ?\n  has_many :issues, :class_name =&gt; 'RbStory', :foreign_key =&gt; 'release_id', :dependent =&gt; :nullify\n  has_many :rb_release_burnchart_day_cache, :dependent =&gt; :delete_all, :foreign_key =&gt; 'release_id'\n\n  validates_presence_of :project_id, :name, :release_start_date, :release_end_date       # &lt;&lt;&lt;&lt;------- or here ....?\n  validates_inclusion_of :status, :in =&gt; RELEASE_STATUSES\n  validates_inclusion_of :sharing, :in =&gt; RELEASE_SHARINGS\n\n...\n\n  def shared_to_projects(scope_project)\n    @shared_projects ||=\n      begin\n    # Project used when fetching tree sharing\n    r = self.project.root? ? self.project : self.project.root\n    # Project used for other sharings\n    p = self.project\n    Project.visible.scoped(:include =&gt; :releases,\n      :conditions =&gt; [\"#{RbRelease.table_name}.id = #{id}\" +\n      \" OR (#{Project.table_name}.status &lt;&gt; #{Project::STATUS_ARCHIVED} AND (\" +\n      \" 'system' = ? \" +\n      \" OR (#{Project.table_name}.lft &gt;= #{r.lft} AND\n...\n</code></pre>\n\n<p>So evidently we're relying on something from the main <code>Project</code> object to do something with the templated query - checking <code>../../app/models/project.rb</code> I reach a dead end as to what to check for next... The <code>RbRelease</code> has declared its association with <code>Project</code>, but still the query does not seem to include that in the <code>FROM</code> clause before stating its conditions.</p>\n\n<p>My naive question is: <strong>how would I fix the relationship association so that the SQL query is correctly built ?</strong></p>\n\n<p><code>==============</code></p>\n\n<p><em>(previously there was also this issue as part of the question, but it turned out to be unrelated)</em></p>\n\n<pre><code>Started GET \"/redmine/rb/master_backlog/afcd123_ghg/menu?project_id=9&amp;authenticity_token=&lt;REDACTED&gt;\" for 10.0.3.1 at 2017-06-21 15:21:36 +0000\nProcessing by RbMasterBacklogsController#menu as JSON\n  Parameters: {\"project_id\"=&gt;\"afcd123_ghg\", \"authenticity_token\"=&gt;\"&lt;REDACTED&gt;\"}\n  Current user: tai (id=125)\nDEPRECATION WARNING: Relation#first with finder options is deprecated. Please build a scope and then call #first on it instead. (called from rb_project_settings at /usr/share/redmine/plugins/redmine_backlogs/lib/backlogs_project_patch.rb:193)\nCompleted 200 OK in 16ms (Views: 0.6ms | ActiveRecord: 7.0ms)\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "capybara"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498069430, "post_id": 44682108, "comment_id": 76351190, "body": "Since this is essentially a Cross Site request based on your design and you confirmed curl works why not use a HTTP library for your testing?"}], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1498065201, "last_edit_date": 1498065201, "creation_date": 1498064770, "answer_id": 44682225, "question_id": 44682108, "link": "https://stackoverflow.com/questions/44682108/how-can-i-verify-the-full-url-that-my-rspec-capybara-test-visits/44682225#44682225", "title": "How can I verify the full url that my Rspec/Capybara test visits?", "body": "<p>Assuming you're using one of the JS capable Capybara drivers (selenium, poltergeist, capybara-webkit), and have set <code>Capybara.run_server = false</code> since you're testing an app launched elsewhere,  <code>visit '/'</code> would attempt to connect to \"#{Capybara.app_host}/\", so whatever you've set <code>Capybara.app_host</code> to would be where it connects.</p>\n\n<p>Note: if you're using the racktest driver there is no support for connecting to remote apps at all, and any domain name specified is completely ignored.</p>\n"}, {"tags": [], "owner": {"reputation": 2080, "user_id": 1033737, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iJ3qS.jpg?s=128&g=1", "display_name": "thefabbulus", "link": "https://stackoverflow.com/users/1033737/thefabbulus"}, "is_accepted": false, "score": 0, "last_activity_date": 1498120635, "creation_date": 1498120635, "answer_id": 44694291, "question_id": 44682108, "link": "https://stackoverflow.com/questions/44682108/how-can-i-verify-the-full-url-that-my-rspec-capybara-test-visits/44694291#44694291", "title": "How can I verify the full url that my Rspec/Capybara test visits?", "body": "<pre><code>RSpec.feature 'user visits homepage', type: :feature do\n scenario 'default' do\n  visit '/'\n  puts current_url\n  expect(page).to have_content('test content')\n end\nend\n</code></pre>\n"}], "owner": {"reputation": 2236, "user_id": 25999, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/32dc9f0968419b360b50cc3d2a4f0e67?s=128&d=identicon&r=PG&f=1", "display_name": "kidbrax", "link": "https://stackoverflow.com/users/25999/kidbrax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1027, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1498120635, "creation_date": 1498064370, "question_id": 44682108, "link": "https://stackoverflow.com/questions/44682108/how-can-i-verify-the-full-url-that-my-rspec-capybara-test-visits", "title": "How can I verify the full url that my Rspec/Capybara test visits?", "body": "<p>I am trying to use Rspec/Capybara to test a non-ruby app.  The app runs in a docker container and the rspec process runs in another container.  When I shell into the rspec container, I can curl the app container without a problem.  But when I run rspec to test the app, it can't connect.  The first thing I want to do is verify the url that Rspec is calling, i.e. what it 'visits'. How can I verify this url</p>\n\n<pre><code>RSpec.feature 'user visits homepage', type: :feature do\n  scenario 'default' do\n    visit '/' # &lt;- how can i print out what url this points to?\n    expect(page).to have_content('test content')\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "string", "padding"], "answers": [{"tags": [], "owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "is_accepted": true, "score": 3, "last_activity_date": 1498064082, "creation_date": 1498064082, "answer_id": 44682021, "question_id": 44681951, "link": "https://stackoverflow.com/questions/44681951/how-do-i-add-spaces-to-the-end-of-my-string/44682021#44682021", "title": "How do I add spaces to the end of my string?", "body": "<p>The integer to <code>ljust()</code> must be larger than the length of the string, or nothing will be appended. Since <code>line</code> is six chars, I believe you want:</p>\n\n<pre><code>line = \"abcdef\"\nline = line.ljust(10, \" \")\n</code></pre>\n\n<p>That'll add four spaces after the six characters already present in the string.</p>\n\n<p>You could likely also do something along the lines of:</p>\n\n<pre><code>line = line.ljust(line.length + 4, \" \")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 1, "last_activity_date": 1498064423, "creation_date": 1498064423, "answer_id": 44682124, "question_id": 44681951, "link": "https://stackoverflow.com/questions/44681951/how-do-i-add-spaces-to-the-end-of-my-string/44682124#44682124", "title": "How do I add spaces to the end of my string?", "body": "<p>You can add a multiple of a spaces:</p>\n\n<pre><code>line = \"abcdef\"\nline + ' '*5\n #=&gt; \"abcdef     \"\nline\n #=&gt; \"abcdef\"\n</code></pre>\n\n<p>Or use <code>concat</code> which modifies the string.</p>\n\n<pre><code>line.concat(' '*5) \n #=&gt; \"abcdef     \"\nline\n #=&gt; \"abcdef     \"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "closed_date": 1498065497, "accepted_answer_id": 44682021, "answer_count": 2, "score": 0, "last_activity_date": 1498064423, "creation_date": 1498063842, "question_id": 44681951, "link": "https://stackoverflow.com/questions/44681951/how-do-i-add-spaces-to-the-end-of-my-string", "closed_reason": "Duplicate", "title": "How do I add spaces to the end of my string?", "body": "<p>I'm using Ruby 2.4.  HOw do I add an arbitrary amount of spaces to the end of my string?  I thought it was ljust but</p>\n\n<pre><code>2.4.0 :003 &gt; line = \"abcdef\"\n =&gt; \"abcdef\"\n2.4.0 :004 &gt; line = line.ljust(4, \" \")\n =&gt; \"abcdef\"\n</code></pre>\n\n<p>Notice my string is unchanged.  What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "is_accepted": false, "score": 0, "last_activity_date": 1498064224, "creation_date": 1498064224, "answer_id": 44682055, "question_id": 44681937, "link": "https://stackoverflow.com/questions/44681937/merge-a-hash-inside-array/44682055#44682055", "title": "Merge a hash inside array", "body": "<p>It should be simple like this, use .merge method</p>\n\n<pre><code>def self.v_and_c items\n result = []\n items.try(:each) do |item|\n  result &lt;&lt; item\n  if item.is_parent_variation\n    check_ancestor item\n    result = result.merge { :item_variation =&gt; @variations }\n    result = result.merge { :options =&gt; @options }\n   elsif item.is_parent_customization\n    check_ancestor item\n    result = result.merge { :customizations =&gt; @customizations }\n    result = result.merge { :ingredients =&gt; @ingredients }\n   end\n end\n result\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 369, "user_id": 3462608, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hEWcA.jpg?s=128&g=1", "display_name": "Ravindra Yadav", "link": "https://stackoverflow.com/users/3462608/ravindra-yadav"}, "edited": false, "score": 0, "creation_date": 1498067664, "post_id": 44682424, "comment_id": 76350207, "body": "thanks for your quick reply and actually some times check_ancestor function not calling as per the condition so I called twice."}, {"owner": {"reputation": 369, "user_id": 3462608, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hEWcA.jpg?s=128&g=1", "display_name": "Ravindra Yadav", "link": "https://stackoverflow.com/users/3462608/ravindra-yadav"}, "edited": false, "score": 0, "creation_date": 1498067852, "post_id": 44682424, "comment_id": 76350306, "body": "item_hash = {}.merge(item) --&gt; this is creating error so I have changed it to item_hash = {}.merge(item: item) then it runs otherwise throw error that no implicit conversion of Item into Hash."}, {"owner": {"reputation": 390, "user_id": 6534673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-QmfABmsbHTI/AAAAAAAAAAI/AAAAAAAARhk/1rApEK4Fvdo/photo.jpg?sz=128", "display_name": "Jyoti Dhiman", "link": "https://stackoverflow.com/users/6534673/jyoti-dhiman"}, "reply_to_user": {"reputation": 369, "user_id": 3462608, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hEWcA.jpg?s=128&g=1", "display_name": "Ravindra Yadav", "link": "https://stackoverflow.com/users/3462608/ravindra-yadav"}, "edited": false, "score": 0, "creation_date": 1498109771, "post_id": 44682424, "comment_id": 76365166, "body": "I assumed item to be a hash. My bad."}], "tags": [], "owner": {"reputation": 390, "user_id": 6534673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-QmfABmsbHTI/AAAAAAAAAAI/AAAAAAAARhk/1rApEK4Fvdo/photo.jpg?sz=128", "display_name": "Jyoti Dhiman", "link": "https://stackoverflow.com/users/6534673/jyoti-dhiman"}, "is_accepted": true, "score": 0, "last_activity_date": 1498065812, "last_edit_date": 1498065812, "creation_date": 1498065487, "answer_id": 44682424, "question_id": 44681937, "link": "https://stackoverflow.com/questions/44681937/merge-a-hash-inside-array/44682424#44682424", "title": "Merge a hash inside array", "body": "<p>You could try something like this:</p>\n\n<pre><code>def self.v_and_c items\n result = []\n items.try(:each) do |item|\n  item_hash = {}.merge(item)\n  if item.is_parent_variation\n    check_ancestor item\n    item_hash.merge!({ item_variation: @variations }).merge!({ options: @options})\n  elsif item.is_parent_customization\n    check_ancestor item\n    item_hash.merge!({ customizations: @customizations }).merge!({ ingredients: @ingredients})\n  end\n   result.push(item_hash)\n end\n result\nend\n</code></pre>\n\n<p><strong>Explanation:</strong>\nFor each iteration of loop, create an item_hash and merge all the requisite hashes in it and then push the resulting hash into the result array.</p>\n\n<p><strong>Few pointers:</strong></p>\n\n<ul>\n<li>Take care of new Ruby hash syntax </li>\n<li>If check ancestor is needed in both if and else why not do it outside?</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3106523, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f5e865631c96ee9caef5d5d120a094d1?s=128&d=identicon&r=PG&f=1", "display_name": "Minu", "link": "https://stackoverflow.com/users/3106523/minu"}, "is_accepted": false, "score": 0, "last_activity_date": 1498068101, "creation_date": 1498068101, "answer_id": 44683175, "question_id": 44681937, "link": "https://stackoverflow.com/questions/44681937/merge-a-hash-inside-array/44683175#44683175", "title": "Merge a hash inside array", "body": "<pre><code>def self.v_and_c items\n  [].tap do |result|\n  items.try(:each) do |item|\n    result_hash = item.dup\n    if item.is_parent_variation\n      check_ancestor item\n      result_hash.merge!({ item_variation: @variations, options: @options })\n    elsif item.is_parent_customization\n      check_ancestor item\n      result_hash.merge!({ customizations: @customizations, ingredients: @ingredients })\n    end\n    result &lt;&lt; result_hash\n  end\nend\n</code></pre>\n\n<p>end</p>\n"}], "owner": {"reputation": 369, "user_id": 3462608, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hEWcA.jpg?s=128&g=1", "display_name": "Ravindra Yadav", "link": "https://stackoverflow.com/users/3462608/ravindra-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 44682424, "answer_count": 3, "score": 0, "last_activity_date": 1498068101, "creation_date": 1498063811, "last_edit_date": 1498064019, "question_id": 44681937, "link": "https://stackoverflow.com/questions/44681937/merge-a-hash-inside-array", "title": "Merge a hash inside array", "body": "<p>I am new to Ruby and Rails, I have stuck in a situation that I need to create an array of hashes. Please see below the code:</p>\n\n<pre><code>def self.v_and_c items\n result = []\n items.try(:each) do |item|\n  result &lt;&lt; item\n  if item.is_parent_variation\n    check_ancestor item\n    result &lt;&lt; { :item_variation =&gt; @variations }\n    result &lt;&lt; { :options =&gt; @options }\n   elsif item.is_parent_customization\n    check_ancestor item\n    result &lt;&lt; { :customizations =&gt; @customizations }\n    result &lt;&lt; { :ingredients =&gt; @ingredients }\n   end\n end\n result\nend\n</code></pre>\n\n<p>Here is the output of the function:</p>\n\n<pre><code>{\"items\":[{\"id\":1,\"name\":\"Cake\"},{\"item_variation\":null},{\"options\":null}]}\n</code></pre>\n\n<p>But I wanted to do like this.</p>\n\n<pre><code>{\"items\":[{\"id\":1,\"name\":\"Cake\",\"item_variation\":null, \"options\":null} ]}\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498116812, "post_id": 44684899, "comment_id": 76369021, "body": "Wow, you&#39;re great. Thank you very much. I need time to test it but I am sure you test it and it will work. Amazing!!!"}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498117043, "post_id": 44684899, "comment_id": 76369198, "body": "Can I ask you a question? I have projects already built that have Gemfile.lock. My understanding is that while Gemfile list the dependencies required (so even something like version&gt;x.y) the Gemfile.lock contains the real dependencies used (the whole dependencies tree). Now suppose I have only source code of a project, how I can determine dependencies? Should I look at Gemfile or .gemspec? I know in this case I cannot know which dependencies will be used because it depends on when it will be build, but for dependencies that do not specify the exact version is ok for me to have the latest one."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 1, "creation_date": 1498137259, "post_id": 44684899, "comment_id": 76383742, "body": "@SalvatoreD&#39;angelo determining the dependencies from pure source would be much more difficult. If you have a Gemfile or a gemspec it should be reasonable. If is truly just pure source code that &quot;requires&quot; certain dependencies then you would have to keep track of things like <code>$LOAD_PATH</code> and determine if the items added are <code>gems</code> and then leverage that for a dependency list. Additionally you would have to ensure that you can visit every file in the code base to make sure every single dependency has been loaded. I am sure this is possible but far more tedious than I intend to tackle."}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498137564, "post_id": 44684899, "comment_id": 76383969, "body": "I am trying your code: Update 2, but I got the following error: <code>&lt;main&gt;&#39;: undefined method </code>each_with_object&#39; for #&lt;Bundler::Definition:0x00000001844058&gt; (NoMethodError)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498137889, "post_id": 44684899, "comment_id": 76384236, "body": "Are you missing the dependencies part? <code>dependencies.each_with_object(Hash.new { |h,k| h[k] = [] })</code>? There is a trailing dot (<code>.</code>) on the first line which will cause the second line to be chained to it I just posted in this manner to keep it compact"}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498138725, "post_id": 44684899, "comment_id": 76384882, "body": "Got the following error: usr/local/lib/site_ruby/1.9.1/rubygems/dependency.rb:315:in `to_specs&#39;: Could not find &#39;cf-message-bus&#39; (&gt;= 0)"}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498138807, "post_id": 44684899, "comment_id": 76384958, "body": "It seems code requuest have already been downloaded. Am I correct? What I can do to solve it?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498138927, "post_id": 44684899, "comment_id": 76385066, "body": "@SalvatoreD&#39;angelo you will have to install the bundle for it to find the dependencies (apparently it tries to load them). You could try passing <code>true</code> as the third argument to <code>Bundler::Definition</code> although this will force updating it seems (not 100% sure)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498139546, "post_id": 44684899, "comment_id": 76385588, "body": "@SalvatoreD&#39;angelo you could also trap this and tag it as a missing dependency which might make the most sense in this case"}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498140038, "post_id": 44684899, "comment_id": 76385998, "body": "I cannot make this code working. Sorry. Going back to my code, my main problem is that I am unable to understand the LockfileParser structure, if there is a way to understand if a dependency is in the test/development group."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498140604, "post_id": 44684899, "comment_id": 76386456, "body": "@SalvatoreD&#39;angelo I will try and come up with something more suitable but there is no way to determine the dependency group strictly from the lock file"}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498140879, "post_id": 44684899, "comment_id": 76386678, "body": "The problem I have is only on two gems on my vendor/cache. They are the following:   gem &quot;cf-message-bus&quot;, git: &quot;<a href=\"https://github.com/cloudfoundry/cf-message-bus.git\" rel=\"nofollow noreferrer\">github.com/cloudfoundry/cf-message-bus.git</a>&quot; gem &quot;vcap_common&quot;, git: &quot;<a href=\"https://github.com/cloudfoundry/vcap-common.git\" rel=\"nofollow noreferrer\">github.com/cloudfoundry/vcap-common.git</a>&quot;  in my vendor/cache folder they are managed as folder and not as .gem file:  cf-message-bus-b48eeb4357bd vcap-common-4ad156de3fcb  I do not know if this could be the issue"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498158246, "post_id": 44684899, "comment_id": 76397783, "body": "@SalvatoreD&#39;angelo I have posted a new answer (could probably be cleaned up more) I think this is the desired result"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1498079153, "last_edit_date": 1498079153, "creation_date": 1498073816, "answer_id": 44684899, "question_id": 44681231, "link": "https://stackoverflow.com/questions/44681231/how-to-list-ruby-production-only-dependencies-using-gemfile-lock-and-lockfilepar/44684899#44684899", "title": "How to list ruby production only dependencies using Gemfile.lock and LockfileParser class", "body": "<p>How about this </p>\n\n<pre><code>require 'bundler'\n\ndependencies = Bundler::Definition.build('Gemfile','Gemfile.lock',nil).\n     dependencies.each_with_object(Hash.new { |h,k| h[k] = [] }) do |dep,obj| \n       dep.groups.each do |g|\n         obj[g] &lt;&lt; {name: dep.name,\n          required_version: dep.requirement.requirements.join,\n          actual_version: dep.to_spec.version.to_s\n          }\n       end\nend\n</code></pre>\n\n<p>This will group all the dependencies by their group and place them in <code>Hash</code>es containing their name, their required version and their specific version. For example:  </p>\n\n<pre><code>{:default=&gt;\n  [{:name=&gt;\"rake\", :required_version=&gt;\"=11.3.0\", :actual_version=&gt;\"11.3.0\"},\n   {:name=&gt;\"rails\", :required_version=&gt;\"=4.2.5.2\", :actual_version=&gt;\"4.2.5.2\"},\n   {:name=&gt;\"arel\", :required_version=&gt;\"=6.0.3\", :actual_version=&gt;\"6.0.3\"},\n   {:name=&gt;\"activerecord\",\n    :required_version=&gt;\"~&gt;4.2.0\",\n    :actual_version=&gt;\"4.2.8\"},\n   {:name=&gt;\"activerecord-sqlserver-adapter\",\n    :required_version=&gt;\"~&gt;4.2.0\",\n    :actual_version=&gt;\"4.2.18\"},\n   {:name=&gt;\"tiny_tds\", :required_version=&gt;\"~&gt;0.7.0\", :actual_version=&gt;\"0.7.0\"}],\n :doc=&gt;\n  [{:name=&gt;\"sdoc\", :required_version=&gt;\"~&gt;0.4.0\", :actual_version=&gt;\"0.4.2\"}],\n :development=&gt;\n  [{:name=&gt;\"byebug\", :required_version=&gt;\"&gt;=0\", :actual_version=&gt;\"9.0.6\"},\n   {:name=&gt;\"web-console\",\n    :required_version=&gt;\"~&gt;2.0\",\n    :actual_version=&gt;\"2.3.0\"},\n   {:name=&gt;\"capistrano\",\n    :required_version=&gt;\"=3.7.2\",\n    :actual_version=&gt;\"3.7.2\"}],\n :test=&gt;\n  [{:name=&gt;\"byebug\", :required_version=&gt;\"&gt;=0\", :actual_version=&gt;\"9.0.6\"}]}\n</code></pre>\n\n<p>BTW <code>:default</code> is production (might need to expand further to handle dependencies of dependencies I will see what I can do)</p>\n\n<p><strong>Update 1</strong>: Similar formatting lists <code>:runtime</code> dependencies of dependencies (not uniq)</p>\n\n<pre><code>  def dep_to_hash(dep)\n    {name: dep.name,\n      required_version: dep.requirement.requirements.join,\n      actual_version: dep.to_spec.version.to_s,\n      dependencies: dep.to_spec.dependencies.select {|d| d.type == :runtime}.each_with_object(Hash.new { |h,k| h[k] = [] }) do |dep2,obj|\n        obj[dep2.type] &lt;&lt; dep_to_hash(dep2)\n      end\n      }\n  end\n\n\n  deps = Bundler::Definition.build('Gemfile','Gemfile.lock',nil).\n     dependencies.each_with_object(Hash.new { |h,k| h[k] = [] }) do |dep,obj| \n       dep.groups.each do |g|\n         obj[g] &lt;&lt; dep_to_hash(dep)\n       end\n  end\n</code></pre>\n\n<p>Output snippet: </p>\n\n<pre><code> {:default=&gt;\n  [{:name=&gt;\"rails\",\n    :required_version=&gt;\"=4.2.5.2\",\n    :actual_version=&gt;\"4.2.5.2\",\n    :dependencies=&gt;\n     {:runtime=&gt;\n       [{:name=&gt;\"activesupport\",\n         :required_version=&gt;\"=4.2.5.2\",\n         :actual_version=&gt;\"4.2.5.2\",\n         :dependencies=&gt;\n          {:runtime=&gt;\n            [{:name=&gt;\"i18n\",\n              :required_version=&gt;\"~&gt;0.7\",\n              :actual_version=&gt;\"0.8.1\",\n              :dependencies=&gt;{}},\n             {:name=&gt;\"json\",\n              :required_version=&gt;\"&gt;=1.7.7~&gt;1.7\",\n              :actual_version=&gt;\"1.8.6\",\n              :dependencies=&gt;{}},\n</code></pre>\n\n<p><strong>Update 2</strong> (More like what you seem to be targeting now and is uniq by \"group\") </p>\n\n<pre><code>    require 'bundler'\n    def add_to_dep(dep,top_level)\n      deps = dep.to_spec.dependencies.select {|d| d.type == :runtime}\n      deps.each do |dep|\n        add_to_dep(dep,top_level) \n      end\n      # handle existing dependencies by using highest version\n      exists = top_level.grep(/#{dep.name}/)[0]\n      if exists\n        version = exists.split(',').last\n        new_version = dep.to_spec.version.to_s\n        if new_version &gt; version\n          top_level.delete_at(top_level.index(exists))\n          top_level &lt;&lt; \"#{dep.name}, #{dep.to_spec.version}\" \n        end\n      else\n        top_level &lt;&lt; \"#{dep.name}, #{dep.to_spec.version}\"\n      end  \n    end\n\n\n    deps = Bundler::Definition.build('Gemfile','Gemfile.lock',nil).\n       dependencies.each_with_object(Hash.new { |h,k| h[k] = [] }) do |dep,obj| \n         dep.groups.each do |g|\n           add_to_dep(dep,obj[g])\n         end\n    end.each {|_k,v| v.sort!}\n</code></pre>\n\n<p>Output Snippet:</p>\n\n<pre><code>{:default=&gt;\n  [\"actionmailer, 4.2.5.2\",\n   \"actionpack, 4.2.8\",\n   \"actionview, 4.2.8\",\n   \"activejob, 4.2.5.2\",\n   \"activemodel, 4.2.8\",\n   \"activerecord, 4.2.8\",\n   \"activerecord-sqlserver-adapter, 4.2.18\",\n   \"activesupport, 4.2.8\",\n   \"arel, 6.0.4\",\n   \"axlsx, 2.0.1\",\n   \"builder, 3.2.3\",\n   \"bundler, 1.14.6\",\n   \"coffee-rails, 4.1.1\",\n   \"coffee-script, 2.4.1\",\n   \"coffee-script-source, 1.12.2\",\n   \"concurrent-ruby, 1.0.5\",\n   \"erubis, 2.7.0\",\n   \"execjs, 2.7.0\",\n   \"globalid, 0.4.0\",\n   \"hash-deep-merge, 0.1.1\",\n   \"htmlentities, 4.3.4\",\n   \"i18n, 0.8.1\",\n   \"jbuilder, 2.6.2\",\n   \"jquery-rails, 4.2.2\",\n   \"jquery-ui-rails, 6.0.1\",\n   \"json, 1.8.6\",\n   \"lazy_high_charts, 1.5.6\",\n   \"loofah, 2.0.3\",\n   \"mail, 2.6.5\",\n   \"mime-types, 3.1\",\n   \"mime-types-data, 3.2016.0521\",\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498558234, "post_id": 44707459, "comment_id": 76535622, "body": "Thanks for reply. I really appreciate it. locked_gems method is undefined for definition in   def lock_file     @definition.locked_gems end  How I can address this?  Moreover, I have the impression that I need to have required .gem file installed somewhere.  Currently I have them in &lt;myproject&gt;/vendor/cache. How I can make my code find them?"}, {"owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "edited": false, "score": 0, "creation_date": 1498560752, "post_id": 44707459, "comment_id": 76537376, "body": "Ok Solved. I just replaced it with: lockfile_contents = File.read(&#39;Gemfile.lock&#39;)     Bundler::LockfileParser.new(lockfile_contents)"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1498158207, "creation_date": 1498158207, "answer_id": 44707459, "question_id": 44681231, "link": "https://stackoverflow.com/questions/44681231/how-to-list-ruby-production-only-dependencies-using-gemfile-lock-and-lockfilepar/44707459#44707459", "title": "How to list ruby production only dependencies using Gemfile.lock and LockfileParser class", "body": "<p>I will leave my other answer in case it helps someone else: Here is the revised version based on what I think you want </p>\n\n<pre><code>require 'bundler'\n\nclass DependencyTree\n  attr_reader :definition\n  def initialize(gemfile,lockfile)\n    @gemfile = gemfile\n    @definition = Bundler::Definition.build(gemfile,lockfile,nil)\n  end\n\n  def all_dependencies\n    return @all_dependencies if @all_dependencies\n    collect_dependencies\n  end\n\n  def inspect\n    \"#&lt;#{self.class.name}:#{self.object_id} Gemfile: #{Pathname.new(@gemfile).expand_path} &gt;\"\n  end\n\n  def lock_file\n    @definition.locked_gems\n  end\n\n  def to_h\n    lock_file.specs.each_with_object(Hash.new {|h,k| h[k] = []}) do |lock,obj|\n      gem_file_dep = all_dependencies.detect {|dep| dep[:name] == lock.name} || {group: :unknown}\n      name = lock.full_name.dup\n      name &lt;&lt; \" (#{gem_file_dep[:error]})\" if gem_file_dep[:error]\n      obj[gem_file_dep[:group]] &lt;&lt; name                    \n    end\n  end\n\n  private \n    def groupify(dep)\n      dep.groups.map do |g| \n        a = [{group: g, name: dep.name}] \n        begin\n          a &lt;&lt; runtime_dependencies(g,dep.to_spec)\n        rescue Gem::LoadError =&gt; e\n          a[-1] =  {group: g, name: dep.name,error: 'NOT INSTALLED'}\n        end\n      end\n    end\n    def collect_dependencies\n      @all_dependencies = @definition.dependencies.map do |dep|\n          groupify(dep)\n      end.flatten\n      group_missing\n      @all_dependencies.uniq!\n    end\n    def runtime_dependencies(group,spec)\n      spec.dependencies.select { |dep| dep.type == :runtime}.map do |dep|\n          a = {group: group, name: dep.name}\n          dep.to_spec.dependencies.empty? ? a : [a] &lt;&lt; runtime_dependencies(group,dep.to_spec)\n      end\n    end\n    def group_missing\n      all_locks.cycle(2) do |a|\n        deep_dep = @all_dependencies.find_all {|h| a.include?(h[:name])}.uniq\n        a.each do |k|\n          deep_dep.each do |h|\n            all_dependencies &lt;&lt; {group: h[:group], name: k, error: 'NOT INSTALLED'}\n          end\n        end\n      end\n    end\n    def all_locks\n      lock_file.specs.map do |spec|\n        spec.to_lock.delete(' ').split(\"\\n\").map do |s| \n          s.slice(/^[\\w\\-]+/)\n        end\n      end\n    end\nend  \n</code></pre>\n\n<p>the usage is:</p>\n\n<pre><code> dt = DependencyTree.new('Gemfile','Gemfile.lock') \n dt.to_h\n</code></pre>\n\n<p>output Snippet: </p>\n\n<pre><code>{:default=&gt;\n  [\"actionmailer-4.2.5.2 (NOT INSTALLED)\",\n   \"actionpack-4.2.5.2\",\n   \"actionview-4.2.5.2\",\n   \"activejob-4.2.5.2 (NOT INSTALLED)\",\n   \"activemodel-4.2.5.2\",\n   \"activerecord-4.2.5.2\",\n   \"activerecord-sqlserver-adapter-4.2.17\",\n   \"activesupport-4.2.5.2\",\n   \"arel-6.0.3 (NOT INSTALLED)\",\n   \"axlsx-2.0.1 (NOT INSTALLED)\",\n   \"binding_of_caller-0.7.2 (NOT INSTALLED)\",\n   \"builder-3.2.3\",\n   \"coffee-rails-4.1.1 (NOT INSTALLED)\",\n   \"coffee-script-2.4.1 (NOT INSTALLED)\",\n   \"coffee-script-source-1.12.2 (NOT INSTALLED)\",\n   \"concurrent-ruby-1.0.4\",\n   \"debug_inspector-0.0.2 (NOT INSTALLED)\",\n   \"erubis-2.7.0\",\n   \"execjs-2.7.0\"],\n:development=&gt;\n  [\"airbrussh-1.1.2\",\n   \"byebug-9.0.6 (NOT INSTALLED)\",\n   \"capistrano-3.7.2\"],\n:doc =&gt; [\"sdoc-0.4.2 (NOT INSTALLED)\"]}\n</code></pre>\n\n<p>production gems will be in <code>:default</code> development gems would be <code>:default</code> + <code>:development</code></p>\n"}], "owner": {"reputation": 473, "user_id": 6286900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/20NnH.jpg?s=128&g=1", "display_name": "Salvatore D&#39;angelo", "link": "https://stackoverflow.com/users/6286900/salvatore-dangelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 44707459, "answer_count": 2, "score": 0, "last_activity_date": 1498158207, "creation_date": 1498061381, "question_id": 44681231, "link": "https://stackoverflow.com/questions/44681231/how-to-list-ruby-production-only-dependencies-using-gemfile-lock-and-lockfilepar", "title": "How to list ruby production only dependencies using Gemfile.lock and LockfileParser class", "body": "<p>I have a tool that analyze some ruby projects having Gemfile and Gemfile.lock files. This tool given in input the path where ruby project is, list all its dependencies.</p>\n\n<p>My problem is that I only need to print production dependencies excluding development and test. Today I find out that my code does not exclude them and I do not know how to modify it for my purpose. <strong>How I can remove development and test dependencies from the list?</strong></p>\n\n<p>Here a simplified version of the ruby code I use to list dependencies:</p>\n\n<pre><code>project_path = ARGV.map {|path| File.expand_path(path) }\n\nENV['BUNDLE_GEMFILE'] = project_path+\"/Gemfile\"\n\nlockfile_path=project_path+\"/Gemfile.lock\"\n\nlockfile_contents = File.read(lockfile_path)\nparser = Bundler::LockfileParser.new(lockfile_contents)\n\nlockfile_contents = File.read(lockfile_path)\nparser = Bundler::LockfileParser.new(lockfile_contents)\n\nto_fetch = []\nparser.specs.each do |spec|\n    gem_basename = \"#{spec.name},#{spec.version}\"\n    to_fetch &lt;&lt; gem_basename\nend\n\nto_fetch.uniq!\nto_fetch.sort!\n</code></pre>\n\n<p>The variable to_fetch contains the dependencies.</p>\n\n<p>Here the Gemfile:</p>\n\n<pre><code>source \"https://rubygems.org\"\n\ngem \"cf-message-bus\", git: \"https://github.com/cloudfoundry/cf-message-bus.git\"\ngem \"vcap_common\", git: \"https://github.com/cloudfoundry/vcap-common.git\"\ngem \"aws-sdk\", '~&gt; 2', require: false\ngem \"steno\"\ngem \"httparty\"\n\ngroup :test do\n    gem 'codeclimate-test-reporter', require: false\n    gem \"rake\"\n    gem \"rspec\"\n    gem \"ci_reporter\"\n    gem \"timecop\"\n    gem \"webmock\"\nend\n</code></pre>\n\n<p>Let me know if you need also the Gemfile.lock that is 149 lines long.</p>\n"}, {"tags": ["ios", "ruby", "amazon-ec2", "sinatra", "spotify"], "answers": [{"tags": [], "owner": {"reputation": 436, "user_id": 3265888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ad76bb1e69ffbab6dfecb2d61b2aad?s=128&d=identicon&r=PG&f=1", "display_name": "York Yang", "link": "https://stackoverflow.com/users/3265888/york-yang"}, "is_accepted": true, "score": 0, "last_activity_date": 1498069280, "creation_date": 1498069280, "answer_id": 44683502, "question_id": 44680990, "link": "https://stackoverflow.com/questions/44680990/how-safe-is-it-to-use-an-ip-for-running-a-sinatra-ruby-app-for-an-ios-applicatio/44683502#44683502", "title": "How safe is it to use an ip for running a Sinatra ruby app for an iOS application", "body": "<p>HTTPS is only available for domain names. Not available for IP. If you only use IP, then you are exposed to MITM attack and all your data is plain text flying around. Anyone can eavesdrop your request. You have a code parameter in the swap request and I guess is code is credential correct? If yes, it's better to grab some domain name and set it up using aws route53. Then buy some cheap SSL certificate to associate it with the domain. Then on the iOS side, enable HTTPS instead of HTTP to communicate with your server. This has nothing to do with your Sinatra app.  </p>\n\n<p>To know more about SSL/HTTPS, you can take a look at some beginner tutorials like this: <a href=\"http://www.hongkiat.com/blog/ssl-certs-guide/\" rel=\"nofollow noreferrer\">http://www.hongkiat.com/blog/ssl-certs-guide/</a></p>\n"}], "owner": {"reputation": 57, "user_id": 8195097, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5293eb7818baf901d1e2a6c4e12d2699?s=128&d=identicon&r=PG&f=1", "display_name": "JohnA", "link": "https://stackoverflow.com/users/8195097/johna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 44683502, "answer_count": 1, "score": 0, "last_activity_date": 1498069280, "creation_date": 1498060670, "question_id": 44680990, "link": "https://stackoverflow.com/questions/44680990/how-safe-is-it-to-use-an-ip-for-running-a-sinatra-ruby-app-for-an-ios-applicatio", "title": "How safe is it to use an ip for running a Sinatra ruby app for an iOS application", "body": "<p>I am building an iOS app and I have an AWS ec2 instance running a Sinatra app for refreshing and swapping a Spotify SDK access token and I am wondering about any safety issues with having a url such as <code>http://#someIP:4567</code> on the application itself.</p>\n\n<p>I know with an AWS ec2 instance you can get it secured by making it a https but how can you secure an IP in the same sense(If I even need to do so)?</p>\n\n<p>Here is what is in the ruby file:</p>\n\n<pre><code>require 'sinatra'\nrequire 'net/http'\nrequire 'net/https'\nrequire 'base64'\nrequire 'encrypted_strings'\nrequire 'json'\n\nset :bind, '0.0.0.0'\n\nCLIENT_ID = ENV['TheClientIDGivenBySpotify']\nCLIENT_SECRET = ENV['TheClientSecretGivenBySpotify']\nENCRYPTION_SECRET = ENV['cFJLyifeUJUBFWdHzVbykfDmPHtLKLGzViHW9aHGmyTLD8hGXC']\nCLIENT_CALLBACK_URL = ENV['appForSpotify://returnAfterLogin']\n\nSPOTIFY_ACCOUNTS_ENDPOINT = URI.parse(\"https://accounts.spotify.com\")\n\nget '/' do\n\"Working\"    \nend\n\npost '/swap' do\n    AUTH_HEADER = \"Basic \" + Base64.strict_encode64(CLIENT_ID + \":\" + CLIENT_SECRET)\n\n    # This call takes a single POST parameter, \"code\", which\n    # it combines with your client ID, secret and callback\n    # URL to get an OAuth token from the Spotify Auth Service,\n    # which it will pass back to the caller in a JSON payload.\n\n    auth_code = params[:code]\n\n    http = Net::HTTP.new(SPOTIFY_ACCOUNTS_ENDPOINT.host, SPOTIFY_ACCOUNTS_ENDPOINT.port)\n    http.use_ssl = true\n\n    request = Net::HTTP::Post.new(\"/api/token\")\n\n    request.add_field(\"Authorization\", AUTH_HEADER)\n\n    request.form_data = {\n        \"grant_type\" =&gt; \"authorization_code\",\n        \"redirect_uri\" =&gt; CLIENT_CALLBACK_URL,\n        \"code\" =&gt; auth_code\n    }\n\n    response = http.request(request)\n\n    # encrypt the refresh token before forwarding to the client\n    if response.code.to_i == 200\n        token_data = JSON.parse(response.body)\n        refresh_token = token_data[\"refresh_token\"]\n        encrypted_token = refresh_token.encrypt(:symmetric, :password =&gt; ENCRYPTION_SECRET)\n        token_data[\"refresh_token\"] = encrypted_token\n        response.body = JSON.dump(token_data)\n    end\n\n    status response.code.to_i\n    return response.body\nend\n\npost '/refresh' do\n    AUTH_HEADER = \"Basic \" + Base64.strict_encode64(CLIENT_ID + \":\" + CLIENT_SECRET)\n\n    # Request a new access token using the POST:ed refresh token\n\n    http = Net::HTTP.new(SPOTIFY_ACCOUNTS_ENDPOINT.host, SPOTIFY_ACCOUNTS_ENDPOINT.port)\n    http.use_ssl = true\n\n    request = Net::HTTP::Post.new(\"/api/token\")\n\n    request.add_field(\"Authorization\", AUTH_HEADER)\n\n    encrypted_token = params[:refresh_token]\n    refresh_token = encrypted_token.decrypt(:symmetric, :password =&gt; ENCRYPTION_SECRET)\n\n    request.form_data = {\n        \"grant_type\" =&gt; \"refresh_token\",\n        \"refresh_token\" =&gt; refresh_token\n    }\n\n    response = http.request(request)\n\n    status response.code.to_i\n    return response.body\n\nend\n</code></pre>\n\n<p>In xcode I would POST to <code>http://#someIP:4567/swap</code> or <code>http://#someIP:4567/refresh</code></p>\n\n<p>Is this safe to do? \nAm I handling this correctly?\nBy having the request being sent to an IP that can be accessible by anyone, am I putting myself and anyone else who is using the application in danger of having their information stolen or viewed?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 1, "creation_date": 1498059637, "post_id": 44680500, "comment_id": 76345505, "body": "What database are you using"}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1498059681, "post_id": 44680500, "comment_id": 76345537, "body": "Postgres is the db I&#39;m using :)"}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 1, "creation_date": 1498059810, "post_id": 44680500, "comment_id": 76345637, "body": "and on most recent weeks, does that include the current week?"}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1498059863, "post_id": 44680500, "comment_id": 76345681, "body": "yes please, the most recent week would be the current week whether that means 1 day or 6"}], "answers": [{"comments": [{"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "edited": false, "score": 0, "creation_date": 1498060710, "post_id": 44680761, "comment_id": 76346287, "body": "this is great thank you... It returns 0 for weeks w no points"}], "tags": [], "owner": {"reputation": 1338, "user_id": 720254, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/drkkb.jpg?s=128&g=1", "display_name": "Francesco Boffa", "link": "https://stackoverflow.com/users/720254/francesco-boffa"}, "is_accepted": true, "score": 1, "last_activity_date": 1498059950, "creation_date": 1498059950, "answer_id": 44680761, "question_id": 44680500, "link": "https://stackoverflow.com/questions/44680500/with-ruby-rails5-how-can-i-loop-through-the-most-recent-4-weeks-and-collect-an/44680761#44680761", "title": "With Ruby/Rails5, How can I loop through the most recent 4 weeks and collect an aggregate sum?", "body": "<p>You can use a simple ActiveRecord query in a loop</p>\n\n<pre><code>points = (1..4).map do |n|\n   Log.where(\"created_at &lt;= ?\", n.weeks.ago).sum(:points)\nend\n</code></pre>\n\n<p><code>n.weeks.ago</code> will be transformed into a date object, thanks to ActiveSupport.</p>\n\n<p>Eg:</p>\n\n<p><code>2.weeks.ago =&gt; 2017-06-07 16:45:33</code></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I just read in a comment that you want to consider <strong>whole</strong> weeks, (monday to sunday) and that the first week should be the current week.</p>\n\n<p>Try with:</p>\n\n<pre><code>points = (0..3).map do |n|\n   Log.where(\"created_at &lt;= ?\", n.weeks.ago.end_of_week).sum(:points)\nend\n</code></pre>\n"}], "owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 1, "accepted_answer_id": 44680761, "answer_count": 1, "score": 0, "last_activity_date": 1498060034, "creation_date": 1498059320, "last_edit_date": 1498059695, "question_id": 44680500, "link": "https://stackoverflow.com/questions/44680500/with-ruby-rails5-how-can-i-loop-through-the-most-recent-4-weeks-and-collect-an", "title": "With Ruby/Rails5, How can I loop through the most recent 4 weeks and collect an aggregate sum?", "body": "<p>Given the table:</p>\n\n<pre><code>Log Table: id, user_id, points, created_at\n</code></pre>\n\n<p>Goal is to go 4 weeks back and per week obtain the cumulative points up to that point:</p>\n\n<pre><code>\"05/29/2017\", total_points (= the Big Bang to this date)\n\"06/5/2017\", total_points (= the Big Bang to this date)\n\"06/12/2017\", total_points (= the Big Bang to this date)\n\"06/19/2017\", total_points (= the Big Bang to this date)\n</code></pre>\n\n<p>With Ruby/Rails5, How can I loop through the most recent 4 weeks and collect the point count?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "comments": [{"owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "edited": false, "score": 2, "creation_date": 1498056750, "post_id": 44679360, "comment_id": 76343226, "body": "I suggest you to generate a scaffold and see how the form works. See this link <a href=\"http://guides.rubyonrails.org/active_record_validations.html#displaying-validation-errors-in-views\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a> for showing validation errors:"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498056821, "post_id": 44679360, "comment_id": 76343301, "body": "Semi-off topic, but you should fix your indentation and alignment of <code>div</code>/<code>form</code> blocks. The <code>&lt;% end %&gt;</code> should be placed 3 lines up - and this mistake would have been obvious, had you indented the code properly."}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498057531, "post_id": 44679360, "comment_id": 76343902, "body": "Done @TomLord thanks for the observation"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057216, "post_id": 44679501, "comment_id": 76343663, "body": "I already have this done with a def user_params that checks if you submited all 4 things I just want to make a notice when you don&#39;t!!  I have it like this atm: <code>else       redirect_to &#39;&#47;signup&#39;      end</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057511, "post_id": 44679501, "comment_id": 76343883, "body": "Add your controller to the question."}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057669, "post_id": 44679501, "comment_id": 76344022, "body": "Done it! you can check now"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057701, "post_id": 44679501, "comment_id": 76344051, "body": "Don&#39;t you redirect when the user isn&#39;t saved?, check the updated answer."}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057824, "post_id": 44679501, "comment_id": 76344153, "body": "I used to have <code>redirect_to &#39;&#47;signup&#39;</code> after the flash notice, and the flash notice still doesn&#39;t appear..."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057879, "post_id": 44679501, "comment_id": 76344200, "body": "It depends if you have the way to show the <code>flash</code> in the view, do you?"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057922, "post_id": 44679501, "comment_id": 76344229, "body": "Maybe that&#39;s it! How do I make a way to show it in the view?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498058104, "post_id": 44679501, "comment_id": 76344372, "body": "Just check if <code>flash[:error]</code> has a value and print it, see the udpdated answer."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1498058032, "last_edit_date": 1498058032, "creation_date": 1498056696, "answer_id": 44679501, "question_id": 44679360, "link": "https://stackoverflow.com/questions/44679360/how-do-i-make-error-notices-in-this-ruby-form/44679501#44679501", "title": "How do I make error notices in this ruby form?", "body": "<p>You can use the <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">Active Record Validations</a>.</p>\n\n<p>If you have a model called User, then you can specify which attributes to validate for presence using the <code>validates</code> method and setting the <code>presence</code> to <code>true</code>, this will check if the field on the form has been filled, also if has only whitespaces.</p>\n\n<p>For instance:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  validates :nome, presence: true\n  ...\n</code></pre>\n\n<p>For your controller:</p>\n\n<pre><code>def create \n  user = User.new(user_params) \n  if user.save \n    session[:user_id] = user.id \n    redirect_to '/' \n  else \n    flash[:error] = 'invalid value' \n    redirect_to new_user_path\n  end \nend\n</code></pre>\n\n<p>Redirect to the new user path with <code>flash[:error]</code> as \"invalid value\".</p>\n\n<p>For your view:</p>\n\n<pre><code>&lt;% if flash[:error] %&gt;\n  &lt;div class=\"error\"&gt;\n    &lt;%= flash[:error] %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 2395946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gqI0l.png?s=128&g=1", "display_name": "hoangdd", "link": "https://stackoverflow.com/users/2395946/hoangdd"}, "is_accepted": false, "score": 4, "last_activity_date": 1498057163, "last_edit_date": 1498057163, "creation_date": 1498056750, "answer_id": 44679519, "question_id": 44679360, "link": "https://stackoverflow.com/questions/44679360/how-do-i-make-error-notices-in-this-ruby-form/44679519#44679519", "title": "How do I make error notices in this ruby form?", "body": "<ul>\n<li>Rails only can validate when you submitted your form. In this case, you can check out <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">this guide</a>.</li>\n<li>In other case, if you want immediately show validate message when user enter into input, you must validate it by using Javascript. You also can use <a href=\"https://jqueryvalidation.org/\" rel=\"nofollow noreferrer\">Jquery validation plugin</a> to do that.</li>\n</ul>\n\n<p>Hope its help :)</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057419, "post_id": 44679670, "comment_id": 76343820, "body": "I did this :  <code>def create     user = User.new(user_params)     if user.save       session[:user_id] = user.id       redirect_to &#39;&#47;&#39;     else     flash[:error] = &#39;invalid value&#39;      end   end</code>  got this error: <code>No template found for UsersController#create, rendering head :no_content</code>"}, {"owner": {"reputation": 171, "user_id": 1592591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2d32ac48d24c7313d703b09b9d6ea7?s=128&d=identicon&r=PG", "display_name": "Sujay Gavhane", "link": "https://stackoverflow.com/users/1592591/sujay-gavhane"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498057987, "post_id": 44679670, "comment_id": 76344282, "body": "def create         user = User.new(user_params)         if user.save             session[:user_id] = user.id             redirect_to root_path, notice: &#39;valid value&#39;         else             flash[:error] = &#39;invalid value&#39;             redirect_to action: &quot;new&quot;         end end you forgot to mention redirect path in your else part"}], "tags": [], "owner": {"reputation": 171, "user_id": 1592591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2d32ac48d24c7313d703b09b9d6ea7?s=128&d=identicon&r=PG", "display_name": "Sujay Gavhane", "link": "https://stackoverflow.com/users/1592591/sujay-gavhane"}, "is_accepted": false, "score": 1, "last_activity_date": 1498057146, "creation_date": 1498057146, "answer_id": 44679670, "question_id": 44679360, "link": "https://stackoverflow.com/questions/44679360/how-do-i-make-error-notices-in-this-ruby-form/44679670#44679670", "title": "How do I make error notices in this ruby form?", "body": "<p>you should use jquery validations if you want to check if the field is empty type validations before submit <a href=\"https://jqueryvalidation.org/documentation/\" rel=\"nofollow noreferrer\">https://jqueryvalidation.org/documentation/</a> follow this link.</p>\n\n<p>Or if you are ok with validating fields on submit then in create or update action of your controller you can check from the params if that field is empty. then you can show flash messages like this</p>\n\n<pre><code>flash[:notice] = 'valid value'\nflash[:error] = 'invalid value'\n</code></pre>\n\n<p>Or you can add model level validations on that fields <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_validations.html</a> here</p>\n"}], "owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 44679501, "answer_count": 3, "score": 1, "last_activity_date": 1498058032, "creation_date": 1498056315, "last_edit_date": 1498057614, "question_id": 44679360, "link": "https://stackoverflow.com/questions/44679360/how-do-i-make-error-notices-in-this-ruby-form", "title": "How do I make error notices in this ruby form?", "body": "<p>How can I make an error notice when somebody leaves spaces empty, etc...</p>\n\n<p>I tried enumerous codes and they either didn't work or failed... I even installed a gem but nothing worked until now... please help with ideas/solutions</p>\n\n<pre><code>&lt;div class=\"jumbotron\"\n    &lt;div class=\"container\"&gt;\n\n    &lt;h2&gt;Signup&lt;/h2&gt;\n\n\n&lt;%= form_for :user, url: '/users' do |f| %&gt;\n  N\u00famero de Empregado: &lt;br&gt;\n  &lt;%= f.number_field :NumeroEmpregado %&gt;&lt;br&gt;\n  Primeiro e \u00daltimo Nome: &lt;br&gt;\n  &lt;%= f.text_field :nome %&gt;&lt;br&gt;\n  Password: &lt;br&gt;\n  &lt;%= f.password_field :password %&gt;&lt;br&gt;\n  Confirma\u00e7\u00e3o Password: &lt;br&gt;\n  &lt;%= f.password_field :password_confirmation %&gt;&lt;br&gt;\n\n\n  &lt;%= f.submit \"Submit\" %&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n  def new\n  end\n\n  def create\n    user = User.new(user_params)\n    if user.save\n      session[:user_id] = user.id\n      redirect_to '/'\n    else\n    flash[:error] = 'invalid value'\n\n    end\n  end\n\nprivate\n\n  def user_params\n    params.require(:user).permit(:NumeroEmpregado, :nome, :password, :password_confirmation)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1498057135, "post_id": 44679631, "comment_id": 76343584, "body": "Just to know, could you access the <code>lang</code> attribute and check it using <code>match</code>?, like <code>expect(find(&#39;html&#39;)[:lang]).to match(&#39;es&#39;)</code>?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1498058016, "post_id": 44679631, "comment_id": 76344303, "body": "@Sebasti&#225;nPalma  You could, however if the page was dynamically changing that wouldn&#39;t wait/retry for the match so it&#39;s better to stay away from using text matchers on attribute values.  Technically you could also do<code>expect(find(&#39;html[lang=&quot;es&quot;]&#39;)).to be</code> but the <code>have_css</code> reads better."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1498057044, "creation_date": 1498057044, "answer_id": 44679631, "question_id": 44678992, "link": "https://stackoverflow.com/questions/44678992/rspec-capybara-test-html-lang/44679631#44679631", "title": "Rspec/capybara - test html lang", "body": "<p>The <code>have_css</code> matcher checks for descendants of the current scope (in your example the <code>html</code> element) that match the given CSS.  You could use the <code>match_css</code> matcher which checks whether the current scope element matches the given CSS</p>\n\n<pre><code>expect(find('html')).to match_css('[lang=\"es\"]')\n</code></pre>\n\n<p>or (assuming you have no other use for html element) just do</p>\n\n<pre><code>expect(page).to have_css('html[lang=\"es\"]')\n</code></pre>\n\n<p>which would be more performant.</p>\n"}], "owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 44679631, "answer_count": 1, "score": 0, "last_activity_date": 1498057044, "creation_date": 1498055428, "question_id": 44678992, "link": "https://stackoverflow.com/questions/44678992/rspec-capybara-test-html-lang", "title": "Rspec/capybara - test html lang", "body": "<p>I have scripts that define dynamically the html lang=\"XX\" at the top of the html code.</p>\n\n<p>For example even in guatemala, I have  for certain pages with htl lang=\"de\", as they depend not on the country of the IP but on some other model's data.</p>\n\n<p>Anyway, how can I assert in a test with rspec and capybara that the lang attribute of the html is \"XX\", which would be along the line of:</p>\n\n<pre><code>expect(find('html')).to have_css('[lang=\"es\"]')\n</code></pre>\n\n<p>The actual html on the page is</p>\n\n<pre><code>&lt;html lang=\"XX\" class=\"deal-page turbolinks-progress-bar\" xmlns:fb=\"http://ogp.me/ns/fb#\"&gt;  \n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>expected to find css \"[lang=\\\"es\\\"]\" but there were no matches\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1498055588, "post_id": 44678504, "comment_id": 76342226, "body": "Quick answers to your sub questions.  <a href=\"https://github.com/rbenv/rbenv#installation\" rel=\"nofollow noreferrer\">This Link</a>  is the installation process  for rbenv.  But rbenv is only necessary if you have multiple projects on the same machine that require different ruby versions. In ruby the word <code>Gem</code> is basically <code>Library</code> and <code>Bundler</code> is a <code>Gem&#47;Library</code> management tool to ensure that your gems are downloaded, versioned properly, and not conflicting.  <a href=\"https://en.wikipedia.org/wiki/RubyGems\" rel=\"nofollow noreferrer\">This Wikipedia</a> explains ruby gems in greater detail"}, {"owner": {"reputation": 1, "user_id": 8194709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1feab0b8810f269537a9aadd4ff10e6c?s=128&d=identicon&r=PG&f=1", "display_name": "zPrince A", "link": "https://stackoverflow.com/users/8194709/zprince-a"}, "reply_to_user": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1498065389, "post_id": 44678504, "comment_id": 76348938, "body": "Thank you so much! This was very simple and helpful. I appreciate it."}], "answers": [{"comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1498076972, "post_id": 44678554, "comment_id": 76355517, "body": "He is using system version of ruby which is no good. I think in a long run its better for him to install ruby with <code>rbenv</code> or <code>rvm</code> then to use <code>sudo</code>."}], "tags": [], "owner": {"reputation": 4446, "user_id": 6079412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5e6c2756113d7289e80bed137251db?s=128&d=identicon&r=PG&f=1", "display_name": "larz", "link": "https://stackoverflow.com/users/6079412/larz"}, "is_accepted": false, "score": 1, "last_activity_date": 1498054290, "creation_date": 1498054290, "answer_id": 44678554, "question_id": 44678504, "link": "https://stackoverflow.com/questions/44678504/why-doesnt-gem-install-bundler-work/44678554#44678554", "title": "Why doesn&#39;t gem install bundler work?", "body": "<p>Try 'sudo gem install bundler'</p>\n"}], "owner": {"reputation": 1, "user_id": 8194709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1feab0b8810f269537a9aadd4ff10e6c?s=128&d=identicon&r=PG&f=1", "display_name": "zPrince A", "link": "https://stackoverflow.com/users/8194709/zprince-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498054583, "creation_date": 1498054172, "last_edit_date": 1498054583, "question_id": 44678504, "link": "https://stackoverflow.com/questions/44678504/why-doesnt-gem-install-bundler-work", "title": "Why doesn&#39;t gem install bundler work?", "body": "<p>I am trying to deploy an application via Github pages, and based on this tutorial that I am watching, I need to install bundler first. </p>\n\n<p>When I type in the command <code>gem install bundler</code>, I get the error: </p>\n\n<blockquote>\n  <p>While executing gem ... (Gem::FilePermissionError)\n      You don't have write permissions for the /Library/Ruby/Gems/2.0.0 directory.</p>\n</blockquote>\n\n<p>I do not have rbenv downloaded and I don't know how to. I also do not fully understand the concept of gems. </p>\n\n<p>How can I bypass this issue? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "edited": false, "score": 0, "creation_date": 1498055484, "post_id": 44678437, "comment_id": 76342132, "body": "In the input file, the file name mentioned has space, like this &#39;SVN Folders.txt&#39;, but in the error the same file reads like this, &#39;SVNFolders.txt&#39;. Does your file name have spaces ?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498055500, "post_id": 44678437, "comment_id": 76342152, "body": "Let me get this straight... There is only <b>one</b> file in <code>H:&#47;Ruby_test_works</code>: <code>input.txt</code>. This file contains four lines of text, each ending in another file name. You then try to open that file ... But the file <b>does not exist</b>. This is your error message. There is no such file as <code>H:&#47;Ruby_test_works&#47;SVNFolders.txt</code>. So what exactly is your question?"}, {"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "reply_to_user": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "edited": false, "score": 0, "creation_date": 1498057514, "post_id": 44678437, "comment_id": 76343885, "body": "@Ucpuzz : Sorry that was an copy and paste issue. File doesn&#39;t have name spaces"}, {"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498057730, "post_id": 44678437, "comment_id": 76344082, "body": "@TomLord : My apologies if the question is confusing. input.txt file has 3 columns, say 1st col - existing value, 2nd col : to be replaced value, 3 col is the file name where the replacement has to be done.  there are 5 files under : <code>H:&#47;Ruby_test_works</code> including <code>input.txt</code>&gt;  I&#39;m looping thru each line of input.txt and to fetch the values that has be to replaced on the other 4 files."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1498076626, "post_id": 44678437, "comment_id": 76355366, "body": "Have you tried to use <code>File.open</code> instead of <code>File.read</code> on line 7? Also I could not find docs on <code>File.read</code>. What version of ruby you are using?"}, {"owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1498079213, "post_id": 44678437, "comment_id": 76356626, "body": "@MartinZinovsky <code>File</code> extends <code>IO</code>, which is where <code>read</code> is implemented: <a href=\"http://ruby-doc.org/core-2.0.0/IO.html#method-c-read\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.0.0/IO.html#method-c-read</a>"}], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1498116077, "post_id": 44686283, "comment_id": 76368587, "body": "Thanks a lot for the insight. +1 for puts vs p usage."}], "tags": [], "owner": {"reputation": 3352, "user_id": 5152338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5QbPE.png?s=128&g=1", "display_name": "jdno", "link": "https://stackoverflow.com/users/5152338/jdno"}, "is_accepted": true, "score": 9, "last_activity_date": 1498079149, "creation_date": 1498079149, "answer_id": 44686283, "question_id": 44678437, "link": "https://stackoverflow.com/questions/44678437/no-such-file-or-directory-rb-sysopen-ruby/44686283#44686283", "title": "No such file or directory @ rb_sysopen ruby", "body": "<p>The <code>file_name</code> contains the newline character <code>\\n</code> at the end, which won't get printed but messes up the path. You can fix the issue by stripping the <code>line</code> first:</p>\n\n<pre><code>initial, final, file_name = line.strip.split(\"\\t\")\n</code></pre>\n\n<p>When debugging code, be careful with <code>puts</code>. Quoting its <a href=\"https://ruby-doc.org/core-2.4.1/IO.html#method-i-puts\" rel=\"noreferrer\">documentation</a> reveals an ugly truth:</p>\n\n<blockquote>\n  <p>Writes the given object(s) to ios. <strong>Writes a newline after any that do not already end with a newline sequence.</strong></p>\n</blockquote>\n\n<p>Another way to put this is to say it ignores (potential) newlines at the end of the object(s). Which is why you never saw that the file name actually was <code>SVNFolders.txt\\n</code>.</p>\n\n<p>Instead of using <code>puts</code>, you can use <code>p</code> when troubleshooting issues. The very short comparison between the two is that <code>puts</code> calls <code>to_s</code> and adds a newline, while <code>p</code> calls <code>inspect</code> on the object. Here is a bit more details about the differences: <a href=\"http://www.garethrees.co.uk/2013/05/04/p-vs-puts-vs-print-in-ruby/\" rel=\"noreferrer\">http://www.garethrees.co.uk/2013/05/04/p-vs-puts-vs-print-in-ruby/</a></p>\n"}], "owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17995, "favorite_count": 1, "accepted_answer_id": 44686283, "answer_count": 1, "score": 3, "last_activity_date": 1498079149, "creation_date": 1498053978, "last_edit_date": 1498057994, "question_id": 44678437, "link": "https://stackoverflow.com/questions/44678437/no-such-file-or-directory-rb-sysopen-ruby", "title": "No such file or directory @ rb_sysopen ruby", "body": "<p>Facing below issue eventhough the file is present in the folder.</p>\n\n<pre><code>H:\\Ruby_test_works&gt;ruby hurrah.rb\nhurrah.rb:7:in `read': No such file or directory @ rb_sysopen - H:/Ruby_\ntest_works/SVNFolders.txt (Errno::ENOENT)\n        from hurrah.rb:7:in `block in &lt;main&gt;'\n        from hurrah.rb:4:in `each_line'\n        from hurrah.rb:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>Input file (input.txt) Columns are tab separated.</p>\n\n<pre><code>10.3.2.021.asd  10.3.2.041.def  SVNFolders.txt\nSubversionNotify    Subversionweelta    post-commit.bat\nCommit message  still rake  customemail.txt\nmckechney.com   yahoo.in    ReadMe.txt\n</code></pre>\n\n<p>Code : </p>\n\n<pre><code>dir = 'H:/Ruby_test_works'\nfile = File.open(\"#{dir}/input.txt\", \"r\")\n\nfile.each_line do |line|\n  initial, final, file_name = line.split(\"\\t\")\n  #puts file_name\n  old_value = File.read(\"#{dir}/#{file_name}\")\n\n  replace = old_value.gsub( /#{Regexp.escape(initial)}, #{Regexp.escape(final)}/)\n  File.open(\"#{dir}/#{file_name}\", \"w\") { |fi| fi.puts replace }\n\nend\n</code></pre>\n\n<p>I have tried using both forward and backward slashes but no luck. What I'm missing, not sure. Thanks.</p>\n\n<p><code>puts file_name</code> gives the below values</p>\n\n<pre><code>SVNFolders.txt\npost-commit.bat\ncustomemail.txt\nReadMe.txt\n</code></pre>\n"}, {"tags": ["ruby", "rack-pow"], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "is_accepted": false, "score": 0, "last_activity_date": 1498068131, "creation_date": 1498068131, "answer_id": 44683189, "question_id": 44678228, "link": "https://stackoverflow.com/questions/44678228/powder-gem-error-on-install/44683189#44683189", "title": "powder gem, error on install", "body": "<p>There is <a href=\"https://github.com/basecamp/pow/issues/320\" rel=\"nofollow noreferrer\">an issue with pow</a> about this problem. There are a few suggestions over there, but the one solution that seemed most likely to help was to remove <code>~/.pow</code> and reinstall. The rather unhelpful error message came from <a href=\"https://github.com/basecamp/pow/blob/master/src/util.coffee#L67\" rel=\"nofollow noreferrer\">this line</a>:</p>\n\n<pre><code>      callback \"file exists\"\n</code></pre>\n\n<p>It would have been helpful if the developers of Pow included the filename instead of the generic message. </p>\n\n<p>Judging from the code and the comments on the issue, the problem probably occurs when a directory that pow needs is a symlink to a directory. <code>lstat</code> does not count those as directories, but as symlinks. That seems like a bug in Pow.</p>\n"}], "owner": {"reputation": 147, "user_id": 7484402, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kQdg28mKmYI/AAAAAAAAAAI/AAAAAAAAAAw/e8ctpSjMgyk/photo.jpg?sz=128", "display_name": "ann", "link": "https://stackoverflow.com/users/7484402/ann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498068131, "creation_date": 1498053459, "question_id": 44678228, "link": "https://stackoverflow.com/questions/44678228/powder-gem-error-on-install", "title": "powder gem, error on install", "body": "<p>After installing <code>powder</code> gem, I run:</p>\n\n<pre><code>$ powder install\n</code></pre>\n\n<p>the output:</p>\n\n<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  9039  100  9039    0     0   8600      0  0:00:01  0:00:01 --:--:--  8608\n\n/Users/name/Library/Application Support/Pow/Versions/0.5.0/lib/command.js:78\n            throw err;\n                  ^\nfile exists\n</code></pre>\n\n<p>That <code>file exist</code> does not tell me much though.\nAny ideas what could've gone wrong? Maybe I should report it on gem issues page?\nI was installing it on mac.</p>\n"}, {"tags": ["ruby", "string", "split", "tabs"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498054129, "post_id": 44678116, "comment_id": 76340987, "body": "<code>&quot;a\\t\\tb   c d&quot;.split(&#47;  +|\\t&#47;)</code>"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1498054130, "post_id": 44678116, "comment_id": 76340988, "body": "<code>\\s</code> or <code>[[:space:]]</code> covers tabs. So you have to move <code>\\t</code> in the start - <code>str.split(&#47;\\t|\\s{2,}&#47;)</code>"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498054977, "post_id": 44678116, "comment_id": 76341703, "body": "THat doesn&#39;t work.  If my string is str = &quot;ab \\t\\t\\tf&quot;, the above results in  [&quot;ab&quot;, &quot;f&quot;], but since i want to split on tabs and there are three tabs in that string, the result shoulld be [&quot;ab &quot;, &quot;&quot;, &quot;&quot;, &quot;f&quot;]"}], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498072656, "post_id": 44679459, "comment_id": 76353173, "body": "Does the clause &quot; {2,}&quot; take into account non-breaking spaces?"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498073739, "post_id": 44679459, "comment_id": 76353820, "body": "@Dave Can you provide an example string?"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498074131, "post_id": 44679459, "comment_id": 76354032, "body": "No, I can&#39;t.  I ahve read that &quot;[[:space:]]&quot; encompasses both breaking and non-breaking spaces, but when I try your expression using that qualifier, &quot;ab \\t\\t\\tf&quot;.split(/\\t|[[:space:]]{2,}/), the result is [&quot;ab&quot;, &quot;f&quot;], which is not quite what I want.  Maybe I&#39;m wrong about that &quot;[[:space:]]&quot; expression encompassing both things."}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498077221, "post_id": 44679459, "comment_id": 76355631, "body": "@Dave I tested it and it won&#39;t, so you will need to add <code>\\u00A0</code> to the expression. Check the updated answer."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498141151, "post_id": 44679459, "comment_id": 76386901, "body": "I really appreciate your hard work on this one.  I have one more question.  I&#39;m paranoid that there is other types of whitespace that I&#39;m not considering that [[:space:]] covers, for example, &quot;\\n&quot;.  Is your solution continegent on knowing all possible types of white space and enumerating them in that &quot;[ |\\u00A0]&quot; clause?"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1498141771, "post_id": 44679459, "comment_id": 76387428, "body": "@Dave You will need to add all possible types of whitespace, except <code>\\t</code>, that <code>[[:space:]]</code> covers (i.e. <code>\\r</code>,<code>\\n</code>,<code>\\v</code>,<code>\\f</code>); something like this: <code>[ |\\u00A0|\\r|\\n|\\v|\\f]</code>."}], "tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": true, "score": 3, "last_activity_date": 1498077190, "last_edit_date": 1498077190, "creation_date": 1498056606, "answer_id": 44679459, "question_id": 44678116, "link": "https://stackoverflow.com/questions/44678116/in-ruby-how-do-i-split-on-two-or-more-spaces-or-a-tab/44679459#44679459", "title": "In Ruby, how do I split on two or more spaces or a tab?", "body": "<p>You could try this:</p>\n\n<pre><code>\"a\\t\\tb   c d\".split(/\\t| {2,}/)\n#=&gt; [\"a\", \"\", \"b\", \"c d\"]\n\n\"ab \\t\\t\\tf\".split(/\\t| {2,}/)\n#=&gt; [\"ab \", \"\", \"\", \"f\"]\n</code></pre>\n\n<p>Where <code>\\t</code> is for <em>a tab</em> and <code>{2,}</code> for <em>two or more spaces</em>. Notice that there is a <strong>space</strong> before <code>{2,}</code>.</p>\n\n<p>To include <em>non-breaking spaces</em> you could add <code>\\u00A0</code> to the expression, like this:</p>\n\n<pre><code>str.split(/\\t|[ |\\u00A0]{2,}/)\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>str = \"a\\t\\tb \\u00A0 c d\"         #=&gt; \"a\\t\\tb \u00a0 c d\"\nstr.split(/\\t|[ |\\u00A0]{2,}/)    #=&gt; [\"a\", \"\", \"b\", \"c d\"]\n\nstr = \"ab \\t\\t\\tf\"                #=&gt; \"ab \\t\\t\\tf\"\nstr.split(/\\t|[ |\\u00A0]{2,}/)    #=&gt; [\"ab \", \"\", \"\", \"f\"]\n</code></pre>\n\n<p>Where <code>[ |\\u00A0]{2,}</code> will check for 2 or more occurrences of either a <em>space</em> or <em>non-breaking space</em>.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 44679459, "answer_count": 1, "score": -1, "last_activity_date": 1498078268, "creation_date": 1498053176, "last_edit_date": 1498078268, "question_id": 44678116, "link": "https://stackoverflow.com/questions/44678116/in-ruby-how-do-i-split-on-two-or-more-spaces-or-a-tab", "title": "In Ruby, how do I split on two or more spaces or a tab?", "body": "<p>With Ruby, how do I split into two or more spaces or a tab?  that is I have:</p>\n\n<pre><code>2.4.0 :005 &gt;   str = \"a\\t\\tb   c d\"\n =&gt; \"a\\t\\tb   c d\"\n</code></pre>\n\n<p>and applying my rules above, I would like the result to be:</p>\n\n<pre><code>[\"a\", \"\", \"b\", \"c d\"]\n</code></pre>\n\n<p>since the consecutive tabs are capturing an empty string.  But when I try the below:</p>\n\n<pre><code>2.4.0 :007 &gt; str.split(/(?:[[:space:]][[:space:]]+|\\t)/)\n =&gt; [\"a\", \"b\", \"c d\"]\n</code></pre>\n\n<p>The tabs are getting merged into a single <code>[[:space:]]</code>.  </p>\n\n<p>How do I adjust my regular expression to split into two or more spaces or a tab character?</p>\n"}, {"tags": ["ruby", "delphi", "apple-push-notifications", "client", "tcpserver"], "answers": [{"comments": [{"owner": {"reputation": 326, "user_id": 5736369, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-9RqrFuDB7iY/AAAAAAAAAAI/AAAAAAAAAAA/v0PAgVWQU_g/photo.jpg?sz=128", "display_name": "T.S", "link": "https://stackoverflow.com/users/5736369/t-s"}, "edited": false, "score": 0, "creation_date": 1498114593, "post_id": 44681651, "comment_id": 76367701, "body": "Using 127.0.0.1 gives me the same issue unfortunately. Also, trying 127.0.0.1 on telnet - does not connect it properly either - while telnet on localhost does work."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 326, "user_id": 5736369, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-9RqrFuDB7iY/AAAAAAAAAAI/AAAAAAAAAAA/v0PAgVWQU_g/photo.jpg?sz=128", "display_name": "T.S", "link": "https://stackoverflow.com/users/5736369/t-s"}, "edited": false, "score": 1, "creation_date": 1498115352, "post_id": 44681651, "comment_id": 76368141, "body": "I know, that is the point I was trying to make.  When the server is not actively listening on <code>127.0.0.1</code>, clients cannot connect to <code>127.0.0.1</code>.  Binding the server to <code>0.0.0.0</code> does not guarantee a binding to <code>127.0.0.1</code>. Clients have to connect using an IP that the server is actually listening on. Indy treats <code>localhost</code> as <code>127.0.0.1</code> only, it won&#39;t try to resolve <code>localhost</code> to other local IPs."}, {"owner": {"reputation": 326, "user_id": 5736369, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-9RqrFuDB7iY/AAAAAAAAAAI/AAAAAAAAAAA/v0PAgVWQU_g/photo.jpg?sz=128", "display_name": "T.S", "link": "https://stackoverflow.com/users/5736369/t-s"}, "edited": false, "score": 0, "creation_date": 1498116190, "post_id": 44681651, "comment_id": 76368655, "body": "Nice - never knew. ill test this soon. An alternative and perhaps more straightforward solution would be to explicitly tell Ruby to start on 127.0.0.1 -&gt; server = TCPServer.open(&quot;127.0.0.1&quot;, 2196)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 326, "user_id": 5736369, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-9RqrFuDB7iY/AAAAAAAAAAI/AAAAAAAAAAA/v0PAgVWQU_g/photo.jpg?sz=128", "display_name": "T.S", "link": "https://stackoverflow.com/users/5736369/t-s"}, "edited": false, "score": 0, "creation_date": 1498116321, "post_id": 44681651, "comment_id": 76368734, "body": "You could, but just know that doing so, the server will only be accessible to clients on the same machine, not to outside clients on the same LAN, or other networks.  If you need that, leave the server the way it was, and just have local clients on the same machine connect to a correct IP, which you can get from <code>netstat</code>."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1498115327, "last_edit_date": 1498115327, "creation_date": 1498062812, "answer_id": 44681651, "question_id": 44677471, "link": "https://stackoverflow.com/questions/44677471/connecting-to-ruby-tcpserver-from-delphi-using-indy/44681651#44681651", "title": "Connecting to ruby tcpserver from delphi using indy", "body": "<p>The error means the server is not listening on <code>127.0.0.1</code>. The server could be listening on other local IPs without listening on <code>127.0.0.1</code>.</p>\n\n<p><code>localhost</code> does not necessarily refer to just <code>127.0.0.1</code>.  Lookup queries via <code>gethostbyname()</code> or <code>getaddrinfo()</code> can resolve <code>localhost</code> to actual local IPs, which <code>telnet</code> would then try to connect to until one succeeds.</p>\n\n<p>But Indy currently treats <code>localhost</code> as <code>127.0.0.1</code> only, without trying to resolve it dynamically:</p>\n\n<pre><code>function TIdStack.ResolveHost(const AHost: string;\n  const AIPVersion: TIdIPVersion = ID_DEFAULT_IP_VERSION): string;\nbegin\n  Result := '';\n  case AIPVersion of\n    Id_IPv4: begin\n        // Sometimes 95 forgets who localhost is\n        if TextIsSame(AHost, 'LOCALHOST') then begin    {Do not Localize}\n          Result := '127.0.0.1';    {Do not Localize}\n        end else if IsIP(AHost) then begin\n          Result := AHost;\n        end else begin\n          Result := HostByName(AHost, Id_IPv4);\n        end;\n      end;\n    Id_IPv6: begin\n        if TextIsSame(AHost, 'LOCALHOST') then begin    {Do not Localize}\n          Result := '::1';    {Do not Localize}\n        end else begin\n          Result := IdGlobal.MakeCanonicalIPv6Address(AHost);\n          if Result = '' then begin\n            Result := HostByName(AHost, Id_IPv6);\n          end;\n        end;\n      end;\n    else begin\n      IPVersionUnsupported;\n    end;\n  end;\nend;\n</code></pre>\n\n<p>Even if Indy tried to resolve <code>localhost</code> as a hostname, it does not attempt to connect to all reported IPs. That is a <a href=\"https://github.com/IndySockets/Indy/issues/164\" rel=\"nofollow noreferrer\">TODO item</a> on Indy's issue list.</p>\n\n<p>My advice would be to resolve <code>localhost</code> manually with <code>getaddrinfo()</code>, then use a loop to run through the reported IPs, resetting the <code>TIdTCPClient.Host</code> (and possibly <code>TIdTCPClient.IPVersion</code>) and calling <code>TIdTCPClient.Connect()</code> for each one, until one succeeds or the loop ends.</p>\n"}], "owner": {"reputation": 326, "user_id": 5736369, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-9RqrFuDB7iY/AAAAAAAAAAI/AAAAAAAAAAA/v0PAgVWQU_g/photo.jpg?sz=128", "display_name": "T.S", "link": "https://stackoverflow.com/users/5736369/t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498115327, "creation_date": 1498051466, "last_edit_date": 1498052066, "question_id": 44677471, "link": "https://stackoverflow.com/questions/44677471/connecting-to-ruby-tcpserver-from-delphi-using-indy", "title": "Connecting to ruby tcpserver from delphi using indy", "body": "<p>I got the following example (by: Matt S) running in cmd elevated mode: <a href=\"https://stackoverflow.com/questions/2284908/how-do-you-test-the-push-notification-feedback-service\">How do you test the Push Notification feedback service?</a></p>\n\n<p>I can connect to this ruby server by using \"telnet localhost 2196\" and it'll start sending data to the telnet client just fine.</p>\n\n<p>However, if I then try to put this to use in delphi, using indy:</p>\n\n<pre><code>    TcpClient := TIdTcpClient.Create(nil);\n    TcpClient.Host := 'localhost';\n    TcpClient.Port := 2196;\n    TcpClient.Connect;\n</code></pre>\n\n<p>I get the following error: Socket Error # 10061 Connection refused as soon as \"Connect\" is called. It appears as though the tcp server could not be found.</p>\n\n<p>What might I be doing wrong here?</p>\n"}, {"tags": ["ruby", "linux", "chef-infra", "chef-solo"], "comments": [{"owner": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "edited": false, "score": 0, "creation_date": 1498051952, "post_id": 44677438, "comment_id": 76339384, "body": "He complains about a missing directory entry.  Do you have a <code>&#47;var&#47;chef&#47;nodes</code> in your file system?"}, {"owner": {"reputation": 11, "user_id": 7993867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb45b6d29bead230029c5807889f3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/7993867/arun"}, "reply_to_user": {"reputation": 47098, "user_id": 1281485, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/G4LdD.jpg?s=128&g=1", "display_name": "Alfe", "link": "https://stackoverflow.com/users/1281485/alfe"}, "edited": false, "score": 0, "creation_date": 1498057353, "post_id": 44677438, "comment_id": 76343774, "body": "I don&#39;t have /var/chef/nodes. But do we need to create? Between I&#39;m using chef solo"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1498065396, "post_id": 44677438, "comment_id": 76348945, "body": "Stack Overflow is a site for programming and development questions. This question appears to be off-topic because it is not about programming or development. See <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here</a> in the Help Center. Perhaps <a href=\"http://superuser.com/\">Super User</a> or <a href=\"http://unix.stackexchange.com/\">Unix &amp; Linux Stack Exchange</a> would be a better place to ask."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1498087326, "post_id": 44677438, "comment_id": 76359429, "body": "Are you running as root?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7993867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb45b6d29bead230029c5807889f3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/7993867/arun"}, "is_accepted": false, "score": 0, "last_activity_date": 1498126980, "creation_date": 1498126980, "answer_id": 44696678, "question_id": 44677438, "link": "https://stackoverflow.com/questions/44677438/chef-solo-not-running-in-redhat-linux/44696678#44696678", "title": "chef solo not running in redhat linux", "body": "<p>Finally it's worked for me. Forget to create a solo.rb file.</p>\n\n<p>Created solo.rb file under /etc/chef directory and added the entry for the node name</p>\n\n<p>node_name '10.1.10.1'</p>\n"}], "owner": {"reputation": 11, "user_id": 7993867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb45b6d29bead230029c5807889f3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/7993867/arun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498126980, "creation_date": 1498051399, "last_edit_date": 1498051805, "question_id": 44677438, "link": "https://stackoverflow.com/questions/44677438/chef-solo-not-running-in-redhat-linux", "title": "chef solo not running in redhat linux", "body": "<p>I have installed the ChefDK rpm package in Redhat Linux 7.2. </p>\n\n<p>The <code>chef-solo --version</code> command provides the correct version (<code>Chef: 12.19.36</code>).</p>\n\n<p>Now I'm trying to run my recipe using the following chef-solo command:</p>\n\n<pre><code>chef-solo --override-runlist \"recipe[demo_cookbook::default]\"\n</code></pre>\n\n<p>But I am getting the following error message:</p>\n\n<pre><code>\"Chef encountered an error attempting to load the node data for &lt;my server name&gt;\"\nUnknown Server Error:\n---------------------\nThe server had a fatal error attempting to load the node data.\n/opt/chefdk/embedded/lib/ruby/gems/2.3.0/gems/chef-12.19.36/bin/chef-solo:25:in `&lt;top (required)&gt;'\n/usr/bin/chef-solo:57:in `load'\n/usr/bin/chef-solo:57:in `&lt;main&gt;'\n\nPlatform:\n---------\nx86_64-linux\n\nException raised! #&lt;Errno::ENOENT: No such file or directory @ dir_s_mkdir - /var/chef/nodes&gt;\n/opt/chefdk/embedded/lib/ruby/gems/2.3.0/gems/chef-12.19.36/lib/chef/chef_fs/file_system/repository/chef_repository_file_system_root_dir.rb:113:in `mkdir'\n</code></pre>\n\n<p>Could you please suggest what I could do now?</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498049652, "post_id": 44676661, "comment_id": 76337444, "body": "Can&#39;t understand what do you mean by this <code>[![Standard simple form radio buttons][1]][1]</code>"}, {"owner": {"reputation": 393, "user_id": 4347423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0175ce86b787c87515c165b7269483f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanRio", "link": "https://stackoverflow.com/users/4347423/danrio"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498049699, "post_id": 44676661, "comment_id": 76337480, "body": "Supposed to be an image but it isn&#39;t showing... edited it now"}, {"owner": {"reputation": 393, "user_id": 4347423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0175ce86b787c87515c165b7269483f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanRio", "link": "https://stackoverflow.com/users/4347423/danrio"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498050048, "post_id": 44676661, "comment_id": 76337769, "body": "Images now showing, apologies."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498050306, "post_id": 44676661, "comment_id": 76337983, "body": "You should make your own custom wrapper <a href=\"https://github.com/plataformatec/simple_form/wiki/custom-wrappers\" rel=\"nofollow noreferrer\">See Here</a> or custom input <a href=\"https://github.com/plataformatec/simple_form/wiki/Adding-custom-input-components\" rel=\"nofollow noreferrer\">See Here</a> then instead of as: :radio_buttons you would substitute your own custom identifier. Probably need a little js and a hidden field to store the value of the button clicked."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498050900, "post_id": 44676661, "comment_id": 76338490, "body": "As an added note are you using a ui framework? Kinda looks like bootstrap but I think it would be best to actually specify"}, {"owner": {"reputation": 393, "user_id": 4347423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0175ce86b787c87515c165b7269483f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanRio", "link": "https://stackoverflow.com/users/4347423/danrio"}, "edited": false, "score": 0, "creation_date": 1498051437, "post_id": 44676661, "comment_id": 76338926, "body": "Yes I&#39;m using Bootstrap you&#39;re right. I&#39;ve added it to the initial question. I&#39;ve tried custom wrappers before with no success, I&#39;ll give it another get and post my results."}], "answers": [{"tags": [], "owner": {"reputation": 603, "user_id": 3655448, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d265d625523f228c9a94f14dbf7c8893?s=128&d=identicon&r=PG&f=1", "display_name": "Shrolox", "link": "https://stackoverflow.com/users/3655448/shrolox"}, "is_accepted": false, "score": 5, "last_activity_date": 1498052856, "last_edit_date": 1498052856, "creation_date": 1498051414, "answer_id": 44677444, "question_id": 44676661, "link": "https://stackoverflow.com/questions/44676661/change-radio-buttons-to-actual-buttons-ruby-on-rails-simple-form-gem/44677444#44677444", "title": "Change radio buttons to actual buttons - Ruby on Rails Simple Form Gem", "body": "<p>You can hide the real radio button, and set your custom button to be its label.\nThen the custom button can be styled relatively to wether the radio button is checked or not.</p>\n\n<p>Here is an example generating the fields using another function of <code>Rails Simple Form</code> gem:</p>\n\n<pre><code>f.collection_radio_buttons : domiciled, [[true, 'Yes'] ,[false, 'No']], :first, :last\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>input[type=\"radio\"] {\r\n  display:none;\r\n}\r\n\r\nlabel {\r\n  border: 1px solid #DDD;\r\n  border-radius:5px;\r\n  padding:10px;\r\n  margin-top:10px;\r\n  display:block;\r\n  position:relative;\r\n}\r\n\r\nlabel:hover {\r\n  cursor:pointer;\r\n  background-color:#EEE;\r\n}\r\n\r\ninput[type=\"radio\"]:checked + label {\r\n  background-color:#DDD;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input id=\"user_options_true\" name=\"user[options]\" type=\"radio\" value=\"true\" /&gt;\r\n&lt;label class=\"collection_radio_buttons\" for=\"user_options_true\"&gt;Yes&lt;/label&gt;\r\n&lt;input id=\"user_options_false\" name=\"user[options]\" type=\"radio\" value=\"false\" /&gt;\r\n&lt;label class=\"collection_radio_buttons\" for=\"user_options_false\"&gt;No&lt;/label&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 393, "user_id": 4347423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0175ce86b787c87515c165b7269483f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanRio", "link": "https://stackoverflow.com/users/4347423/danrio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1215, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1498052856, "creation_date": 1498049433, "last_edit_date": 1498051511, "question_id": 44676661, "link": "https://stackoverflow.com/questions/44676661/change-radio-buttons-to-actual-buttons-ruby-on-rails-simple-form-gem", "title": "Change radio buttons to actual buttons - Ruby on Rails Simple Form Gem", "body": "<p>I've made multiple attempts at doing this but just can't get my head round how to do it with the automatic wrappers that the Simple Form gem makes. </p>\n\n<p>Using Ruby on Rails (plus Simple Form Gem) I'm trying to make the standard output of radio buttons that look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GCuzW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GCuzW.png\" alt=\"Standard Radio Buttons\"></a></p>\n\n<p>Ruby: </p>\n\n<pre><code> &lt;%= n.input :domiciled, as: :radio_buttons, label: \"Do you confirm your business is domicled in the United Kingdom?\", checked: true %&gt;\n</code></pre>\n\n<p>HTML output: </p>\n\n<pre><code> &lt;div class=\"form-group radio_buttons optional user_nurse_domiciled\"&gt;\n     &lt;label class=\"control-label radio_buttons optional\"&gt;Do you confirm your business is domicled in the United Kingdom?\n     &lt;/label&gt;\n          &lt;input type=\"hidden\" name=\"user[nurse_attributes][domiciled]\" value=\"\"&gt;\n               &lt;span class=\"radio\"&gt;\n                  &lt;label for=\"user_nurse_attributes_domiciled_true\"&gt;\n                     &lt;input class=\"radio_buttons optional\" type=\"radio\" value=\"true\" checked=\"checked\" name=\"user[nurse_attributes][domiciled]\" id=\"user_nurse_attributes_domiciled_true\"&gt;Yes\n                  &lt;/label&gt;\n               &lt;/span&gt;\n               &lt;span class=\"radio\"&gt;\n                    &lt;label for=\"user_nurse_attributes_domiciled_false\"&gt;\n                        &lt;input class=\"radio_buttons optional\" readonly=\"readonly\" type=\"radio\" value=\"false\" name=\"user[nurse_attributes][domiciled]\" id=\"user_nurse_attributes_domiciled_false\"&gt;No\n                     &lt;/label&gt;\n                 &lt;/span&gt;\n   &lt;/div&gt;\n</code></pre>\n\n<p>Look like something like this and still of course hold the true / false value:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rhqh0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rhqh0.png\" alt=\"Raido buttons as buttons\"></a></p>\n\n<p>I've tried various CSS solutions I've found but nothing that I can get to work with Simple Form. Any help much appreciated thanks.</p>\n\n<p>EDIT: </p>\n\n<p>To clarify as per comment question, I'm also using Bootstrap.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-connect"], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 6685184, "user_type": "registered", "accept_rate": 26, "profile_image": "https://graph.facebook.com/10210388967946925/picture?type=large", "display_name": "Varun Babu Pozhath", "link": "https://stackoverflow.com/users/6685184/varun-babu-pozhath"}, "is_accepted": false, "score": 0, "last_activity_date": 1498354172, "creation_date": 1498354172, "answer_id": 44742401, "question_id": 44676461, "link": "https://stackoverflow.com/questions/44676461/which-type-of-stripe-connect-user-suitable-for-a-marketplace-platform/44742401#44742401", "title": "Which type of Stripe Connect user suitable for a marketplace platform", "body": "<p>There are 3 ways to create charges in stripe connect. Looks like you would need to go with Stripe conect's <code>Creating Separate Charges and Transfers</code> </p>\n\n<p><a href=\"https://stripe.com/docs/connect/charges-transfers\" rel=\"nofollow noreferrer\">https://stripe.com/docs/connect/charges-transfers</a></p>\n\n<p>The only limitation is that it is currently available only in US and Europe. You can find more information on Stripe's documentation link above.</p>\n"}], "owner": {"reputation": 692, "user_id": 3431546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796590c1b3b4f390753560dbc09910ca?s=128&d=identicon&r=PG", "display_name": "Sahidur Rahman Suman", "link": "https://stackoverflow.com/users/3431546/sahidur-rahman-suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498354172, "creation_date": 1498048902, "question_id": 44676461, "link": "https://stackoverflow.com/questions/44676461/which-type-of-stripe-connect-user-suitable-for-a-marketplace-platform", "title": "Which type of Stripe Connect user suitable for a marketplace platform", "body": "<p>I am working for a donation platform using Rails 5.1.1. Here mainly two types of user - i) Donors, ii) Organizations.</p>\n\n<p>Donor can donate any amount to a specific organizations.</p>\n\n<p>Organization can get their donations (cut off the platform fee). And organization owner can transfer their money to their bank account or Debit card.</p>\n\n<p>For above functionalities i want to use Stripe Connect. I found stripe connect has three types of user (Standard, express and custom).</p>\n\n<p>So my application scenario, Which user type is suitable for organization to manage their activities ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498048788, "post_id": 44676346, "comment_id": 76336763, "body": "Post your full form code."}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498048940, "post_id": 44676346, "comment_id": 76336886, "body": "Done, edited main question"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498048962, "post_id": 44676346, "comment_id": 76336898, "body": "You got the answer @yzalavin is right :)"}, {"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "edited": false, "score": 1, "creation_date": 1498049345, "post_id": 44676346, "comment_id": 76337176, "body": "Replace <code>&lt;%= form_errors_for :user %&gt;</code> To ` &lt;%= form_errors_for f.object %&gt;`"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498049446, "post_id": 44676346, "comment_id": 76337268, "body": "This fixed the error, but the error message is still not showing..."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498049008, "post_id": 44676438, "comment_id": 76336937, "body": "Can you explain a bit further? I&#39;m quite new to RoR and I don&#39;t quite understand what you want me to do, sorry"}], "tags": [], "owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "is_accepted": false, "score": 2, "last_activity_date": 1498049230, "last_edit_date": 1498049230, "creation_date": 1498048832, "answer_id": 44676438, "question_id": 44676346, "link": "https://stackoverflow.com/questions/44676346/trying-to-use-validations-with-local-variables/44676438#44676438", "title": "Trying to use validations with local variables", "body": "<p><code>object</code> must be an instance of an ActiveRecord model. You are passing <code>:user</code> as a symbol.</p>\n\n<p>You should pass an instance of User. If you use some authentication logic you could pass <code>current_user</code> to this method.</p>\n\n<p>UPD:</p>\n\n<p>The error says that your <code>object</code> does not understand method <code>errors</code>. <code>:user</code> is a Symbol. It is not a variable that holds your user. Therefore, it does not implement method <code>errors</code>.</p>\n\n<p><code>User</code> is a model that inherits behaviour from <code>ActiveRecord</code>. It provides method <code>errors</code>. For example, <code>object = User.create(params)</code> will work.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498050323, "post_id": 44676933, "comment_id": 76338011, "body": "gives me this error: <code>undefined method &#39;errors&#39; for nil:NilClass</code>  on this line  <code>&lt;% if f.object.errors.any? %&gt;</code>"}, {"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498050414, "post_id": 44676933, "comment_id": 76338104, "body": "Updated this line <code>&lt;%= pluralize(f.object.errors.count, &quot;error&quot;) %&gt;</code>"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498050700, "post_id": 44676933, "comment_id": 76338350, "body": "I get this error on <code>line 3 =&gt; &lt;% if f.object.errors.any? %&gt;</code>"}, {"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498050897, "post_id": 44676933, "comment_id": 76338488, "body": "Use <code>User</code> model object with <code>form_for</code> like this <code>&lt;%= form_for(@user) do |f| %&gt;</code> where <code>@user</code> is <code>@user = User.new</code> in your controller"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498051136, "post_id": 44676933, "comment_id": 76338684, "body": "did it, now I get the following error: <code>First argument in form cannot contain nil or be empty</code> on line <code>&lt;%= form_for(@user) do |f| %&gt;</code>"}, {"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 1, "creation_date": 1498051437, "post_id": 44676933, "comment_id": 76338925, "body": "have you created <code>@user = User.new</code> in your controller from where this page rendering?"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498051507, "post_id": 44676933, "comment_id": 76338992, "body": "yes: <code>def create     @user = User.new(user_params)     if user.save       session[:user_id] = user.id       redirect_to &#39;&#47;&#39;     else       redirect_to &#39;&#47;signup&#39;      end   end </code>"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498051748, "post_id": 44676933, "comment_id": 76339195, "body": "Done this, code works, but It&#39;s still not showing the error messages when I submit the form empty..."}, {"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "reply_to_user": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498051899, "post_id": 44676933, "comment_id": 76339337, "body": "what is the console output? does it redirect back to the same form page?"}, {"owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "edited": false, "score": 0, "creation_date": 1498051958, "post_id": 44676933, "comment_id": 76339392, "body": "redirects back to the same page yes, but without displaying any error message for the fields being empty"}], "tags": [], "owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "is_accepted": true, "score": 0, "last_activity_date": 1498051523, "last_edit_date": 1498051523, "creation_date": 1498050098, "answer_id": 44676933, "question_id": 44676346, "link": "https://stackoverflow.com/questions/44676346/trying-to-use-validations-with-local-variables/44676933#44676933", "title": "Trying to use validations with local variables", "body": "<p><strong>EDITED</strong></p>\n\n<p>In your <code>UsersController</code> in <code>new</code> action update as below</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new\n    @user = User.new\n  end\nend\n</code></pre>\n\n<p>and in your <code>views/users/_form.html.erb</code> file form do the below code</p>\n\n<pre><code>&lt;%= form_for(@user) do |f| %&gt;\n  &lt;% if @user.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n    &lt;h2&gt;&lt;%= pluralize(@user.errors.count, \"error\") %&gt; prohibited this user from being saved:&lt;/h2&gt;\n    &lt;ul&gt;\n      &lt;% @user.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  N\u00famero de Empregado: &lt;br&gt;\n  &lt;%= f.number_field :NumeroEmpregado %&gt;&lt;br&gt;\n\n  Primeiro e \u00daltimo Nome: &lt;br&gt;\n  &lt;%= f.text_field :nome %&gt;&lt;br&gt;\n\n  Password: &lt;br&gt;\n  &lt;%= f.password_field :password %&gt;&lt;br&gt;\n\n Confirma\u00e7\u00e3o Password: &lt;br&gt;\n &lt;%= f.password_field :password_confirmation %&gt;&lt;br&gt;\n\n &lt;%= f.submit \"Submit\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 8054234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mbQ3p.png?s=128&g=1", "display_name": "Dando Mando Nogger", "link": "https://stackoverflow.com/users/8054234/dando-mando-nogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44676933, "answer_count": 2, "score": 0, "last_activity_date": 1498051523, "creation_date": 1498048617, "last_edit_date": 1498048915, "question_id": 44676346, "link": "https://stackoverflow.com/questions/44676346/trying-to-use-validations-with-local-variables", "title": "Trying to use validations with local variables", "body": "<p>So I've been trying to use validations on ruby on rails with the form_for format</p>\n\n<p>I followed this: <a href=\"https://stackoverflow.com/a/33048292/8054234\">https://stackoverflow.com/a/33048292/8054234</a></p>\n\n<p>but im getting the following error:</p>\n\n<pre><code>&lt;%= pluralize(object.errors.count, \"error\") %&gt; prevented the form from being saved:\n\nundefined method `errors' for :user:Symbol\n</code></pre>\n\n<p>Any idead how I could make this work/fix it?</p>\n\n<p>edit1 uploaded full form code:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag \"users\" %&gt;\n\n&lt;div class=\"jumbotron\"\n    &lt;div class=\"container\"&gt;\n\n    &lt;h2&gt;Signup&lt;/h2&gt;\n\n\n&lt;%= form_for :user, url: '/users' do |f| %&gt;\n  &lt;%= form_errors_for :user %&gt;\n  N\u00famero de Empregado: &lt;br&gt;\n  &lt;%= f.number_field :NumeroEmpregado %&gt;&lt;br&gt;\n  Primeiro e \u00daltimo Nome: &lt;br&gt;\n  &lt;%= f.text_field :nome %&gt;&lt;br&gt;\n  Password: &lt;br&gt;\n  &lt;%= f.password_field :password %&gt;&lt;br&gt;\n  Confirma\u00e7\u00e3o Password: &lt;br&gt;\n  &lt;%= f.password_field :password_confirmation %&gt;&lt;br&gt;\n\n\n  &lt;%= f.submit \"Submit\" %&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "edited": false, "score": 0, "creation_date": 1498048051, "post_id": 44676095, "comment_id": 76336169, "body": "Show me your <code>Post</code> model code"}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "reply_to_user": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "edited": false, "score": 0, "creation_date": 1498048110, "post_id": 44676095, "comment_id": 76336222, "body": "I guess I have to code something that will automatically delete the comments?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1498048148, "post_id": 44676095, "comment_id": 76336254, "body": "How are you deleting the post? show the controller code."}, {"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1498049250, "post_id": 44676095, "comment_id": 76337108, "body": "It&#39;s fixed guys, I didn&#39;t have the dependent: :destroy in my post model thanks a lot"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1498049109, "post_id": 44676195, "comment_id": 76337007, "body": "It fixed my problem. Thanks a lot!"}, {"owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "reply_to_user": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1498049429, "post_id": 44676195, "comment_id": 76337254, "body": "Welcome :) Keep coding"}], "tags": [], "owner": {"reputation": 1414, "user_id": 3458314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0gRzO.jpg?s=128&g=1", "display_name": "hgsongra", "link": "https://stackoverflow.com/users/3458314/hgsongra"}, "is_accepted": false, "score": 1, "last_activity_date": 1498048846, "last_edit_date": 1498048846, "creation_date": 1498048242, "answer_id": 44676195, "question_id": 44676095, "link": "https://stackoverflow.com/questions/44676095/update-or-delete-on-table-x-violates-foreign-key-constraint-fk-rails-5a7b4084/44676195#44676195", "title": "update or delete on table &quot;x&quot; violates foreign key constraint &quot;fk_rails_5a7b40847a&quot; on table &quot;x&quot;", "body": "<p>Update the below line in your <code>Post</code> model as below</p>\n\n<pre><code>has_many :comments, dependent: :destroy \n</code></pre>\n\n<p>You have to mention <code>dependent: :destroy</code> in your <code>Post</code> model. So when any <code>post</code> get to deleted by <code>post.destroy</code>, It deletes the all dependent records of <code>Comment</code> model.   </p>\n\n<p>Hope this will resolve your issue</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1498049070, "post_id": 44676203, "comment_id": 76336980, "body": "Awesome it worked perfectly thanks so much!"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 6, "last_activity_date": 1570778679, "last_edit_date": 1570778679, "creation_date": 1498048253, "answer_id": 44676203, "question_id": 44676095, "link": "https://stackoverflow.com/questions/44676095/update-or-delete-on-table-x-violates-foreign-key-constraint-fk-rails-5a7b4084/44676203#44676203", "title": "update or delete on table &quot;x&quot; violates foreign key constraint &quot;fk_rails_5a7b40847a&quot; on table &quot;x&quot;", "body": "<p>It depends what you want to do with the post's comments on its deletion. In case you want to delete them on cascade, for example:</p>\n\n<pre><code>post.rb\n\nhas_many :comments, dependent: :destroy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "edited": false, "score": 0, "creation_date": 1498049089, "post_id": 44676224, "comment_id": 76336994, "body": "Worked perfectly!! Thanks!"}], "tags": [], "owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "is_accepted": false, "score": 0, "last_activity_date": 1498048307, "creation_date": 1498048307, "answer_id": 44676224, "question_id": 44676095, "link": "https://stackoverflow.com/questions/44676095/update-or-delete-on-table-x-violates-foreign-key-constraint-fk-rails-5a7b4084/44676224#44676224", "title": "update or delete on table &quot;x&quot; violates foreign key constraint &quot;fk_rails_5a7b40847a&quot; on table &quot;x&quot;", "body": "<p>It's because you have a constraint in your database.<br>\nI presume that the foreign key <code>post_id</code> in table <code>comments</code> must exist in the associated table <code>posts</code>.<br>\nThat is certainly because you specify the foreign key relation in the migration with <code>rails g model Comment post:references</code>.  </p>\n\n<p>You have to specify what to do with associated models on deletion :</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  has_many :comments, dependent: :destroy # destroy associated comments\nend\n</code></pre>\n\n<p>Then call method <code>post.destroy</code> instead of <code>post.delete</code> on your record</p>\n\n<p>See <a href=\"http://guides.rubyonrails.org/association_basics.html#has-many-association-reference\" rel=\"nofollow noreferrer\">has_many</a> for other options</p>\n"}], "owner": {"reputation": 75, "user_id": 8162953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdcac12ea90ba7a077d33f2f97e1dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Cailhol", "link": "https://stackoverflow.com/users/8162953/thomas-cailhol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5101, "favorite_count": 0, "closed_date": 1498048342, "accepted_answer_id": 44676203, "answer_count": 3, "score": 4, "last_activity_date": 1607559253, "creation_date": 1498047958, "last_edit_date": 1607559253, "question_id": 44676095, "link": "https://stackoverflow.com/questions/44676095/update-or-delete-on-table-x-violates-foreign-key-constraint-fk-rails-5a7b4084", "closed_reason": "Duplicate", "title": "update or delete on table &quot;x&quot; violates foreign key constraint &quot;fk_rails_5a7b40847a&quot; on table &quot;x&quot;", "body": "<p>I am building a rails app (5.1.1) that has the equivalent of posts and comments linked to them.</p>\n<p>Everything seems to be working just fine but when I try to delete a post that has comments I get this error:</p>\n<pre><code>PG::ForeignKeyViolation: ERROR:  update or delete on table &quot;posts&quot; violates foreign key constraint &quot;fk_rails_5a7b40847a&quot; on table &quot;comments&quot;\nDETAIL:  Key (id)=(3) is still referenced from table &quot;comments&quot;.\n: DELETE FROM &quot;posts&quot; WHERE &quot;prototypes&quot;.&quot;id&quot; = $1&quot;\n</code></pre>\n<p>The error seems pretty straight forward but I'm really new to rails and postgresql so I'm looking for some help on that!</p>\n"}, {"tags": ["ruby", "puppet", "facter"], "answers": [{"comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1498068108, "post_id": 44680907, "comment_id": 76350433, "body": "Using this logic, if you have both installed it only reports 5"}, {"owner": {"reputation": 39, "user_id": 6457058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85146f641f3486b6c51747cc79c70e23?s=128&d=identicon&r=PG&f=1", "display_name": "Studentus", "link": "https://stackoverflow.com/users/6457058/studentus"}, "edited": false, "score": 0, "creation_date": 1498218791, "post_id": 44680907, "comment_id": 76423641, "body": "Perfect, thank you! Didn&#39;t know that it&#39;s in the wrong directory."}], "tags": [], "owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "is_accepted": true, "score": 3, "last_activity_date": 1498060375, "creation_date": 1498060375, "answer_id": 44680907, "question_id": 44674079, "link": "https://stackoverflow.com/questions/44674079/fact-file-was-parsed-but-returned-an-empty-data-set/44680907#44680907", "title": "Fact file was parsed but returned an empty data set", "body": "<p><code>facts.d</code> is the module directory for external facts. You could place this file into the external facts directory, but the expected output would need to be key-value pairs. This is not happening, so Puppet is not finding a data set for the fact. <a href=\"https://docs.puppet.com/facter/3.6/custom_facts.html#executable-facts-----unix\" rel=\"nofollow noreferrer\">https://docs.puppet.com/facter/3.6/custom_facts.html#executable-facts-----unix</a></p>\n\n<p>You have written this fact as a custom fact and not an external fact. Therefore, it needs to be placed inside the <code>lib/facter</code> directory in your module instead. Then it will function correctly. I notice this important information seems to have been removed from the latest Facter documentation, which probably lends to your confusion.</p>\n\n<p>Also, consider using an <code>elsif</code> in your code for clarity and optimization:</p>\n\n<pre><code>if File.directory? '/etc/php5'\n  5\nelsif File.directory? '/etc/php7'\n  7\nelse\n  0\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1498079513, "post_id": 44682031, "comment_id": 76356764, "body": "Yeah I was about to say that I thought <code>Facter::Util::Resolution</code> was deprecated. Looks like the module needs an update."}], "tags": [], "owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "is_accepted": false, "score": 1, "last_activity_date": 1498064117, "creation_date": 1498064117, "answer_id": 44682031, "question_id": 44674079, "link": "https://stackoverflow.com/questions/44674079/fact-file-was-parsed-but-returned-an-empty-data-set/44682031#44682031", "title": "Fact file was parsed but returned an empty data set", "body": "<p>What Matt Schuchard said.</p>\n\n<p>Also, you might consider that the Approved Vox Populi Puppet module uses <a href=\"https://github.com/voxpupuli/puppet-php/blob/master/lib/facter/phpversion.rb\" rel=\"nofollow noreferrer\">this</a> code for PHP version:</p>\n\n<pre><code>Facter.add(:phpversion) do\n  setcode do\n    output = Facter::Util::Resolution.exec('php -v')\n\n    unless output.nil?\n      output.split(\"\\n\").first.split(' ').\n        select { |x| x =~ %r{^(?:(\\d+)\\.)(?:(\\d+)\\.)?(\\*|\\d+)} }.first\n    end\n  end\nend\n</code></pre>\n\n<p>Note that <code>Facter::Util::Resolution.exec</code> is deprecated in favour of <code>Facter::Core::Execution.exec</code>.</p>\n\n<p>Aside from that, you might consider this a better way of getting the PHP version.</p>\n"}], "owner": {"reputation": 39, "user_id": 6457058, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85146f641f3486b6c51747cc79c70e23?s=128&d=identicon&r=PG&f=1", "display_name": "Studentus", "link": "https://stackoverflow.com/users/6457058/studentus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "accepted_answer_id": 44680907, "answer_count": 2, "score": 2, "last_activity_date": 1498064117, "creation_date": 1498042386, "last_edit_date": 1498044472, "question_id": 44674079, "link": "https://stackoverflow.com/questions/44674079/fact-file-was-parsed-but-returned-an-empty-data-set", "title": "Fact file was parsed but returned an empty data set", "body": "<p>For my current module, I need to check if php version 5 or 7 is installed and created a fact for this. The fact file is stored in the modules directory in <em>facts.d/packageversion.rb</em> and has the following content:</p>\n\n<pre><code>#!/usr/bin/ruby\nrequire 'facter'\n\nFacter.add(:php_version) do\n  setcode do\n    if File.directory? '/etc/php5'\n      5\n    else\n      if File.directory? '/etc/php7'\n        7\n      else\n        0\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>But I can't use it in my module. In Puppet agent log, i get this error:</p>\n\n<blockquote>\n  <p>Fact file /var/lib/puppet/facts.d/packageversion.rb was parsed but\n  returned an empty data set</p>\n</blockquote>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["ruby", "rspec", "stderr"], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 2, "last_activity_date": 1498045667, "last_edit_date": 1498045667, "creation_date": 1498042510, "answer_id": 44674124, "question_id": 44673739, "link": "https://stackoverflow.com/questions/44673739/rspec-capture-stderr-output-of-linux-process/44674124#44674124", "title": "Rspec - capture stderr output of linux process", "body": "<p>RSpec's <code>output.to_stderr</code> matcher is looking for things that write to <code>$stdout</code>/<code>$stderr</code> -- which your shell command is not doing, as it runs as a separate sub-process.</p>\n\n<p>In order to test this, you need to explicitly capture the <code>stdout</code> and <code>stderr</code> of the shell code. You could build your own implementation of this quite easily using the <a href=\"https://ruby-doc.org/stdlib/libdoc/open3/rdoc/Open3.html\" rel=\"nofollow noreferrer\"><code>Open3</code> standard library</a>, or for example use the <a href=\"https://github.com/mdurban/rspec-bash\" rel=\"nofollow noreferrer\"><code>rspec-bash</code> gem</a>:</p>\n\n<pre><code>require 'rspec'\nrequire 'rspec/bash'\n\ndescribe 'My behaviour' do\n  include Rspec::Bash\n\n  let(:stubbed_env) { create_stubbed_env }\n\n  it 'should do something' do\n    stdout, stderr, status = stubbed_env.execute(\n      'echo \"foo\" 1&gt;&amp;2'\n    )\n    expect(stderr).to eq('foo')\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1498045641, "post_id": 44674336, "comment_id": 76334339, "body": "You can check the exact message: <code>.to output(&#39;foo&#39;).to_std_error_from_any_process</code> -- <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/output-matcher#output-to-stderr-from-any-process-matcher\" rel=\"nofollow noreferrer\">read the docs</a>"}], "tags": [], "owner": {"reputation": 2044, "user_id": 820501, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/SDYBl.jpg?s=128&g=1", "display_name": "ShockwaveNN", "link": "https://stackoverflow.com/users/820501/shockwavenn"}, "is_accepted": true, "score": 0, "last_activity_date": 1498043123, "creation_date": 1498043123, "answer_id": 44674336, "question_id": 44673739, "link": "https://stackoverflow.com/questions/44673739/rspec-capture-stderr-output-of-linux-process/44674336#44674336", "title": "Rspec - capture stderr output of linux process", "body": "<p>Found a less precise, but more easier to read method:</p>\n\n<pre><code>require 'rspec'\n\ndescribe 'My behaviour' do\n\n  it 'should do something' do\n    expect { system('echo \"foo\" 1&gt;&amp;2 ') }.to output.to_stderr_from_any_process\n  end\nend\n</code></pre>\n\n<p>AFAIU - it cannot check exact message, but it's enough for me</p>\n"}], "owner": {"reputation": 2044, "user_id": 820501, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/SDYBl.jpg?s=128&g=1", "display_name": "ShockwaveNN", "link": "https://stackoverflow.com/users/820501/shockwavenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 44674336, "answer_count": 2, "score": 4, "last_activity_date": 1498045667, "creation_date": 1498041422, "question_id": 44673739, "link": "https://stackoverflow.com/questions/44673739/rspec-capture-stderr-output-of-linux-process", "title": "Rspec - capture stderr output of linux process", "body": "<p>I want to test what my bash script output some message to stderr.\nI try this:</p>\n\n<pre><code>require 'rspec'\n\ndescribe 'My behaviour' do\n\n  it 'should do something' do\n    expect { `echo \"foo\" 1&gt;&amp;2` }.to output.to_stderr\n  end\nend\n</code></pre>\n\n<p>But seems output to stderr happened not during test.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis"], "comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1498044379, "post_id": 44673573, "comment_id": 76333426, "body": "Do you need all of those gems? I only use <code>redis-rails</code> and it works perfectly."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1498044453, "post_id": 44673573, "comment_id": 76333481, "body": "its mention in tutorial <a href=\"https://www.sitepoint.com/rails-model-caching-redis/\" rel=\"nofollow noreferrer\">sitepoint.com/rails-model-caching-redis</a>"}], "answers": [{"tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498056482, "last_edit_date": 1498056482, "creation_date": 1498055998, "answer_id": 44679220, "question_id": 44673573, "link": "https://stackoverflow.com/questions/44673573/require-cannot-load-such-file-rack-cache-entity-store-loaderror/44679220#44679220", "title": "`require&#39;: cannot load such file -- rack/cache/entity_store (LoadError)", "body": "<p>Based on this <a href=\"https://github.com/redis-store/redis-rack-cache/issues/9\" rel=\"nofollow noreferrer\">like</a>, try using rack-cache version > 1.6.0</p>\n\n<p>Add the following to your gem file:</p>\n\n<pre><code>gem 'rack-cache', '~&gt; 1.6.1'\n</code></pre>\n\n<p>then run </p>\n\n<pre><code>bundle update rack-cache\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498056482, "creation_date": 1498040955, "last_edit_date": 1498041349, "question_id": 44673573, "link": "https://stackoverflow.com/questions/44673573/require-cannot-load-such-file-rack-cache-entity-store-loaderror", "title": "`require&#39;: cannot load such file -- rack/cache/entity_store (LoadError)", "body": "<p>After adding redis cache gems in my app</p>\n\n<pre><code>gem 'redis'\ngem 'redis-namespace'\ngem 'redis-rails'\ngem 'redis-rack-cache'\n</code></pre>\n\n<p>After installing that GEM I'm getting the following error.</p>\n\n<pre><code>`require': cannot load such file -- rack/cache/entity_store (LoadError)\n</code></pre>\n\n<blockquote>\n  <p>How can I resolve this, Any idea ?</p>\n</blockquote>\n"}, {"tags": ["jquery", "html", "css", "ruby", "sass"], "comments": [{"owner": {"reputation": 2431, "user_id": 3501205, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1639234418/picture?type=large", "display_name": "Alex Weitz", "link": "https://stackoverflow.com/users/3501205/alex-weitz"}, "edited": false, "score": 1, "creation_date": 1498040582, "post_id": 44673364, "comment_id": 76330776, "body": "Codeacademy just touches the surface - Search for &quot;the odin project&quot;"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1498041107, "post_id": 44673364, "comment_id": 76331168, "body": "It&#39;s an excellent resource for beginners but I don&#39;t think anybody mastered &#39;web development&#39; from there alone. Finish the tracks that you&#39;re interested in on CA then source more advanced material. If you&#39;re interested in Ruby click <a href=\"https://stackoverflow.com/tags/ruby/info\">here</a> for info on learning resources."}], "answers": [{"tags": [], "owner": {"reputation": 6627, "user_id": 2830603, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MAADD.gif?s=128&g=1", "display_name": "Hash", "link": "https://stackoverflow.com/users/2830603/hash"}, "is_accepted": false, "score": 2, "last_activity_date": 1498040793, "creation_date": 1498040793, "answer_id": 44673508, "question_id": 44673364, "link": "https://stackoverflow.com/questions/44673364/is-codecademy-a-good-choice-to-master-in-web-development/44673508#44673508", "title": "Is codecademy a good choice to master in web development?", "body": "<p><strong>PRO:</strong></p>\n\n<ul>\n<li>Excellent for absolute beginners (as in you don't even know HTML).</li>\n<li>Great step-by-step instructions and great help when you get stuck.</li>\n<li>Supportive community.</li>\n<li>Wide range of content to learn from; you can find lessons on many\ntopics (e.g. HTML, CSS, Ruby, Rails, Python, Javascript ...etc) and\nthey keep adding more content.</li>\n</ul>\n\n<p><strong>CON:</strong></p>\n\n<ul>\n<li>Almost too much hand-holding (harkening back to PRO#1 - they're great\nfor absolute beginners) doesn't help intermediate students move on to\nlearning advanced concepts.</li>\n<li>Disjointed lessons/modules without bringing the student back to the\n\"big picture\" or \"why do I need to know this\" can leave a student\nuncertain where to go or how to progress from that point on. This can\nbe seen by the number of users asking \"Done with Codecademy. What\nnow?\" type of questions on their forums.</li>\n<li>A mile wide, but an inch deep. Meaning: although they have lots of\nresources and content, they barely cover the surface and they don't\ndive deep enough to get to the next level of programming.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 262, "user_id": 7991072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc37fe29fe222ddb275c4d44d9eb4e5?s=128&d=identicon&r=PG", "display_name": "Vijay Raheja", "link": "https://stackoverflow.com/users/7991072/vijay-raheja"}, "is_accepted": false, "score": 1, "last_activity_date": 1498041026, "creation_date": 1498041026, "answer_id": 44673602, "question_id": 44673364, "link": "https://stackoverflow.com/questions/44673364/is-codecademy-a-good-choice-to-master-in-web-development/44673602#44673602", "title": "Is codecademy a good choice to master in web development?", "body": "<p>Yes, it is code website but depends what you want to learn.\nThere are other options also.</p>\n\n<ul>\n<li>Code school </li>\n<li>Pluralsight </li>\n<li>E-books</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "is_accepted": false, "score": 2, "last_activity_date": 1498042380, "creation_date": 1498042380, "answer_id": 44674077, "question_id": 44673364, "link": "https://stackoverflow.com/questions/44673364/is-codecademy-a-good-choice-to-master-in-web-development/44674077#44674077", "title": "Is codecademy a good choice to master in web development?", "body": "<p>I highly recommend the <strong><a href=\"https://www.theodinproject.com/\" rel=\"nofollow noreferrer\">Odin Project</a></strong>. It has a very broad perspective and use many different ways and ressources instead of focusing on one kind teaching.</p>\n\n<p>Codeacademy is a very good resource, but it may be guiding you too much. A big part of programming is actually figuring out what problem you are actually solving, and structuring that project.</p>\n\n<p>The odin project also forces you to work in your own environment, on the console, using git and all this. It is not some walled garden, where everything always plays nicely together.</p>\n"}], "owner": {"reputation": 82, "user_id": 7496473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab8d801d910107a792516a39683192d?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Areeb", "link": "https://stackoverflow.com/users/7496473/muhammad-areeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 0, "closed_date": 1498046690, "answer_count": 3, "score": 0, "last_activity_date": 1498042380, "creation_date": 1498040407, "question_id": 44673364, "link": "https://stackoverflow.com/questions/44673364/is-codecademy-a-good-choice-to-master-in-web-development", "closed_reason": "Opinion-based", "title": "Is codecademy a good choice to master in web development?", "body": "<p>I have been learning from codecademy quite a while. I want to know if really i am putting my time on quality stuff or not?</p>\n"}, {"tags": ["ruby", "garbage-collection", "puma"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1498038815, "post_id": 44672535, "comment_id": 76329517, "body": "Yes, this is quite a vague question. Can you provide more details? Can you narrow this down to certain requests or path in your application? What does the application do? How big is the database? Is there more information related to the request in the log files? Do the errors in include a usefull stacktrace?"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1498039498, "post_id": 44672535, "comment_id": 76330062, "body": "<a href=\"https://www.schneems.com/2017/02/21/the-oldest-bug-in-ruby-why-racktimeout-might-hose-your-server/\" rel=\"nofollow noreferrer\">schneems.com/2017/02/21/&hellip;</a>"}, {"owner": {"reputation": 3669, "user_id": 3678689, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/eadd310b0e2a59fe38c4ffbdb2884dfd?s=128&d=identicon&r=PG", "display_name": "Jan Klimo", "link": "https://stackoverflow.com/users/3678689/jan-klimo"}, "edited": false, "score": 0, "creation_date": 1527273234, "post_id": 44672535, "comment_id": 88082069, "body": "Hi Jonathan, I have <i>exactly</i> the same situation. I&#39;m wondering if you made progress here? Happy to share any info so we can debug it together if needed. I have at least 4 occurrences of this in NewRelic."}, {"owner": {"reputation": 2452, "user_id": 195203, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e38d270efea4af166e915b99c79663d?s=128&d=identicon&r=PG", "display_name": "Jonathan del Strother", "link": "https://stackoverflow.com/users/195203/jonathan-del-strother"}, "edited": false, "score": 0, "creation_date": 1527498864, "post_id": 44672535, "comment_id": 88136115, "body": "Sadly not, though I don\u2019t recall seeing it for a while. Wonder if we have any dependencies in common?  We have Rails 5.1, and possible culprits that spring to mind include mysql2, hiredis, dalli, rmagick, and thinkingsphinx."}], "owner": {"reputation": 2452, "user_id": 195203, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7e38d270efea4af166e915b99c79663d?s=128&d=identicon&r=PG", "display_name": "Jonathan del Strother", "link": "https://stackoverflow.com/users/195203/jonathan-del-strother"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498038359, "creation_date": 1498038359, "question_id": 44672535, "link": "https://stackoverflow.com/questions/44672535/unbounded-memory-growth-after-racktimeout-in-a-puma-rails-app", "title": "Unbounded memory growth after Rack::Timeout in a puma Rails app", "body": "<p>We're using Ruby 2.3.3 with a Rails 5.0 app, running on puma 3.8.2, and rack-timeout 0.4.2.</p>\n\n<p>We get semi frequent Rack::Timeout exceptions that have no ill effect.  Occasionally though, something bad will happen that causes a slew of timeouts, and after that point, the puma worker process seems to just keep generating more and more live objects.  GC appears to still be running - at least, NewRelic is still reporting time spent in GC - but it doesn't seem to be having much effect:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6ybS6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6ybS6.png\" alt=\"heap size graph\"></a></p>\n\n<p>The worker process keeps serving requests, but gets slower &amp; slower as the heap size goes up, before eventually dying with out-of-memory errors.</p>\n\n<p>I know this is quite a vague question, but I wondered if anyone had run into anything similar.  Any tips for diagnosing it further?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "edited": false, "score": 1, "creation_date": 1498038248, "post_id": 44672357, "comment_id": 76329116, "body": "Use nested attributes for update client record."}], "answers": [{"comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 1, "creation_date": 1498038974, "post_id": 44672588, "comment_id": 76329639, "body": "It should be named as <code>ChildrenController</code>."}, {"owner": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "edited": false, "score": 0, "creation_date": 1498039881, "post_id": 44672588, "comment_id": 76330316, "body": "I updated the child manually but it does not feel right indeed. I&#39;m in an unusual case but I might be able to make it work Rest style. Thanks"}], "tags": [], "owner": {"reputation": 1338, "user_id": 720254, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/drkkb.jpg?s=128&g=1", "display_name": "Francesco Boffa", "link": "https://stackoverflow.com/users/720254/francesco-boffa"}, "is_accepted": true, "score": 1, "last_activity_date": 1498038466, "creation_date": 1498038466, "answer_id": 44672588, "question_id": 44672357, "link": "https://stackoverflow.com/questions/44672357/rails-update-child-from-parent-controller/44672588#44672588", "title": "Rails update child from parent controller", "body": "<p>If you just want to update the <em>child</em> entity, you should do that into the <code>ChildsController</code>.</p>\n\n<p>You <em>can</em> update the child in the parent controller, but it is a violation of the REST principles. You are the ultimate authority in your code for what you can and cannot do, but following best practices will help you in the long run.</p>\n\n<p>If you insist on following the dark side, I suggest you to just update the child without using the overcomplicated <code>nested_attributes</code> which use case is for a <strong>simultaneous</strong> update.</p>\n"}], "owner": {"reputation": 313, "user_id": 7511524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TXVnb.jpg?s=128&g=1", "display_name": "Manspider", "link": "https://stackoverflow.com/users/7511524/manspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 44672588, "answer_count": 1, "score": 0, "last_activity_date": 1498038466, "creation_date": 1498037929, "question_id": 44672357, "link": "https://stackoverflow.com/questions/44672357/rails-update-child-from-parent-controller", "title": "Rails update child from parent controller", "body": "<p>So I have this simple situation:</p>\n\n<p>User model has_one client\nI want to update client's attributes from user's update method (in controller)\nShould I accept nested attributes from client and update all as one, or should I update client independently (maybe call client's edit url from here) ?</p>\n\n<p>Not sure what is the best way to do this.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby", "macos"], "answers": [{"tags": [], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "is_accepted": true, "score": 0, "last_activity_date": 1498093818, "creation_date": 1498093818, "answer_id": 44688539, "question_id": 44672048, "link": "https://stackoverflow.com/questions/44672048/use-launchcontrol-to-run-pg-dump-in-a-ruby-file/44688539#44688539", "title": "Use LaunchControl to run pg_dump in a ruby file", "body": "<p>The problem is that I am not putting the full file path to <code>pg_dump</code>.</p>\n\n<p><code>pg_dump</code> is a utility of postgresql which was installed using homebrew. So in my case I did <code>brew info postgresql</code> which told me the path to postgresql.  In the bin directory I found <code>pgdump</code>.</p>\n\n<p>I also put in the full path to where I wanted <code>backup_file</code> saved. This was found by changing to that directory and typing <code>pwd</code>.</p>\n"}], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 44688539, "answer_count": 1, "score": 0, "last_activity_date": 1498093818, "creation_date": 1498037241, "last_edit_date": 1498086958, "question_id": 44672048, "link": "https://stackoverflow.com/questions/44672048/use-launchcontrol-to-run-pg-dump-in-a-ruby-file", "title": "Use LaunchControl to run pg_dump in a ruby file", "body": "<p>Using Mac OSX 10.12.5, I have a ruby file with the following contents</p>\n\n<pre><code>#!/usr/bin/env ruby\nDir.chdir('/Users/my_files') do\n  system(\"pg_dump -Fc --no-acl --no-owner -h localhost -U MyName development &gt; backup_file.dump\")\nend\n</code></pre>\n\n<p>it works if I run it from the command line, but if I run it from LaunchControl I get the following error:</p>\n\n<pre><code>sh: pg_dump: command not found\n</code></pre>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["ruby", "cucumber"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 1, "creation_date": 1498059301, "post_id": 44671624, "comment_id": 76345256, "body": "Cucumber expressions might not actually be implemented yet for Ruby. The <a href=\"https://github.com/cucumber/cucumber-ruby/issues/1002\" rel=\"nofollow noreferrer\">issue for adding support</a> is still in the open state."}], "answers": [{"comments": [{"owner": {"reputation": 5315, "user_id": 3527464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MRCc6.jpg?s=128&g=1", "display_name": "Pyves", "link": "https://stackoverflow.com/users/3527464/pyves"}, "edited": false, "score": 1, "creation_date": 1602857359, "post_id": 48095501, "comment_id": 113860957, "body": "Documentation is now available here: <a href=\"https://cucumber.io/docs/cucumber/configuration\" rel=\"nofollow noreferrer\">cucumber.io/docs/cucumber/configuration</a>. The rendering for Ruby was broken, but was fixed in <a href=\"https://github.com/cucumber/docs.cucumber.io/pull/530\" rel=\"nofollow noreferrer\">github.com/cucumber/docs.cucumber.io/pull/530</a>"}], "tags": [], "owner": {"reputation": 145, "user_id": 1627766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e0b4ef5a47591b964229d3ebc29565?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1627766/aaron"}, "is_accepted": true, "score": 4, "last_activity_date": 1515069442, "creation_date": 1515069442, "answer_id": 48095501, "question_id": 44671624, "link": "https://stackoverflow.com/questions/44671624/cucumber-ruby-cucumber-expressions/48095501#48095501", "title": "Cucumber Ruby - Cucumber Expressions", "body": "<p>Cucumber expressions are available from v3.0.0 (see: <a href=\"https://github.com/cucumber/cucumber-ruby/issues/1002#issuecomment-332734877\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber-ruby/issues/1002#issuecomment-332734877</a>). However, adding a custom parameter type seems to be undocumented at the moment and I had to dig quite a bit to find out how to do it (see the <a href=\"https://github.com/cucumber/cucumber-ruby/blob/08fbcc9a70d5efea76b6b435267a81959d9f7da2/lib/cucumber/glue/dsl.rb\" rel=\"nofollow noreferrer\" title=\"this class\"><code>Cucumber::Glue::Dsl</code> class</a>).</p>\n\n<p>In my case I wanted to add a <code>date</code> parameter type to match the format <code>YYYY-MM-DD</code>, so I created a new file <code>parameter_types.rb</code> in the <code>support</code> directory (I'm using Cucumber to test a Rails application) with the following content:</p>\n\n<pre><code>ParameterType name:             'date',\n              type:             Date,\n              regexp:           /\\d{4}-\\d{2}-\\d{2}/,\n              transformer:      -&gt;(str) { Date.parse(str) },\n              use_for_snippets: true\n</code></pre>\n\n<p><code>ParameterType</code> is a method like <code>After</code>, <code>Before</code>, etc. that you can use to define hooks. You can add more parameter types by appending them to the same file.</p>\n"}], "owner": {"reputation": 2754, "user_id": 5114911, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1698453063709112/picture?type=large", "display_name": "KyleFairns", "link": "https://stackoverflow.com/users/5114911/kylefairns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 1, "accepted_answer_id": 48095501, "answer_count": 1, "score": 3, "last_activity_date": 1515069442, "creation_date": 1498036147, "last_edit_date": 1498038634, "question_id": 44671624, "link": "https://stackoverflow.com/questions/44671624/cucumber-ruby-cucumber-expressions", "title": "Cucumber Ruby - Cucumber Expressions", "body": "<p>Trying out some new things in Cucumber Ruby, and I came across their Cucumber Expressions.</p>\n\n<p>I've tried registering parameters:</p>\n\n<pre><code>require 'cucumber/cucumber_expressions/parameter_type'\nrequire 'cucumber/cucumber_expressions/parameter_type_registry'\n\nCucumber::CucumberExpressions::ParameterTypeRegistry.new.define_parameter_type(Cucumber::CucumberExpressions::ParameterType.new(\n    'optional_not',\n    String,\n    /n't| not|/,\n    lambda {|s| String.new(s)}\n))\n\nCucumber::CucumberExpressions::ParameterTypeRegistry.new.define_parameter_type(Cucumber::CucumberExpressions::ParameterType.new(\n    'string_in_double_quotes',\n    String,\n    /\"[^\"]*\"/,\n    lambda {|s| String.new(s)}\n))\n</code></pre>\n\n<p>But when I have a step definition such as:</p>\n\n<pre><code>Given \"{string_in_double_quotes} does{optional_not} work\" do |thing, invert|\n   invert = invert.gsub(' ', '')\n   if invert == 'n\\'t' or invert == 'not'\n      # Something here\n   else\n      # Something here\n   end\nend\n</code></pre>\n\n<p>It does not match <code>Given \"the expression\" does work</code> or <code>Given \"the expression\" does not work</code> - which it should, and simply comes back with a step snippet</p>\n\n<p>Does anyone know what I'm doing wrong?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Turns out that the basic \"int\" cucumber expression is not working either, and that should be built in.</p>\n\n<pre><code>Given \"I want {int} potatoes\" do |number|\n puts \"#{number} potatoes\"\nend\n</code></pre>\n\n<p>Does not match <code>And I want 7 potatoes</code>, as an example.</p>\n\n<p>Using:</p>\n\n<ul>\n<li>cucumber v3.0.0.pre.1</li>\n<li>cucumber-expressions v3.0.0</li>\n<li>ruby v2.4.1</li>\n</ul>\n"}, {"tags": ["ruby", "rspec", "ruby-on-rails-5", "factory-bot"], "comments": [{"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498033524, "post_id": 44670445, "comment_id": 76325647, "body": "@mudasobwa just read the opposite on the FactoryGirl documentation &gt; Calling create will invoke both after_build and after_create callbacks.  <a href=\"https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#callbacks\" rel=\"nofollow noreferrer\">github.com/thoughtbot/factory_girl/blob/master/&hellip;</a>  I confirmed this when placing breakpoints in the code. Maybe this was the case in an older version of FG but not now"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498033976, "post_id": 44670445, "comment_id": 76325948, "body": "Uh, indeed, I was referring to the obsolete version of FG. Will remove the comment above, since it\u2019s irrelevant."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498034023, "post_id": 44670445, "comment_id": 76325992, "body": "Would you mind to try to explicitly <i>reload</i> the respective objects? Like <code>comp.reload.admins.first.reload.user</code>?"}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498034139, "post_id": 44670445, "comment_id": 76326078, "body": "Just tried that after a FactoryGirl.create(), it still gives nil"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498034276, "post_id": 44670445, "comment_id": 76326179, "body": "Then probably the problem is with model relations, not FG itself. <code>company.save</code> does not seem to save nested users. Try it outside FG."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498034366, "post_id": 44670445, "comment_id": 76326239, "body": "Yes most likely. In case it&#39;s relevant I am using Mongoid. I have found a fix which is to use a before_create hook to save users, since the company will not have been persisted yet"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498034349, "post_id": 44670899, "comment_id": 76326227, "body": "This obviously works, but the nested model should be saved within a parent when configured properly."}], "tags": [], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "is_accepted": true, "score": 0, "last_activity_date": 1498034296, "creation_date": 1498034296, "answer_id": 44670899, "question_id": 44670445, "link": "https://stackoverflow.com/questions/44670445/factory-girl-building-and-creating-3-related-models-association-is-lost-after-b/44670899#44670899", "title": "Factory Girl building and creating 3 related models, association is lost after build stage", "body": "<p>It would seem saving the company model first loses the 2-level deep nested user association. SO instead of </p>\n\n<pre><code>after(:create) do |comp, evaluator|\n  # First save the users\n  comp.admins.map(&amp;:user).compact.each(&amp;:save!)\n\n  # Then save admins themselves\n  comp.admins.each(&amp;:save!)\n</code></pre>\n\n<p>The following does work (still not quite sure why though)</p>\n\n<pre><code>before(:create) do |comp, evaluator|\n  # Need to save newly created 2-level deep nested users first\n  comp.admins.map(&amp;:user).compact.each(&amp;:save!)\nend\n\nafter(:create) do |comp, evaluator|\n  # Then save admins themselves\n  comp.admins.each(&amp;:save!)\nend\n</code></pre>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44670899, "answer_count": 1, "score": 1, "last_activity_date": 1498034296, "creation_date": 1498032918, "last_edit_date": 1498033616, "question_id": 44670445, "link": "https://stackoverflow.com/questions/44670445/factory-girl-building-and-creating-3-related-models-association-is-lost-after-b", "title": "Factory Girl building and creating 3 related models, association is lost after build stage", "body": "<p>I have the following models</p>\n\n<pre><code>class Company\n  has_many :admins, class_name: 'Profile::CompanyAdmin'\n\n  validates :must_have_at_least_one_admin_validation\n\n  def must_have_at_least_one_admin_validation\n    errors.add(:admins, :not_enough) if admins.size.zero?\n  end\nend\n\nclass Profile::CompanyAdmin\n  belongs_to :company\n  belongs_to :user, inverse_of: :company_admin_profiles\nend\n\nclass User\n  has_many :company_admin_profiles, inverse_of: :user\nend\n</code></pre>\n\n<p>I am trying to set up factories so I can easily build coherent data. Especially, I want to be able to <code>create(:company, *traits)</code> and it creates an Admin profile with a user account</p>\n\n<pre><code>factory :company do \n\n  transient do\n    # need one admin to pass validation\n    admins_count 1          # Admins with a user account\n    invited_admins_count 0  # Admins without user account\n  end\n\n  after(:build) do |comp, evaluator|\n    # Creating a company admin with a user\n    comp.admins += build_list(:company_admin_user,\n      evaluator.admins_count,\n      company: comp\n    ).map { |u| u.company_admin_profiles.first }\n    comp.admins += build_list(:company_admin_profile,\n      evaluator.invited_admins_count,\n      company: comp\n    )\n    comp.entities = build_list(:entity,\n      evaluator.entity_count,\n      company: comp\n    )\n    # If I debug here, I have\n    # comp.admins.first.user # =&gt; Exists !\n\n  end\n\n  after(:create) do |comp, evaluator|\n    # If I debug here\n    # comp.admins.first.user # =&gt; Gone \ud83d\ude31\n\n    # First save users of admin profiles (we need the user ID for the admin profile user foreign key)\n    comp.admins.map(&amp;:user).each(&amp;:save!)\n    # Then save admins themselves\n    comp.admins.each(&amp;:save!)\n  end\n</code></pre>\n\n<p>In the example above, when I debug at the end of the company <code>after_build</code> stage, I have successfully built admin profiles with thier users, however after the beginning of the <code>after_create</code> stage, I have lost the associated user in the admin profiles (cf comments)</p>\n\n<p>What's wrong ?</p>\n\n<p>For the reference here are the other factories for Profile/User</p>\n\n<pre><code>factory(:company_admin_user) do \n\n  transient do \n    company { build(:company, admins_count: 0) }\n  end\n\n  after(:build) do |user, evaluator|\n    user.company_admin_profiles &lt;&lt; build(:company_admin_profile,\n      company: evaluator.company,\n      user: user,\n    )\n  end\n\n  after(:create) do |user, evaluator|\n    user.rh_profiles.each(&amp;:save!)\n  end\n\nend\n\nfactory :company_admin_profile, class: Profile::CompanyAdmin do\n  company\n  user nil # By default creating a CompanyAdmin profile does not create associated user\nend\n</code></pre>\n\n<p>EDIT : </p>\n\n<p>A simpler way to see the problem</p>\n\n<p>company = FactoryGirl.build(:company)\ncompany.admins.first.user # => Exists !\ncompany.save # => true\ncompany.admins.first.user # => Nil !</p>\n"}, {"tags": ["ruby", "http", "httprequest", "http-status-code-500", "unirest"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498032763, "post_id": 44670080, "comment_id": 76325160, "body": "Can you provide a <b>cURL command</b> that does not result in a 500 error? If yes, then great -- let&#39;s find out what your ruby code is doing differently. If no, then ... We can&#39;t help."}, {"owner": {"reputation": 569, "user_id": 7355534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1rWLC.jpg?s=128&g=1", "display_name": "Bastien Robert", "link": "https://stackoverflow.com/users/7355534/bastien-robert"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498033180, "post_id": 44670080, "comment_id": 76325428, "body": "Yes sure, I&#39;ve tried with hurl.it and it work great !"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498033382, "post_id": 44670080, "comment_id": 76325549, "body": "You&#39;ve tried <b>what</b> with <code>hurl.it</code>? Edit your post to include a working example."}, {"owner": {"reputation": 569, "user_id": 7355534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1rWLC.jpg?s=128&g=1", "display_name": "Bastien Robert", "link": "https://stackoverflow.com/users/7355534/bastien-robert"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1498034109, "post_id": 44670080, "comment_id": 76326051, "body": "I tried a simple Infos.getInfos request, here you have a screen capture of the request"}], "answers": [{"comments": [{"owner": {"reputation": 40596, "user_id": 1677912, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/craWj.png?s=128&g=1", "display_name": "Mogsdad", "link": "https://stackoverflow.com/users/1677912/mogsdad"}, "edited": false, "score": 0, "creation_date": 1518141531, "post_id": 48697298, "comment_id": 84394022, "body": "A link to a solution is welcome, but please ensure your answer is useful without it: <a href=\"//meta.stackexchange.com/a/8259\">add context around the link</a> so your fellow users will have some idea what it is and why it\u2019s there, then quote the most relevant part of the page you&#39;re linking to in case the target page is unavailable. <a href=\"//stackoverflow.com/help/deleted-answers\">Answers that are little more than a link may be deleted.</a>"}], "tags": [], "owner": {"reputation": 569, "user_id": 7355534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1rWLC.jpg?s=128&g=1", "display_name": "Bastien Robert", "link": "https://stackoverflow.com/users/7355534/bastien-robert"}, "is_accepted": true, "score": -1, "last_activity_date": 1518138801, "creation_date": 1518138801, "answer_id": 48697298, "question_id": 44670080, "link": "https://stackoverflow.com/questions/44670080/ruby-uniquest-request-error-500/48697298#48697298", "title": "Ruby uniquest request : error 500", "body": "<p>Finally find the solution, script\u2019s disponible here : <a href=\"https://github.com/bastienrobert/Sellsy-API\" rel=\"nofollow noreferrer\">https://github.com/bastienrobert/Sellsy-API</a></p>\n"}], "owner": {"reputation": 569, "user_id": 7355534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1rWLC.jpg?s=128&g=1", "display_name": "Bastien Robert", "link": "https://stackoverflow.com/users/7355534/bastien-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 48697298, "answer_count": 1, "score": 0, "last_activity_date": 1518138801, "creation_date": 1498031836, "last_edit_date": 1498033622, "question_id": 44670080, "link": "https://stackoverflow.com/questions/44670080/ruby-uniquest-request-error-500", "title": "Ruby uniquest request : error 500", "body": "<p>Just get a HTTP error 500 when I try to execute this uniquest Ruby script. The goal is to make an HTTP POST request on an API which use oauth to authenticate.</p>\n\n<p>So I made 2 arrays, one for the request header and a second for the request body, but it doesn't seems to work.</p>\n\n<pre><code># Import unirest &amp; yaml (for debugging)\nrequire 'unirest'\nrequire 'yaml'\n\n# Generate Timestamp for oauth authenticate\n@timestamp = Time.now.to_i\n\n# Head array\n@toHead = {\n  \"Cache-Control\" =&gt; \"no-cache\",\n  \"Accept\" =&gt; \"*/*\",\n  \"Accept-Encoding\" =&gt; \"gzip, deflate\",\n  \"Content-Type\" =&gt; \"application/x-www-form-urlencoded\",\n  \"User-Agent\" =&gt; \"runscope/0.1\",\n  \"Content-Length\" =&gt; \"94\",\n  \"Authorization\" =&gt; {\n    \"oauth_nonce\" =&gt; '12345678',\n    \"oauth_timestamp\" =&gt; \"#{@timestamp}\",\n    \"oauth_version\" =&gt; '1.0',\n    \"oauth_signature_method\" =&gt; 'PLAINTEXT',\n    \"oauth_consumer_key\" =&gt; 'CONSUMER_KEY',\n    \"oauth_token\" =&gt; 'TOKEN_KEY',\n    \"oauth_signature\" =&gt; \"CONSUMER_SECRET&amp;TOKEN_SECRET\"\n  }\n}\n\n# Body array\n@toSend = {\n  :io_mode =&gt; \"json\",\n  :request =&gt; 1,\n  :do_in =&gt; {\n    :method =&gt; 'Client.getList',\n    :params =&gt; []\n  }\n}\n\n# Launch the request\nresponse = Unirest.post \"https://apifeed.sellsy.com/0/\",\n                        headers:@toHead,\n                        parameters:@toSend\n\n# Get the response\nresponse.code\nresponse.headers\nresponse.body\nresponse.raw_body\n</code></pre>\n\n<p>That returns an error code 500, the answer headers and an empty body :</p>\n\n<pre><code>code: 500\nheaders:\n  :server: nginx\n  :date: Wed, 21 Jun 2017 07:43:03 GMT\n  :content_type: application/json; encoding=utf-8\n  :content_length: '0'\n  :connection: keep-alive\n  :keep_alive: timeout=10\nraw_body: ''\nbody: ''\n</code></pre>\n\n<p>EDIT : I tried with hurl.it, for a simple post request, and It works great : <a href=\"https://i.stack.imgur.com/uJRoJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uJRoJ.jpg\" alt=\"Hurl.it request\"></a></p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 5, "creation_date": 1498028894, "post_id": 44669016, "comment_id": 76322730, "body": "Just remove it from <code>message1</code> after you get the match. There is no way to capture non-continuous parts of texts into 1 group."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1498029560, "post_id": 44669016, "comment_id": 76323127, "body": "Another way would be to match <code>LogMessage:INFO:</code> and <code>sm-Server-02110</code> separately and concatenate them afterwards."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498030700, "post_id": 44669016, "comment_id": 76323878, "body": "@mudasobwa: If you have time, please post an answer showing this approach. Or maybe both."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1498031139, "post_id": 44669016, "comment_id": 76324156, "body": "@WiktorStribi\u017cew done"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1498031132, "creation_date": 1498031132, "answer_id": 44669849, "question_id": 44669016, "link": "https://stackoverflow.com/questions/44669016/ruby-regex-select-without-a/44669849#44669849", "title": "Ruby regex select without a [", "body": "<p>The answer below is posted by Wiktor Stribi\u017cew\u2019s request in comments.</p>\n\n<p><strong>There is no way to capture non-continuous parts of texts into 1 group.</strong> Hence, we have two different possibilities:</p>\n\n<p>\u00a01. (by Wiktor Stribi\u017cew):</p>\n\n<pre><code>input = \"[LogMessage:INFO:[sm-Server-02110] Product=Policy\"\ninput =~ /^\\[(?&lt;message1&gt;\\S+)\\]\\s(?&lt;message2&gt;.*)$/\n[$~[:message1].delete('['), $~[:message2]]\n#\u21d2 [\n#    [0] \"LogMessage:INFO:sm-Server-02110\",\n#    [1] \"Product=Policy\"\n# ]\n</code></pre>\n\n<p>\u00a02. (by mudasobwa):</p>\n\n<pre><code>input =~ /^\\[(?&lt;message1_1&gt;.+?)\\[(?&lt;message1_2&gt;.+?)\\]\\s(?&lt;message2&gt;.*)$/\n[$~[:message1_1] + $~[:message1_2], $~[:message2]]\n#\u21d2 [\n#    [0] \"LogMessage:INFO:sm-Server-02110\",\n#    [1] \"Product=Policy\"\n# ]\n</code></pre>\n"}], "owner": {"reputation": 914, "user_id": 5829792, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh4.googleusercontent.com/-mcTxAoDeAKw/AAAAAAAAAAI/AAAAAAAAAJk/ASirmDgZYEk/photo.jpg?sz=128", "display_name": "Rajkumar .E", "link": "https://stackoverflow.com/users/5829792/rajkumar-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498031132, "creation_date": 1498028798, "question_id": 44669016, "link": "https://stackoverflow.com/questions/44669016/ruby-regex-select-without-a", "title": "Ruby regex select without a [", "body": "<p>I need to select letter without <strong>[</strong> in my log(meassage1).</p>\n\n<p><strong>My Log:</strong></p>\n\n<pre><code> [LogMessage:INFO:[sm-Server-02110] Product=PolicyServer,Platform=Linux 2.6.32-573.8.1.el6.x86_64,Version=12.52,Update=01.01,Label=640,Crypto=128,UTC=1456285048,TZ=0][]\n</code></pre>\n\n<p><strong>My Regex:</strong></p>\n\n<pre><code> \\[(?&lt;message1&gt;\\S+)\\]\\s(?&lt;message2&gt;.*)\\]\\[(?&lt;data&gt;[^\\]]*)\\]$\n</code></pre>\n\n<p><strong>Matches:</strong></p>\n\n<pre><code>message1    LogMessage:INFO:[sm-Server-02110\nmessage2    Product=PolicyServer,Platform=Linux    2.6.32-573.8.1.el6.x86_64,Version=12.52,Update=01.01,Label=640,Crypto=128,UTC=1456285048,TZ=0\ndata\n</code></pre>\n\n<p><strong>Reference:</strong>  <a href=\"http://rubular.com/r/urCvQMdRlB\" rel=\"nofollow noreferrer\">http://rubular.com/r/urCvQMdRlB</a></p>\n\n<p>I need to match result <code>message1   LogMessage:INFO:sm-Server-02110</code> instead of <code>message1  LogMessage:INFO:[sm-Server-02110</code></p>\n\n<p><strong>I tried below way:</strong></p>\n\n<pre><code>\\[(?&lt;message1&gt;[^[].*)\\]\\s(?&lt;message2&gt;.*)\\]\\[(?&lt;data&gt;[^\\]]*)\\]$\n</code></pre>\n\n<p>but its throw <strong>Premature end of char-class.</strong></p>\n\n<p>Suggest me How to select value with out select this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "rake-task"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 5, "creation_date": 1498028227, "post_id": 44668782, "comment_id": 76322343, "body": "<a href=\"https://github.com/rails/rails/blob/2dfe8f1f84b7c4ff6673e7035adbeecaf31734b0/railties/lib/rails/tasks/engine.rake#L31\" rel=\"nofollow noreferrer\">Link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "edited": false, "score": 0, "creation_date": 1498083661, "post_id": 44671070, "comment_id": 76358363, "body": "so this task can be run regardless of have a rails server running?"}, {"owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "reply_to_user": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "edited": false, "score": 1, "creation_date": 1498108634, "post_id": 44671070, "comment_id": 76364711, "body": "Yes, Rake Task don&#39;t need server running."}], "tags": [], "owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "is_accepted": false, "score": 1, "last_activity_date": 1498034739, "creation_date": 1498034739, "answer_id": 44671070, "question_id": 44668782, "link": "https://stackoverflow.com/questions/44668782/where-does-bundle-exec-rake-dbmigrate-come-from/44671070#44671070", "title": "Where does bundle exec rake db:migrate come from?", "body": "<p>The <code>db:migrate</code> is a rake task. db:migrate task <strong>(a built-in Rails support program)</strong> will search through your project's db/migrate directory and use the files therein to update the database's schema.</p>\n\n<p>When you run db:migrate, rails will check a special table called schema_migrations which contains the time-stamp of the last migration applied to the database. it will store the times-tamps of the migration files that were already run.</p>\n"}, {"comments": [{"owner": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "edited": false, "score": 0, "creation_date": 1498113875, "post_id": 44671999, "comment_id": 76367277, "body": "Thanks @Aschen So rake can be used to do a lot of things, but rails comes with some rake tasks and one of them is db:migrate and it is just a build tool (script) that accesses the <code>ActiveRecord::Migrator</code> and then calls its <code>migrate</code> method? Is this correct?"}, {"owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "reply_to_user": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "edited": false, "score": 0, "creation_date": 1498119458, "post_id": 44671999, "comment_id": 76370837, "body": "Yes it&#39;s correct :-) As @hardik says it also check in the table <code>schema_migrations</code> which migrations have already been executed."}], "tags": [], "owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "is_accepted": true, "score": 2, "last_activity_date": 1498037127, "creation_date": 1498037127, "answer_id": 44671999, "question_id": 44668782, "link": "https://stackoverflow.com/questions/44668782/where-does-bundle-exec-rake-dbmigrate-come-from/44671999#44671999", "title": "Where does bundle exec rake db:migrate come from?", "body": "<p>This task is part of <code>ActiveRecord</code>. You can see where it is defined here : <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/tasks/database_tasks.rb#L164\" rel=\"nofollow noreferrer\">database_tasks.rb</a></p>\n\n<p>Basically the task call <code>ActiveRecord::Migrator</code> which is the module in charge of applying migrations to the database.</p>\n\n<p>For example if you create a new migration and you get the following output : </p>\n\n<pre><code>Running via Spring preloader in process 4675\n      invoke  active_record\n      create    db/migrate/20170621091940_create_user.rb\n</code></pre>\n\n<p>When you call the <code>db:migrate</code> task it will call <code>ActiveRecord::Migrator.migrate(\"db/migrate\", 20170621091940)</code> and apply your migration.</p>\n"}], "owner": {"reputation": 7599, "user_id": 6730305, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/g0QG2.jpg?s=128&g=1", "display_name": "stackjlei", "link": "https://stackoverflow.com/users/6730305/stackjlei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 44671999, "answer_count": 2, "score": -2, "last_activity_date": 1498037127, "creation_date": 1498028038, "question_id": 44668782, "link": "https://stackoverflow.com/questions/44668782/where-does-bundle-exec-rake-dbmigrate-come-from", "title": "Where does bundle exec rake db:migrate come from?", "body": "<p>I'd to see where this rake task is written and how it finds the db to migrate to.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1498028485, "post_id": 44668705, "comment_id": 76322489, "body": "According to <a href=\"http://railsdiff.org/4.2.7/5.1.1\" rel=\"nofollow noreferrer\">RailsDiff</a> fresh Rails applications in Version <code>4.2.7</code> and <code>5.1.1</code> have quite different a structure and file contents. Why do you expect that an application that was generated with the latest version can be run with a version that is almost a year old?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1498028571, "post_id": 44668705, "comment_id": 76322542, "body": "Just regenerate the app."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498028650, "post_id": 44668705, "comment_id": 76322586, "body": "I wonder how this ...uhhhhm question got 2 upvotes."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1498029292, "creation_date": 1498029292, "answer_id": 44669189, "question_id": 44668705, "link": "https://stackoverflow.com/questions/44668705/project-stopped-working-after-downgrading-rails-version/44669189#44669189", "title": "Project stopped working after downgrading Rails version", "body": "<p>A Rails application generated with version 5.1.1 includes this line:</p>\n\n<pre><code># in config/application.rb:12\nconfig.load_defaults 5.1\n</code></pre>\n\n<p><code>load_defaults</code> is a method that was introduced in Rails 5 and does not exist in Rails 4.2.x</p>\n\n<p>That said, you cannot just downgrade a Rails version (btw you usually cannot just upgrade either). You need to change your application to the structure the other Rails version is expecting. <a href=\"http://railsdiff.org/\" rel=\"nofollow noreferrer\">RailsDiff</a> is a great resource to see the differences between applications generated with different versions of Rails.</p>\n\n<p>You have two options:</p>\n\n<ol>\n<li>Adopt the changes between the versions or</li>\n<li>Regenerate a new application with the desired version.</li>\n</ol>\n"}], "owner": {"reputation": 4659, "user_id": 3164751, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jLKLy.jpg?s=128&g=1", "display_name": "Amrinder Singh", "link": "https://stackoverflow.com/users/3164751/amrinder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 44669189, "answer_count": 1, "score": 3, "last_activity_date": 1498029292, "creation_date": 1498027768, "last_edit_date": 1498028514, "question_id": 44668705, "link": "https://stackoverflow.com/questions/44668705/project-stopped-working-after-downgrading-rails-version", "title": "Project stopped working after downgrading Rails version", "body": "<p>Initially i was using rails version 5.1.1, but when i downgraded it to 4.2.7 then it started giving me the following error:</p>\n\n<pre><code>`method_missing': undefined method `load_defaults'\n</code></pre>\n\n<p>whenever i try to run \"rails s\" it shows the above error in terminal, it is just a fresh project, i just installed a new project by using \"rails new \", then i changed the rails version in gem file to</p>\n\n<pre><code>gem 'rails', '~&gt; 4.2.7'\n</code></pre>\n\n<p>then after doing this when i tried to hit \"rails s\" it started giving me that error.</p>\n\n<p>Any ideas why is this happening?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "user-interface", "web"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 3, "creation_date": 1498026610, "post_id": 44668329, "comment_id": 76321441, "body": "add option <code>multiple: true</code> with select"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8165687"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1498027155, "post_id": 44668329, "comment_id": 76321717, "body": "Hi! Ty mr. Deepak. Is now working ty!"}], "owner": {"user_type": "does_not_exist", "display_name": "user8165687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498026482, "creation_date": 1498026482, "question_id": 44668329, "link": "https://stackoverflow.com/questions/44668329/rails-how-to-make-select-list", "title": "Rails: How to make select list", "body": "<p>I would like multiple line select with scrollbar in Ruby on Rails like in this img:\n   <a href=\"https://i.stack.imgur.com/Kkq0u.jpg\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/Kkq0u.jpg</a></p>\n\n<pre><code>  &lt;select size=\"3\"&gt;\n    &lt;option value=\"sy\"&gt;sy&lt;/option&gt;\n    &lt;option value=\"malakal\"&gt;malakal&lt;/option&gt;\n    &lt;option value=\"pigs go moo\"&gt;pigs go moo&lt;/option&gt;\n  &lt;/select&gt;\n</code></pre>\n\n<p>However I am unable find option for do this &amp; only achieve dropdown\n   <a href=\"https://i.stack.imgur.com/5jcdP.jpg\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/5jcdP.jpg</a></p>\n\n<pre><code> &lt;%= form.collection_select(:player_id, Player.all, :id, :name) %&gt;\n</code></pre>\n\n<p>How do I make the dropdown into a list like in 1st image?</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1498024216, "post_id": 44667656, "comment_id": 76320365, "body": "Your URL is a <code>String</code>. When you get the error, it is an <code>URI</code>. Can&#39;t tell you more without a stacktrace, unfortunately (since the <code>gsub</code> is clearly not in the code you just pasted)."}, {"owner": {"reputation": 551, "user_id": 1615933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49181dd16c88bded716219782c57ad6?s=128&d=identicon&r=PG", "display_name": "N3SS4H", "link": "https://stackoverflow.com/users/1615933/n3ss4h"}, "edited": false, "score": 1, "creation_date": 1498024658, "post_id": 44667656, "comment_id": 76320549, "body": "are you sure that Chef::HTTP.new expects a URI?  have you tried passing a string value?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1498024904, "post_id": 44667656, "comment_id": 76320674, "body": "<code>Chef::HTTP.new(url)</code> will work (the initializer expects a string there.)"}, {"owner": {"reputation": 11, "user_id": 8090069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1315243681864013/picture?type=large", "display_name": "Kushal Warke", "link": "https://stackoverflow.com/users/8090069/kushal-warke"}, "reply_to_user": {"reputation": 551, "user_id": 1615933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49181dd16c88bded716219782c57ad6?s=128&d=identicon&r=PG", "display_name": "N3SS4H", "link": "https://stackoverflow.com/users/1615933/n3ss4h"}, "edited": false, "score": 0, "creation_date": 1498027049, "post_id": 44667656, "comment_id": 76321658, "body": "@vhutchison yes. I have tried passing the url that i have declared in prgram. It is working on that. Url is string."}, {"owner": {"reputation": 11, "user_id": 8090069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1315243681864013/picture?type=large", "display_name": "Kushal Warke", "link": "https://stackoverflow.com/users/8090069/kushal-warke"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1498027480, "post_id": 44667656, "comment_id": 76321926, "body": "@Amadan I have removed the uri parsed part. Now input is the subnet string i am getting from user. I am appending it to current url. When I tried to give it to Chef::HTTP.new(url) it is giving &quot;had an error: URI::InvalidURIError: bad URI(is not URI?): <a href=\"https://company.in.example.net:port/ha/100.1.100.1\" rel=\"nofollow noreferrer\">company.in.example.net:port/ha/100.1.100.1</a>&quot;."}, {"owner": {"reputation": 11, "user_id": 8090069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1315243681864013/picture?type=large", "display_name": "Kushal Warke", "link": "https://stackoverflow.com/users/8090069/kushal-warke"}, "edited": false, "score": 0, "creation_date": 1498027869, "post_id": 44667656, "comment_id": 76322145, "body": "Issue is resolved. I used url.chomp before passing it to Chef::HTTP.new(url). So basically after giving input ruby automatically adds newline character. Because of that it was causing bad url error. url.stomp removes that character. Anyways thanks for the help everyone."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1498048777, "post_id": 44667656, "comment_id": 76336756, "body": "Using <code>gets</code> in Chef code is really weird and almost certainly incorrect. There will not be a user present most of the time chef-client is run."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8090069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1315243681864013/picture?type=large", "display_name": "Kushal Warke", "link": "https://stackoverflow.com/users/8090069/kushal-warke"}, "edited": false, "score": 0, "creation_date": 1498045743, "post_id": 44672485, "comment_id": 76334415, "body": "Yes. The error was because of not including chomp. It is fixed now. Thanks"}], "tags": [], "owner": {"reputation": 1338, "user_id": 720254, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/drkkb.jpg?s=128&g=1", "display_name": "Francesco Boffa", "link": "https://stackoverflow.com/users/720254/francesco-boffa"}, "is_accepted": true, "score": 0, "last_activity_date": 1498038223, "creation_date": 1498038223, "answer_id": 44672485, "question_id": 44667656, "link": "https://stackoverflow.com/questions/44667656/undefined-method-gsub-for-urihttps0x0000000404f3b8/44672485#44672485", "title": "Undefined method `gsub&#39; for #&lt;URI::HTTPS:0x0000000404f3b8&gt;", "body": "<p>There are a few issues with your code.</p>\n\n<p>First of all you're getting <code>URI::InvalidURIError: bad URI(is not URI?)</code> because what you are passing is not a semantically valid URI.</p>\n\n<pre><code>url = 'https://company.in.example.net:port/ha/'\n</code></pre>\n\n<p>I suspect that you didn't replace the <code>:port</code> with an actual port number. </p>\n\n<p>Second, you're receiving user input without removing trailing whitespace. You should read your line as:</p>\n\n<pre><code>input = gets.chomp\n</code></pre>\n\n<p>Otherwise your input would have a trailing <code>\\n</code>, giving you an invalid URI.</p>\n\n<p>Third, if you're getting the gsub error is because Chef is probably expecting to receive a <code>String</code>, not an <code>URI</code> object. You can easily convert the URI to string like this:</p>\n\n<pre><code>Chef::HTTP.new(uri.to_s)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8090069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1315243681864013/picture?type=large", "display_name": "Kushal Warke", "link": "https://stackoverflow.com/users/8090069/kushal-warke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 44672485, "answer_count": 1, "score": 0, "last_activity_date": 1498038223, "creation_date": 1498023731, "last_edit_date": 1498024097, "question_id": 44667656, "link": "https://stackoverflow.com/questions/44667656/undefined-method-gsub-for-urihttps0x0000000404f3b8", "title": "Undefined method `gsub&#39; for #&lt;URI::HTTPS:0x0000000404f3b8&gt;", "body": "<p>I am trying to use Http::get request on url entered by user. In one recipe I have url \"<a href=\"https://company.in.example.net:port/ha\" rel=\"nofollow noreferrer\">https://company.in.example.net:port/ha</a>\". This recipe prints the subnets available. User will select the subnet and give it as input. Suppose user gives \"100.1.100.1\" then I need to append it to existing url and perform http::get action on that. So the new url should be \"<a href=\"https://company.in.example.net:port/ha/100.1.100.1\" rel=\"nofollow noreferrer\">https://company.in.example.net:port/ha/100.1.100.1</a>\" I have written following script.</p>\n\n<pre><code>url = 'https://company.in.example.net:port/ha/'\nruby_block 'run_my_template_resource' do\n   action :create\n   block do\n     puts \"Enter subnet: \"\n     input = gets\n     url = url + input\n     puts url\n     uri =  URI.parse(URI.encode(url.to_s))\n     r = Chef::Resource::Template.new('default',run_context)\n     r.path       '/etc/app.conf'\n     r.source     'app.conf.erb'\n     r.cookbook   'testbook'\n     r.owner      'root'\n     r.group      'root'\n     r.mode       00600\n     r.variables({\n     my_id: Chef::HTTP.new(uri).get('/',{ 'user-principal' =&gt; \n '{\"userName\":\"user\",\"password\":\"pass\"}', 'Accept' =&gt; 'application/json', \n 'Content-Type' =&gt; 'application/json' })\n    })\n     r.run_action :create\n   end\n end\n</code></pre>\n\n<p>Here puts url printing correct url. When I run the recipe I am getting error <code>NoMethodError: undefined method</code>gsub' for #` Any help will be highly appreciated. \nThanks :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1498020388, "post_id": 44666880, "comment_id": 76319019, "body": "Why is it an issue when Rails selects more columns? Why do you use <code>eager_load</code> instead of <code>joins</code>?"}, {"owner": {"reputation": 20898, "user_id": 11194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ee76d05f9b62656b9eeaa81fe4619db?s=128&d=identicon&r=PG", "display_name": "Ash", "link": "https://stackoverflow.com/users/11194/ash"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1498020693, "post_id": 44666880, "comment_id": 76319115, "body": "Because they&#39;re not included in the aggregate function or the group by, the SQL will fail to execute.  Eager_load gives me LEFT OUTER JOIN whilst a joins will give me a INNER JOIN."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8192061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154741237762218/picture?type=large", "display_name": "omnihound", "link": "https://stackoverflow.com/users/8192061/omnihound"}, "is_accepted": true, "score": 1, "last_activity_date": 1498021789, "creation_date": 1498021789, "answer_id": 44667254, "question_id": 44666880, "link": "https://stackoverflow.com/questions/44666880/activerecord-automatically-overriding-specifically-selected-fields/44667254#44667254", "title": "ActiveRecord automatically overriding specifically selected fields", "body": "<p>The problem is with eager_load which appears to indiscriminately add all the fields of the associated model, ignoring your 'selects'. If you change it to joins for the INNER JOIN instead of the LEFT OUTER JOIN then it accepts your select and works as intended.</p>\n"}], "owner": {"reputation": 20898, "user_id": 11194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ee76d05f9b62656b9eeaa81fe4619db?s=128&d=identicon&r=PG", "display_name": "Ash", "link": "https://stackoverflow.com/users/11194/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 44667254, "answer_count": 1, "score": 0, "last_activity_date": 1498021789, "creation_date": 1498019204, "last_edit_date": 1498021299, "question_id": 44666880, "link": "https://stackoverflow.com/questions/44666880/activerecord-automatically-overriding-specifically-selected-fields", "title": "ActiveRecord automatically overriding specifically selected fields", "body": "<p>I have the following code:</p>\n\n<pre><code>L.select('\"l\".\"id\", \"ps\".\"name\", \"ps\".\"proposed_start\", \"ps\".\"proposed_finished\", COUNT(*) as total, SUM(EXTRACT(EPOCH FROM (\"l\".\"stop_at\" - \"l\".\"start_at\"))) as duration, COUNT(CASE WHEN \"l\".\"stop_at\" IS NULL THEN 1 ELSE NULL END) as ongoing').\n  where(p_id: P.where.not(name: nil).select(:id)).\n  eager_load(:p).\n  group('\"l\".\"id\"')\n</code></pre>\n\n<blockquote>\n  <p>Note: <code>P.where.not(name: nil)</code> is just a random condition, in prod it\n  will be filtering out P's that don't belong to the user, but its not\n  <em>entirely</em> relevant to the question its there so I could confirm that ActiveRecord would run it as a sub-query.  I've also renamed the\n  models to L and P to obfuscate my project. Also I know the aggregate\n  function in my select are not SQL agnostic, I am using Postgresql.</p>\n</blockquote>\n\n<p>However, when I run <code>.to_sql</code> to inspect what resulting SQL ActiveRecord will produce I discover to my dismay that I end up with:</p>\n\n<pre><code>SELECT \"l\".\"id\", \n       \"p\".\"name\", \n       \"p\".\"proposed_start\", \n       \"p\".\"proposed_finished\", \n       Count(*)                                                    AS total, \n       Sum(Extract(epoch FROM ( \"l\".\"stop_at\" - \"l\".\"start_at\" ))) AS duration, \n       Count(CASE \n               WHEN \"l\".\"stop_at\" IS NULL THEN 1 \n               ELSE NULL \n             END)                                                  AS ongoing, \n       \"l\".\"id\"                                                    AS t0_r0, \n       \"l\".\"p_id\"                                                  AS t0_r1, \n       \"l\".\"user_id\"                                               AS t0_r2, \n       \"l\".\"start_at\"                                              AS t0_r3, \n       \"l\".\"stop_at\"                                               AS t0_r4, \n       \"l\".\"comment\"                                               AS t0_r5, \n       \"l\".\"created_at\"                                            AS t0_r6, \n       \"l\".\"updated_at\"                                            AS t0_r7, \n       \"l\".\"deleted_at\"                                            AS t0_r8, \n       \"l\".\"deleted_by_id\"                                         AS t0_r9, \n       \"p\".\"id\"                                                    AS t1_r0, \n       \"p\".\"name\"                                                  AS t1_r1, \n       \"p\".\"approved_by_id\"                                        AS t1_r2, \n       \"p\".\"user_id\"                                               AS t1_r3, \n       \"p\".\"proposed_start\"                                        AS t1_r4, \n       \"p\".\"proposed_finished\"                                     AS t1_r5, \n       \"p\".\"created_at\"                                            AS t1_r6, \n       \"p\".\"updated_at\"                                            AS t1_r7, \n       \"p\".\"p_status_id\"                                           AS t1_r8, \n       \"p\".\"approved_at\"                                           AS t1_r9, \n       \"p\".\"sub_unit_id\"                                           AS t1_r10, \n       \"p\".\"details\"                                               AS t1_r11, \n       \"p\".\"archived_at\"                                           AS t1_r12, \n       \"p\".\"archived_by_id\"                                        AS t1_r13 \nFROM   \"l\" \n       LEFT OUTER JOIN \"p\" \n                    ON \"p\".\"id\" = \"l\".\"p_id\" \nWHERE  \"l\".\"deleted_at\" IS NULL \n       AND \"l\".\"p_id\" IN (SELECT \"p\".\"id\" \n                          FROM   \"p\" \n                          WHERE  ( \"p\".\"name\" IS NOT NULL )) \nGROUP  BY \"l\".\"id\" \n</code></pre>\n\n<p>As you can see, ActiveRecord is automatically selecting all of the fields of the joined table \"p\" as well as my specific select. How can I stop it from doing that?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1498077549, "post_id": 44666731, "comment_id": 76355773, "body": "You could try to start up your rails server in production environment and track this bug down"}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 8159914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XApNb.jpg?s=128&g=1", "display_name": "Sowmiya Sangaiah", "link": "https://stackoverflow.com/users/8159914/sowmiya-sangaiah"}, "is_accepted": false, "score": 0, "last_activity_date": 1498114193, "creation_date": 1498114193, "answer_id": 44692118, "question_id": 44666731, "link": "https://stackoverflow.com/questions/44666731/rails-duplicate-validation-error-messages-only-in-production/44692118#44692118", "title": "Rails: Duplicate validation error messages only in production", "body": "<p>Kindly check whether this link helps you in getting rid of the bug. since your entire code was not there above.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29038232/errors-are-displayed-twice-in-rails\">Errors are displayed twice in rails</a></p>\n"}], "owner": {"reputation": 9910, "user_id": 5898312, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Gcwsi.jpg?s=128&g=1", "display_name": "Tony Vincent", "link": "https://stackoverflow.com/users/5898312/tony-vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 568, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1498114193, "creation_date": 1498018128, "last_edit_date": 1498022331, "question_id": 44666731, "link": "https://stackoverflow.com/questions/44666731/rails-duplicate-validation-error-messages-only-in-production", "title": "Rails: Duplicate validation error messages only in production", "body": "<p>I am using <a href=\"https://github.com/daddyz/phonelib\" rel=\"nofollow noreferrer\">phonelib</a> gem for phone number validation.\nIn my user model, <code>user.rb</code> I have</p>\n\n<pre><code>validates :phone, phone: { allow_blank: true, message: \"Please enter valid contact number\" }\n</code></pre>\n\n<p>In <code>_form.html.erb</code></p>\n\n<pre><code>&lt;%= f.number_field :phone, :maxlength =&gt; '16', class: 'phone-number' %&gt;\n&lt;%= f.error_message_on :phone %&gt;\n</code></pre>\n\n<p>When a user enters invalid phone number I am getting the error message <em>\"Please enter valid contact number\"</em> twice.\n<a href=\"https://i.stack.imgur.com/vXXcn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vXXcn.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also I have another validation</p>\n\n<pre><code>validates_presence_of :company_type, message: 'Please enter your company type'\n</code></pre>\n\n<p>and in my partial</p>\n\n<pre><code>&lt;%= f.select :company_type, [], { prompt: false }, class: 'company-type' %&gt;\n&lt;%= f.error_message_on :company_type %&gt;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/O3UnU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O3UnU.png\" alt=\"enter image description here\"></a></p>\n\n<p>The strange thing is <strong>this happens only in production</strong> and not in development environment. Can anyone help me figure out what is causing this behaviour? Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "edited": false, "score": 1, "creation_date": 1498019416, "post_id": 44666310, "comment_id": 76318737, "body": "In the week <code>2017-05-08</code>, is points <code>0</code> or <code>nil</code> ?"}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "reply_to_user": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "edited": false, "score": 0, "creation_date": 1498020276, "post_id": 44666310, "comment_id": 76318982, "body": "nil, no records exist for that week in this case..."}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "reply_to_user": {"reputation": 584, "user_id": 7159326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3bce136965a79ceb3a45f93bdbac3c?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane El Kesri", "link": "https://stackoverflow.com/users/7159326/othmane-el-kesri"}, "edited": false, "score": 0, "creation_date": 1498020373, "post_id": 44666310, "comment_id": 76319012, "body": "to be clear there is no result returned for that week, it just skips that week as seen above in the return results I provided."}], "answers": [{"comments": [{"owner": {"reputation": 4577, "user_id": 4147191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zNy4Unw5fq8/AAAAAAAAAAI/AAAAAAAAAP8/kQW6cfxt280/photo.jpg?sz=128", "display_name": "\u0141ukasz Kami\u0144ski", "link": "https://stackoverflow.com/users/4147191/%c5%81ukasz-kami%c5%84ski"}, "edited": false, "score": 2, "creation_date": 1498045356, "post_id": 44668301, "comment_id": 76334124, "body": "Solution is good, but that join will not work because timestamps produced by <code>generate_series</code> and <code>date_trunc</code> won&#39;t match if you start from 2017-01-01. You need to <code>date_trunc(&#39;week&#39;</code> your starting date."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1498052007, "post_id": 44668301, "comment_id": 76339434, "body": "@Nick I find plain SQL in an ORM like this to be out of place. <code>Arel</code> the underlying query assembler for rails/activerecord can assemble any valid SQL using code rather than plain strings. Also in most cases it allows you to merge the results into a true AR Object"}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498054357, "post_id": 44668301, "comment_id": 76341206, "body": "@engineersmnky thank you. Is there a way to do this w rails?"}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "edited": false, "score": 0, "creation_date": 1498056741, "post_id": 44668301, "comment_id": 76343215, "body": "@nick I appreciate the reply but would love to find a Rails way of doing this...."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "edited": false, "score": 0, "creation_date": 1498062897, "post_id": 44668301, "comment_id": 76347541, "body": "@AnnaSm I have posted an answer although I am certain it may be confusing it should return the results requested. <b>Nick</b> thank you for the suggested SQL it made creating the query a bit simpler when I didn&#39;t have to figure out how to generate the weeks (I don&#39;t use postgres much)"}, {"owner": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498142953, "post_id": 44668301, "comment_id": 76388373, "body": "Here is a good fresh article explaining that generation of dates: <a href=\"http://www.craigkerstiens.com/2017/06/08/working-with-time-in-postgres/\" rel=\"nofollow noreferrer\">craigkerstiens.com/2017/06/08/working-with-time-in-postgres</a>"}, {"owner": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498143034, "post_id": 44668301, "comment_id": 76388429, "body": "generate_series() is a standard built-in function, very useful to generate series of integers or dates."}, {"owner": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498143195, "post_id": 44668301, "comment_id": 76388561, "body": "AnnaSm, again (I won&#39;t stop to say it) -- learn plain SQL and use it in advanced cases. And just use AR&#39;s &quot;execute&quot; method."}], "tags": [], "owner": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "is_accepted": false, "score": 2, "last_activity_date": 1498144626, "last_edit_date": 1498144626, "creation_date": 1498026383, "answer_id": 44668301, "question_id": 44666310, "link": "https://stackoverflow.com/questions/44666310/with-date-truncweek-return-a-record-if-the-weeks-sumpoints-has-0/44668301#44668301", "title": "With DATE_TRUNC(&#39;week&#39;), Return a record if the week&#39;s .sum(:points) has 0?", "body": "<p>First of all, I strongly recommend to start learning and using plain SQL to perform such tasks. Active Record (like any other ORM) is good only for simple tasks. Sooner or later you will need to dig into Postgres logs and find what exact SQL queries your RoR AR has produced, why they are not optimal or why these queries give you now what you want.</p>\n\n<p>Now regarding your question itself. I would do it like this, using LEFT JOIN and CTE (see <a href=\"https://www.postgresql.org/docs/current/static/queries-with.html\" rel=\"nofollow noreferrer\">https://www.postgresql.org/docs/current/static/queries-with.html</a>):</p>\n\n<pre><code>with dates(period) as (\n  select generate_series\n  from generate_series(\n    '2017-01-01'::timestamp,\n    now(),\n    interval '1 week'\n  )\n)\nselect\n  period,\n  points\nfrom\n  dates\nleft join log_table on date_trunc('week', created_at) = date_trunc('week', period)\ngroup by 1\norder by 1\n;\n</code></pre>\n\n<p>CTE are standard SQL feature and they are really worth to learn and use.</p>\n\n<p>To work with data in the database, consider using database (SQL) first. </p>\n\n<p>There is even an ideology with increasing popularity -- #DatabaseFirst.</p>\n\n<p>If you have doubts here are some good articles related to this topic:</p>\n\n<p><a href=\"http://database-programmer.blogspot.co.at/2010/12/historical-perspective-of-orm-and.html?m=1\" rel=\"nofollow noreferrer\">http://database-programmer.blogspot.co.at/2010/12/historical-perspective-of-orm-and.html?m=1</a></p>\n\n<p><a href=\"http://tapoueh.org/blog/2017/06/sql-and-business-logic/\" rel=\"nofollow noreferrer\">http://tapoueh.org/blog/2017/06/sql-and-business-logic/</a></p>\n\n<p><a href=\"http://tapoueh.org/blog/2017/06/how-to-write-sql/\" rel=\"nofollow noreferrer\">http://tapoueh.org/blog/2017/06/how-to-write-sql/</a></p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498143726, "post_id": 44681625, "comment_id": 76389018, "body": "@Nick yes harder to read for sure but ensures SQL escaping, extensibility (could be separated into common components for use in other queries) and is far easier to debug"}, {"owner": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498144866, "post_id": 44681625, "comment_id": 76389890, "body": "&quot;send&quot; / &quot;execute&quot; with whole SQL and SQL escaping are not mutually exclusive things. While splitting well-readable SQL to chunks makes it non-readable and increases maintenance costs (to analyze and optimize SQL, you&#39;ll need to grep logs, trace proper queries somehow, and then deal with plain SQL eventually)."}, {"owner": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498145281, "post_id": 44681625, "comment_id": 76390170, "body": "&quot;far easier to debug&quot; -- sorry no. Debugging SQL and its performance in such approach is a nightmare."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 1955, "user_id": 4677351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd83ef0697453605e940498271634031?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4677351/nick"}, "edited": false, "score": 0, "creation_date": 1498145387, "post_id": 44681625, "comment_id": 76390239, "body": "@Nick to each their own. I have built massive reporting libraries based on <code>Arel</code> composition (outside of rails) that are extremely extensible and maintainable but thank you for chiming in"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1498067011, "last_edit_date": 1498067011, "creation_date": 1498062722, "answer_id": 44681625, "question_id": 44666310, "link": "https://stackoverflow.com/questions/44666310/with-date-truncweek-return-a-record-if-the-weeks-sumpoints-has-0/44681625#44681625", "title": "With DATE_TRUNC(&#39;week&#39;), Return a record if the week&#39;s .sum(:points) has 0?", "body": "<p>Please be advised I did not take the time to recreate your structure.</p>\n\n<p><strong>Warning For Other Readers</strong> </p>\n\n<blockquote>\n  <p>Older versions of Arel do not assemble CTE statements. (I have had issues with versions &lt; 6.0 the methods are there  but for some reason the \"With\" portion of the query does not get generated) For these versions use sub-queries rather than CTE. </p>\n</blockquote>\n\n<p>The first thing I would do for this type of functionality is create a service object to handle this specific case. (So let's start there) </p>\n\n<pre><code>class UserPointsByWeek\n  attr_reader :user\n\n\n  def initialize(user)\n    @user = user\n  end\nend\n</code></pre>\n\n<p>Now for the heavy lifting to build the appropriate query (BTW Thank @Nick for his contribution as I built this based on his suggestion along with @\u0141ukaszKami\u0144ski comment) </p>\n\n<pre><code>class UserPointsByWeek\n  attr_accessor :weeks_back\n  # ...\n  # results returned as an Array of Hashes \n  # [{week: ####-##-##, weekly_points: N},{week: ####-##-##, weekly_points: N}]\n  def weekly_points\n    @points_by_week ||= ActiveRecord::Base.connection.exec_query(to_sql).to_hash\n  end\n  #Show the SQL generated\n  def to_sql\n    result.to_sql\n  end\n\n\n  private\n    #This is the actual query that will be executed\n    def result\n      all_weeks.project(\n        all_weeks[:week],\n        log_table[:points].sum.as('weekly_points')\n      ).with([first_week_table,all_weeks_table]).\n      join(log_table,Arel::Nodes::OuterJoin).on(\n        all_weeks[:week].eq(\n          Arel::Nodes::NamedFunction.new('DATE_TRUNC',\n            [\n              Arel::Nodes::SqlLiteral.new(\"'week'\"),\n              log_table[:created_at]\n            ])\n          ).and(log_table[:user_id].eq(@user.id))\n      ).group(\n        all_weeks[:week]\n      )\n    end\n\n    def rollback\n      if @weeks_back \n        Arel::Nodes::NamedFunction.new('DATE_TRUNC',[\n             Arel::Nodes::SqlLiteral.new(\"'week'\"),\n             Arel::Nodes::SqlLiteral.new(\"'#{@weeks_back.weeks.ago.strftime(\"%Y-%m-%d\")}'::timestamp\")\n         ]) \n      else \n         first_week.project(first_week[:week].minimum)\n      end\n    end\n\n    # the logs table that actually exists in your database\n    def log_table\n      Log.arel_table\n    end\n\n    # just a table alias\n    def first_week \n      Arel::Table.new('first_week')\n    end\n    # definition for the table alias\n    def first_week_table\n      Arel::Nodes::As.new(first_week,first_week_definition)\n    end\n\n    # definition for finding @user's weeks on record\n    # we will call use MIN later on to determine the First Week\n    def first_week_definition\n      log_table.project(\n        Arel::Nodes::NamedFunction.new('DATE_TRUNC',[\n            Arel::Nodes::SqlLiteral.new(\"'week'\"),\n            log_table[:created_at]\n          ]).as('week')\n      ).where(log_table[:user_id].eq(@user.id))\n    end\n\n    #just a table alias\n    def all_weeks \n      Arel::Table.new('all_weeks')\n    end\n\n    #a definition for this alias\n    def all_weeks_table\n      Arel::Nodes::As.new(all_weeks,series_table)\n    end\n\n    # series generation as suggested by @Nick\n    # used to build all_weeks_table\n    def series_table\n      Arel::SelectManager.new(Arel::Table.engine,series_definition)\n        .project(Arel::Nodes::SqlLiteral.new(\"gs\").as('week'))\n    end\n\n    # the actual series being generated\n    # starts on the @user's first week and continues to now on 1 week intervals\n    def series_definition\n      Arel::Nodes::NamedFunction.new('generate_series',\n        [ rollback,\n          Arel::Nodes::SqlLiteral.new(\"now()\"),\n          Arel::Nodes::SqlLiteral.new(\"interval '1 week'\")\n        ]\n      ).as('_(gs)')\n    end\nend\n</code></pre>\n\n<p>The resulting SQL for this will look like </p>\n\n<pre><code>UserPointsByWeek.new(@user).to_sql # Assuming user.id == 1\n#=&gt; \"WITH first_week AS (\n        SELECT DATE_TRUNC('week', logs.created_at) AS week \n        FROM logs \n        WHERE logs.user_id = 1\n    ), all_weeks AS (\n        SELECT gs AS week \n        FROM generate_series(\n            (SELECT MIN(first_week.week) FROM first_week), \n            now(), \n            interval '1 week') AS _(gs)\n   ) \n   SELECT \n       all_weeks.week, \n       SUM(logs.points) AS weekly_points \n   FROM \n       all_weeks \n       LEFT OUTER JOIN logs ON all_weeks.week = DATE_TRUNC('week', logs.created_at) \n         AND logs.user_id = 1    \n   GROUP BY \n       all_weeks.week\"\n</code></pre>\n\n<p>And <code>#weekly_points</code> will return an <code>Array</code> of <code>Hash</code> objects with 2 keys <code>:week</code> and <code>:weekly_points</code> for each week between the User's first week and the current week. As a side note the <code>user</code> is also still accessible as well.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498067198, "post_id": 44682471, "comment_id": 76349961, "body": "Since <code>nil</code> is the intended result <code>Hash.new(0)</code> is not really needed (Although it does seem more correct) but I can agree that I may have over thought the solution as a reaction to the original answer. As a side note maybe alter your query to address point 2. Additionally it might be useful to explain how to build a range of &quot;weeks&quot; for iterative purposes"}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1498073837, "post_id": 44682471, "comment_id": 76353884, "body": "@engineersmnky Yes, noted. Updated to reflect your helpful comments."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1498073898, "post_id": 44682471, "comment_id": 76353920, "body": "Already upvoted or I would upvote again. Very clean simple solution"}], "tags": [], "owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1498073814, "last_edit_date": 1498073814, "creation_date": 1498065658, "answer_id": 44682471, "question_id": 44666310, "link": "https://stackoverflow.com/questions/44666310/with-date-truncweek-return-a-record-if-the-weeks-sumpoints-has-0/44682471#44682471", "title": "With DATE_TRUNC(&#39;week&#39;), Return a record if the week&#39;s .sum(:points) has 0?", "body": "<p>I would disagree that this is complex enough to warrant using SQL or Arel. You have 95% of the result you need right there, and the rest should be trivial.</p>\n\n<h1>Method 1</h1>\n\n<p>If you only want to be able to fetch values from the Hash, consider defining a default value on the hash like this:</p>\n\n<pre><code>points_by_week =\n  Hash.\n  new(0).\n  merge(\n    Log.\n    where(user_id: user_id).\n    group(\"DATE_TRUNC('year', created_at)\", \"DATE_TRUNC('week', created_at)\").\n    sum(:points)\n  )\n</code></pre>\n\n<p>Then, whenever you call:</p>\n\n<pre><code>points_by_week[x]\n</code></pre>\n\n<p>... you will be returned a 0 if x is not in the hash.</p>\n\n<p>If a nil is required for keys not present then you would pass <code>nil</code> instead of <code>0</code> to Hash.new </p>\n\n<h1>Method 2</h1>\n\n<p>Alternatively, if you really need to populate the entire set of values in the hash, you can create a hash with the required keys and zeroes/nils for the values with something like this, based on a range (I've used integers 0 to 100 here):</p>\n\n<pre><code>Hash[*(0..5).to_a.zip(Array.new(6,0)).flatten]\n =&gt; {0=&gt;0, 1=&gt;0, 2=&gt;0, 3=&gt;0, 4=&gt;0, 5=&gt;0} \n</code></pre>\n\n<p>... or ...</p>\n\n<pre><code>Hash[*(0..5).to_a.zip(Array.new(6)).flatten]\n =&gt; {0=&gt;nil, 1=&gt;nil, 2=&gt;nil, 3=&gt;nil, 4=&gt;nil, 5=&gt;nil} \n</code></pre>\n\n<p>(maybe there's a more convenient way), and <code>#reverse_merge</code> it with your current hash.</p>\n\n<p>e.g.</p>\n\n<pre><code>2.2.5 :036 &gt; x = {1 =&gt; 1, 3 =&gt; 3}\n =&gt; {1=&gt;1, 3=&gt;3} \n2.2.5 :037 &gt; y = Hash[*(0..5).to_a.zip(Array.new(6,0)).flatten]\n =&gt; {0=&gt;0, 1=&gt;0, 2=&gt;0, 3=&gt;0, 4=&gt;0, 5=&gt;0} \n2.2.5 :038 &gt; z = x.reverse_merge(y)\n =&gt; {0=&gt;0, 1=&gt;1, 2=&gt;0, 3=&gt;3, 4=&gt;0, 5=&gt;0} \n</code></pre>\n\n<p>An array of Monday dates can be generated with something like:</p>\n\n<pre><code>mondays = (Date.parse(\"2017-04-17\")..(Date.parse(\"2017-04-17\")+20.weeks)).map(&amp;:to_time).select(&amp;:monday?)\n</code></pre>\n\n<p>... and transformed to [year,date] pairs with ... </p>\n\n<pre><code>year_monday_pairs = mondays.map{|d| [d.beginning_of_year, d] }\n</code></pre>\n\n<p>... and converted to the hash required for the <code>#reverse_merge</code> with ...</p>\n\n<pre><code>Hash[*year_monday_pairs.zip(Array.new(year_monday_pairs.size, 0)).flatten(1)]\n =&gt; {[2017-01-01 00:00:00 +0000, 2017-04-17 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-04-24 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-05-01 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-05-08 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-05-15 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-05-22 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-05-29 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-06-05 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-06-12 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-06-19 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-06-26 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-07-03 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-07-10 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-07-17 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-07-24 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-07-31 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-08-07 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-08-14 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-08-21 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-08-28 00:00:00 +0100]=&gt;0, [2017-01-01 00:00:00 +0000, 2017-09-04 00:00:00 +0100]=&gt;0} \n</code></pre>\n"}], "owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1498144626, "creation_date": 1498015262, "question_id": 44666310, "link": "https://stackoverflow.com/questions/44666310/with-date-truncweek-return-a-record-if-the-weeks-sumpoints-has-0", "title": "With DATE_TRUNC(&#39;week&#39;), Return a record if the week&#39;s .sum(:points) has 0?", "body": "<p>I have the following Rails+Postgres query to query the db for an aggregate number of points and grouped by week:</p>\n\n<pre><code>Log Table: id, user_id, points, created_at\n\npoints_by_week = Log.where(user_id: user_id).group(\"DATE_TRUNC('year', created_at)\", \"DATE_TRUNC('week', created_at)\").sum(:points)\n</code></pre>\n\n<p>This returns results like so:</p>\n\n<pre><code>{ [2017-01-01 00:00:00 UTC, 2017-04-17 00:00:00 UTC]=&gt;10, \n  [2017-01-01 00:00:00 UTC, 2017-05-15 00:00:00 UTC]=&gt;110, \n  [2017-01-01 00:00:00 UTC, 2017-06-19 00:00:00 UTC]=&gt;1185 }\n</code></pre>\n\n<p>The problem is this only returns a record if 1 or more points exist per the week. </p>\n\n<p><strong>How can I:</strong></p>\n\n<ol>\n<li>Have a week result return if the week contains 0 points. Example, for the return above, the week of <code>2017-05-08</code> is missing because it has 0 points. I want it to return above. So when I graph this result, the week shows 0.</li>\n<li>Specify how many weeks to go back? And make sure if a week contains 0 points, it is outputted per #1 above.</li>\n</ol>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1498060496, "post_id": 44666224, "comment_id": 76346140, "body": "Thanks a lot. You save my hours"}], "tags": [], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "is_accepted": true, "score": 1, "last_activity_date": 1498014620, "creation_date": 1498014620, "answer_id": 44666224, "question_id": 44666145, "link": "https://stackoverflow.com/questions/44666145/retrieve-records-count-from-has-many-relation/44666224#44666224", "title": "Retrieve records count from has_many relation", "body": "<p>This should probably help..</p>\n\n<p>Bookrack.rb</p>\n\n<pre><code>has_many :faculties\nhas_many :books, through: :faculties\nhas_many :barcodes, through: :books\n</code></pre>\n\n<p>Then you can do,</p>\n\n<pre><code>Bookrack.find(1).barcodes.count\n</code></pre>\n\n<p>Also to note that, <code>has_many</code> relations has to be plural, your model seems inappropriate..or correct it if it's a typo..</p>\n"}, {"tags": [], "owner": {"reputation": 1095, "user_id": 5004690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6LQZv.jpg?s=128&g=1", "display_name": "TamerB", "link": "https://stackoverflow.com/users/5004690/tamerb"}, "is_accepted": false, "score": 2, "last_activity_date": 1498015954, "creation_date": 1498015954, "answer_id": 44666407, "question_id": 44666145, "link": "https://stackoverflow.com/questions/44666145/retrieve-records-count-from-has-many-relation/44666407#44666407", "title": "Retrieve records count from has_many relation", "body": "<p>Did you try this (for example for counting barcodes of the first book in the first faculty in the first bookrack):</p>\n\n<pre><code>b = Bookrack.first.faculties.first.books.first.barcodes.count\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1498017125, "creation_date": 1498017125, "answer_id": 44666591, "question_id": 44666145, "link": "https://stackoverflow.com/questions/44666145/retrieve-records-count-from-has-many-relation/44666591#44666591", "title": "Retrieve records count from has_many relation", "body": "<p>With model relationships like:</p>\n\n<pre><code># app/models/bookrack.rb\nhas_many :faculties\n\n#\u00a0app/models/faculty.rb\nbelongs_to :bookrack\nhas_many :books\n\n# app/models/book.rb\nbelongs_to :faculty\nhas_many :barcodes\n\n#\u00a0app/models/barcode.rb\nbelongs_to :book\n</code></pre>\n\n<p>You could use <a href=\"http://guides.rubyonrails.org/active_record_querying.html#joins\" rel=\"nofollow noreferrer\"><code>joins</code></a> in a \"nested\" way:</p>\n\n<pre><code>Bookrack.joins(faculties: [books: :barcodes]).count\n#\u00a0=&gt; SELECT COUNT(*) FROM \"bookracks\" \n#    INNER JOIN \"faculties\" ON \"faculties\".\"bookrack_id\" = \"bookracks\".\"id\" \n#    INNER JOIN \"books\" ON \"books\".\"faculty_id\" = \"faculties\".\"id\" \n#    INNER JOIN \"barcodes\" ON \"barcodes\".\"book_id\" = \"books\".\"id\"\n# =&gt; 1\n</code></pre>\n"}], "owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 44666224, "answer_count": 3, "score": 1, "last_activity_date": 1527039279, "creation_date": 1498013911, "last_edit_date": 1527039279, "question_id": 44666145, "link": "https://stackoverflow.com/questions/44666145/retrieve-records-count-from-has-many-relation", "title": "Retrieve records count from has_many relation", "body": "<p>I have the following models</p>\n\n<pre><code>Bookrack.rb\nhas_many :faculties\n\nFaculty.rb\nbelongs_to :bookrack\nhas_many :books\n\nBook.rb\nbelongs_to :faculty\nhas_many :barcodes\n\nBarcode.rb\nbelongs_to :book\n</code></pre>\n\n<p>I have a controller name bookrack controller. I can extract record of barcode in Bookrack using loop and empty array. Is there any simpler method to extract barcode record from Bookrack. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 252285, "user_id": 541091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd0165a88a06fc92a36f222606f17a11?s=128&d=identicon&r=PG", "display_name": "Michael Berkowski", "link": "https://stackoverflow.com/users/541091/michael-berkowski"}, "edited": false, "score": 0, "creation_date": 1498003986, "post_id": 44664866, "comment_id": 76315214, "body": "Did you call <code>Dotenv.load</code> as in the README examples? The Rails gem probably does so for you, but if you&#39;re using plain Ruby you&#39;ll have to actually load it. <a href=\"https://github.com/bkeepers/dotenv#sinatra-or-plain-ol-ruby\" rel=\"nofollow noreferrer\">github.com/bkeepers/dotenv#sinatra-or-plain-ol-ruby</a>"}, {"owner": {"reputation": 21, "user_id": 7071023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d133c45784553df3b915e6b575ed31?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/7071023/eric"}, "reply_to_user": {"reputation": 252285, "user_id": 541091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd0165a88a06fc92a36f222606f17a11?s=128&d=identicon&r=PG", "display_name": "Michael Berkowski", "link": "https://stackoverflow.com/users/541091/michael-berkowski"}, "edited": false, "score": 0, "creation_date": 1498004080, "post_id": 44664866, "comment_id": 76315236, "body": "@MichaelBerkowski Thank you for the fast reply, I did call Dotenv.load unfortunately :( I have it at the very top: <a href=\"http://imgur.com/SLXJmLh\" rel=\"nofollow noreferrer\">imgur.com/SLXJmLh</a>"}, {"owner": {"reputation": 252285, "user_id": 541091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd0165a88a06fc92a36f222606f17a11?s=128&d=identicon&r=PG", "display_name": "Michael Berkowski", "link": "https://stackoverflow.com/users/541091/michael-berkowski"}, "edited": false, "score": 0, "creation_date": 1498004424, "post_id": 44664866, "comment_id": 76315310, "body": "What is the name of your <code>.env</code> file? In Rails you&#39;re probably using environment-specific files like <code>.env.development</code> but by default <code>Dotenv.load</code> will read a file called <code>.env</code>"}, {"owner": {"reputation": 252285, "user_id": 541091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd0165a88a06fc92a36f222606f17a11?s=128&d=identicon&r=PG", "display_name": "Michael Berkowski", "link": "https://stackoverflow.com/users/541091/michael-berkowski"}, "edited": false, "score": 0, "creation_date": 1498004465, "post_id": 44664866, "comment_id": 76315319, "body": "In IRB, a simple <code>require &#39;dotenv&#39;; Dotenv.load</code> results in a Hash of the variables defined in <code>.&#47;.env</code>"}, {"owner": {"reputation": 21, "user_id": 7071023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d133c45784553df3b915e6b575ed31?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/7071023/eric"}, "reply_to_user": {"reputation": 252285, "user_id": 541091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd0165a88a06fc92a36f222606f17a11?s=128&d=identicon&r=PG", "display_name": "Michael Berkowski", "link": "https://stackoverflow.com/users/541091/michael-berkowski"}, "edited": false, "score": 0, "creation_date": 1498004496, "post_id": 44664866, "comment_id": 76315329, "body": "@MichaelBerkowski The <code>.env</code> file is called <code>.env</code> and is located directly at the root <code>&#47;.env</code>. Is that where it is supposed to be in ruby? Here is the current file structure: <a href=\"http://imgur.com/JhafycL\" rel=\"nofollow noreferrer\">imgur.com/JhafycL</a>"}, {"owner": {"reputation": 1600, "user_id": 1395009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/88yfK.jpg?s=128&g=1", "display_name": "nikkypx", "link": "https://stackoverflow.com/users/1395009/nikkypx"}, "edited": false, "score": 0, "creation_date": 1498435944, "post_id": 44664866, "comment_id": 76484463, "body": "why do you have dotenv and dotenv-rails installed"}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 2570513, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7eb8f514f4fb6aa178669e98bc512797?s=128&d=identicon&r=PG", "display_name": "Mario Gil", "link": "https://stackoverflow.com/users/2570513/mario-gil"}, "edited": false, "score": 0, "creation_date": 1558321579, "post_id": 44665034, "comment_id": 99048634, "body": "More recent changes let you do <code>require &#39;dotenv&#47;load&#39;</code>"}], "tags": [], "owner": {"reputation": 21, "user_id": 7071023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d133c45784553df3b915e6b575ed31?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/7071023/eric"}, "is_accepted": true, "score": 1, "last_activity_date": 1498005078, "creation_date": 1498005078, "answer_id": 44665034, "question_id": 44664866, "link": "https://stackoverflow.com/questions/44664866/ruby-dotenv-gem-not-loading-env-file/44665034#44665034", "title": "Ruby dotenv gem not loading .env file", "body": "<p>Okay I figured it out. While this used to work, I guess a recent update of <code>dotenv</code> has changed things.</p>\n\n<p>Because my ruby script is located in <code>./lib/scripts/script.rb</code> I needed to call <code>Dotenv.load(\"../../.env\")</code> so that it would point it to my <code>.env</code> file in the root of the project structure.</p>\n"}], "owner": {"reputation": 21, "user_id": 7071023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d133c45784553df3b915e6b575ed31?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/7071023/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2134, "favorite_count": 0, "accepted_answer_id": 44665034, "answer_count": 1, "score": 1, "last_activity_date": 1498005078, "creation_date": 1498003676, "last_edit_date": 1498004257, "question_id": 44664866, "link": "https://stackoverflow.com/questions/44664866/ruby-dotenv-gem-not-loading-env-file", "title": "Ruby dotenv gem not loading .env file", "body": "<p>I have the both the <code>dotenv</code> and <code>dotenv-rails</code> gem installed in my project. When I run the rails console I can type:  </p>\n\n<pre><code>2.4.0 :001 &gt; ENV[\"DATABASE_NAME\"]\n =&gt; \"portfolio_site_development\"\n</code></pre>\n\n<p>However my problem arises with Ruby, when in a Ruby file or the irb terminal when I call:   </p>\n\n<pre><code>2.4.0 :001 &gt; ENV[\"DATABASE_NAME\"]\n =&gt; nil \n</code></pre>\n\n<p>I am requiring <code>dotenv</code> in my Ruby file. What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "chartkick", "impressionist"], "comments": [{"owner": {"reputation": 1622, "user_id": 277994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce795239ba5dd2384fc2f88ffaff5451?s=128&d=identicon&r=PG", "display_name": "excid3", "link": "https://stackoverflow.com/users/277994/excid3"}, "edited": false, "score": 0, "creation_date": 1498078826, "post_id": 44664847, "comment_id": 76356462, "body": "Can you post some of the stacktrace you get for this?"}, {"owner": {"reputation": 55, "user_id": 1014645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee2026d5fc0a7fe21151503b1eea5df1?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/1014645/martin"}, "reply_to_user": {"reputation": 1622, "user_id": 277994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce795239ba5dd2384fc2f88ffaff5451?s=128&d=identicon&r=PG", "display_name": "excid3", "link": "https://stackoverflow.com/users/277994/excid3"}, "edited": false, "score": 0, "creation_date": 1498079495, "post_id": 44664847, "comment_id": 76356754, "body": "I hope that&#39;s enough.. Slightly different from above but same idea. <a href=\"https://gist.github.com/MartinMcDermid/c925b58b730cc42dab51b982ca32ba94\" rel=\"nofollow noreferrer\">gist.github.com/MartinMcDermid/c925b58b730cc42dab51b982ca32b&zwnj;&#8203;a94</a>"}, {"owner": {"reputation": 1622, "user_id": 277994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce795239ba5dd2384fc2f88ffaff5451?s=128&d=identicon&r=PG", "display_name": "excid3", "link": "https://stackoverflow.com/users/277994/excid3"}, "edited": false, "score": 1, "creation_date": 1498142092, "post_id": 44664847, "comment_id": 76387685, "body": "I&#39;m going to guess that it would be because in two cases you&#39;re using a regular Array and not an ActiveRecord::Relation with groupdate. Your <code>@test</code> array and <code>@user_vehicle_impressions</code> arrays are probably both causing the issue and if so, you&#39;ll want to convert those over to SQL queries instead or just manually do the count yourself in Ruby."}], "owner": {"reputation": 55, "user_id": 1014645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee2026d5fc0a7fe21151503b1eea5df1?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/1014645/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1498003528, "creation_date": 1498003528, "question_id": 44664847, "link": "https://stackoverflow.com/questions/44664847/using-impressionist-with-chartkick-displaying-user-articles-impressions-in-gra", "title": "Using impressionist with chartkick - displaying user.articles.impressions in graph", "body": "<p>I'm using the Impressionist gem to capture article views. A user can create an article and can view these in his dashboard. What I'm looking to do is to display a graph using Chartkick showing the amount of articles created by day, comments by day and most importantly for this question, the impressions per day of the users articles (and only his), so if the user has two impressions, per article, and has two articles, it'd show 4 in the chart for that day.</p>\n\n<p>In my show action I have:</p>\n\n<pre><code>@articles = current_user.articles\n@comments = @articles.comments\n</code></pre>\n\n<p>And in my view:</p>\n\n<pre><code>&lt;%= area_chart [\n   {name: \"Articles\", data: @articles.group_by_week(:created_at, format: \"%B %d, %Y\").count },\n   {name: \"Comments\", data: @comments.group_by_week(:created_at, format: \"%B %d, %Y\").count },\n   {name: \"Impressions\", data: @impressions.group_by_week(:created_at, format: \"%B %d, %Y\").count }\n]%&gt;\n</code></pre>\n\n<p>I've tried so many ways of doing this, collecting the ids of the impressions, but every time I do I get 'no block given'.. like so (and try not to laugh):</p>\n\n<pre><code>@article_impressions = []\n\n@articles.each do |article|\n  @impression = Impression.where(impressionable_id: article.id)\n  if @impression.present?\n    @article_impressions &lt;&lt; [@impression.ids]\n  end\nend\n</code></pre>\n\n<p>I've also tried just taking the @impression into the hash but same again, 'no block given'. I'm almost 100% certain I'm doing this the wrong way and I'm being a bit of an idiot. If anyone could help, it'd be much appreciated!</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "if-statement"], "comments": [{"owner": {"reputation": 5903, "user_id": 3908170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vou9q.jpg?s=128&g=1", "display_name": "DarkCygnus", "link": "https://stackoverflow.com/users/3908170/darkcygnus"}, "edited": false, "score": 0, "creation_date": 1498002777, "post_id": 44664731, "comment_id": 76314957, "body": "What do you mean with &quot;fails&quot;, you get an error? If yes please include the stack trace. If it is unexpected behaviour, please add what is your actual and expected behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 1228, "user_id": 4497621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d140bf5c97a7ee616b0f21189fa9373?s=128&d=identicon&r=PG&f=1", "display_name": "John Hayes-Reed", "link": "https://stackoverflow.com/users/4497621/john-hayes-reed"}, "edited": false, "score": 1, "creation_date": 1498011568, "post_id": 44664749, "comment_id": 76316881, "body": "<code>%w[plants trees]</code> all hail rubocop"}, {"owner": {"reputation": 15, "user_id": 8191243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7c385dae9ce8d3e3c49023977d0e78?s=128&d=identicon&r=PG&f=1", "display_name": "traci123me", "link": "https://stackoverflow.com/users/8191243/traci123me"}, "edited": false, "score": 0, "creation_date": 1498062943, "post_id": 44664749, "comment_id": 76347564, "body": "@dezman - Thanks!!"}], "tags": [], "owner": {"reputation": 15236, "user_id": 1388017, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Z2KPU.png?s=128&g=1", "display_name": "dezman", "link": "https://stackoverflow.com/users/1388017/dezman"}, "is_accepted": false, "score": 3, "last_activity_date": 1498002830, "creation_date": 1498002830, "answer_id": 44664749, "question_id": 44664731, "link": "https://stackoverflow.com/questions/44664731/why-does-if-statement-fail-when-or-is-used/44664749#44664749", "title": "Why does IF statement fail when OR || is used?", "body": "<p>You cant use <code>||</code> like that, id do <code>['plants', 'trees'].includes? @body_id</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 5903, "user_id": 3908170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vou9q.jpg?s=128&g=1", "display_name": "DarkCygnus", "link": "https://stackoverflow.com/users/3908170/darkcygnus"}, "is_accepted": false, "score": 1, "last_activity_date": 1498002845, "creation_date": 1498002845, "answer_id": 44664750, "question_id": 44664731, "link": "https://stackoverflow.com/questions/44664731/why-does-if-statement-fail-when-or-is-used/44664750#44664750", "title": "Why does IF statement fail when OR || is used?", "body": "<p>Shouldn't it be?</p>\n\n<pre><code>&lt;% if @body_id == 'plants' || @body_id == 'trees' %&gt;\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8191243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7c385dae9ce8d3e3c49023977d0e78?s=128&d=identicon&r=PG&f=1", "display_name": "traci123me", "link": "https://stackoverflow.com/users/8191243/traci123me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1498008746, "answer_count": 2, "score": -4, "last_activity_date": 1498002845, "creation_date": 1498002713, "question_id": 44664731, "link": "https://stackoverflow.com/questions/44664731/why-does-if-statement-fail-when-or-is-used", "closed_reason": "Duplicate", "title": "Why does IF statement fail when OR || is used?", "body": "<p>My Ruby if statement fails when the or operator is used.  </p>\n\n<pre><code>&lt;% if @body_id == 'plants' || 'trees' %&gt;\n   &lt;meta name=\"robots\" content=\"noindex, nofollow\"&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "authentication", "oauth-2.0", "calllog", "ringcentral"], "comments": [{"owner": {"reputation": 21, "user_id": 4032221, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mitch Main", "link": "https://stackoverflow.com/users/4032221/mitch-main"}, "edited": false, "score": 0, "creation_date": 1498001441, "post_id": 44664527, "comment_id": 76314604, "body": "here&#39;s a link to the screenshot which didn&#39;t work <a href=\"https://snag.gy/rz2X0K.jpg\" rel=\"nofollow noreferrer\">snag.gy/rz2X0K.jpg</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": false, "score": 0, "last_activity_date": 1499980773, "last_edit_date": 1499980773, "creation_date": 1499833559, "answer_id": 45048432, "question_id": 44664527, "link": "https://stackoverflow.com/questions/44664527/ringcentral-oauth-sever-only-password-flow-with-rubys-httparty/45048432#45048432", "title": "RingCentral OAuth Sever-Only Password Flow with Ruby&#39;s HTTParty", "body": "<blockquote>\n  <p>Frustratingly the documentation for the RingCentral Ruby SDK have no documented method for refreshing these tokens, and nebulously mentions something about \"Manual Refreshes\". Any ideas or thoughts on my requests or the SDK would be appreciated. I would prefer to perform refreshes than re-auth over and over again.</p>\n</blockquote>\n\n<p>Token refresh is in the detailed documentation in the <code>/docs</code> folder of the repo and also posted on the <a href=\"http://ringcentral-sdk-ruby.readthedocs.io/\" rel=\"nofollow noreferrer\">Ruby SDK's Read the Docs</a>. I'll look to make those docs more evident.</p>\n\n<p>The Token Refresh section of the docs is available here:</p>\n\n<p><a href=\"http://ringcentral-sdk-ruby.readthedocs.io/en/latest/usage/authorization/Authorization/#token-refresh\" rel=\"nofollow noreferrer\">http://ringcentral-sdk-ruby.readthedocs.io/en/latest/usage/authorization/Authorization/#token-refresh</a></p>\n\n<p>Regarding the call log request, you can make it directly using the SDK with the API call below.</p>\n\n<pre><code>client = RingCentralSdk::REST::Client.new do | config |\n  # ...\nend\n\nclient.http.get 'account/~/extension/~/call-log'\n</code></pre>\n\n<p>For the <code>accountId</code> and <code>extensionId</code> path parameters, you can use <code>~</code> to indicate the account and extension for the currently logged in user. If you want to specify the <code>accountId</code> and <code>extensionId</code>, be aware that these are backend id values and do not correspond to the main company phone number or <code>extensionNumber</code> that a user dials. You can retrieve the <code>accountId</code> and <code>extensionId</code> for your logged in user by calling the <code>account/~/extension</code> API endpoint.</p>\n"}], "owner": {"reputation": 21, "user_id": 4032221, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mitch Main", "link": "https://stackoverflow.com/users/4032221/mitch-main"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527453474, "creation_date": 1498001266, "last_edit_date": 1527453474, "question_id": 44664527, "link": "https://stackoverflow.com/questions/44664527/ringcentral-oauth-sever-only-password-flow-with-rubys-httparty", "title": "RingCentral OAuth Sever-Only Password Flow with Ruby&#39;s HTTParty", "body": "<p>I'm currently trying to write a Data Extraction Application for RingCentral to dump CSVs to AWS as part of a Data Warehousing project. I've reviewed several pieces of their documentation outlining how to authenticate using the Password Flow, but there seems to be some missing pieces based on their examples in the documentation <a href=\"http://ringcentral-api-docs.readthedocs.io/en/latest/oauth/\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>In the example listed under \"Password Flow\" There is an authentication header that is never mentioned and the value that is included is pulled out out of thin air by the author, and then never mentioned in the authentication steps below it. I can validate that my application meets the Private, Server-Only Requirements with scope 'Read Call Logs'. Below is a screenshot of my settings:\n[Link to Image because I don't have enough reputation...ugh][2]</p>\n\n<p>Using the Sandbox credentials and endpoint for development, here's what I've tried so far:</p>\n\n<pre><code>url = 'https://platform.devtest.ringcentral.com/restapi/oauth/token'\nheaders = {'Content-Type'=&gt;'application/x-www-form-urlencoded'}\nbody = {:grant_type=&gt;\"password\", :username=&gt;\"13133982093\", :password=&gt;&lt;OUR_SANDBOX_PASSWORD&gt;}\nresp = HTTParty.post(url, headers: headers, body: URI.encode_www_form(body))\n</code></pre>\n\n<p>The printed response:</p>\n\n<pre><code>#&lt;HTTParty::Response:0x7ff29588a420 parsed_response={\"error\"=&gt;\"invalid_client\", \"error_description\"=&gt;\"Invalid client: \", \"errors\"=&gt;[{\"errorCode\"=&gt;\"OAU-153\", \"message\"=&gt;\"Invalid client: \", \"parameters\"=&gt;[{\"parameterName\"=&gt;\"client_id\", \"parameterValue\"=&gt;\"\"}]}]}, @response=#&lt;Net::HTTPBadRequest 400 Bad Request readbody=true&gt;, @headers={\"server\"=&gt;[\"nginx/1.10.2\"], \"date\"=&gt;[\"Tue, 20 Jun 2017 22:05:36 GMT\"], \"content-type\"=&gt;[\"application/json;charset=utf-8\"], \"transfer-encoding\"=&gt;[\"chunked\"], \"connection\"=&gt;[\"close\"], \"x-application-context\"=&gt;[\"application:8080\"], \"content-language\"=&gt;[\"en\"], \"www-authenticate\"=&gt;[\"Bearer realm=\\\"RingCentral REST API\\\", error=\\\"invalid_client\\\", error_description=\\\"Invalid client: \\\"\"], \"rcrequestid\"=&gt;[\"96aaacb0-5604-11e7-97a9-005056bb594d\"], \"aceroutingkey\"=&gt;[\"sjc11-c01-ace01.c83d65c2-46d3-11e7-ab8e-005056a73f60\"], \"x-server-name\"=&gt;[\"sjc06-c01-hlb02\"], \"x-request-time\"=&gt;[\"0.010\"], \"x-upstream-server\"=&gt;[\"10.24.22.193:8080\"], \"x-upstream-status\"=&gt;[\"400\"], \"x-upstream-htime\"=&gt;[\"0.010\"], \"x-upstream-rtime\"=&gt;[\"1497996336.573\"], \"x-upstream-ctime\"=&gt;[\"0.000\"], \"x-tcpinfo\"=&gt;[\"1000, 500, 10, 28960\"], \"routingkey\"=&gt;[\"SJC11P01\"]}&gt; \n</code></pre>\n\n<p>I've tried Google Searching for the Error Code OAU-153 and it's completely undocumented. I've even included things like an Authorization Header produced from the client_id and client_secret (a.k.a - app_key and app_secret) like such: <code>auth= {'Authorization': \"Basic #{ Base64.encode64(\"#{client_id}:#{client_secret}\") }\"}</code></p>\n\n<p>Which was included in a call like: <code>resp = HTTParty.post(token_url, headers: headers, body: URI.encode_www_form(token_body), auth: auth)</code></p>\n\n<p>But this still produced the same error as above with error_description <code>\"Invalid Client: \"</code>, and error_code <code>OAU-153</code>.</p>\n\n<p>Additionally, due to project requirements the Ring Central Ruby SDK causes dependency conflicts with very important gems in my current application, thus we're having to write new Auth code for this data source.</p>\n\n<p>At this point I'm lost. I've heavily validated that my keys, username and password are all correct. I've included the <code>username</code> phone number value as a sanity check for formatting. I'm essentially left with 2 questions I cannot answer:</p>\n\n<p>1) Am I approching this correctly? Have I selected the correct roles and permissions for this application? Do I need to create a new one with a different Auth Flow and Privacy settings?</p>\n\n<p>2) Am I using the right tools for this? Is HTTParty possibly a culprit in how it's sending my requests? Digging in the Repository hasn't brought much to light in the time I've spent.</p>\n\n<h2>EDIT:</h2>\n\n<p>We made changes to the project which allowed us to use the SDK for authentication like this:</p>\n\n<pre><code>client = RingCentralSdk::REST::Client.new do | config |\n    config.app_key = ENV['RC_CLIENT_ID']\n    config.app_secret = ENV['RC_CLIENT_SECRET']\n    config.server_url = @server_url\n    config.username = @account_num\n    config.password = @password\n    config.extension = @extension_id\n</code></pre>\n\n<p>Then we store token info as a hash by doing: <code>token_hash = client.token.to_hash</code></p>\n\n<p>An example of the hash can be seen below:</p>\n\n<pre><code>{\"token_type\"=&gt;\"bearer\", \"refresh_token_expires_in\"=&gt;604800, \n \"scope\"=&gt;\"ReadCallLog\", \"owner_id\"=&gt;[COMPANY's OWNER_ID], \n \"endpoint_id\"=&gt;\"N0UV835BQ2C_Bz2ofJA1Eg\", \n :access_token=&gt; [REMOVED FOR SECURITY],\n :refresh_token=&gt; [REMOVED FOR SECURITY], \n :expires_at=&gt;1498081681} \n</code></pre>\n\n<p>However, now I cannot perform 2 operations: a simple authenticated request or a token Refresh.</p>\n\n<h3>Attempting simple <code>call-log</code> request:</h3>\n\n<pre><code>uri = \"https://platform.devtest.ringcentral.com/restapi/v1.0/account/&lt;phone_num_with_pre_+&gt;/extension/101/call-log\"\nheaders = {\"Accept\"=&gt;\"application/json\", \"Authorization\"=&gt; \"#{ token_hash[:access_token] }\"} \nresp = HTTParty.get(uri, headers: headers)\n</code></pre>\n\n<p>This sort of request earns me an error:</p>\n\n<pre><code> #&lt;HTTParty::Response:0x7fdf2b0ae800 parsed_response={\"errorCode\"=&gt;\"InvalidParameter\", \"message\"=&gt;\"Resource for parameter [accountId] is not found\", \"errors\"=&gt;[{\"errorCode\"=&gt;\"CMN-102\", \"message\"=&gt;\"Resource for parameter [accountId] is not found\", \"parameterName\"=&gt;\"accountId\"}], \"parameterName\"=&gt;\"accountId\"}, @response=#&lt;Net::HTTPNotFound 404 Not Found readbody=true&gt;, @headers={\"server\"=&gt;[\"nginx/1.10.2\"], \"date\"=&gt;[\"Wed, 21 Jun 2017 21:39:58 GMT\"], \"content-type\"=&gt;[\"application/json;charset=UTF-8\"], \"content-length\"=&gt;[\"290\"], \"connection\"=&gt;[\"close\"], \"rcrequestid\"=&gt;[\"2b66c9d6-56ca-11e7-b418-005056bb26b9\"], \"routingkey\"=&gt;[\"SJC11P01PAS02\"], \"x-error-id\"=&gt;[\"2b66c9d6-56ca-11e7-b418-005056bb26b9\"], \"content-language\"=&gt;[\"en-US\"], \"x-rate-limit-group\"=&gt;[\"heavy\"], \"x-rate-limit-limit\"=&gt;[\"10\"], \"x-rate-limit-remaining\"=&gt;[\"9\"], \"x-rate-limit-window\"=&gt;[\"60\"]}&gt;\n</code></pre>\n\n<p>This error suggests 2 things, 1) My account_id parameter is input wrong -- however, I copied the Sandbox number directly from the RC Developer Portal for my application, both with the prepended <code>+</code> and without, and the same error occurred, 2) There are no <code>call-log</code> records, and thus the API server thinks that the Resource doesn't exists and throws the error.</p>\n\n<p>So, I guess my question is? How can I even develop against this Sandbox when there is no data for me to query? Is there an easy way to make data for this account?</p>\n\n<h3>Attempting Refresh Token Flow:</h3>\n\n<p>NOTE: I just sign-in again every time I need a token at the moment. Clunky but not terrible.</p>\n\n<p>Perform the request:</p>\n\n<pre><code>uri = \"https://platform.devtest.ringcentral.com/restapi/oauth/token\"\nrefresh_headers = {\"Accept\"=&gt;\"application/json\", \"Content-Type\"=&gt;\"application/x-www-form-urlencoded\", \n                   \"Authentication\"=&gt;\"Basic [BASE64_ENCODED_APP_KEY:APP_SECRET_DELIMITED_COMBO]}\nrefresh_body = {:grant_type=&gt;\"refresh_token\", :refresh_token=&gt;\"#{token_hash[:refresh_token]}\"} \nresp = HTTParty.post(uri, headers: refresh_headers, body: URI.www_encode_form(refresh_body))\n</code></pre>\n\n<p>Earn an error:</p>\n\n<pre><code>#&lt;HTTParty::Response:0x7fdf3055d8d8 parsed_response={\"error\"=&gt;\"invalid_client\", \"error_description\"=&gt;\"Invalid client: \", \"errors\"=&gt;[{\"errorCode\"=&gt;\"OAU-153\", \"message\"=&gt;\"Invalid client: \", \"parameters\"=&gt;[{\"parameterName\"=&gt;\"client_id\", \"parameterValue\"=&gt;\"\"}]}]}, @response=#&lt;Net::HTTPBadRequest 400 Bad Request readbody=true&gt;, @headers={\"server\"=&gt;[\"nginx/1.10.2\"], \"date\"=&gt;[\"Wed, 21 Jun 2017 22:16:07 GMT\"], \"content-type\"=&gt;[\"application/json;charset=utf-8\"], \"transfer-encoding\"=&gt;[\"chunked\"], \"connection\"=&gt;[\"close\"], \"x-application-context\"=&gt;[\"application:8080\"], \"content-language\"=&gt;[\"en\"], \"www-authenticate\"=&gt;[\"Bearer realm=\\\"RingCentral REST API\\\", error=\\\"invalid_client\\\", error_description=\\\"Invalid client: \\\"\"], \"rcrequestid\"=&gt;[\"3958edb2-56cf-11e7-8758-005056bb26b9\"], \"aceroutingkey\"=&gt;[\"sjc11-c01-ace01.c83d65c2-46d3-11e7-ab8e-005056a73f60\"], \"x-server-name\"=&gt;[\"sjc06-c01-hlb01\"], \"x-request-time\"=&gt;[\"0.000\"], \"x-upstream-server\"=&gt;[\"10.24.22.193:8080\"], \"x-upstream-status\"=&gt;[\"400\"], \"x-upstream-htime\"=&gt;[\"0.000\"], \"x-upstream-rtime\"=&gt;[\"1498083367.846\"], \"x-upstream-ctime\"=&gt;[\"0.000\"], \"x-tcpinfo\"=&gt;[\"1000, 500, 10, 28960\"], \"routingkey\"=&gt;[\"SJC11P01\"]}&gt; \n</code></pre>\n\n<p>Weep silently to yourself...</p>\n\n<pre><code>:'-(\n</code></pre>\n\n<p>Frustratingly the documentation for the RingCentral Ruby SDK have no documented method for refreshing these tokens, and nebulously mentions something about \"Manual Refreshes\". Any ideas or thoughts on my requests or the SDK would be appreciated. I would prefer to perform refreshes than re-auth over and over again.</p>\n"}, {"tags": ["ruby", "string-formatting"], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1553381209, "post_id": 44664665, "comment_id": 97365098, "body": "It might be worth noting that the <a href=\"https://github.com/rubocop-hq/ruby-style-guide#sprintf\" rel=\"nofollow noreferrer\">Ruby style guide</a> recommends using <code>sprintf</code> and <code>format</code> instead of <code>%</code> to avoid confusion."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 2, "last_activity_date": 1553380652, "last_edit_date": 1553380652, "creation_date": 1498002179, "answer_id": 44664665, "question_id": 44664525, "link": "https://stackoverflow.com/questions/44664525/why-does-a-formatted-string-with-no-keys-return-itself/44664665#44664665", "title": "Why does a formatted string with no keys return itself?", "body": "<p>Your:</p>\n\n<pre><code>puts format_string\n</code></pre>\n\n<p>prints <code>format_string</code> because that's what <code>puts</code> does. The formatting (and complaining about missing keys) that you're seeing is done by the <a href=\"https://ruby-doc.org/core/String.html#method-i-25\" rel=\"nofollow noreferrer\"><code>String#%</code></a> method; <code>puts</code> doesn't interpret the <code>%{...}</code> things in the string, the <code>%</code> operator does that. Perhaps breaking it into two steps (and being more consistent with your whitespace) will clarify things for you:</p>\n\n<pre><code>formatted_string = format_string % {greeting: \"Hi\", name: \"John\"}\n# -------------------------------^ Just an operator like any other, %{ has no special meaning outside the string you use the % operator on.\nputs formatted_string\n</code></pre>\n\n<p>The <code>%</code> in <code>format_string % hash</code> is just an operator like any other, <code>%{</code> has no special meaning outside the string you use the <code>%</code> operator on so removing the space between the operator (<code>%</code>) and the opening brace (<code>{</code>) of the hash operand is misleading.</p>\n"}], "owner": {"reputation": 25, "user_id": 5813722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda7d074c2823f9e89429655e342e67b?s=128&d=identicon&r=PG&f=1", "display_name": "Naethanyel", "link": "https://stackoverflow.com/users/5813722/naethanyel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 44664665, "answer_count": 1, "score": 0, "last_activity_date": 1553380652, "creation_date": 1498001262, "question_id": 44664525, "link": "https://stackoverflow.com/questions/44664525/why-does-a-formatted-string-with-no-keys-return-itself", "title": "Why does a formatted string with no keys return itself?", "body": "<p>Considering this Ruby code:</p>\n\n<pre><code>format_string = \"%{greeting}, %{name}\"\n\nputs format_string %{greeting: \"Hi\", name: \"John\"}  # &lt;-- returns \"Hi, John\"\nputs format_string                                  # &lt;-- returns \"%{greeting}, %{name}\" \nputs format_string %{greeting: \"Hi\"}        # &lt;-- returns key{name} not found (KeyError)\"\n</code></pre>\n\n<p>The following code produces an <strong>error because it is missing a key.</strong></p>\n\n<pre><code>puts format_string %{greeting: \"Hi\"}    # returns \"key{name} not found (KeyError)\"\n</code></pre>\n\n<p>While the code below returns the exact value of the format_string variable, <strong>even though it missing both keys.</strong> I would expect the value to be equal to nil, or result in an error like the code above.</p>\n\n<pre><code>puts format_string      # returns \"%{greeting: \"Hi\", name: \"John\"}\"\n</code></pre>\n\n<p><strong>I'm looking for an explanation of how and why the exact value is returned, when no keys or variables are set to the string.</strong>\nI have read through the ruby docs and multiple web pages relating to ruby formatting, yet I have not been able to find an answer. </p>\n"}, {"tags": ["ruby", "xml", "rubygems", "libxml-ruby"], "comments": [{"owner": {"reputation": 1365, "user_id": 541408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/711ad7b75ad8a8a56fedb27b1e1503ef?s=128&d=identicon&r=PG", "display_name": "kurupt_89", "link": "https://stackoverflow.com/users/541408/kurupt-89"}, "edited": false, "score": 0, "creation_date": 1500002721, "post_id": 44664362, "comment_id": 77160697, "body": "did you end up finding a solution to this?"}], "owner": {"reputation": 51, "user_id": 7680874, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/37bc395c641a28a760f17f1266fb9335?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/7680874/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498000008, "creation_date": 1498000008, "question_id": 44664362, "link": "https://stackoverflow.com/questions/44664362/cannot-load-libxml-ruby-so-for-libxml-ruby-gem", "title": "Cannot load libxml_ruby.so for libxml-ruby gem", "body": "<p>I installed the libxml-ruby gem, with the <code>--platform=x86_64</code> flag, and whenever I try to <code>require 'xml'</code> I get an error.</p>\n\n<pre><code>Ruby24-x64/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require':\n126: The specified module could not be found.   \n</code></pre>\n\n<p><code>- I:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/libxml-ruby-3.0.0/lib/libxml_ruby.so (LoadError)</code></p>\n\n<p>I checked, and libxml_ruby.so is in that directory. Any ideas on how to fix this?</p>\n\n<p>I am using Ruby version 2.4.1 on Windows 10.</p>\n"}, {"tags": ["arrays", "ruby", "if-statement", "ternary-operator"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498004206, "post_id": 44664282, "comment_id": 76315268, "body": "This is a very strange thing to want to do. What problem are you trying to solve by doing this?"}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498006456, "post_id": 44664282, "comment_id": 76315740, "body": "I&#39;m solving a problem step by step and each step has to check for a few things that don&#39;t easily evaluate to true or false. It&#39;s really a variable-length ternary expression (the first example could be <code>&#39;false&#39;.evaluate ? 0 : &#39;true&#39;.evaluate ? 1 : &#39;true&#39;.evaluate ? 2 : 3</code> but sometimes longer and sometimes shorter). What&#39;s so strange about it?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1498008146, "post_id": 44664282, "comment_id": 76316089, "body": "In 15 years of Ruby, I have never seen anyone do anything remotely like this. It&#39;s weird to encode things in the indices of an Array this way instead of just using objects. It&#39;s weird to have a &quot;variable-length ternary expression&quot;, which is a contradiction in terms. I think this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a> and you&#39;d get better answers by asking something like &quot;How do I check multiple conditions and return a result for the first condition that matches or a default result?&quot;"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498008273, "post_id": 44664282, "comment_id": 76316121, "body": "And to answer that question, I would suggest representing each condition/result pair as an object and using <a href=\"https://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\"><code>find</code></a> to return the first object with a matching condition (or a default) from an array of such objects."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498075376, "post_id": 44664282, "comment_id": 76354713, "body": "Do you understand the result of this benchmark? If you did then you would know that it is extremely unlikely that the result matters. It&#39;s hard to imagine a scenario where this is not premature, unnecessary optimization. Do you have millions of conditions?"}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498076138, "post_id": 44664282, "comment_id": 76355121, "body": "I don&#39;t have millions of conditions but I am checking ~700 000 expressions on average (often the same one but the condition checking is different), it&#39;s not deadly but you can see that when one way takes 3s and another takes 6 or 18, I&#39;m not going to chose 18, no matter how rubytastic it is. Again, if there is a way to reformat the code and make it faster, please forgive the imperfect question and suggest it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498076631, "post_id": 44664282, "comment_id": 76355370, "body": "One obvious performance optimization that suggests itself is to convert an array of pairs into a pair of arrays, one for the conditions and one for the results. This would eliminate the array index branching and make the logic simpler at the same time."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498079071, "post_id": 44664282, "comment_id": 76356566, "body": "With my implementation I get: <code>flat: 3.37s, nested: 6.20s, options (Struct): 6.92s, separate (2 arrays): 3.96s</code>, my class method is: <code>self[1][self[0].index {|i| yield i} || self[0].length]</code>, can it be done better?"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1498027508, "post_id": 44665536, "comment_id": 76321938, "body": "&quot;Ruby is an object-oriented language&quot; \u2013 Yes! I am always amazed by what hoops people are willing to jump through in order to treat Ruby as an array-of-hashes-of-strings-to-arrays-of-strings-and-integers&zwnj;&#8203;-oriented language (or something even worse) when it should be obvious to them that they are fighting the language."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1498069574, "post_id": 44665536, "comment_id": 76351273, "body": "If it is an XY Problem, what&#39;s a better way to do this? knowing that the number of checks is variable and they have to be stored somehow. Also, @J&#246;rgWMittag, I&#39;m not concerned about hurting the language&#39;s feelings as long as it works and, as of now, an array of consecutive values is the fastest way i&#39;ve found."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498074884, "post_id": 44665536, "comment_id": 76354445, "body": "My answer <i>is</i> my proposed better way to do this. Have you read it?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498075085, "post_id": 44665536, "comment_id": 76354564, "body": "Also, the problem isn&#39;t &quot;hurting the language&#39;s feelings&quot;. Languages don&#39;t have feelings and besides, they hate being anthropomorphized. The problem is trying to use an unnecessarily complex method that the language doesn&#39;t offer any special support for when a method exists that is easier and better supported by the language. This makes <i>your job</i> harder. The programming language doesn&#39;t care one way or the other."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1498076590, "post_id": 44665536, "comment_id": 76355352, "body": "@ReinHenrichs yes, I did read it, sorry I got lost for a second and thought i was responding to J&#246;rgWMittag. Again, whatever the language (in all it&#39;s mineral glory) thinks about my solution, it&#39;s the fastest i&#39;ve come up with so far. So if you have a <i>faster</i> suggestion, i&#39;ll be glad to take a look, I&#39;m not allergic to objects as long as they&#39;re fast."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 3, "last_activity_date": 1498010367, "last_edit_date": 1498010367, "creation_date": 1498009219, "answer_id": 44665536, "question_id": 44664282, "link": "https://stackoverflow.com/questions/44664282/ruby-evaluate-a-special-array-as-an-arbitrarily-long-ternary-if-elsif-else/44665536#44665536", "title": "ruby: evaluate a special array as an arbitrarily long ternary if...elsif...else statement (or ternary expression)", "body": "<p>I think this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. You have flattened pairs of values into an array. This forces you to go to a lot of extra effort to test the array indices to recover the information originally contained in the pairs (which element is first, which element is second). All of this extra work could be avoided by simply not flattening the pairs in the first place, thereby retaining their knowledge of which element is which.</p>\n\n<p>Because of this, I am going to provide a solution to the problem you are trying to solve rather than tell you how to implement the solution you have chosen. </p>\n\n<p>You can represent each condition/result pair as an object and then <code>find</code> the first one that matches:</p>\n\n<pre><code># A condition/result pair\nOption = Struct.new :condition, :result\n\n# To hold a default value which duck-types with `result`.\nDefault = Struct.new :result\n\noptions = [Option.new('false', 0), Option.new('true', 1), Option.new('true', 2)]\n\noptions.find(Default.new(3)) {|opt| opt.condition == 'true'}.result\n# =&gt; 1\n</code></pre>\n\n<p>If you are allergic to creating new objects, you can use 2-element arrays as pairs:</p>\n\n<pre><code>options = [['false', 0], ['true', 1], ['true', 2]]\noptions.find([nil, 3]) {|condition, result| condition == 'true'}.last\n# =&gt; 1\n</code></pre>\n\n<p>But Ruby is an object-oriented language. Creating new objects to solve new problems is exactly what the language is designed for.</p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1498009654, "creation_date": 1498009654, "answer_id": 44665583, "question_id": 44664282, "link": "https://stackoverflow.com/questions/44664282/ruby-evaluate-a-special-array-as-an-arbitrarily-long-ternary-if-elsif-else/44665583#44665583", "title": "ruby: evaluate a special array as an arbitrarily long ternary if...elsif...else statement (or ternary expression)", "body": "<p>I was going to say this is a bit more Rubyish solution than what you have, but Rein is right - the whole concept is not very Rubyish to start with, and you'd probably profit from asking a different, more specific question.</p>\n\n<pre><code>module ArrayWithCase\n  refine Array do\n    def case_when_then_else(&amp;block)\n      each_slice(2).find { |x|\n        x.size == 1 || (block_given? ? block[x[0]] : x[0])\n      }&amp;.last\n    end\n  end\nend\n\nmodule Test\n  using ArrayWithCase\n  p ['false', 0, 'true', 1, 'true', 2, 3].case_when_then_else {|i| i == 'true'}\n  # =&gt; 1\n  p [false, 0, true, 1, true, 2, 3].case_when_then_else\n  # =&gt; 1\n  p [1,2,3,4,5].case_when_then_else { |i| i &gt; 6 }\n  # =&gt; 6\n  p [\"only_possible_answer\"].case_when_then_else(&amp;:itself)\n  # =&gt; \"only_possible_answer\"\n  p [false, 4].case_when_then_else(&amp;:itself)\n  # =&gt; nil\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "is_accepted": true, "score": 1, "last_activity_date": 1498017429, "last_edit_date": 1498017429, "creation_date": 1498017019, "answer_id": 44666573, "question_id": 44664282, "link": "https://stackoverflow.com/questions/44664282/ruby-evaluate-a-special-array-as-an-arbitrarily-long-ternary-if-elsif-else/44666573#44666573", "title": "ruby: evaluate a special array as an arbitrarily long ternary if...elsif...else statement (or ternary expression)", "body": "<blockquote>\n  <p>fastest among all answers</p>\n</blockquote>\n\n<h1>My solution</h1>\n\n<pre><code>require 'minitest/autorun'\nclass OldArray &lt; Array\n  def ternary &amp;block\n    # the block checks if a condition is true\n    i = 0\n    while true\n      if i % 2 == 1 or i == length - 1\n        return self[i]\n      else\n        i += yield(self[i]) ? 1 : 2\n      end\n    end\n  end\nend\n\nclass NewArray &lt; Array\n  def ternary\n    index = 0\n\n    # Loop until you find item satisfying the condition skipping one item\n    index += 2 until (index &gt;= self.length - 1) || yield(self[index]) \n\n    # return the next value unless its the last/default item\n    return self[index+1] unless index == self.length - 1 \n\n    # return default item\n    self.last\n  end\nend\n\nclass TestMe &lt; Minitest::Test\n  def test_array\n    assert_equal 5, NewArray.new([1, 2, 3, 4, 5]).ternary {|i| i &gt; 6}\n    assert_equal 4, NewArray.new([1, 2, 3, 4, 5]).ternary {|i| i &gt; 2}\n    assert_equal 5, NewArray.new([1, 2, 3, 4, 5]).ternary {|i| puts \"is: #{i}\";i &gt; 3}\n    assert_equal 1, NewArray.new(['false', 0, 'true', 1, 'true', 2, 3]).ternary {|i|i == 'true'}\n  end\nend\n\nrequire 'benchmark/ips'\nBenchmark.ips do |x|\n  x.report(\"My Technique\") { NewArray.new([1, 2, 3, 4, 5]).ternary {|i| i &gt; 6} }\n  x.report(\"Your Technique\") { OldArray.new([1, 2, 3, 4, 5]).ternary {|i| i &gt; 6} }\nend\n</code></pre>\n\n<h2>Benchmark</h2>\n\n<pre><code>Warming up --------------------------------------\n        My Technique    98.295k i/100ms\n      Your Technique    73.008k i/100ms\nCalculating -------------------------------------\n        My Technique      1.292M (\u00b1 1.9%) i/s -      6.487M in   5.023137s\n      Your Technique    891.204k (\u00b1 1.8%) i/s -      4.526M in   5.080896s\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: I have created new classes from <code>Array</code> for testing purposes. You can however open the <code>Array</code> class and add the behavior. It will work as fine.</p>\n</blockquote>\n"}], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 44666573, "answer_count": 3, "score": 0, "last_activity_date": 1498079162, "creation_date": 1497999501, "last_edit_date": 1498079162, "question_id": 44664282, "link": "https://stackoverflow.com/questions/44664282/ruby-evaluate-a-special-array-as-an-arbitrarily-long-ternary-if-elsif-else", "title": "ruby: evaluate a special array as an arbitrarily long ternary if...elsif...else statement (or ternary expression)", "body": "<p>I'm storing some decision-making data in arrays that look like: <code>[condition, result, ..., condition, result, default]</code>, so basically ternary expressions (<code>c ? r : ... c ? r : d</code>) and I'm evaluating them as such with this piece of code:</p>\n\n<pre><code>class Array\n  def ternary &amp;block\n    # the block checks if a condition is true\n    i = 0\n    while true\n      if i % 2 == 1 or i == length - 1\n        return self[i]\n      else\n        i += yield(self[i]) ? 1 : 2\n      end\n    end\n  end\nend\n\n['false', 0, 'true', 1, 'true', 2, 3].ternary {|i| i == 'true'}\n  # =&gt; 1\n[1, 2, 3, 4, 5].ternary {|i| i &gt; 6}\n  # =&gt; 5 (defaults to last value because all conditions failed)\n</code></pre>\n\n<p>I'm wondering if there's a faster built-in way of doing this or how I can improve this code.</p>\n\n<p>Note: there are arbitrarily many conditions and <code>[only_possible_answer]</code> should also work</p>\n\n<h1>EDIT: The answers so far (tested over 1 000 000 iterations of the same array):</h1>\n\n<h2>Setup</h2>\n\n<pre><code>flat = ['false', 0, 'false', 1, 'false', 2, 'false', 3, 'false', 4, 'true', 5, 6]\nnested = [['false', 0], ['false', 1], ['false', 2], ['false', 3], ['false', 4], ['true', 5], [6]]\nOption = Struct.new :condition, :result\nDefault = Struct.new :result\nclass Default\n  def call; self; end\n  # otherwise:\n  # undefined method \u2018call\u2019 for #&lt;struct Default result=whatever&gt;\nend\noptions = [Option.new('false', 0), Option.new('false', 1), Option.new('false', 2), Option.new('false', 3), Option.new('false', 4), Option.new('true', 5)]\n\nclass Array\n  def ternary_flat_slow\n    i = 0\n    while true\n      if i % 2 == 1 or i == length - 1\n        return self[i]\n      else\n        i += yield(self[i]) ? 1 : 2\n      end\n    end\n  end\n  def ternary_flat_fast # by @illusionist\n    index = 0\n    index += 2 until (index &gt;= self.length - 1) || yield(self[index]) \n    return self[index+1] unless index == self.length - 1 \n    self.last\n  end\n  def ternary_nested\n    find {|i| i.length == 1 or yield i[0]} .last\n  end\n  def ternary_options default # by @ReinHenrichs\n    find(default) {|i| yield i} .result\n  end\n  def case_when_then_else(&amp;block) # by @Amadan\n    each_slice(2).find { |x|\n      x.size == 1 || (block_given? ? block[x[0]] : x[0])\n    }&amp;.last\n  end\nend\n\nrequire 'benchmark'\n\nBenchmark.bmbm(9) do |i|\n  i.report('flat slow') { 1000000.times { flat.ternary_flat_slow {|con| con == 'true' }}}\n  i.report('flat fast') { 1000000.times { flat.ternary_flat_fast {|con| con == 'true' }}}\n  i.report('   nested') { 1000000.times { nested.ternary_nested {|con| con == 'true' }}}\n  i.report('  options') { 1000000.times { options.ternary_options(Default.new(6)) {|con| con.condition == 'true' }}}\n  i.report('  c_w_t_e') { 1000000.times { flat.case_when_then_else {|con| con == 'true' }}}\nend\n</code></pre>\n\n<h2>Results</h2>\n\n<pre><code>Rehearsal ---------------------------------------------\nflat slow   4.510000   0.030000   4.540000 (  4.549424) # original\nflat fast   3.600000   0.030000   3.630000 (  3.656058) # @illusionist\n   nested   6.920000   0.080000   7.000000 (  7.252300) # me (as suggested)\n  options   7.030000   0.050000   7.080000 (  7.130508) # @ReinHenrichs\n  c_w_t_e  19.320000   0.140000  19.460000 ( 19.593633) # @Amadan\n----------------------------------- total: 41.710000sec\n\n                user     system      total        real\nflat slow   4.290000   0.030000   4.320000 (  4.339875) # original\nflat fast   3.360000   0.020000   3.380000 (  3.401809) # @illusionist\n   nested   6.180000   0.040000   6.220000 (  6.258939) # me (as suggested)\n  options   6.640000   0.040000   6.680000 (  6.704991) # @ReinHenrichs\n  c_w_t_e  18.340000   0.120000  18.460000 ( 18.548176) # @Amadan\n</code></pre>\n\n<p>However \"unrubyish\" it is, @illusionist's answer is the fastest and speed is a primary concern</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "websocket"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1498025819, "post_id": 44663772, "comment_id": 76321095, "body": "I would consider the target client as well. I don&#39;t know if ActionCable has non-browser clients and it&#39;s possible that you want the Websocket API to be accessible also to native mobile apps (not just browsers)....? P.S. I&#39;m biased, since I&#39;m the author of iodine (the Ruby web socket server) and <a href=\"http://www.plezi.io\" rel=\"nofollow noreferrer\">Plezi</a> (a real-time application framework built on iodine). I voted with my actions to leave websockets out of ActionCable&#39;s hands."}, {"owner": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1498026403, "post_id": 44663772, "comment_id": 76321347, "body": "Yes my main goal is to handle just mobiles and I am wondering if ActionCable is appropriate to achieve that."}], "answers": [{"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 1, "last_activity_date": 1498070932, "last_edit_date": 1498070932, "creation_date": 1498032456, "answer_id": 44670291, "question_id": 44663772, "link": "https://stackoverflow.com/questions/44663772/rails-actioncable-api-mode/44670291#44670291", "title": "Rails ActionCable API mode", "body": "<p>I would probably avoid using the ActionCable semantics and internal protocol for an API project that includes non-browser clients.</p>\n\n<p>For example:</p>\n\n<ul>\n<li><p>ActionCable's internal semantics / protocol might change between versions. Since your code will be tightly coupled with ActionCable's internal workings, it might be harder to upgrade.</p></li>\n<li><p>ActionCable's internal semantics / protocol might or might not include everything you need, whereas writing your own Websocket messaging protocol (especially using JSON) is super easy and will offer you an exact fit.</p></li>\n</ul>\n\n<p>This doesn't mean you need to completely move away from Rails. It should be easy enough to use your Rails models and code within a non-Rails Websocket alternative.</p>\n\n<p>Also, Ruby has some nice Websocket alternatives for ActionCable.</p>\n\n<p>I'm biased, being the author of both <a href=\"https://github.com/boazsegev/iodine\" rel=\"nofollow noreferrer\">Iodine - an HTTP/Websocket server with native Pub/Sub</a> and <a href=\"http://www.plezi.io\" rel=\"nofollow noreferrer\">Plezi.io, a real-time web application framework</a>... but I would probably use iodine (with or without the added comfort offered by Plezi).</p>\n\n<p>A simple Websocket application with Plezi will look something like this (seriously, run the following code from the terminal using <code>irb</code>, it works):</p>\n\n<pre><code>require 'plezi'\nclass ChatServer\n  def index\n    \"Use Websockets to connect.\"\n  end\n  def on_open\n    @name = params['id'] || \"anonymmous\"\n    subscribe channel: \"chat\"\n    publish channel: \"chat\", message: \"#{@name} joind the chat.\"\n    write \"Welcome, #{@name}!\"\n  end\n  def on_close\n    publish channel: \"chat\", message: \"#{@name} left the chat.\"\n  end\n  def on_message data\n    publish channel: \"chat\", message: \"#{@name}: #{data}\"\n  end\n  def on_shutdown\n    write \"Server shutting down. Goodbye #{@name}\"\n  end\nend\nPlezi.route '/', ChatServer\n\n# We'll monitor message just for kicks:\nsubscription = Iodine.subscribe(pattern: \"*\") do |channel, message|\n  # print a log?\n  puts \"\\n* Message on channel #{channel}:\\n#{message}\\n\"\nend\n# make sure we don't duplicate our monitoring on every process.\nroot_pid = Process.pid\nIodine.run { Iodine.unsubscribe(subscription) unless Process.pid == root_pid }\n\nexit\n</code></pre>\n\n<p>No Redis server required, no special things to prepare and it's possible to use plezi as middleware within a Rails application (running the <code>iodine</code> server instead of <code>puma</code>).</p>\n"}], "owner": {"reputation": 613, "user_id": 5032873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MSWnq.jpg?s=128&g=1", "display_name": "mike927", "link": "https://stackoverflow.com/users/5032873/mike927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1498070932, "creation_date": 1497996367, "question_id": 44663772, "link": "https://stackoverflow.com/questions/44663772/rails-actioncable-api-mode", "title": "Rails ActionCable API mode", "body": "<p>I am going to create Rails API that handles WebSocket based on ActionCable (first of all, it is good idea to use ActionCable in API mode ?). ActionCable works well for full stack Rails application but I encountered difficulties with API. The first question is what kind of format should have all requests to actionCable server. All I've found so far it is subscribe action:</p>\n\n<pre><code>{\n  \"command\":\"subscribe\",\n  \"identifier\":\"{\\\"channel\\\":\\\"SomeChannel\\\"}\"\n}\n</code></pre>\n\n<p>How about others? Is there any documentation where I can find that?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby", "windows", "process"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1497998939, "post_id": 44663549, "comment_id": 76313898, "body": "How about <code>system(&quot;tasklist&quot;)</code>?"}, {"owner": {"reputation": 3853, "user_id": 18197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68162a00c688d604d5514e0b719b90e?s=128&d=identicon&r=PG", "display_name": "Pavling", "link": "https://stackoverflow.com/users/18197/pavling"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1498002514, "post_id": 44663549, "comment_id": 76314888, "body": "or <code>get-process</code> if you have powershell... quick @orde, put it as an answer before I do! ;-)"}, {"owner": {"reputation": 1215, "user_id": 4081647, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/31e29b70920f6bc0952ed800b4e28261?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysQuestioning", "link": "https://stackoverflow.com/users/4081647/alwaysquestioning"}, "edited": false, "score": 0, "creation_date": 1498002590, "post_id": 44663549, "comment_id": 76314906, "body": "I would rather not spawn any shell. I would rather use a Ruby API."}, {"owner": {"reputation": 3853, "user_id": 18197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68162a00c688d604d5514e0b719b90e?s=128&d=identicon&r=PG", "display_name": "Pavling", "link": "https://stackoverflow.com/users/18197/pavling"}, "edited": false, "score": 0, "creation_date": 1498002760, "post_id": 44663549, "comment_id": 76314947, "body": "You don&#39;t want any dependency or library, you said. so use <code>system</code> or backticks."}, {"owner": {"reputation": 1215, "user_id": 4081647, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/31e29b70920f6bc0952ed800b4e28261?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysQuestioning", "link": "https://stackoverflow.com/users/4081647/alwaysquestioning"}, "edited": false, "score": 0, "creation_date": 1498004786, "post_id": 44663549, "comment_id": 76315384, "body": "I meant I don&#39;t want any <i>external</i> library not included in baseline Ruby. If <code>system</code> does not spawn a shell I will look into it."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "reply_to_user": {"reputation": 3853, "user_id": 18197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68162a00c688d604d5514e0b719b90e?s=128&d=identicon&r=PG", "display_name": "Pavling", "link": "https://stackoverflow.com/users/18197/pavling"}, "edited": false, "score": 0, "creation_date": 1498005078, "post_id": 44663549, "comment_id": 76315446, "body": "@Pavling: LOL.  Feel free to edit my answer with the powershell info."}], "answers": [{"comments": [{"owner": {"reputation": 1215, "user_id": 4081647, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/31e29b70920f6bc0952ed800b4e28261?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysQuestioning", "link": "https://stackoverflow.com/users/4081647/alwaysquestioning"}, "edited": false, "score": 0, "creation_date": 1498005262, "post_id": 44665005, "comment_id": 76315481, "body": "Is there any way I can do this without interacting with directly interacting with a shell? E.g. some higher-level already-included Ruby module?"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "reply_to_user": {"reputation": 1215, "user_id": 4081647, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/31e29b70920f6bc0952ed800b4e28261?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysQuestioning", "link": "https://stackoverflow.com/users/4081647/alwaysquestioning"}, "edited": false, "score": 1, "creation_date": 1498006754, "post_id": 44665005, "comment_id": 76315794, "body": "Well, it&#39;s a Kernal method, so I don&#39;t think you&#39;ll get much higher level than that. But--if you use <a href=\"https://ruby-doc.org/core-2.4.1/Kernel.html#method-i-60\" rel=\"nofollow noreferrer\"><code>backticks</code></a>--you could assign the result because it returns &quot;the standard output of running cmd in a subshell&quot;.  <code>Kernal::system</code> &quot;returns true if the command gives zero exit status, false for non zero exit status. Returns nil if command execution fails.&quot;"}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": false, "score": 2, "last_activity_date": 1498004888, "creation_date": 1498004888, "answer_id": 44665005, "question_id": 44663549, "link": "https://stackoverflow.com/questions/44663549/how-can-i-list-all-running-windows-processes-using-ruby-without-any-additional-l/44665005#44665005", "title": "How can I list all running Windows processes using Ruby without any additional library?", "body": "<p>You can use the <a href=\"https://ruby-doc.org/core-2.4.1/Kernel.html#method-i-system\" rel=\"nofollow noreferrer\"><code>Kernal::system</code></a>  method to execute a command line argument.  For example:</p>\n\n<pre><code>system(\"tasklist\")\n\n    Image Name                     PID Session Name        Session#    Mem Usage\n========================= ======== ================ =========== ============\nSystem Idle Process              0 Services                   0         24 K\n...\nruby.exe                      1336 Console                    1      9,100 K\ntasklist.exe                   944 Console                    1      5,332 K\n</code></pre>\n\n<p>Alternately--as points @Pavling out--you can use <code>[Kernal::`]</code>(aka backtick), but some find it less readable.  YMMV.</p>\n"}], "owner": {"reputation": 1215, "user_id": 4081647, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/31e29b70920f6bc0952ed800b4e28261?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysQuestioning", "link": "https://stackoverflow.com/users/4081647/alwaysquestioning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498004888, "creation_date": 1497995200, "last_edit_date": 1498004802, "question_id": 44663549, "link": "https://stackoverflow.com/questions/44663549/how-can-i-list-all-running-windows-processes-using-ruby-without-any-additional-l", "title": "How can I list all running Windows processes using Ruby without any additional library?", "body": "<p>I want to list all processes running on my Windows system using Ruby without installing any additional dependency or library that is not already part of Ruby. I have not found any way to do this online. Is there any clean way to do this from Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "edited": false, "score": 0, "creation_date": 1497996004, "post_id": 44663509, "comment_id": 76312980, "body": "Try forcing the rubygems version to be same in both systems. gem update --system version_from_working _system"}, {"owner": {"reputation": 2446, "user_id": 151472, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/94919cfc16f05edaee8d64224120f49c?s=128&d=identicon&r=PG", "display_name": "modulaaron", "link": "https://stackoverflow.com/users/151472/modulaaron"}, "reply_to_user": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "edited": false, "score": 0, "creation_date": 1497996353, "post_id": 44663509, "comment_id": 76313090, "body": "That did the trick, thanks so much!"}], "answers": [{"tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": true, "score": 1, "last_activity_date": 1497996661, "creation_date": 1497996661, "answer_id": 44663828, "question_id": 44663509, "link": "https://stackoverflow.com/questions/44663509/bundler-not-recognizing-local-gem-path/44663828#44663828", "title": "Bundler not recognizing local gem path", "body": "<pre><code>  gem update --system version_from_working_system\n</code></pre>\n"}], "owner": {"reputation": 2446, "user_id": 151472, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/94919cfc16f05edaee8d64224120f49c?s=128&d=identicon&r=PG", "display_name": "modulaaron", "link": "https://stackoverflow.com/users/151472/modulaaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 44663828, "answer_count": 1, "score": 0, "last_activity_date": 1497996661, "creation_date": 1497994943, "last_edit_date": 1497995331, "question_id": 44663509, "link": "https://stackoverflow.com/questions/44663509/bundler-not-recognizing-local-gem-path", "title": "Bundler not recognizing local gem path", "body": "<p>For a site on its current server, running <code>bundle install --path vendor/bundle --full-index</code> runs with no issues. However, when I run this for the same site on my new server (same version of Bundler), I get:</p>\n\n<pre><code>NoMethodError: undefined method `spec' for nil:NilClass\nAn error occurred while installing userstamp (2.0.2), and Bundler cannot continue.\nMake sure that `gem install userstamp -v '2.0.2'` succeeds before bundling.\n</code></pre>\n\n<p>That specific gem is defined like this in the Gemfile:</p>\n\n<pre><code>gem 'userstamp', '2.0.2', path: \"vendor/local_gems/userstamp\"\n</code></pre>\n\n<p>and the gem is present there. This means that Bundler is ignoring the <code>path</code> option in the Gemfile. Any suggestions on how to proceed?</p>\n"}, {"tags": ["ruby", "selenium", "safari", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 780180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lzzGj.jpg?s=128&g=1", "display_name": "N D", "link": "https://stackoverflow.com/users/780180/n-d"}, "is_accepted": false, "score": 4, "last_activity_date": 1582602092, "last_edit_date": 1582602092, "creation_date": 1497994764, "answer_id": 44663482, "question_id": 44663481, "link": "https://stackoverflow.com/questions/44663481/how-to-setup-capybara-with-safari-technology-preview-in-ruby/44663482#44663482", "title": "How to setup Capybara with Safari Technology Preview in Ruby", "body": "<p>To get this to work I used the following code:</p>\n\n<pre><code>    #This is what we use to test the Safari release channel. \n    #You will have to install Safari Technology Preview (STP) from Apple.\n\n    #see standard properties here: https://www.w3.org/TR/webdriver/#capabilities\n    #STP requires a capabilities object\n    #you could use any of the properties from the link above. \n    #I just used a accept_insecure_certs for the heck of it\n    desired_caps = Selenium::WebDriver::Remote::Capabilities.safari(\n      {\n        accept_insecure_certs: true\n      }\n    )\n    Capybara.register_driver :safari_technology_preview do |app|\n      Capybara::Selenium::Driver.new(\n        app,\n        browser: :safari,\n        driver_path: '/Applications/Safari Technology Preview.app/Contents/MacOS/safaridriver',\n        desired_capabilities: desired_caps\n      )\n    end\n    Capybara.default_driver = :safari_technology_preview\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2310, "user_id": 1760776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a06b0ee4ca4d278a813cadb1e0735b7?s=128&d=identicon&r=PG", "display_name": "tgf", "link": "https://stackoverflow.com/users/1760776/tgf"}, "is_accepted": false, "score": 0, "last_activity_date": 1587417514, "creation_date": 1587417514, "answer_id": 61332214, "question_id": 44663481, "link": "https://stackoverflow.com/questions/44663481/how-to-setup-capybara-with-safari-technology-preview-in-ruby/61332214#61332214", "title": "How to setup Capybara with Safari Technology Preview in Ruby", "body": "<p>There is now a way to do this without specifying the path (which you may not know).  The Selenium driver supports telling the driver that you want Technology Preview.  However this seems to work a little differently than other options.</p>\n\n<p>Calling <code>Selenium::WebDriver::Safari.technology_preview!</code> turns the feature on for any Safari Driver created after this.</p>\n\n<pre><code>Capybara.register_driver :safari_tech_preview do |app|\n  Selenium::WebDriver::Safari.technology_preview!\n  capabilities = Selenium::WebDriver::Remote::Capabilities.safari\n  Capybara::Selenium::Driver.new(app, browser: :safari, desired_capabilities: capabilities)\nend\n</code></pre>\n\n<p>Make sure you've enabled remote automation in the tech preview browser first.</p>\n"}], "owner": {"reputation": 635, "user_id": 780180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lzzGj.jpg?s=128&g=1", "display_name": "N D", "link": "https://stackoverflow.com/users/780180/n-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1136, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1587417514, "creation_date": 1497994764, "question_id": 44663481, "link": "https://stackoverflow.com/questions/44663481/how-to-setup-capybara-with-safari-technology-preview-in-ruby", "title": "How to setup Capybara with Safari Technology Preview in Ruby", "body": "<p>I can't establish a session with Safari Technology Preview (STP) using Capybara and Selenium. Capybara won't even open a browser window.  </p>\n\n<p>I've upgraded to Ruby 2.3.0 Capybara 2.14.2 Selenium 3.4.0<br>\nI downloaded and installed STP from <a href=\"https://developer.apple.com/safari/download/\" rel=\"nofollow noreferrer\">https://developer.apple.com/safari/download/</a><br>\nI am trying to use the following code:</p>\n\n<pre><code>Capybara.register_driver :selenium do |app|\nCapybara::Selenium::Driver.new(\n  app,\n  browser: :safari \n)\nend\nCapybara.default_driver = :selenium\n</code></pre>\n\n<p>How do I initialize Capybara to use the STP safaridriver that has implemented the W3C standards for automation?  </p>\n"}, {"tags": ["arrays", "ruby", "performance", "optimization", "elementwise-operations"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1497994967, "post_id": 44663287, "comment_id": 76312604, "body": "Does <code>deep_array</code> need to be set to <code>new_array</code> (i.e. <code>deep_array.object_id == new_array.object_id</code> when you&#39;re done) or do you just need them to have the same contents?"}, {"owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "edited": false, "score": 0, "creation_date": 1497995036, "post_id": 44663287, "comment_id": 76312620, "body": "In the hash where ever deep_array is being referenced, you can switch that with new_array reference right, so you don&#39;t have to copy. {key =&gt; deep_array} you can change it to { key =&gt; new_array }, not sure if this is what you are looking for."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1497998302, "post_id": 44663287, "comment_id": 76313724, "body": "@muistooshort no, <code>new array</code> is a cached value in this case so it should stay as it is"}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "edited": false, "score": 0, "creation_date": 1497998488, "post_id": 44663287, "comment_id": 76313775, "body": "@Ucpuzz yes but the position of <code>deep_array</code> is more like <code>hash[a][b][c][d]</code> and <code>a, b, c and d</code> are arrays themselves and have to be hashed, it&#39;s too slow to access <code>deep_array</code>, that&#39;s why I have a local reference"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1498002494, "post_id": 44663287, "comment_id": 76314883, "body": "If you had a reference one level above what you have then maybe <code>whatever[:your_array] = new_array.dup</code> would work, I don&#39;t know if that would be significantly faster than manually copying element by element though. If you have such complicated and deeply nested data then maybe you should rethink how you&#39;re managing your data."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1498004021, "post_id": 44663287, "comment_id": 76315224, "body": "@muistooshort it&#39;s not storage, they&#39;re values used in calculation, I&#39;ve found that <code>[[array, array], ...]</code> works better than <code>{array =&gt; array, ...}</code> so I have a few levels nesting. That&#39;s better but still not quite the same, I&#39;m doing a lot of lookups and replacements and the array containing <code>deep_array</code> is quite big so (at least in benchmarks) modifying the reference is still faster than modifying <code>container[deep_array]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "is_accepted": true, "score": 0, "last_activity_date": 1498122408, "last_edit_date": 1498122408, "creation_date": 1498065683, "answer_id": 44682477, "question_id": 44663287, "link": "https://stackoverflow.com/questions/44663287/ruby-set-an-array-through-another-array-pointing-to-the-original/44682477#44682477", "title": "ruby set an array through another array pointing to the original", "body": "<p>Tell me if I'm wrong but <code>Array#replace</code> seems faster than any of the current answers as it doesn't require the new array to be <code>.dup</code>licated and doesn't need another reference to be created:</p>\n\n<pre><code>new_arrays = 1000000.times.map {4.times.map {rand 10}}\n\nrequire 'benchmark'\n\nBenchmark.bmbm(18) do |i|\n  i.report('     find, replace') do\n    hash = {0=&gt;{1=&gt;{2=&gt;{3=&gt;[]}}}}\n    1000000.times do |j|\n      hash[0][1][2][3].replace new_arrays[j]\n    end\n  end\n\n  i.report('         find, dup') do\n    hash = {0=&gt;{1=&gt;{2=&gt;{3=&gt;[]}}}}\n    1000000.times do |j|\n      hash[0][1][2][3] = new_arrays[j].dup\n    end\n  end\n\n  i.report('reference, replace') do\n    hash = {0=&gt;{1=&gt;{2=&gt;{3=&gt;[]}}}}\n    reference = hash[0][1][2][3]\n    1000000.times do |j|\n      reference.replace new_arrays[j]\n    end\n  end\n\n  i.report('    above ref, dup') do\n    hash = {0=&gt;{1=&gt;{2=&gt;{3=&gt;[]}}}}\n    above = hash[0][1][2]\n    1000000.times do |j|\n      above[3] = new_arrays[j].dup\n    end\n  end\nend\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>Rehearsal ------------------------------------------------------\n     find, replace   1.670000   0.090000   1.760000 (  1.791100)\n         find, dup   2.010000   0.110000   2.120000 (  2.193884)\nreference, replace   0.460000   0.000000   0.460000 (  0.470288)\n    above ref, dup   1.390000   0.020000   1.410000 (  1.421624)\n--------------------------------------------- total: 5.750000sec\n\n                         user     system      total        real\n     find, replace   0.960000   0.020000   0.980000 (  1.039140)\n         find, dup   1.720000   0.010000   1.730000 (  1.753176)\nreference, replace   0.470000   0.000000   0.470000 (  0.472988)\n    above ref, dup   1.360000   0.020000   1.380000 (  1.384833)\n</code></pre>\n\n<p>And the differences would be even more drastic if I were indexing with arrays</p>\n"}], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 44682477, "answer_count": 1, "score": 1, "last_activity_date": 1498122408, "creation_date": 1497994038, "last_edit_date": 1498007684, "question_id": 44663287, "link": "https://stackoverflow.com/questions/44663287/ruby-set-an-array-through-another-array-pointing-to-the-original", "title": "ruby set an array through another array pointing to the original", "body": "<p>I have some array <code>deep_array</code> that's deep in a hash and takes time to access, I also have a variable (<code>my_local_variable</code>) pointing to <code>deep_array</code> and some other local array <code>new_array</code>. I need to set <code>deep_array</code> to <code>new_array</code> through <code>my_local_variable</code>.</p>\n\n<p>Something equivalent to one of these:</p>\n\n<pre><code>my_local_variable.map!.with_index {|_, i| new_array[i]}\n\nmy_local_variable.each_with_index {|_, i| b[i] = new_array[i]}\n</code></pre>\n\n<p>but much faster</p>\n\n<p>Edit: speed</p>\n\n<p>This is a rough idea of the situation I'm dealing with:</p>\n\n<p>(in reality it's deeper but i'm doing fewer writes)</p>\n\n<pre><code>require 'benchmark'\nH = {[1,2,3]=&gt;[2,3,4],[3,4,5]=&gt;[4,5,6],[5,6,7]=&gt;[6,7,8]}\nh = H[[1,2,3]]\n\nBenchmark.bmbm(15) do |i|\n  i.report('local reference') {1_000_000.times {|i| h[0] = i}}\n  i.report('          index') {1_000_000.times {H[[1,2,3]][0] = i}}\nend\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>Rehearsal ---------------------------------------------------\nlocal reference   0.230000   0.010000   0.240000 (  0.234168)\n          index   5.780000   0.040000   5.820000 (  5.851909)\n------------------------------------------ total: 6.060000sec\n\n                      user     system      total        real\nlocal reference   0.220000   0.000000   0.220000 (  0.226742)\n          index   5.770000   0.030000   5.800000 (  5.830011)\n</code></pre>\n"}, {"tags": ["ruby", "apache-kafka", "apache-zookeeper", "supervisord"], "answers": [{"comments": [{"owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1497996338, "post_id": 44663463, "comment_id": 76313080, "body": "Thanks! Do you know, is there any benefit to increasing the number of partitions?"}, {"owner": {"reputation": 652, "user_id": 3929893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kTSBB.jpg?s=128&g=1", "display_name": "Quentin Geff", "link": "https://stackoverflow.com/users/3929893/quentin-geff"}, "reply_to_user": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "edited": false, "score": 0, "creation_date": 1498037022, "post_id": 44663463, "comment_id": 76328189, "body": "&quot;More Partitions Lead to Higher Throughput&quot; : <a href=\"https://www.confluent.io/blog/how-to-choose-the-number-of-topicspartitions-in-a-kafka-cluster/\" rel=\"nofollow noreferrer\">confluent.io/blog/&hellip;</a> ;)"}], "tags": [], "owner": {"reputation": 652, "user_id": 3929893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kTSBB.jpg?s=128&g=1", "display_name": "Quentin Geff", "link": "https://stackoverflow.com/users/3929893/quentin-geff"}, "is_accepted": true, "score": 1, "last_activity_date": 1497994679, "creation_date": 1497994679, "answer_id": 44663463, "question_id": 44663115, "link": "https://stackoverflow.com/questions/44663115/kafka-consumer-nomethoderror-undefined-method-length-for-nilnilclass/44663463#44663463", "title": "Kafka Consumer NoMethodError: undefined method `length&#39; for nil:NilClass", "body": "<p>It seems, all your consumers are in the same consumer-group and subscribe to the same topic wich have only 5 partitons. If you want distribute the consumation charge on 50 consumers you have to configure your topic with 50 partitions.</p>\n"}], "owner": {"reputation": 2393, "user_id": 5252715, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/173d75348dae4a3a945234ac0a528e37?s=128&d=identicon&r=PG", "display_name": "malexanders", "link": "https://stackoverflow.com/users/5252715/malexanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 44663463, "answer_count": 1, "score": 0, "last_activity_date": 1497994679, "creation_date": 1497993319, "question_id": 44663115, "link": "https://stackoverflow.com/questions/44663115/kafka-consumer-nomethoderror-undefined-method-length-for-nilnilclass", "title": "Kafka Consumer NoMethodError: undefined method `length&#39; for nil:NilClass", "body": "<p>I'm running multiple kafka consumers, each on their own server, that are reading from the same topic defined on a remote kafka cluster. Only 5 of 50 servers are successfully running the consumer process. The rest are failing to start - here are the logs:</p>\n\n<blockquote>\n  <p>I, [2017-06-20T20:25:13.524287 #13302]  INFO -- : Registered for\n  conversions-processor as web1:d671ebce-bf76-4917-b504-ffd5924994f2 I,\n  [2017-06-20T20:25:13.529857 #13302]  INFO -- : 6 instances have been\n  registered: web11:86472d4d-cc95-4a5d-bc52-d1c97a8a9c34,\n  web1:d671ebce-bf76-4917-b504-ffd5924994f2,\n  web14:818a5194-bb51-48d4-bd59-2221a4d3c7ac,\n  web12:11e3f37e-5612-4306-bb1d-bf831da42052,\n  web13:8ace8116-09a4-451c-80b2-8b199ebf45be,\n  web10:8b17b591-9cb0-4193-a460-967ec30cc48c. bundler: failed to load\n  command:\n  /home/deploy/apps/test/current/exe/tracking-events-kafka-consumer.rb\n  (/home/deploy/apps/test/current/exe/tracking-events-kafka-consumer.rb)\n  NoMethodError: undefined method <code>length' for nil:NilClass<br>\n  /home/deploy/apps/test/shared/bundle/ruby/2.3.0/bundler/gems/kafka-consumer-268309adaabe/lib/kafka/consumer.rb:130:in\n  </code>manage_partition_consumers'<br>\n  /home/deploy/apps/test/shared/bundle/ruby/2.3.0/bundler/gems/kafka-consumer-268309adaabe/lib/kafka/consumer.rb:88:in\n  <code>block in each' I, [2017-06-20T20:25:15.320951 #13363]  INFO -- :\n  Registered for conversions-processor as\n  web1:15494044-ddf7-4702-9578-ab828be62478 I,\n  [2017-06-20T20:25:15.325198 #13363]  INFO -- : 6 instances have been\n  registered: web13:8ace8116-09a4-451c-80b2-8b199ebf45be,\n  web12:11e3f37e-5612-4306-bb1d-bf831da42052,\n  web10:8b17b591-9cb0-4193-a460-967ec30cc48c,\n  web11:86472d4d-cc95-4a5d-bc52-d1c97a8a9c34,\n  web14:818a5194-bb51-48d4-bd59-2221a4d3c7ac,\n  web1:15494044-ddf7-4702-9578-ab828be62478. bundler: failed to load\n  command:\n  /home/deploy/apps/test/current/exe/tracking-events-kafka-consumer.rb\n  (/home/deploy/apps/test/current/exe/tracking-events-kafka-consumer.rb)\n  NoMethodError: undefined method</code>length' for nil:NilClass<br>\n  /home/deploy/apps/test/shared/bundle/ruby/2.3.0/bundler/gems/kafka-consumer-268309adaabe/lib/kafka/consumer.rb:130:in\n  <code>manage_partition_consumers'<br>\n  /home/deploy/apps/test/shared/bundle/ruby/2.3.0/bundler/gems/kafka-consumer-268309adaabe/lib/kafka/consumer.rb:88:in\n  </code>block in each'</p>\n</blockquote>\n\n<p>If I stop the consumer on one box - I can start it successfully on one of the boxes that had previously failed. It seems that my configuration only allows 5 consumers to be registered at a time?</p>\n\n<p>My question is, why is this happening? and how might I fix it?</p>\n\n<p>Any suggestions or insight, as always, is hugely appreciated!!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "answers": [{"tags": [], "owner": {"reputation": 12104, "user_id": 87298, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd2e27498ad94413dcc5d4d660dd43cf?s=128&d=identicon&r=PG", "display_name": "Edward Anderson", "link": "https://stackoverflow.com/users/87298/edward-anderson"}, "is_accepted": false, "score": 0, "last_activity_date": 1599766564, "last_edit_date": 1599766564, "creation_date": 1599753890, "answer_id": 63833585, "question_id": 44663081, "link": "https://stackoverflow.com/questions/44663081/ruby-rails-csv-column-specific-converters/63833585#63833585", "title": "Ruby/Rails: CSV column specific converters", "body": "<p>Though CSV doesn't provide such an interface, it does allow you to specify multiple converters to try. It only applies each filter when a value matches the that filter's expected format.</p>\n<p>Therefore you can specify both converters in your options, and CSV will intelligently apply them whenever a column's value matches the format for an integer or date.</p>\n<pre><code>converters: [:integer, :date]\n</code></pre>\n<p>The downside to their approach is that it will also convert dates and integers in other columns rather than leaving them as strings.</p>\n<p>If you need to get around this limitation, you can provide a lambda converter that takes 2 parameters, where the 2nd parameter is a <code>CSV::FieldInfo</code> that contains the header, aka what column the value is in, and apply conversions only to specific columns.</p>\n"}], "owner": {"reputation": 16860, "user_id": 1536309, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/40f2ef2f2a528a76dbd3667acd154e5c?s=128&d=identicon&r=PG", "display_name": "Blair Anderson", "link": "https://stackoverflow.com/users/1536309/blair-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1599766564, "creation_date": 1497993191, "last_edit_date": 1497994659, "question_id": 44663081, "link": "https://stackoverflow.com/questions/44663081/ruby-rails-csv-column-specific-converters", "title": "Ruby/Rails: CSV column specific converters", "body": "<p>I have a CSV and using the default CSV library would like to apply different converters to different columns</p>\n\n<p>headers are:</p>\n\n<pre><code>units_at_warehouse(#integer),\n  external_id(#string),\n    released(#date),\n      list_price_cents(#integer)\n</code></pre>\n\n<p>I am current using these options:</p>\n\n<pre><code>options = {\n  headers: true, \n  converters: nil, \n  header_converters: :symbol\n}\n\nCSV.foreach(file, options) do |row|\n  # current my best option is:\n  convert_integers(row)\n  convert_dates(row)\n  persist(row)#...saving\nend\n</code></pre>\n\n<p>Is it possible to pass in a converter <strong>PER</strong> column?</p>\n\n<p>Something like:</p>\n\n<pre><code>options = {\n  headers: true, \n  header_converters: :symbol,\n  converters: {\n    units_at_warehouse: :numeric,\n    list_price_cents: :numeric,\n    released: :date\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1497993698, "post_id": 44662866, "comment_id": 76312075, "body": "hope one of these <a href=\"http://cobwwweb.com/4-ways-to-pass-arguments-to-a-rake-task\" rel=\"nofollow noreferrer\">cobwwweb.com/4-ways-to-pass-arguments-to-a-rake-task</a> options work for you"}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1497994539, "post_id": 44662866, "comment_id": 76312415, "body": "I think you just need to invert your condition, i.e. you want to read <code>$stdin</code> if it\u2019s <i>not</i> a tty (it\u2019s a pipe)."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1497998544, "post_id": 44662866, "comment_id": 76313786, "body": "@matt you are correct, feel free to add answer or I will"}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1498003127, "post_id": 44664751, "comment_id": 76315043, "body": "Edited to use unless instead of <code>if !</code>"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1498003109, "last_edit_date": 1498003109, "creation_date": 1498002862, "answer_id": 44664751, "question_id": 44662866, "link": "https://stackoverflow.com/questions/44662866/optionally-allowing-stdin-to-be-passed-to-a-rake-task/44664751#44664751", "title": "Optionally allowing STDIN to be passed to a rake task", "body": "<p>You just need to invert the condition. What you want is to read stdin if it\u2019s <em>not</em> a tty:</p>\n\n<pre><code>instructions = STDIN.read.split(\"\\n\") unless STDIN.tty?\n</code></pre>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 44664751, "answer_count": 1, "score": 0, "last_activity_date": 1498003109, "creation_date": 1497992235, "question_id": 44662866, "link": "https://stackoverflow.com/questions/44662866/optionally-allowing-stdin-to-be-passed-to-a-rake-task", "title": "Optionally allowing STDIN to be passed to a rake task", "body": "<p>I have a rake task that I would like to be optionally given stdin, e.g. either of the following could work:</p>\n\n<pre><code>rake my_task\ncat foo.txt | rake my_task\n</code></pre>\n\n<p>The problem is that I don't have a reliable way to check whether STDIN was given to the program. Here's my current attempt, which just hangs indeterminately:</p>\n\n<pre><code>instructions = STDIN.read.split(\"\\n\") if STDIN.tty?\n</code></pre>\n\n<p>I added the <code>STDIN.tty?</code> after reading <a href=\"https://stackoverflow.com/questions/4622046/how-can-you-check-for-stdin-input-in-a-ruby-script\">how-can-you-check-for-stdin-input-in-a-ruby-script</a>. It is returning <code>true</code> when I invoke it with <code>rake my_task</code> (no stdin)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1497991387, "post_id": 44662545, "comment_id": 76310985, "body": "Did you check the release notes or the commit message?"}], "answers": [{"tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 11, "last_activity_date": 1497991986, "creation_date": 1497991986, "answer_id": 44662809, "question_id": 44662545, "link": "https://stackoverflow.com/questions/44662545/why-is-session-store-initializer-removed-in-rails-5-1-1/44662809#44662809", "title": "Why is session store initializer removed in Rails 5.1.1", "body": "<p>Here's the commit where it was removed: <a href=\"https://github.com/rails/rails/commit/e5a6f7ee9e951dbe0e4e9ea2c0743b4dfb135c57\" rel=\"noreferrer\">Setup default session store internally, no longer through an application initializer</a></p>\n\n<p>In summary, new apps don't have that initializer, instead the session store is set to cookie store by default. i.e. the same as the value that used to be specified in the generated version of that initializer.</p>\n"}], "owner": {"reputation": 5255, "user_id": 2639304, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/40c44219d944f4acb6182fd153a87b73?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2639304/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3275, "favorite_count": 2, "accepted_answer_id": 44662809, "answer_count": 1, "score": 8, "last_activity_date": 1503911728, "creation_date": 1497990967, "last_edit_date": 1503911728, "question_id": 44662545, "link": "https://stackoverflow.com/questions/44662545/why-is-session-store-initializer-removed-in-rails-5-1-1", "title": "Why is session store initializer removed in Rails 5.1.1", "body": "<p>I went to this <a href=\"http://railsdiff.org/5.0.0/5.1.1\" rel=\"noreferrer\">website</a> to see the differences between Rails 5.0.0 and Rails 5.1.1</p>\n\n<p>Why does 5.1.1 not anymore include: <code>config/initializers/session_store.rb</code>?</p>\n\n<p>Thanks<a href=\"https://i.stack.imgur.com/woyIj.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/woyIj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497988847, "post_id": 44661911, "comment_id": 76309605, "body": "Yeah, it doesn&#39;t seem to install anything, but it will have to download any referenced Git repositories to gather any related version information from them."}, {"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "edited": false, "score": 0, "creation_date": 1497988969, "post_id": 44661911, "comment_id": 76309687, "body": "The problem is that I don&#39;t have the gem installed that are in the gemfile installed on my system the command <code>outdated</code> exit early without results: ` Could not find gem &#39;sidekiq&#39; in any of the gem sources listed in your Gemfile.`"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497989183, "post_id": 44661911, "comment_id": 76309809, "body": "The <code>bundle</code> command has to verify versus not only the <code>.lock</code> file but the gems that are actually installed. I&#39;m not sure you can skip the installation check."}, {"owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497989323, "post_id": 44661911, "comment_id": 76309886, "body": "@tadman it is what I feared... guess I need to manually parse the .lock file and check if there are new versions manually"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497990301, "post_id": 44661911, "comment_id": 76310373, "body": "It&#39;s not as easy as you&#39;d think since Bundler does a lot of dependency math to see if it&#39;s possible to upgrade. Just because there&#39;s a newer version published on Rubygems doesn&#39;t mean it&#39;s a valid option for your project. You could try and patch this functionality in by leveraging the dependency tree code and make a pull request if you&#39;re feeling adventurous."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 4, "last_activity_date": 1497988412, "creation_date": 1497988412, "answer_id": 44661911, "question_id": 44661806, "link": "https://stackoverflow.com/questions/44661806/how-can-i-run-bundle-outdated-without-the-gems-actually-installed/44661911#44661911", "title": "How can I run `bundle outdated` without the gems actually installed?", "body": "<p><code>gem outdated</code> prints outdated gems without installing them.</p>\n"}], "owner": {"reputation": 2159, "user_id": 4898937, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/iwgDT.jpg?s=128&g=1", "display_name": "ciaoben", "link": "https://stackoverflow.com/users/4898937/ciaoben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497989082, "creation_date": 1497988010, "last_edit_date": 1497989082, "question_id": 44661806, "link": "https://stackoverflow.com/questions/44661806/how-can-i-run-bundle-outdated-without-the-gems-actually-installed", "title": "How can I run `bundle outdated` without the gems actually installed?", "body": "<p>I have a folder with a Gemfile, I can generate the <code>Gemfile.lock</code> with <code>bundle lock</code>, and I want to get the available updates through <code>bundle outdated</code> but without the need of having all the gems listed in my <code>Gemfile.lock</code> installed on my system.</p>\n\n<p>Is is possible?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497987599, "post_id": 44661511, "comment_id": 76308903, "body": "<code>[&quot;abc&quot;, &quot;FFF&quot;, &quot;EEE&quot;]</code> should return 1 or 0?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497987927, "post_id": 44661511, "comment_id": 76309076, "body": "Should return &quot;1&quot; since &quot;FFF&quot; is the first string whose case differs from a previous element&#39;s."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497988071, "post_id": 44661511, "comment_id": 76309154, "body": "Yes, now I&#39;ve realized of it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1498024217, "post_id": 44661511, "comment_id": 76320367, "body": "What if the array were <code>[&quot;666&quot;, &quot;ccc&quot;, &quot;DDD&quot;]</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1497993180, "post_id": 44661794, "comment_id": 76311849, "body": "You could replace <code>each_cons(2)</code> + logic + <code>return</code> by a <code>chunk_while</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1498010508, "post_id": 44661794, "comment_id": 76316608, "body": "Consider <code>...with_index(1)</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1498023190, "post_id": 44661794, "comment_id": 76319979, "body": "@EricDuminil: could you elaborate on how can we use <code>chunk_while</code>, given that the requirement seems to be to find the index of first element with different case."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1498023354, "post_id": 44661794, "comment_id": 76320035, "body": "@CarySwoveland: oooohh, didn&#39;t know about this one, thanks!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1498023365, "last_edit_date": 1498023365, "creation_date": 1497987960, "answer_id": 44661794, "question_id": 44661511, "link": "https://stackoverflow.com/questions/44661511/how-do-i-find-the-first-string-of-differing-case-in-an-array/44661794#44661794", "title": "How do I find the first string of differing case in an array?", "body": "<p>You could take each consecutive pair of elements and compare their upcase-ness. When they differ, you return the index.</p>\n\n<pre><code>def detect_case_change(ary)\n  ary.each_cons(2).with_index(1) do |(a, b), idx|\n    return idx if (a == a.upcase) != (b == b.upcase)\n  end\n  nil\nend\n\ndetect_case_change [\"abc\", \"FFF\", \"EEE\"] # =&gt; 1\ndetect_case_change [\"P\", \"P2F\", \"ccc\", \"DDD\"] # =&gt; 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497988215, "post_id": 44661830, "comment_id": 76309249, "body": "&quot;your data being composed entirely of &#39;A&#39;..&#39;Z&#39; and &#39;a&#39;..&#39;z&#39;&quot; - actually, sample data in the question has digits in it. Although not at the first position."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "edited": false, "score": 0, "creation_date": 1497988268, "post_id": 44661830, "comment_id": 76309280, "body": "Would the above still work for non A-Z characters, like a or e with the accent mark on them?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497988273, "post_id": 44661830, "comment_id": 76309282, "body": "Yeah, this might be needlessly specific, but it might also be sufficient. Just putting it out there."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1497988324, "post_id": 44661830, "comment_id": 76309317, "body": "@Natalia Not all accented characters are actually the same letter. In some languages &#229; and a are two totally different things, while in others &#233; and e are roughly equivalent. This will not work on UTF-8 data, only 7-bit ASCII and only letters. If you&#39;re going into accented letters, then &#223; and &#230; are possibilities as well, so &#198; might end up involved. This rabbit hole is super deep."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1497988094, "creation_date": 1497988094, "answer_id": 44661830, "question_id": 44661511, "link": "https://stackoverflow.com/questions/44661511/how-do-i-find-the-first-string-of-differing-case-in-an-array/44661830#44661830", "title": "How do I find the first string of differing case in an array?", "body": "<p>This makes some assumptions about your data being composed entirely of 'A'..'Z' and 'a'..'z':</p>\n\n<pre><code>def find_case_mismatch(list)\n  index = list.each_cons(2).to_a.index do |(a,b)|\n    a[0].ord &amp; 32 != b[0].ord &amp; 32\n  end\n\n  index &amp;&amp; index + 1\nend\n</code></pre>\n\n<p>This compares the character values. 'A' differs from 'a' by one bit, and that bit is always in the same place (0x20).</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1498023437, "post_id": 44663004, "comment_id": 76320054, "body": "Ah, I see. Clever!"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 1, "last_activity_date": 1497993217, "last_edit_date": 1497993217, "creation_date": 1497992855, "answer_id": 44663004, "question_id": 44661511, "link": "https://stackoverflow.com/questions/44661511/how-do-i-find-the-first-string-of-differing-case-in-an-array/44663004#44663004", "title": "How do I find the first string of differing case in an array?", "body": "<p><a href=\"https://ruby-doc.org/core-2.3.1/Enumerable.html#method-i-chunk\" rel=\"nofollow noreferrer\"><code>Enumerable#chunk</code></a> helps a lot for this task.</p>\n\n<blockquote>\n  <p>Enumerates over the items, chunking them together based on the return\n  value of the block. Consecutive elements which return the same block\n  value are chunked together.</p>\n</blockquote>\n\n<pre><code>l1 = [\"abc\", \"FFF\", \"EEE\"]\nl2 = [\"P\", \"P2F\", \"ccc\", \"DDD\"]\np l1.chunk{|s| s == s.upcase }.to_a\n# [[false, [\"abc\"]], [true, [\"FFF\", \"EEE\"]]]\np l2.chunk{|s| s == s.upcase }.to_a\n# [[true, [\"P\", \"P2F\"]], [false, [\"ccc\"]], [true, [\"DDD\"]]]\n</code></pre>\n\n<p>The fact that you need an index makes it a bit less readable, but here's an example. The desired index (if it exists) is the size of the first chunk:</p>\n\n<pre><code>p l1.chunk{|s| s == s.upcase }.first.last.size\n# 1\np l2.chunk{|s| s == s.upcase }.first.last.size\n# 2\n</code></pre>\n\n<p>If the case doesn't change at all, it returns the length of the whole array:</p>\n\n<pre><code>p %w(aaa bbb ccc ddd).chunk{|s| s == s.upcase }.first.last.size\n# 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1498033843, "last_edit_date": 1498033843, "creation_date": 1498017748, "answer_id": 44666689, "question_id": 44661511, "link": "https://stackoverflow.com/questions/44661511/how-do-i-find-the-first-string-of-differing-case-in-an-array/44666689#44666689", "title": "How do I find the first string of differing case in an array?", "body": "<p>I assume that each element (string) of the array contains at least one letter and only letters of the same case.</p>\n\n<pre><code>def first_case_change_index(arr)\n  s = arr.map { |s| s[/[[:alpha:]]/] }.join\n  (s[0] == s[0].upcase ? s.swapcase : s) =~ /[[:upper:]]/\nend\n\nfirst_case_change_index [\"abc\", \"FFF\", \"EEE\"] #=&gt; 1\nfirst_case_change_index [\"P\", \"P2F\", \"ccc\"]   #=&gt; 2\nfirst_case_change_index [\"P\", \"P2F\", \"DDD\"]   #=&gt; nil\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>arr = [\"P\", \"2PF\", \"ccc\"]\n\na = arr.map { |s| s[/[[:alpha:]]/] }\n  #=&gt; [\"P\", \"P\", \"c\"]\ns = a.join\n  #=&gt; \"PPc\"\ns[0] == s[0].upcase\n  #=&gt; \"P\" == \"P\"\n  #=&gt; true\nt = s.swapcase\n  #=&gt; \"ppC\"\nt =~ /[[:upper:]]/\n  #=&gt; 2\n</code></pre>\n\n<p>Here is another way.</p>\n\n<pre><code>def first_case_change_index(arr)\n  look_for_upcase = (arr[0] == arr[0].downcase)\n  arr.each_index.drop(1).find do |i|\n    (arr[i] == arr[i].upcase) == look_for_upcase\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7055375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 44661794, "answer_count": 4, "score": 2, "last_activity_date": 1498033843, "creation_date": 1497986886, "last_edit_date": 1498017019, "question_id": 44661511, "link": "https://stackoverflow.com/questions/44661511/how-do-i-find-the-first-string-of-differing-case-in-an-array", "title": "How do I find the first string of differing case in an array?", "body": "<p>I have an array of strings, and all contain at least one letter:</p>\n\n<pre><code>[\"abc\", \"FFF\", \"EEE\"]\n</code></pre>\n\n<p>How do I find the index of the first string that is of a different case than any previous string in the array? The function should give <code>1</code> for the above since:</p>\n\n<pre><code>FFF\".eql?(\"FFF\".upcase)\n</code></pre>\n\n<p>and that condition isn't true for any previous string in the array, whereas:</p>\n\n<pre><code>[\"P\", \"P2F\", \"ccc\", \"DDD\"]\n</code></pre>\n\n<p>should yield <code>2</code> since <code>\"ccc\"</code> is not capitalized and all its predecessors are.</p>\n\n<p>I know how to find the first string that is capitalized using</p>\n\n<pre><code>string_tokens.find_index { |w| w == w.upcase }\n</code></pre>\n\n<p>but I can't figure out how to adjust the above to account for differing case.</p>\n"}, {"tags": ["ruby", "class", "instance-variables", "class-method", "instance-methods"], "comments": [{"owner": {"reputation": 9297, "user_id": 764546, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OfNpk.jpg?s=128&g=1", "display_name": "MikDiet", "link": "https://stackoverflow.com/users/764546/mikdiet"}, "edited": false, "score": 1, "creation_date": 1497985223, "post_id": 44660977, "comment_id": 76307541, "body": "Please avoid asking multiple distinct questions at once."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1497985728, "post_id": 44661104, "comment_id": 76307828, "body": "Your first question is answered in the <a href=\"http://ruby-doc.org/core-2.4.1/doc/syntax/methods_rdoc.html\" rel=\"nofollow noreferrer\">Method Names section in the docs</a>."}, {"owner": {"reputation": 1090, "user_id": 7113209, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/10154091942466794/picture?type=large", "display_name": "hancho", "link": "https://stackoverflow.com/users/7113209/hancho"}, "edited": false, "score": 0, "creation_date": 1497985864, "post_id": 44661104, "comment_id": 76307909, "body": "Makes a lot of sense, thank you. For question one, how would you style those methods? I&#39;m not even sure what their purpose is in the entire group of classes."}], "tags": [], "owner": {"reputation": 4023, "user_id": 396964, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9d5d2fc7ebac788a7eca7acd89a96485?s=128&d=identicon&r=PG", "display_name": "chrismanderson", "link": "https://stackoverflow.com/users/396964/chrismanderson"}, "is_accepted": true, "score": 2, "last_activity_date": 1497985385, "creation_date": 1497985385, "answer_id": 44661104, "question_id": 44660977, "link": "https://stackoverflow.com/questions/44660977/questions-about-instance-methods-in-ruby/44661104#44661104", "title": "Questions about instance methods in ruby.", "body": "<ol>\n<li>Yes, that is a getter and setter for an array object on <code>Board</code>. (FWIW I think that it's poor Ruby style to do this, so I wouldn't use this in the future in your own code. I think that's why your IDE is having issues with this method as well.</li>\n<li><p>You can use <code>grid</code> without the @ because of the <code>attr_reader</code> declaration at the top of your class. This creates a read-only variable for the instance variable that is public on the class. It effectively creates a method called:</p>\n\n<pre><code>def grid\n  @grid\nend\n</code></pre>\n\n<p>You would not be able to do <code>grid = []</code> because <code>attr_reader</code> only creates a read only method. To create a read-write accessor, you would use <code>attr_accessor</code>. Keep in mind, using <code>attr_</code> methods make the variable in question public on the class, so if you wanted to keep something internal, you would not use them.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 8657696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlVQO.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/8657696/andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1509605306, "creation_date": 1509605306, "answer_id": 47069205, "question_id": 44660977, "link": "https://stackoverflow.com/questions/44660977/questions-about-instance-methods-in-ruby/47069205#47069205", "title": "Questions about instance methods in ruby.", "body": "<p>A bit late but I was also looking into this and found this on the web. Apparently, it is syntactic sugar for classes with grid-like instance variables.</p>\n\n<blockquote>\n  <p>The Syntactic Sugar</p>\n  \n  <p>These are all equivalent ways to get the bottom-left square:</p>\n\n<pre><code>board.grid[2][0]\nboard.[](2, 0)\nboard[2, 0] # syntactic sugar\n</code></pre>\n  \n  <p>The syntactic sugar allows us to call the Board#[] method with our\n  arguments inside of the square brackets themselves rather than in\n  parentheses following the square brackets.</p>\n  \n  <p>Similarly, the following are equivalent ways to set the top-right\n  square:</p>\n\n<pre><code>board.grid[0][2] = :x\nboard.[]=(0, 2, :x)\nboard[0, 2] = :x  # syntactic sugar\n</code></pre>\n  \n  <p>Naturally, if we bother to set up the special [] and []= methods,\n  we'll use the syntactic sugar way. :)</p>\n</blockquote>\n\n<p>More information can be found from this link:</p>\n\n<p><a href=\"https://github.com/emgreen33/Practice/blob/master/W2D4/bracket-methods.md\" rel=\"nofollow noreferrer\">https://github.com/emgreen33/Practice/blob/master/W2D4/bracket-methods.md</a></p>\n"}], "owner": {"reputation": 1090, "user_id": 7113209, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/10154091942466794/picture?type=large", "display_name": "hancho", "link": "https://stackoverflow.com/users/7113209/hancho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 44661104, "answer_count": 2, "score": 0, "last_activity_date": 1509605306, "creation_date": 1497984844, "question_id": 44660977, "link": "https://stackoverflow.com/questions/44660977/questions-about-instance-methods-in-ruby", "title": "Questions about instance methods in ruby.", "body": "<p>I have an assignment to build a tic-tac-toe game using ruby classes. </p>\n\n<p>I'm new to programming and self taught so far, but was accepted into a program and need to polish up on some concepts to be ahead of the game. </p>\n\n<p>I understand most concepts and got the majority of spec files to work for my game, but I did need to reference the solution code a few times to help solve the last bit of the problem. </p>\n\n<ol>\n<li><p>In creating the board class, two methods were created that were defined using empty arrays. I have never seen this before and wanted to know what was going on. When I went into my IDE and created a method with the name [](empty array) and two parameters, I'd get an error (syntax error, expecting end of input) trying to run it. It seems this must be something you can only do while setting up a class? </p>\n\n<p>I'm assuming these are getter and setter methods?</p>\n\n<pre><code>  def [](pos)\n    row, col = pos\n    grid[row][col]\n  end\n\n  def []=(pos, value)\n    row, col = pos\n    grid[row][col] = value\n  end\n</code></pre></li>\n<li><p>In the above code, grid is an instance variable of the board class. Why can you use an instance variable in a method without putting the \"@\" symbol in front of it - (@grid, instead of grid). This is a little confusing because with normal methods, if you define a variable outside of the method, the method doesn't recognize it. Why is it different inside of classes?</p>\n\n<pre><code>#example \n\nx = 6 \n\ndef add(b)\n  x + b\nend \n\n=&gt; will return an error - local variable x is undefined.\n</code></pre></li>\n</ol>\n\n<p><strong>Below is the full board class in case it'll make better sense understanding and answering the questions. Thank you!</strong></p>\n\n<pre><code>class Board\n  attr_reader :grid, :marks\n\n  def initialize(grid = [])\n    if grid.empty?\n      @grid = Array.new(3) { Array.new(3) }\n    else\n      @grid = grid\n    end\n    @marks = [:X, :O]\n  end\n\n  def place_mark(pos, mark)\n    grid[pos[0]][pos[1]] = mark\n  end\n\n  def [](pos)\n    row, col = pos\n    grid[row][col]\n  end\n\n  def []=(pos, value)\n    row, col = pos\n    grid[row][col] = value\n  end\n\n  def empty?(pos)\n    grid[pos[0]][pos[1]].nil? ? true : false\n  end\n\n  def winner\n    (grid + grid.transpose + diagnol).each do |win|\n      return :X if win == [:X,:X,:X]\n      return :O if win == [:O,:O,:O]\n    end\n    nil\n  end\n\n  def diagnol\n    diag1 = [[0, 0], [1, 1], [2, 2]]\n    diag2 = [[0, 2], [1, 1], [2, 0]]\n\n    [diag1, diag2].map do |diag|\n      diag.map {|row, col| grid[row][col]}\n    end\n  end\n\n  def over?\n    return true if grid.flatten.compact.size == 9 || winner\n    return false if grid.flatten.compact.size == 0 || winner.nil?\n  end\n\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "nested-forms", "strong-parameters"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497984219, "post_id": 44660753, "comment_id": 76306941, "body": "And what&#39;s the error, exactly?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497984270, "post_id": 44660753, "comment_id": 76306973, "body": "Reformat the parameters snippet to multiple lines. It&#39;s unreadable."}, {"owner": {"reputation": 25, "user_id": 6857250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9bc7aa125205cddc30612c4a1b012?s=128&d=identicon&r=PG&f=1", "display_name": "paulkiio", "link": "https://stackoverflow.com/users/6857250/paulkiio"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1497984713, "post_id": 44660753, "comment_id": 76307251, "body": "@SergioTulentsev according to the logger.info, it permits the name, label and proxy but not the contact_attributes. Or at least thats how I understood that?"}], "answers": [{"tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": false, "score": 1, "last_activity_date": 1497985418, "last_edit_date": 1497985418, "creation_date": 1497985076, "answer_id": 44661029, "question_id": 44660753, "link": "https://stackoverflow.com/questions/44660753/unpermited-params-rails-5-1-1/44661029#44661029", "title": "Unpermited params rails 5.1.1", "body": "<p>your contact_attributes is not nested inside of organization, but in your organization_params you are expecting contact_attributes to be nested. Fix your view, so contact_attributes is nested within organization.</p>\n\n<p>Make the below changes in the view to the contract_attributes </p>\n\n<pre><code>  f.fields_for :contract do |ff|\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1497985131, "creation_date": 1497985131, "answer_id": 44661045, "question_id": 44660753, "link": "https://stackoverflow.com/questions/44660753/unpermited-params-rails-5-1-1/44661045#44661045", "title": "Unpermited params rails 5.1.1", "body": "<p>If you look at the shape of your params, you'll see that <code>organization</code> and <code>contact_attributes</code> are siblings, not parent-nested. This has something to do with your <code>fields_for</code>. Off the top of my head, you have to do either this:</p>\n\n<pre><code>= fields_for 'organization[contact_attributes]' do |ff|\n</code></pre>\n\n<p>or some form of this:</p>\n\n<pre><code>= fields_for organization.contact do |ff|\n</code></pre>\n\n<p>Although in this case, you obviously have to make sure it's not nil.</p>\n\n<p>Or check @Ramon's answer, I think he nailed it.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 6857250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9bc7aa125205cddc30612c4a1b012?s=128&d=identicon&r=PG&f=1", "display_name": "paulkiio", "link": "https://stackoverflow.com/users/6857250/paulkiio"}, "edited": false, "score": 0, "creation_date": 1497985572, "post_id": 44661079, "comment_id": 76307734, "body": "Doh! Thanks so much!"}], "tags": [], "owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "is_accepted": true, "score": 3, "last_activity_date": 1497985281, "creation_date": 1497985281, "answer_id": 44661079, "question_id": 44660753, "link": "https://stackoverflow.com/questions/44660753/unpermited-params-rails-5-1-1/44661079#44661079", "title": "Unpermited params rails 5.1.1", "body": "<p>Put an <code>f.</code> before your fields for</p>\n\n<pre><code> = f.fields_for :contact_attributes do |ff|\n      .field.form-group\n        = ff.label :Contact_Name, for: :contact_name\n        = ff.text_field :name, class: 'form-control'\n        = ff.label :Email, for: :contact_email\n        = ff.text_field :name, class: 'form-control'\n        = ff.label :Contact_Phone, for: :contact_phone\n        = ff.text_field :name, class: 'form-control'\n        .actions = f.submit class: 'btn btn-outline-primary'\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6857250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9bc7aa125205cddc30612c4a1b012?s=128&d=identicon&r=PG&f=1", "display_name": "paulkiio", "link": "https://stackoverflow.com/users/6857250/paulkiio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 44661079, "answer_count": 3, "score": 0, "last_activity_date": 1497985418, "creation_date": 1497984088, "last_edit_date": 1497984571, "question_id": 44660753, "link": "https://stackoverflow.com/questions/44660753/unpermited-params-rails-5-1-1", "title": "Unpermited params rails 5.1.1", "body": "<p>Rails 5.1.1 Ruby 2.4.1</p>\n\n<p>When a new organization is created, The contact information should save to the contact table however that is not the case. I am still relatively new to rails and have looked through other posts with strong params with no luck. I think I have included all the essential pieces to get this working if not let me know and thank you! </p>\n\n<p><strong>Console output from logger.info in the create action</strong></p>\n\n<pre><code>13:55:03 rails.1   |   User Load (0.3ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n13:55:03 rails.1   |   Role Load (0.5ms)  SELECT `roles`.* FROM `roles` INNER JOIN `users_roles` ON `roles`.`id` = `users_roles`.`role_id` WHERE `users_roles`.`user_id` = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))\n13:55:03 rails.1   | &lt;ActionController::Parameters {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"LIdSKBh7x9Dqs1A6gKb0Gn7EecArG6aflOeC4OARShLwfySH+HQ5joN3FUCe6qmJBGn2K/QRize67qhrxczK+w==\", \"organization\"=&gt;&lt;ActionController::Parameters {\"name\"=&gt;\"Apple\", \"label\"=&gt;\"apl\", \"proxy_hostname\"=&gt;\"www.apple.com\"} permitted: false&gt;, \"contact_attributes\"=&gt;{\"name\"=&gt;\"555-555-5555\"}, \"commit\"=&gt;\"Create Organization\", \"controller\"=&gt;\"organizations\", \"action\"=&gt;\"create\"} permitted: false&gt;\n13:55:03 rails.1   | &lt;ActionController::Parameters {\"name\"=&gt;\"Apple\", \"label\"=&gt;\"apl\", \"proxy_hostname\"=&gt;\"www.apple.com\"} permitted: true&gt;\n13:55:03 rails.1   |    (0.2ms)  BEGIN\n13:55:03 rails.1   |   Organization Exists (0.4ms)  SELECT  1 AS one FROM `organizations` WHERE `organizations`.`label` = BINARY 'apl' LIMIT 1\n13:55:03 rails.1   |   SQL (0.4ms)  INSERT INTO `organizations` (`name`, `label`, `created_at`, `updated_at`, `proxy_hostname`) VALUES ('Apple', 'apl', '2017-06-20 17:55:03', '2017-06-20 17:55:03', 'www.apple.com')\n13:55:03 rails.1   |    (0.5ms)  COMMIT\n13:55:03 rails.1   | method=POST path=/organizations format=html controller=OrganizationsController action=create status=302 duration=10.23 view=0.00 db=2.12 location=http://localhost:5000/organizations/apl\n13:55:03 rails.1   |   User Load (0.2ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n13:55:03 rails.1   |   Organization Load (0.2ms)  SELECT  `organizations`.* FROM `organizations` WHERE `organizations`.`label` = 'apl' LIMIT 1\n13:55:03 rails.1   |    (0.5ms)  SELECT COUNT(*) FROM `roles` INNER JOIN `users_roles` ON `roles`.`id` = `users_roles`.`role_id` WHERE `users_roles`.`user_id` = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)) OR ((roles.name = 'analyst') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))\n13:55:03 rails.1   |   User Load (0.3ms)  SELECT `users`.* FROM `users` INNER JOIN `organization_users` ON `users`.`id` = `organization_users`.`user_id` WHERE `organization_users`.`organization_id` = 25\n13:55:03 rails.1   |   Sensor Load (0.2ms)  SELECT `sensors`.* FROM `sensors` WHERE `sensors`.`organization_id` = '25'\n13:55:03 rails.1   |   CACHE  (0.0ms)  SELECT COUNT(*) FROM `roles` INNER JOIN `users_roles` ON `roles`.`id` = `users_roles`.`role_id` WHERE `users_roles`.`user_id` = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)) OR ((roles.name = 'analyst') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))  [[\"user_id\", 1]]\n13:55:03 rails.1   |   Role Load (0.5ms)  SELECT `roles`.* FROM `roles` INNER JOIN `users_roles` ON `roles`.`id` = `users_roles`.`role_id` WHERE `users_roles`.`user_id` = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))\n13:55:03 rails.1   |   CACHE Role Load (0.0ms)  SELECT `roles`.* FROM `roles` INNER JOIN `users_roles` ON `roles`.`id` = `users_roles`.`role_id` WHERE `users_roles`.`user_id` = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))  [[\"user_id\", 1]]\n</code></pre>\n\n<p><strong>Models</strong></p>\n\n<pre><code> class Organization &lt; ApplicationRecord\n   belongs_to :contact, optional: true\n\n   accepts_nested_attributes_for :contact\n end\n\n class Contact &lt; ApplicationRecord\n   has_one :organization\n end\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>class OrganizationsController &lt; ApplicationController\n  before_action :set_organization, only: [:show, :edit, :update, \n  :destroy]\n\n   after_action :verify_authorized, except: :index\n   after_action :verify_policy_scoped, only: :index\n\n  def index\n    @organizations = policy_scope(Organization)\n  end\n\n  def show\n    authorize @organization\n  end\n\n  def new\n    @organization = Organization.new(contact: Contact.new)\n    authorize @organization, :create?\n  end\n\n  def edit\n    authorize @organization, :update?\n  end\n\n  def create\n    @organization = Organization.new(organization_params)\n    authorize @organization\n\n    logger.info(params.inspect)\n    logger.info(organization_params.inspect)\n\n    respond_to do |format|\n      if @organization.save\n        format.html { redirect_to @organization, notice: 'Organization \n        was \n        successfully created.' }\n        format.json { render :show, status: :created, location: \n        @organization }\n      else\n        format.html { render :new }\n        format.json { render json: @organization.errors, status: \n        :unprocessable_entity }\n      end\n    end\n  end\n\n  def update\n    authorize @organization\n    respond_to do |format|\n      if @organization.update(organization_params)\n        format.html { redirect_to @organization, notice: 'Organization \n        was \n        successfully updated.' }\n        format.json { render :show, status: :ok, location: \n        @organization }\n      else\n        format.html { render :edit }\n        format.json { render json: @organization.errors, status: \n        :unprocessable_entity }\n      end\n    end\n  end\n\n  def destroy\n    authorize @organization\n    @organization.destroy\n    respond_to do |format|\n      format.html { redirect_to organizations_url, notice: \n      'Organization \n      was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n\n  def set_organization\n    @organization = Organization.find_by_label(params[:id])\n  end\n\n\n  def organization_params\n    params.require(:organization).permit(:name, :label, \n    :proxy_hostname, \n    :contact_id, contact_attributes: [:name, :email, :phone])\n  end\nend\n</code></pre>\n\n<p><strong>Form</strong></p>\n\n<pre><code>= form_for @organization do |f|\n  - if @organization.errors.any?\n    #error_explanation\n    h2 = \"#{pluralize(@organization.errors.count, \"error\")} prohibited \n    this organization from being saved:\"\n    ul\n    - @organization.errors.full_messages.each do |message|\n      li = message\n  .field.form-group\n    = f.label :name, for: :organization_name\n    = f.text_field :name, class: 'form-control', autofocus: true\n  .field.form-group\n    = f.label :label, for: :organization_label\n    = f.text_field :label, class: 'form-control'\n  .field.form-group\n    = f.label :proxy_hostname, for: :organization_proxy_hostname\n    = f.text_field :proxy_hostname, class: 'form-control'\n\n    = fields_for :contact_attributes do |ff|\n      .field.form-group\n        = ff.label :Contact_Name, for: :contact_name\n        = ff.text_field :name, class: 'form-control'\n        = ff.label :Email, for: :contact_email\n        = ff.text_field :name, class: 'form-control'\n        = ff.label :Contact_Phone, for: :contact_phone\n        = ff.text_field :name, class: 'form-control'\n        .actions = f.submit class: 'btn btn-outline-primary'\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 39660, "user_id": 3880585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8pfp3.png?s=128&g=1", "display_name": "gaetanoM", "link": "https://stackoverflow.com/users/3880585/gaetanom"}, "edited": false, "score": 0, "creation_date": 1497979816, "post_id": 44659310, "comment_id": 76304234, "body": "try gsub(&quot;&#39;&quot;, &quot;\\\\\\\\&#39;&quot;)"}, {"owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "reply_to_user": {"reputation": 39660, "user_id": 3880585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8pfp3.png?s=128&g=1", "display_name": "gaetanoM", "link": "https://stackoverflow.com/users/3880585/gaetanom"}, "edited": false, "score": 0, "creation_date": 1497979886, "post_id": 44659310, "comment_id": 76304269, "body": "Tried it already, inside the JSON he consider the apostrophe as the end of the JSON file not as a part of the string."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497980003, "post_id": 44659310, "comment_id": 76304329, "body": "What&#39;s the value for <code>@product</code>?"}, {"owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497980092, "post_id": 44659310, "comment_id": 76304381, "body": "is to long to place here. will edit the post with it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1497980521, "post_id": 44659310, "comment_id": 76304646, "body": "There should be no need to stringify and then deserialize it. Just do <code>var json_test  = &lt;%= @option_change %&gt;);</code> to assign it to the JSON representation directly. <code>html_safe</code> may cause problems, too, as this is JavaScript, not HTML."}, {"owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497980742, "post_id": 44659310, "comment_id": 76304778, "body": "It still brake the JSON at the apostrophe on Test&#39;WithError. <code>[{&quot;option&quot;:1,&quot;properties&quot;:[{&quot;sequence&quot;:null,&quot;option_value&quot;:{&zwnj;&#8203;&quot;id&quot;:3,&quot;value&quot;:&quot;Test&zwnj;&#8203;&#39;WithError&quot;,&quot;image_u&zwnj;&#8203;id&quot;:null,&quot;image_name&zwnj;&#8203;&quot;:null,&quot;description&quot;&zwnj;&#8203;:&quot;&quot;},&quot;product_sku_id&zwnj;&#8203;&quot;:82,&quot;available_stoc&zwnj;&#8203;k&quot;:true}],&quot;next_opti&zwnj;&#8203;on&quot;:null}]</code>"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497980784, "post_id": 44659310, "comment_id": 76304806, "body": "Try <code>OptionChange.new(@product).as_json</code>"}, {"owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497980881, "post_id": 44659310, "comment_id": 76304876, "body": "When i do without the <code>html_safe</code> it send every special character as hexadecimal. <code>[{&amp;quot;option&amp;quot;:1,&amp;quot;properties&amp;quot;:[{&amp;quot;sequen&zwnj;&#8203;ce&amp;quot;:null,&amp;quot;&zwnj;&#8203;option_value&amp;quot;:{&zwnj;&#8203;&amp;quot;id&amp;quot;:3,&amp;qu&zwnj;&#8203;ot;value&amp;quot;:&amp;quot&zwnj;&#8203;;Teste&amp;#x27;ComErro&amp;&zwnj;&#8203;quot;,&amp;quot;image_ui&zwnj;&#8203;d&amp;quot;:null,&amp;quot;i&zwnj;&#8203;mage_name&amp;quot;:null&zwnj;&#8203;,&amp;quot;description&amp;q&zwnj;&#8203;uot;:&amp;quot;&amp;quot;},&amp;&zwnj;&#8203;quot;product_sku_id&amp;&zwnj;&#8203;quot;:82,&amp;quot;avail&zwnj;&#8203;able_stock&amp;quot;:tru&zwnj;&#8203;e}],&amp;quot;next_optio&zwnj;&#8203;n&amp;quot;:null}]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497981561, "post_id": 44659925, "comment_id": 76305289, "body": "I understood about the single quote problem and followed your instructions, anyway it broke. That was the result anyway: <code>var json_test = $.parseJSON([{&quot;option&quot;:1,&quot;properties&quot;:[{&quot;sequence&quot;:null,&quot;opt&zwnj;&#8203;ion_value&quot;:{&quot;id&quot;:3,&quot;&zwnj;&#8203;value&quot;:&quot;Test&#39;WithErr&zwnj;&#8203;or&quot;,&quot;image_uid&quot;:null&zwnj;&#8203;,&quot;image_name&quot;:null,&quot;&zwnj;&#8203;description&quot;:&quot;&quot;},&quot;pr&zwnj;&#8203;oduct_sku_id&quot;:82,&quot;av&zwnj;&#8203;ailable_stock&quot;:true}&zwnj;&#8203;],&quot;next_option&quot;:null&zwnj;&#8203;}]);</code> Thanks for the effort!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497984320, "post_id": 44659925, "comment_id": 76307002, "body": "@FelipePin did you remove the surrounding quotes as mentioned? I cannot reproduce the issue <a href=\"https://repl.it/IuLs/1\" rel=\"nofollow noreferrer\">Repl.it Example</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497984868, "post_id": 44659925, "comment_id": 76307346, "body": "@FelipePin however it is very reproducible with the outer quotes <a href=\"https://repl.it/IuLs/2\" rel=\"nofollow noreferrer\">Repl.it</a>"}, {"owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "edited": false, "score": 0, "creation_date": 1497985308, "post_id": 44659925, "comment_id": 76307594, "body": "Yes, i removed the quotes.  Found an strange fact, when saving the information &quot;Test&#39;WithError&quot; i tried using the ASCII code for the apostrophe (&amp;#39;) like this =&gt; &quot;Test&amp;#39;WithError&quot;... without changing anything it worked perfectly."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1497985578, "post_id": 44659925, "comment_id": 76307736, "body": "So <code>@option_change</code> is a Hash in Ruby? If so, then you should be able to skip the <code>$.parseJSON</code> stuff and go with something closer to <code>var json_test = &lt;%= @option_change.to_json %&gt;;</code>. Or wrap it in double quotes and parse it with <code>$.parseJSON</code>."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 1, "last_activity_date": 1497981152, "creation_date": 1497981152, "answer_id": 44659925, "question_id": 44659310, "link": "https://stackoverflow.com/questions/44659310/escape-and-apostrophe-set-on-a-json-passed-thru-rails-to-js/44659925#44659925", "title": "Escape and Apostrophe set on a JSON passed thru rails to JS", "body": "<p>Single quotes have no special meaning in JSON so <code>to_json</code> will not escape them. For example:</p>\n\n<pre><code>&gt; puts \"'\".to_json\n\"'\"\n</code></pre>\n\n<p>Also note that <code>to_json</code> includes the outer quotes in a string so things like this:</p>\n\n<pre><code>'&lt;%= some_string.to_json %&gt;'\n</code></pre>\n\n<p>will wrap the double quoted JSON string in single quotes and you'll end up with confusion like:</p>\n\n<pre><code>'\"{\\\"k\\\":\\\"v\\\"}\"'\n'\"{\\\"k\\\":\\\"'\\\"}\"'\n// --------^ broken string due to an un-escaped inner quote\n</code></pre>\n\n<p>when you really want:</p>\n\n<pre><code>\"{\\\"k\\\":\\\"v\\\"}\"\n\"{\\\"k\\\":\\\"'\\\"}\"\n// -------^ Not broken as there are no outer single quotes to fight with\n</code></pre>\n\n<p>Consider these results in JavaScript:</p>\n\n<pre><code>&gt; JSON.parse(\"{\\\"k\\\":\\\"v\\\"}\")\n&lt; {k: \"v\"}\n\n&gt; JSON.parse('\"{\\\"k\\\":\\\"v\\\"}\"')\n&lt; SyntaxError: JSON Parse error: Unable to parse JSON string\n</code></pre>\n\n<p>The first one is what you're presumably after.</p>\n\n<p>I think you just want to drop the extra quotes:</p>\n\n<pre><code>var json_test = $.parseJSON(&lt;%= @option_change %&gt;);\n</code></pre>\n\n<p>Or better (IMO) push the encoding into the view so that your Ruby says:</p>\n\n<pre><code>@option_change = OptionChange.new(@product)\n</code></pre>\n\n<p>and your view says:</p>\n\n<pre><code>var json_test = $.parseJSON(&lt;%= @option_change.to_json.html_safe %&gt;);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var json_test = $.parseJSON(&lt;%= @option_change.to_json %&gt;);\n</code></pre>\n\n<p>depending on context.</p>\n"}], "owner": {"reputation": 15, "user_id": 8189881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6611facb4b11fbb46010a3f9d7a41f?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Pin", "link": "https://stackoverflow.com/users/8189881/felipe-pin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497981152, "creation_date": 1497978941, "last_edit_date": 1497980241, "question_id": 44659310, "link": "https://stackoverflow.com/questions/44659310/escape-and-apostrophe-set-on-a-json-passed-thru-rails-to-js", "title": "Escape and Apostrophe set on a JSON passed thru rails to JS", "body": "<p>I'm having some troubles to escape and apostrophe set on a JSON array.\nI Have this:</p>\n\n<pre><code>@option_change = OptionChange.new(@product).to_json.html_safe\n</code></pre>\n\n<p>On the JS file i use it on this way:</p>\n\n<pre><code>var json_test = $.parseJSON('&lt;%= @option_change %&gt;');\n</code></pre>\n\n<p>When this js is executed this is the return:(this is the content of my @option_change)</p>\n\n<pre><code>'\"[{\"option\":1,\"properties\":[{\"sequence\":null,\"option_value\":{\"id\":3,\"value\":\"Test'WithError\",\"image_uid\":null,\"image_name\":null,\"description\":\"\"},\"product_sku_id\":82,\"available_stock\":true}],\"next_option\":null}]\"'\n</code></pre>\n\n<p>I got an error because of the apostrophe set on Test'WithError, i tried using gsub.(\"'\", \"\\\\'\") like suggested on another posts, but i think that my issue need a much more specific way to be solved.</p>\n\n<p>@product:<code>#&lt;Product id: 48, name: \"[ADENA][TESTE] 365b4ea2f838\", resume: \"365b4ea2f838\", description: \"&lt;p&gt;\\r\\n\\t365b4ea2f838&lt;/p&gt;\\r\\n\", created_at: \"2017-06-14 21:29:05\", updated_at: \"2017-06-20 13:10:58\", category_id: 1, highlight: 0, highlight_image: nil, category_highlight: false, meta_description_deprecate: nil, meta_keywords_deprecate: nil, seo_title_deprecate: nil, custom_title_deprecate: nil, brand_id: nil, profile_property_id: nil, video_url: \"\", creditcard_split_config_id: nil, code: nil, product_type_id: 1, unpackable: false, ensemble: false, quantity_uses_decimal: false, minimum_to_buy: #&lt;BigDecimal:7f93ee2f7f90,'0.1E1',9(18)&gt;, delta: true, availability: true, visits: 73, additions: 0, removals: 0, custom_delivery_time_deprecated: nil, sales: nil, google_shopping_identifier_exists: true, private: false, keywords: \"\", extends_delivery_type: \"minute\", extends_delivery_time: nil&gt;</code></p>\n\n<p>You guys have any idea how to?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1497975272, "post_id": 44658133, "comment_id": 76301591, "body": "Don&#39;t force use of a ternary. If you have to jump through hoops to use them, then you&#39;re probably forcing a poor use-case. And you&#39;ll need 2 ternarys to replicate that if-else structure."}, {"owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1497975382, "post_id": 44658133, "comment_id": 76301660, "body": "@Carcigenicate is right, I would not replace that if else statement with a ternary..."}, {"owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "edited": false, "score": 0, "creation_date": 1497975543, "post_id": 44658133, "comment_id": 76301767, "body": "Ternary statement only replaces if else conditions, not if elsif. If you can&#39;t guarantee that your b.value is only &#39;N&#39; or &#39;Y&#39;, you can&#39;t use ternary."}], "answers": [{"tags": [], "owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": -1, "last_activity_date": 1497975490, "creation_date": 1497975490, "answer_id": 44658256, "question_id": 44658133, "link": "https://stackoverflow.com/questions/44658133/ternary-operator-based-on-if-else/44658256#44658256", "title": "ternary operator based on if else", "body": "<p>I would not insist on the ternary operator but extract the common <code>a.present?</code> test in an outer <code>if</code> and then write the rest of the code using <a href=\"http://ruby-doc.org/core-2.4.1/doc/syntax/control_expressions_rdoc.html#label-Modifier+if+and+unless\" rel=\"nofollow noreferrer\"><code>if</code> modifiers</a>:</p>\n\n<pre><code>if a.present? \n    b = test if b.value == 'N'\n    b = guest if b.value == 'Y'\nend\n</code></pre>\n\n<p>To me, it seems much easier to read this way.</p>\n"}, {"comments": [{"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497975957, "post_id": 44658309, "comment_id": 76302056, "body": "You could take it further and extract <code>case</code> to a method."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497975994, "post_id": 44658309, "comment_id": 76302082, "body": "This is on the right track, but in this form it&#39;s super cramped. Tacking a trailing <code>if</code> on a <code>case</code> is technically valid, but also super confusing."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497976065, "post_id": 44658309, "comment_id": 76302132, "body": "<i>Tisk</i> <i>Tisk</i> violates ruby style rules <a href=\"https://github.com/bbatsov/ruby-style-guide#no-multiline-if-modifiers\" rel=\"nofollow noreferrer\">github.com/bbatsov/ruby-style-guide#no-multiline-if-modifier&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1497976185, "post_id": 44658309, "comment_id": 76302208, "body": "@engineersmnky I am an active rubocop-hater, btw."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1497976219, "post_id": 44658309, "comment_id": 76302224, "body": "While Rubocop can be overly strict, it&#39;s code like this that the Rubocop people put into their test cases. The &quot;Principle of Least Surprise&quot; is something you should at least try to adhere to."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1497976221, "post_id": 44658309, "comment_id": 76302226, "body": "Hahaha I am an active readability lover. Imagine if this was less trivial and I told you all the wonderful things I was going to do for you and how I was going to make your life fantastic and great and you were super excited about how amazing everything could be. Then at the very end I mumbled <i>&quot;if you sell me your soul&quot;</i> (that&#39;s kind of where this is headed). Where as if I started with that you probably would have cut me off right there."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497976499, "post_id": 44658309, "comment_id": 76302411, "body": "@engineersmnky this is compact and readable, even more, it forms almost proper rectangle out of the code, which is indeed a valuable bonus :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497976563, "post_id": 44658309, "comment_id": 76302447, "body": "@engineersmnky to tell the truth, this postfix condition is the most realistic statement I ever met in Ruby. \u2764 Mephistopheles."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1497975687, "creation_date": 1497975687, "answer_id": 44658309, "question_id": 44658133, "link": "https://stackoverflow.com/questions/44658133/ternary-operator-based-on-if-else/44658309#44658309", "title": "ternary operator based on if else", "body": "<pre><code>b = case b.value\n    when 'N' then test\n    when 'Y' then guest\n    end if a.present?\n</code></pre>\n\n<p>This is the only DRY answer here so far.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1497976391, "post_id": 44658484, "comment_id": 76302346, "body": "This is indeed the way to go. Maybe I would use postfix <code>if</code>, within this <code>EQUIVALENT</code> constant it won\u2019t be looking cramped."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1497976532, "post_id": 44658484, "comment_id": 76302425, "body": "You just love postfix <code>if</code> too much. I avoid using them on anything longer than a single keyword, like <code>next if ...</code> or <code>return unless ...</code> since anything more involved than that tends to be less immediately obvious."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1497976595, "post_id": 44658484, "comment_id": 76302461, "body": "You can always get a bit adventurous and do <code>b = EQUIVALENT[a.present? &amp;&amp; b.value] || b</code> if you really want a one-liner."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1497976696, "post_id": 44658484, "comment_id": 76302510, "body": "No, to produce oneliners should never be a goal, that is evident even to me."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1497976817, "post_id": 44658484, "comment_id": 76302587, "body": "That representation avoids the trailing <code>if</code>, there&#39;s no &quot;surprises&quot;, because it&#39;s quite clear the lookup depends on two factors both present in side the <code>[...]</code> call. Moving one condition to the end is <i>sneaky</i>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1497976906, "post_id": 44658484, "comment_id": 76302631, "body": "lets make it more confusing <code>a.present? &amp;&amp; b =  EQUIVALENT[b.value] || b</code>. No <code>if</code>, one liner (horrible code practice) <b>Seems Perfect</b>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497976967, "post_id": 44658484, "comment_id": 76302665, "body": "@engineersmnky I&#39;m sure there&#39;s a more optimal expression of this when the greater context in which this code operates in is taken into account. Names like <code>a</code> and <code>b</code> are pretty opaque. Just as I try to avoid trailing <code>if</code>s, &quot;surprise&quot; assignment is also a good thing to side-step."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497977123, "post_id": 44658484, "comment_id": 76302778, "body": "@tadman I apologize if the extremely facetious nature of my comment was unclear."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497977259, "post_id": 44658484, "comment_id": 76302873, "body": "@engineersmnky We&#39;ve all got to clear those snark buffers out before there&#39;s an overflow. I totally understand."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1497994289, "post_id": 44658484, "comment_id": 76312305, "body": "@tadman: It&#39;s not really a one-liner if you need to define <code>EQUIVALENT</code> before. Also, your <code>b = .... || b</code> code isn&#39;t equivalent to the OP&#39;s code because it always sets <code>b</code> even if <code>a</code> isn&#39;t present."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1498090550, "post_id": 44658484, "comment_id": 76360213, "body": "@EricDuminil It just sets <code>b</code> back to <code>b</code>, so it&#39;s a no-op that way."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1498115108, "post_id": 44658484, "comment_id": 76368004, "body": "@tadman: Just wondering, is there any case for which <code>b = b</code> could be dangerous or at least do something unexpected?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1498159744, "post_id": 44658484, "comment_id": 76398576, "body": "@EricDuminil The only case I can think of is where <code>b=</code> is a method in that context and it does something with the input. If it&#39;s a variable I don&#39;t think it&#39;s possible to do anything at all other than assign it."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1497976180, "creation_date": 1497976180, "answer_id": 44658484, "question_id": 44658133, "link": "https://stackoverflow.com/questions/44658133/ternary-operator-based-on-if-else/44658484#44658484", "title": "ternary operator based on if else", "body": "<p>For something like this you might want to use a simple look-up table to eliminate some of the logic:</p>\n\n<pre><code>EQUIVALENT = {\n  'Y' =&gt; 'guest',\n  'N' =&gt; 'test'\n}\n\nif (a.present?)\n  b = EQUIVALENT[b.value] || b\nend\n</code></pre>\n\n<p>The <code>|| b</code> part may not be necessary if non-mapped <code>b</code> values are ignored.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 1, "last_activity_date": 1497994360, "last_edit_date": 1497994360, "creation_date": 1497994050, "answer_id": 44663294, "question_id": 44658133, "link": "https://stackoverflow.com/questions/44658133/ternary-operator-based-on-if-else/44663294#44663294", "title": "ternary operator based on if else", "body": "<p>You can use a ternary operator. It doesn't mean you should do it, though:</p>\n\n<pre><code>a.present? &amp;&amp; (b.value == 'N' ? b = 'test' : b.value == 'Y' &amp;&amp; b = 'guest')\n</code></pre>\n\n<p>Here's a small test:</p>\n\n<pre><code>class Object\n  def present?\n    true\n  end\nend\n\nclass NilClass\n  def present?\n    false\n  end\nend\n\na = true\n\nclass B\n  attr_accessor :value\nend\n\nb = B.new\nb.value = 'Y'\n\na.present? &amp;&amp; (b.value == 'N' ? b = 'test' : b.value == 'Y' &amp;&amp; b = 'guest')\n\np b\n# \"guest\"\n</code></pre>\n"}], "owner": {"reputation": 1695, "user_id": 427354, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8b1da0d743d87175b7cc0ef93c8fcad7?s=128&d=identicon&r=PG", "display_name": "User7354632781", "link": "https://stackoverflow.com/users/427354/user7354632781"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 44658484, "answer_count": 4, "score": 4, "last_activity_date": 1497994360, "creation_date": 1497975169, "question_id": 44658133, "link": "https://stackoverflow.com/questions/44658133/ternary-operator-based-on-if-else", "title": "ternary operator based on if else", "body": "<p>If i have following if else statement</p>\n\n<pre><code>if a.present? &amp;&amp; b.value == 'N'\n b = test\nelsif a.present? &amp;&amp; b.value == 'Y'\n b = guest\nend\n</code></pre>\n\n<p>I can write ternary operation for this</p>\n\n<pre><code>b = (a.present? &amp;&amp; b.value == 'N') ? \"test\" : \"guest\"\n</code></pre>\n\n<p>but in this ternary oprator i am not looking for condition b.value == 'Y' and it could be something else 'd' or 'e'.</p>\n\n<p>How do i update ternary operator so it verifies both conditions in if and elsif?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-engines", "ruby-on-rails-4.2"], "answers": [{"tags": [], "owner": {"reputation": 711, "user_id": 1516373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ot7S1.jpg?s=128&g=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/1516373/david-s"}, "is_accepted": false, "score": 5, "last_activity_date": 1497990009, "creation_date": 1497990009, "answer_id": 44662306, "question_id": 44658070, "link": "https://stackoverflow.com/questions/44658070/models-are-not-being-loaded-accessed-in-engine-tasks-from-engine/44662306#44662306", "title": "Models are not being loaded/accessed in engine tasks from engine", "body": "<p>If you require the Rails application to be mounted, try to add the <code>environment</code> dependency to your task. As an example:</p>\n\n<pre><code>namespace :foo do\n  desc 'Super awesome task'\n  task super_awesome: [:environment] do\n    # etc\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 334, "user_id": 5715234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1077884162244394/picture?type=large", "display_name": "Vitor Oliveira", "link": "https://stackoverflow.com/users/5715234/vitor-oliveira"}, "is_accepted": false, "score": 0, "last_activity_date": 1560822948, "creation_date": 1560822948, "answer_id": 56640821, "question_id": 44658070, "link": "https://stackoverflow.com/questions/44658070/models-are-not-being-loaded-accessed-in-engine-tasks-from-engine/56640821#56640821", "title": "Models are not being loaded/accessed in engine tasks from engine", "body": "<p>Including <code>=&gt; :environment</code> will tell Rake to load full the application environment, giving the relevant task access to things like classes, helpers, models, etc. Without the <code>:environment</code>, you won't have access to any of those extras.</p>\n"}], "owner": {"reputation": 3842, "user_id": 879921, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8efb046fc10e0ce8f1106074a5545fa6?s=128&d=identicon&r=PG&f=1", "display_name": "ducktyped", "link": "https://stackoverflow.com/users/879921/ducktyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1560822948, "creation_date": 1497974943, "question_id": 44658070, "link": "https://stackoverflow.com/questions/44658070/models-are-not-being-loaded-accessed-in-engine-tasks-from-engine", "title": "Models are not being loaded/accessed in engine tasks from engine", "body": "<p>Accessing engine models in engine rake tasks are throwing <code>NameError: uninitialized constant</code>. Models are namespaced and correctly defined. Can be accessed from rails console of mounted application</p>\n\n<p>But not from engine rake tasks</p>\n"}, {"tags": ["ruby", "authentication", "get"], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 5625918, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xz-zUEjzeKo/AAAAAAAAAAI/AAAAAAAABWM/gPuYZ7VfDYk/photo.jpg?sz=128", "display_name": "gbrandao", "link": "https://stackoverflow.com/users/5625918/gbrandao"}, "is_accepted": true, "score": 2, "last_activity_date": 1497983283, "last_edit_date": 1497983283, "creation_date": 1497982442, "answer_id": 44660287, "question_id": 44657978, "link": "https://stackoverflow.com/questions/44657978/get-with-basic-auth-ruby-doesnt-work/44660287#44660287", "title": "Get with Basic Auth Ruby doesn&#39;t work", "body": "<p>In the case, you can't pass form data to GET method.Look at example bellow, I wrote a piece of code based on examples given in the Net::HTTP docs and tested it on my local - it works. Here's what I have:</p>\n\n<pre><code>nfe_key = '41170608187168000160550010000001561000000053'\nparams = {'grupo' =&gt; 'edoc','cnpj' =&gt; '08187168000160', 'ChaveNota' =&gt; nfe_key, 'Url' =&gt; '1'}\n\nuri = URI.parse('https://managersaashom.tecnospeed.com.br:7071/ManagerAPIWeb/nfe/imprime')\n\n\n# Add params to URI\nuri.query = URI.encode_www_form( params )\n\nNet::HTTP.start(uri.host, uri.port,\n  :use_ssl =&gt; uri.scheme == 'https',\n  :verify_mode =&gt; OpenSSL::SSL::VERIFY_NONE) do |http|\n\n  request = Net::HTTP::Get.new uri.request_uri\n  request.basic_auth 'admin', '123mudar'\n\n  response = http.request request # Net::HTTPResponse object\n\n  puts response\n  puts response.body\n end\n</code></pre>\n"}], "owner": {"reputation": 659, "user_id": 6849858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PEH2.jpg?s=128&g=1", "display_name": "V&#237;tor Mar&#231;al", "link": "https://stackoverflow.com/users/6849858/v%c3%adtor-mar%c3%a7al"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 44660287, "answer_count": 1, "score": 1, "last_activity_date": 1497983283, "creation_date": 1497974701, "question_id": 44657978, "link": "https://stackoverflow.com/questions/44657978/get-with-basic-auth-ruby-doesnt-work", "title": "Get with Basic Auth Ruby doesn&#39;t work", "body": "<p>I need to make a GET request in a public api. I know the login and password data are correct but the api returns authentication error. By postman the request is made successfully. The problem is in the same ruby code.</p>\n\n<p>code:</p>\n\n<pre><code>    nfe_key = '41170608187168000160550010000001561000000053'\n    params = {'grupo' =&gt; 'edoc','cnpj' =&gt; '08187168000160', 'ChaveNota' =&gt; nfe_key, 'Url' =&gt; '1'} \n\n    url = URI.parse('https://managersaashom.tecnospeed.com.br:7071/ManagerAPIWeb/nfe/imprime')\n\n    get = Net::HTTP::Get.new(url.path)\n    get.basic_auth 'admin', '123mudar'\n    get.set_form_data(params)\n\n    request = Net::HTTP.new(url.host, url.port)\n    request.read_timeout = 500 #seconds\n    request.use_ssl = true\n    request.verify_mode = OpenSSL::SSL::VERIFY_NONE\n    response = request.start {|http| http.request(get) }\n\n    puts response.body\n</code></pre>\n\n<p>I make a request on a POST route in the same way and it WORKS. I do not understand why with GET does not work.</p>\n\n<p>With post method works:</p>\n\n<pre><code>    params = {'grupo' =&gt; 'edoc','cnpj' =&gt; '08187168000160', 'arquivo' =&gt; 'formato=XML\n    ' + xml} \n    url = URI.parse('https://managersaashom.tecnospeed.com.br:7071/ManagerAPIWeb/nfe/envia')\n\n    post = Net::HTTP::Post.new(url.path)\n    post.basic_auth 'admin', '123mudar'\n    post.set_form_data(params)\n\n    request = Net::HTTP.new(url.host, url.port)\n    request.read_timeout = 500 #seconds\n    request.use_ssl = true\n    request.verify_mode = OpenSSL::SSL::VERIFY_NONE\n    response = request.start {|http| http.request(post) }\n\n    puts response.body\n</code></pre>\n\n<p>In postman:</p>\n\n<p>url :  <a href=\"https://managersaashom.tecnospeed.com.br:7071/ManagerAPIWeb/nfe/imprime?grupo=edoc&amp;cnpj=08187168000160&amp;ChaveNota=41170608187168000160550010000001561000000053&amp;Url=1\" rel=\"nofollow noreferrer\">https://managersaashom.tecnospeed.com.br:7071/ManagerAPIWeb/nfe/imprime?grupo=edoc&amp;cnpj=08187168000160&amp;ChaveNota=41170608187168000160550010000001561000000053&amp;Url=1</a> </p>\n\n<p>method: post\nbasic auth:\n username admin \n password 123mudar </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1329, "user_id": 4341902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GA0Ju.jpg?s=128&g=1", "display_name": "Billy Ferguson", "link": "https://stackoverflow.com/users/4341902/billy-ferguson"}, "edited": false, "score": 0, "creation_date": 1497974573, "post_id": 44657770, "comment_id": 76301179, "body": "If you&#39;re using postgresql you can do this: <code>User.all.group(&quot;DATE_TRUNC(&#39;week&#39;, created_at)&quot;).</code> But that only gets you halfway there."}, {"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 2, "creation_date": 1497974845, "post_id": 44657770, "comment_id": 76301363, "body": "What database are you working with?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 4, "creation_date": 1497975297, "post_id": 44657770, "comment_id": 76301607, "body": "<code>Log.sum(:points).group(&quot;DATE_TRUNC(&#39;week&#39;, created_at)&quot;).where(user_id: user_id)</code> should do it for <code>postgres</code>. If you are using another database you will have to determine how to handle the grouping into weeks."}, {"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "edited": false, "score": 0, "creation_date": 1497976747, "post_id": 44657770, "comment_id": 76302549, "body": "I&#39;m using postgres"}], "answers": [{"comments": [{"owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "edited": false, "score": 0, "creation_date": 1497978704, "post_id": 44658909, "comment_id": 76303638, "body": "This query will not distinguish between week 1 2016 and week 1 2017"}], "tags": [], "owner": {"reputation": 10255, "user_id": 1155142, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c680db41999d478ca34d1a77a470e30d?s=128&d=identicon&r=PG", "display_name": "gabrielhilal", "link": "https://stackoverflow.com/users/1155142/gabrielhilal"}, "is_accepted": false, "score": 2, "last_activity_date": 1497983301, "last_edit_date": 1497983301, "creation_date": 1497977491, "answer_id": 44658909, "question_id": 44657770, "link": "https://stackoverflow.com/questions/44657770/with-rails-how-can-i-query-the-db-for-an-aggregate-number-and-grouped-by-week/44658909#44658909", "title": "With Rails, how can I query the db for an aggregate number and grouped by week?", "body": "<p>something like:</p>\n\n<pre><code>points_by_week = Log.select(\"DATE_TRUNC('week', created_at) as week, sum(points) as total_points\").group(\"week\").where(user_id: x)\n\npoints_by_week.each do |pw|\n  puts \"Week of #{pw.week.strftime('%d/%m/%Y')} - #{pw.total_points} total points\"\nend\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>as per Michael Gorman comment the above won't distinguish between years (2017, 2016, etc), so you might need to group by week and year depending on your requirements:</p>\n\n<pre><code>Log.select(\"DATE_TRUNC('week', created_at) as week, DATE_TRUNC('year', created_at) as year, sum(points) as total_points\").group(\"week, year\")\n</code></pre>\n\n<p>and you can keep using the above loop to display it ;)</p>\n"}, {"tags": [], "owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "is_accepted": false, "score": 1, "last_activity_date": 1497978270, "last_edit_date": 1497978270, "creation_date": 1497977883, "answer_id": 44659019, "question_id": 44657770, "link": "https://stackoverflow.com/questions/44657770/with-rails-how-can-i-query-the-db-for-an-aggregate-number-and-grouped-by-week/44659019#44659019", "title": "With Rails, how can I query the db for an aggregate number and grouped by week?", "body": "<p>Something like this:</p>\n\n<pre><code>select 'WEEK of ' || TO_CHAR(date_trunc( 'week', created_at ), 'dd/mm/yyyy') || ' - ' || sum(points) || ' total points'\nFROM clients\n  WHERE id &lt; 100000\n  GROUP BY date_trunc( 'week', created_at );\n</code></pre>\n\n<p><a href=\"https://www.postgresql.org/docs/9.1/static/functions-string.html\" rel=\"nofollow noreferrer\"><code>||</code></a> is used to concatenate string.</p>\n\n<p><a href=\"https://www.postgresql.org/docs/9.6/static/functions-formatting.html\" rel=\"nofollow noreferrer\"><code>TO_CHAR</code></a> is used as a data type formatting functions.</p>\n"}, {"comments": [{"owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "edited": false, "score": 0, "creation_date": 1498013145, "post_id": 44659214, "comment_id": 76317236, "body": "This is great - thank you! FYI, there was an error due to a comma missing after <code>DATE_TRUNC(&#39;week&#39; </code>"}], "tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": true, "score": 4, "last_activity_date": 1498050745, "last_edit_date": 1498050745, "creation_date": 1497978549, "answer_id": 44659214, "question_id": 44657770, "link": "https://stackoverflow.com/questions/44657770/with-rails-how-can-i-query-the-db-for-an-aggregate-number-and-grouped-by-week/44659214#44659214", "title": "With Rails, how can I query the db for an aggregate number and grouped by week?", "body": "<pre><code>points_by_week = Log.where(user_id: user_id).group(\"DATE_TRUNC('year', created_at)\", \"DATE_TRUNC('week', created_at)\").sum(:points)\n</code></pre>\n\n<p>Will yield a result like</p>\n\n<pre><code>{[2014, 4]=&gt;3,\n [2014, 8]=&gt;7,\n [2015, 4]=&gt;26,\n [2015, 6]=&gt;19,\n [2015, 12]=&gt;50,\n [2015, 32]=&gt;48,\n [2016, 2]=&gt;78,\n [2016, 3]=&gt;45,\n [2016, 4]=&gt;49,\n [2016, 5]=&gt;110,\n [2016, 45]=&gt;30,\n [2017, 4]=&gt;130,\n [2017, 11]=&gt;185}\n</code></pre>\n\n<p>where the key is [year, week], then you can use Date.commercial to get the week of</p>\n\n<pre><code>points_by_week.each do |(year, week), count|\n  date = Date.commercial(year, week)\n  puts \"Week of #{date.strftime('%d/%m/%Y')} - #{count} total points\"\nend\n</code></pre>\n\n<p>And (just cause I can), the mysql version of the query looks like this</p>\n\n<pre><code>points_by_week = Log.where(user_id: user_id).group(\"year(created_at)\", \"week(created_at)\").sum(:points)\n</code></pre>\n\n<p>This by default assumes the week starts on Monday, and the first week of a year is starts on the first Monday of the year</p>\n"}], "owner": {"reputation": 1720, "user_id": 1917603, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/d7d763d72f534405df332812a9d2f2f8?s=128&d=identicon&r=PG", "display_name": "AnnaSm", "link": "https://stackoverflow.com/users/1917603/annasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 44659214, "answer_count": 3, "score": 2, "last_activity_date": 1498050745, "creation_date": 1497974082, "last_edit_date": 1497976758, "question_id": 44657770, "link": "https://stackoverflow.com/questions/44657770/with-rails-how-can-i-query-the-db-for-an-aggregate-number-and-grouped-by-week", "title": "With Rails, how can I query the db for an aggregate number and grouped by week?", "body": "<p>Given a table like so:</p>\n\n<p><strong>Log:</strong></p>\n\n<pre><code>id, user_id, points, created_at\n</code></pre>\n\n<p>With Rails, how can I query the database by user_id and then GROUPED by week via created_at where I can then having something like:</p>\n\n<pre><code>   WEEK of X/XX/XXXX - 3011 total points\n   WEEK of X/XX/XXXX - 320 total points\n   WEEK of X/XX/XXXX - 31 total points\n   WEEK of X/XX/XXXX - 30330 total points\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "edited": false, "score": 0, "creation_date": 1497973337, "post_id": 44657322, "comment_id": 76300348, "body": "Could you show us the error message?. <code>@organisme.save!</code> will show the error message."}, {"owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "reply_to_user": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "edited": false, "score": 0, "creation_date": 1497973499, "post_id": 44657322, "comment_id": 76300474, "body": "@JunanChakma It gives me this <code>Validation failed: Addresses organisme must exist</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "edited": false, "score": 0, "creation_date": 1497974305, "post_id": 44657783, "comment_id": 76300991, "body": "Thank you so much it works perfectly :D Was it because it was trying to have both of them for each addresses and by adding that they&#39;re optional it allows it to have only one of them?"}, {"owner": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "reply_to_user": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "edited": false, "score": 1, "creation_date": 1497974830, "post_id": 44657783, "comment_id": 76301354, "body": "It was not worked because <code>Address</code> validate to presence <code>organisme</code> while create it. But since its parents <code>organisme</code> has not created yet while creating <code>address</code>. Thats why it is giving this validation error."}], "tags": [], "owner": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "is_accepted": true, "score": 1, "last_activity_date": 1497974120, "creation_date": 1497974120, "answer_id": 44657783, "question_id": 44657322, "link": "https://stackoverflow.com/questions/44657322/two-different-classes-using-accepts-nested-attributes-of-one-class/44657783#44657783", "title": "Two different classes using accepts_nested_attributes of one class", "body": "<p>Try to change address model like </p>\n\n<pre><code>class Address &lt; ApplicationRecord\n  belongs_to :organismereferent, optional: true\n  belongs_to :organisme, optional: true\nend\n</code></pre>\n"}], "owner": {"reputation": 2785, "user_id": 7503064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-T2C-ikRb0Ew/AAAAAAAAAAI/AAAAAAAAADM/Y7xlspIiYvg/photo.jpg?sz=128", "display_name": "I.B", "link": "https://stackoverflow.com/users/7503064/i-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 44657783, "answer_count": 1, "score": 0, "last_activity_date": 1497974120, "creation_date": 1497972770, "question_id": 44657322, "link": "https://stackoverflow.com/questions/44657322/two-different-classes-using-accepts-nested-attributes-of-one-class", "title": "Two different classes using accepts_nested_attributes of one class", "body": "<p>I have a class Addresse where Organismereferent and Organisme have a <code>has_many</code> <code>belongs_to</code> relationship with. Also Organismereferent and Organisme can <code>accepts_nested_attributes_for :addresses</code></p>\n\n<p>My problem is when I only had the Organismereferent class everything was working fine and I was able to create a new Organismereferent with an addresse but as soon as I created and added the same relation to Organisme , they both stopped working without giving any error message I only get this in the console:\n<a href=\"https://i.stack.imgur.com/8sOMg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8sOMg.png\" alt=\"enter image description here\"></a></p>\n\n<p>My model:</p>\n\n<pre><code>class Organismereferent &lt; ApplicationRecord\n  has_many :addresses\n  has_many :referents\n  accepts_nested_attributes_for :addresses\nend\n\nclass Organisme &lt; ApplicationRecord\n  has_many :addresses\n  accepts_nested_attributes_for :addresses\nend\n\nclass Address &lt; ApplicationRecord\n  belongs_to :organismereferent\n  belongs_to :organisme\nend\n</code></pre>\n\n<p>Controller for Organisme</p>\n\n<pre><code>def new\n  @organisme = Organisme.new\n  @organisme.addresses.build\nend\n\ndef create\n  @organisme = Organisme.new(organisme_params)\n  @organisme.status = true\n  @organisme.save\n  redirect_to @organisme\nend\n\nprivate\n  def organisme_params\n    params.require(:organisme).permit(:nom, :telephone, :courriel, :fax, addresses_attributes: [:id, :no_civique, :rue, :ville, :province, :etat, :code_postal])\n  end\n</code></pre>\n\n<p>Controller for Organismereferent:</p>\n\n<pre><code>def new\n  @organisme = Organismereferent.new\n  @organisme.addresses.build\nend\n\ndef create\n  @organisme = Organismereferent.new(organisme_params)\n  @organisme.active = true\n  @organisme.save\n  redirect_to @organisme\nend\n\nprivate\n  def organisme_params\n      params.require(:organismereferent).permit(:nom_organisation, :bureau, :telecopie, :courriel, :site_web, addresses_attributes: [:id, :no_civique, :rue, :ville, :province, :etat, :code_postal])\n  end\n</code></pre>\n\n<p>I'm not sure what else information might be important so I'll be glad to add anything.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "seeding"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 1, "creation_date": 1497972235, "post_id": 44656886, "comment_id": 76299603, "body": "you could always move your Seed loader code into a nice Class, then just create an instance of that class or use a class method to do the job in both your Rake task and when you click on that button."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497972408, "post_id": 44656886, "comment_id": 76299722, "body": "Maybe something related <a href=\"https://stackoverflow.com/questions/5212351/can-i-somehow-execute-my-db-seeds-rb-file-from-my-rails-app/5212588\" title=\"can i somehow execute my db seeds rb file from my rails app\">stackoverflow.com/questions/5212351/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1497972220, "post_id": 44657077, "comment_id": 76299588, "body": "Oh, didn&#39;t know about that one :) Definitely the way to go."}, {"owner": {"reputation": 177, "user_id": 5154248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1993645ea9185f4b754ebdcf3347632?s=128&d=identicon&r=PG&f=1", "display_name": "user24601", "link": "https://stackoverflow.com/users/5154248/user24601"}, "edited": false, "score": 0, "creation_date": 1497974831, "post_id": 44657077, "comment_id": 76301355, "body": "Wow, not only did that work, it also drastically boosted the operation&#39;s speed. Thank you so much!"}], "tags": [], "owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "is_accepted": true, "score": 6, "last_activity_date": 1497972085, "creation_date": 1497972085, "answer_id": 44657077, "question_id": 44656886, "link": "https://stackoverflow.com/questions/44656886/rails-in-app-database-seed-button/44657077#44657077", "title": "Rails - In-app &quot;database seed&quot; button?", "body": "<p>You can simply use <code>Rails.application.load_seed</code> where you want in your code</p>\n"}, {"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 3, "last_activity_date": 1497972286, "creation_date": 1497972286, "answer_id": 44657136, "question_id": 44656886, "link": "https://stackoverflow.com/questions/44656886/rails-in-app-database-seed-button/44657136#44657136", "title": "Rails - In-app &quot;database seed&quot; button?", "body": "<p>There is also:</p>\n\n<pre><code>MyAwesomeApp::Application.load_tasks\nRake::Task[\"db:seed\"].invoke\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5154248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1993645ea9185f4b754ebdcf3347632?s=128&d=identicon&r=PG&f=1", "display_name": "user24601", "link": "https://stackoverflow.com/users/5154248/user24601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 1, "accepted_answer_id": 44657077, "answer_count": 2, "score": 2, "last_activity_date": 1497972286, "creation_date": 1497971575, "question_id": 44656886, "link": "https://stackoverflow.com/questions/44656886/rails-in-app-database-seed-button", "title": "Rails - In-app &quot;database seed&quot; button?", "body": "<p>I'm building a Rails app for my company. My <em>seeds.rb</em> file contains code to sync my list of users with our Office 365 directory, which needs to happen every time something changes in the directory, and I'm trying to build an in-app \"seed\" button so that people with no Rails/Heroku knowledge can initiate that process.</p>\n\n<p>As you can see in the code excerpts below, I've figured out that I can do this by calling <code>rails db:seed</code> as a shell command, but it feels like there should be a less roundabout way to do this than a Rails app calling a shell command to perform an operation on itself.</p>\n\n<p>Is there a way to actually run the code in seeds.rb from within the app, or is calling <code>rails db:seed</code> the closest I've got?</p>\n\n<p><em>app/views/layouts/_header.html.erb</em></p>\n\n<pre><code>...\n&lt;li&gt;&lt;%= link_to \"Sync users with O365\", seed_path %&gt;&lt;/li&gt;\n...\n</code></pre>\n\n<p><em>config/routes.rb</em></p>\n\n<pre><code>...\nget '/seed', to: 'application#seed'\n...\n</code></pre>\n\n<p><em>app/controllers/application_controller.rb</em></p>\n\n<pre><code>...\n  def seed\n    `rails db:seed`\n    redirect_back_or root_path\n  end\n...\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "rspec", "automation", "cucumber"], "comments": [{"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1497991517, "post_id": 44656565, "comment_id": 76311061, "body": "You can check this answer <a href=\"https://stackoverflow.com/a/24952345/2067375\">stackoverflow.com/a/24952345/2067375</a>. This might be helpful . You need to implement that feature in the application itself."}, {"owner": {"reputation": 23, "user_id": 8053651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMfN3.jpg?s=128&g=1", "display_name": "Ferhat", "link": "https://stackoverflow.com/users/8053651/ferhat"}, "reply_to_user": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1498054654, "post_id": 44656565, "comment_id": 76341442, "body": "Thanks but That&#39;s not what I&#39;m looking for"}], "owner": {"reputation": 23, "user_id": 8053651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMfN3.jpg?s=128&g=1", "display_name": "Ferhat", "link": "https://stackoverflow.com/users/8053651/ferhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1509613762, "creation_date": 1497970646, "last_edit_date": 1509613762, "question_id": 44656565, "link": "https://stackoverflow.com/questions/44656565/ruby-login-with-run-as-a-different-user-in-browser", "title": "Ruby-Login with Run as a different user in browser", "body": "<p>Normally with hand, <kbd>shift</kbd>+<kbd>right-click</kbd> on browser - Run as a different user.</p>\n\n<p>Login by typing user name and password. I'm testing Ruby. How do I log in with different users in Ruby?</p>\n\n<p><a href=\"https://i.stack.imgur.com/VWTIQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VWTIQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "date", "datetime"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2480609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18131cf4579a72dee741b5bcad00c6d?s=128&d=identicon&r=PG", "display_name": "Michael Larkin", "link": "https://stackoverflow.com/users/2480609/michael-larkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1497971662, "creation_date": 1497971662, "answer_id": 44656932, "question_id": 44655872, "link": "https://stackoverflow.com/questions/44655872/ruby-datetime-to-utc-conversion/44656932#44656932", "title": "Ruby: Datetime to UTC conversion", "body": "<pre><code>require 'time'\n\nfrom = Time.parse \"2017-06-19 14:00 US/Eastern\"\n=&gt; 2017-06-19 14:00:00 -0400 \nfrom.utc\n=&gt; 2017-06-19 18:00:00 UTC\n\nto = Time.parse \"2017-06-19 23:00 US/Eastern\"\n=&gt; 2017-06-19 23:00:00 -0400 \nto.utc\n=&gt; 2017-06-20 03:00:00 UTC \n</code></pre>\n\n<p>Though you can also specify the timezone offset without using the string, doing it this way handles Daylight Savings Time.</p>\n"}, {"comments": [{"owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "edited": false, "score": 0, "creation_date": 1498052682, "post_id": 44660289, "comment_id": 76339963, "body": "Please check my answer, I think it&#39;s shorter and better."}], "tags": [], "owner": {"reputation": 21, "user_id": 1452835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfc1b7fa1474718b82944d4127d4232?s=128&d=identicon&r=PG", "display_name": "Kellen Kyros", "link": "https://stackoverflow.com/users/1452835/kellen-kyros"}, "is_accepted": false, "score": 1, "last_activity_date": 1497982444, "creation_date": 1497982444, "answer_id": 44660289, "question_id": 44655872, "link": "https://stackoverflow.com/questions/44655872/ruby-datetime-to-utc-conversion/44660289#44660289", "title": "Ruby: Datetime to UTC conversion", "body": "<p>Below line of codes worked for me:</p>\n\n<pre><code>parsed_date = Time.zone.parse(from_date).strftime('%Y-%m-%d')\nparsed_time = Time.zone.parse(from_time).strftime('%T')\nTime.parse(parsed_date + ' ' + parsed_time).utc.strftime('%F %T')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7420, "user_id": 1081668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DdH12.png?s=128&g=1", "display_name": "Thanh", "link": "https://stackoverflow.com/users/1081668/thanh"}, "is_accepted": false, "score": 0, "last_activity_date": 1498052649, "creation_date": 1498052649, "answer_id": 44677918, "question_id": 44655872, "link": "https://stackoverflow.com/questions/44655872/ruby-datetime-to-utc-conversion/44677918#44677918", "title": "Ruby: Datetime to UTC conversion", "body": "<p>I think this is shorter:</p>\n\n<pre><code>from_date = \"2017-06-19\"\nfrom_time = \"14:00\"\nDateTime.strptime(\"#{from_date}T#{from_time}ZEDT\", \"%Y-%m-%dT%H:%MZ%z\").utc\n=&gt; Mon, 19 Jun 2017 18:00:00 +000\n\nto_date = \"2017-06-19\" \nto_time = \"23:00\"\n\nDateTime.strptime(\"#{to_date}T#{to_time}ZEDT\", \"%Y-%m-%dT%H:%MZ%z\").utc\n=&gt; Tue, 20 Jun 2017 03:00:00 +0000\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1452835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfc1b7fa1474718b82944d4127d4232?s=128&d=identicon&r=PG", "display_name": "Kellen Kyros", "link": "https://stackoverflow.com/users/1452835/kellen-kyros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1498052649, "creation_date": 1497968962, "last_edit_date": 1497969631, "question_id": 44655872, "link": "https://stackoverflow.com/questions/44655872/ruby-datetime-to-utc-conversion", "title": "Ruby: Datetime to UTC conversion", "body": "<p>I am trying to convert the below date and time combination to UTC</p>\n\n<pre><code>from_date: \"2017-06-19\",from_time: \"14:00\"\nto_date: \"2017-06-19\", to_time: \"23:00\"\nTimezone: EDT\n</code></pre>\n\n<p>I am using below piece of code for conversion</p>\n\n<pre><code>Date.parse(dt).to_datetime + Time.parse(t).utc.seconds_since_midnight.seconds\n</code></pre>\n\n<p>And it gives the wrong date value for the to_date &amp; to_time combination.</p>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Date.parse(from_date).to_datetime +\n   Time.parse(from_time).utc.seconds_since_midnight.seconds\n#\u21d2 **Mon, 19 Jun 2017 18:00:00 +0000**\n\nDate.parse(to_date).to_datetime +\n   Time.parse(to_time).utc.seconds_since_midnight.seconds\n#\u21d2 **Mon, 19 Jun 2017 03:00:00 +0000**\n</code></pre>\n\n<p>Above conversion should give \"Tue, 20 Jun 2017 03:00:00 +0000\" instead.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "edited": false, "score": 0, "creation_date": 1497969407, "post_id": 44655795, "comment_id": 76297457, "body": "Use this response : <a href=\"https://stackoverflow.com/questions/19412607/rails-where-like-and-array\" title=\"rails where like and array\">stackoverflow.com/questions/19412607/rails-where-like-and-ar&zwnj;&#8203;ray</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1497975538, "post_id": 44655795, "comment_id": 76301761, "body": "@user1936635 take a look at this answer I posted yesterday <a href=\"https://stackoverflow.com/questions/44633250/ruby-rails-sql-query-reordering-words-in-a-search-term/44634062#44634062\" title=\"ruby rails sql query reordering words in a search term\">stackoverflow.com/questions/44633250/&hellip;</a>. This is cross database compatible using <code>Arel</code>. You will just have to expand it ever so slightly to handle the multiple fields you are interested in"}, {"owner": {"reputation": 45, "user_id": 1936635, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/03f9a3718a4c976a5e362504af633442?s=128&d=identicon&r=PG", "display_name": "user1936635", "link": "https://stackoverflow.com/users/1936635/user1936635"}, "edited": false, "score": 0, "creation_date": 1497976727, "post_id": 44655795, "comment_id": 76302534, "body": "awesome, I&#39;ll try Arel. thank you"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1497986544, "post_id": 44655795, "comment_id": 76308284, "body": "Possible duplicate of: <a href=\"https://stackoverflow.com/questions/26094430/safe-activerecord-like-query\" title=\"safe activerecord like query\">stackoverflow.com/questions/26094430/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 1936635, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/03f9a3718a4c976a5e362504af633442?s=128&d=identicon&r=PG", "display_name": "user1936635", "link": "https://stackoverflow.com/users/1936635/user1936635"}, "edited": false, "score": 0, "creation_date": 1497974030, "post_id": 44656212, "comment_id": 76300805, "body": "appreciate if you can show me how to do it on MySQL. Thank you very much"}], "tags": [], "owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "is_accepted": true, "score": 0, "last_activity_date": 1497969820, "creation_date": 1497969820, "answer_id": 44656212, "question_id": 44655795, "link": "https://stackoverflow.com/questions/44655795/like-query-in-rails-5-not-working/44656212#44656212", "title": "LIKE Query in rails 5 not working", "body": "<p>According to <a href=\"https://stackoverflow.com/questions/19412607/rails-where-like-and-array\">this response</a> if you are using Postgres you can try something like this : </p>\n\n<pre><code>field2_ilike_params = params[:array_for_field2].map { |p| \"%p%\" }\nfield3_ilike_params = params[:array_for_field3].map { |p| \"%p%\" }\nModel.where(field1: params[:array_for_field1]).where(\"field2 ILIKE ANY ( array[?] ) AND field3 ILIKE ANY ( array[?] )\", field2_ilike_params, field3_ilike_params)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 1936635, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/03f9a3718a4c976a5e362504af633442?s=128&d=identicon&r=PG", "display_name": "user1936635", "link": "https://stackoverflow.com/users/1936635/user1936635"}, "is_accepted": false, "score": 1, "last_activity_date": 1497980069, "creation_date": 1497980069, "answer_id": 44659614, "question_id": 44655795, "link": "https://stackoverflow.com/questions/44655795/like-query-in-rails-5-not-working/44659614#44659614", "title": "LIKE Query in rails 5 not working", "body": "<p>I end up using this solution with REGEX, it works as I needed.</p>\n\n<pre><code>.where(\"field1 IN(?) AND field2 RLIKE(?) AND field3 RLIKE(?) \", params[:array_for_field1], params[:array_for_field2].join(\"|\"), params[:array_for_field3].join(\"|\"))\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1936635, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/03f9a3718a4c976a5e362504af633442?s=128&d=identicon&r=PG", "display_name": "user1936635", "link": "https://stackoverflow.com/users/1936635/user1936635"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 44656212, "answer_count": 2, "score": 0, "last_activity_date": 1497980069, "creation_date": 1497968752, "question_id": 44655795, "link": "https://stackoverflow.com/questions/44655795/like-query-in-rails-5-not-working", "title": "LIKE Query in rails 5 not working", "body": "<p>Using this :</p>\n\n<pre><code>.. .where(\"field1 IN(?) AND field2 LIKE(?) AND field3 LIKE(?) \", params[:array_for_field1], \"%#{params[:array_for_field2]}%\", \"%#{params[:array_for_field3]}%\")\n</code></pre>\n\n<p>I'm getting this :</p>\n\n<pre><code>SELECT `table`.* FROM `table` WHERE(field1 IN('value1','value2','value3') AND field2 LIKE('%[\\\"value1\\\", \\\"value2\\\"]%') AND field3 LIKE('%[\\\"value1\\\"]%') )\n</code></pre>\n\n<p>I would like to know where's the mistake, for field1 works, but the \"LIKE Query\" part using % is not, the params comes from a checkboxes form. thank you</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1497972055, "post_id": 44655226, "comment_id": 76299461, "body": "<i>Sidenote:</i> <b>never</b> use <code>+</code> to concatenate strings in Ruby, it\u2019s a code smell."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5687640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/417110ebca8c32bba4be0b361f6fbaeb?s=128&d=identicon&r=PG&f=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5687640/trenton-tyler"}, "edited": false, "score": 0, "creation_date": 1497971324, "post_id": 44655273, "comment_id": 76298919, "body": "Instead of it outputting to three different columns how can I make it so it is one string? I tried replacing commas with plus signs but get a nil error."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 83, "user_id": 5687640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/417110ebca8c32bba4be0b361f6fbaeb?s=128&d=identicon&r=PG&f=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5687640/trenton-tyler"}, "edited": false, "score": 2, "creation_date": 1497971981, "post_id": 44655273, "comment_id": 76299395, "body": "Updated an answer :: use string interpolation."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1497971970, "last_edit_date": 1497971970, "creation_date": 1497967396, "answer_id": 44655273, "question_id": 44655226, "link": "https://stackoverflow.com/questions/44655226/generate-csv-from-ruby-results/44655273#44655273", "title": "Generate CSV from Ruby results", "body": "<p>Just manage the CSV file to write around the reading:</p>\n\n<pre><code>CSV.open(\"path/to/file.csv\", \"wb\") do |csv|\n  CSV.foreach('data.csv', :headers =&gt; true) do |row|\n    id = row['id']\n    fn = row['first_name']\n    ln = row['last_name']\n    csv &lt;&lt; [fn[0], ln, id[3,8]]\n    # or, to output it as a single column:\n    # csv &lt;&lt; [\"#{fn[0]}#{ln}#{id[3,8]}\"]\n  end\nend\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/stdlib-2.4.1/libdoc/csv/rdoc/CSV.html#class-CSV-label-To+a+File\" rel=\"nofollow noreferrer\">Writing CSV to a file</a>.</p>\n"}], "owner": {"reputation": 83, "user_id": 5687640, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/417110ebca8c32bba4be0b361f6fbaeb?s=128&d=identicon&r=PG&f=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5687640/trenton-tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 44655273, "answer_count": 1, "score": 0, "last_activity_date": 1497971970, "creation_date": 1497967277, "question_id": 44655226, "link": "https://stackoverflow.com/questions/44655226/generate-csv-from-ruby-results", "title": "Generate CSV from Ruby results", "body": "<p>I currently have this script that generates usernames from a given CSV. Rather than printing these results to the console, how can I write a new CSV with these results?</p>\n\n<p>This is the script I currently have, runs with no errors. I am assuming if I write a new CSV in the do |row| block it is going to create x amount of new files which I do not want. </p>\n\n<pre><code>require 'csv'\n\nCSV.foreach('data.csv', :headers =&gt; true) do |row|\n  id = row['id']\n  fn = row['first_name']\n  ln = row['last_name']\n  p fn[0] + ln + id[3,8]\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497965727, "post_id": 44654343, "comment_id": 76294419, "body": "Does this help? <a href=\"https://stackoverflow.com/q/2273122/477037\">stackoverflow.com/q/2273122/477037</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1022, "user_id": 8088139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c57f53526db57b9982402c7f4a353f?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Gorman", "link": "https://stackoverflow.com/users/8088139/michael-gorman"}, "is_accepted": true, "score": 0, "last_activity_date": 1497965587, "creation_date": 1497965587, "answer_id": 44654540, "question_id": 44654343, "link": "https://stackoverflow.com/questions/44654343/custom-validator-on-a-couple-of-attribute-in-rails/44654540#44654540", "title": "custom validator on a couple of attribute in Rails", "body": "<p>Building a custom validator class is a bit much for a single method validation (unless it needs to be used in multiple models).  Try this</p>\n\n<pre><code>class FollowingRelationship &lt; ApplicationRecord\n\n  belongs_to :followed, class_name: \"User\"\n  belongs_to :follower, class_name: \"User\"\n\n  validates :follower_id, presence: true\n  validates :followed_id, presence: true, followed_id: true\n  validates_uniqueness_of :follower_id, scope: :followed_id\n  validate  :does_not_follow_self\n\n  def does_not_follow_self\n    self.errors.add attribute, \"User can't follow itself\" unless self.follower != self.followed\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4412877, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EuEJL8pH70M/AAAAAAAAAAI/AAAAAAAAAL0/v4WOqAAjxB8/photo.jpg?sz=128", "display_name": "JohnLRBrock", "link": "https://stackoverflow.com/users/4412877/johnlrbrock"}, "is_accepted": false, "score": 0, "last_activity_date": 1497965720, "creation_date": 1497965720, "answer_id": 44654608, "question_id": 44654343, "link": "https://stackoverflow.com/questions/44654343/custom-validator-on-a-couple-of-attribute-in-rails/44654608#44654608", "title": "custom validator on a couple of attribute in Rails", "body": "<p>I've made a validator like this for my facebook clone.</p>\n\n<p>you can find it <a href=\"https://github.com/Khanthulhu/The-Dog-Park/blob/master/app/models/friend_request.rb\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The basic version looks like this </p>\n\n<pre><code>    def stop_friending_yourself\n        errors.add(:user_id, \"can't friend themself\") if user_id == friend_id\n    end\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4154276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 44654540, "answer_count": 2, "score": 0, "last_activity_date": 1497965720, "creation_date": 1497964989, "last_edit_date": 1497965611, "question_id": 44654343, "link": "https://stackoverflow.com/questions/44654343/custom-validator-on-a-couple-of-attribute-in-rails", "title": "custom validator on a couple of attribute in Rails", "body": "<p>I'm in trouble with Rails 'Validator'\nI have a table <code>FollowingRelationship</code> to store a couple of user, in which I should validate that <code>follower_id != followed_id</code> (user can't follows themselves).</p>\n\n<p>This is my model:</p>\n\n<pre><code>class FollowingRelationship &lt; ApplicationRecord\n\n  belongs_to :followed, class_name: \"User\"\n  belongs_to :follower, class_name: \"User\"\n\n  validates :follower_id, presence: true\n  validates :followed_id, presence: true, followed_id: true\n  validates_uniqueness_of :follower_id, scope: :followed_id \n\n  class FollowedValidator &lt; ActiveModel::EachValidator\n\n    def validate_each(record, attribute, value)\n      record.errors.add attribute, \"User can't follow itselves\" unless record.follower_id != value\n    end\n  end\nend\n</code></pre>\n\n<p>but the validator still not work</p>\n\n<p><code>FollowingRelationship.create(:follower_id =&gt; 1, :followed_id =&gt; 1)</code> shouldn't create the record, but it works.</p>\n\n<p>Could anyone help me? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "rails-migrations"], "answers": [{"comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1497960754, "post_id": 44652555, "comment_id": 76290570, "body": "You might wanna change it to <code>ModelA.all.find_each {|x| x.save! }</code>"}, {"owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1497960932, "post_id": 44652555, "comment_id": 76290695, "body": "oh yes, that would be more efficient."}], "tags": [], "owner": {"reputation": 631, "user_id": 8157532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bde8f29e12331c4a81c873acfc77cc?s=128&d=identicon&r=PG&f=1", "display_name": "ucpuzz", "link": "https://stackoverflow.com/users/8157532/ucpuzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1497961128, "last_edit_date": 1497961128, "creation_date": 1497960258, "answer_id": 44652555, "question_id": 44652280, "link": "https://stackoverflow.com/questions/44652280/how-to-do-rails-migrations-on-existing-records-historical-data/44652555#44652555", "title": "How to do rails migrations on existing records (historical data)?", "body": "<p>In the migration you can do the following:</p>\n\n<pre><code> class AddColummBToModelA &lt; ActiveRecord::Migration\n  def up\n    unless column_exists? :budgets, :column_b\n      add_column :budgets, :column_b ......\n      ModelA.find_each {|x| x.save! }\n    end\n\n  end\n\n  def down\n   remove_column :budgets, :column_b if column_exists? :budgets, :column_b\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 7862056, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/23b2496ea9a34406bfed33769b0af37d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven.lin", "link": "https://stackoverflow.com/users/7862056/steven-lin"}, "edited": false, "score": 0, "creation_date": 1497963591, "post_id": 44652682, "comment_id": 76292738, "body": "in this case, I am not using the method in the model to generate the value. This seems more like to add a default value?"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 93, "user_id": 7862056, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/23b2496ea9a34406bfed33769b0af37d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven.lin", "link": "https://stackoverflow.com/users/7862056/steven-lin"}, "edited": false, "score": 0, "creation_date": 1497964240, "post_id": 44652682, "comment_id": 76293245, "body": "What exactly are you doing in that method? If it is like concatenation, multiplication, addition or something which we can achieve using the SQL you can use raw update all"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 93, "user_id": 7862056, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/23b2496ea9a34406bfed33769b0af37d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven.lin", "link": "https://stackoverflow.com/users/7862056/steven-lin"}, "edited": false, "score": 0, "creation_date": 1497964269, "post_id": 44652682, "comment_id": 76293268, "body": "Is your columnA Array data type?"}, {"owner": {"reputation": 93, "user_id": 7862056, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/23b2496ea9a34406bfed33769b0af37d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven.lin", "link": "https://stackoverflow.com/users/7862056/steven-lin"}, "edited": false, "score": 0, "creation_date": 1497964782, "post_id": 44652682, "comment_id": 76293687, "body": "Column_A is of type text. I am using serialize to store a hash of the format, &quot;sample&quot;: [  \t   {&quot;name&quot;: &quot;A&quot;,  \t    &quot;value&quot;: [&quot;string1&quot;, &quot;string2&quot;]\t  \t   }  \t]. I am trying to parse this hash and return a string based on it."}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 1, "last_activity_date": 1497960601, "creation_date": 1497960601, "answer_id": 44652682, "question_id": 44652280, "link": "https://stackoverflow.com/questions/44652280/how-to-do-rails-migrations-on-existing-records-historical-data/44652682#44652682", "title": "How to do rails migrations on existing records (historical data)?", "body": "<p>Looping over all records is a bad idea if you have a lot of records in them. Let's say you have 2 million records It will take forever to update the column and then executing the callbacks and validations if you are going <code>ActiveRecord</code> way.</p>\n\n<p>If you can do it with SQL itself you can update all records using SQL way </p>\n\n<p>Something like this migration from Spree</p>\n\n<pre><code>class UpdateNameFieldsOnSpreeCreditCards &lt; ActiveRecord::Migration\n  def up\n    if ActiveRecord::Base.connection.adapter_name.downcase.include? \"mysql\"\n      execute \"UPDATE spree_credit_cards SET name = CONCAT(first_name, ' ', last_name)\"\n    else\n      execute \"UPDATE spree_credit_cards SET name = first_name || ' ' || last_name\"\n    end\n  end\n\n  def down\n    execute \"UPDATE spree_credit_cards SET name = NULL\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 7862056, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/23b2496ea9a34406bfed33769b0af37d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven.lin", "link": "https://stackoverflow.com/users/7862056/steven-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1497961128, "creation_date": 1497959438, "question_id": 44652280, "link": "https://stackoverflow.com/questions/44652280/how-to-do-rails-migrations-on-existing-records-historical-data", "title": "How to do rails migrations on existing records (historical data)?", "body": "<p>I have a model (Model_A) with two columns (Column_A and Column_B)</p>\n\n<p>My model has the following method in it, two generate value of column_B based on column_A</p>\n\n<pre><code>Class Model_A &lt; ActiveRecord::Base\n  before_save :set_column_B\n\n  def set_column_B\n      self.column_B = get_value_from_column_A\n  end\n\n  def get_value_from_column_A\n    # manipulate data from A to get value\n    column_A.join(,) \n  end\n\nend\n</code></pre>\n\n<p>I know I have to create a new column_B as a first step in the migration, However how do I change all pre-existing records in the database to have the correct value in column_B?\nShould I write a script or a Rake task to this or is there a way I can do it through migrations?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4096, "user_id": 641032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eee43a4d5cf6c965dde557003d227f8e?s=128&d=identicon&r=PG", "display_name": "Wukerplank", "link": "https://stackoverflow.com/users/641032/wukerplank"}, "edited": false, "score": 0, "creation_date": 1497957919, "post_id": 44651539, "comment_id": 76288426, "body": "Without more context this is hard to answer. I don&#39;t understand how this is connected to the partial: Why not retrieve the products into <code>@produtos</code> in the <code>ProdutosController</code> and order them however you want them to order? The partial does not care about the order."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "reply_to_user": {"reputation": 4096, "user_id": 641032, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eee43a4d5cf6c965dde557003d227f8e?s=128&d=identicon&r=PG", "display_name": "Wukerplank", "link": "https://stackoverflow.com/users/641032/wukerplank"}, "edited": false, "score": 0, "creation_date": 1497960358, "post_id": 44651539, "comment_id": 76290299, "body": "I use partial in index, where I want to make the order, and also use the partial in another page, that appears the products sought, without the order."}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497959653, "post_id": 44652102, "comment_id": 76289783, "body": "It did not work, it says <code>undefined local variable or method obj</code>"}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497960198, "post_id": 44652102, "comment_id": 76290184, "body": "Change &#39;partial: &quot;produto&quot;&#39; to &quot;produto&quot;"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497960769, "post_id": 44652102, "comment_id": 76290579, "body": "But it is the same thing &quot;produto&quot; and &quot;produto&quot;.It does not change anything if I change, right?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497962346, "post_id": 44652102, "comment_id": 76291746, "body": "I did this, I changed the &#39;partial: &quot;produto&quot;&#39; to &quot;produto&quot; but not changed."}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497963719, "post_id": 44652102, "comment_id": 76292830, "body": "You have &lt;%= render &quot;produto&quot;, obj: @produtos.order(:preco)%&gt; in show.html.erb and &lt;% obj.each do |produto| %&gt; in _produto.html.erb and you still get <i>undefined method obj</i>?"}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497969145, "post_id": 44652102, "comment_id": 76297224, "body": "What version Rails are you using?"}], "tags": [], "owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1497968770, "last_edit_date": 1497968770, "creation_date": 1497958898, "answer_id": 44652102, "question_id": 44651539, "link": "https://stackoverflow.com/questions/44651539/order-by-within-a-partial-render-is-it-possible/44652102#44652102", "title": "Order by within a partial render is it possible?", "body": "<p>You can pass an argument to your partial</p>\n\n<pre><code>&lt;%= render \"produto\", obj: @produtos.order(:preco)%&gt;\n&lt;%= render \"produto\", obj: @produtos.order(:quantidade)%&gt;\n</code></pre>\n\n<p>In your partial _produto.html.erb</p>\n\n<pre><code>&lt;% obj.each do |produto| %&gt;\n    ...\n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497962241, "post_id": 44652990, "comment_id": 76291673, "body": "I can not do this, because I would have to change the partial every time, I use this same partial in <code>quantidade</code>, and searching, if I change to leave specific for <code>preco</code> would be the same as I put the table in the code. It is not?"}, {"owner": {"reputation": 329, "user_id": 8159914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XApNb.jpg?s=128&g=1", "display_name": "Sowmiya Sangaiah", "link": "https://stackoverflow.com/users/8159914/sowmiya-sangaiah"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497962591, "post_id": 44652990, "comment_id": 76291962, "body": "Yeah if you make it specific for <code>preco</code> it would be same as the table you have coded."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497962835, "post_id": 44652990, "comment_id": 76292181, "body": "Because it is but I do not want to, because I use the same table in three places, what changes, one will be ordered by price(preco), the other by quantity(quantidade), and another is normal."}, {"owner": {"reputation": 329, "user_id": 8159914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XApNb.jpg?s=128&g=1", "display_name": "Sowmiya Sangaiah", "link": "https://stackoverflow.com/users/8159914/sowmiya-sangaiah"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497963073, "post_id": 44652990, "comment_id": 76292371, "body": "Have you tried as @SteveTurczyn suggested, since it also reflects the same way i told in my previous comment with your requirement to use for all partials."}], "tags": [], "owner": {"reputation": 329, "user_id": 8159914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XApNb.jpg?s=128&g=1", "display_name": "Sowmiya Sangaiah", "link": "https://stackoverflow.com/users/8159914/sowmiya-sangaiah"}, "is_accepted": false, "score": 0, "last_activity_date": 1497961440, "creation_date": 1497961440, "answer_id": 44652990, "question_id": 44651539, "link": "https://stackoverflow.com/questions/44651539/order-by-within-a-partial-render-is-it-possible/44652990#44652990", "title": "Order by within a partial render is it possible?", "body": "<p>Try using below format:</p>\n\n<pre><code>&lt;%= render partial: \"produto\", :locals =&gt; {:preco_data =&gt; @produtos_por_nome.order(:preco)} %&gt;\n</code></pre>\n\n<p>In your produto partial template you can access like</p>\n\n<pre><code>&lt;%= preco_data.each do |data| %&gt;\n    &lt;tr&gt;\n             &lt;td&gt;\n                &lt;%= produto.nome %&gt;\n             &lt;/td&gt;\n             &lt;td&gt;\n                &lt;%= produto.descricao %&gt;\n             &lt;/td&gt;\n             &lt;td&gt;\n                &lt;%= produto.preco %&gt;\n             &lt;/td&gt;\n             &lt;td&gt;\n                 &lt;%= produto.quantidade %&gt;\n             &lt;/td&gt;\n             &lt;td&gt;\n                &lt;%= button_to \"Remover\", produto, method: :delete, class: \"btn btn-danger\", \n                                          data:{confirm: \"Tem certeza que deseja remover?\"} %&gt;\n             &lt;/td&gt;\n           &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497963084, "post_id": 44653281, "comment_id": 76292377, "body": "In two places I will use the order by, but there is a third party that does not use it. I would have to create another special partial for that location."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497963373, "post_id": 44653281, "comment_id": 76292588, "body": "Ok, if you can&#39;t change the partial you can change the instance variable.  See the edit to my answer."}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497964104, "post_id": 44653281, "comment_id": 76293136, "body": "Ok, the error that appears is something like, undefined method &#39;each&#39; for.  <code>Showing &#47;root&#47;Alura&#47;Projeto_camisas_exemplo&#47;app&#47;views&#47;produtos&#47;_prod&zwnj;&#8203;uto.html.erb where line #1 raised:</code>  <code>undefined method &#39;each&#39; for nil:NilClass</code>   <code>&lt;% @produtos.each do |produto| %&gt;</code>"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497964298, "post_id": 44653281, "comment_id": 76293295, "body": "Hi, ok, I misread your variable names.  Please try the edits I&#39;ve made."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497964401, "post_id": 44653281, "comment_id": 76293393, "body": "And one more change (based on your index method)"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497965039, "post_id": 44653281, "comment_id": 76293913, "body": "In this: And then use it in the partial. <code>&lt;% @produtos.order(order_by).each do |produto| %&gt;</code> it will work? Why do not you use the order by, and when I call the partial on that screen that does not use the order by, I&#39;m going to need to give her an order, right?"}, {"owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "edited": false, "score": 0, "creation_date": 1497965173, "post_id": 44653281, "comment_id": 76293993, "body": "Okay, I made the changes, but still keep giving the same error in each"}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "edited": false, "score": 0, "creation_date": 1497969387, "post_id": 44653281, "comment_id": 76297440, "body": "Your error message <code>undefined method &#39;each&#39; for nil:NilClass</code> means you are not passing a @produtos collection to your partial. Check you are sending something from ProdutosController#index"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1497970650, "post_id": 44653281, "comment_id": 76298423, "body": "Ok, yes, as pointed out by many people you don&#39;t have the instance variable created.  I&#39;ve made one last edit to the answer <code>&lt;% @produtos = Produto.order(:nome) %&gt;</code> and that should work.  But you&#39;ll want to refactor this after you get it working."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1497970570, "last_edit_date": 1497970570, "creation_date": 1497962241, "answer_id": 44653281, "question_id": 44651539, "link": "https://stackoverflow.com/questions/44651539/order-by-within-a-partial-render-is-it-possible/44653281#44653281", "title": "Order by within a partial render is it possible?", "body": "<p>You can pass the option as a local variable.</p>\n\n<pre><code>&lt;%= render partial: \"produto\", locals: {order_by: :preco} %&gt;\n&lt;%= render partial: \"produto\", locals: {order_by: :quantidade }%&gt;\n</code></pre>\n\n<p>And then use it in the partial.</p>\n\n<pre><code>&lt;% @produtos.order(order_by).each do |produto| %&gt;\n</code></pre>\n\n<p>If you absolutely can't change the partial, you can change the instance variable before you call the partial.  So the part of the code where you want ordre <code>preco</code> you would do...</p>\n\n<pre><code>&lt;% @produtos = Produto.order(:nome) %&gt;\n&lt;%= render partial: \"produto\" %&gt;\n</code></pre>\n\n<p>You may want to combine the above into a helper method.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "is_accepted": true, "score": 0, "last_activity_date": 1497970994, "creation_date": 1497970994, "answer_id": 44656693, "question_id": 44651539, "link": "https://stackoverflow.com/questions/44651539/order-by-within-a-partial-render-is-it-possible/44656693#44656693", "title": "Order by within a partial render is it possible?", "body": "<p>I was able to solve..\nIn my partial, I removed the each became so ...</p>\n\n<pre><code>&lt;tr&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= produto.nome %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;/td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= produto.descricao %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;/td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= produto.preco %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;/td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= produto.quantidade %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;/td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;td&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= button_to \"Remover\", produto, method: :delete,\n                                                          class: \"btn btn-danger\",\u00a0 \n                                                          data:{confirm: \n                                                          \"Tem certeza que deseja remover?\"\n                                                            } %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Where i call:</p>\n\n<pre><code>&lt;thead&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;tr&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Nome&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Descri\u00e7\u00e3o&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Pre\u00e7o&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Quantidade&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Remover&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 &lt;/tr&gt;\n\u00a0\u00a0\u00a0 &lt;/thead&gt;\n\u00a0\u00a0\u00a0 &lt;tbody&gt;\n\n\u00a0\u00a0\u00a0 &lt;%= render partial: \"produto\",\u00a0 collection: @produtos_por_preco%&gt;\n\n\u00a0\u00a0\u00a0 \u00a0&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;table class=\"table table-bordered\"&gt;\n\u00a0 &lt;thead&gt;\n\u00a0 &lt;tr&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Nome&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Descri\u00e7\u00e3o&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Pre\u00e7o&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Quantidade&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;th&gt;Remover&lt;/th&gt;\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 &lt;/tr&gt;\n&lt;tbody&gt;\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= render partial: \"produto\",\u00a0 collection: @produtos_por_quantidade%&gt;    \n\n\u00a0\u00a0\u00a0 &lt;/tbody&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>def index\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 @produtos_por_preco = Produto.order :preco\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 @produtos_por_quantidade = Produto.order :quantidade\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #com limite\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #@produtos_por_nome = Produto.order (:nome).limit 5\n\u00a0\u00a0\u00a0 end\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 7959508, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f709b5c45dfa576ac1908802d8c7e817?s=128&d=identicon&r=PG&f=1", "display_name": "Elis Bresciani", "link": "https://stackoverflow.com/users/7959508/elis-bresciani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 44656693, "answer_count": 4, "score": 0, "last_activity_date": 1497970994, "creation_date": 1497957309, "last_edit_date": 1497962876, "question_id": 44651539, "link": "https://stackoverflow.com/questions/44651539/order-by-within-a-partial-render-is-it-possible", "title": "Order by within a partial render is it possible?", "body": "<p>I'm doing a project in RoR, and I got to a point, I was wondering if I can do a partial render and then an order by, is a table, which I use in different ways, but contains the same data, Which would change the order of the data with the order by.\nI want to do something like this:</p>\n\n<pre><code>    &lt;%= render partial: \"produto\", order_by :preco%&gt;\n    &lt;%= render partial: \"produto\", order_by :quantidade%&gt;\n</code></pre>\n\n<p>This is the partial:</p>\n\n<pre><code>    &lt;% @produtos.each do |produto| %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;tr&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= produto.nome %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;/td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;%= produto.descricao %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;/td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0  &lt;%= produto.preco %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;/td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;%= produto.quantidade %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;/td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;%= button_to \"Remover\", produto, method: :delete, class: \"btn btn-danger\", \n                                          data:{confirm: \"Tem certeza que deseja remover?\"} %&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;/td&gt;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0&lt;/tr&gt;\n    \u00a0&lt;% end %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<p>\u00a0</p>\n\n<pre><code>def index\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #@produtos_por_nome = Produto.order :nome\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #@produtos_por_preco = Produto.order :preco\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #com limite\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #@produtos_por_nome = Produto.order (:nome).limit 5\n\u00a0\u00a0\u00a0 end\n\u00a0\u00a0\u00a0 def new\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 @produto = Produto.new\n\u00a0\u00a0\u00a0 end\n\u00a0\u00a0\u00a0 def create\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 valores = params.require(:produto).permit :nome, :preco, :descricao, :quantidade\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 @produto = Produto.new valores\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if @produto.save\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 flash[:notice] = \"Produto salvo com sucesso\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 redirect_to root_url\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 else\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 render :new\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 end\n\n\u00a0\u00a0\u00a0 end\n\u00a0\u00a0\u00a0 def destroy\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 id=params[:id]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Produto.destroy id\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 redirect_to root_url\n\u00a0\u00a0\u00a0 end\n\u00a0\u00a0\u00a0 def busca\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 nome_a_buscar = \"%#{params[:nome]}\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 @produtos = Produto.where \"nome like ?\", nome_a_buscar\n\n\n\u00a0\u00a0\u00a0 end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "vagrant", "port"], "comments": [{"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1497991803, "post_id": 44650967, "comment_id": 76311184, "body": "I think You need to specify the &#39;host&#39; key in your database.yml file and put the ip of the vagrant VM as the value of that key."}, {"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1497991876, "post_id": 44650967, "comment_id": 76311222, "body": "And the &#39;port&#39; key in same file with value 6543. Since that is the port on which Connects to the 5432 port from VM"}], "owner": {"reputation": 498, "user_id": 4788979, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9049df96b6596236925b5a0222625b27?s=128&d=identicon&r=PG&f=1", "display_name": "Dominus", "link": "https://stackoverflow.com/users/4788979/dominus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497957985, "creation_date": 1497955674, "last_edit_date": 1497957985, "question_id": 44650967, "link": "https://stackoverflow.com/questions/44650967/having-trouble-running-postgresql-with-vagrant", "title": "Having trouble running postgresql with vagrant", "body": "<p>So I'm working on a ruby on rails project with a team, and they use ubuntu through vagrant to host the database (in postgresql), so all the rails commands are still executed from the host machine (windows).</p>\n\n<p>Basically, I'm having troubles connecting the two ends, everytime I try to go on any page, it tells me </p>\n\n<pre><code>PG::ConnectionBad\ncould not connect to server: Cannot assign requested address (0x00002741/10049) Is the server running on host \"0.0.0.0\" and accepting TCP/IP connections on port 6543?\n</code></pre>\n\n<p>The Vagrantfile forwards the port 6543 to 5432</p>\n\n<pre><code>  config.vm.network :forwarded_port, guest: 5432, host: 6543\n</code></pre>\n\n<p>and when I ssh into vagrant, it does indeed seem to be listening on that port: </p>\n\n<pre><code>Proto Recv-Q Send-Q Local Address           Foreign Address         State    \ntcp        0      0 0.0.0.0:5432            0.0.0.0:*               LISTEN\n</code></pre>\n\n<p>I don't know what's not working, I've even tried disabling the firewall to check whether that was the issue, but it wasn't.</p>\n\n<p>I welcome any help that can be offered.\nThank you</p>\n\n<p>EDIT: After reading <a href=\"https://stackoverflow.com/questions/18725855/trouble-connecting-to-postgresql-database-in-vagrant-guest-box-with-induction-fr\">this</a>, I looked at my pg_hba.conf file, but it looks like it's allowing all connections:</p>\n\n<pre><code># \"local\" is for Unix domain socket connections only\nlocal   all             all                                  trust\n# IPv4 local connections:\nhost    all             all             0.0.0.0/0            trust\n# IPv6 local connections:\nhost    all             all             ::/0                 trust\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6015, "user_id": 390808, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a0f6edad668a0b63171eeb2a8aea39cd?s=128&d=identicon&r=PG", "display_name": "Sven Koschnicke", "link": "https://stackoverflow.com/users/390808/sven-koschnicke"}, "edited": false, "score": 1, "creation_date": 1497957013, "post_id": 44650925, "comment_id": 76287716, "body": "I can&#39;t reproduce the output you get. Could you give a complete example? I assume you want to match &quot;all lines not starting with &#39;[Roll]&#39;&quot;, is that right? That would be <code>^(?!\\[Roll\\]).*&#47;mg</code>. Your current regex matches the first line starting with either &#39;R&#39;, &#39;o&#39; or &#39;l&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "edited": false, "score": 0, "creation_date": 1497957304, "post_id": 44651393, "comment_id": 76287952, "body": "Thanks for the partition method"}], "tags": [], "owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "is_accepted": false, "score": 1, "last_activity_date": 1497956906, "creation_date": 1497956906, "answer_id": 44651393, "question_id": 44650925, "link": "https://stackoverflow.com/questions/44650925/extract-data-after-matching-pattern-in-ruby/44651393#44651393", "title": "Extract data after matching pattern in ruby", "body": "<p>Change your groups assign line to this:</p>\n\n<pre><code>groups = myvalue[1].partition(/\\[Roll\\]/).last\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "edited": false, "score": 0, "creation_date": 1497957593, "post_id": 44651403, "comment_id": 76288166, "body": "Thanks that did the trick. I&#39;m sorry its an addition to my asked question.Any idea how to split based on the delimiter = and get the values as an array below  <code>first_arr = [&quot;new line&quot;, &quot;check_that&quot;, &quot;stares &quot;]</code>  <code>second_arr = [its corresponding splitted values]</code>"}, {"owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "reply_to_user": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "edited": false, "score": 1, "creation_date": 1497959205, "post_id": 44651403, "comment_id": 76289437, "body": "@voltas <code>first_arr = split(&quot;=&quot;)[0]; second+arr = split(&quot;=&quot;)[1];</code>"}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "edited": false, "score": 0, "creation_date": 1497961560, "post_id": 44651403, "comment_id": 76291138, "body": "@RamonMarques :  thanks for the suggestion but, I&#39;m getting only the first value i.e <code>new line</code> instead of <code>[&quot;new line&quot;, &quot;check_that&quot;, &quot;stares &quot;]</code>  On printing second_array, i get as ` this is new line content  check_that`"}, {"owner": {"reputation": 2408, "user_id": 3100462, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/1566955386/picture?type=large", "display_name": "Ramon Marques", "link": "https://stackoverflow.com/users/3100462/ramon-marques"}, "reply_to_user": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "edited": false, "score": 0, "creation_date": 1497962367, "post_id": 44651403, "comment_id": 76291765, "body": "@voltas actually make another question"}, {"owner": {"reputation": 6015, "user_id": 390808, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a0f6edad668a0b63171eeb2a8aea39cd?s=128&d=identicon&r=PG", "display_name": "Sven Koschnicke", "link": "https://stackoverflow.com/users/390808/sven-koschnicke"}, "edited": false, "score": 1, "creation_date": 1497962522, "post_id": 44651403, "comment_id": 76291904, "body": "It seems you are trying to parse an INI-file. You could use a library for that: <a href=\"https://github.com/twp/inifile\" rel=\"nofollow noreferrer\">github.com/twp/inifile</a>"}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 6015, "user_id": 390808, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a0f6edad668a0b63171eeb2a8aea39cd?s=128&d=identicon&r=PG", "display_name": "Sven Koschnicke", "link": "https://stackoverflow.com/users/390808/sven-koschnicke"}, "edited": false, "score": 0, "creation_date": 1497963093, "post_id": 44651403, "comment_id": 76292387, "body": "@SvenKoschnicke : Its an unorganized input file, but will give a try using ini parser. Thanks for your time. +1 for the inifile option"}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "edited": false, "score": 0, "creation_date": 1497965333, "post_id": 44651403, "comment_id": 76294126, "body": "@voltas : glad to help you"}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": true, "score": 1, "last_activity_date": 1497962472, "last_edit_date": 1497962472, "creation_date": 1497956934, "answer_id": 44651403, "question_id": 44650925, "link": "https://stackoverflow.com/questions/44650925/extract-data-after-matching-pattern-in-ruby/44651403#44651403", "title": "Extract data after matching pattern in ruby", "body": "<pre><code>&gt; string = \"String begins here\n[Roll]\nnew line = this is new line content\ncheck_that = check that line content\nstares = stares content\"\n\n&gt; required_string = string.split(\"[Roll]\").last.strip\n# new line = this is new line content\n# check_that = check that line content\n# stares = stares content\n</code></pre>\n\n<h2>Update:</h2>\n\n<pre><code>&gt; first_arry = required_string.split(\"\\n\").map{|e| e.split(\"=\")}.map(&amp;:first)\n#=&gt; [\"new line \", \"check_that \", \"stares \"] \n&gt; second_arry = required_string.split(\"\\n\").map{|e| e.split(\"=\")}.map(&amp;:last)\n#=&gt; [\" this is new line content\", \" check that line content\", \" stares content\"] \n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 44651403, "answer_count": 2, "score": 0, "last_activity_date": 1497962472, "creation_date": 1497955546, "last_edit_date": 1497957558, "question_id": 44650925, "link": "https://stackoverflow.com/questions/44650925/extract-data-after-matching-pattern-in-ruby", "title": "Extract data after matching pattern in ruby", "body": "<p><code>puts myvalue[1]</code> (my value is a String)</p>\n\n<pre><code>#My COmments\n#Checked on 54\n[Roll]\nnew line = see, that, cfiu\\poli\ncheck_that = roll\\uiju, rolldeny that, its=oik, mao\\ikir4\nstares = roll\\okik, roll\\asde4, roll\\kz98e\n</code></pre>\n\n<p>I'm trying to extract after Roll and assign in to an array</p>\n\n<pre><code>groups = myvalue[1].match(/^[Roll].*/)\n</code></pre>\n\n<p>Output I got </p>\n\n<pre><code>new line = see that cfiu\\poli\n</code></pre>\n\n<p>instead of (expected one)</p>\n\n<pre><code>new line = see that cfiu\\poli\ncheck_that = roll\\uiju, rolldeny that, its=oik, mao\\ikir4\nstares = roll\\okik, roll\\asde4, roll\\kz98e\n</code></pre>\n\n<p>How to do it, thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "authentication", "mongoid"], "comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1497960144, "post_id": 44650806, "comment_id": 76290143, "body": "try this <a href=\"https://stackoverflow.com/questions/35985762/operationfailure-not-authorized-on-tracking-to-execute-command\" title=\"operationfailure not authorized on tracking to execute command\">stackoverflow.com/questions/35985762/&hellip;</a>"}, {"owner": {"reputation": 335, "user_id": 5777214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5ab9a8c48da1c8fccc4808f8397929?s=128&d=identicon&r=PG&f=1", "display_name": "mestarted", "link": "https://stackoverflow.com/users/5777214/mestarted"}, "edited": false, "score": 0, "creation_date": 1497980427, "post_id": 44650806, "comment_id": 76304587, "body": "this link can also be helpful <a href=\"https://stackoverflow.com/questions/4881208/how-to-secure-mongodb-with-username-and-password#answer-42929869\" title=\"how to secure mongodb with username and password%23answer 42929869\">stackoverflow.com/questions/4881208/&hellip;</a>"}], "owner": {"reputation": 41, "user_id": 4502603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V7v3J.gif?s=128&g=1", "display_name": "Kavs", "link": "https://stackoverflow.com/users/4502603/kavs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 552, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497955193, "creation_date": 1497955193, "question_id": 44650806, "link": "https://stackoverflow.com/questions/44650806/mongoid-authentication-issue-in-ruby-on-rails", "title": "Mongoid Authentication issue in Ruby on rails", "body": "<p>I am creating an application using ruby and mongoid. But when I try to create or find a document in any collection using mongoid, i am getting this error </p>\n\n<pre>\nMongo::Error::OperationFailure (not authorized on employee_production to execute command { find: \"devices\", filter: { token: null } } (13))</pre>\n\n<p>I have enabled authentication in /etc/mongod.conf and added username and password to mongoid.yml to authenticate mongodb connection. </p>\n\n<pre>\ndevelopment: \n  clients:    \n    default:\n      database: employee     \n      hosts:\n        - localhost:27017\n      options:       \n        user: 'grapewine'\n        password: '@)90GTWqks*'\n        roles:\n          - 'dbOwner'\n        auth_mech: :scram\n        auth_source: admin\n        connect: :direct\n</pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1497953760, "post_id": 44650137, "comment_id": 76285443, "body": "<i>sums up all tasks</i> You mean <code>count</code>?"}, {"owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "edited": false, "score": 0, "creation_date": 1497954169, "post_id": 44650137, "comment_id": 76285702, "body": "Do you mean to sum tasks for the current group?"}, {"owner": {"reputation": 31, "user_id": 4646312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972a4cc5a1f9c163c534f1f08f1cfe5c?s=128&d=identicon&r=PG&f=1", "display_name": "Pigius", "link": "https://stackoverflow.com/users/4646312/pigius"}, "edited": false, "score": 0, "creation_date": 1497960954, "post_id": 44650137, "comment_id": 76290718, "body": "I mean sum point from task for the current group :)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4646312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972a4cc5a1f9c163c534f1f08f1cfe5c?s=128&d=identicon&r=PG&f=1", "display_name": "Pigius", "link": "https://stackoverflow.com/users/4646312/pigius"}, "edited": false, "score": 0, "creation_date": 1497962271, "post_id": 44650346, "comment_id": 76291692, "body": "How to modify it, to work for each group ? When I use this method above, it will show the same amount for every group, no matter if they have done they task or not ?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 31, "user_id": 4646312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972a4cc5a1f9c163c534f1f08f1cfe5c?s=128&d=identicon&r=PG&f=1", "display_name": "Pigius", "link": "https://stackoverflow.com/users/4646312/pigius"}, "edited": false, "score": 0, "creation_date": 1497975855, "post_id": 44650346, "comment_id": 76301985, "body": "@Pigius you need to use <code>group</code> method"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1497954527, "last_edit_date": 1497954527, "creation_date": 1497954022, "answer_id": 44650346, "question_id": 44650137, "link": "https://stackoverflow.com/questions/44650137/method-that-sums-up-all-values-from-references-model-rails/44650346#44650346", "title": "Method that sums up all values from references model rails", "body": "<p><s>If you meant to <em>Sum of all tasks based on <code>point</code> for each group</em></s> If you are trying to <em>get the <strong>sum of points</strong> for all tasks of each group</em>, then you can do</p>\n\n<pre><code>Task.includes(:group).where(\"state = ?\", 'done').sum(:point)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4646312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972a4cc5a1f9c163c534f1f08f1cfe5c?s=128&d=identicon&r=PG&f=1", "display_name": "Pigius", "link": "https://stackoverflow.com/users/4646312/pigius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1497999281, "accepted_answer_id": 44650346, "answer_count": 1, "score": 0, "last_activity_date": 1497954527, "creation_date": 1497953456, "question_id": 44650137, "link": "https://stackoverflow.com/questions/44650137/method-that-sums-up-all-values-from-references-model-rails", "closed_reason": "Needs details or clarity", "title": "Method that sums up all values from references model rails", "body": "<p>I have two models: </p>\n\n<p>Group and Task (has name:string, point:integer, state:string (to_do,in_progress, done),group_id:integer)</p>\n\n<p>Group has_many :tasks, and Task belongs_to Group. </p>\n\n<p>I would like to write a method that sums up all tasks which has state:done for each group.</p>\n\n<p>I tried to write it:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n has_many :users\n has_many :tasks\n accepts_nested_attributes_for :users, allow_destroy: true\n has_one :grade\n\n\n def amount_of_points\n  amount = Object.tasks.point.where(state:\"done\")\n  amount\n\n end\nend\n</code></pre>\n\n<p>But it wont work. How to handle it ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 1489, "user_id": 3628383, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZZsDD.png?s=128&g=1", "display_name": "Jaeger", "link": "https://stackoverflow.com/users/3628383/jaeger"}, "edited": false, "score": 0, "creation_date": 1497953629, "post_id": 44649946, "comment_id": 76285357, "body": "This might help you : <a href=\"https://stackoverflow.com/questions/14355767/how-to-add-parameters-in-url-of-ruby-on-rails\" title=\"how to add parameters in url of ruby on rails\">stackoverflow.com/questions/14355767/&hellip;</a>"}, {"owner": {"reputation": 1041, "user_id": 6403303, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f95b19e307dd58f82eb71f7698e2ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/6403303/oliver"}, "reply_to_user": {"reputation": 1489, "user_id": 3628383, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZZsDD.png?s=128&g=1", "display_name": "Jaeger", "link": "https://stackoverflow.com/users/3628383/jaeger"}, "edited": false, "score": 0, "creation_date": 1497953991, "post_id": 44649946, "comment_id": 76285575, "body": "I&#39;m not sure if this helps. I mean I know how to use params. My problem is that I don&#39;t know how to pass these to a new controller after sign in with devise."}, {"owner": {"reputation": 1489, "user_id": 3628383, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZZsDD.png?s=128&g=1", "display_name": "Jaeger", "link": "https://stackoverflow.com/users/3628383/jaeger"}, "edited": false, "score": 0, "creation_date": 1497954844, "post_id": 44649946, "comment_id": 76286157, "body": "i apologize, I don&#39;t have a RoR project that I can test with me, but what happens if you do the following? (in the application controller, i suppose) <code>def after_sign_in_path root_path, token_value =&gt; &#39;your data&#39; end</code>"}, {"owner": {"reputation": 1041, "user_id": 6403303, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f95b19e307dd58f82eb71f7698e2ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/6403303/oliver"}, "reply_to_user": {"reputation": 1489, "user_id": 3628383, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZZsDD.png?s=128&g=1", "display_name": "Jaeger", "link": "https://stackoverflow.com/users/3628383/jaeger"}, "edited": false, "score": 0, "creation_date": 1497955504, "post_id": 44649946, "comment_id": 76286641, "body": "in this case nothing happens. that&#39;s exactly my problem: once devise executes the sign in it redirects but the param is gone. so i cannot use it in the after_sign_in_path method."}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1497961219, "post_id": 44649946, "comment_id": 76290890, "body": "I think you can pass extra params in your path. Just add the extra params into brackets: root_path(mytoken: value). then retrieve it as usual: params[:mytoken] inside the targeted controller action"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1497962008, "post_id": 44649946, "comment_id": 76291486, "body": "Ok passing as hidden field is good too. but why do you try to retrieve a param inside your view ?? <code>:value =&gt; params[:token_value]</code> is not correct.  You can retrieve params in controller only, when form is submitted. Moreover what token are you looking for ? The token that is used to confirm acount ?"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 8024742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c17c4540a05e910bd86eda51b0c5f01a?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Shrivastava", "link": "https://stackoverflow.com/users/8024742/ravi-shrivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1497966752, "creation_date": 1497966752, "answer_id": 44655031, "question_id": 44649946, "link": "https://stackoverflow.com/questions/44649946/rails-devise-pass-param-after-sign-in/44655031#44655031", "title": "Rails/Devise: pass param after sign_in", "body": "<p>if you have specific url for that controller/action then below code will work</p>\n\n<pre><code>def after_sign_in_path_for(current_user)\n  specific_url(token: params[\"user\"][\"token\"])\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 2770433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JrXcp.jpg?s=128&g=1", "display_name": "andrewhaines", "link": "https://stackoverflow.com/users/2770433/andrewhaines"}, "is_accepted": false, "score": 2, "last_activity_date": 1505702050, "creation_date": 1505702050, "answer_id": 46270809, "question_id": 44649946, "link": "https://stackoverflow.com/questions/44649946/rails-devise-pass-param-after-sign-in/46270809#46270809", "title": "Rails/Devise: pass param after sign_in", "body": "<p>I was facing a similar, if not identical, problem trying to pass params from a Devise registration form through the default auto-login via <code>after_sign_in_path_for(resource)</code>. The goal was to route a new user to the page from which they had originally clicked the \"Sign up\" button. (It's an events app, and the user should be sourced back to the event they came to sign up for.)</p>\n\n<p>I got it working by including a hidden form field as you did, and making sure it was permitted by including this in my ApplicationController:</p>\n\n<pre><code>def configure_permitted_parameters\n  devise_parameter_sanitizer.permit(:sign_up, keys: [:event_token])\nend\n</code></pre>\n\n<p>Then I just referenced <code>resource.event_token</code> in the <code>after_sign_in_path_for(resource)</code> block:</p>\n\n<pre><code>def after_sign_in_path_for(resource)\n  if resource.event_token\n    event_path(Event.find_by(token: resource.event_token))\n  else\n    user_path(resource)\n  end\nend\n</code></pre>\n\n<p>So if a user signs in with an event token, it fires; if not, it doesn't.</p>\n\n<p>I imagine you could do the same thing with <code>resource.token</code> to pass your params forward inside the path helper.</p>\n"}], "owner": {"reputation": 1041, "user_id": 6403303, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f95b19e307dd58f82eb71f7698e2ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/6403303/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1338, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1505702050, "creation_date": 1497952969, "last_edit_date": 1497954062, "question_id": 44649946, "link": "https://stackoverflow.com/questions/44649946/rails-devise-pass-param-after-sign-in", "title": "Rails/Devise: pass param after sign_in", "body": "<p>In my app I use Devise for authentication. Users can be invited to <strong>sign_in</strong> to the app through a link that has a token attached as a param.</p>\n\n<p>The link looks e. g. like this:</p>\n\n<pre><code>https://chaos-jadz.c9users.io/tokens/?token_value=88042c1c-822e-4e80-b911-3c25a41fdc3f\n</code></pre>\n\n<p>At the moment once a user signs in the app redirects to the root path. </p>\n\n<p>What I want to do now is: once a user signs in and if token_value is present then I want the app to redirect to a specific controller/action with the token as param. </p>\n\n<p>I'm aware of the after_sign_in_path method Devise provides. Redirecting after sign_in to my specified controller/action is no problem. However I am not aware how to pass the param token_value also to the controller/action. </p>\n\n<p>This is my sign_in form (I am using the param here as a hidden field):</p>\n\n<pre><code>&lt;div class=\"panel panel-default devise-bs\" style=\"font-family:arial\"&gt;\n    &lt;div class=\"panel-heading\"&gt;\n      &lt;h4&gt;&lt;%= t('.sign_in', default: 'Sign in') %&gt;&lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div class=\"panel-body\"&gt;\n      &lt;%= form_for(resource, as: resource_name, url: session_path(resource_name), html: { role: 'form' }) do |f| %&gt;\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :spielername %&gt;\n          &lt;%= f.text_field :username, autofocus: true, class: 'form-control', placeholder: \"player101\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :password %&gt;\n          &lt;%= f.password_field :password, autocomplete: 'off', class: 'form-control' %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.hidden_field :token, :value =&gt; params[:token_value], class: 'form-control' %&gt;\n        &lt;/div&gt;\n        &lt;% if devise_mapping.rememberable? %&gt;\n          &lt;div class=\"checkbox\"&gt;\n            &lt;%= f.label :remember_me do %&gt;\n              &lt;%= f.check_box :remember_me %&gt; &lt;%= t('.remember_me', default: 'Remember me') %&gt;\n            &lt;% end %&gt;\n          &lt;/div&gt;\n        &lt;% end %&gt;\n        &lt;%= f.submit  t('.sign_in', default: 'Sign in'), class: 'btn btn-primary' %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"col-xs-12 shared-links\"&gt;\n    &lt;%= render 'devise/shared/links' %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>Can you help?</p>\n"}, {"tags": ["ruby", "algorithm", "recursion", "multidimensional-array", "tostring"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1497954940, "post_id": 44649910, "comment_id": 76286222, "body": "I actually believe that you just want to override <code>Person#to_s</code> to return <code>&quot;Student #{self.name}&quot;</code> string."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1497953499, "post_id": 44649968, "comment_id": 76285247, "body": "Or <code>object.map { |o| my_to_s(o) }</code> to avoid the monkey patching."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497953564, "post_id": 44649968, "comment_id": 76285299, "body": "And you probably want to surround the nested output with <code>&#39;[&#39;</code> and <code>&#39;]&#39;</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497953710, "post_id": 44649968, "comment_id": 76285414, "body": "@Stefan indeed, thanks, I have updated the answer (for both monkeypatched version and external method.)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497953877, "post_id": 44649968, "comment_id": 76285513, "body": "For more object oriented approach, you could alias <code>my_to_s</code> to <code>to_s</code> for <code>Object</code> and override it in <code>Enumerable</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497955017, "post_id": 44649968, "comment_id": 76286293, "body": "This is weird: for some reason, <code>alias_method  :my_to_s, :to_s</code> (or <code>alias  my_to_s to_s</code>) does not work, whereas <code>def my_to_s; to_s; end</code> does."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497955162, "post_id": 44649968, "comment_id": 76286406, "body": "@Stefan <code>alias_method</code> works for me. <code>class Object; alias_method :my_to_s, :to_s; end; 5.my_to_s</code> \u21d2 <code>&quot;#&lt;Fixnum:0x0000000000000b&gt;&quot;</code>. Ah! It works, but it strictly maps to <code>Object#to_s</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1497955330, "post_id": 44649968, "comment_id": 76286518, "body": "@Stefan yes, it looks like the polymorphism is broken and it just produces a \u201chardlink\u201d to <code>Object#to_s</code>. Funny."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1497955258, "last_edit_date": 1497955258, "creation_date": 1497953039, "answer_id": 44649968, "question_id": 44649910, "link": "https://stackoverflow.com/questions/44649910/implement-to-s-of-array-in-ruby/44649968#44649968", "title": "Implement to_s of Array in Ruby", "body": "<p>For nested elements it just calls <code>to_s</code> respectively:</p>\n\n<pre><code>def my_to_s\n  case self\n  when Enumerable then '[' &lt;&lt; map(&amp;:my_to_s).join(', ') &lt;&lt; ']'\n  else \n    to_s # or my own implementation\n  end\nend\n</code></pre>\n\n<p>This is a contrived example, that nearly works, if this <code>my_to_s</code> method is defined on the very <code>BasicObject</code>.</p>\n\n<hr>\n\n<p>As suggested by Stefan, one might avoid monkeypathing:</p>\n\n<pre><code>def my_to_s(object)\n  case object\n  when Enumerable then '[' &lt;&lt; object.map { |e| my_to_s(e) }.join(', ') &lt;&lt; ']'\n  else \n    object.to_s # or my own implementation\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>More OO approach:</p>\n\n<pre><code>class Object\n  def my_to_s; to_s; end\nend\n\nclass Enumerable\n  def my_to_s\n    '[' &lt;&lt; map(&amp;:my_to_s).join(', ') &lt;&lt; ']'\n  end\nend\n\nclass Person\n  def my_to_s\n    \"Student #{name}\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1217, "user_id": 6397805, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/882480008529203/picture?type=large", "display_name": "Huy Tran", "link": "https://stackoverflow.com/users/6397805/huy-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 44649968, "answer_count": 1, "score": 0, "last_activity_date": 1497955258, "creation_date": 1497952865, "question_id": 44649910, "link": "https://stackoverflow.com/questions/44649910/implement-to-s-of-array-in-ruby", "title": "Implement to_s of Array in Ruby", "body": "<p>Ruby's Array class has the built-in method to_s that can turn the array into a string. This method also works with multidimensional array. How is this method implemented? </p>\n\n<p>I want to know about it, so I can reimplement a method <strong>my_to_s(ary)</strong> that can take in a multidimensional and turn it to a string. But instead of returning a string representation of the object like this </p>\n\n<pre><code>[[[1,2,3, Person.new('Mary')]],[4,5,6,7], Person.new('Paul'),2,3,8].to_s\n# [[[1, 2, 3, #&lt;Person:0x283fec0 @name='Mary']], [4, 5, 6, 7], #&lt;Person:0x283fe30 @name='Paul'&gt;, 2, 3, 8]   \n</code></pre>\n\n<p><strong>my_to_s(ary)</strong> should call the to_s method on these objects, so that it returns </p>\n\n<pre><code>my_to_s([[[1,2,3, Person.new('Mary')]],[4,5,6,7], Person.new('Paul'),2,3,8])\n# [[[1, 2, 3, Student Mary]], [4, 5, 6, 7], Student Paul&gt;, 2, 3, 8]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "paperclip"], "comments": [{"owner": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1497979332, "post_id": 44649845, "comment_id": 76303975, "body": "Not sure what version of <code>paperclip</code> you are using but you should check since: <code>Paperclip now requires Ruby version &gt;= 2.1 and Rails version &gt;= 4.2 (only if you&#39;re going to use Paperclip with Ruby on Rails.)</code> (from <a href=\"https://github.com/thoughtbot/paperclip#requirements\" rel=\"nofollow noreferrer\">github.com/thoughtbot/paperclip#requirements</a>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5923919"}, "reply_to_user": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1498114762, "post_id": 44649845, "comment_id": 76367784, "body": "@jdgray I use version 4.2. This bug related with spoof."}, {"owner": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1498147582, "post_id": 44649845, "comment_id": 76391827, "body": "Oh okay your question said <code>4.1.1 -&gt; 4.1.16</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5923919"}, "reply_to_user": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1498204059, "post_id": 44649845, "comment_id": 76413953, "body": "@jdgray sorry, my rails version <code>4.1.6</code> Paperclip version <code>4.2</code>. I think that you meant paperclip version."}, {"owner": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "edited": false, "score": 0, "creation_date": 1498235679, "post_id": 44649845, "comment_id": 76434754, "body": "Your question specifically says: &quot;update of rails 4.1.1 -&gt; 4.1.16&quot;...."}], "owner": {"user_type": "does_not_exist", "display_name": "user5923919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498118248, "creation_date": 1497952675, "last_edit_date": 1498118248, "question_id": 44649845, "link": "https://stackoverflow.com/questions/44649845/error-when-upload-images-documents-via-paperclip-has-an-extension-that-does-no", "title": "Error when upload images/documents via Paperclip: &quot;has an extension that does not match its contents&quot;", "body": "<p>I ran into the error that when I upload images to S3 via Paperclip, I get an error: <code>has an extension that does not match its contents</code>. On a local machine, I do not experience such problems, only for production. This was observed after the update of rails <code>4.1.1 -&gt; 4.1.16</code> and ruby <code>2.1.5 -&gt; 2.3.1</code> and changing the instance to AWS.</p>\n\n<p>Here is my validation:</p>\n\n<pre><code>validates_attachment    :document,\n                        content_type: { not: \"application/x-msdownload\" }\n</code></pre>\n\n<p>I do not understand what the problem is. Any file I upload, whether it's an image or a document (any extension) gets this error. Tell me please, with what it can be connected?</p>\n\n<p><strong>UPD</strong></p>\n\n<p>I found in log this: </p>\n\n<pre><code>[paperclip] Content Type Spoof: Filename example1.png ([\"image/png\"]), content type discovered from file command: . See documentation to allow this combination.\n</code></pre>\n\n<p><strong>UPD 2</strong></p>\n\n<p><a href=\"https://stackoverflow.com/a/21912537/5923919\">This</a> solved my problem</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1497950657, "post_id": 44648903, "comment_id": 76283044, "body": "please share error track trace?"}, {"owner": {"reputation": 55, "user_id": 8187579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4d8b58b8011853a050c777c624d602a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sts", "link": "https://stackoverflow.com/users/8187579/sts"}, "reply_to_user": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1497950763, "post_id": 44648903, "comment_id": 76283118, "body": "@NarasimhaReddy updated"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1497971426, "post_id": 44648903, "comment_id": 76298994, "body": "Can you provide the whole test file, I&#39;ve tested your code and it works, which Rails, Ruby and RSpec version?"}], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 4461539, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P1gw5q8RY4Y/AAAAAAAAAAI/AAAAAAAAAO8/vbF-z9SZp44/photo.jpg?sz=128", "display_name": "moyinho20", "link": "https://stackoverflow.com/users/4461539/moyinho20"}, "reply_to_user": {"reputation": 55, "user_id": 8187579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4d8b58b8011853a050c777c624d602a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sts", "link": "https://stackoverflow.com/users/8187579/sts"}, "edited": false, "score": 0, "creation_date": 1497958549, "post_id": 44649392, "comment_id": 76288909, "body": "Did you try using <code>&#39;&#47;accounts&#39;</code> in scope?"}, {"owner": {"reputation": 55, "user_id": 8187579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4d8b58b8011853a050c777c624d602a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sts", "link": "https://stackoverflow.com/users/8187579/sts"}, "edited": false, "score": 0, "creation_date": 1497961389, "post_id": 44649392, "comment_id": 76291017, "body": "why i should try it?"}, {"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 1, "creation_date": 1497992518, "post_id": 44649392, "comment_id": 76311535, "body": "I think You need get :index, scope: &#39;/accounts&#39; . But like @moyinho20 suggested You should use instead Resources. And instead of asking &#39;why i should try it? &#39; ...You should instead think of the cons/pros for each suggestion. And instead of saying &#39;i just support it&#39; ...maybe You should try and improve the code. If someone for your team wrote code that is hard to maintain instead of leaving it like that You should always try and improve the code because even If You ignore it now chances are that You will have to come Back to same line again in the future."}, {"owner": {"reputation": 515, "user_id": 4461539, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P1gw5q8RY4Y/AAAAAAAAAAI/AAAAAAAAAO8/vbF-z9SZp44/photo.jpg?sz=128", "display_name": "moyinho20", "link": "https://stackoverflow.com/users/4461539/moyinho20"}, "reply_to_user": {"reputation": 55, "user_id": 8187579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4d8b58b8011853a050c777c624d602a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sts", "link": "https://stackoverflow.com/users/8187579/sts"}, "edited": false, "score": 0, "creation_date": 1498033335, "post_id": 44649392, "comment_id": 76325511, "body": "@Sts because it might work?  Else I&#39;m not sure what exactly do you want to fix. I can&#39;t think of any improvement to my answer.  Thanks!"}], "tags": [], "owner": {"reputation": 515, "user_id": 4461539, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P1gw5q8RY4Y/AAAAAAAAAAI/AAAAAAAAAO8/vbF-z9SZp44/photo.jpg?sz=128", "display_name": "moyinho20", "link": "https://stackoverflow.com/users/4461539/moyinho20"}, "is_accepted": false, "score": 0, "last_activity_date": 1497951660, "creation_date": 1497951660, "answer_id": 44649392, "question_id": 44648903, "link": "https://stackoverflow.com/questions/44648903/rspec-no-route-matches-in-controller-spec/44649392#44649392", "title": "Rspec No route matches in controller spec", "body": "<p>You can get it to work by changing routes to:</p>\n\n<pre><code> scope '/accounts' do\n   get '/' =&gt; 'accounts#index', as: :account\n end \n</code></pre>\n\n<p>Im curious though, if <code>Account</code> is a resource, why wouldn't you declare an accounts as a resource: </p>\n\n<pre><code> resource :accounts, :only =&gt; [:show, :index] \n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8187579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4d8b58b8011853a050c777c624d602a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sts", "link": "https://stackoverflow.com/users/8187579/sts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 545, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497971786, "creation_date": 1497950433, "last_edit_date": 1497971786, "question_id": 44648903, "link": "https://stackoverflow.com/questions/44648903/rspec-no-route-matches-in-controller-spec", "title": "Rspec No route matches in controller spec", "body": "<p>I have a route:</p>\n\n<pre><code>scope '/account' do\n  get '/' =&gt; 'accounts#index', as: :account\nend \n</code></pre>\n\n<p>And I want to test it with RSpec:</p>\n\n<pre><code>describe AccountsController, type: :controller do\n  it 'renders the index template' do\n    get :index\n    expect(response.status).to eq(200)\n    expect(response).to render_template :index\n  end\nend \n</code></pre>\n\n<p>But I have got:</p>\n\n<blockquote>\n  <p>ActionController::UrlGenerationError: No route matches</p>\n</blockquote>\n\n<p>How to fix it?</p>\n\n<p>The full trace:</p>\n\n<pre><code>[11] pry(#&lt;RSpec::ExampleGroups::AccountsController&gt;)&gt; get :index\nActionController::UrlGenerationError: No route matches {:action=&gt;\"index\", :controller=&gt;\"accounts\"}\nfrom /home/rubydev/.rvm/gems/ruby-2.2.1/gems/actionpack-4.2.5/lib/action_dispatch/journey/formatter.rb:46:in `generate'\n</code></pre>\n"}, {"tags": ["ruby", "methods", "yield"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1497951247, "post_id": 44648848, "comment_id": 76283508, "body": "You wrote that you have such method, but after all, it seems you don&#39;t have such method."}, {"owner": {"reputation": 2632, "user_id": 1425848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OMoJ7.png?s=128&g=1", "display_name": "garyh", "link": "https://stackoverflow.com/users/1425848/garyh"}, "edited": false, "score": 0, "creation_date": 1497951415, "post_id": 44648848, "comment_id": 76283642, "body": "can you show us the code in your method myFilter?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1497961536, "post_id": 44648848, "comment_id": 76291120, "body": "You are aware that <code>myfilter(arr) { ... }</code> is equivalent to <code>arr.select { ... }</code>, aren&#39;t you?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1497962044, "post_id": 44648848, "comment_id": 76291516, "body": "If you want us to tell you how to modify your method, you should probably show us your method."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "is_accepted": false, "score": 0, "last_activity_date": 1497950640, "creation_date": 1497950640, "answer_id": 44648984, "question_id": 44648848, "link": "https://stackoverflow.com/questions/44648848/how-can-i-modify-my-ruby-method-so-it-takes-in-a-block-of-code-as-well/44648984#44648984", "title": "How can I modify my ruby method so it takes in a block of code as well?", "body": "<p>you can do</p>\n\n<pre><code>def my_filter(arr, &amp;block)\n  arr.select(&amp;block)\nend\n</code></pre>\n\n<p>then call</p>\n\n<pre><code>my_filter([1, 2, 3]) { |e| e &gt; 2 }\n=&gt; [3]\n</code></pre>\n\n<p>but instead you can just call <code>select</code> with a block directly :)</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1497952493, "post_id": 44649090, "comment_id": 76284498, "body": "The good practice is to supply <code>return enum_for(:myfilter, *args) unless block_given?</code> for this method to be able to be called without a block (lazy.)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 3, "last_activity_date": 1497950896, "creation_date": 1497950896, "answer_id": 44649090, "question_id": 44648848, "link": "https://stackoverflow.com/questions/44648848/how-can-i-modify-my-ruby-method-so-it-takes-in-a-block-of-code-as-well/44649090#44649090", "title": "How can I modify my ruby method so it takes in a block of code as well?", "body": "<p>I take for granted you don't want to use <code>select</code> method or similar but you want to understand how blocks work.</p>\n\n<pre><code>def my_filter(arr)\n  if block_given?\n    result = []\n    arr.each { |element| result.push(element) if yield element } # here you use the block passed to this method and execute it with the current element using yield\n    result\n  else\n    arr\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1497961577, "last_edit_date": 1497961577, "creation_date": 1497952629, "answer_id": 44649824, "question_id": 44648848, "link": "https://stackoverflow.com/questions/44648848/how-can-i-modify-my-ruby-method-so-it-takes-in-a-block-of-code-as-well/44649824#44649824", "title": "How can I modify my ruby method so it takes in a block of code as well?", "body": "<p>The idiomatic way would be:</p>\n\n<pre><code>def my_filter(arr)\n  return enum_for(:my_filter, arr) unless block_given?\n\n  arr.each_with_object([]) do |e, acc|\n    acc &lt;&lt; e if yield e\n  end\nend\n</code></pre>\n\n<p>More info on <a href=\"https://ruby-doc.org/core-2.1.2/Enumerator/Lazy.html#method-i-enum_for\" rel=\"nofollow noreferrer\"><code>Enumerator::Lazy#enum_for</code></a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 8161732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f2f72f93da9d9f203bf51db82f1bf1?s=128&d=identicon&r=PG&f=1", "display_name": "EaEaEa", "link": "https://stackoverflow.com/users/8161732/eaeaea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1497961878, "creation_date": 1497950292, "question_id": 44648848, "link": "https://stackoverflow.com/questions/44648848/how-can-i-modify-my-ruby-method-so-it-takes-in-a-block-of-code-as-well", "title": "How can I modify my ruby method so it takes in a block of code as well?", "body": "<p>I have a method called myFilter that takes in an array, and filters out the elements that don't meet the requirement.</p>\n\n<p>For example.</p>\n\n<pre><code>arr = [4,5,8,9,1,3,6]\n\nanswer = myfilter(arr) {|i| i&gt;=5}\n</code></pre>\n\n<p>this run would return an array with elements 5,8,9,6 since they are all greater than or equal to 5. </p>\n\n<p>How would I preform this? the algorithm is easy, but I don't understand how we take in that condition.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "salesforce", "restforce"], "comments": [{"owner": {"reputation": 342, "user_id": 1225367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4573015d12bee8990282ff17f4695684?s=128&d=identicon&r=PG", "display_name": "gillien", "link": "https://stackoverflow.com/users/1225367/gillien"}, "edited": false, "score": 0, "creation_date": 1504858453, "post_id": 44648371, "comment_id": 79185803, "body": "Did you figure out what the problem was? I have got the same problem."}, {"owner": {"reputation": 342, "user_id": 1225367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4573015d12bee8990282ff17f4695684?s=128&d=identicon&r=PG", "display_name": "gillien", "link": "https://stackoverflow.com/users/1225367/gillien"}, "edited": false, "score": 0, "creation_date": 1504859516, "post_id": 44648371, "comment_id": 79186401, "body": "I identified the issue on my side : it was IP Relation settings issue."}, {"owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "reply_to_user": {"reputation": 342, "user_id": 1225367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4573015d12bee8990282ff17f4695684?s=128&d=identicon&r=PG", "display_name": "gillien", "link": "https://stackoverflow.com/users/1225367/gillien"}, "edited": false, "score": 0, "creation_date": 1515749805, "post_id": 44648371, "comment_id": 83428020, "body": "Problem was on Salesforce side. App was configured incorrectly."}], "owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 843, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497949000, "creation_date": 1497949000, "question_id": 44648371, "link": "https://stackoverflow.com/questions/44648371/getting-invalid-grant-authentication-failure", "title": "Getting invalid_grant: authentication failure", "body": "<p>I try to connect to salesforce via restforce gem. I use next:</p>\n\n<pre><code>client = Restforce.new(username: 'user@name.com',\n                           password: 'my_password',\n                           client_id: 'Consumer_Key',\n                           client_secret: 'Consumer_Secret',\n                           security_token: 'security_token',\n                           api_version: '38.0',\n                           grant_type: 'password',\n                           ssl: {version: 'TLSv1'})\ncontacts = client.query(\"select ID__c from Contacts where Name = 'Lorem Ipsum'\")\nputs contacts.first\n</code></pre>\n\n<p>When I try to execute it I'm getting next error:\n<code>'authenticate!': invalid_grant: authentication failure (Restforce::AuthenticationError)</code></p>\n\n<p>In salesforce app I set:</p>\n\n<ul>\n<li>Permitted Users: <em>All users may self-authorize</em>.</li>\n<li>IP Relaxation: <em>Relax IP restrictions</em>.</li>\n</ul>\n\n<p>Checked with enabled and disabled OAuth.</p>\n\n<p>Also I've tried with simple configuration:</p>\n\n<pre><code>client = Restforce.new(username: 'user@name.com',\n                       password: 'my_password',\n                       client_id: 'Consumer_Key',\n                       client_secret: 'Consumer_Secret',\n                       api_version: '38.0',)\n</code></pre>\n\n<p>But got the same error</p>\n\n<p>Valid credentials for salesforce were specified.</p>\n\n<p>What I did wrong?</p>\n"}, {"tags": ["ruby", "shell"], "comments": [{"owner": {"reputation": 64845, "user_id": 2088135, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YB10Q.jpg?s=128&g=1", "display_name": "Tom Fenech", "link": "https://stackoverflow.com/users/2088135/tom-fenech"}, "edited": false, "score": 1, "creation_date": 1497948835, "post_id": 44647916, "comment_id": 76281625, "body": "Remember that every time you&#39;re executing a system command, you&#39;re doing so in a separate subshell. I guess that in a lot of cases, a script which requires elevated permissions would be run with sudo, e.g. <code>sudo script.rb</code>, rather than trying to do something within the script."}, {"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "reply_to_user": {"reputation": 64845, "user_id": 2088135, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YB10Q.jpg?s=128&g=1", "display_name": "Tom Fenech", "link": "https://stackoverflow.com/users/2088135/tom-fenech"}, "edited": false, "score": 0, "creation_date": 1497952349, "post_id": 44647916, "comment_id": 76284379, "body": "I strongly advise against this. This would mean a possible breach in security and there is a great chance of something going wrong. @TomFenech is correct too."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1497966296, "creation_date": 1497966296, "answer_id": 44654852, "question_id": 44647916, "link": "https://stackoverflow.com/questions/44647916/keep-sudo-alive-in-ruby-script/44654852#44654852", "title": "Keep sudo alive in Ruby script", "body": "<p>There are two scenarios, neither of which require you to do any in-program caching of credentials or authorization:</p>\n\n<ol>\n<li><p><em>The user can run arbitrary programs with <code>sudo</code>.</em></p>\n\n<p>Just require your script to be run with <code>sudo</code> instead of calling <code>sudo</code> inside the script. Assume the worst, that your user is going to do that anyway.</p></li>\n<li><p><em>The user can only run certain programs with <code>sudo</code>.</em></p>\n\n<p>In this case, the user can be assumed to be allowed to run the commands your script requires with <code>sudo</code>, but not your script itself. Either</p>\n\n<p>a) you can have the system administrator further configure <code>sudo</code> to allow the user to run those commands without a password, or</p>\n\n<p>b) the system administrator will <em>not</em> make that change, in which case you should not be circumventing that decision.</p></li>\n</ol>\n\n<p>In any case, it is not your program's job to decide when or if a password is required for <code>sudo</code>.</p>\n"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497966296, "creation_date": 1497947827, "question_id": 44647916, "link": "https://stackoverflow.com/questions/44647916/keep-sudo-alive-in-ruby-script", "title": "Keep sudo alive in Ruby script", "body": "<p>Is there a way to keep sudo alive in a Ruby script? I.e. I can ask a user to enter their sudo password once for the duration of a script?</p>\n\n<p>In bash, you could do:</p>\n\n<p><code>while true; do sudo -n true; sleep 60; kill -0 \"$$\" || exit; done 2&gt;/dev/null &amp;</code></p>\n\n<p>Credit: <a href=\"https://gist.github.com/cowboy/3118588\" rel=\"nofollow noreferrer\">Cowboy</a></p>\n"}, {"tags": ["ruby", "windows"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1497948937, "creation_date": 1497948937, "answer_id": 44648342, "question_id": 44647356, "link": "https://stackoverflow.com/questions/44647356/copy-a-file-omitting-the-first-x-characters/44648342#44648342", "title": "copy a file omitting the first X characters", "body": "<p>Something like this would likely work:</p>\n\n<pre><code>File.open(src, 'rb') do |r|\n  File.open(dst, 'wb') do |w|\n    w.write(new_dst_header)\n    r.seek(200)\n    until r.eof?\n      w.write(r.read(chunk_size))\n    end\n  end\nend\n</code></pre>\n\n<p>The bigger <code>chunk_size</code>, the faster it goes, and the more memory you use.</p>\n"}], "owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502628843, "creation_date": 1497946089, "last_edit_date": 1502628843, "question_id": 44647356, "link": "https://stackoverflow.com/questions/44647356/copy-a-file-omitting-the-first-x-characters", "title": "copy a file omitting the first X characters", "body": "<p>I am manipulating proprietary files, which are very similar to wave files but with a custom header, longer than the wav header (200 bytes versus 36 bytes). The samples are similar though. These files are quite large (200Meg typically).</p>\n\n<p>I am trying to batch convert the proprietary files to wav.</p>\n\n<p>I wrote a short script using the wavefile gem. I just read the whole array of samples then create the wave file. It works fine with smaller examples but I have a memory allocation error for larger ones. </p>\n\n<p>I noticed that using Fileutils.cp, copying the file is impressively fast. I am wondering if I could somehow copy the file while \"omitting\" the first 164 bytes, then just write the wave header in the first 36bytes and rename the file (.wav).</p>\n\n<p>What would be the best/easiest way?</p>\n"}, {"tags": ["ruby", "api", "oauth"], "comments": [{"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "edited": false, "score": 0, "creation_date": 1497949692, "post_id": 44647105, "comment_id": 76282318, "body": "have you seen <a href=\"https://github.com/faustus7/sellsy\" rel=\"nofollow noreferrer\">this</a>? there&#39;s no documentation though"}], "answers": [{"comments": [{"owner": {"reputation": 40596, "user_id": 1677912, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/craWj.png?s=128&g=1", "display_name": "Mogsdad", "link": "https://stackoverflow.com/users/1677912/mogsdad"}, "edited": false, "score": 0, "creation_date": 1518141554, "post_id": 48697276, "comment_id": 84394030, "body": "A link to a solution is welcome, but please ensure your answer is useful without it: <a href=\"//meta.stackexchange.com/a/8259\">add context around the link</a> so your fellow users will have some idea what it is and why it\u2019s there, then quote the most relevant part of the page you&#39;re linking to in case the target page is unavailable. <a href=\"//stackoverflow.com/help/deleted-answers\">Answers that are little more than a link may be deleted.</a>"}, {"owner": {"reputation": 745, "user_id": 3033467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a33988a3dc0d009236304ff4ad8d615?s=128&d=identicon&r=PG&f=1", "display_name": "user3033467", "link": "https://stackoverflow.com/users/3033467/user3033467"}, "edited": false, "score": 0, "creation_date": 1613664407, "post_id": 48697276, "comment_id": 117151112, "body": "For anyone who uses this, oauth_signature = URI::escape(self.configuration.consumer_secret) + &quot;&amp;&quot; + URI::escape(self.configuration.user_secret)"}], "tags": [], "owner": {"reputation": 569, "user_id": 7355534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1rWLC.jpg?s=128&g=1", "display_name": "Bastien Robert", "link": "https://stackoverflow.com/users/7355534/bastien-robert"}, "is_accepted": true, "score": -1, "last_activity_date": 1518138616, "creation_date": 1518138616, "answer_id": 48697276, "question_id": 44647105, "link": "https://stackoverflow.com/questions/44647105/error-401-on-api-request-on-ruby/48697276#48697276", "title": "Error 401 on API request on Ruby", "body": "<p>Finally found the solution, script is here : <a href=\"https://github.com/bastienrobert/Sellsy-API\" rel=\"nofollow noreferrer\">https://github.com/bastienrobert/Sellsy-API</a></p>\n"}], "owner": {"reputation": 569, "user_id": 7355534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1rWLC.jpg?s=128&g=1", "display_name": "Bastien Robert", "link": "https://stackoverflow.com/users/7355534/bastien-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 48697276, "answer_count": 1, "score": 0, "last_activity_date": 1518138616, "creation_date": 1497945392, "last_edit_date": 1497973259, "question_id": 44647105, "link": "https://stackoverflow.com/questions/44647105/error-401-on-api-request-on-ruby", "title": "Error 401 on API request on Ruby", "body": "<p>I just want to connect to the <a href=\"https://api.sellsy.com/documentation/intro\" rel=\"nofollow noreferrer\">Sellsy API</a>. So, I write a Ruby script:</p>\n\n<pre><code>require 'oauth'\n@consumer = OAuth::Consumer.new(\"user_key\",\"user_pwd\", :site =&gt; \"https://apifeed.sellsy.com/0/request_token\")\nputs @consumer\n@request_token = @consumer.get_request_token\nsession[:request_token] = @request_token\n</code></pre>\n\n<p>And I get a 401 error on:</p>\n\n<pre><code>#&lt;OAuth::Consumer:0x008dfe229f3c10&gt;\n/usr/local/lib/ruby/gems/2.3.0/gems/oauth0.5.3/lib/oauth/consumer.rb:236:in `token_request': 401 Unauthorized (OAuth::Unauthorized)\nfrom /usr/local/lib/ruby/gems/2.3.0/gems/oauth-0.5.3/lib/oauth/consumer.rb:155:in `get_request_token'\nfrom test0.rb:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>I just want to insure than there is no error on my script, I only want to connect to the API (no other request yet).</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1497943627, "post_id": 44645816, "comment_id": 76278129, "body": "can u pls attach the input file?"}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1497944538, "post_id": 44645816, "comment_id": 76278724, "body": "@BKSpurgeon : Thanks for looking into it, I don&#39;t find any option to attach the file, so have edited the question and pasted the input content."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1497946006, "post_id": 44645816, "comment_id": 76279685, "body": "is there any reason why year_on doesn&#39;t have an @ symbol?"}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1497946280, "post_id": 44645816, "comment_id": 76279855, "body": "@BKSpurgeon : Sincere apologies, that was an editing mistake. I have corrected it in the question. Thanks. Year_in should have @ symbol"}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1498038213, "post_id": 44645816, "comment_id": 76329090, "body": "@BKSpurgeon : Any chance you had a look at it. Thanks."}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1498117001, "post_id": 44645816, "comment_id": 76369165, "body": "@BKSpurgeon : Really appreciate you taking time to look into my issue. Thank you. Unfortunately I don&#39;t have enough reputations to place a bounty. I was trying from my end, but not sure how to move forward. I shall wait for your guidance."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1498117765, "post_id": 44645816, "comment_id": 76369645, "body": "i can&#39;t guarantee a response ~3% chance i can get around to it - so don&#39;t hold your breath, i threw away my notes on this problem anyways; if i do it will be very, very general answers so you will know HOW to solve it. chrs."}, {"owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1498121381, "post_id": 44645816, "comment_id": 76372195, "body": "@BKSpurgeon : got it!"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1498142671, "post_id": 44645816, "comment_id": 76388145, "body": "congratulations! all the best"}], "answers": [{"tags": [], "owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "is_accepted": false, "score": 0, "last_activity_date": 1497943713, "creation_date": 1497943713, "answer_id": 44646540, "question_id": 44645816, "link": "https://stackoverflow.com/questions/44645816/how-to-split-and-organize-the-data-in-ruby/44646540#44646540", "title": "How to split and organize the data in Ruby", "body": "<p>I'd start with splitting by blocks. </p>\n\n<pre><code>file = File.open(\"input.txt\", \"rb\")\nblocks = file.read.split(/\\n\\s*\\n/)\n</code></pre>\n\n<p>and each block need different treatment...</p>\n\n<pre><code>name = parse_name blocks[0]\ngroups = parse_groups blocks[1]\n....\n</code></pre>\n\n<p>parse_groups idea is to get block inside of <code>[groups]</code> and <code>[/]</code> and parse it like <code>split(/^([^\\s]+)\\s*=\\s*([^,\\s])/)</code>... </p>\n"}], "owner": {"reputation": 499, "user_id": 6760948, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/48c180d3ffe5cf06bf86515f9bc6776c?s=128&d=identicon&r=PG&f=1", "display_name": "voltas", "link": "https://stackoverflow.com/users/6760948/voltas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497946213, "creation_date": 1497941540, "last_edit_date": 1497946213, "question_id": 44645816, "link": "https://stackoverflow.com/questions/44645816/how-to-split-and-organize-the-data-in-ruby", "title": "How to split and organize the data in Ruby", "body": "<p>Below is a sample data from the input file.</p>\n\n<pre><code>File Id: C:/my_files/456_Milo_123-values.txt\n\n#RakeBoss-Jan 21st Prod\n[groups]\nmet = chk\\rel_io_chk, chk\\dev_op_io\ndiv = chk\\kzhr2x, chk\\, chk\\czzjrt\njee_only = chk\\zz9ycd, chk\\hz659l\nyear_on = chk\\dytg6\n[/]\n@met = rw\n@div = rw\n@jee_only = r\n\n[/Release]\nyear_on = r\n\n[/Redmine/Treehub]\n@div = r\n@jee_only = rw\n</code></pre>\n\n<p>I want it to be organized like below to an output file</p>\n\n<pre><code>Name            group          id           folder             access\n456_Milo_123    met         chk\\rel_io_chk    /                 rw\n456_Milo_123    met         chk\\dev_op_io     /                 rw\n456_Milo_123    div         chk\\kzhr2x        /                 rw  \n456_Milo_123    div         chk\\czzjrt        /                 rw\n456_Milo_123    div         chk\\zz52t0        /                 rw\n456_Milo_123    jee_only    chk\\zz9ycd        /                 rw\n456_Milo_123    jee_only    chk\\zz9ycd        /                 rw\n456_Milo_123    year_on     chk\\dytg6         /Release          r\n456_Milo_123    div         chk\\czzjrt        /Redmine/Treehub  r\n456_Milo_123    div         chk\\zz52t0        /Redmine/Treehub  r\n456_Milo_123    jee_only    chk\\zz9ycd        /Redmine/Treehub  rw\n456_Milo_123    jee_only    chk\\zz9ycd        /Redmine/Treehub  rw     \n</code></pre>\n\n<p>I have tried many combinations of split and splice to organize it but not able to achieve the above output. </p>\n\n<p>My incomplete tries</p>\n\n<pre><code>file = File.open(\"input.txt\", \"rb\")\nvalues = file.read.split(\"File Id:\")\nvalues.each do |val|\n  val.reject {||a| a.match(/^#|^\\[/m)}\n    end\n#not sure how to process further    \nmatch_by_id(\"input.txt\") do |id, lines|\n  lines.each do |line|\n    group, group_values = line.split(\"=\")\n    group.reject {|a| a.match(/^#|^\\[/m)}\n    end\n#not sure how to process further    \nend\nvalues.shift\n</code></pre>\n\n<p>Any idea how to do that ? Thanks.</p>\n\n<p><strong>Input file</strong></p>\n\n<pre><code>File Id: C:/my_files/00_Roll_Tom-values.txt\n\n#RakeBoss-Random as on 12/19/2016\n[groups]\nmet = chk\\rel_io_chk, chk\\dev_op_io,\ndiv = chk\\kzhr2x, chk\\zz52t0, chk\\czzjrt\nrakeonly = chk\\rzgnsd, chk\\cztw5h\n\n[/]\n@met = rw\n@div = rw\n@rakeonly = r\n*******************************************************************************************\nFile Id: C:/my_files/Rander-values.txt\n\n#RakeBoss-Jan 21st QA\n[groups]\nmet = chk\\rel_io_chk, chk\\dev_op_io\ndiv = chk\\541kmj, chk\\zz52t0\napp_only = chk\\zz9ycd\ncheck_io = chk\\wder4, chk\\zz9ycd\ndiv_write = chk\\lo98j3\nyear_on = chk\\3w345f\n[/]\n@met = rw\n@div = rw\n@app_only= r\n@check_io = r\n@div_write = rw\n@year_on = r\n\n[/wedmin]\n@check_io = rw\n@div_write= rw\n\n[/doc/prod]\n@div = rw\n@app_only = r\n@year_on = rw\n*******************************************************************************************\nFile Id: C:/my_files/456_Milo_123-values.txt\n\n#RakeBoss-Jan 21st Prod\n[groups]\nmet = chk\\rel_io_chk, chk\\dev_op_io\ndiv = chk\\kzhr2x, chk\\, chk\\czzjrt\njee_only = chk\\zz9ycd, chk\\hz659l\nyear_on = chk\\dytg6\n[/]\n@met = rw\n@div = rw\n@jee_only = r\n\n[/Release]\n@year_on = r\n\n[/Redmine/Treehub]\n@div = r\n@jee_only = rw\n******************************************************************************************\nFile Id: C:/my_files/Docker_red-values.txt\n\n#RakeBoss-Check it io.\n[groups]\nmet = chk\\rel_io_chk, chk\\dev_op_io, chk\\njk987\ndiv = chk\\gzlqvg, chk\\zzkgyp, chk\\lzg0rp, chk\\gzp2kv\nrakeonly = chk\\qzvjq0, chk\\kz6w6t, chk\\bzy4kj, chk\\dzfbhp\n\n[/]\n@met = rw\n@div = rw\n@rakeonly = r\n******************************************************************************************\n</code></pre>\n"}]