[{"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1561593399, "post_id": 56782206, "comment_id": 100119381, "body": "I was going to recommend just patching the require method itself to call load, but the problem is gems and stdlib don&#39;t work with load. I don&#39;t know of a better way than restarting the application or replacing the specific require calls with load"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5170629, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1_KlgUGcgw/AAAAAAAAAAI/AAAAAAAAARc/2QQSaHl4qgg/photo.jpg?sz=128", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/5170629/dnguyen"}, "edited": false, "score": 0, "creation_date": 1562109528, "post_id": 56783838, "comment_id": 100271877, "body": "I am editing the files in lib but when I try to run the command via command line it says that the method is not found for that class."}], "tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": false, "score": 0, "last_activity_date": 1561609272, "creation_date": 1561609272, "answer_id": 56783838, "question_id": 56782206, "link": "https://stackoverflow.com/questions/56782206/is-there-a-way-to-reload-all-required-libraries-files-in-ruby-for-an-entire-gem/56783838#56783838", "title": "Is there a way to reload all required libraries/files in Ruby for an entire gem?", "body": "<p>It sounds like you are doing something wrong.</p>\n\n<p>You should not patch the <code>require</code> method, and you should not use <code>load</code> instead of <code>require</code>.</p>\n\n<p>If you are building your own gem, with a command line interface, then you should be able to freely edit any of the files in the gem's <code>lib</code> folder, and it will be used the next time you are running your command line. There is no cached version.</p>\n\n<p>If this is not the behavior you see, then try running your command line with <code>bundle exec your_command</code> instead of just <code>your_command</code>. As a side note, if your Ruby is installed with RVM, you will not need <code>bundle exec</code>.</p>\n"}], "owner": {"reputation": 121, "user_id": 5170629, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1_KlgUGcgw/AAAAAAAAAAI/AAAAAAAAARc/2QQSaHl4qgg/photo.jpg?sz=128", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/5170629/dnguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561609272, "creation_date": 1561592541, "question_id": 56782206, "link": "https://stackoverflow.com/questions/56782206/is-there-a-way-to-reload-all-required-libraries-files-in-ruby-for-an-entire-gem", "title": "Is there a way to reload all required libraries/files in Ruby for an entire gem?", "body": "<p>I've added new methods to Classes in ruby and I would like to reload the entire project instead of changing every instance I've used \"require\" to \"load.\" Is there a way I can force the entire project reload files so my command line script will use the up to date changes instead of what has been cached from previous loads?</p>\n\n<p>I've tried: \nload \"path/to/file.rb\"</p>\n\n<p>but I don't want to reload the file every time, I just want it to reload for development purposes.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "postman"], "comments": [{"owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "edited": false, "score": 0, "creation_date": 1561582157, "post_id": 56780640, "comment_id": 100116362, "body": "Why i cant call model Item in controller???"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1561582285, "post_id": 56780640, "comment_id": 100116431, "body": "call as <code>::Item</code> this will force lookup at the top level. Right now your namespacing also defines <code>Item</code> as in Api::V1:: <b>Item</b> ::ItemsController but that constant does not actually exist it only exists as part of this namespacing"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1561582316, "post_id": 56780711, "comment_id": 100116443, "body": "Please expound otherwise this could just be a comment like mine :)"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1561582671, "post_id": 56780711, "comment_id": 100116568, "body": "@engineersmnky Don&#39;t see your comment :)"}, {"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 2, "creation_date": 1561582698, "post_id": 56780711, "comment_id": 100116573, "body": "Alternative: <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Dependencies/Loadable.html#method-i-require_dependency\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveSupport/Dependencies/&hellip;</a>"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "edited": false, "score": 1, "creation_date": 1561583023, "post_id": 56780711, "comment_id": 100116687, "body": "@\u0422\u0430\u0440\u0430\u0441\u041c\u0430\u0442\u0456\u0457\u0432  engineersmnky gave a good explanation. I suggest to avoid of using <code>namespace :item do</code> in your routing."}], "tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": true, "score": 3, "last_activity_date": 1561582613, "last_edit_date": 1561582613, "creation_date": 1561582284, "answer_id": 56780711, "question_id": 56780640, "link": "https://stackoverflow.com/questions/56780640/nameerror-uninitialized-constant-apiv1itemitemscontrolleritem/56780711#56780711", "title": "NameError: uninitialized constant Api::V1::Item::ItemsController::Item", "body": "<p>Try using <strong>absolute</strong> constant path <code>::Item</code> instead of <strong>relative</strong> constant path <code>Item</code>.</p>\n\n<pre><code>def index\n  @items = ::Item.all\n  # ...\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 56780711, "answer_count": 1, "score": 0, "last_activity_date": 1561582613, "creation_date": 1561581974, "question_id": 56780640, "link": "https://stackoverflow.com/questions/56780640/nameerror-uninitialized-constant-apiv1itemitemscontrolleritem", "title": "NameError: uninitialized constant Api::V1::Item::ItemsController::Item", "body": "<p>I have controller</p>\n\n<pre><code>class Api::V1::Item::ItemsController &lt; ApplicationController\n  def index\n     @items = Item.all \n\n     render json: @items\n  end\nend\n</code></pre>\n\n<p>and routes for this controller</p>\n\n<pre><code> namespace :api do\n  namespace :v1 do\n   namespace :item do\n     resources :items\n   end\n  end\n end \n</code></pre>\n\n<p>If i check this in postman, i obtain an error:</p>\n\n<pre><code>{\n  \"status\": 500,\n  \"error\": \"Internal Server Error\",\n  \"exception\": \"#&lt;NameError: uninitialized constant Api::V1::Item::ItemsController::Item&gt;\",\n }\n</code></pre>\n\n<p>But if i modify controller`s method index like</p>\n\n<pre><code>  def index\n     render json: { check: 'Nice' }\n  end\n</code></pre>\n\n<p>everything will be fine. Pls explain me what the problem is</p>\n"}, {"tags": ["ruby", "string-matching"], "comments": [{"owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "edited": false, "score": 0, "creation_date": 1561581860, "post_id": 56780544, "comment_id": 100116245, "body": "_char is not a character for interpolation I believe since it is single quoted ..."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1561582509, "post_id": 56780697, "comment_id": 100116514, "body": "What happens what <code>_char</code> is <code>&#39;.&#39;</code>, <code>&#39;*&#39;</code>, ...?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1561583731, "post_id": 56780697, "comment_id": 100116969, "body": "@muistooshort, I wasn&#39;t sure I understood your point until I read your answer. True, <code>Regexp::escape</code> is handy, but not essential; one could always do their own escaping."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1561588930, "post_id": 56780697, "comment_id": 100118449, "body": "True but <code>Regexp.escape</code> makes your intention clear and avoids missing anything in some <code>.*?|...</code> line noise (or <code>\\p{...}</code>)."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1561586621, "last_edit_date": 1561586621, "creation_date": 1561582216, "answer_id": 56780697, "question_id": 56780544, "link": "https://stackoverflow.com/questions/56780544/matching-a-double-quote-via-quote-vs-pattern/56780697#56780697", "title": "matching a double-quote via quote vs pattern", "body": "<p>In <code>check_char1</code>, <code>_char</code> in <code>/_char/</code> is treated as a literal, not a variable. You need  <code>/#{_char}/</code>.</p>\n\n<p>If <code>_char</code> were treated as variable how could one enter a literal in a regex that was the name of a variable, method or constant?</p>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 3, "last_activity_date": 1561582454, "creation_date": 1561582454, "answer_id": 56780753, "question_id": 56780544, "link": "https://stackoverflow.com/questions/56780544/matching-a-double-quote-via-quote-vs-pattern/56780753#56780753", "title": "matching a double-quote via quote vs pattern", "body": "<p>If <code>_char</code> is just a string (i.e. no regex pattern matching needed) then just use <a href=\"https://ruby-doc.org/core/String.html#method-i-include-3F\" rel=\"nofollow noreferrer\"><code>String#include?</code></a></p>\n\n<pre><code>if line.include?(_char)\n</code></pre>\n\n<p>If you must use a regex for this then <a href=\"https://ruby-doc.org/core/Regexp.html#method-c-escape\" rel=\"nofollow noreferrer\"><code>Regexp.escape</code></a> is your friend:</p>\n\n<pre><code>if line =~ /#{Regexp.escape(_char)}/\nif line =~ Regexp.new(Regexp.escape(_char))\n</code></pre>\n\n<p>and if you want <code>_char</code> to be treated like a regex (i.e. <code>'.'</code> matches anything) then drop the <code>Regexp.escape</code>:</p>\n\n<pre><code>if line =~ /#{_char}/\nif line =~ Regexp.new(_char)\n</code></pre>\n"}], "owner": {"reputation": 15501, "user_id": 664833, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/814bed2c4c2d0e69ec65a28a166c01b7?s=128&d=identicon&r=PG", "display_name": "user664833", "link": "https://stackoverflow.com/users/664833/user664833"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56780753, "answer_count": 2, "score": 1, "last_activity_date": 1561586621, "creation_date": 1561581515, "question_id": 56780544, "link": "https://stackoverflow.com/questions/56780544/matching-a-double-quote-via-quote-vs-pattern", "title": "matching a double-quote via quote vs pattern", "body": "<p>Why does <code>check_char1</code> fail to find the double-quote?</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nline = 'hello, \"bob\"'\n\ndef check_char1(line, _char)\n    puts \"check_char1 found #{_char} in #{line}\" if line =~ /_char/\nend\n\ncheck_char1(line, '\"')\n\ndef check_char2(line, _char)\n    puts \"check_char2 found #{_char.inspect} in #{line}\" if line =~ _char\nend\n\ncheck_char2(line, /\"/)\n</code></pre>\n\n<p>...and can it be made to work using <code>line =~ /_char/</code>? (How should the double-quote be passed to the method?)</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "migration"], "answers": [{"tags": [], "owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1561575494, "creation_date": 1561575494, "answer_id": 56779429, "question_id": 56779212, "link": "https://stackoverflow.com/questions/56779212/how-to-fix-sequential-order-of-column-with-gaps-in-a-ruby-on-rails-migration/56779429#56779429", "title": "How to fix sequential order of column with &#39;gaps&#39; in a Ruby on Rails Migration", "body": "<p>I believe you would need to do the following things:</p>\n\n<ol>\n<li>You could write a rake task to fix existing records with incorrect/missing ranks. I recommend writing a rake task since this would be a one time activity which would not really have an up/down toggle like that of migrations.</li>\n<li>You could introduce validations for presence and uniqueness of rankings scoped to <code>course_id</code> and <code>student_id</code>. Reference: <a href=\"https://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"nofollow noreferrer\">Uniqueness validations in Rails</a></li>\n<li>You could write a custom validation on the <code>student_course_rankings</code> model to check that rankings do not have gaps. </li>\n<li>Additionally, you would need to handle the order of rankings using suitable views. </li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 4970711, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea9c258b7b2be6853e4c67e1f6c3715a?s=128&d=identicon&r=PG&f=1", "display_name": "ElGatoGabe", "link": "https://stackoverflow.com/users/4970711/elgatogabe"}, "edited": false, "score": 0, "creation_date": 1561580566, "post_id": 56779758, "comment_id": 100115689, "body": "Thank you very much. I found this to be the cleanest solution"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1561576998, "creation_date": 1561576998, "answer_id": 56779758, "question_id": 56779212, "link": "https://stackoverflow.com/questions/56779212/how-to-fix-sequential-order-of-column-with-gaps-in-a-ruby-on-rails-migration/56779758#56779758", "title": "How to fix sequential order of column with &#39;gaps&#39; in a Ruby on Rails Migration", "body": "<p>I would do something like this:</p>\n\n<pre><code>Student.find_each do |student|\n  # load all student_courses for a given student ordered by `ranking`\n  student_courses = StudentCourse.where(student_id: student).order(:ranking)\n\n  student_courses.each.with_index(1) do |student_course, index|\n    # update the ranking by its position in the list\n    student_course.update(ranking: index)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": false, "score": 3, "last_activity_date": 1561577925, "last_edit_date": 1561577925, "creation_date": 1561577046, "answer_id": 56779769, "question_id": 56779212, "link": "https://stackoverflow.com/questions/56779212/how-to-fix-sequential-order-of-column-with-gaps-in-a-ruby-on-rails-migration/56779769#56779769", "title": "How to fix sequential order of column with &#39;gaps&#39; in a Ruby on Rails Migration", "body": "<p>PostgreSQL has some <a href=\"http://www.postgresqltutorial.com/postgresql-window-function/\" rel=\"nofollow noreferrer\">window finctions</a> for ranking with/without gaps. You need one without gaps - <a href=\"http://www.postgresqltutorial.com/postgresql-row_number/\" rel=\"nofollow noreferrer\">ROW_NUMBER</a>:</p>\n\n<pre><code>class FixStudentCourseRankings &lt; ActiveRecord::Migration[5.1]\n  def change\n\n    # Deletes duplicate courses (keeps the first)\n    StudentCourse.where.not(\n      id: StudentCourse.group(:course_id, :student_id).pluck('min(student_courses.id)')\n    ).delete_all\n\n    execute &lt;&lt;~SQL\n      UPDATE student_courses\n      SET ranking = ranked.ranking\n      FROM (\n        SELECT\n          id,\n          ROW_NUMBER() OVER(\n            PARTITION BY student_id\n            ORDER BY id ASC\n          ) AS ranking\n        FROM student_courses\n      ) ranked\n      WHERE student_courses.id = ranked.id\n    SQL\n\n    # Adds unique constraint so students can't accidentally select the same course more than once\n    add_index :student_courses, %i[course_id student_id ranking], unique: true\n  end\nend\n</code></pre>\n\n<p><a href=\"https://www.db-fiddle.com/f/j9Lc7kRoHkRqNQFSR6fDp1/0\" rel=\"nofollow noreferrer\">Db-Fiddle</a></p>\n"}], "owner": {"reputation": 93, "user_id": 4970711, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea9c258b7b2be6853e4c67e1f6c3715a?s=128&d=identicon&r=PG&f=1", "display_name": "ElGatoGabe", "link": "https://stackoverflow.com/users/4970711/elgatogabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56779758, "answer_count": 3, "score": 0, "last_activity_date": 1561577925, "creation_date": 1561574509, "question_id": 56779212, "link": "https://stackoverflow.com/questions/56779212/how-to-fix-sequential-order-of-column-with-gaps-in-a-ruby-on-rails-migration", "title": "How to fix sequential order of column with &#39;gaps&#39; in a Ruby on Rails Migration", "body": "<p>I have a Ruby on Rails app (Rails version: 5.1.1 &amp; Ruby version 2.3.1). Also using PostgreSQL if that matters. I'm having data integrity issues with a mapping table that maps students to selected courses where a column called <code>ranking</code> incorrectly has \"gaps\" in the ranking, and needs to be fixed to be sequential (per student) without any gaps.</p>\n\n<p><strong>Example:</strong> Let's say I have a table called <code>student_course_rankings</code> where a student selects multiple courses and ranks them based on their favorite course.</p>\n\n<p>There's a unique constraint for <code>(student_id, course_id, ranking)</code>, so a student cannot select the same course twice.</p>\n\n<p><code>ranking</code> column just has a <code>NOT NULL</code> constraint, but no other constraints and is of type <code>integer</code>.</p>\n\n<p>What is the best way to do this in a Ruby Migration?</p>\n\n<pre><code>class FixStudentCourseRankings &lt; ActiveRecord::Migration[5.1]\n  def change\n\n    # Deletes duplicate courses (keeps the first)\n    StudentCourse.where.not(\n      id: StudentCourse.group(:course_id, :student_id).pluck('min(student_courses.id)')\n    ).delete_all\n\n    # Adds unique constraint so students can't accidentally select the same course more than once\n    add_index :student_courses, [:course_id, :student_id, :ranking], :unique =&gt; true\n\n    # HERE: Fix ranking order???\n  end\nend\n</code></pre>\n\n<p>Below is simplified version of my table and what it currently looks like with two students.</p>\n\n<pre><code> id | student_id | course_id | ranking \n----+------------+-----------+---------\n  1 |          1 |         2 |       1\n  2 |          1 |         3 |       2\n  3 |          1 |         5 |       4\n  4 |          1 |         9 |       5\n  5 |          1 |         6 |       6\n  6 |          2 |         3 |       2\n  7 |          2 |         6 |       4\n  8 |          2 |         5 |       5\n</code></pre>\n\n<p>What I want it to actually look like:</p>\n\n<pre><code> id | student_id | course_id | ranking \n----+------------+-----------+---------\n  1 |          1 |         2 |       1\n  2 |          1 |         3 |       2\n  3 |          1 |         5 |       3\n  4 |          1 |         9 |       4\n  5 |          1 |         6 |       5\n  6 |          2 |         3 |       1\n  7 |          2 |         6 |       2\n  8 |          2 |         5 |       3\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "edited": false, "score": 0, "creation_date": 1561571078, "post_id": 56778433, "comment_id": 100112012, "body": "I tried to do something like this, but it did not work: get &quot;/:user/contributions&quot; =&gt; &#39;users#contributions&#39;, :constraints =&gt; { :user =&gt; /[^\\/]+/ }"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1561572566, "post_id": 56778433, "comment_id": 100112622, "body": "You should add updates to your post directly in the post. There&#39;s an edit button near the bottom of your post to allow you to do so."}], "owner": {"reputation": 779, "user_id": 1459607, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/9521d2ebbcb24f803880ac7378e78140?s=128&d=identicon&r=PG", "display_name": "Ryan Glen", "link": "https://stackoverflow.com/users/1459607/ryan-glen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561571015, "creation_date": 1561571015, "question_id": 56778433, "link": "https://stackoverflow.com/questions/56778433/ruby-on-rails-routing-with-a-period-or-special-character", "title": "Ruby on Rails routing with a period or special character", "body": "<p>I am trying to create a route with special characters like . or : or spaces. However, when I pass: 12-Pizza.: One Two Three </p>\n\n<p>I look at the log output and Params: {pie => \"12-Pizza\"} is what shows up. It seems to hate periods is there a way to make the routing system ignore this?</p>\n"}, {"tags": ["html", "ruby", "hash", "view", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561570652, "post_id": 56778120, "comment_id": 100111821, "body": "<code>&lt;%= books %&gt;</code> is not the answer here. That data structure is really odd as well."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1561571126, "post_id": 56778120, "comment_id": 100112039, "body": "Inside the loop, you should use the variable <code>book</code> not the collection <code>@books</code>"}, {"owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561573818, "post_id": 56778120, "comment_id": 100113192, "body": "@tadman how can I improve it? Im all in for learning how to make things better!"}, {"owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1561573886, "post_id": 56778120, "comment_id": 100113230, "body": "@maxpleaner that worked! thanks! btw, if you dont mind. I have now a list with the most recent as the first, any idea how can I list by the ones that have the highest <code>count</code> ? for example  &quot;second book&quot;, &quot;Paul smith&quot; =&gt; 3 first in the list and then: &quot;&quot;first book&quot;, &quot;Mary Lovelace&quot; =&gt; 1&quot;  because the first one has the count of =&gt; 3"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561579555, "post_id": 56778120, "comment_id": 100115300, "body": "I&#39;d honestly expect this to be turned inside out, as in: <code>{ 1 =&gt; { name: &#39;First book&#39;, author: &#39;Mary Lovelace&#39; }, 3 =&gt; { name: &#39;Second book&#39;, author: &#39;Paul Smith&#39; } }</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561579570, "post_id": 56778120, "comment_id": 100115302, "body": "Also worth noting &quot;title&quot; not &quot;tittle&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5409357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KJ9dz.png?s=128&g=1", "display_name": "arkaitzz", "link": "https://stackoverflow.com/users/5409357/arkaitzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1561626953, "creation_date": 1561626953, "answer_id": 56787773, "question_id": 56778120, "link": "https://stackoverflow.com/questions/56778120/print-a-hash-in-html-view-with-breaking-lines-ruby-on-rails/56787773#56787773", "title": "Print a hash in HTML view with breaking lines - Ruby on Rails", "body": "<p>max-pleaner answer in code </p>\n\n<pre><code> &lt;% @books.each do |book| %&gt;\n   &lt;ul style=\"list-style-type: circle;\"&gt;\n     &lt;tr&gt;\n       &lt;li&gt;\n         &lt;td&gt;&lt;%= book %&gt;&lt;/td&gt;\n       &lt;/li&gt;\n     &lt;/tr&gt;\n   &lt;/ul&gt;\n &lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9937206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad5dc0a1ab32d105345cffc4c0475b?s=128&d=identicon&r=PG&f=1", "display_name": "Noname", "link": "https://stackoverflow.com/users/9937206/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561626953, "creation_date": 1561569702, "question_id": 56778120, "link": "https://stackoverflow.com/questions/56778120/print-a-hash-in-html-view-with-breaking-lines-ruby-on-rails", "title": "Print a hash in HTML view with breaking lines - Ruby on Rails", "body": "<p>Im new to RoR! I have a instance variable that contains a hash in my controller:</p>\n\n<pre><code>def index\n    @books = Book.group(:tittle, :author).count\n  end\n\n</code></pre>\n\n<p>I shows on my index page as such:</p>\n\n<pre><code>{[\"first book\", \"Mary Lovelace\"]=&gt;1, [\"second book\", \"Paul Smith\"]=&gt;3}\n{[\"first book\", \"Mary Lovelace\"]=&gt;1, [\"second book\", \"Paul Smith\"]=&gt;3}\n\n</code></pre>\n\n<p>This is my index view code:</p>\n\n<pre><code>tbody&gt;\n   &lt;% @books.each do |book| %&gt;\n   &lt;ul style=\"list-style-type: circle;\"&gt;\n      &lt;tr&gt;\n         &lt;li&gt;\n            &lt;td&gt;&lt;%= @books %&gt;&lt;/td&gt;\n         &lt;/li&gt;\n      &lt;/tr&gt;\n   &lt;/ul&gt;\n   &lt;% end %&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>The outcome I wanna accomplish is the following:\nI want the view to print this instead\nexample</p>\n\n<pre><code>\"first book\", \"Mary Lovelace\" =&gt; 1\n\"second book\", \"Paul smith\" =&gt; 3\n\n</code></pre>\n\n<p>Separated by a break line. Would like to hear your suggestions and solutions. Thanks in advance!</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1561568898, "post_id": 56777913, "comment_id": 100110998, "body": "Perhaps try <code>\\A[A-Za-z0-9]+\\z</code>"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1561569292, "post_id": 56777913, "comment_id": 100111169, "body": "@Thefourthbird Same error sadly... It works well with test strings on regex101 but it doesnt pass the test"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1561569318, "post_id": 56777913, "comment_id": 100111182, "body": "Can you add the data from your test to the question?"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1561569681, "post_id": 56777913, "comment_id": 100111356, "body": "I&#39;ve just added few more tests, they all pass except the last one (I don&#39;t know what the test is tho)"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1561569819, "post_id": 56777913, "comment_id": 100111432, "body": "This should work <code>string.match &#47;\\A[A-Za-z0-9]+\\z&#47;</code>"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1561569929, "post_id": 56777913, "comment_id": 100111477, "body": "Well, <code>\\A[a-zA-Z0-9]+\\z</code> should work"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "edited": false, "score": 0, "creation_date": 1561570573, "post_id": 56777913, "comment_id": 100111787, "body": "Oh my god I&#39;m so noob... Yes those regex works, thanks. <code>\\z</code> works but <code>$</code>, I didnt know the subtlety (I still don&#39;t really).   The problem was mainly my ruby syntax tho, I was running: <code>print !!(string.match &#47;\\A[a-zA-Z0-9]+\\z&#47;)</code> because at some point, it was only working with the <code>print</code>.  I&#39;m ashamed and grateful at the same time ^^ Thanks !"}, {"owner": {"reputation": 210, "user_id": 2120436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZn1B.jpg?s=128&g=1", "display_name": "prettycoder", "link": "https://stackoverflow.com/users/2120436/prettycoder"}, "edited": false, "score": 0, "creation_date": 1561571761, "post_id": 56777913, "comment_id": 100112288, "body": "see: <a href=\"https://stackoverflow.com/questions/33267058/regex-to-check-alphanumeric-string-in-ruby\" title=\"regex to check alphanumeric string in ruby\">stackoverflow.com/questions/33267058/&hellip;</a> the solution doesn&#39;t have to involve a regex &#175;_(\u30c4)_/&#175;"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "reply_to_user": {"reputation": 210, "user_id": 2120436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZn1B.jpg?s=128&g=1", "display_name": "prettycoder", "link": "https://stackoverflow.com/users/2120436/prettycoder"}, "edited": false, "score": 0, "creation_date": 1561572768, "post_id": 56777913, "comment_id": 100112710, "body": "@prettycoder lol \u1555( \u141b )\u1557"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 210, "user_id": 2120436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZn1B.jpg?s=128&g=1", "display_name": "prettycoder", "link": "https://stackoverflow.com/users/2120436/prettycoder"}, "edited": false, "score": 0, "creation_date": 1571627290, "post_id": 56777913, "comment_id": 103290737, "body": "@prettycoder, the right forearm needs to be escaped."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1561570451, "post_id": 56778090, "comment_id": 100111725, "body": "That&#39;s the same as <code>r = &#47;^[A-Za-z0-9]+$&#47;</code>, but try this <code>&quot;a1\\n@&quot;.match?(r) #=&gt; true</code>. Can you spot the problem?"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "edited": false, "score": 1, "creation_date": 1561571581, "post_id": 56778090, "comment_id": 100112214, "body": "It doesn&#39;t works, but thank you a lot because I didn&#39;t knew we could pass a block to <code>scan</code>. It&#39;s gonna help me a lot to do some test ! Also I don&#39;t really get the goal of <code>(?=.)</code>, could you briefly explain ?"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1561571889, "post_id": 56778090, "comment_id": 100112346, "body": "@CarySwoveland The problem comes from <code>$</code> which means <i>&quot;end of the line&quot;</i> ? When it meets <code>\\n</code> it stops scanning and return <code>true</code> because <code>a1</code> is valid and <code>@</code> is ignored ?  So I guess this is why we should use <code>\\z</code> right ?"}, {"owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "edited": false, "score": 1, "creation_date": 1561572630, "post_id": 56778090, "comment_id": 100112649, "body": "@Emma thanks for the advises ! I&#39;ll keep experimenting, it looks like there&#39;s sooo much to know about regular expressions ! Hopefully regex101 helps a lot Have a great day/evening :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "edited": false, "score": 1, "creation_date": 1561575478, "post_id": 56778090, "comment_id": 100113947, "body": "@Sumak, yes, here we need to use the string anchors <code>\\A</code> and <code>\\z</code>. When it is known that the string contains no newline characters you can use either those anchors of the line anchors <code>^</code> and <code>$</code>, but it&#39;s best to use the set of anchors that reflects your intent, in part so that you don&#39;t confuse readers. If I see line anchors where string anchors are intended I need to waste time examining the code to ensure the the coder did not have a reason for avoiding the use of string anchors. Also, in this case an error may be introduced if in future strings may contain newline characters."}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": true, "score": 1, "last_activity_date": 1561572152, "last_edit_date": 1592644375, "creation_date": 1561569565, "answer_id": 56778090, "question_id": 56777913, "link": "https://stackoverflow.com/questions/56777913/regex-absolute-begginer-filter-alphanumeric/56778090#56778090", "title": "Regex absolute begginer: filter alphanumeric", "body": "<p>My guess is that maybe, we would start with an expression similar to:</p>\n<pre><code>^(?=[A-Za-z0-9])[A-Za-z0-9]+$\n</code></pre>\n<p>and test to see if it might cover our desired rules.</p>\n<p>In this <a href=\"https://regex101.com/r/T39cu9/1/\" rel=\"nofollow noreferrer\">demo</a>, the expression is explained, if you might be interested.</p>\n<h3>Test</h3>\n<pre><code>re = /^(?=[A-Za-z0-9])[A-Za-z0-9]+$/m\nstr = ' \nab\nc\ndef\nabc*\ndef^\n'\n\n# Print the match result\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1571627711, "creation_date": 1571627711, "answer_id": 58479356, "question_id": 56777913, "link": "https://stackoverflow.com/questions/56777913/regex-absolute-begginer-filter-alphanumeric/58479356#58479356", "title": "Regex absolute begginer: filter alphanumeric", "body": "<pre><code>str !~ /[^A-Za-z\\d]/\n</code></pre>\n\n<p>The string contains alphanumeric characters only if and only if it does <em>not</em> contain a character other than an alphnumeric character.</p>\n"}], "owner": {"reputation": 394, "user_id": 11509906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYTfF.jpg?s=128&g=1", "display_name": "Sumak", "link": "https://stackoverflow.com/users/11509906/sumak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 56778090, "answer_count": 2, "score": 1, "last_activity_date": 1571627711, "creation_date": 1561568797, "last_edit_date": 1561573770, "question_id": 56777913, "link": "https://stackoverflow.com/questions/56777913/regex-absolute-begginer-filter-alphanumeric", "title": "Regex absolute begginer: filter alphanumeric", "body": "<p>I'm playing <a href=\"https://www.codewars.com/kata/not-very-secure/train/ruby\" rel=\"nofollow noreferrer\">codewars</a> in Ruby and I'm stuck on a Kata. The goal is to validate if a user input string is alphanumeric. (yes, this is quite advanced Regex)</p>\n\n<p>The instructions:</p>\n\n<pre><code>At least one character (\"\" is not valid)\nAllowed characters are uppercase / lowercase latin letters and digits from 0 to 9\nNo whitespaces/underscore\n</code></pre>\n\n<p>What I've tried :</p>\n\n<pre><code>^[a-zA-Z0-9]+$\n^(?! !)[a-zA-Z0-9]+$\n^((?! !)[a-zA-Z0-9]+)$\n</code></pre>\n\n<p>It passes all the test except one, here's the error message:</p>\n\n<pre><code>Value is not what was expected\n</code></pre>\n\n<p>I though the Regex I'm using would satisfy all the conditions, what am I missing ?</p>\n\n<p><hr>\n<strong>SOLUTION:</strong> <code>\\A[a-zA-Z0-9]+\\z</code> (and better Ruby :^) )</p>\n\n<ul>\n<li><code>$</code>  => end of a <strong>line</strong></li>\n<li><code>\\z</code> => end of a <strong>string</strong></li>\n</ul>\n\n<p>(same for beginning: <code>^</code> (line) and <code>\\A</code> (string), but wasn't needed for the test)</p>\n\n<p>Favourite answer from another player:</p>\n\n<pre><code>/\\A[A-z\\d]+\\z/\n</code></pre>\n"}, {"tags": ["jquery", "ruby", "append", "haml"], "comments": [{"owner": {"reputation": 6024, "user_id": 4782169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45d896d164a69b89d90a69a3e4db1fab?s=128&d=identicon&r=PG&f=1", "display_name": "msg", "link": "https://stackoverflow.com/users/4782169/msg"}, "edited": false, "score": 2, "creation_date": 1561571775, "post_id": 56777752, "comment_id": 100112295, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56758383/why-append-occur-multiple-times-despite-im-using-each\">Why .append occur multiple times despite I&#39;m using .each?</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561934406, "post_id": 56777752, "comment_id": 100209507, "body": "Welcome to Stack Overflow. Your question is off-topic as it&#39;s a duplicate of one you asked yesterday. Please don&#39;t do that. Instead, re-edit your previous one if anything changed in the question. Asking multiple times don&#39;t improve your chance of answers, whereas improving the question will. &quot;<a href=\"https://stackoverflow.com/help/no-one-answers\">What should I do if no one answers my question?</a>&quot; will help."}], "owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581308568, "creation_date": 1561568221, "last_edit_date": 1581308568, "question_id": 56777752, "link": "https://stackoverflow.com/questions/56777752/why-append-occurs-multiple-times-despite-im-using-each", "title": "Why .append() occurs multiple times despite I&#39;m using .each()?", "body": "<p>I'm using jQuery for displaying dynamic content into panels of my page automatically. Each panel has a progress bar associated with a % number.</p>\n\n<p>Note: this <code>progress-bar</code> is part of the <code>panels</code> I display. There's onyl one by <code>panel</code></p>\n\n<p>Here is a pic of the situation :\n<a href=\"https://image.noelshack.com/fichiers/2019/26/2/1561482314-panel.jpg\" rel=\"nofollow noreferrer\">https://image.noelshack.com/fichiers/2019/26/2/1561482314-panel.jpg</a></p>\n\n<p>I'm using <code>each()</code> and <code>append()</code> to add a div and inject content in it for every panels</p>\n\n<p>The problem is that jQuery is creating as many div (which means it goes into my method and <code>append()</code>) as I display panels.</p>\n\n<p>To be clear, if I display 10 panels, each <code>progress-bar</code> will have 10 children added with <code>.append</code> (so 9 extra that are obviously useless). You see them surrounded in red on the pic above</p>\n\n<p>I can't understand why <code>each()</code> is not working</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$(document).ready(function() {\n  $('.progress-bar').each(function() {\n    var t = $(this);\n    var barPercentage = t.data('percentage');\n    var barContent = t.data('content');\n\n    // add a div for the label text\n    t.children('.label').append('&lt;div class=\"label-text\"&gt;&lt;/div&gt;');\n\n    // add some \"gimme\" percentage when data-percentage is &lt;2\n    if (parseInt((t.data('percentage')), 10) &lt; 2) \n      barPercentage = 2;\n\n    // set up the left/right label flipping\n    if (barPercentage &gt; 50) {\n      t.children('.label').css(\"right\", (100 - barPercentage) + '%');\n      t.children('.label').css(\"margin-right\", \"-10px\");\n    }\n  }\n</code></pre>\n\n<p>Also, here is my HTML :</p>\n\n<pre><code>  %div{class: \"progress-bar\", \"data-percentage\" =&gt; \"#{number.to_i &gt;= 100 ? '100' : number.to_i }\", \"data-content\" =&gt; \"#{label_content}\", style:\"background: white;\"}\n                    - if number.present?  &amp;&amp;  number.to_i != 0\n                      %div{class: \"bar\", style: \"background: #{color};\"}\n                        %span{style: \"background: #{color};\"}\n                      %div{class: \"label\", style: \"background: #{color}; border: 1px solid #{color}\"}\n//Here is where the \"label-text\" &lt;div&gt; is created with jQuery\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 3, "creation_date": 1561567161, "post_id": 56777384, "comment_id": 100110276, "body": "You could also create a Hash that maps each size to an integer e.g. <code>SIZE_ORDER = SIZE_NAMES.each_with_index.to_h</code> and then <code>variants.sort_by(&amp;SIZE_ORDER)</code>."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1561566701, "creation_date": 1561566701, "answer_id": 56777384, "question_id": 56777134, "link": "https://stackoverflow.com/questions/56777134/ordering-items-by-sizename-when-its-not-alphabetically-logic/56777384#56777384", "title": "Ordering items by sizename when it&#39;s not alphabetically logic?", "body": "<p>There are many ways to solve this, but at the core of any solution you need to <em>define the order manually</em> (or use a third party library which has already written this manual ordering for you?).</p>\n\n<p>For example, you could somewhere define e.g.</p>\n\n<pre><code>SIZE_NAMES = %w[XS S M L XL XXL]\n</code></pre>\n\n<p>and then elsewhere in the code, use something like:</p>\n\n<pre><code>variants.sort_by { |variant| SIZE_NAMES.index(variant.size) }\n</code></pre>\n\n<p>For a more \"advanced\" solution, you could instead consider defining each size as a <strong>custom object</strong> rather than a regular <code>String</code>. Take a look at the <a href=\"https://apidock.com/ruby/Comparable\" rel=\"nofollow noreferrer\"><code>Comparable</code> module</a>, and the <code>&lt;=&gt;</code> (\"spaceship\") operator.</p>\n\n<p>By utilising this, you could potentially implement it in such a way that e.g. <code>variants.sort</code> will automatically compare variants by their \"converted\" size, and order them as you expect.</p>\n"}, {"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1561829559, "last_edit_date": 1561829559, "creation_date": 1561568089, "answer_id": 56777713, "question_id": 56777134, "link": "https://stackoverflow.com/questions/56777134/ordering-items-by-sizename-when-its-not-alphabetically-logic/56777713#56777713", "title": "Ordering items by sizename when it&#39;s not alphabetically logic?", "body": "<p>If you wish to do sorting on db side then you have two options:</p>\n\n<ol>\n<li><p>Predefined sort like so:</p>\n\n<pre><code>Variant.order(\n \"CASE size_name\n    WHEN 'S' THEN 1\n    WHEN 'L' THEN 2\n    WHEN 'XL' THEN 3\n    WHEN 'XXL' THEN 4\n    ELSE 10\n  END, size, id\"\n)\n</code></pre>\n\n<p>You might want to move it to scope so in case you need to add another <code>size_name</code> there is only one place to change</p></li>\n<li><p>With <a href=\"https://api.rubyonrails.org/v4.1/classes/ActiveRecord/Enum.html\" rel=\"nofollow noreferrer\">active record enums</a>:</p>\n\n<pre><code>enum size_name: { s: 0, l: 1, xl: 2, xxl: 3 }\n</code></pre>\n\n<p>That way, you can still assign the field by the string/symbol, but the underlying data will actually be an integer, so you can just use <code>order(:size_name, :size)</code> to sort by <code>size_name</code> and <code>size</code>. </p>\n\n<p>Also this way you can add index to speed up ordering</p></li>\n</ol>\n"}], "owner": {"reputation": 129, "user_id": 11025649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5484a36958b8acab5bfb5ed4bae83ffa?s=128&d=identicon&r=PG&f=1", "display_name": "marie", "link": "https://stackoverflow.com/users/11025649/marie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56777384, "answer_count": 2, "score": 1, "last_activity_date": 1561829559, "creation_date": 1561565637, "question_id": 56777134, "link": "https://stackoverflow.com/questions/56777134/ordering-items-by-sizename-when-its-not-alphabetically-logic", "title": "Ordering items by sizename when it&#39;s not alphabetically logic?", "body": "<p>In my app, the admin may add sizes to his products in this order. </p>\n\n<ul>\n<li><code>Variant.create(size_name: \"L\")</code></li>\n<li><code>Variant.create(size_name: \"S\")</code></li>\n<li><code>Variant.create(size_name: \"XXL\")</code> </li>\n<li><code>Variant.create(size_name: \"XL\")</code></li>\n</ul>\n\n<p>Sizes could also be (30,24, 33, 31, 29)</p>\n\n<p>In my product view, the select tag display in the order it has been created. \nI would like to sort from the smallest size to the biggest (S, M, L ...). \nWith the numerically sizes,I can order from the smallest to the biggest it's Okay</p>\n\n<p>How I am supped to make sure that both sizes (the numerically and the alphabetically) could be sorted from the smallest to the biggest?</p>\n"}, {"tags": ["ruby", "class", "oop"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1561570063, "post_id": 56777007, "comment_id": 100111552, "body": "Want to be more confused? <code>Class</code>&#39;s superclass is <code>Module</code> but <code>Module</code>&#39;s class is <code>Class</code> so <code>Module</code> is a <code>Module</code> and a <code>Class</code> just as a <code>Class</code> is a <code>Class</code> and a <code>Module</code>. But while <code>Module</code> is an instance of the class <code>Class</code> you cannot have an instance of the class <code>Module</code>. <a href=\"https://ruby-doc.org/core-2.6.3/Class.html\" rel=\"nofollow noreferrer\">Docs showing class Diagram</a> This is all handled through anonymous metaclasses (<code>singleton</code> or <code>eigen</code>) so while <code>BasicObject</code> is the parent to all classes <code>BasicObject</code>&#39;s eigenclass is <code>Class</code> e.g. <code>BasicObject.singleton_class #&gt; &lt;Class:BasicObject&gt;</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1561788674, "post_id": 56777007, "comment_id": 100184514, "body": "Your question is confusing. 1) In the title you ask about classes to do not inherit from <code>Class</code>, in the text, you ask about classes that aren&#39;t instances of <code>Class</code>. Those are <i>two completely different things</i>. Which one are you asking about? 2) There are <i>no</i> classes that inherit from <code>Class</code> and there are <i>no</i> classes which are not instances of <code>Class</code>, so regardless of which of the two questions you actually mean, it is hard to answer, since you don&#39;t give any concrete examples."}], "answers": [{"comments": [{"owner": {"reputation": 1018, "user_id": 5163063, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-zT-tk41cKas/AAAAAAAAAAI/AAAAAAAAABM/LnD3dq1CvjY/photo.jpg?sz=128", "display_name": "David Kennell", "link": "https://stackoverflow.com/users/5163063/david-kennell"}, "edited": false, "score": 0, "creation_date": 1561590065, "post_id": 56777331, "comment_id": 100118720, "body": "Right, I have to be sure to keep the difference in mind between being an instance of a class vs a subclass of it. I guess it&#39;s just very surprising to me that class A can be a parent class of class B while also being an instance of class B. That means that class A ends up inheriting from itself, right? I would have imagined that this kind of circular inheritance would cause problems, but I guess not!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561788745, "post_id": 56777331, "comment_id": 100184526, "body": "&quot;That means that class A ends up inheriting from itself, right?&quot; \u2013 No, it doesn&#39;t mean that, because, as you just said in the sentence before, inheritance and instance are two completely different things."}], "tags": [], "owner": {"reputation": 106, "user_id": 9821073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8858c099229414c500e3ff547d94d15e?s=128&d=identicon&r=PG&f=1", "display_name": "AmazingRein", "link": "https://stackoverflow.com/users/9821073/amazingrein"}, "is_accepted": false, "score": 2, "last_activity_date": 1561566901, "last_edit_date": 1561566901, "creation_date": 1561566534, "answer_id": 56777331, "question_id": 56777007, "link": "https://stackoverflow.com/questions/56777007/how-do-we-talk-about-classes-that-do-not-inherit-from-the-class-class-in-ruby/56777331#56777331", "title": "How do we talk about classes that do not inherit from the `Class` class in Ruby?", "body": "<p>You can treat all classes are instances of <code>Class</code> in the Ruby world. Worth remembering that everything in ruby is an object, including classes. Yes <code>BasicObject</code> is the top parent class of all classes in Ruby. The class of <code>BasicObject</code> being <code>Class</code>, is not the same as the parent class of <code>BasicObject</code> is <code>Class</code>.</p>\n\n<p>To demonstrate, assume that we have a class <code>Person</code> defined.</p>\n\n<ul>\n<li><code>Person.new.class</code> is <code>Person</code></li>\n<li><code>Person.class</code> is <code>Class</code></li>\n<li><code>Person.superclass</code> is <code>Object</code></li>\n<li><code>Object.class</code> is <code>Class</code></li>\n<li><code>Object.superclass</code> is <code>BasicObject</code></li>\n<li><code>BasicObject.class</code> is <code>Class</code></li>\n<li><code>BasicObject.superclass</code> is <code>nil</code></li>\n</ul>\n\n<p>Proof of all classes in Ruby are in fact objects, you can get the object id of a class. <code>BasicObject.object_id</code>. In the general object-oriented context, a class of a class shouldn't make sense, unless classes are also objects.</p>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1561582120, "last_edit_date": 1561582120, "creation_date": 1561581652, "answer_id": 56780567, "question_id": 56777007, "link": "https://stackoverflow.com/questions/56777007/how-do-we-talk-about-classes-that-do-not-inherit-from-the-class-class-in-ruby/56780567#56780567", "title": "How do we talk about classes that do not inherit from the `Class` class in Ruby?", "body": "<p>As mind-bending as it sounds, it really is like that. <code>BasicObject</code> is a <code>Class</code> and <code>Class</code> is a <code>BasicObject</code>.</p>\n\n<p>I don't think it's possible to express in ruby, so to make this work MRI <a href=\"https://github.com/ruby/ruby/blob/24c4e6dec109e105c13bd4c1b7f7cd51e534a3c3/class.c#L545-L563\" rel=\"nofollow noreferrer\">direcly creates internal structures for these few fundamental classes and wires them in this cyclical manner</a>.</p>\n\n<pre><code>void\nInit_class_hierarchy(void)\n{\n    rb_cBasicObject = boot_defclass(\"BasicObject\", 0);\n    rb_cObject = boot_defclass(\"Object\", rb_cBasicObject);\n    rb_gc_register_mark_object(rb_cObject);\n\n    /* resolve class name ASAP for order-independence */\n    rb_set_class_path_string(rb_cObject, rb_cObject, rb_fstring_lit(\"Object\"));\n\n    rb_cModule = boot_defclass(\"Module\", rb_cObject);\n    rb_cClass =  boot_defclass(\"Class\",  rb_cModule);\n\n    rb_const_set(rb_cObject, rb_intern_const(\"BasicObject\"), rb_cBasicObject);\n    RBASIC_SET_CLASS(rb_cClass, rb_cClass);\n    RBASIC_SET_CLASS(rb_cModule, rb_cClass);\n    RBASIC_SET_CLASS(rb_cObject, rb_cClass);\n    RBASIC_SET_CLASS(rb_cBasicObject, rb_cClass);\n}\n</code></pre>\n\n<p>As we can see, there are no two class types, user-facing one and \"deep\" one. It's the same entity. </p>\n"}], "owner": {"reputation": 1018, "user_id": 5163063, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-zT-tk41cKas/AAAAAAAAAAI/AAAAAAAAABM/LnD3dq1CvjY/photo.jpg?sz=128", "display_name": "David Kennell", "link": "https://stackoverflow.com/users/5163063/david-kennell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1561582120, "creation_date": 1561565190, "question_id": 56777007, "link": "https://stackoverflow.com/questions/56777007/how-do-we-talk-about-classes-that-do-not-inherit-from-the-class-class-in-ruby", "title": "How do we talk about classes that do not inherit from the `Class` class in Ruby?", "body": "<p><a href=\"https://ruby-doc.org/core-2.6.1/BasicObject.html\" rel=\"nofollow noreferrer\">BasicObject</a>, as far as I have read, is the parent class of all other classes in Ruby. However, it's not until further down in the hierarchy where the <code>Class</code> class is actually defined. As such, I'm having a hard time understanding how <code>BasicObject</code> can be a class at all.</p>\n\n<p>Is the difference here just that there's a difference between a ruby <code>Class</code> in an abstract, object-oriented sense as opposed to classes that are actually instances of <code>Class</code>? Or is the hierarchy actually set up in a way where <code>BasicObject</code> is in fact an instance of <code>Class</code>? I feel pretty sure that's not the case.</p>\n\n<p>If there are two meanings for the word \"class\" in Ruby, I feel like I lack the language to discuss the two types. If this is indeed the case, what can I call a class that is not an instance of <code>Class</code>?</p>\n"}, {"tags": ["regex", "ruby", "logstash"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561564848, "post_id": 56776831, "comment_id": 100109135, "body": "Please edit your question to include the code you&#39;ve written so far. We can&#39;t write your code for you but we can help you once you&#39;ve made an attempt."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 2, "last_activity_date": 1561565011, "last_edit_date": 1592644375, "creation_date": 1561565011, "answer_id": 56776956, "question_id": 56776831, "link": "https://stackoverflow.com/questions/56776831/find-a-certain-word-in-pipe-seperated-values/56776956#56776956", "title": "Find a certain word in pipe seperated values", "body": "<p>I'm not quite sure about our desired output, we can likely start with an expression similar to:</p>\n<pre><code>^(.+?)\\|(.+?)\\|(.+?)\\|(.+?)\\|\\/test\\/.+?\\|(.+?)\\|.+$\n</code></pre>\n<p>and check for <code>test</code>.</p>\n<p>In this <a href=\"https://regex101.com/r/W5JYlK/1/\" rel=\"nofollow noreferrer\">demo</a>, the expression is explained, if you might be interested.</p>\n<h3>Example</h3>\n<pre><code>re = /^(.+?)\\|(.+?)\\|(.+?)\\|(.+?)\\|\\/test\\/.+?\\|(.+?)\\|.+$/m\nstr = '20190614|3|method|user|/test/xyz/1.1|400|0\n20190614|3|method|user|/testt/xyz/1.1|400|0'\n\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1561567791, "post_id": 56777023, "comment_id": 100110532, "body": "This is a good answer, but <code>nth_value.to_s.scan(&#47;^\\&#47;test&#47;).any?</code> is overkill when you could do <code>nth_value =~ &#47;^\\&#47;test&#47;</code> or <code>nth_value.start_with?(&quot;&#47;test&quot;)</code>."}, {"owner": {"reputation": 106, "user_id": 9821073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8858c099229414c500e3ff547d94d15e?s=128&d=identicon&r=PG&f=1", "display_name": "AmazingRein", "link": "https://stackoverflow.com/users/9821073/amazingrein"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561568612, "post_id": 56777023, "comment_id": 100110873, "body": "@JordanRunning thanks for that. Will edit the answer."}], "tags": [], "owner": {"reputation": 106, "user_id": 9821073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8858c099229414c500e3ff547d94d15e?s=128&d=identicon&r=PG&f=1", "display_name": "AmazingRein", "link": "https://stackoverflow.com/users/9821073/amazingrein"}, "is_accepted": false, "score": 2, "last_activity_date": 1561568709, "last_edit_date": 1561568709, "creation_date": 1561565235, "answer_id": 56777023, "question_id": 56776831, "link": "https://stackoverflow.com/questions/56776831/find-a-certain-word-in-pipe-seperated-values/56777023#56777023", "title": "Find a certain word in pipe seperated values", "body": "<p>Your question is not conveyed clearly, but I'll just assume that a single message is composed of multiple values joined by pipes.</p>\n\n<pre><code>n = 5\nmessage = '20190614|3|method|user|/test/xyz/1.1|400|0'\nnth_value = message.split('|')[n - 1]\nputs 'Matching' if nth_value =~ /^\\/test/\n</code></pre>\n\n<p>Convert this to into a function and modify it to suit your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 3887, "user_id": 6113627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zNUc0.jpg?s=128&g=1", "display_name": "baudsp", "link": "https://stackoverflow.com/users/6113627/baudsp"}, "is_accepted": false, "score": 0, "last_activity_date": 1561626372, "creation_date": 1561626372, "answer_id": 56787615, "question_id": 56776831, "link": "https://stackoverflow.com/questions/56776831/find-a-certain-word-in-pipe-seperated-values/56787615#56787615", "title": "Find a certain word in pipe seperated values", "body": "<p>In Logstash, if you want to filter on messages which starts with \"/test\" in the 5th value, you can do this (using the regex from Emma):</p>\n\n<pre><code>filter {\n  if [message] =~ /^(.+?)\\|(.+?)\\|(.+?)\\|(.+?)\\|\\/test\\/.+?\\|(.+?)\\|.+$/ {\n    ...\n  }\n}\n</code></pre>\n\n<p>Cf <a href=\"https://www.elastic.co/guide/en/logstash/current/event-dependent-configuration.html#conditionals\" rel=\"nofollow noreferrer\">https://www.elastic.co/guide/en/logstash/current/event-dependent-configuration.html#conditionals</a> for more information.</p>\n"}], "owner": {"reputation": 163, "user_id": 8285291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee2400893b2f85c44be85d76ac5d283?s=128&d=identicon&r=PG&f=1", "display_name": "sn879", "link": "https://stackoverflow.com/users/8285291/sn879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1561626372, "creation_date": 1561564577, "question_id": 56776831, "link": "https://stackoverflow.com/questions/56776831/find-a-certain-word-in-pipe-seperated-values", "title": "Find a certain word in pipe seperated values", "body": "<p>I am trying to figure out how to match a certain word in pipe separated messages.</p>\n\n<p>Ex: 20190614|3|method|user|/test/xyz/1.1|400|0</p>\n\n<p>How do I check every message which starts with \"/test\" in the 5th value?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "polymorphic-associations"], "answers": [{"comments": [{"owner": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561573765, "post_id": 56777002, "comment_id": 100113174, "body": "Actually the merge seems not to be doing anything. the pluck collects the id of the addresses, not the users."}, {"owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "reply_to_user": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561573944, "post_id": 56777002, "comment_id": 100113259, "body": "You would have to use <code>.pluck(:user_id)</code> to pluck user ids of the addresses that have been fetched"}, {"owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "reply_to_user": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561574070, "post_id": 56777002, "comment_id": 100113317, "body": "Also, for <code>.merge</code> to have any effect, you would have to declare a scope on <code>User</code> called <code>admin</code> which would get the admin users.  <code>scope :admin, -&gt; () { is_admin: true }</code> on <code>app&#47;models&#47;user.rb</code>"}, {"owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "reply_to_user": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561574644, "post_id": 56777002, "comment_id": 100113567, "body": "Did that help ?"}, {"owner": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561586068, "post_id": 56777002, "comment_id": 100117692, "body": "I did that, but the merge still does not have any effect."}, {"owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "reply_to_user": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561632687, "post_id": 56777002, "comment_id": 100132992, "body": "Oh, I&#39;m sorry. The join with users should have been an &quot;INNER JOIN&quot; instead of a &quot;LEFT JOIN&quot;. Also, could you please add the <code>to_sql</code> result of the query above? (You&#39;ll have to run <code>.to_sql</code> by removing the <code>pluck</code> part.)"}, {"owner": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "edited": false, "score": 0, "creation_date": 1561636874, "post_id": 56777002, "comment_id": 100135317, "body": "It works with the INNER JOIN. Thank you for your time!"}], "tags": [], "owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "is_accepted": true, "score": 2, "last_activity_date": 1561652533, "last_edit_date": 1561652533, "creation_date": 1561565176, "answer_id": 56777002, "question_id": 56776812, "link": "https://stackoverflow.com/questions/56776812/rails-joins-polymorphic-model-attribute-where-condition-is-met/56777002#56777002", "title": "Rails joins polymorphic model attribute where condition is met", "body": "<p>You cannot directly join the <code>addressable</code> relation as the addressable entities could belong to different models. You could try something like this:</p>\n\n<pre><code>Address\n  .near([@address.latitude, @address.longitude], 5)\n  .where(addressable_type: 'User')\n  .joins(\"INNER JOIN users on users.id = addresses.addressable_id\")\n  .merge(User.admin)\n  .pluck(:id)\n</code></pre>\n\n<p><code>.merge</code> can be used to invoke scopes of joined tables. Here, <code>User</code> model would have a scope called <code>admin</code> which would return admin users.</p>\n"}], "owner": {"reputation": 1271, "user_id": 6015670, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/900baefc5c7d81efc949c24d6e00ec7d?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6015670/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 56777002, "answer_count": 1, "score": 0, "last_activity_date": 1561652533, "creation_date": 1561564527, "question_id": 56776812, "link": "https://stackoverflow.com/questions/56776812/rails-joins-polymorphic-model-attribute-where-condition-is-met", "title": "Rails joins polymorphic model attribute where condition is met", "body": "<p>I can't figure out how to make this query work. I'm looking to get all the user ids of addresses who have a user that is an admin.</p>\n\n<pre><code>Address\n.near([@address.latitude, @address.longitude], 5)\n.where(addressable_type: 'User')\n.joins(:addressable)\n.where('addressable.is_admin = ?', true)\n.pluck(:id)\n</code></pre>\n\n<p>Address.rb</p>\n\n<pre><code>class Address &lt; ApplicationRecord\n  belongs_to :addressable, polymorphic: true\n</code></pre>\n\n<p>User.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_one :address, :as =&gt; :addressable, dependent: :destroy\n</code></pre>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561676919, "post_id": 56775784, "comment_id": 100153383, "body": "Why do you want to create an HTML element as XML?"}, {"owner": {"reputation": 7685, "user_id": 517868, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/771951f55ed37335f238e1a80dfda9cd?s=128&d=identicon&r=PG", "display_name": "Juanito Fatas", "link": "https://stackoverflow.com/users/517868/juanito-fatas"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561775616, "post_id": 56775784, "comment_id": 100183258, "body": "To test something that receives <code>Nokogiri::XML::Element</code> as input in test."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561933265, "post_id": 56775784, "comment_id": 100209344, "body": "Just so you know, Nokogiri turns on very strict checking of the XML when doing that, which can cause problems because HTML usually requires the parse and generation to relax its idea of what&#39;s valid."}], "answers": [{"tags": [], "owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "is_accepted": false, "score": 0, "last_activity_date": 1561561601, "creation_date": 1561561601, "answer_id": 56775925, "question_id": 56775784, "link": "https://stackoverflow.com/questions/56775784/how-to-initialize-a-nokogirixmlelement/56775925#56775925", "title": "How to initialize a Nokogiri::XML::Element", "body": "<p>You're looking for <code>Nokogiri::HTML.fragment</code>:</p>\n\n<pre><code>html = '&lt;a href=\"https://example.com\"&gt;Link&lt;/a&gt;'\nNokogiri::HTML.fragment html\n#=&gt; #(DocumentFragment:0x2b296b79c0c4 { name = \"#document-fragment\", children = [ #(Element:0x2b296919d724 { name = \"a\", attributes = [ #(Attr:0x2b296919d6fc { name = \"href\", value = \"https://example.com\" })], children = [ #(Text \"Link\")] })] })\nasd.children.last\n#=&gt; #(Element:0x2b296b7cbe50 { name = \"a\", attributes = [ #(Attr:0x2b296b7cbe28 { name = \"href\", value = \"https://example.com\" })], children = [ #(Text \"Link\")] })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1561564145, "post_id": 56776201, "comment_id": 100108774, "body": "Nice! I didn&#39;t know about <code>Nokogiri.make</code>"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 4, "last_activity_date": 1561563640, "last_edit_date": 1561563640, "creation_date": 1561562523, "answer_id": 56776201, "question_id": 56775784, "link": "https://stackoverflow.com/questions/56775784/how-to-initialize-a-nokogirixmlelement/56776201#56776201", "title": "How to initialize a Nokogiri::XML::Element", "body": "<p><code>Nokogiri</code> provides the <code>make</code> method (<a href=\"https://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri#make-class_method\" rel=\"nofollow noreferrer\"><code>Nokogiri::make</code></a>) as a convenience method for creating a <code>DocumentFragment</code> and the code is nearly identical to what you are doing now:</p>\n\n<pre><code>def make input = nil, opts = {}, &amp;blk\n  if input\n    Nokogiri::HTML.fragment(input).children.first\n  else\n    Nokogiri(&amp;blk)\n  end\nend\n</code></pre>\n\n<p>example: </p>\n\n<pre><code>html = '&lt;a href=\"https://example.com\"&gt;Link&lt;/a&gt;'\nrequire 'nokogiri'\nNokogiri.make(html)\n#=&gt; #&lt;Nokogiri::XML::Element:0x2afe5af3a04c name=\"a\" attributes=\n#    [#&lt;Nokogiri::XML::Attr:0x2afe5ac33efc name=\"href\" value=\"https://example.com\"&gt;] \n#     children=[#&lt;Nokogiri::XML::Text:0x2afe5ac32408 \"Link\"&gt;]&gt;\n</code></pre>\n\n<p>Other options include </p>\n\n<pre><code>Nokogiri(html).first_element_child\nNokogiri.parse(html).first_element_child\n</code></pre>\n"}], "owner": {"reputation": 7685, "user_id": 517868, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/771951f55ed37335f238e1a80dfda9cd?s=128&d=identicon&r=PG", "display_name": "Juanito Fatas", "link": "https://stackoverflow.com/users/517868/juanito-fatas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 56776201, "answer_count": 2, "score": 0, "last_activity_date": 1561676839, "creation_date": 1561561190, "last_edit_date": 1561676839, "question_id": 56775784, "link": "https://stackoverflow.com/questions/56775784/how-to-initialize-a-nokogirixmlelement", "title": "How to initialize a Nokogiri::XML::Element", "body": "<p>I would like to initialize a <code>Nokogiri::XML::Element</code> object using:</p>\n\n<pre><code>html = '&lt;a href=\"https://example.com\"&gt;Link&lt;/a&gt;'\nNokogiri::XML::Element.new(html)\n</code></pre>\n\n<p>But currently I have to do this:</p>\n\n<pre><code>Nokogiri::HTML::DocumentFragment.parse(html).children.last\n</code></pre>\n\n<p>Is there a better way?</p>\n"}, {"tags": ["ruby", "heroku", "sinatra", "heroku-postgres"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561559727, "post_id": 56774854, "comment_id": 100106078, "body": "What are bundler and ruby versions on your local pc?"}], "answers": [{"comments": [{"owner": {"reputation": 362, "user_id": 11703419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf99c122885da9ffffbb0aeb843cf2d?s=128&d=identicon&r=PG", "display_name": "Donnovan", "link": "https://stackoverflow.com/users/11703419/donnovan"}, "edited": false, "score": 0, "creation_date": 1561566169, "post_id": 56775838, "comment_id": 100109807, "body": "This solved it. Thank you! Now that my app is deployed, it&#39;s not working, but glad this part is fixed."}, {"owner": {"reputation": 1127, "user_id": 797639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080c6d9e82281d627bd2812258702640?s=128&d=identicon&r=PG", "display_name": "pierrea", "link": "https://stackoverflow.com/users/797639/pierrea"}, "edited": false, "score": 2, "creation_date": 1561587895, "post_id": 56775838, "comment_id": 100118181, "body": "This is correct\u2014here is the corresponding changelog: <a href=\"https://devcenter.heroku.com/changelog-items/1656\" rel=\"nofollow noreferrer\">devcenter.heroku.com/changelog-items/1656</a>"}, {"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "reply_to_user": {"reputation": 362, "user_id": 11703419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf99c122885da9ffffbb0aeb843cf2d?s=128&d=identicon&r=PG", "display_name": "Donnovan", "link": "https://stackoverflow.com/users/11703419/donnovan"}, "edited": false, "score": 0, "creation_date": 1561647073, "post_id": 56775838, "comment_id": 100141943, "body": "@Donnovan glad to help! What about accepting my answer?"}], "tags": [], "owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "is_accepted": true, "score": 3, "last_activity_date": 1562141205, "last_edit_date": 1562141205, "creation_date": 1561561346, "answer_id": 56775838, "question_id": 56774854, "link": "https://stackoverflow.com/questions/56774854/how-do-i-fix-a-bundler-conflict-when-pushing-to-heroku/56775838#56775838", "title": "How do I fix a Bundler Conflict when pushing to Heroku?", "body": "<p>I've ran into this issue some time ago: I contacted Heroku and they told me they have a locked version of Bundler, so your only option is to use the Bundler version they use:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>gem uninstall bundler\ngem install bundler -v 2.0.2\nbundle update\n</code></pre>\n"}], "owner": {"reputation": 362, "user_id": 11703419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf99c122885da9ffffbb0aeb843cf2d?s=128&d=identicon&r=PG", "display_name": "Donnovan", "link": "https://stackoverflow.com/users/11703419/donnovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "accepted_answer_id": 56775838, "answer_count": 1, "score": 3, "last_activity_date": 1585732395, "creation_date": 1561558246, "last_edit_date": 1585732395, "question_id": 56774854, "link": "https://stackoverflow.com/questions/56774854/how-do-i-fix-a-bundler-conflict-when-pushing-to-heroku", "title": "How do I fix a Bundler Conflict when pushing to Heroku?", "body": "<p>I'm attempting to deploy a Sinatra app to Heroku. Everything works locally. However I get an issue with bundler when I try to push it successfully to Heroku.</p>\n\n<p>I've tried to delete the Gemfile lock and then the following</p>\n\n<pre><code>bundle update\ngit add .\ngit push \"Gemfile.lock\"\ngit push heroku master\n</code></pre>\n\n<pre><code>gem install bundler:2.0.1\nbundle install\ngit add .\ngit push \"Gemfile.lock\"\ngit push heroku master\n</code></pre>\n\n<pre><code>bundle update --bundler\ngit add .\ngit push \"Gemfile.lock\"\ngit push heroku master\n</code></pre>\n\n<p>Here is my gemfile</p>\n\n<pre><code>source \"https://rubygems.org\"\n\n# gem \"rails\"\ngem 'sinatra'\ngem 'activerecord', '~&gt; 5.2', '&gt;= 5.2.2.1'\ngem 'rake'\ngem 'sinatra-activerecord'\ngem 'require_all'\ngem 'bcrypt'\ngem 'rack-flash3'\ngem 'rb-readline'\n\ngroup :development, :test do\n gem 'sqlite3'\n gem 'shotgun'\n gem 'pry'\nend\n\ngroup :production do\n gem 'pg'\nend\n</code></pre>\n\n<p>Here are the error messages</p>\n\n<pre><code>remote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rack\nremote: -----&gt; Using Ruby version: ruby-2.5.5\nremote: -----&gt; Installing dependencies using bundler 2.0.2\nremote:        Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Activating bundler (2.0.1) failed:\nremote:        Could not find 'bundler' (2.0.1) required by your /tmp/build_77505ef74596fc4dddd66c8b792d759b/Gemfile.lock.\nremote:        To update to the latest version installed on your system, run `bundle update --bundler`.\nremote:        To install the missing version, run `gem install bundler:2.0.1`\nremote:        Checked in 'GEM_PATH=vendor/bundle/ruby/2.5.0', execute `gem env` for more information\nremote:        \nremote:        To install the version of bundler this project requires, run `gem install bundler -v '2.0.1'`\nremote:        Bundler Output: Activating bundler (2.0.1) failed:\nremote:        Could not find 'bundler' (2.0.1) required by your /tmp/build_77505ef74596fc4dddd66c8b792d759b/Gemfile.lock.\nremote:        To update to the latest version installed on your system, run `bundle update --bundler`.\nremote:        To install the missing version, run `gem install bundler:2.0.1`\nremote:        Checked in 'GEM_PATH=vendor/bundle/ruby/2.5.0', execute `gem env` for more information\nremote:        \nremote:        To install the version of bundler this project requires, run `gem install bundler -v '2.0.1'`\nremote: \nremote:  !\nremote:  !     Failed to install gems via Bundler.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !   Push rejected to infinite-waters-69714.\nremote: \nTo https://git.heroku.com/infinite-waters-69714.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\n</code></pre>\n\n<p>Additionally, I've tried to remove sqlite3 altogether and repeat the above processes.</p>\n\n<p>Any ideas on how to fix this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561579112, "post_id": 56774745, "comment_id": 100115225, "body": "<code>days_to_expire = 30; fmt =  &#39;%d&#47;%m&#47;%Y&#39;; (DateTime.strptime(&#39;01&#47;05&#47;2019&#39;, fmt).to_date + days_to_expire).strftime(fmt) #=&gt; &quot;31&#47;05&#47;2019&quot;</code>. This returns the day before that given in the question. I assume that&#39;s do to a counting issue. Please edit to clarify the date you wish to compute."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561581640, "post_id": 56774745, "comment_id": 100116154, "body": "<code>01&#47;05&#47;2019</code> and <code>01&#47;06&#47;2019</code> are not valid Ruby objects. Yes, I know what you mean, at least by the first (presumably the string <code>&quot;01&#47;05&#47;2019&quot;</code>), but I don&#39;t know if you mean the latter to be the string  <code>&quot;01&#47;06&#47;2019&quot;</code> or the <code>Date</code> object that represents that string. Be precise! If a value is string, enclose it in quotes. It would be better to write something like this: <code>publication_date = &quot;01&#47;05&#47;2019&quot;</code> and <code>days_to_expire =  30</code>."}, {"owner": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "reply_to_user": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1561607011, "post_id": 56774745, "comment_id": 100121581, "body": "@laurenzAlbe - please do not translate someone else&#39;s post (this has been discussed on Meta - see <a href=\"https://meta.stackoverflow.com/a/297680/272109\">here</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561581188, "post_id": 56778122, "comment_id": 100115986, "body": "Did you test your answer? If you must use <code>parse</code> why not <code>Date::parse</code> to avoid the roundabout conversion to time and adding seconds? Note the return value required is neither a <code>Time</code> nor <code>Date</code> object."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561583696, "post_id": 56778122, "comment_id": 100116950, "body": "I did test my answer, and the question is asking for general guidance on date/time manipulation: &quot;I&#39;m going to get a whole number and with that I want to determine a date to expire a certain content [and] How can I solve this? Do you have any documentation or function to help me?&quot;. The example they give is a simplified version of what they are asking. Using <code>Date</code> in this case may be less confusing, though either work fine in helping push towards understanding how to solve the broader problem and using <code>Time</code> allows for more specificity."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561584041, "post_id": 56778122, "comment_id": 100117075, "body": "The reason I asked about testing is that Ruby does not have a method <code>Time::parse</code> (<code>DateTime.parse</code> must be used, then <code>.to_date</code> or <code>.to_time</code>, as needed). Perhaps Rails has a method <code>Time::parse</code>. My main point is that, to obtain a date from a date, it&#39;s easier to add <code>30</code> to a <code>Date.parse(...)</code> than to add the corresponding number of seconds to a <code>Time.parse(...)</code>."}, {"owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561584111, "post_id": 56778122, "comment_id": 100117095, "body": "Ruby does have a method <code>Time::parse</code> <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/time/rdoc/Time.html#method-c-parse\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.6.3/libdoc/time/rdoc/&hellip;</a>"}], "tags": [], "owner": {"reputation": 402, "user_id": 6202371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uu5Tq.jpg?s=128&g=1", "display_name": "weilandia", "link": "https://stackoverflow.com/users/6202371/weilandia"}, "is_accepted": true, "score": 0, "last_activity_date": 1561588869, "last_edit_date": 1561588869, "creation_date": 1561569722, "answer_id": 56778122, "question_id": 56774745, "link": "https://stackoverflow.com/questions/56774745/how-do-i-know-the-difference-of-days-months-and-years-from-a-date-can-i-use-s/56778122#56778122", "title": "How do I know the difference of days, months, and years from a date, can I use subtraction?", "body": "<p>There are a handful of ways to accomplish what you're trying to do -- Here are a few possibilities.</p>\n\n<p>Using <code>Time</code> (my recommendation so you have more flexibility later depending on how your needs change and how you end up expiring content):\nYou can convert the \"days to expire\" to seconds and then add that to your time object.  For example:</p>\n\n<pre><code>require \"time\"\n\nt = Time.parse(\"01/05/2019\")\ndays_to_expire = 30\nexpiration = t + (60 * 60 * 24 * days_to_expire)\n</code></pre>\n\n<p>Using <code>Date</code>:</p>\n\n<pre><code>require \"date\"\n\nd = Date.parse(\"01/05/2019\")\ndays_to_expire = 30\nexpiration = d + days_to_expire\n</code></pre>\n\n<p>Using built-in helpers from Rails <code>Active::Support</code>:</p>\n\n<pre><code>t = Time.parse(\"01/05/2019\")\ndays_to_expire = 30\nexpiration = t + days_to_expire.days\n</code></pre>\n\n<p>You can learn more about Ruby <code>Time</code> <a href=\"https://ruby-doc.org/core-2.6/Time.html#method-i-2B\" rel=\"nofollow noreferrer\">here</a> and you can learn about the helpers built-in to <code>Time</code> and <code>Numeric</code> by Rails <a href=\"https://api.rubyonrails.org/classes/Time.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://api.rubyonrails.org/classes/Numeric.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561579516, "post_id": 56778298, "comment_id": 100115287, "body": "Why <code>DateTime.parse</code> rather than <code>Date.parse</code>? Ruby requires <code>DateTime.parse.to_date</code> to then add <code>30</code>. Does Rails not? Note that <code>DateTime.parse(&quot;You may find that &#39;parse&#39; does not always give the result you expect&quot;) #=&gt; #&lt;DateTime: 2019-05-01T00:00:00+00:00, ((2458605j,0s,0n),+0s,2299161j)&gt; </code>. Better to use <code>strptime</code>."}, {"owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561909010, "post_id": 56778298, "comment_id": 100204424, "body": "Oh, thanks! I was unaware of <code>DateTime.parse</code> not being accurate all the time. I&#39;d decided to suggest <code>DateTime</code> instead of <code>Date</code> because I had incorrectly assumed that the OP may need time specific calculations as well. I&#39;ll update the answer to use <code>Date</code>. Thanks!"}], "tags": [], "owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1561909048, "last_edit_date": 1561909048, "creation_date": 1561570413, "answer_id": 56778298, "question_id": 56774745, "link": "https://stackoverflow.com/questions/56774745/how-do-i-know-the-difference-of-days-months-and-years-from-a-date-can-i-use-s/56778298#56778298", "title": "How do I know the difference of days, months, and years from a date, can I use subtraction?", "body": "<p>I'll answer this assuming the project is in Rails since this question is tagged as a Rails one. You could do something like this:</p>\n\n<pre><code>t = Date.parse(\"01/05/2019\")\ndays_to_expire = 30   # Obtained from user input in your case\nresult = t + days_to_expire.days   # Similar to result = t + 30.days\n</code></pre>\n\n<p>You could check out more about <code>Date</code> <a href=\"https://api.rubyonrails.org/classes/Date.html\" rel=\"nofollow noreferrer\">in the API docs here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10407723, "user_type": "registered", "profile_image": "https://graph.facebook.com/584525515275266/picture?type=large", "display_name": "Thiago Silva", "link": "https://stackoverflow.com/users/10407723/thiago-silva"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1561788519, "accepted_answer_id": 56778122, "answer_count": 2, "score": -1, "last_activity_date": 1561909048, "creation_date": 1561557929, "last_edit_date": 1561567365, "question_id": 56774745, "link": "https://stackoverflow.com/questions/56774745/how-do-i-know-the-difference-of-days-months-and-years-from-a-date-can-i-use-s", "closed_reason": "Needs details or clarity", "title": "How do I know the difference of days, months, and years from a date, can I use subtraction?", "body": "<p>I'm writing an algorithm where I'm going to get a whole number and with that I want to determine a date to expire a certain content. I'm already getting the date that the content was published.</p>\n\n<p>Example:</p>\n\n<p>publication date: 01/05/2019<br>\ndays to expire: 30<br>\nresult of the program: 01/06/2019 // date of expiry of the content</p>\n\n<p>NOTE: The value of \"Days to expire\" is entered by the user.</p>\n\n<p>How can I solve this? Do you have any documentation or function to help me?</p>\n"}, {"tags": ["ruby", "v8", "freebsd", "libv8"], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1561559004, "creation_date": 1561559004, "answer_id": 56775084, "question_id": 56774403, "link": "https://stackoverflow.com/questions/56774403/libv8-with-ruby-on-freebsd-12/56775084#56775084", "title": "libv8 with ruby on FreeBSD 12", "body": "<p>Based on comments in <a href=\"https://github.com/cowboyd/libv8/issues/253\" rel=\"nofollow noreferrer\"><code>this issue</code></a> in <a href=\"https://github.com/cowboyd/libv8/\" rel=\"nofollow noreferrer\"><code>libv8 repo</code></a> there are no binary gems for FreeBSD after version 6.0.</p>\n\n<p>You could try to build from source or use downgraded version</p>\n"}], "owner": {"reputation": 675, "user_id": 5457201, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdcdc58c57984ddfa3ef8080b12bcea4?s=128&d=identicon&r=PG", "display_name": "TylerDurden", "link": "https://stackoverflow.com/users/5457201/tylerdurden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561559004, "creation_date": 1561556907, "question_id": 56774403, "link": "https://stackoverflow.com/questions/56774403/libv8-with-ruby-on-freebsd-12", "title": "libv8 with ruby on FreeBSD 12", "body": "<p>I'm trying to get a ruby app working on FreeBSD 12 but I seem to fail miserably.</p>\n\n<p>I installed v8 via <code>pkg install v8</code> and tried to install the libv8 gem via this command:</p>\n\n<pre><code>gem install libv8 -v '7.3.492.27.1' -- --with-system-v8\n</code></pre>\n\n<p>This seems to work fine until it calls <code>gclient</code> which refuses to run on FreeBSD with</p>\n\n<pre><code>KeyError: 'freebsd12'\n</code></pre>\n\n<p>I search a lot but could not find any solution to the problem. Is there any way to get libv8 working on FreeBSD?</p>\n"}, {"tags": ["ruby", "sublimetext3"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561560295, "post_id": 56774053, "comment_id": 100106442, "body": "Do you have <code>pry</code> gem installed? Run <code>gem list | grep pry</code>"}, {"owner": {"reputation": 2210, "user_id": 6813433, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6223cbb3751424e5cc29c6fd9d7b826a?s=128&d=identicon&r=PG&f=1", "display_name": "TheBAST", "link": "https://stackoverflow.com/users/6813433/thebast"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561560370, "post_id": 56774053, "comment_id": 100106488, "body": "I get no results   $ gem list | grep pry"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561560391, "post_id": 56774053, "comment_id": 100106506, "body": "install it then :) <code>gem install pry</code>"}, {"owner": {"reputation": 2210, "user_id": 6813433, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6223cbb3751424e5cc29c6fd9d7b826a?s=128&d=identicon&r=PG&f=1", "display_name": "TheBAST", "link": "https://stackoverflow.com/users/6813433/thebast"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561560433, "post_id": 56774053, "comment_id": 100106532, "body": "I&#39;m a newbie to the Ruby world, what does this mean?"}, {"owner": {"reputation": 2210, "user_id": 6813433, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6223cbb3751424e5cc29c6fd9d7b826a?s=128&d=identicon&r=PG&f=1", "display_name": "TheBAST", "link": "https://stackoverflow.com/users/6813433/thebast"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561560498, "post_id": 56774053, "comment_id": 100106580, "body": "C:/Users/Abrham/AppData/Roaming/Sublime Text 3/Packages/SublimeREPL/config/Ruby/pry_repl.rb:37:in `&lt;main&gt;&#39;: uninitialized constant Pry::InputCompleter (NameError) Did you mean?  Pry::InputLock  I get this"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561744236, "post_id": 56774053, "comment_id": 100176797, "body": "<code>pry</code> is similar to Ruby&#39;s built-in <code>irb</code> but more complete. Obviously your system expects it so you need to install it."}], "owner": {"reputation": 2210, "user_id": 6813433, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/6223cbb3751424e5cc29c6fd9d7b826a?s=128&d=identicon&r=PG&f=1", "display_name": "TheBAST", "link": "https://stackoverflow.com/users/6813433/thebast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561744130, "creation_date": 1561555835, "last_edit_date": 1561744130, "question_id": 56774053, "link": "https://stackoverflow.com/questions/56774053/how-to-fix-could-find-pry-error-in-sublimerepl", "title": "How to fix &quot;could find &#39;pry error&#39;&quot; in SublimeREPL", "body": "<p>I have this code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># require 'io/console'\n\nputs \"Hello World\"\n\n# or what you can do is\n\nprint \"What is your name ? \"\nname = gets\nprint name\n</code></pre>\n\n<p>I choose to use SublimeREPL by choosing</p>\n\n<pre><code>&gt; Tools &gt; SublimeREPL &gt; Ruby &gt; Ruby\n</code></pre>\n\n<p>since I can't accept inputs with the plain Ruby build system in Sublime Text 3, but I got this error:</p>\n\n<pre><code>C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/dependency.rb:310:in `to_specs': Could not find 'pry' (&gt;= 0) among 107 total gem(s) (Gem::MissingSpecError)\nChecked in 'GEM_PATH=C:/Users/Abrham/.gem/ruby/2.5.0;C:/Ruby25-x64/lib/ruby/gems/2.5.0', execute `gem env` for more information\n  from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/dependency.rb:322:in `to_spec'\n  from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_gem.rb:65:in `gem'\n  from C:/Users/Abrham/AppData/Roaming/Sublime Text 3/Packages/SublimeREPL/config/Ruby/pry_repl.rb:2:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "if-statement", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 5, "creation_date": 1561555990, "post_id": 56773901, "comment_id": 100103601, "body": "Did you ever check what <code>ENV[&#39;CAMPAIGN_ENDED&#39;]</code> actually returns at that point in time in the code? How do you handle reading <code>.ENV</code> in your code, do you use a gem or something written on your own?"}, {"owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1561557349, "post_id": 56773901, "comment_id": 100104505, "body": "Yes, I&#39;m using the dotenv-rails gem grouped under development &amp; test. all of my other settings in my ENV file are working fine. I should add that I&#39;m using the Suspenders template (<a href=\"https://github.com/thoughtbot/suspenders\" rel=\"nofollow noreferrer\">github.com/thoughtbot/suspenders</a>)  How can I check what <code>ENV[&#39;CAMPAIGN_ENDED&#39;]</code> returns?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1561557897, "post_id": 56773901, "comment_id": 100104854, "body": "The dotenv-rails gem expect the files name to be downcase (<code>.env</code>). Can you please rename your file and check again? Did you include the code require to load the env file into your <code>config&#47;application.rb</code>? And is your <code>config.ended =</code> code after that <code>Dotenv::Railtie.load</code> call? To check the value of <code>ENV[&#39;CAMPAIGN_ENDED&#39;]</code> You can simply log its value to the Rails log and that search for that entry: <code>Rails.logger.debug(&quot;ENV[&#39;CAMPAIGN_ENDED&#39;] =&gt; #{ENV[&#39;CAMPAIGN_ENDED&#39;].inspect}&quot;)</code> It show up early after restarting the server."}, {"owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1561559762, "post_id": 56773901, "comment_id": 100106103, "body": "Thank you so much. I was missing the <code>Dotenv::Railtie.load</code> code required to load the env file. I thought it would have been all set up during the template configuration because when I ran the server for the first time, everything worked as if all the env configs were loading fine.   Just in case anyone else experiences this issue in future, you need to reset the server after you modify your .ENV file otherwise you won&#39;t see the results.  Thanks again @spickermann"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561568596, "post_id": 56773901, "comment_id": 100110864, "body": "Using environment variables to change run-time behaviour is pretty heavy-handed. You&#39;ll need to reboot your Rails process(es) to effect this change. It&#39;s often better to have a cut-off date where you can flip over from one to another, like <code>if (Campaign.ended?)</code> where that&#39;s a module that implements the logic."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1561575821, "creation_date": 1561575821, "answer_id": 56779506, "question_id": 56773901, "link": "https://stackoverflow.com/questions/56773901/ruby-on-rails-if-else-condition-not-working/56779506#56779506", "title": "Ruby on Rails if/else condition not working", "body": "<p>Please double check that you are loading your <code>.env</code> file in the <code>config/application.rb</code> with</p>\n\n<pre><code>Dotenv::Railtie.load\n</code></pre>\n\n<p>before you actually use the environment variable in this line</p>\n\n<pre><code>config.ended = ENV['CAMPAIGN_ENDED'].to_s == 'true'\n</code></pre>\n\n<p>Remember that you need to restart the Rails application after changing the <code>.env</code> file.</p>\n"}], "owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 56779506, "answer_count": 1, "score": 0, "last_activity_date": 1561575821, "creation_date": 1561555419, "question_id": 56773901, "link": "https://stackoverflow.com/questions/56773901/ruby-on-rails-if-else-condition-not-working", "title": "Ruby on Rails if/else condition not working", "body": "<p>I have a Rails application view where I want to display one of two partials depending on the ENV variable setting. For some reason, the condition is always evaluated to false so the <code>campaign_active</code> partial is displayed. I've changed the ENV to <code>true</code> and tried switching the rendering statements around and found that only the statement after <code>else</code> gets executed. What am I missing?</p>\n\n<p>Here's the view:</p>\n\n<pre><code>&lt;% if Rails.application.config.ended %&gt;\n  &lt;%= render \"users/campaign_ended\" %&gt;\n&lt;% else %&gt;\n  &lt;%= render \"users/campaign_active\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here's the <code>application.rb</code> setting:</p>\n\n<pre><code>config.ended = ENV['CAMPAIGN_ENDED'].to_s == 'true'\n</code></pre>\n\n<p>Here's the <code>.ENV</code> file:</p>\n\n<pre><code>CAMPAIGN_ENDED=true\n</code></pre>\n\n<p>The campaign setting in ENV is set to true so I expect the condition in my view to be true and render the campaign_ended partial. But instead, it renders the campaign_active partial. Now if I switch the statements around and put <code>campaign active</code> ahead of campaign ended, then the <code>campaign ended</code> partial renders. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "web-services"], "comments": [{"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1561555399, "post_id": 56773540, "comment_id": 100103212, "body": "if you have changed you key on server and can&#39;t access it anymore, than it depends on venders if you can reset access. Are you using ec2?"}, {"owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "reply_to_user": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1561556944, "post_id": 56773540, "comment_id": 100104226, "body": "@ZiaUlRehmanMughal , yes i am using ec2,"}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1561633991, "post_id": 56773540, "comment_id": 100133761, "body": "<a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/recover-access-lost-key-pair/\" rel=\"nofollow noreferrer\">aws.amazon.com/premiumsupport/knowledge-center/&hellip;</a> Try this"}], "owner": {"reputation": 947, "user_id": 7333505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade96347d4304c3c3e72b914f61d1792?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh Ranjan", "link": "https://stackoverflow.com/users/7333505/ritesh-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580716565, "creation_date": 1561554365, "last_edit_date": 1580716565, "question_id": 56773540, "link": "https://stackoverflow.com/questions/56773540/modulos-miss-match-of-myserver-key-file-during-ssl-certification-on-server", "title": "Modulos miss-match of `myserver.key` file during ssl certification on server", "body": "<p>I have accidentally changed the modulus of my  <code>myserver.key</code> on the server, is there any way to retrieve my original key file. </p>\n\n<p>Note: initially my ssl was properly integrated.</p>\n"}, {"tags": ["ruby", "http", "nginx", "gitlab"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561550969, "post_id": 56772149, "comment_id": 100100346, "body": "Did you check whats in <code>&#47;var&#47;log&#47;gitlab&#47;unicorn&#47;unicorn_stderr.log</code>?"}, {"owner": {"reputation": 33, "user_id": 9320488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a525a03b862abc314828d16f1214d69b?s=128&d=identicon&r=PG&f=1", "display_name": "Random", "link": "https://stackoverflow.com/users/9320488/random"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561551129, "post_id": 56772149, "comment_id": 100100443, "body": "Yes, I am getting this in loop  NoMethodError: undefined method <code>[]&#39; for nil:NilClass   &#47;opt&#47;gitlab&#47;embedded&#47;service&#47;gitlab-rails&#47;config&#47;initializer&zwnj;&#8203;s&#47;1_settings.rb:115:&zwnj;&#8203;in </code>block in &lt;top (required)&gt;&#39;   /opt/gitlab/embedded/service/gitlab-rails/config/initializer&zwnj;&#8203;s/1_settings.rb:114:&zwnj;&#8203;in <code>each&#39;   &#47;opt&#47;gitlab&#47;embedded&#47;service&#47;gitlab-rails&#47;config&#47;initializer&zwnj;&#8203;s&#47;1_settings.rb:114:&zwnj;&#8203;in </code>&lt;top (required)&gt;&#39;   /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/activesuppo&zwnj;&#8203;rt-4.2.7.1/lib/activ&zwnj;&#8203;e_support/dependenci&zwnj;&#8203;es.rb:268:in `load&#39;"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561551498, "post_id": 56772149, "comment_id": 100100686, "body": "Looks like a problem in <code>initializers&#47;1_settings.rb</code> on line 115. Whats in there? Maybe you dont set some env variable when you start a server"}], "owner": {"reputation": 33, "user_id": 9320488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a525a03b862abc314828d16f1214d69b?s=128&d=identicon&r=PG&f=1", "display_name": "Random", "link": "https://stackoverflow.com/users/9320488/random"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561553325, "creation_date": 1561549878, "last_edit_date": 1561553325, "question_id": 56772149, "link": "https://stackoverflow.com/questions/56772149/502-whoops-bad-gateway-gitlab-is-taking-too-much-time-to-respond", "title": "502 Whoops, Bad Gateway GitLab is taking too much time to respond", "body": "<p>I am new to gitlab and I am trying to rerun and an old git server which has been down for few weeks. It was working a month back, but suddenly it stopped working. I have also tried to upgrade the GitLab. But still error is same.  </p>\n\n<p>Output for # gitlab-ctl tail is as follows</p>\n\n<pre><code>==&gt; /var/log/gitlab/gitlab-workhorse/current &lt;==\n2019-06-26_08:56:26.40033 10.5.11.118 @ - - [2019-06-26 10:56:26.366423831 +0200 CEST] \"GET / HTTP/1.1\" 502 2422 \"\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.80 Safari/537.36\" 0.033868\n2019-06-26_08:56:26.45517 2019/06/26 10:56:26 Send static file \"/opt/gitlab/embedded/service/gitlab-rails/public/favicon.ico\" (\"\") for GET \"/favicon.ico\"\n2019-06-26_08:56:26.47561 10.5.11.118 @ - - [2019-06-26 10:56:26.454851912 +0200 CEST] \"GET /favicon.ico HTTP/1.1\" 200 5430 \"http://10.5.11.118/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.80 Safari/537.36\" 0.020684\n2019-06-26_09:17:01.51633 2019/06/26 11:17:01 error: GET \"/\": badgateway: failed after 0.000s: dial unix /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket: connect: connection refused\n2019-06-26_09:17:01.51647 2019/06/26 11:17:01 ErrorPage: serving predefined error page: 502\n2019-06-26_09:17:01.51648 10.5.11.118 @ - - [2019-06-26 11:17:01.515397035 +0200 CEST] \"GET / HTTP/1.1\" 502 2422 \"\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.80 Safari/537.36\" 0.000799\n2019-06-26_09:24:39.79408 2019/06/26 11:24:39 Starting gitlab-workhorse v0.8.5-20161031.150348\n2019-06-26_09:40:51.86440 2019/06/26 11:40:51 error: GET \"/\": badgateway: failed after 0.000s: dial unix /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket: connect: connection refused\n2019-06-26_09:40:51.86446 2019/06/26 11:40:51 ErrorPage: serving predefined error page: 502\n2019-06-26_09:40:51.86459 10.5.11.118 @ - - [2019-06-26 11:40:51.862764251 +0200 CEST] \"GET / HTTP/1.1\" 502 2422 \"\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.80 Safari/537.36\" 0.001769\n\n==&gt; /var/log/gitlab/unicorn/current &lt;==\n2019-06-26_09:48:30.83101 master failed to start, check stderr log for details\n2019-06-26_09:48:31.83785 failed to start a new unicorn master\n2019-06-26_09:48:31.85436 starting new unicorn master\n\n==&gt; /var/log/gitlab/unicorn/unicorn_stderr.log &lt;==\nI, [2019-06-26T11:48:32.609507 #10462]  INFO -- : Refreshing Gem list\n</code></pre>\n\n<p>and I am also getting following in loop in /var/log/gitlab/unicorn/unicorn_stderr.log</p>\n\n<pre><code>NoMethodError: undefined method `[]' for nil:NilClass\n  /opt/gitlab/embedded/service/gitlab-rails/config/initializers/1_settings.rb:115:in `block in &lt;top (required)&gt;'\n  /opt/gitlab/embedded/service/gitlab-rails/config/initializers/1_settings.rb:114:in `each'\n  /opt/gitlab/embedded/service/gitlab-rails/config/initializers/1_settings.rb:114:in `&lt;top (required)&gt;'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/activesupport-4.2.7.1/lib/active_support/dependencies.rb:268:in `load'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/activesupport-4.2.7.1/lib/active_support/dependencies.rb:268:in `block in load'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/activesupport-4.2.7.1/lib/active_support/dependencies.rb:240:in `load_dependency'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/activesupport-4.2.7.1/lib/active_support/dependencies.rb:268:in `load'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/engine.rb:652:in `block in load_config_initializer'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/activesupport-4.2.7.1/lib/active_support/notifications.rb:166:in `instrument'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/engine.rb:651:in `load_config_initializer'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/engine.rb:616:in `block (2 levels) in &lt;class:Engine&gt;'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/engine.rb:615:in `each'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/engine.rb:615:in `block in &lt;class:Engine&gt;'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/initializable.rb:30:in `instance_exec'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/initializable.rb:30:in `run'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/initializable.rb:55:in `block in run_initializers'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:422:in `block (2 levels) in each_strongly_connected_component_from'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:421:in `block in each_strongly_connected_component_from'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/initializable.rb:44:in `each'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/initializable.rb:44:in `tsort_each_child'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:415:in `call'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:415:in `each_strongly_connected_component_from'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:347:in `each'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:347:in `call'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\n  /opt/gitlab/embedded/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/initializable.rb:54:in `run_initializers'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/railties-4.2.7.1/lib/rails/application.rb:352:in `initialize!'\n  /opt/gitlab/embedded/service/gitlab-rails/config/environment.rb:5:in `&lt;top (required)&gt;'\n  /opt/gitlab/embedded/service/gitlab-rails/config.ru:19:in `require'\n  /opt/gitlab/embedded/service/gitlab-rails/config.ru:19:in `block in &lt;main&gt;'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/rack-1.6.4/lib/rack/builder.rb:55:in `instance_eval'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/rack-1.6.4/lib/rack/builder.rb:55:in `initialize'\n  /opt/gitlab/embedded/service/gitlab-rails/config.ru:1:in `new'\n  /opt/gitlab/embedded/service/gitlab-rails/config.ru:1:in `&lt;main&gt;'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/unicorn-5.1.0/lib/unicorn.rb:56:in `eval'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/unicorn-5.1.0/lib/unicorn.rb:56:in `block in builder'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/unicorn-5.1.0/lib/unicorn/http_server.rb:752:in `build_app!'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/unicorn-5.1.0/lib/unicorn/http_server.rb:129:in `start'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/gems/unicorn-5.1.0/bin/unicorn:126:in `&lt;top (required)&gt;'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/bin/unicorn:22:in `load'\n  /opt/gitlab/embedded/service/gem/ruby/2.3.0/bin/unicorn:22:in `&lt;top (required)&gt;\n</code></pre>\n\n<p>' </p>\n\n<p>I really do not know how to solve this issue. Please can someone help me.</p>\n\n<p>Thanks you in advance.</p>\n"}, {"tags": ["regex", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1561548162, "post_id": 56771519, "comment_id": 100098656, "body": "<code>[A-NP-Z\\d]</code> looks ...ahem visually less impairing :)"}, {"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1561548442, "post_id": 56771519, "comment_id": 100098839, "body": "Thanks for all the details, but I think overall the regex of @thefourthbird is easier to understand at first read. But still very worthy of a plus one :) Thanks, I learned a lot from your answer."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1561548602, "post_id": 56771519, "comment_id": 100098939, "body": "@rmcsharry You may use any workarounds as far as they are working the same. But this is the solution to the &quot;how to exclude some specific chars from a more generic character class&quot; problem in Ruby. I did not create this functionality, note in .NET it might look less &quot;impairing&quot; - <code>[A-Z0-9-[O]]</code>"}, {"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1561548836, "post_id": 56771519, "comment_id": 100099074, "body": "@WiktorStribi\u017cew That is a good point. Based on a strict intepretation of what I asked (which as you say was worded on &#39;how to exclude&quot;) then your answer (and in fact even my own answer too - although harder to grok) is correct. So marking yours as correct now."}], "tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1561547566, "creation_date": 1561547566, "answer_id": 56771519, "question_id": 56771410, "link": "https://stackoverflow.com/questions/56771410/what-is-the-regex-to-test-for-a-compliant-fatca-global-intermediary-identificati/56771519#56771519", "title": "What is the RegEx to test for a compliant FATCA Global Intermediary Identification Number (GIIN)?", "body": "<p>You may use <a href=\"https://www.regular-expressions.info/charclassintersect.html\" rel=\"nofollow noreferrer\">character class intersection</a> and - to match the entire string - anchors:</p>\n\n<pre><code>/\\A[A-Z0-9&amp;&amp;[^O]]{6}\\.[A-Z0-9&amp;&amp;[^O]]{5}\\.(?:LE|SL|ME|BR|SP)\\.\\d{3}\\z/\n</code></pre>\n\n<p>To match as whole word only use word boundaries, <code>\\b</code>, instead of anchors:</p>\n\n<pre><code>/\\b[A-Z0-9&amp;&amp;[^O]]{6}\\.[A-Z0-9&amp;&amp;[^O]]{5}\\.(?:LE|SL|ME|BR|SP)\\.\\d{3}\\b/\n</code></pre>\n\n<p>See the <a href=\"https://rubular.com/r/RIf7a35bHnuXgk\" rel=\"nofollow noreferrer\">Rubular demo</a>.</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>\\A</code> - start of string</li>\n<li><code>[A-Z0-9&amp;&amp;[^O]]{6}</code> - 6 uppercase letters or digits but not <code>O</code></li>\n<li><code>\\.</code> - dot </li>\n<li><code>[A-Z0-9&amp;&amp;[^O]]{5}</code> - 5 uppercase letters or digits but not <code>O</code></li>\n<li><code>\\.</code> - dot</li>\n<li><code>(?:LE|SL|ME|BR|SP)</code> - <code>LE</code>, <code>SL</code>, <code>ME</code>, <code>BR</code> or <code>SP</code></li>\n<li><code>\\.</code> - dot</li>\n<li><code>\\d{3}</code> - any three digits</li>\n<li><code>\\z</code> - end of string</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1561548999, "post_id": 56771529, "comment_id": 100099168, "body": "Thanks for all your input, I learned a lot from this, but based on how I worded the question, wiktor&#39;s answer is more correct to what I asked. Sorry!"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "reply_to_user": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1561549160, "post_id": 56771529, "comment_id": 100099273, "body": "@rmcsharry That is no problem at all. Good luck!"}], "tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 1, "last_activity_date": 1561548673, "last_edit_date": 1561548673, "creation_date": 1561547596, "answer_id": 56771529, "question_id": 56771410, "link": "https://stackoverflow.com/questions/56771410/what-is-the-regex-to-test-for-a-compliant-fatca-global-intermediary-identificati/56771529#56771529", "title": "What is the RegEx to test for a compliant FATCA Global Intermediary Identification Number (GIIN)?", "body": "<p>The format of the current pattern is not correct, there are unclosed groups.</p>\n\n<p>To omit the <code>O</code> you could use <code>[A-NP-Z]</code></p>\n\n<p>If you don't need the groups you could use:</p>\n\n<pre><code>\\b[A-NP-Z0-9]{6}\\.[A-NP-Z0-9]{5}\\.(?:LE|SL|ME|BR|SP)\\.\\d{3}\\b\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<ul>\n<li><code>\\b</code> Word boundary</li>\n<li><code>[A-NP-Z0-9]{6}</code> Match 6 times A-Z without O</li>\n<li><code>\\.</code> Match <code>.</code></li>\n<li><code>[A-NP-Z0-9]{5}</code> Match 5 times A-Z0-9 without O</li>\n<li><code>\\.</code> Match <code>.</code></li>\n<li><code>(?:LE|SL|ME|BR|SP)</code> Match any of the lister</li>\n<li><code>\\.</code> Match <code>.</code></li>\n<li><code>\\d{3}</code> Match 3 digits</li>\n<li><code>\\b</code> Match word boundary</li>\n</ul>\n\n<p><a href=\"https://rubular.com/r/zP4xJbqEyULGPG\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n\n<p>You could add word boundaries <code>\\b</code> around the pattern to prevent the start and end being part of a larger word. Or you could add <code>\\A</code> and <code>\\z</code> anchors to match the start and the end of the string.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1561548075, "post_id": 56771530, "comment_id": 100098611, "body": "What would be wrong with way more simple <code>[A-NP-Z0-9]</code>?!"}, {"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561548514, "post_id": 56771530, "comment_id": 100098886, "body": "Nothing would be wrong - I&#39;m not a RegEx expert and totally agree that simpler is better when it comes to RegEx. It is obvious now I see it that you can do that. Doh!"}], "tags": [], "owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "is_accepted": false, "score": 0, "last_activity_date": 1561547977, "last_edit_date": 1561547977, "creation_date": 1561547597, "answer_id": 56771530, "question_id": 56771410, "link": "https://stackoverflow.com/questions/56771410/what-is-the-regex-to-test-for-a-compliant-fatca-global-intermediary-identificati/56771530#56771530", "title": "What is the RegEx to test for a compliant FATCA Global Intermediary Identification Number (GIIN)?", "body": "<p>It turns out I needed something called a negative look-ahead:</p>\n\n<pre><code>(?:(?![O])\n</code></pre>\n\n<p>which basically says 'except O' (in the group that follows, hence 'look-ahead').</p>\n\n<p>So the final solution is this (I think, not sure but seems to work):</p>\n\n<pre><code>(?:(?![O])[A-Z0-9]){6}\\.(?:(?![O])[A-Z0-9]){5}\\.(?:LE|SL|ME|BR|SP)\\.\\d{3}\n</code></pre>\n"}], "owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 56771519, "answer_count": 3, "score": 2, "last_activity_date": 1561548673, "creation_date": 1561547236, "question_id": 56771410, "link": "https://stackoverflow.com/questions/56771410/what-is-the-regex-to-test-for-a-compliant-fatca-global-intermediary-identificati", "title": "What is the RegEx to test for a compliant FATCA Global Intermediary Identification Number (GIIN)?", "body": "<p><a href=\"https://www.irs.gov/pub/irs-utl/giin_composition.pdf\" rel=\"nofollow noreferrer\">This is the spec</a> for the FATCA GIIN.</p>\n\n<p>19 digits, alphanumeric and only uppercase, in 4 groups, each separated by a compulsory dot/period:</p>\n\n<p>XXXXXX.XXXXX.XX.XXX</p>\n\n<p>First two groups are alphanumeric uppercase, but never include uppercase O.</p>\n\n<p>3rd group seems to only allow strict combination of 2 uppercase letters:</p>\n\n<pre><code>LE|SL|ME|BR|SP\n</code></pre>\n\n<p>4th group is only digits.</p>\n\n<p>I have this so far, but am stuck on how to add that 'never allow O' rule:</p>\n\n<pre><code>[A-Z0-9]){6}\\.[A-Z0-9]){5}\\.(LE|SL|ME|BR|SP)\\.\\d{3}\n</code></pre>\n\n<p>So how can I restrict those first 2 groups to now allow the O?</p>\n\n<p>NOTE - this is for <strong>Ruby</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 0, "creation_date": 1561547256, "post_id": 56771043, "comment_id": 100098135, "body": "<code>rate[&#39;shipmentCost&#39;]</code> is a string, you need to convert it to a comparable entity, ex. an integer using <code>to_i</code>, in order to have <code>min_by</code> to compare the rates and find the cheapest one.  Assuming you&#39;re parsing the json with something like JSON.parse(...) could you please post the parsed JSON?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 0, "creation_date": 1561547400, "post_id": 56771043, "comment_id": 100098226, "body": "@microspino I tried <code>cheapest_rate = rates.min_by { |rate| rate[&#39;shipmentCost&#39;].to_i }</code> but got the same error."}, {"owner": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 0, "creation_date": 1561549306, "post_id": 56771043, "comment_id": 100099365, "body": "the <code>@rates</code> value is not a valid json string, could you please post the raw and parsed json?"}, {"owner": {"reputation": 152, "user_id": 7762387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482afe7efac97adbc138061ba4ab512f?s=128&d=identicon&r=PG&f=1", "display_name": "Adir Ratzon", "link": "https://stackoverflow.com/users/7762387/adir-ratzon"}, "edited": false, "score": 1, "creation_date": 1561549822, "post_id": 56771043, "comment_id": 100099682, "body": "I guess the end of @rates <code>\\&quot;otherCost\\&quot;=&gt;0.0}&quot;</code> makes that invalid json. Remove the <code>}&quot;</code> at the end"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 0, "creation_date": 1561550781, "post_id": 56771043, "comment_id": 100100230, "body": "@microspino I updated the json response.  I was mixing up 2 different scenarios.  The one i previously had up was from when i submijt a form when choosing a <code>@rates</code> from a radio_button in a form (not related to this a)"}, {"owner": {"reputation": 629, "user_id": 3363715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c30a39c99ca53a36d04f8db82e3ff9b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jain", "link": "https://stackoverflow.com/users/3363715/sandesh-jain"}, "edited": false, "score": 0, "creation_date": 1561551262, "post_id": 56771043, "comment_id": 100100535, "body": "Please confirm that in rates you have parsed value coming from following <code>rates = Shipstation::Shipment.get_rates({...})</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561551431, "post_id": 56771043, "comment_id": 100100640, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The JSON you have provided above (and the missing definition for whatever <code>Shipstation::Shipment.get_rates</code> is?) does not give us sufficient information to reproduce the problem."}, {"owner": {"reputation": 629, "user_id": 3363715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c30a39c99ca53a36d04f8db82e3ff9b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jain", "link": "https://stackoverflow.com/users/3363715/sandesh-jain"}, "edited": false, "score": 0, "creation_date": 1561552381, "post_id": 56771043, "comment_id": 100101275, "body": "Please add response of <code>Shipstation::Shipment.get_rates({...})</code>"}, {"owner": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 0, "creation_date": 1561552491, "post_id": 56771043, "comment_id": 100101347, "body": "@uno as far as i can tell the parsed JSON response you posted works fine:   <code>[{&quot;serviceName&quot;=&gt;&quot;USPS First Class Mail - Package&quot;, &quot;serviceCode&quot;=&gt;&quot;usps_first_class_mail&quot;, &quot;shipmentCost&quot;=&gt;2.66, &quot;otherCost&quot;=&gt;0.0}, {&quot;serviceName&quot;=&gt;&quot;USPS Priority Mail - Package&quot;, &quot;serviceCode&quot;=&gt;&quot;usps_priority_mail&quot;, &quot;shipmentCost&quot;=&gt;6.95, &quot;otherCost&quot;=&gt;0.0}].min_by {|r| r[&#39;shipmentCost&#39;] }</code>  results in:   <code>{&quot;serviceName&quot;=&gt;&quot;USPS First Class Mail - Package&quot;, &quot;serviceCode&quot;=&gt;&quot;usps_first_class_mail&quot;, &quot;shipmentCost&quot;=&gt;2.66, &quot;otherCost&quot;=&gt;0.0}</code>  Please post one that generates the error."}, {"owner": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 1, "creation_date": 1561553044, "post_id": 56771043, "comment_id": 100101730, "body": "@uno also, saw your other related question here: <a href=\"https://stackoverflow.com/questions/56752948/getting-the-each-loop-result-with-the-lowest-number-from-json\" title=\"getting the each loop result with the lowest number from json\">stackoverflow.com/questions/56752948/&hellip;</a> I&#39;m not sure it&#39;s fair to have us answering every single step of your problem in different questions..."}, {"owner": {"reputation": 7424, "user_id": 204159, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4daad74624eb020dc8d2a36ad9c10816?s=128&d=identicon&r=PG", "display_name": "microspino", "link": "https://stackoverflow.com/users/204159/microspino"}, "edited": false, "score": 0, "creation_date": 1561553433, "post_id": 56771043, "comment_id": 100101979, "body": "and also here.... <a href=\"https://stackoverflow.com/questions/56765464/saving-json-response-in-create\" title=\"saving json response in create\">stackoverflow.com/questions/56765464/&hellip;</a>"}, {"owner": {"reputation": 629, "user_id": 3363715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c30a39c99ca53a36d04f8db82e3ff9b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jain", "link": "https://stackoverflow.com/users/3363715/sandesh-jain"}, "edited": false, "score": 0, "creation_date": 1561555045, "post_id": 56771043, "comment_id": 100102962, "body": "@uno - I am pretty much sure the response of the <code>Shipstation::Shipment.get_rates({...})</code> is not exactly this <code>[{&quot;serviceName&quot;=&gt;&quot;USPS First Class Mail - Package&quot;, &quot;serviceCode&quot;=&gt;&quot;usps_first_class_mail&quot;, &quot;shipmentCost&quot;=&gt;2.66, &quot;otherCost&quot;=&gt;0.0}, {&quot;serviceName&quot;=&gt;&quot;USPS Priority Mail - Package&quot;, &quot;serviceCode&quot;=&gt;&quot;usps_priority_mail&quot;, &quot;shipmentCost&quot;=&gt;6.95, &quot;otherCost&quot;=&gt;0.0}]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "is_accepted": false, "score": 0, "last_activity_date": 1561552720, "creation_date": 1561552720, "answer_id": 56773049, "question_id": 56771043, "link": "https://stackoverflow.com/questions/56771043/getting-lowest-number-integer-available-from-json-response-in-parameters/56773049#56773049", "title": "Getting lowest number/integer available from json response in parameters", "body": "<blockquote>\n  <p>[{\"serviceName\"=>\"USPS First Class Mail - Package\", \"serviceCode\"=>\"usps_first_class_mail\", \"shipmentCost\"=>2.66, \"otherCost\"=>0.0}, {\"serviceName\"=>\"USPS Priority Mail - Package\", \"serviceCode\"=>\"usps_priority_mail\", \"shipmentCost\"=>6.95, \"otherCost\"=>0.0}]</p>\n</blockquote>\n\n<p>From this array of hashes, you can simply do:</p>\n\n<pre><code>rates = Shipstation::Shipment.get_rates({...})\n\ncheapest_rate_number = rates.collect { |h| h[\"shipmentCost\"].to_f }.min\n</code></pre>\n\n<p>The eerror you posted suggests that not all <code>\"shipmentCost\"</code> values are integer or float, so we are just converting them to float to be safe even if some are integer/float and some are strings.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1561552720, "creation_date": 1561546049, "last_edit_date": 1561550701, "question_id": 56771043, "link": "https://stackoverflow.com/questions/56771043/getting-lowest-number-integer-available-from-json-response-in-parameters", "title": "Getting lowest number/integer available from json response in parameters", "body": "<p>Not really sure how to question this as a title...</p>\n\n<p>but this is the situation and issue:</p>\n\n<p>I take Order's from an API.  While taking the order in, I want to add a shipping rate based off the weight of the product.  I use an API from stamps to receive rates and I want to charge the least expensive rate available from the stamps API response.</p>\n\n<p>Here is my attempt to get the rate (which works for displaying on front-end but not seeming to work in the following)....</p>\n\n<pre><code>...\nrates = Shipstation::Shipment.get_rates({...})\n\ncheapest_rate = rates.min_by { |rate| rate['shipmentCost'] }\ncheapest_rate_number = cheapest_rate[\"shipmentCost\"]\n</code></pre>\n\n<p><strong>error:</strong></p>\n\n<pre><code>TypeError (no implicit conversion of String into Integer) on line 75\n</code></pre>\n\n<p>line 75: <code>cheapest_rate = rates.min_by { |rate| rate['shipmentCost'] }</code></p>\n\n<p>The goal is to take the lowest number available, use that for <code>@order.shipping_rate</code> to then use for calculating the total payment for processing.</p>\n\n<p>The <code>@rates</code> JSON response looks like this:</p>\n\n<pre><code> [{\"serviceName\"=&gt;\"USPS First Class Mail - Package\", \"serviceCode\"=&gt;\"usps_first_class_mail\", \"shipmentCost\"=&gt;2.66, \"otherCost\"=&gt;0.0}, {\"serviceName\"=&gt;\"USPS Priority Mail - Package\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;6.95, \"otherCost\"=&gt;0.0}]\n</code></pre>\n\n<p>but with more than one option.</p>\n\n<p><strong>How can I</strong> take my current code and or new code to get the lowest integer from <code>\\\"shipmentCost\\\"</code>, define it and then pass it through to the model without the error from above</p>\n"}, {"tags": ["ruby", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1561586577, "last_edit_date": 1561586577, "creation_date": 1561553483, "answer_id": 56773281, "question_id": 56770807, "link": "https://stackoverflow.com/questions/56770807/clear-the-input-with-required-value/56773281#56773281", "title": "Clear the input with required value", "body": "<p>I think you're confused by what you're looking at.  There is no \"required value\" attribute, the element has a <code>value</code> attribute equal to \"1561540348@@test.co\" and also has a <code>required</code> attribute which specifies to HTML5 form validation not to submit the form if the field is empty - <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Form_validation#The_required_attribute\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Form_validation#The_required_attribute</a></p>\n\n<p>Clearing the field with something like</p>\n\n<pre><code>fill_in('email', with: '')\n</code></pre>\n\n<p>will set the elements <code>value</code> property (not the same as the attribute, but the property is what actually gets submitted) to empty however the browser won't let you submit the form due to validation failing. If this doesn't explain/answer your issue please explain more fully what exactly you're trying to do.</p>\n"}], "owner": {"reputation": 1, "user_id": 4479903, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rmUIPH4GviM/AAAAAAAAAAI/AAAAAAAAAG8/ZoOshNeTrz4/photo.jpg?sz=128", "display_name": "Sergei Lagun", "link": "https://stackoverflow.com/users/4479903/sergei-lagun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561586577, "creation_date": 1561545394, "question_id": 56770807, "link": "https://stackoverflow.com/questions/56770807/clear-the-input-with-required-value", "title": "Clear the input with required value", "body": "<p>I have some issue with clearing css input field. Input field has a prefilled \"required value\" and I can't clear. <a href=\"https://take.ms/UoMB9\" rel=\"nofollow noreferrer\">https://take.ms/UoMB9</a></p>\n\n<p>I already tried </p>\n\n<pre><code>find('input[name=email]').set('')\nel = find('input[name=email]')\nel.native.clear\n</code></pre>\n\n<p>this code clearing only value, but not \"required value\"</p>\n\n<p>Would be appreciated if someone can help this</p>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1562030530, "post_id": 56770008, "comment_id": 100239838, "body": "Are you able to use an <a href=\"https://bundler.io/v2.0/guides/bundler_in_a_single_file_ruby_script.html\" rel=\"nofollow noreferrer\">inline Gemfile</a> in your second script?"}, {"owner": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1562132822, "post_id": 56770008, "comment_id": 100276228, "body": "Jay ; it sure works also, thanks. If you make it an answer, I&#39;ll up vote it!"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "edited": false, "score": 0, "creation_date": 1561877667, "post_id": 56822950, "comment_id": 100198672, "body": "no, cwd=Dir.pwd ; ourDir=File.dirname(<b>FILE</b>) ; Dir.chdir(ourDir) ; #takes care of dir Changing,"}, {"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "edited": false, "score": 0, "creation_date": 1561878568, "post_id": 56822950, "comment_id": 100198801, "body": "<code>cwd=Dir.pwd ; ourDir=File.dirname(FILE) ; Dir.chdir(ourDir) ;</code> is located inside script2.rb, so the script2 itself is called without Gemfile. The script2.rb must be called from a directory where it&#39;s Gemfile is located."}, {"owner": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "edited": false, "score": 0, "creation_date": 1561926126, "post_id": 56822950, "comment_id": 100208053, "body": "I don&#39;t think Bundler work that way. But anyway, the solution is something I can&#39;t imagine yet, so I did try <code>Dir.chdir(&#39;&#47;Users&#47;charbon&#47;wip&#47;script2&#39;) ; puts &quot;we are now in #{cwd} ; ls gives&quot; ; puts `ls`; exec(&quot;&#47;Users&#47;charbon&#47;wip&#47;script2&#47;script2.rb&quot;)</code> and the result is the same. Bundler just needs to be able to find the Gemfile when it&#39;s called via require &#39;bundler&#39;."}, {"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "edited": false, "score": 0, "creation_date": 1561966447, "post_id": 56822950, "comment_id": 100215202, "body": "it seems that Dir.chdir do not change context to a new directory, shell script works fine:       <code>#bin&#47;sh     .&#47;script1.rb     cd ..&#47;script2     ls     .&#47;script2.rb</code> there is a message in <a href=\"https://stackoverflow.com/questions/3410310/exec-the-cd-command-in-a-ruby-script/11954975\" title=\"exec the cd command in a ruby script\">stackoverflow.com/questions/3410310/&hellip;</a> : <b>You can&#39;t change the working directory (or the environment variables for that matter) of the shell that invoked you in a ruby script (or any other kind of application). The only commands that can change the pwd of the current shell are shell built-ins.</b> Sorry for formatting."}], "tags": [], "owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "is_accepted": false, "score": 2, "last_activity_date": 1561877137, "creation_date": 1561877137, "answer_id": 56822950, "question_id": 56770008, "link": "https://stackoverflow.com/questions/56770008/bundler-works-when-rb-file-called-directly-fails-when-called-via-exec-from-oth/56822950#56822950", "title": "Bundler works when .rb file called directly, fails when called via exec from other ruby script", "body": "<p>It seems that you need to make <code>Dir.chdir \"/Users/charbon/wip/script2/\"</code> before calling <code>script2.rb</code>. \nYou are calling script2.rb from a directory, where there is no Gemfile for it. The script will look like this:</p>\n\n<pre><code>#!/usr/bin/env ruby\ncwd=Dir.pwd ; ourDir=File.dirname(__FILE__) ; Dir.chdir(ourDir)\nrequire 'bundler' ;  Bundler.setup\nrequire \"awesome_print\"\nap \"in script1, we have awesome_print in our GemFile\"\nDir.chdir \"/Users/charbon/wip/script2/\"\nexec(\"script2.rb\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "edited": false, "score": 0, "creation_date": 1562132888, "post_id": 56840767, "comment_id": 100276253, "body": "thanks, you put me on the right track. The only change required is <code>Bundler.with_clean_env { exec(&quot;&#47;path&#47;to&#47;script2.rb&quot;) }</code> (no need for Dir.chdir before)"}], "tags": [], "owner": {"reputation": 386, "user_id": 5501618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uR2MN.jpg?s=128&g=1", "display_name": "Marat Amerov", "link": "https://stackoverflow.com/users/5501618/marat-amerov"}, "is_accepted": true, "score": 4, "last_activity_date": 1562006073, "creation_date": 1562006073, "answer_id": 56840767, "question_id": 56770008, "link": "https://stackoverflow.com/questions/56770008/bundler-works-when-rb-file-called-directly-fails-when-called-via-exec-from-oth/56840767#56840767", "title": "Bundler works when .rb file called directly, fails when called via exec from other ruby script", "body": "<p>script1.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#!/usr/bin/env ruby\ncwd=Dir.pwd ; ourDir=File.dirname(__FILE__) ; Dir.chdir(ourDir)\nrequire 'bundler' ;  Bundler.setup\nrequire \"awesome_print\"\nap \"in script1, we have awesome_print in our GemFile\"\n\nBundler.with_clean_env do\n  Dir.chdir('/Users/charbon/wip/script2/script2.rb') do\n    exec(\"./script2.rb\")\n  end \nend\n</code></pre>\n\n<p>script2.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#!/usr/bin/env ruby\nputs \"we are now in script2.rb\"\ncwd=Dir.pwd ; ourDir=File.dirname(__FILE__) ; Dir.chdir(ourDir)\n\n\nrequire 'bundler' ;\nBundler.setup\nrequire 'awesome_print'\n\nap \"in script2, we also have awesome_print in our GemFile\"\nputs \"but we also have colored, which is not available, this throws an erro\"\nrequire \"colored\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "is_accepted": false, "score": 4, "last_activity_date": 1562178892, "last_edit_date": 1562178892, "creation_date": 1562133389, "answer_id": 56863741, "question_id": 56770008, "link": "https://stackoverflow.com/questions/56770008/bundler-works-when-rb-file-called-directly-fails-when-called-via-exec-from-oth/56863741#56863741", "title": "Bundler works when .rb file called directly, fails when called via exec from other ruby script", "body": "<p>To sum up and to complete <a href=\"https://stackoverflow.com/a/56840767/1759335\">Marat Amerov</a>'s answer:</p>\n\n<p>Bundler has this very <a href=\"https://bundler.io/v1.3/man/bundle-exec.1.html#Shelling-out\" rel=\"nofollow noreferrer\">well documented</a>:</p>\n\n<blockquote>\n  <p>Any Ruby code that opens a subshell (like system, backticks, or %x{}) will automatically use the current Bundler environment. If you need to shell out to a Ruby command that is not part of your current bundle, use the with_clean_env method with a block</p>\n</blockquote>\n\n<p>Second solution is as commented by <a href=\"https://stackoverflow.com/users/2892779/jay-dorsey\">Jay Dorsey</a> : use the <a href=\"https://bundler.io/v2.0/guides/bundler_in_a_single_file_ruby_script.html\" rel=\"nofollow noreferrer\">bundler/inline method</a></p>\n\n<p>I have tested both methods and they work fine.</p>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 4, "last_activity_date": 1562164971, "creation_date": 1562164971, "answer_id": 56872626, "question_id": 56770008, "link": "https://stackoverflow.com/questions/56770008/bundler-works-when-rb-file-called-directly-fails-when-called-via-exec-from-oth/56872626#56872626", "title": "Bundler works when .rb file called directly, fails when called via exec from other ruby script", "body": "<p>From my comment on the original question:</p>\n\n<p>Bundler supports <a href=\"https://bundler.io/v2.0/guides/bundler_in_a_single_file_ruby_script.html\" rel=\"nofollow noreferrer\">inline Gemfiles</a> which allow you to specify your required gems (and sources!) directly in your ruby script. As long as you have bundler installed on the machine it should work, allowing you to keep your script dependencies isolated.</p>\n\n<p>Bundler will handle installing &amp; requiring the required gems, allowing you to run your script</p>\n"}], "owner": {"reputation": 307, "user_id": 1759335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/49a601fdce8c0240a4a8c3df1def5120?s=128&d=identicon&r=PG", "display_name": "MichaelC", "link": "https://stackoverflow.com/users/1759335/michaelc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 56840767, "answer_count": 4, "score": 4, "last_activity_date": 1562178892, "creation_date": 1561542978, "question_id": 56770008, "link": "https://stackoverflow.com/questions/56770008/bundler-works-when-rb-file-called-directly-fails-when-called-via-exec-from-oth", "title": "Bundler works when .rb file called directly, fails when called via exec from other ruby script", "body": "<p><strong>I need to call a ruby script2.rb using Bundler + Gemfile from another ruby script1.rb using Bundler + Gemfile.</strong></p>\n\n<p>I noticed that the Gems available to script2.rb are only those of script1.rb. The gems unique to script2.rb are not available when script2.rb is called by script1.rb.\nWhen script2.rb is called directly from the bash shell, everything is available.</p>\n\n<p>I made sure it's not an ENV problem, I compared them using diff with helper code like so in both files and made a couple modifications to make them match.</p>\n\n<pre><code>File.open(\"script2_env.txt\", 'wb') {|f| f.write(JSON.pretty_generate(ENV.to_h))}\n</code></pre>\n\n<p>To make sure it was not a $LOAD_PATH problem, I also made sure they match.</p>\n\n<p>In script2.rb, which is called by script1.rb, I added the following line to match the $LOAD_PATH of script1 :</p>\n\n<pre><code>$:.unshift \"/usr/local/Cellar/rbenv/1.1.2/rbenv.d/exec/gem-rehash\"\n</code></pre>\n\n<p>My understanding of the problem is that somehow Bundler is not initialized properly when script2.rb is called from script1.rb, maybe because there is no</p>\n\n<pre><code>eval \"$(rbenv init -)\"\n</code></pre>\n\n<p>as there is in my bash_profile</p>\n\n<p>script1/script1.rb :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#!/usr/bin/env ruby\ncwd=Dir.pwd ; ourDir=File.dirname(__FILE__) ; Dir.chdir(ourDir)\nrequire 'bundler' ;  Bundler.setup\nrequire \"awesome_print\"\nap \"in script1, we have awesome_print in our GemFile\"\nexec(\"/Users/charbon/wip/script2/script2.rb\")\n</code></pre>\n\n<p>script1/Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'awesome_print'\n</code></pre>\n\n<p>script2.rb :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#!/usr/bin/env ruby\nputs \"we are now in script2.rb\"\n$:.unshift \"/usr/local/Cellar/rbenv/1.1.2/rbenv.d/exec/gem-rehash\"\ncwd=Dir.pwd ; ourDir=File.dirname(__FILE__) ; Dir.chdir(ourDir)\n\n#make ENV match to script1 ENV\nENV.delete('BUNDLER_ORIG_GEM_PATH') \nENV['BUNDLE_GEMFILE']=ourDir+\"/Gemfile\"\nENV['RBENV_DIR']=ourDir\n\nrequire 'bundler' ;\nBundler.setup\nrequire 'awesome_print'\n\nap \"in script2, we also have awesome_print in our GemFile\"\nputs \"but we also have colored, which is not available, this throws an erro\"\nrequire \"colored\"\n</code></pre>\n\n<p>script2/Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'awesome_print'\ngem 'colored'\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code> /Users/charbon/wip/script1/script1.rb \n\"in script1, we have awesome_print in our GemFile\"\nwe are now in script2.rb\nourDir is /Users/charbon/wip/script2\n\"in script2, we also have awesome_print in our GemFile\"\nbut we also have colored, which is not available, this throws an error\n/Users/charbon/wip/script2/script2.rb:19:in `require': cannot load such file -- colored (LoadError)\n    from /Users/charbon/wip/script2/script2.rb:19:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "multithreading", "mri"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561535708, "post_id": 56767842, "comment_id": 100091541, "body": "The first test does not prove anything, save for the that in 100 times there was no preemption happened."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561536342, "post_id": 56767842, "comment_id": 100091846, "body": "How does the second example show that <code>i += 1</code> isn&#39;t thread-safe?"}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561536443, "post_id": 56767842, "comment_id": 100091896, "body": "@Stefan Source code appended."}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561536733, "post_id": 56767842, "comment_id": 100092036, "body": "@AlekseiMatiushkin I have run the test one repeatedly and all show the same result. Any more, If I run the same test using jruby, the result is variable."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1561536827, "post_id": 56767842, "comment_id": 100092080, "body": "One cannot prove anything by showing any huge number of confirmations. Proves work the other way round."}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561537470, "post_id": 56767842, "comment_id": 100092415, "body": "@Stefan Second example shows that <code>while true do i += 1 end</code> is not thread-safe in that while thread1 hasn&#39;t finished its execution, thread2 got its CPU time to execute some code. If thread1 is not preemptive(thread-safe), thread2 should not have a chance to execute. But it does have."}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561537698, "post_id": 56767842, "comment_id": 100092541, "body": "@AlekseiMatiushkin I agree. The test is a confirmation, not the proof. The proof is the implementation of MRI, which is detailed in this <a href=\"https://www.jstorimer.com/blogs/workingwithcode/8100871-nobody-understands-the-gil-part-2-implementation\" rel=\"nofollow noreferrer\">post</a>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561537790, "post_id": 56767842, "comment_id": 100092599, "body": "Okay, given that <code>i += 1</code> is thread-safe (I haven&#39;t checked), what makes you think that the whole statement <code>while true do i += 1 end</code> must be thread-safe (or &quot;atomic&quot;), too? There could be a thread switch right before <code>i += 1</code> or afterwards."}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561538078, "post_id": 56767842, "comment_id": 100092740, "body": "@Stefan Yes. In other words, If <code>i += 1</code> is executed atomically, <code>while true do i += 1 end</code> should be executed atomically too."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1561538780, "post_id": 56767842, "comment_id": 100093130, "body": "@ChengshengWen the blog post states that in MRI the interrupt flag is checked before returning from a method and concludes that method invocations are therefore atomic. In other words: the atomicity ends when returning from a method. Which means your <code>while</code> isn&#39;t covered."}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561540013, "post_id": 56767842, "comment_id": 100093876, "body": "@Stefan You mean <code>while</code> executes while body by using some function call? If it does, the answer is obvious. But is there any supporting documentation? I google it but fail to find anything about how <code>while</code> statement works."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561788493, "post_id": 56767842, "comment_id": 100184491, "body": "You talk about two different things in your question. In your title, you ask about Ruby, in your text, you ask about MRI. <i>Those are two completely different things!</i> Which of the two are you asking about? Also, note that MRI is no longer being developed, maintained, or supported, and hasn&#39;t been for years. The currently maintained Ruby implementations are, to my knowledge, Rubinius, TruffleRuby, Opal, JRuby, MRuby, RubyMotion / DragonRuby, YARV, RubyOMR(???), and MagLev(???), and maybe for some <i>really</i> generous definition of &quot;maintained&quot; IronRuby."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "edited": false, "score": 0, "creation_date": 1561545693, "post_id": 56769647, "comment_id": 100097213, "body": "The fact that <code>i + 1</code> is a method call, i.e. it&#39;s equal to i+(1), helps me a lot. It&#39;s very different from compiled language such as C."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "edited": false, "score": 0, "creation_date": 1561546395, "post_id": 56769647, "comment_id": 100097611, "body": "@ChengshengWen to be fair, the blog post says <i>&quot;methods implemented in C are atomic&quot;</i> so it doesn&#39;t apply to our overridden method. But the example clearly shows that MRI doesn&#39;t try to keep larger statements like <code>i = ...</code> atomically. (let alone loops with conditions)"}, {"owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "edited": false, "score": 0, "creation_date": 1561598926, "post_id": 56769647, "comment_id": 100120229, "body": "I know.  Use of <code>rand</code> inside overridden may cause the checking of interrupt flag, which makes <code>i = i + 1</code> preemptive as a whole unexpectedly."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 7, "last_activity_date": 1561546508, "last_edit_date": 1561546508, "creation_date": 1561541876, "answer_id": 56769647, "question_id": 56767842, "link": "https://stackoverflow.com/questions/56767842/in-ruby-why-while-true-do-i-1-end-is-not-thread-safe/56769647#56769647", "title": "In Ruby, why `while true do i += 1 end` is not thread safe?", "body": "<blockquote>\n  <p>According to this post, <code>i += 1</code> is thread safe in MRI </p>\n</blockquote>\n\n<p>Not quite. The blog post states that <em>method invocations</em> are effectively thread-safe in MRI.</p>\n\n<p>The abbreviated assignment <code>i += 1</code> is syntactic sugar for:</p>\n\n<pre><code>i = i + 1\n</code></pre>\n\n<p>So we have an assignment <code>i = ...</code> <em>and</em> a method call <code>i + 1</code>. According to the blog post, the latter is thread-safe. But it also says that a thread-switch can occur right before returning the method's result, i.e. before the result is re-assigned to <code>i</code>:</p>\n\n<pre><code>i = i + 1\n#  ^\n# here\n</code></pre>\n\n<p>Unfortunately this isn't easy do demonstrate from within Ruby.</p>\n\n<p>We can however hook into <code>Integer#+</code> and randomly ask the thread scheduler to pass control to another thread:</p>\n\n<pre><code>module Mayhem\n  def +(other)\n    Thread.pass if rand &lt; 0.5\n    super\n  end\nend\n</code></pre>\n\n<p>If MRI ensures thread-safety for the whole <code>i += 1</code> statement, the above shouldn't have any effect. But it does:</p>\n\n<pre><code>Integer.prepend(Mayhem)\n\n10.times do\n  i = 0\n  Array.new(10) { Thread.new { i += 1 } }.each(&amp;:join)\n  puts i\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>5\n7\n6\n4\n4\n8\n4\n5\n6\n7\n</code></pre>\n\n<p>If you want thread-safe code, don't rely on implementation details (those can change). In the above example, you could wrap the sensitive part in a <a href=\"http://ruby-doc.org/core-2.6.3/Mutex.html#method-i-synchronize\" rel=\"nofollow noreferrer\"><code>Mutex#synchronize</code></a> call:</p>\n\n<pre><code>Integer.prepend(Mayhem)\n\nm = Mutex.new\n\n10.times do\n  i = 0\n  Array.new(10) { Thread.new { m.synchronize { i += 1 } } }.each(&amp;:join)\n  puts i\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>10\n10\n10\n10\n10\n10\n10\n10\n10\n10\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7972759, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O9z4mFGZOtM/AAAAAAAAAAI/AAAAAAAAABQ/kGMyPja_-hQ/photo.jpg?sz=128", "display_name": "Chengsheng Wen", "link": "https://stackoverflow.com/users/7972759/chengsheng-wen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 56769647, "answer_count": 1, "score": 2, "last_activity_date": 1561546508, "creation_date": 1561535544, "last_edit_date": 1561536313, "question_id": 56767842, "link": "https://stackoverflow.com/questions/56767842/in-ruby-why-while-true-do-i-1-end-is-not-thread-safe", "title": "In Ruby, why `while true do i += 1 end` is not thread safe?", "body": "<p>According to this <a href=\"https://www.jstorimer.com/blogs/workingwithcode/8100871-nobody-understands-the-gil-part-2-implementation\" rel=\"nofollow noreferrer\">post</a>, <code>i += 1</code> is thread safe in MRI Ruby because the preemption only happens at the end of function call, not somewhere between <code>i += 1</code>. </p>\n\n<p>A repeatable test below shows that this is true:\n<a href=\"https://i.stack.imgur.com/kPB30.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kPB30.png\" alt=\"repeatable test\"></a></p>\n\n<p>But why <code>while true do i += 1 end</code> is not thread safe, as shown by the second test below where thread1 is preempted by thread2 when thread1 is still executing <code>while true do i += 1 end</code> ?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ALdAj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ALdAj.png\" alt=\"second test\"></a></p>\n\n<p>Please help.</p>\n\n<p>Below are the code reference:</p>\n\n<p>test one:</p>\n\n<pre><code>100.times do\n  i = 0\n  1000.times.map do\n    Thread.new {1000.times {i += 1}}\n  end.each(&amp;:join)\n  puts i\nend\n</code></pre>\n\n<p>test two:</p>\n\n<pre><code>t1 = Thread.new do\n  puts \"#{Time.new} t1 running\"\n  i = 0\n  while true do i += 1 end\nend\n\nsleep 4\n\nt2 = Thread.new do\n  puts \"#{Time.new} t2 running\"\nend\n\nt1.join\nt2.join\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rack"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561532114, "post_id": 56766811, "comment_id": 100089722, "body": "<i>Sidenote:</i> <i>\u201cExpected x_y.rb to define constant XY\u201d</i> messages have nothing to do with reliability, it\u2019s Rails \u2018smart\u2019 autoloading complains about your files naming / path."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561532289, "post_id": 56766811, "comment_id": 100089791, "body": "<i>Sidenote #2:</i> To <i>\u201creliably maintain a long-lived singleton object to handle server-level events\u201d</i> one rare if never picks up Rails solutions. The generic approach would be to use something like message queue (sending events there from your Rails,) and have a reliable app (reliable excludes Rails in the first place) that reads a queue, sends an event to consumer(s) and <i>then</i> acks the message. That way it\u2019d be guaranteed each message is processed."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1561532499, "post_id": 56766811, "comment_id": 100089906, "body": "Did you consider using iodine&#39;s built-in support for pub/sub? You can use it with ActionCable (though less recommended than direct pub/sub to raw WebSockets) by adding a code block to the subscription (so the subscription calls the block instead of sending the data)... (P.S., I&#39;m biased)"}, {"owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561532656, "post_id": 56766811, "comment_id": 100089994, "body": "@AlekseiMatiushkin One approach that we&#39;re considering is a subprocess that connects to the Rails app locally, probably as a websocket client. Part of my motivation here is to learn a bit more about how ActionCable manages to be long-lived within Rails, and if it&#39;s possible (or advisable) for third parties to accomplish the same."}, {"owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1561532686, "post_id": 56766811, "comment_id": 100090010, "body": "@Myst Looking at that now. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "is_accepted": false, "score": 0, "last_activity_date": 1561870572, "creation_date": 1561870572, "answer_id": 56822499, "question_id": 56766811, "link": "https://stackoverflow.com/questions/56766811/strategies-for-multithreaded-singleton-object-in-rails/56822499#56822499", "title": "Strategies for multithreaded singleton object in Rails", "body": "<p>As of now, the strategy I am undertaking is to instantiate a singleton object early in the boot process and then use it to maintain threads. Threadsafe practices are obviously needed for this.</p>\n\n<p>The file application.rb defines <code>MyApp::Application</code>. At this point I declare an accessor <code>my_thing_manager</code>, <code>require my_thing_manager</code> and set <code>self.my_thing_manager = MyThingManager.instance</code>. </p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class MyThingManager\n    def instance\n        return Thread.main[:thing_manager] unless Thread.main[:thing_manager].nil?\n        Thread.main[:thing_manager] = self.new\n    end\n\n    private\n\n    def initialize\n    end\nend\n</code></pre>\n\n<p><strong>This approach works in a single multithreaded process</strong> but does <em>not</em> work in a clustered production environment. For my requirements that is completely acceptable. For a multi-process app, one could utilize hooks in e.g. Puma <code>after_worker_fork</code> or Unicorn's <code>after_fork</code> to manage a subscription to something like Redis pubsub. This will be a requirement for an upcoming project so I expect to develop this strategy further.</p>\n"}], "owner": {"reputation": 458, "user_id": 2027188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085678fea49e413bfb66f71361c9a7fd?s=128&d=identicon&r=PG", "display_name": "adc", "link": "https://stackoverflow.com/users/2027188/adc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561870572, "creation_date": 1561531867, "question_id": 56766811, "link": "https://stackoverflow.com/questions/56766811/strategies-for-multithreaded-singleton-object-in-rails", "title": "Strategies for multithreaded singleton object in Rails", "body": "<p>I have a compelling use case where notifications happen in realtime at the server level. I would like to push these events out over a websocket using Rails' ActionCable. <strong>How Can I reliably maintain a long-lived singleton object to react to and push server-level events?</strong></p>\n\n<ul>\n<li><p>I prototyped a Rails app using an object instantiated from a file in /app/lib that mixes in the <code>Singleton</code> module. Even with class caching, this was instantiated multiple times and occasionally garbage collected despite open sockets.</p></li>\n<li><p>Marking the event producer's <code>initialize</code> method private and writing a class-level instance method that checks <code>Thread.main[:event_provider]</code> for an instance works 95% in development, but I worry about what I don't know that I don't know about production. Very occasionally I get exceptions like \"Expected x_y.rb to define constant XY\" exceptions, which make me think there's a problem to this approach.</p></li>\n<li><p>The production server will ultimately serve a very small number of clients in an environment that demands 100% uptime. I can choose a server stack that makes sense.</p></li>\n</ul>\n\n<p>I'm hoping someone with knowledge of Rack and/or ActionCable can comment on reliable ways to serve events to a Rails application from within the server.</p>\n"}, {"tags": ["ruby", "exception", "mutex", "synchronize"], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "edited": false, "score": 0, "creation_date": 1561528507, "post_id": 56765973, "comment_id": 100088167, "body": "In my test, I think it actually happened.  But are we sure that if there are no other threads waiting for this mutex, then inside the rescue block mutex will be always unlocked?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "edited": false, "score": 0, "creation_date": 1561528594, "post_id": 56765973, "comment_id": 100088201, "body": "I do not get the question. If there are no other threads waiting for this mutex, <code>m.synchronize</code> is effectively NOOP."}, {"owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "edited": false, "score": 1, "creation_date": 1561528946, "post_id": 56765973, "comment_id": 100088337, "body": "Ok, I got the answer \u2014 it is unlocked for sure, but can be already locked again. Thank you."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1561528609, "last_edit_date": 1561528609, "creation_date": 1561527925, "answer_id": 56765973, "question_id": 56765929, "link": "https://stackoverflow.com/questions/56765929/how-exactly-exception-unlocks-mutex/56765973#56765973", "title": "How exactly exception unlocks mutex?", "body": "<p>Nobody promised that the processor would stop the world, waiting for your action :) That said, between</p>\n\n<pre><code>raise 'Break'\n</code></pre>\n\n<p>and</p>\n\n<pre><code>puts \"(1) rescue break, m.locked?: #{m.locked?}\"\n</code></pre>\n\n<p>there is another thread that might get the execution time <em>and in turn lock the mutex</em>.</p>\n\n<hr>\n\n<p>Please also note, that </p>\n\n<pre><code>    raise 'Break'\n  end\nrescue \n  puts \"(1) rescue break, m.locked?: #{m.locked?}\"\n</code></pre>\n\n<p>is effectively the same as</p>\n\n<pre><code>  end\n  puts \"(1) rescue break, m.locked?: #{m.locked?}\"\n</code></pre>\n\n<p>In the latter snippet, it should be clear that <code>m</code> might be either locked by another thread, or not; we have it just released, so no promise.</p>\n"}], "owner": {"reputation": 855, "user_id": 364392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1af8b60c508bb4f5f11371b13c379c8b?s=128&d=identicon&r=PG", "display_name": "Inversion", "link": "https://stackoverflow.com/users/364392/inversion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56765973, "answer_count": 1, "score": 0, "last_activity_date": 1561528609, "creation_date": 1561527733, "last_edit_date": 1561528586, "question_id": 56765929, "link": "https://stackoverflow.com/questions/56765929/how-exactly-exception-unlocks-mutex", "title": "How exactly exception unlocks mutex?", "body": "<p>This simple test mostly results as<br>\n<code>(1) rescue break, m.locked?: false</code><br>\nbut sometimes I can see<br>\n<code>(1) rescue break, m.locked?: true</code></p>\n\n<pre><code>m = Mutex.new\n\n6.times do\n\n    Thread.new do\n        begin\n            m.synchronize do\n                puts 't1 action'\n                3.times do\n                    puts '.'\n                    sleep 0.5\n                end\n                raise 'Break'\n            end\n        rescue \n            puts \"(1) rescue break, m.locked?: #{m.locked?}\"\n            m.synchronize do\n                sleep 0.1\n            end\n            puts '(2) after m {sleep}'\n            sleep 0.1\n            puts 'rescue break 2'\n        end\n    end\n\n    sleep 0.1\n    t2 = Thread.new do\n        puts 't2 waiting for mutex'\n        m.synchronize do\n            puts '(3) t2 action'\n        end\n    end\n\n    t2.join\n    sleep 0.2\n    puts;puts;\nend\n</code></pre>\n\n<p>I expected that inside the rescue block mutex will be always unlocked.</p>\n\n<p>Environment:\nRuby v2.6.3.62 (2019-04-16) [x64-mingw32]</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1561530701, "post_id": 56766525, "comment_id": 100089080, "body": "And you can set a different stdin_input for each context by putting a <code>let(:stdin_input)</code> in each context."}, {"owner": {"reputation": 21, "user_id": 11700444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fv_C_Qx2T30/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXuR62L37NoiplK-m6FQ2Oh2jaig/photo.jpg?sz=128", "display_name": "Robel", "link": "https://stackoverflow.com/users/11700444/robel"}, "edited": false, "score": 0, "creation_date": 1561571026, "post_id": 56766525, "comment_id": 100111990, "body": "Can you please write one of the context, I don&#39;t know how to write it?"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 21, "user_id": 11700444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fv_C_Qx2T30/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXuR62L37NoiplK-m6FQ2Oh2jaig/photo.jpg?sz=128", "display_name": "Robel", "link": "https://stackoverflow.com/users/11700444/robel"}, "edited": false, "score": 0, "creation_date": 1561573439, "post_id": 56766525, "comment_id": 100113023, "body": "I edited the answer to show more of the test. I don&#39;t really know what else you&#39;re looking for. Is it not working?"}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": false, "score": 1, "last_activity_date": 1561573394, "last_edit_date": 1561573394, "creation_date": 1561530642, "answer_id": 56766525, "question_id": 56765567, "link": "https://stackoverflow.com/questions/56765567/how-to-write-rspec-for-logic-and-write-mock-stdin/56766525#56766525", "title": "How to write rspec for logic and write mock STDIN", "body": "<p>You can use <a href=\"https://relishapp.com/rspec/rspec-mocks/v/2-14/docs/method-stubs\" rel=\"nofollow noreferrer\">method stubs</a>.</p>\n\n<p>In this case you want to stub <code>STDIN.gets.chomp</code>, so you'd do something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>describe '#find_part_id' do\n  before do\n    allow(STDIN.gets).to receive(:chomp).and_return(stdin_input)\n  end\n\n  let(:stdin_input) { 'user input from stdin' }\n  let(:face) { create(:face) }\n\n  subject { described_class.find_part_id(face) }\n\n  context 'When bab con already exists' do\n    context 'when there are more than one part ids' do\n      it 'some test' do\n        # your test here\n      end\n    end\n\n    # more contexts...\n\n    context 'a context that needs a different stdin_input' do \n      let(:stdin_input) { 'some different user input from stdin' }\n\n      it 'another test' do\n        # your test here\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Where stdin_input is the string you want the user to enter for your tests.</p>\n"}], "owner": {"reputation": 21, "user_id": 11700444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fv_C_Qx2T30/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXuR62L37NoiplK-m6FQ2Oh2jaig/photo.jpg?sz=128", "display_name": "Robel", "link": "https://stackoverflow.com/users/11700444/robel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1561587631, "creation_date": 1561525724, "last_edit_date": 1561587631, "question_id": 56765567, "link": "https://stackoverflow.com/questions/56765567/how-to-write-rspec-for-logic-and-write-mock-stdin", "title": "How to write rspec for logic and write mock STDIN", "body": "<p>I am a very new coder and trying to write rspec for a class that test the conditional statement/logic. I started sudo coding for it  but I was told to make mock STDIN which I don't know how to. Can someone please write the rspec for the class or give me a few idea how to create a mock STDIN. I need help writing rspec for the conditional statement/logic, if some can please just write the test for one of the context then I can do rest based on that.</p>\n\n<pre><code>require 'rails_helper'\n\nmodule BAB::ACA\n\n RSpec.describe partfinder do\n\n    describe '#find_part_id' do\n      let(:face) { create(:face) }\n\n      subject { described_class.find_part_id(face) }\n\n      context 'When bab con already exists' do\n        context 'when there are more than one part ids' do\n          #create part ids \n\n        context 'when user input matches an existing id' do \n          #mock STDIN that matches an existing, subject should equal that id \n        end \n\n        context 'when user input does not match an existing id' do\n          # mock STDIN that does match existing id, should return failure message\n        end \n       end \n\n        context 'when there is only one bab part id' do\n          # subject should equal the one that already exists\n        end\n       end \n\n        context 'when av con does not yet exist' do\n          # mock STDIN and make sure subject equals what you mocked\n        end\n      end \nend\n\nmodule BAB::ACA\n\n    class partfinder\n\n      def self.find_part_id(face)\n        av_con = BAB::Child:Fail.find_by(\n                  face: face\n                  reg: BAB:Child.find_reg\n                )\n        if av_con\n          look_id(face, av_con)\n        end\n        else\n          puts \"What is #{face.name} BAB part id? must be 6\"\n          STDIN.gets.chomp\n        end\n      end\n\n      def self.look_id(face, av_con)\n        if av_con.part_ids.length &gt; 1\n          ask_for_id(face, av_con)\n        else\n        av.con.part_ids.first\n        end\n      end\n\n      def self.ask_for_id(face, av_con)\n        puts \"What is #{face.name} BAB part id? \"\n        bab_part_id = STDIN.gets.chomp\n\n        unless av.con.part_ids.include?(bab_part_id)\n          fail 'Entered id doesn't match'\n        end\n        bab_part_id\n      end\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561544680, "post_id": 56766898, "comment_id": 100096604, "body": "The @rates is from an API so the response is json.  Sorry, should have explained that...  I am looking for a hash, but wondering why the way I &quot;save&quot; the <code>[&quot;serviceCode&quot;]</code>, it saves the title and not the value from the parameters... and what&#39;s up with the <code>&#47;</code>&#39;s in the parameters and how I can rid them... I read that using <code>as_json</code> would do that but somehow doenst?"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561565478, "post_id": 56766898, "comment_id": 100109472, "body": "As I said, as_json <i>does</i> correctly return a hash. The issue is that you&#39;re trying to put that hash into a radio button. That simply will not work. As a form element, radio buttons expect simple data (really just strings) and if you try to render one with a hash it will coerce that hash into a string. That&#39;s where the \\s are coming from. I can really only recommend that you find another way to do this. You cannot get hash data into a single radio button without a lot of shoehorning, and you almost certainly should not do so. If you&#39;re really set on doing this, you can try <code>.to_json</code> instead"}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": false, "score": 0, "last_activity_date": 1561532143, "creation_date": 1561532143, "answer_id": 56766898, "question_id": 56765464, "link": "https://stackoverflow.com/questions/56765464/saving-json-response-in-create/56766898#56766898", "title": "Saving json response in create", "body": "<p><code>rate.as_json</code> is correctly returning a hash, but when you pass data to form.radio_button it get's converted into something html friendly. Basically, form.radio_button calls <code>.to_s</code> (or some similar method that probably also escapes html) on that hash, which is why you're getting the hash as a string.</p>\n\n<p>As a rule, individual HTML form elements should not contain hash data, and especially not ruby formatted hash data. Keep in mind that once the page is rendered in a browser, it knows nothing about the backend, let alone how to run ruby code.</p>\n\n<p>You should take a step back and think of this RESTfully. If your users are meant to select a rate, and you have a number of rate records in your db, you really only need them to send back the <em>id</em> of the rate they would like. Without seeing your controller it's hard to tell exactly what else would need to change, but your radio buttons should probably look more like:</p>\n\n<pre><code>&lt;%= form.radio_button :rate_id, rate.id %&gt;\n</code></pre>\n\n<p>Your controller's create method would then be responsible for setting the user's selected rate, possibly requiring you to look up the rate again.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561532143, "creation_date": 1561525145, "question_id": 56765464, "link": "https://stackoverflow.com/questions/56765464/saving-json-response-in-create", "title": "Saving json response in create", "body": "<p>I want to save a json response but it is saving the title instead of the value.  Also having issues with how the params are coming through with slashes instead of as a hash</p>\n\n<p>I have the following response from form submit:</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"2134\", \"shipping_rate\"=&gt;{...\"shipping_rate\"=&gt;\"{\\\"serviceName\\\"=&gt;\\\"USPS First Class Mail - Package\\\", \\\"serviceCode\\\"=&gt;\\\"usps_first_class_mail\\\", \\\"shipmentCost\\\"=&gt;2.66, \\\"otherCost\\\"=&gt;0.0}\"}, \"commit\"=&gt;\"Create Shipping rate\"}\n</code></pre>\n\n<p><strong>form:</strong></p>\n\n<pre><code>...\n&lt;% @rates.each do |rate| %&gt;\n  &lt;%= form.radio_button :shipping_rate, rate.as_json %&gt; &lt;%= rate %&gt;&lt;br /&gt;\n&lt;% end %&gt;\n...\n</code></pre>\n\n<p>I am under the impression using <code>as_json</code> removes the \"/\" so it comes through as a hash parameters.</p>\n\n<p>I also tried using <code>@rates.as_json.each</code> with same results</p>\n\n<p><strong>Create</strong> method in controller:</p>\n\n<pre><code>@shipping_rate.service_code = params[\"shipping_rate\"][\"shipping_rate\"][\"serviceCode\"]\n</code></pre>\n\n<p>How the service_code saves is as \"serviceCode\" and not \"usps_first_class_mail\".</p>\n\n<p>How can I:</p>\n\n<ol>\n<li>Have the params come through as a hash, without the <code>/</code>'s</li>\n<li>Save the value of <code>params[\"shipping_rate\"][\"shipping_rate\"][\"serviceCode\"]</code> instead of the title</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-dynamodb"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3285614, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005699283880/picture?type=large", "display_name": "user3285614", "link": "https://stackoverflow.com/users/3285614/user3285614"}, "is_accepted": false, "score": 0, "last_activity_date": 1561554293, "creation_date": 1561554293, "answer_id": 56773517, "question_id": 56763992, "link": "https://stackoverflow.com/questions/56763992/problem-saving-object-to-dynamodb-using-dynamoid/56773517#56773517", "title": "Problem saving object to DynamoDB using Dynamoid", "body": "<p>As mentioned in the <a href=\"https://github.com/Dynamoid/dynamoid/issues/366\" rel=\"nofollow noreferrer\">Github issue</a>, the Dynamoid gem does not support rails 6</p>\n"}], "owner": {"reputation": 11, "user_id": 3285614, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005699283880/picture?type=large", "display_name": "user3285614", "link": "https://stackoverflow.com/users/3285614/user3285614"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1542, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561554293, "creation_date": 1561512785, "question_id": 56763992, "link": "https://stackoverflow.com/questions/56763992/problem-saving-object-to-dynamodb-using-dynamoid", "title": "Problem saving object to DynamoDB using Dynamoid", "body": "<p>I tried to create rails 6 (ruby version: 2.6.3) project using Dynamoid to store data in my DynamoDB database.</p>\n\n<p>To make sure my data is saved correctly in dynamoDB, I followed the configuration step mentioned in the README file (<a href=\"https://github.com/Dynamoid/dynamoid\" rel=\"nofollow noreferrer\">https://github.com/Dynamoid/dynamoid</a>).\nI create a user model as following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User\n  include Dynamoid::Document\n\n  field :name\nend\n</code></pre>\n\n<p>After configuration, I tried to save a user using the rails console.</p>\n\n<p>As a result, I have this error :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>2.6.3 :012 &gt; u = User.create(name: 'John')\nTraceback (most recent call last):\n        1: from (irb):12\nNoMethodError (undefined method `force_change' for #&lt;ActiveModel::NullMutationTracker:0x00007faf8e24bef0&gt;)\n</code></pre>\n\n<p>Anybody had the same issue? \nDimanoid is supported by rails 6?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1561511571, "post_id": 56763365, "comment_id": 100084499, "body": "When dividing, if the numerator or denominator is a float, the result will be a float; else it will be an integer (with the remainder being discarded). Integer division: <code>4&#47;2 #=&gt; 2; 4&#47;3 #=&gt; 1; 1&#47;2 #=&gt; 0</code>. Float division <code>4&#47;3.0 #=&gt; 1.33...; 1.0&#47;2 #=&gt; 0.5; 1.to_f&#47;2 #=&gt; 0.5</code>. A more complex example: <code>3&#47;(2&#47;(1+4).to_f) = 3&#47;(2&#47;5.0) = 3&#47;0.4 #=&gt; 7.5</code>.  You can alternatively write <code>1.fdiv(3) #=&gt; 0.5</code>. See <a href=\"http://ruby-doc.org/core-2.5.1/Numeric.html#method-i-fdiv\" rel=\"nofollow noreferrer\">Numeric#fdiv</a>."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 2, "creation_date": 1561529250, "post_id": 56763365, "comment_id": 100088469, "body": "Float division, could also be fixed changing this line: <code>sum += 1.0&#47;(1+(3*(i-1)))</code>. Note the numerator: <code>1.0</code>. Side note, instead of <code>for</code> loop, use a more Rubyish: <code>(1..n).each do |i|</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1561531267, "creation_date": 1561531267, "answer_id": 56766647, "question_id": 56763365, "link": "https://stackoverflow.com/questions/56763365/sum-of-first-nth-term-of-series/56766647#56766647", "title": "Sum of first nth term of series", "body": "<p>When you have expression like <code>z = x/y</code>, in ruby it does specify type for output based on operand provided for division. If <code>x</code> &amp; <code>y</code> both are integer, output calculated is also integer and float value is removed.</p>\n\n<p>So to obtain output as <code>float</code>, you need to have one operand at least as float value which can be found using <code>to_f</code> on variable. Here you need to change only,</p>\n\n<pre><code>- sum += 1/(1+(3*(i-1)))\n+ sum += 1.0/(1+(3*(i-1)))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11683588, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215479005632755/picture?type=large", "display_name": "Mary Lang", "link": "https://stackoverflow.com/users/11683588/mary-lang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "closed_date": 1561536622, "answer_count": 1, "score": 0, "last_activity_date": 1561531267, "creation_date": 1561506222, "last_edit_date": 1561529166, "question_id": 56763365, "link": "https://stackoverflow.com/questions/56763365/sum-of-first-nth-term-of-series", "closed_reason": "Duplicate", "title": "Sum of first nth term of series", "body": "<p>I am not understanding why my code isn't looping, for any input I give I get the result of <code>\"1.00\"</code></p>\n\n<p>I feel like I am being silly and missing something very obvious.</p>\n\n<p>This series is shown in other places most often as <strong>1/3n+1</strong></p>\n\n<p>But if <code>series_sum(1) = \"1.00\"</code></p>\n\n<p>then <strong>3+1 = 4</strong> giving you <strong>1/4</strong> to add to your sum for input of <strong>1</strong> which doesn't make sense</p>\n\n<pre><code>def series_sum(n)\n  sum = 0\n  if n == 0\n    return \"0.00\"\n  else\n    for i in 1..n \n      sum += 1/(1+(3*(i-1)))\n    end\n  end\n\n  return \"%.2f\" % sum.to_s\n\nend\n</code></pre>\n\n<p>for <code>series_sum(1)</code> should be <code>\"1.00\"</code>\n<code>series_sum(2)</code> should be <code>\"1.25\"</code>\n<code>series_sum(3)</code> should be <code>\"1.39\"</code>\netc</p>\n\n<p>My code gives <code>\"1.00\"</code> for any input</p>\n\n<p>Why won't this code run the loop and perform the sum?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1561514501, "post_id": 56763355, "comment_id": 100085007, "body": "Don&#39;t think that it is possible to &quot;load record using different class&quot;. But may you&#39;re going in wrong direction, trying to solve your real problem this way? Please, add more info about the gem and what you&#39;re trying to achieve?"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1561529356, "post_id": 56763355, "comment_id": 100088504, "body": "I would type it all out, but the specifics are pretty complicated... Basically I have a gem I&#39;m using that takes in an AR relation object, and tries to lookup other classes I&#39;m expected to define using class.name. My base STI class has about a dozen classes inheriting it, and I&#39;d like to not have to define a dozen more classes that are all almost the exact same. Tried dynamically creating those classes by doing using const_set and iterating over the leaves, but that doesn&#39;t work because my gem assumes that class.name is non-nil when the class is defined. tldr it&#39;s this or monkey-patch the gem."}], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1561529810, "post_id": 56764780, "comment_id": 100088684, "body": "This <i>almost</i> works. I&#39;m using a gem that expects me to give it an AR object, and calling <code>map{|e| e.becomes(MyClass)}</code> collapses the AR object into an array. My gem wants to call <code>join</code> or <code>includes</code> on what I pass it. Added that requirement to the question. I didn&#39;t think of using becomes though, and I might be able to do a more surgical monkey patch using it. Will see..."}], "tags": [], "owner": {"reputation": 2356, "user_id": 1547872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/x2Brf.jpg?s=128&g=1", "display_name": "dileep nandanam", "link": "https://stackoverflow.com/users/1547872/dileep-nandanam"}, "is_accepted": false, "score": 2, "last_activity_date": 1561519903, "creation_date": 1561519903, "answer_id": 56764780, "question_id": 56763355, "link": "https://stackoverflow.com/questions/56763355/how-can-i-load-an-sti-record-using-just-the-base-sti-class/56764780#56764780", "title": "How can I load an STI record using just the base STI class?", "body": "<pre><code>Myclass.all.map{|e| e.becomes(Myclass)}\n</code></pre>\n\n<p>will give objects of class Myclass regardless the type attribute.</p>\n"}], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2832, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561529832, "creation_date": 1561506071, "last_edit_date": 1561529832, "question_id": 56763355, "link": "https://stackoverflow.com/questions/56763355/how-can-i-load-an-sti-record-using-just-the-base-sti-class", "title": "How can I load an STI record using just the base STI class?", "body": "<p>Say I have models using STI like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyBase &lt; ApplicationRecord ; end\nclass MyBase::MySubclass1 &lt; MyBase ; end\nclass MyBase::MySubclass2 &lt; MyBase ; end\n</code></pre>\n\n<p>When I lookup records using the base class, the records all load with the class in the type column.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>MyBase.all.to_a.map { |record| record.class.name }\n# =&gt; [MyBase::MySubclass1, MyBase::MySubclass2]\n</code></pre>\n\n<p>99 times out of 100 this is a good thing, but is it possible to have these records load into their base class instead of the class in the type column? eg</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>MyBase.first.class\n# =&gt; MyBase\n</code></pre>\n\n<p>I'm hoping there's a way to turn it off in the AR query, something like <code>MyBase.where(condition: :something, use_base: true)</code>...</p>\n\n<p>My use case is that I'm using a gem which expects me to pass it an AR relation, looks at class.name, and breaks when it gets an STI subclass. To avoid patching the gem, I'd like to abide by its limitations and pass it a relation whose records' classes will automatically be coerced into the STI base class when loaded.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "react-rails"], "comments": [{"owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1561527854, "post_id": 56762699, "comment_id": 100087951, "body": "What does the react code look like?"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1837676, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a295b35e68023c56f211bf5df921b8a7?s=128&d=identicon&r=PG", "display_name": "Steez", "link": "https://stackoverflow.com/users/1837676/steez"}, "edited": false, "score": 0, "creation_date": 1561558513, "post_id": 56767308, "comment_id": 100105281, "body": "This is a good catch but this isn&#39;t actually the problem. I will make the proper edits above. Thanks"}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1561533648, "creation_date": 1561533648, "answer_id": 56767308, "question_id": 56762699, "link": "https://stackoverflow.com/questions/56762699/how-to-redirect-to-a-ruby-on-rails-controller-that-renders-a-react-rails-page/56767308#56767308", "title": "How to redirect to a ruby on rails controller that renders a react rails page", "body": "<p>I think you got the redirect code wrong.\nCan you try this in the redirection controller?</p>\n\n<pre><code>redirect_to edit_user_path(user, track: \"homepage\")\n</code></pre>\n\n<p>Use <code>redirect_to</code> instead of <code>return</code></p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 1837676, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a295b35e68023c56f211bf5df921b8a7?s=128&d=identicon&r=PG", "display_name": "Steez", "link": "https://stackoverflow.com/users/1837676/steez"}, "is_accepted": true, "score": 0, "last_activity_date": 1561573134, "creation_date": 1561573134, "answer_id": 56778881, "question_id": 56762699, "link": "https://stackoverflow.com/questions/56762699/how-to-redirect-to-a-ruby-on-rails-controller-that-renders-a-react-rails-page/56778881#56778881", "title": "How to redirect to a ruby on rails controller that renders a react rails page", "body": "<p>Turns out it was a timing issue. The link I was using had turbolinks enabled. When I changed turbolinks to be false everything worked as expected. </p>\n"}], "owner": {"reputation": 193, "user_id": 1837676, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a295b35e68023c56f211bf5df921b8a7?s=128&d=identicon&r=PG", "display_name": "Steez", "link": "https://stackoverflow.com/users/1837676/steez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 56778881, "answer_count": 2, "score": 0, "last_activity_date": 1561573134, "creation_date": 1561500724, "last_edit_date": 1561558549, "question_id": 56762699, "link": "https://stackoverflow.com/questions/56762699/how-to-redirect-to-a-ruby-on-rails-controller-that-renders-a-react-rails-page", "title": "How to redirect to a ruby on rails controller that renders a react rails page", "body": "<p>I have a button on my homepage that redirects to my controller:\n<code>redirect_to edit_user_path(user, track: \"homepage\")</code></p>\n\n<p>I can see that the redirect works correctly because if I throw a pry inside the controller it'll freeze. </p>\n\n<p>The edit action inside my users_controller renders a react page. I am using the react rails gem.</p>\n\n<p>When I visit the users/:id/edit page it works properly but for whatever reason when I go thru the redirect it doesn't load properly.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># edit.html.erb\n`&lt;%= react_component(\"App\", @data) %&gt;`\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># users_controller#edit\n# GET users/:id/edit\ndef edit\n  @tracking = params[:track] if params[:track].present?\n  @data = {name: \"steve\", age: 33, track: @tracking}\nend\n</code></pre>\n\n<p>It almost looks like all of the props are missing because the react developer tools says: \"waiting for roots to load...\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 6559, "user_id": 382520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05f73868bd13eba39cab490c897f1333?s=128&d=identicon&r=PG", "display_name": "JCorcuera", "link": "https://stackoverflow.com/users/382520/jcorcuera"}, "edited": false, "score": 0, "creation_date": 1561498038, "post_id": 56762156, "comment_id": 100081679, "body": "Please paste your schema for the users table."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 2, "creation_date": 1561498413, "post_id": 56762156, "comment_id": 100081804, "body": "And did you add <code>wistia_project_id</code> column? Was it via migration? Did it run on your remote db?"}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1561498651, "post_id": 56762156, "comment_id": 100081872, "body": "@MartinZinovsky It was via migration. I didn&#39;t run it on my remote DB, but I just did and it WORKED!!! :D I will give you the points for this."}], "owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561497590, "creation_date": 1561497590, "question_id": 56762156, "link": "https://stackoverflow.com/questions/56762156/rails-undefined-method-error-for-form-label-and-text-field", "title": "Rails: undefined method error for form label and text field", "body": "<p>My <code>show.html.erb</code> is literally just a page that has User information and has a text field + button that one can type in. </p>\n\n<p>For some reason, Heroku crashes when I try to go to <code>show.html.erb</code>, the logs which can be seen in this <a href=\"http://%3Cscript%20src=%22https://gist.github.com/wangjess/121e58b733c70a6ec44a21ca25687c95.js%22%3E%3C/script%3E\" rel=\"nofollow noreferrer\">public gist.</a></p>\n\n<p>On line 26, it's clear that it doesn't like my naming <code>wistia_project_id</code>. However, this is just the name of the column that I created for my Users table, and it's also what I want to call the text field. </p>\n\n<p>It is not a method. It's literally just my <code>wistia_project_id</code> name. </p>\n\n<p>For those curious why I want to do this, I want to <code>put</code> this to my database, updating the <code>wistia_project_id</code> column in the database. </p>\n\n<p>I am new to Rails and I don't understand this error.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1561496866, "post_id": 56761998, "comment_id": 100081319, "body": "The first one is a special-case, it specifies arguments to Ruby. Normally it&#39;s <code>#!&#47;usr&#47;bin&#47;env ruby</code> with or without <code>-w</code> as preference dictates."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561496918, "post_id": 56761998, "comment_id": 100081330, "body": "Please edit if you like... Or let me know!"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 3, "creation_date": 1561497223, "post_id": 56761998, "comment_id": 100081422, "body": "@S.Goswami He&#39;s saying it&#39;s not Ruby-related, it&#39;s a shebang."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 5, "last_activity_date": 1561496920, "creation_date": 1561496920, "answer_id": 56762030, "question_id": 56761998, "link": "https://stackoverflow.com/questions/56761998/list-of-all-magic-instructions-in-ruby/56762030#56762030", "title": "List of all magic instructions in Ruby", "body": "<p>The link you mention there has a link to <a href=\"https://github.com/ruby/ruby/blob/v2_6_0/parse.y#L6687-L6690\" rel=\"noreferrer\">the Ruby source</a> where these are defined:</p>\n\n<pre><code>static const struct magic_comment magic_comments[] = {\n    {\"coding\", magic_comment_encoding, parser_encode_length},\n    {\"encoding\", magic_comment_encoding, parser_encode_length},\n    {\"frozen_string_literal\", parser_set_compile_option_flag},\n    {\"warn_indent\", parser_set_token_info},\n# if WARN_PAST_SCOPE\n    {\"warn_past_scope\", parser_set_past_scope},\n# endif\n};\n</code></pre>\n\n<p>One of these is gated based on a <code>#define</code>, so it may be a feature that's incomplete or yet to ship, perhaps held back for Ruby 2.7 or 3.0.</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56762030, "answer_count": 1, "score": 2, "last_activity_date": 1609927484, "creation_date": 1561496745, "last_edit_date": 1609927484, "question_id": 56761998, "link": "https://stackoverflow.com/questions/56761998/list-of-all-magic-instructions-in-ruby", "title": "List of all magic instructions in Ruby", "body": "<p>I am looking for a list of all the magic instructions in Ruby.</p>\n\n<p>For example:</p>\n\n<pre><code>#!/usr/bin/ruby -w\n# encoding: windows-1252\n# warn_indent: false\n# frozen_string_literal: true\n</code></pre>\n\n<p>I just got <a href=\"https://idiosyncratic-ruby.com/58-magic-instructions.html\" rel=\"nofollow noreferrer\">one link</a> mentioning some of them.</p>\n"}, {"tags": ["ruby", "grape", "grape-api"], "comments": [{"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 1, "creation_date": 1561496284, "post_id": 56761778, "comment_id": 100081140, "body": "Can you show your setup?"}, {"owner": {"reputation": 31, "user_id": 11009139, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QS777hjzhxk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMOmgPHznQDt_H8ZummS84rdBbx1g/mo/photo.jpg?sz=128", "display_name": "senpAi95", "link": "https://stackoverflow.com/users/11009139/senpai95"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1561501132, "post_id": 56761778, "comment_id": 100082559, "body": "@EJ2015 Thanks for your response. Please look at my edit."}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1561584985, "post_id": 56761778, "comment_id": 100117376, "body": "Did you try setting the Accept header in your request?"}, {"owner": {"reputation": 31, "user_id": 11009139, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QS777hjzhxk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMOmgPHznQDt_H8ZummS84rdBbx1g/mo/photo.jpg?sz=128", "display_name": "senpAi95", "link": "https://stackoverflow.com/users/11009139/senpai95"}, "reply_to_user": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1561589153, "post_id": 56761778, "comment_id": 100118505, "body": "Yes. Even tried with content-type in request header too. No luck!"}], "owner": {"reputation": 31, "user_id": 11009139, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QS777hjzhxk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMOmgPHznQDt_H8ZummS84rdBbx1g/mo/photo.jpg?sz=128", "display_name": "senpAi95", "link": "https://stackoverflow.com/users/11009139/senpai95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561511756, "creation_date": 1561495588, "last_edit_date": 1561511756, "question_id": 56761778, "link": "https://stackoverflow.com/questions/56761778/content-type-is-different-in-response", "title": "content type is different in response", "body": "<p>I am reading a binary file and trying to send in body of a response with application/octet-stream as content type. In postman and chrome I could get the binary data in the body but the headers are still application/json no matter what I change/do.</p>\n\n<p>edit:</p>\n\n<pre><code>desc 'Retrieve a Binary file' do\n            detail 'Retrieves a binary for a given file.'\n            produces ['application/octet-stream','application/json',\n                      'application/xml', 'text/plain']\n\n          get tags: ['abc'] do\n            content_type 'application/octet-stream'\n            present stubed_data\n          end \n</code></pre>\n\n<p>and api.rb has</p>\n\n<pre><code>    content_type :xml, 'application/xml'\n    content_type :json, 'application/json'\n    content_type :binary, 'application/octet-stream'\n    content_type :txt, 'text/plain'\n    default_format :json\n</code></pre>\n"}, {"tags": ["json", "ruby", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 189, "user_id": 11604669, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nUn6Vjvj8mc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reG6n_9NfbomnKqJwn0m_cvFSDoeQ/mo/photo.jpg?sz=128", "display_name": "Gerold Astor", "link": "https://stackoverflow.com/users/11604669/gerold-astor"}, "edited": false, "score": 0, "creation_date": 1561494607, "post_id": 56761538, "comment_id": 100080537, "body": "Thanks for the feedback."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 3, "last_activity_date": 1561494614, "last_edit_date": 1561494614, "creation_date": 1561494351, "answer_id": 56761538, "question_id": 56761501, "link": "https://stackoverflow.com/questions/56761501/parsing-a-json-with/56761538#56761538", "title": "Parsing a JSON with []", "body": "<p>Since data is an array you need to access the items inside the array by the index.</p>\n\n<pre><code>puts response[\"daily\"][\"data\"][0][\"precipType\"]\n</code></pre>\n\n<p>For the first element in the array.</p>\n\n<p>Or loop over all items in the array like so</p>\n\n<pre><code>response[\"daily\"][\"data\"].each do |item|\n  puts item[\"precipType\"]\nend\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 11604669, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nUn6Vjvj8mc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reG6n_9NfbomnKqJwn0m_cvFSDoeQ/mo/photo.jpg?sz=128", "display_name": "Gerold Astor", "link": "https://stackoverflow.com/users/11604669/gerold-astor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56761538, "answer_count": 1, "score": 0, "last_activity_date": 1561494614, "creation_date": 1561494178, "question_id": 56761501, "link": "https://stackoverflow.com/questions/56761501/parsing-a-json-with", "title": "Parsing a JSON with []", "body": "<p>I am having trouble accessing parts of a json that looks like this. The thing I am looking to get is precip type.</p>\n\n<pre><code>{\n        \"latitude\": 42.3601,\n        \"daily\": {\n          \"data\": [\n            {\n              \"time\": 255589200,\n              \"icon\": \"snow\",\n              \"sunriseTime\": 255613996,\n              \"sunsetTime\": 255650764,\n              \"moonPhase\": 0.97,\n              \"precipIntensity\": 0.0354,\n              \"precipIntensityMax\": 0.1731,\n              \"precipIntensityMaxTime\": 255657600,\n              \"precipProbability\": 1,\n              \"precipAccumulation\": 7.337,\n              \"precipType\": \"snow\",\n              \"temperatureHigh\": 31.84,\n            }\n          ]\n        },\n        \"offset\": -5\n      }\n</code></pre>\n\n<p>So far I have tried </p>\n\n<p><code>response['daily']['data']['precipType']</code></p>\n\n<p>and also this (I didn't expect this to work though, it was just a try)</p>\n\n<p><code>response['daily']['data.precipType']</code></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561493149, "post_id": 56761186, "comment_id": 100079963, "body": "Regardless of the error, this is a somewhat convoluted bit of code. If you want <code>from_date</code> to be a <b>date</b>, which defaults to <b>today</b>, then you can probably just do: <code>def main(from_date = Date.today)</code>. And if you <i>really</i> need it it to actually be <code>Time</code> instance (??!!!), then: <code>def main(from_date = Date.today.to_time)</code>."}, {"owner": {"reputation": 542, "user_id": 1064501, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5c83b9b945e2fbad3cd254dc98650679?s=128&d=identicon&r=PG", "display_name": "Sergey Blohin", "link": "https://stackoverflow.com/users/1064501/sergey-blohin"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561493429, "post_id": 56761186, "comment_id": 100080065, "body": "@TomLord, I do not need current <i>date</i>, I need current date <i>with</i> zero hours/minutes/seconds. 2019-06-25 00:00:00 (begin of current day)."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1561493627, "post_id": 56761186, "comment_id": 100080155, "body": "That&#39;s exactly what <code>Date.today</code> is. A <code>Date</code> object has no notion of hours, minutes, seconds, etc. And it would be a rather odd requirement that a variable named <code>from_date</code> must be a <code>Time</code>, not a <code>Date</code>. Regardless, as I said, <code>Date.today.to_time</code> returns an identical value to your approach."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561493703, "post_id": 56761186, "comment_id": 100080179, "body": "For what it&#39;s worth though, I have no idea why RubyMine reports <code>dereference may occur</code>. All I can say is that the code can be better written; and doing so would likely make the warning go away."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561494098, "post_id": 56761186, "comment_id": 100080326, "body": "@TomLord if <code>nil</code> is explicitly passed, then <code>def main(from_date = Date.today.to_time)</code> does not work as <code>nil</code> is still a valid argument thus replacing the default value for <code>from_date</code> (this may be what RubyMine is actually warning about). That being said I agree with <code>Date.today.to_time</code>"}], "owner": {"reputation": 542, "user_id": 1064501, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5c83b9b945e2fbad3cd254dc98650679?s=128&d=identicon&r=PG", "display_name": "Sergey Blohin", "link": "https://stackoverflow.com/users/1064501/sergey-blohin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561492643, "creation_date": 1561492643, "question_id": 56761186, "link": "https://stackoverflow.com/questions/56761186/nil-dereference-may-occur-on-time-new-to-date-to-time", "title": "nil dereference may occur on Time.new.to_date.to_time", "body": "<p>Why RubyMine gives a warning <code>nil dereference may occur</code> on <code>Time.new.to_date.to_time</code>?  </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def main(from_date = nil)\n  from_date ||= Time.new.to_date.to_time\nend\n</code></pre>\n\n<p>I want to fill variable <code>from_date</code> in method with either an argument passed to the method or the current date (Time.new.to_date.to_time).</p>\n\n<p>In what case can happen <code>dereference may occur</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "edited": false, "score": 0, "creation_date": 1561495355, "post_id": 56761440, "comment_id": 100080816, "body": "This <code>&lt;% end %&gt;</code> instead of this <code>&lt;%= end %&gt;</code>. (First line) :)"}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561496515, "post_id": 56761440, "comment_id": 100081205, "body": "Thank you so much for your thought-out response. I appreciate the effort you put in! One question, you mention that you pass something into <code>set_project_id!(val)</code>, but you do not pass anything when you call it in <code>@user.set_project_id</code>? Thank you again."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561497903, "post_id": 56761440, "comment_id": 100081643, "body": "@McFloofenbork you&#39;re right, that was a typo. Edited"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1561501792, "last_edit_date": 1561501792, "creation_date": 1561493907, "answer_id": 56761440, "question_id": 56761171, "link": "https://stackoverflow.com/questions/56761171/i-have-a-bug-in-my-html-erb-file-for-rails/56761440#56761440", "title": "I have a bug in my HTML ERB file for Rails", "body": "<p>The syntax error is that you are missing <code>&lt;% end %&gt;</code> for the <code>&lt;%= form_for(@user) do |f| %&gt;</code> block.</p>\n\n<p>To answer your question about how to access the param in the model's method - you should pass it as an argument:</p>\n\n<pre><code>@user.set_project_id(params[:wistia_project_ID])\n</code></pre>\n\n<p>And change the method to accept an argument. Note, I am assuming you want to actually persist this to the database, so I'm adding a <code>save</code> call. You could alternatively call <code>update</code> which assigns the new value and saves in one go.</p>\n\n<pre><code>def set_project_id(val)\n  self.wistia_project_ID = val # self is necessary here\n  save # or self.save, but the self is unnecessary here\nend\n</code></pre>\n\n<p>However, calling <code>save</code> does always <em>succesfully</em> save the record, there is still the possibility of an error if a model-level validation failed. You can handle this using <code>flash</code>: <a href=\"https://guides.rubyonrails.org/action_controller_overview.html#flash-now\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/action_controller_overview.html#flash-now</a></p>\n\n<p>or, if you don't need to redirect, can just use an instance variable to store the errors:</p>\n\n<pre><code>@user = User.find(params[:id])\n@user.set_project_id(params[:wistia_project_ID])\nunless @user.valid?\n  @errors = @user.errors.full_messages\n  render :show\nend\n</code></pre>\n\n<p>and in the <code>show</code> view:</p>\n\n<pre><code>&lt;% if @errors  %&gt;\n  &lt;p&gt;THE FORM COULD NOT BE SAVED &lt;/p&gt;\n  &lt;ul id='errors'&gt;\n  &lt;% @errors.each do |error| %&gt;\n    &lt;li&gt;&lt;%= error %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Also note, I would probably rename your <code>set_project_id</code> method to <code>set_project_id!</code> (added a bang), to signify that it mutates the input (changes its internal state).</p>\n"}], "owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56761440, "answer_count": 1, "score": 0, "last_activity_date": 1561501792, "creation_date": 1561492548, "last_edit_date": 1561497091, "question_id": 56761171, "link": "https://stackoverflow.com/questions/56761171/i-have-a-bug-in-my-html-erb-file-for-rails", "title": "I have a bug in my HTML ERB file for Rails", "body": "<p>I want to create a text field that accepts input and when you press the button next to it, it will save these changes to the database. It will be a PUT request, updating the value in the database for this specific user (not the logged in user, this is a page for admins to update values for users).</p>\n\n<p>This is what the structure should be, (code to follow below): </p>\n\n<p>1) Create text field and button for this in <code>show.html.erb</code></p>\n\n<p>2) Create a function called <code>set_wistia_project_ID</code> for this in <code>users_controller.rb</code>, set button equal to this <code>:action</code></p>\n\n<p>3) Create a helper function called <code>set_project_id</code> in <code>user.rb</code> that is called by <code>set_wistia_project_ID</code>, which actually updates the database. I decided to split it up into two functions because I noticed a lot of Rails projects tend to separate and break up functionality into the controller and model. </p>\n\n<p>4) Edit my <code>routes.rb</code> to include some strange code, which I'll be honest, have no idea what it actually does. But without it, the entire app crashes on Heroku. So I leave it there. Found from a StackOverflow post.</p>\n\n<p>My <code>show.html.erb</code>:</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;div class=\"row\"&gt;\n  &lt;aside class=\"col-md-4\"&gt;\n    &lt;section class=\"user_info\"&gt;\n      &lt;h1&gt;\n        &lt;%= gravatar_for @user %&gt;\n        &lt;%= @user.name %&gt;\n        &lt;br&gt;\n        &lt;%= @user.email %&gt;\n        &lt;br&gt;\n        &lt;div class=\"row\"&gt;\n          &lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n            &lt;%= form_for(@user) do |f| %&gt;\n              &lt;%= render 'shared/error_messages' %&gt;\n\n              &lt;%= f.label :wistia_project_id %&gt;\n              &lt;%= f.text_field :wistia_project_id, class: 'form-control' %&gt;\n\n              &lt;%= button_to \"Save\", :action =&gt; \"set_wistia_project_ID\", :method =&gt; :put, :form_class =&gt; \"form-control\" %&gt;   \n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/h1&gt;\n    &lt;/section&gt;\n  &lt;/aside&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>My <code>users_controller.rb</code>:</p>\n\n<pre><code>  # Sets wistia_project_ID.\n  def set_wistia_project_ID\n    @user = User.find(params[:id])\n    @user.set_project_id\n  end\n</code></pre>\n\n<p>My <code>user.rb</code>:</p>\n\n<pre><code>  # Sets the wistia_project_ID.\n  def set_project_id\n    self.wistia_project_ID # HOW TO SET EQUAL TO INPUT?\n  end\n</code></pre>\n\n<p>My <code>routes.rb</code>:</p>\n\n<pre><code>Rails.application.routes.draw do\n  root 'static_pages#home'\n  get 'password_resets/new'\n  get 'password_resets/edit'\n  get 'sessions/new'\n  get  '/help',    to: 'static_pages#help'\n  get  '/about',   to: 'static_pages#about'\n  get  '/contact', to: 'static_pages#contact'\n  get  '/signup',  to: 'users#new'\n  post '/signup',  to: 'users#create'\n  get    '/login',   to: 'sessions#new'\n  post   '/login',   to: 'sessions#create'\n  delete '/logout',  to: 'sessions#destroy'\n  resources :users do\n    member do\n      put 'set_wistia_project_ID'\n    end\n  end\n  resources :account_activations, only: [:edit]\n  resources :password_resets,     only: [:new, :create, :edit, :update]\nend\n</code></pre>\n\n<p>But the problem I am having is that when I try to go to <code>show.html.erb</code>, my Heroku app crashes :(</p>\n\n<p>The reason:</p>\n\n<pre><code>F, [2019-06-25T19:53:20.706881 #8] FATAL -- : [b2ed08bb-de52-417f-9ba8-8ec85629dce8] \napp/views/users/show.html.erb:30: \nsyntax error, unexpected end-of-input, expecting end\n</code></pre>\n\n<p>But it looks fine to me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller", "helper", "link-to"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1561495086, "post_id": 56761039, "comment_id": 100080721, "body": "Why? Just separate the routes so that you have a <code>pending_bookings_path</code> and an <code>approved_bookings_path</code>"}, {"owner": {"reputation": 129, "user_id": 10663676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e53116ab119e0bb4c481ff8829db729?s=128&d=identicon&r=PG&f=1", "display_name": "kel.o", "link": "https://stackoverflow.com/users/10663676/kel-o"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1561497441, "post_id": 56761039, "comment_id": 100081497, "body": "I considered this, but I like to avoid creating new routes when not absolutely necessary. This is definitely a solution though and is less complex than the suggested solution i proposed."}], "answers": [{"comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1561501319, "post_id": 56761959, "comment_id": 100082605, "body": "<code>status: &quot;#{params[:status]}&quot;</code> can be just <code>status: params[:status]</code>"}], "tags": [], "owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "is_accepted": true, "score": 3, "last_activity_date": 1561496883, "last_edit_date": 1561496883, "creation_date": 1561496581, "answer_id": 56761959, "question_id": 56761039, "link": "https://stackoverflow.com/questions/56761039/routing-to-different-instances-of-index-using-a-helper-method/56761959#56761959", "title": "Routing to different instances of Index using a Helper Method", "body": "<p>It seems like you're going about this in a more complicated way than you need to.  Why not just have an index like:</p>\n\n<pre><code> def index\n   #Rails autoescapes this string so no fear of sql injection using user supplied strings\n   @bookings = Booking.where(host_id:@user.id, status: \"#{params[:status]}\")\n end\n</code></pre>\n\n<p>Then use a link like:  </p>\n\n<pre><code> &lt;%= link_to 'Pending Reservations', bookings_path(status: 'pending')%&gt;\n &lt;%= link_to 'Approved Reservations', bookings_path(status: 'approved')%&gt; `\n</code></pre>\n\n<p>Now your view can just handle <code>@bookings</code> and not concern itself with the types of <code>@bookings</code> as that is done by the logic in your controller. This is the bare minimum but you should get in the habit of adding error messages etc. to your controllers so consider doing:</p>\n\n<pre><code> def index\n   if params[:status].present?\n     #Rails autoescapes this string so no fear of sql injection using user supplied strings\n     @bookings = Booking.where(host_id:@user.id, status: \"#{params[:status]}\")\n     flash[:success] = \"#{params[:status].titleize} Bookings loaded.\"\n     redirect_to whatever_path\n   else\n     flash[:error] = \"Something went wrong\"\n     redirect_to some_path\n   end\n end\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 10663676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e53116ab119e0bb4c481ff8829db729?s=128&d=identicon&r=PG&f=1", "display_name": "kel.o", "link": "https://stackoverflow.com/users/10663676/kel-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56761959, "answer_count": 1, "score": 0, "last_activity_date": 1561496883, "creation_date": 1561491914, "last_edit_date": 1561492991, "question_id": 56761039, "link": "https://stackoverflow.com/questions/56761039/routing-to-different-instances-of-index-using-a-helper-method", "title": "Routing to different instances of Index using a Helper Method", "body": "<p>I have a controller called BookingsController with a bookings#index action. Inside the index action, there are 2 instance variables, <code>@pending_bookings</code> and <code>@approved_bookings</code>, which query Booking objects by their <code>status</code>. </p>\n\n<pre><code> def index\n     @pending_bookings = Booking.where(host_id:@user.id, \n    status:'pending') \n     @approved_bookings = Booking.where(host_id:@user.id, \n    status:'approved')\n end \n</code></pre>\n\n<p>I want to route the user to a different instance of index depending on the link they click. Basically <code>bookings_path(@pending_bookings)</code> should route the user to the index page displaying all <code>pending_bookings</code>, adversely, <code>bookings_path(@approved_bookings)</code> should route the user to the index page displaying all <code>approved_bookings</code>.</p>\n\n<p>In my view, I have 2 links that should direct the user to each path respectively. </p>\n\n<pre><code> &lt;%= link_to 'Pending Reservations', bookings_path(@pending_bookings)%&gt;\n &lt;%= link_to 'Approved Reservations', bookings_path(@approved_bookings)%&gt; `\n</code></pre>\n\n<p>The index.html.erb file:</p>\n\n<pre><code>  &lt;%= booking_index_helper_path %&gt; \n</code></pre>\n\n<p>contains an embedded helper method that should recognize the path the user clicks and render the proper Booking objects.</p>\n\n<p>Here's the (flawed) logic for recognizing the path the user chooses and rendering the necessary objects:</p>\n\n<p>pages_helper.rb:</p>\n\n<pre><code> def booking_index_helper_path\n    if bookings_path(@pending_bookings)\n      render @pending_bookings\n    elsif bookings_path(@approved_bookings)\n      render @approved_bookings\n    else bookings_path(@total_bookings)\n      @total_bookings\n    end\n end\n</code></pre>\n\n<p>I put a <code>binding.pry</code> in the helper method to confirm it is being hit (it is). For some reason when I click the link to direct me to the proper objects, however, the first condition is always satisfied. What is a better way to write this conditional to recognize the path the user chooses?</p>\n"}, {"tags": ["json", "ruby", "parsing"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1561485990, "post_id": 56759720, "comment_id": 100076951, "body": "The problem is certainly that the file <code>xyz&#47;abc&#47;config.json</code> contains invalid JSON. Please double check and post the content of that file."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 11614662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b662715c73aaa0c74fb03418ad0637?s=128&d=identicon&r=PG&f=1", "display_name": "Betsy Stones", "link": "https://stackoverflow.com/users/11614662/betsy-stones"}, "edited": false, "score": 0, "creation_date": 1561486268, "post_id": 56759760, "comment_id": 100077099, "body": "I tried this too, but then I get error for obtaining parsed_key undefined method `[]&#39; for nil:NilClass (NoMethodError)"}, {"owner": {"reputation": 1602, "user_id": 880498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd8a4259431a73e23a5b860196694a0?s=128&d=identicon&r=PG", "display_name": "rogercampos", "link": "https://stackoverflow.com/users/880498/rogercampos"}, "reply_to_user": {"reputation": 91, "user_id": 11614662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b662715c73aaa0c74fb03418ad0637?s=128&d=identicon&r=PG&f=1", "display_name": "Betsy Stones", "link": "https://stackoverflow.com/users/11614662/betsy-stones"}, "edited": false, "score": 0, "creation_date": 1561486467, "post_id": 56759760, "comment_id": 100077198, "body": "The file may contain &#39;null&#39; then, that&#39;s a nil in ruby."}], "tags": [], "owner": {"reputation": 1602, "user_id": 880498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd8a4259431a73e23a5b860196694a0?s=128&d=identicon&r=PG", "display_name": "rogercampos", "link": "https://stackoverflow.com/users/880498/rogercampos"}, "is_accepted": true, "score": 1, "last_activity_date": 1561485997, "creation_date": 1561485997, "answer_id": 56759760, "question_id": 56759720, "link": "https://stackoverflow.com/questions/56759720/trouble-parsing-file-obtained-from-dir-glob/56759760#56759760", "title": "Trouble parsing file obtained from Dir.glob", "body": "<p><code>f</code> there is just the path, a String. If you want the contents of the file you'll need to read it first, <code>data = JSON.parse(File.read(f))</code></p>\n"}], "owner": {"reputation": 91, "user_id": 11614662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b662715c73aaa0c74fb03418ad0637?s=128&d=identicon&r=PG&f=1", "display_name": "Betsy Stones", "link": "https://stackoverflow.com/users/11614662/betsy-stones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56759760, "answer_count": 1, "score": 1, "last_activity_date": 1561485997, "creation_date": 1561485847, "question_id": 56759720, "link": "https://stackoverflow.com/questions/56759720/trouble-parsing-file-obtained-from-dir-glob", "title": "Trouble parsing file obtained from Dir.glob", "body": "<p>I am new to ruby. Running into error while trying to parse file obtained from Dir.glob command using JSON.parse()</p>\n\n<pre><code>require 'json'\n\nDir.glob('**/*/.json').each do |f| # find all the .json file and loop each file\n  puts f\n  data = JSON.parse(f)\n  if data['Apple'].nil?\n    puts \"skipping file #{f} as it does not have Apple\"\n    next\n  end\n  parsed_key= File.dirname(data['Apple'][0]['red'][0]['key'])\n  puts parsed_key\nend\n</code></pre>\n\n<p>`parse': 767: unexpected token at 'xyz/abc/config.json' (JSON::ParserError)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561485977, "post_id": 56759179, "comment_id": 100076945, "body": "Did you add a file called <code>procfile</code> or <code>Procfile</code>? The capital &quot;P&quot; is important."}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 1, "creation_date": 1561487084, "post_id": 56759179, "comment_id": 100077450, "body": "can you include more of the log output?"}, {"owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "edited": false, "score": 0, "creation_date": 1561490053, "post_id": 56759179, "comment_id": 100078719, "body": "Show what appears with this command: gem list bundler"}, {"owner": {"reputation": 1, "user_id": 11699077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U_aOn1Uw8X8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvccFV6hIEOquUwbgWWREGAd4kWg/photo.jpg?sz=128", "display_name": "Carl Scozzari", "link": "https://stackoverflow.com/users/11699077/carl-scozzari"}, "edited": false, "score": 0, "creation_date": 1561577499, "post_id": 56759179, "comment_id": 100114742, "body": "It is with a capital &quot;P&quot; for Procfile."}], "answers": [{"tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": false, "score": 0, "last_activity_date": 1561487928, "last_edit_date": 1561487928, "creation_date": 1561487179, "answer_id": 56760024, "question_id": 56759179, "link": "https://stackoverflow.com/questions/56759179/heroku-app-wont-deploy-and-keeps-crashing-not-sure-if-it-is-using-my-procfile/56760024#56760024", "title": "Heroku app won&#39;t deploy and keeps crashing not sure if it is using my procfile", "body": "<p>I just had this problem an hour ago. The bundler 2 update is still causing ripple effects throughout the Ruby world.</p>\n\n<p>Running this in the command line (in the same directory as your app) fixed it for me:</p>\n\n<pre><code>heroku buildpacks:set https://github.com/bundler/heroku-buildpack-bundler2\n</code></pre>\n\n<p>As indicated by <a href=\"https://github.com/bundler/bundler/issues/6784#issuecomment-438562046\" rel=\"nofollow noreferrer\">this comment on GitHub</a>.</p>\n\n<p>However, I can say that I am not sure why this is happening - perhaps it is a temporary glitch. Yesterday, I was able to deploy a different app to Heroku, without the need to run this command, and <a href=\"https://devcenter.heroku.com/changelog-items/1563\" rel=\"nofollow noreferrer\">this page on Heroku</a> states that Bundler 2 should already be supported natively.</p>\n"}], "owner": {"reputation": 1, "user_id": 11699077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U_aOn1Uw8X8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvccFV6hIEOquUwbgWWREGAd4kWg/photo.jpg?sz=128", "display_name": "Carl Scozzari", "link": "https://stackoverflow.com/users/11699077/carl-scozzari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561490257, "creation_date": 1561483526, "last_edit_date": 1561485898, "question_id": 56759179, "link": "https://stackoverflow.com/questions/56759179/heroku-app-wont-deploy-and-keeps-crashing-not-sure-if-it-is-using-my-procfile", "title": "Heroku app won&#39;t deploy and keeps crashing not sure if it is using my procfile", "body": "<p>My app will just not load it keeps timing out and is giving me a <code>503 h10</code> error through my logs. </p>\n\n<p>I have worked around the <code>uglifier</code> problem, added a <code>procfile</code>, looked to do a start script but unsure of what will work for that one. <a href=\"https://github.com/CarlSciz/Villain_Enterprise_\" rel=\"nofollow noreferrer\">https://github.com/CarlSciz/Villain_Enterprise_</a></p>\n\n<p>I have worked around the <code>uglifier</code> problem, added a <code>procfile</code>, looked to do a start script but unsure of what will work for that one. I have also added the bundler gem that it says it's missing. </p>\n\n<pre><code>2019-06-25T17:10:12.187805+00:00 app[web.1]: To update to the lastest version installed on your system, run `bundle update --bundler`.\n2019-06-25T17:10:12.187811+00:00 app[web.1]: To install the missing version, run `gem install bundler:2.0.2`\n2019-06-25T17:10:12.187818+00:00 app[web.1]: from /usr/lib/ruby/2.5.0/rubygems.rb:263:in `bin_path'\n2019-06-25T17:10:12.187825+00:00 app[web.1]: from /app/bin/bundle:3:in `&lt;main&gt;'\n2019-06-25T17:10:13.111607+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=villainenterprise.herokuapp.com request_id=9c8f5e4d-ec05-46cd-a953-6bcbbde90008 fwd=\"68.55.118.239\" dyno= connect= service= status=503 bytes= protocol=https\n2019-06-25T17:10:15.607654+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=villainenterprise.herokuapp.com request_id=a531d7a2-91ba-4f0b-b4d6-f19d1c2a675e fwd=\"68.55.118.239\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n\n<p>it just will not load, even the local host won't load now.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1561482406, "post_id": 56758860, "comment_id": 100075384, "body": "Can you show your Todo model? My guess is that you have a validation checking that the body must be present, and since you are only passing in title in the created action, the <code>@todo.save</code> line fails. Since the Todo wasn&#39;t saved, it can&#39;t redirect you to it at the end of the create method and redirects to index instead. Redirecting to an unsaved record redirects to that record&#39;s index page instead.  Btw you can use <code>params.permit(:title, :body)</code> to pass in those attrs to Todo.new. If I&#39;m right about the validation, changing that line would fix it. Or add a <code>valid?</code> check in the controller."}, {"owner": {"reputation": 3518, "user_id": 1152980, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/m8i3G.gif?s=128&g=1", "display_name": "William", "link": "https://stackoverflow.com/users/1152980/william"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1561482740, "post_id": 56758860, "comment_id": 100075529, "body": "I added it to the question above."}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1561483178, "post_id": 56758860, "comment_id": 100075722, "body": "<code>title</code> and <code>body</code> are inside the <code>todo</code> key in your <code>params</code>. You&#39;d need <code>params.require(:todo).permit(:title, :body)</code>"}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1561484293, "post_id": 56758860, "comment_id": 100076160, "body": "@fanta is correct. So you don&#39;t seem to have any validations in the model, but are you sure the Todo is correctly saving? I&#39;m still a bit suspicious of <code>@todo.save</code>. Do you see new entries in the todos table after hitting create?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561497610, "post_id": 56758860, "comment_id": 100081551, "body": "If you see that it&#39;s usually that you have no link text specified, as in <code>@link.title</code> is blank. If not then it&#39;s a case of supplying the arguments to <code>link_to</code> in the wrong order."}], "owner": {"reputation": 3518, "user_id": 1152980, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/m8i3G.gif?s=128&g=1", "display_name": "William", "link": "https://stackoverflow.com/users/1152980/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561482720, "creation_date": 1561482125, "last_edit_date": 1561482720, "question_id": 56758860, "link": "https://stackoverflow.com/questions/56758860/rails-todo-is-created-and-rendered-as-todos-on-the-html-page", "title": "Rails: Todo is created and rendered as &quot;/todos&quot; on the HTML page", "body": "<p>I haven't used Ruby/Rails in years. I am trying to get up and running with just a basic functioning Todo CRUD app. </p>\n\n<p><strong>App/models/todo.rb</strong></p>\n\n<pre><code>class Todo &lt; ApplicationRecord\nend\n</code></pre>\n\n<p><strong>db/schema</strong></p>\n\n<pre><code>ActiveRecord::Schema.define(version: 2019_06_25_070433) do\n\n  create_table \"todos\", force: :cascade do |t|\n    t.string \"title\"\n    t.string \"body\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\nend\n</code></pre>\n\n<p>The problem is when I submit a todo it renders as \"/todos\".</p>\n\n<p><a href=\"http://localhost:3000/todos\" rel=\"nofollow noreferrer\">http://localhost:3000/todos</a></p>\n\n<p>The page renders as:</p>\n\n<p><a href=\"https://i.stack.imgur.com/G8pky.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G8pky.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here are the (incomplete) controller actions.</p>\n\n<pre><code>class TodosController &lt; ApplicationController\n  def index\n    @todos = Todo.all\n  end\n\n  def show\n    @todo = Todo.find(params[:id])\n  end\n\n  def update\n  end\n\n  def new\n    @todo = Todo.new\n  end\n\n  def create\n    @todo = Todo.new(params[:title])    # I am not sure about the correct syntax for params. I want the title AND body\n    @todo.save\n    redirect_to @todo\n\n  end\n\n  def edit\n  end\n\n  def destroy\n  end\nend\n</code></pre>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code>&lt;%= form_with model: @todo do |form| %&gt;\n  &lt;%= form.text_field :title %&gt;\n  &lt;%= form.label :body%&gt;\n  &lt;%= form.text_field :body %&gt;\n  &lt;%= form.submit %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>When I submit a \"todo\" the page redirect to the show route and when the HTML page renders it does not display the \"todo\". </p>\n\n<p><strong>show.html.erb</strong></p>\n\n<pre><code>&lt;ul&gt;\n  &lt;%= @todo.title %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>The rails terminal shows the following:</p>\n\n<pre><code>Started POST \"/todos\" for ::1 at 2019-06-25 09:41:45 -0700\nProcessing by TodosController#create as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"x29t72XmHgzZ49Lg3fu/11z2U0p5bSE1RpZhRyxzIqzvtCUuCnMhfbYF6ndYq7OU58aBtNggdYzSEsmQlGKwHQ==\", \"todo\"=&gt;{\"title\"=&gt;\"Hello \", \"body\"=&gt;\"World\"}, \"commit\"=&gt;\"Create Todo\"}\n   (0.1ms)  begin transaction\n  \u21b3 app/controllers/todos_controller.rb:19\n  Todo Create (0.4ms)  INSERT INTO \"todos\" (\"created_at\", \"updated_at\") VALUES (?, ?)  [[\"created_at\", \"2019-06-25 16:41:45.054400\"], [\"updated_at\", \"2019-06-25 16:41:45.054400\"]]\n  \u21b3 app/controllers/todos_controller.rb:19\n   (4.4ms)  commit transaction\n  \u21b3 app/controllers/todos_controller.rb:19\nRedirected to http://localhost:3000/todos/32\nCompleted 200 OK in 8ms (ActiveRecord: 4.9ms)\n\n\nStarted GET \"/todos/32\" for ::1 at 2019-06-25 09:41:45 -0700\nProcessing by TodosController#show as HTML\n  Parameters: {\"id\"=&gt;\"32\"}\n  Todo Load (0.1ms)  SELECT  \"todos\".* FROM \"todos\" WHERE \"todos\".\"id\" = ? LIMIT ?  [[\"id\", 32], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/todos_controller.rb:7\n  Rendering todos/show.html.erb within layouts/application\n  Rendered todos/show.html.erb within layouts/application (0.3ms)\nCompleted 200 OK in 13ms (Views: 11.8ms | ActiveRecord: 0.1ms)\n</code></pre>\n\n<p>When I run the seed command to populate the app with dummy data it renders fine.</p>\n\n<p><strong>seeds.rb</strong></p>\n\n<pre><code>Todo.create(title: 'AAA', body: 'aaa')\nTodo.create(title: 'BBB', body: 'bbb')\nTodo.create(title: 'CCC', body: 'ccc')\nTodo.create(title: 'DDD', body: 'ddd')\n</code></pre>\n\n<p>Thank you.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mLEy5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mLEy5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "sorbet"], "comments": [{"owner": {"reputation": 2177, "user_id": 684133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e34bba8a34fc266d15ab1cebafd0a2?s=128&d=identicon&r=PG", "display_name": "Martin Vidner", "link": "https://stackoverflow.com/users/684133/martin-vidner"}, "edited": false, "score": 0, "creation_date": 1561482091, "post_id": 56758793, "comment_id": 100075236, "body": "For my reference, the actual code is in Yast::I18n - <a href=\"https://github.com/yast/yast-ruby-bindings/blob/19594f24db0fea8d4fa8b8fd4573803792686e9a/src/ruby/yast/i18n.rb#L57\" rel=\"nofollow noreferrer\">github.com/yast/yast-ruby-bindings/blob/&hellip;</a>"}, {"owner": {"reputation": 2177, "user_id": 684133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e34bba8a34fc266d15ab1cebafd0a2?s=128&d=identicon&r=PG", "display_name": "Martin Vidner", "link": "https://stackoverflow.com/users/684133/martin-vidner"}, "edited": false, "score": 0, "creation_date": 1561482865, "post_id": 56758793, "comment_id": 100075589, "body": "I am running 0.4.4296"}, {"owner": {"reputation": 44302, "user_id": 90025, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b3bb70a4bace7f9bd49f48b149ab95f9?s=128&d=identicon&r=PG", "display_name": "Paul Tarjan", "link": "https://stackoverflow.com/users/90025/paul-tarjan"}, "edited": false, "score": 0, "creation_date": 1561485080, "post_id": 56758793, "comment_id": 100076534, "body": "Thanks for the bug about the include. Fixed here: <a href=\"https://github.com/sorbet/sorbet/pull/1047\" rel=\"nofollow noreferrer\">github.com/sorbet/sorbet/pull/1047</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2177, "user_id": 684133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e34bba8a34fc266d15ab1cebafd0a2?s=128&d=identicon&r=PG", "display_name": "Martin Vidner", "link": "https://stackoverflow.com/users/684133/martin-vidner"}, "is_accepted": false, "score": 0, "last_activity_date": 1561481848, "creation_date": 1561481848, "answer_id": 56758794, "question_id": 56758793, "link": "https://stackoverflow.com/questions/56758793/how-to-call-self-class-from-a-mix-in-module/56758794#56758794", "title": "How to call `self.class` from a mix-in module?", "body": "<p>My current workaround is: (<a href=\"https://sorbet.run/#%23%20typed%3A%20true%0Amodule%20ObjectInterface%0A%20%20def%20class%3B%20super%3B%20end%0Aend%0Amodule%20M%0A%20%20include%20ObjectInterface%0A%20%20def%20foo%0A%20%20%20%20self.class%0A%20%20end%0Aend%0A\" rel=\"nofollow noreferrer\">sorbet.run link</a>)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># typed: true\nmodule ObjectInterface\n  def class; super; end\nend\nmodule M\n  include ObjectInterface\n  def foo\n    self.class\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44302, "user_id": 90025, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b3bb70a4bace7f9bd49f48b149ab95f9?s=128&d=identicon&r=PG", "display_name": "Paul Tarjan", "link": "https://stackoverflow.com/users/90025/paul-tarjan"}, "is_accepted": true, "score": 3, "last_activity_date": 1561492147, "creation_date": 1561492147, "answer_id": 56761082, "question_id": 56758793, "link": "https://stackoverflow.com/questions/56758793/how-to-call-self-class-from-a-mix-in-module/56761082#56761082", "title": "How to call `self.class` from a mix-in module?", "body": "<p>This was actually two bugs! Thanks for pointing them out:</p>\n\n<p><code>class</code> wasn't in our shims on <code>Kernel</code>: <a href=\"https://github.com/sorbet/sorbet/pull/1050\" rel=\"nofollow noreferrer\">https://github.com/sorbet/sorbet/pull/1050</a>\nand we should never suggest to include something that isn't a <code>Module</code>: <a href=\"https://github.com/sorbet/sorbet/pull/1047\" rel=\"nofollow noreferrer\">https://github.com/sorbet/sorbet/pull/1047</a></p>\n"}], "owner": {"reputation": 2177, "user_id": 684133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e34bba8a34fc266d15ab1cebafd0a2?s=128&d=identicon&r=PG", "display_name": "Martin Vidner", "link": "https://stackoverflow.com/users/684133/martin-vidner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 56761082, "answer_count": 2, "score": 2, "last_activity_date": 1561492147, "creation_date": 1561481848, "question_id": 56758793, "link": "https://stackoverflow.com/questions/56758793/how-to-call-self-class-from-a-mix-in-module", "title": "How to call `self.class` from a mix-in module?", "body": "<p>I have a module to be included in other classes. It uses the <a href=\"https://ruby-doc.org/core-2.5.0/Object.html#method-i-class\" rel=\"nofollow noreferrer\">Object#class</a> method, like this: \n(<a href=\"https://sorbet.run/#%23%20typed%3A%20true%0Amodule%20M%0A%20%20def%20foo%0A%20%20%20%20self.class%0A%20%20end%0Aend%0A\" rel=\"nofollow noreferrer\">sorbet.run link</a>)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># typed: true\nmodule M\n  def foo\n    self.class\n  end\nend\n</code></pre>\n\n<p>To this, Sorbet says</p>\n\n<pre><code>editor.rb:4: Method class does not exist on M https://srb.help/7003\n     4 |    self.class\n            ^^^^^^^^^^\n  Did you mean to `include Object` in this module?\n    ???: Did you mean: Object#class?\n</code></pre>\n\n<p>Now it gets interesting. <a href=\"https://sorbet.org/docs/error-reference#7003\" rel=\"nofollow noreferrer\">Error reference for 7003</a> does describe that this guards against type errors in modules to be included in BasicObject. Fine, so I include Object, as the checker tells me: (<a href=\"https://sorbet.run/#%23%20typed%3A%20true%0Amodule%20M%0A%20%20include%20Object%0A%20%20def%20foo%0A%20%20%20%20self.class%0A%20%20end%0Aend%0A\" rel=\"nofollow noreferrer\">sorbet.run link</a>)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># typed: true\nmodule M\n  include Object\n  def foo\n    self.class\n  end\nend\n</code></pre>\n\n<p>The error message is quite unhelpful, and the linked <a href=\"https://sorbet.org/docs/error-reference#5032\" rel=\"nofollow noreferrer\">page #5032</a> does not exist.</p>\n\n<pre><code>editor.rb:2: Only modules can be included. This module or class includes Object https://srb.help/5032\n     2 |module M\n        ^^^^^^^^\n</code></pre>\n\n<p>It took me a while to realize that it's trying to tell me I cannot include a Class which is a subclass of Module. Compare with Ruby's error message:</p>\n\n<pre><code>$ ruby -e 'module M; include Object; end'\nTraceback (most recent call last):\n        2: from -e:1:in `&lt;main&gt;'\n        1: from -e:1:in `&lt;module:M&gt;'\n-e:1:in `include': wrong argument type Class (expected Module) (TypeError)\n</code></pre>\n\n<p>How can I make my code pass the <code>typed: true</code> level here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "activerecord", "where-clause"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561491877, "post_id": 56758346, "comment_id": 100079471, "body": "To check their &quot;latest answer&quot;, you could consider doing <code>order(:created_at).limit(1)</code>.  To perform the third check, where a user has not submitted an attempt, it&#39;s vastly more efficient to perform an <b>OUTER JOIN</b> than to query by IDs like that. This is, literally, what an outer join is designed for; and modern rails has a built-in method for it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561492040, "post_id": 56758346, "comment_id": 100079533, "body": "I don&#39;t really see a way to &quot;combine&quot; these queries (what does that even mean??); the only thing I can thing of is to define a <i>scope</i> with logic like <code>.where(&quot;question_attempts.score &gt;= ? AND question_attempts.score &lt;= ?&quot;, ...)</code> - so you could pass <code>0, 99</code> as params or <code>100, 100</code> as params. But based on the information you&#39;ve provided, such a scope may be overkill."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561492223, "post_id": 56758346, "comment_id": 100079610, "body": "Another thing you could consider doing is - depending on your UI design/requirements - consider restructuring the overall model: A <code>Quiz</code> is a collection of <code>Question</code>s. And a <code>QuizAttempt</code> is a collection of <code>QuestionAnswer</code>s (which can be skipped?). When showing the scores, consider the value of each <code>QuestionAnswer</code> <i>associated to a <code>QuizAttempt</code></i>. This gives a much simpler and more meaningful definition for &quot;latest answer&quot; and &quot;overall score&quot;."}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561494640, "post_id": 56758346, "comment_id": 100080553, "body": "Thanks for your tips Tom. I don&#39;t think restructuring the models will work, unfortunately, as questions can be taken without being in a quiz. By combining I mean exactly what you mention - the user may want questions they&#39;ve answered correctly and incorrectly in the past - i.e. your suggestion of <code>.where(&quot;question_attempts.score &gt;= ? AND question_attempts.score &lt;= ?&quot;, ...)</code>. I was hoping to avoid creating a series of <code>if else</code> checks, but perhaps I could create a series of strings that I could <code>.join</code> with an <code>OR</code> statements. I&#39;ll have a play with the things you&#39;ve recommended."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561494898, "post_id": 56758346, "comment_id": 100080657, "body": "If you want a fourth scope for &quot;answered questions&quot; as opposed to &quot;unanswered questions&quot;, then a straightforward <b>INNER JOIN</b> would suffice. (The opposite of an outer join, see?) A scope like I suggested would also work - but although it saves a few lines of code, it adds unnecessary checks against the <code>score</code>. But either way, there&#39;s no need for any <code>if</code> statements here."}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561503904, "post_id": 56758346, "comment_id": 100083145, "body": "Thanks Tom, I&#39;ve managed to get it working (I think) due to your help, I&#39;ve added the code to the bottom of my question. I imagine it&#39;s a terribly convoluted solution... would appreciate any input you have"}], "answers": [{"comments": [{"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1561543199, "post_id": 56768618, "comment_id": 100095714, "body": "Thanks, that&#39;s a lot better for sure. I tweaked the logic for the params[incorrect] to also ensure that params[correct] was false (as otherwise it matched when they were both true). The only issue is that I am getting the error <code>ArgumentError (Relation passed to #or must be structurally compatible. Incompatible values: [:joins]):</code>. I&#39;ve treid a few different things but still crops up - I thought the following would work (as I can&#39;t see any join!), it works when not inside an <code>.or()</code> - <code>Question.where.not( id: QuestionAttempt.where( user_id: current_user.id ).pluck(:question_id) )</code>"}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1561545047, "post_id": 56768618, "comment_id": 100096864, "body": "Fixed it in the end, it&#39;s not as elegant as your solution it&#39;s much more elegant than my original. Thanks so much for your help!"}, {"owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "edited": false, "score": 0, "creation_date": 1561546103, "post_id": 56768618, "comment_id": 100097425, "body": "I&#39;ve updated my question to reflect what I&#39;m doing now. Basically a load of <code>.where</code> statements, after using <code>.pluck()</code> to get the relevant ids. Thanks again for your help."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1561538287, "creation_date": 1561538287, "answer_id": 56768618, "question_id": 56758346, "link": "https://stackoverflow.com/questions/56758346/filter-ruby-model-by-second-with-multiple-conditions-question-attempt-grades-a/56768618#56768618", "title": "Filter ruby model by second with multiple conditions - question attempt grades and unattempted", "body": "<p>Here is a quick pass at a cleanup of your current solution:</p>\n\n<pre><code>def tags\n  params[:topics]&amp;.split(\",\")\nend\n\ndef difficulties\n  params[:difficulties]&amp;.split(\",\")\nend\n\n# ...\n\nquestions = Question.joins(:question_attempts).where(\n    question_attempts: { user_id: current_user.id },\n    private: false,\n    draft: false,\n    approved: true\n  )\n\n# If both are true, no need to scope query\nif params[:correct] == \"true\" &amp;&amp; params[:incorrect] != \"true\"\n  questions = questions.where('question_attempts.score = 100')\nelsif params[:incorrect] == \"true\"\n  questions = questions.where('question_attempts.score &lt; 100')\nend\n\nquestions = questions.where(difficulty: difficulties) if difficulties\n\nquestions = questions.joins(:tags).where(tags: { name: tags }) if tags\n\nif params[:unattempted] == \"true\"\n  questions = questions.or(\n    Question.includes(:question_attempts).where(question_attempts: { user_id: nil})\n  )\nend\n\nquestions.distinct\n</code></pre>\n\n<p>The key difference between my version and yours is that I <em>compose the query in logical components</em>, rather than attempting to write the whole thing in one go.</p>\n\n<p>This reduces the overall length and complexity, whilst maintaining the same result.</p>\n\n<p>You could further simplify this by defining <strong>scopes</strong> on the <code>Question</code> model, to move much of this logic outside of the controller.</p>\n\n<p><em>Note: I haven't actually run this code, so it may contain some minor mistake(s). Please test carefully.</em></p>\n"}], "owner": {"reputation": 3000, "user_id": 5604852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-PDS5mZUZSok/AAAAAAAAAAI/AAAAAAAAD9Q/RGu5AZCnSoo/photo.jpg?sz=128", "display_name": "Oliver Trampleasure", "link": "https://stackoverflow.com/users/5604852/oliver-trampleasure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561545124, "creation_date": 1561479865, "last_edit_date": 1561545124, "question_id": 56758346, "link": "https://stackoverflow.com/questions/56758346/filter-ruby-model-by-second-with-multiple-conditions-question-attempt-grades-a", "title": "Filter ruby model by second with multiple conditions - question attempt grades and unattempted", "body": "<p>I am building a question engine with Ruby, I have the question element working well - users can create and attempt <code>questions</code>, and their attempts are saved in a <code>question_attempts</code> table.</p>\n\n<p>I am now trying to build a question bank feature where users can filter all questions by a few different options - tags, difficulty and the result of their last attempt (if it exists). Both the filtering by tag (via a separate <code>tags</code> table and join <code>taggings</code> table), and difficulty (a string of four options saved within the <code>question</code> table) work as expected.</p>\n\n<p>I am having some issues with filter questions based upon the user's attempts. I need to be able to filter for three different conditions:</p>\n\n<ul>\n<li><strong>Correct</strong> - where question.attempt.score == 100</li>\n<li><strong>Incorrect</strong> - where question.attempt.score &lt; 100</li>\n<li><strong>Not attempted</strong> - where question.attempt == nil / does not exist</li>\n</ul>\n\n<p>The <code>question_attempts</code> models <code>belongs_to: user</code> and <code>belongs_to: question</code>. The <code>score</code> from their attempt is saved as a standardised percentage float with a maximum of 100.0.</p>\n\n<p>For the first two I can use a similar methodology as I have for the tags, both of these work:</p>\n\n<p><code>.where(question_attempts: { score: 100, user_id: current_user.id }</code></p>\n\n<p><code>.where.not(question_attempts: { score: 100 }).where(user_id: current_user.id })</code></p>\n\n<p>I can get the questions that an individual user has not submitted a response to using the following line:</p>\n\n<p><code>.where.not(id: QuestionAttempt.where( user_id: current_user.id ).select( \"question_id\" ) )</code></p>\n\n<hr>\n\n<p>My issues are:</p>\n\n<ul>\n<li><strong>How do I combine these filter options?</strong> I am trying to avoid writing a long series of <code>if else</code> statements, but will do this if required (I can do this without assistance, just want to check there isn't a better way before cracking on)</li>\n<li><strong>How do I limit the checking of results to their last attempt only?</strong> i.e. if they have submitted a question response 2+ times I only want to check the result of the most recent. I would be tempted to use the solution from Mark Swardstrom in this <a href=\"https://stackoverflow.com/questions/5247886/rails-query-through-association-limited-to-most-recent-record\">answer</a>, primarily because I understand it, but am concerned it would be an inefficient method.</li>\n</ul>\n\n<hr>\n\n<p>Thank you for your help</p>\n\n<p>Let me know if you need more details.</p>\n\n<hr>\n\n<p><strong>Models</strong></p>\n\n<pre><code>class Question &lt; ApplicationRecord\n  has_many :taggings, dependent: :destroy\n  has_many :tags, through: :taggings\n  has_many :question_attempts, dependent: :destroy\nend\n\nclass QuestionAttempt &lt; ApplicationRecord\n  belongs_to :question\n  belongs_to :user\nend\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<pre><code># Gather topics / tags\n# This is working\nif params[:topics] != nil \n  @tags = params[:topics].split(\",\")\nend\n\n# Gather difficulties\n# This is working as expected\n# If nil, then show all difficulties\nif params[:difficulties] != nil \n  @difficulties = params[:difficulties].split(\",\")\nelse\n  flash[:notice] = 'Showing all difficulties as none selected'   \n  @difficulties = [\"Untested\", \"Easy\", \"Medium\", \"Hard\"]\nend\n\n# This is the element not yet working\n# I can gather the options Unattempted / Correct / Incorrect from the params\n# Not sure how to then join this with my question_attempts table\n@attempts = params[:attempts].split(\",\") \n\n\n# Gather questions matching the filters \nif @tags == nil\n\n  @questions = Question.joins(:question_attempts).where(difficulty: @difficulties, private: false, draft: false, approved: true).distinct\n\nelse\n\n  @questions = Question.joins(:question_attempts).joins(:tags).where(tags: { name: @tags }, difficulty: @difficulties, private: false, draft: false, approved: true).distinct\n\nend\n</code></pre>\n\n<hr>\n\n<h1>Current Solution</h1>\n\n<p>This is likely not the most efficient way of doing this, but it seems to be working thanks to tips from Tom Lord. Would welcome any constructive feedback / tips.</p>\n\n<pre><code>    def tags\n  params[:topics]&amp;.split(\",\")\nend\n\ndef difficulties\n  params[:difficulties]&amp;.split(\",\")\nend\n\n  def filter\n\n# Check for previous answers\nif params[:correct] == \"true\" &amp;&amp; params[:incorrect] != \"true\"\n  @questions = Question.where( id: QuestionAttempt.where(user_id: current_user.id).where('score = 100').pluck(:question_id) )\nelsif params[:incorrect] == \"true\" &amp;&amp; params[:correct] != \"true\"\n  @questions = Question.where( id: QuestionAttempt.where(user_id: current_user.id).where('score &lt; 100').pluck(:question_id) )\nelsif params[:incorrect] == \"true\" &amp;&amp; params[:correct] == \"true\"\n  @questions = Question.where( id: QuestionAttempt.where(user_id: current_user.id).pluck(:question_id) )\nend\n\n# Check for unanswered filters\nif params[:unattempted] == \"true\"\n\n  if @questions == nil\n\n    @questions = Question.where.not( id: QuestionAttempt.where( user_id: current_user.id ).pluck(:question_id) )\n\n  else\n\n    @questions = Question.where.not( id: QuestionAttempt.where( user_id: current_user.id ).pluck(:question_id) ).or (\n        @questions\n      )\n\n  end\n\nend\n\n\n#\u00a0Add all other filters afterwards as they should apply to all    \n\n@questions = @questions.where(difficulty: difficulties) if difficulties\n\n@questions = @questions.joins(:tags).where(tags: { name: tags }) if tags\n\n@questions = @questions.where(\n    private: false,\n    draft: false,\n    approved: true\n  )\n\n@questions.distinct\n</code></pre>\n"}, {"tags": ["ruby", "api", "noaa"], "answers": [{"tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": true, "score": 4, "last_activity_date": 1561480697, "last_edit_date": 1561480697, "creation_date": 1561471912, "answer_id": 56756040, "question_id": 56754879, "link": "https://stackoverflow.com/questions/56754879/ruby-putting-token-key-in-requests/56756040#56756040", "title": "Ruby putting token key in requests", "body": "<p>According to the <a href=\"https://www.ncdc.noaa.gov/cdo-web/webservices/v2\" rel=\"nofollow noreferrer\">API documentation</a> (based on the URL you referenced), you need to provide the token in a header named <code>token</code>.</p>\n\n<p>So, you should probably try some variation of the below (code untested):</p>\n\n<pre><code>token = 'YiwwVvywLngtPT***************'\nurl = 'https://www.ncdc.noaa.gov/cdo-web/api/v2/stations?locationid=FIPS:23&amp;limit=5&amp;sortfield=mindate'\nuri = URI(url)\nrequest = Net::HTTP::Get.new(uri)\nrequest['token'] = token\nresponse = Net::HTTP.start(uri.hostname, uri.port) do |http|\n  http.request(request)\nend\n</code></pre>\n\n<p>More information about <code>Net:HTTP</code> headers can be found in <a href=\"https://stackoverflow.com/questions/44839503/ruby-send-get-request-with-headers\">this StackOverflow answer</a>.</p>\n\n<hr>\n\n<p>As a side note, if you are not locked on using <code>Net::HTTP</code>, consider switching to a friendlier HTTP client, perhaps <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty</a>. Then, the complete code looks like this:</p>\n\n<pre><code>require 'httparty'\n\ntoken = 'YiwwVvywLngtPT***************'\nurl = 'https://www.ncdc.noaa.gov/cdo-web/api/v2/stations?locationid=FIPS:23&amp;limit=5&amp;sortfield=mindate'\nresponse = HTTParty.get url, headers: { token: token }\n\nputs response.body\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 11604669, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nUn6Vjvj8mc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reG6n_9NfbomnKqJwn0m_cvFSDoeQ/mo/photo.jpg?sz=128", "display_name": "Gerold Astor", "link": "https://stackoverflow.com/users/11604669/gerold-astor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56756040, "answer_count": 1, "score": 0, "last_activity_date": 1561480697, "creation_date": 1561468189, "question_id": 56754879, "link": "https://stackoverflow.com/questions/56754879/ruby-putting-token-key-in-requests", "title": "Ruby putting token key in requests", "body": "<p>I dont know how to put my key into my requests so they are sent back as</p>\n\n<pre><code>{\"status\"=&gt;\"400\", \"message\"=&gt;\"Token parameter is required.\"}\n</code></pre>\n\n<p>This is the code I have been using</p>\n\n<pre><code>require 'net/http'\nrequire 'json'\n\ntoken = 'YiwwVvywLngtPT***************'\nurl = 'https://www.ncdc.noaa.gov/cdo-web/api/v2/stations?locationid=FIPS:23&amp;limit=5&amp;sortfield=mindate'\nuri = URI(url)\nresponse = Net::HTTP.get(uri)\nresponse.authorization = token\nputs JSON.parse(response)\n</code></pre>\n\n<p>I have tried a couple different things I've found on the internet but all of them just give errors for </p>\n\n<pre><code>undefined method `methodname' for #&lt;String:0x00007fd97519abd0&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "vue.js", "google-authentication"], "comments": [{"owner": {"reputation": 5966, "user_id": 2477691, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DaiPF.jpg?s=128&g=1", "display_name": "chumakoff", "link": "https://stackoverflow.com/users/2477691/chumakoff"}, "edited": false, "score": 0, "creation_date": 1561469979, "post_id": 56754870, "comment_id": 100068480, "body": "<code>jwt_sessions</code> also supports memory stores, not only redis"}], "owner": {"reputation": 11, "user_id": 11697790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c46bd09efd935aee0ce91c61c0469b?s=128&d=identicon&r=PG&f=1", "display_name": "notorious_dev", "link": "https://stackoverflow.com/users/11697790/notorious-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1561468168, "creation_date": 1561468168, "question_id": 56754870, "link": "https://stackoverflow.com/questions/56754870/google-spa-oauth-jwt-rails", "title": "Google SPA oauth + JWT + Rails", "body": "<p>I have Rails 5 app. As for the frontend we use Vue js. So it is closed app for only authorised google users. How it works now:</p>\n\n<p>Vue calls Google and authenticates user, after that it send the payload to rails server. I use google-oauth gem, so I can see token, expiration date, id_token as well as refresh_token for the first time. I check against my database if we do have same user by it's email as google provided. And if yes I create a JWT token that I send back to frontend with expiration date for 1 day. The token is saved in cookies.</p>\n\n<p>Every time API call is made to backend the jwt token is provided and I check again against user if it still exist on my database. </p>\n\n<p>The problem is that is not a good UX for users to log in everyday again and again. I would like to refresh user, but I do not save any tokens from google in my db. Should I use that?</p>\n\n<p>Do I need to do additional calls to google from server side maybe?</p>\n\n<p>Did anyone implemented anything on their projects like this? How does sign in authentication works with google and do I need to do calls to google everytime?</p>\n\n<p>I don't have Redis on my server as it is not possible to get it installed, so I can't use jwt sessions gem.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "associations", "single-table-inheritance"], "comments": [{"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1561468145, "post_id": 56754556, "comment_id": 100067262, "body": "In my own limited experience with single table inheritance, the relationships still need to be defined on the model being inheited from. It&#39;s the methods you define, ie scope, enums, instance method that you can change on each model. But the relationships need to be on the model that has a table in the db.  I may be wrong but that&#39;s what I had to do when I started playing with single table inheritance"}, {"owner": {"reputation": 45, "user_id": 11037755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb95565b91ec15fb7e0d34ab18ff590?s=128&d=identicon&r=PG&f=1", "display_name": "Sam J", "link": "https://stackoverflow.com/users/11037755/sam-j"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1561469027, "post_id": 56754556, "comment_id": 100067853, "body": "I will give this a try. Would love to hear any advice others might have."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1561470140, "post_id": 56754556, "comment_id": 100068577, "body": "Same ^, my experience is literally from one attempt. I just threw stuff at the wall and saw what stuck while tracing the errors, lol"}, {"owner": {"reputation": 45, "user_id": 11037755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb95565b91ec15fb7e0d34ab18ff590?s=128&d=identicon&r=PG&f=1", "display_name": "Sam J", "link": "https://stackoverflow.com/users/11037755/sam-j"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 2, "creation_date": 1561470673, "post_id": 56754556, "comment_id": 100068936, "body": "I&#39;ve solved it. There was a method contained within a concern with the same name as the association. That method was getting called. Oops!  So it turns out you can define the associations on the child model after all"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1561471203, "post_id": 56754556, "comment_id": 100069298, "body": "Oh nice! Congratz! And thanks for letting me know. Will definitely help in refactoring for me in the future :D"}], "owner": {"reputation": 45, "user_id": 11037755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb95565b91ec15fb7e0d34ab18ff590?s=128&d=identicon&r=PG&f=1", "display_name": "Sam J", "link": "https://stackoverflow.com/users/11037755/sam-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561467188, "creation_date": 1561467188, "question_id": 56754556, "link": "https://stackoverflow.com/questions/56754556/rails-many-to-many-association-with-single-table-inheritance", "title": "Rails many-to-many association with single table inheritance", "body": "<p>This problem involves a rails ActiveRecord many-to-many association and a case of single-table-inheritance. I am struggling to get the association <code>Patient</code> -> <code>Membership</code> to work. All other associations work as expected.</p>\n\n<p>Note that <code>Member</code> (below) contains foreign key fields for <code>membership_id</code> and <code>patient_id</code>.</p>\n\n<p>So far I have experimented with various combinations of options for the associations but haven't managed to find the correct setup to make the association work</p>\n\n<pre><code>class LineItem &lt; ApplicationRecord\nend\n\nclass Membership &lt; LineItem\n  has_many :members, dependent: :destroy, foreign_key: :line_item_id, inverse_of: :membership\n  has_many :patients, through: :members\nend\n\nclass Member &lt; ApplicationRecord\n  belongs_to :membership, foreign_key: :line_item_id, inverse_of: :members\n  belongs_to :patient, optional: true\nend\n\nclass Patient &lt; ApplicationRecord\n  has_many :members\n  has_many :memberships, through: :members\nend\n</code></pre>\n\n<p>Let <code>patient_1</code> be an instance of <code>Patient</code>.\nLet <code>membership_1</code> be an instance of <code>Membership</code>.\nLet them be associated through <code>member_1</code>, an instance of <code>Member</code>.</p>\n\n<p>I would expect <code>patient_1.memberships</code> to return <code>membership_1</code> (contained within ActiveRecord Relation).</p>\n\n<p>Instead I am getting the following error:\n<code>ActiveRecord::StatementInvalid: PG::UndefinedColumn: ERROR:  column line_items.member_id does not exist</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "assets", "sprockets"], "comments": [{"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 2, "creation_date": 1561465951, "post_id": 56754044, "comment_id": 100065745, "body": "Assets compilation should only be used for static images used in your app (icons, backgrounds...), not for the actual data your site uses. This is especially true if it is  a dynamic and large collection of images."}, {"owner": {"reputation": 471, "user_id": 4524405, "user_type": "registered", "accept_rate": 9, "profile_image": "https://lh5.googleusercontent.com/-fjErJCkTgpE/AAAAAAAAAAI/AAAAAAAAEA0/Yuvi6mOQONs/photo.jpg?sz=128", "display_name": "Gregory Frerot", "link": "https://stackoverflow.com/users/4524405/gregory-frerot"}, "reply_to_user": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1561467401, "post_id": 56754044, "comment_id": 100066734, "body": "Oh ! I don&#39;t know that... Currently I use image_tag() to link my image. How to link my image without used assets compilation ?"}], "answers": [{"tags": [], "owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "is_accepted": false, "score": 1, "last_activity_date": 1561468195, "creation_date": 1561468195, "answer_id": 56754881, "question_id": 56754044, "link": "https://stackoverflow.com/questions/56754044/execute-assetsprecompile-by-code-client/56754881#56754881", "title": "Execute &quot;assets:precompile&quot; by code/client", "body": "<p>Asset compilation should only be used for static images used in your app (icons, backgrounds...), not for the actual data your site uses.</p>\n\n<p>This is especially true if it is a dynamic and large collection of images.</p>\n\n<hr>\n\n<p>This isn't really a programming problem anymore, it's more of a general software engineering problem, but here are my two cents anyways.</p>\n\n<p>I'd suggest you use a CDN to make the photos available to browsers. Your Rails app should store (or build) the URLs to the CDN, so that the client browser can fetch and display them.</p>\n\n<p>For instance, set up a HTTP server such as Nginx on the same machine that hosts the FTP server, then build a consistent URL schema so that your FTP files can be served through HTTP, without copy.</p>\n\n<p>New files added to the server via FTP are automatically available through HTTP, and maybe a cron job or an asynchronous worker can check for new files and register them to your Rails app.</p>\n\n<p>Of course, that's just an example of what can be done. There are tons of other solutions, but without further details, it's hard to tell.</p>\n"}], "owner": {"reputation": 471, "user_id": 4524405, "user_type": "registered", "accept_rate": 9, "profile_image": "https://lh5.googleusercontent.com/-fjErJCkTgpE/AAAAAAAAAAI/AAAAAAAAEA0/Yuvi6mOQONs/photo.jpg?sz=128", "display_name": "Gregory Frerot", "link": "https://stackoverflow.com/users/4524405/gregory-frerot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561468195, "creation_date": 1561465595, "question_id": 56754044, "link": "https://stackoverflow.com/questions/56754044/execute-assetsprecompile-by-code-client", "title": "Execute &quot;assets:precompile&quot; by code/client", "body": "<p>I have a site that has a lot of images (+ 10k) with several hundreds displayed by pages, so I use the principle of ruby on rails assets to compile these images. The problem is that my client has the possibility to change these images via an FTP and it forces me to connect each time in ssh to the server to launch the command \"assets: precompile\". Would there be a way to create a link button my client will click to launch the command from the code.</p>\n\n<p>I tried to create a cron job with the Whenever gem (<a href=\"https://github.com/javan/whenever\" rel=\"nofollow noreferrer\">https://github.com/javan/whenever</a>) that runs the \"assets: precompile\" command every hour but it does not work.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>every :hour do\n  rake \"assets:precompile\"\nend\n</code></pre>\n\n<p>I tried to create this method linked to a link but without success also</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def compile_image\n  system('rvm use 2.2.0@project &amp;&amp; cd /var/www/project-folder/ &amp;&amp; rake assets:precompile')\n  redirect_to imports_index_path, notice: 'Images compiled'\nend\n</code></pre>\n\n<p>I'm on ruby 2.2 and rails 4.2.</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["ruby", "docusignapi"], "answers": [{"tags": [], "owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "is_accepted": false, "score": 0, "last_activity_date": 1562602812, "creation_date": 1562602812, "answer_id": 56938957, "question_id": 56753822, "link": "https://stackoverflow.com/questions/56753822/docusign-api-with-ruby-is-there-a-way-to-download-a-document-with-all-the-tab-c/56938957#56938957", "title": "Docusign APi with RUby: IS there a way to download a document with all the tab content populated", "body": "<p>The pdf would have the data inside the document as part of the completed doc (assuming it's visible). If you want to get the data downloaded separately, you would need to use API calls to get the envelope and get the tabs information. see this <a href=\"https://developers.docusign.com/esign-rest-api/guides/features/tabs\" rel=\"nofollow noreferrer\">https://developers.docusign.com/esign-rest-api/guides/features/tabs</a></p>\n"}], "owner": {"reputation": 31, "user_id": 1369322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9faf0acb74ee56dbb01302704f8fa325?s=128&d=identicon&r=PG", "display_name": "prabu", "link": "https://stackoverflow.com/users/1369322/prabu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562602812, "creation_date": 1561464894, "question_id": 56753822, "link": "https://stackoverflow.com/questions/56753822/docusign-api-with-ruby-is-there-a-way-to-download-a-document-with-all-the-tab-c", "title": "Docusign APi with RUby: IS there a way to download a document with all the tab content populated", "body": "<p>I need to download an envelope from docusign by populating the tab data in ruby on rails. </p>\n\n<p>I have used get_combined_document_from_envelope but it does not seems to get all the data.</p>\n\n<pre><code>  def method_name \n      output_pdf = docusign.get_combined_document_from_envelope(\n         envelope_id: document.external_key,\n         local_save_path: \"docusign_docs/file_name.pdf\",\n         return_stream: false\n       )\n  end\n</code></pre>\n\n<p>I need the output file to have all the tabs populated.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "select", "haml"], "comments": [{"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1561465611, "post_id": 56753348, "comment_id": 100065520, "body": "<code>url = &quot;&#47;progress_boards&#47;new&quot;</code> working???"}, {"owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "reply_to_user": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1561468836, "post_id": 56753348, "comment_id": 100067709, "body": "Yes, it is working fine"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561474547, "post_id": 56753348, "comment_id": 100071346, "body": "Are there errors in your server console?"}, {"owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561478195, "post_id": 56753348, "comment_id": 100073390, "body": "Yes, here it is @jvillian : Started GET &quot;/progress_boards/7/pbbackground&quot; for 127.0.0.1 at 2019-06-25 16:54:21 +0100 ActionController::RoutingError (No route matches [GET] &quot;/progress_boards/7/pbbackground&quot;):"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561478939, "post_id": 56753348, "comment_id": 100073740, "body": "So, you have a routing error. Please add your <code>routes.rb</code> to your question."}, {"owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561480629, "post_id": 56753348, "comment_id": 100074538, "body": "@jvillian Alright, this is done"}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "edited": false, "score": 0, "creation_date": 1561484383, "post_id": 56758571, "comment_id": 100076194, "body": "Sure thing. Feel free to upvote and/or accept for future searchers."}, {"owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "edited": false, "score": 0, "creation_date": 1561545187, "post_id": 56758571, "comment_id": 100096954, "body": "That&#39;s what I did but as a new member my vote is taken in account but not displayed"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1561481479, "last_edit_date": 1561481479, "creation_date": 1561480868, "answer_id": 56758571, "question_id": 56753348, "link": "https://stackoverflow.com/questions/56753348/how-to-fix-404-error-while-loading-a-pop-via-ajax/56758571#56758571", "title": "How to fix : 404 error while loading a pop via Ajax?", "body": "<p>The error is telling you exactly what is wrong: </p>\n\n<pre><code>ActionController::RoutingError (No route matches [GET] \"/progress_boards/7/pbbackground\")\n</code></pre>\n\n<p>And, as you can see, you don't have a <code>pbbackground</code> route:</p>\n\n<pre><code>resources :progress_boards do\n  collection do\n    get :get_progress_data\n    get :get_panel_data\n    get :render_tab\n  end\n  member do\n    get :open_or_archive\n  end\nend\n</code></pre>\n\n<p>Assuming you have a <code>pbbackground</code> action on your <code>ProgressBoardsController</code>, then do: </p>\n\n<pre><code>resources :progress_boards do\n  collection do\n    get :get_progress_data\n    get :get_panel_data\n    get :render_tab\n  end\n  member do\n    get :open_or_archive\n    get :pbbackground\n  end\nend\n</code></pre>\n\n<p>BTW and FWIW: Rails errors are not always <em>perfectly</em> helpful. But, they are often <em>very</em> helpful. In this case, you were getting a <code>RoutingError (No route matches)</code> error. Which almost certainly points to your <code>routes.rb</code>. This had nothing to do with your javascript or button code. In which case, showing your javascript and button code was not relevant. </p>\n"}], "owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581308578, "creation_date": 1561463196, "last_edit_date": 1581308578, "question_id": 56753348, "link": "https://stackoverflow.com/questions/56753348/how-to-fix-404-error-while-loading-a-pop-via-ajax", "title": "How to fix : 404 error while loading a pop via Ajax?", "body": "<p>I'm quite new to RoR so I should miss something\nI'm stuck with trying to load a popup via Ajax while clicking a button\nEvery time I try to reach it I got the error of the Ajax method you can see below</p>\n\n<ul>\n<li>I believe my synthax is right</li>\n<li>I obviously created a 'pbbackground' file</li>\n<li>I also referred to that line in my button on click action</li>\n<li>I tried to load a popup with the content of an already functional popup but it doesn't work</li>\n<li>The pop-up is loading but not displaying and I'm getting the ajax error message => I guess my \"sucess\" part is the issue but I can't find out why</li>\n<li>I used \"debugger;\" to spot if it tries going into the 'success' part of the JS but it seems it doesn't</li>\n<li>While checking my browser console I saw that the error is a 404</li>\n</ul>\n\n<p>My JS method :</p>\n\n<pre><code>  function loadProgressForm(resource, id){\n    $(\".form_loader\").show();\n    if(resource == \"new\"){\n      url = \"/progress_boards/new\";\n      popup_name = \"Make A Progress Board\";\n    } else if (resource == \"edit\"){\n      url = \"/progress_boards/\" + id + \"/edit\";\n      popup_name = \"Add/Remove Metrics\";\n    } else if (resource == \"pbbackground\"){\n      url = \"/progress_boards/\" + id + \"/pbbackground\";\n      popup_name = \"Add A Picture\";\n    }\n    $.ajax({\n      url: url,\n      success: function(response, data){\n        $(\"#progress_board_form\").html(response.html);\n        $(\"#progress_board_form\").find('.modal-title').text(popup_name);\n        $(\".form_loader\").hide();\n      },\n      error: function(response, data){\n        alert(\"Error loading project form\")\n        $(\".form_loader\").hide();\n      }\n    })\n  }\n</code></pre>\n\n<p>Button code :</p>\n\n<pre><code>    %li= link_to 'Add Background', 'javascript:void(0)', onclick:\"$('#create_edit_progress_board_model').appendTo('body').modal('show'); loadProgressForm('pbbackground', #{@progress_board.id});\"\n</code></pre>\n\n<p>Also, here is the part corresponding to my folder in my <code>route.rb</code> file :</p>\n\n<pre><code>resources :progress_boards do\n    collection do\n      get :get_progress_data\n      get :get_panel_data\n      get :render_tab\n    end\n    member do\n      get :open_or_archive\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 5, "creation_date": 1561461970, "post_id": 56752948, "comment_id": 100063466, "body": "Something along the lines of <code>cheapest_rate = rates.min_by { |rate| rate[&#39;shipmentCost&#39;] }</code> ?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561462496, "post_id": 56752948, "comment_id": 100063759, "body": "Wow you&#39;er a beast.  I did: <code>@cheapest_rate = @rates.min_by { |rate| rate[&#39;shipmentCost&#39;] }     @cheapest_rate_number = @cheapest_rate[&quot;shipmentCost&quot;]</code> to get the number alone but both rate will come in handy also to be used."}], "answers": [{"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 2, "last_activity_date": 1561463432, "creation_date": 1561463432, "answer_id": 56753417, "question_id": 56752948, "link": "https://stackoverflow.com/questions/56752948/getting-the-each-loop-result-with-the-lowest-number-from-json/56753417#56753417", "title": "Getting the .each loop result with the lowest number from json", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-min_by\" rel=\"nofollow noreferrer\">Enumerable#min_by</a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>cheapest = @shipping_rates.min_by{|rate| rate['shipmentCost'] }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1563894211, "post_id": 56757231, "comment_id": 100847855, "body": "Did this help at all @uno?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1563894199, "last_edit_date": 1563894199, "creation_date": 1561475750, "answer_id": 56757231, "question_id": 56752948, "link": "https://stackoverflow.com/questions/56752948/getting-the-each-loop-result-with-the-lowest-number-from-json/56757231#56757231", "title": "Getting the .each loop result with the lowest number from json", "body": "<p>Going to add a little to this: if there's a chance a JSON hash contains a <code>nil</code> value or the key isn't found, @Vasfed's (very good) answer will raise an <code>ArgumentError</code>.</p>\n\n<pre><code>[1, nil].min_by(&amp;:itself)\n# =&gt; ArgumentError: comparison of NilClass with 1 failed\n</code></pre>\n\n<p>Therefore, I'd use:</p>\n\n<pre><code>@shipping_rates.min_by { |rate| rate['shipmentCost'] || Float::INFINITY }\n# or\n@shipping_rates.compact.min_by { |rate| rate['shipmentCost'] }\n\n#\u00a0e.g.\n[1, nil].min_by { |x| x || Float::INFINITY }\n# =&gt; 1\n[1, nil].compact.min_by(&amp;:itself)\n# =&gt; 1\n</code></pre>\n\n<p>That way you'll avoid any such errors.</p>\n\n<p>There's one caveat with using <code>Float::INFINITY</code> here: if you don't have any <code>shipmentCost</code>s available, you'll be left rendering infinity. Therefore, you would want to wrap this in an equality check to avoid this:</p>\n\n<pre><code>&lt;% cheapest = @shipping_rates.min_by { |rate| rate['shipmentCost'] || Float::INFINITY }[\"shipmentCost\"] %&gt;\n&lt;%= cheapest unless cheapest == Float::INFINITY %&gt;\n</code></pre>\n\n<p>That leaves me thinking the option with compact is the way to go :) Hope this helps:</p>\n\n<pre><code>&lt;%= @shipping_rates.compact.min_by { |rate| rate['shipmentCost'] %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563894199, "creation_date": 1561461761, "last_edit_date": 1561463058, "question_id": 56752948, "link": "https://stackoverflow.com/questions/56752948/getting-the-each-loop-result-with-the-lowest-number-from-json", "title": "Getting the .each loop result with the lowest number from json", "body": "<p>I have an API response from a shipping API that I would like to automatically choose the lowest shipping rate by default.</p>\n\n<p>Here is the json:</p>\n\n<pre><code>[\n  {\"serviceName\"=&gt;\"USPS First Class Mail - Letter\", \"serviceCode\"=&gt;\"usps_first_class_mail\", \"shipmentCost\"=&gt;0.8, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS First Class Mail - Large Envelope or Flat\", \"serviceCode\"=&gt;\"usps_first_class_mail\", \"shipmentCost\"=&gt;1.3, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS First Class Mail - Package\", \"serviceCode\"=&gt;\"usps_first_class_mail\", \"shipmentCost\"=&gt;2.84, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Package\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;7.82, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Medium Flat Rate Box\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;12.8, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Small Flat Rate Box\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;7.5, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Large Flat Rate Box\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;17.6, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Flat Rate Envelope\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;6.95, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Flat Rate Padded Envelope\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;7.55, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Regional Rate Box A\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;9.95, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Regional Rate Box B\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;16.1, \"otherCost\"=&gt;0.0},\n  {\"serviceName\"=&gt;\"USPS Priority Mail - Legal Flat Rate Envelope\", \"serviceCode\"=&gt;\"usps_priority_mail\", \"shipmentCost\"=&gt;7.25, \"otherCost\"=&gt;0.0}\n] \n</code></pre>\n\n<p>I would then like to define the lowest priced one to then pass to the payment processor.</p>\n\n<p>I tried using  <code>&lt;%= rate[\"shipmentCost\"].min %&gt;</code> but got <code>undefined method</code>min' for 0.8:Float`... Which 0.8 is the lowest option, from the json response.</p>\n\n<p>How can I have the each loop, or a loop in general, spot the lowest `rate[\"shipmentCost\"], and then define that so I can use it to add to the price of the goods.</p>\n\n<p>for instance, I would like to do something like:</p>\n\n<p><code>rate_to_use = rate[\"shipmentCost\"].min</code>\nand then use \"price + rate_to_use = total\" for processing the payment.  Then later for shipping a label will be created using the same lowest rate or match it.</p>\n"}, {"tags": ["ruby", "connection-pool"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561463054, "post_id": 56752091, "comment_id": 100064075, "body": "As always, <code>Wrapper</code> can be used to wrap an existing pool, <code>ConnectionPool</code> provides it\u2019s own implementation."}, {"owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561469943, "post_id": 56752091, "comment_id": 100068453, "body": "Pardon me for my poor understanding, But what do you mean to wrap an existing pool ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561472756, "post_id": 56752091, "comment_id": 100070278, "body": "To wrap e. g. <code>redis</code> pool, provided by <code>redis</code>."}, {"owner": {"reputation": 773, "user_id": 537025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfc49166318a6c56ad40ecb53189888?s=128&d=identicon&r=PG", "display_name": "courtsimas", "link": "https://stackoverflow.com/users/537025/courtsimas"}, "edited": false, "score": 0, "creation_date": 1588952656, "post_id": 56752091, "comment_id": 109107081, "body": "Reading through this thread will help explain the purpose of the wrapper <a href=\"https://github.com/mperham/connection_pool/issues/105\" rel=\"nofollow noreferrer\">github.com/mperham/connection_pool/issues/105</a>"}], "owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561458916, "creation_date": 1561458916, "question_id": 56752091, "link": "https://stackoverflow.com/questions/56752091/ruby-mperham-connection-pool-difference-between-connectionpool-and-connectionpoo", "title": "Ruby mperham/connection_pool difference between ConnectionPool and ConnectionPool::Wrapper", "body": "<p>in following <a href=\"https://github.com/mperham/connection_pool\" rel=\"nofollow noreferrer\">https://github.com/mperham/connection_pool</a>, Can anybody guide me what is the difference between ConnectionPool and ConnectionPool::Wrapper ? Under what circumstances one should use ConnectionPool::Wrapper ? Pros/cons of each method if they are similar ? I am finding it hard to understand by reading documentations <a href=\"https://github.com/mperham/connection_pool\" rel=\"nofollow noreferrer\">https://github.com/mperham/connection_pool</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1561458615, "post_id": 56751958, "comment_id": 100061529, "body": "No special meaning. Exclamation mark is part of the method name. Look up method&#39;s documentation to find out what it does."}, {"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "edited": false, "score": 1, "creation_date": 1561458860, "post_id": 56751958, "comment_id": 100061646, "body": "In Active Record, <code>lock</code> and <code>lock!</code> are not the same. The former exists on relations, the latter on records."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561787988, "post_id": 56751958, "comment_id": 100184430, "body": "&quot;I tried to find on internet, but I could find a good explanation&quot; \u2013 It would be helpful if you could explain what <i>exactly</i> is missing in the documentation. That way, the Rails developers can improve the documentation so that future developers don&#39;t stumble across the same problems as you did. You would basically make the world a better place, and who wouldn&#39;t want that?"}], "answers": [{"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 0, "last_activity_date": 1561491474, "creation_date": 1561491474, "answer_id": 56760936, "question_id": 56751958, "link": "https://stackoverflow.com/questions/56751958/the-meaning-of-lock-ending-with-exclamation-mark/56760936#56760936", "title": "The meaning of lock ending with exclamation mark", "body": "<p>Go to the <a href=\"https://rubyonrails.org/\" rel=\"nofollow noreferrer\">Ruby on Rails</a> site. Click on the \"<a href=\"https://api.rubyonrails.org/\" rel=\"nofollow noreferrer\">API</a>\" link at the top. Type \"lock!\" into the search field. Click on <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html#method-i-lock-21\" rel=\"nofollow noreferrer\">the first result</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JL2Er.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JL2Er.gif\" alt=\"ActiveRecord::Locking::Pessimistic#lock!\"></a></p>\n\n<blockquote>\n  <h3>lock!(lock = true)</h3>\n  \n  <p>Obtain a row lock on this record. Reloads the record to obtain the requested lock. Pass an SQL locking clause to\n  append the end of the SELECT statement or pass true for \u201cFOR UPDATE\u201d\n  (the default, an exclusive row lock). Returns the locked record.</p>\n</blockquote>\n\n<p>If you're unclear on what a row lock is, the <a href=\"https://docs.oracle.com/cd/B19306_01/server.102/b14220/consist.htm\" rel=\"nofollow noreferrer\">first half of this article</a> is a good place to start. The TL;DR is that a row lock prevents some other database user (which might be another connection from the same app) from modifying the row you're modifying or about to modify.</p>\n"}], "owner": {"reputation": 35461, "user_id": 959734, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/44608a8e81f8ca8ee21619d07df32b92?s=128&d=identicon&r=PG", "display_name": "Leem.fin", "link": "https://stackoverflow.com/users/959734/leem-fin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561491474, "creation_date": 1561458516, "question_id": 56751958, "link": "https://stackoverflow.com/questions/56751958/the-meaning-of-lock-ending-with-exclamation-mark", "title": "The meaning of lock ending with exclamation mark", "body": "<p>I tried to find on internet, but I could find a good explanation. What does lock ending with exclamation mark mean in ruby? e.g. <code>@student.lock!</code> (BTW, I know what <code>lock</code> means in concurrency)</p>\n"}, {"tags": ["ruby", "grammar", "parslet"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561454783, "post_id": 56749529, "comment_id": 100059367, "body": "There is zero chance somebody will get through this wall of code; could you please provide MCVE to recognize and reproduce the issue on our side?"}, {"owner": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "edited": false, "score": 0, "creation_date": 1561456700, "post_id": 56749529, "comment_id": 100060439, "body": "GobbleUp not defined."}, {"owner": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "edited": false, "score": 0, "creation_date": 1561457132, "post_id": 56749529, "comment_id": 100060679, "body": "I&#39;ll assume the GobbleUp rule can be replaced with &quot; rule(:quoted_val) {quote &gt;&gt; (quote.absnt? &gt;&gt; any).repeat(0) &gt;&gt; quote}&quot;"}, {"owner": {"reputation": 83, "user_id": 1028640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41376ed185323c2e1224b868972a1f3e?s=128&d=identicon&r=PG", "display_name": "Mateusz Fryc", "link": "https://stackoverflow.com/users/1028640/mateusz-fryc"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561457942, "post_id": 56749529, "comment_id": 100061152, "body": "@AlekseiMatiushkin I believe this is MCVE. If someone knows the concept of parslet, then it is clear to him that what I included is Parser - first stage, and Transformation - second stage rules. Parsing works properly, but I had to attach it, as without it Transformations code would be incomprehensible."}, {"owner": {"reputation": 83, "user_id": 1028640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41376ed185323c2e1224b868972a1f3e?s=128&d=identicon&r=PG", "display_name": "Mateusz Fryc", "link": "https://stackoverflow.com/users/1028640/mateusz-fryc"}, "reply_to_user": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "edited": false, "score": 1, "creation_date": 1561458047, "post_id": 56749529, "comment_id": 100061216, "body": "@NigelThorne - yeap GobbleUp works as you expect, this is strange it is not included in parslet gem, I can see it in github in accelerator section, but indeed it is not present in downloaded gem. I will change it to slower counterpart."}, {"owner": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "edited": false, "score": 0, "creation_date": 1561459579, "post_id": 56749529, "comment_id": 100062086, "body": "I can make the example pass, but I don&#39;t know what else it should pass"}, {"owner": {"reputation": 83, "user_id": 1028640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41376ed185323c2e1224b868972a1f3e?s=128&d=identicon&r=PG", "display_name": "Mateusz Fryc", "link": "https://stackoverflow.com/users/1028640/mateusz-fryc"}, "edited": false, "score": 0, "creation_date": 1561459918, "post_id": 56749529, "comment_id": 100062297, "body": "Well, basically this is JSON-like structure. What differs is the fact, that values/keys don&#39;t have to be quoted. They are quoted only if needed e.g they contain special char (&quot;:,.[]{}) or it is also possible to have &quot;3&quot; quoted just to indicate it is string, but AFAIC this is handled properly by parser. Only transformation was not really working in some cases, like the one presented. Some sample of representative input would be {key:[],key1:[[[1],[]]], key2:{key1:1,key2:&quot;1&quot;}, key3:&quot;dog,{:ca]t,&quot;,key3:{}}. Expected output is a structured data created with OpenStruct and Array structures."}, {"owner": {"reputation": 19268, "user_id": 23963, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9a5280831aec1b4b614eb1e5bf40baf?s=128&d=identicon&r=PG", "display_name": "Nigel Thorne", "link": "https://stackoverflow.com/users/23963/nigel-thorne"}, "edited": false, "score": 0, "creation_date": 1579068207, "post_id": 56749529, "comment_id": 105639111, "body": "@MateuszFryc if GobbleUp is faster..that&#39;s interesting. That means code could scan your parser ... look for the slower version and replace it with the faster version and your parser would go faster... This reminds me of regex optimisation... damn another todo for my backlog."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 1028640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41376ed185323c2e1224b868972a1f3e?s=128&d=identicon&r=PG", "display_name": "Mateusz Fryc", "link": "https://stackoverflow.com/users/1028640/mateusz-fryc"}, "is_accepted": false, "score": 1, "last_activity_date": 1561477427, "last_edit_date": 1561477427, "creation_date": 1561475181, "answer_id": 56757060, "question_id": 56749529, "link": "https://stackoverflow.com/questions/56749529/how-to-transform-nested-arrays-string-in-json-like-string-to-structured-object-u/56757060#56757060", "title": "How to transform nested arrays string in json like string to structured object using parslet", "body": "<p>Thanks everyone for sharing especially, @NigelThorne whose answer in other thread lead me to actual solution of this problem. I Introduced some additional classes like Map/Value/Arr so I am able to recognize whether particular array is created by Transform framework, or it is a result of list matching.</p>\n\n<p>Below is a working code and some tests for future reference.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'parslet'\nrequire 'parslet/convenience'\nrequire 'ostruct'\n\n\nmodule JSONLikeDataModule\n  module Parsing\n\n    class GobbleUp &lt; Parslet::Atoms::Base\n      def initialize absent, min_chars = 0\n        @absent = absent\n        @min_chars = min_chars\n      end\n\n      def try(source, context, consume_all)\n        excluding_length = source.chars_until(@absent)\n\n        if excluding_length &gt;= @min_chars\n          return succ(source.consume(excluding_length))\n        else\n          return context.err(self, source, \"No such string in input: #{@absent.inspect}.\")\n        end\n      end\n\n      def to_s_inner(prec)\n        \"until('#{@absent}')\"\n      end\n    end\n\n    class JSONLikeDataParser &lt; Parslet::Parser\n      rule(:l_map_paren) {str('{')}\n      rule(:r_map_paren) {str('}')}\n      rule(:l_list_paren) {str('[')}\n      rule(:r_list_paren) {str(']')}\n      rule(:map_entry_delimiter) {str(':')}\n      rule(:val_delimiter) {str(',')}\n      rule(:quote) {str('\"')}\n\n      rule(:simple_val) {match('[^\",:\\.\\{\\}\\[\\]]').repeat(1)}\n      rule(:quoted_val) {quote &gt;&gt; GobbleUp.new('\"').as(:value) &gt;&gt; quote}\n\n\n      rule(:map) {l_map_paren &gt;&gt; map_entries.maybe.as(:map) &gt;&gt; r_map_paren}\n      rule(:map_entries) {map_entry &gt;&gt; (val_delimiter &gt;&gt; map_entry).repeat}\n      rule(:map_entry) {map_key &gt;&gt; map_entry_delimiter &gt;&gt; object}\n      rule(:map_key) {(match('[A-Za-z_]').repeat(1) &gt;&gt; match('[A-Za-z0-9_]').repeat).as(:key)}\n\n      rule(:list) {l_list_paren &gt;&gt; list_values.maybe.as(:list) &gt;&gt; r_list_paren}\n      rule(:list_values) {object &gt;&gt; (val_delimiter &gt;&gt; object).repeat}\n\n      rule(:object) {map.as(:value) | simple_val.as(:value) | quoted_val | list.as(:value)}\n\n      root(:object)\n    end\n\n    class JSONLikeDataTransform &lt; Parslet::Transform\n      rule(key: simple(:key), value: simple(:value)) {{builder.value(key) =&gt; builder.value(value)}}\n\n      rule(map: subtree(:s)) do\n        ret = {}\n        next builder.map(ret) unless s\n\n        to_transform = s\n        if to_transform.is_a?(Hash)\n          to_transform = [to_transform]\n        end\n\n        to_transform.each do |h|\n          ret.merge!(h)\n        end\n        builder.map(ret)\n      end\n\n      rule(list: simple(:list)) {builder.list(list)}\n      rule(list: sequence(:list)) {builder.list(list)}\n      rule(list: subtree(:list)) {builder.list(list)}\n\n      rule(value: simple(:value)) {builder.value(value)}\n      rule(value: sequence(:value)) {value.map {|val| builder.value(val)}}\n      rule(value: subtree(:value)) {builder.value(value)}\n\n    end\n\n\n\n    class Builder\n      def map(h)\n        Map.new(h)\n      end\n\n      def list(l)\n        Arr.new(l)\n      end\n\n      def value(v)\n        Value.new(v)\n      end\n\n      class Arr\n        def initialize(val)\n          @val = val\n        end\n\n        def val\n          return [] unless @val\n          return @val.map(&amp;:val) if @val.is_a?(Array)\n          return [@val.val]\n        end\n      end\n\n      class Map\n        def initialize(val)\n          @val = val\n        end\n\n        def val\n          return OpenStruct.new unless @val\n          @val.inject(OpenStruct.new) do |ostruct, (k,v)|\n            ostruct[k.val] = v.val\n            ostruct\n          end\n        end\n      end\n\n      class Value\n        def initialize(val)\n          @val = val\n        end\n\n        def val\n          @val.respond_to?(:str) ? @val.str : @val.val\n        end\n      end\n    end\n  end\nend\n\nmodule JSONLikeDataModule\n  class JSONLikeDataFactory\n    @@flag_data_parser ||= Parsing::JSONLikeDataParser.new\n    @@flag_data_transform ||= Parsing::JSONLikeDataTransform.new\n\n    class &lt;&lt; self\n      private :new\n\n      def create(flag_data_str)\n        parsed_tree = @@flag_data_parser.parse_with_debug(flag_data_str)\n        ret = @@flag_data_transform.apply(parsed_tree, :builder =&gt; Parsing::Builder.new)\n        ret.val\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Tests</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'minitest/autorun'\nclass JSONLikeFactoryTest &lt; Minitest::Test\n  include JSONLikeDataModule\n  describe \"JSONLikeDataFactory\" do\n\n    subject do\n      JSONLikeDataFactory\n    end\n\n    it \"should create string val\" do\n      subject.create('_S').must_equal \"_S\"\n    end\n\n    it \"should create empty array\" do\n      subject.create('[]').must_equal []\n    end\n\n    it \"should create empty nested array\" do\n      subject.create('[[[]]]').must_equal [[[]]]\n    end\n\n    it \"should create not empty nested array\" do\n      subject.create('[[[1],[2,3]]]').must_equal [[['1'],['2','3']]]\n    end\n\n    it \"should create empty OpenStruct\" do\n      subject.create('{}').must_equal OpenStruct.new\n    end\n\n    it \"should create filled 1level OpenStruct\" do\n      subject.create('{key1:val,key2:\"val\"}').must_equal OpenStruct.new(key1: \"val\", key2: \"val\")\n    end\n\n    it \"should create filled 2levels OpenStruct\" do\n      subject.create('{key1:val,key2:\"val\",key3:{},key4:{key1:val},key5:[1,2],key6:[[1,2,3],{},1,{key1:\"[]{}:,.\"}]}').must_equal o(key1: \"val\", key2: \"val\", key3: o, key4: o(key1: \"val\"), key5: %w(1 2), key6: [%w(1 2 3), o, '1', o(key1: '[]{}:,.')])\n    end\n\n    def o(h= {})\n      OpenStruct.new(h)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 1028640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41376ed185323c2e1224b868972a1f3e?s=128&d=identicon&r=PG", "display_name": "Mateusz Fryc", "link": "https://stackoverflow.com/users/1028640/mateusz-fryc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561477427, "creation_date": 1561450179, "last_edit_date": 1561458623, "question_id": 56749529, "link": "https://stackoverflow.com/questions/56749529/how-to-transform-nested-arrays-string-in-json-like-string-to-structured-object-u", "title": "How to transform nested arrays string in json like string to structured object using parslet", "body": "<p>I have a problem with transforming parsed JSON-like string, which contains nested arrays, to structured object. I am using parslet to do this. </p>\n\n<p>I created parser and transformer, presented below. But I can't handle nested arrays situation.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'parslet'\nclass JSONLikeDataParser &lt; Parslet::Parser\n  rule(:l_map_paren) {str('{')}\n  rule(:r_map_paren) {str('}')}\n  rule(:l_list_paren) {str('[')}\n  rule(:r_list_paren) {str(']')}\n  rule(:map_entry_delimiter) {str(':')}\n  rule(:val_delimiter) {str(',')}\n  rule(:quote) {str('\"')}\n\n  rule(:simple_val) {match('[^\",:\\.\\{\\}\\[\\]]').repeat(1)}\n  rule(:quoted_val) {quote &gt;&gt; (quote.absnt? &gt;&gt; any).repeat(0) &gt;&gt; quote}\n\n\n  rule(:map) {l_map_paren &gt;&gt; map_entries.maybe.as(:map) &gt;&gt; r_map_paren}\n  rule(:map_entries) {map_entry &gt;&gt; (val_delimiter &gt;&gt; map_entry).repeat}\n  rule(:map_entry) {map_key &gt;&gt; map_entry_delimiter &gt;&gt; object}\n  rule(:map_key) {(match('[A-Za-z_]').repeat(1) &gt;&gt; match('[A-Za-z0-9_]').repeat).as(:key)}\n\n  rule(:list) {l_list_paren &gt;&gt; list_values.maybe.as(:list) &gt;&gt; r_list_paren}\n  rule(:list_values) {object &gt;&gt; (val_delimiter &gt;&gt; object).repeat}\n\n  rule(:object) {map | (simple_val | quoted_val).as(:value) | list }\n\n  root(:object)\nend\n\n#TODO doesn't handle properly nested array: [[[1,2],[3]]]\nclass JSONLikeDataTransform &lt; Parslet::Transform\n  rule(map: subtree(:s)) do\n    ret = {}\n    if (s.is_a?(Hash))\n      ret[s[:key]] = s[:value]\n    else\n      s.each do |h|\n        ret.merge!(h)\n      end\n    end\n    OpenStruct.new(ret)\n  end\n  rule(key: simple(:k), value: simple(:v)) {{k.str =&gt; v.str}}\n  rule(key: simple(:k), list: simple(:v)) {{k.str =&gt; [v]}}\n  rule(key: simple(:k), list: sequence(:v)) {{k.str =&gt; v}}\n\n  rule(map: simple(:s)) {s ? OpenStruct.new(s) : OpenStruct.new}\n\n  rule(list: subtree(:s)) {[s]}\n  rule(list: sequence(:s)) {s}\n  rule(list: simple(:s)) {s ? [s] : []}\n\n  rule(value: subtree(:s)) {s}\n  rule(value: sequence(:s)) {s}\n  rule(value: simple(:s)) {s.str}\nend\n\nputs JSONLikeDataTransform.new.apply(JSONLikeDataParser.new.parse(\"[[[1],[2,3]]]\")).inspect\n</code></pre>\n\n<p>Problematic string is <code>\"[[[1],[2,3]]]\"</code>. I expect to receive properly nested structure. But what I get is <code>\"[[[[1],[2,3]]]]\"</code> one bracket too much.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "tinymce-rails"], "comments": [{"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1561451224, "post_id": 56749520, "comment_id": 100057468, "body": "I think you might need <a href=\"https://www.tiny.cloud/docs/mobile/\" rel=\"nofollow noreferrer\">tinyMCE mobile</a>. Here is another question with the same issue as the one you described: <a href=\"https://community.tiny.cloud/communityQuestion?id=9066100000097myAAA\" rel=\"nofollow noreferrer\">community.tiny.cloud/communityQuestion?id=9066100000097myAAA</a>"}, {"owner": {"reputation": 11, "user_id": 11695850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fdac082df3b9de6b3e0022f243365e?s=128&d=identicon&r=PG&f=1", "display_name": "Madhusudhan", "link": "https://stackoverflow.com/users/11695850/madhusudhan"}, "reply_to_user": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "edited": false, "score": 0, "creation_date": 1561544854, "post_id": 56749520, "comment_id": 100096723, "body": "I tried but it didn&#39;t work."}], "owner": {"reputation": 11, "user_id": 11695850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fdac082df3b9de6b3e0022f243365e?s=128&d=identicon&r=PG&f=1", "display_name": "Madhusudhan", "link": "https://stackoverflow.com/users/11695850/madhusudhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561450149, "creation_date": 1561450149, "question_id": 56749520, "link": "https://stackoverflow.com/questions/56749520/tinymce-is-not-working-for-mobile-view-in-google-chrome-using-tinymce-rails-ge", "title": "TinyMCE is not working for mobile view in Google Chrome using &quot;tinymce-rails&quot; gem", "body": "<p>I have added \"gem 'tinymce-rails'\" in my rails application\nI have added \"//= require tinymce-jquery\" in my application.js</p>\n\n<p>And in my js.erb file, I initialized it using</p>\n\n<pre><code>tinyMCE.init({\n  selector: '#offer_description',\n  menubar: false,\n  branding: false,\n  height: 300\n});\n</code></pre>\n\n<p>and on edit, I reinitialized it using</p>\n\n<pre><code>tinymce.EditorManager.execCommand('mceRemoveEditor',true, (tinymce.EditorManager.activeEditor != null) ? tinymce.EditorManager.activeEditor.id : null);\n\ntinymce.EditorManager.execCommand('mceAddEditor',true, (tinymce.EditorManager.activeEditor != null) ? tinymce.EditorManager.activeEditor.id : null);\n</code></pre>\n\n<p>And in my view page, I have added class \"tinymce\" like this:-</p>\n\n<pre><code>= form.text_area :description, :maxlength =&gt; \"5000\", :class =&gt; \"listing_description_textarea tinymce\"\n</code></pre>\n\n<p>It is working fine in both firefox and google chrome.\nBut in mobile view in Google Chrome, it is displaying a black box having a book icon in middle and the text area is not working.\nThere is no error in the browser console and Ubuntu Terminal.\nWhat should I do to get it work properly?</p>\n\n<p><a href=\"https://i.stack.imgur.com/k7yfM.png\" rel=\"nofollow noreferrer\">This error is displaying in mobile view in place of tinymce Text Editor</a></p>\n"}, {"tags": ["ruby", "azure-devops", "azure-devops-rest-api"], "answers": [{"tags": [], "owner": {"reputation": 23460, "user_id": 7409220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bhmli.jpg?s=128&g=1", "display_name": "Shayki Abramczyk", "link": "https://stackoverflow.com/users/7409220/shayki-abramczyk"}, "is_accepted": true, "score": 1, "last_activity_date": 1561445202, "creation_date": 1561445202, "answer_id": 56748244, "question_id": 56748125, "link": "https://stackoverflow.com/questions/56748125/how-to-create-work-items-tasks-bugs-etc-using-ruby-for-an-azure-devops-proje/56748244#56748244", "title": "How to create Work items (tasks, bugs, etc) using ruby for an Azure DevOps project?", "body": "<p>There is unofficial Ruby library that wrap the Azure DevOps api, you can find it <a href=\"https://gitlab.com/michaelsabo/ruby_vsts\" rel=\"nofollow noreferrer\">here</a>, is not look like it's maintained.</p>\n\n<p>Another option is to use <a href=\"https://docs.microsoft.com/en-us/rest/api/azure/devops\" rel=\"nofollow noreferrer\">Azure DevOps Rest API</a> with Ruby, and run it like every HTTP request.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 5076841, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-koRKA9X1hyo/AAAAAAAAAAI/AAAAAAAAAAA/228nkJq8okc/photo.jpg?sz=128", "display_name": "reach2saurabh", "link": "https://stackoverflow.com/users/5076841/reach2saurabh"}, "is_accepted": false, "score": 0, "last_activity_date": 1561716636, "creation_date": 1561716636, "answer_id": 56805005, "question_id": 56748125, "link": "https://stackoverflow.com/questions/56748125/how-to-create-work-items-tasks-bugs-etc-using-ruby-for-an-azure-devops-proje/56805005#56805005", "title": "How to create Work items (tasks, bugs, etc) using ruby for an Azure DevOps project?", "body": "<p>Not sure about the Ruby API, but can use the standard REST API in ruby code to create work item in ado project. Below links with help you with the details -</p>\n\n<p><a href=\"https://docs.microsoft.com/en-gb/rest/api/index?branch=master&amp;view=Azure%20DevOps\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/rest/api/index?branch=master&amp;view=Azure%20DevOps</a></p>\n\n<p>Work item tracking Service</p>\n\n<p><a href=\"https://docs.microsoft.com/en-gb/rest/api/azure/devops/wit/?view=azure-devops-rest-5.0\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/rest/api/azure/devops/wit/?view=azure-devops-rest-5.0</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7584879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aafd12c7da36ac9b1d77e8719931a1f?s=128&d=identicon&r=PG&f=1", "display_name": "learner", "link": "https://stackoverflow.com/users/7584879/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 56748244, "answer_count": 2, "score": 0, "last_activity_date": 1561716636, "creation_date": 1561444647, "last_edit_date": 1561445229, "question_id": 56748125, "link": "https://stackoverflow.com/questions/56748125/how-to-create-work-items-tasks-bugs-etc-using-ruby-for-an-azure-devops-proje", "title": "How to create Work items (tasks, bugs, etc) using ruby for an Azure DevOps project?", "body": "<p>Is there any Ruby API that would be used to create work items in my ADS project? </p>\n\n<p>Which api should I use to create or update work items in Azure DevOps using ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "partials", "react-rails"], "answers": [{"tags": [], "owner": {"reputation": 1015, "user_id": 6773669, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f9471cd591c8e6d426534832c0804cd5?s=128&d=identicon&r=PG&f=1", "display_name": "Pragun", "link": "https://stackoverflow.com/users/6773669/pragun"}, "is_accepted": false, "score": 2, "last_activity_date": 1561699452, "creation_date": 1561699452, "answer_id": 56801309, "question_id": 56746524, "link": "https://stackoverflow.com/questions/56746524/rendering-a-react-component-in-ruby-on-rails-partial/56801309#56801309", "title": "Rendering a react component in Ruby on Rails partial", "body": "<p>checked <code>react-rails</code> source code and had to manually call <code>ReactRailsUJS.handleMount()</code> via javascript.</p>\n"}], "owner": {"reputation": 1015, "user_id": 6773669, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f9471cd591c8e6d426534832c0804cd5?s=128&d=identicon&r=PG&f=1", "display_name": "Pragun", "link": "https://stackoverflow.com/users/6773669/pragun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561699452, "creation_date": 1561434101, "question_id": 56746524, "link": "https://stackoverflow.com/questions/56746524/rendering-a-react-component-in-ruby-on-rails-partial", "title": "Rendering a react component in Ruby on Rails partial", "body": "<p>Is it possible to render a react component in a rails partial through an AJAX call? Basically for performance reasons, I have to do some condition checks in order to render and initialize a react component in rails view. I cannot require the react JS upfront as well. I am thinking about rendering a partial through AJAX call and replacing the html in the view from jQuery. I am using <code>react-rails</code> for this purpose.</p>\n\n<p>I'm not sure if this is the best way to do it. Other alternatives would be helpful too.</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-solo"], "comments": [{"owner": {"reputation": 6310, "user_id": 3080908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f82666477cf654ae658055c538a6bdf?s=128&d=identicon&r=PG", "display_name": "Lee_Dailey", "link": "https://stackoverflow.com/users/3080908/lee-dailey"}, "edited": false, "score": 0, "creation_date": 1561429103, "post_id": 56745844, "comment_id": 100050455, "body": "what does this have to do with powershell? i am confused ... [<i>blush</i>]"}, {"owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "edited": false, "score": 0, "creation_date": 1562231864, "post_id": 56745844, "comment_id": 100316527, "body": "Created GitHub issue here <a href=\"https://github.com/chef/chef/issues/8714\" rel=\"nofollow noreferrer\">github.com/chef/chef/issues/8714</a>. thanks"}], "owner": {"reputation": 23, "user_id": 6177844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9161182d6b41176b1e760b21a9fb793c?s=128&d=identicon&r=PG&f=1", "display_name": "SmNg1028", "link": "https://stackoverflow.com/users/6177844/smng1028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561447771, "creation_date": 1561427637, "last_edit_date": 1561447771, "question_id": 56745844, "link": "https://stackoverflow.com/questions/56745844/unable-to-locate-config-files-when-i-tried-to-run-chef-solo", "title": "Unable to locate config files when I tried to run chef-solo", "body": "<p>When I ran ChefSolo in my server, it threw this error saying that it couldn't find my config file (solo.rb and nodes file), even though it is literally under my Chef directory. </p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>chef-solo -c solo.rb -j \".\\nodes\\test.json\"\n</code></pre>\n\n<pre><code>[2019-06-24T07:04:56+00:00] DEBUG: Reading products and relationships...\n[2019-06-24T07:04:56+00:00] DEBUG: Successfully read products and relationships\n[2019-06-24T07:04:56+00:00] DEBUG: Searching for the following licenses: [\"infra-client\", \"inspec\"]\n[2019-06-24T07:04:56+00:00] DEBUG: Found license chef_infra_client at C:/Users/simon.lam/.chef/accepted_licenses/chef_in\nfra_client\n[2019-06-24T07:04:56+00:00] DEBUG: Found license inspec at C:/Users/simon.lam/.chef/accepted_licenses/inspec\n[2019-06-24T07:04:56+00:00] DEBUG: Missing licenses remaining: []\n[2019-06-24T07:04:56+00:00] DEBUG: All licenses present\n[2019-06-24T07:04:56+00:00] FATAL: Cannot load configuration from .\\nodes\\local.json\n\nPS C:\\git\\chef&gt; chef -v\nChef Development Kit Version: 4.0.60\nchef-client version: 15.0.300\ndelivery version: master (9d07501a3b347cc687c902319d23dc32dd5fa621)\nberks version: 7.0.8\nkitchen version: 2.2.5\ninspec version: 4.3.2\n</code></pre>\n\n<p>when I specified the full path of solo.rb and node config file, it stops complaining </p>\n\n<p>I have tried to installing Chef WorkStation and it still failed with the same error, couldnt find solo.rb. Just wondering if I have missed out any configuration to re-point chef to look into my own git chef directory (C:\\git\\chef... all my chef cookbooks, nodes and solo.rb are in here). But chef-solo keeps looking for solo.rb in C:\\solo.rb, not sure why it does that (maybe the relative path is not working - potential bug).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "rspec", "chef-infra", "chefspec"], "comments": [{"owner": {"reputation": 2725, "user_id": 303114, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/kBVST.jpg?s=128&g=1", "display_name": "danfromisrael", "link": "https://stackoverflow.com/users/303114/danfromisrael"}, "edited": false, "score": 0, "creation_date": 1589091664, "post_id": 56745067, "comment_id": 109151280, "body": "did you get to solve this issue ?"}], "owner": {"reputation": 23, "user_id": 6177844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9161182d6b41176b1e760b21a9fb793c?s=128&d=identicon&r=PG&f=1", "display_name": "SmNg1028", "link": "https://stackoverflow.com/users/6177844/smng1028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1971, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561418722, "creation_date": 1561418722, "question_id": 56745067, "link": "https://stackoverflow.com/questions/56745067/mocking-library-function-is-not-working-properly-under-context-block", "title": "Mocking library function is not working properly under context block?", "body": "<p>I have a ChefSpec test below, I am not sure if it is a bug in ChefSpec or not. \nHowever, whenever I mocked a library function under context block, the mocking library did not mock the value for the function and caused the failure of the test. The odd thing is the test passed (the mocking worked) when all the 'it' blocks stayed inside that context block, but if I add any other 'it' block outside that context block, the mocking will fail to mock the library function and start stepping into them. </p>\n\n<p>Is there any way to fix or work around this? Thanks  </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>context \"when site_tool is not set (default)\" do \n            #This mocking block is not working properly inside the context block.\n            #If I move everything out of this context block, everything works fine\n            # including the mocking library function below. \n            # The error is basically it tried to step into the library function,\n            # even though its not supposed to as I have mocked it out \n            # Is there a different way of mocking library function \n            #specifically for outside and inside context block??\n            before do \n                allow_any_instance_of(Chef::Recipe)\n                    .to receive(:get_service_account_password)\n                    .with(site[:app][:permissions][:base_username]) \n                    .and_return(\"test_password\")\n            end  \n\n            it 'adds the default app pool' do\n            is_expected.to add_iis_pool('DefaultAppPool').with(\n                ...\n            )\n            end\n            ## More complicated 'it' blocks below\n        end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11694557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98371304c7ad2b9de3ab13917364021e?s=128&d=identicon&r=PG&f=1", "display_name": "A. Lelli", "link": "https://stackoverflow.com/users/11694557/a-lelli"}, "edited": false, "score": 0, "creation_date": 1561420130, "post_id": 56744880, "comment_id": 100049127, "body": "Hi, I upvoted this, thanks so much for all the advice. I realize now I didn&#39;t ask the most essential part of my question, whether your only routes should be the 7 standard restful &quot;show&quot;, &quot;index&quot;, &quot;update&quot; etc. routes in order for your API to be restful, or whether you can make ad hoc functions that correspond to the &quot;principles of REST&quot;, whatever that might mean. I&#39;ll edit my question to do this and will accept your answer as solving if it answers that as well.   Just another question as well, when you say &quot;at the database level&quot;, does this mean manipulation with a controller method?"}, {"owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "reply_to_user": {"reputation": 11, "user_id": 11694557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98371304c7ad2b9de3ab13917364021e?s=128&d=identicon&r=PG&f=1", "display_name": "A. Lelli", "link": "https://stackoverflow.com/users/11694557/a-lelli"}, "edited": false, "score": 0, "creation_date": 1561425588, "post_id": 56744880, "comment_id": 100049931, "body": "@A.Lelli by &quot;at the database level&quot; I mean like I did in my example. You still write code in the controller (or in the model called by the controller), but the actual selection or aggregation is done by the DB. In this case I&#39;m using <code>order(RANDOM())</code> and <code>limit</code> together to do the picking of the random row in the DB instead of in ruby."}, {"owner": {"reputation": 11, "user_id": 11694557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98371304c7ad2b9de3ab13917364021e?s=128&d=identicon&r=PG&f=1", "display_name": "A. Lelli", "link": "https://stackoverflow.com/users/11694557/a-lelli"}, "edited": false, "score": 0, "creation_date": 1561510838, "post_id": 56744880, "comment_id": 100084394, "body": "Got it! Thanks again!"}], "tags": [], "owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "is_accepted": false, "score": 3, "last_activity_date": 1561425652, "last_edit_date": 1561425652, "creation_date": 1561416748, "answer_id": 56744880, "question_id": 56744709, "link": "https://stackoverflow.com/questions/56744709/when-and-where-to-aggregate-or-perform-calculations-on-data-in-restful-rails-api/56744880#56744880", "title": "When and where to aggregate or perform calculations on data in RESTful Rails API", "body": "<p>This is a pretty broad design question so I'm just going to give a list of general pointers to think about:</p>\n\n<ul>\n<li>A major component of RESTful web service design is picking the right resources, which do not need to correspond directly with the tables in your database. It's totally appropriate to invent new resources (usually but now always with a corresponding class in <code>models/</code>) that map more naturally to what the client is looking for. </li>\n<li>In general I'd recommend performing aggregations on the server side at the database level (or via some other data-storage mechanism like a pre-computed cache if even the database is too slow)</li>\n<li>If you're using a relational database, it can be useful to define views that perform the aggregation (<a href=\"https://www.postgresql.org/docs/11/sql-createview.html\" rel=\"nofollow noreferrer\">https://www.postgresql.org/docs/11/sql-createview.html</a>). Then you can create an activerecord model that references the view</li>\n<li>It's generally not worth creating controller methods that are named differently from what's in your routes file. In your example I'd just have a new action <code>random</code> at <code>/script_lines/random</code> and then a controller method <code>random</code>. </li>\n<li>Depending on how truly \"RESTful\" you want to be, you may or may not need be working in a codebase where it's acceptable to define non-standard controller actions and it might or might not be acceptable for a GET endpoint to return random results like this (both of these can break the strict definition of REST). Check out this answer: <a href=\"https://stackoverflow.com/questions/20396167/restful-web-service-to-get-random-number-verb\">RESTful web service to get random number verb</a> for some more context.</li>\n</ul>\n\n<p>Personally, if I wasn't overly concerned with RESTful-ness, I'd add a new action to the ScriptLinesController like this:</p>\n\n<pre><code>class ScriptLinesController &lt; ApplicationController\n  def random\n    num_lines = rand(0..9)\n    render json: ScriptLine.order(\"RANDOM()\").limit(num_lines)\n  end\nend\n</code></pre>\n\n<p>As the <code>random</code> function got more complicated over time I'd consider moving it to the <code>ScriptLine</code> model. If even more complexity got added that was all logically related to the concept of \"Collection of random script lines\" I'd move that code out to a separate other model and create a new controller.   </p>\n"}], "owner": {"reputation": 11, "user_id": 11694557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98371304c7ad2b9de3ab13917364021e?s=128&d=identicon&r=PG&f=1", "display_name": "A. Lelli", "link": "https://stackoverflow.com/users/11694557/a-lelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561425652, "creation_date": 1561415462, "last_edit_date": 1561420400, "question_id": 56744709, "link": "https://stackoverflow.com/questions/56744709/when-and-where-to-aggregate-or-perform-calculations-on-data-in-restful-rails-api", "title": "When and where to aggregate or perform calculations on data in RESTful Rails API", "body": "<p>I was wondering if there is a general way one should go about aggregating data or performing calculations on it (e.g. grabbing ten random lines of a movie script, or multiplying ten product prices by each other) in Rails or in MVCs in general. Specifically I'm attempting to do the first example (10 lines of a movie script) in my application. </p>\n\n<p>I'm using Rails 5.2+. What I've tried so far is making an instance method <code>getRandomLines</code> in my <code>ScriptLinesController</code>. But I'm not sure whether I should instead be using the show method and aggregating the data on the client-side, or if I should put the method in the model <code>ScriptLine</code></p>\n\n<p>I've tested the following route using Postman and it works, but it seems like the wrong way to go about it:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#My routes.rb:\nRails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n\n  get 'script_lines/test', to: 'script_lines#getRandomLines'\n\nend\n</code></pre>\n\n<p>My controller looks like this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ScriptLinesController &lt; ApplicationController\n  def index\n    render json: ScriptLine.all\n  end\n\n  def show\n    scriptLine = ScriptLine.find_by(id: params[:id])\n\n    render json: scriptLine\n  end\n\n  def getRandomLines\n    numLines=rand(0..9)\n    nineLines = []\n    numLines.times do\n      id_num = rand(1..ScriptLine.last.id)\n      nineLines &lt;&lt; ScriptLine.find_by(id: id_num)\n    end\n\n    render json: nineLines[0]\n  end\nend\n</code></pre>\n\n<p>My model looks like this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ScriptLine &lt; ApplicationRecord\n  validates :line_number, presence:true\n\n  belongs_to :script\nend\n</code></pre>\n\n<p>Finally my schema looks like this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  create_table \"script_lines\", force: :cascade do |t|\n    t.string \"line_number\"\n    t.string \"line\"\n    t.bigint \"script_id\"\n    t.index [\"script_id\"], name: \"index_script_lines_on_script_id\"\n  end\n</code></pre>\n\n<p>So in sum, is creating methods in the controller and specifying routes to those methods the right way to aggregate/perform calculations on data in a RESTful manner? In particular I'm wondering if the 7 standard RESTful routes are the only routes allowed, or if you can have ad-hoc routes for manipulating data that comply with REST principles. </p>\n\n<p>This is my first question, so apologies in advance if it's asking too much or too vague, will modify accordingly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "if-statement", "conditional-statements", "ternary"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1561416398, "post_id": 56744683, "comment_id": 100048375, "body": "You second code does not set the same classes as the first code, I&#39;m not sure I understand your question, what&#39;s the problem with the ternary operator? is it not working? I think I would move that logic to a helper though"}, {"owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1561421527, "post_id": 56744683, "comment_id": 100049353, "body": "Yeah the first was before I changed the class names. I have  other ternary in my code inline but using == with 2 &lt;%= %&gt; tags does not seem to change the css class I am calling."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "edited": false, "score": 0, "creation_date": 1561416379, "post_id": 56744764, "comment_id": 100048372, "body": "Nick , that is exactly what I have and it is not working. I definitely read up before I asked this question. For some reason using the == is not working."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1561416430, "post_id": 56744764, "comment_id": 100048388, "body": "What does &quot;not working&quot; mean? Do you get errors? Does it produce the wrong result? If so, what result? You may need to put in a diagnostic <code>&lt;%= (track.user.username == current_user.username).inspect) %&gt;</code>"}, {"owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "edited": false, "score": 0, "creation_date": 1561416953, "post_id": 56744764, "comment_id": 100048512, "body": "I have never used .inspect before ? I&#39;ll look it up. (I have been coding for a little over a year) Thanks for your help."}], "tags": [], "owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1561415826, "creation_date": 1561415826, "answer_id": 56744764, "question_id": 56744683, "link": "https://stackoverflow.com/questions/56744683/how-do-you-write-a-conditional-ternary-operator-inline-in-ruby-on-rails/56744764#56744764", "title": "How do you write a conditional ternary operator inline in Ruby on Rails?", "body": "<p>You probably want to do something like:</p>\n\n<pre><code>&lt;td class=\"&lt;%= track.user.username == current_user.username ? \"track_table_current_user\" : \"td-userName\" %&gt;\"&gt;\n    &lt;%= track.user.username %&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/4252936/how-do-i-use-the-conditional-operator-in-ruby\">this answer</a> to learn how to use the ternary operator, it works about the same in every language out there.</p>\n"}, {"comments": [{"owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "edited": false, "score": 0, "creation_date": 1561416697, "post_id": 56744857, "comment_id": 100048447, "body": "I already had this but it messed up my search function I had because I was unable to access the &lt;td&gt; values. I like the idea of adding a @rendered_name in the controller as a work around."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "reply_to_user": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "edited": false, "score": 0, "creation_date": 1561417038, "post_id": 56744857, "comment_id": 100048532, "body": "As a rule, views and templates should have 0 logic in them. In this case, the <code>@rendered_name</code> isn&#39;t a workaround as much as a better way to design your views. Once you get in this habit, debugging view logic will become way easier."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "reply_to_user": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "edited": false, "score": 0, "creation_date": 1561417095, "post_id": 56744857, "comment_id": 100048543, "body": "Instead of debugging why you can&#39;t access the <code>&lt;td&gt;</code> values (do you mean the class values?), I would first start with this approach, and then ask a question if it isn&#39;t working as expected."}, {"owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "edited": false, "score": 0, "creation_date": 1561421807, "post_id": 56744857, "comment_id": 100049390, "body": "I added my search function to the code above. --- I get undefined values if I use an ruby if statement. I figured I could get away with writing it inline. I did mean &lt;td&gt; or class becuase I am using getElelmentsByClassName() and I also tried querySelectorAll()"}], "tags": [], "owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "is_accepted": false, "score": 1, "last_activity_date": 1561416510, "creation_date": 1561416510, "answer_id": 56744857, "question_id": 56744683, "link": "https://stackoverflow.com/questions/56744683/how-do-you-write-a-conditional-ternary-operator-inline-in-ruby-on-rails/56744857#56744857", "title": "How do you write a conditional ternary operator inline in Ruby on Rails?", "body": "<p>I would not use the ternary operator here because it makes your template code much more difficult to read. Instead, I would do an if-else statement. The ternary operator is really nice for very short if-else statements, but especially in rendered code, we want to reduce all logic possible, and when it's not possible, we want it to be as easy to parse as possible.</p>\n\n<p>This is much easier to parse:</p>\n\n<pre><code>&lt;% if track.user.username == current_user.username %&gt;\n  &lt;td class=\"track_table_user_name &lt;%= this_current_user %&gt;&gt;\n&lt;% else %&gt;\n  &lt;td class=\"track_table_user_name &lt;%= other_user %&gt;&gt;\n...\n</code></pre>\n\n<p>I would even go as far as to make a <code>@rendered_username</code> variable in the controller so you don't have to do any of this logic.</p>\n"}, {"comments": [{"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 1, "creation_date": 1561422996, "post_id": 56745417, "comment_id": 100049551, "body": "Now that you have it working, would you consider separating the logic out of the view and into the controller (or helper)?"}, {"owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "reply_to_user": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1561434270, "post_id": 56745417, "comment_id": 100051328, "body": "Is that better practice? I did that with the tracks that were populating but I thought color changes of names could be left in the html..I would love advice or direction."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 1, "creation_date": 1561583795, "post_id": 56745417, "comment_id": 100116993, "body": "Yes, as much as possible you want to reduce logic in views. Not only is it extremely difficult to test, but now you have another [usually messy] layer to debug when things aren&#39;t working. Try googling &quot;rails views logic&quot; and you&#39;ll see a bunch of articles talking about ways to get around putting logic in views :)"}], "tags": [], "owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1561422814, "creation_date": 1561422814, "answer_id": 56745417, "question_id": 56744683, "link": "https://stackoverflow.com/questions/56744683/how-do-you-write-a-conditional-ternary-operator-inline-in-ruby-on-rails/56745417#56745417", "title": "How do you write a conditional ternary operator inline in Ruby on Rails?", "body": "<p>I figured it out.... I am going to hate to admit this but i forgot the '=' symbol... uggggg why!?!?! </p>\n\n<pre><code>&lt;td class=\"track_table_user_name \\\n    &lt;% ***(right here)*** track.user.username == current_user.username ? \"this_current_user\" : \"other_user\" %&gt;\"&gt;\n     &lt;%= track.user.username %&gt;\n    &lt;/td&gt;\n\n</code></pre>\n\n<p>Thanks everyone for your help and the .inspect, and to put a variable in the controler. </p>\n\n<p>My working final :</p>\n\n<pre><code>&lt;td class=\"track_table_user_name &lt;%= (track.user.username == current_user.username) ? \"this_current_user\" : \"other_user\" %&gt;\"&gt;&lt;%= track.user.username %&gt;&lt;/td&gt;\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 9424474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bjgChKgBfVk/AAAAAAAAAAI/AAAAAAAAAJ0/Y2bJrPa4EbY/photo.jpg?sz=128", "display_name": "Curtis M", "link": "https://stackoverflow.com/users/9424474/curtis-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1561422814, "creation_date": 1561415287, "last_edit_date": 1561422729, "question_id": 56744683, "link": "https://stackoverflow.com/questions/56744683/how-do-you-write-a-conditional-ternary-operator-inline-in-ruby-on-rails", "title": "How do you write a conditional ternary operator inline in Ruby on Rails?", "body": "<p>I am trying to compare 2 values and change the color of one when the condition holds true.\nBut I also have a search-bar and I could not access the tag values when it is wrapped in an &lt;% if %> statement in my javascript function using Rails. </p>\n\n<p>I originally had the code as so</p>\n\n<pre><code> &lt;% if track.user.username == current_user.username%&gt;\n   &lt;td class=\"track_table_current_user\"&gt;\n     &lt;span&gt;&lt;%= track.user.username %&gt;&lt;/span&gt;\n   &lt;/td&gt;\n &lt;% else %&gt;\n   &lt;td class=\"td-userName\"&gt; \n     &lt;span class=\"track_table_user_name\"&gt;&lt;%= track.user.username %&gt; &lt;/span&gt;\n   &lt;/td&gt;\n &lt;% end %&gt; \n</code></pre>\n\n<p>My Ternary as of now: </p>\n\n<pre><code>&lt;td class=\"track_table_user_name &lt;% track.user.username == current_user.username ? \"this_current_user\" : \"other_user\" %&gt;\"&gt;\n    &lt;%= track.user.username %&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>The Search Function that I cannot access the values if I use an &lt;% if %> &lt;% else%>:</p>\n\n<pre><code>function trackTableSearch() {\n  var input, filter, table, tr, td, i, txtValue;\n  input = document.getElementById(\"trackTableInput\");\n  filter = input.value.toUpperCase();\n  table = document.getElementById(\"tracksTable\");\n  tr = table.getElementsByTagName(\"tr\");\n  for (i = 0; i &lt; tr.length; i++) {\n    tdN  = tr[i].getElementsByClassName(\"td-trackName\")[0];\n    tdU = tr[i].getElementsByClassName(\"track_table_user_name\")[0];\n    tdR = tr[i].getElementsByClassName(\"td-trackApproved\")[0];\n    tdP = tr[i].getElementsByClassName(\"td-public\")[0];\n    if ((tdN) || (tdU) || (tdR) || (tdP)) {\n      txtValueN  = tdN.textContent  || tdN.innerText;\n      txtValueU  = tdU.textContent  || tdU.innerText;\n      txtValueA  = tdR.textContent  || tdR.innerText;\n      txtValueP  = tdP.textContent  || tdP.innerText;\n\n      if (txtValueN.toUpperCase().indexOf(filter) &gt; -1) {\n        tr[i].style.display = \"\";\n      }else if (txtValueU.toUpperCase().indexOf(filter) &gt; -1) {\n        tr[i].style.display = \"\";\n      } else if (txtValueA.toUpperCase().indexOf(filter) &gt; -1) {\n        tr[i].style.display = \"\";\n      }else if (txtValueP.toUpperCase().indexOf(filter) &gt; -1) {\n        tr[i].style.display = \"\";\n      }else{\n        tr[i].style.display = \"none\";\n      }\n    }\n  }\n</code></pre>\n"}, {"tags": ["ruby", "memory"], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1561407510, "post_id": 56743315, "comment_id": 100045723, "body": "Well so for even smaller strings, isn&#39;t it a good practice to reassign it rather than using the <code>str.replace(&#39;something&#39;)</code> or <code>str.clear.concat(&#39;something&#39;)</code> methods? In other words is it a bad idea to reassign a string or an array rather than clearing and concat some data to it?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 1, "creation_date": 1561409205, "post_id": 56743315, "comment_id": 100046342, "body": "@S.Goswami It is good practice to create a new copy rather than altering an object in place. Altering an object affects everything which refers to that object, like <code>b</code> in the example above. This &quot;action at a distance&quot; can cause hard to find bugs. For this reason it&#39;s best to treat objects as &quot;immutable&quot;, meaning the object does not change; if you want to change it you make a new copy and change that. If you know you have total control over a very large object, and copying it will affect performance, go ahead and optimize. Otherwise make copies and let the garbage collector do its thing."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 1, "creation_date": 1561409542, "post_id": 56743315, "comment_id": 100046436, "body": "@S.Goswami PS <code>str.replace(&#39;foo&#39;)</code> is clearer and a tad more efficient than <code>str.clear.concat(&#39;foo&#39;)</code>. Both result in freeing the original memory and allocating new memory, but <code>str.replace</code> does it explicitly whereas with <code>str.clear.concat</code> both the reader and Ruby have to jump through a few more hoops."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561787772, "post_id": 56743315, "comment_id": 100184405, "body": "@Schwern: In addition to the &quot;spooky action at a distance&quot; problem, re-using objects by mutating them also breaks the fundamental assumptions that modern high-performance generational garbage collectors are built on: 1) objects die young, 2) old objects don&#39;t reference new objects, 3) objects aren&#39;t mutated. 1 + 2 together are called the &quot;generational hypothesis&quot;, 3 is more related to the general performance impact of write barriers / fences / locks / etc. that are required to protect the integrity of the garbage-collected object space."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 8, "last_activity_date": 1561407350, "last_edit_date": 1561407350, "creation_date": 1561406917, "answer_id": 56743315, "question_id": 56743116, "link": "https://stackoverflow.com/questions/56743116/why-reassigning-a-string-doesnt-reduce-the-memory-usage-in-ruby/56743315#56743315", "title": "Why reassigning a string doesn&#39;t reduce the memory usage in Ruby?", "body": "<p><code>a = ''</code> and <code>a.clear</code> do subtly different things.</p>\n\n<p><code>a = ''</code> creates a new <code>String</code> object and assigns it to <code>a</code>. The old <code>String</code> object is still floating around in memory waiting to be garbage collected.</p>\n\n<pre><code>2.4.4 :010 &gt; a = 'foo'\n =&gt; \"foo\" \n2.4.4 :011 &gt; a.object_id\n =&gt; 70311739468740 \n2.4.4 :012 &gt; a = ''\n =&gt; \"\" \n2.4.4 :013 &gt; a.object_id\n =&gt; 70311748786840 \n</code></pre>\n\n<p>Note the different object IDs.</p>\n\n<p><code>a.clear</code> clears the existing <code>String</code> object.</p>\n\n<pre><code>2.4.4 :016 &gt; a = 'foo'\n =&gt; \"foo\" \n2.4.4 :017 &gt; a.object_id\n =&gt; 70311748749240 \n2.4.4 :018 &gt; a.clear\n =&gt; \"\" \n2.4.4 :019 &gt; a.object_id\n =&gt; 70311748749240 \n</code></pre>\n\n<p>Note the object ID is the same.</p>\n\n<p>Specifically <code>clear</code> calls <a href=\"https://github.com/ruby/ruby/blob/551ef27490bf380e46453846c040b48596f34a6a/string.c#L2156\" rel=\"noreferrer\"><code>str_discard</code></a> which immediately frees the memory allocated to the <code>String</code>.</p>\n\n<pre><code>static inline void\nstr_discard(VALUE str)\n{\n    str_modifiable(str);\n    if (!STR_EMBED_P(str) &amp;&amp; !FL_TEST(str, STR_SHARED|STR_NOFREE)) {\n    ruby_sized_xfree(STR_HEAP_PTR(str), STR_HEAP_SIZE(str));\n    RSTRING(str)-&gt;as.heap.ptr = 0;\n    RSTRING(str)-&gt;as.heap.len = 0;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Another way to see the difference...</p>\n\n<pre><code>2.4.4 :026 &gt; a = 'foo'\n =&gt; \"foo\" \n2.4.4 :027 &gt; b = a\n =&gt; \"foo\" \n2.4.4 :028 &gt; a.object_id\n =&gt; 70311748602540 \n2.4.4 :029 &gt; b.object_id\n =&gt; 70311748602540\n</code></pre>\n\n<p><code>a</code> and <code>b</code> point at the same underlying object.</p>\n\n<pre><code>2.4.4 :030 &gt; a = ''\n =&gt; \"\" \n2.4.4 :031 &gt; b\n =&gt; \"foo\" \n2.4.4 :032 &gt; a.object_id\n =&gt; 70311748541360 \n2.4.4 :033 &gt; b.object_id\n =&gt; 70311748602540 \n</code></pre>\n\n<p>After <code>a = ''</code>, <code>a</code> points at a new object while <code>b</code> points at the original. This illustrates why <code>a = ''</code> cannot free memory immediately, something else might be referencing the original <code>String</code>.</p>\n\n<p>If we set that up again...</p>\n\n<pre><code>2.4.4 :034 &gt; a = 'foo'\n =&gt; \"foo\" \n2.4.4 :035 &gt; b = a\n =&gt; \"foo\" \n2.4.4 :036 &gt; a.object_id\n =&gt; 70311748490260 \n2.4.4 :037 &gt; b.object_id\n =&gt; 70311748490260 \n</code></pre>\n\n<p>But this time use <code>a.clear</code>...</p>\n\n<pre><code>2.4.4 :038 &gt; a.clear\n =&gt; \"\" \n2.4.4 :039 &gt; b\n =&gt; \"\" \n2.4.4 :040 &gt; a.object_id\n =&gt; 70311748490260 \n2.4.4 :041 &gt; b.object_id\n =&gt; 70311748490260 \n</code></pre>\n\n<p><code>a</code> and <code>b</code> are still both refer to the same object.</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56743315, "answer_count": 1, "score": 1, "last_activity_date": 1561478681, "creation_date": 1561406031, "last_edit_date": 1561478681, "question_id": 56743116, "link": "https://stackoverflow.com/questions/56743116/why-reassigning-a-string-doesnt-reduce-the-memory-usage-in-ruby", "title": "Why reassigning a string doesn&#39;t reduce the memory usage in Ruby?", "body": "<p>I just noticed that if you don't either clear or replace a string, the memory usage doesn't reduce.</p>\n\n<p>File x.rb:</p>\n\n<pre><code>#!/usr/bin/ruby -w\nraise(RuntimeError, 'A GNU/Linux or an Android system is needed') unless /linux/ === RUBY_PLATFORM.downcase\n\nrequire 'objspace'\nSTDOUT.sync = true\nGC.start(full_mark: true, immediate_sweep: true)\n\ndefine_method(:show) { \"System Memory Usage: #{::IO.readlines('/proc/meminfo').then { |x| [x[0], x[2]] }\n                            .map { |x| x.split[1].to_f }.reduce(:-)./(1024).round(3)} MiB \"\\\n                                \"| Available: #{::IO.readlines('/proc/meminfo')[2].split[1].to_f./(1024).round(3)} MiB\" }\n\ndefine_method(:memsize) { |obj| ObjectSpace.memsize_of(obj).to_s.reverse.gsub(/\\d{1,3}/).to_a.join(',').reverse &lt;&lt; ' Bytes'}\n</code></pre>\n\n<p>File y.rb:</p>\n\n<pre><code>#!/usr/bin/ruby -w\nfail(NoMemoryError, 'Not enough available memory') if ::IO.readlines('/proc/meminfo')[2].split[1].to_i &lt; 600_000\nrequire_relative(File.join(__dir__, 'x'))\nputs show\n\na = '0' * 500_000_000\nputs \"Memory used by a: #{memsize(a)}\"\nputs show\n\na = ''\nputs \"Memory used by a: #{memsize(a)}\"\nputs show\n</code></pre>\n\n<p>File z.rb:</p>\n\n<pre><code>#!/usr/bin/ruby -w\nfail(NoMemoryError, 'Not enough available memory') if ::IO.readlines('/proc/meminfo')[2].split[1].to_i &lt; 600_000\nrequire_relative(File.join(__dir__, 'x'))\n\nputs show\n\na = '0' * 500_000_000\nputs \"Memory used by a: #{memsize(a)}\"\nputs show\n\na.clear\n\nputs \"Memory used by a: #{memsize(a)}\"\nputs show\n</code></pre>\n\n<p>Output of y.rb:</p>\n\n<pre><code>System Memory Usage: 2316.289 MiB | Available: 1445.23 MiB\nMemory used by a: 500,000,041 Bytes\nSystem Memory Usage: 2795.504 MiB | Available: 966.016 MiB\nMemory used by a: 40 Bytes\nSystem Memory Usage: 2795.504 MiB | Available: 966.016 MiB\n</code></pre>\n\n<p>Output of z.rb:</p>\n\n<pre><code>System Memory Usage: 2301.359 MiB | Available: 1460.16 MiB\nMemory used by a: 500,000,041 Bytes\nSystem Memory Usage: 2780.098 MiB | Available: 981.422 MiB\nMemory used by a: 40 Bytes\nSystem Memory Usage: 2303.387 MiB | Available: 1458.133 MiB\n</code></pre>\n\n<p>Now the problem despite assigning a to an empty string, running the file y.rb uses around 500 megs of memory until the program exits.</p>\n\n<p>z.rb clears the string.</p>\n\n<p>This doesn't also clears the memory:</p>\n\n<pre><code>a[0..-1] = ''\n</code></pre>\n\n<p>Note that both my program and gnome-system-monitor agrees with the system RAM usage.</p>\n\n<p>Why is this the case? How does clear works when assignment operator doesn't?</p>\n"}, {"tags": ["ruby", "rubygems", "jekyll", "rbenv"], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1561452830, "last_edit_date": 1561452830, "creation_date": 1561408272, "answer_id": 56743558, "question_id": 56743072, "link": "https://stackoverflow.com/questions/56743072/going-to-project-folder-before-bundle-install/56743558#56743558", "title": "Going to project folder before &quot;bundle install&quot;", "body": "<p>Why do you want to use <code>jekyll</code>? Usually you would use it as part of a <em>project</em> - which probably entails writing the line:</p>\n\n<pre><code>gem 'jekyll'\n</code></pre>\n\n<p>...inside the <code>Gemfile</code> of your project. And then, to install the library (along with all other dependencies, you can run <code>bundle install</code>.</p>\n\n<p>This is why the next line of the guide talks about running the command: <code>bundle exec jekyll serve ...</code> -- because the author is assuming that you have a project set up.</p>\n\n<p>However, if you just want to install the gem globally (i.e. not within the context of a project), then you don't need to do anything with <code>bundle</code>. Just run:</p>\n\n<pre><code>gem install jekyll\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 11694164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05da4d046c3a43d087a9e6895ba03d8?s=128&d=identicon&r=PG&f=1", "display_name": "iHaveAQuestion", "link": "https://stackoverflow.com/users/11694164/ihaveaquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56743558, "answer_count": 1, "score": 0, "last_activity_date": 1561452830, "creation_date": 1561405817, "last_edit_date": 1561413285, "question_id": 56743072, "link": "https://stackoverflow.com/questions/56743072/going-to-project-folder-before-bundle-install", "title": "Going to project folder before &quot;bundle install&quot;", "body": "<p>I'm trying to install jekyll based on instructions here (via rbenv): <a href=\"https://gist.github.com/r-brown/a0b50d56cfb3596e0d17\" rel=\"nofollow noreferrer\">https://gist.github.com/r-brown/a0b50d56cfb3596e0d17</a></p>\n\n<p>Before the \"bundle install\" step, it states:\ngo to the project folder </p>\n\n<p>However, I'm new and simply truly confused as to what this refers to? I don't actually have a project folder right now, because I am merely in the process of installing jekyll? </p>\n\n<p>Or is that referring to a specific location based on the earlier installation steps?  </p>\n\n<p>I attempted to skip this step and directly input <code>bundle install</code>, but that yielded this error</p>\n\n<blockquote>\n  <p>\"Could not locate Gemfile\". </p>\n</blockquote>\n\n<p>Referring to this post: <a href=\"https://stackoverflow.com/questions/3329953/could-not-locate-gemfile\">Could not locate Gemfile</a> was unfortunately not useful as no one explicitly stated what \"project folder\" entails...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "export-to-csv"], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1561407124, "post_id": 56743350, "comment_id": 100045584, "body": "I don&#39;t think you need <code>headers: true</code> when writing the csv. I tested and you can remove it with no effect. It can be used as an option to <code>CSV.parse</code> to get you back hashes instead of just the arrays of values"}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1561407349, "post_id": 56743350, "comment_id": 100045664, "body": "Yes, you are right, the <code>headers: true</code> is unnecessary. Thanks!"}, {"owner": {"reputation": 87, "user_id": 10711236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l1lM9rG7y6A/AAAAAAAAAAI/AAAAAAAA0BE/Msz6-dL9OkA/photo.jpg?sz=128", "display_name": "Aly Dabbous", "link": "https://stackoverflow.com/users/10711236/aly-dabbous"}, "edited": false, "score": 0, "creation_date": 1561458404, "post_id": 56743350, "comment_id": 100061418, "body": "Thanks alot my friend. @MrShemek"}], "tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": true, "score": 1, "last_activity_date": 1561408031, "last_edit_date": 1561408031, "creation_date": 1561407053, "answer_id": 56743350, "question_id": 56743022, "link": "https://stackoverflow.com/questions/56743022/structuring-csv-in-row-and-column-format-with-rails/56743350#56743350", "title": "structuring csv in row and column format with rails", "body": "<p>First of all - product names. You are fetching too much information from the HTML. The h2 element contains whitespaces and span element inside which probably should be ignored. You can do it like this:</p>\n\n<pre><code>product_names.each do |product_name| \n  name &lt;&lt; product_name.css('h2.product-name a').children[0].text.gsub(/\\s{2,}/, '')\nend\n</code></pre>\n\n<p>Then, CSV requires passing each row as an array with multiple items. In your case, there should be many arrays with two items (product name and price). To do this, you can simply zip two tables:</p>\n\n<pre><code>items = name.zip(price)\n</code></pre>\n\n<p>And then create CSV file:</p>\n\n<pre><code>CSV.open('data/wheyprotein.csv', 'w') do |csv|\n  csv &lt;&lt; headers\n  items.each {|row| csv &lt;&lt; row }\nend\n</code></pre>\n\n<p>The full method looks like this:</p>\n\n<pre><code>def whey_scrapper\n    company = 'Body+%26+fit'\n    url = \"https://www.bodyenfitshop.nl/eiwittenwhey/whey-proteine/?limit=81&amp;manufacturer=#{company}\"\n    unparsed_page = open(url).read\n    parsed_page = Nokogiri::HTML(unparsed_page)\n    product_names = parsed_page.css('div.product-primary')\n    name = Array.new\n    product_names.each do |product_name| \n        name &lt;&lt; product_name.css('h2.product-name a').children[0].text.gsub(/\\s{2,}/, '')\n    end\n    product_prices = parsed_page.css('div.price-box')\n    price = Array.new\n    product_prices.each do |product_price|\n        price &lt;&lt; product_price.css('span.price').text\n    end\n    headers = [\"name\", \"price\"]\n    items = name.zip(price)\n    CSV.open('data/wheyprotein.csv', 'w+') do |csv|\n        csv &lt;&lt; headers\n        items.each {|row| csv &lt;&lt; row }\n    end\nend   \n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10711236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l1lM9rG7y6A/AAAAAAAAAAI/AAAAAAAA0BE/Msz6-dL9OkA/photo.jpg?sz=128", "display_name": "Aly Dabbous", "link": "https://stackoverflow.com/users/10711236/aly-dabbous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 56743350, "answer_count": 1, "score": 0, "last_activity_date": 1561412019, "creation_date": 1561405554, "last_edit_date": 1561412019, "question_id": 56743022, "link": "https://stackoverflow.com/questions/56743022/structuring-csv-in-row-and-column-format-with-rails", "title": "structuring csv in row and column format with rails", "body": "<p>I built a small web scraping application with ruby whereby I scrape data from a website and then store it in a csv file. I'm scraping and storing everything successfully, however I'm unable to structure my csv file in a 'table' format, whereby there are two columns and multiple rows. My csv file should have a name column and a price column, with the name and price of each product item. This is my code: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>require 'open-uri'\r\nrequire 'nokogiri'\r\nrequire 'httparty'\r\nrequire 'byebug'\r\nrequire 'csv'\r\n\r\n    def whey_scrapper\r\n        company = 'Body+%26+fit'\r\n        url = \"https://www.bodyenfitshop.nl/eiwittenwhey/whey-proteine/?limit=81&amp;manufacturer=#{company}\"\r\n        unparsed_page = open(url).read\r\n        parsed_page = Nokogiri::HTML(unparsed_page)\r\n        product_names = parsed_page.css('div.product-primary')\r\n        name = Array.new\r\n        product_names.each do |product_name| \r\n            name &lt;&lt; product_name.css('h2.product-name').text\r\n        end\r\n        product_prices = parsed_page.css('div.price-box')\r\n        price = Array.new\r\n        product_prices.each do |product_price|\r\n            price &lt;&lt; product_price.css('span.price').text\r\n        end\r\n        headers = [\"name\", \"price\"]\r\n        item = [name, price]\r\n        CSV.open('data/wheyprotein.csv', 'w', :col_sep =&gt; \"\\t|\", :headers =&gt; true) do |csv|\r\n            csv &lt;&lt; headers\r\n            item.each {|row| csv &lt;&lt; row }\r\n        end\r\n        byebug\r\n    end   \r\n    whey_scrapper</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I create a row after each item iteration, however the csv file is still very unstructured &amp; messy.</p>\n\n<p>This is how my csv file looks: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>name\t|price\r\n-----------------\r\n\"\r\n                            \r\n                                Whey Perfection                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Perfection\u00ae bestseller box                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Perfection - Special Series                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Isolaat Perfection                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Perfect Protein                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Isolaat XP                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Micellar Casein Perfection                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Low Calorie Meal                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Breakfast                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Perfection - Flavour Box                                 Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Protein Breakfast                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Perfection Summer Box                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Puur Whey                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Isolaat Crispy                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Vegan Protein voordeel                                Body &amp; fit vegan\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Whey Perfection Winter Box                                Body &amp; fit\r\n                            \r\n                        \"\t|\"\r\n                            \r\n                                Sports Breakfast                                Body &amp; fit\r\n                            \r\n                        \"\r\n\u20ac\u00a07,90\t|\u20ac\u00a09,90\t|\u20ac\u00a011,90\t|\u20ac\u00a017,90\t|\u20ac\u00a031,90\t|\u20ac\u00a018,90\t|\u20ac\u00a012,90\t|\u20ac\u00a06,90\t|\u20ac\u00a06,90\t|\u20ac\u00a010,90\t|\u20ac\u00a015,90\t|\u20ac\u00a09,90\t|\u20ac\u00a026,90\t|\u20ac\u00a06,90\t|\u20ac\u00a024,90\t|\u20ac\u00a09,90\t|\u20ac\u00a020,90</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "encryption", "openssl", "aes", "cbc-mode"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561405758, "post_id": 56742924, "comment_id": 100045030, "body": "There&#39;s an extraordinary number of spaces at the end of each line here. A few would be understandable, but there&#39;s in excess of 190!"}, {"owner": {"reputation": 2775, "user_id": 818089, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e7963db0759e839417f172ebf6840a93?s=128&d=identicon&r=PG", "display_name": "content01", "link": "https://stackoverflow.com/users/818089/content01"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1561406060, "post_id": 56742924, "comment_id": 100045145, "body": "@tadman fixed :)"}], "answers": [{"comments": [{"owner": {"reputation": 2775, "user_id": 818089, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e7963db0759e839417f172ebf6840a93?s=128&d=identicon&r=PG", "display_name": "content01", "link": "https://stackoverflow.com/users/818089/content01"}, "edited": false, "score": 0, "creation_date": 1561406102, "post_id": 56743056, "comment_id": 100045166, "body": "But isn&#39;t that the whole point? To rely on the secret/key and not the IV?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 2775, "user_id": 818089, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e7963db0759e839417f172ebf6840a93?s=128&d=identicon&r=PG", "display_name": "content01", "link": "https://stackoverflow.com/users/818089/content01"}, "edited": false, "score": 0, "creation_date": 1561407479, "post_id": 56743056, "comment_id": 100045709, "body": "The key is user defined (e.g. passphrase) but the IV is generated or pre-defined. Both are needed to unlock the content. You can always hard-code a particular IV if you prefer, or randomly generate it and store it with the key. Note that hard-coding an IV may expose you to more risks security-wise, but if the stakes are low it&#39;s not really a big deal. It just makes it easier to guess your passphrase, as with a fixed IV you don&#39;t need to test for all possible IVs."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1561405718, "creation_date": 1561405718, "answer_id": 56743056, "question_id": 56742924, "link": "https://stackoverflow.com/questions/56742924/ruby-openssl-aes128-cbc-decrypting-with-random-iv-not-working/56743056#56743056", "title": "Ruby OPENSSL AES128 CBC decrypting with random iv not working", "body": "<p>You're using a different, random IV on the decryption. This value must be identical. That is you capture it when encrypting:</p>\n\n<pre><code>iv = cipher.random_iv\n</code></pre>\n\n<p>Then you decrypt using that:</p>\n\n<pre><code>cipher.iv = iv\n</code></pre>\n\n<p>Then it decrypts properly. You need the same key + IV pair in order for the decryption to succeed.</p>\n"}], "owner": {"reputation": 2775, "user_id": 818089, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e7963db0759e839417f172ebf6840a93?s=128&d=identicon&r=PG", "display_name": "content01", "link": "https://stackoverflow.com/users/818089/content01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 56743056, "answer_count": 1, "score": 0, "last_activity_date": 1561406047, "creation_date": 1561405103, "last_edit_date": 1561406047, "question_id": 56742924, "link": "https://stackoverflow.com/questions/56742924/ruby-openssl-aes128-cbc-decrypting-with-random-iv-not-working", "title": "Ruby OPENSSL AES128 CBC decrypting with random iv not working", "body": "<p>I'm using a fairly simple encryption/decryption Ruby script, and it seems to work - BUT the decryption bit corrupts the first few bytes of the message. What am I missing?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>key = OpenSSL::Random.random_bytes(16)\nplain_text = \"Some important txt we want to encrypt\"\ncipher = OpenSSL::Cipher::AES128.new(:CBC)\ncipher.encrypt\ncipher.key = key\ncipher.random_iv\ncipher_text = cipher.update(plain_text) + cipher.final\n\ncipher = OpenSSL::Cipher::AES128.new(:CBC)\ncipher.decrypt\ncipher.key = key\ncipher.random_iv\ndecrypted_plain_text = cipher.update(cipher_text) + cipher.final\n\nputs \"AES128 in CBC mode\"\nputs \"Plain text: \" + plain_text\nputs \"Cipher text: \" + urlsafe_encode64(cipher_text)\nputs \"Decrypted plain text: \" + decrypted_plain_text\n</code></pre>\n\n<p>And the outcome:</p>\n\n<pre><code>AES128 in CBC mode Plain text: Some important txt we want to encrypt\nCipher text:\nP2fdC7cApQvxHnfxSEfB2iJaueK3xRoj-NN3bDR8JheL_VPFYTDF_RxpLfBwoRfp\nDecrypted plain text: \ufffd\u0707\ufffd\u03a3 }w\ufffdD\ufffdA:xt we want to encrypt\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "rubygems", "rails-activestorage"], "comments": [{"owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "edited": false, "score": 0, "creation_date": 1561404594, "post_id": 56742748, "comment_id": 100044605, "body": "I also have @user.save in the runFile method"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "edited": false, "score": 0, "creation_date": 1561407065, "post_id": 56743099, "comment_id": 100045556, "body": "there&#39;s a new error now -- I guess maybe :file is empty so is there something wrong with what I did in the views"}, {"owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "reply_to_user": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "edited": false, "score": 0, "creation_date": 1561407168, "post_id": 56743099, "comment_id": 100045597, "body": "@sr1 can you please update your question with the code of the entire form?"}, {"owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "edited": false, "score": 0, "creation_date": 1561409331, "post_id": 56743099, "comment_id": 100046377, "body": "would the runFile_form method call runFile and if not where would it be called? Also would this fix the issue of the new associated file_attachment not saving?"}], "tags": [], "owner": {"reputation": 2285, "user_id": 2039726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fc7ff9bf8f9489ab7715282a9b7e9c?s=128&d=identicon&r=PG", "display_name": "MrShemek", "link": "https://stackoverflow.com/users/2039726/mrshemek"}, "is_accepted": false, "score": 0, "last_activity_date": 1561407986, "last_edit_date": 1561407986, "creation_date": 1561405934, "answer_id": 56743099, "question_id": 56742748, "link": "https://stackoverflow.com/questions/56742748/when-i-do-user-file-attachparamsfile-it-doesnt-save-when-using-active-stor/56743099#56743099", "title": "When I do user.file.attach(params[:file]) it doesn&#39;t save when using active storage", "body": "<p>I think you have mixed a few things. </p>\n\n<p>To display a form, you need a normal link (without <code>method</code>). In your case, it will be <code>runFile</code>. However, <code>runFile</code> is responsible just for displaying the form. You need another method that will handle the action of submitting the form. Similar to <code>edit</code> and <code>update</code> methods.</p>\n\n<p>Here is an idea of how it might look:</p>\n\n<pre><code>def runFile_form\n  # do whatever you need to display the form\nend\n\ndef runFile\n  @user.file.attach(params[:file])\nend\n\ndef user_params\n  params.require(:user).permit(:file)\nend\n</code></pre>\n\n<p>In routes, please define a GET route for <code>runFile_form</code> method and use it on the show page:</p>\n\n<pre><code>&lt;%= link_to \"Run file\", runFile_form_path %&gt;\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561408669, "creation_date": 1561404232, "last_edit_date": 1561408669, "question_id": 56742748, "link": "https://stackoverflow.com/questions/56742748/when-i-do-user-file-attachparamsfile-it-doesnt-save-when-using-active-stor", "title": "When I do user.file.attach(params[:file]) it doesn&#39;t save when using active storage", "body": "<p>I'm getting this error with the line @user.file.attach(params[:file]): </p>\n\n<p>ActiveRecord::RecordNotSaved in UsersController#runFile.\nFailed to save the new associated file_attachment.</p>\n\n<p>I am using active storage to store files.</p>\n\n<p>In my User model I have this code: </p>\n\n<pre><code>has_one_attached :file\n</code></pre>\n\n<p>in my Users Controller,\nI have this code:</p>\n\n<pre><code>def runFile \n```\n  @user.file.attach(params[:file])\n```\nend\n\n```\ndef user_params\n    params.require(:user).permit(:file)\nend\n</code></pre>\n\n<p>in my form in views I have this code:</p>\n\n<pre><code>&lt;%= form_with(model: user, local: true) do |form| %&gt;\n  &lt;% if user.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(user.errors.count, \"error\") %&gt; prohibited \n              this user from being saved:&lt;/h2&gt;\n\n     &lt;ul&gt;\n      &lt;% user.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n   &lt;div class=\"field\"&gt;\n     &lt;%= form.label :file %&gt;\n    &lt;%= form.file_field :file %&gt;\n  &lt;/div&gt;\n &lt;br&gt; \n\n  &lt;h6 class=\"actions\"&gt;\n    &lt;%= form.submit \"Create\" %&gt;\n  &lt;/h6&gt; \n&lt;% end %&gt;\n</code></pre>\n\n<p>This is my show form as for each user you click Run File for the runFile method:</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n    &lt;%= link_to \"Run File\", runFile_path, method: :post %&gt;\n\n\n&lt;%= link_to 'Edit', edit_user_path(@user) %&gt; |\n&lt;%= link_to 'Back', users_path %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "unit-testing", "rspec", "rspec-mocks", "sorbet"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 11694080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0IkNMW4HoMI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf6AvZ2emXvEcqcXIfx6iAqqCysg/mo/photo.jpg?sz=128", "display_name": "Rahil Shah", "link": "https://stackoverflow.com/users/11694080/rahil-shah"}, "edited": false, "score": 0, "creation_date": 1561450064, "post_id": 56743840, "comment_id": 100056896, "body": "Got it! Thanks. I refactored the test code as you suggested and it works fine now."}, {"owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "edited": false, "score": 1, "creation_date": 1564444506, "post_id": 56743840, "comment_id": 101024455, "body": "I&#39;m not convinced this justification is wholly appropriate for RSpec mocks, as (I believe) they have some different properties to mocha. Have created an issue to discuss: <a href=\"https://github.com/rspec/rspec-mocks/issues/1286\" rel=\"nofollow noreferrer\">github.com/rspec/rspec-mocks/issues/1286</a>"}], "tags": [], "owner": {"reputation": 874, "user_id": 1015863, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/82j8j.jpg?s=128&g=1", "display_name": "jez", "link": "https://stackoverflow.com/users/1015863/jez"}, "is_accepted": true, "score": 5, "last_activity_date": 1561409775, "creation_date": 1561409775, "answer_id": 56743840, "question_id": 56742572, "link": "https://stackoverflow.com/questions/56742572/how-to-use-sorbet-type-checking-with-rspec-mocks/56743840#56743840", "title": "How to use sorbet type checking with RSpec mocks?", "body": "<p>Mocha mocks (stub in tests) will not pass any type checks by default. This is deliberate and considered a feature; bare mocks make tests brittle and tend to cause problems when refactoring code, regardless of type checking.</p>\n\n<p>When trying to test a method using a Mocha mock that fails a type check, we recommend rewriting the test to not use Mocha mocks. Either:</p>\n\n<ul>\n<li>Create a genuine instance of the object, and use <code>.stubs</code> to replace only certain methods.</li>\n<li>Write helper functions to create real instances of your objects with fake data.</li>\n</ul>\n\n<p>In the worst case, you can stub <code>is_a?</code> to make a Mocha mock pass a type check, but please avoid doing this. It results in brittle tests and makes code harder to reason about. If you must:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># NOT RECOMMENDED!\n\nfake_llama = stub\nfake_llama.stubs(:llama_count).returns(17)\nfake_llama.stubs(:is_a?).with(M::Llama).returns(true)\n</code></pre>\n\n<p>I'm not familiar with the differences between RSpec's mocks and Mocha's mocks (at Stripe where Sorbet is developed we use Mocha) but the principles should be the same.</p>\n"}, {"comments": [{"owner": {"reputation": 515, "user_id": 2946008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05c09a65a7da49f59996c4b08b7046b3?s=128&d=identicon&r=PG", "display_name": "Allenaz", "link": "https://stackoverflow.com/users/2946008/allenaz"}, "edited": false, "score": 0, "creation_date": 1604922708, "post_id": 56905241, "comment_id": 114485591, "body": "The above is done in this gem: <a href=\"https://github.com/tricycle/rspec-sorbet\" rel=\"nofollow noreferrer\">github.com/tricycle/rspec-sorbet</a>"}], "tags": [], "owner": {"reputation": 81, "user_id": 3186172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/103ee4a1c0b88331695e3f0aac0f5c16?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Jedrychowski", "link": "https://stackoverflow.com/users/3186172/jan-jedrychowski"}, "is_accepted": false, "score": 8, "last_activity_date": 1571097618, "last_edit_date": 1571097618, "creation_date": 1562338019, "answer_id": 56905241, "question_id": 56742572, "link": "https://stackoverflow.com/questions/56742572/how-to-use-sorbet-type-checking-with-rspec-mocks/56905241#56905241", "title": "How to use sorbet type checking with RSpec mocks?", "body": "<p>Solution 1:</p>\n\n<p>Use <code>instance_double</code> with a proper class and mock it's <code>is_a?</code>. To do that globally perform monkey-patching:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'rspec/mocks'\n\nclass RSpec::Mocks::InstanceVerifyingDouble\n  def is_a?(expected)\n    @doubled_module.target &lt;= expected || super\n  end\nend\n</code></pre>\n\n<p>Solution 2:</p>\n\n<p>Selectively, do not raise exception when caused by mocks.\nThis way Sorbet still performs types checks unless a mock is used.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'sorbet-runtime'\n\nRSpec.configure do |config|\n  config.before :each, sorbet: :mocks do\n    T::Configuration.inline_type_error_handler = proc do |error|\n      raise error unless error.message.include? \"got type RSpec::Mocks\"\n    end\n\n    T::Configuration.call_validation_error_handler = proc do |_signature, opts|\n      raise TypeError.new(opts[:pretty_message]) unless opts[:message].include? \"got type RSpec::Mocks\"\n    end\n  end\n\n\n  config.after :each, sorbet: :mocks do\n    T::Configuration.inline_type_error_handler = nil\n    T::Configuration.call_validation_error_handler = nil\n  end\nend\n\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 11694080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0IkNMW4HoMI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf6AvZ2emXvEcqcXIfx6iAqqCysg/mo/photo.jpg?sz=128", "display_name": "Rahil Shah", "link": "https://stackoverflow.com/users/11694080/rahil-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 1, "accepted_answer_id": 56743840, "answer_count": 2, "score": 8, "last_activity_date": 1604683251, "creation_date": 1561403348, "question_id": 56742572, "link": "https://stackoverflow.com/questions/56742572/how-to-use-sorbet-type-checking-with-rspec-mocks", "title": "How to use sorbet type checking with RSpec mocks?", "body": "<p>I have a method that that has a sorbet type signature definition.\nWhile trying to mock this method in tests using RSpec I get a type mismatch error. \nI'm trying to understand how I can resolve this issue and can add RSpec based tests without affecting sorbet type check.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>sig {params(login_context: LoginContext, company_id: String).returns(T::Boolean)}\n  def populate_dummy_data(login_context, company_id)\n</code></pre>\n\n<p>Test Code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@login_context = double(LoginContext, :requester =&gt; @requester) # Creates an instance of type Rspec::Mocks::double\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>expected no Exception, got #&lt;TypeError: Parameter \u2018login_context\u2019: Expected type LoginContext, got type RSpec::Mocks::Double wit...a_populator_spec.rb:42\n</code></pre>\n"}, {"tags": ["ruby", "windows", "jekyll", "bundler"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561408741, "post_id": 56742033, "comment_id": 100046180, "body": "What is <code>another-jekyll-plugin</code>? It <a href=\"https://rubygems.org/search?utf8=%E2%9C%93&amp;query=another-jekyll-plugin\" rel=\"nofollow noreferrer\">does not exist on RubyGems</a>. Is it something you wrote, but forgot to upload? Is it uploaded to a different server, e.g. <code>gemfury</code> or some other private host? Is it a gem which is on your <b>local</b> machine, and you don&#39;t plan to upload it? Either way, that&#39;s what the error says: It does not exist on the one source that&#39;s listed in the <code>Gemfile</code>."}, {"owner": {"reputation": 634, "user_id": 11866885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cbXoH.jpg?s=128&g=1", "display_name": "Austin Johnson", "link": "https://stackoverflow.com/users/11866885/austin-johnson"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561409024, "post_id": 56742033, "comment_id": 100046281, "body": "I followed the tutorial at <a href=\"https://jekyllrb.com/docs/plugins/installation/\" rel=\"nofollow noreferrer\">jekyllrb.com/docs/plugins/installation</a> @TomLord"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561451372, "post_id": 56742033, "comment_id": 100057568, "body": "Right.... Well perhaps one could blame the tutorial for being poorly written, but that&#39;s only been included as an <b>EXAMPLE</b>. <code>jekyll-gist</code>, <code>jekyll-coffeescript</code>, etc are real plugins, but <code>another-jekyll-plugin</code> is not. Perhaps the author of that guide should have done better to make it absolutely crystal clear to &quot;not follow this guide word-for-word, since it includes a fake library name&quot;."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561451498, "post_id": 56742033, "comment_id": 100057624, "body": "In fact, why not click the &quot;Improve this page&quot; <a href=\"https://github.com/jekyll/jekyll/edit/master/docs/_docs/plugins/installation.md\" rel=\"nofollow noreferrer\">link</a> and suggest an edit yourself, which you feel would have made it clearer to you?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 13651810, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MMhBBeYsQ6k/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnKyhzqxXLU-6l-86COqSkCgi2FzQ/photo.jpg?sz=128", "display_name": "Manan Goel", "link": "https://stackoverflow.com/users/13651810/manan-goel"}, "is_accepted": false, "score": 0, "last_activity_date": 1591190251, "creation_date": 1591190251, "answer_id": 62173798, "question_id": 56742033, "link": "https://stackoverflow.com/questions/56742033/could-not-find-gem-another-jekyll-plugin-x64-mingw32-in-any-of-the-gem-sources/62173798#62173798", "title": "Could not find gem &#39;another-jekyll-plugin x64-mingw32&#39; in any of the gem sources", "body": "<p>another-jekyll-plugin means that the plugin which you want use and put its name in place of that.. its not a plugin</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 11175853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3m4IjKcvr10/AAAAAAAAAAI/AAAAAAAADGY/gD_3ZbCgczI/photo.jpg?sz=128", "display_name": "Vikash P", "link": "https://stackoverflow.com/users/11175853/vikash-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1594850845, "last_edit_date": 1594850845, "creation_date": 1594849414, "answer_id": 62924214, "question_id": 56742033, "link": "https://stackoverflow.com/questions/56742033/could-not-find-gem-another-jekyll-plugin-x64-mingw32-in-any-of-the-gem-sources/62924214#62924214", "title": "Could not find gem &#39;another-jekyll-plugin x64-mingw32&#39; in any of the gem sources", "body": "<p>Just do</p>\n<pre class=\"lang-sh prettyprint-override\"><code>gem install jekyll-sitemap\ngem install jekyll-seo-tag\ngem install jekyll-autoprefixer\n\ngem install &lt;any jekyll plugin name here&gt;\n</code></pre>\n<p>and then</p>\n<pre class=\"lang-sh prettyprint-override\"><code>bundle exec jekyll serve\n</code></pre>\n<p>It will fix the issue.</p>\n"}], "owner": {"reputation": 634, "user_id": 11866885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cbXoH.jpg?s=128&g=1", "display_name": "Austin Johnson", "link": "https://stackoverflow.com/users/11866885/austin-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 62924214, "answer_count": 2, "score": 1, "last_activity_date": 1594850845, "creation_date": 1561400724, "question_id": 56742033, "link": "https://stackoverflow.com/questions/56742033/could-not-find-gem-another-jekyll-plugin-x64-mingw32-in-any-of-the-gem-sources", "title": "Could not find gem &#39;another-jekyll-plugin x64-mingw32&#39; in any of the gem sources", "body": "<p>I am trying to use jekyll on windows however when I run </p>\n\n<blockquote>\n  <p>bundle exec jekyll serve</p>\n</blockquote>\n\n<p>I get an error saying </p>\n\n<blockquote>\n  <p>Could not find gem 'rspec (~> 3.4) x64-mingw32' in any of the gem\n  sources listed in your Gemfile or in gems cached in vendor/cache. Run\n  <code>bundle install</code> to install missing gems.</p>\n</blockquote>\n\n<p>Then when I run bundle install I get </p>\n\n<blockquote>\n  <p>Could not find gem 'another-jekyll-plugin x64-mingw32' in any of the\n  gem sources listed in your Gemfile or in gems cached in vendor/cache.</p>\n</blockquote>\n\n<p>here is the bundle env </p>\n\n<h2>Environment</h2>\n\n<pre><code>Bundler       2.0.2\n  Platforms   ruby, x64-mingw32\nRuby          2.5.5p157 (2019-03-15 revision 67260) [x64-mingw32]\n  Full Path   D:/Ruby25-x64/bin/ruby.exe\n  Config Dir  C:/ProgramData\nRubyGems      2.7.6.2\n  Gem Home    D:/Ruby25-x64/lib/ruby/gems/2.5.0\n  Gem Path    C:/Users/austi/.gem/ruby/2.5.0;D:/Ruby25-x64/lib/ruby/gems/2.5.0\n  User Path   C:/Users/austi/.gem/ruby/2.5.0\n  Bin Dir     D:/Ruby25-x64/bin\nTools\n  Git         2.22.0.windows.1\n  RVM         not installed\n  rbenv       not installed\n  chruby      not installed\n</code></pre>\n\n<h2>Bundler Build Metadata</h2>\n\n<pre><code>Built At          2019-06-13\nGit SHA           496bca538\nReleased Version  true\n</code></pre>\n\n<h2>Gemfile</h2>\n\n<h3>Gemfile</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>source 'https://rubygems.org'\n\n# Specify your gem's dependencies in jekyll-admin.gemspec\ngemspec\n\n# Site dependencies\ngem 'jekyll-seo-tag'\ngem 'jekyll-sitemap'\ngem 'rake', '12.3.1'\ngroup :jekyll_plugins do\n    gem \"jekyll-gist\"\n    gem \"jekyll-coffeescript\"\n    gem \"jekyll-assets\"\n    gem \"another-jekyll-plugin\"\n  end\n</code></pre>\n\n<h3>Gemfile.lock</h3>\n\n<pre><code>&lt;No D:/anautics/jekyll-admin/Gemfile.lock found&gt;\n</code></pre>\n\n<h2>Gemspecs</h2>\n\n<h3>jekyll-admin.gemspec</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code># coding: utf-8\nlib = File.expand_path('../lib', __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\nrequire 'jekyll-admin/version'\n\nGem::Specification.new do |spec|\n  spec.name          = \"jekyll-admin\"\n  spec.version       = JekyllAdmin::VERSION\n  spec.authors       = [\"Mert Kahyao\u011flu\", \"GitHub Open Source\"]\n  spec.email         = [\"mertkahyaoglu93@gmail.com\", \"opensource@github.com\"]\n\n  spec.summary       = %q{wp-admin for Jekyll, but better}\n  spec.description   = %q{Jekyll::Admin is a drop in administrative framework for Jekyll sites.}\n  spec.homepage      = \"https://github.com/jekyll/jekyll-admin\"\n  spec.license       = \"MIT\"\n\n  # Prevent pushing this gem to RubyGems.org. To allow pushes either set the 'allowed_push_host'\n  # to allow pushing to a single host or delete this section to allow pushing to any host.\n  if spec.respond_to?(:metadata)\n    spec.metadata['allowed_push_host'] = \"https://rubygems.org\"\n  else\n    raise \"RubyGems 2.0 or newer is required to protect against public gem pushes.\"\n  end\n\n  spec.files         = Dir.glob(\"lib/**/*\").concat(%w(LICENSE README.md))\n  spec.bindir        = \"exe\"\n  spec.executables   = spec.files.grep(%r{^exe/}) { |f| File.basename(f) }\n  spec.require_paths = [\"lib\"]\n\n  spec.add_dependency \"jekyll\", \"~&gt; 3.3\"\n  spec.add_dependency \"sinatra\", \"~&gt; 1.4\"\n  spec.add_dependency \"sinatra-contrib\", \"~&gt; 1.4\"\n  spec.add_dependency \"addressable\", \"~&gt; 2.4\"\n\n  spec.add_development_dependency \"bundler\", \"~&gt; 1.7\"\n  spec.add_development_dependency \"rake\", \"~&gt; 10.0\"\n  spec.add_development_dependency \"rspec\", \"~&gt; 3.4\"\n  spec.add_development_dependency \"rubocop\", \"~&gt; 0.57.2\"\n  spec.add_development_dependency \"sinatra-cross_origin\", \"~&gt; 0.3\"\n  spec.add_development_dependency \"gem-release\", \"~&gt; 0.7\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "sorbet"], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 3171006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7dfc74cd6e3194a22ef6fac2c51f0ae?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/3171006/anton"}, "edited": false, "score": 0, "creation_date": 1561468484, "post_id": 56741987, "comment_id": 100067466, "body": "Thanks! I tried it but nothing happened:  <a href=\"https://user-images.githubusercontent.com/1147484/60101326-3e582a80-9764-11e9-84eb-7f96a6ea2882.jpg\" rel=\"nofollow noreferrer\">user-images.githubusercontent.com/1147484/&hellip;</a>"}, {"owner": {"reputation": 327, "user_id": 714058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4ed657ecc33c96dd02730556fb41e?s=128&d=identicon&r=PG", "display_name": "hdoan", "link": "https://stackoverflow.com/users/714058/hdoan"}, "reply_to_user": {"reputation": 287, "user_id": 3171006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7dfc74cd6e3194a22ef6fac2c51f0ae?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/3171006/anton"}, "edited": false, "score": 0, "creation_date": 1561471784, "post_id": 56741987, "comment_id": 100069665, "body": "It turns out they dropped the support for <code>rbis&#47;</code>. It only works with <code>rbi&#47;</code> folder now."}], "tags": [], "owner": {"reputation": 327, "user_id": 714058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4ed657ecc33c96dd02730556fb41e?s=128&d=identicon&r=PG", "display_name": "hdoan", "link": "https://stackoverflow.com/users/714058/hdoan"}, "is_accepted": true, "score": 1, "last_activity_date": 1561471981, "last_edit_date": 1561471981, "creation_date": 1561400445, "answer_id": 56741987, "question_id": 56741667, "link": "https://stackoverflow.com/questions/56741667/how-to-use-specific-rbi-file-with-tc-command/56741987#56741987", "title": "How to use specific RBI file with tc command", "body": "<p>Use <code>rbi/</code> instead of <code>rbis/</code>. In the latest version of <code>sorbet</code>, they dropped the support for <code>rbis/</code> (Paul Tarjan just updated the documentation yesterday). </p>\n\n<p>Here is a more detailed instructions:\n1. Create a <code>rbi/</code> folder at the gem's root director (sibling of <code>lib/</code> folder)\n2. Put any custom rbi files in there.\n3. Profit! <code>srb tc</code> works automatically.</p>\n"}], "owner": {"reputation": 287, "user_id": 3171006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7dfc74cd6e3194a22ef6fac2c51f0ae?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/3171006/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56741987, "answer_count": 1, "score": 1, "last_activity_date": 1561471981, "creation_date": 1561398888, "question_id": 56741667, "link": "https://stackoverflow.com/questions/56741667/how-to-use-specific-rbi-file-with-tc-command", "title": "How to use specific RBI file with tc command", "body": "<p>I'm playing with sorbet and my gem. I create custom <code>/rbis</code> folder for RBI file and want to use it in <code>srb tc</code> command for checking this library without copying files. Also, I checked the documentation and found nothing. </p>\n\n<p>Any ideas of how I can do it?</p>\n"}, {"tags": ["ruby", "encryption", "openssl", "des"], "answers": [{"tags": [], "owner": {"reputation": 3029, "user_id": 162260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca23228b0e7354ce3f243528b469fcc?s=128&d=identicon&r=PG", "display_name": "i-blis", "link": "https://stackoverflow.com/users/162260/i-blis"}, "is_accepted": false, "score": 1, "last_activity_date": 1561404208, "creation_date": 1561404208, "answer_id": 56742742, "question_id": 56741153, "link": "https://stackoverflow.com/questions/56741153/how-do-i-decrypt-files-that-are-encrypted-using-des-command-in-ruby/56742742#56742742", "title": "How do I decrypt files that are encrypted using des command in Ruby?", "body": "<p>Try switching the mode, from <code>CBC</code> to <code>ECB</code> for instance with <code>OpenSSL::Cipher.new('DES-ECB')</code>. </p>\n\n<p>If you check which ciphers your Ruby installation supports by looking at <code>OpenSSL::Cipher.ciphers</code>, you'll find a list of available modes too.</p>\n"}], "owner": {"reputation": 189, "user_id": 5125027, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10153391766200552/picture?type=large", "display_name": "Steven Kwok", "link": "https://stackoverflow.com/users/5125027/steven-kwok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561404208, "creation_date": 1561396343, "question_id": 56741153, "link": "https://stackoverflow.com/questions/56741153/how-do-i-decrypt-files-that-are-encrypted-using-des-command-in-ruby", "title": "How do I decrypt files that are encrypted using des command in Ruby?", "body": "<p>I need to decrypt files that are encrypted with this command:</p>\n\n<pre><code>des -E -u -k \"some key\" file.in file.out.enc\n</code></pre>\n\n<p>The decryption code in Ruby:</p>\n\n<pre><code>def decrypt(key)\n  cipher = OpenSSL::Cipher.new(\u2018des\u2019).decrypt\n  cipher.key = key\n\n  File.open(\u2018file.out\u2019, \u2018wb\u2019) do |outf|\n    decrypted = cipher.update(File.read(\u2018file.in.enc\u2019)) + cipher.final\n    outf.write(decrypted)\n  end\nend\n</code></pre>\n\n<p>I\u2019m getting wrong final block length error when I run the code above. I also tried decrypting using the openssl command line tool and got a bad magic number error. Any advice?</p>\n"}, {"tags": ["html", "css", "ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561450824, "post_id": 56741193, "comment_id": 100057255, "body": "hi @Douglas thanks so much for your answer! I am trying to have an index page which is like a spreadsheet that has a tick box at the side."}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561563613, "post_id": 56741193, "comment_id": 100108456, "body": "hi @Douglas thank you so much! this is so very helpful - i will have a look now!!!"}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561564219, "post_id": 56741193, "comment_id": 100108822, "body": "hi Douglas, i dont really get this bit here : ``` ScootiesCoupon.transaction do     ScootiesCoupon.where(id: to_valid.keys, validated: false).update_all(       validated:true)     ScootiesCoupon.where(id: to_not_valid.keys, validated: true).update_all(       validated:false)   end```"}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561567784, "post_id": 56741193, "comment_id": 100110526, "body": "This is very helpful to me without having to create a new field as checkbox, thank you! I have a question in regard to the checkbox - when the email is validated it will be stored into db as true and the ticked row will be disabled as it no longer can being ticked?(disabled?) any idea how to implement that on this case?"}, {"owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "reply_to_user": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561573035, "post_id": 56741193, "comment_id": 100112835, "body": "Hi @gina. Thank you for your questions. There&#39;s an edit with explanation about the use of <code>transaction</code>. The question about hiding check boxes under certain circumstances is really a new question. However, you can conditionally render them. Probably you don&#39;t put that business logic in the view, although that&#39;s tempting and easy to do."}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 1, "creation_date": 1561735834, "post_id": 56741193, "comment_id": 100173499, "body": "hi, @Douglas thank you so much for answering!! i was wondering would you mind explaining the codes in the scootiescoupon controller method."}, {"owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "reply_to_user": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561737380, "post_id": 56741193, "comment_id": 100174144, "body": "Thank you for the prompt. The answer now contains further explanation of the controller code rather than hand waving with &quot;pretty straightforward&quot;. Does that help?"}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561737714, "post_id": 56741193, "comment_id": 100174311, "body": "Thank you so much for your prompt answer too! could you please maybe showcase the disabled/hiding checkboxes function for me, please?"}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 1, "creation_date": 1561738583, "post_id": 56741193, "comment_id": 100174639, "body": "or you&#39;d think i should ask a new question fro that? :)"}, {"owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "reply_to_user": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561738627, "post_id": 56741193, "comment_id": 100174655, "body": "Hi @gina. No problem regarding the prompt response. I&#39;m trying to solve a JS packaging issue I have with help from SO and the in-box pulses red. With regard to the disabling, hiding. That feels like another question to me. The answer is already quite long and detailed. Adding an answer around adding this business logic would cause it to be much longer and less focussed. Please pardon me asking for a pass on that one. If you like, consider asking it as a new question."}, {"owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "edited": false, "score": 0, "creation_date": 1561971298, "post_id": 56741193, "comment_id": 100217283, "body": "Hi @Douglas, thank you so much! for some reasons for the question I&#39;ve asked previously doesn&#39;t allow me to ask question lately- could you have a look of this link? thx <a href=\"https://stackoverflow.com/questions/56832650/how-to-disable-checkbox-on-condition\" title=\"how to disable checkbox on condition\">stackoverflow.com/questions/56832650/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "is_accepted": false, "score": 0, "last_activity_date": 1561737605, "last_edit_date": 1561737605, "creation_date": 1561396519, "answer_id": 56741193, "question_id": 56740524, "link": "https://stackoverflow.com/questions/56740524/how-to-build-a-tick-box-with-rails-on-view-index/56741193#56741193", "title": "how to build a tick box with rails on view/index", "body": "<p>Thank you for your question. It is in fact not so simple to do. You want to edit (one attribute from) multiple records in one form.</p>\n\n<p>With a little poking, I came up with the following:</p>\n\n<p>In <code>app/views/scooties_coupons/index.html.erb</code>:</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;h1&gt;Scooties Coupons&lt;/h1&gt;\n\n&lt;%= form_with(url: validate_coupons_path, method: 'patch') do |f| %&gt;\n  &lt;table&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;Valid&lt;/th&gt;\n        &lt;th&gt;Coupon&lt;/th&gt;\n        &lt;th&gt;Redeemed&lt;/th&gt;\n        &lt;th&gt;First name&lt;/th&gt;\n        &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n      &lt;% @scooties_coupons.each do |scooties_coupon| %&gt;\n        &lt;tr&gt;\n          &lt;td&gt;\n            &lt;%= fields_for('scooties_coupons[]', scooties_coupon) do |cf|\n              cf.check_box(:validated)\n            end %&gt;\n          &lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.coupon %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.redeemed %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.first_name %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= link_to 'Show', scooties_coupon %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= link_to 'Edit', edit_scooties_coupon_path(scooties_coupon) %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= link_to 'Destroy', scooties_coupon, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n\n&lt;br&gt;\n\n&lt;%= link_to 'New Scooties Coupon', new_scooties_coupon_path %&gt;\n</code></pre>\n\n<p>Contains a few tricks:</p>\n\n<ul>\n<li>The <code>form_with(url: validate_coupons_path, method: 'patch')</code> sets-up a patch message to the server on submit.</li>\n<li>The </li>\n</ul>\n\n<pre><code>fields_for('scooties_coupons[]', scooties_coupon) do |cf|\n  cf.check_box(:validated)\nend\n</code></pre>\n\n<p>sets-up a check box for an entry. When you check the output HTML you find two fields as follows:</p>\n\n<pre><code>&lt;input name=\"scooties_coupons[1][validated]\" type=\"hidden\" value=\"0\"&gt;\n&lt;input type=\"checkbox\" value=\"1\" checked=\"checked\"\n name=\"scooties_coupons[1][validated]\"\n id=\"scooties_coupons_1_validated\"&gt;\n</code></pre>\n\n<ul>\n<li>The <code>&lt;%= f.submit %&gt;</code> submit button</li>\n</ul>\n\n<p>In <code>app/controllers/scotties_coupons_controller.rb</code>:</p>\n\n<pre><code>def set_valid_coupons\n  to_valid = params[:scooties_coupons].select do |id, attrs|\n    attrs[:validated] == '1'\n  end\n  to_not_valid = params[:scooties_coupons].reject do |id, attrs|\n    attrs[:validated] == '1'\n  end\n  ScootiesCoupon.transaction do\n    ScootiesCoupon.where(id: to_valid.keys, validated: false).update_all(\n      validated:true)\n    ScootiesCoupon.where(id: to_not_valid.keys, validated: true).update_all(\n      validated:false)\n  end\n  redirect_to action: :index, notice: 'Validations updated'\nend\n</code></pre>\n\n<p>is a scraping of the params to make two updates that set and clear the <code>validated</code> flags on the records such that they correspond to what was patched.</p>\n\n<p>First, <code>to_valid</code> contains a selection of the params that have the <code>validated</code> check box checked.</p>\n\n<p>Next, <code>to_not_valid</code> contains a selection of the params that do not have the <code>validated</code> box checked. When the <code>validated</code> attribute has value, \"1\" it is checked. This code treats any other value as <em>not</em> checked.</p>\n\n<p>The <code>ScootiesCoupon.transaction do</code> block makes the two\nupdates that it contains virtually atomic in the sense that, if the second fails, ActiveRecord will roll back the first.</p>\n\n<p>The first update selects records that both have:</p>\n\n<ul>\n<li>a key matching the ones with the <code>validated</code> box checked</li>\n<li>a current value of validated as <code>false</code></li>\n</ul>\n\n<p>It updates those records to value of validated as <code>true</code></p>\n\n<p>The second update selects records that both have:</p>\n\n<ul>\n<li>a key matching the ones with the <code>validated</code> box not checked</li>\n<li>a current value of validated as <code>true</code></li>\n</ul>\n\n<p>It updates those records to value of validated as <code>false</code></p>\n\n<p>By only updating records that need changing, that don't already match the values of the check boxes, the code avoids updating every record in the table. In truth, however, if there are that many records in the table, the index view is going to become quite unwieldy. With hundreds or thousands of coupons there will be quite a bit of rendering for the browser and scrolling for the person administering validations. That is a different problem and different question.</p>\n\n<p>In <code>config/routes.rb</code>:</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :scooties_coupons\n  patch 'validate_coupons', to: 'scooties_coupons#set_valid_coupons'\nend\n</code></pre>\n\n<p>adds the controller action for patching up the records.</p>\n\n<p>The index displays as, for example:\n<a href=\"https://i.stack.imgur.com/D0CkN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D0CkN.png\" alt=\"Scooties Coupons index form screen shot\"></a></p>\n\n<p>On submit, the server console outputs:</p>\n\n<pre><code>Started PATCH \"/validate_coupons\" for ::1 at 2019-06-25 17:12:58 -0300\nProcessing by ScootiesCouponsController#set_valid_coupons as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"6Rk...rA==\",\n   \"scooties_coupons\"=&gt;{\n     \"1\"=&gt;{\"validated\"=&gt;\"1\"}, \"2\"=&gt;{\"validated\"=&gt;\"0\"},\n     \"3\"=&gt;{\"validated\"=&gt;\"0\"}, \"4\"=&gt;{\"validated\"=&gt;\"1\"}\n  }, \"commit\"=&gt;\"Save \"}\n   (0.1ms)  begin transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:60\n  ScootiesCoupon Update All (0.4ms)  UPDATE \"scooties_coupons\"\n SET \"validated\" = 1\n WHERE \"scooties_coupons\".\"id\" IN (?, ?)\n AND \"scooties_coupons\".\"validated\" = ?\n  [[\"id\", 1], [\"id\", 4], [\"validated\", 0]]\n  \u21b3 app/controllers/scooties_coupons_controller.rb:61\n  ScootiesCoupon Update All (0.2ms)  UPDATE \"scooties_coupons\"\n SET \"validated\" = 0\n WHERE \"scooties_coupons\".\"id\" IN (?, ?)\n AND \"scooties_coupons\".\"validated\" = ?\n  [[\"id\", 2], [\"id\", 3], [\"validated\", 1]]\n  \u21b3 app/controllers/scooties_coupons_controller.rb:63\n   (0.1ms)  commit transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:60\nRedirected to http://localhost:3000/scooties_coupons?notice=Validations+updated\nCompleted 200 OK in 5ms (ActiveRecord: 0.7ms)\n</code></pre>\n\n<p>There are other tricks to get the record to update when the box is checked or unchecked, without the submit, via AJAX; however, starting with a submitted form gets most of the way there without that complication. The AJAX way is quite a bit of a complication, I'm afraid.</p>\n\n<p>Find:</p>\n\n<ul>\n<li>Rails API 5.2.3 documentation for <code>check_box</code> at <a href=\"https://api.rubyonrails.org/v5.2.3/classes/ActionView/Helpers/FormBuilder.html#method-i-check_box\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/v5.2.3/classes/ActionView/Helpers/FormBuilder.html#method-i-check_box</a></li>\n<li>Rails 5.2 guidance about dealing with forms in Rails at <a href=\"https://guides.rubyonrails.org/v5.2/form_helpers.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/v5.2/form_helpers.html</a></li>\n</ul>\n\n<p>These haven't changed much in a very long time; so are likely relevant.</p>\n\n<p>As an aside, the following implementation of the controller method might look tempting:</p>\n\n<pre><code>def set_valid_coupons\n  update_params = {}\n  params.require(:scooties_coupons).each do |id, attrs|\n    update_params[id] = attrs.permit(:validated)\n  end\n  if (ScootiesCoupon.update(update_params.keys, update_params.values))\n    redirect_to action: :index, notice: 'Validations updated'\n  else\n    redirect_to action: :index, alert: 'Updates failed'\n  end\nend\n</code></pre>\n\n<p>However note that causes several commands to the database <em>per record</em>, as follows:</p>\n\n<pre><code>Started PATCH \"/validate_coupons\" for 127.0.0.1 at 2019-06-25 15:33:29 -0300\nProcessing by ScootiesCouponsController#set_valid_coupons as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"2Ecnb8Sy/5L4m9wW+4QlSS5WXQTCUh92ALRcv9w69OGRiov/Z95ReX9tGBn7UNN/NXSl83PeKs8cIkLaGhAoDg==\", \"scooties_coupons\"=&gt;{\"1\"=&gt;{\"validated\"=&gt;\"1\"}, \"2\"=&gt;{\"validated\"=&gt;\"0\"}, \"3\"=&gt;{\"validated\"=&gt;\"0\"}, \"4\"=&gt;{\"validated\"=&gt;\"0\"}}, \"commit\"=&gt;\"Save \"}\n  ScootiesCoupon Load (0.2ms)  SELECT  \"scooties_coupons\".* FROM \"scooties_coupons\" WHERE \"scooties_coupons\".\"id\" = ? LIMIT ?  [[\"id\", 1], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n  ScootiesCoupon Load (0.1ms)  SELECT  \"scooties_coupons\".* FROM \"scooties_coupons\" WHERE \"scooties_coupons\".\"id\" = ? LIMIT ?  [[\"id\", 2], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n  ScootiesCoupon Load (0.1ms)  SELECT  \"scooties_coupons\".* FROM \"scooties_coupons\" WHERE \"scooties_coupons\".\"id\" = ? LIMIT ?  [[\"id\", 3], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n  ScootiesCoupon Load (0.1ms)  SELECT  \"scooties_coupons\".* FROM \"scooties_coupons\" WHERE \"scooties_coupons\".\"id\" = ? LIMIT ?  [[\"id\", 4], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  begin transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  commit transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  begin transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  commit transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  begin transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  commit transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  begin transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\n   (0.0ms)  commit transaction\n  \u21b3 app/controllers/scooties_coupons_controller.rb:48\nRedirected to http://localhost:3000/scooties_coupons?notice=Validations+updated\nCompleted 200 OK in 15ms (ActiveRecord: 1.0ms)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11406245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fc1b844539d3afeb0d3afa7d35c912?s=128&d=identicon&r=PG&f=1", "display_name": "gina", "link": "https://stackoverflow.com/users/11406245/gina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561737605, "creation_date": 1561393238, "question_id": 56740524, "link": "https://stackoverflow.com/questions/56740524/how-to-build-a-tick-box-with-rails-on-view-index", "title": "how to build a tick box with rails on view/index", "body": "<p>I am trying to build a tick box section with rails on view/index,these are all the steps I've taken so far i know that i need to do something about routes.rb, can you help?</p>\n\n<p>this is the view:</p>\n\n<pre><code>&lt;table class=\"table table-hover\"&gt;\n      &lt;thead&gt;\n        &lt;tr&gt;\n          &lt;th&gt;Coupon&lt;/th&gt;\n          &lt;th&gt;first_name&lt;/th&gt;\n          &lt;th&gt;surname&lt;/th&gt;\n          &lt;th&gt;email&lt;/th&gt;\n          &lt;th&gt;occupation&lt;/th&gt;\n          &lt;th&gt;validation&lt;/th&gt;\n        &lt;/tr&gt;\n      &lt;/thead&gt;\n    &lt;tbody&gt;\n      &lt;% @scooties_coupons.each do |scooties_coupon| %&gt;\n        &lt;tr&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.coupon %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.first_name %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.surname %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.email %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.occupation %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= link_to \"Mark as Valid\", method: :patch %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n    &lt;/table&gt;\n\n</code></pre>\n\n<p>(i know to mark as valid should use link to but i am not too sure where to link to)</p>\n\n<pre><code> create_table \"scooties_coupons\", force: :cascade do |t|\n    t.string \"coupon\"\n    t.boolean \"redeemed\", default: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"email\"\n    t.integer \"expires_in\"\n    t.string \"first_name\"\n    t.string \"surname\"\n    t.string \"oppcupation\"\n    t.string \"occupation\"\n    t.boolean \"validated\"\n    t.index [\"coupon\"], name: \"index_scooties_coupons_on_coupon\"\n  end\n</code></pre>\n\n<p>(I've also created the validated as boolean in the db)</p>\n\n<p>this is the controller:</p>\n\n<pre><code>def update\n\n     @scooties_coupon = ScootiesCoupon.find(scooties_coupon_params)\n     @scooties_coupon.update( scooties_coupon_params\n    redirect_to scooties_coupons_new_path\n\n  end\n\n\n  def scooties_coupon_params\n    params.require(:scooties_coupon).permit(:first_name, :surname, :email, :occupation)\n\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1561392673, "post_id": 56740261, "comment_id": 100039569, "body": "You tagged your question with [ruby-on-rails]. Are you trying to do this in a Ruby on Rails model class?"}, {"owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "reply_to_user": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1561392903, "post_id": 56740261, "comment_id": 100039682, "body": "No just into my controller to access to external values like params[:something]"}, {"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1561393029, "post_id": 56740261, "comment_id": 100039732, "body": "I&#39;m not sure to understand. Can you update your question with what you are actually trying to do? I think we&#39;re facing a case of <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">XY problem</a> here."}], "answers": [{"comments": [{"owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "reply_to_user": {"reputation": 830, "user_id": 5136200, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gBAqD.jpg?s=128&g=1", "display_name": "Archer", "link": "https://stackoverflow.com/users/5136200/archer"}, "edited": false, "score": 0, "creation_date": 1561399230, "post_id": 56740522, "comment_id": 100042456, "body": "@Archer do you mean &quot;#{@parameter}&quot; ?"}, {"owner": {"reputation": 830, "user_id": 5136200, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gBAqD.jpg?s=128&g=1", "display_name": "Archer", "link": "https://stackoverflow.com/users/5136200/archer"}, "edited": false, "score": 0, "creation_date": 1561401318, "post_id": 56740522, "comment_id": 100043300, "body": "Due to typo... This version is also possible: User.update(&quot;#{@parameter}&quot;: &quot;new name here&quot;)"}], "tags": [], "owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "is_accepted": true, "score": 1, "last_activity_date": 1561393449, "last_edit_date": 1561393449, "creation_date": 1561393217, "answer_id": 56740522, "question_id": 56740261, "link": "https://stackoverflow.com/questions/56740261/update-params-with-passed-value/56740522#56740522", "title": "Update params with passed value", "body": "<p>You can only use the <code>{ x: foo }</code> hash syntax when the keys are literals in the source code (like <code>:x</code> in that example). If you want to use the value of a variable as the key to a hash you have to use the old style hashrocket syntax like this: </p>\n\n<pre><code>  User.update(@parameter =&gt; \"new name here\")\n</code></pre>\n\n<p>(That's not strictly the only way to do it, see this answer for more: <a href=\"https://stackoverflow.com/questions/21440745/creating-a-hash-key-from-a-variable-in-ruby\">Creating a hash key from a variable in Ruby?</a>)</p>\n"}], "owner": {"reputation": 487, "user_id": 7847797, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-k7pSuJNJeV4/AAAAAAAAAAI/AAAAAAAAApY/6cIE0jxiCM8/photo.jpg?sz=128", "display_name": "jacques Mesnet", "link": "https://stackoverflow.com/users/7847797/jacques-mesnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56740522, "answer_count": 1, "score": 1, "last_activity_date": 1561393449, "creation_date": 1561392106, "last_edit_date": 1561392638, "question_id": 56740261, "link": "https://stackoverflow.com/questions/56740261/update-params-with-passed-value", "title": "Update params with passed value", "body": "<p>I would like to create a generic method to update certain params of my model.</p>\n\n<p>Example:</p>\n\n<pre><code>@parameter = \"name\"\n\nUser.update(@parameter: \"new name here\")\n</code></pre>\n\n<p>So here I would like to update the column \"name\" with the value \"new name here\". But this method isn't working. Any Idea of how I should do it?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-lambda", "aws-media-convert"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1561392287, "post_id": 56739919, "comment_id": 100039408, "body": "<code>uninitialized constant Aws::MediaConvert</code> is telling you that the class you&#39;re calling has not been defined in the ruby script where you&#39;re calling it.  You need to require it before you reach this point, normally at the top of your <code>.rb</code> file."}, {"owner": {"reputation": 171, "user_id": 10034431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPDRY.jpg?s=128&g=1", "display_name": "Ivan Raszl", "link": "https://stackoverflow.com/users/10034431/ivan-raszl"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561425013, "post_id": 56739919, "comment_id": 100049848, "body": "Yes. Thank you! I had require &#39;aws-sdk-s3&#39;, which I thought includes &#39;aws-sdk-mediaconvert&#39;, but it seems it doesn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1561397209, "last_edit_date": 1561397209, "creation_date": 1561396225, "answer_id": 56741128, "question_id": 56739919, "link": "https://stackoverflow.com/questions/56739919/how-to-initiate-a-media-conversion-with-ruby-in-aws-lambda/56741128#56741128", "title": "How to initiate a Media Conversion with Ruby in AWS Lambda?", "body": "<p>You need to install <code>aws-sdk-mediaconvert</code> gem. Add this to Gemfile:</p>\n\n<pre><code>gem 'aws-sdk-mediaconvert'\n</code></pre>\n\n<p>and run </p>\n\n<pre><code>bundle\n</code></pre>\n\n<p>If you still getting this error require it at the top of your MediaConvert job:</p>\n\n<pre><code>require 'aws-sdk-mediaconvert'\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 10034431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPDRY.jpg?s=128&g=1", "display_name": "Ivan Raszl", "link": "https://stackoverflow.com/users/10034431/ivan-raszl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 56741128, "answer_count": 1, "score": 1, "last_activity_date": 1561397209, "creation_date": 1561390733, "question_id": 56739919, "link": "https://stackoverflow.com/questions/56739919/how-to-initiate-a-media-conversion-with-ruby-in-aws-lambda", "title": "How to initiate a Media Conversion with Ruby in AWS Lambda?", "body": "<p>I'm trying to start a MediaConvert job with Ruby in AWS Lambda after a file has been uploaded to a bucket. The event kicks off fine, but I'm having trouble initiating the job.</p>\n\n<p>I was trying to follow instructions from here to initiate the client: <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/MediaConvert/Client.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdkforruby/api/Aws/MediaConvert/Client.html</a></p>\n\n<p>And from here to kick off the job:\n<a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/MediaConvert/Client.html#create_job-instance_method\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/MediaConvert/Client.html#create_job-instance_method</a></p>\n\n<pre><code># Event to kick off the media conversion: file uploaded to a bucket\nsourceS3Bucket = event['Records'][0]['s3']['bucket']['name']\nsourceS3Key = event['Records'][0]['s3']['object']['key']\nsourceS3 = 's3://'+ sourceS3Bucket + '/' + sourceS3Key\njobMetadata['input'] = sourceS3\n\n# Loading the MediaConvert settings\njson_from_file = File.read('job.json')\njobSettings = JSON.parse(json_from_file)\n\n# Initiating a client\nclient = Aws::MediaConvert::Client.new(\n  access_key_id: ENV['ACCESS_KEY_ID'],\n  secret_access_key: ENV['SECRET_ACCESS_KEY']\n)\n\n# Kicking off a job\nresponse = client.create_job({\n  Role: ENV['MediaConvertRole'],\n  UserMetadata: jobMetadata,\n  Settings: jobSettings\n})\n</code></pre>\n\n<p>I'm getting this error:</p>\n\n<pre><code>Critical exception from handler\n{\n  \"errorMessage\": \"uninitialized constant Aws::MediaConvert\",\n  \"errorType\": \"Function&lt;NameError&gt;\",\n  \"stackTrace\": [\n    \"/var/task/convert.rb:38:in `rescue in call'\",\n    \"/var/task/convert.rb:6:in `call'\"\n  ]\n}\n</code></pre>\n\n<p>I'm unsure why the function is failing, do you have any clues please?</p>\n"}, {"tags": ["ruby", "memoization"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561392762, "post_id": 56739837, "comment_id": 100039614, "body": "Do you want to flush the whole cache for all objects, or for one object? I&#39;m not sure the former is possible."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1561397146, "post_id": 56739837, "comment_id": 100041551, "body": "Did you see the <a href=\"https://github.com/matthewrudy/memoist#reload\" rel=\"nofollow noreferrer\">&#39;Reload&#39; section of the readme</a>?"}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1561414366, "post_id": 56739837, "comment_id": 100047888, "body": "i want to globally nuke"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561390375, "creation_date": 1561390375, "question_id": 56739837, "link": "https://stackoverflow.com/questions/56739837/how-clear-memoist-cache", "title": "How clear memoist cache?", "body": "<p>How do you clear the temporary memory (cache) of <a href=\"https://github.com/matthewrudy/memoist\" rel=\"nofollow noreferrer\">memoist</a>  ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "require"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561387998, "post_id": 56739093, "comment_id": 100037082, "body": "Where does that code come from?"}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561388518, "post_id": 56739093, "comment_id": 100037392, "body": "a private repo for a website based on rails"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1561388662, "post_id": 56739093, "comment_id": 100037477, "body": "Maybe the required code expects <code>Canonicalizer</code> or the methods within it to be defined. Have you checked the source code or tried moving <code>require</code> to the top?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1561391523, "post_id": 56739093, "comment_id": 100039038, "body": "One can only speculate. Maybe its location was necessary to avoid a conflict in the module definition, or possibly the opposite: to tell the reader that the module definition does not depend on what is being required. Maybe it was to delay its execution until needed. Most of us are used to putting <code>require</code> statements near the top of a file, but might it be better practice to put each one immediately before the first block of code where it is needed?"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 5, "last_activity_date": 1561388601, "creation_date": 1561388601, "answer_id": 56739372, "question_id": 56739093, "link": "https://stackoverflow.com/questions/56739093/why-put-require-statement-at-the-end-of-a-ruby-file/56739372#56739372", "title": "Why put require statement at the end of a ruby file?", "body": "<p>Ruby code is not compiled, it\u2019s being processed [mostly] as it comes to the parser. That said, the following two pieces of code are not equivalent:</p>\n\n<pre><code>class Foo; def foo; :first; end; end\nclass Foo; def foo; :second; end; end\nFoo.new.foo #\u21d2 :second\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>class Foo; def foo; :second; end; end\nclass Foo; def foo; :first; end; end\nFoo.new.foo #\u21d2 :first\n</code></pre>\n\n<p>Also, <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-require\" rel=\"noreferrer\"><code>Kernel#require</code></a> is a regular function defined on <code>Kernel</code> module. I could think of <code>'canonicalizer/hub_page_canonical'</code> file depends on <code>Canonicalizer</code> module (e. g. it contains the definition of the class that <code>include Canonicalizer</code>.) For that to be possible, the included module must be declared upfront, hence <code>require</code> comes after its definition.</p>\n"}, {"tags": [], "owner": {"reputation": 4711, "user_id": 6193, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/10ce9da6cc20b28b25052b88ed5d4d6e?s=128&d=identicon&r=PG", "display_name": "Joe Cannatti", "link": "https://stackoverflow.com/users/6193/joe-cannatti"}, "is_accepted": false, "score": 0, "last_activity_date": 1561402852, "last_edit_date": 1561402852, "creation_date": 1561388854, "answer_id": 56739432, "question_id": 56739093, "link": "https://stackoverflow.com/questions/56739093/why-put-require-statement-at-the-end-of-a-ruby-file/56739432#56739432", "title": "Why put require statement at the end of a ruby file?", "body": "<p>One possible reason is that that there is something happening when the library is required via <code>require 'canonicalizer/hub_page_canonical'</code> that acts differently if those methods aren't defined on <code>module Canonicalizer</code>.</p>\n\n<p>Could be metaprogramming of some type or just that those methods are called at code load time.</p>\n\n<p>Ruby is a language where code can run both at load time and run time.</p>\n"}, {"tags": [], "owner": {"reputation": 1602, "user_id": 880498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd8a4259431a73e23a5b860196694a0?s=128&d=identicon&r=PG", "display_name": "rogercampos", "link": "https://stackoverflow.com/users/880498/rogercampos"}, "is_accepted": false, "score": 0, "last_activity_date": 1561485691, "creation_date": 1561485691, "answer_id": 56759687, "question_id": 56739093, "link": "https://stackoverflow.com/questions/56739093/why-put-require-statement-at-the-end-of-a-ruby-file/56759687#56759687", "title": "Why put require statement at the end of a ruby file?", "body": "<p>It's strange to see a <code>require</code> in a rails app, that shouldn't be there. That being said, a reason I had to do this was to avoid an infinite loop, when one file required the other in order to resolve their constants (via rails autoloader).</p>\n\n<p>My suggestion would be to forget about this, remove all <code>require</code>s you see and use standard autoload via convention of files and folder names.</p>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1561485691, "creation_date": 1561387680, "question_id": 56739093, "link": "https://stackoverflow.com/questions/56739093/why-put-require-statement-at-the-end-of-a-ruby-file", "title": "Why put require statement at the end of a ruby file?", "body": "<p>I saw this in my newly inherited ruby/rails project,\nand was wondering:</p>\n\n<pre><code>module Canonicalizer\n  # Redirects the client to the canonical url\n  #\n  # @return [undefined]\n  #\n  # @api private\n  def redirect_to_canonical_url\n    if request.get? &amp;&amp; !canonical_url?\n      redirect_to canonical_url, status: :moved_permanently\n      false\n    else\n      true\n    end\n  end\n\n  # Test if the current request URL is canonical\n  #\n  # @return [Boolean]\n  #\n  # @api private\n  def canonical_url?\n    request.path == canonical_url\n  end\n\nend\n\nrequire 'canonicalizer/hub_page_canonical'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561394665, "post_id": 56739056, "comment_id": 100040525, "body": "If you want to call a variable that&#39;s defined inside one method from inside another method, you need to define it as an instance variable so <code>@parsed_page = Nokogiri::HTML(unparsed_page)</code> then you can call <code>@parsed_page</code> inside other methods."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1561395602, "post_id": 56739056, "comment_id": 100040920, "body": "Tip: Consider <code>[ ]</code> instead of <code>Array.new</code> unless you&#39;re adding arguments like <code>Array.new(size)</code> or <code>Array.new(size, default)</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561395714, "post_id": 56739056, "comment_id": 100040970, "body": "Remember that <a href=\"https://ruby-doc.org/core-2.6.0.preview3/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> is the tool you want here. It can quickly convert one array to another of the same size, avoiding the array initialization, and manual appending."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561395990, "post_id": 56739056, "comment_id": 100041102, "body": "It&#39;s also spelled &quot;<a href=\"https://www.dictionary.com/browse/scraper\" rel=\"nofollow noreferrer\">scraper</a>&quot; not &quot;<a href=\"https://www.dictionary.com/browse/scrapper\" rel=\"nofollow noreferrer\">scrapper</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10711236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l1lM9rG7y6A/AAAAAAAAAAI/AAAAAAAA0BE/Msz6-dL9OkA/photo.jpg?sz=128", "display_name": "Aly Dabbous", "link": "https://stackoverflow.com/users/10711236/aly-dabbous"}, "edited": false, "score": 0, "creation_date": 1561570606, "post_id": 56740991, "comment_id": 100111803, "body": "hey @lacostenycoder I did as you told me. But unfortunately the methods are not working as they should. It&#39;s simply not storing the data correctly in the csv. This is my code: <a href=\"https://codeshare.io/anMOv3\" rel=\"nofollow noreferrer\">codeshare.io/anMOv3</a>"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1561395454, "creation_date": 1561395454, "answer_id": 56740991, "question_id": 56739056, "link": "https://stackoverflow.com/questions/56739056/nameerror-exception-undefined-local-variable-or-method-products-for-wheyscrap/56740991#56740991", "title": "NameError Exception: undefined local variable or method `products&#39; for Wheyscrapper:Class", "body": "<p>This should be refactored in a better way but this should at least work without refactor, based on my comments above</p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\nrequire 'httparty'\nrequire 'csv'\n\nclass Wheyscrapper\n  def whey_scrapper\n    company = 'Body+%26+fit'\n    url = \"https://www.bodyenfitshop.nl/afslanken/afslank-toppers/?manufacturer=#{company}\"\n    unparsed_page = open(url).read\n    @parsed_page = Nokogiri::HTML(unparsed_page)\n    product_scrapper\n    prices_scrapper\n    # csv = CSV.open('wheyprotein.csv', 'wb')\n  end\n\n\n  def product_scrapper\n    @products = Array.new\n    product_names = @parsed_page.css('div.product-primary')\n    product_names.each do |product_name|\n      product = {\n        name: product_name.css('h2.product-name').text\n      }\n      @products &lt;&lt; product\n    end\n  end\n\n  def prices_scrapper\n    @prices = Array.new\n    @product_prices = @parsed_page.css('div.price-box')\n    @product_prices.each do |product_price|\n      price = {\n        amount: product_price.css('span.price').text\n      }\n      @prices &lt;&lt; price\n    end\n  end\nend\n\nw = Wheyscrapper.new.whey_scrapper\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1561397325, "creation_date": 1561397325, "answer_id": 56741357, "question_id": 56739056, "link": "https://stackoverflow.com/questions/56739056/nameerror-exception-undefined-local-variable-or-method-products-for-wheyscrap/56741357#56741357", "title": "NameError Exception: undefined local variable or method `products&#39; for Wheyscrapper:Class", "body": "<p>There's a lot going on here, but to make it more Ruby you'd consider making those <em>lazy-initialized</em> and giving them names that reflect that:</p>\n\n<pre><code>class Wheyscrapper\n  URL = \"https://www.bodyenfitshop.nl/afslanken/afslank-toppers/?%s\"\n\n  def initialize(company:)\n    @company = company\n    # Use encode_www_form to encode query-string parameters\n    @url = URL % URI.encode_www_form(manufacturer: company)\n  end\n\n  def document\n    # Lazy-initialize a parsd version of the page\n    @document ||= Nokogiri::HTML(open(url).read)\n  end\n\n  def products\n    document.css('div.product-primary').map do |product_name| \n      {\n        name: product_name.css('h2.product-name').text\n      }\n    end\n  end\n\n  def prices\n    document.css('div.price-box').map do |product_price|\n      {\n        amount: product_price.css('span.price').text\n      }\n    end\n  end\nend\n</code></pre>\n\n<p>This fixes a lot of the data propagation problems you had in your original. When you declare a variable it's a <em>local</em> variable, meaning it doesn't exist outside of that particular call of that particular method. If you want to persist it for longer you need to use <em>instance variables</em>, as in <code>@products</code>, or you need to define methods that return the data you need.</p>\n\n<p>The above approach combines that, using a lazy-initialized instance variable to persist the parsed document, and exposes that as a method the other methods can use.</p>\n\n<p>Now you can spin this up:</p>\n\n<pre><code>scraper = WheyScraper.new(company: \"Body &amp; Fit\")\n</code></pre>\n\n<p>Where that should enable everything to be available directly:</p>\n\n<pre><code>scraper.prices\nscraper.products\n</code></pre>\n\n<p>When you learn how to use Ruby effectively you'll often find solutions to your problems that are really minimal. Usually a lot of Ruby code is a sign that it's not being used properly.</p>\n"}], "owner": {"reputation": 87, "user_id": 10711236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l1lM9rG7y6A/AAAAAAAAAAI/AAAAAAAA0BE/Msz6-dL9OkA/photo.jpg?sz=128", "display_name": "Aly Dabbous", "link": "https://stackoverflow.com/users/10711236/aly-dabbous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561397325, "creation_date": 1561387547, "last_edit_date": 1561395557, "question_id": 56739056, "link": "https://stackoverflow.com/questions/56739056/nameerror-exception-undefined-local-variable-or-method-products-for-wheyscrap", "title": "NameError Exception: undefined local variable or method `products&#39; for Wheyscrapper:Class", "body": "<p>I'm building a small web scraper using Ruby and now I'm trying to refactor my code. Unfortunately, I'm encountering some errors while I'm refactoring my code. This is one of the errors. </p>\n\n<p>Basically, I'm calling two separate methods in the first method which is whey_scrapper. Each of these two methods are basically responsible of scraping a specific item on the webpage. When I run and debug this code with byebug, I basically try to display the products or prices I've scraped but I get an error message saying that 'products' or 'prices' is undefined. This is my current code:</p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\nrequire 'httparty'\nrequire 'byebug'\nrequire 'csv'\n\nclass Wheyscrapper\n    def whey_scrapper\n        company = 'Body+%26+fit'\n        url = \"https://www.bodyenfitshop.nl/afslanken/afslank-toppers/?manufacturer=#{company}\"\n        unparsed_page = open(url).read\n        parsed_page = Nokogiri::HTML(unparsed_page)\n        product_scrapper\n        prices_scrapper\n        # csv = CSV.open('wheyprotein.csv', 'wb')       \n    end \n\n\n    def product_scrapper\n        products = Array.new\n        product_names = parsed_page.css('div.product-primary')\n        product_names.each do |product_name| \n            product = {\n                name: product_name.css('h2.product-name').text\n            }\n            products &lt;&lt; product \n        end\n    end\n\n    def prices_scrapper\n        prices = Array.new\n        product_prices = parsed_page.css('div.price-box')\n        product_prices.each do |product_price|\n            price = {\n                amount: product_price.css('span.price').text\n            }\n            prices &lt;&lt; price\n        end\n    end\n    byebug\n    whey_scrapper\nend     \n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 3, "creation_date": 1561387655, "post_id": 56739031, "comment_id": 100036861, "body": "check here, <a href=\"https://ruby.github.io/rdoc/\" rel=\"nofollow noreferrer\">ruby.github.io/rdoc</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 5, "creation_date": 1561393864, "post_id": 56739031, "comment_id": 100040139, "body": "@ray Or maybe Yard: <a href=\"https://yardoc.org\" rel=\"nofollow noreferrer\">yardoc.org</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1561397665, "creation_date": 1561397665, "answer_id": 56741436, "question_id": 56739031, "link": "https://stackoverflow.com/questions/56739031/what-is-this-code-commenting-style-found-in-ruby-code/56741436#56741436", "title": "what is this code commenting style found in ruby code", "body": "<p>It's definitely yardoc per what mu said. You can see the documentation on the tags used below:</p>\n\n<ul>\n<li><a href=\"https://www.rubydoc.info/gems/yard/file/docs/Tags.md#api\" rel=\"nofollow noreferrer\">@api</a></li>\n<li><a href=\"https://www.rubydoc.info/gems/yard/file/docs/Tags.md#return\" rel=\"nofollow noreferrer\">@return</a></li>\n</ul>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561397665, "creation_date": 1561387473, "question_id": 56739031, "link": "https://stackoverflow.com/questions/56739031/what-is-this-code-commenting-style-found-in-ruby-code", "title": "what is this code commenting style found in ruby code", "body": "<p>I recently opened up a git repository containing ruby code.\nAnd I see this code commenting convention - What is it, and does \nit have a documentation ?</p>\n\n<pre><code>  # Test if the current request URL is canonical\n  #\n  # @return [Boolean]\n  #\n  # @api private\n  def canonical_url?\n    request.path == canonical_url\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "jvm", "sunspot", "sunspot-solr"], "comments": [{"owner": {"reputation": 671, "user_id": 3445936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cd8z6.jpg?s=128&g=1", "display_name": "Rohit Lingayat", "link": "https://stackoverflow.com/users/3445936/rohit-lingayat"}, "edited": false, "score": 0, "creation_date": 1562221225, "post_id": 56738602, "comment_id": 100311275, "body": "You can try the below steps it might help you: 1) shut down solr <code>rake sunspot:solr:stop</code> 2) Delete all the indexing files from the folder 3) start solr <code>rake sunspot:solr:start</code>"}], "answers": [{"tags": [], "owner": {"reputation": 575, "user_id": 5372951, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10154278269606110/picture?type=large", "display_name": "Samuel Faure", "link": "https://stackoverflow.com/users/5372951/samuel-faure"}, "is_accepted": false, "score": 1, "last_activity_date": 1562506973, "creation_date": 1562506973, "answer_id": 56922695, "question_id": 56738602, "link": "https://stackoverflow.com/questions/56738602/sunspot-solr-gem-connection-issue/56922695#56922695", "title": "Sunspot_solr gem connection issue", "body": "<p>This line got my attention :</p>\n\n<p><code>733  WARN  (main) [   ] o.a.s.c.SolrResourceLoader Can't find (or read) directory to add to classloader: lib (resolved as: &lt;&lt;YOUR PATH&gt;&gt;/solr/lib</code></p>\n\n<p>1/ Check if directory exists at this path</p>\n\n<p>2/ If directory exist, check that you (if you are the user launching the Solr process) own the directory and its content // have read rights</p>\n\n<p>As a side note, afaik you should avoid giving people on the internet your full path with user name, it gives me a lot of info on who you are / where you work as well as making it easier for me to eventually bruteforce your system. You should edit your post to mask the full path.</p>\n"}], "owner": {"reputation": 179, "user_id": 9368056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Co7GK.png?s=128&g=1", "display_name": "A.A. F", "link": "https://stackoverflow.com/users/9368056/a-a-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562506973, "creation_date": 1561386104, "question_id": 56738602, "link": "https://stackoverflow.com/questions/56738602/sunspot-solr-gem-connection-issue", "title": "Sunspot_solr gem connection issue", "body": "<p>I am running a rails application which uses the sunspot_rails and sunspot_solr gems. I am facing several errors like <em>org.apache.solr.common.SolrException: Error opening new searcher</em> and\n<em>RSolr::Error::ConnectionRefused: Connection refused</em>. </p>\n\n<p><strong>System Configurations</strong></p>\n\n<p><code>Ruby 2.2.6\n Rails 4.2.2\n RVM 1.29.8</code></p>\n\n<pre><code>java -version \njava version \"11.0.2\" 2019-01-15 LTS\nJava(TM) SE Runtime Environment 18.9 (build 11.0.2+9-LTS)\nJava HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.2+9-LTS, mixed mode)\n</code></pre>\n\n<p>I also tried with Java8 and Java12 but it resulted in the same errors.</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>gem 'sunspot_rails'\ngem 'sunspot_solr'\ngem 'sunspot_mongo'\n</code></pre>\n\n<h2>Commands I am running to start solr and run the application</h2>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>Installs the required gems</p>\n\n<pre><code>rails g sunspot_rails:install\n</code></pre>\n\n<p>Creates a solr/ directory inside the project directory, but it is missing the bin/ and data/ directories I have seen other people mentioning on other questions on StackOveflow</p>\n\n<pre><code>rake sunspot:solr:start\nSuccessfully started Solr ...\n</code></pre>\n\n<p>I can see the solr admin panel on localhost:8982</p>\n\n<pre><code>rake sunspot:solr:run\n\n~/RubymineProjects/kadium$ rake sunspot:solr:run --trace\nDEPRECATION WARNING: The factory_girl gem is deprecated. Please upgrade to factory_bot. See https://github.com/thoughtbot/factory_bot/blob/v4.9.0/UPGRADE_FROM_FACTORY_GIRL.md for further instructions. (called from require at /home/ccomputing/.rvm/rubies/ruby-2.2.6/lib/ruby/site_ruby/2.2.0/bundler/runtime.rb:81)\n** Invoke sunspot:solr:run (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Execute sunspot:solr:run\n\nStarting Solr on port 8982 from /home/ccomputing/.rvm/gems/ruby-2.2.6@kadium/gems/sunspot_solr-2.3.0/solr/server\n\nJava HotSpot(TM) 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.\n0    INFO  (main) [   ] o.e.j.u.log Logging initialized @421ms\n152  INFO  (main) [   ] o.e.j.s.Server jetty-9.2.11.v20150529\n166  WARN  (main) [   ] o.e.j.s.h.RequestLogHandler !RequestLog\n167  INFO  (main) [   ] o.e.j.d.p.ScanningAppProvider Deployment monitor [file:/home/ccomputing/.rvm/gems/ruby-2.2.6@kadium/gems/sunspot_solr-2.3.0/solr/server/contexts/] at interval 0\n444  INFO  (main) [   ] o.e.j.w.StandardDescriptorProcessor NO JSP Support for /solr, did not find org.apache.jasper.servlet.JspServlet\n455  WARN  (main) [   ] o.e.j.s.SecurityHandler ServletContext@o.e.j.w.WebAppContext@7ef82753{/solr,file:/home/ccomputing/.rvm/gems/ruby-2.2.6@kadium/gems/sunspot_solr-2.3.0/solr/server/solr-webapp/webapp/,STARTING}{/home/ccomputing/.rvm/gems/ruby-2.2.6@kadium/gems/sunspot_solr-2.3.0/solr/server/solr-webapp/webapp} has uncovered http methods for path: /\n462  INFO  (main) [   ] o.a.s.s.SolrDispatchFilter SolrDispatchFilter.init(): WebAppClassLoader=225672073@d737b89\n522  INFO  (main) [   ] o.a.s.c.SolrResourceLoader JNDI not configured for solr (NoInitialContextEx)\n522  INFO  (main) [   ] o.a.s.c.SolrResourceLoader using system property solr.solr.home: /home/ccomputing/RubymineProjects/kadium/solr\n524  INFO  (main) [   ] o.a.s.c.SolrResourceLoader new SolrResourceLoader for directory: '/home/ccomputing/RubymineProjects/kadium/solr/'\n657  INFO  (main) [   ] o.a.s.c.SolrXmlConfig Loading container configuration from /home/ccomputing/RubymineProjects/kadium/solr/solr.xml\n715  INFO  (main) [   ] o.a.s.c.CoresLocator Config-defined core root directory: /home/ccomputing/RubymineProjects/kadium/solr\n732  INFO  (main) [   ] o.a.s.c.CoreContainer New CoreContainer 997695567\n733  INFO  (main) [   ] o.a.s.c.CoreContainer Loading cores into CoreContainer [instanceDir=/home/ccomputing/RubymineProjects/kadium/solr/]\n733  INFO  (main) [   ] o.a.s.c.CoreContainer loading shared library: /home/ccomputing/RubymineProjects/kadium/solr/lib\n733  WARN  (main) [   ] o.a.s.c.SolrResourceLoader Can't find (or read) directory to add to classloader: lib (resolved as: /home/ccomputing/RubymineProjects/kadium/solr/lib).\n747  INFO  (main) [   ] o.a.s.h.c.HttpShardHandlerFactory created with socketTimeout : 600000,connTimeout : 60000,maxConnectionsPerHost : 20,maxConnections : 10000,corePoolSize : 0,maximumPoolSize : 2147483647,maxThreadIdleTime : 5,sizeOfQueue : -1,fairnessPolicy : false,useRetries : false,\n2231 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.c.Config Loaded SolrConfig: solrconfig.xml\n2236 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.c.Config Loaded SolrConfig: solrconfig.xml\n2239 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.s.IndexSchema Reading Solr Schema from /home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/conf/schema.xml\n2239 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.s.IndexSchema Reading Solr Schema from /home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/conf/schema.xml\n2239 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.s.IndexSchema Reading Solr Schema from /home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/conf/schema.xml\n2310 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.s.IndexSchema [default] Schema name=sunspot\n2310 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.s.IndexSchema [test] Schema name=sunspot\n2313 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.s.IndexSchema [development] Schema name=sunspot\n2477 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.s.IndexSchema default search field in schema is text\n2478 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.s.IndexSchema default search field in schema is text\n2478 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.s.IndexSchema query parser default operator is AND\n2478 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.s.IndexSchema query parser default operator is AND\n2479 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.s.IndexSchema unique key field: id\n2482 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.s.IndexSchema default search field in schema is text\n2482 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.s.IndexSchema query parser default operator is AND\n2483 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.s.IndexSchema unique key field: id\n2479 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.s.IndexSchema unique key field: id\n2485 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.c.ConfigSetProperties Did not find ConfigSet properties, assuming default properties: Can't find resource 'configsetprops.json' in classpath or '/home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/conf'\n2486 INFO  (coreLoadExecutor-6-thread-3) [   ] o.a.s.c.CoreContainer Creating SolrCore 'default' using configuration from configset /home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot\n2486 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.c.ConfigSetProperties Did not find ConfigSet properties, assuming default properties: Can't find resource 'configsetprops.json' in classpath or '/home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/conf'\n2487 INFO  (coreLoadExecutor-6-thread-2) [   ] o.a.s.c.CoreContainer Creating SolrCore 'development' using configuration from configset /home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot\n2488 INFO  (coreLoadExecutor-6-thread-2) [   x:development] o.a.s.c.SolrCore solr.NRTCachingDirectoryFactory\n2490 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.c.ConfigSetProperties Did not find ConfigSet properties, assuming default properties: Can't find resource 'configsetprops.json' in classpath or '/home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/conf'\n2493 INFO  (coreLoadExecutor-6-thread-1) [   ] o.a.s.c.CoreContainer Creating SolrCore 'test' using configuration from configset /home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot\n2493 INFO  (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.SolrCore solr.NRTCachingDirectoryFactory\n2487 INFO  (coreLoadExecutor-6-thread-3) [   x:default] o.a.s.c.SolrCore solr.NRTCachingDirectoryFactory\n2506 INFO  (coreLoadExecutor-6-thread-2) [   x:development] o.a.s.c.SolrCore [[development] ] Opening new SolrCore at [/home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/], dataDir=[null]\n2508 INFO  (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.SolrCore [[test] ] Opening new SolrCore at [/home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/], dataDir=[null]\n2509 INFO  (coreLoadExecutor-6-thread-3) [   x:default] o.a.s.c.SolrCore [[default] ] Opening new SolrCore at [/home/ccomputing/RubymineProjects/kadium/solr/configsets/sunspot/], dataDir=[null]\n2511 INFO  (coreLoadExecutor-6-thread-3) [   x:default] o.a.s.c.JmxMonitoredMap No JMX servers found, not exposing Solr information with JMX.\n2785 INFO  (coreLoadExecutor-6-thread-2) [   x:development] o.a.s.u.DefaultSolrCoreState SolrCoreState ref count has reached 0 - closing IndexWriter\n2785 INFO  (coreLoadExecutor-6-thread-2) [   x:development] o.a.s.u.DefaultSolrCoreState closing IndexWriter with IndexWriterCloser\n2787 INFO  (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.SolrCore [test] Closing main searcher on request.\n2787 INFO  (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.CachingDirectoryFactory Closing NRTCachingDirectoryFactory - 1 directories currently being tracked\n2788 INFO  (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.CachingDirectoryFactory looking to close /home/ccomputing/RubymineProjects/kadium/solr/test/data [CachedDir&lt;&lt;refCount=0;path=/home/ccomputing/RubymineProjects/kadium/solr/test/data;done=false&gt;&gt;]\n2788 INFO  (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.CachingDirectoryFactory Closing directory: /home/ccomputing/RubymineProjects/kadium/solr/test/data\n2789 ERROR (coreLoadExecutor-6-thread-1) [   x:test] o.a.s.c.CoreContainer Error creating core [test]: Error opening new searcher\norg.apache.solr.common.SolrException: Error opening new searcher\n    at org.apache.solr.core.SolrCore.&lt;init&gt;(SolrCore.java:820)\n    at org.apache.solr.core.SolrCore.&lt;init&gt;(SolrCore.java:659)\n    at org.apache.solr.core.CoreContainer.create(CoreContainer.java:723)\n    at org.apache.solr.core.CoreContainer$1.call(CoreContainer.java:443)\n    at org.apache.solr.core.CoreContainer$1.call(CoreContainer.java:434)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor$1.run(ExecutorUtil.java:210)\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n    at java.base/java.lang.Thread.run(Thread.java:834)\nCaused by: org.apache.solr.common.SolrException: Error opening new searcher\n    at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:1662)\n    at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:1773)\n    at org.apache.solr.core.SolrCore.initSearcher(SolrCore.java:916)\n    at org.apache.solr.core.SolrCore.&lt;init&gt;(SolrCore.java:793)\n    ... 9 more\n</code></pre>\n\n<p>I have tried most of the solutions I found on similar questions, but none of them worked for me. Would really appreciate a solution to this.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 629, "user_id": 3363715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c30a39c99ca53a36d04f8db82e3ff9b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jain", "link": "https://stackoverflow.com/users/3363715/sandesh-jain"}, "edited": false, "score": 0, "creation_date": 1561382775, "post_id": 56737362, "comment_id": 100033888, "body": "Possibly duplicate of <a href=\"https://stackoverflow.com/questions/23309669/ruby-encode-xc3-from-ascii-8bit-to-utf-8-encodingundefinedconversionerr\" title=\"ruby encode xc3 from ascii 8bit to utf 8 encodingundefinedconversionerr\">stackoverflow.com/questions/23309669/&hellip;</a>  In cust_setup data you might getting some special character"}, {"owner": {"reputation": 535, "user_id": 661372, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3fd63441303963aa5dd21928309a3e9?s=128&d=identicon&r=PG", "display_name": "Bill", "link": "https://stackoverflow.com/users/661372/bill"}, "reply_to_user": {"reputation": 629, "user_id": 3363715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c30a39c99ca53a36d04f8db82e3ff9b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jain", "link": "https://stackoverflow.com/users/3363715/sandesh-jain"}, "edited": false, "score": 0, "creation_date": 1561383409, "post_id": 56737362, "comment_id": 100034261, "body": "I had read through that. I get undefined method when trying the .force_encoding(&#39;ISO-8859-1&#39;) on my recordset."}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 661372, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3fd63441303963aa5dd21928309a3e9?s=128&d=identicon&r=PG", "display_name": "Bill", "link": "https://stackoverflow.com/users/661372/bill"}, "is_accepted": false, "score": 0, "last_activity_date": 1561415158, "creation_date": 1561415158, "answer_id": 56744669, "question_id": 56737362, "link": "https://stackoverflow.com/questions/56737362/render-json-encodingundefinedconversionerror-xc3-from-ascii-8bit-to-utf-8/56744669#56744669", "title": "render json Encoding::UndefinedConversionError (&quot;\\xC3&quot; from ASCII-8BIT to UTF-8)", "body": "<p>I resolved this, sorta... see below (from OP)</p>\n\n<p>Edit 4: added a getter in the model for the specific field. encoding works in the model if i specify it on the a specific field. i have this now:</p>\n\n<p>self[:sp_legal].force_encoding(\"UTF-8\").encode(\"ASCII-8BIT\")</p>\n\n<p>which throws this error</p>\n\n<p>Encoding::InvalidByteSequenceError (\"\\xF3\" followed by \"n\" on UTF-8):</p>\n\n<p>Edit 5: I have it working for now. I don't like the way I had to do it, it's removing characters it doesn't know what to do with, so not sure what i'll get at times, but it's working. here is my final getter</p>\n\n<p>self[:sp_legal].force_encoding(\"UTF-8\").encode(\"ASCII-8BIT\", invalid: :replace, undef: :replace)</p>\n"}], "owner": {"reputation": 535, "user_id": 661372, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3fd63441303963aa5dd21928309a3e9?s=128&d=identicon&r=PG", "display_name": "Bill", "link": "https://stackoverflow.com/users/661372/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561415158, "creation_date": 1561381951, "last_edit_date": 1561393644, "question_id": 56737362, "link": "https://stackoverflow.com/questions/56737362/render-json-encodingundefinedconversionerror-xc3-from-ascii-8bit-to-utf-8", "title": "render json Encoding::UndefinedConversionError (&quot;\\xC3&quot; from ASCII-8BIT to UTF-8)", "body": "<p>Rails 4.1.4 app with Ruby 2.3.0</p>\n\n<p>had to unexpectedly move an app to a different host. I've been battling this error for a couple of days and not sure why it's started at the new server. I get the error at this line of code</p>\n\n<p><code>render json: { :result =&gt; cust_setup }, status: 200</code></p>\n\n<p>cust_setup is data returned from a MySQL db. Changing the Encodeing to UTF8 didn't help. Tried some different ways to output that with the same result. Not sure what to do with this.</p>\n\n<p><strong>Edit:</strong> One thing I found during my searching here is that we moved from the mysql2 to the mysql gem as we couldn't get the mysql2 gem to work. the mysql gem seems to be the culprit of changing things to ASCII-8BIT.</p>\n\n<p><strong>Edit 2:</strong> Coupled with the above, there is 1 field in this table that has Spanish language in it. If I remove that, the error disappears. So, it's the special characters in the spanish text coupled with moving to the mysql gem. I'm not sure what I need to do to resolve this at the moment.</p>\n\n<p><strong>Edit 3:</strong> i tried going back to mysql2 gem, got it running, still throws the same error.</p>\n\n<p><strong>Edit 4:</strong> added a getter in the model for the specific field. encoding works in the model if i specify it on the a specific field. i have this now: </p>\n\n<p><code>self[:sp_legal].force_encoding(\"UTF-8\").encode(\"ASCII-8BIT\")</code></p>\n\n<p>which throws this error</p>\n\n<p><code>Encoding::InvalidByteSequenceError (\"\\xF3\" followed by \"n\" on UTF-8):</code></p>\n\n<p><strong>Edit 5:</strong> I have it working for now. I don't like the way I had to do it, it's removing characters it doesn't know what to do with, so not sure what i'll get at times, but it's working. here is my final getter</p>\n\n<p><code>self[:sp_legal].force_encoding(\"UTF-8\").encode(\"ASCII-8BIT\", invalid: :replace, undef: :replace)</code></p>\n"}, {"tags": ["ruby", "xml"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561402198, "post_id": 56735220, "comment_id": 100043657, "body": "It&#39;s not clear what the problem is. You say &quot;When the parser reaches a node which is empty the characters method doesn&#39;t fire,&quot; but you don&#39;t say why that&#39;s a problem or what behavior you want instead. Could you edit your question to explain what you need to happen that isn&#39;t happening with your current code?"}, {"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561435954, "post_id": 56735220, "comment_id": 100051656, "body": "I&#39;ve added more info, hope its easy to understand."}], "answers": [{"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 1, "last_activity_date": 1561475648, "creation_date": 1561475648, "answer_id": 56757202, "question_id": 56735220, "link": "https://stackoverflow.com/questions/56735220/nokogiri-sax-ignoring-empty-characters/56757202#56757202", "title": "Nokogiri SAX ignoring empty characters", "body": "<p>Since <code>characters</code> might not get called, you'll need to instead watch for the <code>&lt;name&gt;</code> and <code>&lt;raw&gt;</code> elements themselves. If we can assume <code>&lt;name&gt;</code> and <code>&lt;raw&gt;</code> always come in pairs and in that order, we can create a new \"empty\" pair (e.g. <code>{ name: nil, raw: nil }</code>) every time we run into the former, and then fill in the values when (and if) <code>characters</code> is called:</p>\n\n<pre><code>class Parser &lt; Nokogiri::XML::SAX::Document\n  def initialize(*args)\n    @vals = []\n    @current_el = nil\n    super\n  end\n\n  def start_element(el_name, attrs = [])\n    if el_name == \"name\"\n      @vals &lt;&lt; { name: nil, raw: nil }\n      @current_el = \"name\"\n    elsif el_name == \"raw\"\n      @current_el = \"raw\"\n    else\n      @current_el = nil\n    end\n  end\n\n  def end_element(el_name)\n    if el_name == \"name\" || el_name == \"raw\"\n      @current_el = nil\n    end\n  end\n\n  def characters(str)\n    str = str.strip\n    if @current_el == \"name\"\n      @vals.last[:name] = str\n    elsif @current_el == \"raw\"\n      @vals.last[:raw] = str\n    end\n  end\n\n  def end_document\n    pp @vals\n  end\nend\n</code></pre>\n\n<p>You can see this in action on repl.it (but be forewarned, it takes forever to run the first time, because Nokogiri): <a href=\"https://repl.it/@jrunning/SpitefulRichLists\" rel=\"nofollow noreferrer\">https://repl.it/@jrunning/SpitefulRichLists</a></p>\n"}], "owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56757202, "answer_count": 1, "score": 2, "last_activity_date": 1561475648, "creation_date": 1561374237, "last_edit_date": 1561474530, "question_id": 56735220, "link": "https://stackoverflow.com/questions/56735220/nokogiri-sax-ignoring-empty-characters", "title": "Nokogiri SAX ignoring empty characters", "body": "<p>I'm trying to parse a large xml file using sax parser. When the parser reaches a node which is empty the characters method doesn't fire. Here is an example...</p>\n\n<pre><code>require 'nokogiri'\n\nclass Parser &lt; Nokogiri::XML::SAX::Document\n  def initialize\n    @count=1\n  end\n  def start_element(name, attrs = [])\n    puts name\n  end\n  def characters(string)\n    string.strip!\n    puts \"#{@count} #{string}\"\n    @count += 1\n  end\n  def end_element(name)\n    puts name\n  end\nend\n\nNokogiri::XML::SAX::Parser.new(Parser.new).parse(File.open('sax_example3.xml'))\n</code></pre>\n\n<p>Here is the sample xml document.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;root&gt;\n    &lt;ISA type=\"array\"&gt;\n        &lt;ISA&gt;\n            &lt;I02&gt;\n                &lt;name&gt;Information1&lt;/name&gt;\n                &lt;value&gt;\n                    &lt;raw&gt;00&lt;/raw&gt;\n                    &lt;description&gt;&lt;/description&gt;\n                &lt;/value&gt;\n            &lt;/I02&gt;\n            &lt;I02&gt;\n                &lt;name&gt;Information2&lt;/name&gt;\n                &lt;value&gt;\n                    &lt;raw&gt;&lt;/raw&gt;\n                    &lt;description nil=\"true\"/&gt;\n                &lt;/value&gt;\n            &lt;/I02&gt;\n        &lt;/ISA&gt;\n    &lt;/ISA&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>I had to use <code>sax</code> because the file has around <code>6.5 million lines</code>.</p>\n\n<p>What I'm trying to do is gather all the <code>name</code> values and then <code>raw</code> values into separate arrays and later I can zip both arrays to get key value pairs.</p>\n\n<p>Am I approaching this the correct way? Is there any other way to do this?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p><strong>What I expected</strong></p>\n\n<pre><code>array1 = [\"Information1\",\"Information2\"]  \narray2 = [\"00\", \"\"]  \n</code></pre>\n\n<p>All <code>name</code> values are assigned to array1 and <code>raw</code> values to array2 like shown above.</p>\n\n<p><strong>What I'm getting</strong></p>\n\n<pre><code>array1 = [\"Information1\",\"Information2\"]  \narray2 = [\"00\"]  \n</code></pre>\n\n<p><code>array2</code> doesn't have the same number of elements as <code>array1</code>, which means there is no way to map names to array. The reason for this I think is that the <code>characters</code> method is not called if the node is empty.</p>\n\n<p>Here is the output of the above program (Edited the above script and added line numbers)</p>\n\n<pre><code>root           \n1              \nISA            \n2              \nISA            \n3              \nI02            \n4              \nname           \n5 Information1 \nname           \n6              \nvalue          \n7              \nraw            \n8 00           \nraw            \n9              \ndescription    \ndescription    \n10             \nvalue          \n11             \nI02            \n12             \nI02            \n13             \nname           \n14 Information2\nname           \n15             \nvalue          \n16             \nraw            \nraw            \n17             \ndescription    \ndescription    \n18             \nvalue          \n19             \nI02            \n20             \nISA            \n21             \nISA            \n22             \nroot       \n</code></pre>\n\n<p>As you can see, between lines (9 &amp; 10), (16 &amp; 17) and (17 &amp; 18) the <code>start_element</code> &amp; <code>end_element</code> methods are executed but the <code>characters</code> method isn't.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "overriding", "monkeypatching", "rails-activestorage"], "answers": [{"tags": [], "owner": {"reputation": 2503, "user_id": 1348593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/abaf929fee8bb15c2d096c0be90e75e6?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Maloeuvre", "link": "https://stackoverflow.com/users/1348593/nicolas-maloeuvre"}, "is_accepted": true, "score": 1, "last_activity_date": 1561377232, "creation_date": 1561377232, "answer_id": 56735992, "question_id": 56733669, "link": "https://stackoverflow.com/questions/56733669/how-to-add-a-method-to-activestoragevariant/56735992#56735992", "title": "How to add a method to ActiveStorage::Variant?", "body": "<p>Use :</p>\n\n<pre><code>ActiveSupport::Reloader.to_prepare do\n  ActiveStorage::Variant.include ActiveStorageVariantCachedUrl\nend\n</code></pre>\n"}], "owner": {"reputation": 2503, "user_id": 1348593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/abaf929fee8bb15c2d096c0be90e75e6?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Maloeuvre", "link": "https://stackoverflow.com/users/1348593/nicolas-maloeuvre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 56735992, "answer_count": 1, "score": 0, "last_activity_date": 1561377232, "creation_date": 1561368719, "question_id": 56733669, "link": "https://stackoverflow.com/questions/56733669/how-to-add-a-method-to-activestoragevariant", "title": "How to add a method to ActiveStorage::Variant?", "body": "<p>I want to add a method to <code>ActiveStorage::Variant</code> How to do it?</p>\n\n<p>I have this for ActiveStorage::Blob and it works when I modify code without reloading the server :</p>\n\n<p><code>config/initializers/active_storage_direct_url.rb</code> :</p>\n\n<pre><code>module ActiveStorageDirectUrl\n  def cloudfront_url(expires_at = nil)\n    # xx\n  end\nend\n\nActiveSupport.on_load(:active_storage_blob) do\n  ActiveStorage::Blob.include ActiveStorageBlobCachedUrl\nend\n</code></pre>\n\n<p>But the issue is when I do it for ActiveStorage::Variant. I tried this :</p>\n\n<pre><code>ActiveSupport.on_load(:active_storage_blob) do\n  ActiveStorage::Variant.include ActiveStorageVariantCachedUrl\nend\n</code></pre>\n\n<pre><code>ActiveSupport.on_load(:active_storage_variant) do\n  ActiveStorage::Variant.include ActiveStorageVariantCachedUrl\nend\n</code></pre>\n\n<p>But it in both case, in dev environment, when I modify some code and without restarting the server, it says <code>undefined method 'direct_url' for #&lt;ActiveStorage::Variant:0x00007fc04fa45530&gt;</code></p>\n\n<p>When I reload the <code>rails server</code> it works though. Same thing for sidekiq, I need to reload it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "soap", "savon"], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1561369734, "creation_date": 1561366969, "last_edit_date": 1561369734, "question_id": 56733170, "link": "https://stackoverflow.com/questions/56733170/how-to-write-middleware-in-savon", "title": "How to write middleware in Savon?", "body": "<p>Is there a way to write middleware in Savon like Rack middleware or Faraday middleware? </p>\n\n<p>The only thing a found was <a href=\"http://savonrb.com/version2/observers.html\" rel=\"nofollow noreferrer\"><code>Observers</code></a> but its not what I looking for because savon observer getting called only once before request was made. </p>\n\n<p>In Faraday for example middleware called twice - before request was made and after response was got. So I can do things like calculate time of request/response</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "paperclip", "obfuscation"], "comments": [{"owner": {"reputation": 1257, "user_id": 4108555, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e4b39206bd7e7e23b3faa85b7cb1373c?s=128&d=identicon&r=PG&f=1", "display_name": "NN796", "link": "https://stackoverflow.com/users/4108555/nn796"}, "edited": false, "score": 0, "creation_date": 1561365513, "post_id": 56732716, "comment_id": 100024650, "body": "A complete guide present here <a href=\"https://stackoverflow.com/questions/2123437/ruby-obfuscator\">stackoverflow.com/questions/2123437/ruby-obfuscator</a>. <a href=\"https://github.com/jwt/ruby-jwe\" rel=\"nofollow noreferrer\">github.com/jwt/ruby-jwe</a>"}, {"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1561365534, "post_id": 56732716, "comment_id": 100024659, "body": "for (3) it&#39;s impossible. Client-side JS can be read by anybody. So, there is no reliable way to de-obfuscate the resource without also giving away the de-obfuscation mechanic and thus likely the obfuscation mechanic. What is the purpose of this anyway? Any resource has to be readable in order to work. And you need that readable in the client. So, by definition, any resource given to the client will be available."}, {"owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "reply_to_user": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1561375217, "post_id": 56732716, "comment_id": 100029668, "body": "@VLAZ yes you are right, as long as we de-obfuscate in JS, anyone can de-obfuscate. The purpose of obfuscation is to &quot;make obscure, unclear, or unintelligible.&quot;. Our goal is to not have it readable by the &quot;human eye&quot; easily and to be able to rotate obfuscation methods. If you feel like uncompressing our 300k lines of frontend minified code and reverse engineer it, then yes, you gonna have access to it."}, {"owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "reply_to_user": {"reputation": 1257, "user_id": 4108555, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e4b39206bd7e7e23b3faa85b7cb1373c?s=128&d=identicon&r=PG&f=1", "display_name": "NN796", "link": "https://stackoverflow.com/users/4108555/nn796"}, "edited": false, "score": 0, "creation_date": 1561375280, "post_id": 56732716, "comment_id": 100029702, "body": "@NN796 this is to obfuscate ruby code, I&#39;m trying to obfuscate some JSON assets."}, {"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1561375877, "post_id": 56732716, "comment_id": 100030008, "body": "@DanielCosta I&#39;m still not clear on what the end goal is. If you just want to stop casual observers, you can base64 encode it. It&#39;s almost useless as a protection mechanism but it would stop casual people from looking into it. If you want to make it harder for more determined people to the point where you want to rotate de-obfuscation mechanisms, you&#39;ve already lost. Almost nobody who is going to bother looking into a base64 encoded strings would be stopped by harsher measures. At the very least, they could just drop a breakpoint after decoding and look at the data there."}, {"owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "reply_to_user": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1561549966, "post_id": 56732716, "comment_id": 100099775, "body": "@VLAZ the end goal doesn&#39;t really matter here. The question is quite simple: what method should be used that allows to obfuscate a file in Ruby and de-obfuscate in javascript."}, {"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1561551743, "post_id": 56732716, "comment_id": 100100846, "body": "@DanielCosta that&#39;s <i>a solution</i>. I don&#39;t know what <i>the problem</i> is. Are you trying to protect the data in flight from somebody snooping with Wireshark? Are you trying to protect from somebody opening the dev tools and the network tab? Are you trying to protect the data from being used by any user? The first&#39;s solution is HTTPS, the second it&#39;s encoding the data. The third is to not transfer the data. I&#39;m not sure what &quot;obfuscating the entire payload, then deobfuscate it and be able to rotate the mechanisms&quot; solves."}, {"owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "reply_to_user": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1561715334, "post_id": 56732716, "comment_id": 100163459, "body": "@VLAZ We have a 3D model that is in form of a text file. This file is read by our custom 3D viewer. Our goal is to obfuscate this 3D model because this file is accessible by anyone. Our 3D viewer takes care of de-obfuscating and displaying it.   The reason we doing that is that in its text form, this file could be read by competitors 3D viewers."}], "owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561365290, "creation_date": 1561365290, "question_id": 56732716, "link": "https://stackoverflow.com/questions/56732716/obfuscation-in-ruby-deobfuscation-in-javascript", "title": "Obfuscation in Ruby, Deobfuscation in Javascript", "body": "<p>Our public API (ruby) saves JSON assets to an Amazon S3 bucket. Those assets are showed to our users through a javascript reader.</p>\n\n<p>Our customers would like to have those assets obfuscated. I'm currently looking into some workflow to:</p>\n\n<ol>\n<li>Obfuscate in ruby</li>\n<li>Save it on S3 (with Paperclip)</li>\n<li>Deobfuscate in javascript</li>\n</ol>\n\n<p>The point (2) is pretty much figured out as I can create a new style and use a processor with Paperclip.</p>\n\n<p>For the (1) and (3) I'm struggling to find a working solution that won't be too easy to be reverse engineered.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1561369626, "post_id": 56730382, "comment_id": 100026831, "body": "We all know the outcome of <code>true == false</code>. You could simply replace it by <code>false</code>."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1561362898, "post_id": 56730461, "comment_id": 100023364, "body": "Alternatively <code>arr.push(true == false ? &#39;a&#39; : &#39;b&#39;)</code>"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 2, "creation_date": 1561372726, "post_id": 56730461, "comment_id": 100028449, "body": "Maybe it&#39;s a hack, but this also works: <code>arr  &lt;&lt;= true == false ? &#39;a&#39; : &#39;b&#39;</code>"}, {"owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "edited": false, "score": 0, "creation_date": 1561387266, "post_id": 56730461, "comment_id": 100036593, "body": "Thank you iGian, this is the answer I&#39;m looking for"}], "tags": [], "owner": {"reputation": 667, "user_id": 5863438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hX2nv.png?s=128&g=1", "display_name": "the_spectator", "link": "https://stackoverflow.com/users/5863438/the-spectator"}, "is_accepted": false, "score": 16, "last_activity_date": 1561369444, "last_edit_date": 1561369444, "creation_date": 1561355072, "answer_id": 56730461, "question_id": 56730382, "link": "https://stackoverflow.com/questions/56730382/how-to-push-a-value-to-an-array-with-a-ternary-operator/56730461#56730461", "title": "how to push a value to an array with a ternary operator?", "body": "<p>It is due to <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/precedence_rdoc.html\" rel=\"noreferrer\">Ruby's operator precedence</a>. Operator <code>&lt;&lt;</code> has greater precedence than the ternary operator. Your example can be solved by modifying the code as below:</p>\n\n<pre><code>arr = []\narr &lt;&lt; (true == false ? 'a' : 'b')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1561403536, "post_id": 56739022, "comment_id": 100044194, "body": "This answer will be more useful to future readers if you explain <i>why</i> it works. Practically speaking what&#39;s the difference between <code>&lt;&lt;</code> and <code>&lt;&lt;=</code>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561787431, "post_id": 56739022, "comment_id": 100184359, "body": "If you already have a working solution, why do you use the conditional operator in the first place? You should, in general, prefer the conditional expression over the conditional operator, since the conditional operator has some non-intuitive precedence, as you just discovered. You already posted a solution with the conditional expression, and that one just works: <code>arr &lt;&lt; if true == false then &#39;a&#39; else &#39;b&#39; end</code>"}, {"owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "edited": false, "score": 0, "creation_date": 1561874822, "post_id": 56739022, "comment_id": 100198217, "body": "Hey Jorg, I was curious about why the conditional expression doesn&#39;t work and wanted to learn from experts."}], "tags": [], "owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "is_accepted": true, "score": 1, "last_activity_date": 1561387454, "creation_date": 1561387454, "answer_id": 56739022, "question_id": 56730382, "link": "https://stackoverflow.com/questions/56730382/how-to-push-a-value-to-an-array-with-a-ternary-operator/56739022#56739022", "title": "how to push a value to an array with a ternary operator?", "body": "<p>thank you all for helping, I like the solution by iGian i.e. without parenthesis.</p>\n\n<pre><code>arr &lt;&lt;= true == false ? 'a' : 'b'\n\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 56739022, "answer_count": 2, "score": 4, "last_activity_date": 1561387454, "creation_date": 1561354613, "last_edit_date": 1561361500, "question_id": 56730382, "link": "https://stackoverflow.com/questions/56730382/how-to-push-a-value-to-an-array-with-a-ternary-operator", "title": "how to push a value to an array with a ternary operator?", "body": "<p>the array is returning a boolean value instead of the value assigned by the ternary operator</p>\n\n<p>and the code...</p>\n\n<pre><code>arr = []\narr &lt;&lt;  true == false ? 'a' : 'b'\n# Expecting, the output of arr to be ['b']. But instead, I was getting [true] \n</code></pre>\n\n<p>Why is this behavior? </p>\n\n<p>and to get the right value I have to do this.</p>\n\n<pre><code>arr &lt;&lt; if true == false\n         'a'\n       else\n         'b'\n       end  \n\n# and also, = also works fine\narr =  true == false ? 'a' : 'b' # arr has 'b'\n\n</code></pre>\n\n<p>and why the behavior is different when using the ternary operator?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1561362383, "post_id": 56729557, "comment_id": 100023162, "body": "I will prefer <code>arr.length.times.select { |x| arr[x] == 3 }</code>"}, {"owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1561553213, "post_id": 56729557, "comment_id": 100101841, "body": "Hey Ray,  performance wise I see the each_index is taking less time to execute when comparing with length.times."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1561558551, "post_id": 56729557, "comment_id": 100105305, "body": "Yes agreed! <code>each_index</code> is better option."}], "owner": {"reputation": 121, "user_id": 7082648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161177576ed098ad9f9cbb56d5eea6?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/7082648/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "closed_date": 1561349161, "answer_count": 0, "score": 0, "last_activity_date": 1561347645, "creation_date": 1561347422, "question_id": 56729557, "link": "https://stackoverflow.com/questions/56729557/is-there-a-simple-way-to-find-the-index-of-values-in-a-array-like-select-with-in", "closed_reason": "Duplicate", "title": "Is there a simple way to find the index of values in a array like select with index_of?", "body": "<p>If I have an array of repeated values and I need to find the indexes of all the occurrence like </p>\n\n<p>I tried with each_with_index but need something that is more efficient like select</p>\n\n<pre><code>arr = [2,3,4,3,5,6,3,7,8]   \n# Now, I'm trying to grab the indexes of all the occurrences of 3\n\n    final=[]\n    arr.each_with_index do |x, i|\n      final &lt;&lt; i if x == 3\n    end\n</code></pre>\n\n<p>In, Final I'm collecting all the indexes of 3's positions</p>\n\n<p>the final array should have [1,3,6]</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 180, "user_id": 1881608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef99f58ba5a8d821ac4cb357b4478d0?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1881608/praveen"}, "edited": false, "score": 0, "creation_date": 1561380026, "post_id": 56729135, "comment_id": 100032324, "body": "You can use compact instead of strip like <code>arr_new.compact.join(&quot; &quot;)</code> so it will remove additional spaces from middle of given string also if we don&#39;t have integer in sequence."}], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 5, "last_activity_date": 1561343428, "creation_date": 1561343428, "answer_id": 56729213, "question_id": 56729135, "link": "https://stackoverflow.com/questions/56729135/space-before-first-word-after-join-array-to-string/56729213#56729213", "title": "Space before first word after .join array to string", "body": "<p>The reason you're seeing the extra space is because arrays in ruby are 0 indexed, so you have an nil array element because your first insert is a index <code>1</code></p>\n\n<pre><code>x = []\nx[1] = \"test\"\n</code></pre>\n\n<p>This creates an array as such:</p>\n\n<pre><code>[\n  nil,\n  \"test\"\n]\n</code></pre>\n\n<p>If you created an empty array named <code>x</code> and assigned <code>x[10] = \"test\"</code> you'd have 10 nil values, and the word \"test\" in your array.</p>\n\n<p>So, your array, before joining, is actually:</p>\n\n<pre><code>[nil, \"Thi1s\", \"is2\", \"3a\", \"T4est\"]\n</code></pre>\n\n<p>You have a couple options:</p>\n\n<ul>\n<li>Change your strings to start with zero</li>\n<li>Change your assignment to adjust the offset (subtract one)</li>\n<li>Use <code>compact</code> before you join (this will remove nils)</li>\n<li>Use <code>strip</code> as you noted</li>\n</ul>\n\n<p>I'd suggest <code>compact</code> because it would address a few edge cases (such as \"gaps\" in your numbers.</p>\n\n<p>More info in the <a href=\"https://ruby-doc.org/core-2.6.3/Array.html\" rel=\"noreferrer\">array docs</a></p>\n"}, {"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1561362027, "creation_date": 1561362027, "answer_id": 56731885, "question_id": 56729135, "link": "https://stackoverflow.com/questions/56729135/space-before-first-word-after-join-array-to-string/56731885#56731885", "title": "Space before first word after .join array to string", "body": "<p><a href=\"https://stackoverflow.com/a/56729213/2423164\">@Jay's explanation</a> is indeed correct.</p>\n\n<p>I'll simply suggest a cleaner version of your code that doesn't have the same problem.</p>\n\n<hr>\n\n<p>This assumes that the 1-9 order isn't dynamic. Aka wouldn't work if you wanted to sort by random characters for example.</p>\n\n<pre><code>def order(words)\n  words.split.sort_by { |word| word[/\\d/].to_i }.join ' '\nend\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11683588, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215479005632755/picture?type=large", "display_name": "Mary Lang", "link": "https://stackoverflow.com/users/11683588/mary-lang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561362027, "creation_date": 1561342521, "last_edit_date": 1561353551, "question_id": 56729135, "link": "https://stackoverflow.com/questions/56729135/space-before-first-word-after-join-array-to-string", "title": "Space before first word after .join array to string", "body": "<p>To convert array to string I used <a href=\"https://ruby-doc.org/core/Array.html#method-i-join\" rel=\"nofollow noreferrer\"><code>Array#join</code></a> and got space between the\nbeginning of the string, first quote mark, and the first word. I do not understand why this is happening. </p>\n\n<p>I resolved with <code>String#strip</code> but I would like to understand</p>\n\n<pre><code>def order(words)\n  arr_new = []\n  arr = words.split(\" \")\n  nums = [\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"]\n  arr.each do |word|\n    nums.each do |num| \n      if word.include? num \n        arr_new[num.to_i] = word\n      end \n    end\n  end \n\n  arr_new.join(\" \").strip \nend \n\n\norder(\"is2 Thi1s T4est 3a\")\n</code></pre>\n\n<p>Without .strip the output is:</p>\n\n<pre><code>\" Thi1s is2 3a T4est\"\n</code></pre>\n\n<p>After .strip:</p>\n\n<pre><code>\"Thi1s is2 3a T4est\"\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "css", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561344614, "post_id": 56729086, "comment_id": 100018133, "body": "Are you aware that the <code>if</code> branch and the <code>else</code> branch of your conditional are identical?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561344822, "post_id": 56729086, "comment_id": 100018170, "body": "I want to display all records, even <code>if (order.cart_id == order.cart_id) == false</code>."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561344932, "post_id": 56729086, "comment_id": 100018185, "body": "Either way, that&#39;s just one of many attempts.  No need to show other attempts because none work the way I would like unfortunately.  I&#39;ve done that any many iterations of that, etc."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561344941, "post_id": 56729086, "comment_id": 100018188, "body": "But <code>order.card_id == order.cart_id</code> must always be true."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561345017, "post_id": 56729086, "comment_id": 100018202, "body": "Hm... how can I accomplish what i want then? I thought that would compare all value results"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561346409, "post_id": 56729086, "comment_id": 100018377, "body": "Your spec is not very clear. Will <code>cart_id</code> 1 always be red, and <code>cart_id</code> 2 always be blue? Or will the first cart always be red and the second cart always be blue, regardless of the <code>cart_id</code>? How many possible carts might there be in a single order? If more than two, how will you determine what color the third cart gets?"}, {"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "edited": false, "score": 0, "creation_date": 1561348400, "post_id": 56729086, "comment_id": 100018658, "body": "try plucking all the cart_ids from <code>@vendor_orders</code> and create a hash, with cart_id as key and random hex color as values. then while looping you call the style inline and call the color with cart_id as key."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561351763, "post_id": 56729086, "comment_id": 100019309, "body": "@moveson it should iterate between red and blue.  The reason for 2 different colors is to differentiate between the groups of orders with the same cart_id, so 4 orders next to each other with 2 different carts will be able to be differentiate each other.  Basically, it&#39;s a visual thing.  Instead of needing to look at &quot;cart_id&quot; to know if 2 &quot;orders&quot; share the same cart, we will be able to have a visual color. Then use 2 colors so they aren&#39;t mixed together to avoid confusion"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561352492, "post_id": 56729841, "comment_id": 100019483, "body": "Okay this works thank. How can I specify the list of colors I would like to use instead of random? So it iterates between &quot;red&quot; and &quot;blue&quot;"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561352764, "post_id": 56729841, "comment_id": 100019537, "body": "This actually doesn&#39;t work for a number of reasons. The color is based on the id of the vendor_order, not the id of the cart. And it doesn&#39;t distinguish whether the cart has multiple items or not."}, {"owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561352960, "post_id": 56729841, "comment_id": 100019581, "body": "@uno what if there is more than two ids"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561353144, "post_id": 56729841, "comment_id": 100019633, "body": "As long as it iterates that is fine. I just don&#39;t want the same color next to each other.  Basically, I just want the color as a visual aid instead of needing to read the cart_id column to see if they share the same cart."}], "tags": [], "owner": {"reputation": 1243, "user_id": 10476417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b57114718c234f1f44a28f5396026e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Aravindan", "link": "https://stackoverflow.com/users/10476417/abhishek-aravindan"}, "is_accepted": false, "score": 0, "last_activity_date": 1561350345, "creation_date": 1561350345, "answer_id": 56729841, "question_id": 56729086, "link": "https://stackoverflow.com/questions/56729086/color-rows-by-matching-associations-in-table/56729841#56729841", "title": "Color rows by matching associations in table", "body": "<p>This is a suggestion. I compiled and served the same purpose.</p>\n\n<p>in your controller pluck the cart ids from <code>@vendor_orders</code> and make a hash with the id as key and random color as value.</p>\n\n<pre><code>    @ids = @vendor_orders.pluck(:id)\n    @ids = @ids.uniq\n    @color = Hash.new\n    @ids.each do |val|\n        @color[\"#{val}\"] = \"##{random_hex}\"\n    end\n</code></pre>\n\n<p>where random_hex is</p>\n\n<pre><code>def random_hex\n    colour = \"%06x\" % (rand * 0xffffff)\n    return colour\nend\n</code></pre>\n\n<p>now in your view inside loop call the color respective to cart_id from <code>@color</code> like</p>\n\n<p><code>&lt;td style='background:&lt;%= @color[\"#{order.cart_id}\"] %&gt;'&gt;&lt;%= order.cart_id %&gt;&lt;/td&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1561353541, "post_id": 56730146, "comment_id": 100019723, "body": "You should change <code>% 2</code> to <code>% COLORS.size</code>. It\u2019s more flexible and gets rid of magic numbers."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561435629, "post_id": 56730146, "comment_id": 100051594, "body": "You went off   .   I know you say this is dead simple but it&#39;s a bit over my head.  Say I wanted to add a column for <code>Orders.where(order_status: &quot;complete&quot; )</code>, would I try to add that to the VendorOrderPresnter or would I make a new presenter file?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1561496537, "post_id": 56730146, "comment_id": 100081213, "body": "You can use the same presenter. Just add a public method and define it. See my edited answer. You can address the new method with <code>@presenter.completed_orders</code>."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561533153, "post_id": 56730146, "comment_id": 100090241, "body": "perfect.  one more issue is that not all orders will have a cart_id and orders without that aren&#39;t appearing.  How can I tweak the presenter to allow all orders to go through, even if cart_id doesn&#39;t appear.  Basically an Order will either have cart_id or shop_order_id"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1561533329, "post_id": 56730146, "comment_id": 100090332, "body": "omg, I had the <code>if cart.present</code> still in the view lol wow.  nvm.. thanks for everything"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 1, "last_activity_date": 1561496684, "last_edit_date": 1561496684, "creation_date": 1561352954, "answer_id": 56730146, "question_id": 56729086, "link": "https://stackoverflow.com/questions/56729086/color-rows-by-matching-associations-in-table/56730146#56730146", "title": "Color rows by matching associations in table", "body": "<p>You will need some specialized logic that belongs neither in the view nor in the controller. I would suggest you place this logic into a presenter.</p>\n\n<p>The controller logic is dead simple:</p>\n\n<pre><code># app/controllers/orders_controller.rb\n\nclass OrdersController &lt; ApplicationController\n  def index\n    @presenter = VendorOrderPresenter.new(current_user&amp;.id)\n  end\nend\n</code></pre>\n\n<p>The specialized logic is contained in a presenter:</p>\n\n<pre><code># app/presenters/vendor_order_presenter.rb\n\nclass VendorOrderPresenter\n  COLORS = %w[red blue].freeze\n\n  def initialize(current_user_id)\n    @current_user_id = current_user_id\n  end\n\n  def vendor_orders\n    @vendor_orders ||= Order.where(product_id: vendor_products.pluck(:product_id)).order(created_at: :desc)\n  end\n\n  def completed_orders\n    @completed_orders ||= vendor_orders.where(order_status: \"complete\")\n  end\n\n  def background_color(order)\n    index = colorable_cart_ids.index(order.cart_id)\n    index ? COLORS[index % COLORS.size] : nil\n  end\n\n  private\n\n  attr_reader :current_user_id\n\n  def vendor_products\n    VendorProduct.where(vendor_id: current_user_id)\n  end\n\n  def colorable_cart_ids\n    @colorable_cart_ids ||= cart_ids.select { |id| cart_ids.count(id) &gt; 1 }.uniq\n  end\n\n  def cart_ids\n    @cart_ids ||= vendor_orders.pluck(:cart_id).compact\n  end\nend\n</code></pre>\n\n<p>Now the view layer is simple and intuitive with no conditional or specialized logic:</p>\n\n<pre><code># app/views/orders/index.html.erb\n\n&lt;h1&gt;Index&lt;/h1&gt;\n&lt;table&gt;\n  &lt;thead&gt;\n  &lt;th&gt;Order ID&lt;/th&gt;\n  &lt;th&gt;Cart ID&lt;/th&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n  &lt;% @presenter.vendor_orders.each do |order| %&gt;\n    &lt;tr style='background:&lt;%= @presenter.background_color(order) %&gt;'&gt;\n      &lt;td&gt;&lt;%= order.id %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= order.cart_id %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>A full working solution can be found <a href=\"https://github.com/moveson/order-row-colors\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 0, "accepted_answer_id": 56730146, "answer_count": 2, "score": 0, "last_activity_date": 1561496684, "creation_date": 1561341931, "last_edit_date": 1561346698, "question_id": 56729086, "link": "https://stackoverflow.com/questions/56729086/color-rows-by-matching-associations-in-table", "title": "Color rows by matching associations in table", "body": "<p>My goal is to have rows where the loop results that have matching attributes have the same color background</p>\n\n<p>Here is my attempt:</p>\n\n<p><strong>controller:</strong></p>\n\n<pre><code>vendor_products = VendorProduct.where(vendor_id: current_user.id)\n@vendor_orders = Order.where(product_id: vendor_products.map { |vp| vp.product_id}).order(created_at: :desc)\n</code></pre>\n\n<p><strong>Form:</strong></p>\n\n<pre><code>  &lt;% @vendor_orders.each do |order, cart_id| %&gt;\n      &lt;tr class=\"ok\"&gt;\n        &lt;% if order.cart_id.present? &amp;&amp; order.cart_id == order.cart_id %&gt;\n            &lt;td&gt;&lt;%= order.id %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= order.cart_id %&gt;&lt;/td&gt;\n            .....\n        &lt;% else %&gt;\n            &lt;td&gt;&lt;%= order.id %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= order.cart_id %&gt;&lt;/td&gt;\n            .....\n        &lt;% end %&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>(tried <code>if</code> statement both inside/outside <code>&lt;tr&gt;</code>)</p>\n\n<p><strong>Style:</strong></p>\n\n<pre><code>.ok:nth-child(odd) {\n  background: red;\n}\n\n.ok:nth-child(even) {\n  background: blue;\n}\n</code></pre>\n\n<p>My goal is if the cart_id of the order match, then for the x number of orders matching cart_id's to have the same color background so it's known they are the same cart.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>ID | Cart \n\n1  | 1 (red)\n\n2  | 1 (red)\n\n3  | nil\n\n4  | 2 (blue)\n\n5  | 2 (blue)\n</code></pre>\n\n<p>So, ID 1 and 2 would have their rows as red and ID 4 and 5 would have their rows as blue.  With 3 having no color since is doesn't belong to any cart.  Also, would like this for only carts that have multiple items.</p>\n\n<p>Some orders will have no cart and only have one product associated with them.  Some order are created with a cart that will have multiple line items.  </p>\n\n<p>so basically, IF an orders cart_id is present? and the cart.line_items.count > 1, to have all the orders associated with it the same color.</p>\n\n<p><strong>Models:</strong></p>\n\n<pre><code>**cart**\n\nhas_many :line_items, dependent: :destroy\nhas_one :order\n...\n\n**line items**\n\nbelongs_to :cart\n...\n\n**order**\n\nbelongs_to :cart\n</code></pre>\n\n<p>What my attempt does is nothing.  All the results just turn red.</p>\n\n<p>I am tagging JS and JQ just in case because I assume that is a viable option for this to work.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "rest", "api"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1561337630, "post_id": 56728639, "comment_id": 100017178, "body": "That (&quot;the expected output&quot;) is not JSON. That looks like JavaScript source code. There is a difference. It also seems to contain fields that do not exist in your data (like <code>duration_ms</code>) - no amount of formatting tricks can pull that rabbit out of a hat. This looks like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>; why, exactly, do you desire this format?"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1561340009, "post_id": 56728639, "comment_id": 100017492, "body": "Amadan has a point: it looks like the data you are getting has already been deserialized."}, {"owner": {"reputation": 21, "user_id": 10939646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630a88f9dac775f043b9d3350d591ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Martin", "link": "https://stackoverflow.com/users/10939646/andres-martin"}, "edited": false, "score": 0, "creation_date": 1561353355, "post_id": 56728639, "comment_id": 100019684, "body": "Yes, that&#39;s what I want to render, not the deserialized format but the Javascript format-like, with keys without double quotes"}], "answers": [{"tags": [], "owner": {"reputation": 1130, "user_id": 4574914, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c27823d944d6c2125057e337c8700b97?s=128&d=identicon&r=PG&f=1", "display_name": "joeyk16", "link": "https://stackoverflow.com/users/4574914/joeyk16"}, "is_accepted": false, "score": 0, "last_activity_date": 1561361916, "last_edit_date": 1561361916, "creation_date": 1561341159, "answer_id": 56729022, "question_id": 56728639, "link": "https://stackoverflow.com/questions/56728639/how-to-give-the-correct-format-to-this-json-response-in-rails-5/56729022#56729022", "title": "How to give the correct format to this JSON response in Rails 5?", "body": "<p>Ok, there is the right way to do this and the let's get it to work way. Let's do the latter because its easier for a junior to understand:</p>\n\n<h1>Quick Way</h1>\n\n<p>The below is sudo code. You will have to fix it.</p>\n\n<pre><code>artists = [\n  {\n    \"id\":1,\n    \"name\":\"Metallica\",\n    \"image\":\"{\\\"height\\\"=&gt;640, \\\"url\\\"=&gt;\\\"https://i.scdn.co/image/\n     5a06711d7fc48d5e0e3f9a3274ffed3f0af1bd91\\\", \\\"width\\\"=&gt;640}\",\n    \"genres\":\"[\\\"alternative metal\\\", \\\"hard rock\\\", \\\"metal\\\", \\\"old school \n     thrash\\\", \\\"rock\\\", \\\"speed metal\\\", \\\"thrash metal\\\"]\",\n    \"popularity\":\"86\",\n    \"spotify_url\":\"spotify:artist:2ye2Wgw4gimLv2eAKyk1NB\",\n    \"spotify_id\":\"2ye2Wgw4gimLv2eAKyk1NB\",\n    \"created_at\":\"2019-06-23T17:27:11.893Z\",\n    \"updated_at\":\"2019-06-23T17:27:11.893Z\"\n  },\n  {\n    \"id\":2,\n    \"name\":\"Diomedes Diaz\",\n    \"image\":\"{\\\"height\\\"=&gt;640, \n    \\\"url\\\"=&gt;\\\"https://i.scdn.co/image/\n    c3b77cdff8b152466447e4573c45613b06fbcf1b\\\", \\\"width\\\"=&gt;640}\",\n    \"genres\":\"[\\\"cumbia\\\", \\\"vallenato\\\"]\",\n    \"popularity\":\"61\",\n    \"spotify_url\":\"spotify:artist:66NweiA3nU84k1S3SZdTSG\",\n    \"spotify_id\":\"66NweiA3nU84k1S3SZdTSG\",\n    \"created_at\":\"2019-06-23T17:27:12.024Z\",\n    \"updated_at\":\"2019-06-23T17:27:12.024Z\"\n  },\n]\n\narray = artists.map do |artist|\n  {\n    name: artist['name'],\n    spotify_url: artist['spotify_url'],\n    # The below attributes I dont know how to get because they're not in the response\n    # preview_url: \"https://p.scdn.co/mp3- \n    # preview/7a7becf24a93022ae9068ac3cb2e88e61563e268\",\n    # duration_ms: 9870,\n    # explicit: true\n  }\nend\n</code></pre>\n\n<p>Then do this</p>\n\n<pre><code>render json: { data: array }\n</code></pre>\n\n<h1>Another Option</h1>\n\n<p>I find the architecture a little weird. I'm assuming you have a backend and frontend type architecture. Why not just return exactly what Spotify gives you to the frontend. Then have the front end use attributes it needs.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11664067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YOe41ShpUy4/AAAAAAAAAAI/AAAAAAAAABQ/DiX-DV3yhoU/photo.jpg?sz=128", "display_name": "Tushar Vaniya", "link": "https://stackoverflow.com/users/11664067/tushar-vaniya"}, "is_accepted": false, "score": 0, "last_activity_date": 1561376258, "last_edit_date": 1561376258, "creation_date": 1561360775, "answer_id": 56731577, "question_id": 56728639, "link": "https://stackoverflow.com/questions/56728639/how-to-give-the-correct-format-to-this-json-response-in-rails-5/56731577#56731577", "title": "How to give the correct format to this JSON response in Rails 5?", "body": "<p>Fetch data in an object and use the to_json method.</p>\n\n<p>Example : </p>\n\n<pre><code>puts student.to_json \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10939646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/630a88f9dac775f043b9d3350d591ed0?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Martin", "link": "https://stackoverflow.com/users/10939646/andres-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561376258, "creation_date": 1561336116, "last_edit_date": 1561350938, "question_id": 56728639, "link": "https://stackoverflow.com/questions/56728639/how-to-give-the-correct-format-to-this-json-response-in-rails-5", "title": "How to give the correct format to this JSON response in Rails 5?", "body": "<p>I'm trying to format a JSON response from the Spotify API, I tried several methods but none of them match the desired format, I appreciate your help since I'm new in RoR.</p>\n\n<p>I tried using some methods like <code>pretty_generate()</code> and <code>neat_generate</code>, but I cannot figure out how to set the format correctly, also I'm using Spotify gem to fetch data from the API.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\n    render json: JSON.neat_generate(@artists.as_json)\n\n</code></pre>\n\n<p>this is the output I'm getting:</p>\n\n<pre><code>[\n  {\n    \"id\":1,\n    \"name\":\"Metallica\",\n    \"image\":\"{\\\"height\\\"=&gt;640, \\\"url\\\"=&gt;\\\"https://i.scdn.co/image/\n     5a06711d7fc48d5e0e3f9a3274ffed3f0af1bd91\\\", \\\"width\\\"=&gt;640}\",\n    \"genres\":\"[\\\"alternative metal\\\", \\\"hard rock\\\", \\\"metal\\\", \\\"old school \n     thrash\\\", \\\"rock\\\", \\\"speed metal\\\", \\\"thrash metal\\\"]\",\n    \"popularity\":\"86\",\n    \"spotify_url\":\"spotify:artist:2ye2Wgw4gimLv2eAKyk1NB\",\n    \"spotify_id\":\"2ye2Wgw4gimLv2eAKyk1NB\",\n   },\n  {\n    \"id\":2,\n    \"name\":\"Diomedes Diaz\",\n    \"image\":\"{\\\"height\\\"=&gt;640, \n    \\\"url\\\"=&gt;\\\"https://i.scdn.co/image/\n    c3b77cdff8b152466447e4573c45613b06fbcf1b\\\", \\\"width\\\"=&gt;640}\",\n    \"genres\":\"[\\\"cumbia\\\", \\\"vallenato\\\"]\",\n    \"popularity\":\"61\",\n    \"spotify_url\":\"spotify:artist:66NweiA3nU84k1S3SZdTSG\",\n    \"spotify_id\":\"66NweiA3nU84k1S3SZdTSG\",\n   },\n]\n</code></pre>\n\n<p>But the expected output should be like this:</p>\n\n<pre><code>{\n  data: [\n    {\n      name: \"song One\",\n      spotify_url: \n      \"https://api.spotify.com/v1/tracks/0O3xlhTJPTrGevY2FnYUQC\",\n      preview_url: \"https://p.scdn.co/mp3- \n      preview/7a7becf24a93022ae9068ac3cb2e88e61563e268\",\n      duration_ms: 9870,\n      explicit: true\n    },\n    {\n      name: \"song Two\",\n      spotify_url: \n      \"https://api.spotify.com/v1/tracks/0O3xlhTJPTrGevY2FnYUQC\",\n      preview_url: \"https://p.scdn.co/mp3- \n      preview/7a7becf24a93022ae9068ac3cb2e88e61563e268\",\n      duration_ms: 9870,\n      explicit: true    \n    }\n  ]\n}\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "nokogiri", "redmine"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1561334810, "post_id": 56728540, "comment_id": 100016859, "body": "If you specify <code>nokogiri &gt;= 1.4.2</code>, you&#39;ll get the latest. Which in this case is 1.9.1, which requires Ruby 2.2. Try specifying the exact version of nokogiri you want. Maybe something like <code>~&gt; 1.6</code>."}, {"owner": {"reputation": 3414, "user_id": 974380, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a4f5e1111c01ea94f001d5e28d38051?s=128&d=identicon&r=PG", "display_name": "Nickool", "link": "https://stackoverflow.com/users/974380/nickool"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1561334953, "post_id": 56728540, "comment_id": 100016879, "body": "should I say nokogiri = 1.6.8?"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1561335067, "post_id": 56728540, "comment_id": 100016895, "body": "<code>gem &#39;nokogiri&#39;, &#39;1.6.8&#39;</code>"}, {"owner": {"reputation": 3414, "user_id": 974380, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a4f5e1111c01ea94f001d5e28d38051?s=128&d=identicon&r=PG", "display_name": "Nickool", "link": "https://stackoverflow.com/users/974380/nickool"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1561335175, "post_id": 56728540, "comment_id": 100016914, "body": "it says Bundler could not find compatible versions for gem &quot;nokogiri&quot;:"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1561344183, "post_id": 56728540, "comment_id": 100018079, "body": "Looks like road requires 1.8+, so you&#39;ll want to specify something like <code>~&gt; 1.8</code>. Looking thru nokogiri docs, 1.9.1 looks like where 2.0 support was dropped so you need to find something less than that, but greater than 1.8. It&#39;s not clear why bundler isn&#39;t resolving this for you, but there may be something in your Gemfile.lock that&#39;s causing it (or maybe someone ran a bundle update without any arguments)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561363670, "post_id": 56728540, "comment_id": 100023718, "body": "<i>&quot;maybe someone ran a bundle update without any arguments&quot;</i> -- This. It looks like your dependencies have been messed up due to someone running <code>bundle update</code>. If your code is in source control, you could try reverting whatever the breaking update was; otherwise you&#39;ll need to go through and reverse-engineer downgrading libraries as needed to get your setup working again."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1561363998, "post_id": 56728540, "comment_id": 100023891, "body": "...Or, you could try to upgrade <i>everything</i> -- i.e. use a modern ruby version and a modern redmine version. Your setup is stuck in limbo since several dependencies are updated whilst others are not; and the result is incompatible - hence the errors."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1561393591, "post_id": 56728540, "comment_id": 100040012, "body": "Redmine 3.2 supports Ruby up to version 2.2. You will make life much simpler if you first update Ruby to 2.2 and then subsequently upgrade Redmine to a newer version (at least 3.4). There, you can then again update Ruby to a newer (supported) version such as Ruby 2.4"}], "answers": [{"tags": [], "owner": {"reputation": 3414, "user_id": 974380, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a4f5e1111c01ea94f001d5e28d38051?s=128&d=identicon&r=PG", "display_name": "Nickool", "link": "https://stackoverflow.com/users/974380/nickool"}, "is_accepted": true, "score": 0, "last_activity_date": 1562712223, "last_edit_date": 1562712223, "creation_date": 1561485979, "answer_id": 56759754, "question_id": 56728540, "link": "https://stackoverflow.com/questions/56728540/nokogiri-1-6-8-is-installed-but-gives-error-for-previous-nokogiri-when-running/56759754#56759754", "title": "Nokogiri 1.6.8 is installed but gives error for previous Nokogiri when running &quot;bundle install&quot;", "body": "<p>I could not fix this issue. It was looping through upgrades and downgrades, so after much frustration I tried Ruby 2.6 that Redmine 4.2 claimed to be compatible, which still had issues. I downgraded to Ruby 2.3 and it worked, then I migrated my database according to the redmine.org documentation and almost everything is functional, and I got a feedback that it is much faster.</p>\n\n<p>According to my experience, you will have your Redmine database still working so don't worry that it s the same version.</p>\n"}], "owner": {"reputation": 3414, "user_id": 974380, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a4f5e1111c01ea94f001d5e28d38051?s=128&d=identicon&r=PG", "display_name": "Nickool", "link": "https://stackoverflow.com/users/974380/nickool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4147, "favorite_count": 0, "accepted_answer_id": 56759754, "answer_count": 1, "score": 0, "last_activity_date": 1562712643, "creation_date": 1561334385, "last_edit_date": 1562712643, "question_id": 56728540, "link": "https://stackoverflow.com/questions/56728540/nokogiri-1-6-8-is-installed-but-gives-error-for-previous-nokogiri-when-running", "title": "Nokogiri 1.6.8 is installed but gives error for previous Nokogiri when running &quot;bundle install&quot;", "body": "<p>We had a server shutdown and Redmine stopped working, so I had to reinstall Bundler and run <code>bundle install</code>.</p>\n\n<p>While running <code>bundle install</code> I get this error:</p>\n\n<pre><code>c:\\APPS\\webapps\\redmine-3.2.0&gt;bundle install\nFetching gem metadata from https://rubygems.org/.............\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies....\nUsing rake 12.3.2\nUsing concurrent-ruby 1.1.5\nUsing i18n 0.9.5\nUsing json 1.8.6\nUsing minitest 5.11.3\nUsing thread_safe 0.3.6\nUsing tzinfo 1.2.5\nUsing activesupport 4.2.5\nUsing builder 3.2.3\nUsing erubis 2.7.0\nUsing mini_portile2 2.4.0\nFetching nokogiri 1.9.1 (x64-mingw32)\nInstalling nokogiri 1.9.1 (x64-mingw32)\nGem::RuntimeRequirementNotMetError: nokogiri requires Ruby version &gt;= 2.2, &lt;\n2.6. The current ruby version is 2.0.0.\nAn error occurred while installing nokogiri (1.9.1), and Bundler cannot\ncontinue.\nMake sure that `gem install nokogiri -v '1.9.1' --source\n'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  rails was resolved to 4.2.5, which depends on\n    actionmailer was resolved to 4.2.5, which depends on\n      actionpack was resolved to 4.2.5, which depends on\n        actionview was resolved to 4.2.5, which depends on\n          rails-dom-testing was resolved to 1.0.9, which depends on\n            nokogiri\n</code></pre>\n\n<p>I already installed Nokogiri 1.6.8. I'm not sure why it cannot read the Nokogiri version that I installed and still fetches 1.9.1 because I need Ruby v. 2 for Redmine 2.3.0, however my bundle is still telling me that it is looking for 1.9.1. While doing <code>bundle install</code> I tried changing the Gemfile based on my research to <code>gem \"nokogiri\", \"&gt;= 1.4.2\"</code> however 1.9.1 is persisting. How can I successfully upgrade Nokogiri?</p>\n\n<p>I used: </p>\n\n<pre><code>gem \"nokogiri\", \"1.6.8\"\n</code></pre>\n\n<p>In my Gemfile I have:</p>\n\n<pre><code>c:\\APPS\\webapps\\redmine-3.2.0&gt;bundle update nokogiri\nFetching gem metadata from https://rubygems.org/.............\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies....\nBundler could not find compatible versions for gem \"nokogiri\":\n  In Gemfile:\n    nokogiri (= 1.6.8) java\n\n    roadie-rails java was resolved to 1.2.0, which depends on\n      roadie (~&gt; 3.1) java was resolved to 3.5.0, which depends on\n        nokogiri (~&gt; 1.8) java\n</code></pre>\n\n<p>If I run what <code>gem install nokogiri -v '1.9.1'</code>, I get an error that my Ruby version is lower than expected and I cannot have a higher Ruby version because Redmine is an old version.</p>\n\n<p>Here are all the Nokogiri versions I have:</p>\n\n<pre><code>c:\\APPS\\webapps\\redmine-3.2.0&gt;gem uninstall nokogiri\nYAML safe loading is not available. Please upgrade psych to a version that supports safe loading (&gt;= 2.0).\n\n    Select gem to uninstall:\n    1. nokogiri-1.6.8.rc3-x64-mingw32\n    2. nokogiri-1.6.8-x64-mingw32\n    3. nokogiri-1.6.8.1-x64-mingw32\n    4. All versions\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 11, "user_id": 11689742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecffc8d9bc1a49b6527a53682a04ba7?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/11689742/oscar"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1561342329, "post_id": 56728460, "comment_id": 100017859, "body": "It&#39;s not a duplicate. They&#39;re using a different function, getting different HTML out, and describing a different problem (that everything is wrapped in a label element)."}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1561368113, "post_id": 56728460, "comment_id": 100025969, "body": "Can u post more about the form. From the document I see they have option <code>label: false</code> and <code>label_html: { class: &#39;hidden&#39; }</code>. Are u sure that you use <code>&lt;%= simple_form_for @user do |f| %&gt; </code>"}, {"owner": {"reputation": 11, "user_id": 11689742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecffc8d9bc1a49b6527a53682a04ba7?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/11689742/oscar"}, "reply_to_user": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1561381847, "post_id": 56728460, "comment_id": 100033338, "body": "Sure! I&#39;m adding it as a second edit above."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12320381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzxAuWYwrk0IQabevI1eTVP0tW7vnpTz0xSQuT=k-s128", "display_name": "VINCENT DELACOUR", "link": "https://stackoverflow.com/users/12320381/vincent-delacour"}, "is_accepted": false, "score": 0, "last_activity_date": 1572870763, "last_edit_date": 1572870763, "creation_date": 1572869612, "answer_id": 58693255, "question_id": 56728460, "link": "https://stackoverflow.com/questions/56728460/how-do-i-hide-the-form-title-that-appears-inside-a-legend-tag-when-generating-ch/58693255#58693255", "title": "How do I hide the form title that appears inside a legend tag when generating check boxes for an association using simple-form?", "body": "<p>You can do the following in css:</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>form[name=\"your_form_name\"]&gt;fieldset&gt;legend {\n    display: none;\n}\n</code></pre>\n\n<p>But it's purely cosmetic\n;)</p>\n"}, {"tags": [], "owner": {"reputation": 236, "user_id": 13101388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5TuIk2U1WDg/AAAAAAAAAAI/AAAAAAAAags/AKF05nCB2kLuQbguztJDqQo8lHol4QWmeg/photo.jpg?sz=128", "display_name": "Thomas Van Holder", "link": "https://stackoverflow.com/users/13101388/thomas-van-holder"}, "is_accepted": false, "score": 2, "last_activity_date": 1602660739, "last_edit_date": 1602660739, "creation_date": 1584820609, "answer_id": 60792621, "question_id": 56728460, "link": "https://stackoverflow.com/questions/56728460/how-do-i-hide-the-form-title-that-appears-inside-a-legend-tag-when-generating-ch/60792621#60792621", "title": "How do I hide the form title that appears inside a legend tag when generating check boxes for an association using simple-form?", "body": "<p>You can eliminate the legend that is created by simple form with <code>label: &quot;&quot;</code></p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 13870188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8a190ec268ebcb9ededaf5420e1aebd?s=128&d=identicon&r=PG", "display_name": "Matt Budz", "link": "https://stackoverflow.com/users/13870188/matt-budz"}, "is_accepted": false, "score": 0, "last_activity_date": 1599736742, "creation_date": 1599736742, "answer_id": 63828582, "question_id": 56728460, "link": "https://stackoverflow.com/questions/56728460/how-do-i-hide-the-form-title-that-appears-inside-a-legend-tag-when-generating-ch/63828582#63828582", "title": "How do I hide the form title that appears inside a legend tag when generating check boxes for an association using simple-form?", "body": "<p>According to documentation:</p>\n<pre><code>label: false\n</code></pre>\n<p>should work to hide the generated <code>&lt;legend&gt;</code> element.</p>\n<p>I tested this and found that this in fact does not work.</p>\n<p>The workaround I found to work was:</p>\n<pre><code>label: ''\n</code></pre>\n<p>The <code>&lt;legend&gt;</code> element will still be generated but it will be blank.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11185224, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G0CI1QbV26I/AAAAAAAAAAI/AAAAAAAAAsg/imy2ckaNrGc/photo.jpg?sz=128", "display_name": "\u041a\u0438\u0440\u0438\u043b\u043b \u0417\u0443\u0431\u0430\u0440\u0435\u0432", "link": "https://stackoverflow.com/users/11185224/%d0%9a%d0%b8%d1%80%d0%b8%d0%bb%d0%bb-%d0%97%d1%83%d0%b1%d0%b0%d1%80%d0%b5%d0%b2"}, "is_accepted": false, "score": 3, "last_activity_date": 1605816872, "creation_date": 1605816872, "answer_id": 64919292, "question_id": 56728460, "link": "https://stackoverflow.com/questions/56728460/how-do-i-hide-the-form-title-that-appears-inside-a-legend-tag-when-generating-ch/64919292#64919292", "title": "How do I hide the form title that appears inside a legend tag when generating check boxes for an association using simple-form?", "body": "<p>Hi\ud83d\udc4b I hope this helps someone</p>\n<pre><code>= f.association :menu_item_tags, as: :check_boxes, legend_tag: false\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11689742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecffc8d9bc1a49b6527a53682a04ba7?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/11689742/oscar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1605816872, "creation_date": 1561333258, "last_edit_date": 1561381935, "question_id": 56728460, "link": "https://stackoverflow.com/questions/56728460/how-do-i-hide-the-form-title-that-appears-inside-a-legend-tag-when-generating-ch", "title": "How do I hide the form title that appears inside a legend tag when generating check boxes for an association using simple-form?", "body": "<p>I'm using simple-form (Ruby 2.5.1, Rails 5.2.3, simple-form 4.1.0) to generate checkboxes for an association. The form element it generates includes an overall title for the section that defaults to the name of the association (in this case, \"Menu item tags\") and is inside a  tag. I want to hide it completely, but can't.</p>\n\n<p>I can change the text to \"Test\" using <code>label: \"Test\"</code>, but label: false doesn't hide it like I'd expect. I've read the docs and done my best to read the source, but I can't make any progress.</p>\n\n<p>Here's the simple-form call:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    f.association :menu_item_tags, as: :check_boxes\n</code></pre>\n\n<p>And here's the HTML output:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>    &lt;fieldset class=\"form-group check_boxes optional listing_menus_menu_sections_menu_items_menu_item_tags form-group-valid\"&gt; \n        &lt;legend class=\"col-form-label pt-0\"&gt;Menu item tags&lt;/legend&gt;\n        &lt;input type=\"hidden\" name=\"listing[menus_attributes][0][menu_sections_attributes][0][menu_items_attributes][0][menu_item_tag_ids][]\" value=\"\"&gt;\n        &lt;div class=\"form-check\"&gt;\n            &lt;input class=\"form-check-input is-valid check_boxes optional\" type=\"checkbox\" value=\"1\" checked=\"checked\" name=\"listing[menus_attributes][0][menu_sections_attributes][0][menu_items_attributes][0][menu_item_tag_ids][]\" id=\"listing_menus_attributes_0_menu_sections_attributes_0_menu_items_attributes_0_menu_item_tag_ids_1\"&gt;\n            &lt;label class=\"collection_check_boxes\" for=\"listing_menus_attributes_0_menu_sections_attributes_0_menu_items_attributes_0_menu_item_tag_ids_1\"&gt;Vegetarian&lt;/label&gt;\n        &lt;/div&gt;\n    &lt;/fieldset&gt;\n</code></pre>\n\n<p>I need to remove the  tag on the second line of the HTML. label: false seems like the obvious convention, but it doesn't work.</p>\n\n<p><strong>Edit:</strong> This is not a duplicate of <a href=\"https://stackoverflow.com/questions/37975486/remove-outer-label-from-collection-check-boxes\">Remove outer label from collection_check_boxes</a>. They're using a different function, getting different HTML out, and describing a different problem (that everything is wrapped in a label element). And the solution doesn't fix or affect the behavior I'm describing.</p>\n\n<p><strong>Edit:</strong> Here's a simplified version of the form in question, in response to a comment below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= simple_form_for @listing do |f| %&gt;\n  &lt;%= f.simple_fields_for :menus do |f| %&gt;\n    &lt;%= f.simple_fields_for :menu_sections do |f| %&gt;\n      &lt;%= f.simple_fields_for :menu_items do |f| %&gt;\n        &lt;%= f.association :menu_item_tags, as: :check_boxes %&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "selenium-chromedriver", "watir"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1561382244, "post_id": 56727998, "comment_id": 100033556, "body": "Please write this and check<code>browser = Watir::Browser.new :chrome, args: args, options: {prefs: prefs}</code> It works for me."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 9513734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc37f55b3fe152dc0fbc2c9fa43b15d1?s=128&d=identicon&r=PG&f=1", "display_name": "I.M.", "link": "https://stackoverflow.com/users/9513734/i-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1561412267, "creation_date": 1561412267, "answer_id": 56744254, "question_id": 56727998, "link": "https://stackoverflow.com/questions/56727998/problems-initialising-browser-with-options-using-ruby-watir-chrome/56744254#56744254", "title": "Problems initialising browser with options using Ruby, Watir, Chrome", "body": "<p>Taken from help I got elsewhere: </p>\n\n<pre><code>options = Selenium::WebDriver::Chrome::Options.new.tap do |o|\n  o.add_argument('--disable-infobars')   \n  o.add_preference(:download, directory_upgrade: true,\n                              prompt_for_download: false,\n                              default_directory: 'C:\\\\DownloadFolder\\\\')   \n  o.add_option(:detach, true)  \nend                       \n\nbrowser = Watir::Browser.new :chrome, options: options\n</code></pre>\n\n<p>Two things solved the problem. 1 is specifying the options through selenium rather that Watir. The other is no longer being able to use single forward slashes in folder paths. </p>\n"}], "owner": {"reputation": 35, "user_id": 9513734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc37f55b3fe152dc0fbc2c9fa43b15d1?s=128&d=identicon&r=PG&f=1", "display_name": "I.M.", "link": "https://stackoverflow.com/users/9513734/i-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561412267, "creation_date": 1561326741, "last_edit_date": 1561327226, "question_id": 56727998, "link": "https://stackoverflow.com/questions/56727998/problems-initialising-browser-with-options-using-ruby-watir-chrome", "title": "Problems initialising browser with options using Ruby, Watir, Chrome", "body": "<p>I have a few web-scraping scripts that I've been using for a while now that have been working without issue. However because of an update of something somewhere (I think chrome+chromedriver), the the browsers are not loading with the preferences/options I specify. </p>\n\n<p>Current code: </p>\n\n<pre><code>preferences = { \n  :download =&gt; {\n    :prompt_for_download =&gt; false,\n    :directory_upgrade =&gt; true,\n    :default_directory =&gt; 'C:/DownloadFolder/', \n  }   \n}   \nargs = ['--disable-infobars']\nbrowser = Watir::Browser.new :chrome, :chrome_options =&gt; {:detach =&gt; true, :prefs =&gt; preferences, :args =&gt; args}\n</code></pre>\n\n<p>The problems I'm noticing are that the '--disable-infobars' and download folder location are not being applied. </p>\n\n<p>ruby version: 2.3.3p222</p>\n\n<p>watir version: 6.16.5</p>\n\n<p>selenium webdriver version: 3.142.3</p>\n\n<p>chrome version: 75.0.3770.100</p>\n\n<p>chromedriver version : 75.0.3770.90</p>\n"}, {"tags": ["ruby", "hashmap"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561330057, "post_id": 56727562, "comment_id": 100016252, "body": "Here&#39;s a way to do that without mutating the original hash: <code>my_hash.merge(my_hash) { |*,n| n.last } #=&gt; {&quot;positions&quot;=&gt;[2, 3, 13]}</code>. I prefer   @Sebastian&#39;s solution, but this may be useful if it is necessary to support Ruby versions prior to 2.4, when <a href=\"http://ruby-doc.org/core-2.6.3/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a> may its debut."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561364210, "post_id": 56727562, "comment_id": 100024006, "body": "Deleting the first inner array would result in <code>[[2, 3, 13]]</code> \u2013 do you also want to flatten the outer array? Or maybe replace the outer array by its 2nd element?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561367866, "post_id": 56727562, "comment_id": 100025822, "body": "<code>my_hash[&#39;positions&#39;] = my_hash[&#39;positions&#39;][1]</code> might be what you are looking for \u2013 it assigns to key <code>&#39;positions&#39;</code> the first element of the array it is holding."}], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1561323057, "post_id": 56727601, "comment_id": 100015057, "body": "<code>shift</code> returns something like <code>[[2, 3, 13]]</code>."}, {"owner": {"reputation": 2358, "user_id": 1072281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5900eea054e31a49f94492cc5618ee17?s=128&d=identicon&r=PG&f=1", "display_name": "colinux", "link": "https://stackoverflow.com/users/1072281/colinux"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1561323396, "post_id": 56727601, "comment_id": 100015110, "body": "Yes, indeed <code>shift</code> is mutating the double array"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1561325679, "post_id": 56727601, "comment_id": 100015566, "body": "<code>shift</code> returns the element that shifted from the array but if you don&#39;t assign it to anything then Ruby will ignore it. Some demonstration code would help the OP visualize how it works."}], "tags": [], "owner": {"reputation": 2358, "user_id": 1072281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5900eea054e31a49f94492cc5618ee17?s=128&d=identicon&r=PG&f=1", "display_name": "colinux", "link": "https://stackoverflow.com/users/1072281/colinux"}, "is_accepted": false, "score": 3, "last_activity_date": 1561322678, "creation_date": 1561322678, "answer_id": 56727601, "question_id": 56727562, "link": "https://stackoverflow.com/questions/56727562/how-to-delete-an-array-inside-a-hash/56727601#56727601", "title": "How to delete an array inside a hash", "body": "<p><code>pop</code> is removing the last element of an array. Try <code>shift</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1561324135, "last_edit_date": 1561324135, "creation_date": 1561323018, "answer_id": 56727636, "question_id": 56727562, "link": "https://stackoverflow.com/questions/56727562/how-to-delete-an-array-inside-a-hash/56727636#56727636", "title": "How to delete an array inside a hash", "body": "<p>You can use <code>transform_values</code> and select the second element from the array in <code>positions</code>:</p>\n\n<pre><code>my_hash = {\"positions\"=&gt;[[2, 3, 13, 56], [2, 3, 13]]}\nwanted_hash = my_hash.transform_values { |value| value[1] }\n# {\"positions\"=&gt;[2, 3, 13]}\n</code></pre>\n\n<p>Notice it doesn't modify <code>my_hash</code>, it returns a new object.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 10049490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7fbd0da6a6d265009e468801b0a626c?s=128&d=identicon&r=PG&f=1", "display_name": "Sindhu Shree", "link": "https://stackoverflow.com/users/10049490/sindhu-shree"}, "is_accepted": false, "score": 0, "last_activity_date": 1561520717, "last_edit_date": 1561520717, "creation_date": 1561382171, "answer_id": 56737420, "question_id": 56727562, "link": "https://stackoverflow.com/questions/56727562/how-to-delete-an-array-inside-a-hash/56737420#56737420", "title": "How to delete an array inside a hash", "body": "<p>Carried out this series of steps in irb. This is assuming that you want to mutate my_hash:</p>\n\n<pre><code>my_hash = {\"positions\"=&gt;[[2, 3, 13, 56], [2, 3, 13]]}\n#\u00a0=&gt; {\"positions\"=&gt;[[2, 3, 13, 56], [2, 3, 13]]} \nmy_hash[\"positions\"].shift\n# =&gt; [2, 3, 13, 56] \nmy_hash\n# =&gt; {\"positions\"=&gt;[[2, 3, 13]]} \nmy_hash[\"positions\"].flatten!\n# =&gt; [2, 3, 13] \nmy_hash\n# =&gt; {\"positions\"=&gt;[2, 3, 13]} \n</code></pre>\n\n<p>So, it comes down to:</p>\n\n<pre><code>my_hash[\"positions\"].shift\nmy_hash[\"positions\"].flatten!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 1449406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkyLF.jpg?s=128&g=1", "display_name": "Nataniele", "link": "https://stackoverflow.com/users/1449406/nataniele"}, "is_accepted": false, "score": 0, "last_activity_date": 1562762814, "last_edit_date": 1562762814, "creation_date": 1562762370, "answer_id": 56970919, "question_id": 56727562, "link": "https://stackoverflow.com/questions/56727562/how-to-delete-an-array-inside-a-hash/56970919#56970919", "title": "How to delete an array inside a hash", "body": "<p>This can be done with non-destructive <code>each_with)object</code> method:</p>\n\n<p><code>my_hash.each_with_object({}) { |(k, v), h| h[k] = v[1]}</code>.</p>\n\n<p>If you use ruby version &lt; 2.4.0 (where <code>transform_values</code> method was introduced) this could help. </p>\n"}], "owner": {"reputation": 141, "user_id": 10270808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d699eeebe7ca0b03df8404922909490?s=128&d=identicon&r=PG&f=1", "display_name": "Ronnie Wiesenhower", "link": "https://stackoverflow.com/users/10270808/ronnie-wiesenhower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 56727636, "answer_count": 4, "score": 1, "last_activity_date": 1562762814, "creation_date": 1561322292, "last_edit_date": 1561324102, "question_id": 56727562, "link": "https://stackoverflow.com/questions/56727562/how-to-delete-an-array-inside-a-hash", "title": "How to delete an array inside a hash", "body": "<p>I have a hash that looks like this:</p>\n\n<pre><code>my_hash = {\"positions\"=&gt;[[2, 3, 13, 56], [2, 3, 13]]}\n</code></pre>\n\n<p>I would like to delete the first array inside of the hash:</p>\n\n<pre><code>wanted_hash == {\"positions\"=&gt; [2, 3, 13]}\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>wanted_hash = my_hash.values[0].pop\n</code></pre>\n\n<p>but this removes the wrong array. I'm not sure why, but it removes <code>[2,3,13]</code>.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1561328001, "post_id": 56727409, "comment_id": 100015972, "body": "<code>code_duplicate = @code</code> does not duplicate @code."}, {"owner": {"reputation": 15, "user_id": 10859983, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-brMrOIeLDIc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZuUJwW_Z54tcg-3odPQEYX6P4ojA/mo/photo.jpg?sz=128", "display_name": "Eojo", "link": "https://stackoverflow.com/users/10859983/eojo"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1561330430, "post_id": 56727409, "comment_id": 100016296, "body": "Does it not copy the instance variable @code into a method level variable called code_duplicate?  That is a method from a different class, which I put in because it was referenced above. It seems to be working correctly."}, {"owner": {"reputation": 318, "user_id": 3664194, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001800281383/picture?type=large", "display_name": "Michael Kosyk", "link": "https://stackoverflow.com/users/3664194/michael-kosyk"}, "edited": false, "score": 0, "creation_date": 1561374875, "post_id": 56727409, "comment_id": 100029500, "body": "@Eojo - no, that is only copying a <code>reference</code> to that variable."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10859983, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-brMrOIeLDIc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZuUJwW_Z54tcg-3odPQEYX6P4ojA/mo/photo.jpg?sz=128", "display_name": "Eojo", "link": "https://stackoverflow.com/users/10859983/eojo"}, "edited": false, "score": 0, "creation_date": 1561392851, "post_id": 56737181, "comment_id": 100039663, "body": "Interesting.  I changed it as advised.  It didn&#39;t fix the behavior of the cull_set method (it&#39;s still getting wiped out after the first guess), but it&#39;s certainly good to know. I appreciate it."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 15, "user_id": 10859983, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-brMrOIeLDIc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZuUJwW_Z54tcg-3odPQEYX6P4ojA/mo/photo.jpg?sz=128", "display_name": "Eojo", "link": "https://stackoverflow.com/users/10859983/eojo"}, "edited": false, "score": 0, "creation_date": 1561490638, "post_id": 56737181, "comment_id": 100078971, "body": "so there might be another problem. it&#39;s a bit hard to understand the code without running it. can you share a full version?"}, {"owner": {"reputation": 15, "user_id": 10859983, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-brMrOIeLDIc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZuUJwW_Z54tcg-3odPQEYX6P4ojA/mo/photo.jpg?sz=128", "display_name": "Eojo", "link": "https://stackoverflow.com/users/10859983/eojo"}, "edited": false, "score": 0, "creation_date": 1561509115, "post_id": 56737181, "comment_id": 100084102, "body": "I actually got it working.  Instead of trying to fix what was there, I rewrote a couple of the methods involved from scratch and it resolved the issue.  I&#39;m a little burnt out on the project and have moved on, but I&#39;ll go back, pin-point the bug and post the solution.  Thanks for your help!"}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1561381627, "last_edit_date": 1561381627, "creation_date": 1561381303, "answer_id": 56737181, "question_id": 56727409, "link": "https://stackoverflow.com/questions/56727409/trying-to-cull-a-set-but-the-set-keeps-disappearing/56737181#56737181", "title": "Trying to cull a set but the set keeps disappearing", "body": "<p>Try </p>\n\n<pre><code>copy = something.dup\n</code></pre>\n\n<p>because after just </p>\n\n<pre><code>copy = something\n</code></pre>\n\n<p><code>copy</code> and <code>something</code>  are pointing to the same object. You can confirm this by checking the <code>object_id</code> of the object referenced by the variable. If it is the same, then it is the same object.</p>\n\n<p>When you <code>dup</code> an object, you will cretae a copy. Depending on what you want to <code>dup</code> you might need to implement/override the logic to create a copy. For built in Classes like <code>String</code>, <code>Hash</code> and so on it will work out of the box.</p>\n\n<p>Be aware that nested constructs (eq. Hash containing other Hashes) are not duplicated.</p>\n\n<pre><code>h1 = {\"a\" =&gt; {\"b\" =&gt; 2}}\nh2 = h1.dup\nputs h1.object_id      # 70199597610060\nputs h2.object_id      # 70199597627020\nputs h1[\"a\"].object_id # 70199597610080 \nputs h2[\"a\"].object_id # 70199597610080\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10859983, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-brMrOIeLDIc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZuUJwW_Z54tcg-3odPQEYX6P4ojA/mo/photo.jpg?sz=128", "display_name": "Eojo", "link": "https://stackoverflow.com/users/10859983/eojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561381627, "creation_date": 1561320771, "question_id": 56727409, "link": "https://stackoverflow.com/questions/56727409/trying-to-cull-a-set-but-the-set-keeps-disappearing", "title": "Trying to cull a set but the set keeps disappearing", "body": "<p>I'm trying to program the AI for a Mastermind game in ruby using Donal Knuth's 5 guess algorithm.  The game consists of a codemaker, who uses 8 different colored pegs to create a set of 4, and a codebreaker, who guesses at the code and receives feedback (a red square for a peg which is both the right color and in the right spot, and a white square for a peg which is the right color but in the wrong spot). </p>\n\n<p>I've created a set for all possible codes.  My goal is to compare feedback from the guess to feedback from all codes in the set, then delete the ones that don't match.  It seems to delete the entire set though.</p>\n\n<pre><code>class ComputerPlayer &lt; Player\n  def initialize(game)\n    super(game)\n    @all_possible_codes = create_codes\n    @turn = 1\n  end\n\n  def get_code\n    Array.new(4){rand(1..6)}\n  end\n\n  def get_guess\n    puts @all_possible_codes.length\n    if @turn == 0\n      @turn += 1\n      cull_set([1, 1, 2, 2])\n      @all_possible_codes.delete(\"1122\")\n      return [1, 1, 2, 2]\n    else \n      random_sample = @all_possible_codes.to_a.sample.split('').map{|str| str.to_i}\n      @all_possible_codes.delete(random_sample.join(''))\n      cull_set(random_sample)\n      random_sample\n    end\n  end\n\n  def cull_set(guess)\n    feedback = @game.feedback_on_guess(guess)\n    puts feedback\n    @all_possible_codes.delete_if { |str| @game.feedback_on_guess(str.split.map{|num| num.to_i}) != feedback }\n  end\n\n  def create_codes\n    set = Set.new\n    (1..8).each do |i|\n      (1..8).each do |j|\n        (1..8).each do |k|\n          (1..8).each do |l|\n            set &lt;&lt; [i, j, k, l].join('')\n          end\n        end\n      end\n    end\n    set\n  end\nend\n\n#this is the feedback_on_guess method used by the above class\n\ndef feedback_on_guess(code_guess)\n    code_duplicate = @code\n    feedback = []\n    code_duplicate.map.with_index do |entry, i|\n      if entry == code_guess[i]\n        feedback.push('r')\n        code_guess[i] = -1\n        -2\n      else\n      entry\n      end\n    end.each do |entry|\n      found_index = code_guess.find_index(entry)\n      if found_index\n        feedback.push('g')\n        code_guess[found_index] = -1\n      end\n    end\n    puts feedback\n    feedback\n  end\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1561313642, "post_id": 56726498, "comment_id": 100013067, "body": "Perfect. it worked I just have one more question. I tried this way   User.joins(:roles,:permission).where(&#39;roles.name in (?)&#39;, [&#39;admin&#39;, &#39;sub_admin&#39;, &#39;super_admin&#39;]).update(can_view_details: true). It worked as well but it took a lot of time"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 1, "creation_date": 1561314011, "post_id": 56726498, "comment_id": 100013151, "body": "Hey, you can see in the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html#method-i-update\" rel=\"nofollow noreferrer\">docs</a>, it states that <i>updating a large number of records will run an UPDATE query for each record, which may cause a performance issue</i>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1561313503, "last_edit_date": 1561313503, "creation_date": 1561312741, "answer_id": 56726498, "question_id": 56726413, "link": "https://stackoverflow.com/questions/56726413/update-specific-column-using-update-all-while-doing-joins/56726498#56726498", "title": "Update specific column using update_all while doing joins", "body": "<p>Try getting the permissions right from the model, but using joins with User:</p>\n\n<pre><code>Permission.\n  joins(user: :roles).\n  where('users.roles IN (?)', %w[admin sub_admin super_admin]).\n  update_all(can_view_details: true)\n</code></pre>\n"}], "owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56726498, "answer_count": 1, "score": 1, "last_activity_date": 1561313503, "creation_date": 1561312038, "question_id": 56726413, "link": "https://stackoverflow.com/questions/56726413/update-specific-column-using-update-all-while-doing-joins", "title": "Update specific column using update_all while doing joins", "body": "<p>I have an association something like below</p>\n\n<p>User has_many roles<br/>\nUser has_one permission</p>\n\n<p>Table names\nusers, roles and permissions and they are under the same schema and database</p>\n\n<p>I want to fetch the roles which are admin,super_admin,sub_admin. And want to update a column in the permission table</p>\n\n<pre><code> User.joins(:roles,:permission).where('roles.name in (?)', ['admin', 'sub_admin', 'super_admin']).select(\"permissions.*\").update_all('permission.can_view_details', true)\n</code></pre>\n\n<p>Firing the above query is giving me error.</p>\n\n<p>Caused by PG::UndefinedColumn: ERROR:  column \"can_view_details\" of relation \"users\" does not exist\nLINE 1: UPDATE \"schema\".\"users\" SET \"can_view_details\" =...</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1561342774, "post_id": 56726280, "comment_id": 100017928, "body": "Are you sure that your <code>@user</code> is activated? To check it add <code>p @user.activated?</code> as first line inside <code>valid_user</code> method, try to reset password again and look at the logs"}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1561417817, "post_id": 56726280, "comment_id": 100048681, "body": "I actually resolved this by ignoring it, pushing to production, somehow working in production, and it works locally too... @_@"}], "owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561314611, "creation_date": 1561311001, "last_edit_date": 1561314611, "question_id": 56726280, "link": "https://stackoverflow.com/questions/56726280/rails-wont-bring-me-to-the-reset-password-form-constantly-redirecting-me", "title": "Rails won&#39;t bring me to the Reset Password Form, constantly redirecting me", "body": "<p>I am following Michael Hartl's Ruby Tutorial guide and I'm on Lesson 12\uff1a Password Reset Form.</p>\n\n<p>My problem is when testing locally, it won't take me to the reset passwords form. I can see in my logs that it TRIES TO, but instead ends up redirecting me to the home page (\"/\" root). I have no idea why it's doing this as I am following the tutorial. But it works in production! I have the entire GitHub repo <a href=\"https://github.com/wangjess/sample_app\" rel=\"nofollow noreferrer\">here</a> if anyone wants to take a look. </p>\n\n<p>I have verified that my <code>routes.rb</code> is correct as I see the password reset URL using <code>rake rails</code>. I have also verified that it is <em>indeed</em> redirecting me to / as it is in the server logs:</p>\n\n<pre><code>Started GET \"/password_resets/D7-YG1GP-RNkdVJFp4PwjQ/edit?email=jessica@example.com\" for 127.0.0.1 at 2019-06-23 13:13:20 -0400\nProcessing by PasswordResetsController#edit as HTML\n  Parameters: {\"email\"=&gt;\"jessica@example.com\", \"id\"=&gt;\"D7-YG1GP-RNkdVJFp4PwjQ\"}\n  User Load (1.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"email\" = ? LIMIT ?  [[\"email\", \"jessica@example.com\"], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/password_resets_controller.rb:45\nRedirected to http://0.0.0.0:3000/\nFilter chain halted as :valid_user rendered or redirected\nCompleted 302 Found in 2ms (ActiveRecord: 1.0ms)\n</code></pre>\n\n<p>Looks like the culprit is <code>valid_user</code> function, but it looks fine to me. Basically, the user needs to exist in the database, be activated, and authenticated using tokens. Otherwise, you get redirected.</p>\n\n<pre><code># Confirms a valid user.\n    def valid_user\n        unless (@user &amp;&amp; @user.activated? &amp;&amp;\n            @user.authenticated?(:reset, params[:id]))\n        redirect_to root_url\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "answers": [{"comments": [{"owner": {"reputation": 1058, "user_id": 676119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7487ed31a1105813d1a8b3a85dc4eee?s=128&d=identicon&r=PG", "display_name": "Roman Gaufman", "link": "https://stackoverflow.com/users/676119/roman-gaufman"}, "edited": false, "score": 0, "creation_date": 1563107518, "post_id": 56743573, "comment_id": 100584071, "body": "Yes, I understand this is what it is expecting. My question is how can I force the old behaviour that Mongoid ~6 had of not requiring User::AuditSession and just using AuditSession."}, {"owner": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "reply_to_user": {"reputation": 1058, "user_id": 676119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7487ed31a1105813d1a8b3a85dc4eee?s=128&d=identicon&r=PG", "display_name": "Roman Gaufman", "link": "https://stackoverflow.com/users/676119/roman-gaufman"}, "edited": false, "score": 0, "creation_date": 1563216084, "post_id": 56743573, "comment_id": 100618543, "body": "I don&#39;t know the details of your application and why its behavior changed, other than as far as I know Rails has had the behavior I described for a long time. I imagine creating a small reproduce case of the &quot;old behavior&quot; ( i.e. an application with a single model in the &quot;wrong&quot; location) would help to shed light on why it was the way it was."}], "tags": [], "owner": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "is_accepted": false, "score": 0, "last_activity_date": 1561408349, "creation_date": 1561408349, "answer_id": 56743573, "question_id": 56725724, "link": "https://stackoverflow.com/questions/56725724/mogoid-7-0-4-returns-unable-to-autoload-constant-mongoid-6-worked-fine/56743573#56743573", "title": "Mogoid 7.0.4 returns Unable to autoload constant (Mongoid ~6 worked fine)", "body": "<p>Per the Rails conventions, if the model is defined in <code>user/audit_session.rb</code>, the class name should be <code>User::AuditSession</code>.</p>\n\n<p>A workaround is to preload the class so that it is loaded by the time it is needed. Depending on where the class is used from, this could be as simple as placing</p>\n\n<pre><code>require 'user/audit_session'\n</code></pre>\n\n<p>in the file that uses AuditSession.</p>\n\n<p>Alternatively you could define a top-level <code>audit_session.rb</code> which includes the other file (i.e. just has the above include in it).</p>\n"}], "owner": {"reputation": 1058, "user_id": 676119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7487ed31a1105813d1a8b3a85dc4eee?s=128&d=identicon&r=PG", "display_name": "Roman Gaufman", "link": "https://stackoverflow.com/users/676119/roman-gaufman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561408349, "creation_date": 1561306675, "last_edit_date": 1561317232, "question_id": 56725724, "link": "https://stackoverflow.com/questions/56725724/mogoid-7-0-4-returns-unable-to-autoload-constant-mongoid-6-worked-fine", "title": "Mogoid 7.0.4 returns Unable to autoload constant (Mongoid ~6 worked fine)", "body": "<p>When I try to upgrade to Mongoid ~7, it throws this error:</p>\n\n<pre><code>            Unable to autoload constant User::AuditSession, expected ./testapp/app/models/user/audit_session.rb to define it\n</code></pre>\n\n<p>I indeed have this file, but it defines AuditSession, not User::AuditSession. I put all the user related models into this directory which worked in Mongoid ~6, but it seems to no longer work in Mongoid ~7.</p>\n\n<p>Is there any workaround I can do to get the old behaviour? - My goal is to avoid moving all my model files or editing all my class names.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 2358, "user_id": 1072281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5900eea054e31a49f94492cc5618ee17?s=128&d=identicon&r=PG&f=1", "display_name": "colinux", "link": "https://stackoverflow.com/users/1072281/colinux"}, "edited": false, "score": 1, "creation_date": 1561307089, "post_id": 56725677, "comment_id": 100011554, "body": "I don&#39;t understand your desired output <code>{ &#39;a&#39; =&gt; 1, c =&gt; &#39;2&#39; }</code> from your input. Can you elaborate ?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1561307091, "post_id": 56725677, "comment_id": 100011555, "body": "Can you explain how <code>{&#39;a&#39; =&gt; 1, c =&gt; &#39;2&#39;}</code> is an extract of the &quot;unique values&quot; for the input?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11652832"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1561307704, "post_id": 56725677, "comment_id": 100011696, "body": "@maxpleaner Sure, for example the key &#39;a&#39; has 2 values(c, b) that are not unique, because they are present in &#39;b&#39; also.  In that case it should return { &#39;a&#39; =&gt; 1} since &#39;d&#39; is the unique value. Same goes for &#39;b&#39; that has 2 common values with a, but 2 unique ones as well."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561308719, "post_id": 56725677, "comment_id": 100011962, "body": "It appears you mean, &quot;extract the <i>number</i> of unique values for each key&quot;, not the unique values themselves. If so, please edit. You also need to explain what you mean by &quot;unique&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561314161, "post_id": 56725677, "comment_id": 100013194, "body": "Whenever you give an example it&#39;s helpful to assign a variable to each input. (Here <code>h = {...}</code>, from my edit.) That way readers can refer to those variables in answers and comments without having to define them, and all readers refer to the same variable names. You may also find it helpful to make the statement of the question precise and unambiguous (see my edit of your question). Lastly, it facilitates cut-and-paste."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561395549, "post_id": 56725946, "comment_id": 100040895, "body": "@Stefan, I was <a href=\"https://www.usingenglish.com/reference/idioms/asleep+at+the+switch.html\" rel=\"nofollow noreferrer\">asleep at the switch</a>. Fixed."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1561396085, "last_edit_date": 1561396085, "creation_date": 1561308235, "answer_id": 56725946, "question_id": 56725677, "link": "https://stackoverflow.com/questions/56725677/given-a-hash-with-an-array-of-values-how-to-extract-numbers-of-unique-values-of/56725946#56725946", "title": "Given a hash with an array of values, how to extract numbers of unique values of each key?", "body": "<p>This should meet your requirements.</p>\n\n<pre><code>def uniqify(h)\n  keys = h.keys\n  keys.each_with_object({}) { |k,g| g[k] =\n    (keys-[k]).reduce(h[k]) { |a,kk| a-h[kk] }.uniq.size } }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>h = { 'cat' =&gt; ['c', 'b', 'e', 'f', 'c'],\n      'dog' =&gt; ['c', 'b', 'f', 'g', 'h'] }\n\nuniqify h\n  #=&gt; {\"cat\"=&gt;1, \"dog\"=&gt;2}\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>h = { 'cat' =&gt; ['c', 'b', 'd', 'c', 'e', 'f'],\n      'dog' =&gt; ['c', 'b', 'f', 'g'],\n      'pig' =&gt; ['h', 'h', 'b', 'f'] }\n\nuniqify h\n  #=&gt; {\"cat\"=&gt;2, \"dog\"=&gt;1, \"pig\"=&gt;1}\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-2D\" rel=\"nofollow noreferrer\">Array#-</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 180, "user_id": 1881608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef99f58ba5a8d821ac4cb357b4478d0?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1881608/praveen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561454648, "post_id": 56737858, "comment_id": 100059303, "body": "@CarySwoveland - Here in this example value itself has a duplicate. I have updated my answer to skip the duplicate in self array."}], "tags": [], "owner": {"reputation": 180, "user_id": 1881608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef99f58ba5a8d821ac4cb357b4478d0?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1881608/praveen"}, "is_accepted": true, "score": 1, "last_activity_date": 1561454520, "last_edit_date": 1561454520, "creation_date": 1561383594, "answer_id": 56737858, "question_id": 56725677, "link": "https://stackoverflow.com/questions/56725677/given-a-hash-with-an-array-of-values-how-to-extract-numbers-of-unique-values-of/56737858#56737858", "title": "Given a hash with an array of values, how to extract numbers of unique values of each key?", "body": "<p>Below code would work with more than two keys also</p>\n\n<pre><code>h = {\n  'a' =&gt; ['c', 'b', 'd'],\n  'b' =&gt; ['c', 'b', 'f', 'g']\n}\ng={}\n\nall_values = h.values.flatten\nuniq_elements = all_values.select{|element| all_values.count(element) == 1 }\nh.each do |k,v|\n  g[k] = (v &amp; uniq_elements).count\nend\ng\n</code></pre>\n\n<p>If we don't want to check duplicates in self array of hash then we can collect uniq like below</p>\n\n<pre><code>h = { 'cat' =&gt; ['c', 'b', 'd', 'c', 'e', 'f'],\n      'dog' =&gt; ['c', 'b', 'f', 'g'],\n      'pig' =&gt; ['h', 'h', 'b', 'f'] }\n\ng={}\n\nall_values = h.values.collect{|val| val.uniq}.flatten\nuniq_elements = all_values.select{|element| all_values.count(element) == 1 }\nh.each do |k,v|\n  g[k] = (v &amp; uniq_elements).count\nend\ng\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11652832"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56737858, "answer_count": 2, "score": 0, "last_activity_date": 1561454520, "creation_date": 1561306247, "last_edit_date": 1561313954, "question_id": 56725677, "link": "https://stackoverflow.com/questions/56725677/given-a-hash-with-an-array-of-values-how-to-extract-numbers-of-unique-values-of", "title": "Given a hash with an array of values, how to extract numbers of unique values of each key?", "body": "<p>I have a hash that has an array of values for each key: </p>\n\n<pre><code>h = {\n  'a' =&gt; ['c', 'b', 'd'],\n  'b' =&gt; ['c', 'b', 'f', 'g']\n}\n</code></pre>\n\n<p>I need to return a hash <code>g</code> that gives the number of \"unique\" values of each key in <code>h</code>. For example, <code>h['a']</code> has 2 values (<code>'c'</code> and <code>b'</code>) that are not unique in the sense that they are present in <code>h['b']</code>. In that case the value of <code>'a'</code> in <code>g</code> should equal <code>1</code> since <code>'d'</code> is the only unique element of <code>h['a']</code>. The same goes for the key <code>'b'</code>. It has 2 common values with <code>'a'</code> in <code>h</code>, but 2 unique ones as well (<code>'f'</code> and <code>g'</code>). So in my case the <code>g</code> should equal <code>{'a' =&gt; 1,</code>b<code>=&gt; 2}</code>.</p>\n\n<p>I have tried <code>h.select { |_,a| a.size == 1 }</code>, but it returns an empty hash.</p>\n\n<p>Also, I have a way of returning the unique values but when I'm trying to write the Rspec test it fails, the solution I have is the following:</p>\n\n<pre><code>@split_log_file.each { |key, array|\n  \"#{key} has #{array.uniq.length} unique visitors\" }\n</code></pre>\n"}, {"tags": ["ruby", "class", "inheritance"], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 4, "creation_date": 1561315001, "post_id": 56725718, "comment_id": 100013422, "body": "This means, however, that you can only have one subclasss, since for every single instance you create, you overwrite the method. So, if you have different subclasses, you would overwrite the method with different implementations, which means that whatever class you instantiate last, <i>all</i> objects which behave like that, regardless of which subclass they are an instance of. Now, since all your subclasses are going to end up behaving the same, you might just as well not have different subclasses at all, and if you have only one subclass, then you might just as well have no subclasses at all."}, {"owner": {"reputation": 2146, "user_id": 1949759, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LAldS.jpg?s=128&g=1", "display_name": "wout", "link": "https://stackoverflow.com/users/1949759/wout"}, "edited": false, "score": 0, "creation_date": 1561362233, "post_id": 56725718, "comment_id": 100023092, "body": "@colinux You are right, the method way might be the most elegant after all."}], "tags": [], "owner": {"reputation": 2358, "user_id": 1072281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5900eea054e31a49f94492cc5618ee17?s=128&d=identicon&r=PG&f=1", "display_name": "colinux", "link": "https://stackoverflow.com/users/1072281/colinux"}, "is_accepted": false, "score": 2, "last_activity_date": 1561321595, "last_edit_date": 1561321595, "creation_date": 1561306629, "answer_id": 56725718, "question_id": 56725597, "link": "https://stackoverflow.com/questions/56725597/how-to-make-alias-method-in-ruby-use-the-sub-class-custom-method/56725718#56725718", "title": "How to make alias_method in Ruby use the sub-class&#39; custom method?", "body": "<p>This is because <code>alias_method</code> treats <code>self</code> at runtime.</p>\n\n<p><strong>Edit</strong>\nAs @J\u00f6rg commented, my solution can cause some troubles depending of your application (multithreading environment\u2026). The <code>to_s</code> implementation like you suggested is probably the best, and not especially less elegant IMO.</p>\n\n<p>One way would be to declare the alias at initialize (on the class).</p>\n\n<pre><code>class Beer\n  def initialize\n    self.class.alias_method :to_s, :bottle_content\n  end\n\n  def bottle_content\n    '250 ml'\n  end\nend\n</code></pre>\n\n<p>This way the alias is created on the class of the instance, ie. <code>Duvel</code> in your example.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1561328661, "creation_date": 1561328661, "answer_id": 56728132, "question_id": 56725597, "link": "https://stackoverflow.com/questions/56725597/how-to-make-alias-method-in-ruby-use-the-sub-class-custom-method/56728132#56728132", "title": "How to make alias_method in Ruby use the sub-class&#39; custom method?", "body": "<p>For reasons I will explain, you cannot, from <code>Beer</code>, create an alias to a method in a subclass, for that subclass, at the time the subclass is created.</p>\n\n<p>Using the callback <a href=\"https://ruby-doc.org/core-2.5.0/Class.html#method-i-inherited\" rel=\"nofollow noreferrer\">Class#inherited</a>, however, we can do something close to what you want to achieve:</p>\n\n<pre><code>class Beer\n  def bottle_content\n    '250 ml'\n  end\n\n  alias_method :to_s, :bottle_content\n\n  def self.inherited(klass)\n    klass.define_method(:to_s) { bottle_content }\n  end\nend\n\nclass Duvel &lt; Beer\n  def bottle_content\n    '330 ml'\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Beer.new.to_s\n  #=&gt; \"250 ml\" \nDuvel.new.to_s\n  #=&gt; \"330 ml\"\n</code></pre>\n\n<p>The problem is that <code>Beer::inherited</code> is called right after <code>class Duvel &lt; Beer</code> is executed, before the method <code>Duvel#bottle_content</code> is defined. If we were to change the operative line of <code>Beer::inherited</code> to</p>\n\n<pre><code>klass.alias_method(:to_s, :bottle_content)\n</code></pre>\n\n<p>that would bind <code>Duvel#to_s</code> to <code>Beer#bottle_content</code>, as <code>Duvel#bottle_content</code> has not yet been defined.</p>\n"}, {"comments": [{"owner": {"reputation": 5019, "user_id": 200122, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/325a6cdf06dbd60d2ce88bb6851d974c?s=128&d=identicon&r=PG", "display_name": "Mirko", "link": "https://stackoverflow.com/users/200122/mirko"}, "edited": false, "score": 0, "creation_date": 1601303749, "post_id": 56728184, "comment_id": 113358130, "body": "just be careful, extending this in Rails overrides overridden <code>Module.delegate</code> method"}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 3, "last_activity_date": 1561329302, "creation_date": 1561329302, "answer_id": 56728184, "question_id": 56725597, "link": "https://stackoverflow.com/questions/56725597/how-to-make-alias-method-in-ruby-use-the-sub-class-custom-method/56728184#56728184", "title": "How to make alias_method in Ruby use the sub-class&#39; custom method?", "body": "<p>If all you want is the delegation behavior without having to write a new method by hand, I might suggest <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/forwardable/rdoc/Forwardable.html\" rel=\"nofollow noreferrer\"><code>Forwardable</code></a>.</p>\n\n<pre><code>require 'forwardable'\n\nclass Beer\n  extend Forwardable\n\n  def bottle_content\n    '250 ml'\n  end\n\n  def_delegator :self, :bottle_content, :to_s\nend\n</code></pre>\n\n<p>It's really intended to be used for delegating methods to <em>other</em> objects, but there's nothing saying we <em>can't</em> do this, simply by passing it a <code>:self</code> as the first argument.</p>\n\n<pre><code>irb(main):001:0&gt; puts Duvel.new\n330 ml\n=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 2146, "user_id": 1949759, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LAldS.jpg?s=128&g=1", "display_name": "wout", "link": "https://stackoverflow.com/users/1949759/wout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1561329302, "creation_date": 1561305670, "last_edit_date": 1561314902, "question_id": 56725597, "link": "https://stackoverflow.com/questions/56725597/how-to-make-alias-method-in-ruby-use-the-sub-class-custom-method", "title": "How to make alias_method in Ruby use the sub-class&#39; custom method?", "body": "<p>Let's say I have a base class with three sub-classes. The base class has a method common to most sub-classes, and it has an alias:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Beer\n  def bottle_content\n    '250 ml'\n  end\n  alias_method :to_s, :bottle_content\nend\n\nclass Heineken &lt; Beer\nend\n\nclass Stella &lt; Beer\nend\n\nclass Duvel &lt; Beer\n  def bottle_content\n    '330 ml'\n  end\nend\n</code></pre>\n\n<p>Now, if the <code>to_s</code> method is called on the diverging sub-class instance of <code>Duvel</code>, <code>250 ml</code> is returned instead of <code>330 ml</code>.</p>\n\n<p>I get why; the alias is made at the level of the super class. And I know this can be fixed by re-defining the <code>alias_method</code> in the diverging class. But is there another way to do this?</p>\n\n<p>Obviously, using a method for <code>to_s</code> would work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Beer\n  def bottle_content\n    '250 ml'\n  end\n  def to_s; bottle_content; end\nend\n</code></pre>\n\n<p>But maybe there is more elegant approach?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin", "rails-activestorage", "ruby-on-rails-5.2"], "answers": [{"comments": [{"owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1561297849, "post_id": 56723951, "comment_id": 100009048, "body": "i updated my answer render image inside a <code>ul &amp; li </code> can you try that once? It worked for me."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1561297930, "post_id": 56723951, "comment_id": 100009071, "body": "but whats the diff?"}, {"owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 1, "creation_date": 1561298363, "post_id": 56723951, "comment_id": 100009193, "body": "i&#39;m not sure but i think as you&#39;re looping through multiple items  it was returning an array of <code>#</code>. Where as when you use <code>last</code> you&#39;re directly rendering it with a <code>image_tag</code>. And when you use <code>ul &amp; li</code> to render multiple items html is returned and it was rendering it. that makes the difference i guess."}], "tags": [], "owner": {"reputation": 1173, "user_id": 9418609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o0aMF.jpg?s=128&g=1", "display_name": "uday", "link": "https://stackoverflow.com/users/9418609/uday"}, "is_accepted": true, "score": 5, "last_activity_date": 1561297790, "last_edit_date": 1561297790, "creation_date": 1561293439, "answer_id": 56723951, "question_id": 56723697, "link": "https://stackoverflow.com/questions/56723697/active-storage-images-not-showing-in-activeadmin-rails/56723951#56723951", "title": "Active storage images not showing in activeadmin rails", "body": "<p>You need to use the <code>url_for</code> to display the images, something like below  </p>\n\n<pre><code>row \"Images\" do |p|\n  ul do\n    p.photos.each do |photo|\n      li do\n        image_tag url_for(photo)\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 648, "user_id": 10313894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVS6l.jpg?s=128&g=1", "display_name": "ARK", "link": "https://stackoverflow.com/users/10313894/ark"}, "edited": false, "score": 0, "creation_date": 1594979249, "post_id": 62951341, "comment_id": 111322506, "body": "I mean the OP was missing <code>url_for</code>. The issue is not solved with <code>ul</code> and <code>li</code>. It is solved with <code>url_for</code>."}], "tags": [], "owner": {"reputation": 648, "user_id": 10313894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVS6l.jpg?s=128&g=1", "display_name": "ARK", "link": "https://stackoverflow.com/users/10313894/ark"}, "is_accepted": false, "score": 0, "last_activity_date": 1594978918, "creation_date": 1594978918, "answer_id": 62951341, "question_id": 56723697, "link": "https://stackoverflow.com/questions/56723697/active-storage-images-not-showing-in-activeadmin-rails/62951341#62951341", "title": "Active storage images not showing in activeadmin rails", "body": "<p>I did not face any issues doing it this way for multiple attachments:</p>\n<pre><code>if resource.photos.attached?\n  row &quot;Photos&quot; do |resource|\n    resource.photos.map{|photo| image_tag url_for photo}\n  end\nend\n</code></pre>\n<p>I don't know why @uday would suggest <code>ul</code> and <code>li</code>. It seems like an &quot;XY solution&quot;.</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 56723951, "answer_count": 2, "score": 1, "last_activity_date": 1594978918, "creation_date": 1561291570, "last_edit_date": 1561297147, "question_id": 56723697, "link": "https://stackoverflow.com/questions/56723697/active-storage-images-not-showing-in-activeadmin-rails", "title": "Active storage images not showing in activeadmin rails", "body": "<p>Using active storage to store images which are working fine.\nIssue I face is that when I <code>image_tag image</code> it shows <code>#</code> instead of image.</p>\n\n<p>Here is the code\nproducts.rb</p>\n\n<pre><code>has_many_attached :photos\n</code></pre>\n\n<p>in active_admin</p>\n\n<pre><code>row \"Images\" do |p|\n  p.photos.attachments.each do |photo|\n    image_tag photo\n  end\nend\n</code></pre>\n\n<p>it not displaying images. it check with byebug also the url is fine but images not display and it shows this</p>\n\n<p><a href=\"https://i.stack.imgur.com/joZs0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/joZs0.png\" alt=\"enter image description here\"></a></p>\n\n<p>only this one works</p>\n\n<pre><code>row \"Images\" do |p|\n    image_tag p.photos.attachments.last\nend\n</code></pre>\n"}]