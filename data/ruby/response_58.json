[{"tags": ["ruby-on-rails", "ruby", "activerecord", "controller", "applicationcontroller"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 5, "creation_date": 1455753470, "post_id": 35470109, "comment_id": 58635878, "body": "Your mixing apples and pears and this question makes no sense at all.  <code>ActiveRecord::Base</code> is models,  <code>ActionController::Base</code> is controllers.  <code>@article.update(article_params)</code> is calling <code>.update</code> on a model instance and has nothing to do with <code>ApplicationController</code>. You might want to start by reading: <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/getting_started.html</a>"}, {"owner": {"reputation": 556, "user_id": 4316935, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91c11f0640e132006aaddce32c727fe7?s=128&d=identicon&r=PG", "display_name": "Rod Argumedo", "link": "https://stackoverflow.com/users/4316935/rod-argumedo"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1455760274, "post_id": 35470109, "comment_id": 58638051, "body": "To be honest, <code>ActiveRecord::Base</code> is only used for models in a database. There is a lot of extensive documentation over how both of <code>ActionController</code> and <code>ActiveRecord</code> works. I also think it&#39;s not the <b>proper</b> question to ask because there are a lot of people keep asking the same question over and over again. what @max said, read the documentation from Rails itself."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5943095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244a5d86888649f4b9394208fccfdb52?s=128&d=identicon&r=PG&f=1", "display_name": "DeveloperB", "link": "https://stackoverflow.com/users/5943095/developerb"}, "edited": false, "score": 0, "creation_date": 1455791772, "post_id": 35471225, "comment_id": 58651874, "body": "Hi, MVC is totally clear,  the meaning is, how is it possible to use the update() -methode within the controller, because it is a class with a scope. And I don&#39;t mixup everything, method is using in the controller -&gt; (<a href=\"http://guides.rubyonrails.org/action_controller_overview.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/action_controller_overview.html</a>)   .... My question is, how it works inside rails. how is it possible to use the method in the controller, from where comes that."}, {"owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "reply_to_user": {"reputation": 1, "user_id": 5943095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244a5d86888649f4b9394208fccfdb52?s=128&d=identicon&r=PG&f=1", "display_name": "DeveloperB", "link": "https://stackoverflow.com/users/5943095/developerb"}, "edited": false, "score": 0, "creation_date": 1455883457, "post_id": 35471225, "comment_id": 58700835, "body": "You could do something like <code>MyModel.where(id: params[:id]).update(name: &quot;hello&quot;)</code> in your controller method. You create a controller method hen that controller method delegates to the model class"}], "tags": [], "owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "is_accepted": false, "score": 2, "last_activity_date": 1455759767, "creation_date": 1455759767, "answer_id": 35471225, "question_id": 35470109, "link": "https://stackoverflow.com/questions/35470109/rails-how-works-applicationcontroller/35471225#35471225", "title": "Rails how works ApplicationController", "body": "<p>Rails follow the MVC architecture. In that architecture, your models interact with the database and your controllers interact with incoming requests (usually by orchestrating some models and then passing those off to some views that render the content). Rails achieves reuse through inheritance, so you can't (and probably wouldn't want to) mix concerns</p>\n\n<p>I recommend checking out the official Rails guides. I think it's some of the best written documentation in the industry:</p>\n\n<p><a href=\"http://guides.rubyonrails.org/\" rel=\"nofollow\">http://guides.rubyonrails.org/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5943095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244a5d86888649f4b9394208fccfdb52?s=128&d=identicon&r=PG&f=1", "display_name": "DeveloperB", "link": "https://stackoverflow.com/users/5943095/developerb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 1, "closed_date": 1455763469, "answer_count": 1, "score": -2, "last_activity_date": 1455759767, "creation_date": 1455753032, "last_edit_date": 1455756216, "question_id": 35470109, "link": "https://stackoverflow.com/questions/35470109/rails-how-works-applicationcontroller", "closed_reason": "Needs details or clarity", "title": "Rails how works ApplicationController", "body": "<p>When i write a Controller Class, it's possible to use methods like:</p>\n\n<pre><code>@article.update(article_params)\n</code></pre>\n\n<p>The method <code>update</code> comes from the class <code>ActiveRecord::Base</code> :\n<a href=\"http://api.rubyonrails.org/v2.3/classes/ActiveRecord/Base.html#M001966\" rel=\"nofollow\">http://api.rubyonrails.org/v2.3/classes/ActiveRecord/Base.html#M001966</a></p>\n\n<p>My questions:</p>\n\n<ol>\n<li><p>How can I use the <code>update</code> method from a Controller class that does not inherit from <code>ActiveRecord::Base</code>? It looks like <code>ApplicationController</code> inherits only from <code>ActionController::Base</code></p></li>\n<li><p>Are there any resources available to read up on this?</p></li>\n</ol>\n\n<p>Thanks for help, Cheers B</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "cucumber", "capybara", "site-prism"], "answers": [{"tags": [], "owner": {"reputation": 207, "user_id": 5631763, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/245046d37ae87654c4d5e83266568584?s=128&d=identicon&r=PG&f=1", "display_name": "SaeeK", "link": "https://stackoverflow.com/users/5631763/saeek"}, "is_accepted": false, "score": 1, "last_activity_date": 1455754254, "creation_date": 1455754254, "answer_id": 35470331, "question_id": 35469935, "link": "https://stackoverflow.com/questions/35469935/need-to-execute-a-step-each-feature-may-have-diff-step-only-once-before-a-cucu/35470331#35470331", "title": "Need to execute a step (each feature may have diff step) only once before a Cucumber feature file", "body": "<p>This can be achieved by associating a Before, After, Around or AfterStep hook with one or more tags. Examples:</p>\n\n<pre><code>Before('@cucumis, @sativus') do\n  # This will only run before scenarios tagged\n  # with @cucumis OR @sativus.\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1410, "user_id": 3890924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uy8Gd.jpg?s=128&g=1", "display_name": "alannichols", "link": "https://stackoverflow.com/users/3890924/alannichols"}, "edited": false, "score": 0, "creation_date": 1455808300, "post_id": 35470998, "comment_id": 58663746, "body": "Some discussion of it can be found here - <a href=\"http://stackoverflow.com/questions/23113370/is-there-a-cucumber-hook-to-run-before-and-after-each-feature\" title=\"is there a cucumber hook to run before and after each feature\">stackoverflow.com/questions/23113370/&hellip;</a>"}], "tags": [], "owner": {"reputation": 926, "user_id": 2379703, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c95691ed554de6809abeb2a542a0e1e1?s=128&d=identicon&r=PG", "display_name": "jshort", "link": "https://stackoverflow.com/users/2379703/jshort"}, "is_accepted": false, "score": 2, "last_activity_date": 1455758174, "creation_date": 1455758174, "answer_id": 35470998, "question_id": 35469935, "link": "https://stackoverflow.com/questions/35469935/need-to-execute-a-step-each-feature-may-have-diff-step-only-once-before-a-cucu/35470998#35470998", "title": "Need to execute a step (each feature may have diff step) only once before a Cucumber feature file", "body": "<p>Cucumber doesn't really support what you are asking about.  A way to implement this with cucumber hooks would be to use these two pieces of doc:</p>\n\n<p><a href=\"https://github.com/cucumber/cucumber/wiki/Hooks#tagged-hooks\" rel=\"nofollow\">https://github.com/cucumber/cucumber/wiki/Hooks#tagged-hooks</a></p>\n\n<p><a href=\"https://github.com/cucumber/cucumber/wiki/Hooks#running-a-before-hook-only-once\" rel=\"nofollow\">https://github.com/cucumber/cucumber/wiki/Hooks#running-a-before-hook-only-once</a></p>\n\n<p>You would tag all your feature files appropriately and you can implement tagged Before hooks that execute once on a per feature tag basis.</p>\n\n<p>It's not beautiful but it accomplishes what you want without waiting on a feature request (or using a different tool).</p>\n"}, {"tags": [], "owner": {"reputation": 672, "user_id": 5788146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a22eb214b625f168dd5ed1c4d39e2f9e?s=128&d=identicon&r=PG&f=1", "display_name": "Sarabjit Singh", "link": "https://stackoverflow.com/users/5788146/sarabjit-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1455876180, "creation_date": 1455876180, "answer_id": 35502464, "question_id": 35469935, "link": "https://stackoverflow.com/questions/35469935/need-to-execute-a-step-each-feature-may-have-diff-step-only-once-before-a-cucu/35502464#35502464", "title": "Need to execute a step (each feature may have diff step) only once before a Cucumber feature file", "body": "<p>Yes, This can be done by passing the actual value in you feature file and using \"<code>(\\\\d+)</code>\" in you java file. Look at below shown code for better understanding.</p>\n\n<pre><code>Scenario: some test scenario\nGiven whenever a value is 50\n</code></pre>\n\n<p>In <code>myFile.java</code>, write the step definition as shown below</p>\n\n<pre><code>@Given(\"whenever a value is (\\\\d+)$\")\npublic void testValueInVariable(int value) throws Throwable {\n assertEqual(value, 50);\n}\n</code></pre>\n\n<p>you can also have a look at below link to get more clear picture:\n<a href=\"https://thomassundberg.wordpress.com/2014/05/29/cucumber-jvm-hello-world/\" rel=\"nofollow\">https://thomassundberg.wordpress.com/2014/05/29/cucumber-jvm-hello-world/</a></p>\n"}, {"comments": [{"owner": {"reputation": 680, "user_id": 3434387, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AF81I.jpg?s=128&g=1", "display_name": "Saikat", "link": "https://stackoverflow.com/users/3434387/saikat"}, "edited": false, "score": 1, "creation_date": 1456170686, "post_id": 35558478, "comment_id": 58813275, "body": "I have actually changed my mind to execute a specific step only once before a feature file. I have configured that and found out the issue, if one scenario fails then it leads to be failed for other scenario. As @diabolist said. Thanks for sharing."}], "tags": [], "owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "is_accepted": false, "score": 1, "last_activity_date": 1456157635, "creation_date": 1456157635, "answer_id": 35558478, "question_id": 35469935, "link": "https://stackoverflow.com/questions/35469935/need-to-execute-a-step-each-feature-may-have-diff-step-only-once-before-a-cucu/35558478#35558478", "title": "Need to execute a step (each feature may have diff step) only once before a Cucumber feature file", "body": "<p>This must be in the top 5 most frequent questions on the Cucumber mailing list. You can do what you want with hooks. However you almost certainly should not do what you want. The execution time you save by taking this approach is totally outweighed by the amount of time and effort it will take to debug the intermittent failures that such an approach generally leads to.</p>\n\n<p>One of the foundations of creating automated tests is to start from a consistent place. When you have code that setups key things in scenarios, but that is not run for every scenario you have to do the following:</p>\n\n<ol>\n<li>Ensure your setup code creates a consistent base to start from (this is easy)</li>\n<li>Ensure that every scenario that uses this base, does not modify the base in any way at all (this is very very difficult)</li>\n</ol>\n\n<p>In your example you'd have to ensure that every action in every scenario ends up on your original page URL. If just one scenario fails to do that, then you will end up with intermittent failures, and you will have to go through every scenario to find your culprit.</p>\n\n<p>In general it is much easier and more effective to put your effort into making your setup code FAST enough so that you are not worried about running it before each scenario.</p>\n"}, {"tags": [], "owner": {"reputation": 1177, "user_id": 3405140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oAszy.png?s=128&g=1", "display_name": "moertel", "link": "https://stackoverflow.com/users/3405140/moertel"}, "is_accepted": false, "score": 0, "last_activity_date": 1469624886, "creation_date": 1469624886, "answer_id": 38613905, "question_id": 35469935, "link": "https://stackoverflow.com/questions/35469935/need-to-execute-a-step-each-feature-may-have-diff-step-only-once-before-a-cucu/38613905#38613905", "title": "Need to execute a step (each feature may have diff step) only once before a Cucumber feature file", "body": "<p>Some suggestions have been given, especially the one quoting the <a href=\"https://github.com/cucumber/cucumber/wiki/Hooks#running-a-before-hook-only-once\" rel=\"nofollow\">official documentation</a> which uses a global variable to store whether or not initial setup has been run.</p>\n\n<p>For my case, where multiple features were executed one after another, I had to reset the variable again by checking whether <code>scenario.feature.name</code> has changed:</p>\n\n<pre><code>$feature_name ||= ''\n$is_setup ||= false\n\nBefore do |scenario|\n  current_feature_name = scenario.feature.name rescue nil\n  if current_feature_name != $feature_name\n    $feature_name = current_feature_name\n    $is_setup = false\n  end\nend\n</code></pre>\n\n<p><code>$is_setup</code> can then be used in steps to determine whether any initial setup needs to be done.</p>\n"}], "owner": {"reputation": 680, "user_id": 3434387, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AF81I.jpg?s=128&g=1", "display_name": "Saikat", "link": "https://stackoverflow.com/users/3434387/saikat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1102, "favorite_count": 3, "answer_count": 5, "score": 3, "last_activity_date": 1469624886, "creation_date": 1455752245, "last_edit_date": 1455754981, "question_id": 35469935, "link": "https://stackoverflow.com/questions/35469935/need-to-execute-a-step-each-feature-may-have-diff-step-only-once-before-a-cucu", "title": "Need to execute a step (each feature may have diff step) only once before a Cucumber feature file", "body": "<p>I want to execute a specific step only once before each cucumber feature files. A cucumber feature files can have multiple scenarios. I don't want Background steps here which executes before each scenario. Every feature file can have a step (which is different in each feature) which will execute only once. So i can't use that step into before hook as i have a specific step for every 20 features. Sample Gherkin shows below:</p>\n\n<pre><code>Scenario: This will execute only once before all scenario in this current feature\nWhen Navigate to the Page URL\n\nScenario: scenario 1\nWhen Some Action\nThen Some Verification\n\nScenario: scenario 2\nWhen Some Action\nThen Some Verification\n\nScenario: scenario 3\nWhen Some Action\nThen Some Verification\n</code></pre>\n\n<p>I hope you guys understand my Question. I am using Ruby Capybara Cucumber in my framework.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 716, "user_id": 3250825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1468110470/picture?type=large", "display_name": "mccalljt", "link": "https://stackoverflow.com/users/3250825/mccalljt"}, "edited": false, "score": 0, "creation_date": 1455751820, "post_id": 35469817, "comment_id": 58635256, "body": "User.all will return a collection, so it would be more appropriately named @users. You are the trying to call an instance method on the collection. You need to iterate over the collection and call avatar on the single instances."}], "answers": [{"comments": [{"owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "edited": false, "score": 0, "creation_date": 1455752018, "post_id": 35469868, "comment_id": 58635347, "body": "Ahh I see. Okay, sorry (so sorry...) for my newb-ness, but how would I implement that? E.g. how would I change my code to reflect that?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1455752517, "post_id": 35469868, "comment_id": 58635512, "body": "It still makes zero sense to have a index method that displays a single record. And she is obviously trying to display a collection. The naming is just off."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "edited": false, "score": 1, "creation_date": 1455752586, "post_id": 35469868, "comment_id": 58635535, "body": "Agreed, and your answer provides a more robust solution than mine, and should be followed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1455752706, "post_id": 35469868, "comment_id": 58635574, "body": "I put a note in my answer for you @max"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "is_accepted": false, "score": 1, "last_activity_date": 1455752654, "last_edit_date": 1455752654, "creation_date": 1455751863, "answer_id": 35469868, "question_id": 35469817, "link": "https://stackoverflow.com/questions/35469817/undefined-method-avatar-for-useractiverecord-relation0x007fc328248ef0/35469868#35469868", "title": "undefined method `avatar&#39; for #&lt;User::ActiveRecord_Relation:0x007fc328248ef0&gt;", "body": "<p>You are seeing this error because you're calling a method on an <code>Relation</code> object, not on a <code>User</code> object. Try calling .first on your relation object, it will return a <code>User</code> object. You can then call <code>.avatar</code> on that <code>User</code> object.</p>\n\n<p>It looks like you are storing a relation into <code>@user</code> in your <code>index</code> method of <code>users_controller.rb</code></p>\n\n<pre><code>def index\n  @user = User.all\n  if params[:search]\n    @user = User.search(params[:search]).order(\"created_at DESC\")\n  else\n    @user = User.all.order('created_at DESC')\n  end\nend\n</code></pre>\n\n<p>In both of these cases, you are calling <code>.all</code>, which will return a relation. You can use something along the llines of <code>User.where(criteria: &lt;unique criteria&gt;).first</code> to get an actual singular user object and save it to @user. <strong>However</strong>, as max pointed out, it doesn't make sense to have an index method that returns a singular user. So you should map this functionality to another controller method. </p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1455752442, "post_id": 35469922, "comment_id": 58635490, "body": "Also note that doing <code>&lt;%= params[:search] %&gt;</code> can leave your users open to  cross site scripting (XSS) attacks.  You need to escape it properly. <a href=\"http://guides.rubyonrails.org/security.html#cross-site-scripting-xss\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/security.html#cross-site-scripting-xs&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "edited": false, "score": 0, "creation_date": 1455753152, "post_id": 35469922, "comment_id": 58635757, "body": "You rock! Thank you so much."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 4, "last_activity_date": 1455752602, "last_edit_date": 1455752602, "creation_date": 1455752174, "answer_id": 35469922, "question_id": 35469817, "link": "https://stackoverflow.com/questions/35469817/undefined-method-avatar-for-useractiverecord-relation0x007fc328248ef0/35469922#35469922", "title": "undefined method `avatar&#39; for #&lt;User::ActiveRecord_Relation:0x007fc328248ef0&gt;", "body": "<p>You are trying to use a collection of users as a single user.</p>\n\n<pre><code>def index\n  @users = User.all\n  if params[:search]\n    @users = User.search(params[:search]).order(\"created_at DESC\")\n  else\n    @users = User.all.order('created_at DESC')\n  end\nend\n</code></pre>\n\n<hr>\n\n<pre><code>&lt;% if @users.any? %&gt;\n  &lt;%= render @users %&gt;\n&lt;% else %&gt;\n  &lt;p&gt;There are no posts containing the term(s) &lt;%= params[:search] %&gt;.&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Up to here the changes have only been to avoid developer confusion. However the real crux is your partial where you are using <code>@user</code> and not <code>user</code>.</p>\n\n<pre><code>&lt;%= image_tag @user.avatar.url(:thumb) %&gt;\n</code></pre>\n\n<p>The difference here is that <code>user</code> is a local variable which rails creates when rendering the partial. While <code>@user</code> is your miss-named collection!</p>\n\n<p>So just use the local variable:</p>\n\n<pre><code>&lt;%= image_tag user.avatar.url(:thumb) %&gt;\n</code></pre>\n\n<p>And pay attention to pluralization when naming your variables.</p>\n"}], "owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 35469922, "answer_count": 2, "score": 1, "last_activity_date": 1455752654, "creation_date": 1455751591, "question_id": 35469817, "link": "https://stackoverflow.com/questions/35469817/undefined-method-avatar-for-useractiverecord-relation0x007fc328248ef0", "title": "undefined method `avatar&#39; for #&lt;User::ActiveRecord_Relation:0x007fc328248ef0&gt;", "body": "<p>I'm trying to display the data for a user searched by their first or last name. I'm able to display all data returned for a user (e.g. if user is searched by first name, I can pull all other fields/data associated with the searched user, such as city, state/province, etc). </p>\n\n<p>The only field that seems to be giving me an error is the avatar (profile photo) field associated with each user.  <code>&lt;%= image_tag @user.avatar.url(:thumb) %&gt;</code></p>\n\n<p>Note: I am able to display this field from other user pages (e.g. show.html.erb). </p>\n\n<p>The error I get upon hitting the search results page is: </p>\n\n<blockquote>\n  <p>NoMethodError in Users#index - undefined method `avatar' for #\n  User::ActiveRecord_Relation:0x007fc328248ef0</p>\n</blockquote>\n\n<p><strong>_user.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"card\"&gt;\n\n    &lt;div class=\"columns\"&gt;\n\n        &lt;div class=\"col\"&gt;\n\n  &lt;%= image_tag @user.avatar.url(:thumb) %&gt;\n\n\n        &lt;/div&gt;\n\n          &lt;div class=\"col\"&gt;\n\n             &lt;div class=\"name\"&gt;\n            &lt;%= user.firstname %&gt; &lt;%= user.lastname%&gt;\n\n    &lt;/div&gt;\n        &lt;br&gt;\n           &lt;b&gt;&lt;%= user.city%&gt;, &lt;%= user.stateprov%&gt;&lt;/b&gt;\n\n&lt;/div&gt;\n\n        &lt;/div&gt;\n\n    &lt;/div&gt;\n</code></pre>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;% if @user.present? %&gt;\n  &lt;%= render @user %&gt;\n&lt;% else %&gt;\n  &lt;p&gt;There are no posts containing the term(s) &lt;%= params[:search] %&gt;.&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>user.rb</strong> </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\ndef self.search(search)\n    where(\"firstname LIKE ? OR lastname LIKE ?\", \"%#{search}%\", \"%#{search}%\")\nend\n\n\nhas_secure_password\n\n  validates_length_of :password, :in =&gt; 6..20, :on =&gt; :create\n  validates :password_confirmation, presence: true, if: -&gt; { new_record? || changes[\"password\"] }\n\nhas_attached_file :avatar,\n\n\n :path =&gt; \":rails_root/public/system/:attachment/:id/:basename_:style.:extension\",\n :url =&gt; \"/system/:attachment/:id/:basename_:style.:extension\",\n\n\n :styles =&gt; {\n  :thumb    =&gt; ['175x175#',  :jpg, :quality =&gt; 100],\n :preview  =&gt; ['480x480#',  :jpg, :quality =&gt; 70],\n  :large    =&gt; ['600&gt;',      :jpg, :quality =&gt; 70],\n  :retina   =&gt; ['1200&gt;',     :jpg, :quality =&gt; 30]\n},\n:convert_options =&gt; {\n  :thumb    =&gt; '-set colorspace sRGB -strip',\n :preview  =&gt; '-set colorspace sRGB -strip',\n  :large    =&gt; '-set colorspace sRGB -strip',\n  :retina   =&gt; '-set colorspace sRGB -strip -sharpen 0x0.5'\n}\n\nvalidates_attachment :avatar,\n    :presence =&gt; true,\n    :size =&gt; { :in =&gt; 0..10.megabytes },\n    :content_type =&gt; { :content_type =&gt; /^image\\/(jpeg|png|gif|tiff)$/ }\n\n\nend\n</code></pre>\n\n<p><strong>users_controller.rb</strong></p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\ndef create\n  @user = User.new(user_params)\n  if @user.save\n    flash[:success] = \"You signed up successfully\"\n    flash[:color] = \"valid\"\n    redirect_to @user\n  else\n    flash[:notice] = \"Form is invalid\"\n    flash[:color] = \"invalid\"\n    render \"new\"\n  end\nend\n\n\ndef index\n  @user = User.all\n  if params[:search]\n    @user = User.search(params[:search]).order(\"created_at DESC\")\n  else\n    @user = User.all.order('created_at DESC')\n  end\nend\n\n\n\ndef show\n  @user = User.find(params[:id])\nend\n\ndef edit\n  @user = User.find(params[:id])\nend\n\ndef update\n  @user = User.find(params[:id])\n\nif @user.update_attributes(user_params)\n\nredirect_to @user  \n\nelse\n\n  render 'edit'\nend\nend\n\n\nprivate\ndef user_params\n  params.require(:user).permit(:firstname, :lastname, :email, :aptno, :streetaddress, :city, :country, :stateprov, :poszip, :receive_newsletters, :terms_accepted,  :password, :password_confirmation, :avatar)\nend\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1455752830, "post_id": 35469619, "comment_id": 58635626, "body": "Why the .rb in the end of the gem name? Have you tried just <b>$ gem install http_parser -v &#39;0.6.0&#39;</b>?"}, {"owner": {"reputation": 41, "user_id": 5943016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd1311756b25b18061128b594268d1c?s=128&d=identicon&r=PG&f=1", "display_name": "L. Dong", "link": "https://stackoverflow.com/users/5943016/l-dong"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1455753345, "post_id": 35469619, "comment_id": 58635839, "body": "@Ed de Almeida i get this:  <code>ERROR:  Could not find a valid gem &#39;http_parser&#39; (= 0.6.0) in any repository ERROR:  Possible alternatives: http-parser</code>"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1455756438, "post_id": 35469619, "comment_id": 58636779, "body": "And tried this alternative?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1455757075, "post_id": 35469619, "comment_id": 58636991, "body": "@EddeAlmeida for some silly reason the gem is actually named <code>http_parser.rb</code> - <a href=\"https://rubygems.org/gems/http_parser.rb/versions/0.6.0\" rel=\"nofollow noreferrer\">rubygems.org/gems/http_parser.rb/versions/0.6.0</a>"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1455757300, "post_id": 35469619, "comment_id": 58637070, "body": "Well... If so, then it is easy to know what is happening. This kind of error you got happens when you don&#39;t have all requisites to build the native extensions to a gem. Just yesterday I got a similar error trying to install postgresql, because my Fedora 22 installation had not a package name postgresql-devel. After I install it everything worked fine. Unfortunately it seems you are building under Windows and I just can&#39;t help you efficiently with this SO."}], "answers": [{"tags": [], "owner": {"reputation": 2387, "user_id": 4717992, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SRrvm.jpg?s=128&g=1", "display_name": "Jonathan Soifer", "link": "https://stackoverflow.com/users/4717992/jonathan-soifer"}, "is_accepted": false, "score": 6, "last_activity_date": 1478089589, "creation_date": 1478089589, "answer_id": 40379944, "question_id": 35469619, "link": "https://stackoverflow.com/questions/35469619/while-installing-http-parser-rb-error-failed-to-build-gem-native-extension/40379944#40379944", "title": "While installing http_parser.rb ERROR: Failed to build gem native extension", "body": "<p>I was going through this very same issue.</p>\n\n<p>Looked up the Git Repository for the Gem (HTTP_Parser) and found out the reason for my problem:</p>\n\n<p><a href=\"https://github.com/tmm1/http_parser.rb/issues/47\" rel=\"noreferrer\">HTTP_Parser currently doesn't not support a Path with spaces</a></p>\n\n<p>So I renamed my path and solved it.</p>\n"}, {"tags": [], "owner": {"reputation": 2231, "user_id": 507169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9c4267bb4bf7e4cdbdb0d07f858eb7?s=128&d=identicon&r=PG", "display_name": "BigBlueHat", "link": "https://stackoverflow.com/users/507169/bigbluehat"}, "is_accepted": false, "score": 0, "last_activity_date": 1561218398, "creation_date": 1561218398, "answer_id": 56716859, "question_id": 35469619, "link": "https://stackoverflow.com/questions/35469619/while-installing-http-parser-rb-error-failed-to-build-gem-native-extension/56716859#56716859", "title": "While installing http_parser.rb ERROR: Failed to build gem native extension", "body": "<p>Hopefully by now you've found the answer. However, for others (like me) who find this post, here's what's needed:</p>\n\n<ol>\n<li>Install Ruby+DevKit from RubyInstaller: <a href=\"https://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">https://rubyinstaller.org/downloads/</a></li>\n<li>Check the \"ridk install\" checkbox at the end of the installer.</li>\n<li>When RIDK runs, pick option 3 to install both MSYS and MINGW dev tools (<code>make</code> is provided with the MINGW stuff).</li>\n</ol>\n\n<p>Open a fresh console (to get fresh environment variables), and rerun your gem or bundle command...and hope for the best.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 41, "user_id": 5943016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd1311756b25b18061128b594268d1c?s=128&d=identicon&r=PG&f=1", "display_name": "L. Dong", "link": "https://stackoverflow.com/users/5943016/l-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3791, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1561218398, "creation_date": 1455750598, "question_id": 35469619, "link": "https://stackoverflow.com/questions/35469619/while-installing-http-parser-rb-error-failed-to-build-gem-native-extension", "title": "While installing http_parser.rb ERROR: Failed to build gem native extension", "body": "<p>i'm new to all of this but i get this error when i try to install http_parser using gem:</p>\n\n<pre><code>dongl_000@LENNY ~/ava-home (master)\n$ gem install http_parser.rb -v '0.6.0'\nBuilding native extensions.  This could take a while...\nERROR:  Error installing http_parser.rb:\n        ERROR: Failed to build gem native extension.\n\n    c:/Ruby22-x64/bin/ruby.exe -r ./siteconf20160217-15056-1hoiyfc.rb extconf.rb\n\ncreating Makefile\n\nmake \"DESTDIR=\" clean\n\nmake \"DESTDIR=\"\ngenerating ruby_http_parser-x64-mingw32.def\nmake: *** No rule to make target '/c/Ruby22-x64/include/ruby-2.2.0/ruby.h', need\ned by 'ruby_http_parser.o'.  Stop.\n\nmake failed, exit code 2\n\nGem files will remain installed in c:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/http_p\narser.rb-0.6.0 for inspection.\nResults logged to c:/Ruby22-x64/lib/ruby/gems/2.2.0/extensions/x64-mingw32/2.2.0\n/http_parser.rb-0.6.0/gem_make.out\n</code></pre>\n\n<p>ruby version: 2.2.1</p>\n\n<p>rubyGem version: 2.4.5</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5942977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba6d7f23a34c0151b2a54b30d3e8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5942977/ryan"}, "edited": false, "score": 0, "creation_date": 1455752132, "post_id": 35469642, "comment_id": 58635381, "body": "Is there any way I can do that if I&#39;m using the Entry model to generate my list? I added some details into the original post showing how I populate my table."}], "tags": [], "owner": {"reputation": 144, "user_id": 2652968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf8ddd2b4ec942babff1640fe780a1f?s=128&d=identicon&r=PG", "display_name": "Kyle Selman", "link": "https://stackoverflow.com/users/2652968/kyle-selman"}, "is_accepted": false, "score": 0, "last_activity_date": 1455750683, "creation_date": 1455750683, "answer_id": 35469642, "question_id": 35469571, "link": "https://stackoverflow.com/questions/35469571/search-a-models-references-foreign-keys-attribute-in-rails-using-sqlite3/35469642#35469642", "title": "Search a model&#39;s reference&#39;s/foreign_key&#39;s attribute (in rails using SQLite3)", "body": "<p>The best way to do this would be to have a search function inside the related model too.</p>\n\n<p>That way you could just say</p>\n\n<pre><code>user.search(search)\n</code></pre>\n\n<p>And get your list back in that manner.</p>\n"}], "owner": {"reputation": 1, "user_id": 5942977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba6d7f23a34c0151b2a54b30d3e8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5942977/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455752023, "creation_date": 1455750367, "last_edit_date": 1455752023, "question_id": 35469571, "link": "https://stackoverflow.com/questions/35469571/search-a-models-references-foreign-keys-attribute-in-rails-using-sqlite3", "title": "Search a model&#39;s reference&#39;s/foreign_key&#39;s attribute (in rails using SQLite3)", "body": "<p>I am trying to perform a search function on a table</p>\n\n<pre><code># my controller EntriesController.rb\n  def index\n    @entries = Entry.all\n    @entries = Entry.search(params[:search])\n    @entry = current_user.entries.build if logged_in?\n  end\n</code></pre>\n\n<p>I was able to implement a search bar using self.search method in my model</p>\n\n<pre><code># app/models/entry.rb\nclass Entry &lt; ActiveRecord::Base\n  belongs_to :user\n  validates :user_id, presence: true\n  validates :sample, :charge, :need_by, :file_format, :scan_type, presence: true\n\n  def self.search(search)\n    if search\n      where('created_at LIKE :search OR sample LIKE :search OR \n             need_by LIKE :search OR scan_type LIKE :search', \n             search: \"%#{search}%\")\n    else\n      all\n    end\n  end\nend\n</code></pre>\n\n<p>Everything works so far, but the entry model references the user model by user_id. I would like the search to be able to search the user model as well. So I tried adding this to the search method in entry.rb</p>\n\n<pre><code>if search\n  where('user.name LIKE :search', search: \"%#{search}%\")\nend\n</code></pre>\n\n<p>SQLite3 obviously shot me an error saying the column, \"user.name\" doesn't exist. I know it doesn't exist, but is there any way I can access it without having to use something like Ransack? Or should I just learn how to use a search gem?</p>\n\n<p>Here's the full exception</p>\n\n<pre><code>SQLite3::SQLException: no such column: user.name: SELECT  \"entries\".* FROM \"entries\" WHERE (user.name LIKE '%asdf%' OR created_at LIKE '%asdf%' OR sample LIKE '%asdf%' OR need_by LIKE '%asdf%' OR scan_type LIKE '%asdf%') AND \"entries\".\"scanned\" = ?  ORDER BY \"entries\".\"created_at\" ASC LIMIT 5 OFFSET 0\n</code></pre>\n\n<p>Currently, I am populating the table in question by using:</p>\n\n<pre><code>&lt;% @entries.each do |entry| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= entry.created_at.strftime(\"%Y %m %d\") %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= entry.user.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;!-- other entry stuff --&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>TL;DR, i'd like to make entry.user.name a searchable term.</p>\n"}, {"tags": ["ruby", "unit-testing", "rspec", "sinatra", "factory-bot"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "is_accepted": false, "score": 1, "last_activity_date": 1455750964, "creation_date": 1455750964, "answer_id": 35469700, "question_id": 35469482, "link": "https://stackoverflow.com/questions/35469482/creating-a-unit-test-suite-using-rspec-and-factory-girl/35469700#35469700", "title": "Creating a unit test suite using Rspec and Factory Girl", "body": "<p>So from what I gather, you want to use mocks or test doubles to mimic the functionality of your Vservers. This is indeed possible, the question is <em>should</em> it be done.</p>\n\n<p>You can use factory girl to create factories for each of your Vserver classes, but those facotories will only return whatever data you give them, they wont have any <em>real</em> data, since they only have whatever you assigned them in your tests or factories.</p>\n\n<p>What I would recommend is that within your facotries, you actually establish a connection to each instance of your Vservers, and pull back all the attributes which you need. So for example you could create a factory like so:</p>\n\n<pre><code>factory :vserver_1 do\n   id { connect_to_vserver_1_and_get_id }\n   domain_name { connect_to_vserver_1_get_domain_name }\nend\n</code></pre>\n\n<p>This would instantiate a new instance of vserver_1, with all the attributess of your current vserver. If you were to change the domain name of verserver 1 in the future, your vserver_1 factory would reflect these changes. </p>\n\n<p>Also, the factory girl gem has great <a href=\"https://github.com/thoughtbot/factory_girl\" rel=\"nofollow\">docs</a>, you should definitely read them in their entirety before building a new test suite. Good luck! </p>\n"}], "owner": {"reputation": 15, "user_id": 4062151, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004677157514/picture?type=large", "display_name": "Mahesh4eva", "link": "https://stackoverflow.com/users/4062151/mahesh4eva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455750964, "creation_date": 1455749988, "question_id": 35469482, "link": "https://stackoverflow.com/questions/35469482/creating-a-unit-test-suite-using-rspec-and-factory-girl", "title": "Creating a unit test suite using Rspec and Factory Girl", "body": "<p>I have a requirement where we should be creating for Factories for servers, we call them as Vservers. It basically has the attributes like Fully qualified domain name (fqdn), eg: dev-vserver.storage.com, ID and etc..</p>\n\n<p>We make a connection to the Vserver and retrieve information about different operations that we do like provisioning storage, resizing of volumes, deletion of volumes etc., in a json format.</p>\n\n<p>We would like to come up with a better unit testing environment with RSPEC and FactoryGirl, where we can mock the Vserver functionality by creating doubles or mocks instead of directly interacting with the actual Vserver for testing.</p>\n\n<p>I would like to hear suggestions and opinions from all you. </p>\n\n<p>Help is much appreciated.</p>\n\n<p>Thanks,\nMahesh</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 770, "user_id": 2341321, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd6c380c7b09a8f821e45e9a2a561643?s=128&d=identicon&r=PG", "display_name": "Jared Rader", "link": "https://stackoverflow.com/users/2341321/jared-rader"}, "edited": false, "score": 0, "creation_date": 1455772133, "post_id": 35469384, "comment_id": 58641402, "body": "instead of calling <code>Wv::WaveList.new</code> in <code>self.new_from_file</code>, couldn&#39;t you call <code>self.new</code>, so that <code>self</code> refers to the class being acted upon? I tested this out, and the new instance was a <code>MyWaveList</code> instead of a <code>Wv::WaveList</code>"}, {"owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "reply_to_user": {"reputation": 770, "user_id": 2341321, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd6c380c7b09a8f821e45e9a2a561643?s=128&d=identicon&r=PG", "display_name": "Jared Rader", "link": "https://stackoverflow.com/users/2341321/jared-rader"}, "edited": false, "score": 0, "creation_date": 1455804334, "post_id": 35469384, "comment_id": 58660684, "body": "That&#39;s what I was missing.  In one of the methods deeper down (called by new_from_file) I had a call to Wv::WaveList.new,  I monkey patched that method to call self.new,  and then subclassing works as expected.  I understand what&#39;s going on, but feel free to submit an answer explaining explaining what&#39;s going on, and I will accept it.  In the end I will fix this issue directly in the class (since I own it) and also probably just add copy_waves to the class anyway (since it would be useful)"}], "answers": [{"tags": [], "owner": {"reputation": 770, "user_id": 2341321, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd6c380c7b09a8f821e45e9a2a561643?s=128&d=identicon&r=PG", "display_name": "Jared Rader", "link": "https://stackoverflow.com/users/2341321/jared-rader"}, "is_accepted": true, "score": 1, "last_activity_date": 1455809205, "creation_date": 1455809205, "answer_id": 35485562, "question_id": 35469384, "link": "https://stackoverflow.com/questions/35469384/subclassing-a-class-that-has-a-factory-method/35485562#35485562", "title": "Subclassing a class that has a &quot;factory&quot; method", "body": "<p>I believe this should work</p>\n\n<pre><code>class Wv::WvWaveList \n  def self.new_from_file file_name\n    ... \n    self.new\n  end\n  ....\nend\n</code></pre>\n\n<p>Because <code>self.new_from_file</code> was always calling <code>Wv::WaveList.new</code>, it was always instantiating objects with that class, even from subclasses. But by using <code>self</code>, you'll be able to call <code>new_from_file</code> on any subclass, and the objects will be of the correct class:</p>\n\n<pre><code>&gt;&gt; a = MyWaveList.new_from_file \"some_file\"\n=&gt; #&lt;MyWaveList:0x007fd473004318 @file_name=\"some_file\"&gt;\n&gt;&gt; a.class\n=&gt; MyWaveList\n</code></pre>\n"}], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 35485562, "answer_count": 1, "score": 0, "last_activity_date": 1455809205, "creation_date": 1455749526, "question_id": 35469384, "link": "https://stackoverflow.com/questions/35469384/subclassing-a-class-that-has-a-factory-method", "title": "Subclassing a class that has a &quot;factory&quot; method", "body": "<p>I have a class that has a \"factory\" method which returns new instances given a file_name.  Depending on the type of file given it needs to construct the object differently.  It also happens to be a swig generated class wrapping a c++ class, I am not sure that matters, but I am including that detail just in case it does.  So I have this class defined somewhere, which has among other things this <code>new_from_file</code> method</p>\n\n<pre><code>class Wv::WvWaveList \n  def self.new_from_file file_name\n     ... \n      Wv::WaveList.new\n  end\n  ....\nend\n</code></pre>\n\n<p>I wanted to add a method <code>copy_wave</code>, so my first thought was to subclass and add it there so something like this.</p>\n\n<pre><code>class MyWaveList &lt; Wv::WvWaveList\n  def copy_wave\n    ...        \n  end\nend\n</code></pre>\n\n<p>The problem is that new_from_file still returns a Wv::WaveList not a MyWaveList so I can't call <code>copy_wave</code> on instances returned by <code>new_from_file</code></p>\n\n<p>One simple solution is to just open the class up here and add the method</p>\n\n<pre><code>class Wv::WvWave\n  def copy_wave\n     ...\n  end\nend\n</code></pre>\n\n<p>Another solution would be to have MyWaveList have an instance of a Wv::WaveList and delegate all the appropriate calls to that instance.</p>\n\n<p>So I am just wondering what the inheritance solution might be?  I just don't see it right now. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rubymine"], "comments": [{"owner": {"reputation": 344, "user_id": 1306709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e85eb7621b90a4ef6bde85446094c8?s=128&d=identicon&r=PG", "display_name": "Borys Pylhun", "link": "https://stackoverflow.com/users/1306709/borys-pylhun"}, "edited": false, "score": 0, "creation_date": 1455748995, "post_id": 35468669, "comment_id": 58634018, "body": "Are you able to select Rails Version here? <a href=\"http://i.stack.imgur.com/xe5mb.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/xe5mb.png</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "is_accepted": true, "score": 1, "last_activity_date": 1455749881, "creation_date": 1455749881, "answer_id": 35469465, "question_id": 35468669, "link": "https://stackoverflow.com/questions/35468669/rubymine-8-doesnt-detect-rails-gem-after-installation-cannot-create-project/35469465#35469465", "title": "RubyMine 8 doesn&#39;t detect Rails gem after installation, cannot create project", "body": "<p>The best way to create rails projects is through the command line.</p>\n\n<p>1) Go to the folder where you want to create the project</p>\n\n<p><code>-&gt;$ cd development</code></p>\n\n<p>2) Create rails project</p>\n\n<p><code>-&gt;$ rails new project_name</code></p>\n\n<p>3) Open project in Rubymine</p>\n\n<p><code>-&gt;$ mine .</code></p>\n\n<p>This will open Rubymine to your current project.</p>\n\n<p>I work with Rubymine all the time, and it's best not to worry about the gems it can't install. If you absolutely need the gem, first make sure <code>gem install rails</code> works. Then attempt to install it using the little pop up about not having all of the installed gems. You may need to uninstall rails to fix the issue.</p>\n\n<p>If the reason you want the gems is to use the debugger, I suggest using the <code>byebug</code> gem. It's a great gem for debugging and I personally prefer it over the rubymine debugger.</p>\n"}], "owner": {"reputation": 65, "user_id": 5187740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cf77b4d3100b48b4e03be154e6a35fb?s=128&d=identicon&r=PG&f=1", "display_name": "mayijia66fly", "link": "https://stackoverflow.com/users/5187740/mayijia66fly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 35469465, "answer_count": 1, "score": 1, "last_activity_date": 1455932287, "creation_date": 1455746448, "last_edit_date": 1455932287, "question_id": 35468669, "link": "https://stackoverflow.com/questions/35468669/rubymine-8-doesnt-detect-rails-gem-after-installation-cannot-create-project", "title": "RubyMine 8 doesn&#39;t detect Rails gem after installation, cannot create project", "body": "<p>After I installed Rails 4.2.5.1 in RubyMine welcome page, RubyMine doesn't detect Rails, and I cannot create projects.</p>\n\n<p><strong>RubyMine Welcome Page</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xe5mb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xe5mb.png\" alt=\"enter image description here\"></a></p>\n\n<p>And <strong>Console</strong>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WDvmK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WDvmK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara", "stripe-payments"], "comments": [{"owner": {"reputation": 5250, "user_id": 5154683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae81933dce5ced9ec019414bbd4f0f4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Nubel", "link": "https://stackoverflow.com/users/5154683/robert-nubel"}, "edited": false, "score": 0, "creation_date": 1455747053, "post_id": 35468506, "comment_id": 58633198, "body": "What record mode is VCR running in? If it&#39;s in <code>new_episodes</code> but still generating new files each time, try setting it to <code>none</code> to make debugging easier."}], "answers": [{"comments": [{"owner": {"reputation": 4587, "user_id": 1098873, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/47fe800ed32c2009b4f83d129e8657f9?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1098873/eric"}, "edited": false, "score": 3, "creation_date": 1455812434, "post_id": 35484324, "comment_id": 58667009, "body": "Puffing billy should be able to do this."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5307473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHbg3.jpg?s=128&g=1", "display_name": "Ywain", "link": "https://stackoverflow.com/users/5307473/ywain"}, "is_accepted": false, "score": -3, "last_activity_date": 1455806122, "creation_date": 1455806122, "answer_id": 35484324, "question_id": 35468506, "link": "https://stackoverflow.com/questions/35468506/how-can-i-use-puffing-billy-and-vcr-to-prevent-testing-stripes-checkout-from-cr/35484324#35484324", "title": "How can I use puffing-billy and VCR to prevent testing stripe&#39;s checkout from creating endless new files?", "body": "<p>Stripe's <a href=\"https://stripe.com/docs/checkout\" rel=\"nofollow\">Checkout form</a> will always reach out to Stripe's servers. While you can use your test API key and create card tokens using the special <a href=\"https://stripe.com/docs/testing#cards\" rel=\"nofollow\">testing numbers</a>, there is no way to prevent Checkout from contacting Stripe's servers.</p>\n"}, {"tags": [], "owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "is_accepted": false, "score": 5, "last_activity_date": 1506582374, "last_edit_date": 1506582374, "creation_date": 1506548911, "answer_id": 46457748, "question_id": 35468506, "link": "https://stackoverflow.com/questions/35468506/how-can-i-use-puffing-billy-and-vcr-to-prevent-testing-stripes-checkout-from-cr/46457748#46457748", "title": "How can I use puffing-billy and VCR to prevent testing stripe&#39;s checkout from creating endless new files?", "body": "<p>You can use the <code>merge_cached_responses_whitelist</code> option to merge responses. It was difficult to figure out the correct syntax for URLs, but this is what I figured out:</p>\n\n<ul>\n<li>The rules <strong>MUST</strong> be regexes. I tried using strings and it froze my tests.</li>\n<li>You must <strong>NOT</strong> include the protocol in your regex (e.g. <code>https?:\\/\\/</code>)</li>\n<li>For HTTPS urls, you must handle port <code>:443</code> after the domain</li>\n</ul>\n\n<p>Here's my rules to cache some Stripe responses on the front-end:</p>\n\n<pre><code>config.merge_cached_responses_whitelist = [\n  /api\\.stripe\\.com(:443)*\\/v1\\/tokens/,\n  /m\\.stripe\\.com(:443)*\\/4/\n]\n</code></pre>\n\n<p>Another important tip is that <code>puffing-billy</code> logs are not printed to your console, but go directly into your test logs at <code>log/test.log</code>. It really helps if you keep an eye on your test logs with:</p>\n\n<pre><code>tail -f log/test.log\n</code></pre>\n\n<p>You will see lines like this:</p>\n\n<pre><code>puffing-billy: CACHE KEY for 'https://api.stripe.com:443/v1/tokens' is 'post_e23c813681b1bac66ef1cc6f5f1b56108a18ec52'\npuffing-billy: CACHE post for 'https://api.stripe.com:443/v1/tokens'\npuffing-billy: CACHE KEY for 'https://m.stripe.com:443/4' is post_8072c2c958962829d4ba630f02301dc3a51f6a6e'\npuffing-billy: CACHE post for 'https://m.stripe.com:443/4'\n</code></pre>\n"}], "owner": {"reputation": 4587, "user_id": 1098873, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/47fe800ed32c2009b4f83d129e8657f9?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1098873/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1506582374, "creation_date": 1455745855, "question_id": 35468506, "link": "https://stackoverflow.com/questions/35468506/how-can-i-use-puffing-billy-and-vcr-to-prevent-testing-stripes-checkout-from-cr", "title": "How can I use puffing-billy and VCR to prevent testing stripe&#39;s checkout from creating endless new files?", "body": "<p>I am using puffing-billy/vcr/capybara/rspec to write a feature spec that is testing my use of the stripe gem. My specs are passing but I have been unable to get puffing-billy to use cached data rather than creating new files each time I run rspec.</p>\n\n<p>Is it possible to test the stripe checkout functionality without hitting the network or mocking anything else?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 631, "user_id": 5585943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a364cbb3ba5972c13ec5440c1113c9ed?s=128&d=identicon&r=PG&f=1", "display_name": "jacob.mccrumb", "link": "https://stackoverflow.com/users/5585943/jacob-mccrumb"}, "edited": false, "score": 1, "creation_date": 1455745828, "post_id": 35468397, "comment_id": 58632589, "body": "One thing to change is make the second group around the keys non capturing: <code>\\[((key1|key2|key3): (.+?))(?=(?:key1:|key2:|key3:|\\]))</code>"}, {"owner": {"reputation": 3678, "user_id": 145536, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9e92c681072b514fb360a0b01c0f5ea7?s=128&d=identicon&r=PG", "display_name": "Allen Liu", "link": "https://stackoverflow.com/users/145536/allen-liu"}, "reply_to_user": {"reputation": 631, "user_id": 5585943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a364cbb3ba5972c13ec5440c1113c9ed?s=128&d=identicon&r=PG&f=1", "display_name": "jacob.mccrumb", "link": "https://stackoverflow.com/users/5585943/jacob-mccrumb"}, "edited": false, "score": 0, "creation_date": 1455745867, "post_id": 35468397, "comment_id": 58632611, "body": "@jacob.m doh! good catch."}, {"owner": {"reputation": 631, "user_id": 5585943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a364cbb3ba5972c13ec5440c1113c9ed?s=128&d=identicon&r=PG&f=1", "display_name": "jacob.mccrumb", "link": "https://stackoverflow.com/users/5585943/jacob-mccrumb"}, "edited": false, "score": 1, "creation_date": 1455746084, "post_id": 35468397, "comment_id": 58632726, "body": "No problem! And if you could probably also make the outer group non-capturing (unless you need &quot;key: whatever text&quot; <a href=\"http://rubular.com/r/5bMBGpHsoX\" rel=\"nofollow noreferrer\">rubular</a> <code>\\[(?:(key1|key2|key3): (.+?))(?=(?:key1:|key2:|key3:|\\]))</code>"}, {"owner": {"reputation": 3678, "user_id": 145536, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9e92c681072b514fb360a0b01c0f5ea7?s=128&d=identicon&r=PG", "display_name": "Allen Liu", "link": "https://stackoverflow.com/users/145536/allen-liu"}, "reply_to_user": {"reputation": 631, "user_id": 5585943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a364cbb3ba5972c13ec5440c1113c9ed?s=128&d=identicon&r=PG&f=1", "display_name": "jacob.mccrumb", "link": "https://stackoverflow.com/users/5585943/jacob-mccrumb"}, "edited": false, "score": 0, "creation_date": 1455746210, "post_id": 35468397, "comment_id": 58632796, "body": "@jacob.m Thanks. I&#39;ll keep that in mind for the final version. I&#39;ll keep it out for now because that regex is looking pretty hairy (to me at least)."}, {"owner": {"reputation": 631, "user_id": 5585943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a364cbb3ba5972c13ec5440c1113c9ed?s=128&d=identicon&r=PG&f=1", "display_name": "jacob.mccrumb", "link": "https://stackoverflow.com/users/5585943/jacob-mccrumb"}, "edited": false, "score": 1, "creation_date": 1455746450, "post_id": 35468397, "comment_id": 58632928, "body": "Sounds good, but either way rubular is a good website for testing regexp :)"}, {"owner": {"reputation": 3769, "user_id": 801098, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/49a2f1ba2e29fc702a18d253c4fcdb9e?s=128&d=identicon&r=PG", "display_name": "OnlineCop", "link": "https://stackoverflow.com/users/801098/onlinecop"}, "edited": false, "score": 0, "creation_date": 1455746898, "post_id": 35468397, "comment_id": 58633123, "body": "While <a href=\"https://regex101.com/r/oQ2yI0/1\" rel=\"nofollow noreferrer\">this</a> is rather ugly and doesn&#39;t combine both <code>key2</code> into a single key, nor does it handle keys that contain double quotes with the possibility of <code>[</code> and <code>]</code> characters, it DOES hit much of the OP&#39;s requirements. :-)"}, {"owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 1, "creation_date": 1455746909, "post_id": 35468397, "comment_id": 58633133, "body": "Are you interested by something like this? <a href=\"http://rubular.com/r/LWZTiy8yUz\" rel=\"nofollow noreferrer\">rubular.com/r/LWZTiy8yUz</a>"}, {"owner": {"reputation": 3678, "user_id": 145536, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9e92c681072b514fb360a0b01c0f5ea7?s=128&d=identicon&r=PG", "display_name": "Allen Liu", "link": "https://stackoverflow.com/users/145536/allen-liu"}, "reply_to_user": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 0, "creation_date": 1455747206, "post_id": 35468397, "comment_id": 58633279, "body": "@CasimiretHippolyte Thank you! It seems to do the job. I just need to digest it!"}, {"owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 1, "creation_date": 1455747352, "post_id": 35468397, "comment_id": 58633343, "body": "@AllenLiu: be careful, I assumed that the closing bracket has its own line. but with a little change: <a href=\"http://rubular.com/r/5YtcclhgJJ\" rel=\"nofollow noreferrer\">rubular.com/r/5YtcclhgJJ</a>"}, {"owner": {"reputation": 3678, "user_id": 145536, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9e92c681072b514fb360a0b01c0f5ea7?s=128&d=identicon&r=PG", "display_name": "Allen Liu", "link": "https://stackoverflow.com/users/145536/allen-liu"}, "reply_to_user": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 0, "creation_date": 1455747463, "post_id": 35468397, "comment_id": 58633386, "body": "@CasimiretHippolyte Ok. Thanks for the heads up. It actually doesn&#39;t need to be but maybe that&#39;ll be an exercise for me to try to work with this regex. BTW, you should post it as answer so I can credit you."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1455772907, "post_id": 35468397, "comment_id": 58641678, "body": "What you have is not a valid object."}], "answers": [{"comments": [{"owner": {"reputation": 3678, "user_id": 145536, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9e92c681072b514fb360a0b01c0f5ea7?s=128&d=identicon&r=PG", "display_name": "Allen Liu", "link": "https://stackoverflow.com/users/145536/allen-liu"}, "edited": false, "score": 0, "creation_date": 1455821527, "post_id": 35484580, "comment_id": 58672918, "body": "I like the simplicity of this solution. Thanks!"}], "tags": [], "owner": {"reputation": 11718, "user_id": 1827631, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/I24JN.png?s=128&g=1", "display_name": "hirolau", "link": "https://stackoverflow.com/users/1827631/hirolau"}, "is_accepted": true, "score": 1, "last_activity_date": 1455806774, "creation_date": 1455806774, "answer_id": 35484580, "question_id": 35468397, "link": "https://stackoverflow.com/questions/35468397/regex-to-parse-out-data-from-text/35484580#35484580", "title": "regex to parse out data from text", "body": "<pre><code>data = %Q|[key1: this is a bunch of text that can \nspan multiple lines. \nkey2: foo \nkey2: bar\nkey3: this can span multiple lines \nas well \n]|\n\np data[1..-2] #Remove square brackets [...] \n  .split(/(key\\d):\\s+/)[1..-1] #regexp out keys and values. (And get rid of initial empty string)\n  .each_slice(2) #Group into key-value lists\n  .group_by(&amp;:shift) # Group by first values\n</code></pre>\n"}], "owner": {"reputation": 3678, "user_id": 145536, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9e92c681072b514fb360a0b01c0f5ea7?s=128&d=identicon&r=PG", "display_name": "Allen Liu", "link": "https://stackoverflow.com/users/145536/allen-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 35484580, "answer_count": 1, "score": -1, "last_activity_date": 1455806774, "creation_date": 1455745426, "last_edit_date": 1455745974, "question_id": 35468397, "link": "https://stackoverflow.com/questions/35468397/regex-to-parse-out-data-from-text", "title": "regex to parse out data from text", "body": "<p>I'm using Ruby 2.2 to parse the following text:</p>\n\n<pre><code>[key1: this is a bunch of text that can \nspan multiple lines. \nkey2: foo \nkey2: bar\nkey3: this can span multiple lines \nas well \n]\n</code></pre>\n\n<p>Into an array of hashes that look like this:</p>\n\n<pre><code>[\n    key1: \"this is a bunch of text that can span multiple lines.\"\n    key2: [\"foo\", \"bar\"]\n    key3: \"this can span multiple lines as well\"\n]\n</code></pre>\n\n<p>My first goal is to come up with the regex to parse out the key/value pairs and this is what I am stuck on:</p>\n\n<pre><code>/\\[((key1|key2|key3): (.+?))+(?=(?:key1:|key2:|key3:|\\]))/m\n</code></pre>\n\n<p>It's not working because the lookahead I'm using to look for the next key or closing bracket seems to be matching text. My understanding is that it doesn't.</p>\n\n<p>Any suggestions would be greatly appreciated. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "angularjs", "api"], "comments": [{"owner": {"reputation": 10578, "user_id": 736967, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b7d2776ddcfe9d17833e1078285302d?s=128&d=identicon&r=PG", "display_name": "Ronnie", "link": "https://stackoverflow.com/users/736967/ronnie"}, "edited": false, "score": 0, "creation_date": 1455743583, "post_id": 35467806, "comment_id": 58631249, "body": "have you verified the contents of  <code>$scope.message</code> before you POST? What if you remove the content type?"}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455745629, "post_id": 35468020, "comment_id": 58632467, "body": "(Part 1) Thank you, now is the Rails Server is throwing me a different error: <i><b>ArgumentError (When assigning attributes, you must pass a hash as an argument.)</b></i>"}, {"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455745670, "post_id": 35468020, "comment_id": 58632493, "body": "Create Method in rails is:   <b>def create                  respond_with Message.create(params[:content])             end</b>"}, {"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455746097, "post_id": 35468020, "comment_id": 58632734, "body": "Ok, don&#39;t worry: I fixed it  with this:  <b>data    :  {&#39;message&#39;: $scope.message}</b>  Thank you a lot"}], "tags": [], "owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "is_accepted": true, "score": 3, "last_activity_date": 1455744163, "creation_date": 1455744163, "answer_id": 35468020, "question_id": 35467806, "link": "https://stackoverflow.com/questions/35467806/angularjs-sends-nil-parameters-to-api/35468020#35468020", "title": "AngularJS sends nil parameters to API", "body": "<p>You need to serialize the data when you send as <code>x-www-form-urlencoded</code></p>\n\n<p>Example copied from docs</p>\n\n<pre><code>.controller(function($http, $httpParamSerializerJQLike) {\n  //...\n\n  $http({\n    url: myUrl,\n    method: 'POST',\n    data: $httpParamSerializerJQLike(myData),\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    }\n  });\n\n});\n</code></pre>\n\n<p>Or use the defaults of <code>$http</code> which sends JSON in request body as <code>application/json</code>:</p>\n\n<pre><code>$http.post(myurl, data).then(...;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1455744469, "post_id": 35468056, "comment_id": 58631762, "body": "no need to set <code>&#39;application&#47;json&#39;</code> ... that is the default and don&#39;t use <code>toJson</code> that is already done internally. Can see it already in OP&#39;s request"}, {"owner": {"reputation": 7497, "user_id": 2033044, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fnK5m.png?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/2033044/lucas"}, "reply_to_user": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1455744750, "post_id": 35468056, "comment_id": 58631923, "body": "hey, you are right but thought it would be better to have the default written instead of what i thought wouldnt work: x-www-form-urlencoded"}, {"owner": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1455744795, "post_id": 35468056, "comment_id": 58631956, "body": "except then OP would think it was needed every time and others who read this later with similar problems might think so also"}, {"owner": {"reputation": 7497, "user_id": 2033044, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fnK5m.png?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/2033044/lucas"}, "reply_to_user": {"reputation": 162909, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1455744979, "post_id": 35468056, "comment_id": 58632052, "body": "you saw the best solution for sure, this is how I would have started to solve the problem. I just see it weird sending this content type application/x-www-form-urlencoded for json data"}, {"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455745732, "post_id": 35468056, "comment_id": 58632533, "body": "(Part 1) This solution worked too, but now Rails is throwing me a different message:  <i><b>ArgumentError (When assigning attributes, you must pass a hash as an argument.)</b></i>"}, {"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455745789, "post_id": 35468056, "comment_id": 58632566, "body": "(Part 2) This is my Create method in Rails: <b>def create                  respond_with Message.create(params[:content])             end</b>"}, {"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455746160, "post_id": 35468056, "comment_id": 58632767, "body": "Ok, don&#39;t worry: I fixed it  with this:  <b>data    :  {&#39;message&#39;: $scope.message}</b>  And putting this in the Rails Controller: <b>params.require(:message).permit(:content)</b>  Thank you a lot."}], "tags": [], "owner": {"reputation": 7497, "user_id": 2033044, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fnK5m.png?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/2033044/lucas"}, "is_accepted": false, "score": 2, "last_activity_date": 1455744474, "last_edit_date": 1455744474, "creation_date": 1455744275, "answer_id": 35468056, "question_id": 35467806, "link": "https://stackoverflow.com/questions/35467806/angularjs-sends-nil-parameters-to-api/35468056#35468056", "title": "AngularJS sends nil parameters to API", "body": "<p>change this line:</p>\n\n<pre><code>headers : {'Content-Type': 'application/x-www-form-urlencoded'} \n</code></pre>\n\n<p>to:</p>\n\n<pre><code>headers : {'Content-Type': 'application/json'} \n</code></pre>\n\n<p>Also encode to Json if it isnt like this:</p>\n\n<pre><code>  data    :  angular.toJson($scope.message), //forms user object\n</code></pre>\n\n<p>This way you will send the correct JSON formatted data to API, make sure your API accepts Json encoded data just in case. </p>\n"}], "owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 35468020, "answer_count": 2, "score": 2, "last_activity_date": 1455744474, "creation_date": 1455743343, "question_id": 35467806, "link": "https://stackoverflow.com/questions/35467806/angularjs-sends-nil-parameters-to-api", "title": "AngularJS sends nil parameters to API", "body": "<p>I created a basic API with Ruby on Rails. Whenever I try to send data from a form in AngularJS, I get this message in the Rails Server:</p>\n\n<pre><code>Parameters: {\"{\\\"content\\\":\\\"message\\\"}\"=&gt;nil}\n</code></pre>\n\n<p>So, it's creating null records in the DB.</p>\n\n<p>This is the controller in AngularJS to send the data:</p>\n\n<pre><code>app.controller('postController', function($scope, $http) {\n  // create a blank object to handle form data.\n    $scope.message = {};\n  // calling submit function.\n    $scope.submitForm = function() {\n\n    $http({\n      method  : 'POST',\n      url     : 'http://localhost:3000/api/v1/messages',\n      data    :  $scope.message, //forms user object\n      headers : {'Content-Type': 'application/x-www-form-urlencoded'} \n     })\n      .success(function(data) { ... }\n      });\n    };\n});\n</code></pre>\n"}, {"tags": ["ios", "iphone", "ruby", "rubygems"], "owner": {"reputation": 139, "user_id": 5391570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/izXHq.jpg?s=128&g=1", "display_name": "xorist", "link": "https://stackoverflow.com/users/5391570/xorist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455750576, "creation_date": 1455742703, "last_edit_date": 1455750576, "question_id": 35467606, "link": "https://stackoverflow.com/questions/35467606/lazy-symbol-binding-failed-error-when-attempting-to-install-gem-bundler", "title": "&#39;lazy symbol binding failed&#39; error when attempting to install gem bundler", "body": "<p><strong><em>Question</em></strong></p>\n\n<p>I'm trying to install MetaSploit on my iPhone 5S with iOS 8.1.3. Pangu Jailbreak. I've run into an issue with getting it working. Whenever I run the command <code>ruby msfconsole</code> I get a dependency error</p>\n\n<pre><code>iphone:/msf3 root# ruby msfconsole\n[*] Metasploit requires the Bundler gem to be installed\n    $ gem install bundler\n</code></pre>\n\n<p>So then I attempt to install the bundler as instructed, but then I encounter the error.</p>\n\n<pre><code>iphone:/msf3 root# gem install bundler\ndyld: lazy symbol binding failed: Symbol not found: __OSSwapInt16\n  Referenced from: /usr/lib/ruby/1.9.1/arm-darwin9/socket.bundle\n  Expected in: flat namespace\n\ndyld: Symbol not found: __OSSwapInt16\n  Referenced from: /usr/lib/ruby/1.9.1/arm-darwin9/socket.bundle\n  Expected in: flat namespace\n</code></pre>\n\n<p>does anyone know how to fix this?</p>\n\n<p><strong><em>gem environment</em></strong></p>\n\n<pre><code>iphone:/msf3 root# gem environment\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.3.7\n  - RUBY VERSION: 1.9.2 (2010-08-18 patchlevel 0) [arm-darwin9]\n  - INSTALLATION DIRECTORY: /usr/lib/ruby/gems/1.9.1\n  - RUBY EXECUTABLE: /usr/bin/ruby\n  - EXECUTABLE DIRECTORY: /usr/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - arm-darwin-9\n  - GEM PATHS:\n     - /usr/lib/ruby/gems/1.9.1\n     - /var/root/.gem/ruby/1.9.1\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - http://rubygems.org/\n</code></pre>\n\n<p><strong><em>Gemfile</em></strong></p>\n\n<pre><code>source 'https://rubygems.org'\n# Add default group gems to `metasploit-framework.gemspec`:\n#   spec.add_runtime_dependency '&lt;name&gt;', [&lt;version requirements&gt;]\ngemspec name: 'metasploit-framework'\n\n# separate from test as simplecov is not run on travis-ci\ngroup :coverage do\n  # code coverage for tests\n  # any version newer than 0.5.4 gives an Encoding error when trying to read the source files.\n  # see: https://github.com/colszowka/simplecov/issues/127 (hopefully fixed in 0.8.0)\n  gem 'simplecov'\nend\n\ngroup :development do\n  # Markdown formatting for yard\n  gem 'redcarpet'\n  # generating documentation\n  gem 'yard'\n  # for development and testing purposes\n  gem 'pry'\nend\n\ngroup :development, :test do\n  # automatically include factories from spec/factories\n  gem 'factory_girl_rails', '~&gt; 4.5.0'\n  # Make rspec output shorter and more useful\n  gem 'fivemat', '~&gt; 1.3.1'\n  # running documentation generation tasks and rspec tasks\n  gem 'rake', '&gt;= 10.0.0'\n  # Define `rake spec`.  Must be in development AND test so that its available by default as a rake test when the\n  # environment is development\n  gem 'rspec-rails' , '~&gt; 3.3'\nend\n\ngroup :test do\n  # cucumber extension for testing command line applications, like msfconsole\n  gem 'aruba'\n  # cucumber + automatic database cleaning with database_cleaner\n  gem 'cucumber-rails', :require =&gt; false\n  gem 'shoulda-matchers'\n  # Manipulate Time.now in specs\n  gem 'timecop'\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "loops", "integer"], "comments": [{"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 7, "creation_date": 1455742932, "post_id": 35467524, "comment_id": 58630900, "body": "If you&#39;re going to post your homework, at least show us what you&#39;ve tried so far, and where you got stuck."}, {"owner": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "edited": false, "score": 5, "creation_date": 1455743429, "post_id": 35467524, "comment_id": 58631176, "body": "I&#39;m voting to close this question as off-topic because it looks like a homework exercise, without any attempt to solve it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455745785, "post_id": 35467524, "comment_id": 58632562, "body": "<code>do</code>, <code>while</code> and <code>until</code> employ loops, but enumerator with blocks do not. If you do not mean to exclude the latter you may wish to strike the all-caps sentence. I presume the entire family of <code>max</code> methods is off-limits (`max_by, minmax, etc.)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455745950, "post_id": 35467524, "comment_id": 58632652, "body": "How about <code>arr = numbers.uniq; (arr-arr.min(arr.size-1)).first #=&gt; 60</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "edited": false, "score": 0, "creation_date": 1455746436, "post_id": 35467524, "comment_id": 58632918, "body": "@eugen, are those valid reasons for closing? Reference? Many times I see newbies (never veterans!) scolded for not showing their attempt at a solution. The plain fact is that newbies often have no idea where to start  to solve the problem. Should we force them to present gibberish?  So what if it&#39;s homework? We&#39;re here to teach, not to serve as instructors&#39; aides."}, {"owner": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1455747490, "post_id": 35467524, "comment_id": 58633399, "body": "@CarySwoveland, have a look at <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> - specifically point 3."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "edited": false, "score": 0, "creation_date": 1455785399, "post_id": 35467524, "comment_id": 58647535, "body": "@eugen, the part dealing with homework states, &quot;Questions asking for homework help must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it.&quot; That&#39;s reasonable, as it does not necessarily demand code. (Have you ever worked on a problem for hours and not had any code to show for it?) I suggest that in these cases the OP be asked to respond to what I quoted above, rather than to &quot;<i>show</i> us what you&#39;ve done&quot;, which to me means &quot;show us your code&quot;. Only if the OP refuses to do so should a vote to close be issued."}], "answers": [{"comments": [{"owner": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "edited": false, "score": 0, "creation_date": 1455743846, "post_id": 35467558, "comment_id": 58631387, "body": "See the post by @Cappy  for a revised version of this  :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455744556, "post_id": 35467558, "comment_id": 58631807, "body": "You and @Cappy should both add <code>max_num</code> as a third line, to retrieve the value."}], "tags": [], "owner": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "is_accepted": false, "score": 2, "last_activity_date": 1455742552, "creation_date": 1455742552, "answer_id": 35467558, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35467558#35467558", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>Create another variable to store the current max, and then loop through the numbers.</p>\n\n<pre><code>max_num = 0\nnumbers.each { |n| max_num = n if n &gt; max_num }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3994, "user_id": 37019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4354cb7ba5e9c6a01f77eb8de753b62?s=128&d=identicon&r=PG", "display_name": "danielrsmith", "link": "https://stackoverflow.com/users/37019/danielrsmith"}, "is_accepted": false, "score": 2, "last_activity_date": 1455742852, "creation_date": 1455742852, "answer_id": 35467656, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35467656#35467656", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>I love using <code>inject</code> for something like this</p>\n\n<pre><code>numbers.inject(0){|acc,n| n &gt; acc ? n : acc}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455744721, "post_id": 35467709, "comment_id": 58631902, "body": "<code>reduce</code> is preferred to <code>inject</code>, which @danielrsmith used in his earlier answer?"}, {"owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455746980, "post_id": 35467709, "comment_id": 58633162, "body": "Both <code>reduce</code> and <code>inject</code> do the same things (reduce is an alias of inject), however according to <a href=\"https://github.com/bbatsov/ruby-style-guide#map-find-select-reduce-size\" rel=\"nofollow noreferrer\">Ruby Style Guide</a> it is preferred to use reduce."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455785692, "post_id": 35467709, "comment_id": 58647694, "body": "I realize that. I just don&#39;t see the point of your answer considering that it is a duplicate of an earlier answer."}], "tags": [], "owner": {"reputation": 2172, "user_id": 4412925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf7fa1503a3820659b27943c99d463a0?s=128&d=identicon&r=PG&f=1", "display_name": "Nabeel", "link": "https://stackoverflow.com/users/4412925/nabeel"}, "is_accepted": false, "score": 1, "last_activity_date": 1455743338, "last_edit_date": 1455743338, "creation_date": 1455742986, "answer_id": 35467709, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35467709#35467709", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>Another one to use is the Enumerable <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-reduce\" rel=\"nofollow\"><code>reduce</code></a>.</p>\n\n<pre><code>[-1000000, 10, 20, 30, 40, 50, 100, 60, 80].reduce {|x,y| x &gt; y ? x : y}\n=&gt; 100\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "edited": false, "score": 0, "creation_date": 1455743367, "post_id": 35467771, "comment_id": 58631141, "body": "Good catch! <code>max_num</code> should be set to first number in array rather than 0   :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455744898, "post_id": 35467771, "comment_id": 58632012, "body": "...or to <code>-Float::INFINITY #=&gt; -Infinity</code> (same as <code>-1.0&#47;0</code>)."}], "tags": [], "owner": {"reputation": 11, "user_id": 5942479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a4283f0df36c4a0a13a4f466c4c402a?s=128&d=identicon&r=PG&f=1", "display_name": "Cappyccino", "link": "https://stackoverflow.com/users/5942479/cappyccino"}, "is_accepted": false, "score": 1, "last_activity_date": 1455743241, "creation_date": 1455743241, "answer_id": 35467771, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35467771#35467771", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>Similar to philip yoo's answer, but works for an array of negative numbers.</p>\n\n<pre><code>max_num = numbers.first \nnumbers.each { |n| max_num = n if n &gt; max_num }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 5938358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd980f4c02d88122d045088ca2eef14?s=128&d=identicon&r=PG&f=1", "display_name": "JonahR", "link": "https://stackoverflow.com/users/5938358/jonahr"}, "is_accepted": false, "score": 0, "last_activity_date": 1455745344, "creation_date": 1455745344, "answer_id": 35468366, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35468366#35468366", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>This code is run on a <code>for</code> loop instead of  <code>.each</code>. From what your questioned asked, I thought you might need an actual loop constructor.</p>\n\n<pre><code>numbers = [10, 20, 30, 40, 50]\ngreatest_num = numbers.first\nfor n in numbers\n    greatest_num = n if n &gt; greatest_num\nend\np greatest_num\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1455745377, "creation_date": 1455745377, "answer_id": 35468379, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35468379#35468379", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>Not a loop, but you could use recursion.</p>\n\n<pre><code>numbers = [10, 20, 30, 40, 60, 50]\n\ndef biggest(arr)\n  return arr.first if arr.size == 1\n  cand = biggest(arr[1..-1])\n  arr.first &gt; cand ? arr.first : cand\nend\n\nbiggest(numbers) #=&gt; 60\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5942470, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208155945633531/picture?type=large", "display_name": "JAidin", "link": "https://stackoverflow.com/users/5942470/jaidin"}, "is_accepted": false, "score": 0, "last_activity_date": 1455761010, "last_edit_date": 1455761010, "creation_date": 1455754874, "answer_id": 35470458, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby/35470458#35470458", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>A more \"newbie\" way (since i am one :-)) Started the Ruby journey 2 weeks ago</p>\n\n<pre><code>numbers = [10, 20, 30, 40, 50, 60] # your array\nmax_num = numbers[0] # Setting max_num to the first element of your array    \nnumbers.size.times{|x| if max_num &lt; numbers[x] then max_num = numbers[x] end} # I use \n #* the .size method to find how many elements are on your array and the .times method\n #* to iterate \"size\" \"times\" over your array.  In the block you have a simple comparison\nputs max_num #displaying the result\n</code></pre>\n\n<p>So, a little bit more detail.... An array index always starts at 0. We never assign zero to our max_num variable because your array might contain negative numbers.</p>\n\n<p>The numbers.size.times thingy... In Ruby we can use multiple methods on an object and in our example the object is the array numbers. So, numbers.size will return 6 (remember arrays start at 0. So from 0 to 5 equals 6 elements on your array) and then we use the .times method to loop 6 times the block. </p>\n\n<p>Inside the block... .times method will pass to variable x the values from 0 to 5. So, all that remains is to do a simple comparison. If our max_num is less than our numbers array in x position (numbers[x]) then then make numbers[x] my new max_num (max_num = numbers[x]). The block will repeat it self 6.times :-)</p>\n\n<p>The code works.. As for the explanation.. This is how I understand it... And since English is not my native language i ask the community to comment (good and bad) both the code and the explanation... </p>\n"}], "owner": {"reputation": 29, "user_id": 5942599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669fc775601e4c69863c13effe89d7ae?s=128&d=identicon&r=PG&f=1", "display_name": "liz", "link": "https://stackoverflow.com/users/5942599/liz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 0, "closed_date": 1455757258, "answer_count": 7, "score": -6, "last_activity_date": 1455761010, "creation_date": 1455742444, "question_id": 35467524, "link": "https://stackoverflow.com/questions/35467524/using-a-loop-to-find-greatest-integer-in-array-using-ruby", "closed_reason": "Not suitable for this site", "title": "Using a loop to find greatest integer in array using Ruby", "body": "<p>I need to find the greatest integer in an array using a loop in Ruby</p>\n\n<p>ex: numbers = [10, 20, 30, 40, 50, 60]</p>\n\n<p><em>note</em> I can't use the .max function. HAS TO BE A LOOP.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 2, "last_activity_date": 1456162279, "creation_date": 1456162279, "answer_id": 35560109, "question_id": 35467521, "link": "https://stackoverflow.com/questions/35467521/why-cant-i-get-the-allocation-source-information/35560109#35560109", "title": "Why can&#39;t I get the allocation source information?", "body": "<p>Those two objects were simply allocated before the <code>ObjectSpace.trace_object_allocations_start</code> call or any other Ruby code in this file was executed:</p>\n\n<ul>\n<li><p><code>\"foo\".freeze</code> was allocated at <a href=\"https://github.com/ruby/ruby/blob/v2_3_0/compile.c#L4797-L4811\" rel=\"nofollow\">compile time by <code>rb_fstring()</code></a> (and originally also at <a href=\"https://github.com/ruby/ruby/blob/v2_3_0/parse.y#L6507\" rel=\"nofollow\">parse time</a>)</p></li>\n<li><p>the additional allocation of <code>\"foo\"</code> at run time happens only because internally <code>obj = \"foo\"</code> is actually similar to <code>obj = \"foo\".dup</code>. Take a look at the definition of the <a href=\"https://github.com/ruby/ruby/blob/v2_3_0/insns.def#L343-L355\" rel=\"nofollow\"><code>putstring</code> YARV instruction</a> and the <a href=\"https://github.com/ruby/ruby/blob/v2_3_0/string.c#L1317-L1322\" rel=\"nofollow\"><code>rb_str_resurrect()</code></a> function for more details. </p></li>\n<li><p><code>/foo/</code> was allocated at <a href=\"https://github.com/ruby/ruby/blob/v2_3_0/parse.y#L3972-L3988\" rel=\"nofollow\">parse time by <code>reg_compile()</code></a>. That's it. No duplication here, so it's always the same object (no interning occurs though and it might be surprising behavior to some):</p>\n\n<pre><code>3.times.map{ \"foo\".object_id }.uniq         # =&gt; [21063740, 21063720, 21063700]\n3.times.map{ \"foo\".freeze.object_id }.uniq  # =&gt; [21064340]\n3.times.map{ /foo/.object_id }.uniq         # =&gt; [21065100]\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 35560109, "answer_count": 1, "score": 3, "last_activity_date": 1456162279, "creation_date": 1455742424, "last_edit_date": 1592644375, "question_id": 35467521, "link": "https://stackoverflow.com/questions/35467521/why-cant-i-get-the-allocation-source-information", "title": "Why can&#39;t I get the allocation source information?", "body": "<h3>1. String</h3>\n<p>When I have a non-frozen non-interned string, I can get its source location (suppose the file name is <code>foo_file.rb</code>):</p>\n<pre><code>require &quot;objspace&quot;\nObjectSpace.trace_object_allocations_start\n\nobj = &quot;foo&quot;\nObjectSpace.allocation_sourcefile(obj) # =&gt; foo_file.rb\nObjectSpace.allocation_sourceline(obj) # =&gt; 4\n</code></pre>\n<p>When I have an interned string, the source location becomes unavailable (note the interning feature with <code>freeze</code> after a string literal):</p>\n<pre><code>obj = &quot;foo&quot;.freeze\nObjectSpace.allocation_sourcefile(obj) # =&gt; nil\nObjectSpace.allocation_sourceline(obj) # =&gt; nil\n</code></pre>\n<p>I can confirm that this unavailability is not because it is frozen, but it is because it is interned:</p>\n<pre><code>obj = &quot;foo&quot;\nobj = obj.freeze\nObjectSpace.allocation_sourcefile(obj) # =&gt; foo_file.rb\nObjectSpace.allocation_sourceline(obj) # =&gt; 4\n</code></pre>\n<p>Why can't I get the source information from an interned string?</p>\n<h3>2. Regxp</h3>\n<p>When I have a regex, I can't get the source information even if it is not frozen:</p>\n<pre><code>obj = /foo/\nobj.frozen? # =&gt; false\nObjectSpace.allocation_sourcefile(obj) # =&gt; nil\nObjectSpace.allocation_sourceline(obj) # =&gt; nil\n</code></pre>\n<p>Why can't I get the source location from a regex even when it is not frozen?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "edited": false, "score": 0, "creation_date": 1455743652, "post_id": 35467341, "comment_id": 58631287, "body": "Can you please include <code>_user.html.erb</code>?"}, {"owner": {"reputation": 1150, "user_id": 5213790, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JsYim.jpg?s=128&g=1", "display_name": "mrvncaragay", "link": "https://stackoverflow.com/users/5213790/mrvncaragay"}, "edited": false, "score": 0, "creation_date": 1455743671, "post_id": 35467341, "comment_id": 58631297, "body": "yes, you have to add something like this in your <code>_user.html.erb</code>,  <code>&lt;%= user.name %&gt;</code> since @user is an instance of User model."}], "answers": [{"comments": [{"owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "edited": false, "score": 0, "creation_date": 1455745617, "post_id": 35467908, "comment_id": 58632458, "body": "Changed to your suggestion, and still no results are printed :/"}], "tags": [], "owner": {"reputation": 96, "user_id": 2112230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0842e07e98e0b3aa914d30887c93b1c?s=128&d=identicon&r=PG", "display_name": "GonzoGhanem", "link": "https://stackoverflow.com/users/2112230/gonzoghanem"}, "is_accepted": false, "score": 0, "last_activity_date": 1455743789, "creation_date": 1455743789, "answer_id": 35467908, "question_id": 35467341, "link": "https://stackoverflow.com/questions/35467341/search-results-not-printing/35467908#35467908", "title": "Search results not printing?", "body": "<p>You are getting no results on your <code>search</code> method, that's why you don't see any results after. Change your <code>where</code> statements, since it's creating and AND query and you are probably looking for an OR. Please try something like:</p>\n\n<pre><code>def self.search(search)\n    where(\"firstname LIKE ? OR lastname LIKE ?\", \"%#{search}%\", \"%#{search}%\")\nend\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "edited": false, "score": 0, "creation_date": 1455746165, "post_id": 35468021, "comment_id": 58632771, "body": "This works like a charm - thank you! What if I type a first and last name into my search field though? e.g. Searching &quot;Brittany&quot; pulls up a first name and lastname result, but searching &quot;Brittany Miller&quot; brings up no results."}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "reply_to_user": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "edited": false, "score": 0, "creation_date": 1455746312, "post_id": 35468021, "comment_id": 58632850, "body": "Oooh, I had fun with that one not too long ago. It was <b><i>nasty</i></b>. I&#39;ll throw in an update above."}, {"owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "edited": false, "score": 0, "creation_date": 1455747292, "post_id": 35468021, "comment_id": 58633313, "body": "Thank you so much - and strange, searching multiple fields seems like it would be an easy/common task?! No? My rails app is sitting on Sqlite3."}], "tags": [], "owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "is_accepted": true, "score": 0, "last_activity_date": 1455747381, "last_edit_date": 1455747381, "creation_date": 1455744172, "answer_id": 35468021, "question_id": 35467341, "link": "https://stackoverflow.com/questions/35467341/search-results-not-printing/35468021#35468021", "title": "Search results not printing?", "body": "<h2>View</h2>\n\n<p>It's not usually done to pass <code>params</code> back to the view - mainly I think because it changes for each request, and it might end up being different to what you expect. You probably want to copy this to an instance variable in the controller.</p>\n\n<pre><code>&lt;% if @users.present? %&gt;\n  &lt;%= render @users %&gt;\n&lt;% else %&gt;\n  &lt;p&gt;There are no posts containing the term(s) &lt;%= @search %&gt;.&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<h2>Partial</h2>\n\n<p><strong>_user.html.erb</strong></p>\n\n<pre><code>&lt;%= user.firstname %&gt; &lt;%= user.lastname%&gt;\n</code></pre>\n\n<h2>Controller</h2>\n\n<ol>\n<li>Scrap <code>@user = User.all</code>, it doesn't do anything.</li>\n<li>You're returning more than one user; your variable should be called <code>@users</code> for readability.</li>\n<li>Scrap <code>.all</code> in the <code>else</code> clause, it's not necessary.</li>\n</ol>\n\n<p>It should be:</p>\n\n<pre><code>def index\n  @search = params[:search]\n  if @search\n    @users = User.search(@search).order(\"created_at DESC\")\n  else\n    @users = User.order('created_at DESC')\n  end\nend\n</code></pre>\n\n<h2>Model</h2>\n\n<p><code>where(\"firstname LIKE ?\", \"%#{search}%\")</code> is getting ignored. It runs it, but throws the result away and returns only the result of the next line. You want:</p>\n\n<pre><code>def self.search(search)\n  where(\"firstname LIKE :p OR lastname LIKE :p\", p: \"%#{search}%\")\nend\n</code></pre>\n\n<hr>\n\n<h1>Multi field search</h1>\n\n<p>- Search multiple fields for multiple tokens out of a single parameter</p>\n\n<p>You are a <strong>masochist</strong> if you want to try this. But it is possible, and I have done it before.</p>\n\n<p><em>Note: this is written for SQL Server 2008, as that's what my company was using at the time. Some SQL functions - particularly <code>IsNull</code> and <code>LIKE</code> - may be different depending on what you're using.</em></p>\n\n<pre><code>class User\n  scope :search, -&gt;(value) do\n    # This allows tokens containing A-z, 0-9, _, and %. Anything else is treated\n    # as a delimiter.\n    multi_field_search(%w[firstname lastname], value.split(/[^\\w%]/))\n  end\n\n  # This scope is generic, and reusable for any combination of string fields in\n  # any model.\n  scope :multi_field_search, -&gt;(fields, values) do\n    # You're looking in these fields...\n    fields_clause = fields.select(&amp;:present?).map do |field|\n      \"IsNull(#{field}, '')\"\n    end.join(\" + ' ' + \")\n\n    # ... for these values...\n    values_clause = sanitize_conditions(values.select(&amp;:present?).map do |value|\n      \"combo_view.combination LIKE '%#{value}%'\"\n    end.join(' AND '))\n\n    # ... and you do it by constructing a query to join the fields together, and\n    # searching for each token of the search parameter individually.\n    joins(&lt;&lt;-SQL).where(values_clause)\n      INNER JOIN (\n        SELECT *, #{fields_clause} AS combination\n        FROM #{table_name}\n      ) AS combo_view ON #{table_name}.#{primary_key} = combo_view.#{primary_key}\n    SQL\n  end\n\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1321, "user_id": 3030060, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/vjjqk.png?s=128&g=1", "display_name": "Brittany", "link": "https://stackoverflow.com/users/3030060/brittany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 35468021, "answer_count": 2, "score": 0, "last_activity_date": 1455747381, "creation_date": 1455741866, "question_id": 35467341, "link": "https://stackoverflow.com/questions/35467341/search-results-not-printing", "title": "Search results not printing?", "body": "<p>I've built a search bar into my application.html.erb header that allows my visitors to search \"Users\" on my site, and upon clicking the 'submit' button to show search results, found results don't seem to print on my page (it's merely blank).</p>\n\n<p>I've created index.html.erb under my users folder, as well as _user.html.erb, so I'm not sure why this is happening (as I understand it, _user.html.erb is necessary to display found/rendered results)? </p>\n\n<p>Is there a line of code I should be placing in _user.html.erb?</p>\n\n<p>Here's what's in my <strong>index.html.erb</strong>:</p>\n\n<pre><code>&lt;% if @user.present? %&gt;\n  &lt;%= render @user %&gt;\n&lt;% else %&gt;\n  &lt;p&gt;There are no posts containing the term(s) &lt;%= params[:search] %&gt;.&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Incase you need my other files:</p>\n\n<p><strong>users_controller.rb</strong></p>\n\n<pre><code>def index\n  @user = User.all\n  if params[:search]\n    @user = User.search(params[:search]).order(\"created_at DESC\")\n  else\n    @user = User.all.order('created_at DESC')\n  end\nend\n</code></pre>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>def self.search(search)\n  where(\"firstname LIKE ?\", \"%#{search}%\") \n  where(\"lastname LIKE ?\", \"%#{search}%\")\nend\n</code></pre>\n"}, {"tags": ["php", "ruby", "primes"], "comments": [{"owner": {"reputation": 73199, "user_id": 2844319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYfls.png?s=128&g=1", "display_name": "AbraCadaver", "link": "https://stackoverflow.com/users/2844319/abracadaver"}, "edited": false, "score": 1, "creation_date": 1455742080, "post_id": 35467253, "comment_id": 58630416, "body": "Maybe you want to move <code>return $flag;</code> to the end outside of the loop."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1455742223, "post_id": 35467253, "comment_id": 58630523, "body": "Why not use a conventional <a href=\"http://php.net/manual/en/control-structures.for.php\" rel=\"nofollow noreferrer\"><code>for</code> loop</a> instead of this quirky, manual <code>while</code> style? <code>for($k = 0; $k &lt;= 100; $k++)</code> would be more concise."}, {"owner": {"reputation": 223, "user_id": 4983424, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7c4296d34222334921aa97c940a43f0?s=128&d=identicon&r=PG&f=1", "display_name": "Stijn Westerhof", "link": "https://stackoverflow.com/users/4983424/stijn-westerhof"}, "edited": false, "score": 0, "creation_date": 1455742834, "post_id": 35467253, "comment_id": 58630845, "body": "Okay thanks for the feedback! I used both of your suggestions, and it worked :)"}], "owner": {"reputation": 223, "user_id": 4983424, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7c4296d34222334921aa97c940a43f0?s=128&d=identicon&r=PG&f=1", "display_name": "Stijn Westerhof", "link": "https://stackoverflow.com/users/4983424/stijn-westerhof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455742054, "creation_date": 1455741553, "last_edit_date": 1455742054, "question_id": 35467253, "link": "https://stackoverflow.com/questions/35467253/converting-a-ruby-script-to-a-php-script", "title": "Converting a Ruby script to a PHP script", "body": "<p>I have to make a PHP script that calculates prime numbers. I never made something in PHP before.. (only in Ruby and JavaScript) I already tried to convert the script to PHP (see below) can someone explain me why it doesn't print down the first two prime numbers (2 &amp; 3)? It worked in my ruby script.</p>\n\n<pre><code>&lt;?php\n$k = 0;\nfunction primeNumber($n) {\n $flag = true;\n $i = 2;\n while($i &lt;= ($n / 2) &amp;&amp; $flag == true) {\n   if ($n % $i == 0) {\n     $flag = false;\n     break;\n   }else {\n     $i++;\n   }\n   return $flag;\n }\n}\nwhile ($k &lt;= 100) {\n if (primeNumber($k)) {\n   echo $k.\"&lt;/br&gt;\";\n }\n $k++;\n}\n\n?&gt;\n</code></pre>\n\n<p>Please dont remake the script completely, cause I understand it while doing it this way. :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 0, "creation_date": 1455743568, "post_id": 35467206, "comment_id": 58631244, "body": "Assuming you&#39;re trying to capture and test HTTP calls to an API external to your application, take a look at VCR - <a href=\"https://github.com/vcr/vcr\" rel=\"nofollow noreferrer\">github.com/vcr/vcr</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1455747411, "post_id": 35467415, "comment_id": 58633369, "body": "Edited - message expectations and Expectation messages are not the same thing."}], "tags": [], "owner": {"reputation": 6559, "user_id": 382520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05f73868bd13eba39cab490c897f1333?s=128&d=identicon&r=PG", "display_name": "JCorcuera", "link": "https://stackoverflow.com/users/382520/jcorcuera"}, "is_accepted": false, "score": 3, "last_activity_date": 1455747384, "last_edit_date": 1495535291, "creation_date": 1455742085, "answer_id": 35467415, "question_id": 35467206, "link": "https://stackoverflow.com/questions/35467206/how-do-i-check-if-an-api-was-called-during-a-test/35467415#35467415", "title": "How do I check if an API was called during a test", "body": "<p>You need to use <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/basics/expecting-messages\" rel=\"nofollow noreferrer\">message expectations</a>, for example:</p>\n\n<pre><code>it \"asks the project to trigger all hooks\" do\n  expect(project).to receive(:execute_hooks).twice\n  expect(project).to receive(:execute_services).twice\n  expect(project).to receive(:update_merge_requests)\n\n  PostReceive.new.perform(...)\nend\n</code></pre>\n\n<p>Regarding mailers check this other <a href=\"https://stackoverflow.com/a/19983341\">answer</a></p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 6, "last_activity_date": 1618556823, "last_edit_date": 1618556823, "creation_date": 1455746212, "answer_id": 35468596, "question_id": 35467206, "link": "https://stackoverflow.com/questions/35467206/how-do-i-check-if-an-api-was-called-during-a-test/35468596#35468596", "title": "How do I check if an API was called during a test", "body": "<p>Sending real HTTP requests from your app can have some serious drawbacks:</p>\n<ul>\n<li>Flapping tests due to connectivity issues.</li>\n<li>Dramatically slower test suites.</li>\n<li>Hitting API rate limits on 3rd party sites</li>\n<li>Service may not exist yet (only documentation for it).</li>\n<li>Non-deterministic responses can cause flapping tests.</li>\n<li>API may not provide sandboxes or test mode.</li>\n</ul>\n<p>You also need to weigh having clear boundaries of each application vs test acuity. Properly respecting the app boundaries means that you only test that your app communicates with the collaborator(s) as specified by the API(s) and stub out the actual communication.</p>\n<p>The con is of course that stubbing always has a cost when it comes to test acuity. You may miss bugs where the API does not work as documented or where you're simply testing for the wrong thing.</p>\n<p><strong>Webmock</strong> for example lets you stub out the HTTP layer completely. You can set expectations on the external calls and mock the return values.</p>\n<pre><code>stub_request(:post, &quot;api.example.com&quot;).to_return(status: 201)\n</code></pre>\n<hr />\n<pre><code>expect(a_request(:post, &quot;www.example.com&quot;).\n  with(:body =&gt; {&quot;a&quot; =&gt; [&quot;b&quot;, &quot;c&quot;]},\n    :headers =&gt; {'Content-Type' =&gt; 'application/json'})).to have_been_made\n</code></pre>\n<p><strong>VCR</strong> on the other hand is kind of a middle road, it lets you perform real HTTP requests which it records to YML files and then plays back the results. Subsequent runs are faster and deterministic. VCR is a lot less arduous than setting up mock responses, however you still need to deal with setting up the initial state and cleaning up any side effects on the external service from your tests.</p>\n<pre><code>VCR.use_cassette(&quot;synopsis&quot;) do\n  response = Net::HTTP.get_response(URI('http://example.com'))\n  expect(response.body).to match(&quot;Example domain&quot;)\nend\n</code></pre>\n<p>This is an example plucked from a real world app that uses the Flickr API:</p>\n<pre><code>RSpec.feature 'Importing photosets from flickr' do\n\n  include JavascriptTestHelpers\n\n  let(:user) { create(:admin, flickr_uid: 'xxx') }\n\n  before { login_as user }\n\n  let(:visit_new_photosets_path) do\n    VCR.use_cassette('photosets_import') { visit new_photoset_path }\n  end\n\n  scenario 'When I create a photoset it should have the correct attributes', js: true do\n    visit_new_photosets_path\n    VCR.use_cassette('create_a_photoset') do\n      click_button('Create Photoset', match: :first)\n      wait_for_ajax\n    end\n    find('.photoset', match: :first).click\n    expect(page).to have_content &quot;Showcase&quot;\n    expect(page).to have_content &quot;Like a greatest hits collection, but with snow.&quot;\n    expect(page).to have_selector '.photo img', count: 10\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1588, "user_id": 3442951, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/oqtiY.png?s=128&g=1", "display_name": "Will Taylor", "link": "https://stackoverflow.com/users/3442951/will-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1379, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1618556823, "creation_date": 1455741399, "last_edit_date": 1455756879, "question_id": 35467206, "link": "https://stackoverflow.com/questions/35467206/how-do-i-check-if-an-api-was-called-during-a-test", "title": "How do I check if an API was called during a test", "body": "<p>I want our app to speak to our microservice for sending emails via an API.</p>\n\n<p>In tests (in RSpec), I want to say:</p>\n\n<ol>\n<li>Do something</li>\n<li>I expect the microservice to have been called / not been called.</li>\n</ol>\n\n<p>For example:</p>\n\n<ol>\n<li>Create a user</li>\n<li>I expect to have sent the welcome email.</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "react-native", "resque", "resque-scheduler"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 4765385, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152806996726984/picture?type=large", "display_name": "kalyco", "link": "https://stackoverflow.com/users/4765385/kalyco"}, "is_accepted": false, "score": 0, "last_activity_date": 1461948249, "creation_date": 1461948249, "answer_id": 36943570, "question_id": 35467095, "link": "https://stackoverflow.com/questions/35467095/processing-jobs-in-the-background-using-resque-and-resque-scheduler/36943570#36943570", "title": "Processing jobs in the background using Resque and Resque-scheduler", "body": "<p>I ran into this issue when I was moving to production. At first I added a pre and post deploy to start resque after the regular system configurations were running, because it causes a hitch if scheduler runs in the background. That worked but I later just added <code>nohup</code> to the arguement and that worked for me:</p>\n\n<p><code>VERBOSE=1 PIDFILE=./resque_scheduler.pid BACKGROUND=yes nohup rake environment resque:scheduler &gt;&gt; log/resque_scheduler.log 2&gt;&amp;1'\"</code></p>\n"}], "owner": {"reputation": 69, "user_id": 4677664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RXseX.jpg?s=128&g=1", "display_name": "Jourdan Bul-lalayao", "link": "https://stackoverflow.com/users/4677664/jourdan-bul-lalayao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461948249, "creation_date": 1455741035, "question_id": 35467095, "link": "https://stackoverflow.com/questions/35467095/processing-jobs-in-the-background-using-resque-and-resque-scheduler", "title": "Processing jobs in the background using Resque and Resque-scheduler", "body": "<p>I'm building an iOS app using Ruby on Rails as the back-end. I need help with an issue while trying to use Resque and Resque-scheduler to run a delayed job in the future (using a 'deliveries' queue).</p>\n\n<p><strong>Basically, my jobs work correctly when I run both Resque and Resque-scheduler in the foreground, but the jobs don't process in Resque when I run them in the background (using <code>BACKGROUND=yes</code>).</strong></p>\n\n<p>If you see the screenshot below, you can see Resque-scheduler processing 'Delayed Items', but Resque doesn't actually process it. I have <code>VERBOSE=1</code> set for Resque, so that I can see the logs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Zios.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Zios.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Any idea what I'm doing wrong? Could it be my configuration settings being incorrect? Here's my configuration</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h87bY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h87bY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks so much! Feel free to ask for more information if necessary.</p>\n"}, {"tags": ["ruby", "wildcard", "watir", "unzip"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4088858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44b3f197b3c7ac9a6a40288cdecd7cb?s=128&d=identicon&r=PG", "display_name": "guestburg", "link": "https://stackoverflow.com/users/4088858/guestburg"}, "edited": false, "score": 0, "creation_date": 1455743144, "post_id": 35467221, "comment_id": 58631012, "body": "That makes a lot more sense! Thank you so much!"}, {"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "reply_to_user": {"reputation": 7, "user_id": 4088858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44b3f197b3c7ac9a6a40288cdecd7cb?s=128&d=identicon&r=PG", "display_name": "guestburg", "link": "https://stackoverflow.com/users/4088858/guestburg"}, "edited": false, "score": 0, "creation_date": 1455743597, "post_id": 35467221, "comment_id": 58631259, "body": "That&#39;s a different thing, and not directly supported by <code>Zip::File</code>. You need to concatenate them afterwards. Or call a shell command. <code>unzip</code> on UNIX can for example extract to stdout. You might redirect that to a file. I suggest to investigate a bit and if you should not find a solution, ask a new question dedicated to that."}], "tags": [], "owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "is_accepted": false, "score": 1, "last_activity_date": 1455741843, "last_edit_date": 1455741843, "creation_date": 1455741446, "answer_id": 35467221, "question_id": 35467088, "link": "https://stackoverflow.com/questions/35467088/how-to-unzip-more-than-one-folder-in-a-directory-wild-card-not-working/35467221#35467221", "title": "How to unzip more than one folder in a directory - wild card not working", "body": "<p>The \"wildcard\" is actually a feature called <a href=\"https://en.wikipedia.org/wiki/Glob_%28programming%29\" rel=\"nofollow\"><em>glob pattern</em></a>. Ruby supports that trough <a href=\"http://ruby-doc.org/core-1.9.3/Dir.html#method-c-glob\" rel=\"nofollow\"><code>Dir.glob()</code></a>.</p>\n\n<p>It should be:</p>\n\n<pre><code>Dir.glob('my/directory/*.zip') { |filename|\n    Zip::File.open(filename) { |zip_file|\n        zip_file.each { |f|\n            f_path=File.join(\"fil_download\", f.name)\n            FileUtils.mkdir_p(File.dirname(f_path))\n            zip_file.extract(f, f_path) unless File.exist?(f_path)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4088858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44b3f197b3c7ac9a6a40288cdecd7cb?s=128&d=identicon&r=PG", "display_name": "guestburg", "link": "https://stackoverflow.com/users/4088858/guestburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455753780, "creation_date": 1455741021, "last_edit_date": 1455753780, "question_id": 35467088, "link": "https://stackoverflow.com/questions/35467088/how-to-unzip-more-than-one-folder-in-a-directory-wild-card-not-working", "title": "How to unzip more than one folder in a directory - wild card not working", "body": "<p>I'm working in Ruby/Watir\nI am downloading files from a website they come in .zip folder\nI want to unzip those folders but i dont know the name of the downloaded folder so i decided to use the wildcard which isnt working</p>\n\n<pre><code>Zip::File.open('my/directory/*.zip') { |zip_file|\n     zip_file.each { |f|\n     f_path=File.join(\"fil_download\", f.name)\n     FileUtils.mkdir_p(File.dirname(f_path))\n     zip_file.extract(f, f_path) unless File.exist?(f_path)\n   }\n  }\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "cucumber", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 680, "user_id": 3434387, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AF81I.jpg?s=128&g=1", "display_name": "Saikat", "link": "https://stackoverflow.com/users/3434387/saikat"}, "edited": false, "score": 0, "creation_date": 1455741128, "post_id": 35467038, "comment_id": 58629917, "body": "I don&#39;t want to use xpath. I forgot to mention. If its there any way i can use css instead your given xpath ???"}], "tags": [], "owner": {"reputation": 977, "user_id": 4603039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-2-hWqltglJY/AAAAAAAAAAI/AAAAAAAAA28/BWGljEnrSMc/photo.jpg?sz=128", "display_name": "Jacob Murphy", "link": "https://stackoverflow.com/users/4603039/jacob-murphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1455740842, "last_edit_date": 1495542801, "creation_date": 1455740842, "answer_id": 35467038, "question_id": 35466574, "link": "https://stackoverflow.com/questions/35466574/how-to-exclude-particular-class-atrribute-name-in-css-selector-in-selenium-autom/35467038#35467038", "title": "How to exclude particular class/atrribute name in CSS selector in Selenium Automation?", "body": "<p>Have you tried using an xpath to locate the element? Perhaps something like: <code>//a[contains(@title, 'Design') and not(contains(@class, 'reMode_selected'))]</code></p>\n\n<p>References/Examples:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1550981/how-to-use-not-in-xpath\">Using <code>not</code> in xpath</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/15837151/selecting-element-with-multiple-classes-in-capybara\">Using <code>and</code> in xpath</a></p>\n"}, {"comments": [{"owner": {"reputation": 680, "user_id": 3434387, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AF81I.jpg?s=128&g=1", "display_name": "Saikat", "link": "https://stackoverflow.com/users/3434387/saikat"}, "edited": false, "score": 0, "creation_date": 1455747307, "post_id": 35467333, "comment_id": 58633318, "body": "I didn&#39;t try that code yet. But i will let you know and accept the answer if that works. Thanks"}], "tags": [], "owner": {"reputation": 34075, "user_id": 5168011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb70c32e1e533e7c0cb2f9317a6b2aa3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy", "link": "https://stackoverflow.com/users/5168011/guy"}, "is_accepted": false, "score": 2, "last_activity_date": 1455741851, "creation_date": 1455741851, "answer_id": 35467333, "question_id": 35466574, "link": "https://stackoverflow.com/questions/35466574/how-to-exclude-particular-class-atrribute-name-in-css-selector-in-selenium-autom/35467333#35467333", "title": "How to exclude particular class/atrribute name in CSS selector in Selenium Automation?", "body": "<p>You can do this with <code>cssSelector</code></p>\n\n<pre><code>driver.find_element(:css,\".reMode_design:not(.reMode_selected)\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 5757444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2Bcp7g6300s/AAAAAAAAAAI/AAAAAAAAAAA/eoxRSqyUnQI/photo.jpg?sz=128", "display_name": "Bhumi Panchal", "link": "https://stackoverflow.com/users/5757444/bhumi-panchal"}, "is_accepted": false, "score": 1, "last_activity_date": 1455781065, "creation_date": 1455781065, "answer_id": 35475479, "question_id": 35466574, "link": "https://stackoverflow.com/questions/35466574/how-to-exclude-particular-class-atrribute-name-in-css-selector-in-selenium-autom/35475479#35475479", "title": "How to exclude particular class/atrribute name in CSS selector in Selenium Automation?", "body": "<p>You can do with this css locator    <code>a[title='Design']:not([class*='reMode_selected'])</code></p>\n"}, {"tags": [], "owner": {"reputation": 373, "user_id": 6800247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3060495c5d90b4295387d6df3b959966?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Hill", "link": "https://stackoverflow.com/users/6800247/luke-hill"}, "is_accepted": false, "score": 0, "last_activity_date": 1550840468, "creation_date": 1550840468, "answer_id": 54827769, "question_id": 35466574, "link": "https://stackoverflow.com/questions/35466574/how-to-exclude-particular-class-atrribute-name-in-css-selector-in-selenium-autom/54827769#54827769", "title": "How to exclude particular class/atrribute name in CSS selector in Selenium Automation?", "body": "<p>You can use the <code>not:</code> css prefix as others have mentioned or you could combine a capybara query to return the element based off it's text, or use a waiter.</p>\n\n<p>SitePrism is quite advanced, so pretty much all options are open to you</p>\n"}], "owner": {"reputation": 680, "user_id": 3434387, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/AF81I.jpg?s=128&g=1", "display_name": "Saikat", "link": "https://stackoverflow.com/users/3434387/saikat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2413, "favorite_count": 2, "answer_count": 4, "score": 2, "last_activity_date": 1572509966, "creation_date": 1455739283, "last_edit_date": 1572509966, "question_id": 35466574, "link": "https://stackoverflow.com/questions/35466574/how-to-exclude-particular-class-atrribute-name-in-css-selector-in-selenium-autom", "title": "How to exclude particular class/atrribute name in CSS selector in Selenium Automation?", "body": "<p>I have below HTML sample code:</p>\n\n<pre><code>&lt;a href=\"\" title=\"Design\" class=\"reMode_design  reMode_hover\"&gt;\n    &lt;span&gt;Design&lt;/span&gt;\n&lt;/a&gt;\n\n&lt;a href=\"\" title=\"Design\" \n class=\"reMode_design  reMode_hover reMode_selected\"&gt;\n    &lt;span&gt;Design&lt;/span&gt;\n&lt;/a&gt;\n</code></pre>\n\n<p>Here, i need to define CSS for the 1st href element and want to ignore 2nd element which has this class \"reMode_selected\". How to define css for the 1st element by ignoring 2nd element???</p>\n\n<p>I don't want to use Xpath and I am looking for like this below CSS selector:</p>\n\n<pre><code>element :fld_link, \"[title='Design'] [class !='reMode_selected']\"\n</code></pre>\n\n<p>This format doesn't work in SitePrism Cucumber.  Need Help on how to exclude a attribute name in CSS selector...</p>\n"}, {"tags": ["ruby", "http", "cookies", "http-headers", "session-cookies"], "comments": [{"owner": {"reputation": 694, "user_id": 478747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24de36bff6fc70b30f22dc8aa0c19cb?s=128&d=identicon&r=PG", "display_name": "instinctious", "link": "https://stackoverflow.com/users/478747/instinctious"}, "edited": false, "score": 0, "creation_date": 1455811104, "post_id": 35466561, "comment_id": 58665937, "body": "It is really hard to say without offering the web page in question - it could be their fault. Have you tried implementing this with <b>mechanize</b> gem?"}, {"owner": {"reputation": 397, "user_id": 5942350, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/441bdfead4798589a2b34c78386b2533?s=128&d=identicon&r=PG&f=1", "display_name": "ZEWEI CHU", "link": "https://stackoverflow.com/users/5942350/zewei-chu"}, "reply_to_user": {"reputation": 694, "user_id": 478747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24de36bff6fc70b30f22dc8aa0c19cb?s=128&d=identicon&r=PG", "display_name": "instinctious", "link": "https://stackoverflow.com/users/478747/instinctious"}, "edited": false, "score": 0, "creation_date": 1455904035, "post_id": 35466561, "comment_id": 58713961, "body": "@instinctious Thanks for pointing out this tool. I will try that."}], "owner": {"reputation": 397, "user_id": 5942350, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/441bdfead4798589a2b34c78386b2533?s=128&d=identicon&r=PG&f=1", "display_name": "ZEWEI CHU", "link": "https://stackoverflow.com/users/5942350/zewei-chu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455741121, "creation_date": 1455739250, "last_edit_date": 1455741121, "question_id": 35466561, "link": "https://stackoverflow.com/questions/35466561/send-http-requests-in-ruby-and-stay-logged-in", "title": "Send http requests in Ruby and stay logged in?", "body": "<p>I am trying to crawl websites with ruby. The way I am implementing it is that I send request for a page, and get all the links(href tags) in the page, and then generate another GET request. The problem is that I want to stay logged in during the whole process. I wrote some code as followed. </p>\n\n<pre><code>def start_crawling\n    uri = URI(@host + \"/login\")\n    @visited.push @host + \"/login\"\n    req = Net::HTTP::Post.new(uri)\n    req.set_form_data({\n      'email' =&gt; 'test', \n      'password' =&gt; 'test'\n    })\n    Net::HTTP.start(uri.hostname, uri.port) do |http|\n      res = http.request req\n      puts uri\n      puts res.code\n      content = res.body\n      puts content\n      puts res.response\n      cookie = res.response['Set-Cookie'] # this gives nothing\n      puts cookie\n      puts res[\"Set-Cookie\"] # prints nothing here\n      hrefs = get_href_tag_array_from_html(content)\n      send_get_requests(hrefs, cookie)\n    end\n  end\n\n  def send_get_requests(hrefs, cookie)\n    while not hrefs.empty? \n      href = hrefs.pop\n      href = @host + href if not href.start_with?\"http\"\n      next if @visited.include?(href)\n      puts \"href: \" + href\n      uri = URI(href)\n\n      Net::HTTP.start(uri.host, uri.port) do |http|\n        req = Net::HTTP::Get.new uri\n        res = http.request req\n        puts \"------------------href: #{href}---------------------------\"\n        puts res.code\n        puts res.message\n        puts res.class.name\n        puts \"Cookie: \"\n        puts res['Set-Cookie'] # this works and prints cookies\n        puts res.body \n        puts \"------------------end of: #{href}---------------------------\"\n        new_hrefs = get_href_tag_array_from_html(res.body)\n        hrefs += new_hrefs\n      end\n      @visited.push href \n    end\n  end\n</code></pre>\n\n<p>I want to start crawling from the login page. Ideally I want to stay logged in during the whole crawling procedure. I don't know much about session/cookie stuff, but I guess if I can get the cookie from the previous response and send it with the next request, I should be able to stay logged in. However, I cannot get any cookie from the login response. The response body is a 302 redirection, as I would expect. I checked it on the browser and the 302 response header does contain a cookie field, and this cookie is used for the next get request to redirect to the home page, but I cannot get the cookie field. </p>\n\n<p>When I send GET request and get the response, I can get the cookie field out of it, but when I send POST request for the login page, I cannot get any cookie. Is there any fundamental difference between GET and POST requests in such cases? </p>\n\n<p>Any idea how can I get this cookie field? Or do I have some basic misunderstanding in solving this crawling problem? Thanks. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "migration", "database-migration"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455739375, "post_id": 35466451, "comment_id": 58628849, "body": "how to set up the migration you&#39;re asking?"}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455739458, "post_id": 35466451, "comment_id": 58628895, "body": "Yes, I am unable to set it up ...."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455739550, "post_id": 35466451, "comment_id": 58628956, "body": "you already have these tables <code>posts</code> and <code>users</code>?"}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455739740, "post_id": 35466451, "comment_id": 58629083, "body": "yes the tables and users posts are already present"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455739945, "post_id": 35466451, "comment_id": 58629212, "body": "consider <code>has_many through</code>. <code>create_table :game_users, id: false do |t|   t.references :post_id, null: false, index: true   t.references :user_id, null: false, index: true end</code>"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455748528, "post_id": 35468585, "comment_id": 58633848, "body": "thank you very much but I have a problem when I create a new &quot;subscription&quot;, the post ID is not save perhaps that the problem come from:    <code>def subscription_params                params.require(:subscription).permit(:user_id, :post_id)              end</code>"}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "reply_to_user": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455749108, "post_id": 35468585, "comment_id": 58634082, "body": "That sounds like a separate question. I think you&#39;d most likely not want to manipulate subscriptions directly, but use things like <code>@post.followers &lt;&lt; current_user</code> in an action on the <i>posts</i> controller."}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455752559, "post_id": 35468585, "comment_id": 58635526, "body": "<code>@post.followers &lt;&lt; current_user</code> generate error: <code>NameError: uninitialized constant Post::Follower</code>.    When i create a subscription i have this error: <code>Unpermitted parameter: post_id </code>I checked several times the settings are correct though!"}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "reply_to_user": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455757302, "post_id": 35468585, "comment_id": 58637071, "body": "Hmm. You&#39;ve got <code>source: :user</code> or <code>class_name: &#39;User&#39;</code> in <code>Post.has_many :followers</code>?"}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455777000, "post_id": 35468585, "comment_id": 58643360, "body": "I have <code>source: :user</code> in Post model"}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455781399, "post_id": 35468585, "comment_id": 58645383, "body": "I have succesfully fix error: <code>Unpermitted parameter: post_id</code> but have always the error: <code>NameError: uninitialized constant Post::Follower</code>. I can use <code>@post.subscriptions</code> its work !"}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "reply_to_user": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455827820, "post_id": 35468585, "comment_id": 58676508, "body": "Does it work if you put <code>class_name: &#39;User&#39;</code> back in?"}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455829676, "post_id": 35468585, "comment_id": 58677482, "body": "When i use class_name: &quot;User&quot; i have this error: <code>ActiveRecord::HasManyThroughSourceAssociationNotFoundError: Could not find the source association(s) &quot;follower&quot; or :followers in model Subscription. Try &#39;has_many :followers, :through =&gt; :subscriptions, :source =&gt; &lt;name&gt;&#39;. Is it one of user or post?</code> I need to put class_name and the source? (The two together?)"}, {"owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "reply_to_user": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 1, "creation_date": 1455829684, "post_id": 35468585, "comment_id": 58677488, "body": "Yeah, I guess it&#39;s both."}, {"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1455830032, "post_id": 35468585, "comment_id": 58677660, "body": "Thank you very much, this kind of relationship is quite complex to do, but thank you very much for your help"}], "tags": [], "owner": {"reputation": 2558, "user_id": 1157242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9d4b10e0b35be38592bed9e4e5457e3?s=128&d=identicon&r=PG", "display_name": "PJSCopeland", "link": "https://stackoverflow.com/users/1157242/pjscopeland"}, "is_accepted": true, "score": 1, "last_activity_date": 1455829731, "last_edit_date": 1455829731, "creation_date": 1455746144, "answer_id": 35468585, "question_id": 35466451, "link": "https://stackoverflow.com/questions/35466451/migration-has-one-and-has-many/35468585#35468585", "title": "Migration has_one and has_many", "body": "<p><code>Post</code> should <strong><code>belong_to</code></strong><code>:owner</code>, because the <code>posts</code> table has the foreign key. Also, its <code>#users</code> is a bit too ambiguously named, as is <code>User#posts</code>.</p>\n\n<p>Here are your models:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  belongs_to :owner, class_name: 'User', inverse_of: :owned_posts # foreign_key: :owner_id will be inferred\n  has_many :subscriptions\n  has_many :followers, through: :subscriptions, source: :user, class_name: 'User', inverse_of: :followed_posts\nend\n\nclass Subscription &lt; ActiveRecord::Base\n  belongs_to :post\n  belongs_to :user\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :owned_posts, class_name: 'Post', inverse_of: :owner\n  has_many :subscriptions\n  has_many :followed_posts, through: :subscriptions, source: :post, class_name: 'Post', inverse_of: :followers\nend\n</code></pre>\n\n<p>And here are the migrations to support them:</p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      # ...\n    end\n  end\nend\n\nclass CreatePosts &lt; ActiveRecord::Migration\n  def change\n    create_table :posts do |t|\n      t.integer :owner_id\n      # ...\n    end\n  end\nend\n\nclass CreateSubscriptions &lt; ActiveRecord::Migration\n  def change\n    create_table :subscriptions do |t|\n      t.integer :post_id\n      t.integer :user_id\n    end\n  end\nend\n</code></pre>\n\n<p><strong>If it weren't for the 'ownership' relation,</strong> you could use a <code>has_and_belongs_to_many</code> relationship: </p>\n\n<ol>\n<li>rename the <code>subscriptions</code> migration to <code>posts_users</code> (must be plurals in alphabetical order),</li>\n<li>do away with its model entirely, and</li>\n<li>have <code>Post.has_and_belongs_to_many :users</code> and <code>User.has_and_belongs_to_many :posts</code>.</li>\n</ol>\n\n<p>In fact, you technically <em>could</em> do that, but having ambiguous names like that is bad practice.</p>\n"}], "owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 35468585, "answer_count": 1, "score": 0, "last_activity_date": 1455829731, "creation_date": 1455738879, "last_edit_date": 1455756891, "question_id": 35466451, "link": "https://stackoverflow.com/questions/35466451/migration-has-one-and-has-many", "title": "Migration has_one and has_many", "body": "<pre><code>class Post &lt; ActiveRecord::Base\n  has_one :owner, class_name: \"User\", foreign_key: \"owner_id\" #creator post\n  has_many :users #followers post\nend\n\nclass User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, :validatable\n\n has_many :posts \n end\n</code></pre>\n\n<p>What command line I need to perform to migrate to perform these different relationships between the User and Post tables?\n Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "parameters", "parameter-passing"], "comments": [{"owner": {"reputation": 1910, "user_id": 676788, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/16dfcfaa3f6405e9572cea3f88a68c56?s=128&d=identicon&r=PG", "display_name": "Nafaa Boutefer", "link": "https://stackoverflow.com/users/676788/nafaa-boutefer"}, "edited": false, "score": 0, "creation_date": 1455737840, "post_id": 35465775, "comment_id": 58627847, "body": "You do not need to create a new variable <code>@params</code>, because <code>params</code> is available in the views as well."}, {"owner": {"reputation": 3897, "user_id": 4490400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JuX7g.jpg?s=128&g=1", "display_name": "Atte Juvonen", "link": "https://stackoverflow.com/users/4490400/atte-juvonen"}, "reply_to_user": {"reputation": 1910, "user_id": 676788, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/16dfcfaa3f6405e9572cea3f88a68c56?s=128&d=identicon&r=PG", "display_name": "Nafaa Boutefer", "link": "https://stackoverflow.com/users/676788/nafaa-boutefer"}, "edited": false, "score": 0, "creation_date": 1455738519, "post_id": 35465775, "comment_id": 58628289, "body": "When I try to use params in the view, it returns nil."}], "answers": [{"comments": [{"owner": {"reputation": 1910, "user_id": 676788, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/16dfcfaa3f6405e9572cea3f88a68c56?s=128&d=identicon&r=PG", "display_name": "Nafaa Boutefer", "link": "https://stackoverflow.com/users/676788/nafaa-boutefer"}, "edited": false, "score": 0, "creation_date": 1455794774, "post_id": 35465872, "comment_id": 58653888, "body": "This should not happen, because <code>params</code> always contains <code>:controller</code> and <code>:action</code>, even if you do not pass any params. There should be an error somewhere. <code>params</code> is always a <code>Hash</code> and cannot be <code>nil</code>."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": true, "score": 2, "last_activity_date": 1455739110, "last_edit_date": 1455739110, "creation_date": 1455737130, "answer_id": 35465872, "question_id": 35465775, "link": "https://stackoverflow.com/questions/35465775/ruby-on-rails-variable-visibility/35465872#35465872", "title": "Ruby on Rails variable visibility", "body": "<p>You can use your controller instance variable <code>@params</code> in your <code>/places</code> views. But because you did not pass any params, <code>params</code> returns <code>nil</code>.\nSo, if this variables was out visibility, you would get <code>NameError</code>.\nTry to set <code>@params</code> directly like <code>@params = { foo: \"bar\" }</code> and you will see it.\nMore about params in Rails <a href=\"http://guides.rubyonrails.org/action_controller_overview.html\" rel=\"nofollow\">here</a> (#4 Parameters).</p>\n"}], "owner": {"reputation": 3897, "user_id": 4490400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JuX7g.jpg?s=128&g=1", "display_name": "Atte Juvonen", "link": "https://stackoverflow.com/users/4490400/atte-juvonen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 35465872, "answer_count": 1, "score": 0, "last_activity_date": 1455739110, "creation_date": 1455736816, "question_id": 35465775, "link": "https://stackoverflow.com/questions/35465775/ruby-on-rails-variable-visibility", "title": "Ruby on Rails variable visibility", "body": "<p>I have many controllers where I set variables so that the appropriate views gain visibility to these variables. For example,</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n...\ndef index\n  @users = User.all\nend\n...\n</code></pre>\n\n<p>This works. So how come this doesn't work:</p>\n\n<pre><code>class PlacesController &lt; ApplicationController\n...\ndef show\n  @params = params\nend\n...\n</code></pre>\n\n<p>If I byebug in the show-method, I can access params. If I byebug in the view (places/show.html.erb), then \"params\" and \"@params\" return nil.</p>\n\n<p>Does this have something to do with the fact that \"User\" is an ActiveRecord and \"Place\" is not? How can I make arbitrary data accessible to the view?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "angularjs", "api"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455740466, "post_id": 35466406, "comment_id": 58629534, "body": "(Part 1) Thank you for replaying! This helped, but now I&#39;m getting this in the console:   <i>&quot;XMLHttpRequest cannot load <a href=\"http://localhost:3000/api/v1/messages\" rel=\"nofollow noreferrer\">localhost:3000/api/v1/messages</a>. No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. Origin &#39;<a href=\"http://127.0.0.1:59076\" rel=\"nofollow noreferrer\">127.0.0.1:59076</a>&#39; is therefore not allowed access. The response had HTTP status code 500.&quot;</i>"}, {"owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455740481, "post_id": 35466406, "comment_id": 58629550, "body": "(Part 2) But I have this method in my Application Controller:  <i>before_filter :add_allow_credentials_headers     def add_allow_credentials_headers         response.headers[&#39;Access-Control-Allow-Origin&#39;] = request.headers[&#39;Origin&#39;] || &#39;*&#39;         response.headers[&#39;Access-Control-Allow-Credentials&#39;] = &#39;true&#39;     end</i>"}, {"owner": {"reputation": 994, "user_id": 4084391, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6mN6X.png?s=128&g=1", "display_name": "Daniel Batalla", "link": "https://stackoverflow.com/users/4084391/daniel-batalla"}, "reply_to_user": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "edited": false, "score": 0, "creation_date": 1455753394, "post_id": 35466406, "comment_id": 58635860, "body": "@GabrielAlejandro If you still getting that error, open it in a new question to get more attention!"}], "tags": [], "owner": {"reputation": 994, "user_id": 4084391, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6mN6X.png?s=128&g=1", "display_name": "Daniel Batalla", "link": "https://stackoverflow.com/users/4084391/daniel-batalla"}, "is_accepted": true, "score": 2, "last_activity_date": 1455738760, "creation_date": 1455738760, "answer_id": 35466406, "question_id": 35465761, "link": "https://stackoverflow.com/questions/35465761/angularjs-form-data-to-ruby-on-rails-api/35466406#35466406", "title": "AngularJS form data to Ruby on Rails API", "body": "<p>You must assign a key to your <code>message</code> object in <code>data</code> parameter, like this: </p>\n\n<pre><code>$http({\n  method  : 'POST',\n  url     : 'http://localhost:3000/api/v1/messages',\n  data    : { data: $scope.message },\n  headers : {'Content-Type': 'application/x-www-form-urlencoded'} \n })\n .sucess(function(data){ ... });\n</code></pre>\n\n<p>And then, in your controller:</p>\n\n<pre><code>def create \n  respond_with Message.create(params[:data])\nend\n</code></pre>\n\n<p>Hope this help :)</p>\n"}], "owner": {"reputation": 215, "user_id": 4938318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-b7eZ09DTtLI/AAAAAAAAAAI/AAAAAAAAAHM/DJ5NjzA0tIU/photo.jpg?sz=128", "display_name": "Gabriel Alejandro", "link": "https://stackoverflow.com/users/4938318/gabriel-alejandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 35466406, "answer_count": 1, "score": 1, "last_activity_date": 1455738760, "creation_date": 1455736761, "question_id": 35465761, "link": "https://stackoverflow.com/questions/35465761/angularjs-form-data-to-ruby-on-rails-api", "title": "AngularJS form data to Ruby on Rails API", "body": "<p>I created a simple API with Ruby on Rails,and I'm trying to send data from a form with AngularJS. The thing is that the App is sending the post method and the backend is creating the new records, so far it's working, but it creates it with Null values.</p>\n\n<p>This is the form:</p>\n\n<pre><code>&lt;div ng-controller=\"postController\"&gt;\n    &lt;form name=\"messageForm\" ng-submit=\"submitForm()\"&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Name&lt;/label&gt;\n            &lt;input type=\"text\" name=\"content\" class=\"form-control\" ng-model=\"message.content\"&gt;\n        &lt;/div&gt;\n        &lt;button type=\"submit\" class=\"btn btn-primary\"&gt;Submit&lt;/button&gt;\n    &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This is the Angular Controller:</p>\n\n<pre><code>app.controller('postController', function($scope, $http) {\n  // create a blank object to handle form data.\n    $scope.message = {};\n  // calling our submit function.\n    $scope.submitForm = function() {\n\n    $http({\n      method  : 'POST',\n      url     : 'http://localhost:3000/api/v1/messages',\n      data    : $scope.message, //forms user object\n      headers : {'Content-Type': 'application/x-www-form-urlencoded'} \n     })\n      .success(function(data) {\n        if (data.errors) {\n          // Showing errors.\n          $scope.errorContent = data.errors.errorContent;\n        } else {\n          $scope.message = data.message;\n        }\n      });\n    };\n});\n</code></pre>\n\n<p>And in the RoR's API Controller, this is the Create method:</p>\n\n<pre><code>def create \n    respond_with Message.create(params[:message])\nend\n</code></pre>\n\n<p>The only rows are:</p>\n\n<ul>\n<li>ID which is generated automatically.</li>\n<li>And 'content'</li>\n</ul>\n"}, {"tags": ["ruby", "command-line-arguments", "optparse"], "answers": [{"comments": [{"owner": {"reputation": 826, "user_id": 2819525, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/830e2fecdd962110e83555e0d2ee8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Benedikt Bock", "link": "https://stackoverflow.com/users/2819525/benedikt-bock"}, "edited": false, "score": 0, "creation_date": 1455815463, "post_id": 35465029, "comment_id": 58669253, "body": "I didn&#39;t find a solution for arguments like <code>-ssh</code>. Do you have an example?"}, {"owner": {"reputation": 344, "user_id": 1306709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e85eb7621b90a4ef6bde85446094c8?s=128&d=identicon&r=PG", "display_name": "Borys Pylhun", "link": "https://stackoverflow.com/users/1306709/borys-pylhun"}, "reply_to_user": {"reputation": 826, "user_id": 2819525, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/830e2fecdd962110e83555e0d2ee8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Benedikt Bock", "link": "https://stackoverflow.com/users/2819525/benedikt-bock"}, "edited": false, "score": 1, "creation_date": 1455817544, "post_id": 35465029, "comment_id": 58670520, "body": "@BenediktBock hmm, looks like I misunderstood your needs initially, sorry. It looks like <code>commander</code> doesn&#39;t support such kind of arguments. Check this gems collection also <a href=\"https://www.ruby-toolbox.com/categories/CLI_Option_Parsers\" rel=\"nofollow noreferrer\">ruby-toolbox.com/categories/CLI_Option_Parsers</a>, not sure but might be you&#39;ll find something useful there."}], "tags": [], "owner": {"reputation": 344, "user_id": 1306709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e85eb7621b90a4ef6bde85446094c8?s=128&d=identicon&r=PG", "display_name": "Borys Pylhun", "link": "https://stackoverflow.com/users/1306709/borys-pylhun"}, "is_accepted": false, "score": 0, "last_activity_date": 1455734569, "creation_date": 1455734569, "answer_id": 35465029, "question_id": 35464818, "link": "https://stackoverflow.com/questions/35464818/multicharacter-command-line-arguments-with-a-ruby-script/35465029#35465029", "title": "Multicharacter command-line arguments with a ruby script", "body": "<p>Try <a href=\"https://github.com/commander-rb/commander\" rel=\"nofollow\">commander gem</a>\nIt supports both - short and (or) long versions of parameters and is very flexible and well documented.</p>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 2959663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c62012c04ba1ee0f67c4da0e9da303a?s=128&d=identicon&r=PG&f=1", "display_name": "johnrbnz", "link": "https://stackoverflow.com/users/2959663/johnrbnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1455735401, "creation_date": 1455735401, "answer_id": 35465309, "question_id": 35464818, "link": "https://stackoverflow.com/questions/35464818/multicharacter-command-line-arguments-with-a-ruby-script/35465309#35465309", "title": "Multicharacter command-line arguments with a ruby script", "body": "<p>A simple/pragmatic approach: if you are unhappy with the implementation of the OptionParser, I recommend you write your own parser using <a href=\"http://ruby-doc.org/core-2.2.0/Object.html#ARGV\" rel=\"nofollow\"><code>ARGV</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 826, "user_id": 2819525, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/830e2fecdd962110e83555e0d2ee8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Benedikt Bock", "link": "https://stackoverflow.com/users/2819525/benedikt-bock"}, "is_accepted": true, "score": 0, "last_activity_date": 1459019344, "last_edit_date": 1495535312, "creation_date": 1459019344, "answer_id": 36239651, "question_id": 35464818, "link": "https://stackoverflow.com/questions/35464818/multicharacter-command-line-arguments-with-a-ruby-script/36239651#36239651", "title": "Multicharacter command-line arguments with a ruby script", "body": "<p><a href=\"http://github.com/leejarvis/slop\" rel=\"nofollow noreferrer\" title=\"Slop\">Slop</a> will work for me. Thanks to <a href=\"https://stackoverflow.com/users/1306709/boris-pilgun\">Boris Pilgun</a></p>\n"}], "owner": {"reputation": 826, "user_id": 2819525, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/830e2fecdd962110e83555e0d2ee8ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Benedikt Bock", "link": "https://stackoverflow.com/users/2819525/benedikt-bock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 36239651, "answer_count": 3, "score": 0, "last_activity_date": 1459019344, "creation_date": 1455733795, "question_id": 35464818, "link": "https://stackoverflow.com/questions/35464818/multicharacter-command-line-arguments-with-a-ruby-script", "title": "Multicharacter command-line arguments with a ruby script", "body": "<p>Normally I would use <a href=\"http://docs.ruby-lang.org/en/2.1.0/OptionParser.html\" rel=\"nofollow\">optparse</a> to parse command-line arguments. In this case I need arguments like <code>-ssh</code> or <code>-telnet</code> (basically I need the arguments from <a href=\"http://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter3.html#using-cmdline\" rel=\"nofollow\">PuTTY</a>). Optparse only supports single letter flags with a long version (e.g. <code>-s</code> and <code>--ssh</code>).</p>\n\n<p>Is there another class like optparse?</p>\n"}, {"tags": ["ruby", "testing"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4471249, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/06f6917eb487f073a0ef25fa2b64206b?s=128&d=identicon&r=PG&f=1", "display_name": "JCD", "link": "https://stackoverflow.com/users/4471249/jcd"}, "edited": false, "score": 0, "creation_date": 1455734635, "post_id": 35464834, "comment_id": 58625800, "body": "Awesome thank you very much, this worked like a charm."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1455734814, "post_id": 35464834, "comment_id": 58625919, "body": "There is nothing wrong about this post, but it should be a comment to the question rather than an answer."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1455735023, "post_id": 35464834, "comment_id": 58626043, "body": "Why? Question was <code>The output is nil, not &#39;errychay&#39; which is what I want</code>. I answered on question, and gave link for more details about boolean operators."}, {"owner": {"reputation": 69, "user_id": 4471249, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/06f6917eb487f073a0ef25fa2b64206b?s=128&d=identicon&r=PG&f=1", "display_name": "JCD", "link": "https://stackoverflow.com/users/4471249/jcd"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1455766742, "post_id": 35464834, "comment_id": 58639782, "body": "@sawa it answered my question and got my code to behave the way I intended"}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": true, "score": 0, "last_activity_date": 1455735676, "last_edit_date": 1455735676, "creation_date": 1455733866, "answer_id": 35464834, "question_id": 35464605, "link": "https://stackoverflow.com/questions/35464605/third-elsif-statement-generates-nil-and-not-desired-output/35464834#35464834", "title": "Third elsif statement generates nil and not desired output", "body": "<p>It seems like you should use <code>or</code> instead of <code>and</code>. More about boolean operators in Ruby you can look <a href=\"https://rubymonk.com/learning/books/1-ruby-primer/chapters/8-control-structures/lessons/43-boolean-expressions-in-ruby\" rel=\"nofollow\">here</a>. Also, i advise you to do some refactoring:</p>\n\n<pre><code>def translate(arg)\n  vowel = [\"a\", \"e\", \"i\", \"o\", \"u\"]\n  vowel_word = \"ay\"\n  consonant = [\"z\", \"b\", \"t\", \"g\", \"h\"]\n  consonant_word = \"ay\"\n\n  if vowel.include?(arg[0])\n    arg + vowel_word\n  elsif consonant.include?(arg[0])\n    foo = arg[1,6]\n    foo + arg[0] + consonant_word\n  elsif consonant.include?(arg[0]) || consonant.include?(arg[1])\n    foo = arg[2, 5]\n    foo + arg[0] + arg[1] + consonant_word\n  end\nend\n</code></pre>\n\n<p>Note, that <code>include?</code> method returns <code>true</code> of <code>false</code>, so you may omit <code>== true</code>. Also, Ruby automatically returns last string of <code>if..else</code> statement, so you can omit it too.  </p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1455734360, "creation_date": 1455734360, "answer_id": 35464973, "question_id": 35464605, "link": "https://stackoverflow.com/questions/35464605/third-elsif-statement-generates-nil-and-not-desired-output/35464973#35464973", "title": "Third elsif statement generates nil and not desired output", "body": "<p>It is because your</p>\n\n<pre><code>consonant = [\"z\", \"b\", \"t\", \"g\", \"h\"]\n</code></pre>\n\n<p>is not a full consonant list, particularly it does not include the <code>arg[0]</code> of <code>\"cherry\"</code>, which is <code>\"c\"</code>. So <code>\"cherry\"</code> satisfies neither <code>vowel.include?(arg[0])</code> nor <code>consonant.include?(arg[0])</code>, nor any of the three <code>if</code>/<code>elsif</code> conditions, and the condition block returns <code>nil</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 4471249, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/06f6917eb487f073a0ef25fa2b64206b?s=128&d=identicon&r=PG&f=1", "display_name": "JCD", "link": "https://stackoverflow.com/users/4471249/jcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 35464834, "answer_count": 2, "score": 0, "last_activity_date": 1455821457, "creation_date": 1455733160, "last_edit_date": 1455821457, "question_id": 35464605, "link": "https://stackoverflow.com/questions/35464605/third-elsif-statement-generates-nil-and-not-desired-output", "title": "Third elsif statement generates nil and not desired output", "body": "<p>Performing a BDD tutorial and the test requires that a word that has two consonants at the beginning of a word be translated into pig latin. It is the the second elsif statement is where I am having trouble. The code is as follows:</p>\n\n<pre><code>def translate(arg)\n\n    vowel = [\"a\", \"e\", \"i\", \"o\", \"u\"]\n    vowel_word = \"ay\"\n\n    consonant = [\"z\", \"b\", \"t\", \"g\", \"h\"]\n    consonant_word = \"ay\"\n\n    if vowel.include?(arg[0]) == true\n        return arg + vowel_word\n    elsif consonant.include?(arg[0]) == true\n        foo = arg[1,6]\n        return foo + arg[0] + consonant_word\n    elsif (consonant.include?(arg[0]) == true) and (consonant.include?(arg[1]) == true)\n        foo = arg[2, 5]\n        return foo + arg[0] + arg[1] + consonant_word\n    end\nend\n\ntranslate(\"apple\")\ntranslate(\"banana\")\ntranslate(\"cherry\")\n</code></pre>\n\n<p>My problem is with the third condition. The output is nil, not 'errychay' which is what I want. Any help will be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller"], "answers": [{"tags": [], "owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "is_accepted": true, "score": 1, "last_activity_date": 1455733475, "creation_date": 1455733475, "answer_id": 35464710, "question_id": 35464229, "link": "https://stackoverflow.com/questions/35464229/how-can-i-create-a-record-from-different-controllers-in-rails/35464710#35464710", "title": "How can I create a record from different controllers in Rails?", "body": "<p>You do not want to create controller action that calls another controller action. This is possible, but will give you a lot of problems (as both will try to render). The only really acceptable way to jump from one controller action to another is via <code>redirect_to</code>, and that is not going to solve the problems you described.</p>\n\n<p>In an MVC framework (such as rails), what you're going to want to do is move the reused parts of the <code>token#create</code> action into the token <em>model</em>, and then reference this from <code>token#create</code>, <code>registrations#post</code>, <code>confirmations#post</code>, and <code>passwords#post</code>. This could be a method like <code>Token.define_token( my_params )</code>, or simply the existing <code>Token.create()</code> method.</p>\n\n<p>Model behaviour such as what you described belongs in the Model. The Controller should simply be calling this, as the Controller's purpose is generally to set up the View.</p>\n\n<p><strong>References:</strong></p>\n\n<ul>\n<li><a href=\"http://www.toptal.com/ruby-on-rails/top-10-mistakes-that-rails-programmers-make\" rel=\"nofollow\">Common Mistake #1</a></li>\n<li><a href=\"http://www.sitepoint.com/10-ruby-on-rails-best-practices/\" rel=\"nofollow\">Fat Model, Skinny Controller</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 4192176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LphmA.jpg?s=128&g=1", "display_name": "uoroaix", "link": "https://stackoverflow.com/users/4192176/uoroaix"}, "is_accepted": false, "score": 0, "last_activity_date": 1455734455, "creation_date": 1455734455, "answer_id": 35465002, "question_id": 35464229, "link": "https://stackoverflow.com/questions/35464229/how-can-i-create-a-record-from-different-controllers-in-rails/35465002#35465002", "title": "How can I create a record from different controllers in Rails?", "body": "<p>Passing the category to the Token's controller is unnecessary. Just like ConnorCMcKee said, controller calling another controller method is going to make your life miserably and not how it should be done in a MVC framework. You should just create the token right in your user's controller like the example you wrote yourself.</p>\n\n<pre><code>def create\n   @user = User.new(create_user_params)\n\n   if @user.save\n    @user.tokens.create(category: \"confirmation\")\n    render json: @user, status: :created\n   else\n    render json: { errors: @user.errors }, status: :unprocessable_entity\n   end\nend\n</code></pre>\n\n<p>And if you want to deliver it later you can use a background job gem to do that for you.</p>\n"}], "owner": {"reputation": 153, "user_id": 2516601, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e96a46b750c3c242b76832777188802f?s=128&d=identicon&r=PG", "display_name": "Alex N.", "link": "https://stackoverflow.com/users/2516601/alex-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 2, "accepted_answer_id": 35464710, "answer_count": 2, "score": 1, "last_activity_date": 1455734834, "creation_date": 1455731885, "last_edit_date": 1455734834, "question_id": 35464229, "link": "https://stackoverflow.com/questions/35464229/how-can-i-create-a-record-from-different-controllers-in-rails", "title": "How can I create a record from different controllers in Rails?", "body": "<p><strong>The Problem:</strong></p>\n\n<p>I have a Token model that can have a category (authentication, refresh, confirmation, reset_password). I need to be able to create tokens from the following controller actions:</p>\n\n<ol>\n<li><p>registrations#post - When the user signs up, I need to create a confirmation token to be used in the welcome email. For Example:</p>\n\n<pre><code># POST /users =&gt; registrations#create\ndef create\n    @user = User.new(create_user_params)\n\n    if @user.save\n        # create confirmation token here. something like Token.create(category: \"confirmation\")\n        Api::V1::UserMailer.signup_confirmation(@user.id).deliver_later\n        render json: @user, status: :created\n    else\n        render json: { errors: @user.errors }, status: :unprocessable_entity\n    end\nend\n</code></pre></li>\n<li><p>confirmations#post - When the user requests authorization to access an API, I need to create an authentication token / refresh token pair.</p></li>\n<li>passwords#post - When the user requests a forgot password email, I need to create a reset_password token.</li>\n</ol>\n\n<p><strong>A few additional notes:</strong></p>\n\n<ul>\n<li>There is some custom logic to be done depending on the category.</li>\n<li>The relationship between User and Token is has_many. </li>\n</ul>\n\n<p><strong>The Question:</strong></p>\n\n<p>Is there a way I could pass the category to the Token controller's create action from one of these other controllers?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "rspec"], "comments": [{"owner": {"reputation": 206, "user_id": 3227183, "user_type": "registered", "profile_image": "https://graph.facebook.com/695426280/picture?type=large", "display_name": "lienvdsteen", "link": "https://stackoverflow.com/users/3227183/lienvdsteen"}, "edited": false, "score": 0, "creation_date": 1455732825, "post_id": 35464190, "comment_id": 58624757, "body": "Can you try this: <code>post &#39;&#47;routes&#39;, params.to_json, { &#39;Accept&#39; =&gt; Mime::JSON, &#39;Content-Type&#39; =&gt; Mime::JSON.to_s }</code>"}, {"owner": {"reputation": 1667, "user_id": 2244502, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/QZIaP.jpg?s=128&g=1", "display_name": "tvieira", "link": "https://stackoverflow.com/users/2244502/tvieira"}, "reply_to_user": {"reputation": 206, "user_id": 3227183, "user_type": "registered", "profile_image": "https://graph.facebook.com/695426280/picture?type=large", "display_name": "lienvdsteen", "link": "https://stackoverflow.com/users/3227183/lienvdsteen"}, "edited": false, "score": 0, "creation_date": 1455734334, "post_id": 35464190, "comment_id": 58625610, "body": "I still get the same error"}], "answers": [{"comments": [{"owner": {"reputation": 1667, "user_id": 2244502, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/QZIaP.jpg?s=128&g=1", "display_name": "tvieira", "link": "https://stackoverflow.com/users/2244502/tvieira"}, "edited": false, "score": 0, "creation_date": 1455797308, "post_id": 35464715, "comment_id": 58655520, "body": "You make a good point, it was legacy code, so... you know lol"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1455733497, "creation_date": 1455733497, "answer_id": 35464715, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json/35464715#35464715", "title": "RSpec not sending a Post request in JSON", "body": "<p>I'm curious why you are doing <code>json_params = ActionController::Parameters.new( JSON.parse(request.body.read)</code>? (Am I missing something?) </p>\n\n<p>params should already come in as ActionContoller::Parameters. So, route_params should be</p>\n\n<pre><code>def route_params\n  params.require(:route).permit(\n    :start_lat, \n    :start_long, \n    :end_lat, \n    :end_long,\n    :flag_opt\n   )\nend\n</code></pre>\n\n<p>By the way, I assume your routes.rb is something like</p>\n\n<pre><code># config/routes.rb\nRails.application.routes.draw do     \n  namespace :api, defaults: {format: 'json'} do\n    ...\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2286, "user_id": 2162222, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/99fc4772c37472ae3fa83b046c772ba4?s=128&d=identicon&r=PG", "display_name": "monteirobrena", "link": "https://stackoverflow.com/users/2162222/monteirobrena"}, "is_accepted": false, "score": 0, "last_activity_date": 1455734945, "creation_date": 1455734945, "answer_id": 35465157, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json/35465157#35465157", "title": "RSpec not sending a Post request in JSON", "body": "<p>You need set the JSON parse to your test environment.</p>\n\n<p>Create a file in spec/support/request_helper.rb:</p>\n\n<pre><code>module Requests\n  module JsonHelpers\n    def json\n      @json ||= JSON.parse(response.body)\n    end\n  end\nend\n\nRSpec.configure do |config|\n  config.include Requests::JsonHelpers, type: :controller\nend\n</code></pre>\n\n<p>And </p>\n"}, {"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1455806133, "post_id": 35470236, "comment_id": 58662055, "body": "As a side comment, instead of <code>count =</code> and <code>expect... to eq (count + 1)</code>, how about <code>expect{post :create, params}.to change{Route.count}.by(1)</code>? Also, I&#39;m of that camp that says only one <code>expect</code> per test - so it&#39;s clearer what&#39;s failing when something fails."}, {"owner": {"reputation": 642, "user_id": 4745520, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10200391026893649/picture?type=large", "display_name": "Jeff", "link": "https://stackoverflow.com/users/4745520/jeff"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1455811750, "post_id": 35470236, "comment_id": 58666456, "body": "@jvillian yeah that is an improvement and I didn&#39;t think of that. It is kind of standard to just keep that <code>http_status</code> expectation because if the request wasnt successful, then the <code>Route.count</code> wouldn&#39;t have changed. I do get the point that if it did change, then the request &quot;must&quot; have been successful so maybe it was kind of redundant."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1455812186, "post_id": 35470236, "comment_id": 58666825, "body": "I&#39;m working on an API system where the http status code is meaningful. So, we definitely test for it. But, just in another block. Thanks for the feedback!"}], "tags": [], "owner": {"reputation": 642, "user_id": 4745520, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10200391026893649/picture?type=large", "display_name": "Jeff", "link": "https://stackoverflow.com/users/4745520/jeff"}, "is_accepted": false, "score": 0, "last_activity_date": 1455753716, "creation_date": 1455753716, "answer_id": 35470236, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json/35470236#35470236", "title": "RSpec not sending a Post request in JSON", "body": "<p>I'm not sure why your API has to receive json in it's create action. Here's what I would do:</p>\n\n<pre><code>class RoutesControllerTest &lt; ActionController::TestCase\n\n  describe \"User with token\"\n    test \"should post route\" do  \n      params = { route: {  start_lat: 38.7627951, start_long: -9.1532211,\n                            end_lat: 38.7483783, end_long: -9.155045,\n                            flag_opt: 0.4, city: 1 }\n                }\n\n      count = Route.all.size\n\n      post :create, params\n      expect(response).to have_http_status(201)\n      expect(Route.all.size).to eq(count + 1) # actually created something\n    end\n  end\nend\n</code></pre>\n\n<p>And then in your strong params:</p>\n\n<pre><code>def route_params\n  params.require(:route).permit(\n      :start_lat, \n      :start_long, \n      :end_lat, \n      :end_long,\n      :flag_opt\n   )\nend\n</code></pre>\n\n<p>No need to process everything as JSON even on the rails end.</p>\n"}, {"comments": [{"owner": {"reputation": 727, "user_id": 616987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d9a5a6cadc7954e2e93e512ba35efd8c?s=128&d=identicon&r=PG", "display_name": "Pathogen", "link": "https://stackoverflow.com/users/616987/pathogen"}, "edited": false, "score": 0, "creation_date": 1551473739, "post_id": 52107595, "comment_id": 96666997, "body": "<code>as: :json</code> is indeed just what&#39;s necessary to have Rspec serialize your request, rather than creating the usual Rails formatted post body for you."}, {"owner": {"reputation": 1127, "user_id": 399940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fbb830df79b0280d8d45826c202d5f?s=128&d=identicon&r=PG", "display_name": "emptywalls", "link": "https://stackoverflow.com/users/399940/emptywalls"}, "edited": false, "score": 0, "creation_date": 1552085056, "post_id": 52107595, "comment_id": 96891732, "body": "This caught me by surprise as well. Doing request.raw_post inside the spec while writing API documentation is what led me here. Thanks, this works!"}], "tags": [], "owner": {"reputation": 131, "user_id": 1462631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e7d2b41f3e4b5bf801a53096edf69?s=128&d=identicon&r=PG", "display_name": "nicb", "link": "https://stackoverflow.com/users/1462631/nicb"}, "is_accepted": false, "score": 3, "last_activity_date": 1535681644, "creation_date": 1535681644, "answer_id": 52107595, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json/52107595#52107595", "title": "RSpec not sending a Post request in JSON", "body": "<p>I've been struggling with this one too. Sometimes you really just want to test with a real JSON body. I'm not sure if this solution is specific to Rails 5, but after a lot of hunting I was relieved to finally figure this one out.</p>\n\n<p>You can use <code>as: :json</code> instead of <code>format: :json</code> to make RSpec format the request body.</p>\n\n<p>That is, change:   </p>\n\n<pre><code>post '/routes.json' , params.to_json, format: :json\n</code></pre>\n\n<p>to </p>\n\n<pre><code>post '/routes.json' , params.to_json, as: :json\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1035, "user_id": 5891503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/830569e0fa440b692ab80005ef9b00cb?s=128&d=identicon&r=PG", "display_name": "reiallenramos", "link": "https://stackoverflow.com/users/5891503/reiallenramos"}, "is_accepted": false, "score": 0, "last_activity_date": 1535708278, "creation_date": 1535708278, "answer_id": 52112580, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json/52112580#52112580", "title": "RSpec not sending a Post request in JSON", "body": "<p>for Rails 5, just call <code>request.accept = \"application/json\"</code> before the HTTP verb. Example:</p>\n\n<pre><code>context \"GET #show\" do\n  it \"returns json data\" do\n    request.accept = \"application/json\"\n    get :show\n    hash_body = JSON.parse(response.body)\n    #### your expectation here\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 458, "user_id": 873741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26d2b34e0dfd4be1d397363f820b811b?s=128&d=identicon&r=PG", "display_name": "nitrnitr", "link": "https://stackoverflow.com/users/873741/nitrnitr"}, "is_accepted": false, "score": 3, "last_activity_date": 1553615310, "creation_date": 1553615310, "answer_id": 55361244, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json/55361244#55361244", "title": "RSpec not sending a Post request in JSON", "body": "<p>This worked for me to test a json posted on the body to the controller (RSpec 3.7.0)</p>\n\n<p><code>post :action, params: { whatever: value }, body: { some_key: value }.to_json, as: :json</code></p>\n\n<p>And you read your controller with</p>\n\n<p><code>request.body.read</code></p>\n"}], "owner": {"reputation": 1667, "user_id": 2244502, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/QZIaP.jpg?s=128&g=1", "display_name": "tvieira", "link": "https://stackoverflow.com/users/2244502/tvieira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4913, "favorite_count": 2, "accepted_answer_id": 35464715, "answer_count": 6, "score": 0, "last_activity_date": 1553615310, "creation_date": 1455731762, "question_id": 35464190, "link": "https://stackoverflow.com/questions/35464190/rspec-not-sending-a-post-request-in-json", "title": "RSpec not sending a Post request in JSON", "body": "<p>I'm doing a Rails App that it's mostly an API. I'm trying to test the controllers for my API endpoints. My RSpec Controller tester is as following:</p>\n\n<pre><code>require 'rails_helper'\nrequire 'spec_helper'\nrequire 'rack/test'\nrequire 'devise'\n\nclass RoutesControllerTest &lt; ActionController::TestCase\n\n  describe \"User with token\"\n    test \"should post route\" do  \n      params = { route: {  start_lat: 38.7627951, start_long: -9.1532211,\n                            end_lat: 38.7483783, end_long: -9.155045,\n                            flag_opt: 0.4, city: 1 }\n                }\n\n      post '/routes.json' , params.to_json, format: :json\n      assert_response :success\n    end\n  end\nend\n</code></pre>\n\n<p>And My Controller is:</p>\n\n<pre><code>class RoutesController &lt; ApplicationController\n\n  def create\n    city = City.find(params[:route][:city])\n    user = current_user\n    @route = user.routes.new(route_params)\n    @results = @route.calc_route(@route.start_long, @route.start_lat, @route.end_long, @route.end_lat, params[:route][:flag_opt], city)\n    if @route.save!\n      render :template=&gt;\"/routes/routes.json.jbuilder\", status: 201, :formats =&gt; [:json]\n    else\n      render json: @route.errors\n    end\n  end\n\n  private\n\n  def route_params\n    json_params = ActionController::Parameters.new( JSON.parse(request.body.read) )\n    json_params.require(:route).permit(\n          :start_lat, \n          :start_long, \n          :end_lat, \n          :end_long,\n          :flag_opt\n     )\n  end\nend\n</code></pre>\n\n<p>But everytime I run the <code>rspec spec/controller</code> I get into the following error:</p>\n\n<pre><code>Failure/Error: json_params = ActionController::Parameters.new(JSON.parse(request.body.read) )\n\nJSON::ParserError:\n  757: unexpected token at 'route%5Bcity%5D=24&amp;route%5Bend_lat%5D=41.26171490000001&amp;route%5Bend_long%5D=-8.38193640000001&amp;route%5Bflag_opt%5D=1&amp;route%5Bstart_lat%5D=38.753225&amp;route%5Bstart_long%5D=-9.144376&amp;route%5Buser_id%5D=24'\n</code></pre>\n\n<p>Which means that the request is not being sent as JSON</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "edited": false, "score": 0, "creation_date": 1455731253, "post_id": 35463967, "comment_id": 58623825, "body": "Sorry, I should have mentioned this website is designed to help you practise Ruby. I&#39;m just a beginner. It&#39;s helping me get used to TDD. So you start with the test provided by the exercise, then you write a program to satisfy that test."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "edited": false, "score": 0, "creation_date": 1455731485, "post_id": 35463967, "comment_id": 58623975, "body": "Okay, I answered the exercise for you."}, {"owner": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "edited": false, "score": 1, "creation_date": 1455731788, "post_id": 35463967, "comment_id": 58624178, "body": "This is great, as well. Thank you! Your example is a little easier for me to wrap my head around. Assigning a default value to world makes sense."}, {"owner": {"reputation": 854, "user_id": 6205893, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/760180597445489/picture?type=large", "display_name": "Luan Gon&#231;alves Barbosa", "link": "https://stackoverflow.com/users/6205893/luan-gon%c3%a7alves-barbosa"}, "edited": false, "score": 0, "creation_date": 1557409715, "post_id": 35463967, "comment_id": 98762061, "body": "That&#39;s certainly the best and right response... It provides a nice glimpse already of how differently class and instance methods behave..."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1488303540, "last_edit_date": 1488303540, "creation_date": 1455731084, "answer_id": 35463967, "question_id": 35463812, "link": "https://stackoverflow.com/questions/35463812/minitest-error-argumenterror-wrong-number-of-arguments-given-1-expected-0/35463967#35463967", "title": "Minitest Error - ArgumentError: wrong number of arguments (given 1, expected 0)", "body": "<blockquote>\n  <p>How do I define a method that doesn't require arguments?</p>\n</blockquote>\n\n<p>Your problem is the opposite. You are passing an argument to a method <code>HelloWorld.hello</code>, which does not take an argument.</p>\n\n<p>Your test code does not match what your source code is doing. Either change your source code to:</p>\n\n<pre><code>class HelloWorld\n  def self.hello(name = \"World\")\n    \"Hello, #{name}!\"\n  end\nend\n</code></pre>\n\n<p>Here, the <code>name = \"World\"</code> indicates that the <code>name</code> argument is optional, and that the default value is <code>\"World\"</code>.</p>\n\n<p>Or, change your tests to:</p>\n\n<pre><code>assert_equal 'Hello, Alice!', HelloWorld.new('Alice').say_hello\nassert_equal 'Hello, Bob!', HelloWorld.new('Bob').say_hello\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "edited": false, "score": 0, "creation_date": 1455731635, "post_id": 35464044, "comment_id": 58624064, "body": "This was the solution I was looking for. Thank you! All three assertions pass. I was getting hung up on the wording of Minitest&#39;s output."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "edited": false, "score": 0, "creation_date": 1455731852, "post_id": 35464044, "comment_id": 58624216, "body": "Right, so the learning from the test is how you can call the same method with and without arguments, which is a good learning.  Most of what you have in your solution you don&#39;t need (at the moment)... the initialize and the <code>say_hello</code> and the creating of the new object.  Typically it&#39;s best NOT to code stuff until you need it to pass a test."}, {"owner": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "edited": false, "score": 0, "creation_date": 1455735711, "post_id": 35464044, "comment_id": 58626437, "body": "That makes sense, thank you Steve. Based on my current experience that was the only way I felt I could accomplish the goal. Defining a default value for the argument makes a lot of sense!"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1488303330, "last_edit_date": 1488303330, "creation_date": 1455731308, "answer_id": 35464044, "question_id": 35463812, "link": "https://stackoverflow.com/questions/35463812/minitest-error-argumenterror-wrong-number-of-arguments-given-1-expected-0/35464044#35464044", "title": "Minitest Error - ArgumentError: wrong number of arguments (given 1, expected 0)", "body": "<p>Sometimes in a test you say </p>\n\n<pre><code>HelloWorld.hello('Alice')\n</code></pre>\n\n<p>Other times in a test you say</p>\n\n<pre><code>HelloWorld.hello\n</code></pre>\n\n<p>So you're calling the method \"hello\" with and without arguments.</p>\n\n<p>To make arguments optional, you can give them a default value.</p>\n\n<pre><code>def self.hello(name_to_use=nil)\n  if name_to_use\n    \"Hello, #{name_to_use}!\"\n  else\n    \"Hello, World!\"\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 4851566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68998e20f52bb4dc774377c2bafd8bb3?s=128&d=identicon&r=PG", "display_name": "chemturion", "link": "https://stackoverflow.com/users/4851566/chemturion"}, "is_accepted": false, "score": 0, "last_activity_date": 1488499622, "creation_date": 1488499622, "answer_id": 42568310, "question_id": 35463812, "link": "https://stackoverflow.com/questions/35463812/minitest-error-argumenterror-wrong-number-of-arguments-given-1-expected-0/42568310#42568310", "title": "Minitest Error - ArgumentError: wrong number of arguments (given 1, expected 0)", "body": "<blockquote>\n  <p>How do I define a method that doesn't require arguments?</p>\n</blockquote>\n\n<p>It's important to understand what the error message means, as I had a similar problem on Learn.co's <a href=\"https://learn.co/tracks/full-stack-community-bootcamp/intro-to-ruby-development/oo-tic-tac-toe/oo-tic-tac-toe\" rel=\"nofollow noreferrer\">Object-Oriented TicTacToe challenge</a>. When your code is ran against the test code, the test code is \"giving\" one argument of <code>'Alice'</code> to the <code>#self.hello</code> method. But your <code>#self.hello</code> method as written is expecting exactly zero arguments. Hence:</p>\n\n<pre><code>ArgumentError: wrong number of arguments (given 1, expected 0)\n/Users/drempel/exercism/ruby/hello-world/hello_world.rb:3:in `hello'\nhello_world_test.rb:24:in `test_sample_name'\n</code></pre>\n\n<p>My error message was similar and I had the same train of thought: \"If it expected 0, how can I give it 0?\" Clearly, a key takeaway from our experience is to better understand now what the error message meant.</p>\n"}], "owner": {"reputation": 35, "user_id": 5701265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab3eee710cfc5e0b63f4586267ec614?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/5701265/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22843, "favorite_count": 1, "accepted_answer_id": 35464044, "answer_count": 3, "score": 1, "last_activity_date": 1488499622, "creation_date": 1455730647, "last_edit_date": 1455731918, "question_id": 35463812, "link": "https://stackoverflow.com/questions/35463812/minitest-error-argumenterror-wrong-number-of-arguments-given-1-expected-0", "title": "Minitest Error - ArgumentError: wrong number of arguments (given 1, expected 0)", "body": "<p>I am doing an exercise on exercism.io. This is requested in the Spec document:</p>\n\n<ol>\n<li>The <code>Hello World!</code> program will greet me, the caller.</li>\n<li>If I tell the program my name is Alice, it will greet me by saying \"Hello, Alice!\".</li>\n<li>If I neglect to give it my name, it will greet me by saying \"Hello, World!\"</li>\n</ol>\n\n<hr>\n\n<pre><code>class HelloWorldTest &lt; Minitest::Test\n  def test_no_name\n    assert_equal 'Hello, World!', HelloWorld.hello\n  end\n\n  def test_sample_name\n    assert_equal 'Hello, Alice!', HelloWorld.hello('Alice')\n  end\n\n  def test_other_sample_name\n    assert_equal 'Hello, Bob!', HelloWorld.hello('Bob')\n  end\nend\n</code></pre>\n\n<p>This is my program:</p>\n\n<pre><code>class HelloWorld\n  def self.hello\n    \"Hello, World!\"\n  end\n\n  def initialize(name)\n    @name = name\n  end\n\n  def say_hello\n    puts \"Hello, #{@name}!\"\n  end\nend\n\nprint \"Give me your name: \"\nyour_name = gets.chomp\nhello = HelloWorld.new(your_name)\nif your_name == \"\"\n  puts \"Hello, World!\"\nelse\n  hello.say_hello\nend\n</code></pre>\n\n<p>The program runs and satisfies all of the requirements, but I get the error:</p>\n\n<pre><code>1) Error:\nHelloWorldTest#test_sample_name:\nArgumentError: wrong number of arguments (given 1, expected 0)\n    /Users/drempel/exercism/ruby/hello-world/hello_world.rb:3:in `hello'\n    hello_world_test.rb:24:in `test_sample_name'\n\n3 runs, 1 assertions, 0 failures, 1 errors, 1 skips\n</code></pre>\n\n<p>How do I define a method that doesn't require arguments?</p>\n"}, {"tags": ["ruby", "loops"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1455730629, "post_id": 35463185, "comment_id": 58623458, "body": "Ruby does not have a  <code>:++</code> method and you don&#39;t need the second semicolon in the first line."}], "answers": [{"tags": [], "owner": {"reputation": 2183, "user_id": 1200043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tr7dt.jpg?s=128&g=1", "display_name": "maniacalrobot", "link": "https://stackoverflow.com/users/1200043/maniacalrobot"}, "is_accepted": false, "score": 2, "last_activity_date": 1455729416, "creation_date": 1455729416, "answer_id": 35463397, "question_id": 35463185, "link": "https://stackoverflow.com/questions/35463185/for-loop-with-conditional-increment/35463397#35463397", "title": "For loop with conditional increment", "body": "<p>As you need to re evaluate the condition based on your incrementing <code>i</code> variable, you could use a while statement: </p>\n\n<pre><code>i = 0\n\nwhile i &lt; 100  do\n  if i == 20\n     i = 50\n  else\n     i = i+1\n  end \nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 6, "last_activity_date": 1494764602, "last_edit_date": 1494764602, "creation_date": 1455729446, "answer_id": 35463409, "question_id": 35463185, "link": "https://stackoverflow.com/questions/35463185/for-loop-with-conditional-increment/35463409#35463409", "title": "For loop with conditional increment", "body": "<p>This is probably one of the few cases where a <code>while</code> loop would be appropriate:</p>\n\n<pre><code>i = 0\nwhile i &lt; 10\n  if i == 2\n    i = 5\n  else\n    i += 1\n  end\n\n  p i\nend\n# 1\n# 2\n# 5\n# 6\n# 7\n# 8\n# 9\n# 10\n</code></pre>\n\n<p>Or, you could add your own C-style <code>for</code> loop to the language, it's actually pretty simple:</p>\n\n<pre><code>class Proc\n  def for(iter=-&gt;{}, &amp;blk)\n    return unless call\n    yield\n    iter.()\n    self.for(iter, &amp;blk)\n  end\nend\n\ni = 0\n-&gt; { i &lt; 10 }.for -&gt; { if i == 2 then i = 5 else i += 1 end } { p i }\n# 1\n# 2\n# 5\n# 6\n# 7\n# 8\n# 9\n# 10\n</code></pre>\n\n<p>This is equivalent to the following C-style <code>for</code> loop (demonstrated in ECMAScript):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>for(let i = 1; i &lt;= 10; i === 2 ? i = 5 : i++) {\r\n  console.log(i);\r\n}\r\n// 1\r\n// 2\r\n// 5\r\n// 6\r\n// 7\r\n// 8\r\n// 9\r\n// 10</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 7447, "user_id": 602372, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/q6bLu.jpg?s=128&g=1", "display_name": "Yam Marcovic", "link": "https://stackoverflow.com/users/602372/yam-marcovic"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455735631, "post_id": 35464273, "comment_id": 58626386, "body": "@CarySwoveland Thanks, will add."}], "tags": [], "owner": {"reputation": 7447, "user_id": 602372, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/q6bLu.jpg?s=128&g=1", "display_name": "Yam Marcovic", "link": "https://stackoverflow.com/users/602372/yam-marcovic"}, "is_accepted": false, "score": 1, "last_activity_date": 1455737027, "last_edit_date": 1455737027, "creation_date": 1455732048, "answer_id": 35464273, "question_id": 35463185, "link": "https://stackoverflow.com/questions/35463185/for-loop-with-conditional-increment/35464273#35464273", "title": "For loop with conditional increment", "body": "<p>Not sure how literal you were trying to be with the numbers there, but here's a more elegant trick just for that:</p>\n\n<pre><code>[0...20, 50..100].flat_map(&amp;:to_a).each do |i|\n  # ...\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[*0...20, *50..100].each do |i|\n  # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1455736381, "last_edit_date": 1455736381, "creation_date": 1455734089, "answer_id": 35464894, "question_id": 35463185, "link": "https://stackoverflow.com/questions/35463185/for-loop-with-conditional-increment/35464894#35464894", "title": "For loop with conditional increment", "body": "<p>I wouldn't recommend this, but it's a way to skip indices when using an enumerator with a block. Suppose</p>\n\n<pre><code>skip_index  = 2\nskip_number = 4\narr = [*0..10]\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>arr = arr[skip_number..10] if skip_index.zero?\narr.each do |i|\n  puts \"i=#{i}\"\n  # do something\n  arr.replace([*skip_number..10]) if i == skip_index-1\nend\ni=0\ni=1\ni=6\ni=7\ni=8\ni=9\ni=10\n</code></pre>\n\n<p>This may provide some insight into how <code>each</code> works.</p>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 5938358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd980f4c02d88122d045088ca2eef14?s=128&d=identicon&r=PG&f=1", "display_name": "JonahR", "link": "https://stackoverflow.com/users/5938358/jonahr"}, "is_accepted": false, "score": 0, "last_activity_date": 1455738488, "creation_date": 1455738488, "answer_id": 35466316, "question_id": 35463185, "link": "https://stackoverflow.com/questions/35463185/for-loop-with-conditional-increment/35466316#35466316", "title": "For loop with conditional increment", "body": "<p>Here is concise while loop that will achieve what you want to do.</p>\n\n<pre><code>i = 0\nwhile i &lt; 100\n    i == 20 ? i = 50 : i += 1\n    p i\nend\n</code></pre>\n\n<p>This will return: \n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n50\n51\n52\n53\n...\n100</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1897, "favorite_count": 0, "accepted_answer_id": 35463409, "answer_count": 5, "score": 0, "last_activity_date": 1494764602, "creation_date": 1455728872, "last_edit_date": 1455772969, "question_id": 35463185, "link": "https://stackoverflow.com/questions/35463185/for-loop-with-conditional-increment", "title": "For loop with conditional increment", "body": "<p>I want a <code>for</code> loop that increments according to a condition. The loop should normally increment its index <code>i</code> by <code>1</code>, but if some condition (<code>i == 20</code>) is met, then it should set the value of <code>i</code> to <code>50</code> (skipping <code>21</code>--<code>49</code>). Pseudo-code would be something like this:</p>\n\n<pre><code>for(i = 0; i &lt; 100;)\n  if i == 20\n    i = 50\n  else\n    i = i++\n  end \nend\n</code></pre>\n\n<p>How can I implement this?</p>\n"}, {"tags": ["ruby", "api"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2516837"}, "edited": false, "score": 0, "creation_date": 1471241233, "post_id": 35462996, "comment_id": 65254729, "body": "If anyone is still looking for a workaround for this. Making the script sleep for <i>6</i> seconds every 40 requests still works. As shown here : <a href=\"https://github.com/o19s/relevant-search-book/issues/1\" rel=\"nofollow noreferrer\">github.com/o19s/relevant-search-book/issues/1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 2130426, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/08ac3c97b3173f28cf0cf9361a293e6c?s=128&d=identicon&r=PG", "display_name": "f7n", "link": "https://stackoverflow.com/users/2130426/f7n"}, "edited": false, "score": 0, "creation_date": 1455729529, "post_id": 35463224, "comment_id": 58622727, "body": "Thanks for this tip. I&#39;ll implement this. Can you check my edit? It looks like I will have to implement a 10s throttle every 40 requests. Is using sleep() and a while loop a good solution? Seems really archaic to me."}, {"owner": {"reputation": 7567, "user_id": 908842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fdcc9243d55a92dd2b3a9e2568bae0?s=128&d=identicon&r=PG", "display_name": "Kalman", "link": "https://stackoverflow.com/users/908842/kalman"}, "edited": false, "score": 1, "creation_date": 1455730187, "post_id": 35463224, "comment_id": 58623178, "body": "Ruby 2.3.0 introduces a &quot;save navigation&quot; operator for this specific issue <a href=\"http://aaronlasseigne.com/2016/01/04/rubys-new-safe-navigation-not-equal-operator/\" rel=\"nofollow noreferrer\">aaronlasseigne.com/2016/01/04/&hellip;</a>"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1455728983, "creation_date": 1455728983, "answer_id": 35463224, "question_id": 35462996, "link": "https://stackoverflow.com/questions/35462996/how-to-scrape-tmdb-using-ruby-getting-undefined-method-for-nilnilclass-er/35463224#35463224", "title": "How to scrape TMDB using Ruby? Getting undefined method `[]&#39; for nil:NilClass error", "body": "<p>When you access a property through multiple levels you <em>assume</em> they're all present and will suffer an error when they're not. This snippet, for example:</p>\n\n<pre><code>result['movie_results'][0][\"id\"]\n</code></pre>\n\n<p>If <code>result['movie_results']</code> is not an array, or if it is an array but is empty, or is something other than a Hash, this will explode with an exception.</p>\n\n<p>The safer approach is this:</p>\n\n<pre><code>result['movie_results'] &amp;&amp; result['movie_results'][0] &amp;&amp; result['movie_results'][0][\"id\"]\n</code></pre>\n\n<p>That's awfully annoying to do on a frequent basis, so you might want to write a method that carefully <a href=\"https://blog.blockscore.com/new-features-in-ruby-2-3/\" rel=\"nofollow\">digs down</a> to the value you're looking for.</p>\n"}], "owner": {"reputation": 968, "user_id": 2130426, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/08ac3c97b3173f28cf0cf9361a293e6c?s=128&d=identicon&r=PG", "display_name": "f7n", "link": "https://stackoverflow.com/users/2130426/f7n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455731717, "creation_date": 1455728282, "last_edit_date": 1455731717, "question_id": 35462996, "link": "https://stackoverflow.com/questions/35462996/how-to-scrape-tmdb-using-ruby-getting-undefined-method-for-nilnilclass-er", "title": "How to scrape TMDB using Ruby? Getting undefined method `[]&#39; for nil:NilClass error", "body": "<p>I've got a list of movies and I'm trying to scrape TheMovieDatabase.org (TMDB) to return each of the movie's ID (just an example, I plan to retrieve more info, but my code is failing at this point).</p>\n\n<p>I'm using the gem themoviedb (<a href=\"https://github.com/ahmetabdi/themoviedb\" rel=\"nofollow\">https://github.com/ahmetabdi/themoviedb</a>), and I've got an array of IMDB movie IDs (around 10,000 movies), which I'm iterating through and performing a API call on each of them, like this:</p>\n\n<pre><code>imdb_id = [\"tt0114709\", \"tt0113497\", \"tt0107050\", \"tt0114885\", \"tt0113041\", \"tt0113277\" (etc...)]\n\nimdb_id.each do |id|\n    result = Tmdb::Find.imdb_id(id)\n    p result['movie_results'][0][\"id\"]\nend\n</code></pre>\n\n<p>However, the code fails after a number of iterations with this error:</p>\n\n<pre><code>`block in &lt;main&gt;': undefined method `[]' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>Sometimes it will fail on the 40th ID (most common), or the 88th ID, or the 109th. There is nothing different between these IDs and any other ID which success in the array, and if I query them alone it works fine:</p>\n\n<pre><code>result = Tmdb::Find.imdb_id(imdb_id[41])\np result['movie_results'][0][\"id\"]\n</code></pre>\n\n<p>The JSON result for <code>Tmdb::Find.imdb_id(imdb_id[41])</code> look like this (I removed some data that I'm not using for readability):</p>\n\n<pre><code>{  \n   \"movie_results\"   =&gt;   [  \n      {  \n         \"adult\"         =&gt;false,\n         \"id\"         =&gt;11443\n      }\n   ]\n}\n</code></pre>\n\n<p>I'm really confused what's causing the problem. Should I have some delay between API calls? Is this even the best way to perform lots of API calls in Ruby?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>found this error in the JSON: <code>\"status_message\"=&gt;\"Your request count (41) is over the allowed limit of 40.\"}</code>. I need to implement a throttle in my code...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "https", "devise", "credentials"], "answers": [{"comments": [{"owner": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "edited": false, "score": 0, "creation_date": 1455730882, "post_id": 35463768, "comment_id": 58623616, "body": "Thanks for the hasty response. As for the user_params definition, will it throw an exception when those any of those 3 fields are not provided as is? Or will I have to check for that separately.  As for the create definition, how will those keywords appear to my mobile application when it receives the response?"}, {"owner": {"reputation": 2895, "user_id": 214759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a643cb8407049539331506124310d20?s=128&d=identicon&r=PG", "display_name": "Jimmy Baker", "link": "https://stackoverflow.com/users/214759/jimmy-baker"}, "reply_to_user": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "edited": false, "score": 0, "creation_date": 1455731096, "post_id": 35463768, "comment_id": 58623748, "body": "It&#39;s up to the validation in your model to determine if the new user record is valid. If you&#39;re using has_secure_password in rails, then this is added by default. This means that you won&#39;t be able to save a new user without a valid email, password and password_confirmation."}, {"owner": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "edited": false, "score": 0, "creation_date": 1455731131, "post_id": 35463768, "comment_id": 58623770, "body": "Ah, I do have validation in place, so I&#39;m good there - didn&#39;t think of that. what about the status keywords?"}, {"owner": {"reputation": 2895, "user_id": 214759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a643cb8407049539331506124310d20?s=128&d=identicon&r=PG", "display_name": "Jimmy Baker", "link": "https://stackoverflow.com/users/214759/jimmy-baker"}, "reply_to_user": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "edited": false, "score": 0, "creation_date": 1455731263, "post_id": 35463768, "comment_id": 58623832, "body": "The response from this controller should be whatever you want your User records to be serialized as. No matter what serializer you use, the response should be in JSON. I&#39;m a fan of active_model_serializers but there are others as well. If you don&#39;t want to add a dependency, then you can simply overwrite the as_json method in your User class where you can define a hash that represents how you want a user to be seen in JSON."}, {"owner": {"reputation": 2895, "user_id": 214759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a643cb8407049539331506124310d20?s=128&d=identicon&r=PG", "display_name": "Jimmy Baker", "link": "https://stackoverflow.com/users/214759/jimmy-baker"}, "reply_to_user": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "edited": false, "score": 0, "creation_date": 1455731354, "post_id": 35463768, "comment_id": 58623895, "body": "Rails converts these to the proper http status code integers. 200/201/404/etc. Here&#39;s a list of all of them: <a href=\"http://billpatrianakos.me/blog/2013/10/13/list-of-rails-status-code-symbols/\" rel=\"nofollow noreferrer\">billpatrianakos.me/blog/2013/10/13/&hellip;</a>"}, {"owner": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "edited": false, "score": 0, "creation_date": 1455731421, "post_id": 35463768, "comment_id": 58623939, "body": "Thanks really helpful"}], "tags": [], "owner": {"reputation": 2895, "user_id": 214759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a643cb8407049539331506124310d20?s=128&d=identicon&r=PG", "display_name": "Jimmy Baker", "link": "https://stackoverflow.com/users/214759/jimmy-baker"}, "is_accepted": true, "score": 0, "last_activity_date": 1455730476, "creation_date": 1455730476, "answer_id": 35463768, "question_id": 35462823, "link": "https://stackoverflow.com/questions/35462823/proper-way-to-send-user-credentials-to-rails-api/35463768#35463768", "title": "Proper way to send user credentials to rails API", "body": "<p>Yeah, what you have is a good start.</p>\n\n<blockquote>\n  <p>Is it adequate to use HTTPS and send user credentials through\n  parameters?</p>\n</blockquote>\n\n<p>It's not only adequate, it's socially responsible of you to send them via HTTPS. At the top of your controller you can force your controller to only respond to ssl requests like so:</p>\n\n<pre><code>force_ssl unless Rails.env.test?\n</code></pre>\n\n<blockquote>\n  <p>How can I do this using the first method defined inside of my\n  user_params? It seems that sending a JSON object and parsing it with\n  my second user_param definition (the one not commented out) is the\n  only way to accomplish this. I was originally sending email, password,\n  password_confirmation as their own params, but then I found out that\n  params.require can only take one argument at a time, and then my\n  errors would only show one field that is missing when there could be\n  multiple, hence the reason why I'm sending it as one object.</p>\n</blockquote>\n\n<p>You can reduce this all down to simply:</p>\n\n<pre><code>def user_params\n  params.permit(:email, :password, :password_confirmation)\nend\n</code></pre>\n\n<p>Rails, by default, will parse JSON into the params hash for you. Using the code above you can also avoid having to put your email and password inside a \"user\" key on the json object.</p>\n\n<pre><code>{ email: '...', password: '...' } VS. { user: { email: '...', password: '...' } }\n</code></pre>\n\n<blockquote>\n  <p>Am i going about this all wrong? or headed in the right direction?</p>\n</blockquote>\n\n<p>You're on the right track. Another minor suggestion, which is totally developer preference is to use keywords for the response types instead of the integers themselves. I just think it reads nicely that way. Here's what it would look like:</p>\n\n<pre><code>def create\n    user = User.new(user_params)\n    if user.save\n      render json: user, status: :created\n    else\n      render json: { errors: user.errors }, status: :unprocessable_entity\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 4174, "user_id": 2247192, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/79903375cf1b12dafab1366f73492919?s=128&d=identicon&r=PG&f=1", "display_name": "Riptyde4", "link": "https://stackoverflow.com/users/2247192/riptyde4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 985, "favorite_count": 0, "accepted_answer_id": 35463768, "answer_count": 1, "score": 1, "last_activity_date": 1455730476, "creation_date": 1455727842, "last_edit_date": 1455728478, "question_id": 35462823, "link": "https://stackoverflow.com/questions/35462823/proper-way-to-send-user-credentials-to-rails-api", "title": "Proper way to send user credentials to rails API", "body": "<p>I've setup devise token authentication on my Rails API And it's working properly, however I'm unsure of the most proper secure way to send user credentials when logging in/registering... To give you some context, the API will be used as the backend for a mobile application when it's completed.</p>\n\n<p>Here's what I have for my create method inside of my users_controller.rb:</p>\n\n<pre><code>def create\n    user = User.new(user_params)\n    if user.save\n      render json: user, status: 201\n    else\n      render json: { errors: user.errors}, status: 422\n    end\nend\n</code></pre>\n\n<p>As of now, I'm sending them as parameters through the URL (email, password, password confirmation).</p>\n\n<p>My user_params method:</p>\n\n<pre><code>def user_params\n  # Seems to expect a user object as the param, unsure of how to replicate this on the app side\n  # params.require(:user).permit(:email, :password, :password_confirmation)\n\n  # Expects to see params[:user] as a string representation of JSON containing fields\n  # email, password, and password_confirmation.\n  ActionController::Parameters.new(JSON.parse(params.require(:user))).permit(:email, :password, :password_confirmation)\nend\n</code></pre>\n\n<p>As you can see from my comments, I'm quite unsure how to proceed and I'd like to create as secure a process as possible with the setup that I have.  </p>\n\n<p><strong>These are some questions that I have about sending user credentials to my API from a mobile application:</strong></p>\n\n<p>Is it adequate to use HTTPS and send user credentials through parameters?</p>\n\n<p>How can I do this using the first method defined inside of my user_params? It seems that sending a JSON object and parsing it with my second user_param definition (the one not commented out) is the only way to accomplish this. I was originally sending email, password, password_confirmation as their own params, but then I found out that params.require can only take one argument at a time, and then my errors would only show one field that is missing when there could be multiple, hence the reason why I'm sending it as one object.</p>\n\n<p>Am i going about this all wrong? or headed in the right direction?</p>\n\n<p>Thanks for all of your help ahead of time!</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "devise", "reactjs"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5103897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/s46Sk.jpg?s=128&g=1", "display_name": "Luke Schunk", "link": "https://stackoverflow.com/users/5103897/luke-schunk"}, "edited": false, "score": 0, "creation_date": 1455754603, "post_id": 35466738, "comment_id": 58636208, "body": "Thanks - this is a pretty interesting solution. Unfortunately our team doesn&#39;t want to use reactrb, but your post got me started in the right direction, so thanks!"}, {"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "reply_to_user": {"reputation": 241, "user_id": 5103897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/s46Sk.jpg?s=128&g=1", "display_name": "Luke Schunk", "link": "https://stackoverflow.com/users/5103897/luke-schunk"}, "edited": false, "score": 0, "creation_date": 1455756171, "post_id": 35466738, "comment_id": 58636684, "body": "Glad to help!  Under the hood reactrb just generates react.js calls, so you should be able to translate the ruby solution to JSX.  Of course you won&#39;t be able to access your rails models directly ;-( .  It would be great if you could drop in at <a href=\"https://gitter.im/zetachang/react.rb\" rel=\"nofollow noreferrer\">gitter.im/zetachang/react.rb</a> and spend a couple of minutes sharing your teams pros and cons of react.js vs react.rb!"}], "tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": true, "score": 3, "last_activity_date": 1455740770, "last_edit_date": 1455740770, "creation_date": 1455739803, "answer_id": 35466738, "question_id": 35462718, "link": "https://stackoverflow.com/questions/35462718/javascript-react-authentication-through-ruby-gem-devise/35466738#35466738", "title": "JavaScript React Authentication through Ruby Gem Devise?", "body": "<p>What we want is a component (lets call it LoginMenu) that replaces this ERB partial. </p>\n\n<p>Lets break it down by figuring out how we are going to get rid of the specific ERB code, of which there are the following constructs:</p>\n\n<ol>\n<li><code>&lt;% if user_signed_in? %&gt; ... &lt;% else %&gt; ... &lt;% end %&gt;</code></li>\n<li><code>&lt;%= link_to 'Account', edit_user_registration_path %&gt;</code></li>\n<li><code>&lt;%= link_to 'Sign out', destroy_user_session_path, :method=&gt;'delete' %&gt;</code></li>\n<li><code>&lt;%= link_to 'Sign in', new_user_session_path %&gt;</code></li>\n<li><code>&lt;%= link_to 'Sign up', new_user_registration_path %&gt;</code></li>\n</ol>\n\n<p>What 1, 2, &amp; 3 all need is a user_id (which might be nil) .  If there is a non-nil user_id then the \"user is signed in\" and the id of the user can be used to construct the the edit and destroy paths.  The other two paths (4, 5) are constant values.</p>\n\n<p>So what your component needs is the user_id to be sent in as a prop.  Then you can say something like this</p>\n\n<pre><code>if (props[\"user_id\"]) {\n  ... build and render the edit and destroy links using the value of props[\"user_id\"]\n} else {\n  ... build the signin, and signup links\n}\n</code></pre>\n\n<p>You can make little helper functions like this:</p>\n\n<pre><code>edit_user_link: function {\n  &lt;a style=... href={\"/user/\"+props[\"user_id\"]+/edit\"} &gt;\n}\n</code></pre>\n\n<p>etc...</p>\n\n<p>Assuming you are using react-rails then you will have</p>\n\n<pre><code>&lt;%= react_component \"LoginMenu\", user_id: @user ? @user.id : nil %&gt;\n</code></pre>\n\n<p>At this point this much of the page is not \"reactive\" but in our experience login is one of the harder things to make reactive, so just leave as is for now.</p>\n\n<p>FYI... if you are just starting out you may want to consider <a href=\"http://reactrb.org\" rel=\"nofollow\">http://reactrb.org</a> which will let you code the client side code in ruby, so you are not trying to learn mesh three different lanuages at once (ruby, js, JSX).</p>\n\n<p>You ruby component would look like this for example (this will actually run in Stack Overflow...)</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script type=\"text/ruby\"&gt;\r\n# the above script tag just allows us to run in SO\r\n# In your app User would be your user model, we are just going to stub it here\r\n\r\nclass User # &lt; ActiveRecord::Base - just stub user for now\r\n  def id\r\n   12\r\n  end\r\nend\r\n\r\n# Here is your component.  Normally this would be in the file \r\n# app/views/components/login.rb by convention\r\n\r\nclass LoginMenu &lt; React::Component::Base\r\n  param :user, type: User\r\n  def render \r\n    ul.nav_right_links do\r\n      if params.user #react.rb refers to props as params\r\n        li { a(href: \"/user/#{params.user.id}/edit\") { \"Account\" } }\r\n        li { a(href: \"/user/#{params.user.id}/delete\") { \"Delete\" } }\r\n      else\r\n        li { a(href: \"/user/new\") { \"Sign Up\" } }\r\n        li { a(href: \"/user/login\") { \"Sign In\" } }\r\n      end\r\n      li { a(href: \"/connections/help\") { \"Help\" } }\r\n    end\r\n  end\r\nend\r\n\r\n# the following just fires up our component in stack overflow...\r\n# in your app you would do this in the controller:\r\n# &lt;%= react_component \"LoginMenu\", user: @user %&gt;\r\n\r\nElement['#container'].render { LoginMenu(user: User.new) }\r\n\r\n&lt;/script&gt;\r\n&lt;div id=\"container\"&gt;&lt;/div&gt;\r\n\r\n&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n\r\n&lt;script src=\"https://rawgit.com/reactive-ruby/inline-reactive-ruby/master/inline-reactive-ruby.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Besides <a href=\"http://reactrb.org\" rel=\"nofollow\">http://reactrb.org</a> which has a good basic tutorial, you can check these slides out which cover rails integration specifics: <a href=\"http://slides.com/mitchvanduyn/deck-1\" rel=\"nofollow\">http://slides.com/mitchvanduyn/deck-1</a></p>\n"}], "owner": {"reputation": 241, "user_id": 5103897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/s46Sk.jpg?s=128&g=1", "display_name": "Luke Schunk", "link": "https://stackoverflow.com/users/5103897/luke-schunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3326, "favorite_count": 2, "accepted_answer_id": 35466738, "answer_count": 1, "score": 1, "last_activity_date": 1455740770, "creation_date": 1455727554, "question_id": 35462718, "link": "https://stackoverflow.com/questions/35462718/javascript-react-authentication-through-ruby-gem-devise", "title": "JavaScript React Authentication through Ruby Gem Devise?", "body": "<p>I'm working in a rails app for the first time and I'm trying to convert the front end to React. I'm doing this view-by view, and right now I'm working on the menu bar, which has links that work based on whether or not the user is logged in. See the original rails erb code below: </p>\n\n<pre><code>&lt;ul class=\"nav-right-links\"&gt;\n  &lt;% if user_signed_in? %&gt;\n    &lt;li&gt;&lt;%= link_to 'Account', edit_user_registration_path %&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;%= link_to 'Sign out', destroy_user_session_path, :method=&gt;'delete' %&gt;&lt;/li&gt;\n  &lt;% else %&gt;\n    &lt;li&gt;&lt;%= link_to 'Sign in', new_user_session_path %&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;%= link_to 'Sign up', new_user_registration_path %&gt;&lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;li&gt;&lt;a href=\"/connections/help\"&gt;Help&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>I figured out that this auth is being done by a rails Gem called Devise. I want to keep the auth being done through devise, but I just need to figure out how to get some of the logic into React. If you're curious, here's some of my react code so far. Right now I'm just using hrefs, but obviously it's not responding to whether or not the user is logged in:</p>\n\n<pre><code>  render () {\n    return (\n      &lt;div style={styles.container}&gt;\n        &lt;ul style={styles.leftNav}&gt;\n          {leftLinks.map(link =&gt; {\n            return (\n              &lt;li style={styles.listElement}&gt;&lt;a style={styles.link} href={link.path}&gt; {link.name} &lt;/a&gt; &lt;/li&gt;\n            );\n          })}\n        &lt;/ul&gt;\n      &lt;/div&gt;\n    );\n  }\n</code></pre>\n\n<p>Any help is greatly appreciated! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-api-ruby-client"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 5890390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da81465d80d5f56c412172cbdeaf1092?s=128&d=identicon&r=PG&f=1", "display_name": "omarmilhouse", "link": "https://stackoverflow.com/users/5890390/omarmilhouse"}, "is_accepted": true, "score": 1, "last_activity_date": 1455728555, "creation_date": 1455728555, "answer_id": 35463079, "question_id": 35462464, "link": "https://stackoverflow.com/questions/35462464/how-to-pass-my-auth-token-and-refresh-tokens-to/35463079#35463079", "title": "How to pass my auth_token and refresh tokens to", "body": "<p>You can create the authorization object by instantiate a new UserRefreshCredentials like this:</p>\n\n<pre><code> authorization = Google::Auth::UserRefreshCredentials.new(\n      client_id: GOOGLE_CLIENT_ID\n      client_secret: GOOGLE_CLIENT_SECRET\n      scope: GOOGLE_SCOPE,\n      access_token: YOUR_AUTH_TOKEN,\n      refresh_token: YOUR_REFRESH_TOKEN,\n      expires_at: YOUR_EXPIRE_AT_TIMESTAMP,\n      grant_type: 'authorization_code')\n</code></pre>\n"}], "owner": {"reputation": 6363, "user_id": 2837813, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/5Xggf.png?s=128&g=1", "display_name": "ProGM", "link": "https://stackoverflow.com/users/2837813/progm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 35463079, "answer_count": 1, "score": 0, "last_activity_date": 1455728555, "creation_date": 1455726782, "question_id": 35462464, "link": "https://stackoverflow.com/questions/35462464/how-to-pass-my-auth-token-and-refresh-tokens-to", "title": "How to pass my auth_token and refresh tokens to", "body": "<p>I'm using the <code>google-api-ruby-client</code> gem in rails.</p>\n\n<p>In the examples I found an example to load GooglePlus data:</p>\n\n<pre><code>client = Google::Apis::PlusV1::PlusService.new\nclient.key = ENV['GOOGLE_CLIENT_ID']\nclient.authorization = authorization\n</code></pre>\n\n<p><strong>I have already obtained both <code>refresh_token</code> and the <code>auth_token</code> with another method</strong> (using devise oauth).</p>\n\n<p>How can I generate the <code>authorization</code> object, starting from the tokens I have?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1455727005, "post_id": 35462384, "comment_id": 58621097, "body": "Note: Do be careful about making method calls like <code>x(y)</code> and not <code>x (y)</code> with a space. The space can cause the statement to be interpreted in a way you may not intend."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1455727076, "post_id": 35462384, "comment_id": 58621141, "body": "Do you mean <code>resources :professors</code>? The lack of a plural might be messing up your routing table."}, {"owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1455727133, "post_id": 35462384, "comment_id": 58621183, "body": "Thanks for that.  It didn&#39;t help with this issue but I will try to make that a practice, it&#39;s a bad habit from Java or something I suppose."}, {"owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1455727194, "post_id": 35462384, "comment_id": 58621229, "body": "Tadman, that worked!  Thank you so much!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1455727716, "post_id": 35462384, "comment_id": 58621587, "body": "Also, I think maybe you don&#39;t need <code>get &#39;newprof&#39; =&gt; &#39;professor#new&#39;</code> unless you specifically want to use <code>newprof_path</code> somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "edited": false, "score": 0, "creation_date": 1455751204, "post_id": 35462814, "comment_id": 58635015, "body": "Now I&#39;m getting a load error:  Unable to autoload constant ProfessorsController, expected /Users/tfantina/Documents/Code and Websites/Ruby &amp; Rails Stuff/ratings-test/app/controllers/professors_controller.rb to define it"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "edited": false, "score": 0, "creation_date": 1455818988, "post_id": 35462814, "comment_id": 58671460, "body": "It&#39;s probably a case that you&#39;ve defined <code>ProfessorController</code> inadvertently."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1455727824, "creation_date": 1455727824, "answer_id": 35462814, "question_id": 35462384, "link": "https://stackoverflow.com/questions/35462384/rails-nomethoderror/35462814#35462814", "title": "Rails NoMethodError", "body": "<p>Within the Rails environment it's very important to be aware of the pluralization requirements of various names. Be sure to declare your <em>resources</em> as plural:</p>\n\n<pre><code>resources :professors\n</code></pre>\n\n<p>Declaring it in the singular may mess up the automatically generated routes, you'll get thing like <code>professor_path</code> instead of <code>professors_path</code>. You can check what these are with:</p>\n\n<pre><code>rake routes\n</code></pre>\n\n<p>If you get errors about <code>x_path</code> being missing, check that there's a route with the name <code>x</code> in your routes listing. The most common case is it's mislabeled, a typo, or you've failed to pluralize it properly.</p>\n"}], "owner": {"reputation": 572, "user_id": 5100555, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6de1f19624f27e2e059e2b511ef4bfe6?s=128&d=identicon&r=PG", "display_name": "tfantina", "link": "https://stackoverflow.com/users/5100555/tfantina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 35462814, "answer_count": 1, "score": 0, "last_activity_date": 1455727824, "creation_date": 1455726563, "last_edit_date": 1495535298, "question_id": 35462384, "link": "https://stackoverflow.com/questions/35462384/rails-nomethoderror", "title": "Rails NoMethodError", "body": "<p>I'm having an issue very similar to the one asked in this question here: <a href=\"https://stackoverflow.com/questions/13549967/nomethoderror-undefined-method-foobar-path-when-using-form-for\">NoMethodError / undefined method `foobar_path&#39; when using form_for</a> However the answer there confuses me.<br>\nI went through Michael Hartel's Ruby on Rails tutorial before developing the application I'm working on at the moment, I tried to copy exactly what he did when he created a user model as I created my model.  My application is designed to be a database for university professors, so the model I'm using is called \"professor\" but it's the same concept as \"user\".</p>\n\n<p>Here is the code for my New.html.erb where is where users go to create a new professor: </p>\n\n<pre><code>&lt;%provide(:title, 'Add a professor') %&gt;\n&lt;div class=\"jumbotron\"&gt;\n&lt;h2&gt; New Professor&lt;/h2&gt;\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n    &lt;%= form_for (@professor) do |f| %&gt;\n    &lt;%= f.label \"First Name\" %&gt;\n    &lt;%= f.text_field :fname %&gt;\n\n    &lt;%= f.label  \"Last Name\" %&gt;\n    &lt;%= f.text_field :lname %&gt;\n\n    &lt;%= f.label \"School\" %&gt;\n    &lt;%= f.text_field :school %&gt;\n\n    &lt;%= f.submit \"Add this professor\", class: \"btn btn-primary\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And then here is the code from the Professor_controller.rb</p>\n\n<pre><code>class ProfessorController &lt; ApplicationController\n  def show\n    @professor = Professor.find(params[:id])\n  end\n\n  def new\n    @professor = Professor.new\n  end\nend\n</code></pre>\n\n<p>When I replace </p>\n\n<pre><code>  &lt;%= form_for (@professor) do |f| %&gt;  \n</code></pre>\n\n<p>In new.html.erb with: </p>\n\n<pre><code>  &lt;%= form_for (:professor) do |f| %&gt;\n</code></pre>\n\n<p>It works.  The thread I mentioned above said something about adding a route for the controller.  My routes.rb looks like this:</p>\n\n<pre><code>Rails.application.routes.draw do\n\nroot 'static_pages#home'\nget  'about' =&gt; 'static_pages#about'\nget 'newprof' =&gt; 'professor#new'\nresources :professor\n</code></pre>\n\n<p>And I don't believe that in Michael Hartel's book he does anything differently.   I'm still very new to Rails so forgive me if this is a bit of an easy question, I've been stuck on it for a few days and I've tried numerous work arounds, using the instance of :professor works but @professor does not and I don't know why.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routing", "constants"], "answers": [{"comments": [{"owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455726988, "post_id": 35462439, "comment_id": 58621080, "body": "Good answer. In which situation is <code>scope</code> superior to <code>namespace</code>?"}, {"owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455727073, "post_id": 35462439, "comment_id": 58621139, "body": "Also, using <code>scope</code> seems to have broken my auto generated paths like <code>firefighters_dashboard_path</code>. Any tips there?"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "reply_to_user": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455727172, "post_id": 35462439, "comment_id": 58621212, "body": "Is a firefighter a singular resource?  I.e. Can you see all firefighters or is there just &quot;one&quot; by that I mean say I login as a firefighter, I can only see my stuff, no other firefighters stuff."}, {"owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455727226, "post_id": 35462439, "comment_id": 58621245, "body": "There&#39;s gonna be accounting, chiefs, etc, they are not in the routes right now though."}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "reply_to_user": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455728237, "post_id": 35462439, "comment_id": 58621934, "body": "all under <code>&#47;firefighters</code>?  Ok then my other suggestion wouldn&#39;t make that much sense.  I was going to suggest a singular resource.  You can do <code>get &#39;&#47;dashboard&#39;        =&gt; &#39;firefighters#dashboard&#39;, as: :firefighters_dashboard</code>"}], "tags": [], "owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "is_accepted": true, "score": 2, "last_activity_date": 1455726713, "creation_date": 1455726713, "answer_id": 35462439, "question_id": 35462137, "link": "https://stackoverflow.com/questions/35462137/uninitialized-constant-error-pertaining-to-rails-namespaces/35462439#35462439", "title": "Uninitialized constant error pertaining to Rails&#39; namespaces", "body": "<pre><code>get '/firefighters/dashboard' =&gt; 'firefighters#dashboard'\n</code></pre>\n\n<p>Works because your controller is</p>\n\n<pre><code>class FirefightersController\nend\n</code></pre>\n\n<p>These</p>\n\n<pre><code>namespace :firefighters do\n  get '/dashboard'        =&gt; 'firefighters#dashboard' # Namely, this one.\n  get '/dashboard/:date'  =&gt; 'firefighters#dashboard'\n  get '/account'          =&gt; 'firefighters#account'\n  get '/edit'             =&gt; 'firefighters#edit'\n  get '/approve'          =&gt; 'firefighters#approve'\nend\n</code></pre>\n\n<p>Don't work because rails is expecting a module so your controller should be</p>\n\n<pre><code>class Firefighters::FirefightersController\n</code></pre>\n\n<p>You could if you're only bothered about the url, not about the folder structure for your app do</p>\n\n<pre><code>scope '/firefighters' do\n  get '/dashboard'        =&gt; 'firefighters#dashboard' # Namely, this one.\n  get '/dashboard/:date'  =&gt; 'firefighters#dashboard'\n  get '/account'          =&gt; 'firefighters#account'\n  get '/edit'             =&gt; 'firefighters#edit'\n  get '/approve'          =&gt; 'firefighters#approve'\nend\n</code></pre>\n\n<p>In which case you could leave your controller as it is.</p>\n"}], "owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 35462439, "answer_count": 1, "score": 0, "last_activity_date": 1455726713, "creation_date": 1455725906, "question_id": 35462137, "link": "https://stackoverflow.com/questions/35462137/uninitialized-constant-error-pertaining-to-rails-namespaces", "title": "Uninitialized constant error pertaining to Rails&#39; namespaces", "body": "<p>I posted this question before, but changed some variable names and realized my mistake too late, so this code is unaltered in any way.</p>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Routing Error uninitialized constant Firefighters  Rails.root:<br>\n  /Users/Vladdy/Dropbox/dev/firestaff</p>\n</blockquote>\n\n<p>Here's the relevant, erroring bit from <code>routes.rb</code>:</p>\n\n<pre><code>  # get '/firefighters/dashboard' =&gt; 'firefighters#dashboard'\n  namespace :firefighters do\n    get '/dashboard'        =&gt; 'firefighters#dashboard' # Namely, this one.\n    get '/dashboard/:date'  =&gt; 'firefighters#dashboard'\n    get '/account'          =&gt; 'firefighters#account'\n    get '/edit'             =&gt; 'firefighters#edit'\n    get '/approve'          =&gt; 'firefighters#approve'\n  end\n</code></pre>\n\n<p>If I uncomment line 1, and comment get <code>/dashboard</code>, the dashboard loads just fine through <code>FirefightersController#dashboard</code>.</p>\n\n<p>I painstakingly checked that all of my model names are singular: <code>Accountant</code>, <code>Engineer</code>, <code>Firefighter</code> and all of my controllers are plural: <code>AccountingController</code>, <code>EngineeringController</code>, etc.</p>\n\n<p>Here is the stack trace of the error: <a href=\"http://pastebin.com/NpvY2EYy\" rel=\"nofollow\">http://pastebin.com/NpvY2EYy</a></p>\n\n<p>I hope this is enough information. Once again - SOS! I do no know how to diagnose this problem. If it matters, I'm using ruby 2.3.0 and rails 4.2.5</p>\n\n<p>Thanks you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3411, "user_id": 294022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsrDd.jpg?s=128&g=1", "display_name": "GorillaApe", "link": "https://stackoverflow.com/users/294022/gorillaape"}, "edited": false, "score": 0, "creation_date": 1470856493, "post_id": 38881735, "comment_id": 65124550, "body": "we did something like that. However the real solution would be to use a custom form builder"}, {"owner": {"reputation": 20306, "user_id": 182172, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZlHFm.png?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/182172/victor"}, "edited": false, "score": 0, "creation_date": 1473298059, "post_id": 38881735, "comment_id": 66090178, "body": "Or better, use <code>&lt;% class_name = model.class.name.underscore %&gt;</code> so you get camel_case for CamelCase."}], "tags": [], "owner": {"reputation": 522, "user_id": 1116736, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/V6VCi.jpg?s=128&g=1", "display_name": "ronlut", "link": "https://stackoverflow.com/users/1116736/ronlut"}, "is_accepted": true, "score": 2, "last_activity_date": 1470856349, "creation_date": 1470856349, "answer_id": 38881735, "question_id": 35462043, "link": "https://stackoverflow.com/questions/35462043/rails-error-form-fields-validation-css-and-semantic-ui/38881735#38881735", "title": "Rails error form fields validation css and semantic-ui", "body": "<p>I also had this problem and found zero convenient solutions to it.</p>\n\n<p>Solved it by doing the following things:</p>\n\n<p>First of all, in any view I want to have the error class applied to the <code>.fields</code> div I've added the following line at the end:</p>\n\n<p><strong>new.html.erb</strong> (for example)</p>\n\n<pre><code>&lt;%= render partial: 'shared/fields_error_class', locals: {model: @user} %&gt;\n</code></pre>\n\n<p>Next, create the following partial: <strong>/shared/_fields_error_class.html.erb</strong>:</p>\n\n<pre><code>&lt;% class_name = model.class.name.downcase %&gt;\n&lt;% field_selectors = [] %&gt;\n&lt;% model.errors.keys.each do |field| %&gt;\n    &lt;% field_selectors.push \"##{class_name}_#{field}\" if model.errors[field].any? %&gt;\n&lt;% end %&gt;\n\n&lt;%= javascript_tag do %&gt;\n    $(\"&lt;%= field_selectors.join(',') %&gt;\").parents('.field').addClass('error');\n&lt;% end %&gt;\n</code></pre>\n\n<p>I hope my solution is self explanatory and will help others who struggle with semantic-ui and rails.</p>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 5308751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6019ff43b0bbd60b0cd6f7b1e9a37017?s=128&d=identicon&r=PG&f=1", "display_name": "BarrieH", "link": "https://stackoverflow.com/users/5308751/barrieh"}, "is_accepted": false, "score": 0, "last_activity_date": 1523437504, "last_edit_date": 1523437504, "creation_date": 1523428062, "answer_id": 49767966, "question_id": 35462043, "link": "https://stackoverflow.com/questions/35462043/rails-error-form-fields-validation-css-and-semantic-ui/49767966#49767966", "title": "Rails error form fields validation css and semantic-ui", "body": "<p>For Rails 5 and HTML5 <strong>without</strong> JQuery, replace the partial in the original solution with:</p>\n\n<pre><code>&lt;% class_name = model.class.name.downcase %&gt;\n&lt;% model.errors.keys.each do |field| %&gt;\n    &lt;% if model.errors[field].any? %&gt;\n      &lt;%= javascript_tag do %&gt;\n        document.getElementById('&lt;%= \"#{class_name}_#{field}\" %&gt;').parentElement.parentElement.classList.add('error');\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Also, add the following file to Rails 5:</p>\n\n<pre><code># initializers/customize_errors.rb\nActionView::Base.field_error_proc = Proc.new do |html_tag, instance_tag|\n  # gets rid of field_with_errors div being applied to fields\n  html_tag\nend\n</code></pre>\n"}], "owner": {"reputation": 3411, "user_id": 294022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsrDd.jpg?s=128&g=1", "display_name": "GorillaApe", "link": "https://stackoverflow.com/users/294022/gorillaape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 38881735, "answer_count": 2, "score": 2, "last_activity_date": 1523437504, "creation_date": 1455725668, "last_edit_date": 1592644375, "question_id": 35462043, "link": "https://stackoverflow.com/questions/35462043/rails-error-form-fields-validation-css-and-semantic-ui", "title": "Rails error form fields validation css and semantic-ui", "body": "<p>I am facing a problem with errors during form validation.</p>\n<h2>How semantic-ui shows errors</h2>\n<pre><code> &lt;div class=&quot;field error&quot;&gt;\n    &lt;label&gt;Gender&lt;/label&gt;\n    &lt;div class=&quot;ui selection dropdown&quot;&gt;\n      &lt;div class=&quot;default text&quot;&gt;Select&lt;/div&gt;\n      &lt;i class=&quot;dropdown icon&quot;&gt;&lt;/i&gt;\n      &lt;input type=&quot;hidden&quot; name=&quot;gender&quot;&gt;\n      &lt;div class=&quot;menu&quot;&gt;\n        &lt;div class=&quot;item&quot; data-value=&quot;male&quot;&gt;Male&lt;/div&gt;\n        &lt;div class=&quot;item&quot; data-value=&quot;female&quot;&gt;Female&lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>\n<p>As you can see it places <code>.error</code>css class at the container.</p>\n<h2>How rails shows errors</h2>\n<pre><code>Proc.new do |html_tag, instance|\n  %Q(&lt;div class=&quot;field_with_errors&quot;&gt;#{html_tag}&lt;/div&gt;).html_safe\nend\n</code></pre>\n<p>Rails wraps the form field (input,textarea,select etc) with a div with <code>field_with_errors</code> class.</p>\n<p>Even customizing this at app.config I see no way changing the parent's css. Is there is any workaround for this ?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 78237, "user_id": 2025923, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zYYVM.png?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2025923/tushar"}, "edited": false, "score": 2, "creation_date": 1455725769, "post_id": 35462038, "comment_id": 58620196, "body": "How are you getting the result? You need to get the first captured group"}, {"owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 4, "creation_date": 1455725776, "post_id": 35462038, "comment_id": 58620202, "body": "The purpose of a non-capturing group is to group things without generating a capture, but not to remove the matched substring from the global match."}, {"owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "edited": false, "score": 1, "creation_date": 1455725863, "post_id": 35462038, "comment_id": 58620271, "body": "It is working if you properly fetch <a href=\"http://rubular.com/r/6NcnBGTEwy\" rel=\"nofollow noreferrer\">rubular.com/r/6NcnBGTEwy</a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1455726139, "post_id": 35462038, "comment_id": 58620460, "body": "A regex does not do anything by itself. How are you using the regex? Splitting the string with it? Substituting some parts of the string with it?"}, {"owner": {"reputation": 9006, "user_id": 2805376, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/gTE7F.jpg?s=128&g=1", "display_name": "Shafizadeh", "link": "https://stackoverflow.com/users/2805376/shafizadeh"}, "edited": false, "score": 0, "creation_date": 1455726217, "post_id": 35462038, "comment_id": 58620517, "body": "What exactly do you need to get of this: <code>id&#47;number&#47;2000GXZ2&#47;ref=sr</code>? (which part)"}], "answers": [{"tags": [], "owner": {"reputation": 631, "user_id": 5585943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a364cbb3ba5972c13ec5440c1113c9ed?s=128&d=identicon&r=PG&f=1", "display_name": "jacob.mccrumb", "link": "https://stackoverflow.com/users/5585943/jacob-mccrumb"}, "is_accepted": true, "score": 12, "last_activity_date": 1455727920, "creation_date": 1455727920, "answer_id": 35462854, "question_id": 35462038, "link": "https://stackoverflow.com/questions/35462038/ruby-regular-expression-non-capture-group/35462854#35462854", "title": "Ruby regular expression non capture group", "body": "<p>As mentioned by others, non-capturing groups still count towards the overall match. If you don't want that part in your match use a lookbehind.\n<a href=\"http://rubular.com/r/kY1Dib5AYv\" rel=\"noreferrer\">Rubular example</a></p>\n\n<pre><code>(?&lt;=id\\/number\\/)([a-zA-Z0-9]{8})\n</code></pre>\n\n<blockquote>\n  <p>(?&lt;=pat) - Positive lookbehind assertion: ensures that the preceding characters match pat, but doesn't include those characters in the matched text</p>\n</blockquote>\n\n<p><a href=\"http://ruby-doc.org/core-2.1.0/Regexp.html\" rel=\"noreferrer\">Ruby Doc Regexp</a></p>\n\n<p>Also, the capture group around the id number is unnecessary in this case.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 1954572, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f096a7e09f222b100a5eaeb95bf459c8?s=128&d=identicon&r=PG", "display_name": "AKarpun", "link": "https://stackoverflow.com/users/1954572/akarpun"}, "edited": false, "score": 0, "creation_date": 1455999953, "post_id": 35467069, "comment_id": 58746610, "body": "Wow, thank you for such thoroughful answer. Much apreciate it !"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1575758400, "last_edit_date": 1575758400, "creation_date": 1455740947, "answer_id": 35467069, "question_id": 35462038, "link": "https://stackoverflow.com/questions/35462038/ruby-regular-expression-non-capture-group/35467069#35467069", "title": "Ruby regular expression non capture group", "body": "<p>You have:</p>\n\n<pre><code>str = \"id/number/2000GXZ2/ref=sr\"\n\nr = /\n    (?:id\\/number\\/) # match string in a non-capture group\n    ([a-zA-Z0-9]{8}) # match character in character class 8 times, in capture group 1\n    /x               # extended/free-spacing regex definition mode\n</code></pre>\n\n<p>Then (using <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">String#[]</a>):</p>\n\n<pre><code>str[r]\n  #=&gt; \"id/number/2000GXZ2\"\n</code></pre>\n\n<p>returns the entire match, as it should, not just the contents of capture group 1. There are a few ways to remedy this. Consider first ones that do not use a capture group.</p>\n\n<p>@jacob.m suggested putting the first part in a positive lookbehind (modified slightly from his code):</p>\n\n<pre><code>r = /\n    (?&lt;=id\\/number\\/) # match string in positive lookbehind\n    [[:alnum:]]{8}    # match &gt;= 1 alphameric characters\n    /x\n\nstr[r]\n  #=&gt; \"2000GXZ2\"\n</code></pre>\n\n<p>An alternative is:</p>\n\n<pre><code>r = /\n    id\\/number\\/   # match string\n    \\K             # forget everything matched so far\n    [[:alnum:]]{8} # match 8 alphanumeric characters\n    /x\n\nstr[r]\n  #=&gt; \"2000GXZ2\"\n</code></pre>\n\n<p><code>\\K</code> is especially useful when the match to forget is variable-length, as (in Ruby) positive lookbehinds do not work with variable-length matches.</p>\n\n<p>With both of these approaches, if the part to be matched contains only numbers and capital letters, you may want to use <code>[A-Z0-9]+</code> instead of <code>[[:alnum:]]</code> (though the latter includes Unicode letters, not just those from the English alphabet). In fact, if all the entries have the form of your example, you might be able to use:</p>\n\n<pre><code>r = /\n    \\d          # match a digit\n    [A-Z0-9]{7} # match &gt;= 0 capital letters or digits\n    /x\n\nstr[r]\n  #=&gt; \"2000GXZ2\"\n</code></pre>\n\n<p>The other line of approach is to keep your capture group. One simple way is:</p>\n\n<pre><code>r = /\n    id\\/number\\/     # match string\n    ([[:alnum:]]{8}) # match &gt;= 1 alphameric characters in capture group 1\n    /x\n\nstr =~ r\nstr[r, 1] #=&gt; \"2000GXZ2\"\n</code></pre>\n\n<p>Alternatively, you could use <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-sub\" rel=\"nofollow noreferrer\">String#sub</a> to replace the entire string with the contents of the capture group:</p>\n\n<pre><code>r = /\n    id\\/number\\/     # match string\n    ([[:alnum:]]{8}) # match &gt;= 1 alphameric characters in capture group 1\n    .*               # match the remainder of the string\n    /x\n\nstr.sub(r, '\\1')  #=&gt; \"2000GXZ2\"\nstr.sub(r, \"\\\\1\") #=&gt; \"2000GXZ2\" \nstr.sub(r) { $1 } #=&gt; \"2000GXZ2\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5461, "user_id": 3543437, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/947362c9bddd67410a62fe6b02b5487d?s=128&d=identicon&r=PG&f=1", "display_name": "kayleeFrye_onDeck", "link": "https://stackoverflow.com/users/3543437/kayleefrye-ondeck"}, "is_accepted": false, "score": 0, "last_activity_date": 1496710584, "creation_date": 1496710584, "answer_id": 44379838, "question_id": 35462038, "link": "https://stackoverflow.com/questions/35462038/ruby-regular-expression-non-capture-group/44379838#44379838", "title": "Ruby regular expression non capture group", "body": "<p>This is Ruby <code>Regexp</code> <em>expected</em> match consistency evilness. Some <code>Regexp</code>-style methods will return the global-match while others will return specified matches.</p>\n\n<p>In this case, one method we can use to get the behavior you're looking for is <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\"><code>scan</code></a>.</p>\n\n<p>I don't think anyone here actually mentions how to get your <code>Regexp</code> working as <em>you</em> originally intended, which was to get the capture-only match. To do that, you would use the <code>scan</code> method like so with your original pattern:</p>\n\n<p><strong>test_me.rb</strong></p>\n\n<pre><code>test_string=\"id/number/2000GXZ2/ref=sr\"\nresult = test_string.scan(/(?:id\\/number\\/)([a-zA-Z0-9]{8})/)\nputs result\n</code></pre>\n\n<blockquote>\n<pre><code>2000GXZ2\n</code></pre>\n</blockquote>\n\n<p>That said, replacing <code>(?:)</code> with <code>(?&lt;=)</code> for non-capture groups for look-behinds will benefit you both when you use <code>scan</code> as well as other parts of ruby that use <code>Regexp</code>s.</p>\n"}], "owner": {"reputation": 161, "user_id": 1954572, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f096a7e09f222b100a5eaeb95bf459c8?s=128&d=identicon&r=PG", "display_name": "AKarpun", "link": "https://stackoverflow.com/users/1954572/akarpun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6929, "favorite_count": 4, "accepted_answer_id": 35462854, "answer_count": 3, "score": 8, "last_activity_date": 1575758400, "creation_date": 1455725661, "last_edit_date": 1542620456, "question_id": 35462038, "link": "https://stackoverflow.com/questions/35462038/ruby-regular-expression-non-capture-group", "title": "Ruby regular expression non capture group", "body": "<p>I'm trying to grab id number from the string, say</p>\n\n<pre><code>id/number/2000GXZ2/ref=sr\n</code></pre>\n\n<p>using</p>\n\n<pre><code>(?:id\\/number\\/)([a-zA-Z0-9]{8})\n</code></pre>\n\n<p>for some reason non capture group is not worked, giving me:</p>\n\n<pre><code>id/number/2000GXZ2\n</code></pre>\n"}, {"tags": ["ruby", "shopify", "liquid"], "comments": [{"owner": {"reputation": 1978, "user_id": 3802273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MKQQ3.jpg?s=128&g=1", "display_name": "miglio", "link": "https://stackoverflow.com/users/3802273/miglio"}, "edited": false, "score": 0, "creation_date": 1455730318, "post_id": 35461714, "comment_id": 58623271, "body": "yes you can, but using the <a href=\"https://docs.shopify.com/api/reference/product\" rel=\"nofollow noreferrer\">api</a>, not ajax cart."}, {"owner": {"reputation": 820, "user_id": 4700219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1933f817cf197dc14b8de51430da631e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Hein", "link": "https://stackoverflow.com/users/4700219/alexander-hein"}, "reply_to_user": {"reputation": 1978, "user_id": 3802273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MKQQ3.jpg?s=128&g=1", "display_name": "miglio", "link": "https://stackoverflow.com/users/3802273/miglio"}, "edited": false, "score": 0, "creation_date": 1455735612, "post_id": 35461714, "comment_id": 58626376, "body": "Does using the api mean I have to create a shopify app?"}, {"owner": {"reputation": 1978, "user_id": 3802273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MKQQ3.jpg?s=128&g=1", "display_name": "miglio", "link": "https://stackoverflow.com/users/3802273/miglio"}, "edited": false, "score": 0, "creation_date": 1455740474, "post_id": 35461714, "comment_id": 58629539, "body": "yes, you only need to create a private app."}], "owner": {"reputation": 820, "user_id": 4700219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1933f817cf197dc14b8de51430da631e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Hein", "link": "https://stackoverflow.com/users/4700219/alexander-hein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455724816, "creation_date": 1455724816, "question_id": 35461714, "link": "https://stackoverflow.com/questions/35461714/creating-cutom-products-on-the-fly", "title": "creating cutom products on the fly", "body": "<p>I'm builing a product configurator with highly complex \u201cone-of-a-kind\u201d products \nUnfortunately it is not possible for us to use shopify's product variants as we have a huge array of options, quantity discounts etc. </p>\n\n<p>Is there a great way in creating cutom products on the fly?</p>\n\n<p><strong>What we are looking for:</strong> </p>\n\n<ul>\n<li>Create a product on the fly if the user click on the add-to-cart button.    </li>\n<li>Add the custom product to the cart.  </li>\n<li>Don't list the dynamically created products in the admin</li>\n</ul>\n\n<p>So is this possible? Or is there another way</p>\n\n<p>https://jsfiddle.net/ow0g6Lvs/</p>\n\n<p>Thanks.</p>\n\n<p>Regards,</p>\n\n<p>Alex</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1455726844, "post_id": 35461507, "comment_id": 58620976, "body": "What are your current allowed params?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1455727816, "post_id": 35461507, "comment_id": 58621657, "body": "I tried anything but nothing happens!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "edited": false, "score": 0, "creation_date": 1455727477, "post_id": 35462534, "comment_id": 58621420, "body": "Nothing, again: <code>Completed 500 Internal Server Error in 129ms (ActiveRecord: 36.2ms)  ActiveModel::ForbiddenAttributesError - ActiveModel::ForbiddenAttributesError:   activemodel (4.2.5) lib&#47;active_model&#47;forbidden_attributes_protection.rb:21:in </code>sanitize_for_mass_assignment&#39;   activerecord (4.2.5) lib/active_record/attribute_assignment.rb:33:in <code>assign_attributes&#39;</code>"}, {"owner": {"reputation": 1346, "user_id": 484130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bd6aaab7589b8767c019423d72617d9?s=128&d=identicon&r=PG", "display_name": "Francis.TM", "link": "https://stackoverflow.com/users/484130/francis-tm"}, "edited": false, "score": 0, "creation_date": 1455729361, "post_id": 35462534, "comment_id": 58622616, "body": "@JohnSam I have tested and updated the answer, sorry for previous one which I didn&#39;t test it myself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "edited": false, "score": 0, "creation_date": 1455729503, "post_id": 35462534, "comment_id": 58622712, "body": "Dear @Francis.TM, here we are again in trouble. Like before: <code>ActiveModel::ForbiddenAttributesError - ActiveModel::ForbiddenAttributesError:</code>"}, {"owner": {"reputation": 1346, "user_id": 484130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bd6aaab7589b8767c019423d72617d9?s=128&d=identicon&r=PG", "display_name": "Francis.TM", "link": "https://stackoverflow.com/users/484130/francis-tm"}, "edited": false, "score": 0, "creation_date": 1455729909, "post_id": 35462534, "comment_id": 58623009, "body": "@JohnSam I have give a full example that which I have tested."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "edited": false, "score": 0, "creation_date": 1455730536, "post_id": 35462534, "comment_id": 58623402, "body": "Now it works. Thanks, but why I have to use this strange code <code>params.permit(user: [:last_name, :first_name])[&quot;user&quot;]</code>? I can&#39;t use simple and standard <code>def user_params       params.require(:user).permit(user: [:last_name, :first_name])     end</code>??"}, {"owner": {"reputation": 1346, "user_id": 484130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bd6aaab7589b8767c019423d72617d9?s=128&d=identicon&r=PG", "display_name": "Francis.TM", "link": "https://stackoverflow.com/users/484130/francis-tm"}, "edited": false, "score": 0, "creation_date": 1455730685, "post_id": 35462534, "comment_id": 58623491, "body": "@JohnSam Rails 4 don&#39;t let you use form params directly into a db query, you need permit it first. so we need a <code>params.permit</code>, just like a whitelist. detail you can check <a href=\"http://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-permit\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionController/&hellip;</a> ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "edited": false, "score": 0, "creation_date": 1455731519, "post_id": 35462534, "comment_id": 58623998, "body": "How can I check if at least one of them is saved? Other words how can I use the standard: <code>respond_to do |format|       if @user.save.........</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "edited": false, "score": 0, "creation_date": 1455734933, "post_id": 35462534, "comment_id": 58625993, "body": "Dear @Francis.TM, everything works now. Just one question now. How can I group by :lastname, or <code>:firstname</code> and save records with sum of every row grouped by one attribute and an attribute &quot;count&quot; (count column is there already in database, but I need one record total for the same lastname in <code>@users</code>)? Sorry the mess!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "edited": false, "score": 0, "creation_date": 1455740597, "post_id": 35462534, "comment_id": 58629616, "body": "And then a curiosity, instead of save every each per time, how to save one time with a big INSERT query?"}, {"owner": {"reputation": 1346, "user_id": 484130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bd6aaab7589b8767c019423d72617d9?s=128&d=identicon&r=PG", "display_name": "Francis.TM", "link": "https://stackoverflow.com/users/484130/francis-tm"}, "edited": false, "score": 1, "creation_date": 1455768602, "post_id": 35462534, "comment_id": 58640264, "body": "@JohnSam You can see <a href=\"https://www.coffeepowered.net/2009/01/23/mass-inserting-data-in-rails-without-killing-your-performance/\" rel=\"nofollow noreferrer\">coffeepowered.net/2009/01/23/&hellip;</a> for mass inserting information."}], "tags": [], "owner": {"reputation": 1346, "user_id": 484130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bd6aaab7589b8767c019423d72617d9?s=128&d=identicon&r=PG", "display_name": "Francis.TM", "link": "https://stackoverflow.com/users/484130/francis-tm"}, "is_accepted": true, "score": 0, "last_activity_date": 1455732723, "last_edit_date": 1495540765, "creation_date": 1455726975, "answer_id": 35462534, "question_id": 35461507, "link": "https://stackoverflow.com/questions/35461507/multiple-non-nested-model-creation-on-same-page-with-rails-4/35462534#35462534", "title": "Multiple non-nested model creation on same page with Rails 4", "body": "<pre><code>params.permit(:user, array: [\n  :last_name,\n  :first_name,\n])\n</code></pre>\n\n<p>From: <a href=\"https://stackoverflow.com/a/30285592/484130\">https://stackoverflow.com/a/30285592/484130</a></p>\n\n<p>UPDATE:</p>\n\n<pre><code>class FooController &lt; ApplicationController\n\n  def users_params\n    params.permit(user: [:last_name, :first_name])[\"user\"]\n  end\n\n  def some_action\n    @users = Array.new\n\n    users_params.each do |user_params|\n      user = User.new user_params\n      @users.push user if user.save\n    end\n\n    respond_to do |format|\n      format.json { render json: @users }\n    end\n  end\n\n  ....\n\nend\n</code></pre>\n\n<p>This should work.<br>\nAnd sorry for not test it myself..</p>\n\n<p>BTW, gem <code>byebug</code> is your best friend.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 35462534, "answer_count": 1, "score": 1, "last_activity_date": 1455732723, "creation_date": 1455724374, "last_edit_date": 1495541251, "question_id": 35461507, "link": "https://stackoverflow.com/questions/35461507/multiple-non-nested-model-creation-on-same-page-with-rails-4", "title": "Multiple non-nested model creation on same page with Rails 4", "body": "<p>I'm using this good answer:</p>\n\n<p><a href=\"https://stackoverflow.com/a/16920211/4412054\">https://stackoverflow.com/a/16920211/4412054</a></p>\n\n<p>in my project:</p>\n\n<p><strong>_form.html.erb</strong>:</p>\n\n<pre><code>= form_tag({controller: \"users\", action: \"create\"}, remote: true) do\n  %table\n    %tr\n      %td= text_field_tag 'user[][first_name]'\n      %td= text_field_tag 'user[][last_name]'\n\n    %tr.actions\n      %td= submit_tag 'Save'\n      %td= button_tag 'Add new user form', id: 'add_user_form'\n\n    %tr.new_user_row.hidden # hidden class matches the css rule: {display:none;}\n      %td= text_field_tag \"user[][first_name]\"\n      %td= text_field_tag \"user[][last_name]\"\n\n:javascript # jQuery\n  $('#add_user_form').bind('click', function(e) {\n    var row = $('tr.new_user_row').clone().removeClass('hidden new_user_row');\n    $('tr.actions').before(row); # will append the &lt;tr&gt; before the actions\n  });\n</code></pre>\n\n<p>and <strong>UsersController</strong>:</p>\n\n<pre><code>def create\n  params[:user].each do |attr|\n    User.create(attr)\n  end\nend\n</code></pre>\n\n<p>but when I submit it give me this error:</p>\n\n<pre><code>ActiveModel::ForbiddenAttributesError\n</code></pre>\n\n<p>If I disable Rails 4 <code>strong_parameters</code> by <code>config.action_controller.permit_all_parameters = true</code> in <em>config/application.rb</em> it works and save.</p>\n\n<p><strong>How to permit the hash</strong></p>\n\n<p><code>..., \"user\"=&gt;[{\"first_name\"=&gt;\"Name\", \"last_name\"=&gt;\"Last\"}, {\"first_name\"=&gt;\"\", \"last_name\"=&gt;\"\"}],....</code></p>\n\n<p><em>in my controller?</em></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>If I use in Rails console:</p>\n\n<p><code>User.create({\"first_name\"=&gt;\"Name\", \"last_name\"=&gt;\"Last\"})</code></p>\n\n<p>it works!!!</p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>In my controller I have this:</p>\n\n<pre><code>def users_params\n  params.require(:user).permit(:user, array: [:first_name, :last_name])\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 508, "user_id": 5011742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec446968095707a8ce6d14afd529648?s=128&d=identicon&r=PG", "display_name": "apod", "link": "https://stackoverflow.com/users/5011742/apod"}, "edited": false, "score": 0, "creation_date": 1455724632, "post_id": 35461480, "comment_id": 58619306, "body": "Can you please post the error?"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "reply_to_user": {"reputation": 508, "user_id": 5011742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec446968095707a8ce6d14afd529648?s=128&d=identicon&r=PG", "display_name": "apod", "link": "https://stackoverflow.com/users/5011742/apod"}, "edited": false, "score": 0, "creation_date": 1455725336, "post_id": 35461480, "comment_id": 58619871, "body": "undefined local variable or method `destroy&#39; for CommentsController:Class"}, {"owner": {"reputation": 508, "user_id": 5011742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec446968095707a8ce6d14afd529648?s=128&d=identicon&r=PG", "display_name": "apod", "link": "https://stackoverflow.com/users/5011742/apod"}, "edited": false, "score": 0, "creation_date": 1455725642, "post_id": 35461480, "comment_id": 58620102, "body": "Do you have a route for the destroy action?"}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1455725644, "post_id": 35461480, "comment_id": 58620105, "body": "method <code>destroy</code> in <code>CommentsController</code> is instance method, so did you call it like this? <code>CommentsController.new.destroy</code>"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455726061, "post_id": 35461480, "comment_id": 58620417, "body": "nope, i don&#39;t have a route for the destroy action. it is nested under the Posts controller. resources :posts do      resources :comments   end"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455726096, "post_id": 35461480, "comment_id": 58620436, "body": "i called it using @comment.destroy"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1455726441, "post_id": 35461480, "comment_id": 58620687, "body": "Are you sure the error refers to that line?"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455726533, "post_id": 35461480, "comment_id": 58620755, "body": "not quite sure, it occurs everytime i click the delete link."}, {"owner": {"reputation": 782, "user_id": 2238713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f19eba539dc6f2638b843c3c0bf31c?s=128&d=identicon&r=PG", "display_name": "Jim Edelstein", "link": "https://stackoverflow.com/users/2238713/jim-edelstein"}, "edited": false, "score": 0, "creation_date": 1455758942, "post_id": 35461480, "comment_id": 58637591, "body": "Can you also post the view where these partials are used? The error suggests that the comment you are looking for with Comment.find is not being found, hence you can&#39;t call destroy on it."}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455793714, "post_id": 35461480, "comment_id": 58653207, "body": "ill just give a link to my repository. thanks in advance <a href=\"https://github.com/ridata14/BlogApp\" rel=\"nofollow noreferrer\">github.com/ridata14/BlogApp</a>"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "reply_to_user": {"reputation": 782, "user_id": 2238713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f19eba539dc6f2638b843c3c0bf31c?s=128&d=identicon&r=PG", "display_name": "Jim Edelstein", "link": "https://stackoverflow.com/users/2238713/jim-edelstein"}, "edited": false, "score": 0, "creation_date": 1455794265, "post_id": 35461480, "comment_id": 58653545, "body": "@JimEdelstein Im also thinking about that, maybe something wrong with my Delete link. I am passing it to [comment.post, comment] I&#39;m pretty unsure with this variables."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455727261, "post_id": 35462547, "comment_id": 58621272, "body": "i think i get your point. I can create and view my posts in my page, meaning that I have successfully instantiated a comment. kinda weird though, coz this is the same exact code from one of the rails tutorials."}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "reply_to_user": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455727455, "post_id": 35462547, "comment_id": 58621401, "body": "@StormTrooper What is in <code>ApplicationController</code> or did you create instance of <code>CommentsController </code> somewere? I rly try to figure this out what is going on here:D"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455727780, "post_id": 35462547, "comment_id": 58621623, "body": "CommentController stated above, nothing relevant inside ApplicationController, just some devise stuff and all."}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "reply_to_user": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455727978, "post_id": 35462547, "comment_id": 58621772, "body": "@StormTrooper and are you create instance of  <code>CommentsController</code> ? Or did you say that <code>destroy</code> method is class method?"}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "reply_to_user": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455728662, "post_id": 35462547, "comment_id": 58622185, "body": "@StormTrooper Sou you need to create new instance or set <code>destroy</code> to class method. Try it in code."}], "tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 0, "last_activity_date": 1455727012, "creation_date": 1455727012, "answer_id": 35462547, "question_id": 35461480, "link": "https://stackoverflow.com/questions/35461480/undefined-local-variable-or-method-destroy-for-commentscontrollerclass-in-my/35462547#35462547", "title": "undefined local variable or method `destroy&#39; for CommentsController:Class in my destroy comment method", "body": "<p>Maybe i miss the point, but you can't call instance method without define it like class method or without create instance.</p>\n\n<p>The error</p>\n\n<blockquote>\n  <p>undefined local variable or method `destroy' for CommentsController:Class</p>\n</blockquote>\n\n<p>so if you call <code>CommentsController.destroy</code>, you call instance method <code>destroy</code> with no instance, so this generates error.</p>\n\n<p>is same like this case</p>\n\n<pre><code>class Foo\n  def destroy\n    puts \"destroy\"\n  end\nend\n\nFoo.destroy\n#=&gt; NoMethodError: undefined method `destroy' for Foo:Class\n</code></pre>\n\n<p>But you can do this</p>\n\n<pre><code>class Bar\n  def self.destroy\n    puts \"destroy\"\n  end\nend\n\nBar.destroy\n# =&gt; \"destroy\"\n</code></pre>\n\n<p>or call it like this</p>\n\n<pre><code>Foo.new.destroy\n# =&gt; \"destroy\"\n</code></pre>\n\n<p>Am i wrong?</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455795070, "post_id": 35479944, "comment_id": 58654085, "body": "thanks for looking into this. tried running this snippet. since my comment is nested under the posts controller. Instead of comment_path(comment), I used post_comment_path(comment) ... the error returned was this...  &quot;No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;comments&quot;, :id=&gt;nil, ...**some comment parameters*** missing required keys: [:id]&quot;"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455795459, "post_id": 35479944, "comment_id": 58654342, "body": "Please give &#39;method: :delete&#39; to go to destroy action, if not given it goes to show action.                                                                                                  You have destroy method in comments controller?"}, {"owner": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "edited": false, "score": 0, "creation_date": 1455795699, "post_id": 35479944, "comment_id": 58654507, "body": "give the output of rake routes"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455795728, "post_id": 35479944, "comment_id": 58654524, "body": "yes i did that, sorry for not posting the full syntax. this is the code that i ran. &lt;%= link_to &#39;Delete&#39;, post_comment_path(comment),                \t\t\t\tmethod: :delete,                 \t\t\t\tclass: &#39;delete-link&#39;  %&gt; ...same outcome. No route matches."}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "reply_to_user": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "edited": false, "score": 0, "creation_date": 1455795858, "post_id": 35479944, "comment_id": 58654613, "body": "@Dias here&#39;s my routes output. <a href=\"https://gist.github.com/ridata14/167a0eeae0031a09c81c\" rel=\"nofollow noreferrer\">gist.github.com/ridata14/167a0eeae0031a09c81c</a>"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1455796002, "post_id": 35479944, "comment_id": 58654692, "body": "I have changed the ans and added some code in destroy method, please try that."}, {"owner": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "reply_to_user": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455796175, "post_id": 35479944, "comment_id": 58654801, "body": "@StormTrooper are you getting now comment id as params"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455796446, "post_id": 35479944, "comment_id": 58654961, "body": "@Sravan tried the code. error &quot;undefined method `    &#39; for #&lt;CommentsController:0x007f65ee90efb0&gt;&quot; shows up and its pointing out to the @comment = @post.comments.find(params[:id]) line."}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1455796562, "post_id": 35479944, "comment_id": 58655031, "body": "I think your post must have got deleted which is giving the error.Please check the render text: @post and check it"}, {"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455800544, "post_id": 35479944, "comment_id": 58657855, "body": "my post is still there, I can view it together with its comments. my only problem is deleting a comment. which leads to the error(s) stated above."}], "tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": false, "score": 0, "last_activity_date": 1455795973, "last_edit_date": 1455795973, "creation_date": 1455794246, "answer_id": 35479944, "question_id": 35461480, "link": "https://stackoverflow.com/questions/35461480/undefined-local-variable-or-method-destroy-for-commentscontrollerclass-in-my/35479944#35479944", "title": "undefined local variable or method `destroy&#39; for CommentsController:Class in my destroy comment method", "body": "<p>Try to send the comment object along with the destroy method as a paramete, so that the controller recognizes it.</p>\n\n<p>You have to get the post of that article and delete the comment according to the link i have given.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code> def destroy\r\n   @post = Post.find(params[:post_id])\r\n   @comment = @post.comments.find(params[:id])\r\n   @comment.destroy\r\n   redirect_to post_path(@post)\r\n end</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;%= link_to 'Destroy Comment', [comment.post, comment],\r\n               method: :delete,\r\n               data: { confirm: 'Are you sure?' } %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">For help refer to this guide in delete section</a></p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "edited": false, "score": 0, "creation_date": 1455801714, "post_id": 35480589, "comment_id": 58658782, "body": "this is also outputting an error that my @comment = @post.comments.find(params[:id]) line has an undefined method."}], "tags": [], "owner": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "is_accepted": false, "score": 0, "last_activity_date": 1455795942, "creation_date": 1455795942, "answer_id": 35480589, "question_id": 35461480, "link": "https://stackoverflow.com/questions/35461480/undefined-local-variable-or-method-destroy-for-commentscontrollerclass-in-my/35480589#35480589", "title": "undefined local variable or method `destroy&#39; for CommentsController:Class in my destroy comment method", "body": "<p>should pass post object in the path since comments resource is nested under posts</p>\n\n<pre><code>&lt;%= link_to 'Delete', post_comment_path(post, comment), method: :delete, class: 'delete-link' %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 782, "user_id": 2238713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f19eba539dc6f2638b843c3c0bf31c?s=128&d=identicon&r=PG", "display_name": "Jim Edelstein", "link": "https://stackoverflow.com/users/2238713/jim-edelstein"}, "is_accepted": false, "score": 1, "last_activity_date": 1455913868, "creation_date": 1455913868, "answer_id": 35514450, "question_id": 35461480, "link": "https://stackoverflow.com/questions/35461480/undefined-local-variable-or-method-destroy-for-commentscontrollerclass-in-my/35514450#35514450", "title": "undefined local variable or method `destroy&#39; for CommentsController:Class in my destroy comment method", "body": "<p>OK, I looked at the repo. You have a comments table but no model.  <code>rails generate model Comment</code></p>\n"}], "owner": {"reputation": 65, "user_id": 3772273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VVDLn.jpg?s=128&g=1", "display_name": "StormTrooper", "link": "https://stackoverflow.com/users/3772273/stormtrooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1455913868, "creation_date": 1455724298, "last_edit_date": 1455793791, "question_id": 35461480, "link": "https://stackoverflow.com/questions/35461480/undefined-local-variable-or-method-destroy-for-commentscontrollerclass-in-my", "title": "undefined local variable or method `destroy&#39; for CommentsController:Class in my destroy comment method", "body": "<p>I've added a comment feature in my app and so far everything's working fine until this error came up. What I did is that I added a delete comment feature. Everything shows normal when I fire up the server, but the problem comes in after I click the 'delete' button.</p>\n\n<p>Error message</p>\n\n<blockquote>\n  <p>undefined local variable or method `destroy' for CommentsController:Class</p>\n</blockquote>\n\n<p>Anyway, here's my code.</p>\n\n<p>Comments controller</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @post = Post.find(params[:post_id])\n    @comment = @post.comments.create(comments_params)\n    redirect_to post_path(@post)\n  end\n\n  def destroy\n    @comment = Comment.find(params[:id])\n    @comment.destroy\n    #redirect_to post_path(@post)\n  end\n\n  private\n\n  def comments_params\n    params.require(:comment).permit(:body, :commenter, :user_id)\n  end\nend\n</code></pre>\n\n<p>Comment view partial</p>\n\n<pre><code>&lt;div class='row'&gt;\n    &lt;div class='comments col-md-6'&gt;\n        &lt;p&gt;\n        \u00a0\u00a0&lt;b&gt;&lt;%= comment.commenter %&gt;:&lt;/b&gt;\n        \u00a0\u00a0&lt;p&gt;&lt;span&gt;&lt;%= comment.body %&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;/p&gt;\n\n        &lt;%= button_to 'Delete', [comment.post, comment],\n               method: :delete, data: { confirm: 'Are you sure?' }  %&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Comment form</p>\n\n<pre><code>&lt;div class='form-group col-md-5'&gt;\n\n&lt;%= form_for([@posts, @posts.comments.build]) do |f| %&gt;\n\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label 'Add a comment' %&gt;&lt;br&gt;\n        &lt;%= f.text_area :body, class: 'form-control', rows: '3' %&gt;\n    &lt;/div&gt;\n      &lt;%= f.hidden_field :commenter, value: current_user.name %&gt;\n      &lt;%= f.hidden_field :user_id, value: current_user.id %&gt;\n    &lt;div class=\"actions\"&gt;\n        &lt;%= f.submit %&gt;\n        &lt;div class='back-button'&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>help would be greatly appreciated!</p>\n\n<p>UPDATE:</p>\n\n<p>This is the link to my github repo. just in case anyone would like to tinker on it.</p>\n\n<p><a href=\"https://github.com/ridata14/BlogApp\" rel=\"nofollow\">https://github.com/ridata14/BlogApp</a></p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455742753, "post_id": 35461587, "comment_id": 58630801, "body": "You could use three dots: <code>syms[0...syms.index(:FIVE)]</code>."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1455724545, "creation_date": 1455724545, "answer_id": 35461587, "question_id": 35461448, "link": "https://stackoverflow.com/questions/35461448/get-everything-before-a-certain-symbol-in-a-array-of-symbols/35461587#35461587", "title": "Get everything before a certain symbol in a array of symbols", "body": "<pre><code>syms = [:ONE,:TWO,:THREE,:FOUR,:FIVE,:SIX,:SEVEN,:EIGHT]\nsyms[0..(syms.index(:FIVE) - 1)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 0, "last_activity_date": 1455724575, "creation_date": 1455724575, "answer_id": 35461599, "question_id": 35461448, "link": "https://stackoverflow.com/questions/35461448/get-everything-before-a-certain-symbol-in-a-array-of-symbols/35461599#35461599", "title": "Get everything before a certain symbol in a array of symbols", "body": "<pre><code>a = [:ONE,:TWO,:THREE,:FOUR,:FIVE,:SIX,:SEVEN,:EIGHT]\na.map.with_index{|x,i| i &lt; a.index(:FIVE) ? x : nil}.compact\n# =&gt; [:ONE, :TWO, :THREE, :FOUR]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 2, "creation_date": 1455724969, "post_id": 35461752, "comment_id": 58619584, "body": "This is very elegant. +1"}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 6, "last_activity_date": 1455724898, "creation_date": 1455724898, "answer_id": 35461752, "question_id": 35461448, "link": "https://stackoverflow.com/questions/35461448/get-everything-before-a-certain-symbol-in-a-array-of-symbols/35461752#35461752", "title": "Get everything before a certain symbol in a array of symbols", "body": "<pre><code>syms = [:ONE,:TWO,:THREE,:FOUR,:FIVE,:SIX,:SEVEN,:EIGHT]\nsyms.slice_before(:FIVE).first #=&gt; [:ONE, :TWO, :THREE, :FOUR]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1455743872, "last_edit_date": 1455743872, "creation_date": 1455742609, "answer_id": 35467578, "question_id": 35461448, "link": "https://stackoverflow.com/questions/35461448/get-everything-before-a-certain-symbol-in-a-array-of-symbols/35467578#35467578", "title": "Get everything before a certain symbol in a array of symbols", "body": "<pre><code>arr = [:ONE,:TWO,:THREE,:FOUR,:FIVE,:SIX,:SEVEN]\n</code></pre>\n\n<p><strong>#1 Use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-first\" rel=\"nofollow\">Array#first</a> with an argument and <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-index\" rel=\"nofollow\">Array#index</a></strong></p>\n\n<pre><code>arr.first(a.index(:FIVE))\n  #=&gt; [:ONE, :TWO, :THREE, :FOUR]\n</code></pre>\n\n<p><strong>#2 Use Ruby's <a href=\"http://nithinbekal.com/posts/ruby-flip-flop\" rel=\"nofollow\">flip-flop operator</a></strong></p>\n\n<pre><code>arr.select { |sym| true unless sym==:FIVE..false }\n  #=&gt; [:ONE, :TWO, :THREE, :FOUR] \n</code></pre>\n"}], "owner": {"reputation": 296, "user_id": 1165357, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68ede82c102ee5152a456d3e621898f0?s=128&d=identicon&r=PG", "display_name": "CocoaBean", "link": "https://stackoverflow.com/users/1165357/cocoabean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 35461752, "answer_count": 4, "score": 2, "last_activity_date": 1455743872, "creation_date": 1455724202, "question_id": 35461448, "link": "https://stackoverflow.com/questions/35461448/get-everything-before-a-certain-symbol-in-a-array-of-symbols", "title": "Get everything before a certain symbol in a array of symbols", "body": "<p>Let's say I would have a array of symbols, like:</p>\n\n<pre><code>[:ONE,:TWO,:THREE,:FOUR,:FIVE,:SIX,:SEVEN,:EIGHT]\n</code></pre>\n\n<p>How can I get, for example, everything before <code>:FIVE</code>?</p>\n\n<p>The expected result of the example would be <code>[:ONE,:TWO,:THREE,:FOUR]</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1455723843, "creation_date": 1455723843, "answer_id": 35461306, "question_id": 35461218, "link": "https://stackoverflow.com/questions/35461218/how-to-exclude-a-certain-selection-from-a-collection-select-list/35461306#35461306", "title": "How to exclude a certain selection from a collection_select list?", "body": "<p>You might pass to collection_select something like</p>\n\n<pre><code>@colleagues.reject {|user| user.id == current_user.id }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "is_accepted": false, "score": 3, "last_activity_date": 1455723890, "creation_date": 1455723890, "answer_id": 35461327, "question_id": 35461218, "link": "https://stackoverflow.com/questions/35461218/how-to-exclude-a-certain-selection-from-a-collection-select-list/35461327#35461327", "title": "How to exclude a certain selection from a collection_select list?", "body": "<pre><code>@colleagues = User.where(business_id: current_user.business_id).where.not(id: current_user.id)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1724, "user_id": 2046428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b0dd872a8540848d292a237714394a?s=128&d=identicon&r=PG", "display_name": "Sajidur Rahman", "link": "https://stackoverflow.com/users/2046428/sajidur-rahman"}, "is_accepted": false, "score": 0, "last_activity_date": 1568020708, "creation_date": 1568020708, "answer_id": 57851091, "question_id": 35461218, "link": "https://stackoverflow.com/questions/35461218/how-to-exclude-a-certain-selection-from-a-collection-select-list/57851091#57851091", "title": "How to exclude a certain selection from a collection_select list?", "body": "<p>This code works for me in rails 6.0.0</p>\n\n<pre><code>form.collection_select :parent_id, Collection.all.where.not(id: collection.id), :id, :title\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 5701051, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a84ab02fcf8603703392942ccc2cdcaa?s=128&d=identicon&r=PG&f=1", "display_name": "S Craig", "link": "https://stackoverflow.com/users/5701051/s-craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "accepted_answer_id": 35461306, "answer_count": 3, "score": 0, "last_activity_date": 1568020708, "creation_date": 1455723632, "question_id": 35461218, "link": "https://stackoverflow.com/questions/35461218/how-to-exclude-a-certain-selection-from-a-collection-select-list", "title": "How to exclude a certain selection from a collection_select list?", "body": "<p>Simply I have a <code>collection_select</code> which allows a user to select any users that share the same <code>business.id</code>. It uses the list <code>@colleagues</code> created in Ruby:</p>\n\n<pre><code>#events_controller#new\n@colleagues = User.where(business_id: current_user.business_id)\n\n\n#events/new.html.erb\n&lt;%= f.collection_select :id,\n                        @colleagues,\n                        :id,\n                        :full_name %&gt;\n</code></pre>\n\n<p>But at the moment, this list <strong>includes</strong> the <code>current_user</code>, which I do not want to happen (the user should <em>not</em> be able to select them self). <strong>Is there a way I can exclude the <code>current_user</code> from this list from querying the database?</strong> I am using SQLite. </p>\n\n<p>Thank you, and any further explanation would be much appreciated as I am new to Ruby and SQL.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 1, "creation_date": 1455723234, "post_id": 35460923, "comment_id": 58618170, "body": "you initialize <code>all_tasks</code> when you make a new list, but when you call <code>all_tasks</code> in the <code>write_to_file</code> method...well take a look.  there needs to be some connection between those two objects and there isn&#39;t.  I understand what you are trying to do here, but maybe you&#39;re trying to run before you walk."}, {"owner": {"reputation": 232, "user_id": 5817240, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6ff1678916582d985fae676bed69f285?s=128&d=identicon&r=PG&f=1", "display_name": "Turk", "link": "https://stackoverflow.com/users/5817240/turk"}, "edited": false, "score": 0, "creation_date": 1455723247, "post_id": 35460923, "comment_id": 58618175, "body": "Why is there not an &quot;@&quot; sign in front of the all_tasks arrays in the methods?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 2465549, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e45075a5a7c47159933e705c8b477d62?s=128&d=identicon&r=PG", "display_name": "sneakycrow", "link": "https://stackoverflow.com/users/2465549/sneakycrow"}, "edited": false, "score": 0, "creation_date": 1455743865, "post_id": 35461078, "comment_id": 58631397, "body": "The write_to_file method isn&#39;t in the module Menu. How is it part of it?"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1455723271, "creation_date": 1455723271, "answer_id": 35461078, "question_id": 35460923, "link": "https://stackoverflow.com/questions/35460923/array-exists-but-items-arent-being-pushed-into-it/35461078#35461078", "title": "Array exists but items aren&#39;t being pushed into it", "body": "<p><code>write_to_file</code> is a method of the module Menu but Menu isn't mixed-in in List, it doesn't know about <code>all_tasks</code>. Also, this line</p>\n\n<pre><code>if all_tasks == nil\n</code></pre>\n\n<p>in Ruby is written like</p>\n\n<pre><code>if all_tasks.nil?\n</code></pre>\n\n<p>or</p>\n\n<pre><code>unless all_tasks\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4336, "user_id": 574181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c78d396646e7612dead8bcd7c63a4fe?s=128&d=identicon&r=PG", "display_name": "Satya", "link": "https://stackoverflow.com/users/574181/satya"}, "is_accepted": false, "score": 0, "last_activity_date": 1455723319, "creation_date": 1455723319, "answer_id": 35461097, "question_id": 35460923, "link": "https://stackoverflow.com/questions/35460923/array-exists-but-items-arent-being-pushed-into-it/35461097#35461097", "title": "Array exists but items aren&#39;t being pushed into it", "body": "<p><code>attr_accessor</code> just makes two methods, a getter and a setter. When you do <code>all_tasks &lt;&lt; task</code>, the getter is called, and returns the current value of @all_tasks, an anonymous array. Then <code>task</code> is added to that array. (The array is implicitly returned from <code>add</code> but I think that won't help.) Notice that @all_tasks was not modified.</p>\n\n<p>You could do this:</p>\n\n<pre><code>all_tasks = all_tasks &lt;&lt; task\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 2465549, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e45075a5a7c47159933e705c8b477d62?s=128&d=identicon&r=PG", "display_name": "sneakycrow", "link": "https://stackoverflow.com/users/2465549/sneakycrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1455744374, "creation_date": 1455744374, "answer_id": 35468086, "question_id": 35460923, "link": "https://stackoverflow.com/questions/35460923/array-exists-but-items-arent-being-pushed-into-it/35468086#35468086", "title": "Array exists but items aren&#39;t being pushed into it", "body": "<p>The problem, thanks to @dax, was that <code>write_to_file</code> method was called without calling the array to call it to.</p>\n\n<p>Instead of <code>write_to_file</code> in the <code>'write'</code> case it should've been <code>my_list.write_to_file</code></p>\n"}], "owner": {"reputation": 67, "user_id": 2465549, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e45075a5a7c47159933e705c8b477d62?s=128&d=identicon&r=PG", "display_name": "sneakycrow", "link": "https://stackoverflow.com/users/2465549/sneakycrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455744374, "creation_date": 1455722921, "question_id": 35460923, "link": "https://stackoverflow.com/questions/35460923/array-exists-but-items-arent-being-pushed-into-it", "title": "Array exists but items aren&#39;t being pushed into it", "body": "<p>So, here's my issue. When I create a new List class at the beginning of the program runner, it's supposed to create a new array (<code>all_tasks</code>). Each time I add a new task, the task should be pushed to the array. Then, when I show the array, it should list each task. </p>\n\n<p>The issue is when I use the <code>write_to_file</code> method. I get an error <code>Undefined local variable or method 'all_tasks'</code>. I made another method case in where I can look at the array, and it doesn't look like the new tasks are being pushed into the array. Yet, when I use the <code>show_tasks</code> method, it's able to list everything in the array. </p>\n\n<p>If someone could not just grab me a solution but also elaborate a lot, I'd appreciate that. I'm still a beginner with Ruby.</p>\n\n<p>As a side note, the <code>show_tasks</code> method also lists each item in the array twice, once using <code>puts</code> but then again right below it.</p>\n\n<pre><code> ## Classes ##\n\n    #List Class - Used for anything involving the list\n    class List\n      attr_accessor :all_tasks\n      def initialize\n        @all_tasks = Array.new\n      end\n      def add(task)\n        all_tasks &lt;&lt; task\n      end\n      def show_tasks\n        all_tasks.each do |x|\n          puts \"- #{x}\"\n        end\n      end\n    end\n\n    #Task Class - Used for anything involving Tasks\n    class Task\n      attr_reader :description\n      alias to_s description\n      def initialize(description)\n        @description = description\n      end\n    end\n\n    ## Modules ##\n    module Promptable\n      def prompt(message = \"What would you like to do?\", symbol = \"&gt;: \")\n        print \"#{message}\\n\"\n        print symbol\n        gets.chomp\n      end\n      def show_menu\n        menu\n      end\n    end\n\n\n    module Menu\n      def menu\n        puts \"\\nHere's a list of options that you can choose from: \\n\n        'add' - Add a task to the list \\n\n        'write' - Write the list to a file \\n\n        'show' - Shows current tasks in list \\n\n        'q' - Quits from current session \\n\n        \\n Please Select an option\"\n      end\n    end\n\n    #Methods - various methods\n    def desc_to_s\n      description\n    end\n    def write_to_file(filename)\n      if all_tasks == nil\n        puts \"Error - Array is nil\"\n      else\n        IO.write(filename, @all_tasks.map(&amp;:desc_to_s).join(\"\\n\"))\n      end\n    end\n\n    #Program Runner\n    if __FILE__ == $PROGRAM_NAME\n      include Menu\n      include Promptable\n      my_list = List.new\n      puts \"\\nWelcome to do ToDoLoo! Create your ToDo List \\n\"\n      until ['q'].include?(user_input = prompt(show_menu).downcase)\n        case user_input\n          # Developer only controls\n        when 'devshowtask'\n          my_list.each do |x|\n            puts \"#{x}\"\n          end\n        when 'add'\n          my_list.add(Task.new(prompt(\"What task would you like to create?\")))\n        when 'show'\n          puts \"Here's a current list of all your tasks:\\n\"\n          puts my_list.show_tasks\n          prompt(\"Press enter to continue\")\n        when 'menu'\n          prompt(show_menu)\n        when 'write'\n          write_to_file(prompt(\"What would you like to name the file\"))\n        else puts \"\\nThat is not a valid command\"\n        end\n      end\n    end\n</code></pre>\n"}, {"tags": ["ruby", "iteration"], "comments": [{"owner": {"reputation": 7447, "user_id": 602372, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/q6bLu.jpg?s=128&g=1", "display_name": "Yam Marcovic", "link": "https://stackoverflow.com/users/602372/yam-marcovic"}, "edited": false, "score": 2, "creation_date": 1455725895, "post_id": 35460236, "comment_id": 58620295, "body": "Yes. <code>index = i - 45</code>."}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 1, "creation_date": 1455757647, "post_id": 35460236, "comment_id": 58637185, "body": "You are rejecting answers that express the idiomatic Ruby way to do this, and they meet the requirements in the question (&quot;without any external counters&quot;).  Can you please explain why?"}, {"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "edited": false, "score": 2, "creation_date": 1455780080, "post_id": 35460236, "comment_id": 58644725, "body": "Voting to close as unclear because the asker doesn&#39;t specify all of his requirements."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1455724799, "post_id": 35460448, "comment_id": 58619444, "body": "Uhm no. I want to use only step, not .each_with_index. Thanks anyway"}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 1, "creation_date": 1455779750, "post_id": 35460448, "comment_id": 58644566, "body": "As shown by @sawa&#39;s answer (deleted, sadly), #each_with_index can take an offset.  <code>...each_with_index(1) do...</code> would cause <code>index</code> to be 10 on the 10th iteration."}, {"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 1, "creation_date": 1455779879, "post_id": 35460448, "comment_id": 58644627, "body": "@markzzz ... why? Is subtraction disallowed as well?"}], "tags": [], "owner": {"reputation": 7447, "user_id": 602372, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/q6bLu.jpg?s=128&g=1", "display_name": "Yam Marcovic", "link": "https://stackoverflow.com/users/602372/yam-marcovic"}, "is_accepted": true, "score": 5, "last_activity_date": 1455721801, "creation_date": 1455721801, "answer_id": 35460448, "question_id": 35460236, "link": "https://stackoverflow.com/questions/35460236/step-with-index/35460448#35460448", "title": "`step` with index", "body": "<p>I'm not sure about the performance implications here, but you could do something like this:</p>\n\n<pre><code>46.step(127, 1).each_with_index do |i, index|\nend\n</code></pre>\n\n<p>Only, in the 10th iteration <code>index</code> would be 9.</p>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 5938358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd980f4c02d88122d045088ca2eef14?s=128&d=identicon&r=PG&f=1", "display_name": "JonahR", "link": "https://stackoverflow.com/users/5938358/jonahr"}, "is_accepted": false, "score": 0, "last_activity_date": 1455729298, "creation_date": 1455729298, "answer_id": 35463352, "question_id": 35460236, "link": "https://stackoverflow.com/questions/35460236/step-with-index/35463352#35463352", "title": "`step` with index", "body": "<p>Here is some code that should solve your problem.</p>\n\n<pre><code>return_array = []\n46.step(127, 1) do |i|\n    group_array = []\n    group_array &lt;&lt; i\n    return_array &lt;&lt; group_array \n    group_array &lt;&lt; return_array.find_index(group_array) + 1\nend\nreturn_array\n</code></pre>\n\n<p>This will return [ [46, 1], [47, 2], [48, 3], [49, 4], [50, 5], [51, 6], [52, 7], [53, 8], [54, 9], [55, 10], [56, 11], [57, 12], ... , [127, 82] ] </p>\n"}], "owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 1, "accepted_answer_id": 35460448, "answer_count": 2, "score": -1, "last_activity_date": 1455729298, "creation_date": 1455721293, "last_edit_date": 1455722170, "question_id": 35460236, "link": "https://stackoverflow.com/questions/35460236/step-with-index", "title": "`step` with index", "body": "<p>If I have this code:</p>\n\n<pre><code>46.step(127, 1) do |i|\nend\n</code></pre>\n\n<p>can I get, at the 10th iteration, both <code>i = 55</code> and <code>index = 10</code> without any external counters?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "parameters"], "answers": [{"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1455721396, "post_id": 35460207, "comment_id": 58616739, "body": "You&#39;ll need to specify the table name whenever you use the &quot;id&quot; field."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 0, "last_activity_date": 1455721212, "creation_date": 1455721212, "answer_id": 35460207, "question_id": 35460093, "link": "https://stackoverflow.com/questions/35460093/how-do-i-pass-two-or-more-parameters-to-two-different-tables-using-joins-on-ruby/35460207#35460207", "title": "How do i pass two or more parameters to two different tables using Joins on Ruby on rails", "body": "<p>Have you tried something like</p>\n\n<pre><code>@exams = Exam.joins(exam_subjects: :subject).where(:id =&gt; [params[:exam_id], params[:subject_id]])\n</code></pre>\n\n<p>?</p>\n"}, {"tags": [], "owner": {"reputation": 1649, "user_id": 778593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea193e38d766da28584e64c56975ff6?s=128&d=identicon&r=PG", "display_name": "Cloxure", "link": "https://stackoverflow.com/users/778593/cloxure"}, "is_accepted": false, "score": 0, "last_activity_date": 1455721373, "creation_date": 1455721373, "answer_id": 35460258, "question_id": 35460093, "link": "https://stackoverflow.com/questions/35460093/how-do-i-pass-two-or-more-parameters-to-two-different-tables-using-joins-on-ruby/35460258#35460258", "title": "How do i pass two or more parameters to two different tables using Joins on Ruby on rails", "body": "<p>You can use an string as a parameter in the where condition:</p>\n\n<pre><code>@exams = Exam.joins(exam_subjects: :subject).where('id = ? AND exam_id = ?', params[:exam_id], params[:subject_id])\n</code></pre>\n\n<p>Take a look at <a href=\"http://guides.rubyonrails.org/active_record_querying.html#pure-string-conditions\" rel=\"nofollow\"> Pure String Conditions</a> on active record.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5747768"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 35460207, "answer_count": 2, "score": 0, "last_activity_date": 1489416687, "creation_date": 1455720965, "last_edit_date": 1489416687, "question_id": 35460093, "link": "https://stackoverflow.com/questions/35460093/how-do-i-pass-two-or-more-parameters-to-two-different-tables-using-joins-on-ruby", "title": "How do i pass two or more parameters to two different tables using Joins on Ruby on rails", "body": "<p>i have the exams table, the subjects table, and the exam_subjects table. i want to filter lets say by Exam.id and Subject.id on the WHERE how do i pass those parameters.</p>\n\n<pre><code>@exams = Exam.joins(exam_subjects: :subject).where(:exam_id =&gt; params[:exam_id], :subject_id =&gt; params[:subject_id])\n</code></pre>\n"}, {"tags": ["ruby", "optparse"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1455722136, "post_id": 35460060, "comment_id": 58617305, "body": "You can see <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/optparse/rdoc/OptionParser.html#class-OptionParser-label-Type+Coercion\" rel=\"nofollow noreferrer\">here</a> Array&#39;s require comma separated values.  They do say custom coercion&#39;s are coming so maybe in future ruby versions?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1455723572, "post_id": 35460060, "comment_id": 58618438, "body": "It&#39;s common for CLIs to take a list of files as their last argument(s), as described in this answer: <a href=\"http://stackoverflow.com/questions/2449171/how-to-parse-an-argument-without-a-name-with-rubys-optparse\" title=\"how to parse an argument without a name with rubys optparse\">stackoverflow.com/questions/2449171/&hellip;</a> It&#39;s not exactly what you&#39;re asking for, but might that approach work for your application?"}], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 7948068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71dc87adc38b9813f2fc7db09aea190?s=128&d=identicon&r=PG&f=1", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/7948068/kathryn"}, "is_accepted": true, "score": 2, "last_activity_date": 1506365534, "last_edit_date": 1506365534, "creation_date": 1493694170, "answer_id": 43729400, "question_id": 35460060, "link": "https://stackoverflow.com/questions/35460060/list-of-arguments-in-optparse-without-separator/43729400#43729400", "title": "List of arguments in OptParse without separator", "body": "<p>If you don't have option parameters you pass or if all other parameters are optional, you can just pass the files the old-fashioned way: via <code>ARGV</code>. By default, command line options are separated by spaces, not commas.</p>\n\n<p>If you absolutely need to support the <code>-f</code> option, you could add support for <code>ARGV</code> in addition</p>\n\n<pre><code>require \"optparse\"\n\noptions = {\n  :files =&gt; []\n}\nopt_parse = OptionParser.new do |opts|\n  opts.banner = \"Usage: main.rb file(s) ...\"\n\n  opts.on(\"-f\", \"--files file1,file2,...\", Array, \"File(s)\") do |f|\n    options[:files] += f\n  end\n\n  opts.on_tail(\"-h\", \"--help\", \"Show this message\") do\n    puts opts\n    exit\n  end\n\nend\nopt_parse.parse!\n\noptions[:files] += ARGV\n\nif options[:files].length == 0\n  abort(opt_parse.help)\nend\n\nputs options[:files]\n</code></pre>\n\n<p>Using this method, you can even mix both styles:</p>\n\n<pre><code>$ main.rb -f -f file1,file2 file3 -f file4 file5\nfile1\nfile2\nfile4\nfile3\nfile5\n</code></pre>\n\n<p>(Note <code>file5</code> is really being passed via <code>ARGV</code>, but it kinda looks like you are using a space as a separator.)</p>\n"}], "owner": {"reputation": 1439, "user_id": 3909621, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/gWquo.jpg?s=128&g=1", "display_name": "Nicolas Charvoz", "link": "https://stackoverflow.com/users/3909621/nicolas-charvoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 43729400, "answer_count": 1, "score": 2, "last_activity_date": 1506365534, "creation_date": 1455720885, "question_id": 35460060, "link": "https://stackoverflow.com/questions/35460060/list-of-arguments-in-optparse-without-separator", "title": "List of arguments in OptParse without separator", "body": "<p>I'm currently building a simple program which will read and write file on standard output. I want to launch my program this way : <code>ruby main.rb -f file1 file2 file3</code> ...</p>\n\n<p>But with optParse I cannot get this to work I must include separator .. I need optParse because I handle multiple options (like verbose, help ...). So if I do this : <code>ruby main.rb -f file1,file2</code> ... It works</p>\n\n<p>How can I achieve this ?</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1455720161, "post_id": 35459703, "comment_id": 58615779, "body": "You mean <code>@user</code>? You need and accessor, like <code>attr_reader :user</code> (or manually define <code>def user; @user end</code>)"}, {"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "reply_to_user": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1455720640, "post_id": 35459703, "comment_id": 58616174, "body": "could you explain why <code>@user</code> ?"}, {"owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1455720829, "post_id": 35459703, "comment_id": 58616322, "body": "Your title mentions accessing a &quot;class instance variable&quot;, and <code>@user</code> is an instance variable, so I supposed you were asking how to access it outside of <code>PopulateForm</code>. If I made the wrong assumption let me know."}, {"owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 1, "creation_date": 1455721022, "post_id": 35459703, "comment_id": 58616454, "body": "By the way, <i>instance variable</i> and <i>class instance variable</i> are different things. Simplifying things a bit, the latter is a variable of a Class instance (i.e., of some class), while the former is a variable of an Object instance."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1455724307, "post_id": 35459703, "comment_id": 58619044, "body": "There are no class instance variables in the code you posted. Could you please make sure to post the <i>actual</i> code corresponding to your question? Otherwise it is impossible to answer the question."}], "answers": [{"comments": [{"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455721564, "post_id": 35460197, "comment_id": 58616877, "body": "wow that&#39;s a great answer and really simple to follow, thank you"}, {"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455722041, "post_id": 35460197, "comment_id": 58617248, "body": "would you mind explaining the <code>user_details</code> method please, mainly the <code>@user_details ||=</code> thanks"}, {"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455722233, "post_id": 35460197, "comment_id": 58617371, "body": "also i&#39;ve noticed you namespaced the class and not have module &gt; class.. is this a better practice? do i not need to declare a module ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455723016, "post_id": 35460197, "comment_id": 58617991, "body": "I&#39;ve just collapsed the <code>module X class Y</code> definition into <code>class X::Y</code> for brevity here. Generally if you have a <code>module X</code> definition in <code>x.rb</code> and <code>class Y</code> in <code>x&#47;y.rb</code> then the autoloader will figure it out. I find the less nesting you do the better, so I tend to use the shorter method."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455723135, "post_id": 35460197, "comment_id": 58618094, "body": "The Ruby idiom <code>@x ||= y</code> only initializes <code>@x</code> with a value if <code>@x</code> is a non-true boolean value, that is <code>nil</code> or <code>false</code>. It&#39;s often used as a &quot;lazy initializer&quot;, or one that&#39;s generally called once and only once. This one is a little too lazy, you may end up running that query several times if there&#39;s no match, but you can make it less lazy with a bit more work. The example here does the job, though. <code>x ||= y</code> is equivalent to <code>x = x || y</code> or more specifically <code>x = y unless x</code>."}, {"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455723380, "post_id": 35460197, "comment_id": 58618300, "body": "wow, are you available as a mentor, you&#39;re explanations are great :-) thanks again"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455728340, "post_id": 35460197, "comment_id": 58621992, "body": "I try and you&#39;re welcome! I&#39;ve been considering making use of <a href=\"https://www.codementor.io/\" rel=\"nofollow noreferrer\">Codementor</a> more often for things like that."}, {"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455729331, "post_id": 35460197, "comment_id": 58622600, "body": "Ive used that a few times now, find talking about a problem far more beneficial, you should sign up on there"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455730668, "post_id": 35460197, "comment_id": 58623482, "body": "I&#39;m on there. Just haven&#39;t spent much time there yet."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1455721194, "creation_date": 1455721194, "answer_id": 35460197, "question_id": 35459703, "link": "https://stackoverflow.com/questions/35459703/access-instance-variables-outside-class-ruby/35460197#35460197", "title": "Access Instance Variables outside class - Ruby", "body": "<p>The simple answer here is to add <code>attr_reader</code> which makes these variables accessible:</p>\n\n<pre><code>class BraintreeTransaction::PopulateForm\n  attr_reader :first_name\n  attr_reader :last_name\n\n  # ...\nend\n</code></pre>\n\n<p>Then you can access these only if you capture the populate module:</p>\n\n<pre><code>def new\n  @populate = BraintreeTransaction::PopulateForm.new(@user).populate_form\nend\n</code></pre>\n\n<p>In your view you can then use them like this:</p>\n\n<pre><code>&lt;%= text_field_tag :first_name, @populate.first_name, ... %&gt;\n</code></pre>\n\n<p>I'd recommend doing this lazy-loading style though, to avoid having to manually initialize it:</p>\n\n<pre><code>class BraintreeTransaction::PopulateForm\n  def initialize(user)\n    @user = user\n  end\n\n  def first_name\n    user_details and user_details.first_name\n  end\n\n  def last_name\n    user_details and user_details.last_name\n  end\n\n  def user_details\n    @user_details ||=\n      Transaction.where(\n        user_id: @user.id,\n        completed: false\n      ).order(\n        created_at: :desc\n      ).first\nend\n</code></pre>\n\n<p>This has the effect of cutting your queries in half and caching the result so only the first access has cost. Calling <code>populate_form</code> manually is implicit, no longer required.</p>\n"}], "owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 35460197, "answer_count": 1, "score": 0, "last_activity_date": 1455724756, "creation_date": 1455719925, "last_edit_date": 1455724756, "question_id": 35459703, "link": "https://stackoverflow.com/questions/35459703/access-instance-variables-outside-class-ruby", "title": "Access Instance Variables outside class - Ruby", "body": "<p>I have seen quite a few posts on this topic and apologise for not being able to use them for my example but i can seem to get it to work</p>\n\n<p>I have a form that can be pre populated with the users information if the data exisits</p>\n\n<pre><code>def new\n  BraintreeTransaction::PopulateForm.new(@user).populate_form\nend\n\nmodule BraintreeTransaction\n  class PopulateForm\n    def initialize(user)\n      @user = user\n    end\n\n    def populate_form\n     return if Transaction.where(user_id: @user.id, completed: false).empty?\n     user_details = Transaction.where(user_id: @user.id, completed: false).order(created_at: :desc).first\n     @first_name = user_details.first_name if user_details.first_name.present?\n     @last_name = user_details.last_name if user_details.last_name.present?\n   end\nend\n</code></pre>\n\n<p>My Form</p>\n\n<pre><code>&lt;%= text_field_tag :first_name, @first_name, placeholder: 'First Name', required: true %&gt;\n&lt;%= text_field_tag :last_name, @last_name, placeholder: 'Last Name', required: true %&gt;\n</code></pre>\n\n<p>How do i access the instance variable in this situation?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "url-for"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 2, "creation_date": 1455720013, "post_id": 35459634, "comment_id": 58615666, "body": "<code>textbook_url</code> is bad name name for a controller as rails has its predefined <code>path</code> and <code>url</code> helpers(<code>*_url</code>) which may be conflicting in your case. Try changing the name of the controller."}, {"owner": {"reputation": 14016, "user_id": 2148718, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b458d4a48bebf560c9a90d5ab2db1902?s=128&d=identicon&r=PG", "display_name": "Migwell", "link": "https://stackoverflow.com/users/2148718/migwell"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455721306, "post_id": 35459634, "comment_id": 58616669, "body": "That sounds plausible but I don&#39;t think anything changed after I changed the controller name. <a href=\"http://i.imgur.com/XS4CM4K.png\" rel=\"nofollow noreferrer\">i.imgur.com/XS4CM4K.png</a>"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1455721502, "post_id": 35459634, "comment_id": 58616837, "body": "What are you trying to achieve with the &quot;return super unless&quot; line?  That&#39;s the one that&#39;s causing the infinite loop."}, {"owner": {"reputation": 14016, "user_id": 2148718, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b458d4a48bebf560c9a90d5ab2db1902?s=128&d=identicon&r=PG", "display_name": "Migwell", "link": "https://stackoverflow.com/users/2148718/migwell"}, "edited": false, "score": 0, "creation_date": 1455755076, "post_id": 35459634, "comment_id": 58636361, "body": "That&#39;s part of rails"}], "owner": {"reputation": 14016, "user_id": 2148718, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b458d4a48bebf560c9a90d5ab2db1902?s=128&d=identicon&r=PG", "display_name": "Migwell", "link": "https://stackoverflow.com/users/2148718/migwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455719754, "creation_date": 1455719754, "question_id": 35459634, "link": "https://stackoverflow.com/questions/35459634/rails-url-for-with-a-controller-causing-infinite-loop", "title": "Rails url_for with a controller causing infinite loop", "body": "<p>I have a controller, called 'textbook_url' that I generated with <code>rails g controller</code>, has only one route that I added manually:</p>\n\n<p><code>get 'textbook_url/:id' =&gt; 'textbook_url#show', as: 'textbook_url'</code></p>\n\n<p>Now I want to be able to use <code>url_for controller: textbook_url, id: 111</code>and have it return <code>/textbook_url/111</code>. However I believe that I missed something because calling url_for on this controller causes an infinite loop, as pictured.\n<a href=\"https://i.stack.imgur.com/SxCvf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SxCvf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Do I need to customise the url_options method of my controller for url_for to work?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano3"], "comments": [{"owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "edited": false, "score": 0, "creation_date": 1455749926, "post_id": 35459255, "comment_id": 58634462, "body": "I don&#39;t know the answer, but if I could make an observation: you seem to be using some sort of &quot;copy&quot; scm plugin instead of the standard hg/git/svn. The scm code is what is responsible for creating the release directory; not capistrano itself (at least, this is true as of 3.4). I suggest looking into the scm plugin to see if maybe it needs to be upgraded."}, {"owner": {"reputation": 1096, "user_id": 2087549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dd60e923b026b22045450ec26adca1?s=128&d=identicon&r=PG", "display_name": "Andreas Gnyp", "link": "https://stackoverflow.com/users/2087549/andreas-gnyp"}, "reply_to_user": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "edited": false, "score": 0, "creation_date": 1455812182, "post_id": 35459255, "comment_id": 58666822, "body": "Thank you. This actually might help. I will post, if it yields something."}, {"owner": {"reputation": 1096, "user_id": 2087549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dd60e923b026b22045450ec26adca1?s=128&d=identicon&r=PG", "display_name": "Andreas Gnyp", "link": "https://stackoverflow.com/users/2087549/andreas-gnyp"}, "reply_to_user": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "edited": false, "score": 0, "creation_date": 1455886829, "post_id": 35459255, "comment_id": 58702895, "body": "It helped. We&#39;ve upgraded scm-plugin and now it works."}], "owner": {"reputation": 1096, "user_id": 2087549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97dd60e923b026b22045450ec26adca1?s=128&d=identicon&r=PG", "display_name": "Andreas Gnyp", "link": "https://stackoverflow.com/users/2087549/andreas-gnyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1455718873, "creation_date": 1455718873, "question_id": 35459255, "link": "https://stackoverflow.com/questions/35459255/capistrano-testing-for-release-directory-and-failing", "title": "Capistrano testing for release directory and failing", "body": "<p>We upgraded from Rails 3.2 to Rails 4.2 and Capistrano from 3.2.1 to 3.4.</p>\n\n<p>Now it seems <em>capistrano</em> does not create the release-directory before it tests for it. Which results in an error:</p>\n\n<pre><code>** Invoke test (first_time)\n** Execute test\n** Invoke load:defaults (first_time)\n** Execute load:defaults\n** Invoke bundler:map_bins (first_time)\n** Execute bundler:map_bins\n** Invoke rvm:hook (first_time)\n** Execute rvm:hook\n** Invoke rvm:check (first_time)\n** Execute rvm:check\n** Invoke deploy:set_rails_env (first_time)\n** Execute deploy:set_rails_env\n** Invoke deploy:set_linked_dirs (first_time)\n** Execute deploy:set_linked_dirs\n** Invoke deploy (first_time)\n** Execute deploy\n** Invoke deploy:starting (first_time)\n** Execute deploy:starting\n** Invoke deploy:check (first_time)\n** Execute deploy:check\n** Invoke copy:check (first_time)\n** Execute copy:check\n** Invoke deploy:check:directories (first_time)\n** Execute deploy:check:directories\n** Invoke deploy:check:linked_dirs (first_time)\n** Execute deploy:check:linked_dirs\n** Invoke deploy:check:make_linked_dirs (first_time)\n** Execute deploy:check:make_linked_dirs\n** Invoke dcportal:db:create_config (first_time)\n** Execute dcportal:db:create_config\n** Invoke deploy:check:linked_files (first_time)\n** Execute deploy:check:linked_files\n** Invoke deploy:set_previous_revision (first_time)\n** Execute deploy:set_previous_revision\n** Invoke deploy:started (first_time)\n** Execute deploy:started\n** Invoke deploy:updating (first_time)\n** Invoke deploy:new_release_path (first_time)\n** Execute deploy:new_release_path\n** Execute deploy:updating\n DEBUG [84703c58] Running /usr/bin/env [ -d ~/.rvm ] as cap@softwaredev-it2\n** Invoke copy:create_release (first_time)\n DEBUG [84703c58] Command: [ -d ~/.rvm ]\n** Invoke copy:deploy (first_time)\n\n[...]\n\nDEBUG [5c4fa563] Running /usr/bin/env if test ! -d /var/www/rails/dc/releases/20160217135156; then echo \"Directory does not exist '/var/www/rails/dc/releases/20160217135156'\" 1&gt;&amp;2; false; fi as cap@softwaredev-it2\nDEBUG [5c4fa563] Command: if test ! -d /var/www/rails/dc/releases/20160217135156; then echo \"Directory does not exist '/var/www/rails/dc/releases/20160217135156'\" 1&gt;&amp;2; false; fi\nDEBUG [5c4fa563]    Directory does not exist '/var/www/rails/dc/releases/20160217135156'\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "rubymine"], "comments": [{"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1455802794, "post_id": 35459232, "comment_id": 58659517, "body": "Why do you think it ignores the version specified? You can check it also in Gemfile.lock (in addition, check if &quot;Run in context of the bundle&quot; option is turned on)"}], "owner": {"reputation": 3607, "user_id": 1644596, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/16472e6b0d3f743900f35ac3a5476586?s=128&d=identicon&r=PG", "display_name": "Robbie Wareham", "link": "https://stackoverflow.com/users/1644596/robbie-wareham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455718805, "creation_date": 1455718805, "question_id": 35459232, "link": "https://stackoverflow.com/questions/35459232/can-rubymine-support-different-versions-of-rspec", "title": "Can Rubymine support different versions of RSpec?", "body": "<p>I have 2 unrelated Rubymine projects, one of which uses RSpec 2, the other uses RSpec3. The required version of rspec is defined in the Gemfile of each.</p>\n\n<p>When I run the specs via Rubymine, it always uses the latest version of Rspec on my laptop and ignores the version defined in the Gemfile.  </p>\n\n<p>As I am unable to run the Rspec2 project with RSpec3, I have to manually uninstall RSpec3 when developing, then reinstall when developing the RSpec3 project.</p>\n\n<p>Is there anyway I can force Rubymine to run a specific version of RSpec for a project?</p>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1455719226, "post_id": 35458887, "comment_id": 58614982, "body": "You can use a <i>positive lookbehind</i> to avoid the nested array: <code>str.scan(&#47;(?&lt;=offset=)\\d+&#47;)</code>, or - since there is probably only one &quot;offset&quot; - just <code>str[&#47;(?&lt;=offset=)\\d+&#47;]</code>"}], "tags": [], "owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "is_accepted": false, "score": 2, "last_activity_date": 1455717957, "creation_date": 1455717957, "answer_id": 35458887, "question_id": 35458788, "link": "https://stackoverflow.com/questions/35458788/ruby-extract-data-from-string-with-regex/35458887#35458887", "title": "Ruby - Extract data from string with regex", "body": "<p>Assuming offset will always be present as <code>offset=</code> and it will always be a numeric value</p>\n\n<pre><code>str = \"\\/v1\\/195900\\/patients?DEPARTMENTID=162&amp;GUARANTORCOUNTRYCODE3166=1&amp;offset=20\"\nstr.scan(/offset=(\\d+)/)\n#=&gt; [[\"20\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 3, "last_activity_date": 1455718305, "creation_date": 1455718305, "answer_id": 35459033, "question_id": 35458788, "link": "https://stackoverflow.com/questions/35458788/ruby-extract-data-from-string-with-regex/35459033#35459033", "title": "Ruby - Extract data from string with regex", "body": "<p>It doesn't satisfy your requirement to use a regex, but here is a way:</p>\n\n<pre><code>uri = \"\\/v1\\/195900\\/patients?DEPARTMENTID=162&amp;GUARANTORCOUNTRYCODE3166=1&amp;offset=20\"\n\nrequire \"uri\"\nURI.decode_www_form(URI(uri).query).assoc(\"offset\").last\n# =&gt; \"20\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>URI.decode_www_form(URI(uri).query).to_h[\"offset\"]\n# =&gt; \"20\"\n</code></pre>\n"}], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "closed_date": 1455719327, "accepted_answer_id": 35459033, "answer_count": 2, "score": -5, "last_activity_date": 1455718305, "creation_date": 1455717729, "question_id": 35458788, "link": "https://stackoverflow.com/questions/35458788/ruby-extract-data-from-string-with-regex", "closed_reason": "Duplicate", "title": "Ruby - Extract data from string with regex", "body": "<p>In ruby I have string that looks like this:</p>\n\n<pre><code>\"\\/v1\\/195900\\/patients?DEPARTMENTID=162&amp;GUARANTORCOUNTRYCODE3166=1&amp;offset=20\"\n</code></pre>\n\n<p>how can I extract offset value from this string with regular expressions?</p>\n"}, {"tags": ["css", "ruby", "ruby-on-rails-4", "pdf-generation", "princely"], "answers": [{"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1455721710, "creation_date": 1455721710, "answer_id": 35460402, "question_id": 35458780, "link": "https://stackoverflow.com/questions/35458780/pdf-file-rendered-in-portrait-instead-of-landscape/35460402#35460402", "title": "pdf file rendered in portrait instead of landscape", "body": "<p>If you can't get this right with princely take a look at <a href=\"https://github.com/boazsegev/combine_pdf\" rel=\"nofollow\">combine_pdf</a>, here a sample that rotates a pdf file and saves it into another file.</p>\n\n<pre><code>require \"combine_pdf\"\n\npdf = CombinePDF.load(\"file.pdf\")\npdf.pages.each {|p| p.orientation :landscape }\npdf.save 'my.pdf'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "is_accepted": true, "score": 0, "last_activity_date": 1455911626, "creation_date": 1455911626, "answer_id": 35513820, "question_id": 35458780, "link": "https://stackoverflow.com/questions/35458780/pdf-file-rendered-in-portrait-instead-of-landscape/35513820#35513820", "title": "pdf file rendered in portrait instead of landscape", "body": "<p><strong>Final Solution</strong></p>\n\n<p>This was fixed by downgrading <code>sprockets-rails</code> gem from <code>3.0.0</code> to <code>2.3.3</code> because of <a href=\"https://github.com/rails/sprockets-rails/issues/237\" rel=\"nofollow\">this issue</a>. </p>\n\n<p><strong>How I got there</strong></p>\n\n<p>Found an error message in <code>prince.log</code> file generated by the <code>princexml</code> command line utility which said <code>printpdf.css: warning: can't open input file: No such file or directory</code></p>\n\n<p>That made me realize that the <code>princexml</code> commandline utility was being passed <code>printpdf.css</code> as the value for the css file, instead of the fully-qualified path: <code>/Users/prakash/Projects/main_project/app/assets/stylesheets/printpdf.css</code> on staging. </p>\n\n<p>Debugging through <a href=\"https://github.com/mbleigh/princely/blob/7526cbefb632b19427b0f9f80428fe1717b18087/lib/princely/asset_support.rb#L19\" rel=\"nofollow\">princely code</a>, found that <code>Rails.application.assets</code> is being returned as nil here. </p>\n\n<p>One other interesting thing I noticed during this exercise:</p>\n\n<p>Downgrading rails version from <code>4.2.5.1</code> to <code>4.2.4</code> originally to rollback all my changes did not downgrade the version of <code>sprockets-rails</code> gem to <code>2.3.3</code>; it still kept it at <code>3.0.0</code>; hence my conclusion that the rails upgrade step was not a culprit for this problem.</p>\n"}], "owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 35513820, "answer_count": 2, "score": 1, "last_activity_date": 1455911626, "creation_date": 1455717704, "last_edit_date": 1455718037, "question_id": 35458780, "link": "https://stackoverflow.com/questions/35458780/pdf-file-rendered-in-portrait-instead-of-landscape", "title": "pdf file rendered in portrait instead of landscape", "body": "<p>We are using princely gem to generate pdf documents on our <code>rails 4</code> app.  For the last couple of days, the generated pdf is rendering in portrait mode instead of the specified landscape mode; this functionality has been working fine for years. </p>\n\n<p>There have been some updates being done on the ruby/rails versions on the server, but nothing has been changed on the pdf generation code itself. </p>\n\n<p>One interesting aspect is that the pdf is generated in landscape mode on the development server, when I test it locally on my machine(Mac). The same code generates pdf in portrait mode on the staging/production server (Linux).</p>\n\n<p>Related code:</p>\n\n<p><strong>From Gemfile</strong></p>\n\n<pre><code>gem 'rails', '4.2.5.1'\ngem 'princely', git: \"git@github.com:mbleigh/princely.git\"\n....\n</code></pre>\n\n<p><strong>Pdf render code:</strong> </p>\n\n<pre><code>render :pdf =&gt; \"ticket\",\n       :template =&gt; \"admin/tickets/print.pdf.erb\",\n       :stylesheets =&gt; [\"printpdf.css\"]\n</code></pre>\n\n<p><strong>app/assets/stylesheets/printpdf.css:</strong></p>\n\n<pre><code>@page {                                                                            \n  size: 8.5in 11in landscape;                                                      \n  margin: 5mm 5mm 5mm 5mm;                                                         \n}                                                                                  \n@page {                                                                            \n  @bottom-right {                                                                  \n    content: counter(page);                                                        \n  }                                                                                \n}                                                                                  \n#pagebreak {                                                                       \n  page-break-after: always;                                                        \n}    \n</code></pre>\n\n<p><strong>Princely command executed (as shown in the log):</strong></p>\n\n<pre><code>PRINCE XML PDF COMMAND\n/usr/local/bin/prince --input=html --server --log=/Users/prakash/Projects/main_project/log/prince.log  -s /Users/prakash/Projects/main_project/app/assets/stylesheets/printpdf.css  --silent - -o -\n</code></pre>\n\n<p>Rails version was changed from <code>4.2.4</code> to <code>4.2.5.1</code> recently, and ruby version was changed from <code>2.2.0</code> to <code>2.3.0</code>. I rolled back both these changes on the staging server, but reverting neither of those changes fixes the portrait-instead-of-landscape issue.      </p>\n\n<p>Would appreciate any suggestions on where to look for the root cause of this problem, and how to fix it. </p>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1455717470, "post_id": 35458631, "comment_id": 58613634, "body": "That looks like erb, not HTML. There are haml, slim, etc."}, {"owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1455717529, "post_id": 35458631, "comment_id": 58613685, "body": "Corrected tag and title. Thanks."}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1455717551, "post_id": 35458631, "comment_id": 58613703, "body": "It looks good to me!"}], "answers": [{"comments": [{"owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "edited": false, "score": 0, "creation_date": 1455717809, "post_id": 35458747, "comment_id": 58613896, "body": "Well, it is a line shorter, but an extra file... Thanks for the suggestion, though :)"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "reply_to_user": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "edited": false, "score": 0, "creation_date": 1455717996, "post_id": 35458747, "comment_id": 58614041, "body": "Ha, yeah, like I said, what you&#39;ve got already is sufficiently elegant. When you only need to iterate over/add simple <code>li</code>s, 9 lines is pretty clean. :-D"}], "tags": [], "owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "is_accepted": false, "score": 0, "last_activity_date": 1455718247, "last_edit_date": 1455718247, "creation_date": 1455717603, "answer_id": 35458747, "question_id": 35458631, "link": "https://stackoverflow.com/questions/35458631/elegant-way-to-print-html-lists-with-ruby-erb/35458747#35458747", "title": "Elegant way to print HTML Lists with Ruby + ERB", "body": "<p>That actually looks sufficiently elegant to me already, but you could do this to make a <em>little</em> cleaner:</p>\n\n<pre><code>&lt;% if items.any? %&gt;\n  &lt;ul class=\"level1\"&gt;\n    = render items\n  &lt;/ul&gt;   \n&lt;% end %&gt;\n</code></pre>\n\n<p>And then have your <code>li</code> code in a partial called <code>_items.html.erb</code>, like so:</p>\n\n<pre><code>&lt;li class=\"item\"&gt;\n  &lt;a href=\"#\"&gt;&lt;%= item.text %&gt;&lt;/a&gt;\n&lt;/li&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "edited": false, "score": 0, "creation_date": 1455718503, "post_id": 35458846, "comment_id": 58614433, "body": "Just 2 levels... that is so far the best one :)"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1455718665, "post_id": 35458846, "comment_id": 58614552, "body": "I personally think the readability is better with the <code>if items.any?</code> wrapping the block, but there&#39;s no doubt that is <i>super concise</i>. Very nice!"}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 3, "last_activity_date": 1455718505, "last_edit_date": 1455718505, "creation_date": 1455717862, "answer_id": 35458846, "question_id": 35458631, "link": "https://stackoverflow.com/questions/35458631/elegant-way-to-print-html-lists-with-ruby-erb/35458846#35458846", "title": "Elegant way to print HTML Lists with Ruby + ERB", "body": "<p>Try this, <a href=\"https://github.com/rails/rails/pull/5637#issuecomment-4777920\" rel=\"nofollow\"><code>based on</code></a>:</p>\n\n<pre><code>&lt;% content_tag(:ul, class: 'level1') do %&gt;\n   &lt;% content_tag_for(:li, items, class: \"item\") do |item|\n      &lt;%= link_to item.text, '#' %&gt;\n   &lt;% end %&gt;\n&lt;% end if items.any? %&gt;   \n</code></pre>\n\n<p>5 lines, no extra partials, only rails helpers.</p>\n"}, {"comments": [{"owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "edited": false, "score": 0, "creation_date": 1455718032, "post_id": 35458879, "comment_id": 58614075, "body": "well, it is just another command to print the same. It is basically the same instructions with synonym methods."}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "reply_to_user": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "edited": false, "score": 0, "creation_date": 1455718185, "post_id": 35458879, "comment_id": 58614173, "body": "@Dbugger what exactly are you looking for? Maybe we&#39;re not understanding what &quot;elegant&quot; means to you. You still have to tell the computer what you want it to do. :-)"}], "tags": [], "owner": {"reputation": 1545, "user_id": 1438190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af222bb723abc93783d6c33e95b15897?s=128&d=identicon&r=PG", "display_name": "Anezio Campos", "link": "https://stackoverflow.com/users/1438190/anezio-campos"}, "is_accepted": false, "score": 0, "last_activity_date": 1455717945, "creation_date": 1455717945, "answer_id": 35458879, "question_id": 35458631, "link": "https://stackoverflow.com/questions/35458631/elegant-way-to-print-html-lists-with-ruby-erb/35458879#35458879", "title": "Elegant way to print HTML Lists with Ruby + ERB", "body": "<p>I would go into something like this:</p>\n\n<pre><code>if items.any?\n  content_tag(:ul, class: 'level1') do\n    items.each do |item|\n      concat content_tag(:li, class: 'item', item)\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "edited": false, "score": 1, "creation_date": 1455718299, "post_id": 35458968, "comment_id": 58614263, "body": "Well, I do not want to change my whole templating engine just because of this... :) But thanks for the suggestion"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1455718161, "last_edit_date": 1495540765, "creation_date": 1455718161, "answer_id": 35458968, "question_id": 35458631, "link": "https://stackoverflow.com/questions/35458631/elegant-way-to-print-html-lists-with-ruby-erb/35458968#35458968", "title": "Elegant way to print HTML Lists with Ruby + ERB", "body": "<p>As <a href=\"https://stackoverflow.com/questions/35458631/elegant-way-to-print-html-lists-with-ruby-erb/35458968#comment58613634_35458631\">suggested by sawa</a>, you could use <a href=\"http://slim-lang.com\" rel=\"nofollow noreferrer\">Slim</a>:</p>\n\n<pre><code>- if items.any?\n  ul.level1\n    - items.each do |item|\n      li.item\n        a href=\"#\"\n          = item.text\n</code></pre>\n\n<p>or <a href=\"http://haml.info\" rel=\"nofollow noreferrer\">Haml</a>:</p>\n\n<pre><code>- if items.any?\n  %ul.level1\n    - items.each do |item|\n      %li.item\n        %a{href: \"#\"}= item.text\n</code></pre>\n\n<p>Both produce nicely formatted HTML.</p>\n"}], "owner": {"reputation": 20915, "user_id": 392684, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DXigI.jpg?s=128&g=1", "display_name": "Enrique Moreno Tent", "link": "https://stackoverflow.com/users/392684/enrique-moreno-tent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1455718505, "creation_date": 1455717296, "last_edit_date": 1455717954, "question_id": 35458631, "link": "https://stackoverflow.com/questions/35458631/elegant-way-to-print-html-lists-with-ruby-erb", "title": "Elegant way to print HTML Lists with Ruby + ERB", "body": "<p>I have the following code</p>\n\n<pre><code>&lt;% if items.any? %&gt;\n    &lt;ul class=\"level1\"&gt;\n        &lt;% items.each do |item| %&gt;\n            &lt;li class=\"item\"&gt;\n                &lt;a href=\"#\"&gt;&lt;%= item.text %&gt;&lt;/a&gt;\n            &lt;/li&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;   \n&lt;% end %&gt;\n</code></pre>\n\n<p>While this works, I was wondering if there was a way to make it more elegant. The <code>if</code> and then <code>each</code> is not very pretty...</p>\n\n<p>Anyone knows a more elegant syntax?</p>\n"}, {"tags": ["ruby", "google-cloud-platform", "google-api-ruby-client"], "answers": [{"tags": [], "owner": {"reputation": 15006, "user_id": 520567, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6cb1b2c58abc2116f910ec9253ee387f?s=128&d=identicon&r=PG", "display_name": "akostadinov", "link": "https://stackoverflow.com/users/520567/akostadinov"}, "is_accepted": true, "score": 1, "last_activity_date": 1455727874, "last_edit_date": 1455727874, "creation_date": 1455718100, "answer_id": 35458940, "question_id": 35458309, "link": "https://stackoverflow.com/questions/35458309/error-inserting-instance-with-gcloud-api-gem/35458940#35458940", "title": "error inserting instance with gcloud api gem", "body": "<p>Huh, might be stupid but I couldn't understand it for a good time that I actually have to create an <code>Instance</code> object and use it for the call.</p>\n\n<pre><code>io = Google::Apis::ComputeV1::Instance.new(instance_opts)\ncompute.insert_instance(project, zone, io)\n</code></pre>\n\n<p>But with one more detail. Hash should be <code>:machine_type</code> instead of <code>\"machineType\"</code>. That's the same for all hash keys.</p>\n"}], "owner": {"reputation": 15006, "user_id": 520567, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6cb1b2c58abc2116f910ec9253ee387f?s=128&d=identicon&r=PG", "display_name": "akostadinov", "link": "https://stackoverflow.com/users/520567/akostadinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 35458940, "answer_count": 1, "score": 1, "last_activity_date": 1459578359, "creation_date": 1455716374, "last_edit_date": 1455814714, "question_id": 35458309, "link": "https://stackoverflow.com/questions/35458309/error-inserting-instance-with-gcloud-api-gem", "title": "error inserting instance with gcloud api gem", "body": "<p>trying to launch an instance in Google Cloud using <code>google-api-client</code> 0.9.2 \nSo I'm running:</p>\n\n<pre><code>compute.insert_instance(project, zone, instance_opts)\n</code></pre>\n\n<p>Where <code>instance_opts</code> is:</p>\n\n<pre><code>---\nmachineType: https://www.googleapis.com/compute/v1/projects/openshift-gce-devel/zones/us-central1-a/machineTypes/n1-standard-1\ndisks:\n- initializeParams:\n    sourceImage: https://www.googleapis.com/compute/v1/projects/myproject/global/images/myimage\n  type: SCRATCH\nnetworkInterfaces:\n- network: projects/myproject/global/networks/default\n  accessConfigs:\n  - name: external\nname: mytest\n</code></pre>\n\n<p>But I'm getting an error from server:</p>\n\n<pre><code>{\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"required\",\n    \"message\": \"Required field 'resource.name' not specified\"\n   }\n  ],\n  \"code\": 400,\n  \"message\": \"Required field 'resource.name' not specified\"\n }\n}\n</code></pre>\n\n<p>I'm getting exact same issue even if I make <code>instance_opts</code> only:</p>\n\n<pre><code>{\"name\": \"mytest\"}\n</code></pre>\n\n<p>I get an error for unknown field \"resource\" or \"resource.name\" if I try to set these in <code>instance_opts</code>. Setting name of disk also doesn't help. So I'm wondering what the issue could be.</p>\n"}, {"tags": ["ruby", "docker", "chef-infra", "knife"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1455744971, "creation_date": 1455744971, "answer_id": 35468257, "question_id": 35458300, "link": "https://stackoverflow.com/questions/35458300/chef-provisioning-systemstackerror-stack-level-too-deep/35468257#35468257", "title": "CHEF provisioning: SystemStackError: stack level too deep", "body": "<p>Chef-provisioning is alpha-level code, and the docker driver probably even more so. You are better off filing a GitHub issue on the relevant project because very few people have used either and you want a direct conduit to those that have.</p>\n"}], "owner": {"reputation": 362, "user_id": 4396320, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh3.googleusercontent.com/-skAcS8g3clU/AAAAAAAAAAI/AAAAAAAAADI/MM0j6pIaA7k/photo.jpg?sz=128", "display_name": "rizotas", "link": "https://stackoverflow.com/users/4396320/rizotas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455744971, "creation_date": 1455716358, "question_id": 35458300, "link": "https://stackoverflow.com/questions/35458300/chef-provisioning-systemstackerror-stack-level-too-deep", "title": "CHEF provisioning: SystemStackError: stack level too deep", "body": "<p>I'm making a node provisioner with <a href=\"https://www.chef.io/\" rel=\"nofollow\">CHEF</a>, I want to create and configure Docker containers inside it.</p>\n\n<p>Currently I get a CHEF node with Chefdk and chef-provisioner-docker, but when I trigger the recipe to create containers (machine) I get a <code>Stack level too deep</code> withc I dont understand why.</p>\n\n<p>Stacktrace:</p>\n\n<pre><code>[2016-02-16T11:12:21-05:00] INFO: Forking chef instance to converge...\n[2016-02-16T11:12:21-05:00] INFO: *** Chef 12.5.1 ***\n[2016-02-16T11:12:21-05:00] INFO: Chef-client pid: 2456\n[2016-02-16T11:12:23-05:00] INFO: Run List is [recipe[dockerice], recipe[provisioning]]\n[2016-02-16T11:12:23-05:00] INFO: Run List expands to [dockerice, provisioning]\n[2016-02-16T11:12:23-05:00] INFO: Starting Chef Run for provisioner-1\n[2016-02-16T11:12:23-05:00] INFO: Running start handlers\n[2016-02-16T11:12:23-05:00] INFO: Start handlers complete.\n[2016-02-16T11:12:24-05:00] INFO: Loading cookbooks [dockerice@0.1.0, docker@2.4.16, compat_resource@12.7.1, provisioning@0.1.0]\n[2016-02-16T11:12:24-05:00] INFO: Processing docker_service[default] action create (dockerice::default line 10)\n[2016-02-16T11:12:24-05:00] INFO: Processing docker_installation_script[default] action create (/var/chef/cache/cookbooks/docker/libraries/docker_service.rb line 53)\n[2016-02-16T11:12:24-05:00] INFO: Processing apt_package[curl] action install (/var/chef/cache/cookbooks/docker/libraries/docker_installation_script.rb line 35)\n[2016-02-16T11:12:24-05:00] INFO: Processing execute[install docker] action run (/var/chef/cache/cookbooks/docker/libraries/docker_installation_script.rb line 39)\n[2016-02-16T11:12:24-05:00] INFO: Processing docker_service[default] action start (dockerice::default line 10)\n[2016-02-16T11:12:24-05:00] INFO: Processing docker_service_manager_systemd[default] action start (/var/chef/cache/cookbooks/docker/libraries/docker_service.rb line 71)\n[2016-02-16T11:12:25-05:00] WARN: Default value false is invalid for property tls_ca_cert of resource . In Chef 13 this will become an error: Property tls_ca_cert must be one of: String, nil!  You passed false.. at /var/chef/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef.rb:20:in `log_deprecation'\n[2016-02-16T11:12:25-05:00] INFO: Processing directory[/usr/libexec] action create (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 23)\n[2016-02-16T11:12:25-05:00] INFO: Processing template[/usr/libexec/docker-wait-ready] action create (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 32)\n[2016-02-16T11:12:25-05:00] INFO: Processing template[/lib/systemd/system/docker.service] action create (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 46)\n[2016-02-16T11:12:25-05:00] INFO: Processing file[/etc/docker-firstconverge] action create (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 63)\n[2016-02-16T11:12:25-05:00] INFO: Processing execute[systemctl daemon-reload] action nothing (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 68)\n[2016-02-16T11:12:25-05:00] INFO: Processing template[/usr/lib/tmpfiles.d/docker.conf] action create (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 74)\n[2016-02-16T11:12:25-05:00] INFO: Processing service[docker] action enable (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 85)\n[2016-02-16T11:12:25-05:00] INFO: Processing service[docker] action start (/var/chef/cache/cookbooks/docker/libraries/docker_service_manager_systemd.rb line 85)\n[2016-02-16T11:12:25-05:00] INFO: Processing machine[contenedor] action converge (provisioning::default line 12)\n[2016-02-16T11:12:25-05:00] INFO: HTTP Request Returned 404 Object Not Found: error\n[2016-02-16T11:12:25-05:00] WARN: chef_environment nil currently does not overwrite the value of chef_environment. This will change in Chef 13, and the value will be set to nil instead. Please change your code to explicitly accept nil using \"property :chef_environment, [MyType, nil]\", or stop setting this value to nil. at /var/chef/cache/cookbooks/compat_resource/files/lib/chef_compat/monkeypatches/chef.rb:20:in `log_deprecation' at /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/chef-12.5.1/lib/chef/event_dispatch/dispatcher.rb:38:in `call'\n[0m\n================================================================================[0m\n[31mError executing action `converge` on resource 'machine[contenedor]'[0m\n================================================================================[0m\n\n[0mSystemStackError[0m\n----------------[0m\nstack level too deep[0m\n\n[0mCookbook Trace:[0m\n---------------[0m\n/var/chef/cache/cookbooks/docker/files/default/vendor/gems/excon-0.45.4/lib/excon/headers.rb:33[0m\n\n[0mResource Declaration:[0m\n---------------------[0m\n# In /var/chef/cache/cookbooks/provisioning/recipes/default.rb\n[0m\n[0m 12: machine 'contenedor' do\n[0m 13:     machine_options :docker_options =&gt; {\n[0m 14:       :base_image =&gt; {\n[0m 15:           :name =&gt; 'ubuntu',\n[0m 16:           :repository =&gt; 'ubuntu',\n[0m 17:           :tag =&gt; '14.04'\n[0m 18:       },\n[0m 19:       :command =&gt; '/usr/sbin/sshd -p 8022 -D',\n[0m 20:     }\n[0m 21: end\n[0m\n[0mCompiled Resource:[0m\n------------------[0m\n# Declared in /var/chef/cache/cookbooks/provisioning/recipes/default.rb:12:in `from_file'\n[0m\n[0mmachine(\"contenedor\") do\n[0m  action [:converge]\n[0m  retries 0\n[0m  retry_delay 2\n[0m  default_guard_interpreter :default\n[0m  chef_server {:chef_server_url=&gt;\"https://api.chef.io/organizations/aramirez\", :options=&gt;{:client_name=&gt;\"provisioner-1\", :signing_key_filename=&gt;\"/etc/chef/client.pem\", :api_version=&gt;\"0\"}}\n[0m  driver \"docker\"\n[0m  machine_options {:docker_options=&gt;{:base_image=&gt;{:name=&gt;\"ubuntu\", :repository=&gt;\"ubuntu\", :tag=&gt;\"14.04\"}, :command=&gt;\"/usr/sbin/sshd -p 8022 -D\"}}\n[0m  declared_type :machine\n[0m  cookbook_name \"provisioning\"\n[0m  recipe_name \"default\"\n[0mend\n[0m\n[0m[2016-02-16T11:12:25-05:00] INFO: Running queued delayed notifications before re-raising exception\n[2016-02-16T11:12:25-05:00] ERROR: Running exception handlers\n[2016-02-16T11:12:25-05:00] ERROR: Exception handlers complete\n[2016-02-16T11:12:25-05:00] INFO: Sending resource update report (run-id: 58ed0337-8487-4d72-8c28-c11e9c57551d)\n[2016-02-16T11:12:26-05:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out\n[2016-02-16T11:12:26-05:00] ERROR: machine[contenedor] (provisioning::default line 12) had an error: SystemStackError: stack level too deep\n[2016-02-16T11:12:26-05:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)\n</code></pre>\n\n<p>How can I solve it to able to create docker containers in a provisioner node?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "rake", "bundler", "jruby"], "answers": [{"tags": [], "owner": {"reputation": 4065, "user_id": 1240482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HgBKF.jpg?s=128&g=1", "display_name": "jsears", "link": "https://stackoverflow.com/users/1240482/jsears"}, "is_accepted": false, "score": 1, "last_activity_date": 1455719116, "last_edit_date": 1455719116, "creation_date": 1455717772, "answer_id": 35458808, "question_id": 35458295, "link": "https://stackoverflow.com/questions/35458295/unsupported-exec-option-close-others-error-when-starting-jruby/35458808#35458808", "title": "&quot;unsupported exec option: close_others&quot; error when starting JRuby", "body": "<p>JRuby 9.X has <a href=\"https://developer.zendesk.com/blog/ruby-2-0-changes-exec-bundler\" rel=\"nofollow\">changed the way it handles spawning processes</a>.</p>\n\n<p>Starting with v1.4.0.rc1 version of Bundler, there is now an option to bundle exec called --keep-file-descriptors which ports Ruby 1.9's behavior and keeps all relevant file descriptors.  That allows you to suppress this issue.  An alternative approach is to use binstubs.  Upgrading from bundler 1.10.6 to 1.11 also resolves this issue.</p>\n\n<p>For more information, see the <a href=\"https://github.com/bundler/bundler/issues/2628\" rel=\"nofollow\">original Bundler issue</a> and the <a href=\"https://github.com/bundler/bundler/pull/2629\" rel=\"nofollow\">pull request that added the option</a>.</p>\n"}], "owner": {"reputation": 4065, "user_id": 1240482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HgBKF.jpg?s=128&g=1", "display_name": "jsears", "link": "https://stackoverflow.com/users/1240482/jsears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455719116, "creation_date": 1455716354, "last_edit_date": 1455716961, "question_id": 35458295, "link": "https://stackoverflow.com/questions/35458295/unsupported-exec-option-close-others-error-when-starting-jruby", "title": "&quot;unsupported exec option: close_others&quot; error when starting JRuby", "body": "<p>When running Rake tasks via Bundler 1.10.6 w/ JRuby 9.0.4.0, I receive the following warning:</p>\n\n<pre><code>uri:classloader:/jruby/kernel/kernel.rb:17: warning: unsupported exec option: close_others\n</code></pre>\n\n<p>I do not see the same issue when running rake tasks without using <code>bundle exec</code>.</p>\n\n<p>Could anyone point me to the source of this warning, or a means to eliminate it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1499368464, "post_id": 35458200, "comment_id": 76889767, "body": "<a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": false, "score": 6, "last_activity_date": 1455716348, "creation_date": 1455716348, "answer_id": 35458292, "question_id": 35458200, "link": "https://stackoverflow.com/questions/35458200/ruby-on-rails-giving-me-errors/35458292#35458292", "title": "Ruby on Rails giving me errors...", "body": "<blockquote>\n  <p>syntax error, unexpected keyword_end</p>\n</blockquote>\n\n<p>You need to change <code>&lt;%= end %&gt;</code> to <code>&lt;% end %&gt;</code></p>\n"}], "owner": {"reputation": 73, "user_id": 1538594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/643cca41a74f02d28d7ee1fe8533de2d?s=128&d=identicon&r=PG", "display_name": "Mr. P-teo", "link": "https://stackoverflow.com/users/1538594/mr-p-teo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455716348, "creation_date": 1455716102, "question_id": 35458200, "link": "https://stackoverflow.com/questions/35458200/ruby-on-rails-giving-me-errors", "title": "Ruby on Rails giving me errors...", "body": "<p>So i've been following DevTips ruby on rails blog tutorial on YouTube but i keep getting errors:</p>\n\n<pre><code>app/views/posts/new.html.erb:11: syntax error, unexpected keyword_end\napp/views/posts/new.html.erb:13: syntax error, unexpected keyword_ensure, expecting ')'\napp/views/posts/new.html.erb:15: syntax error, unexpected keyword_end, expecting ')'\n</code></pre>\n\n<p>Now... For one my code isnt even 15 lines long... which is one reason why im so lost. Here is my code: </p>\n\n<pre><code>&lt;h1&gt;New Post&lt;/h1&gt;\n\n&lt;%= form_for @post do |f| %&gt;\n  &lt;%= f.label :title %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :title %&gt;&lt;br /&gt;\n  &lt;br /&gt;\n  &lt;%= f.label :body %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :body %&gt;&lt;br /&gt;\n  &lt;br /&gt;\n  &lt;%= f.submit %&gt;\n&lt;%= end %&gt;\n</code></pre>\n\n<p>Any help with this. I'm completely baffled...</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "devise", "scopes"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455714707, "post_id": 35457500, "comment_id": 58611654, "body": "In which model you have that scope?"}, {"owner": {"reputation": 129, "user_id": 2365503, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/018ab92a03ea161c5d74c913a27c32d0?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2365503/craig"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455714786, "post_id": 35457500, "comment_id": 58611717, "body": "In the Referral class. I&#39;ve edited my question to show that."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455714829, "post_id": 35457500, "comment_id": 58611755, "body": "Try <code>includes(:client)</code> instead of <code>includes(:clients)</code>"}, {"owner": {"reputation": 129, "user_id": 2365503, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/018ab92a03ea161c5d74c913a27c32d0?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2365503/craig"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455715241, "post_id": 35457500, "comment_id": 58612039, "body": "I still get a similar error with client instead of clients."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1455715574, "post_id": 35457500, "comment_id": 58612259, "body": "<a href=\"http://stackoverflow.com/questions/19175084/activerecord-query-through-multiple-joins\" title=\"activerecord query through multiple joins\">stackoverflow.com/questions/19175084/&hellip;</a>"}, {"owner": {"reputation": 129, "user_id": 2365503, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/018ab92a03ea161c5d74c913a27c32d0?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2365503/craig"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1455716266, "post_id": 35457500, "comment_id": 58612749, "body": "Thanks for your answer @Ilya but I&#39;m looking to achieve this using scopes."}, {"owner": {"reputation": 1705, "user_id": 1461972, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a6030b91c06dbba9a59f2b514d631962?s=128&d=identicon&r=PG", "display_name": "MrWater", "link": "https://stackoverflow.com/users/1461972/mrwater"}, "edited": false, "score": 0, "creation_date": 1488043325, "post_id": 35457500, "comment_id": 72060716, "body": "Craig, I wonder if using the delegate might serve (. Check: <a href=\"http://stackoverflow.com/a/14893450/1461972\">stackoverflow.com/a/14893450/1461972</a> ) . Maybe you can have   <code>delegate :client, to: :submission</code> , instead of <code>has_one :client, through: :submission</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "edited": false, "score": 0, "creation_date": 1455717362, "post_id": 35458435, "comment_id": 58613549, "body": "The asker would then have to change his reference to &quot;submission.client.address.city_town&quot;, and be introducing an entirely unnecessary table to the mix."}], "tags": [], "owner": {"reputation": 84, "user_id": 2399225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa144da6e487e02f72bbf23f8c7a3d2?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2399225/marcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1455822201, "last_edit_date": 1455822201, "creation_date": 1455716708, "answer_id": 35458435, "question_id": 35457500, "link": "https://stackoverflow.com/questions/35457500/rails-scope-with-nested-association/35458435#35458435", "title": "Rails scope with nested association", "body": "<p>could you try </p>\n\n<pre><code>includes(submission: :clients)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 2365503, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/018ab92a03ea161c5d74c913a27c32d0?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2365503/craig"}, "edited": false, "score": 0, "creation_date": 1455788038, "post_id": 35458503, "comment_id": 58649210, "body": "Sorry for the late reply. I will try this and let you know how it goes"}], "tags": [], "owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "is_accepted": false, "score": 2, "last_activity_date": 1455718631, "last_edit_date": 1455718631, "creation_date": 1455716883, "answer_id": 35458503, "question_id": 35457500, "link": "https://stackoverflow.com/questions/35457500/rails-scope-with-nested-association/35458503#35458503", "title": "Rails scope with nested association", "body": "<p>You are receiving this particular error because you are improperly referencing the city_town in your query. <code>client.address.city_town =&gt; city_town</code> would imply that the key in this hash is a value nested within an existing \"client\" variable. This is more correct, and will likely remove the particular error you've just encountered:</p>\n\n<p>By the way, the commenter Pavan was correct, <code>:client</code> should be singular in your <code>.includes()</code> statement. That said, I also expanded it to include the Address table up front, which may have caused additional errors.</p>\n\n<pre><code># The .includes() parameters have been changed, and quotes have been added to the query.\nscope :agency_referrals, -&gt; (id, city_town) { includes(client: :address).where(agency_id: id, 'client.address.city_town' =&gt; city_town) }\n</code></pre>\n\n<p>Also, if you're looking for a non-string method of referencing the proper location (because this is Ruby, and we love our symbols), you could write this:</p>\n\n<pre><code>includes(:clients).where(agency_id: id, client: { address: { city_town: city_town } } =&gt; city_town)\n</code></pre>\n\n<p>I personally find this to be less clean, but it is a more \"modern\" format.</p>\n\n<p>For further reference, you may wish to review <a href=\"http://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-eager-loaded-associations\" rel=\"nofollow\">this documentation</a>.</p>\n"}], "owner": {"reputation": 129, "user_id": 2365503, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/018ab92a03ea161c5d74c913a27c32d0?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2365503/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3225, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455822201, "creation_date": 1455714123, "last_edit_date": 1455714765, "question_id": 35457500, "link": "https://stackoverflow.com/questions/35457500/rails-scope-with-nested-association", "title": "Rails scope with nested association", "body": "<p>I'm trying to get to grips with rails scopes.  I have the simple basics down but I'm trying to create a slightly more complex scope and I'm having some trouble.</p>\n\n<pre><code>class Client\n  has_many :referrals, through: :submissions\n  has_one :address\n  has_many :submissions\nend\n\nclass Submission\n    belongs_to :client\n    belongs_to :user\n    has_many :referrals, :inverse_of =&gt; :submission, dependent: :delete_all\nend\n\nclass Referral\n    belongs_to :branch\n    belongs_to :submission\n    has_one :client, through: :submission\nend\n\nclass Address\n    belongs_to :client\nend\n</code></pre>\n\n<p>I also have users created using devise.  I have a custom attribute added to users called <code>city_town</code>.</p>\n\n<p>When a user signs up, they select what city or town they are from and the agency that they work for.  When submissions are created, they take nested attributes for client details and address, as well as referral details. referrals take an agency_id that specifies where that referral is going to.</p>\n\n<p>What I'm trying to achieve is to create a scope that will collect all referrals where the <code>referral.client.address.city_town</code> matches the current user's city or town i.e: <code>current_user.city_town</code> and the agency_id of the referral matched the agency_id of the signed in user.</p>\n\n<p>In short, when a user signs in, they can see referrals only for their agency and area.</p>\n\n<p>So far I've got:</p>\n\n<pre><code>class Referral\n  scope :agency_referrals, -&gt; (id, city_town) { includes(:clients).where(agency_id: id, client.address.city_town =&gt; city_town) }\nend\n</code></pre>\n\n<p>but I'm painfully aware that this is far from correct. I get this error:</p>\n\n<pre><code>undefined local variable or method `client' for #&lt;Class:0x00000003200c08&gt;\n</code></pre>\n\n<p>Any idea where I'm going wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "rest", "devise"], "comments": [{"owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "edited": false, "score": 0, "creation_date": 1455714172, "post_id": 35457279, "comment_id": 58611254, "body": "Please have a look at <a href=\"http://blog.codebykat.com/2012/07/23/remote-api-authentication-with-rails-3-using-activeresource-and-devise/\" rel=\"nofollow noreferrer\">blog.codebykat.com/2012/07/23/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5460657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206686797761415/picture?type=large", "display_name": "Tom Kazakov", "link": "https://stackoverflow.com/users/5460657/tom-kazakov"}, "reply_to_user": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "edited": false, "score": 0, "creation_date": 1455717158, "post_id": 35457279, "comment_id": 58613405, "body": "@Shrikant1712, thanks! But it seems to me that that the article author completely redefines Devise session controller methods so it won&#39;t really answer my main question (why GET is working while DELETE is not)."}, {"owner": {"reputation": 69, "user_id": 7309070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WOyfGhnWU40/AAAAAAAAAAI/AAAAAAAAAB4/QH4chz2cmao/photo.jpg?sz=128", "display_name": "Kyle Anderson", "link": "https://stackoverflow.com/users/7309070/kyle-anderson"}, "edited": false, "score": 0, "creation_date": 1591313294, "post_id": 35457279, "comment_id": 110016903, "body": "I don&#39;t suppose you ever figured this one out? I&#39;m having this issue 4 years later. I&#39;ve got a button being rendered in react that sends a delete request to my logout URL, and right next to it I have a button rendered by rails that sends a delete request to the same URL. Only the rails one works, but both send the same request."}, {"owner": {"reputation": 69, "user_id": 7309070, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WOyfGhnWU40/AAAAAAAAAAI/AAAAAAAAAB4/QH4chz2cmao/photo.jpg?sz=128", "display_name": "Kyle Anderson", "link": "https://stackoverflow.com/users/7309070/kyle-anderson"}, "edited": false, "score": 0, "creation_date": 1591313929, "post_id": 35457279, "comment_id": 110017054, "body": "Nevermind, I did the naive thing and forgot to halt the redirect on button press with <code>e.preventDefault()</code>. Keeping my post in case someone else does the same."}], "owner": {"reputation": 1, "user_id": 5460657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206686797761415/picture?type=large", "display_name": "Tom Kazakov", "link": "https://stackoverflow.com/users/5460657/tom-kazakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 779, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1455713509, "creation_date": 1455713509, "question_id": 35457279, "link": "https://stackoverflow.com/questions/35457279/devise-sign-out-via-api-not-doing-anything", "title": "Devise sign_out via API not doing anything", "body": "<p>We've got a Rails 4.2.3 with Devise 3.5.5 for allowing Facebook auth.\nOur backend is accessed by iOS app and has a Rails web front-end. </p>\n\n<p>Both signing in and out is working properly on the web, signing in works absolutely fine also in the iOS app; but <strong>attempting DELETE request on <a href=\"http://BASE_URL/users/sign_out/\" rel=\"nofollow\">http://BASE_URL/users/sign_out/</a> makes no change in the user state</strong> \u2014 the session is not destroyed and the user is kept authorized. </p>\n\n<p>1) Web signing out conducted via the following template works properly:</p>\n\n<pre><code>&lt;%= link_to('Sign out', destroy_user_session_path, :method =&gt; :delete) %&gt;\n</code></pre>\n\n<p>2) When I request DELETE on /users/sign_out/ (using Paw or cURL) I get HTTP 204 (a proper answer for delete query as I get it).</p>\n\n<p>3) Devise sign out method is being accessed: I've set a logger triger in app/controllers/users/sessions_controller.rb <code>destroy</code> method and it give a log entry every time the request is made.</p>\n\n<p>4) When I change <code>config.sign_out_via</code> method to <code>:get</code> everything starts working as intended: the session gets terminated after GET /users/sign_out/ request.</p>\n\n<p>5) Just to cover all other solution avenues from similar StackOverflow questions I've checked that <code>#= require jquery_ujs</code> is in place.</p>\n\n<p>I was thinking about keeping deauth method on <code>:get</code> but as I understand it has two major flaws: CSRF insecurity and general non-restfulness of using GET to destroy an object.</p>\n\n<p>Please advise on what changes I can implement to investigate the issue and fix it!  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gmail-api", "google-cloud-pubsub"], "answers": [{"tags": [], "owner": {"reputation": 3356, "user_id": 1165922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e9eaacc54b335a56ea3008a67459a9?s=128&d=identicon&r=PG", "display_name": "Takashi Matsuo", "link": "https://stackoverflow.com/users/1165922/takashi-matsuo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455954885, "creation_date": 1455954885, "answer_id": 35520612, "question_id": 35457159, "link": "https://stackoverflow.com/questions/35457159/how-to-call-watch-using-pubsub-service-object-in-ruby-on-rails/35520612#35520612", "title": "How to call watch() using pubsub service object in Ruby on Rails", "body": "<p>You need to give publish permission on your topic to a service account <em>gmail-api-push@system.gserviceaccount.com</em>. For how to do this, please see:\n<a href=\"https://developers.google.com/gmail/api/guides/push#grant_publish_rights_on_your_topic\" rel=\"nofollow\">https://developers.google.com/gmail/api/guides/push#grant_publish_rights_on_your_topic</a></p>\n"}], "owner": {"reputation": 21, "user_id": 5757010, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b6627dabec04b90ff63ed74ca9258a70?s=128&d=identicon&r=PG&f=1", "display_name": "AJinkya", "link": "https://stackoverflow.com/users/5757010/ajinkya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455954885, "creation_date": 1455713192, "question_id": 35457159, "link": "https://stackoverflow.com/questions/35457159/how-to-call-watch-using-pubsub-service-object-in-ruby-on-rails", "title": "How to call watch() using pubsub service object in Ruby on Rails", "body": "<p>I am using google-api-client gem to integrate google services into my Rails application. with the scope of PubSub I am able to create topic and subscriptions in my a/c but I am facing issues while calling watch() method. Can anyone give me the flow to call watch method through service object like  below\n<a href=\"https://developers.google.com/gmail/api/v1/reference/users/watch\" rel=\"nofollow\">https://developers.google.com/gmail/api/v1/reference/users/watch</a></p>\n\n<p>Following is my script to get service object</p>\n\n<pre><code>pubsub_service = Google::Apis::PubsubV1::PubsubService.new\npubsub_service.client_options.application_name = APPLICATION_NAME\npubsub_service.authorization = authorize\n</code></pre>\n"}, {"tags": ["ruby", "heroku", "god"], "answers": [{"comments": [{"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1455776480, "post_id": 35457483, "comment_id": 58643115, "body": "I want it to start automatically without me when the script crashes. These looks like a manual process?"}], "tags": [], "owner": {"reputation": 2183, "user_id": 1200043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tr7dt.jpg?s=128&g=1", "display_name": "maniacalrobot", "link": "https://stackoverflow.com/users/1200043/maniacalrobot"}, "is_accepted": false, "score": 0, "last_activity_date": 1455714060, "creation_date": 1455714060, "answer_id": 35457483, "question_id": 35456913, "link": "https://stackoverflow.com/questions/35456913/how-to-run-auto-restart-in-heroku-for-ruby-scripts/35457483#35457483", "title": "How to run auto restart in heroku for ruby scripts", "body": "<p>Your processes should start automatically when you access your website.</p>\n\n<p>However, Heroku does provide commands to manage your processes, check out <a href=\"https://devcenter.heroku.com/articles/dynos\" rel=\"nofollow\">https://devcenter.heroku.com/articles/dynos</a> for the complete list. E.g., to restart all processes, use the toolbelt command:</p>\n\n<pre><code>heroku ps:restart --app yourappname\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1455776448, "post_id": 35464350, "comment_id": 58643100, "body": "I see. It doesn&#39;t crash often but it does. I will read up on sidekick."}, {"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1455776683, "post_id": 35464350, "comment_id": 58643217, "body": "Hi I didn&#39;t see anything on sidekiq. My app has a listener for input from Slack so needs to have the listener active and then run the script when it receives an inbound request. Sometimes the job that runs has issues so j want it to just restart since it means the input went awry."}, {"owner": {"reputation": 2211, "user_id": 3453, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/086f9df078dc5af0b999d88a6b41023a?s=128&d=identicon&r=PG", "display_name": "Nathan Lee", "link": "https://stackoverflow.com/users/3453/nathan-lee"}, "reply_to_user": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1455811086, "post_id": 35464350, "comment_id": 58665923, "body": "The worker and clock are just examples. Sidekiq probably isn&#39;t what you want for a slack listener. You can basically type any command after the colon, and Heroku will ensure that the script is restarted if it ends or crashes."}, {"owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "edited": false, "score": 0, "creation_date": 1455845146, "post_id": 35464350, "comment_id": 58683754, "body": "Ah okay. I see now. Thanks"}], "tags": [], "owner": {"reputation": 2211, "user_id": 3453, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/086f9df078dc5af0b999d88a6b41023a?s=128&d=identicon&r=PG", "display_name": "Nathan Lee", "link": "https://stackoverflow.com/users/3453/nathan-lee"}, "is_accepted": true, "score": 0, "last_activity_date": 1455810943, "last_edit_date": 1455810943, "creation_date": 1455732333, "answer_id": 35464350, "question_id": 35456913, "link": "https://stackoverflow.com/questions/35456913/how-to-run-auto-restart-in-heroku-for-ruby-scripts/35464350#35464350", "title": "How to run auto restart in heroku for ruby scripts", "body": "<p>On Heroku you shouldn't need to use a process supervisor like god. If all you need is to ensure your process is restarted if it crashes, Heroku can manage that fine. </p>\n\n<p>It should be as simple as adding two entries in your procfile as workers. <a href=\"https://devcenter.heroku.com/articles/background-jobs-queueing\" rel=\"nofollow\">https://devcenter.heroku.com/articles/background-jobs-queueing</a></p>\n\n<p><code>\nworker: bundle exec sidekiq\nclock: bundle exec clockwork lib/clock.rb\nslack_listener: bundle exec ruby lib/slack_bot.rb\n</code></p>\n\n<p>You could possibly have issues, if your processing are crashing quite often. <a href=\"https://devcenter.heroku.com/articles/dynos#dyno-crash-restart-policy\" rel=\"nofollow\">Dyno Crash Restart Policy</a></p>\n"}], "owner": {"reputation": 15386, "user_id": 92679, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/oJLsX.jpg?s=128&g=1", "display_name": "Satchel", "link": "https://stackoverflow.com/users/92679/satchel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 35464350, "answer_count": 2, "score": 0, "last_activity_date": 1455810943, "creation_date": 1455712558, "question_id": 35456913, "link": "https://stackoverflow.com/questions/35456913/how-to-run-auto-restart-in-heroku-for-ruby-scripts", "title": "How to run auto restart in heroku for ruby scripts", "body": "<p>In my Dev box on Nitrous, I am able to run <code>God -c scripts.god -D</code> to restart the two .rb files if they die. </p>\n\n<p>I just run that and the processes for the most part stay alive. </p>\n\n<p>But I cannot do the same in heroku. It seems when I run the <code>god</code> command the .god file does not open and generates an error in heroku. </p>\n\n<p>Question:</p>\n\n<p>How can I run God to restart failed processes in heroku as I do on my development Nitrous environment?</p>\n\n<p>Or is there a recommended alternative way to watch heroku processes and restart them automatically when they fail?</p>\n"}, {"tags": ["ruby", "ftp", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5350184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143eb9c6918c6a859a6147b77ac6c922?s=128&d=identicon&r=PG&f=1", "display_name": "Muzammal Abbas", "link": "https://stackoverflow.com/users/5350184/muzammal-abbas"}, "edited": false, "score": 0, "creation_date": 1455774088, "post_id": 35468216, "comment_id": 58642122, "body": "Thanks for the answer, but it is not working, here very almost 100 % similar is   url <a href=\"ftp://user:password@server/folder\" rel=\"nofollow noreferrer\">user:password@server/folder</a> A/folder B/file_name.ext"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 41, "user_id": 5350184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143eb9c6918c6a859a6147b77ac6c922?s=128&d=identicon&r=PG&f=1", "display_name": "Muzammal Abbas", "link": "https://stackoverflow.com/users/5350184/muzammal-abbas"}, "edited": false, "score": 0, "creation_date": 1455780126, "post_id": 35468216, "comment_id": 58644751, "body": "Having spaces seems likely to be related then. Does it work without the extra <code>URI.encode</code>? I assume you tried that already and added that in an attempt to fix things?"}, {"owner": {"reputation": 41, "user_id": 5350184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143eb9c6918c6a859a6147b77ac6c922?s=128&d=identicon&r=PG&f=1", "display_name": "Muzammal Abbas", "link": "https://stackoverflow.com/users/5350184/muzammal-abbas"}, "edited": false, "score": 0, "creation_date": 1455793061, "post_id": 35468216, "comment_id": 58652781, "body": "Yes, I have already given try to URI.encode. BTW without spaces I have the same issue as well."}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 41, "user_id": 5350184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143eb9c6918c6a859a6147b77ac6c922?s=128&d=identicon&r=PG&f=1", "display_name": "Muzammal Abbas", "link": "https://stackoverflow.com/users/5350184/muzammal-abbas"}, "edited": false, "score": 0, "creation_date": 1455820780, "post_id": 35468216, "comment_id": 58672498, "body": "Well then what I said above still stands. Put your actual URL in that snippet and make sure it returns true."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 0, "last_activity_date": 1455744818, "creation_date": 1455744818, "answer_id": 35468216, "question_id": 35456647, "link": "https://stackoverflow.com/questions/35456647/chef-remote-file-unable-to-download-file-from-ftp/35468216#35468216", "title": "Chef :: remote_file unable to download file from FTP", "body": "<p>I think you replaced too much of the real content. Probably something in the username, password, or hostname is causing a problem with the URI parsing.</p>\n\n<pre><code>&gt; URI.parse(\"ftp://user:password@server/folder/file.bak\").absolute?\ntrue\n</code></pre>\n\n<p>Get that working with whatever values you actually have and it should be fine.</p>\n"}], "owner": {"reputation": 41, "user_id": 5350184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143eb9c6918c6a859a6147b77ac6c922?s=128&d=identicon&r=PG&f=1", "display_name": "Muzammal Abbas", "link": "https://stackoverflow.com/users/5350184/muzammal-abbas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455744818, "creation_date": 1455711802, "question_id": 35456647, "link": "https://stackoverflow.com/questions/35456647/chef-remote-file-unable-to-download-file-from-ftp", "title": "Chef :: remote_file unable to download file from FTP", "body": "<p>I am developing a recipe to download some file from FTP server. I am successfully able authenticate the FTP server and fetching the list of the files. But when my chef is executed to download the files I am getting error.</p>\n\n<p>Here is code  </p>\n\n<pre><code>fileList.each do |file|\n  remote_file \"C:\\\\\" + file do\n    source URI::encode(\"ftp://user:password@server/folder/\" + file)\n    action :create_if_missing\n  end\nend\n</code></pre>\n\n<p>and here is  error's log</p>\n\n<pre><code>PS C:\\chef-repo&gt; chef-apply .\\cookbooks\\visireview-sqlserver-config\\recipes\\ftp_restore_db.rb\n[2016-02-17T17:14:20+05:00] WARN: ftp://user:password@server/folder/file.bak was an invalid URI. Trying to escape invalid characters\n[2016-02-17T17:14:20+05:00] FATAL: Stacktrace dumped to C:/chef/cache/chef-stacktrace.out\n[2016-02-17T17:14:20+05:00] FATAL: Chef::Exceptions::InvalidRemoteFileURI: \"ftp://user:password@server/folder/file.bak\" is not a valid `source` parameter for remote_file. `source` must be an absolute URI or an array of URIs.\n</code></pre>\n\n<p>Please spare some of your previous time and help me to get rid of this issue.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby", "activerecord"], "comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455712137, "post_id": 35456458, "comment_id": 58609783, "body": "I came from worse but the number of colors could rise and repetitions in code aren&#39;t nice, also if there was a way to do everything in one update (and keep being readable) it would execute faster"}], "answers": [{"comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1455720206, "post_id": 35456848, "comment_id": 58615813, "body": "more DRY yes, but you can&#39;t use a constant for color_dependencies, otherwise error &#39;dynamic constant assignment&#39;, the updates are still one after the other though"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1455723377, "post_id": 35456848, "comment_id": 58618299, "body": "Also worth noting that this would be a great candidate for wrapping in <code>Signal.transaction do ... end</code> to make sure this happens in one shot, not stalling out half-way through for whatever reason or tripping up over other instances of the same code."}, {"owner": {"reputation": 344, "user_id": 1306709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e85eb7621b90a4ef6bde85446094c8?s=128&d=identicon&r=PG", "display_name": "Borys Pylhun", "link": "https://stackoverflow.com/users/1306709/borys-pylhun"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1455723392, "post_id": 35456848, "comment_id": 58618305, "body": "@peter, you&#39;re right. I replaced it by variable, so <code>color_dependencies</code> can be modified later in code if needed."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1455877056, "post_id": 35456848, "comment_id": 58696659, "body": "a pity the first reset can&#39;t be added in the hash and not verything is done in one sweep. for the moment I&#39;m gonna accept your answer since it gives at least part of the sollution"}, {"owner": {"reputation": 344, "user_id": 1306709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e85eb7621b90a4ef6bde85446094c8?s=128&d=identicon&r=PG", "display_name": "Borys Pylhun", "link": "https://stackoverflow.com/users/1306709/borys-pylhun"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1455885462, "post_id": 35456848, "comment_id": 58702127, "body": "@peter you can also wrap it in Signal.transaction like @tadman said (more info: <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/Transactions/&hellip;</a>). In this case it will be faster than doing separated <code>update_all</code> queries because all requests will be done in single database <code>BEGIN....COMMIT</code> block instead of multiple. And this is more safely because will be rolled back if something goes wrong. Here is more aboout that in mysql: <a href=\"http://www.tutorialspoint.com/mysql/mysql-transactions.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/mysql/mysql-transactions.htm</a>"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1455887574, "post_id": 35456848, "comment_id": 58703289, "body": "@boris&amp;tadman: I read about that but it wasn&#39;t clear to me what the speed benefit would be, and the safety isn&#39;t an issue here, i&#39;ll do a few benchmarks, thanks for the update"}], "tags": [], "owner": {"reputation": 344, "user_id": 1306709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e85eb7621b90a4ef6bde85446094c8?s=128&d=identicon&r=PG", "display_name": "Borys Pylhun", "link": "https://stackoverflow.com/users/1306709/borys-pylhun"}, "is_accepted": true, "score": 3, "last_activity_date": 1455723135, "last_edit_date": 1455723135, "creation_date": 1455712378, "answer_id": 35456848, "question_id": 35456458, "link": "https://stackoverflow.com/questions/35456458/combined-updates-in-ruby-activerecord/35456848#35456848", "title": "Combined updates in Ruby Activerecord", "body": "<p>Probably you could do it more <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow\">DRY</a> and use hash style for arguments instead string in <code>update_all</code>:</p>\n\n<pre><code># reset all color fields to null\nSignal.where.not(color: nil).update_all(color: nil)\n# set color field based on status\ncolor_dependencies = {\n  CONFIG.status.step3 =&gt; 'o', \n  CONFIG.status.step4 =&gt; 'r', \n  CONFIG.status.manual =&gt; 'y'\n}\n\ncolor_dependencies.each do |status, color| \n  Signal.where(status: status).update_all(color: color) \nend\n</code></pre>\n"}], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 1, "accepted_answer_id": 35456848, "answer_count": 1, "score": 1, "last_activity_date": 1455723135, "creation_date": 1455711335, "question_id": 35456458, "link": "https://stackoverflow.com/questions/35456458/combined-updates-in-ruby-activerecord", "title": "Combined updates in Ruby Activerecord", "body": "<p>Is there a better way to do multiple updates in Ruby Activerecord (not Rails) as to what I do here ? I don't want to loop over all the records and work with if's or case's.</p>\n\n<pre><code># reset all color fields to null\nSignal.where.not(color: nil).update_all(\"color = null\")\n# set color field based on status\nSignal.where(status: CONFIG.status.step3).update_all(\"color = 'o'\")\nSignal.where(status: CONFIG.status.step4).update_all(\"color = 'r'\")\nSignal.where(status: CONFIG.status.manual).update_all(\"color = 'y'\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "xlsx", "axlsx"], "answers": [{"tags": [], "owner": {"reputation": 1995, "user_id": 1011964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c74ae7d92a97e1fe53489f66c32a718?s=128&d=identicon&r=PG", "display_name": "noel", "link": "https://stackoverflow.com/users/1011964/noel"}, "is_accepted": false, "score": 0, "last_activity_date": 1455889100, "creation_date": 1455889100, "answer_id": 35506697, "question_id": 35456156, "link": "https://stackoverflow.com/questions/35456156/error-handling-for-gem-axlsx-rails/35506697#35506697", "title": "Error handling for gem &#39;axlsx_rails&#39;", "body": "<p>It has to do with <code>customer.name</code> and your sheet name. It is limited to 31 characters, and occasionally you have customer names that are longer. Use <code>customer.name[0,31]</code> or some other method to ensure length.</p>\n\n<p>The spreadsheet spec also limits what characters can go in a sheet name. I've not been able to find a specific example this morning. But if you strip the name to a-zA-Z1-9 and - you should get by.</p>\n"}], "owner": {"reputation": 3288, "user_id": 3128796, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a938da1334bd8a4de72edfe2740ac6e0?s=128&d=identicon&r=PG", "display_name": "asdfkjasdfjk", "link": "https://stackoverflow.com/users/3128796/asdfkjasdfjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455889100, "creation_date": 1455710460, "question_id": 35456156, "link": "https://stackoverflow.com/questions/35456156/error-handling-for-gem-axlsx-rails", "title": "Error handling for gem &#39;axlsx_rails&#39;", "body": "<p>So I am using this gem <code>axlsx_rails</code> for exporting some data in excel file. But sometimes I get error like forbidden character as name or name exceed 31 character size. I don't understand how to handle these errors. All I want is to render index again if such error occurs and show a flash message. My current code is below</p>\n\n<pre><code>Class CustomersController\ndef index\n    @customers = Customer.all\n    respond_to do |format|\n      format.html # index.html.erb\n      format.xls\n      format.xlsx\n    end\n  end\nend\n</code></pre>\n\n<p>and index.xlsx.axlsx</p>\n\n<pre><code> wb = xlsx_package.workbook\n    @customers = Customer.all\n    @customers.each do |customer|\n        wb.add_worksheet(name: customer.name) do |sheet|\n        sheet.add_row [\"Name\", ...... ]\n        .\n        .\n        .\n   end\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 5935504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/310143e5281100b727b8b2d350f6f380?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Sharma", "link": "https://stackoverflow.com/users/5935504/mahesh-sharma"}, "edited": false, "score": 0, "creation_date": 1455715977, "post_id": 35456331, "comment_id": 58612554, "body": "Thanks for your reply....but i want index page to behave as our form,which looks like table,in which we can fill our data and submit it and save it in database."}, {"owner": {"reputation": 1217, "user_id": 5511520, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/baaabef4e4f62eee165869427acd0472?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Belyakov", "link": "https://stackoverflow.com/users/5511520/mike-belyakov"}, "reply_to_user": {"reputation": 191, "user_id": 5935504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/310143e5281100b727b8b2d350f6f380?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Sharma", "link": "https://stackoverflow.com/users/5935504/mahesh-sharma"}, "edited": false, "score": 0, "creation_date": 1455741820, "post_id": 35456331, "comment_id": 58630290, "body": "Anyway you will edit form one by one. And if you want to make accessible editing on index- edit <code>index</code> action, add links for edit 1 element, etc. If you want to use db injection- use said tools in the answer. Maybe you question is not clear enough and you need to clear it out?"}], "tags": [], "owner": {"reputation": 1217, "user_id": 5511520, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/baaabef4e4f62eee165869427acd0472?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Belyakov", "link": "https://stackoverflow.com/users/5511520/mike-belyakov"}, "is_accepted": false, "score": 0, "last_activity_date": 1455710949, "creation_date": 1455710949, "answer_id": 35456331, "question_id": 35455892, "link": "https://stackoverflow.com/questions/35455892/how-to-fetch-data-in-tabular-form-in-new-page/35456331#35456331", "title": "How to fetch data in tabular form in _new page", "body": "<p>You can read all needed information from file and parse it into the array of objects, and then use <a href=\"https://github.com/zdennis/activerecord-import\" rel=\"nofollow\">https://github.com/zdennis/activerecord-import</a> gem for insert it in db (for production).</p>\n\n<p>also, you may look into <code>db/seeds.rb</code> file for adding new data in develop.</p>\n"}], "owner": {"reputation": 191, "user_id": 5935504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/310143e5281100b727b8b2d350f6f380?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Sharma", "link": "https://stackoverflow.com/users/5935504/mahesh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455710978, "creation_date": 1455709751, "last_edit_date": 1455710978, "question_id": 35455892, "link": "https://stackoverflow.com/questions/35455892/how-to-fetch-data-in-tabular-form-in-new-page", "title": "How to fetch data in tabular form in _new page", "body": "<p>I'm creating a project in ruby on rails. Is it possible to add data just like normal form and save them in database in show page? Is it possible to add data in tabular form and let the user save the data in batch (i.e. 5-6 record at a time) for the same employee? If so, then how can I achieve this functionality?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "edited": false, "score": 0, "creation_date": 1455714414, "post_id": 35456398, "comment_id": 58611443, "body": "Can you explain on how to update the object in the model?"}], "tags": [], "owner": {"reputation": 1217, "user_id": 5511520, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/baaabef4e4f62eee165869427acd0472?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Belyakov", "link": "https://stackoverflow.com/users/5511520/mike-belyakov"}, "is_accepted": false, "score": 0, "last_activity_date": 1455711148, "creation_date": 1455711148, "answer_id": 35456398, "question_id": 35455808, "link": "https://stackoverflow.com/questions/35455808/calculating-and-inserting-value-into-table-column-using-rails/35456398#35456398", "title": "Calculating and inserting value into table column using rails", "body": "<p>You need to put this functionality to the model and update object before rendering (if i understood you right). Now you never save the changes into the object.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "edited": false, "score": 0, "creation_date": 1455714868, "post_id": 35456556, "comment_id": 58611779, "body": "Hi @huyhoang.framgiavn, I&#39;ve tried this before but the values in the views are not updated. It returns the same value I posted while submitting the form."}, {"owner": {"reputation": 255, "user_id": 5242684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2cf7b1d29ee68f2fd83175179849db?s=128&d=identicon&r=PG", "display_name": "huyhoang-vn", "link": "https://stackoverflow.com/users/5242684/huyhoang-vn"}, "reply_to_user": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "edited": false, "score": 0, "creation_date": 1455763091, "post_id": 35456556, "comment_id": 58638756, "body": "@user1690913 ok. I saw a bug at here. that is you using format :  transaction_params[:cashbox] = cashbox.to_s. Let instead all expresses have this type to   params[:transaction][:cashbox] = cashbox.to_s"}], "tags": [], "owner": {"reputation": 255, "user_id": 5242684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2cf7b1d29ee68f2fd83175179849db?s=128&d=identicon&r=PG", "display_name": "huyhoang-vn", "link": "https://stackoverflow.com/users/5242684/huyhoang-vn"}, "is_accepted": false, "score": 0, "last_activity_date": 1455711572, "creation_date": 1455711572, "answer_id": 35456556, "question_id": 35455808, "link": "https://stackoverflow.com/questions/35455808/calculating-and-inserting-value-into-table-column-using-rails/35456556#35456556", "title": "Calculating and inserting value into table column using rails", "body": "<p>Your logic is confuse, let read more resful of rails.<br>\n- First: you can't save, after that create Transaction again.<br>\n- Second: you created transaction and below don't see updating that transaction should of course it be not changed.</p>\n\n<p><br><br>\nLet try yourself:<br></p>\n\n<pre><code>def create      \n\n    @amount = transaction_params[:amount].to_f\n    @cashbox = transaction_params[:cashbox].to_f\n    @bank = transaction_params[:bank].to_f\n\n    if transaction_params[:t_type] == \"Debit\"\n        if transaction_params[:t_method] == \"Cash\"\n            @cashbox -= @amount\n            transaction_params[:cashbox] = @cashbox.to_s\n\n        else\n            @bank -= @amount\n            transaction_params[:bank] = @bank.to_s\n\n        end\n    elsif transaction_params[:t_type] == \"Credit\"\n        if transaction_params[:t_method] == \"Cash\"\n            @cashbox += @amount\n            transaction_params[:cashbox] = @cashbox.to_s\n\n        else\n            @bank += @amount\n            transaction_params[:bank] = @bank.to_s\n\n        end\n    end\n\n    @transaction = Transaction.new transaction_params\n    if @transaction.save\n      redirect_to @transaction\n    else\n      render 'new'\n    end\n</code></pre>\n\n<p>end</p>\n\n<p>def transaction_params\n    params.require(:transaction).permit(:date, :notes, :t_type, :t_method, :amount, :paid_by, :paid_to, :cashbox, :bank, :house_id, :expense_for)\nend`</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "edited": false, "score": 0, "creation_date": 1455714244, "post_id": 35456699, "comment_id": 58611307, "body": "Hi @Shadwell, to be precise, When I submit the form, I need to update the values of :cashbox and :bank to the new value( value after debit/credit from amount) and insert it into the table. Right now, the data submitted in the form is what is displayed in the view. Also can you precisely explain how to do this?"}, {"owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "reply_to_user": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "edited": false, "score": 0, "creation_date": 1455718334, "post_id": 35456699, "comment_id": 58614290, "body": "No, sorry, precisely explaining how to do that is way outside the scope of a question on here. I&#39;d basically be writing your code for you."}, {"owner": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "edited": false, "score": 0, "creation_date": 1455718623, "post_id": 35456699, "comment_id": 58614520, "body": "No, I didn&#39;t ask you to write the code for me. I&#39;ve ported the code to a new method in my Transaction model. How can I reference this method to print the updated value?"}], "tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": false, "score": 0, "last_activity_date": 1455711959, "creation_date": 1455711959, "answer_id": 35456699, "question_id": 35455808, "link": "https://stackoverflow.com/questions/35455808/calculating-and-inserting-value-into-table-column-using-rails/35456699#35456699", "title": "Calculating and inserting value into table column using rails", "body": "<p>You've got a few things in a bit of a muddle I think:</p>\n\n<p>1) <code>if @transaction.save</code></p>\n\n<p>Here you're trying to save the transaction and only continuing if you do so successfully. Where is <code>@transaction</code> getting set up though? Presumably in some kind of <code>before_filter</code> but I suspect you don't need that in this case.</p>\n\n<p>2) <code>@transaction = Transaction.create(transaction_params)</code></p>\n\n<p>Now you're creating, and saving to the database, a new <code>Transaction</code> object base on the parameters that are being submitted from the form (but only if it passes validation).</p>\n\n<p>3) Then you do a load of work to calculate some parameters that appear to be transaction parameters. At this point though you've already created the transaction object with the parameters that were submitted. You add all these to the <code>params</code> hash which is predominantly used to pass web request parameters in (yes, you can use it for other things but I'd avoid doing that just yet).</p>\n\n<p>Now, the most simple fix is probably to move your <code>Transaction.create</code> line to after all your params changes because then you'll be creating a transaction with the parameters you want. I wouldn't advocate that though. It seems like this code would be better moved to the Transaction model and have a method to apply the values to a transaction after you've built it. </p>\n\n<p>(I'd also question if you've got your modelling quite right. You seem to be passing in a <code>@bank</code> value as part of the web request and then applying the value of the transaction your creating to it to give your bank value on the transaction. Of course, I'm not sure of your exact requirements but this seems like a potentially problematic approach. One for a different question perhaps).</p>\n"}], "owner": {"reputation": 145, "user_id": 1690913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbe72c30e4f6020549c1cc674e62d1f?s=128&d=identicon&r=PG", "display_name": "Ramesh N", "link": "https://stackoverflow.com/users/1690913/ramesh-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1455714510, "creation_date": 1455709539, "last_edit_date": 1455714510, "question_id": 35455808, "link": "https://stackoverflow.com/questions/35455808/calculating-and-inserting-value-into-table-column-using-rails", "title": "Calculating and inserting value into table column using rails", "body": "<p>Hi I'm a newbie to Rails. So pardon if this is a silly question.</p>\n\n<p>I'm working on a project where I need to calculate the Bank Balance and Cashbox balance in a Transaction. So this depends upon the type of transaction \"Debit/Credit\" and type of payment \"Online Payment/Cheque/Cash\". There is only one model involved and that is Transaction Model and transactions table. So this is what I'm doing,</p>\n\n<p>transactions_controller</p>\n\n<pre><code>def create      \n\n        @transaction = Transaction.create(transaction_params)\n\n        @amount = transaction_params[:amount].to_f\n        @cashbox = transaction_params[:cashbox].to_f\n        @bank = transaction_params[:bank].to_f\n\n        if transaction_params[:t_type] == \"Debit\"\n            if transaction_params[:t_method] == \"Cash\"\n                @cashbox -= @amount\n                transaction_params[:cashbox] = @cashbox.to_s\n\n            else\n                @bank -= @amount\n                transaction_params[:bank] = @bank.to_s\n\n            end\n        elsif transaction_params[:t_type] == \"Credit\"\n            if transaction_params[:t_method] == \"Cash\"\n                @cashbox += @amount\n                transaction_params[:cashbox] = @cashbox.to_s\n\n            else\n                @bank += @amount\n                transaction_params[:bank] = @bank.to_s\n\n            end\n        end\n\n    if @transaction.save\n        redirect_to @transaction\n    else\n        render 'new'\n    end\nend\n\ndef transaction_params\n    params.require(:transaction).permit(:date, :notes, :t_type, :t_method, :amount, :paid_by, :paid_to, :cashbox, :bank, :house_id, :expense_for)\nend`\n</code></pre>\n\n<p>Transaction Model</p>\n\n<pre><code>class Transaction &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>But when I submit the form containing all the values, the calculation part does't happen and rails inserts only the values submitted in the form.</p>\n\n<p>How to calculate cashbox balance and bank balance on submit from the form  and store the updated values in the table?\nAlso, kindly suggest if there are any better ways to do this.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1455714229, "post_id": 35455480, "comment_id": 58611298, "body": "Why do you want to do that?"}, {"owner": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1455720092, "post_id": 35455480, "comment_id": 58615727, "body": "I am assessing elements in array to multiple conditions with &#39;delete_if&#39; &amp; &#39;keep_if&#39; to get the state but I don&#39;t want original array to change. But clone worked just fine."}], "answers": [{"comments": [{"owner": {"reputation": 2886, "user_id": 2660531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75352c499497b518d2d5f67d6b6066c0?s=128&d=identicon&r=PG", "display_name": "rdubya", "link": "https://stackoverflow.com/users/2660531/rdubya"}, "reply_to_user": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "edited": false, "score": 0, "creation_date": 1455795583, "post_id": 35455731, "comment_id": 58654426, "body": "@JakubZak After seeing your comment on the question, you may not need to use clone. If you use reject and select instead of delete_if and keep_if (respectively) they will return a new array with only the items you want."}, {"owner": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "edited": false, "score": 0, "creation_date": 1455795652, "post_id": 35455731, "comment_id": 58654468, "body": "Ended up doing exactly that, did clone first and then replaced it with select and reject. Thank you for comment though."}], "tags": [], "owner": {"reputation": 2886, "user_id": 2660531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75352c499497b518d2d5f67d6b6066c0?s=128&d=identicon&r=PG", "display_name": "rdubya", "link": "https://stackoverflow.com/users/2660531/rdubya"}, "is_accepted": true, "score": 2, "last_activity_date": 1455709335, "creation_date": 1455709335, "answer_id": 35455731, "question_id": 35455480, "link": "https://stackoverflow.com/questions/35455480/shortcut-to-map-an-array-to-exactly-the-same-array/35455731#35455731", "title": "Shortcut to map an array to exactly the same array", "body": "<p>I'm not sure if this is what you are trying to do, but it sounds like you could use the <code>clone</code> method <a href=\"http://ruby-doc.org/core-2.3.0/Object.html#method-i-clone\" rel=\"nofollow\">docs</a>. i.e. <code>array.clone</code> </p>\n"}, {"tags": [], "owner": {"reputation": 1217, "user_id": 5511520, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/baaabef4e4f62eee165869427acd0472?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Belyakov", "link": "https://stackoverflow.com/users/5511520/mike-belyakov"}, "is_accepted": false, "score": 0, "last_activity_date": 1455709461, "creation_date": 1455709461, "answer_id": 35455777, "question_id": 35455480, "link": "https://stackoverflow.com/questions/35455480/shortcut-to-map-an-array-to-exactly-the-same-array/35455777#35455777", "title": "Shortcut to map an array to exactly the same array", "body": "<p>If you have some strings array, you can do</p>\n\n<pre><code>pry(main)&gt; a.map{|x| eval x}\n=&gt; [4]\n</code></pre>\n\n<p>But <code>eval</code> is not a string method. In this case you'll need put a var in <code>map</code>. </p>\n\n<p>also, i think this code will speak better than me</p>\n\n<pre><code>2.3.0 :001 &gt; a=[]\n =&gt; [] \n2.3.0 :002 &gt; b=def foo\n2.3.0 :003?&gt;   2+2\n2.3.0 :004?&gt;   end\n =&gt; :foo \n2.3.0 :005 &gt; a&lt;&lt;b\n =&gt; [:foo] \n2.3.0 :006 &gt; a.map{&amp;:send}\nSyntaxError: (irb):6: syntax error, unexpected &amp;\na.map{&amp;:send}\n       ^\n        from /home/kvokka/.rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'\n2.3.0 :007 &gt; a.map{|x| send x}\n =&gt; [4] \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "edited": false, "score": 0, "creation_date": 1455709638, "post_id": 35455803, "comment_id": 58608064, "body": "You can&#39;t: ``map&#39;: undefined method <code>itself&#39; for 1:Fixnum (NoMethodError)</code>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "edited": false, "score": 0, "creation_date": 1455709825, "post_id": 35455803, "comment_id": 58608188, "body": "@JakubZak Cannot be reproduced. If you are using an old Ruby, you should specifically mention so in the question."}, {"owner": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "edited": false, "score": 0, "creation_date": 1455709901, "post_id": 35455803, "comment_id": 58608244, "body": "<code>require &quot;pp&quot;</code>       <code>a = [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;]</code>      <code>b = a.map(&amp;:itself).keep_if { |n| n == &quot;4&quot;}</code>       <code>pp a</code>      <code>pp b</code>       <code>a = [1,2,3,4,5]</code>      <code>b = a.map(&amp;:itself).keep_if { |n| n == 4}</code>       <code>pp a</code>      <code>pp b</code> `"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1455709530, "creation_date": 1455709530, "answer_id": 35455803, "question_id": 35455480, "link": "https://stackoverflow.com/questions/35455480/shortcut-to-map-an-array-to-exactly-the-same-array/35455803#35455803", "title": "Shortcut to map an array to exactly the same array", "body": "<p>Yes. You can do this:</p>\n\n<pre><code>array.map(&amp;:itself)\n</code></pre>\n"}], "owner": {"reputation": 1412, "user_id": 524226, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/J9KIG.jpg?s=128&g=1", "display_name": "Jakub Zak", "link": "https://stackoverflow.com/users/524226/jakub-zak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 35455731, "answer_count": 3, "score": -2, "last_activity_date": 1455709754, "creation_date": 1455708635, "last_edit_date": 1455709754, "question_id": 35455480, "link": "https://stackoverflow.com/questions/35455480/shortcut-to-map-an-array-to-exactly-the-same-array", "title": "Shortcut to map an array to exactly the same array", "body": "<p>Is there some way to use syntax similar to:</p>\n\n<pre><code>array.map(&amp;:some_method)\n</code></pre>\n\n<p>to map elements to themselves, so that it would be equivalent to the following?</p>\n\n<pre><code>array.map{ |x| x }\n</code></pre>\n\n<p>So something like this (pseudocode):</p>\n\n<pre><code>array.map(&amp;:self)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hashmap"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1455708852, "post_id": 35455369, "comment_id": 58607524, "body": "Not clear what you mean by &quot;merged array of all hash keys of <code>:b</code>&quot;. Do you mean all array values corresponding to the key <code>:b</code>?"}, {"owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1455709146, "post_id": 35455369, "comment_id": 58607722, "body": "@sawa :b is a hash key mapping to an array inside of a hash, which is part of a collection of hashes inside of an array"}, {"owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1455716215, "post_id": 35455369, "comment_id": 58612711, "body": "Dear downvoters and &#39;close answer&#39; voters, I hope I have now provided a thorough explanation to my issue. I hope this answer can stay open!"}], "answers": [{"comments": [{"owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "edited": false, "score": 0, "creation_date": 1455720532, "post_id": 35455494, "comment_id": 58616086, "body": "Works great, thanks you! I prefer @sschmeck&#39;s answer though since it is a bit more readable."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 1, "last_activity_date": 1455709398, "last_edit_date": 1455709398, "creation_date": 1455708667, "answer_id": 35455494, "question_id": 35455369, "link": "https://stackoverflow.com/questions/35455369/from-an-array-of-hashes-merge-all-array-values-of-a-specific-hash-key/35455494#35455494", "title": "From an array of hashes, merge all array values of a specific hash key", "body": "<p>You can use <code>each_with_object</code> method for it:</p>\n\n<pre><code>array = [{:a=&gt;'b',:b=&gt;['z','a']},{:a=&gt;'z', :b=&gt;['t','r']}]\n\narray.each_with_object([]) do |hash, memo|\n  memo.push(*hash[:b])\nend\n#=&gt; [\"z\", \"a\", \"t\", \"r\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "is_accepted": true, "score": 5, "last_activity_date": 1455709660, "creation_date": 1455709660, "answer_id": 35455851, "question_id": 35455369, "link": "https://stackoverflow.com/questions/35455369/from-an-array-of-hashes-merge-all-array-values-of-a-specific-hash-key/35455851#35455851", "title": "From an array of hashes, merge all array values of a specific hash key", "body": "<p>Try <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-flat_map\"><code>flat_map</code></a>.</p>\n\n<pre><code>x = [{:a =&gt; 'b', :b =&gt; ['z', 'a']}, {:a =&gt; 'z', :b =&gt; ['t', 'r']}]\nx.flat_map { |e| e[:b] }\n#=&gt; [\"z\", \"a\", \"t\", \"r\"]\n</code></pre>\n"}], "owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 3, "accepted_answer_id": 35455851, "answer_count": 2, "score": 0, "last_activity_date": 1455716708, "creation_date": 1455708339, "last_edit_date": 1455716708, "question_id": 35455369, "link": "https://stackoverflow.com/questions/35455369/from-an-array-of-hashes-merge-all-array-values-of-a-specific-hash-key", "title": "From an array of hashes, merge all array values of a specific hash key", "body": "<p>I have the following array:</p>\n\n<pre><code>[{:a =&gt; 'b', :b =&gt; ['z', 'a', ...]}, ..., {:a =&gt; 'z', :b =&gt; ['t', 'r', ...]}]\n</code></pre>\n\n<p>I would like to obtain a merged array of all array values corresponding to the key of <code>:b</code> such as this:</p>\n\n<pre><code>['z', 'a', 't', 'r', ... ]\n</code></pre>\n\n<p><em>(<code>:b</code> will not hold any duplicates)</em></p>\n\n<p>I tried <code>reduce(&amp;:deep_merge)</code>, but it didn't seem to do what I want. An answer with Rails 'magic' would be preferred, but vanilla Ruby would also be great and appreciated.</p>\n"}, {"tags": ["ruby", "comments"], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 3, "last_activity_date": 1455708568, "creation_date": 1455708568, "answer_id": 35455464, "question_id": 35455333, "link": "https://stackoverflow.com/questions/35455333/multi-line-comments-leads-to-unexpected-tidentifier/35455464#35455464", "title": "Multi-line comments leads to unexpected tIDENTIFIER", "body": "<p>Start and end of multiline comments must be placed at the beginning of a line.</p>\n"}], "owner": {"reputation": 3597, "user_id": 2720802, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3e83c57a6c8a455b27ac8df7ef64a2e2?s=128&d=identicon&r=PG", "display_name": "setevoy", "link": "https://stackoverflow.com/users/2720802/setevoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 35455464, "answer_count": 1, "score": -2, "last_activity_date": 1455715407, "creation_date": 1455708249, "last_edit_date": 1495541270, "question_id": 35455333, "link": "https://stackoverflow.com/questions/35455333/multi-line-comments-leads-to-unexpected-tidentifier", "title": "Multi-line comments leads to unexpected tIDENTIFIER", "body": "<p>I am trying to add a few <code>&gt;&gt;&gt; DocStrings</code>. Here is a piece of my code:</p>\n\n<pre><code>def service_destroy(service)\n\n    =begin\n        service_check(service) retun 0 || 1\n        1 if service up and running\n        0 otherwise\n    =end\n\n    ...\n</code></pre>\n\n<p>According to <a href=\"http://ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/syntax.html#comment\" rel=\"nofollow noreferrer\">documentation</a> and other <a href=\"https://stackoverflow.com/questions/2989762/multi-line-comments-in-ruby\">questions</a>, it must be ignored, but I have a syntax error:</p>\n\n<pre><code>syntax error, unexpected '='\n    =begin\n     ^\n</code></pre>\n"}, {"tags": ["ruby", "string"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 1, "creation_date": 1455708957, "post_id": 35455354, "comment_id": 58607573, "body": "In the string I get this character \\."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 1, "creation_date": 1455709598, "post_id": 35455354, "comment_id": 58608027, "body": "I had to do it like this        sample_string = sample_string.tr(&quot;\\\\&quot;, &quot;&quot;) and then        sample_string = sample_string.tr(&quot;/*[]:?&quot;, &quot;&quot;). For some reason, if I do it in single line I get this character &quot;/&quot; always in the string."}, {"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 1, "creation_date": 1455710586, "post_id": 35455354, "comment_id": 58608695, "body": "Try <code>tr(&quot;&#47;*[]:?\\\\&quot;, &quot;&quot;)</code> instead. Check the <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-tr\" rel=\"nofollow noreferrer\">documentation</a> for details."}, {"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 1, "creation_date": 1455713246, "post_id": 35455354, "comment_id": 58610592, "body": "@sawa The the backslash must be placed at the end."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 1, "last_activity_date": 1455714024, "last_edit_date": 1455714024, "creation_date": 1455708310, "answer_id": 35455354, "question_id": 35455302, "link": "https://stackoverflow.com/questions/35455302/remove-certain-characters-from-string-in-ruby/35455354#35455354", "title": "Remove certain characters from string in Ruby", "body": "<pre><code>sample_string.tr(\"/*[]:?\\\\\", \"\")\n# =&gt; \" dfs s asdf\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1455715148, "creation_date": 1455715148, "answer_id": 35457868, "question_id": 35455302, "link": "https://stackoverflow.com/questions/35455302/remove-certain-characters-from-string-in-ruby/35457868#35457868", "title": "Remove certain characters from string in Ruby", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-delete\" rel=\"nofollow\"><code>String#delete!</code></a>. To backslash character <code>\\</code> has special meaning and must appear at the end.</p>\n\n<pre><code>sample_string = '/\\\\sdfs s*[]: asdf?'\n\nsample_string.delete! '/*[]:?\\\\'\n\nsample_string #=&gt; \"sdfs s asdf\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 35455354, "answer_count": 2, "score": 0, "last_activity_date": 1455715644, "creation_date": 1455708187, "last_edit_date": 1455715644, "question_id": 35455302, "link": "https://stackoverflow.com/questions/35455302/remove-certain-characters-from-string-in-ruby", "title": "Remove certain characters from string in Ruby", "body": "<p>I have a string that contains the following characters:\n<code>\\</code>, <code>/</code>, <code>*</code>, <code>[</code>, <code>]</code>, <code>:</code> and <code>?</code></p>\n\n<p>For example, I have string variable as</p>\n\n<pre><code> sample_string = \"/\\\\sdfs s*[]: asdf?\"\n</code></pre>\n\n<p>I want to remove the above mentioned characters from <code>sample_string</code>. How can I do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "ruby-on-rails-4", "erb"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5930376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35ddca322137d94b2523901d6f626ee3?s=128&d=identicon&r=PG&f=1", "display_name": "domburford", "link": "https://stackoverflow.com/users/5930376/domburford"}, "edited": false, "score": 0, "creation_date": 1455718615, "post_id": 35457209, "comment_id": 58614512, "body": "Hi Richard - You are a true hero! I created a single table with a Url column, Text column, as well as an Order column (type integer). However, when I add the line &quot;&lt;%= t.hidden_field :order, t.index %&gt;&quot; it comes up with this error in the console referencing that line: &quot;undefined method `merge&#39; for nil:NilClass&quot; - not quite sure how to proceed..."}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 99, "user_id": 5930376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35ddca322137d94b2523901d6f626ee3?s=128&d=identicon&r=PG&f=1", "display_name": "domburford", "link": "https://stackoverflow.com/users/5930376/domburford"}, "edited": false, "score": 0, "creation_date": 1455718693, "post_id": 35457209, "comment_id": 58614579, "body": "Interesting, can you post a screenshot?"}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 99, "user_id": 5930376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35ddca322137d94b2523901d6f626ee3?s=128&d=identicon&r=PG&f=1", "display_name": "domburford", "link": "https://stackoverflow.com/users/5930376/domburford"}, "edited": false, "score": 0, "creation_date": 1455719849, "post_id": 35457209, "comment_id": 58615531, "body": "Okay so you do have an <code>order</code> attribute - have you used <code>accepts_nested_attributes_for</code> from <code>Post accepts_nested_attributes_for :things</code>?"}, {"owner": {"reputation": 99, "user_id": 5930376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35ddca322137d94b2523901d6f626ee3?s=128&d=identicon&r=PG&f=1", "display_name": "domburford", "link": "https://stackoverflow.com/users/5930376/domburford"}, "edited": false, "score": 0, "creation_date": 1455721109, "post_id": 35457209, "comment_id": 58616518, "body": "Is there any way we could use Skype (username dom.burford) or a more instant communication? Unfortunately, my reputation is too low to move to chat on SO."}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 99, "user_id": 5930376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35ddca322137d94b2523901d6f626ee3?s=128&d=identicon&r=PG&f=1", "display_name": "domburford", "link": "https://stackoverflow.com/users/5930376/domburford"}, "edited": false, "score": 0, "creation_date": 1455723455, "post_id": 35457209, "comment_id": 58618347, "body": "my email is peckrich@gmail.com if you want to chat on there?"}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 1, "last_activity_date": 1455719805, "last_edit_date": 1455719805, "creation_date": 1455713317, "answer_id": 35457209, "question_id": 35455261, "link": "https://stackoverflow.com/questions/35455261/how-to-get-the-output-of-a-nested-form-to-stay-in-its-exact-original-order-desp/35457209#35457209", "title": "How to get the output of a nested form to stay in its exact original order, despite permutations, using the index action &amp; index template?", "body": "<p>As per my previous answer, you definitely need to put your <code>texts</code> and <code>urls</code> objects into a single table/model. This will allow you to assign \"order\" values for them.</p>\n\n<hr>\n\n<p>I would add an <code>order</code> value to the <code>texts</code> / <code>urls</code> and then use the <a href=\"http://apidock.com/rails/ActionView/Helpers/FormHelper/fields_for#512-Setting-child-index-while-using-nested-attributes-mass-assignment\" rel=\"nofollow noreferrer\"><code>child_index</code></a> value to populate it:</p>\n\n<pre><code>#app/views/posts/new.html.erb\n&lt;%= form_for @post do |f| %&gt;\n  &lt;%= f.fields_for :meta do |t| %&gt;\n    &lt;%= t.text_field :textattr %&gt;\n    &lt;%= t.hidden_field :order, t.index %&gt;\n  &lt;% end %&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>According to the docs:</p>\n\n<blockquote>\n  <p>When a collection is used you might want to know the <code>index</code> of each object into the array. For this purpose, the <code>index</code> method is available in the <code>FormBuilder</code> object.</p>\n\n<pre><code>&lt;%= form_for @person do |person_form| %&gt;\n  ...\n  &lt;%= person_form.fields_for :projects do |project_fields| %&gt;\n    Project #&lt;%= project_fields.index %&gt;\n    ...\n  &lt;% end %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n</blockquote>\n\n<p>--</p>\n\n<p>This will allow you to pass the <code>order</code> attribute through to your db:</p>\n\n<pre><code>#app/controllers/posts_controller.rb\nclass PostsController &lt; ApplicationController\n  def create\n    @post = Post.new post_params\n    @post.save\n  end\n\n  private\n\n  def post_params\n    params.require(:post).permit(meta_attributes: [:order, :textattr])\n  end\nend\n</code></pre>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>I just tried this approach and can confirm it works (<code>index</code>):</p>\n\n<p><a href=\"https://i.stack.imgur.com/RUu4c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RUu4c.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/abuEi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/abuEi.png\" alt=\"enter image description here\"></a></p>\n\n<p>The only thing I would say is that you might not have an <code>order</code> column in your model, although it should not come back with the merge error. </p>\n\n<p>I notice you're using outdated javascript code, can you try without using that code and see what happens?</p>\n"}, {"tags": [], "owner": {"reputation": 956, "user_id": 147180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a25bd292be3a7933ac18e07ae61fa02f?s=128&d=identicon&r=PG", "display_name": "Chris Blunt", "link": "https://stackoverflow.com/users/147180/chris-blunt"}, "is_accepted": true, "score": 1, "last_activity_date": 1455748938, "last_edit_date": 1495542640, "creation_date": 1455748938, "answer_id": 35469234, "question_id": 35455261, "link": "https://stackoverflow.com/questions/35455261/how-to-get-the-output-of-a-nested-form-to-stay-in-its-exact-original-order-desp/35469234#35469234", "title": "How to get the output of a nested form to stay in its exact original order, despite permutations, using the index action &amp; index template?", "body": "<p>As <a href=\"https://stackoverflow.com/a/35457209/147180\">Richard says</a>, you need to add an <code>order</code> column (or <code>position</code> - calling the column <code>order</code> can cause confusion with the generated SQL).</p>\n\n<p>I think the main issue is your <a href=\"https://github.com/dompburford/anotherone/blob/6e4aa31337c19c20b07698e88cb42811a31bbbd8/app/assets/javascripts/posts.coffee\" rel=\"nofollow noreferrer\">coffeescript code</a>. You need to generate a hidden input with each row you add, and use a single <code>current_index</code> counter for row you add:</p>\n\n<pre><code>current_index = 0\n\naddText = -&gt;\n html = \"\"\"\n &lt;br&gt;\n  &lt;textarea name=\"post[things_attributes][#{current_index}][text]\" id=\"post_things_attributes_#{current_index}_text\"&gt;&lt;/textarea&gt;\n  &lt;input type=\"hidden\" name=\"post[things_attributes][#{current_index}][order]\" id=\"post_things_attributes_#{current_index}_order\" value=\"#{current_index}\" /&gt;\n \"\"\"\n\n $(\"#new_post input[type='submit']\").before(html)\n current_index += 1\n\naddUrl = -&gt;\n html = \"\"\"\n &lt;br&gt;\n  &lt;input type=\"url\" name=\"post[things_attributes][#{current_index}][url]\" id=\"post_things_attributes_#{current_index}_url\"&gt;\n  &lt;input type=\"hidden\" name=\"post[things_attributes][#{current_index}][order]\" id=\"post_things_attributes_#{current_index}_order\" value=\"#{current_index}\" /&gt;\n \"\"\"\n\n $(\"#new_post input[type='submit']\").before(html)\n current_index += 1\n</code></pre>\n\n<p>In your <code>index.html.erb</code>, order the <code>Things</code> by the <code>order</code> column:</p>\n\n<pre><code>&lt;% @posts.each do |post| %&gt;\n  &lt;% post.things.order(:order).each do |thing| %&gt;\n    &lt;br&gt;\n    &lt;%= thing.try(:text) %&gt;\n    &lt;%= thing.try(:url) %&gt;\n  &lt;% end %&gt;\n\n  &lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>It's also worth noting that this dynamic nested form pattern is very well-handled by the <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">cocoon gem</a>. I'd recommend taking a look and using that in your project.</p>\n"}], "owner": {"reputation": 99, "user_id": 5930376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/35ddca322137d94b2523901d6f626ee3?s=128&d=identicon&r=PG&f=1", "display_name": "domburford", "link": "https://stackoverflow.com/users/5930376/domburford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 35469234, "answer_count": 2, "score": 0, "last_activity_date": 1455748938, "creation_date": 1455708102, "last_edit_date": 1455712318, "question_id": 35455261, "link": "https://stackoverflow.com/questions/35455261/how-to-get-the-output-of-a-nested-form-to-stay-in-its-exact-original-order-desp", "title": "How to get the output of a nested form to stay in its exact original order, despite permutations, using the index action &amp; index template?", "body": "<p>I am using a nested form to post Urls and Texts. Via javascript, I am allowing any permutation of these two fields e.g. Url1 Text1 Text2 Url2 or Url1 Text1 Url2 Text2 etc </p>\n\n<p><a href=\"https://i.stack.imgur.com/Xm1KF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xm1KF.png\" alt=\"http://imgur.com/DBPPZBf\"></a></p>\n\n<p>After submitting the form and redirecting to the index.html.view, I am then trying to keep the original order of whatever permutation I decide to use in the form i.e. if I decided to post Text1 Url1 Url2 Text2 Url3 I need that exact same arrangement to display in the browser. </p>\n\n<p>Post Form Code </p>\n\n<p><a href=\"https://i.stack.imgur.com/EjBML.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EjBML.png\" alt=\"http://imgur.com/dtjZrFX\"></a></p>\n\n<p>Post Model</p>\n\n<pre><code> class Post &lt; ActiveRecord::Base\n   has_many :texts\n   has_many :urls    \n   accepts_nested_attributes_for :texts, :urls \n end\n</code></pre>\n\n<p>Text Model</p>\n\n<pre><code> class Text &lt; ActiveRecord::Base\n  belongs_to :post \n end\n</code></pre>\n\n<p>Url Model </p>\n\n<pre><code> class Url &lt; ActiveRecord::Base\n  belongs_to :post\n end\n</code></pre>\n\n<p>Schema </p>\n\n<pre><code> ActiveRecord::Schema.define(version: 20160215123916) do\n\n create_table \"posts\", force: :cascade do |t|\n t.datetime \"created_at\", null: false\n t.datetime \"updated_at\", null: false\n  end\n\n create_table \"texts\", force: :cascade do |t|\n  t.text     \"textattr\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.integer  \"post_id\"\n end\n\n add_index \"texts\", [\"post_id\"], name: \"index_texts_on_post_id\"\n\n create_table \"urls\", force: :cascade do |t|\n  t.string   \"urlattr\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.integer  \"post_id\"\n end\n\n add_index \"urls\", [\"post_id\"], name: \"index_urls_on_post_id\"\n\nend\n</code></pre>\n\n<p>Posts Controller </p>\n\n<pre><code>  class PostsController &lt; ApplicationController\n\n  def index\n    @posts = Post.includes(:texts, :urls).all.order(created_at: :desc)\n  end\n\n  def new\n    @post = Post.new \n   end \n\n  def create\n   @post = Post.new(post_params) \n    if @post.save \n      redirect_to '/posts'\n    else \n      render 'new'\n    end \n  end\n\n   private \n    def post_params \n        params.require(:post).permit(:texts_attributes =&gt; [:textattr], :urls_attributes =&gt; [:urlattr])\n    end \n end\n</code></pre>\n\n<p>Index.html.erb (Unsuccessful Attempt)</p>\n\n<pre><code>&lt;% @posts.each do |post| %&gt; \n\n&lt;% post.texts.each do |text|%&gt;\n &lt;%= text.textattr %&gt; &lt;br&gt; \n&lt;% end %&gt;\n\n&lt;% post.urls.each do |url|%&gt;\n &lt;%= url.urlattr %&gt; &lt;br&gt; \n&lt;% end %&gt; \n\n&lt;% end %&gt; \n</code></pre>\n\n<p>Index.html.erb (Unsuccessful Attempt)</p>\n\n<pre><code>   &lt;% @posts.each do |post| %&gt; \n\n    &lt;% [post.texts, post.urls].flatten.sort_by { |c| [c.created_at] }.each do |content| %&gt;\n      &lt;% if content.class.name == \"Text\" %&gt;\n        &lt;%= content.textattr %&gt; \n      &lt;% elsif content.is_a? Url %&gt;\n         &lt;%= content.urlattr %&gt; \n      &lt;% end %&gt; \n    &lt;% end %&gt;\n\n  &lt;% end %&gt;  \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "hyperlink", "block", "font-awesome"], "answers": [{"comments": [{"owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455708636, "post_id": 35455421, "comment_id": 58607377, "body": "thanks. that helped. I used a pipe but I guess it&#39;s up to you"}, {"owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455708750, "post_id": 35455421, "comment_id": 58607459, "body": "Too bad <code>bulma.io</code> only groups &lt;a&gt; tags, and not buttons :(("}, {"owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "edited": false, "score": 0, "creation_date": 1455709035, "post_id": 35455421, "comment_id": 58607637, "body": "Interesting find, but I&#39;m just not using bootstrap again for anything, ever again. Thanks again"}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 3, "last_activity_date": 1455708660, "last_edit_date": 1455708660, "creation_date": 1455708468, "answer_id": 35455421, "question_id": 35455132, "link": "https://stackoverflow.com/questions/35455132/nested-icons-and-rails-link-to-or-button-to-are-not-working-with-slim/35455421#35455421", "title": "Nested icons and Rails&#39; link_to or button_to are not working with SLIM", "body": "<p>According to the <a href=\"http://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to\" rel=\"nofollow\">documentation</a>, it should be:</p>\n\n<pre><code>= button_to firefighters_approve_path(entry), class: 'button is-success' do\n  i.fa.fa-thumbs-up\n    |Accept\n</code></pre>\n\n<p>If you use a block, first argument should be a path and block contains name.</p>\n"}, {"tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 1, "last_activity_date": 1455710775, "creation_date": 1455710775, "answer_id": 35456273, "question_id": 35455132, "link": "https://stackoverflow.com/questions/35455132/nested-icons-and-rails-link-to-or-button-to-are-not-working-with-slim/35456273#35456273", "title": "Nested icons and Rails&#39; link_to or button_to are not working with SLIM", "body": "<p>If you're using the <a href=\"https://github.com/bokmann/font-awesome-rails\" rel=\"nofollow\"><code>font-awesome-rails</code></a> gem, you'd be able to use the <a href=\"https://github.com/bokmann/font-awesome-rails#helpers\" rel=\"nofollow\"><code>fa_icon</code></a> helper:</p>\n\n<pre><code>= button_to fa_icon(\"thumbs-up\", text: \"Accept\"), firefighters_approve_path(entry), class: 'button is-success'\n</code></pre>\n"}], "owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "accepted_answer_id": 35455421, "answer_count": 2, "score": 1, "last_activity_date": 1455710775, "creation_date": 1455707734, "question_id": 35455132, "link": "https://stackoverflow.com/questions/35455132/nested-icons-and-rails-link-to-or-button-to-are-not-working-with-slim", "title": "Nested icons and Rails&#39; link_to or button_to are not working with SLIM", "body": "<p>Why doesn't this work?</p>\n\n<pre><code> # Note the `do` block\n = button_to 'Accept', firefighters_approve_path(entry), class: 'button is-success' do\n    i.fa.fa-thumbs-up\n</code></pre>\n\n<blockquote>\n  <p>undefined method `stringify_keys' for String:0x007fec0bb7bcc8></p>\n</blockquote>\n\n<p>Why doesn't this work?</p>\n\n<pre><code># Note no `do` block\n= button_to 'Accept', firefighters_approve_path(entry), class: 'button is-success'\n  i.fa.fa-thumbs-up\n</code></pre>\n\n<blockquote>\n  <p>undefined method `stringify_keys' for String:0x007fec0bc86b40</p>\n</blockquote>\n\n<p>I want to use slim and fontawesome. What am I missing here?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "grape-api"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1455708916, "post_id": 35454925, "comment_id": 58607555, "body": "try to read gem documentation"}, {"owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "reply_to_user": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 0, "creation_date": 1455710369, "post_id": 35454925, "comment_id": 58608552, "body": "I have read the docs a few times, but it doesn&#39;t say anything about Custom Error messages."}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "edited": false, "score": 0, "creation_date": 1455708742, "post_id": 35455246, "comment_id": 58607452, "body": "I don&#39;t want to just add &quot;Oops&quot; before the message, I want to change the message completely."}, {"owner": {"reputation": 1118, "user_id": 4850235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/484b1b54984fa870e9d4c2341fdf16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Rubysmith", "link": "https://stackoverflow.com/users/4850235/rubysmith"}, "reply_to_user": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "edited": false, "score": 0, "creation_date": 1455710218, "post_id": 35455246, "comment_id": 58608472, "body": "Grape does not have a message option to pass to the params block to override the default validation messages right now. I have updated the answer for you."}, {"owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "edited": false, "score": 0, "creation_date": 1455710458, "post_id": 35455246, "comment_id": 58608597, "body": "I guess then I might end up doing just that. Thanks."}], "tags": [], "owner": {"reputation": 1118, "user_id": 4850235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/484b1b54984fa870e9d4c2341fdf16ed?s=128&d=identicon&r=PG&f=1", "display_name": "Rubysmith", "link": "https://stackoverflow.com/users/4850235/rubysmith"}, "is_accepted": false, "score": 1, "last_activity_date": 1455710046, "last_edit_date": 1455710046, "creation_date": 1455708045, "answer_id": 35455246, "question_id": 35454925, "link": "https://stackoverflow.com/questions/35454925/ruby-grape-custom-validation-error-message/35455246#35455246", "title": "Ruby Grape: Custom validation error message", "body": "<pre><code>format :json\nsubject.rescue_from Grape::Exceptions::ValidationErrors do |e|\n  error!({ messages: e.full_messages.map { |msg| \"Oops!\" + msg }}, 400)\nend\n</code></pre>\n\n<p>Update:</p>\n\n<p>If you want to customize the complete message you can manually edit the grape locale file and override it in your application.</p>\n\n<p><a href=\"https://github.com/ruby-grape/grape/blob/master/lib/grape/locale/en.yml\" rel=\"nofollow\">Grape locale en.yml</a></p>\n"}, {"tags": [], "owner": {"reputation": 465, "user_id": 5925094, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/MbtVD.png?s=128&g=1", "display_name": "Rich Steinmetz", "link": "https://stackoverflow.com/users/5925094/rich-steinmetz"}, "is_accepted": false, "score": 0, "last_activity_date": 1606123615, "creation_date": 1606123615, "answer_id": 64965701, "question_id": 35454925, "link": "https://stackoverflow.com/questions/35454925/ruby-grape-custom-validation-error-message/64965701#64965701", "title": "Ruby Grape: Custom validation error message", "body": "<p>It seems like the original answer is plain wrong:</p>\n<p><a href=\"https://github.com/ruby-grape/grape#custom-validation-messages\" rel=\"nofollow noreferrer\">https://github.com/ruby-grape/grape#custom-validation-messages</a></p>\n<p>Which should work something like this for OP's example:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>params do\n    requires :email, allow_blank: { false, message: '' }, message 'Oops! Email is required.'\nend\n</code></pre>\n<p>The tricky part is that OP is violating 2 validations but wants to have one message. Maybe the workaround above will work, though.</p>\n"}], "owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1572, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1606123615, "creation_date": 1455707200, "question_id": 35454925, "link": "https://stackoverflow.com/questions/35454925/ruby-grape-custom-validation-error-message", "title": "Ruby Grape: Custom validation error message", "body": "<p>How do you change the default error messages given by Grape on Validation Errors?</p>\n\n<p>For Example - </p>\n\n<pre><code>params do\n    requires :email, allow_blank: false\nend\n</code></pre>\n\n<p>If I don't pass the <code>:email</code> in the API call, grape will give error message as <code>['email is missing', 'email is empty']</code> but I want to override the message as <code>['Oops! Email is required.']</code></p>\n\n<p>So, how can I override the default error messages for Grape default Validation Rules.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1455707433, "creation_date": 1455707433, "answer_id": 35455014, "question_id": 35454918, "link": "https://stackoverflow.com/questions/35454918/ruby-on-rails-calculation-total-of-table-value/35455014#35455014", "title": "ruby on rails calculation total of table value", "body": "<pre><code>@product_sales.map(&amp;:totalprice).sum\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455708033, "post_id": 35455170, "comment_id": 58606928, "body": "<code>Product_sale</code> should be <code>ProductSale</code> :)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455708108, "post_id": 35455170, "comment_id": 58606970, "body": "@Pavan indeed, but I just copied the OP&#39;s code - who knows, might be he called the class <code>Product_sale</code> :).."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 0, "last_activity_date": 1455734216, "last_edit_date": 1455734216, "creation_date": 1455707845, "answer_id": 35455170, "question_id": 35454918, "link": "https://stackoverflow.com/questions/35454918/ruby-on-rails-calculation-total-of-table-value/35455170#35455170", "title": "ruby on rails calculation total of table value", "body": "<pre><code>@product_sales.sum('price * quantity') # single query, efficient\n</code></pre>\n\n<p>P.S. Correct name for the class is snakecased <code>ProductSale</code></p>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455709612, "post_id": 35455195, "comment_id": 58608044, "body": "<code>sum</code> operates on database. there is no column <code>totalprice</code> in db, so this will throw wrong SQL error."}], "tags": [], "owner": {"reputation": 84, "user_id": 2399225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa144da6e487e02f72bbf23f8c7a3d2?s=128&d=identicon&r=PG", "display_name": "Marcel", "link": "https://stackoverflow.com/users/2399225/marcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1455707920, "creation_date": 1455707920, "answer_id": 35455195, "question_id": 35454918, "link": "https://stackoverflow.com/questions/35454918/ruby-on-rails-calculation-total-of-table-value/35455195#35455195", "title": "ruby on rails calculation total of table value", "body": "<pre><code>@product_sales.sum(&amp;:totalprice)\n</code></pre>\n\n<p>I think this should work where you only sum the total price of the selected product sales</p>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1455708308, "post_id": 35455319, "comment_id": 58607130, "body": "what&#39;s the point of <b>this</b> answer, when <a href=\"http://stackoverflow.com/a/35455170/1772830\">this same approach has already been proposed</a>?"}, {"owner": {"reputation": 11, "user_id": 5496939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xAk41REAgis/AAAAAAAAAAI/AAAAAAAAAV8/1LkRaSWwrlU/photo.jpg?sz=128", "display_name": "Andrea Cadamuro", "link": "https://stackoverflow.com/users/5496939/andrea-cadamuro"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455715496, "post_id": 35455319, "comment_id": 58612213, "body": "the object @product_sales (maybe already filtered) and not to all table data"}], "tags": [], "owner": {"reputation": 11, "user_id": 5496939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xAk41REAgis/AAAAAAAAAAI/AAAAAAAAAV8/1LkRaSWwrlU/photo.jpg?sz=128", "display_name": "Andrea Cadamuro", "link": "https://stackoverflow.com/users/5496939/andrea-cadamuro"}, "is_accepted": false, "score": 0, "last_activity_date": 1455708228, "creation_date": 1455708228, "answer_id": 35455319, "question_id": 35454918, "link": "https://stackoverflow.com/questions/35454918/ruby-on-rails-calculation-total-of-table-value/35455319#35455319", "title": "ruby on rails calculation total of table value", "body": "<p><code>@product_sales.sum('price * quantity')</code></p>\n"}, {"tags": [], "owner": {"reputation": 2050, "user_id": 5695646, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-nEigl1xsDV4/AAAAAAAAAAI/AAAAAAAAANE/WGykpWYiogM/photo.jpg?sz=128", "display_name": "Yshmarov", "link": "https://stackoverflow.com/users/5695646/yshmarov"}, "is_accepted": false, "score": 0, "last_activity_date": 1455732309, "creation_date": 1455732309, "answer_id": 35464342, "question_id": 35454918, "link": "https://stackoverflow.com/questions/35454918/ruby-on-rails-calculation-total-of-table-value/35464342#35464342", "title": "ruby on rails calculation total of table value", "body": "<p>Best solution for me was the one of Max:</p>\n\n<p>controller index view: <code>@some_total = @product_sales.map(&amp;:totalprice).sum</code></p>\n\n<p>view: <code>= @some_total</code></p>\n"}], "owner": {"reputation": 2050, "user_id": 5695646, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-nEigl1xsDV4/AAAAAAAAAAI/AAAAAAAAANE/WGykpWYiogM/photo.jpg?sz=128", "display_name": "Yshmarov", "link": "https://stackoverflow.com/users/5695646/yshmarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 35455014, "answer_count": 5, "score": 0, "last_activity_date": 1455734216, "creation_date": 1455707172, "question_id": 35454918, "link": "https://stackoverflow.com/questions/35454918/ruby-on-rails-calculation-total-of-table-value", "title": "ruby on rails calculation total of table value", "body": "<p>How can the total of a variable I define be calculated?</p>\n\n<p>I have:</p>\n\n<p>product_sale.rb</p>\n\n<pre><code>def totalprice\n  price*quantity\nend\n</code></pre>\n\n<p>view</p>\n\n<pre><code>%h1 Listing Product Sales\n%table\n  %thead\n    %tr\n      %th Product name\n      %th Price\n      %th Quantity\n      %th Total price\n  %tbody\n    - @product_sales.each do |product_sale|\n      %tr\n        %td= product_sale.product_name\n        %td= product_sale.price\n        %td= product_sale.quantity\n        %td= product_sale.totalprice\n%br\n%h1\n  Total sum to be paid:\n  = Product_sale.sum(:totalprice)\n</code></pre>\n\n<p>the <code>= Product_sale.sum(:totalprice)</code> does not work. How can I calculate it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "edited": false, "score": 0, "creation_date": 1455706257, "post_id": 35453893, "comment_id": 58605677, "body": "Your example is flawed. You don&#39;t exclude the <code>reinforcement</code> group that references the <code>mail</code> gem."}, {"owner": {"reputation": 4288, "user_id": 1629362, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/hnWU3.png?s=128&g=1", "display_name": "bitkot", "link": "https://stackoverflow.com/users/1629362/bitkot"}, "reply_to_user": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "edited": false, "score": 0, "creation_date": 1455706467, "post_id": 35453893, "comment_id": 58605823, "body": "@Mihai-AndreiDinculescu, But I excluded <code>supply</code> group that means it should try to install <code>backup</code> gem."}, {"owner": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "edited": false, "score": 0, "creation_date": 1455707004, "post_id": 35453893, "comment_id": 58606183, "body": "But your error message says that <code>backup</code> depends on <code>mail</code>."}, {"owner": {"reputation": 4288, "user_id": 1629362, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/hnWU3.png?s=128&g=1", "display_name": "bitkot", "link": "https://stackoverflow.com/users/1629362/bitkot"}, "reply_to_user": {"reputation": 18593, "user_id": 4304188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5695b0e5c30d4464163e3f3412fe5f1?s=128&d=identicon&r=PG", "display_name": "Mihai Dinculescu", "link": "https://stackoverflow.com/users/4304188/mihai-dinculescu"}, "edited": false, "score": 0, "creation_date": 1455708269, "post_id": 35453893, "comment_id": 58607097, "body": "Correct, when there is dependency bundle will install specific version required by the gem eg. <code>backup</code> depends on <code>mail=2.5.4</code>, the conflict here is that it also tries to install <code>mail</code> gem version <code>2.6.3</code> which is in different group and is excluded."}], "answers": [{"tags": [], "owner": {"reputation": 4288, "user_id": 1629362, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/hnWU3.png?s=128&g=1", "display_name": "bitkot", "link": "https://stackoverflow.com/users/1629362/bitkot"}, "is_accepted": false, "score": 0, "last_activity_date": 1455772507, "creation_date": 1455772507, "answer_id": 35473364, "question_id": 35453893, "link": "https://stackoverflow.com/questions/35453893/bundler-without-is-not-excluding-gem-installation-of-provided-groups/35473364#35473364", "title": "bundler --without is not excluding gem installation of provided groups", "body": "<p>Found that bundler checks for conflict even between group for consistency.</p>\n\n<p>Here's an <a href=\"http://yehudakatz.com/2010/05/09/the-how-and-why-of-bundler-groups/\" rel=\"nofollow\">article</a> checkout the <code>Consistency</code> part.</p>\n\n<p>This means that even though <code>bundler</code> will not install the gems in other group it will still make sure that there is no conflicting dependencies between gems in all the groups.</p>\n\n<p>I had to create multiple <code>Gemfile</code> and <code>Gemfile.lock</code> for each server.</p>\n"}], "owner": {"reputation": 4288, "user_id": 1629362, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/hnWU3.png?s=128&g=1", "display_name": "bitkot", "link": "https://stackoverflow.com/users/1629362/bitkot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455772507, "creation_date": 1455704537, "last_edit_date": 1455708472, "question_id": 35453893, "link": "https://stackoverflow.com/questions/35453893/bundler-without-is-not-excluding-gem-installation-of-provided-groups", "title": "bundler --without is not excluding gem installation of provided groups", "body": "<p>I have the following Gemfile</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem \"bundler\", \"1.10.6\"\ngem \"unicorn\", \"4.8.2\"\n\ngroup :supply do\n  gem \"backup\", \"4.1.10\"\nend\n\ngroup :bunker do\n  gem \"capistrano\", \"3.4.0\"\n  gem \"capistrano-rbenv\", \"2.0.3\"\n  gem \"capistrano-bundler\", \"1.1.4\"\n  gem \"capistrano-rails\", \"1.1.3\"\n  gem \"capistrano-nc\", \"0.1.4\"\nend\n\ngroup :reinforcement do\n  gem \"actionview\", \"4.2.1\"\n  gem \"actionmailer\", \"4.2.1\"\n  gem \"mail\", \"2.6.3\"\n  gem \"daemons\", \"1.2.3\"\n  gem \"tmail\", \"1.2.7.1\"\n  gem \"activerecord\", \"4.2.1\"\n  gem \"starling\", \"0.10.1\"\nend\n</code></pre>\n\n<p>I have many type of servers and want to install specific gems on specific servers eg. backup gem only on supply server etc.</p>\n\n<p>When I run the following bundle install command</p>\n\n<pre><code>bundle install --clean --without supply bunker --path /tmp/\n</code></pre>\n\n<p>I am getting the following error.</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"mail\":\n  In Gemfile:\n    mail (&gt;= 2.5.4, ~&gt; 2.5) ruby\n\n    backup (= 4.1.10) ruby depends on\n      mail (= 2.5.4) ruby\n\n    mail (= 2.6.3) ruby\n</code></pre>\n\n<p>If <code>without</code> is to exclude gem of certain group then the command should run just fine because it should never try to install mail and backup because they are not in the same group.</p>\n\n<p>Am I missing something or doing anything wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-2"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1455704359, "post_id": 35453741, "comment_id": 58604240, "body": "Why are you using Rails 2.3.18? Its ancient, you should start on Rails 4 instead and make sure you are following tutorials / materials written in the last few years."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 2, "creation_date": 1455704426, "post_id": 35453741, "comment_id": 58604293, "body": "It may be legacy project"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455704589, "post_id": 35453741, "comment_id": 58604411, "body": "Please update the question with <code>routes.rb</code> code."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455704695, "post_id": 35453741, "comment_id": 58604511, "body": "Why can&#39;t you just use <code>root_path</code>?"}, {"owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1455705049, "post_id": 35453741, "comment_id": 58604786, "body": "@pavan  map.login &#39;login/user_logout&#39;,      :controller =&gt; &#39;login&#39;,      :action    =&gt; &#39;user_logout&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "edited": false, "score": 0, "creation_date": 1455705408, "post_id": 35454117, "comment_id": 58605056, "body": "Can you tell me why the root url comes twice .??"}, {"owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "edited": false, "score": 0, "creation_date": 1455705728, "post_id": 35454117, "comment_id": 58605287, "body": "I have checked this code and same issue  and also used the same code in my controller URI(request.env[&quot;HTTP_REFERER&quot;]).host"}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "edited": false, "score": 0, "creation_date": 1455705869, "post_id": 35454117, "comment_id": 58605388, "body": "Sorry, I tried to figure it out. But I can&#39;t. Which ruby version do you use? What happens, if you use the parse method?"}, {"owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "edited": false, "score": 0, "creation_date": 1455706010, "post_id": 35454117, "comment_id": 58605487, "body": "I am using ruby-1.9.3-p551 Actually its old project and I can&#39;t upgrade it to new versions due to many conflicts"}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "edited": false, "score": 1, "creation_date": 1455706398, "post_id": 35454117, "comment_id": 58605775, "body": "Did you try the root_path helper? This would be the best and easiest solution."}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 2, "last_activity_date": 1455705050, "creation_date": 1455705050, "answer_id": 35454117, "question_id": 35453741, "link": "https://stackoverflow.com/questions/35453741/redirect-to-not-able-to-redirect-to-root-url-rails-2-3-18/35454117#35454117", "title": "Redirect_to not able to redirect to root url Rails 2.3.18", "body": "<p>Normaly you should use <code>root_path</code> a routes helper method to get the root path as suggested in the comments.</p>\n\n<p>If you want to parse an url you need to call the parse method of URI before you can ask the uri object for an attribute.</p>\n\n<pre><code>URI.parse(\"https://www.google.com/some/path\").host\n</code></pre>\n\n<p>or</p>\n\n<pre><code>uri = URI.parse(\"https://www.google.com/some/path\")\nuri.host   # =&gt; \"www.google.com\"\nuri.path   # =&gt; \"/some/path\"\nuri.query  # =&gt; nil\nuri.scheme # =&gt; \"https\"\nuri.port   # =&gt; 443\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483454613, "creation_date": 1455704149, "last_edit_date": 1483454613, "question_id": 35453741, "link": "https://stackoverflow.com/questions/35453741/redirect-to-not-able-to-redirect-to-root-url-rails-2-3-18", "title": "Redirect_to not able to redirect to root url Rails 2.3.18", "body": "<p>I am new to Rails and I am unable to redirect to root URL after logout the user, I have checked many solutions but all have same approach redirect_to, When I have used redirect_to to redirect to root URL then it has added the same URL two times. Please see below code.</p>\n\n<pre><code>def user_logout\n    redirect_to URI(request.env[\"HTTP_REFERER\"]).host\nend\n</code></pre>\n\n<p>it works fine but added the root URL two times, like test.comtest.com</p>\n"}, {"tags": ["ruby", "string", "immutability"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1455704031, "post_id": 35453589, "comment_id": 58604019, "body": "Because <code>original_user_id = items2[-1]</code> doesn&#39;t create a copy of the string. If you want to preserve the original string, you should not change it. Assigning a new string via <code>items2[-1] = items2[-1].downcase</code> would work."}, {"owner": {"reputation": 1636, "user_id": 1256849, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/dfa0i.jpg?s=128&g=1", "display_name": "Harry Bomrah", "link": "https://stackoverflow.com/users/1256849/harry-bomrah"}, "edited": false, "score": 0, "creation_date": 1455704179, "post_id": 35453589, "comment_id": 58604110, "body": "This <code>original_user_id = items2[-1]</code> creates a reference and does not copy value."}, {"owner": {"reputation": 11, "user_id": 5939150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09874c11bb4a2776590647bde0d4226f?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime pea", "link": "https://stackoverflow.com/users/5939150/jaime-pea"}, "edited": false, "score": 0, "creation_date": 1455708984, "post_id": 35453589, "comment_id": 58607591, "body": "My bad . it should have been items[-1].downcase! and not items2[-1].downcase!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1455713411, "post_id": 35453589, "comment_id": 58610724, "body": "BTW, the <code>|| x</code> in <code>x.strip || x</code> is extraneous, because <code>String#strip</code> never returns <code>nil</code> or <code>false</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1457596020, "post_id": 35453589, "comment_id": 59479997, "body": "You haven&#39;t selected an answer. We&#39;re none of them satisfactory?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1455707120, "creation_date": 1455707120, "answer_id": 35454904, "question_id": 35453589, "link": "https://stackoverflow.com/questions/35453589/string-is-effected-by-downcase-operation/35454904#35454904", "title": "String is effected by `downcase!` operation", "body": "<p>You might do</p>\n\n<pre><code>original_user_id = items2[-1].dup\n</code></pre>\n\n<p><code>object#dup</code> create a duplicate of the object instead use the same reference</p>\n"}, {"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 0, "last_activity_date": 1455708365, "creation_date": 1455708365, "answer_id": 35455382, "question_id": 35453589, "link": "https://stackoverflow.com/questions/35453589/string-is-effected-by-downcase-operation/35455382#35455382", "title": "String is effected by `downcase!` operation", "body": "<p>You need to create duplicate of the object or copy the value, bcs <code>downcase!</code> modify the original string and you just create refference to object, not duplicated value. So you can easily do this:</p>\n\n<pre><code>original_user_id = items[-1]\n\nitems[-1] = items[-1].downcase\n\noriginal_user_id \n# =&gt; MyUser999\n</code></pre>\n\n<p>or you can modify you code</p>\n\n<pre><code>items = line.split('|').take(2).map{|s| s.strip}\noriginal_user_id = items[-1]\n#=&gt; MyUser999\nitems[-1] = items[-1].downcase\n#=&gt; myuser999\noriginal_user_id \n#=&gt; MyUser999\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1455713256, "last_edit_date": 1455713256, "creation_date": 1455708993, "answer_id": 35455607, "question_id": 35453589, "link": "https://stackoverflow.com/questions/35453589/string-is-effected-by-downcase-operation/35455607#35455607", "title": "String is effected by `downcase!` operation", "body": "<blockquote>\n  <p>I probably missing some OOP fundamental programming concept</p>\n</blockquote>\n\n<p>There are two fundamental and distinct operations:</p>\n\n<ol>\n<li>Assigning an object to a variable</li>\n<li>Sending a message to an object</li>\n</ol>\n\n<p>And it only works that way, i.e. only objects can be assigned<sup>1</sup>, only variables can be assigned-to<sup>2</sup> and messages can only be sent to objects<sup>3</sup>.</p>\n\n<p>That being said, let's look at your code:</p>\n\n<pre><code>items[-1]\n</code></pre>\n\n<p>fetches the last object from the array and returns it: the string <code>\"MyUser999\"</code>.</p>\n\n<pre><code>original_user_id = items[-1]\n</code></pre>\n\n<p>assigns that object to the variable <code>original_user_id</code>.</p>\n\n<p>Both, <code>items[-1]</code> and <code>original_user_id</code> now refer to the same object.</p>\n\n<pre><code>items[-1].downcase!\n</code></pre>\n\n<p>fetches the last object and sends it a <code>downcase!</code> message. Upon receiving this message, the string downcases all of its characters.</p>\n\n<p>At this point, <code>items[-1]</code> and <code>original_user_id</code> still refer to the same object, i.e. the (now downcased) string <code>\"myuser999\"</code>.</p>\n\n<pre><code>original_user_id #=&gt; \"myuser999\"\n</code></pre>\n\n<p>Just as expected.</p>\n\n<hr>\n\n<p><sup>1</sup> Although you can write <code>my_var = my_other_var</code>, this doesn't assign the <em>variable</em> <code>my_other_var</code> to <code>my_var</code>, but the <em>object</em> that is assigned to <code>my_other_var</code>.</p>\n\n<p><sup>2</sup> Ruby does have <a href=\"http://ruby-doc.org/core-2.3.0/doc/syntax/assignment_rdoc.html#label-Assignment+Methods\" rel=\"nofollow\">assignment methods</a>, but they are merely syntactic sugar for sending messages, i.e. <code>hash.default = 123</code> is equivalent to <code>hash.default=(123)</code> or <code>hash.send(:default=, 123)</code></p>\n\n<p><sup>3</sup> <code>my_var.foo</code> doesn't send the message <code>foo</code> to the <em>variable</em> <code>my_var</code>, but to the <em>object</em> that is assigned to <code>my_var</code>. Likewise <code>array[0].foo</code> doesn't send the message <code>foo</code> to an array \"cell\", but to the object at index 0.</p>\n"}], "owner": {"reputation": 11, "user_id": 5939150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09874c11bb4a2776590647bde0d4226f?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime pea", "link": "https://stackoverflow.com/users/5939150/jaime-pea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455713283, "creation_date": 1455703726, "last_edit_date": 1455713283, "question_id": 35453589, "link": "https://stackoverflow.com/questions/35453589/string-is-effected-by-downcase-operation", "title": "String is effected by `downcase!` operation", "body": "<p>I'm trying to read a file line by line and process the data. This is users table data. I'm extracting <code>account_id</code> and <code>user_id</code> and then trying to downcast <code>user_id</code> while saving the original <code>user_id</code>. I have the following code:</p>\n\n<pre><code># account_id | user_id | address | user_name |  passwordDigest\nline = \"g_1e035sadas-035e-45ba-9a1f-40d20000 |    MyUser999 | Alabama | Felix The Cat | 12Yoiqbdz/jCCDASD2kA8D4M5V9pZ3KyWiaj |  null |        null |\" \n\nraw_line = line.split('|')\n# =&gt; [\"g_1e035sadas-035e-45ba-9a1f-40d20000 \", \"    MyUser999 \", \" Alabama \", \" Felix The Cat \", \" 12Yoiqbdz/jCCDASD2kA8D4M5V9pZ3KyWiaj \", \"  null \", \"        null \"]\n\nfiltered_raw_line = raw_line.take(2)\n# =&gt; [\"g_1e035sadas-035e-45ba-9a1f-40d20000 \", \"    MyUser999 \"]\n\nitems = filtered_raw_line.collect{|x| x.strip || x }\n# =&gt; [\"g_1e035sadas-035e-45ba-9a1f-40d20000\", \"MyUser999\"] \n\noriginal_user_id = items[-1]\n# =&gt; \"MyUser999\"\n\nitems[-1].downcase!\n# =&gt; \"myuser999\"\n\noriginal_user_id\n# =&gt; \"myuser999\"\n</code></pre>\n\n<p>I can't figure out why <code>original_user_id</code> changes after performing <code>downcase!</code> operation on one of the array cells.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jenkins"], "answers": [{"tags": [], "owner": {"reputation": 105809, "user_id": 234938, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e509dcb9852f237fe0412caccc335ac9?s=128&d=identicon&r=PG", "display_name": "Christopher Orr", "link": "https://stackoverflow.com/users/234938/christopher-orr"}, "is_accepted": true, "score": 1, "last_activity_date": 1455715259, "creation_date": 1455715259, "answer_id": 35457905, "question_id": 35453149, "link": "https://stackoverflow.com/questions/35453149/jenkins-gem-not-found/35457905#35457905", "title": "jenkins - gem not found", "body": "<p>The answer seems to be in the error message.</p>\n\n<p>When logged in to an interactive shell, it seems that you have added <code>~/.rbenv/shims/</code> to your <code>PATH</code>.</p>\n\n<p>Jenkins isn't using a login console, so doesn't have this configuration, and only has <code>/sbin:/usr/sbin:/bin:/usr/bin</code> on its <code>PATH</code>.</p>\n\n<p>You can update the <code>PATH</code> environment variable globally in the Manage Jenkins > Configure System screen, or per build machine in the build node configuration.</p>\n"}], "owner": {"reputation": 1264, "user_id": 1936343, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/0267ab7159f8625ca6bf07db88da2ff9?s=128&d=identicon&r=PG", "display_name": "voila", "link": "https://stackoverflow.com/users/1936343/voila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "accepted_answer_id": 35457905, "answer_count": 1, "score": 0, "last_activity_date": 1455715259, "creation_date": 1455702645, "question_id": 35453149, "link": "https://stackoverflow.com/questions/35453149/jenkins-gem-not-found", "title": "jenkins - gem not found", "body": "<p>Facing weird issue where <code>jenkins</code> showing me <code>gems</code> not found even though it is installed. \nI logged in with <code>jenkins</code> through <code>terminal</code></p>\n\n<pre><code>~/.rbenv/shims/gem\n-bash-4.1$ whoami\n jenkins\n-bash-4.1$ which gem\n~/.rbenv/shims/gem     ----&gt; it is there \n-bash-4.1$ \n</code></pre>\n\n<p>Now when I tried above commands through <code>jenkins web-interface</code> and put above commands in <code>build-step</code></p>\n\n<pre><code>  + cp app/exampleConfig.js app/config.js \n  + npm -v\n    3.7.2  \n  + pwd\n   /var/lib/jenkins/jobs/code_deploy/workspace\n  + whoami\n   jenkins\n  + which gem\n  which: no gem in (/sbin:/usr/sbin:/bin:/usr/bin)  ------ whyyyy ??\n   Build step 'Execute shell' marked build as failure\n</code></pre>\n\n<p>I am really not able to understand why is this issue. </p>\n\n<p>Any help would be appreciated. </p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing", "rails-routing"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455703151, "post_id": 35453061, "comment_id": 58603319, "body": "read about <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">routing in Rails</a>"}, {"owner": {"reputation": 47, "user_id": 3195752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d35a8288eff284aa301d281ac9bec0fa?s=128&d=identicon&r=PG&f=1", "display_name": "nuduoz", "link": "https://stackoverflow.com/users/3195752/nuduoz"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1455704176, "post_id": 35453061, "comment_id": 58604109, "body": "I&#39;ve read whole article but combination of <code>:only</code> and <code>do</code> block isn&#39;t there. This combinations are probably usual in Ruby but I&#39;m not used to it nor able to find example or solution. But anyway, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 1, "last_activity_date": 1455703411, "last_edit_date": 1455703411, "creation_date": 1455702994, "answer_id": 35453299, "question_id": 35453061, "link": "https://stackoverflow.com/questions/35453061/rails-custom-and-default-routes/35453299#35453299", "title": "Rails custom and default routes", "body": "<p>Your first line defines the route to the index action. Define a resource once only. Read the <a href=\"http://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default\" rel=\"nofollow\">routing guide</a>.</p>\n\n<pre><code>resources :users, :except =&gt; [:index] do\n  collection do \n    post 'users/login', to: 'users#login'\n  end\nend\n</code></pre>\n\n<p>Run <code>rake routes</code> from the command line in your project root folder to see all your route definitions.</p>\n"}, {"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 2, "last_activity_date": 1455703521, "creation_date": 1455703521, "answer_id": 35453513, "question_id": 35453061, "link": "https://stackoverflow.com/questions/35453061/rails-custom-and-default-routes/35453513#35453513", "title": "Rails custom and default routes", "body": "<p>You got your routes wrong. The <code>resources :users</code> generates seven default routes which include the <code>index</code> route as well. You need to tweak the code to below</p>\n\n<pre><code>resources :users, :only =&gt; [:show, :destroy, :create] do\n  collection do \n    post 'login', to: 'users#login'\n  end\nend\n</code></pre>\n\n<p><strong><em>Note:</em></strong></p>\n\n<p>If you noticed, I've removed the <strong>custom routes</strong> for <code>show</code>,<code>create</code> and <code>delete</code> as they are generated by default.</p>\n"}], "owner": {"reputation": 47, "user_id": 3195752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d35a8288eff284aa301d281ac9bec0fa?s=128&d=identicon&r=PG&f=1", "display_name": "nuduoz", "link": "https://stackoverflow.com/users/3195752/nuduoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 35453513, "answer_count": 2, "score": 0, "last_activity_date": 1455703740, "creation_date": 1455702394, "last_edit_date": 1455703740, "question_id": 35453061, "link": "https://stackoverflow.com/questions/35453061/rails-custom-and-default-routes", "title": "Rails custom and default routes", "body": "<p>I'm trying to define custom routes to my controller and I need to use some of the default routes too. Is there any simple solution? </p>\n\n<p>So far I've something like this</p>\n\n<pre><code>resources :users do\n  member do\n    get 'users/:id', to: 'users#show'\n    delete 'users/:id', to: 'users#destroy'\n  end\n  collection do \n    post 'users', to: 'users#create'\n    post 'users/login', to: 'users#login'\n  end\nend\nresources :users, :only =&gt; [:show, :destroy, :create, :login]\n</code></pre>\n\n<p>I don't need nor want the <code>index</code> route but with this settings it's still trying to route <code>GET users/</code> to <code>user_controller</code> <code>index</code> method.</p>\n\n<p>I know that there is probably some simple and obvious answer but I'm not able to find it.</p>\n\n<p>Thank's in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot"], "answers": [{"comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1455701750, "post_id": 35452784, "comment_id": 58602230, "body": "because <code>{}</code> here is a block."}, {"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455701880, "post_id": 35452784, "comment_id": 58602335, "body": "Thanks :-) makes sense"}], "tags": [], "owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "is_accepted": false, "score": 4, "last_activity_date": 1455701710, "creation_date": 1455701710, "answer_id": 35452784, "question_id": 35452681, "link": "https://stackoverflow.com/questions/35452681/data-structure-with-factory-girl/35452784#35452784", "title": "Data Structure with Factory Girl", "body": "<p>Factory girl uses <code>{}</code> in it's syntax.  You need <a href=\"https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#lazy-attributes\" rel=\"nofollow\">two sets to get a hash</a>.</p>\n\n<pre><code>FactoryGirl.define do\n  factory :my_object do\n    amount nil \n    payment_method_nonce '132465'\n    device_data 'device_data'\n    customer { \n      {\n        first_name: 'Richard' \n      }\n    }\n    billing {\n      {\n        first_name: 'Richard',\n        last_name: 'Lewis' \n      }\n    }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455701710, "creation_date": 1455701408, "question_id": 35452681, "link": "https://stackoverflow.com/questions/35452681/data-structure-with-factory-girl", "title": "Data Structure with Factory Girl", "body": "<p>I am trying to create this nested hash structure as as FactoryGirl Object, so that I can call <code>FactoryGirl.attributes_for(:my_object)</code></p>\n\n<pre><code>amount: total,\npayment_method_nonce: params[:payment_method_nonce],\ndevice_data: params[:device_data],\ncustomer: {\n  first_name: params[:first_name],\n},\nbilling: {\n      first_name: params[:first_name],\n      last_name: params[:last_name],\n}\n</code></pre>\n\n<p>So far I have </p>\n\n<pre><code>FactoryGirl.define do\n  factory :my_object do\n    amount nil \n    payment_method_nonce '132465'\n    device_data 'device_data'\n    customer {\n      first_name 'Richard' \n    }\n    billing {\n      first_name 'Richard'\n      last_name 'Lewis' \n    }\n  end\nend\n</code></pre>\n\n<p>I am getting syntax errors and can't seem to get it right</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "hpricot"], "comments": [{"owner": {"reputation": 1075, "user_id": 1418151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46a35a8012aa162755c2db1272a1b12b?s=128&d=identicon&r=PG", "display_name": "aliibrahim", "link": "https://stackoverflow.com/users/1418151/aliibrahim"}, "edited": false, "score": 0, "creation_date": 1455703206, "post_id": 35452455, "comment_id": 58603356, "body": "Hpricot is exactly parsing what you are asking it to do. <code>creator</code> is the empty tag here and it is followed by <code>copyright</code>. Both of these are nested inside <code>title</code> tag. Although <code>title</code> is never really closed but as per the heirarchy it makes sesne what Hpricot is doing."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 1075, "user_id": 1418151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46a35a8012aa162755c2db1272a1b12b?s=128&d=identicon&r=PG", "display_name": "aliibrahim", "link": "https://stackoverflow.com/users/1418151/aliibrahim"}, "edited": false, "score": 0, "creation_date": 1455704472, "post_id": 35452455, "comment_id": 58604324, "body": "But <code>creator</code> is not nested inside <code>title</code> tag in my orignal xml file: <code>title</code> is an empty tag just like <code>creator</code>."}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455700870, "creation_date": 1455700870, "question_id": 35452455, "link": "https://stackoverflow.com/questions/35452455/hpricot-is-parsing-an-xml-file-incorrectly-misreads-empty-tag", "title": "Hpricot is parsing an xml file incorrectly: misreads empty tag", "body": "<p>I have an xml file whose contents are thus:</p>\n\n<pre><code>&lt;data&gt;\n  &lt;title/&gt;\n  &lt;creator/&gt;\n  &lt;copyright&gt;Foo&lt;/copyright&gt;\n&lt;/data&gt;\n</code></pre>\n\n<p>There's no doctype, which might be related to the problem.  I'm reading it in with the Hpricot gem (0.8.1), in rails 2.2.2.  When it parses it, it doesn't treat the <code>title</code> tag as empty, and instead wraps it around its sibling tags:</p>\n\n<pre><code>doc = Hpricot(File.read(\"#{ENV['HOME']}/test.xml\")) \n=&gt; #&lt;Hpricot::Doc {elem &lt;data&gt; \"\\n  \" {elem &lt;title&gt; \"\\n  \" {emptyelem &lt;creator&gt;} \"\\n  \" {elem &lt;copyright&gt; \"Foo\" &lt;/copyright&gt;} \"\\n\"} &lt;/data&gt;} \"\\n\"&gt;\n\nputs doc.to_s\n&lt;data&gt;\n  &lt;title&gt;\n  &lt;creator /&gt;\n  &lt;copyright&gt;Foo&lt;/copyright&gt;\n&lt;/title&gt;&lt;/data&gt;\n</code></pre>\n\n<p>Can anyone explain what's going wrong?  I don't see why the <code>title</code> tag would be treated differently to the <code>creator</code> tag: if there is an issue with not having doctype for example then i'd think these two tags would both suffer from it (or neither of them).</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1455700490, "post_id": 35452236, "comment_id": 58601331, "body": "What do you mean by not working?  You already have a party order with those attributes?"}, {"owner": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455701339, "post_id": 35452236, "comment_id": 58601946, "body": "when I use valid? method the new value is not getting saved in the database."}, {"owner": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "edited": false, "score": 0, "creation_date": 1455702043, "post_id": 35452236, "comment_id": 58602461, "body": "I have modified my answer pls check"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455700842, "post_id": 35452309, "comment_id": 58601587, "body": "I am getting the following error..                                                                                                    undefined method `exists?&#39; for #&lt;PartyOrder:0xb4765c3c&gt;"}, {"owner": {"reputation": 720, "user_id": 3198681, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxRbd.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3198681/akshay"}, "reply_to_user": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455701166, "post_id": 35452309, "comment_id": 58601815, "body": "Please use &#39;valid?&#39; or &#39;present?&#39; instead of &#39;exists?&#39;. Please try the edited code."}, {"owner": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455702117, "post_id": 35452309, "comment_id": 58602529, "body": "Sorry.. It is not throwing any error.. But the existing values also getting stored.. It is not checking.. I hope so., Please help me with changes.. I am sorry If my problem irritates u.. I am new to Rails.."}, {"owner": {"reputation": 720, "user_id": 3198681, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxRbd.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3198681/akshay"}, "reply_to_user": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455705086, "post_id": 35452309, "comment_id": 58604814, "body": "Oh i just understood your requirement. The answer given by Dias will solve it i think. And your problem don&#39;t irritate me :)"}, {"owner": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 1, "creation_date": 1455708066, "post_id": 35452309, "comment_id": 58606941, "body": "But thanks for your help @Akshay. It helped me to learn about valid? method. Thank You"}], "tags": [], "owner": {"reputation": 720, "user_id": 3198681, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxRbd.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3198681/akshay"}, "is_accepted": false, "score": 0, "last_activity_date": 1455701220, "last_edit_date": 1455701220, "creation_date": 1455700422, "answer_id": 35452309, "question_id": 35452236, "link": "https://stackoverflow.com/questions/35452236/exists-method-not-working-in-rails/35452309#35452309", "title": "exists? method not working in rails", "body": "<p>Try using </p>\n\n<pre><code>if @party_order.present?\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>if PartyOrder.exists?(@party_order)\n</code></pre>\n\n<p>So it can be rewritten as:</p>\n\n<pre><code>def party_order_create\n   @party_order=PartyOrder.new(party_order_params)\n   @party_order.save\n   if @party_order.present? \n     flash[:notice] = \"Party Saved Successfully!!!\"\n     redirect_to :action =&gt; \"party_order_index\"\n   else\n     flash.now[:notice] = \"Party not Saved\"\n     render \"party_order_new\"\n   end\n end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455702514, "post_id": 35452680, "comment_id": 58602833, "body": "Thank you.. It worked for me. but it is redirecting to the party_order_index and showing the flash as party saved successfully.. how could I change that??"}, {"owner": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "reply_to_user": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "edited": false, "score": 0, "creation_date": 1455705424, "post_id": 35452680, "comment_id": 58605068, "body": "Hi @kelvin if this or any answer has solved your question please consider accepting it by clicking the check-mark and upvote as well. This indicates to the wider community that you&#39;ve found a solution and gives some reputation to both the answerer and yourself. There is no obligation to do this"}], "tags": [], "owner": {"reputation": 782, "user_id": 2265937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a62134961838eb9d27490b10cc11bd7?s=128&d=identicon&r=PG", "display_name": "Dias", "link": "https://stackoverflow.com/users/2265937/dias"}, "is_accepted": true, "score": -2, "last_activity_date": 1455704752, "last_edit_date": 1455704752, "creation_date": 1455701405, "answer_id": 35452680, "question_id": 35452236, "link": "https://stackoverflow.com/questions/35452236/exists-method-not-working-in-rails/35452680#35452680", "title": "exists? method not working in rails", "body": "<pre><code>@party_order=PartyOrder.find_or_create_by(party_order_params)\n\nif @party_order.present?\n\n  // code\n\nelse\n\n  // code\n\nend\n</code></pre>\n\n<p>// or try this</p>\n\n<pre><code>@party_order=PartyOrder.where(party_order_params)\n\nif @party_order.present?\n\n    flash.now[:notice] = \"Party not Saved\"\n\n    render \"party_order_new\"\n\nelse\n\n    @party_order=PartyOrder.new(party_order_params)\n\n    if @party_order.save\n\n        flash[:notice] = \"Party Saved Successfully!!!\"\n        redirect_to :action =&gt; \"party_order_index\"\n    end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 5928950, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SEKTO.jpg?s=128&g=1", "display_name": "kelvin", "link": "https://stackoverflow.com/users/5928950/kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 35452680, "answer_count": 2, "score": -1, "last_activity_date": 1455704752, "creation_date": 1455700241, "last_edit_date": 1455700494, "question_id": 35452236, "link": "https://stackoverflow.com/questions/35452236/exists-method-not-working-in-rails", "title": "exists? method not working in rails", "body": "<p>I want to check whether the data exists in the database.. If not i should save the data.. I used exists? method like below in the controller..</p>\n\n<pre><code> def party_order_create\n   @party_order = PartyOrder.new(party_order_params)\n   if not PartyOrder.exists?(@party_order)\n   then @party_order.save\n     flash[:notice] = \"Party Saved Successfully!!!\"\n     redirect_to :action =&gt; \"party_order_index\"\n   else\n     flash.now[:notice] = \"Party not Saved\"\n     render \"party_order_new\"\n   end\n end\n</code></pre>\n\n<p>It is not working.. Please kindly correct me..</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1346, "user_id": 484130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8bd6aaab7589b8767c019423d72617d9?s=128&d=identicon&r=PG", "display_name": "Francis.TM", "link": "https://stackoverflow.com/users/484130/francis-tm"}, "is_accepted": false, "score": 0, "last_activity_date": 1455699245, "creation_date": 1455699245, "answer_id": 35451860, "question_id": 35451754, "link": "https://stackoverflow.com/questions/35451754/how-to-make-object-attr-required-when-creating-one/35451860#35451860", "title": "How to make object attr required when creating one", "body": "<p>validator will be run when <code>save</code>, <code>create</code>, <code>update</code>, <code>valid?</code> methods invoked.\nSo you could try </p>\n\n<pre><code>def some_action\n  @unit = Unit.create(some_attr: nil)\n  # then you can get @unit.errors here\nend\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5381611, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8c991bc138ee4305f6d0f562823cba88?s=128&d=identicon&r=PG&f=1", "display_name": "Bozidar Milivojevic", "link": "https://stackoverflow.com/users/5381611/bozidar-milivojevic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455699720, "creation_date": 1455698939, "last_edit_date": 1455699340, "question_id": 35451754, "link": "https://stackoverflow.com/questions/35451754/how-to-make-object-attr-required-when-creating-one", "title": "How to make object attr required when creating one", "body": "<p>I have model <code>Unit</code>. How do I prohibit <code>Unit.new</code> when I have <code>Unit.new(someAttr: nil , .........)</code>? I don't have any constructors, and when I try with <code>validates : someattr , presence: true</code> it is still the same.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "edited": false, "score": 0, "creation_date": 1455702711, "post_id": 35452968, "comment_id": 58602976, "body": "what would help me and be useful as an answer would be to see examples of how you would go about each test if you can please"}], "tags": [], "owner": {"reputation": 463, "user_id": 882700, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/32b241fb2372cc4f18e643d4d9032f19?s=128&d=identicon&r=PG", "display_name": "Vikram3891", "link": "https://stackoverflow.com/users/882700/vikram3891"}, "is_accepted": false, "score": 0, "last_activity_date": 1455702183, "creation_date": 1455702183, "answer_id": 35452968, "question_id": 35451342, "link": "https://stackoverflow.com/questions/35451342/understanding-how-to-test-a-class-using-rspec/35452968#35452968", "title": "Understanding how to test a class using RSpec", "body": "<p>I might not be spot on but I would answer the way I would have tackled the issue. There are three ways you can write a test that hits the code you want to test. </p>\n\n<ul>\n<li>Write a unit test for <code>braintree_hash</code> for <code>BraintreeTransaction::Sale</code> object</li>\n<li>Write a controller unit method for <code>create</code> method in <code>TransactionsController</code> controller</li>\n<li>write an integration test for route for <code>create</code> method in <code>TransactionsController</code>.</li>\n</ul>\n\n<p>These are the ways you can start exploring.</p>\n"}, {"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1455724663, "last_edit_date": 1495541734, "creation_date": 1455724663, "answer_id": 35461632, "question_id": 35451342, "link": "https://stackoverflow.com/questions/35451342/understanding-how-to-test-a-class-using-rspec/35461632#35461632", "title": "Understanding how to test a class using RSpec", "body": "<p>A couple of things here. All the suggestions for refactoring your code (from your other question <a href=\"https://stackoverflow.com/questions/35440167/writing-valuable-controller-tests-rspec\">Writing valuable controller tests - Rspec</a>) apply here. I can make further suggestions on this code, if helpful.</p>\n\n<p>In your test, I believe your problem is that you never actually call <code>BraintreeTransaction.new.braintree_hash(params)</code> (which should be called immediately following your <code>expect_any_instance_of</code> declaration). And so no instances ever receive the message(s).</p>\n"}], "owner": {"reputation": 13886, "user_id": 1150534, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/043af7a7ebf89595bebc3364f933d648?s=128&d=identicon&r=PG", "display_name": "Richlewis", "link": "https://stackoverflow.com/users/1150534/richlewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1526332683, "creation_date": 1455697410, "last_edit_date": 1526332683, "question_id": 35451342, "link": "https://stackoverflow.com/questions/35451342/understanding-how-to-test-a-class-using-rspec", "title": "Understanding how to test a class using RSpec", "body": "<p>The main thing I am looking to achieve from this question is understanding. With some assistance I have been looking at refactoring my controller code into more manageable modules/classes so that I can test them effectively. I have an example here that I would like to work on, my question is how would I test the class <code>Sale</code>:</p>\n\n<pre><code>class TransactionsController &lt; ApplicationController\n  def create\n    payment = BraintreeTransaction::VerifyPayment.new(params, @user_id, @transaction_total)\n    payment.run(params)\n\n  if payment.success?\n    redirect_to thank_you_path\n  else\n    flash.now[:alert] = payment.error\n    flash.keep\n    redirect_to new_transaction_path\n  end\nend\n\nmodule BraintreeTransaction\n  class VerifyPayment\n    def initialize(params, user_id, total)\n      @transaction_total = total\n      @user_id = user_id\n      @params = params\n      @error_message = nil\n   end\n\n  def run(params)\n    @result = BraintreeTransaction::Sale.new.braintree_hash(params, @transaction_total)\n    if @result.success?\n      @cart_items = CartItem.where(user_id: @user_id).where.not(image_id: nil)\n     @cart_items.destroy_all\n     create_real_user\n     update_completed_transaction\n     guest_user.destroy\n     @success = true\n  else\n    update_transaction\n    @error_message = BraintreeErrors::Errors.new.error_message(@result)\n  end\nend\n\n  def success?\n    @success\n  end\n\n  def error\n    @error_message\n  end\nend \n\nmodule BraintreeTransaction\n  class Sale\n    def braintree_hash(params, total)\n      Braintree::Transaction.sale(\n        amount: total,\n        payment_method_nonce: params[:payment_method_nonce],\n        device_data: params[:device_data],\n        customer: {\n          first_name: params[:first_name],\n          last_name: params[:last_name],\n          email: params[:email],\n          phone: params[:phone]\n        },\n        billing: {\n          first_name: params[:first_name],\n          last_name: params[:last_name],\n          company: params[:company],\n          street_address: params[:street_address],\n          locality: params[:locality],\n       region: params[:region],\n         postal_code: params[:postal_code]\n       },\n       shipping: {\n        first_name: params[:shipping_first_name].presence || params[:first_name].presence,\n      last_name: params[:shipping_last_name].presence || params[:last_name].presence,\n        company: params[:shipping_company].presence || params[:company].presence,\n      street_address: params[:shipping_street_address].presence || params[:street_address].presence,\n         locality: params[:shipping_locality].presence || params[:locality].presence,\n      region: params[:shipping_region].presence || params[:region].presence,\n      postal_code: params[:shipping_postal_code].presence || params[:postal_code].presence\n    },\n    options: {\n      submit_for_settlement: true,\n      store_in_vault_on_success: true\n    }\n  )\n  end\n end\nend\n</code></pre>\n\n<p>I don't know if I am looking at this wrong but this piece of code here <code>BraintreeTransaction::Sale.new.braintree_hash</code> is what I want to test and I want to ensure that when called the class receives a hash ?</p>\n\n<h2>Update</h2>\n\n<p>So far I have come up with this (though I am not 100% confident it is the correct approach ?)</p>\n\n<pre><code>require 'rails_helper'\nRSpec.describe BraintreeTransaction::Sale do\n @transaction_total = 100\n let(:params) { FactoryGirl.attributes_for(:braintree_transaction, amount: @transaction_total) }\n it 'recieves a hash when creating a payment' do\n  expect_any_instance_of(BraintreeTransaction::Sale).to receive(:braintree_hash).with(params, @transaction_total).and_return(true)\n end\nend\n</code></pre>\n\n<p>I get an error returned which I don't understand</p>\n\n<pre><code>Failure/Error: DEFAULT_FAILURE_NOTIFIER = lambda { |failure, _opts| raise failure }\nExactly one instance should have received the following message(s) but didn't: braintree_hash\n</code></pre>\n"}, {"tags": ["ruby", "image-processing", "minimagick"], "answers": [{"comments": [{"owner": {"reputation": 506, "user_id": 1658182, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0b57ea0ad429c2fb50dff41efbf918ec?s=128&d=identicon&r=PG", "display_name": "Aayush Kothari", "link": "https://stackoverflow.com/users/1658182/aayush-kothari"}, "edited": false, "score": 0, "creation_date": 1455703671, "post_id": 35453400, "comment_id": 58603755, "body": "Could you confirm mask.png is the background image and avatar.jpg the cartoon&#39;s link I provided?"}, {"owner": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "reply_to_user": {"reputation": 506, "user_id": 1658182, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0b57ea0ad429c2fb50dff41efbf918ec?s=128&d=identicon&r=PG", "display_name": "Aayush Kothari", "link": "https://stackoverflow.com/users/1658182/aayush-kothari"}, "edited": false, "score": 0, "creation_date": 1455703822, "post_id": 35453400, "comment_id": 58603869, "body": "No, they are not, you provided an opaque JPEG for the mask which nothing will show through - so I made a PNG out of it with a transparent hole in it."}, {"owner": {"reputation": 506, "user_id": 1658182, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0b57ea0ad429c2fb50dff41efbf918ec?s=128&d=identicon&r=PG", "display_name": "Aayush Kothari", "link": "https://stackoverflow.com/users/1658182/aayush-kothari"}, "edited": false, "score": 0, "creation_date": 1455704390, "post_id": 35453400, "comment_id": 58604265, "body": "Ah, okay. Also, could you please walk me through how this solution achieves the result and how do I translate this to Ruby code?"}, {"owner": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "reply_to_user": {"reputation": 506, "user_id": 1658182, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0b57ea0ad429c2fb50dff41efbf918ec?s=128&d=identicon&r=PG", "display_name": "Aayush Kothari", "link": "https://stackoverflow.com/users/1658182/aayush-kothari"}, "edited": false, "score": 0, "creation_date": 1455705012, "post_id": 35453400, "comment_id": 58604750, "body": "Sorry I don&#39;t speak Ruby. I basically take the avatar and resize that to 200x200. Then I take the mask and the resized avatar, move the avatar over to the right place with <code>-geometry</code> and then use a <code>Dst-Over</code> composition to composite the mask over the avatar."}], "tags": [], "owner": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": true, "score": 2, "last_activity_date": 1455703235, "creation_date": 1455703235, "answer_id": 35453400, "question_id": 35450852, "link": "https://stackoverflow.com/questions/35450852/minimagick-how-do-i-add-an-overlay-stock-image-thats-larger-than-the-source/35453400#35453400", "title": "MiniMagick: How do I add an overlay stock image that&#39;s larger than the source?", "body": "<p>Not too sure what you are doing as your mask is an opaque JPEG? However, I think you mean to use a transparent PNG for the mask with a hole in it, in which case you could do this:</p>\n\n<pre><code>convert mask.png \\( avatar.jpg -resize 200x200 \\) -geometry +360+150 -compose dst-over -composite result.jpg\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ERzBk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ERzBk.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 506, "user_id": 1658182, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0b57ea0ad429c2fb50dff41efbf918ec?s=128&d=identicon&r=PG", "display_name": "Aayush Kothari", "link": "https://stackoverflow.com/users/1658182/aayush-kothari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 35453400, "answer_count": 1, "score": 2, "last_activity_date": 1455709226, "creation_date": 1455695818, "last_edit_date": 1495540820, "question_id": 35450852, "link": "https://stackoverflow.com/questions/35450852/minimagick-how-do-i-add-an-overlay-stock-image-thats-larger-than-the-source", "title": "MiniMagick: How do I add an overlay stock image that&#39;s larger than the source?", "body": "<p>We're trying to achieve building a custom social sharing image from our app. The backend is built using Ruby/Sinatra and we already use MiniMagick+AWS-SDK to upload user images.</p>\n\n<p>What we want to do is take the user's image and add a stock overlay (it contains a white circle as the placeholder for the variable user image) on top of the user image. I tried using MiniMagick's built-in <code>composite</code> method using <code>Over</code> as the operator, but the problem with <code>Over</code>is, if the overlay is larger than the source, it automatically adjusts according to the source's size. Our overlay is larger and we <strong>want to retain</strong> the overlay such that the resulting image has the complete overlay with the part of the user image that fits the placeholder white circle visible underneath. </p>\n\n<p>I tried <a href=\"https://stackoverflow.com/questions/8699228/how-to-use-imagick-to-merge-and-mask-images\">How to use Imagick to merge and mask images?</a> but it doesn't solve my problem. </p>\n\n<p>Basically, say this is the overlay.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aERil.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aERil.jpg\" alt=\"Stock Overlay\"></a></p>\n\n<p>And take this sample user image as example: </p>\n\n<p><a href=\"https://s-media-cache-ak0.pinimg.com/564x/71/08/b5/7108b5a89ce3d6cc0341f876681f8546.jpg\" rel=\"nofollow noreferrer\">https://s-media-cache-ak0.pinimg.com/564x/71/08/b5/7108b5a89ce3d6cc0341f876681f8546.jpg</a></p>\n\n<p>I would like the resulting image to be the complete overlay with the user image visible behind one of those while circles. </p>\n\n<p><strong>Update</strong></p>\n\n<p>As per <a href=\"https://stackoverflow.com/users/2836621/mark-setchell\">Mark's</a>answer, I wrote the following Ruby code to achieve the result:</p>\n\n<pre><code>avatar = avatar.resize \"200x200\"\nresult = mask.composite(avatar) do |c|\n    c.compose \"DstOver\"\n    c.geometry \"+100+120\" #this could be different depending on your mask's dimensions\nend \n</code></pre>\n\n<p>You can test the result by executing <code>result.write \"result.jpg\"</code></p>\n"}, {"tags": ["ruby", "typhoeus"], "answers": [{"tags": [], "owner": {"reputation": 4875, "user_id": 3098330, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/7GLfA.jpg?s=128&g=1", "display_name": "Gupta", "link": "https://stackoverflow.com/users/3098330/gupta"}, "is_accepted": true, "score": 0, "last_activity_date": 1456128531, "creation_date": 1456128531, "answer_id": 35548617, "question_id": 35450619, "link": "https://stackoverflow.com/questions/35450619/wires-issue-with-typhous-to-find-out-effective-url-from-response/35548617#35548617", "title": "Wires Issue with Typhous to find out effective_url from response", "body": "<p>In order to Get <code>effective_url</code>, I parsed the response using <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow\">Nokogiri Gem</a>  because <code>effective_url</code> is present in <code>script tag</code>. </p>\n\n<pre><code>noko = Nokogiri::HTML(res.response_body)\nurl =ActionView::Base.full_sanitizer.sanitize(noko.to_s.split(\"url\").last).gsub(\"\\n\", \"\").gsub(\"&gt;\", \"\")\nurl[0] = ''\nurl\n\n#=&gt; \"http://jobs.brassring.com/1033/ASP/TG/cim_jobdetail.asp?partnerid=25561&amp;amp;siteid=5140&amp;amp;Areq=14808BR&amp;amp;source=Careerbuilder\"\n</code></pre>\n"}], "owner": {"reputation": 4875, "user_id": 3098330, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/7GLfA.jpg?s=128&g=1", "display_name": "Gupta", "link": "https://stackoverflow.com/users/3098330/gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 35548617, "answer_count": 1, "score": 0, "last_activity_date": 1456128599, "creation_date": 1455694995, "last_edit_date": 1456128599, "question_id": 35450619, "link": "https://stackoverflow.com/questions/35450619/wires-issue-with-typhous-to-find-out-effective-url-from-response", "title": "Wires Issue with Typhous to find out effective_url from response", "body": "<pre><code>res = Typhoeus.get(\"http://atk.contacthr.com/38673270\", \n                    followlocation: true, \n                    ssl_verifypeer: false,\n                    maxredirs: 2, \n                    timeout: 60, \n                    connecttimeout: 60)\nres.effective_url.to_s.force_encoding('UTF-8')\n#=&gt;  \"https://careers.atk.com/viewjob.html?erjob=55430:en_US&amp;eresc=CareerBuilder%2Ecom\n</code></pre>\n\n<p>It Works well !!! But not Unable to find <code>effective_url</code> from request having host </p>\n\n<p><code>http://www.aplitrak.com/?adid=Q29sZXR0ZS4xMjIxNS43MDJAbGhjZy5hcGxpdHJhay5jb20</code></p>\n\n<pre><code>res = Typhoeus.get(\"http://www.aplitrak.com/?adid=Q29sZXR0ZS4xMjIxNS43MDJAbGhjZy5hcGxpdHJhay5jb20\", followlocation: true, ssl_verifypeer: false, maxredirs: 2, timeout: 60, connecttimeout: 60)\n\n=&gt; #&lt;Typhoeus::Response:0xcdff578 @options={:httpauth_avail=&gt;0, :total_time=&gt;2.345899, :starttransfer_time=&gt;2.345752, :appconnect_time=&gt;0.0, :pretransfer_time=&gt;0.004462, :connect_time=&gt;0.004435, :namelookup_time=&gt;0.004139, :redirect_time=&gt;0.0, :effective_url=&gt;\"http://www.aplitrak.com/?adid=Q29sZXR0ZS4xMjIxNS43MDJAbGhjZy5hcGxpdHJhay5jb20\", :primary_ip=&gt;\"46.254.116.54\", :response_code=&gt;200, :request_size=&gt;169, :redirect_count=&gt;0, :return_code=&gt;:ok, :response_headers=&gt;\"HTTP/1.0 200 OK\\r\\nServer: nginx\\r\\nDate: Wed, 17 Feb 2016 07:39:00 GMT\\r\\nContent-Type: text/html; charset=UTF-8\\r\\nVary: Accept-Encoding\\r\\nVary: Accept-Encoding\\r\\nX-Cache: MISS from Dwarpal.localdomain\\r\\nX-Cache-Lookup: MISS from Dwarpal.localdomain:8080\\r\\nX-Cache: MISS from Dwarpal.localdomain\\r\\nX-Cache-Lookup: MISS from Dwarpal.localdomain:8080\\r\\nVia: 1.0 Dwarpal.localdomain:8080 (squid/2.6.STABLE22), 1.0 Dwarpal.localdomain:8080 (squid/2.6.STABLE22)\\r\\nConnection: close\\r\\n\\r\\n\", :response_body=&gt;\"&lt;!DOCTYPE html&gt;\\n&lt;html&gt;\\n    &lt;head&gt;\\n    &lt;script type=\\\"text/javascript\\\"&gt;\\n\\n      var _gaq = _gaq || [];\\n     \n_gaq.push(['_setAccount', 'UA-18771510-2']);\\n      _gaq.push(['_trackPageview']);\\n\\n      (function() {\\n        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\\n        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\\n        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\\n      })();\\n\\n    &lt;/script&gt;\\n\\n&lt;!-- line 230 --&gt;\\n\\n        &lt;script type=\\\"text/javascript\\\"&gt;\\n            function Adcourier() { this.locale = 'en-usa'; }\\n\\n            var Adcourier = new Adcourier();\\n        &lt;/script&gt;\\n    &lt;script type=\\\"text/javascript\\\"&gt;\\n            function translate_js (translation_hash) {\\n                var locale = Adcourier.locale;\\n if ( !locale ) { locale = 'en'; }\\n\\n                var text = translation_hash[locale];\\n\\n                if( !text ){ text = translation_hash['en']; }\\n\\n                for (var i=1, len=arguments.length; i&lt;len; i++) {\\n                    var regex = new RegExp('%'+i+'%', 'g');\\n                    text = text.replace(regex, arguments[i]);\\n                }\\n                return text;\\n            }\\n        &lt;/script&gt;&lt;meta http-equiv=\\\"refresh\\\" content=\\\"0;url=https://lhcgroup-openhire.silkroad.com/epostings/index.cfm?fuseaction=app.jobinfo&amp;jobid=3318&amp;company_id=17106&amp;version=1&amp;source=CareerBuilder\\\"&gt;\\n\", :debug_info=&gt;#&lt;Ethon::Easy::DebugInfo:0xce7e328 @messages=[]&gt;}, @request=#&lt;Typhoeus::Request:0xce00bf8 @base_url=\"http://www.aplitrak.com/?adid=Q29sZXR0ZS4xMjIxNS43MDJAbGhjZy5hcGxpdHJhay5jb20\", @original_options={:followlocation=&gt;true, :ssl_verifypeer=&gt;false, :maxredirs=&gt;2, :timeout=&gt;60, :connecttimeout=&gt;60, :method=&gt;:get}, @options={:followlocation=&gt;true, :ssl_verifypeer=&gt;false, :maxredirs=&gt;2, :timeout=&gt;60, :connecttimeout=&gt;60, :method=&gt;:get, :headers=&gt;{\"User-Agent\"=&gt;\"Typhoeus - https://github.com/typhoeus/typhoeus\"}}, @on_headers=[], @response=#&lt;Typhoeus::Response:0xcdff578 ...&gt;, @on_complete=[], @on_success=[]&gt;&gt;\n</code></pre>\n\n<p>Any help would be appriciated !!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1455696888, "post_id": 35450367, "comment_id": 58599115, "body": "You probably use something like <code>Time.now</code> in your code to get the current date / week. Replace that with a variable and let admins set it manually."}, {"owner": {"reputation": 12784, "user_id": 1373987, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bca7defe7b8087d8e261d32b29cf425e?s=128&d=identicon&r=PG", "display_name": "joshua.paling", "link": "https://stackoverflow.com/users/1373987/joshua-paling"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1455698038, "post_id": 35450367, "comment_id": 58599805, "body": "Thanks - but is the current code unsafe? And if so, why? There&#39;s a few places that use the current time, so while it&#39;ll work, I&#39;d prefer to avoid your approach if possible."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1455698493, "post_id": 35450367, "comment_id": 58600051, "body": "Timecop affects any time related method, e.g. ActiveRecord&#39;s <code>created_at</code> / <code>updated_at</code> fields. Think of a record that has been update before it was created or a new comment that was written in the past. This could become quite a mess."}], "answers": [{"tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 2, "last_activity_date": 1455699086, "creation_date": 1455699086, "answer_id": 35451809, "question_id": 35450367, "link": "https://stackoverflow.com/questions/35450367/timecop-in-production-on-a-per-request-basis/35451809#35451809", "title": "TimeCop in production on a per-request basis", "body": "<p>MRI's global interpreter lock does mean that 2 threads won't execute concurrently, but the granularity of that is much much smaller than the processing of one request.</p>\n\n<p>As it happens unicorn doesn't use threads for concurrency so you'd be ok, but the day you switched to another server (eg puma) then you'd be in for a nasty surprise. </p>\n\n<p>This would also affect things like data in logs, created_at/updated_at timestamps for anything updated and so on. It might also affect monitoring data gathered by services like newrelic, airbrake etc if you use those. Another example of something that might seem completely unrelated is api requests to AWS: the signature that verifies these requests includes a timestamp, and they will fail if you're out of sync by more than a few minutes. There is just too much code (much of which you don't control) that assumes that Time.now is accurate.</p>\n\n<p>You'd be much better off identifying those bits of code that implicitly use the current Time and changing them to allow the desired time to be passed as an argument. </p>\n\n<p>As an aside I think your code would leave the altered time in place if the controller raised an exception</p>\n"}], "owner": {"reputation": 12784, "user_id": 1373987, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bca7defe7b8087d8e261d32b29cf425e?s=128&d=identicon&r=PG", "display_name": "joshua.paling", "link": "https://stackoverflow.com/users/1373987/joshua-paling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 35451809, "answer_count": 1, "score": 0, "last_activity_date": 1455699086, "creation_date": 1455694064, "question_id": 35450367, "link": "https://stackoverflow.com/questions/35450367/timecop-in-production-on-a-per-request-basis", "title": "TimeCop in production on a per-request basis", "body": "<p>I've got a rails app using MRI ruby and Unicorn as the app server. The app provides a 10-week fitness program, and I've built a feature for people logged in as admins to be able to \"time travel\" to different weeks in the program. Basically, it just sets a session variable with the date they're \"time travelled\" to, and, each request, it time-travels to that point at the beginning, then returns at the end. The code is below.</p>\n\n<p>I'd limited the feature non-production environments, out of fear that one person's time-travelling may affect other users (since TimeCop monkey patches core classes). But, given MRI isn't really multi-threaded I'm now thinking that's an irrational fear, and that there should be no danger of using the \"time travel\" feature in production.</p>\n\n<p>For the duration within which a single request is processed (and therefore the time for which the core classes are monkey patched by TimeCop if the user is using \"time travel\"), there should be no possibility that any other request gets run on the same ruby process.</p>\n\n<p>Is this correct? Or can other user's requests be affected by TimeCop's changes to the core classes in a way I'm not aware of?</p>\n\n<p>The code I'm using is as follows:</p>\n\n<pre><code>module TimeTravelFilters\n  extend ActiveSupport::Concern\n\n  included do\n    if Rails.env.development? || Rails.env.staging?\n      around_action :time_travel_for_request\n    end\n  end\n\n  def time_travel_for_request\n    time_travel\n    yield\n    time_travel_return\n  end\n\n  def time_travel\n    if session[:timetravel_to_date]\n      Timecop.travel(session[:timetravel_to_date])\n    end\n  end\n\n  def time_travel_return\n    Timecop.return\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1455698001, "post_id": 35450739, "comment_id": 58599789, "body": "Wouldn&#39;t this be a misuse of <code>throw</code>? From my understanding, <code>throw</code> is a way to write a &quot;controlled <code>goto</code>&quot;, for instance for jumping out from an inner loop. Would it be sane to jump to a place &quot;outside&quot; your application? If I wanted to do this, I would use an exception (<code>fail</code>), not <code>throw</code>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1455698170, "post_id": 35450739, "comment_id": 58599864, "body": "@user1934428 What if it is not an error, but you just want to quit the execution (under a complicated condition), and return to the original position? Using exception is a misuse."}, {"owner": {"reputation": 1011, "user_id": 3891638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pqkeX.jpg?s=128&g=1", "display_name": "cozyconemotel", "link": "https://stackoverflow.com/users/3891638/cozyconemotel"}, "edited": false, "score": 1, "creation_date": 1455703457, "post_id": 35450739, "comment_id": 58603563, "body": "That&#39;s actually a very good explanation. Thank you. Wonder if a similar conversation was held among the Ruby committers too"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1455715530, "post_id": 35450739, "comment_id": 58612233, "body": "@sawa: The original position <b>outside</b> my application? Sorry, but I would consider this pretty bad programming style. Note also that an exception doesn&#39;t necessarily mean an error in the strict sense (one man&#39;s error could be another man&#39;s anticipated behaviour), but an &quot;exceptional situation&quot;. Think about a library function reading past end-of-file and raising an exception. As a user of this function, I can use it in a good way to catch it and know that I&#39;m done."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 5, "last_activity_date": 1455697530, "last_edit_date": 1455697530, "creation_date": 1455695396, "answer_id": 35450739, "question_id": 35450221, "link": "https://stackoverflow.com/questions/35450221/why-would-one-ever-throw-a-non-symbol/35450739#35450739", "title": "Why would one ever throw a non-symbol?", "body": "<p>Suppose you are using some library whose internals you are not concerned about. What if that library uses a <code>throw</code> method with a certain symbol (or any other common object) that accidentally happens to be the same symbol (or an object) that you are <code>throw</code>-ing in your own code? It will cause unwanted interactions. On the other hand, if you create a custom object and throw it, you don't have to care about such problems. Especially if you define it only as a local variable, it would be safe. If you define it as a constant, then it would be relatively safe (the danger being that the other library accidentally uses the same constant name in the same name space).</p>\n\n<p><code>catch</code> with a block parameter creates an instance of <code>Object</code>, and assign that as a block variable, which makes it safe.</p>\n\n<p>When I use <code>throw</code>, I usually cannot use the block variable-form because most of the time, I <code>throw</code> and <code>catch</code> in different methods. So, I create an instance of <code>Object</code>, and assign it as a private constant, which makes it relatively safe.</p>\n\n<pre><code>class SomeClass\n  Foo = Object.new\n  private_constant :Foo\n\n  def some_method\n    ...\n    catch(Foo){... another_method ...}\n    ...\n  end\n  def another_method\n    ...\n    throw(Foo)\n    ...\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1011, "user_id": 3891638, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pqkeX.jpg?s=128&g=1", "display_name": "cozyconemotel", "link": "https://stackoverflow.com/users/3891638/cozyconemotel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 35450739, "answer_count": 1, "score": 2, "last_activity_date": 1455697530, "creation_date": 1455693457, "last_edit_date": 1455694834, "question_id": 35450221, "link": "https://stackoverflow.com/questions/35450221/why-would-one-ever-throw-a-non-symbol", "title": "Why would one ever throw a non-symbol?", "body": "<p>Ruby's <code>throw</code> statement accepts any <code>Object</code>, which means any of these below are legal.</p>\n\n<pre><code>throw BasicObject\nthrow 123456.78\nthrow \"wow\"\nthrow :doge\n</code></pre>\n\n<p>In my understanding, however, there are 2 reasons why I would choose to throw a <code>Symbol</code>.</p>\n\n<ol>\n<li>One must <code>catch</code> the exact same <code>Object</code> that was thrown. This means that doing <code>catch \"wow\"</code> would result in an <code>UncaughtThrowError</code>. This is not a problem when using <code>Symbol</code>s.</li>\n<li>The <code>Object</code> that was thrown cannot be referenced after a <code>catch</code>. To specify a return value, one would input it as the 2nd argument: <code>throw :doge, \"wow\"</code> This would destroy the whole point of throwing a custom <code>Object</code> in my opinion..</li>\n</ol>\n\n<p>Furthermore, what's confusing is that the (first) argument to <code>throw</code> used to be restricted to <code>Symbols</code> before <code>ruby 1.9</code>. Wouldn't this mean that there was somebody that had to <code>throw</code> non-Symbols, and ruby had to change their implementation to allow such use cases? Or was it something else.. like saving execution time for a type check.</p>\n\n<p>At this point, the only thing I can imagine throwing apart from <code>Symbol</code>s are <code>Fixnum</code>s, but was that the reason for the change? Please enlighten me.</p>\n"}, {"tags": ["node.js", "ruby", "zlib"], "comments": [{"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1455693956, "post_id": 35450167, "comment_id": 58597631, "body": "you are forcing encoding on the deflated data?"}], "answers": [{"comments": [{"owner": {"reputation": 3805, "user_id": 247707, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3518ff338e5eee9b32eb1815daabc602?s=128&d=identicon&r=PG", "display_name": "MB.", "link": "https://stackoverflow.com/users/247707/mb"}, "edited": false, "score": 0, "creation_date": 1455818841, "post_id": 35450413, "comment_id": 58671363, "body": "I&#39;m afraid this doesn&#39;t work. Without force_encoding it crashes with error &quot;from ASCII-8BIT to UTF-8&quot;. With force_encoding it doesn&#39;t return anything."}, {"owner": {"reputation": 7832, "user_id": 556678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fc6d0d5f5aae08da0827d9e60d873c27?s=128&d=identicon&r=PG", "display_name": "Eye", "link": "https://stackoverflow.com/users/556678/eye"}, "reply_to_user": {"reputation": 3805, "user_id": 247707, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3518ff338e5eee9b32eb1815daabc602?s=128&d=identicon&r=PG", "display_name": "MB.", "link": "https://stackoverflow.com/users/247707/mb"}, "edited": false, "score": 0, "creation_date": 1455858337, "post_id": 35450413, "comment_id": 58687293, "body": "I&#39;ve expanded the example with a real working code. Please check."}, {"owner": {"reputation": 7832, "user_id": 556678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fc6d0d5f5aae08da0827d9e60d873c27?s=128&d=identicon&r=PG", "display_name": "Eye", "link": "https://stackoverflow.com/users/556678/eye"}, "reply_to_user": {"reputation": 3805, "user_id": 247707, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3518ff338e5eee9b32eb1815daabc602?s=128&d=identicon&r=PG", "display_name": "MB.", "link": "https://stackoverflow.com/users/247707/mb"}, "edited": false, "score": 0, "creation_date": 1456450212, "post_id": 35450413, "comment_id": 58964822, "body": "@MB. have you got a chance to check my answer?"}], "tags": [], "owner": {"reputation": 7832, "user_id": 556678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fc6d0d5f5aae08da0827d9e60d873c27?s=128&d=identicon&r=PG", "display_name": "Eye", "link": "https://stackoverflow.com/users/556678/eye"}, "is_accepted": true, "score": 2, "last_activity_date": 1455858253, "last_edit_date": 1455858253, "creation_date": 1455694240, "answer_id": 35450413, "question_id": 35450167, "link": "https://stackoverflow.com/questions/35450167/how-to-decompress-in-node-data-that-was-compressed-in-ruby-with-gzip/35450413#35450413", "title": "How to decompress in node data that was compressed in ruby with gzip?", "body": "<p>I am not a Ruby dev, so I will write the Ruby part in more or less pseudo code.</p>\n\n<p><strong>Ruby code</strong> (run online at <a href=\"https://repl.it/BoRD/0\" rel=\"nofollow\">https://repl.it/BoRD/0</a>)</p>\n\n<pre><code>require 'json'\nrequire 'zlib'\n\ncar = {:make =&gt; \"bmw\", :year =&gt; \"2003\"}\n\ncar_str = car.to_json\n\nputs \"car_str\", car_str\n\ncar_byte = Zlib::Deflate.deflate(car_str)\n# If you try to `puts car_byte`, it will crash with the following error:\n# \"\\x9C\" from ASCII-8BIT to UTF-8\n#(repl):14:in `puts'\n#(repl):14:in `puts'\n#(repl):14:in `initialize'\n\ncar_str_dec = Zlib::Inflate.inflate(car_byte)\n\nputs \"car_str_dec\", car_str_dec\n# You can check that the decoded message is the same as the source.\n\n# somehow send `car_byte`, the encoded bytes to RabbitMQ.\n</code></pre>\n\n<p><strong>Node code</strong></p>\n\n<pre><code>var zlib = require('zlib');\n\n// somehow get the message from RabbitMQ.\nvar data = '...';\n\nzlib.inflate(data, function (err, buffer) {\n    if (err) {\n        // Handle the error.\n    } else {\n       // If source didn't have any encoding,\n       // no need to specify the encoding.\n       console.log(buffer.toString());\n    }\n});\n</code></pre>\n\n<p>I also suggest you to stick with async functions in Node instead of their sync alternatives.</p>\n"}], "owner": {"reputation": 3805, "user_id": 247707, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3518ff338e5eee9b32eb1815daabc602?s=128&d=identicon&r=PG", "display_name": "MB.", "link": "https://stackoverflow.com/users/247707/mb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 35450413, "answer_count": 1, "score": 0, "last_activity_date": 1518082538, "creation_date": 1455693237, "last_edit_date": 1518082538, "question_id": 35450167, "link": "https://stackoverflow.com/questions/35450167/how-to-decompress-in-node-data-that-was-compressed-in-ruby-with-gzip", "title": "How to decompress in node data that was compressed in ruby with gzip?", "body": "<p>We have a ruby instance that sends a message to a node instance via rabbitmq (bunny and amqplib) like below:</p>\n\n<pre><code>{ :type =&gt; data, :data =&gt; msg }.to_bson.to_s\n</code></pre>\n\n<p>This seems to be going pretty well, but msg's are sometimes long and we are sending them across data centers. zlib would help a lot.</p>\n\n<p>doing smth like this in the ruby sender:</p>\n\n<pre><code>encoded_data = Zlib::Deflate.deflate(msg).force_encoding(msg.encoding)\n</code></pre>\n\n<p>and then reading it inside node:</p>\n\n<pre><code>data = zlib.inflateSync(encoded_data)\n</code></pre>\n\n<p>returns </p>\n\n<pre><code>\"\\x9C\" from ASCII-8BIT to UTF-8\n</code></pre>\n\n<p>Is what I'm trying to do possible?</p>\n"}, {"tags": ["ruby", "local-variables"], "comments": [{"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 2, "creation_date": 1455692476, "post_id": 35449894, "comment_id": 58596925, "body": "It didn&#39;t run at all when I tried to run it (because inside a method created with def you can&#39;t see local variables such as movie_ratings created outside)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1455692588, "post_id": 35449894, "comment_id": 58596967, "body": "@FrederickCheung: That is the problem, I guess."}], "answers": [{"tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": false, "score": 1, "last_activity_date": 1455692482, "creation_date": 1455692482, "answer_id": 35449962, "question_id": 35449894, "link": "https://stackoverflow.com/questions/35449894/why-doesnt-this-example-ruby-code-print-the-result/35449962#35449962", "title": "Why doesn&#39;t this example ruby code print the result?", "body": "<p>The variable <code>movie_ratings</code> is not in the scope of the method. you should pass it as a parameter:</p>\n\n<pre><code>movie_ratings = {\n  memento: 3,\n  primer: 3.5,\n  the_matrix: 5,\n  truman_show: 4,\n  red_dawn: 1.5,\n  skyfall: 4,\n  alex_cross: 2,\n  uhf: 1,\n  lion_king: 3.5\n}\n\ndef good_movies movie_ratings\n  puts movie_ratings.select {|movies, ratings| ratings &gt; 3}\nend\ngood_movies movie_ratings\n# {:primer=&gt;3.5, :the_matrix=&gt;5, :truman_show=&gt;4, :skyfall=&gt;4, :lion_king=&gt;3.5}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1455692484, "creation_date": 1455692484, "answer_id": 35449963, "question_id": 35449894, "link": "https://stackoverflow.com/questions/35449894/why-doesnt-this-example-ruby-code-print-the-result/35449963#35449963", "title": "Why doesn&#39;t this example ruby code print the result?", "body": "<p>Because local variables cannot take scope into a method block. Change it to another type of variable, for example an instance variable, and it will work.</p>\n\n<pre><code>@movie_ratings = {\n  memento: 3,\n  primer: 3.5,\n  the_matrix: 5,\n  truman_show: 4,\n  red_dawn: 1.5,\n  skyfall: 4,\n  alex_cross: 2,\n  uhf: 1,\n  lion_king: 3.5\n}\n\ndef good_movies\n  puts @movie_ratings.select {|movies, ratings| ratings &gt; 3}\nend\ngood_movies\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1455692558, "creation_date": 1455692558, "answer_id": 35449987, "question_id": 35449894, "link": "https://stackoverflow.com/questions/35449894/why-doesnt-this-example-ruby-code-print-the-result/35449987#35449987", "title": "Why doesn&#39;t this example ruby code print the result?", "body": "<p>Local variable <code>movie_ratings</code> is not accessible in the method <code>good_movies</code>. Several approaches are available here:</p>\n\n<ol>\n<li><p>Pass ratings as a parameter</p>\n\n<pre><code>movie_ratings = {\n  memento: 3,\n  primer: 3.5,\n  the_matrix: 5,\n  truman_show: 4,\n  red_dawn: 1.5,\n  skyfall: 4,\n  alex_cross: 2,\n  uhf: 1,\n  lion_king: 3.5\n}\n\ndef good_movies(ratings)\n  puts ratings.select {|movies, ratings| ratings &gt; 3}\nend\n\ngood_movies(movie_ratings)\n</code></pre></li>\n<li><p>Make ratings instance variable (instead of local variable)</p>\n\n<pre><code>@movie_ratings = {\n  memento: 3,\n  primer: 3.5,\n  the_matrix: 5,\n  truman_show: 4,\n  red_dawn: 1.5,\n  skyfall: 4,\n  alex_cross: 2,\n  uhf: 1,\n  lion_king: 3.5\n}\n\ndef good_movies\n  puts @movie_ratings.select {|movies, ratings| ratings &gt; 3}\nend\n\ngood_movies\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1455692646, "post_id": 35449996, "comment_id": 58596987, "body": "Don&#39;t need <code>return</code> here."}], "tags": [], "owner": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455692611, "creation_date": 1455692611, "answer_id": 35449996, "question_id": 35449894, "link": "https://stackoverflow.com/questions/35449894/why-doesnt-this-example-ruby-code-print-the-result/35449996#35449996", "title": "Why doesn&#39;t this example ruby code print the result?", "body": "<p>If you're getting the following error:</p>\n\n<pre><code>NameError: undefined local variable or method `movie_ratings' for main:Object\n</code></pre>\n\n<p>The reason is the method <code>good_movies</code> creates its own local scope, and it doesn't understand what <code>movie_ratings</code> is. You need to pass it to the method so that the method will understand what it is.</p>\n\n<pre><code>def good_movies(movies)\n  return movies.select { |m, r| r &gt; 3 }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 3198681, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxRbd.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3198681/akshay"}, "is_accepted": false, "score": 1, "last_activity_date": 1455696457, "last_edit_date": 1455696457, "creation_date": 1455692863, "answer_id": 35450055, "question_id": 35449894, "link": "https://stackoverflow.com/questions/35449894/why-doesnt-this-example-ruby-code-print-the-result/35450055#35450055", "title": "Why doesn&#39;t this example ruby code print the result?", "body": "<p>You should either pass <code>movie_ratings</code> to the method <code>good_movies</code> like this :</p>\n\n<pre><code>def good_movies(movie_ratings)\n  puts movie_ratings.select {|movies, ratings| ratings &gt; 3}\nend\n</code></pre>\n\n<p>or make movie_ratings an instance variable like this:</p>\n\n<pre><code>@movie_ratings\n</code></pre>\n\n<p>and then inside the method use: <code>puts @movie_ratings.select {|movies, ratings| ratings &gt; 3}</code></p>\n"}], "owner": {"reputation": 1080, "user_id": 5166249, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-WzuHmMgRjOk/AAAAAAAAAAI/AAAAAAAAANM/KmLSxYcVElE/photo.jpg?sz=128", "display_name": "Penny", "link": "https://stackoverflow.com/users/5166249/penny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 35449987, "answer_count": 5, "score": 0, "last_activity_date": 1455696457, "creation_date": 1455692219, "last_edit_date": 1455692748, "question_id": 35449894, "link": "https://stackoverflow.com/questions/35449894/why-doesnt-this-example-ruby-code-print-the-result", "title": "Why doesn&#39;t this example ruby code print the result?", "body": "<p>I'm wondering why the code below doesn't print the movies that have more than 3 stars.</p>\n\n<pre><code>movie_ratings = {\n  memento: 3,\n  primer: 3.5,\n  the_matrix: 5,\n  truman_show: 4,\n  red_dawn: 1.5,\n  skyfall: 4,\n  alex_cross: 2,\n  uhf: 1,\n  lion_king: 3.5\n}\n\ndef good_movies\n  puts movie_ratings.select {|movies, ratings| ratings &gt; 3}\nend\ngood_movies\n</code></pre>\n"}, {"tags": ["ruby", "testing", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1455692047, "post_id": 35449782, "comment_id": 58596743, "body": "This does not answer the question."}, {"owner": {"reputation": 273, "user_id": 5907524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5e14d614787e586c32615d9597507154?s=128&d=identicon&r=PG&f=1", "display_name": "super_noobling", "link": "https://stackoverflow.com/users/5907524/super-noobling"}, "edited": false, "score": 0, "creation_date": 1455693239, "post_id": 35449782, "comment_id": 58597287, "body": "/.rvm/gems/ruby-2.2.1/gems/rspec-core-3.4.1/lib/rspec/core/e&zwnj;&#8203;xample_group.rb:667:&zwnj;&#8203;in <code>method_missing&#39;: </code>board` is not available on an example group (e.g. a <code>describe</code> or <code>context</code> block). It is only available from within individual examples (e.g. <code>it</code> blocks) or from constructs that run in the scope of an example (e.g. <code>before</code>, <code>let</code>, etc). (RSpec::Core::ExampleGroup::WrongScopeError)"}, {"owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "edited": false, "score": 0, "creation_date": 1455693720, "post_id": 35449782, "comment_id": 58597515, "body": "I think you were misusing the <a href=\"http://lmws.net/describe-vs-context-in-rspec\" rel=\"nofollow noreferrer\"><code>context</code></a> block - see my edit"}, {"owner": {"reputation": 273, "user_id": 5907524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5e14d614787e586c32615d9597507154?s=128&d=identicon&r=PG&f=1", "display_name": "super_noobling", "link": "https://stackoverflow.com/users/5907524/super-noobling"}, "edited": false, "score": 0, "creation_date": 1455694306, "post_id": 35449782, "comment_id": 58597820, "body": "Everything is good, however @piece in the before block is nil. It does not refer to anything. So my test doesn&#39;t work still."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1455708466, "post_id": 35449782, "comment_id": 58607255, "body": "Good Ill remove my answer then."}], "tags": [], "owner": {"reputation": 35107, "user_id": 1120015, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ID1fe.png?s=128&g=1", "display_name": "Uri Agassi", "link": "https://stackoverflow.com/users/1120015/uri-agassi"}, "is_accepted": true, "score": 0, "last_activity_date": 1455694394, "last_edit_date": 1455694394, "creation_date": 1455691845, "answer_id": 35449782, "question_id": 35449643, "link": "https://stackoverflow.com/questions/35449643/instance-variable-showing-up-as-nil-in-rspec/35449782#35449782", "title": "Instance variable showing up as `nil` in rspec", "body": "<p>Try using <a href=\"https://relishapp.com/rspec/rspec-core/v/2-5/docs/helper-methods/let-and-let\" rel=\"nofollow\"><code>let</code></a> instead:</p>\n\n<pre><code>require_relative '../spec_helper'\n\ndescribe Chess::King do\n  let(:piece) { Chess::King.new('king1',:black) }\n  let(:board) { Chess::Board.new }\n\n  describe '#possible_moves' do\n    context \"placing king at location 4,5\" do\n      before(:each) { board.grid[4][5] = piece }\n      subject {piece.possible_moves(board)}\n      it {is_expected.to eq([3,5],[3,6],[4,6],[5,6],[5,5])}\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5907524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5e14d614787e586c32615d9597507154?s=128&d=identicon&r=PG&f=1", "display_name": "super_noobling", "link": "https://stackoverflow.com/users/5907524/super-noobling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 35449782, "answer_count": 1, "score": 1, "last_activity_date": 1455694394, "creation_date": 1455691368, "last_edit_date": 1455692026, "question_id": 35449643, "link": "https://stackoverflow.com/questions/35449643/instance-variable-showing-up-as-nil-in-rspec", "title": "Instance variable showing up as `nil` in rspec", "body": "<p>I have the following test code: </p>\n\n<pre><code>require_relative '../spec_helper'\n\ndescribe Chess::King do\n  before do\n    @piece = Chess::King.new('king1',:black)\n    @board = Chess::Board.new\n  end\n\n  describe '#possible_moves' do\n    context \"placing king at location 4,5\" do\n      @board.grid[4][5] = @piece\n      subject {@piece.possible_moves(@board)}\n      it {is_expected.to eq([3,5],[3,6],[4,6],[5,6],[5,5])}\n    end\n  end\nend\n</code></pre>\n\n<p>Why am I getting this error:</p>\n\n<blockquote>\n  <p>in <code>block (3 levels) in &lt;top (required)&gt;': undefined method</code>grid' for nil:NilClass (NoMethodError)</p>\n</blockquote>\n\n<p>I am not sure about this line: <code>@board.grid[4][5] = @piece</code>.</p>\n\n<p>My intention here is to assign the piece object to the grid instance variable of board (8x8 array).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "refactoring", "code-analysis", "rubocop"], "answers": [{"comments": [{"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455693902, "post_id": 35450057, "comment_id": 58597611, "body": "When you are using nested attributes you have to account for find or create by <a href=\"http://stackoverflow.com/questions/3579924/accepts-nested-attributes-for-with-find-or-create\" title=\"accepts nested attributes for with find or create\">stackoverflow.com/questions/3579924/&hellip;</a> =&gt; Am I missing something here? This did fix rubocop though."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455694030, "post_id": 35450057, "comment_id": 58597677, "body": "@chrishough anyway, as to rubocop - use <code>self.attribute</code> only when you&#39;re assigning it, like <code>self.age = 25; save!</code>, any other time it will work without <code>self</code>"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455694645, "post_id": 35450057, "comment_id": 58597976, "body": "@chrishough also regarding the reference you&#39;ve provided - I did not have time to read it thoroughly, but I bet that deleting the <code>before_validation</code> and adding presence validation would work"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455738729, "post_id": 35450057, "comment_id": 58628415, "body": "Unfortunately after more testing today, this did not work. I had to switch the method to     def find_company     existing_company = Company.where(email: company.email) if company     self.company = existing_company.first if existing_company.count &gt; 0 end  The before_validation is needed because it passing attributes to the other model. If you take that off it will always attempt to create a duplicate record."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455739238, "post_id": 35450057, "comment_id": 58628754, "body": "you are screwing thing hard with this <code>before_validation</code>. I use nested_attributes on daily basis and never had I to set up before_validation, that you claim to be required. But hey, that&#39;s your code after all, not mine ;)"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455742211, "post_id": 35450057, "comment_id": 58630517, "body": "Question though, not trying to say this works the best, but are your nested attributes creating a new record each time or handling find or create?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455742529, "post_id": 35450057, "comment_id": 58630689, "body": "@chrishough it is unacceptable, so no way, no. I do not see the reasoning behind nested attributes creating a new record each time something happens. I think you have to just debug and see, what&#39;s going on and why, when not having this before validation you allow nested attrs to create new record. May be somewhere in controller, may be your form does that, may be you do not have proper nested model validations - lots of things to check :)"}, {"owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "edited": false, "score": 0, "creation_date": 1455744931, "post_id": 35450057, "comment_id": 58632030, "body": "maybe I am a bit confused here, but it did create in the past correctly, however, if I tried to create another job with the same company email address it through an error.  I only permit companies with unique email addresses.  If I removed that it would work, but than the db would have duplicates.  everything else checked out. am I crazy here?"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 0, "last_activity_date": 1455692876, "creation_date": 1455692876, "answer_id": 35450057, "question_id": 35448936, "link": "https://stackoverflow.com/questions/35448936/rubocop-style-model-self-needed-but-triggering-warning/35450057#35450057", "title": "rubocop style model self needed but triggering warning", "body": "<p>This would make Rubocop happy:</p>\n\n<pre><code>def find_company\n  self.company = Company.where(email: company.email).first_or_initialize if company\nend\n</code></pre>\n\n<p>P.S. I do not see the logic behind this method - you are checking, if company association is present, and if it is <strong>you are assigning association again with this same company</strong>.</p>\n\n<p>Method does not make sense - I think you'd be better of deleting it altogether.</p>\n\n<p>If you want to make sure, that company is always present, just check add presence validation:</p>\n\n<pre><code>validates :company, presence: true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "is_accepted": false, "score": 0, "last_activity_date": 1455837260, "creation_date": 1455837260, "answer_id": 35494369, "question_id": 35448936, "link": "https://stackoverflow.com/questions/35448936/rubocop-style-model-self-needed-but-triggering-warning/35494369#35494369", "title": "rubocop style model self needed but triggering warning", "body": "<p>In order to fix the issue with find or create by and pass through rubocop successfully this variation solved the problem </p>\n\n<pre><code>  private\n\n  def find_company\n    existing_company = Company.where(email: company.email) if company\n    self.company = existing_company.first if existing_company.count &gt; 0\n  end\n</code></pre>\n"}], "owner": {"reputation": 3498, "user_id": 161869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0dHDQ.png?s=128&g=1", "display_name": "Chris Hough", "link": "https://stackoverflow.com/users/161869/chris-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 35450057, "answer_count": 2, "score": 0, "last_activity_date": 1455837260, "creation_date": 1455688423, "last_edit_date": 1455699102, "question_id": 35448936, "link": "https://stackoverflow.com/questions/35448936/rubocop-style-model-self-needed-but-triggering-warning", "title": "rubocop style model self needed but triggering warning", "body": "<p>For some reason rubocop is choking on this code I have in my model to properly address <code>accepts_nested_attributes_for</code> to work like find or create.  When I tried to remove the <code>self</code> calls it blows up.  At this point I am deferring to experts before I shut that darn cop off. Thoughts?</p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n  belongs_to :company\n  before_validation :find_company\n\n  accepts_nested_attributes_for :company\n\n  private\n\n  def find_company\n    if self.company\n      self.company = Company.where(email: self.company.email).first_or_initialize\n    end\n  end\nend\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gk6gV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gk6gV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1636, "user_id": 1256849, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/dfa0i.jpg?s=128&g=1", "display_name": "Harry Bomrah", "link": "https://stackoverflow.com/users/1256849/harry-bomrah"}, "edited": false, "score": 0, "creation_date": 1455695221, "post_id": 35448072, "comment_id": 58598256, "body": "Try <code>config.action_mailer.default_url_options = { host: &quot;localhost:3000&quot;, protocol: &quot;http&quot;  }</code>"}, {"owner": {"reputation": 398, "user_id": 2634453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/NUcrx.jpg?s=128&g=1", "display_name": "Joe Marion", "link": "https://stackoverflow.com/users/2634453/joe-marion"}, "reply_to_user": {"reputation": 1636, "user_id": 1256849, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/dfa0i.jpg?s=128&g=1", "display_name": "Harry Bomrah", "link": "https://stackoverflow.com/users/1256849/harry-bomrah"}, "edited": false, "score": 0, "creation_date": 1455695732, "post_id": 35448072, "comment_id": 58598547, "body": "That didn&#39;t work either unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 2634453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/NUcrx.jpg?s=128&g=1", "display_name": "Joe Marion", "link": "https://stackoverflow.com/users/2634453/joe-marion"}, "edited": false, "score": 0, "creation_date": 1455693367, "post_id": 35449860, "comment_id": 58597356, "body": "Tried both and added responses. Still no luck connecting. And I was switching between localhost and the domain. I have changed these settings so many times based on other threads I don&#39;t even remember the original."}], "tags": [], "owner": {"reputation": 470, "user_id": 5847429, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aae8a096939117430c37280e7897f32c?s=128&d=identicon&r=PG", "display_name": "Elton Santos", "link": "https://stackoverflow.com/users/5847429/elton-santos"}, "is_accepted": false, "score": 0, "last_activity_date": 1455692074, "creation_date": 1455692074, "answer_id": 35449860, "question_id": 35448072, "link": "https://stackoverflow.com/questions/35448072/connection-refused-actionmailer-with-gmail/35449860#35449860", "title": "Connection Refused - ActionMailer with gmail", "body": "<p>In development.rb add this:</p>\n\n<pre><code>config.action_mailer.perform_deliveries = true\nconfig.action_mailer.raise_delivery_errors = true\nconfig.action_mailer.default :charset =&gt; \"utf-8\"\n</code></pre>\n\n<p>After, try change port 587 to 25, and run:</p>\n\n<pre><code>telnet smtp.gmail.com 587\n</code></pre>\n\n<p>And see the messages, if does not work, change for</p>\n\n<pre><code>telnet smtp.gmail.com 25\n</code></pre>\n\n<p>And a detail, in development:</p>\n\n<pre><code>config.action_mailer.smtp_settings = {\n   ...\n   domain: \"localhost\"\n}\n</code></pre>\n\n<p>On production is ok use domain: \"joemarion.io\", development I preffer use localhost.</p>\n"}, {"comments": [{"owner": {"reputation": 398, "user_id": 2634453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/NUcrx.jpg?s=128&g=1", "display_name": "Joe Marion", "link": "https://stackoverflow.com/users/2634453/joe-marion"}, "edited": false, "score": 0, "creation_date": 1455696134, "post_id": 35450600, "comment_id": 58598745, "body": "I was wondering if this could be the case, but unfortunately it wasn&#39;t"}], "tags": [], "owner": {"reputation": 861, "user_id": 3137099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d08e9c74139956d86a1a31d0209728b?s=128&d=identicon&r=PG&f=1", "display_name": "Kalyan Vedala", "link": "https://stackoverflow.com/users/3137099/kalyan-vedala"}, "is_accepted": false, "score": 0, "last_activity_date": 1455694958, "creation_date": 1455694958, "answer_id": 35450600, "question_id": 35448072, "link": "https://stackoverflow.com/questions/35448072/connection-refused-actionmailer-with-gmail/35450600#35450600", "title": "Connection Refused - ActionMailer with gmail", "body": "<p>You can try reducing the security level of your google account to see if the connection refusal is from google side. Following link should provide more information:</p>\n\n<p><a href=\"https://support.google.com/accounts/answer/6010255?hl=en\" rel=\"nofollow\">https://support.google.com/accounts/answer/6010255?hl=en</a></p>\n\n<p>I did not encounter this problem myself in rails, I encountered it while using javamail, but its worth a try.</p>\n"}], "owner": {"reputation": 398, "user_id": 2634453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/NUcrx.jpg?s=128&g=1", "display_name": "Joe Marion", "link": "https://stackoverflow.com/users/2634453/joe-marion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1455694958, "creation_date": 1455683974, "last_edit_date": 1455693338, "question_id": 35448072, "link": "https://stackoverflow.com/questions/35448072/connection-refused-actionmailer-with-gmail", "title": "Connection Refused - ActionMailer with gmail", "body": "<pre><code>Errno::ECONNREFUSED: Connection refused - connect(2) for \"localhost\" port 25\n</code></pre>\n\n<p>This is the error that I receive when I am trying to send an email using ActionMailer.</p>\n\n<p>Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\n\ngem 'rails', '4.2.5'\ngem 'pg', '~&gt; 0.15'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'high_voltage', '~&gt; 2.4.0'\ngem 'jquery-rails'\ngem 'turbolinks'\ngem 'jbuilder', '~&gt; 2.0'\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\ngem 'devise'\ngem 'figaro'\ngem 'faker'\ngem 'paperclip', '~&gt; 4.3'\ngem 'instagram'\ngem 'pundit'\ngem 'amazon-ses-mailer'\n\n\n\ngroup :test do\n  gem 'simplecov', :require =&gt; false, :group =&gt; :test\n  gem 'factory_girl_rails', :require =&gt; false, :group =&gt; :test\n  gem 'database_cleaner'\n  gem 'rspec-rails'\n  gem 'capybara'\n  gem 'selenium-webdriver'\n  gem 'chromedriver-helper'\nend\n\ngroup :development, :test do\n  gem 'byebug'\n  gem 'better_errors'\n  gem 'binding_of_caller'\nend\n\ngroup :development do\n  gem 'web-console', '~&gt; 2.0'\n\n  gem 'spring'\nend\n\ngroup :production do\n  gem 'puma'\nend\n</code></pre>\n\n<p>development.rb</p>\n\n<pre><code>  config.action_mailer.delivery_method = :smtp\n\n  config.action_mailer.smtp_settings = {\n    address: \"smtp.gmail.com\",\n    port: 587,\n    domain: \"joemarion.io\",\n    user_name: ENV['gmail_username'],\n    password: ENV['gmail_password'],\n    authentication: \"plain\",\n    enable_starttls_auto: true\n  }\n\n  config.action_mailer.default_url_options = { host: \"localhost:3000\" }\n\nend\n</code></pre>\n\n<p>application_mailer.rb</p>\n\n<pre><code>class ApplicationMailer &lt; ActionMailer::Base\n  default from: \"support@example.com\"\n  layout 'mailer'\nend\n</code></pre>\n\n<p>contact_mailer.rb</p>\n\n<pre><code>class ContactMailer &lt; ApplicationMailer\n\n  def contact_us(pending_message)\n    @message = pending_message\n\n    mail to: \"joemarion.io@gmail.com\",\n        subject: \"New message from JoeMarion.io!\"\n  end\nend\n</code></pre>\n\n<p>I have followed a couple tutorials now and I keep running into this problem. I have seen a couple others on SO have this error, but they were due to incorrect settings (most of which they were setting their smtp's up in an initializer, but when they moved it back into development it worked). </p>\n\n<p>I am able to establish a connection to Gmail's server via the command line. </p>\n\n<p>At this point I am starting to get boggled as to what I need to change to fix this. Any advice would be appreciated.</p>\n\n<p>EDIT:\nafter running:</p>\n\n<p>telnet smtp.gmail.com 587</p>\n\n<pre><code>Trying 64.233.180.109...\nConnected to gmail-smtp-msa.l.google.com.\nEscape character is '^]'.\n220 smtp.gmail.com ESMTP u68sm13502513oia.22 - gsmtp\n</code></pre>\n\n<p>telnet smtp.gmail.com 587</p>\n\n<pre><code>Trying 64.233.180.109\n</code></pre>\n\n<p>before timing out.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 3665, "user_id": 4330954, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/340ffba5552ac48227741a8695a255ff?s=128&d=identicon&r=PG", "display_name": "x6iae", "link": "https://stackoverflow.com/users/4330954/x6iae"}, "edited": false, "score": 0, "creation_date": 1455683501, "post_id": 35447942, "comment_id": 58593433, "body": "Smooth man, very smooth. when I tried with: <code>expect { Profile.send(name.pluralize) }.to raise_error</code>, it passed but I got  a warning to provide the type of error. <code>expect { Profile.send(name.pluralize) }.to raise_error(WhateverError)</code> raised no warning however. Thank you."}], "tags": [], "owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "is_accepted": true, "score": 2, "last_activity_date": 1455692108, "last_edit_date": 1455692108, "creation_date": 1455683139, "answer_id": 35447942, "question_id": 35447854, "link": "https://stackoverflow.com/questions/35447854/how-to-test-that-a-variable-is-undefined-or-that-an-exception-is-raised-in-rspec/35447942#35447942", "title": "how to test that a variable is undefined or that an exception is raised in RSpec", "body": "<p>if I had to guess: </p>\n\n<pre><code>expect(Profile.send(name.pluralize)).to raise_error\n</code></pre>\n\n<p>to: </p>\n\n<pre><code>expect { Profile.send(name.pluralize) }.to raise_error\n</code></pre>\n"}], "owner": {"reputation": 3665, "user_id": 4330954, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/340ffba5552ac48227741a8695a255ff?s=128&d=identicon&r=PG", "display_name": "x6iae", "link": "https://stackoverflow.com/users/4330954/x6iae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 1, "accepted_answer_id": 35447942, "answer_count": 1, "score": 0, "last_activity_date": 1455692108, "creation_date": 1455682645, "question_id": 35447854, "link": "https://stackoverflow.com/questions/35447854/how-to-test-that-a-variable-is-undefined-or-that-an-exception-is-raised-in-rspec", "title": "how to test that a variable is undefined or that an exception is raised in RSpec", "body": "<p>In my model, I am dynamically setting scopes</p>\n\n<pre><code>  AccountType.all_valid_types.each do |type| # AccountType.all_valid_types returns an array from database\n    scope type.downcase.pluralize.split(' ').join('_').to_sym, -&gt; { where(account_type: type) }\n  end\n</code></pre>\n\n<p>In my spec test, I am trying to test that the model scope exists for <code>all_valid_types</code> and that when a type is created, updated or deleted, the scope should adjust accordingly...</p>\n\n<p><strong>Implementation:</strong></p>\n\n<pre><code>#account_type.rb:\nafter_save :reset_profile_scopes\nafter_destroy :reset_profile_scopes\n\ndef reset_profile_scopes\n  #unset file\n  Object.send(:remove_const, \"Profile\")\n\n  #reload file\n  load \"profile.rb\"\nend\n</code></pre>\n\n<p><strong>RSpec Test:</strong></p>\n\n<pre><code>describe \"Dynamism\" do\n  it \"should ensure that the profile.rb file (Profile class) gets reloaded after each create, update, and destroy\" do\n    Profile.connection #hack to simulate profile load already\n    account_type = FactoryGirl.create(:account_type)\n    expect(Profile.send(account_type.name.pluralize)).to be_an(ActiveRecord::Relation)\n    name = Faker::Lorem.word\n    account_type.update_attribute(:name, name)\n    expect(Profile.send(name.pluralize)).to be_an(ActiveRecord::Relation)\n    account_type.destroy\n    expect(Profile.send(name.pluralize)).to raise_error\n  end\nend\n</code></pre>\n\n<p>All is working up to the line <code>expect(Profile.send(name.pluralize)).to raise_error</code>.</p>\n\n<p>I know I expect it to throw an error, but how do I write the spec so that it passes with the error without throwing an error? ( Hope this is not confusing )</p>\n\n<p>In other words, what RSpec syntax can I use to <code>expect an error/exception</code>?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "blueprint", "gooddata"], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 5940473, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jKLfE2c-a9M/AAAAAAAAAAI/AAAAAAAAABc/WsQ7DGfZUd8/photo.jpg?sz=128", "display_name": "Martin Burian", "link": "https://stackoverflow.com/users/5940473/martin-burian"}, "is_accepted": true, "score": 0, "last_activity_date": 1455716856, "creation_date": 1455716856, "answer_id": 35458485, "question_id": 35447652, "link": "https://stackoverflow.com/questions/35447652/is-it-possible-change-attribute-folder-in-gooddata-project-by-ruby/35458485#35458485", "title": "Is it possible change attribute folder in GoodData project by Ruby?", "body": "<p>The GoodData Automation SDK does not support changing of folder of attribute or fact.</p>\n\n<p>What you can do is to change it via CloudConnect, MAQL or you can develop your own method in Ruby or of course change it via UI.</p>\n\n<p>CloudConnect lets you change it and also shows you MAQL code which will be used for the change. You can learn from it how to create MAQL code for such changes and then you can execute MAQL code via GoodData API. How to execute MAQL code via API is described here: <a href=\"https://developer.gooddata.com/api#/reference/project-model/execute-a-maql-ddl-script/execute-a-maql-ddl-script\" rel=\"nofollow\">https://developer.gooddata.com/api#/reference/project-model/execute-a-maql-ddl-script/execute-a-maql-ddl-script</a></p>\n\n<p>There is also possibility to change it via UI, catch the change via browser developer tools (it is HTTP POST to attribute/fact object) and reproduce the POST via Ruby.</p>\n"}], "owner": {"reputation": 15, "user_id": 5938303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608a43f2b87c717f46b0501f127cbbdf?s=128&d=identicon&r=PG", "display_name": "Michal", "link": "https://stackoverflow.com/users/5938303/michal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 35458485, "answer_count": 1, "score": 1, "last_activity_date": 1455716856, "creation_date": 1455681548, "last_edit_date": 1455693599, "question_id": 35447652, "link": "https://stackoverflow.com/questions/35447652/is-it-possible-change-attribute-folder-in-gooddata-project-by-ruby", "title": "Is it possible change attribute folder in GoodData project by Ruby?", "body": "<p>In GoodData project is possible to move your attributes and facts to some specific folder. I'm trying to do something like that by Ruby script. \nI have project blueprint and a list of attribute ids and information about their folders, but I'm still not sure how to change a folder. Because this code doesn't work:</p>\n\n<pre><code>    blueprint = project.blueprint\n    blueprint.datasets.map do |dataset|\n    dataset.attributes.map do |attr|\n        attr.folder = dataset.title\n    end\n   end\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>NoMethodError: undefined method `folder='\n</code></pre>\n\n<p>In GoodData Ruby Cookbook is example how to find list of folders, but no more information.</p>\n\n<pre><code> # Currently there is not support in SDK to directly explore folders but we can reach to API directly\n  # You can also go to the project in your browser and look for folders there\n  client.get(\"#{project.md['query']}/dimensions\")['query']['entries'].map {|i| i['title']} # =&gt; [\"Dataset.Opportunities\", \"Awesome Sales Reps\", \"Dataset.Regions\"]\n\n  client.get(\"#{project.md['query']}/folders\")['query']['entries'].map {|i| i['title']} # =&gt; [\"My Special Folder\"]\n</code></pre>\n\n<p>Has somebody already tried to change folder of attributes or facts in your GoodData project? </p>\n\n<p>here is SDK: <a href=\"http://www.rubydoc.info/gems/gooddata/GoodData/Model/BlueprintField\" rel=\"nofollow\">http://www.rubydoc.info/gems/gooddata/GoodData/Model/BlueprintField</a>\nand here are some examples how to work with a blueprint, but mostly it's just about creating new attributes: <a href=\"http://sdk.gooddata.com/gooddata-ruby-examples/#_12_working_with_blueprints\" rel=\"nofollow\">http://sdk.gooddata.com/gooddata-ruby-examples/#_12_working_with_blueprints</a></p>\n\n<p>Thank you for any idea.\nMichal</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "download", "link-to"], "comments": [{"owner": {"reputation": 979, "user_id": 326917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b80523b06c052a6109e6de5a72661c85?s=128&d=identicon&r=PG", "display_name": "ajporterfield", "link": "https://stackoverflow.com/users/326917/ajporterfield"}, "edited": false, "score": 0, "creation_date": 1455681547, "post_id": 35447617, "comment_id": 58592881, "body": "Do you have a download_pdf entry in your routes.rb file?  If so, then you need to put the action in front of the controller name in your _url method.  So, it should be download_pdf_home_url.  Give that a try and see if you get into your controller action."}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "edited": false, "score": 0, "creation_date": 1455705738, "post_id": 35447617, "comment_id": 58605295, "body": "<code>&lt;%= link_to &#39;Download Brochure&#39;, home_download_pdf_url %&gt;</code> Make sure you&#39;re closing the tag properly"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5483394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i2Gsp.png?s=128&g=1", "display_name": "Ansari", "link": "https://stackoverflow.com/users/5483394/ansari"}, "is_accepted": false, "score": 0, "last_activity_date": 1455682692, "creation_date": 1455682692, "answer_id": 35447863, "question_id": 35447617, "link": "https://stackoverflow.com/questions/35447617/undefined-local-variable-or-method-download-a-file-ruby-on-rails/35447863#35447863", "title": "Undefined local variable or method - download a file - Ruby on Rails", "body": "<p>Your using action as </p>\n\n<blockquote>\n  <p>download_pdf </p>\n</blockquote>\n\n<p>so link to can be changed to</p>\n\n<pre><code>link_to \"Download Brochure\", controller: \"home\", action: \"download_pdf\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26534, "user_id": 184212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b31e7abd14f1ceb4c4957da08933c630?s=128&d=identicon&r=PG", "display_name": "Joshua Cheek", "link": "https://stackoverflow.com/users/184212/joshua-cheek"}, "is_accepted": false, "score": 0, "last_activity_date": 1455688430, "creation_date": 1455688430, "answer_id": 35448937, "question_id": 35447617, "link": "https://stackoverflow.com/questions/35447617/undefined-local-variable-or-method-download-a-file-ruby-on-rails/35448937#35448937", "title": "Undefined local variable or method - download a file - Ruby on Rails", "body": "<p>If you're using an older Rails, make sure you restart the server after changing the routes. You might also try alternative route syntax <code>get 'home/download_pdf' =&gt; 'home#download_pdf'</code>, run <code>rake routes</code> to make sure, you should see a line like <code>home_download_pdf GET  /home/download_pdf(.:format) home#download_pdf</code>. You can probably also link directly to the file since it's in the public dir <code>link_to 'Download Brochure', 'Brochure.pdf'</code>, and it's suspicious that your inspection of the view is <code>#&lt;#:0x007fd9f1a2eea0&gt;</code>, been a while since I looked at rails, but I'd expect it to have a class name there. Usually view files are <code>view.html.erb</code>, not <code>view.html</code>, and that file name name is a bit suspicious, what's the full path to the file from the rails root? I'm expecting something like <code>app/views/home/index.html.erb</code> usually the filename will be in a dir named after the controller (hence home), and the file will be named after the action (controller method that rendered it). There are deviations from these conventions, but I can't tell if yours is one of them.</p>\n"}, {"comments": [{"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 21, "user_id": 5938271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297cf056a58f235962f446d565400d3e?s=128&d=identicon&r=PG&f=1", "display_name": "DRails", "link": "https://stackoverflow.com/users/5938271/drails"}, "edited": false, "score": 0, "creation_date": 1455713632, "post_id": 35454533, "comment_id": 58610873, "body": "For the sake of posterity, you&#39;ll want to accept the answer if it worked"}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 0, "last_activity_date": 1455706207, "creation_date": 1455706207, "answer_id": 35454533, "question_id": 35447617, "link": "https://stackoverflow.com/questions/35447617/undefined-local-variable-or-method-download-a-file-ruby-on-rails/35454533#35454533", "title": "Undefined local variable or method - download a file - Ruby on Rails", "body": "<p>The error is simple, it means you don't have a route defined with the \"name\" that you're referencing:</p>\n\n<pre><code>#config/routes.rb\nget \"home/download_pdf\", to: \"home#download_pdf\", as: :home_download_pdf\n\n#app/controllers/home_controller.rb\nclass HomeController &lt; ApplicationController\n  def download_pdf\n    # ...\n  end\nend\n\n#app/views/home/download_pdf.html.erb\n&lt;%= 'Download Brochure', home_download_pdf_path %&gt;\n</code></pre>\n\n<hr>\n\n<p>As a tip, we always put \"misc\" actions in our <code>ApplicationController</code>:</p>\n\n<pre><code>#config/routes.rb\nget \"download_pdf\", to: \"application#download_pdf\", as: :home_download_pdf\n\n#app/controllers/application_controller.rb\nclass ApplicationController &lt; ActionController::Base\n  def download_pdf\n    # ...\n  end\nend\n</code></pre>\n\n<p>--</p>\n\n<p>If you <em>have</em> to use a <code>home</code> controller etc, you'll mostly want to embed any extra routes into a <a href=\"http://guides.rubyonrails.org/routing.html#resources-on-the-web\" rel=\"nofollow\"><code>resources</code></a> directive:</p>\n\n<pre><code>#config/routes.rb\nresources :home, only: [] do\n  get :home_download_pdf, on: :collection #-&gt; url.com/home/home_download_pdf\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5938271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297cf056a58f235962f446d565400d3e?s=128&d=identicon&r=PG&f=1", "display_name": "DRails", "link": "https://stackoverflow.com/users/5938271/drails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1455706207, "creation_date": 1455681290, "last_edit_date": 1455705643, "question_id": 35447617, "link": "https://stackoverflow.com/questions/35447617/undefined-local-variable-or-method-download-a-file-ruby-on-rails", "title": "Undefined local variable or method - download a file - Ruby on Rails", "body": "<p>I am trying to embed a downloadable file in rails. But getting the below error:</p>\n\n<blockquote>\n  <p>ActionView::Template::Error (undefined local variable or method `home_download_pdf_url' for #&lt;#:0x007fd9f1a2eea0>):</p>\n</blockquote>\n\n<p>home_controller.rb</p>\n\n<pre><code>def download_pdf\n  send_file(\n    \"#{Rails.root}/public/Brochure.pdf\",\n     filename: \"Brochure.pdf\",\n     type: \"application/pdf\"\n  )\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code> get 'home/download_pdf'\n</code></pre>\n\n<p>view.html</p>\n\n<pre><code>&lt;%= link_to 'Download Brochure', home_download_pdf_url&gt;\n</code></pre>\n\n<p>I am new to Ruby. Please help. </p>\n"}, {"tags": ["ruby", "twilio"], "answers": [{"comments": [{"owner": {"reputation": 979, "user_id": 326917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b80523b06c052a6109e6de5a72661c85?s=128&d=identicon&r=PG", "display_name": "ajporterfield", "link": "https://stackoverflow.com/users/326917/ajporterfield"}, "edited": false, "score": 1, "creation_date": 1455681762, "post_id": 35447381, "comment_id": 58592952, "body": "I don&#39;t think your props hash will be available since it&#39;s outside the sample method.  Either move it inside or convert it to a method that returns the hash."}, {"owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "reply_to_user": {"reputation": 979, "user_id": 326917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b80523b06c052a6109e6de5a72661c85?s=128&d=identicon&r=PG", "display_name": "ajporterfield", "link": "https://stackoverflow.com/users/326917/ajporterfield"}, "edited": false, "score": 1, "creation_date": 1455681981, "post_id": 35447381, "comment_id": 58593008, "body": "Oh, my bad. Fixed it now."}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": true, "score": 5, "last_activity_date": 1455681953, "last_edit_date": 1455681953, "creation_date": 1455679983, "answer_id": 35447381, "question_id": 35447284, "link": "https://stackoverflow.com/questions/35447284/how-to-reuse-options-hash/35447381#35447381", "title": "How to reuse options hash", "body": "<p>Take them in a hash and use it:</p>\n\n<pre><code>def sample\n    props = {voice: 'alice', language: 'en-GB'}\n\n    render text: (Twilio::TwiML::Response.new do |r|\n        r.Say 'Welcome to ABC Residence', props\n        r.Say 'Thank you for visiting ABC Residence.', props\n        r.Hangup\n    end).text\nend\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 5527610, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bdba139fe3768174ee6246f91a231c60?s=128&d=identicon&r=PG&f=1", "display_name": "RPV", "link": "https://stackoverflow.com/users/5527610/rpv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 35447381, "answer_count": 1, "score": 1, "last_activity_date": 1455687982, "creation_date": 1455679358, "last_edit_date": 1455687982, "question_id": 35447284, "link": "https://stackoverflow.com/questions/35447284/how-to-reuse-options-hash", "title": "How to reuse options hash", "body": "<p>I am using Twilio Say verbs repeatedly and want to refactor my code. Currently it looks somewhat like this </p>\n\n<pre><code>def sample\n    render text: (Twilio::TwiML::Response.new do |r|\n        r.Say 'Welcome to ABC Residence', voice: 'alice', language: 'en-GB'\n        r.Say 'Thank you for visiting ABC Residence.', voice:'alice', language: 'en-GB'\n        r.Hangup\n    end).text\nend\n</code></pre>\n\n<p>Notice tht I'm using <code>voice: 'alice'</code> and <code>language: 'en-GB'</code> twice. How can I put these into a variable to be used over and over again?</p>\n"}, {"tags": ["ruby", "ruby-2.0", "ruby-2.1"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1455679476, "post_id": 35447230, "comment_id": 58592287, "body": "I&#39;m testing out Ruby 2.2.3 on Linux and I get the same behavior as your Ruby 2.1.  I also see that <code>Timeout::Error.new.is_a?(Exception)</code> equals true."}], "answers": [{"comments": [{"owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1455684226, "post_id": 35447373, "comment_id": 58593665, "body": "How odd. This change wasn&#39;t commented upon much. I am not sure it actually helps much. I am curious to see if latest JRuby 9k has 2.1.0 behavior..."}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 4, "last_activity_date": 1455679952, "creation_date": 1455679952, "answer_id": 35447373, "question_id": 35447230, "link": "https://stackoverflow.com/questions/35447230/ruby-timeout-behaves-differently-between-2-0-and-2-1/35447373#35447373", "title": "Ruby Timeout behaves differently between 2.0 and 2.1", "body": "<p>This is documented behavior.  We can compare the documentation of Ruby's Timeout module for <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/timeout/rdoc/Timeout.html\" rel=\"nofollow\">2.0.0</a> and for <a href=\"http://ruby-doc.org/stdlib-2.1.0/libdoc/timeout/rdoc/Timeout.html\" rel=\"nofollow\">2.1.0</a>.  The documentation for 2.1.0 says:</p>\n\n<blockquote>\n  <p>The exception thrown to terminate the given block cannot be rescued inside the block unless klass is given explicitly.</p>\n</blockquote>\n\n<p>If you want to have the old behavior in your application, you can call <code>Timeout::timeout(1, Timeout::Error)</code>.  This would allow you to catch the exception inside the timed block.</p>\n"}], "owner": {"reputation": 6068, "user_id": 552942, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5ba8ff30081252d637691bfd050f70df?s=128&d=identicon&r=PG", "display_name": "WKPlus", "link": "https://stackoverflow.com/users/552942/wkplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 35447373, "answer_count": 1, "score": 0, "last_activity_date": 1455691908, "creation_date": 1455679010, "last_edit_date": 1455691908, "question_id": 35447230, "link": "https://stackoverflow.com/questions/35447230/ruby-timeout-behaves-differently-between-2-0-and-2-1", "title": "Ruby Timeout behaves differently between 2.0 and 2.1", "body": "<p>The following code behaves differently between ruby 2.0 and 2.1:</p>\n\n<pre><code>require 'timeout'\n\ndef scp\n  begin\n    puts \"In begin\"\n    sleep 10\n  rescue Exception =&gt; e\n    puts \"Exception found: #{e}\"\n  else\n    puts \"No exception found\"\n  ensure\n    puts \"In ensure\"\n  end\nend\n\nTimeout::timeout(1) do\n  scp\nend\n</code></pre>\n\n<p>In ruby 2.0, it gives:</p>\n\n<pre><code>In begin\nException found: execution expired\nIn ensure\n</code></pre>\n\n<p>In ruby 2.1, it gives:</p>\n\n<pre><code>In begin\nIn ensure\nt2.rb:7:in `sleep': execution expired (Timeout::Error)\n    from t2.rb:7:in `scp'\n    from t2.rb:18:in `block in &lt;main&gt;'\n    from /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/timeout.rb:91:in `block in timeout'\n    from /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/timeout.rb:35:in `block in catch'\n    from /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/timeout.rb:35:in `catch'\n    from /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/timeout.rb:35:in `catch'\n    from /usr/local/rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/timeout.rb:106:in `timeout'\n    from t2.rb:17:in `&lt;main&gt;'\n</code></pre>\n\n<p>Why are they different?</p>\n"}, {"tags": ["ruby", "hash", "flatten", "keyvaluepair"], "comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1455678295, "post_id": 35446936, "comment_id": 58591943, "body": "Hi @sawa, I am hoping to convert the @data[&#39;snapshot&#39;] array of hashes into a different hash.  See my question for both the current format and the desired format.  I&#39;ll edit the question a bit now."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1455682049, "post_id": 35446936, "comment_id": 58593029, "body": "After posting an answer I see that you have changed the question. My answer now makes no sense. That&#39;s the reason for the rule that questions are not to be changed. I suggest you roll back to your original question."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455694842, "post_id": 35446936, "comment_id": 58598070, "body": "Hi Cary, apologies for the change but I made those changes just a few minutes after sawa told me I should consider rephrasing it.  Since I didn&#39;t change the gist of the question but just some of the hash key names, is the result still the same?  I will note that questions shouldn&#39;t be modified in the future--apologies, I&#39;m brand new with Stack Overflow.  To be clear, because I only changed the hash key name (from &quot;key[0]&quot;, &quot;key[1]&quot;, &quot;key[2]&quot; to &quot;CameFromSource0&quot;, &quot;CameFromSource1&quot;,&quot;CameFromSource2&quot;), does your answer still address my question?  Please let me know and thank you very much!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1455696353, "post_id": 35446936, "comment_id": 58598838, "body": "Yes, that&#39;s fine, as readers will understand what happened after reading your comment."}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455695698, "post_id": 35447735, "comment_id": 58598517, "body": "Thank you so much for taking the time to work through this with me.  I really want to learn how to do this without always having to ask or consult by The Ruby Way book ;-) -- apologies that I modified my question mid-stream but this information is very helpful.  I will try it tomorrow!"}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455751784, "post_id": 35447735, "comment_id": 58635245, "body": "Thank you very much Cary for taking the time here.  I went with Jordan&#39;s answer because it is very concise and seems to get things done the most efficiently (although I haven&#39;t benchmarked it).  This is still a very good answer and I think it will help others who are looking to have a bit more control over the resulting data.  Appreciate your time--wish I could pick both as correct answers."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1455742085, "last_edit_date": 1455742085, "creation_date": 1455681916, "answer_id": 35447735, "question_id": 35446936, "link": "https://stackoverflow.com/questions/35446936/ruby-combining-flattening-multiple-array-of-hashes-on-common-hash-key-value-co/35447735#35447735", "title": "Ruby - combining/flattening multiple array of hashes on common hash key/value combination", "body": "<p>This is one way to do it.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def convert(data)\n  data.each_with_object({}) { |a,h|\n    a.each { |g| h.update(g[\"date\"]=&gt;[g[\"total\"][/\\d+/]]) { |_,o,n| o+n } } }.\n      map { |date, arr| arr.each_with_index.with_object({\"date\"=&gt;date}) { |(e,i),h| \n        h[\"key#{i}\"] = e } }\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>convert(data)\n  #=&gt; [{\"date\"=&gt;\"1455672010\", \"key0\"=&gt;\"817\", \"key1\"=&gt;\"70\", \"key2\"=&gt;\"70\"},\n  #    {\"date\"=&gt;\"1455595298\", \"key0\"=&gt;\"40\", \"key1\"=&gt;\"54\", \"key2\"=&gt;\"43212\"},\n  #    {\"date\"=&gt;\"1455336016\", \"key0\"=&gt;\"555\", \"key1\"=&gt;\"25\", \"key2\"=&gt;\"55525\"}] \n</code></pre>\n\n<p><strong>Two steps</strong></p>\n\n<p>You can see that I've done this in two steps. First construct a hash:</p>\n\n<pre><code>f = data.each_with_object({}) { |a,h| a.each { |g|\n  h.update(g[\"date\"]=&gt;[g[\"total\"][/\\d+/]]) { |_,o,n| o+n } } }\n    #=&gt; {\"1455672010\"=&gt;[\"817\", \"70\", \"70\"],\n    #    \"1455595298\"=&gt;[\"40\", \"54\", \"43212\"],\n    #    \"1455336016\"=&gt;[\"555\", \"25\", \"55525\"]} \n</code></pre>\n\n<p>Here I have used the form of <a href=\"http://ruby-doc.org/core-2.2.0/Hash.html\" rel=\"nofollow\">Hash#update</a> (aka <code>merge!</code>) that employs a block (<code>{ |_,o,n| o+n }</code>) to determine the values of keys that are present in both hashes being merged.</p>\n\n<p>Then convert the hash to the desired format:</p>\n\n<pre><code>f.map { |date, arr| arr.each_with_index.with_object({\"date\"=&gt;date}) { |(e,i),h| \n  h[\"key#{i}\"] = e } }\n  #=&gt; [{\"date\"=&gt;\"1455672010\", \"key0\"=&gt;\"817\", \"key1\"=&gt;\"70\", \"key2\"=&gt;\"70\"},\n  #    {\"date\"=&gt;\"1455595298\", \"key0\"=&gt;\"40\", \"key1\"=&gt;\"54\", \"key2\"=&gt;\"43212\"},\n  #    {\"date\"=&gt;\"1455336016\", \"key0\"=&gt;\"555\", \"key1\"=&gt;\"25\", \"key2\"=&gt;\"55525\"}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455695847, "post_id": 35448819, "comment_id": 58598607, "body": "Hi again Jordan!  Thank you for your continued help on my Ruby-related initiatives.  This is very concise and I really appreciate your breaking out each step to explain how it relates to the whole picture.  I think I understand what this is doing and appreciate the cleanliness &amp; brevity of it.  I will try your suggestion tomorrow and let you know the result.  Again, really appreciate this!  group_by(&amp;:shift) is really neat."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455733008, "post_id": 35448819, "comment_id": 58624868, "body": "Hi Jordan, I tried out the code you provided and although it didn&#39;t throw any errors, I got back an empty hash with &quot;date&quot;, &quot;data0&quot;, &quot;data1&quot;, and &quot;data2&quot; blank.  I then tried to look at each step to make sure data was being populated but even trying to puts result1 is empty.  Here is the exact representation of my data -- I hope I explained it properly in my question.   <a href=\"http://pasted.co/b2c20b23\" rel=\"nofollow noreferrer\">pasted.co/b2c20b23</a>   -- thank you in advance for your help!!"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455739628, "post_id": 35448819, "comment_id": 58629013, "body": "@KurtW Thanks for the clarification. I&#39;ve edited my answer, which now uses a significantly different approach, but one which I think is much simpler. Re: your Chef question I&#39;m not sure what you mean. Chef cookbooks and recipes are all written in Ruby, and much of our software is Ruby as well. I&#39;m glad to hear you&#39;re a customer!"}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455750566, "post_id": 35448819, "comment_id": 58634750, "body": "We are just beginning to get our hands on it--glad to hear it&#39;s <i>mostly</i> Ruby -- the better I get at all of this, the more equipped I&#39;ll be when we bring it in.  Thanks again for your help and going back to write out such a detailed response.  Much appreciated!"}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455751519, "post_id": 35448819, "comment_id": 58635141, "body": "Hey, since I have you here, do you know of a way to round UNIX timestamps in Ruby to the nearest month (or week)?  The results that came back from your code is fantastic, but a bit too granular and I can&#39;t control what comes out of my tool at that level.  Wondering if there is a way to convert 1454817699 (02/07/2016) down to 02/01/2016 (always the first of the month).  If so, I will loop through all of the dates before running your code so the list is much smaller.  I won&#39;t change the question and no need to change the answer, just curious if you knew a way :-).  Thanks either way !!"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455770782, "post_id": 35448819, "comment_id": 58640975, "body": "That&#39;s beyond the scope of a comment. I suggest posting a new question, or checking out Ruby&#39;s Time and DateTime classes."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1455783101, "post_id": 35448819, "comment_id": 58646284, "body": "I&#39;ll try to figure this one out without help. At some point,  I gotta sink or swim and that seems like one I might be able to figure out on my own.  I&#39;ll give it a shot tomorrow.  Thanks!"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1455739422, "last_edit_date": 1455739422, "creation_date": 1455687882, "answer_id": 35448819, "question_id": 35446936, "link": "https://stackoverflow.com/questions/35446936/ruby-combining-flattening-multiple-array-of-hashes-on-common-hash-key-value-co/35448819#35448819", "title": "Ruby - combining/flattening multiple array of hashes on common hash key/value combination", "body": "<h3>TL;DR</h3>\n\n<pre><code>snapshots.each_with_object(Hash.new {|hsh, date| hsh[date] = { \"date\" =&gt; date } })\n  .with_index do |(snapshot, hsh), i|\n    snapshot[\"data\"].each {|datum| hsh[datum[\"date\"]][\"data#{i}\"] = datum[\"total\"] }\n  end.values\n</code></pre>\n\n<h3>How it works</h3>\n\n<p>I'll break it down so you see how each part works. Here's our data (extraneous keys elided for clarity):</p>\n\n<pre><code>snapshots = [\n  { \"dataSourceID\" =&gt; \"152970\",\n    \"data\" =&gt; [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"817\" }, \n                { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"40\" },\n                { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"555\" } ]\n  }\n  { \"dataSourceID\" =&gt; \"33151\",\n    \"data\" =&gt; [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"70\" }, \n                { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"54\" },\n                { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"25\" } ]\n  },\n  { \"dataSourceID\" =&gt; \"52165\",\n    \"data\" =&gt; [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"70\" }, \n                { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"43212\" },\n                { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"55525\" } ]\n  }\n]\n</code></pre>\n\n<p>Most of the magic is here:</p>\n\n<pre><code>result_hash = Hash.new {|hsh, date| hsh[date] = { \"date\" =&gt; date } }\n</code></pre>\n\n<p>Here we're using the Hash's <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-default_proc\" rel=\"nofollow\">default proc</a> to automatically initialize new keys in the following way:</p>\n\n<pre><code>result_hash = Hash.new {|hsh, date| hsh[date] = { \"date\" =&gt; date } }\np result_hash[\"1455672010\"]\n# =&gt; { \"date\" =&gt; \"1455672010\" }\n\np result_hash\n# =&gt; { \"1455672010\" =&gt; { \"date\" =&gt; \"1455672010\" } }\n</code></pre>\n\n<p>Simply accessing <code>result_hash[foo]</code> creates the hash <code>{ \"date\" =&gt; foo }</code> and assigns it to <code>result_hash[foo]</code>. This enables the following:</p>\n\n<pre><code>result_hash[\"1455672010\"][\"data0\"] = \"817\"\np result_hash\n# =&gt; { \"1455672010\" =&gt; { \"date\" =&gt; \"1455672010\", \"data0\" =&gt; \"817\" } }\n</code></pre>\n\n<p>Magic!</p>\n\n<p>Now suppose we have the following data:</p>\n\n<pre><code>data = [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"817\" }, \n         { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"40\" },\n         { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"555\" } ]\n</code></pre>\n\n<p>Using our magic <code>result_hash</code>, we can do this:</p>\n\n<pre><code>data.each do |datum|\n  result_hash[datum[\"date\"]][\"data0\"] = datum[\"total\"]\nend\np result_hash\n# =&gt; { \"1455672010\" =&gt; { \"date\" =&gt; \"1455672010\", \"data0\" =&gt; \"817\" },\n#      \"1455595298\" =&gt; { \"date\" =&gt; \"1455595298\", \"data0\" =&gt; \"40\" },\n#      \"1455336016\" =&gt; { \"date\" =&gt; \"1455336016\", \"data0\" =&gt; \"555\" } }\n</code></pre>\n\n<p>See where I'm going with this? Here's all of our data, finally:</p>\n\n<pre><code>snapshots = [\n  { \"dataSourceID\" =&gt; \"152970\",\n    \"data\" =&gt; [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"817\" }, \n                { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"40\" },\n                { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"555\" } ]\n  }\n  { \"dataSourceID\" =&gt; \"33151\",\n    \"data\" =&gt; [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"70\" }, \n                { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"54\" },\n                { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"25\" } ]\n  },\n  { \"dataSourceID\" =&gt; \"52165\",\n    \"data\" =&gt; [ { \"date\" =&gt; \"1455672010\", \"total\" =&gt; \"70\" }, \n                { \"date\" =&gt; \"1455595298\", \"total\" =&gt; \"43212\" },\n                { \"date\" =&gt; \"1455336016\", \"total\" =&gt; \"55525\" } ]\n  }\n]\n</code></pre>\n\n<p>Instead of hard-coding <code>\"data0\"</code>, we can iterate over the <code>snapshots</code> hashes using <code>each_with_index</code> and build that key (<code>\"data0\"</code>, then <code>\"data1\"</code>, and so on) for each iteration. Inside that loop we can do exactly what we did above but with the <code>\"data\"</code> array from each <code>snapshots</code> hash:</p>\n\n<pre><code>result_hash = Hash.new {|hsh, date| hsh[date] = { \"date\" =&gt; date } }\n\nsnapshots.each_with_index do |snapshot, i|\n  data_key = \"data#{i}\"\n\n  snapshot[\"data\"].each do |datum|\n    date = datum[\"date\"]\n    result_hash[date][data_key] = datum[\"total\"]\n  end\nend\n\np result_hash.values\n# =&gt; [ { \"date\" =&gt; \"1455672010\", \"data0\" =&gt; \"817\", \"data1\" =&gt; \"70\", \"data2\" =&gt; \"70\" },\n#      { \"date\" =&gt; \"1455595298\", \"data0\" =&gt; \"40\",  \"data1\" =&gt; \"54\", \"data2\" =&gt; \"43212\" },\n#      { \"date\" =&gt; \"1455336016\", \"data0\" =&gt; \"555\", \"data1\" =&gt; \"25\", \"data2\" =&gt; \"55525\" } ]\n</code></pre>\n\n<p>Of course, this can be condensed some, which I've done in <strong>TL;DR</strong> above.</p>\n"}], "owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 35448819, "answer_count": 2, "score": -3, "last_activity_date": 1455742085, "creation_date": 1455677143, "last_edit_date": 1455679844, "question_id": 35446936, "link": "https://stackoverflow.com/questions/35446936/ruby-combining-flattening-multiple-array-of-hashes-on-common-hash-key-value-co", "title": "Ruby - combining/flattening multiple array of hashes on common hash key/value combination", "body": "<p>I am working with a large data set with multiple arrays of hashes which all have a key-value pair in common (\"date\" &amp; the date value) as the first element of the hash.</p>\n\n<p>The array of hashes I need to parse (@data[\"snapshot\"]) is in the following format.   Note that @data[\"snapshot\"][0], @data[\"snapshot\"][1], and @data[\"snapshot\"][2] are in <strong>identical format with identical dates</strong> but their total's differ.  In the resulting hash I need to have a key-value pair which identifies where the data came from.  </p>\n\n<p><strong>@data[\"snapshot\"][0] is as follows:</strong></p>\n\n<pre><code>[{\"date\"=&gt;\"1455672010\", \"total\"=&gt;\"**817**\", \"I\"=&gt;\"1\", \"L\"=&gt;\"3\", \"M\"=&gt;\"62\", \"H\"=&gt;\"5\", \"C\"=&gt;\"0\"},\n {\"date\"=&gt;\"1455595298\", \"total\"=&gt;\"**40**\", \"I\"=&gt;\"8\", \"L\"=&gt;\"5\", \"M\"=&gt;\"562\", \"H\"=&gt;\"125\", \"C\"=&gt;\"0\"},\n {\"date\"=&gt;\"1455336016\", \"total\"=&gt;\"**555**\", \"I\"=&gt;\"10\", \"L\"=&gt;\"1\", \"M\"=&gt;\"93\", \"H\"=&gt;\"121\", \"C\"=&gt;\"0\"}]\n</code></pre>\n\n<p><strong>@data[\"snapshot\"][1] is as follows:</strong></p>\n\n<pre><code>[{\"date\"=&gt;\"1455672010\", \"total\"=&gt;\"**70**\", \"I\"=&gt;\"1\", \"L\"=&gt;\"9\", \"M\"=&gt;\"56\", \"H\"=&gt;\"25\", \"C\"=&gt;\"0\"},\n {\"date\"=&gt;\"1455595298\", \"total\"=&gt;\"**54**\", \"I\"=&gt;\"8\", \"L\"=&gt;\"2\", \"M\"=&gt;\"5\", \"H\"=&gt;\"5\", \"C\"=&gt;\"0\"},\n {\"date\"=&gt;\"1455336016\", \"total\"=&gt;\"**25**\", \"I\"=&gt;\"0\", \"L\"=&gt;\"9\", \"M\"=&gt;\"93\", \"H\"=&gt;\"12\", \"C\"=&gt;\"0\"}]\n</code></pre>\n\n<p><strong>@data[\"snapshot\"][2] is as follows:</strong></p>\n\n<pre><code>[{\"date\"=&gt;\"1455672010\", \"total\"=&gt;\"**70**\", \"I\"=&gt;\"12\", \"L\"=&gt;\"5\", \"M\"=&gt;\"5662\", \"H\"=&gt;\"125\", \"C\"=&gt;\"0\"},\n {\"date\"=&gt;\"1455595298\", \"total\"=&gt;\"**43212**\", \"I\"=&gt;\"56\", \"L\"=&gt;\"6\", \"M\"=&gt;\"5662\", \"H\"=&gt;\"125\", \"C\"=&gt;\"0\"},\n {\"date\"=&gt;\"1455336016\", \"total\"=&gt;\"**55525**\", \"I\"=&gt;\"100\", \"L\"=&gt;\"19\", \"M\"=&gt;\"5593\", \"H\"=&gt;\"121\", \"C\"=&gt;\"0\"}]\n</code></pre>\n\n<p><strong>My Question Is Ultimately:</strong></p>\n\n<p>How do I convert (flatten?) the 3 existing array of hashes (@data[\"snapshot\"][0], @data[\"snapshot\"][1], and @data[\"snapshot\"][2]) into a single array of hashes in the following format?</p>\n\n<pre><code>[{\"date\"=&gt;\"1455672010\", \"CameFromDataSource0\"=&gt;\"817\", \"CameFromDataSource1\"=&gt;\"70\", \"CameFromDataSource2\"=&gt;\"70\"},\n {\"date\"=&gt;\"1455595298\", \"CameFromDataSource0\"=&gt;\"40\", \"CameFromDataSource1\"=&gt;\"54\", \"CameFromDataSource2\"=&gt;\"43212\"},   \n {\"date\"=&gt;\"1455336016\", \"CameFromDataSource0\"=&gt;\"555\", \"CameFromDataSource1\"=&gt;\"25\", \"CameFromDataSource2\"=&gt;\"55525\"}]\n</code></pre>\n"}]