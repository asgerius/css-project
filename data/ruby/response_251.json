[{"tags": ["javascript", "ruby"], "comments": [{"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "edited": false, "score": 0, "creation_date": 1572479114, "post_id": 58634992, "comment_id": 103577018, "body": "Surely, just using  <code>var sppf_boolean = &lt;%= Model.exists?(foo_id: foo.id) %&gt;;</code>  should do the trick, am I missing anything?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "edited": false, "score": 0, "creation_date": 1572480935, "post_id": 58634992, "comment_id": 103577415, "body": "Tried it, not working.  That&#39;s what I&#39;m saying, there&#39;s something missing here I am not understanding.  All the same code works as long as i manually set it to true, but if I use the ruby code, which equals true, it won&#39;t work..."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1572481154, "post_id": 58634992, "comment_id": 103577455, "body": "where have you place this code inside script tag? It should be at the bottom of your layout html file before the closing body tag in most cases.  If it&#39;s in a javascript file that will get precompiled, it may not work as expected, and will like throw compilation error if you are using asset pipeline."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1572481644, "post_id": 58635329, "comment_id": 103577550, "body": "Okay we&#39;re getting somewhere.  In the console.log, it says false.... but right above it in the <code>var</code>, it shows <code>var sppf_boolean= true</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 1, "creation_date": 1572481941, "post_id": 58635329, "comment_id": 103577620, "body": "sounds like a possible global scope var name clash.  Try using a different var name? something surely not used elsewhere?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1572482707, "post_id": 58635329, "comment_id": 103577777, "body": "That;s gotta be it.  It&#39;s because it&#39;s based on variables in a loop"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1572482999, "post_id": 58635329, "comment_id": 103577829, "body": "See updated answer, but sounds like using erb in your javascript may not work for your use case, and in general is not recommended."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1572484320, "post_id": 58635329, "comment_id": 103578082, "body": "You were right about the naming.  Because it&#39;s based on variables, I wasn&#39;t using the variable name so it was taking the last variable status"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1572482901, "last_edit_date": 1572482901, "creation_date": 1572481030, "answer_id": 58635329, "question_id": 58634992, "link": "https://stackoverflow.com/questions/58634992/using-boolean-from-json-for-if-statement/58635329#58635329", "title": "Using boolean from JSON for if statement", "body": "<p>This should work but to be sure, add console log.  Also, if you expect your function to be called, well maybe call it?  UPDATE: Use closure to insure you're variable names are not polluted in the global scope.</p>\n\n<pre><code>&lt;script&gt;\n(function(){\n  var sppf_boolean = &lt;%= Model.exists?(foo_id: foo.id) %&gt;;\n  console.log(sppf_boolean);\n  function loadJSONImage() {\n    if (sppf_boolean)\n    {\n       #codey\n    }\n  }\n  // but we have not called the function yet.  Should we? if so:\n  loadJSONImage();    \n}();\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58635329, "answer_count": 1, "score": 0, "last_activity_date": 1572482901, "creation_date": 1572478208, "question_id": 58634992, "link": "https://stackoverflow.com/questions/58634992/using-boolean-from-json-for-if-statement", "title": "Using boolean from JSON for if statement", "body": "<p>I have a var that equals true, but it seems that since it's from a JSON, it's not \"actually\" true.</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>&lt;% sppf = Model.exists?(foo_id: foo.id) %&gt;\n#this translates to: true\n#in the view-source\n\n&lt;script&gt;\nvar sppf_boolean = &lt;%= sppf.to_json.html_safe %&gt;;\n#this translates to: var sppf_boolean = true;\nfunction loadJSONImage() {\n  if (sppf_boolean)\n  {\n     #codey\n  };\n};\n&lt;/script&gt;\n</code></pre>\n\n<p>Tried to remove the <code>to_json.html_safe</code> but that didn't do that trick.  Also tried that with a combination of <code>(sppf_boolean === true)</code> and <code>(sppf_boolean == true)</code></p>\n\n<p>This does work:</p>\n\n<pre><code>&lt;script&gt;\nvar sppf_boolean = true;\nfunction loadJSONImage() {\n  if (sppf_boolean)\n  {\n     #codey\n  };\n};\n&lt;/script&gt;\n</code></pre>\n\n<p>In the source code, it shows <code>true</code> (or <code>false</code>).  Is there some difference from the true/false coming from ruby syntax?</p>\n\n<p>I don't see any reasons on why this will not work.  How can I get this to work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments", "ruby-on-rails-5.2"], "answers": [{"tags": [], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "is_accepted": false, "score": 3, "last_activity_date": 1572544228, "creation_date": 1572544228, "answer_id": 58648838, "question_id": 58634940, "link": "https://stackoverflow.com/questions/58634940/remove-coupon-from-stripe-subscription-in-update/58648838#58648838", "title": "Remove Coupon from Stripe Subscription in Update", "body": "<pre><code>coupon: ''\n</code></pre>\n\n<p>Coupon set to an empty string removes it, while nil/null is ignored</p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572544228, "creation_date": 1572477839, "question_id": 58634940, "link": "https://stackoverflow.com/questions/58634940/remove-coupon-from-stripe-subscription-in-update", "title": "Remove Coupon from Stripe Subscription in Update", "body": "<p>I need to remove a coupon on a subscription during update, I thought passing coupon of nil to the api should remove it, but it just removes it from the post.</p>\n\n<p>There is another way of doing it like this.. \n<a href=\"https://stripe.com/docs/api/discounts/subscription_delete\" rel=\"nofollow noreferrer\">https://stripe.com/docs/api/discounts/subscription_delete</a></p>\n\n<p>but it requires another call I don't want to do.</p>\n\n<h3>Ruby Stripe Gem API:</h3>\n\n<pre><code>      Stripe::Subscription.update(\n        subscription.stripe_id,\n        {\n          coupon: nil,\n          items: [\n            {\n              id: subscription.item_stripe_id,\n              quantity: 0,\n\n            },\n            { \n              plan: to_plan.stripe_id,\n              quantity: 1\n            }\n          ],\n        }\n      ) \n</code></pre>\n\n<h3>creates a post request like this:</h3>\n\n<pre><code>{\n  \"items\": {\n    \"0\": {\n      \"id\": \"si_G5sdf33t89\",\n      \"quantity\": \"0\"\n    },\n    \"1\": {\n      \"plan\": \"a_plan\",\n      \"quantity\": \"1\"\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby", "pty"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572475193, "post_id": 58634512, "comment_id": 103576036, "body": "Note: Inside a <code>def</code> you can just <code>ensure</code> without need for an explicit <code>begin</code>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4097162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc7c0a91ccdab917e5672d244af1ef2?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4097162/robert"}, "edited": false, "score": 0, "creation_date": 1572555138, "post_id": 58637786, "comment_id": 103606850, "body": "Thanks, I believe Solution 2 will work for my situation."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 0, "last_activity_date": 1572531557, "last_edit_date": 1572531557, "creation_date": 1572502717, "answer_id": 58637786, "question_id": 58634512, "link": "https://stackoverflow.com/questions/58634512/ruby-sending-keystrokes-to-pty-in-raw-mode/58637786#58637786", "title": "ruby: Sending keystrokes to PTY in raw mode", "body": "<p>The problem is that the newt C-library opens <code>/dev/tty</code> by default for input. It does not use stdin. This is why nothing you send it seems to work. It's not reading your pipe, it is reading <code>/dev/tty</code>.</p>\n\n<p>Here is the problem in more detail: </p>\n\n<ol>\n<li>Ruby newt calls <code>newtInit()</code> in the C-lib</li>\n<li><code>newtInit()</code> calls <code>SLang_init_tty</code></li>\n<li><code>SLang_init_tty</code> attaches input to <code>/dev/tty</code> by default always.</li>\n</ol>\n\n<p>If you <a href=\"https://www.jedsoft.org/slang/doc/html/cref-10.html\" rel=\"nofollow noreferrer\">read the documentation</a> of <code>SLang_init_tty</code> you will find that the variable <code>SLang_TT_Read_FD</code> determines if <code>/dev/tty</code> is used or not.</p>\n\n<p><strong>Solution 1</strong>:</p>\n\n<p>You need to set <code>SLang_TT_Read_FD</code> to <code>stdin</code>, before calling <code>newtInit()</code> from Ruby.</p>\n\n<p><strong>Solution 2:</strong></p>\n\n<p>Use <code>setsid</code> and <code>ioctl(TIOCSCTTY)</code> to reassign the controlling terminal in the forked process (see <a href=\"https://linux.die.net/man/4/tty_ioctl\" rel=\"nofollow noreferrer\">docs for ioctl here</a>).</p>\n\n<p>Working example:</p>\n\n<pre><code>TIOCSCTTY = 0x540E\nmaster, slave = PTY.open\n\nif fork.nil? then\n  # Child process\n  # Make group leader. Required for aquiring controlling TTY.\n  Process.setsid\n\n  master.close               # Close master side    \n  STDIN.reopen(slave)        # Reassign STDIN\n  STDIN.ioctl(TIOCSCTTY, 0)  # Reassign controlling TTY (important part)\n\n  # Ensure master is ready\n  slave.gets\n\n  # Now we can run the UI\n  newt_run\nelse\n  # Parent process\n  slave.close\n\n  # Sync up with slave\n  master.puts 'hello'\n\n  # Allow for UI setup\n  sleep 1\n\n  master.write \"\\e[B\" # Arrow down\n  master.write \"\\e[B\" # Arrow down\n  master.write \"\\t\"   # Tab\n  master.write \"\\r\"   # Enter\n\n  Process.wait \nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4097162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc7c0a91ccdab917e5672d244af1ef2?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4097162/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 58637786, "answer_count": 1, "score": 2, "last_activity_date": 1572531557, "creation_date": 1572474802, "question_id": 58634512, "link": "https://stackoverflow.com/questions/58634512/ruby-sending-keystrokes-to-pty-in-raw-mode", "title": "ruby: Sending keystrokes to PTY in raw mode", "body": "<p>I'm attempting to add some more automated tests to the <code>ruby-newt</code> module. The code I have seems to work, but still requires manually hitting <code>ENTER</code> at the terminal in order for it to complete.</p>\n\n<p>For example in the following code, <code>\\t</code> will switch to the next button and <code>\\r</code> will press the button, and both commands execute successfully, but the <code>ENTER</code> key still needs to be manually pressed at the terminal otherwise the program just hangs indefinitely.</p>\n\n<p>If the line <code>wr.write \"\\t\\r\"</code> is commented out, then the program will time out and exit successfully after 10 seconds. I've tried <code>wr.flush</code>, but that does not help. I've also tried including <code>\\n</code> in the command.</p>\n\n<p>Is there anything additional I should include in the <code>write</code> command to ensure the child program successfully receives it? </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'newt'\nrequire 'pty'\n\ndef newt_run\n  begin\n    Newt::Screen.new\n    Newt::Screen.centered_window(20, 15, 'Button')\n\n    b1 = Newt::Button.new(1, 1, 'Button1')\n    b2 = Newt::Button.new(1, 6, 'Button2')\n\n    b = Newt::Button.new(1, 11, 'Exit')\n\n    f = Newt::Form.new\n    f.set_timer(10000)\n    f.add(b1, b2, b) \n\n    rv = f.run\n  ensure\n    Newt::Screen.finish\n  end\nend\n\nmaster, slave = PTY.open\nrd, wr = IO.pipe\n\nif fork.nil? then\n  master.close\n  wr.close\n\n  $stdin.reopen(rd)\n  $stdout.reopen(slave)\n  $stderr.reopen(slave)\n\n  newt_run\nelse\n  slave.close\n  rd.close\n\n  wr.write \"\\t\\r\"\n  Process.wait\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5", "rollbar"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5790261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/225b212bb482ad5456e4fa6a1a43593a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/5790261/steve"}, "edited": false, "score": 0, "creation_date": 1572475138, "post_id": 58634437, "comment_id": 103576020, "body": "The key was just adding the expectation of the error being raised"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1572474230, "creation_date": 1572474230, "answer_id": 58634437, "question_id": 58634362, "link": "https://stackoverflow.com/questions/58634362/rspec-test-rollbar-called-in-method-where-error-is-raised/58634437#58634437", "title": "RSpec test Rollbar called in method where error is raised", "body": "<p>You can expect the error or rescue it:</p>\n\n<p>expect the error:</p>\n\n<pre><code>    it 'sends a warning to rollbar' do\n      expect { subject.send(:log_and_raise_error) }.to raise_error NotAuthorized\n\n      expect(Rollbar).to have_received(:warning)\n    end\n</code></pre>\n\n<p>rescue error:</p>\n\n<pre><code>    it 'sends a warning to rollbar' do\n      subject.send(:log_and_raise_error) rescue NotAuthorized\n\n      expect(Rollbar).to have_received(:warning)\n    end\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    it 'sends a warning to rollbar' do\n      begin\n        subject.send(:log_and_raise_error)\n      rescue NotAuthorized\n      # noop\n      end\n      expect(Rollbar).to have_received(:warning)\n    end\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5790261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/225b212bb482ad5456e4fa6a1a43593a?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/5790261/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1572474265, "creation_date": 1572473688, "last_edit_date": 1572474265, "question_id": 58634362, "link": "https://stackoverflow.com/questions/58634362/rspec-test-rollbar-called-in-method-where-error-is-raised", "title": "RSpec test Rollbar called in method where error is raised", "body": "<p>I'm able to test that <code>Rollbar.warning</code> has been called, but when it is called in a method that also raises an error, it fails because an error is raised, and it skips <code>Rollbar.warning</code>.</p>\n\n<pre><code>  context 'unauthorized' do\n    before do\n      allow(Rollbar).to receive(:warning)\n    end\n\n    it 'sends a warning to rollbar' do\n      subject.send(:log_and_raise_error)\n\n      expect(Rollbar).to have_received(:warning)\n    end\n  end\n</code></pre>\n\n<p>Here's the method I'm testing:</p>\n\n<pre><code>  def log_and_raise_error\n    Rollbar.warning(\n      \"Not authorized error accessing resource #{ResourceID}\"\n    )\n\n    raise NotAuthorized\n  end\n</code></pre>\n\n<p>But when I run specs, it fails with:</p>\n\n<pre><code> 1) Authorization unauthorized sends a warning to rollbar\n     Failure/Error: subject.send(:log_and_raise_error)\n\n     NotAuthorized\n</code></pre>\n\n<p>Any ideas how I can get around that error raising and still test Rollbar?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception", "error-handling", "module"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1572472660, "creation_date": 1572472660, "answer_id": 58634194, "question_id": 58634123, "link": "https://stackoverflow.com/questions/58634123/global-error-handling-and-the-order-of-included-rescue-from/58634194#58634194", "title": "Global error handling and the order of included rescue_from", "body": "<p>The <a href=\"https://github.com/rails/rails/blob/66cabeda2c46c582d19738e1318be8d59584cc5b/activesupport/lib/active_support/rescuable.rb#L124-L126\" rel=\"nofollow noreferrer\">last declared handler has the highest priority</a>, so you should declare general handlers first (e.g. one for <code>StandardError</code>) and then specific ones.</p>\n"}], "owner": {"reputation": 677, "user_id": 1968035, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/dbae7dd3567a5f0e0613afe5886b1500?s=128&d=identicon&r=PG", "display_name": "1dolinski", "link": "https://stackoverflow.com/users/1968035/1dolinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 58634194, "answer_count": 1, "score": 2, "last_activity_date": 1572472710, "creation_date": 1572472208, "last_edit_date": 1572472710, "question_id": 58634123, "link": "https://stackoverflow.com/questions/58634123/global-error-handling-and-the-order-of-included-rescue-from", "title": "Global error handling and the order of included rescue_from", "body": "<p>For my program to work as expected, the order of rescue_from is not intuitive. I'm wondering why this is or where I'm going wrong?</p>\n\n<p>I was trying this error handling solution.</p>\n\n<p><a href=\"https://medium.com/rails-ember-beyond/error-handling-in-rails-the-modular-way-9afcddd2fe1b#.yvuf06281\" rel=\"nofollow noreferrer\">https://medium.com/rails-ember-beyond/error-handling-in-rails-the-modular-way-9afcddd2fe1b#.yvuf06281</a></p>\n\n<p>My error handler was the same as in the <a href=\"https://github.com/scaffeinate/modular-error-handling/blob/master/lib/error/error_handler.rb\" rel=\"nofollow noreferrer\">github repo</a></p>\n\n<pre><code>module Error\n  module ErrorHandler\n    def self.included(clazz)\n      clazz.class_eval do\n        rescue_from ActiveRecord::RecordNotFound do |e|\n          respond(:record_not_found, 404, e.to_s)\n        end\n        rescue_from CustomError do |e|\n          respond(e.error, e.status, e.message.to_s)\n        end\n        rescue_from StandardError do |e|\n          respond(:standard_error, 500, e.to_s)\n        end\n      end\n    end\n</code></pre>\n\n<p>This results in my errors always being caught in the <code>StandardError</code> block, skipping the <code>ActiveRecord::RecordNotFound</code> and <code>Custom</code> error blocks.</p>\n\n<p>However, if I switch the order (<code>StandardError</code> higher in the execution) it properly catches the other types of errors.</p>\n\n<pre><code>    def self.included(clazz) #includes module as a class method\n      clazz.class_eval do\n        rescue_from StandardError do |e|\n          respond(:standard_error, 500, e.to_s) \n        end\n\n        rescue_from ActiveRecord::RecordNotFound do |e|\n          respond(:record_not_found, 404, e.to_s)\n        end\n\n        rescue_from CustomError do |e|\n          respond(e.error, e.status, e.message.to_s)\n        end\n      end\n    end\n</code></pre>\n\n<p>Why does having StandardError at the top work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 2, "last_activity_date": 1572534279, "last_edit_date": 1572534279, "creation_date": 1572473618, "answer_id": 58634349, "question_id": 58633850, "link": "https://stackoverflow.com/questions/58633850/ruby-application-helper-invalid-authenticity-token/58634349#58634349", "title": "Ruby Application Helper Invalid Authenticity Token", "body": "<p>Depending on what version of Rails you're using (but let's say it's 4 or 5), all you should need to get the tokens working is:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># In the html head section of app/views/layouts/application.erb\n&lt;%= csrf_meta_tags %&gt;\n</code></pre>\n\n<p>You should <em>not</em> need the custom <code>auth_token</code> helper method you've created!</p>\n"}], "owner": {"reputation": 11, "user_id": 9856216, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156605495611165/picture?type=large", "display_name": "Eugenia Leung", "link": "https://stackoverflow.com/users/9856216/eugenia-leung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572534279, "creation_date": 1572470677, "question_id": 58633850, "link": "https://stackoverflow.com/questions/58633850/ruby-application-helper-invalid-authenticity-token", "title": "Ruby Application Helper Invalid Authenticity Token", "body": "<p>Help! My error message is saying : ActionController::InvalidAuthenticityToken. Is there something wrong with my interpolation of form_authenticity_token?</p>\n\n<p>application_controller.rb</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\nprotect_from_forgery with: :exception\n</code></pre>\n\n<p>application_helper.rb</p>\n\n<pre><code>module ApplicationHelper\ndef auth_token\n    \"&lt;input\n        type='hidden'\n        name='authenticity_token\n        value='#{form_authenticity_token}'\n    /&gt;\".html_safe\nend\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "mocking", "grape"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1572470624, "post_id": 58633826, "comment_id": 103574639, "body": "You mean that <code>second_inquiry_process</code> is an AR relation?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1572471417, "post_id": 58633826, "comment_id": 103574904, "body": "@mrzasa yes, it should be an AR relation"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1572472034, "creation_date": 1572472034, "answer_id": 58634103, "question_id": 58633826, "link": "https://stackoverflow.com/questions/58633826/rspec-mock-activerecordrelation-instead-of-class-object/58634103#58634103", "title": "Rspec mock ActiveRecord::Relation instead of class object", "body": "<p>I can see two options.</p>\n\n<p>If you care about not touching DB in the spec and it's enough to get <code>Enumerable</code>, assign an array to <code>second_inquiry_process</code>, e.g.:</p>\n\n<pre><code>let(:second_inquiry_process) { [inquiry_process_instance] }\n</code></pre>\n\n<p>or with FactoryBot</p>\n\n<pre><code>let(:second_inquiry_process) { build_list :inquiry_process, 1 }\n</code></pre>\n\n<p>If you want to have full AR relation (and I suppose you do), create records in the db and assign them to the variable, e.g.:</p>\n\n<pre><code>let(:inquiry_process_instance) { create :inquiry_proces }\nlet(:second_inquiry_process) { InquiryProcess.where(id: inquiry_process_instance.id) }\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 58634103, "answer_count": 1, "score": 2, "last_activity_date": 1572472066, "creation_date": 1572470537, "last_edit_date": 1572472066, "question_id": 58633826, "link": "https://stackoverflow.com/questions/58633826/rspec-mock-activerecordrelation-instead-of-class-object", "title": "Rspec mock ActiveRecord::Relation instead of class object", "body": "<p>I want to mock one line from my endpoint:</p>\n\n<pre><code>InquiryProcessFilters::CompanyName.new(params[:filters][:company_name].downcase).call\n</code></pre>\n\n<p>So I've mock:</p>\n\n<pre><code>let(:company_name_filter_mock) { instance_double(InquiryProcessFilters::CompanyName) }\n\nbefore do\n  allow(InquiryProcessFilters::CompanyName).to(receive(:new).and_return(company_name_filter_mock))\n  allow(company_name_filter_mock).to receive(:call).and_return(second_inquiry_process)\nend\n</code></pre>\n\n<p>The problem is that my class from endpoint returns result as <code>ActiveRecord_Relation</code> and this is my desired result. How to update my mock to achieve that?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1572470971, "post_id": 58633822, "comment_id": 103574761, "body": "Please see the <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> page. Questions need to stand on their own. Also please post text, not images of text, or links to images of text."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1572471058, "post_id": 58633822, "comment_id": 103574793, "body": "You&#39;re calling out to the system--it will have its own output (likely to <code>stderr</code>)."}, {"owner": {"reputation": 1, "user_id": 12299879, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAZXnKoOvn_rjYac61ATUqjkaFWPj9v0xP7YhiBcA=k-s128", "display_name": "logan infranca", "link": "https://stackoverflow.com/users/12299879/logan-infranca"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1572471998, "post_id": 58633822, "comment_id": 103575095, "body": "Fixed it, I just need to put the system call after the raise statement"}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 1, "last_activity_date": 1572472474, "creation_date": 1572472474, "answer_id": 58634164, "question_id": 58633822, "link": "https://stackoverflow.com/questions/58633822/can-you-output-your-custom-exception-message-but-not-the-default-as-well-in-ruby/58634164#58634164", "title": "Can you output your custom exception message but not the default as well in Ruby?", "body": "<p>It's because <code>system</code> doesn't raise an exception, it just has <a href=\"https://ruby-doc.org/core-2.6.5/Kernel.html#method-i-system\" rel=\"nofollow noreferrer\">varying return values</a>:</p>\n\n<blockquote>\n  <p><code>system</code> returns <code>true</code> if the command gives zero exit status, <code>false</code> for non zero exit status. Returns <code>nil</code> if command execution fails. An error status is available in <code>$?</code>.</p>\n</blockquote>\n\n<p>So you can see that it isn't Ruby printing the error message, it's the <code>open</code> command. It's easy to test in your shell:</p>\n\n<pre><code>$ open bar\nThe file /Users/foo/bar does not exist.\n$ echo $?\n1\n</code></pre>\n\n<p>Confirm in Ruby:</p>\n\n<pre><code>system 'open bar'\nThe file /Users/foo/bar does not exist.\n=&gt; false\nputs $?\npid 9610 exit 1\n=&gt; nil\n</code></pre>\n\n<p>So there's nothing to <code>rescue</code> because there's no exception ever raised. You have to evaluate the return value of <code>system</code> or the exit code of the process (<code>$?</code>) to make a determination as to the success or failure of your call to <code>system</code>.</p>\n\n<p>If you don't want to see any output at all from <code>open</code> then use this to redirect:</p>\n\n<pre><code>system 'open foo &gt; /dev/null 2&gt;&amp;1'\n=&gt; false\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12299879, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAZXnKoOvn_rjYac61ATUqjkaFWPj9v0xP7YhiBcA=k-s128", "display_name": "logan infranca", "link": "https://stackoverflow.com/users/12299879/logan-infranca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1572472474, "creation_date": 1572470505, "question_id": 58633822, "link": "https://stackoverflow.com/questions/58633822/can-you-output-your-custom-exception-message-but-not-the-default-as-well-in-ruby", "title": "Can you output your custom exception message but not the default as well in Ruby?", "body": "<p>I have been trying to create exception handling for opening a file in ruby. I have tried to use the raise and rescue method but all types have either shown the custom and the default(instead of just the custom) or have errored out completely. <a href=\"https://i.stack.imgur.com/epTd3.png\" rel=\"nofollow noreferrer\">My attempted code</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/pbJBb.png\" rel=\"nofollow noreferrer\">output showing custom one bottom but default on top I want to get rid of</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "edited": false, "score": 0, "creation_date": 1572468821, "post_id": 58633447, "comment_id": 103573962, "body": "I&#39;m also interested in <code>include</code> and <code>extend</code>."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572469756, "post_id": 58633447, "comment_id": 103574336, "body": "It&#39;s in the Rubocop style guide, you can&#39;t miss it: <a href=\"https://github.com/rubocop-hq/ruby-style-guide#consistent-classes\" rel=\"nofollow noreferrer\">github.com/rubocop-hq/ruby-style-guide#consistent-classes</a>"}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1572470297, "creation_date": 1572470297, "answer_id": 58633783, "question_id": 58633447, "link": "https://stackoverflow.com/questions/58633447/guidelines-regarding-spaces-for-class-variables-instance-variables-etc/58633783#58633783", "title": "Guidelines regarding spaces for class variables, instance variables, etc", "body": "<p><a href=\"https://stackoverflow.com/users/3784008/anothermh\">anothermh</a> shared the link above (and for the record, amazing that their profile photo is of Robocop when this question is about Rubocop) ... but here's what the <a href=\"https://github.com/rubocop-hq/ruby-style-guide#consistent-classes\" rel=\"nofollow noreferrer\">Rubocop guidelines for classes</a> suggest:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Person\n  # extend and include go first\n  extend SomeModule\n  include AnotherModule\n\n  # inner classes\n  CustomError = Class.new(StandardError)\n\n  # constants are next\n  SOME_CONSTANT = 20\n\n  # afterwards we have attribute macros\n  attr_reader :name\n\n  # followed by other macros (if any)\n  validates :name\n\n  # public class methods are next in line\n  def self.some_method\n  end\n\n  # initialization goes between class methods and other instance methods\n  def initialize\n  end\n\n  # followed by other public instance methods\n  def some_method\n  end\n\n  # protected and private methods are grouped near the end\n  protected\n\n  def some_protected_method\n  end\n\n  private\n\n  def some_private_method\n  end\nend\n</code></pre>\n\n<p>As a personal note: although having consistent styling makes it quicker and easier to read code and for others to scan what you're written, keep in mind that these are just <em>recommendations</em> of \"best practices\". At the end of the day whatever works best FOR YOU should be <em>your</em> new best practice.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58633783, "answer_count": 1, "score": 0, "last_activity_date": 1572470297, "creation_date": 1572468574, "last_edit_date": 1572468667, "question_id": 58633447, "link": "https://stackoverflow.com/questions/58633447/guidelines-regarding-spaces-for-class-variables-instance-variables-etc", "title": "Guidelines regarding spaces for class variables, instance variables, etc", "body": "<p>Is there a guideline to follow in regard to space for class variables, instance variables, etc? For example</p>\n\n<pre><code>class MyModel &lt; ApplicationRecord\n  belongs_to :something\n  has_many: :something_elses\n  validates: :property, presence: true\n  after_save :do_something\nend\n</code></pre>\n\n<p>In this case I'm using as example a model record, but I would like to understand the standard style for everything. I'm using Rubocop and it doesn't tell me anything about this.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 1, "creation_date": 1572467093, "post_id": 58633069, "comment_id": 103573229, "body": "<code>ArgumentError: missing keywords: from, to</code> is the important part I think.  Can you post the seed file?"}, {"owner": {"reputation": 593, "user_id": 10529185, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qa_2_AJSdzg/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVCgOH5CKPBQYvM7Y_sKBLTCIPaDw/mo/photo.jpg?sz=128", "display_name": "CR7", "link": "https://stackoverflow.com/users/10529185/cr7"}, "edited": false, "score": 1, "creation_date": 1572467108, "post_id": 58633069, "comment_id": 103573235, "body": "Please provide your seed.rb code"}], "answers": [{"tags": [], "owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "is_accepted": false, "score": 7, "last_activity_date": 1572467842, "creation_date": 1572467842, "answer_id": 58633295, "question_id": 58633069, "link": "https://stackoverflow.com/questions/58633069/rake-dbseed-generates-argumenterror-missing-keywords-from-to/58633295#58633295", "title": "rake db:seed generates ArgumentError: missing keywords: from, to", "body": "<p>Looks like you're using <code>Faker</code> with the old syntax. It recently changed to require keyword arguments rather than positional arguments.</p>\n\n<p>You need to follow the updated syntax:</p>\n\n<pre><code>Faker::Date.between(from: 2.days.ago, to: Date.today) #=&gt; \"Wed, 24 Sep 2014\"\n</code></pre>\n\n<p>Note the keywords <code>from:</code> and <code>to:</code> which specify the arguments. Order of arguments is not important, and the reverse order will work just the same:</p>\n\n<pre><code>Faker::Date.between(to: Date.today, from: 2.days.ago) #=&gt; \"Wed, 24 Sep 2014\"\n</code></pre>\n\n<p>Additional information available in their docs: <a href=\"https://github.com/faker-ruby/faker/blob/master/doc/default/date.md\" rel=\"noreferrer\">https://github.com/faker-ruby/faker/blob/master/doc/default/date.md</a></p>\n"}], "owner": {"reputation": 21, "user_id": 12254048, "user_type": "registered", "profile_image": "https://graph.facebook.com/2763923400308928/picture?type=large", "display_name": "Andy Softmatech", "link": "https://stackoverflow.com/users/12254048/andy-softmatech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572468504, "creation_date": 1572466769, "last_edit_date": 1572468504, "question_id": 58633069, "link": "https://stackoverflow.com/questions/58633069/rake-dbseed-generates-argumenterror-missing-keywords-from-to", "title": "rake db:seed generates ArgumentError: missing keywords: from, to", "body": "<p>I got a database to seed to test my code. When I run <code>rake db:seed</code> to seed the database, I get the error below.</p>\n\n<p>I expected the console to be blank: this means the data has been seeded.</p>\n\n<p>Error:</p>\n\n<pre><code>[19:19:41] (master) simple-partials-lab-noukod-000\n// \u2665 rake db:seed\n/usr/local/rvm/gems/ruby-2.6.1/gems/activesupport-4.2.11.1/lib/active_support/core_ext/object/duplicable.rb:111: warning: BigDecimal.new is deprecated; use BigDecimal() method instead.\nrake aborted!\nArgumentError: missing keywords: from, to\n/usr/local/rvm/gems/ruby-2.6.1/gems/faker-2.2.1/lib/faker/default/date.rb:6:in `between'\n/home/considerate-transform-1229/simple-partials-lab-noukod-000/db/seeds.rb:9:in `block in &lt;top (required)&gt;'\n/home/considerate-transform-1229/simple-partials-lab-noukod-000/db/seeds.rb:8:in `times'\n/home/considerate-transform-1229/simple-partials-lab-noukod-000/db/seeds.rb:8:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.6.1/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:268:in `load'\n/usr/local/rvm/gems/ruby-2.6.1/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:268:in `block in load'\n/usr/local/rvm/gems/ruby-2.6.1/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:240:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.6.1/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:268:in `load'\n/usr/local/rvm/gems/ruby-2.6.1/gems/railties-4.2.11.1/lib/rails/engine.rb:547:in `load_seed'\n/usr/local/rvm/gems/ruby-2.6.1/gems/activerecord-4.2.11.1/lib/active_record/tasks/database_tasks.rb:253:in `load_seed'\n/usr/local/rvm/gems/ruby-2.6.1/gems/activerecord-4.2.11.1/lib/active_record/railties/databases.rake:173:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.6.1/gems/rake-12.3.3/exe/rake:27:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.6.1/bin/ruby_executable_hooks:24:in `eval'\n/usr/local/rvm/gems/ruby-2.6.1/bin/ruby_executable_hooks:24:in `&lt;main&gt;'\nTasks: TOP =&gt; db:seed\n(See full trace by running task with --trace)\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 3, "creation_date": 1572466653, "post_id": 58632823, "comment_id": 103573071, "body": "As noted in the github issue you reference: A quick hack could be to set <code>RSpec::Support::ObjectFormatter.default_instance.max_formatt&zwnj;&#8203;ed_output_length = n</code> to a high enough value. Or you could just otherwise print the result to the console if the strings don&#39;t match."}, {"owner": {"reputation": 1228, "user_id": 960819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/382c8d761371f83ff28f5e96da0204fe?s=128&d=identicon&r=PG", "display_name": "Pere Joan Martorell", "link": "https://stackoverflow.com/users/960819/pere-joan-martorell"}, "edited": false, "score": 0, "creation_date": 1602241543, "post_id": 58632823, "comment_id": 113665072, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/38670959/how-to-prevent-rspec-from-abbreviating-match-array-output\">How to prevent RSpec from abbreviating match_array output?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 759, "user_id": 9174431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8f67982fb2ef93d0ebf92453b00fe5?s=128&d=identicon&r=PG", "display_name": "Giuseppe Schembri", "link": "https://stackoverflow.com/users/9174431/giuseppe-schembri"}, "is_accepted": false, "score": 0, "last_activity_date": 1573929645, "last_edit_date": 1573929645, "creation_date": 1573919605, "answer_id": 58892495, "question_id": 58632823, "link": "https://stackoverflow.com/questions/58632823/whats-the-best-workaround-for-rspec-string-truncation/58892495#58892495", "title": "What&#39;s the best workaround for Rspec string truncation?", "body": "<p>What about?</p>\n\n<pre><code>expected = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaA\".split('')\n\n\nactual = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaAaaaaaaaaaaaaaaaaaaaaaaaa\".split('')\n\n\n\np (expected.reject.with_index { |ex, ind| actual[ind] == ex }) # [\"a\", \"A\"]\n\np (expected.map.with_index { |ex, ind| [actual[ind], ex, ind] }).\nreject { |actual_ch, expected_ch, index | actual_ch == expected_ch} #[[\"A\", \"a\", 27], [nil, \"A\", 52]]\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1228, "user_id": 960819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/382c8d761371f83ff28f5e96da0204fe?s=128&d=identicon&r=PG", "display_name": "Pere Joan Martorell", "link": "https://stackoverflow.com/users/960819/pere-joan-martorell"}, "is_accepted": false, "score": 0, "last_activity_date": 1602241384, "creation_date": 1602241384, "answer_id": 64278755, "question_id": 58632823, "link": "https://stackoverflow.com/questions/58632823/whats-the-best-workaround-for-rspec-string-truncation/64278755#64278755", "title": "What&#39;s the best workaround for Rspec string truncation?", "body": "<p>RSpec has a setting to set the maximum character length that it will print while formatting an object:</p>\n<pre><code>RSpec.configure do |rspec|\n  rspec.expect_with :rspec do |c|\n    c.max_formatted_output_length = nil\n  end\nend\n</code></pre>\n<p>You can set length to <code>nil</code> to prevent RSpec from doing truncation.\nSetting it to an integer will change the maximum number of characters in the formatted output (<code>200</code> by default).</p>\n<p>Documentation: <a href=\"http://rspec.info/documentation/3.9/rspec-expectations/RSpec/Expectations/Configuration.html#max_formatted_output_length=-instance_method\" rel=\"nofollow noreferrer\">http://rspec.info/documentation/3.9/rspec-expectations/RSpec/Expectations/Configuration.html#max_formatted_output_length=-instance_method</a></p>\n"}], "owner": {"reputation": 2426, "user_id": 229810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/642586dc22f75193f059bc39c43d624e?s=128&d=identicon&r=PG", "display_name": "kevin cline", "link": "https://stackoverflow.com/users/229810/kevin-cline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1602241384, "creation_date": 1572465684, "question_id": 58632823, "link": "https://stackoverflow.com/questions/58632823/whats-the-best-workaround-for-rspec-string-truncation", "title": "What&#39;s the best workaround for Rspec string truncation?", "body": "<p>I'm looking for a work-around for this RSpec misfeature: <a href=\"https://github.com/rspec/rspec-core/issues/2535\" rel=\"nofollow noreferrer\">https://github.com/rspec/rspec-core/issues/2535</a>. </p>\n\n<p>An RSpec equality assertion on two long-ish strings may result in the differing parts of the strings being elided.</p>\n\n<p>For example, if the expected value is:</p>\n\n<pre><code>\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"\n</code></pre>\n\n<p>and the actual value is:</p>\n\n<pre><code>\"aaaaaaaaaaaaaaaaaaaaaaaaaaaAaaaaaaaaaaaaaaaaaaaaaaaa\"```\n</code></pre>\n\n<p>the output may be:</p>\n\n<pre><code> Failure/Error: expect(g.to_whitespace_escaped_xwiki).to eq(expect)\n\n   expected: \"aaaaaaaaaaaaaaaa...aaaaaaaaaaaaaaaaaaa\"\n        got: \"aaaaaaaaaaaaaaaa...aaaaaaaaaaaaaaaaaaa\"\n   (compared using ==)\n</code></pre>\n\n<p>The portions that differ are not output.</p>\n"}, {"tags": ["ruby", "methods"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1572461830, "post_id": 58632014, "comment_id": 103571113, "body": "looks like your code is missing something"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1572461992, "post_id": 58632014, "comment_id": 103571176, "body": "what part doesn&#39;t make sense?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572465140, "post_id": 58632611, "comment_id": 103572473, "body": "If the exercise is to <i>write</i> <code>map</code>, then delegating to Array/Enumerable is kind of cheating, no? :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1572465507, "post_id": 58632611, "comment_id": 103572634, "body": "@Sergio, ha! It didn&#39;t occur to me that this was to be a replacement for THE map, though it is front-and-centre in the first sentence."}, {"owner": {"reputation": 21, "user_id": 10327766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80176b97a2e46f08150df67e868bd97e?s=128&d=identicon&r=PG&f=1", "display_name": "Valentine M.", "link": "https://stackoverflow.com/users/10327766/valentine-m"}, "edited": false, "score": 0, "creation_date": 1572471793, "post_id": 58632611, "comment_id": 103575037, "body": "Got it! Thank you !!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1572486348, "last_edit_date": 1572486348, "creation_date": 1572464619, "answer_id": 58632611, "question_id": 58632014, "link": "https://stackoverflow.com/questions/58632014/generalize-map-and-reduce-lab/58632611#58632611", "title": "generalize map and reduce lab", "body": "<p><strong>How your method <code>map</code> works</strong></p>\n\n<p>To see how your method operates let's modify your code to add some intermediate variables and some <code>puts</code> statements to show the values of those variables.</p>\n\n<pre><code>def map(s)\n  new = []\n  i = 0\n  n = s.length\n  puts \"s has length #{n}\"\n  while i &lt; n\n    puts \"i = #{i}\"\n    e = s[i]\n    puts \"  Yield #{e} to the block\"\n    rv = yield(e)\n    puts \"  The block's return value is #{rv}. Push #{rv} onto new\"\n    new.push(rv)\n    puts \"  new now equals #{new}\"\n    i += 1\n  end\n  puts \"We now return the value of new\"\n  new\nend\n</code></pre>\n\n<p>Now let's execute the method with one of the blocks of interest.</p>\n\n<pre><code>s = [1, 2, 3, -9]\nmap(s) { |n| n * 2 }\n  #=&gt; [2, 4, 6, -18] (return value of method)\n</code></pre>\n\n<p>The following is displayed.</p>\n\n<pre><code>s has length 4\ni = 0\n  Yield 1 to the block\n  The block's return value is 2. Push 2 onto new\n  new now equals [2]\ni = 1\n  Yield 2 to the block\n  The block's return value is 4. Push 4 onto new\n  new now equals [2, 4]\ni = 2\n  Yield 3 to the block\n  The block's return value is 6. Push 6 onto new\n  new now equals [2, 4, 6]\ni = 3\n  Yield -9 to the block\n  The block's return value is -18. Push -18 onto new\n  new now equals [2, 4, 6, -18]\nWe now return the value of new\n</code></pre>\n\n<p>It may by of interest to execute this modified method with different values of <code>s</code> and different blocks.</p>\n\n<p><strong>A replacement for <code>Array#map</code>?</strong></p>\n\n<p>Is this a replacement for <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-map\" rel=\"nofollow noreferrer\">Array#map</a> (or <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\">Enumerable#map</a>, but for now let's just consider <code>Array#map</code>)? As you defined it at the <em>top level</em> your <code>map</code> is an instance method of the class <code>Object</code>:</p>\n\n<pre><code>Object.instance_methods.include?(:map) #=&gt; true\n</code></pre>\n\n<p>It must be invoked <code>map([1,2,3]) { |n| ... }</code> whereas <code>Array#map</code> is invoked <code>[1,2,3].map { |n| ... }</code>. Therefore, for your method <code>map</code> to be a replacement for <code>Array#map</code> you need to define it as follows.</p>\n\n<pre><code>class Array\n  def map\n    new = []\n    i = 0\n    while i &lt; length\n      new.push(yield(self[i]))\n      i += 1\n    end\n    new\n  end\nend\n\n[1, 2, 3, -9].map { |n| n * 2 }\n  #=&gt; [2, 4, 6, -18]\n</code></pre>\n\n<p><strong>Simplify</strong></p>\n\n<p>We can simplify this method as follows.</p>\n\n<pre><code>class Array\n  def map\n    new = []\n    each { |e| new &lt;&lt; yield(e) }\n    new\n  end\nend\n\n[1, 2, 3, -9].map { |n| n * 2 }\n  #=&gt; [2, 4, 6, -18]\n</code></pre>\n\n<p>or, better:</p>\n\n<pre><code>class Array\n  def map\n    each_with_object([]) { |e,new| new &lt;&lt; yield(e) }\n  end\nend\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a>.</p>\n\n<p>Note that <code>while i &lt; length</code> is equivalent to <code>while i &lt; self.length</code>, because <code>self.</code>, if omitted, is implicit, and therefore redundant. Similarly, <code>each { |e| new &lt;&lt; yield(e) }</code> is equivalent to <code>self.each { |e| new &lt;&lt; yield(e) }</code> and <code>each_with_object([]) { ... }</code> is equivalent to <code>self.each_with_object([]) { ... }</code>.</p>\n\n<p><strong>Are we finished?</strong></p>\n\n<p>If we examine the doc <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-map\" rel=\"nofollow noreferrer\">Array#map</a> carefully we see that there are two forms of the method. The first is when <code>map</code> takes a block. Our method <code>Array#map</code> mimics that behaviour and that is the only behaviour needed to satisfy the given <code>rspec</code> tests.</p>\n\n<p>There is a second form, however, where <code>map</code> is not given a block, in which case it returns an enumerator. That allows us to chain the method to another. For example (with Ruby's <code>Array#map</code>),</p>\n\n<pre><code>['cat', 'dog', 'pig'].map.with_index do |animal, i|\n  i.even? ? animal.upcase : animal\nend\n  #=&gt; [\"CAT\", \"dog\", \"PIG\"]\n</code></pre>\n\n<p>We could modify our <code>Array#map</code> to incorporate this second behaviour as follows.</p>\n\n<pre><code>class Array\n  def map\n    if block_given?\n      each_with_object([]) { |e,new| new &lt;&lt; yield(e) }\n    else\n      to_enum(:map)\n    end\n  end\nend\n\n[1, 2, 3, -9].map { |n| n * 2 }\n  #=&gt; [2, 4, 6, -18]\n['cat', 'dog', 'pig'].map.with_index do |animal, i|\n  i.even? ? animal.upcase : animal\nend\n  #=&gt; [\"CAT\", \"dog\", \"PIG\"]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-block_given-3F\" rel=\"nofollow noreferrer\">Kernel#block_given?</a> and <a href=\"https://ruby-doc.org/core-2.6.5/Object.html#method-i-to_enum\" rel=\"nofollow noreferrer\">Object#to_enum</a>.</p>\n\n<p><strong>Notes</strong></p>\n\n<p>You might use, say, <code>arr</code>, rather than <code>s</code> as the variable holding the array, as <code>s</code> often denotes a string, just as <code>h</code> typically denotes a hash. One generally avoids names for  variables and custom methods that are the names of core Ruby methods. That is also an objection to your use of <code>new</code> as a variable name, as there are many core methods named <code>new</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 10327766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80176b97a2e46f08150df67e868bd97e?s=128&d=identicon&r=PG&f=1", "display_name": "Valentine M.", "link": "https://stackoverflow.com/users/10327766/valentine-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 58632611, "answer_count": 1, "score": 0, "last_activity_date": 1572486348, "creation_date": 1572461602, "last_edit_date": 1572469565, "question_id": 58632014, "link": "https://stackoverflow.com/questions/58632014/generalize-map-and-reduce-lab", "title": "generalize map and reduce lab", "body": "<p>I'm working on a lab Using a generalized map method to pass an element and block through returning multiple outcomes.</p>\n\n<p>Really struggled on this one. Found some responses but they don't really make sense to me.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>def map(s)\n  new = []\n  i = 0\n  while i &lt; s.length\n    new.push(yield(s[i]))\n    i += 1\n  end\n  new\nend\n</code></pre>\n\n<p>Here's is the test:</p>\n\n<pre><code>  it \"returns an array with all values made negative\" do\n    expect(map([1, 2, 3, -9]){|n| n * -1}).to eq([-1, -2, -3, 9])\n  end\n\n  it \"returns an array with the original values\" do\n    dune = [\"paul\", \"gurney\", \"vladimir\", \"jessica\", \"chani\"]\n    expect(map(dune){|n| n}).to eq(dune)\n  end\n\n  it \"returns an array with the original values multiplied by 2\" do\n    expect(map([1, 2, 3, -9]){|n| n * 2}).to eq([2, 4, 6, -18])\n  end\n\n  it \"returns an array with the original values squared\" do\n    expect(map([1, 2, 3, -9]){|n| n * n}).to eq([1, 4, 9, 81])\n  end\nend\n</code></pre>\n\n<p>I don't get how the above code can give you these 4 different results.</p>\n\n<p>Could someone help me understand it ?</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["ruby", "tiny-tds"], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1572462186, "creation_date": 1572462186, "answer_id": 58632125, "question_id": 58631735, "link": "https://stackoverflow.com/questions/58631735/ruby-with-ms-sql-to-truncate-all-table-in-a-db/58632125#58632125", "title": "Ruby with MS SQL to truncate all table in a DB", "body": "<p>I believe the issue is that you're trying to run a new execution inside of your <code>out.each</code> block, although the initial <code>out = @client.execute(...)</code> execution hasn't completed.</p>\n\n<p>Here you execute some sql:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>out = @client.execute(\"SELECT TABLE_NAME FROM INFORMATION_SCHEMA....\n</code></pre>\n\n<p>... and then inside of your <code>each</code> loop you're trying to execute again:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@client.execute(\"TRUNCATE TABLE #{x['TABLE_NAME']}\")\n</code></pre>\n\n<p>... before your initial <code>out</code> execution has been completed using <code>out.do</code> as you suggested.</p>\n"}], "owner": {"reputation": 444, "user_id": 9115319, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4e2d89c784b2c575c1ba83f8c2a1d5e7?s=128&d=identicon&r=PG&f=1", "display_name": "Dot Net Dev", "link": "https://stackoverflow.com/users/9115319/dot-net-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572462186, "creation_date": 1572460380, "question_id": 58631735, "link": "https://stackoverflow.com/questions/58631735/ruby-with-ms-sql-to-truncate-all-table-in-a-db", "title": "Ruby with MS SQL to truncate all table in a DB", "body": "<p>I am using ruby and tiny_tds (ms sql). I want to truncate all the tables in a database.</p>\n\n<p>below is what I have now: </p>\n\n<pre><code>require 'tiny_tds'\n@client = TinyTds::Client.new(username: 'sa', database: 'test123', password: 'Auto1', host: 'localhost', port: 1433)\nputs 'Connecting to SQL Server'\n\nif @client.active? == true then puts 'Done' end\n\nout = @client.execute(\"SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE' AND TABLE_CATALOG='test123'\");\n#@client.do\n#puts \"out ==&gt; #{out}\"\nout.each do |x|\n        puts \"tabname1 ==&gt; #{x['TABLE_NAME']}\"\n        next if x['TABLE_NAME'] =~ /api_user|version_info/\n        @client.execute(\"TRUNCATE TABLE #{x['TABLE_NAME']}\")\n        @client.do\nend\n@client.close\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ ruby mssql.rb\nConnecting to SQL Server\nDone\ntabname1 ==&gt; test\nmssql.rb:14:in `execute': Attempt to initiate a new Adaptive Server operation with results pending (TinyTds::Error)\n    from mssql.rb:14:in `block in &lt;main&gt;'\n    from mssql.rb:10:in `each'\n    from mssql.rb:10:in `&lt;main&gt;'\n</code></pre>\n\n<p>I know we need to use <code>do</code> [<code>@client.execute(sql).do</code>]. but still getting the error</p>\n\n<p><strong>Update:</strong> </p>\n\n<p>tables in test123 db</p>\n\n<p>test, \ntest1</p>\n"}, {"tags": ["ruby", "jekyll", "liquid"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 8062316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/844cdb76e5b5ab4984ac0abd5525141a?s=128&d=identicon&r=PG&f=1", "display_name": "Kingle", "link": "https://stackoverflow.com/users/8062316/kingle"}, "edited": false, "score": 0, "creation_date": 1572479964, "post_id": 58634044, "comment_id": 103577186, "body": "Thank you, this works. But can you tell me why <code>{{ category | | last | size}}</code> has two <code>|</code>?"}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "reply_to_user": {"reputation": 301, "user_id": 8062316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/844cdb76e5b5ab4984ac0abd5525141a?s=128&d=identicon&r=PG&f=1", "display_name": "Kingle", "link": "https://stackoverflow.com/users/8062316/kingle"}, "edited": false, "score": 0, "creation_date": 1572482794, "post_id": 58634044, "comment_id": 103577794, "body": "Whoops! That&#39;s totally a typo :-) Good catch. Answer updated."}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1572482804, "last_edit_date": 1572482804, "creation_date": 1572471699, "answer_id": 58634044, "question_id": 58631388, "link": "https://stackoverflow.com/questions/58631388/how-do-i-create-a-loop-that-display-each-category-and-its-post-count/58634044#58634044", "title": "How do I create a loop that display each category and its post count?", "body": "<p>From the <a href=\"https://shopify.github.io/liquid/filters/size\" rel=\"nofollow noreferrer\">Liquid docs for the <em>size</em> filter</a>:</p>\n\n<blockquote>\n  <p>Size: Returns the number of characters in a string or the number of items in an array.</p>\n</blockquote>\n\n<p>Here's a full listing of the <a href=\"https://jekyllrb.com/docs/variables\" rel=\"nofollow noreferrer\">available vars using Jekyll</a>, including <code>site.categories</code>.</p>\n\n<p>Instead of calling <code>size</code> on your <code>category</code> var itself, you need to call it on the last argument, which is where the array of posts are hiding:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;h2&gt;Post Categories&lt;/h2&gt;\n&lt;nav&gt;\n  {% for category in site.categories %}\n    &lt;h3&gt;&lt;a href=\"/{{ category | first }}\"&gt;{{ category | first }}&lt;/a&gt; ({{ category | last | size }})&lt;/h3&gt;\n  {% endfor %}\n&lt;/nav&gt;\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 8062316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/844cdb76e5b5ab4984ac0abd5525141a?s=128&d=identicon&r=PG&f=1", "display_name": "Kingle", "link": "https://stackoverflow.com/users/8062316/kingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58634044, "answer_count": 1, "score": 1, "last_activity_date": 1572482804, "creation_date": 1572458935, "last_edit_date": 1572463915, "question_id": 58631388, "link": "https://stackoverflow.com/questions/58631388/how-do-i-create-a-loop-that-display-each-category-and-its-post-count", "title": "How do I create a loop that display each category and its post count?", "body": "<p>I have a blog that I built with Jekyll. On the side bar I want to include a <code>nav</code> bar that list each category along with total number of posts for each. This is what I have right now:</p>\n\n<pre><code>&lt;h2&gt;Post Categories&lt;/h2&gt;\n&lt;nav&gt;\n  {% for category in site.categories %}\n    &lt;h3&gt;&lt;a href=\"/{{ category }}\"&gt;{{ category }}&lt;/a&gt; ({{ category | size }})&lt;/h3&gt;\n  {% endfor %}\n&lt;/nav&gt;\n</code></pre>\n\n<p>I'm not on my computer that has Ruby and Jekyll installed so I can't build the site locally. But is this something that will work?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-sdk", "pre-signed-url"], "comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1572459321, "post_id": 58630541, "comment_id": 103569996, "body": "I don&#39;t know Ruby but what if you create your bucket object using: aws_bucket = client.bucket(public_bucket_name) and then request the pre-signed URL?"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 1, "creation_date": 1572465979, "post_id": 58630541, "comment_id": 103572806, "body": "Pre-signed <code>POST</code> does not put anything in the URL other than the path, which is always <code>&#47;</code>.  Everything is in the form body."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1572468217, "post_id": 58630541, "comment_id": 103573692, "body": "can you have a look at the params that are sent with the post request? The SDK should be populating the headers with the pertinent values."}, {"owner": {"reputation": 31, "user_id": 7592630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owHE9-Yg8AI/AAAAAAAAAAI/AAAAAAAAFv0/TbjmRVw1xXc/photo.jpg?sz=128", "display_name": "abigail mcphillips", "link": "https://stackoverflow.com/users/7592630/abigail-mcphillips"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1572469183, "post_id": 58630541, "comment_id": 103574112, "body": "Ahh thanks @Michael-sqlbot, I think I was confusing it with a <code>PUT</code>. The thing is, the <code>fields</code> the pre-signed post is returning only include three things: <code>Expires</code>, <code>acl</code> and <code>key</code> - there&#39;s no policy, signature or access key. If I just pass these three things in as form data, I get an access denied error."}, {"owner": {"reputation": 31, "user_id": 7592630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owHE9-Yg8AI/AAAAAAAAAAI/AAAAAAAAFv0/TbjmRVw1xXc/photo.jpg?sz=128", "display_name": "abigail mcphillips", "link": "https://stackoverflow.com/users/7592630/abigail-mcphillips"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1572469550, "post_id": 58630541, "comment_id": 103574274, "body": "@BKSpurgeon - I&#39;ve added some extra information in my original post!"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1572470113, "post_id": 58630541, "comment_id": 103574465, "body": "are you able to do a <code>hello world</code> post request using the AWS SDK WITHOUT using the form constructed by the react app? The post request sent by the AWS SDK will have all the relevant tokens / keys added in the request headers, which you may not be porting over into the form you are creating in your native react app. the form you are creating in your react app will need those keys. You will have to pass them in to your react app as a &quot;flag&quot; not sure what you would call it in react, but in elm, they are called &quot;flags&quot;."}, {"owner": {"reputation": 31, "user_id": 7592630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owHE9-Yg8AI/AAAAAAAAAAI/AAAAAAAAFv0/TbjmRVw1xXc/photo.jpg?sz=128", "display_name": "abigail mcphillips", "link": "https://stackoverflow.com/users/7592630/abigail-mcphillips"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1572471232, "post_id": 58630541, "comment_id": 103574845, "body": "@jarmod I&#39;ve tried creating the bucket directly on the resource a la <a href=\"https://docs.aws.amazon.com/code-samples/latest/catalog/ruby-s3-upload_object_presigned_url.rb.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/code-samples/latest/catalog/&hellip;</a>, but still no luck."}, {"owner": {"reputation": 31, "user_id": 7592630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owHE9-Yg8AI/AAAAAAAAAAI/AAAAAAAAFv0/TbjmRVw1xXc/photo.jpg?sz=128", "display_name": "abigail mcphillips", "link": "https://stackoverflow.com/users/7592630/abigail-mcphillips"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1572471273, "post_id": 58630541, "comment_id": 103574855, "body": "@BKSpurgeon good idea - I&#39;ll give this a go, thanks!"}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1572485364, "post_id": 58630541, "comment_id": 103578302, "body": "@abigailmcphillips I would suggest to start even simpler: get a simple GET request working. Then add on the compexity of a simple post request."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7592630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owHE9-Yg8AI/AAAAAAAAAAI/AAAAAAAAFv0/TbjmRVw1xXc/photo.jpg?sz=128", "display_name": "abigail mcphillips", "link": "https://stackoverflow.com/users/7592630/abigail-mcphillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1572529681, "creation_date": 1572529681, "answer_id": 58644756, "question_id": 58630541, "link": "https://stackoverflow.com/questions/58630541/generated-aws-presignedpost-does-not-include-correct-url-fields/58644756#58644756", "title": "Generated AWS PresignedPost does not include correct url / fields", "body": "<p>So I finally got this working by creating the presigned post like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Aws::S3::PresignedPost.new(\n  public_bucket_credentials,\n  public_bucket_region,\n  public_bucket_name,\n  {\n    key: 'some-random-key',\n    acl: 'public-read',\n    expires: Time.zone.now + 5.minutes\n  }\n)\n</code></pre>\n\n<p>Then everything I needed (access key, signature and policy) is returned in the <code>fields</code> key of the returned presigned post. No change needed to the React code.</p>\n\n<p>Looks like the way I was setting up the client and then creating a bucket was not passing through the credentials needed to create a workable presigned post (I'm not really sure why AWS should allow this to happen...).</p>\n\n<p>Anyway, it's working now! Thanks to everyone for their help.</p>\n"}], "owner": {"reputation": 31, "user_id": 7592630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owHE9-Yg8AI/AAAAAAAAAAI/AAAAAAAAFv0/TbjmRVw1xXc/photo.jpg?sz=128", "display_name": "abigail mcphillips", "link": "https://stackoverflow.com/users/7592630/abigail-mcphillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572529712, "creation_date": 1572455407, "last_edit_date": 1572529712, "question_id": 58630541, "link": "https://stackoverflow.com/questions/58630541/generated-aws-presignedpost-does-not-include-correct-url-fields", "title": "Generated AWS PresignedPost does not include correct url / fields", "body": "<p>I am attempting to upload a file to an AWS S3 bucket via a presigned post.</p>\n\n<p>When I generate a <code>PresignedPost</code> on the server using the AWS SDK for Ruby (Version 3), I do not receive back the correct url and fields for the client to make a successful POST request.</p>\n\n<p>Generating the <code>PresignedPost</code> in ruby:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>client = Aws::S3::Client.new(\n  region: public_bucket_region,\n  credentials: public_bucket_credentials\n)\n\naws_bucket = Aws::S3::Bucket.new(\n  public_bucket_name,\n  client: client\n)\n\nrequest = aws_bucket.presigned_post(\n  key: 'some-random-key',\n  acl: 'public-read',\n  expires: Time.zone.now + 5.minutes\n)\n\nputs request.url\n=&gt; \"https://bucket-name.s3.eu-west-1.amazonaws.com\"\n\nputs request.fields\n=&gt;\n{\n  Expires: \"Wed, 30 Oct 2019 16:53:01 GMT\",\n  acl: \"public-read\",\n  key: 'some-random-key'\n}\n</code></pre>\n\n<p>As per the documentation, all I should have to do at this point is make a POST request to the returned URL, including the field data in the body.</p>\n\n<p>However, this is clearly not enough, I get an access denied error message. I expected the URL to contain the access key id, signature, policy etc?</p>\n\n<p>What am I missing?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>The <code>POST</code> request is being constructed as such (in a React Native app), I realise I need some extra things in the body / headers but my presigned post doesn't seem to be returning anything useful in <code>request.fields</code>:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const body = new FormData();\nObject.entries(request.fields).forEach(([k, v]) =&gt; {\n  body.append(k, v);\n});\nbody.append('file', file);\n\nawait fetch(request.url, {\n  method: 'post',\n  body: body\n});\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1572455315, "post_id": 58630464, "comment_id": 103568175, "body": "You should probably show the definition that&#39;s returning <code>nil</code>; it&#39;s exceedingly likely that that&#39;s where the issue lies."}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1572456349, "post_id": 58630464, "comment_id": 103568642, "body": "@coreyward - added my controller and helper file methods. Hope this is what you were asking for."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 4, "creation_date": 1572458484, "post_id": 58630464, "comment_id": 103569615, "body": "you are returning <code>sorted_results</code> but this only gets set when there is no <code>sort_column</code> present change <code>sorted_leads</code> to <code>sorted_results</code>"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1572458767, "post_id": 58630464, "comment_id": 103569748, "body": "How embarrassing... :/ Thanks @engineersmnky"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1572462855, "post_id": 58630464, "comment_id": 103571512, "body": "Why are you sorting the data in the method called <code>fetch_data</code> It looks like this method is doing to much. I would advise moving the logic related to sorting to a separate method."}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572456312, "creation_date": 1572455153, "last_edit_date": 1572456312, "question_id": 58630464, "link": "https://stackoverflow.com/questions/58630464/rails-console-vs-module", "title": "Rails console vs module", "body": "<p>I have an array of hashes (<code>data</code>)</p>\n\n<pre><code>sort_column = \"Me.You.Them\"\n</code></pre>\n\n<p>I need to sort the array by the <code>sort_column</code>.\nWhen I do <code>data.sort_by { |h| h.dig(sort_column.split('.').map(&amp;:to_s))}</code> in the rails console, I get the data returned sorted, but when I place the exact same method in my helper module, it returns nil.</p>\n\n<p>Anyone knows why? </p>\n\n<p>Here are my methods:</p>\n\n<p>My helper file:</p>\n\n<pre><code>module DatatablesHelper\n    def fetch_data(data, sort_column, sort_direction)\n        if sort_column.present? \n            if sort_direction == \"desc\"\n                sorted_leads = data.sort_by { |h| h.dig(sort_column.split('.').map(&amp;:to_s))}\n            else\n                sorted_leads = data.sort_by { |h| -h.dig(sort_column.split('.').map(&amp;:to_s))}\n            end\n        else\n            sorted_results = data\n        end\n        return sorted_results\n    end\nend\n</code></pre>\n\n<p>My controller and action</p>\n\n<pre><code>class DataController &lt; ApplicationController\n    include DatatablesHelper\n    def get_data\n        data = [\n            {},\n            {}\n        ] # Here imagine we have a large array of hashes returned from an api\n        sort_column = params['order'][\"0\"] # =&gt; \"Me.You.Them\"\n        final = fetch_data(data, sort_column, \"desc\")\n        render json: {\n            recordsTotal: data.count,\n            recordsFiltered: final.count,\n            data: final\n        }\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "inheritance"], "answers": [{"comments": [{"owner": {"reputation": 835, "user_id": 3416381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6V4dL.jpg?s=128&g=1", "display_name": "madevident", "link": "https://stackoverflow.com/users/3416381/madevident"}, "edited": false, "score": 0, "creation_date": 1572460921, "post_id": 58630122, "comment_id": 103570743, "body": "Thanks - I decided to use your final suggestion and simply check to see whether <code>self</code> is the parent class, and raise an error if it is."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1572461477, "post_id": 58630122, "comment_id": 103570974, "body": "Another option would be to use the <code>Class#inherited</code> hook to add that method to the inheriting classes only and then the method would not exist for <code>Building</code> at all. Sidenote: this would also allow accumulation of subclasses and avoid ObjectSpace all together which as the application grows will result in slower and slower looping"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1572454160, "last_edit_date": 1572454160, "creation_date": 1572453844, "answer_id": 58630122, "question_id": 58630039, "link": "https://stackoverflow.com/questions/58630039/can-i-make-a-parent-class-methods-private-but-allow-them-to-be-called-by-their/58630122#58630122", "title": "Can I make a parent class methods private, but allow them to be called by their child classes via inheritance only?", "body": "<blockquote>\n  <p>Why doesn't private work in this case?</p>\n</blockquote>\n\n<p>Because <code>private</code> affects only instance methods, not class methods. I normally use <code>private_class_method</code> for this</p>\n\n<pre><code>  private_class_method def self.subclasses\n    # list all subclasses\n    ObjectSpace.each_object(Class).select { |c| c &lt; self }\n  end\n</code></pre>\n\n<p>Alternatively, you can define this method in a singleton class where it will be an instance method.</p>\n\n<pre><code>class &lt;&lt; self\n  private\n\n  def subclasses\n    # list all subclasses\n    ObjectSpace.each_object(Class).select { |c| c &lt; self }\n  end\nend\n</code></pre>\n\n<p>Note that the privateness is inherited and you won't be able to call the method on <code>House</code> either. I would leave the method public and raise from it if <code>self</code> is <code>Building</code></p>\n\n<pre><code>  def self.subclasses\n    raise 'use a subclass' if self == Building\n\n    # list all subclasses\n    ObjectSpace.each_object(Class).select { |c| c &lt; self }\n  end\n</code></pre>\n"}], "owner": {"reputation": 835, "user_id": 3416381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6V4dL.jpg?s=128&g=1", "display_name": "madevident", "link": "https://stackoverflow.com/users/3416381/madevident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58630122, "answer_count": 1, "score": 0, "last_activity_date": 1572454160, "creation_date": 1572453520, "last_edit_date": 1572453875, "question_id": 58630039, "link": "https://stackoverflow.com/questions/58630039/can-i-make-a-parent-class-methods-private-but-allow-them-to-be-called-by-their", "title": "Can I make a parent class methods private, but allow them to be called by their child classes via inheritance only?", "body": "<p>Let's say I have a three-level inheritance class hierarchy:</p>\n\n<pre><code>Building\n  \u2b11 OfficeTower\n  \u2b11 House\n    \u2b11 RowHouse\n    \u2b11 DetachedHouse\n</code></pre>\n\n<p>I want the <code>OfficeTower</code> and <code>House</code> classes to inherit a class method from the <code>Building</code> class, which will list all child classes. I want to define this method only once, in the <code>Building</code> class, but I <strong>don't actually want the method to be publicly available</strong> if called <strong>directly</strong> from the <code>Building</code> class.</p>\n\n<p>Here's what I tried:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Building\n\n  private\n\n  def self.subclasses\n    # list all subclasses\n    ObjectSpace.each_object(Class).select { |c| c &lt; self }\n  end\n\nend\n\nclass OfficeTower &lt; Building\nend\n\nclass House &lt; Building\nend\n\nclass RowHouse &lt; House\nend\n\nclass DetachedHouse &lt; House\nend\n</code></pre>\n\n<p>The <code>subclasses</code> class method works as expected when called on a child class of <code>Building</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>House.subclasses\n=&gt; [DetachedHouse, RowHouse] # This is good.\n</code></pre>\n\n<p>I was expecting the <code>subclasses</code> method to raise a <code>NoMethodError</code> when called directly from the <code>Building</code> class. But that didn't happen:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Building.subclasses  \n=&gt; [DetachedHouse, OfficeTower, RowHouse, House] # I expected NoMethodError!\n</code></pre>\n\n<p>Why doesn't <code>private</code> work in this case? Is there a better way to make this method unavailable when called directly from the <code>Building</code> class? Should I use composition instead of inheritance here (ie make a <code>Buildable</code> module with the <code>subclasses</code> class method, and include that module in <code>OfficeTower</code> and <code>House</code>)? This feels messier to me...</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 11247828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2854121988147353/picture?type=large", "display_name": "Too Colline", "link": "https://stackoverflow.com/users/11247828/too-colline"}, "edited": false, "score": 0, "creation_date": 1572452853, "post_id": 58629826, "comment_id": 103566894, "body": "Yeah, while that is true, I know that <code>super</code> is actually a keyword and not a method, but the usage is the same nevertheless."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 40, "user_id": 11247828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2854121988147353/picture?type=large", "display_name": "Too Colline", "link": "https://stackoverflow.com/users/11247828/too-colline"}, "edited": false, "score": 0, "creation_date": 1572452907, "post_id": 58629826, "comment_id": 103566920, "body": "I&#39;m trying to find a link to the current documentation, but <a href=\"https://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-super\" rel=\"nofollow noreferrer\">this older version</a> explains. It&#39;s an exception to the usual rule."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1572455689, "post_id": 58629826, "comment_id": 103568350, "body": "@tadman You can find the <code>super</code> keyword documented at the bottom of <a href=\"https://ruby-doc.org/core-2.6.5/doc/syntax/modules_and_classes_rdoc.html#label-Inheritance\" rel=\"nofollow noreferrer\">this</a> chapter."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1572456640, "post_id": 58629826, "comment_id": 103568795, "body": "@3limin4t0r Thanks. Updated the answer with that link."}, {"owner": {"reputation": 40, "user_id": 11247828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2854121988147353/picture?type=large", "display_name": "Too Colline", "link": "https://stackoverflow.com/users/11247828/too-colline"}, "edited": false, "score": 1, "creation_date": 1572464896, "post_id": 58629826, "comment_id": 103572376, "body": "Very helpful too, understood."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1572466201, "last_edit_date": 1572466201, "creation_date": 1572452657, "answer_id": 58629826, "question_id": 58629788, "link": "https://stackoverflow.com/questions/58629788/method-call-without-parenthesis-doesnt-forward-all-arguments-while-with-parenth/58629826#58629826", "title": "method call without parenthesis doesn&#39;t forward all arguments while with parenthesis it initializes without any arguments", "body": "<p>Normally this is true, but <code>super</code> is special because it's not so much a method as it is <a href=\"https://ruby-doc.org/core-2.6.5/doc/syntax/modules_and_classes_rdoc.html#label-Inheritance\" rel=\"nofollow noreferrer\">also a Ruby keyword with special properties</a>.</p>\n\n<p>There's several forms at work here:</p>\n\n<ul>\n<li><code>super</code> means \"call the parent's method <em>with the same arguments this method was given</em>\".</li>\n<li><code>super()</code> means \"call the parent's method with <em>no arguments</em>\".</li>\n<li><code>super a, b</code> and <code>super(a, b)</code> both mean \"call the parent's method with <em>specific arguments</em>\".</li>\n</ul>\n\n<p>I'm not aware of any other method calls in Ruby that spontaneously send arguments that aren't specified, but <code>super</code>, by virtue of being a keyword, does look like this.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1572459626, "last_edit_date": 1572459626, "creation_date": 1572459004, "answer_id": 58631403, "question_id": 58629788, "link": "https://stackoverflow.com/questions/58629788/method-call-without-parenthesis-doesnt-forward-all-arguments-while-with-parenth/58631403#58631403", "title": "method call without parenthesis doesn&#39;t forward all arguments while with parenthesis it initializes without any arguments", "body": "<blockquote>\n  <p>I know for a fact that in Ruby, parenthesis for method calls are optional.</p>\n</blockquote>\n\n<p>That is true.</p>\n\n<blockquote>\n  <p>I need to understand why sometimes when a method call is made with parenthesis to initialize a base class, for instance, it doesn't forward all arguments while without parenthesis it does.</p>\n</blockquote>\n\n<p>Let's look at this again, this time I have emphasized the important bit in <strong>bold</strong>:</p>\n\n<blockquote>\n  <p>I need to understand why sometimes when <strong>a method call</strong> is made with parenthesis to initialize a base class, for instance, it doesn't forward all arguments while without parenthesis it does.</p>\n</blockquote>\n\n<p>Simple: it's <strong>not a method call</strong>. The <code>super</code> keyword is not a method, it is <a href=\"https://ruby-doc.org/core/doc/keywords_rdoc.html\" rel=\"nofollow noreferrer\">a keyword</a>, just like <code>class</code>, <code>module</code>, <code>if</code>, <code>unless</code>, <code>while</code>, <code>until</code>, <code>for</code>, <code>case</code>, <code>rescue</code>, <code>yield</code>, <code>in</code>, <code>then</code>, <code>when</code>, <code>do</code>, <code>ensure</code>, <code>else</code>, <code>begin</code>, <code>do</code>, <code>end</code>, etc.</p>\n\n<p>Since it's not a method call, there is no reason for it to follow the rules of a method call. It follows the rules of a <a href=\"https://ruby-doc.org/core/doc/syntax/modules_and_classes_rdoc.html#label-Inheritance\" rel=\"nofollow noreferrer\"><em><code>super</code> expression</em></a>.</p>\n\n<p>In particular, you can find the rules for the <em><code>super</code> expression</em> in Section 11.3.4 <em>The <code>super</code> expression</em> of <a href=\"https://iso.org/standard/59579.html\" rel=\"nofollow noreferrer\">the ISO Ruby Language Specification</a>, specifically clauses b) 1) i)-iv) of the <em>Semantics</em> subsection:</p>\n\n<blockquote>\n  <ul>\n  <li>b) Let <em>A</em> be an empty list. Let <em>B</em> be the top of \u27e6block\u27e7.\n  \n  <ul>\n  <li>1) If the <em>super-expression</em> is a <em>super-with-optional-argument</em>, and neither the <em>argument-with-parentheses</em> nor the <em>block</em> is present, construct a list of arguments as follows:\n  \n  <ul>\n  <li>i) Let <em>M</em> be the method which corresponds to the current method invocation. Let <em>L</em> be the <em>parameter-list</em> of the <em>method-parameter-part</em> of <em>M</em>. Let <em>S</em> be the set of local variable bindings in \u27e6local-variable-bindings\u27e7 which corresponds to the current method invocation.</li>\n  <li>ii) If the <em>mandatory-parameter-list</em> is present in <em>L</em>, for each <em>mandatory-parameter</em> <em>p</em>, take the following steps:\n  \n  <ul>\n  <li>I) Let <em>v</em> be the value of the binding with name <em>p</em> in <em>S</em>.</li>\n  <li>II) Append <em>v</em> to <em>A</em>.</li>\n  </ul></li>\n  <li>iii) If the <em>optional-parameter-list</em> is present in <em>L</em>, for each <em>optional-parameter</em> <em>p</em>, take the following steps:\n  \n  <ul>\n  <li>I) Let <em>n</em> be the <em>optional-parameter-name</em> of <em>p</em>.</li>\n  <li>II) Let <em>v</em> be the value of the binding with name <em>n</em> in <em>S</em>.</li>\n  <li>III) Append <em>v</em> to <em>A</em>.</li>\n  </ul></li>\n  <li>iv) If the <em>array-parameter</em> is present in <em>L</em>:\n  \n  <ul>\n  <li>I) Let <em>n</em> be the <em>array-parameter-name</em> of the <em>array-parameter</em>.</li>\n  <li>II) Let <em>v</em> be the value of the binding with name <em>n</em> in <em>S</em>. Append each element of <em>v</em>, in the indexing order, to <em>A</em>.</li>\n  </ul></li>\n  </ul></li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>As you can see, <code>super</code> without an argument list means \"pass the argument list of the original call\". Whereas <code>super</code> <em>with</em> an argument list means \"pass exactly this argument list\". This second case is described in b) 2)-4), which I will not quote here, since it pretty much says what you expect it would say.</p>\n\n<p>You can also find some information in the <a href=\"https://github.com/ruby/spec/\" rel=\"nofollow noreferrer\">ruby/spec project</a>, under <a href=\"https://github.com/ruby/spec/blob/master/language/super_spec.rb#L227-L277\" rel=\"nofollow noreferrer\"><code>language/super_spec.rb</code></a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>it \"without explicit arguments can accept a block but still pass the original arguments\" do\n  SuperSpecs::ZSuperWithBlock::B.new.a.should == 14\nend\n\nit \"passes along block via reference to method expecting a reference\" do\n  SuperSpecs::ZSuperWithBlock::B.new.b.should == [14, 15]\nend\n\nit \"passes along a block via reference to a method that yields\" do\n  SuperSpecs::ZSuperWithBlock::B.new.c.should == 16\nend\n\nit \"without explicit arguments passes optional arguments that have a default value\" do\n  SuperSpecs::ZSuperWithOptional::B.new.m(1, 2).should == 14\nend\n\nit \"without explicit arguments passes optional arguments that have a non-default value\" do\n  SuperSpecs::ZSuperWithOptional::B.new.m(1, 2, 3).should == 3\nend\n\nit \"without explicit arguments passes optional arguments that have a default value but were modified\" do\n  SuperSpecs::ZSuperWithOptional::C.new.m(1, 2).should == 100\nend\n\nit \"without explicit arguments passes optional arguments that have a non-default value but were modified\" do\n  SuperSpecs::ZSuperWithOptional::C.new.m(1, 2, 3).should == 100\nend\n\nit \"without explicit arguments passes rest arguments\" do\n  SuperSpecs::ZSuperWithRest::B.new.m(1, 2, 3).should == [1, 2, 3]\nend\n\nit \"without explicit arguments passes rest arguments including any modifications\" do\n  SuperSpecs::ZSuperWithRest::B.new.m_modified(1, 2, 3).should == [1, 14, 3]\nend\n\nit \"without explicit arguments passes arguments and rest arguments\" do\n  SuperSpecs::ZSuperWithRestAndOthers::B.new.m(1, 2, 3, 4, 5).should == [3, 4, 5]\nend\n\nit \"without explicit arguments passes arguments and rest arguments including any modifications\" do\n  SuperSpecs::ZSuperWithRestAndOthers::B.new.m_modified(1, 2, 3, 4, 5).should == [3, 14, 5]\nend\n\nit \"without explicit arguments that are '_'\" do\n  SuperSpecs::ZSuperWithUnderscores::B.new.m(1, 2).should == [1, 2]\nend\n\nit \"without explicit arguments that are '_' including any modifications\" do\n  SuperSpecs::ZSuperWithUnderscores::B.new.m_modified(1, 2).should == [14, 2]\nend\n</code></pre>\n"}], "owner": {"reputation": 40, "user_id": 11247828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2854121988147353/picture?type=large", "display_name": "Too Colline", "link": "https://stackoverflow.com/users/11247828/too-colline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58631403, "answer_count": 2, "score": 0, "last_activity_date": 1572466201, "creation_date": 1572452506, "last_edit_date": 1572455320, "question_id": 58629788, "link": "https://stackoverflow.com/questions/58629788/method-call-without-parenthesis-doesnt-forward-all-arguments-while-with-parenth", "title": "method call without parenthesis doesn&#39;t forward all arguments while with parenthesis it initializes without any arguments", "body": "<p>I know for a fact that in Ruby, parenthesis for method calls are optional. I need to understand why sometimes when a method call is made with parenthesis to initialize a base class, for instance, it doesn't forward all arguments while without parenthesis it does.</p>\n\n<p>An instance is described below:</p>\n\n<pre><code>[1] irb(main)&gt; class Account\n[1] irb(main)*   def initialize(*args)\n[1] irb(main)*     pp(args)\n[1] irb(main)*   end\n[1] irb(main)* end\n=&gt; :initialize\n[2] irb(main)&gt; class User &lt; Account\n[2] irb(main)*   def initialize(a, b)\n[2] irb(main)*     super()\n[2] irb(main)*   end\n[2] irb(main)* end\n=&gt; :initialize\n[3] irb(main)&gt; class Guest &lt; Account\n[3] irb(main)*   def initialize(a, b)\n[3] irb(main)*     super\n[3] irb(main)*   end\n[3] irb(main)* end\n=&gt; :initialize\n[4] irb(main)&gt; User.new(1, 2)\n[]\n[5] irb(main)&gt; Guest.new(1, 2)\n[1, 2]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1572455257, "post_id": 58629482, "comment_id": 103568139, "body": "Can you show what you have tried? This question is confusing to me."}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "edited": false, "score": 0, "creation_date": 1572460744, "post_id": 58629482, "comment_id": 103570663, "body": "You will need to query books and include the author and written associated. then you will need to loop to structure your output the way you want above or using your serializer...hope this gives you some hints."}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1572465981, "last_edit_date": 1572465981, "creation_date": 1572465664, "answer_id": 58632816, "question_id": 58629482, "link": "https://stackoverflow.com/questions/58629482/is-there-a-way-to-add-an-extra-value-not-in-db-model-to-an-existent-model-and/58632816#58632816", "title": "Is there a way to add an extra value (not in db model) to an existent model and return its?", "body": "<p>I'm guessing what you are trying to do is setup a many to many assocation beween books and authors and then create a nested route. Which is actually a pretty mundane thing.</p>\n\n<pre><code>class Book &lt; ApplicationRecord\n  has_many :authorships\n  has_many :authors, through: :authorships\nend\n\nclass Author &lt; ApplicationRecord\n  has_many :authorships\n  has_many :authors, through: :authorships\nend\n\n# \"Written\" is a lousy name for a model since its not a noun\nclass Authorship &lt; ApplicationRecord\n  belongs_to :book\n  belongs_to :author\nend\n</code></pre>\n\n<p>Using m-2-m is a pretty solid choice since it lets you handle multiple authors. </p>\n\n<p>You can then setup a nested route:</p>\n\n<pre><code>resources :authors do\n  resources :books, module: :authors, only: [:index]\nend\n</code></pre>\n\n<p>And a controller that will respond to <code>/authors/:author_id/books</code>.</p>\n\n<pre><code>module Authors\n  class BooksController &lt; ApplicationController\n    before_action :set_author\n\n    # GET /authors/1/books\n    # GET /authors/1/books.json\n    def index\n      @books = @author.books\n      render json: @books\n    end\n\n    private\n    def set_author\n       @author = Author.includes(:books)\n                       .find(params[:author_id])\n    end\n  end\nend\n</code></pre>\n\n<p>The reason I'm using <code>module: :authors</code> is that it lets you create seperate controllers for the nested and unnested representations of the resource (<code>/books</code>) without a bunch of code branches in the controller.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 12083607, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDGhYeghHc6w0w3sKZ740mCcQypYOfj7Vn0Tt8a9w=k-s128", "display_name": "Akshay batra", "link": "https://stackoverflow.com/users/12083607/akshay-batra"}, "is_accepted": false, "score": 0, "last_activity_date": 1572507042, "creation_date": 1572507042, "answer_id": 58638635, "question_id": 58629482, "link": "https://stackoverflow.com/questions/58629482/is-there-a-way-to-add-an-extra-value-not-in-db-model-to-an-existent-model-and/58638635#58638635", "title": "Is there a way to add an extra value (not in db model) to an existent model and return its?", "body": "<p><strong>As per my understanding,</strong></p>\n\n<p>You have 3 models - Book (title), Author (name) and Written (author_id,book_id).</p>\n\n<p>When you do \nbook = Book.first</p>\n\n<p>author = book.author (as book belongs to author)</p>\n\n<p>***`</p>\n\n<blockquote>\n  <p>other_books = author.books.map(&amp;:id) - book.id</p>\n</blockquote>\n\n<p>`***</p>\n\n<p>(You can get other books by getting all book ids of that particular author, and then subtracting the particular book id from that.</p>\n"}], "owner": {"reputation": 23, "user_id": 3066435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1yCDR.jpg?s=128&g=1", "display_name": "Finn", "link": "https://stackoverflow.com/users/3066435/finn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572507042, "creation_date": 1572451477, "last_edit_date": 1572451688, "question_id": 58629482, "link": "https://stackoverflow.com/questions/58629482/is-there-a-way-to-add-an-extra-value-not-in-db-model-to-an-existent-model-and", "title": "Is there a way to add an extra value (not in db model) to an existent model and return its?", "body": "<p>I have 3 models - Book (title), Author (name) and Written (author_id,book_id).</p>\n\n<p>My foreign-key works perfectly.</p>\n\n<p>I want, for a strange case, when GETS all books with the http_get call, the list of other books written by same author. I explain with an example:</p>\n\n<pre><code>BOOK = &lt;1: \"LOTR - The Fellowship of the Ring\"&gt; ; &lt;2: \"LOTR - The Two Towers&gt; ; &lt;3: \"HARRY POTTER - The Philosopher's Stone&gt; ; &lt;4: \"LOTR - The Return of the king\"&gt; ; &lt;5: \"HARRY POTTER - The Chamber of Secrets\"&gt;.\n\nAUTHOR = &lt;1: \"Tolkien\"&gt; ; &lt;2: \"Rowling\"&gt;.\n\nWRITTEN = &lt;1: 1,1&gt; ; &lt;2: 1,2&gt; ; &lt;3: 1,4&gt; ; &lt;4: 2,3&gt; ; &lt;5: 2,5&gt;\n</code></pre>\n\n<p>Fine! When I do my GET_REQUEST for all books, I want obtain :</p>\n\n<pre><code>{\n\"id\":\"1\",\n\"title\":\"LOTR-The Fellowship of the Ring\",\n\"author-id\":\"1\",\n\"other-books\":\"[2,4]\"\n},\n\n{\n\"id\":\"2\",\n\"title\":\"LOTR-The Two Towers\",\n\"author-id\":\"1\",\n\"other-books\":\"[1,4]\"\n},\n</code></pre>\n\n<p>and so on..</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "liquid"], "comments": [{"owner": {"reputation": 391, "user_id": 7049314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quFSU.jpg?s=128&g=1", "display_name": "Adam Hollett", "link": "https://stackoverflow.com/users/7049314/adam-hollett"}, "edited": false, "score": 0, "creation_date": 1572458743, "post_id": 58628805, "comment_id": 103569736, "body": "Hi there! What version of Liquid is your app using? I see you&#39;ve also tagged Ruby on Rails, so if your Rails app is consuming a version of Liquid before 4.0.0, you won&#39;t be able to use the whitespace control tags. Those were added in Liquid 4.0.0."}, {"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "reply_to_user": {"reputation": 391, "user_id": 7049314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quFSU.jpg?s=128&g=1", "display_name": "Adam Hollett", "link": "https://stackoverflow.com/users/7049314/adam-hollett"}, "edited": false, "score": 0, "creation_date": 1572518464, "post_id": 58628805, "comment_id": 103588563, "body": "hi @AdamHollett, thanks for your reply. I was using the gem version 3.0.6 and i update it to 4.0.3 but now i am getting a error <code>undefined method liquid_methods</code> in my user.rb"}, {"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "reply_to_user": {"reputation": 391, "user_id": 7049314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quFSU.jpg?s=128&g=1", "display_name": "Adam Hollett", "link": "https://stackoverflow.com/users/7049314/adam-hollett"}, "edited": false, "score": 0, "creation_date": 1572526688, "post_id": 58628805, "comment_id": 103593021, "body": "hi @AdamHollett, thats was the issue, would you want to put this in a answer so if someone visits the post it would be helpfull, i can mark the answer as accepted, thanks"}, {"owner": {"reputation": 391, "user_id": 7049314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quFSU.jpg?s=128&g=1", "display_name": "Adam Hollett", "link": "https://stackoverflow.com/users/7049314/adam-hollett"}, "edited": false, "score": 0, "creation_date": 1572635738, "post_id": 58628805, "comment_id": 103632550, "body": "Done! thanks for getting back to me."}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 7049314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quFSU.jpg?s=128&g=1", "display_name": "Adam Hollett", "link": "https://stackoverflow.com/users/7049314/adam-hollett"}, "edited": false, "score": 0, "creation_date": 1573070807, "post_id": 58631674, "comment_id": 103765423, "body": "<code>.present?</code> is not valid Liquid. You can do something similar by comparing equality with the special <code>blank</code> keyword:  <code>{% if foo == blank %}   This will only print if foo is not set or if it&#39;s an empty string {% endif %}</code>"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1572460074, "creation_date": 1572460074, "answer_id": 58631674, "question_id": 58628805, "link": "https://stackoverflow.com/questions/58628805/liquid-syntax-error-tag-was-not-properly-terminated-with-regexp/58631674#58631674", "title": "Liquid syntax error: Tag was not properly terminated with regexp: /\\%\\}/", "body": "<p>Did you check to make sure <code>extras['password_to_be_sent']</code> doesn't return a truthy but empty string?  Maybe it should be:</p>\n\n<pre><code>Username: {{user.email}}\n{%- if extras['password_to_be_sent'].present? -%}\nPassword: {{extras['password_to_be_sent']}}\n{%- endif -%}\nTrial expiration: {{user.trial_expiration}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 7049314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/quFSU.jpg?s=128&g=1", "display_name": "Adam Hollett", "link": "https://stackoverflow.com/users/7049314/adam-hollett"}, "is_accepted": true, "score": 1, "last_activity_date": 1572635709, "creation_date": 1572635709, "answer_id": 58664685, "question_id": 58628805, "link": "https://stackoverflow.com/questions/58628805/liquid-syntax-error-tag-was-not-properly-terminated-with-regexp/58664685#58664685", "title": "Liquid syntax error: Tag was not properly terminated with regexp: /\\%\\}/", "body": "<p>Answered above in a comment, but here it is again:</p>\n\n<blockquote>\n  <p>I see you've also tagged Ruby on Rails \u2014 if your Rails app is consuming a version of Liquid earlier than 4.0.0, you won't be able to use the whitespace control tags. Those were added in Liquid 4.0.0.</p>\n</blockquote>\n"}], "owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "accepted_answer_id": 58664685, "answer_count": 2, "score": 0, "last_activity_date": 1572635709, "creation_date": 1572449408, "question_id": 58628805, "link": "https://stackoverflow.com/questions/58628805/liquid-syntax-error-tag-was-not-properly-terminated-with-regexp", "title": "Liquid syntax error: Tag was not properly terminated with regexp: /\\%\\}/", "body": "<p>I have a an <code>if</code> condition in my liquid template like this</p>\n\n<pre><code>Username: {{user.email}}\n{% if extras['password_to_be_sent'] %}\nPassword: {{extras['password_to_be_sent']}}\n{% endif %}\nTrial expiration: {{user.trial_expiration}}\n</code></pre>\n\n<p>However this is generating a line break when the if condition does not evaluate to <code>true</code></p>\n\n<p>so the above generated output like this</p>\n\n<pre><code>Username: Abc\n\nTrail Expiration: 2019-11-10\n</code></pre>\n\n<p>I want to remove the additional line break when the <code>if</code> condition does not evaluate to <code>true</code></p>\n\n<p>i tried adding <code>-</code> as suggested here <a href=\"https://shopify.github.io/liquid/basics/whitespace/\" rel=\"nofollow noreferrer\">https://shopify.github.io/liquid/basics/whitespace/</a></p>\n\n<p>so updated code to </p>\n\n<pre><code>Username: {{user.email}}\n{%- if extras['password_to_be_sent'] -%}\nPassword: {{extras['password_to_be_sent']}}\n{%- endif -%}\nTrial expiration: {{user.trial_expiration}}\n</code></pre>\n\n<p>but this is giving an exception <code>Liquid::SyntaxError (Liquid syntax error: Tag '{%- if extras['password_to_be_sent'] -%}' was not properly terminated with regexp: /\\%\\}/)</code> </p>\n\n<p>Additionally, I am saving the template code in database, if that helps.</p>\n\n<p>Any help in this would be appreciated. Thanks.</p>\n"}, {"tags": ["ruby", "watir", "page-object-gem"], "owner": {"reputation": 38, "user_id": 4876405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmiys.png?s=128&g=1", "display_name": "Praveen P.", "link": "https://stackoverflow.com/users/4876405/praveen-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572454786, "creation_date": 1572449193, "last_edit_date": 1572454786, "question_id": 58628735, "link": "https://stackoverflow.com/questions/58628735/is-there-a-way-to-define-a-range-when-using-page-sections", "title": "Is there a way to define a range when using page_sections?", "body": "<p>My page has few divs in block layout with same class names. There is an outer div with an id and I have defined this outer div as a page-section. Each of the inner divs forms a block section and except the first page_section(index: 0), I want the access the rest of them as page_sections.</p>\n\n<pre><code>class MainHTML\n  include PageObject\n\n  page_section(:outer_div, BlockSection, id: 'block_section_id')\nend\n\n\nclass BlockSection\n  include PageObject\n\n  page_section(:first_block, PrimaryBlock, class: 'block-class', index: 0)\n  page_sections(:remaining_blocks, SecondaryBlocks, class: 'block-class', index: [1..-1])\nend\n</code></pre>\n\n<p>Is there a way to define a range [1..-1] when declaring page_sections like above?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 5, "last_activity_date": 1572448347, "creation_date": 1572448347, "answer_id": 58628467, "question_id": 58628391, "link": "https://stackoverflow.com/questions/58628391/wrong-number-of-arguments-in-initialize-given-0-expected-1/58628467#58628467", "title": "Wrong Number of Arguments in Initialize (given 0, expected 1)", "body": "<p>In this line, you are instantiating a <code>Launcher</code>:</p>\n\n<pre><code>launcher = Launcher.new\n</code></pre>\n\n<p>That will call the <code>initialize</code> method on it. That method expects an argument:</p>\n\n<pre><code>def initialize (app_map)\n  @app_map = app_map\nend\n</code></pre>\n\n<p>In order to resolve the error, you will need to pass in a parameter for the <code>app_map</code> argument. I don't know what it's supposed to actually be here, but that'll look something like this:</p>\n\n<pre><code>launcher = Launcher.new(the_app_map)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 12156759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hl9k8.png?s=128&g=1", "display_name": "GreenLights", "link": "https://stackoverflow.com/users/12156759/greenlights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572448347, "creation_date": 1572448095, "question_id": 58628391, "link": "https://stackoverflow.com/questions/58628391/wrong-number-of-arguments-in-initialize-given-0-expected-1", "title": "Wrong Number of Arguments in Initialize (given 0, expected 1)", "body": "<p>I am following along with a tutorial at:</p>\n\n<p><a href=\"http://neurogami.com/content/neurogami-10_minutes_to_your_first_Ruby_app/#sidebar4\" rel=\"nofollow noreferrer\">http://neurogami.com/content/neurogami-10_minutes_to_your_first_Ruby_app/#sidebar4</a></p>\n\n<p>I have checked and rechecked the code, and I do not understand why ruby is not reading my variable <code>app_map</code> as a valid argument.</p>\n\n<p>I have searched online for similar questions, and they exist, yet I can not understand why this variable is not working. I also am not exactly sure what <code>initialize</code> means, as I am an absolute beginner with Ruby. Any insight would be greatly appreciated.</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nclass Launcher\n\n  def initialize (app_map)\n   @app_map = app_map\n  end\n\n  #execute the given file using the associate app\n  def run file_name\n    application = select_app file_name\n    system \"#{application} #{file_name}\"\n  end\n\n  #given a file, lookup the matching application\n  def select_app file_name\n    ftype = file_type file_name\n    @app_map[ ftype ]\n  end\n\n  #return the part of the file name string after the last '.'\n  def file_type file_name\n    File.extname( file_name ).gsub( /^\\./, '' ).downcase\n  end\n\nend\n\nlauncher = Launcher.new\n\nend\n</code></pre>\n\n<p>I am not sure what this code is supposed to run, but I have multiple error messages.</p>\n\n<pre><code>tinyapp.rb:8:in `initialize': wrong number of arguments (given 0, expected 1) (ArgumentError)\n    from tinyapp.rb:30:in `new'\n    from tinyapp.rb:30:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "windows", "rubygems"], "comments": [{"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1572447950, "post_id": 58626992, "comment_id": 103564064, "body": "This and 90% of your future issues can be solved by following: <a href=\"https://ubuntu.com/download\" rel=\"nofollow noreferrer\">ubuntu.com/download</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 2, "last_activity_date": 1572444748, "creation_date": 1572444748, "answer_id": 58627300, "question_id": 58626992, "link": "https://stackoverflow.com/questions/58626992/cant-update-rubygems-on-windows-10/58627300#58627300", "title": "Can&#39;t Update RubyGems on Windows 10", "body": "<p>You could try updating it manually:</p>\n\n<ol>\n<li><p>Go here:<br>\n<a href=\"https://rubygems.org/pages/download\" rel=\"nofollow noreferrer\">https://rubygems.org/pages/download</a></p></li>\n<li><p>Download the zip file</p></li>\n<li>Unzip it to some folder</li>\n<li>In the terminal <code>cd</code> to this folder</li>\n<li>Type <code>ruby setup.rb</code></li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 12297632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e57748f1579c5afb6d96fa7fca33188?s=128&d=identicon&r=PG&f=1", "display_name": "Surya Vasudevan", "link": "https://stackoverflow.com/users/12297632/surya-vasudevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58627300, "answer_count": 1, "score": 2, "last_activity_date": 1572449620, "creation_date": 1572443746, "last_edit_date": 1572449620, "question_id": 58626992, "link": "https://stackoverflow.com/questions/58626992/cant-update-rubygems-on-windows-10", "title": "Can&#39;t Update RubyGems on Windows 10", "body": "<p>Gem Version:</p>\n\n<pre><code>$ gem --version\n2.1.2\n</code></pre>\n\n<p>Ruby Version:</p>\n\n<pre><code>$ ruby --version\nruby 2.5.5p157 (2019-03-15 revision 67260) [x64-mingw32]\n</code></pre>\n\n<p>When I try to update Gem, I get the following error</p>\n\n<pre><code>$ gem update --system\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `source_paths' for #&lt;Gem::Specification:0x1595b798 rubygems-update-3.0.6&gt;\nUpdating rubygems-update\nSuccessfully installed rubygems-update-3.0.6\n</code></pre>\n\n<p>Plese help me updating gem to >2.5.0.\nThanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 1780307, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8502b1b249f8fd4ceed6e691eeebd027?s=128&d=identicon&r=PG", "display_name": "Arthur Felipe", "link": "https://stackoverflow.com/users/1780307/arthur-felipe"}, "edited": false, "score": 0, "creation_date": 1572530002, "post_id": 58632921, "comment_id": 103594880, "body": "loved the approach"}, {"owner": {"reputation": 987, "user_id": 1780307, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8502b1b249f8fd4ceed6e691eeebd027?s=128&d=identicon&r=PG", "display_name": "Arthur Felipe", "link": "https://stackoverflow.com/users/1780307/arthur-felipe"}, "edited": false, "score": 1, "creation_date": 1574434484, "post_id": 58632921, "comment_id": 104243741, "body": "I used your approach to create a gem. gem &#39;graphql_scaffold&#39;. What do you think about it?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 987, "user_id": 1780307, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8502b1b249f8fd4ceed6e691eeebd027?s=128&d=identicon&r=PG", "display_name": "Arthur Felipe", "link": "https://stackoverflow.com/users/1780307/arthur-felipe"}, "edited": false, "score": 0, "creation_date": 1574654011, "post_id": 58632921, "comment_id": 104294778, "body": "That&#39;s a good idea, let me know if you need help implementing it @ArthurFelipe"}, {"owner": {"reputation": 987, "user_id": 1780307, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8502b1b249f8fd4ceed6e691eeebd027?s=128&d=identicon&r=PG", "display_name": "Arthur Felipe", "link": "https://stackoverflow.com/users/1780307/arthur-felipe"}, "edited": false, "score": 0, "creation_date": 1574767051, "post_id": 58632921, "comment_id": 104339819, "body": "Fell free to fork and add anything you think would be better. It is still at the begining... Thank you! <a href=\"https://github.com/arthurmolina/graphql_scaffold\" rel=\"nofollow noreferrer\">github.com/arthurmolina/graphql_scaffold</a>"}, {"owner": {"reputation": 155, "user_id": 13128714, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-011OcGXRUMw/AAAAAAAAAAI/AAAAAAAAAAA/AKF05nBZF94jikFYobNiMsrFAILIZfHOig/photo.jpg?sz=128", "display_name": "Yannick Schr&#246;der", "link": "https://stackoverflow.com/users/13128714/yannick-schr%c3%b6der"}, "edited": false, "score": 0, "creation_date": 1591565001, "post_id": 58632921, "comment_id": 110097796, "body": "I&#39;m totally new to graphql, could you share a demo/github link to understand how u extended the GraphQL-Ruby Type Definition System and in which file you added the field to all queries?"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 3, "last_activity_date": 1572466104, "creation_date": 1572466104, "answer_id": 58632921, "question_id": 58626327, "link": "https://stackoverflow.com/questions/58626327/ruby-graphql-how-to-order-arguments-in-an-option/58632921#58632921", "title": "Ruby GraphQL: How to order arguments in an option?", "body": "<p>The ruby Hash instances are not ordered (see <a href=\"https://stackoverflow.com/questions/31418673/is-order-of-a-ruby-hash-literal-guaranteed\">Is order of a Ruby hash literal guaranteed?</a>)</p>\n\n<hr>\n\n<p>To leverage the optional multi sorting options in GraphQL input types, I usually use the following structure:</p>\n\n<ul>\n<li>1 enum to contain all filterable/sortable/searchable field of a resource (ex: <code>UserField</code>)</li>\n<li>1 enum to contain the 2 sort directions (<code>asc</code> and <code>desc</code>)</li>\n<li>1 field accepting an optional list of <code>{ field: UserField!, sortDir: SortDir! }</code> inputs.</li>\n</ul>\n\n<p>This then enables the API consumers to simply do queries like:</p>\n\n<pre><code>allUsers(sort_by: [{field: username, sortDir: desc}, {field: id, sortDir: asc}]) {\n  # ...\n}\n</code></pre>\n\n<p>And this pattern can be easily re-used for searching and filtering:</p>\n\n<pre><code>allUsers(search: [{field: username, comparator: like, value: 'bob'}]) {}\nallUsers(search: [{field: age, comparator: greater_than, value: '22'}]) {} # type casting is done server-side\nallUsers(search: [{field: username, comparator: equal, value: 'bob'}]) {} # equivalent of filtering\n</code></pre>\n\n<hr>\n\n<p>Eventually, with further deeper work you can allow complex <code>and</code>/<code>or</code> for the input:</p>\n\n<pre><code>allUsers(\n  search: [\n    {\n      left: {field: username, comparator: like, value: 'bob'}\n      operator: and\n      right: {field: dateOfBirth, comparator: geater_than, value: '2001-01-01'}\n    }\n  ]\n)\n</code></pre>\n\n<p>Disclaimer: the last example above is one of the many things I want to implement in my GQL API but I haven't had the time to think it through yet, it's just a draft</p>\n"}], "owner": {"reputation": 987, "user_id": 1780307, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8502b1b249f8fd4ceed6e691eeebd027?s=128&d=identicon&r=PG", "display_name": "Arthur Felipe", "link": "https://stackoverflow.com/users/1780307/arthur-felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 58632921, "answer_count": 1, "score": 3, "last_activity_date": 1572466104, "creation_date": 1572441620, "question_id": 58626327, "link": "https://stackoverflow.com/questions/58626327/ruby-graphql-how-to-order-arguments-in-an-option", "title": "Ruby GraphQL: How to order arguments in an option?", "body": "<p>I am using SearchObject with GraphQL in Ruby on Rails and created an option called :order_by</p>\n\n<pre><code>option :order_by, type: LinksOrderBy, with: :apply_order_by\n</code></pre>\n\n<p>The type LinksOrderBy is defined by this:</p>\n\n<pre><code>class LinksOrderBy &lt; ::Types::BaseInputObject\n  argument :created_at, AscDescEnum, required: false\n  argument :description, AscDescEnum, required: false\n  argument :id, AscDescEnum, required: false\n  argument :updated_at, AscDescEnum, required: false\n  argument :url, AscDescEnum, required: false\nend\n</code></pre>\n\n<p>But when I try something like this in GraphQL query:</p>\n\n<pre><code>{allLinks(order_by:{id: asc, description: desc}) {\n    id\n    description\n}}\n</code></pre>\n\n<p>I don't get it in the right order:</p>\n\n<pre><code>def apply_order_by(scope, value)\n  scope.order(value.arguments.to_h.map{|k, v| k + ' ' + v}.join(', ')) # \"description desc, id asc\"\nend\n</code></pre>\n\n<p>As you can see the right order should be <strong>\"id, description\"</strong>, not <strong>\"description, id\"</strong>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1572441966, "post_id": 58625452, "comment_id": 103560397, "body": "I&#39;d go to anyone who written that initially and ask why they decided to use <code>last</code> instead of <code>any?</code>. Is it possible (according to business rules) for one InquiryProcess to have mutliple <code>inquiry_field_responses</code> with name of <code>&quot;company_name&quot;</code>?  I&#39;d assume in my answer there can only be one record as such due to lack of order information associated with the call to <code>last</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572441077, "post_id": 58626086, "comment_id": 103559844, "body": "You can use <code>ids</code> instead of <code>.select(:id)</code>, no?"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572441223, "post_id": 58626086, "comment_id": 103559930, "body": "@SebastianPalma - <code>ids</code> would return array of ids, which is what I&#39;m trying to avoid. <code>select(:id)</code> return ActiveRecord relation, which will be inserted as a subquery."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572445419, "post_id": 58626086, "comment_id": 103562455, "body": "Ok, so if I update your <code>call</code> to correspondent fields in db - <code>id_select = InquiryProcess.joins(inquiry_field_responses: :inquiry_field).where(inquiry_fields: { name: &#39;company_name&#39; }).where(InquiryField.arel_table[:value].matches(&quot;#{company_&zwnj;&#8203;filter}%&quot;)).select(:&zwnj;&#8203;id)</code> I have an error <code>ActiveRecord::StatementInvalid (PG::UndefinedColumn: ERROR:  column inquiry_fields.value does not exist)</code> which is true because value is not a column in db"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572445605, "post_id": 58626086, "comment_id": 103562579, "body": "When <code>where</code> receives an array it uses the <code>IN</code> clause instead using <code>=</code> @BroiSatse."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572447249, "post_id": 58626086, "comment_id": 103563633, "body": "@SebastianPalma -Of course it is. And I&#39;m trying to avoid it as such a query has issues with memory leak. It is always better to use single, same query rather than two queries where second relies on result of the other. It&#39;s usually faster as SQL optimizer is included, requires less memory as no interim values needs to be stored and it has no caching issues with memory leaks."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572447982, "post_id": 58626086, "comment_id": 103564088, "body": "So, you prefer to pass a subquery to <code>IN</code> rather than passing directly the ids? @BroiSatse. I don&#39;t get your point about memory leaks and optimization."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572448449, "post_id": 58626086, "comment_id": 103564358, "body": "Yes, the issue we hit was that if you calculate and use dynamic list of ids in your queary, rails will see each call as a new query and will attempt to cache it <code>with ActiveRecord::QueryCache</code> since the dynamic list of ids will often change, even for a medium size database that cache will exhaust your available memory, killing your application. In our case it meant forced server restart every two weeks (not much I know, but still annoying especially as it was affecting the business). @SebastianPalma"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572449169, "post_id": 58626086, "comment_id": 103564756, "body": "I don&#39;t know if we&#39;re referring to the same, but that will perform a single query, in any case (select, pluck or the whole ActiveRecord_Relation)."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1572449625, "post_id": 58626086, "comment_id": 103564994, "body": "Well, no, because you firstly need to perform the query to obtain the list of ids. Using <code>pluck</code> or <code>ids</code> will firstly query the database to obtain the list of ids, and then insert that list into the second query (completely ruining cache). <code>select</code> on the other hand is not querying the database, but is used as a subquery in a single SQL query. This gives the database chance to optimise it and, since we always send the same query, only one caching record is stored in the memory."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572628919, "post_id": 58626086, "comment_id": 103629848, "body": "@mr_muscle - Could you please add how <code>value</code> is defined?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572632374, "post_id": 58626086, "comment_id": 103631325, "body": "@BroiSatse I think it comes from <code>gem attr_encrypted</code> - in model <code>InquiryFieldResponse</code> I&#39;ve got <code>attr_encrypted :value, key: Base64.decode64(Rails.application.secrets.encryption_key)</code>"}], "tags": [], "owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "is_accepted": false, "score": 1, "last_activity_date": 1572442045, "last_edit_date": 1572442045, "creation_date": 1572440840, "answer_id": 58626086, "question_id": 58625452, "link": "https://stackoverflow.com/questions/58625452/rails-code-refactor-in-call-method-to-handle-map/58626086#58626086", "title": "Rails code refactor in call method to handle map", "body": "<p>The code you posted is not only hard to follow, but I remember we had a massive memory leak connected to ActiveReocrd caching when using precalculated ids in a query.</p>\n\n<p>That said, I'd try to utilise the above within a single sql query:</p>\n\n<pre><code>def call\n  id_select = InquiryProcess\n    .joins(inquiry_field_responses: :inquiry_field)\n    .where(inquire_fields: { name: 'company_name' })\n    .where(InquiryField.arel_table[:value].matches(\"#{company_filter}%\"))\n    .select(:id)\n\n  InquiryProcess.where(id: id_select)\nend\n</code></pre>\n\n<p>Note that <code>id_select</code> is not an array of ids but ActiveRecord scope, the above will translate to following SQL:</p>\n\n<pre><code>SELECT \"inquiry_processes\".* \n  FROM \"inquiry_processes\" \n  WHERE \"inquiry_processes\".\"id\" IN (\n    SELECT \"inquiry_processes\".\"id\"\n      FROM \"inquiry_processes\"\n      INNER JOIN ...\n      WHERE ...\n  ) \n</code></pre>\n\n<p>And to answer another question - why do we query table by matching id to a result of another subquery on the same table? This is to avoid all sort of painful issues when you deal with an active record relation that has a join in it - e.g. it would affect all further <code>includes</code> statements, as the preloaded association would only include records matching the relation join conditions.</p>\n\n<p>I really hope for you that this bit is quite well tested or you have someone who can verify validity of the behaviour.</p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572445531, "creation_date": 1572438672, "last_edit_date": 1572445531, "question_id": 58625452, "link": "https://stackoverflow.com/questions/58625452/rails-code-refactor-in-call-method-to-handle-map", "title": "Rails code refactor in call method to handle map", "body": "<p>I'm just wondering is there any chance to get fresh eye on code below and make some code refactor?</p>\n\n<pre><code>def call\n  inq_proc_ids = InquiryProcess.all.includes(inquiry_field_responses: :inquiry_field).select do |process|\n    process.inquiry_field_responses.select do |inquiry_field_responses|\n      inquiry_field_responses.inquiry_field.name == 'company_name'\n    end.last&amp;.value&amp;.start_with?(company_filter)\n  end.map(&amp;:id)\n  InquiryProcess.where(id: inq_proc_ids)\nend\n</code></pre>\n\n<p>I think I should leave only InquiryProcess.where(id: inq_proc_ids) in my call method but I don't know how to handle with all these <code>.last&amp;.value&amp;.start_with?(company_filter)</code> and <code>.map(&amp;:id)</code> stuff.</p>\n\n<p>EDIT:</p>\n\n<p>I was trying to split it to the new methods</p>\n\n<pre><code>def call\n  InquiryProcess.where(id: inquiry_process_id)\nend\n\nprivate\n\nattr_reader :company_filter, :inquiry_field_response\n\ndef inquiry_process_id\n  InquiryProcess.all.includes(inquiry_field_responses: :inquiry_field).select do |process|\n    process.inquiry_field_responses.select_company_name\n  end.map(&amp;:id)\nend\n\ndef select_company_name\n  select do |inquiry_field_responses|\n    inquiry_field_responses.inquiry_field.name == 'company_name'\n  end.last&amp;.value&amp;.start_with?(company_filter)\nend\n</code></pre>\n\n<p>but I got an error:</p>\n\n<blockquote>\n  <p>NoMethodError (undefined method `select_company_name' for ActiveRecord::Associations::CollectionProxy []>):</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572434768, "post_id": 58624078, "comment_id": 103556340, "body": "Unfortunately this is not that easy. To get company name I have to download last relation <code>&amp;.last</code> and call <code>value</code>. If I change this code to <code>&amp;.last&amp;.value == &#39;aaa&#39;</code> it will show me only InquiryProcess for companies with exactly that name so &#39;aaa&#39; but I want to display all InquiryProcesses for companies starting their name with &#39;aaa&#39;."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 2, "last_activity_date": 1572433890, "creation_date": 1572433890, "answer_id": 58624078, "question_id": 58623934, "link": "https://stackoverflow.com/questions/58623934/rails-show-record-start-from-db-with-specific-letters/58624078#58624078", "title": "Rails show record start from db with specific letters", "body": "<p>It's much more easier.</p>\n\n<p>Just use SQL for this:</p>\n\n<pre><code>InquiryProcess.where(\"company_name LIKE ?\",  \"aaa%\")\n</code></pre>\n\n<p>This shows you all <code>inquiry_processes</code> that <code>company_name</code> starts with <code>aaa</code></p>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 3, "last_activity_date": 1572434571, "creation_date": 1572434571, "answer_id": 58624294, "question_id": 58623934, "link": "https://stackoverflow.com/questions/58623934/rails-show-record-start-from-db-with-specific-letters/58624294#58624294", "title": "Rails show record start from db with specific letters", "body": "<p>I would do something like this:</p>\n\n<pre><code>field = InquiryField.find_by!(name: 'company_name')\nresponse_table = InquiryFieldResponse.arel_table\nresponses = field.inquiry_field_responses.where(response_table[:value].matches('aaa%'))\nprocesses = InquiryProcess.where(id: responses.select(:inquiry_process_id))\n</code></pre>\n\n<p>First select the field that you want to check the values of. From there select all responses that belong to that specific field and start with <code>'aaa'</code>. Then select the processes using the responses.</p>\n\n<hr>\n\n<p>The issue with your current code is that you'll do:</p>\n\n<pre><code>'some string' == start_with?('aaa')\n</code></pre>\n\n<p>Which should be:</p>\n\n<pre><code>'some string'.start_with?('aaa')\n</code></pre>\n\n<p>Or more specific to your case:</p>\n\n<pre><code>end.last&amp;.value&amp;.start_with?('aaa')\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58624294, "answer_count": 2, "score": 0, "last_activity_date": 1572434571, "creation_date": 1572433367, "question_id": 58623934, "link": "https://stackoverflow.com/questions/58623934/rails-show-record-start-from-db-with-specific-letters", "title": "Rails show record start from db with specific letters", "body": "<p>I want to show only those inquiry processes where company name starts from specific letters. I thought I should use <code>start_with?</code> but in the code below I've an error</p>\n\n<blockquote>\n  <p>NoMethodError (undefined method `start_with?'</p>\n</blockquote>\n\n<pre><code>def call\n  InquiryProcess.all.includes(inquiry_field_responses: :inquiry_field).select do |process|\n    process.inquiry_field_responses.select do |inquiry_field_responses|\n      inquiry_field_responses.inquiry_field.name == 'company_name'\n    end&amp;.last&amp;.value == start_with?('aaa')\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "moodle", "moodle-api"], "comments": [{"owner": {"reputation": 370, "user_id": 1086223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fb6uF.jpg?s=128&g=1", "display_name": "curiouscode", "link": "https://stackoverflow.com/users/1086223/curiouscode"}, "edited": false, "score": 0, "creation_date": 1572469631, "post_id": 58623923, "comment_id": 103574295, "body": "Can you provide code examples that you tried and that didn&#39;t work? It&#39;s hard to know the right direction to point you in without knowing what you&#39;ve done."}, {"owner": {"reputation": 44, "user_id": 7668170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnqDV.jpg?s=128&g=1", "display_name": "Barkha Jariwala", "link": "https://stackoverflow.com/users/7668170/barkha-jariwala"}, "reply_to_user": {"reputation": 370, "user_id": 1086223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fb6uF.jpg?s=128&g=1", "display_name": "curiouscode", "link": "https://stackoverflow.com/users/1086223/curiouscode"}, "edited": false, "score": 0, "creation_date": 1572516951, "post_id": 58623923, "comment_id": 103587660, "body": "Hi, Please check my comment on the answer given by calebkm. Thanks for giving your time."}], "answers": [{"comments": [{"owner": {"reputation": 44, "user_id": 7668170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnqDV.jpg?s=128&g=1", "display_name": "Barkha Jariwala", "link": "https://stackoverflow.com/users/7668170/barkha-jariwala"}, "edited": false, "score": 0, "creation_date": 1572516884, "post_id": 58628538, "comment_id": 103587622, "body": "Hey, Thanks for your answer. The code that you provided did not work for me. However, After hours of searching and trial and error, I found out that the main issue was in my moodle setting. The token needs to add some user to be added to it and also enable them to let them use the token and access the functions added to the external service. I appreciate you for giving your precious time after my query. Honestly, I was not able to find that option now.  The whole moodle site admin interface is so clumsy. :("}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1572448566, "creation_date": 1572448566, "answer_id": 58628538, "question_id": 58623923, "link": "https://stackoverflow.com/questions/58623923/moodle-with-ruby-on-rails/58628538#58628538", "title": "Moodle with Ruby On Rails", "body": "<p>Can you show us how you tried to configure your gems? For example, according to the docs the <code>moddle-api</code> gem requires a configuration like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> Moodle::Api.configure do|c|\n  c.host = 'http://my_moodle_instance.com'\n  c.token = 'mytoken'\nend\n</code></pre>\n\n<p>If you did configure the gem like the above, can you show some of the code that you tried to call once the gem was installed and configured?</p>\n"}], "owner": {"reputation": 44, "user_id": 7668170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnqDV.jpg?s=128&g=1", "display_name": "Barkha Jariwala", "link": "https://stackoverflow.com/users/7668170/barkha-jariwala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572448566, "creation_date": 1572433315, "question_id": 58623923, "link": "https://stackoverflow.com/questions/58623923/moodle-with-ruby-on-rails", "title": "Moodle with Ruby On Rails", "body": "<p>Currently, I am working on a rails application which requires the user to be registered automatically in the moodle. I searched for it and found these gems,</p>\n\n<ol>\n<li>moodle-api: <a href=\"https://github.com/getsmarter/moodle-api\" rel=\"nofollow noreferrer\">https://github.com/getsmarter/moodle-api</a></li>\n<li>moodle_rb: <a href=\"https://github.com/jobready/moodle-rb/\" rel=\"nofollow noreferrer\">https://github.com/jobready/moodle-rb/</a></li>\n<li>moodle: <a href=\"https://github.com/robertboloc/moodle\" rel=\"nofollow noreferrer\">https://github.com/robertboloc/moodle</a></li>\n</ol>\n\n<p>But, nothing seems to work for me. I even searched on youtube but found nothing with the rails.</p>\n\n<p>However, using the <code>moodle_rb</code> gem I was able to create an object which returned me the sites info using the <code>sites_info</code> function. Other than that I am unable to use any of the web services of the moodle. I have created an external service and added some functions like <code>auth_email_get_signup_settings</code> and <code>auth_email_signup_user</code> which accepts none parameters.</p>\n\n<p>May anyone guides me through this? or even a minor help would also be great.</p>\n\n<p>I am using a token to create the object.</p>\n\n<p>Thanks in advance.    </p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 1, "creation_date": 1572493981, "post_id": 58623353, "comment_id": 103579915, "body": "Why not simply create another <code>RSpec.describe</code> block without including shared context? Would pretty explicit for other to understand a reason instead of diving into configuration to search why context not being loaded"}, {"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1572521155, "post_id": 58623353, "comment_id": 103589968, "body": "That would be a good idea, but I have some setup in the <code>describe</code> block I want to use for all of the specs. Splitting it in two means I have to duplicate this setup."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1572542305, "post_id": 58623353, "comment_id": 103601575, "body": "you always can put shared setup into a method, class, module. This is ruby ;)"}], "answers": [{"comments": [{"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1572443437, "post_id": 58624441, "comment_id": 103561235, "body": "That sounds pretty neat. Can I do silly things like overriding that metadata in nested blocks? For instance, loading the context in one example inside the &quot;with some special context&quot; context?"}, {"owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "reply_to_user": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1572473481, "post_id": 58624441, "comment_id": 103575567, "body": "@Richard-Degenne, you should be. Please note I have moved the metadata tag to <code>it</code> block. (previously it was in the wrong place). Since metadata runs for each spec (&quot;it block&quot;), you should be able to mix and match."}], "tags": [], "owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "is_accepted": true, "score": 1, "last_activity_date": 1572473219, "last_edit_date": 1572473219, "creation_date": 1572435098, "answer_id": 58624441, "question_id": 58623353, "link": "https://stackoverflow.com/questions/58623353/is-there-a-way-to-turn-off-a-shared-context-inside-a-single-blcok/58624441#58624441", "title": "Is there a way to &quot;turn off&quot; a shared context inside a single blcok?", "body": "<p>I think by slightly modifying how you include the context and using RSpec metadata, you should be able to get this working. </p>\n\n<pre><code>RSpec.shared_context \"my shared context\" do\n  # code\nend\n\n\n\n# spec/support/shared_context_load.rb\nRSpec.configure do |config|\n  config.before do |example|\n    unless example.metadata[:load_shared_context] == false\n      config.include_context \"my shared context\"\n    end\n  end\nend\n\n\n\ndescribe MyClass do\n  # NOTE the shared_contxet is removed from here\n\n  describe '#some_method' do\n    # Specs using the shared context...\n\n    it \"this spec using shared context\"\n       # code\n    end\n\n    context 'with some special context' do\n      it \"this spec is not using shared context\", load_shared_context: false do \n        # Turn off 'my shared context' here      \n        # ...\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58624441, "answer_count": 1, "score": 0, "last_activity_date": 1572473219, "creation_date": 1572431490, "question_id": 58623353, "link": "https://stackoverflow.com/questions/58623353/is-there-a-way-to-turn-off-a-shared-context-inside-a-single-blcok", "title": "Is there a way to &quot;turn off&quot; a shared context inside a single blcok?", "body": "<p>I am using shared contexts to DRY my spec files.</p>\n\n<p>However, I have one single <code>context</code> block where I would like to disable the shared context. Is this possible?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>describe MyClass do\n  include_context 'my shared context'\n\n  describe '#some_method' do\n    # Specs using the shared context...\n\n    context 'with some special context' do\n      # Turn off 'my shared context' here      \n      # ...\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "session"], "comments": [{"owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "edited": false, "score": 0, "creation_date": 1572433315, "post_id": 58623189, "comment_id": 103555566, "body": "Can you elaborate what you mean by  &#39;based on session&#39; , is it the current user session etc ?"}, {"owner": {"reputation": 141, "user_id": 10043524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e81c8d061b996ff7555a797692ce7d7?s=128&d=identicon&r=PG&f=1", "display_name": "leafeve", "link": "https://stackoverflow.com/users/10043524/leafeve"}, "reply_to_user": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "edited": false, "score": 0, "creation_date": 1572433471, "post_id": 58623189, "comment_id": 103555653, "body": "It can be current_user, current_host, guest"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5067874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OF4OQ.png?s=128&g=1", "display_name": "facundo espinosa", "link": "https://stackoverflow.com/users/5067874/facundo-espinosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1572443053, "creation_date": 1572443053, "answer_id": 58626772, "question_id": 58623189, "link": "https://stackoverflow.com/questions/58623189/how-can-i-count-view-number-from-a-model-filtered-by-session/58626772#58626772", "title": "How can i count view_number from a model filtered by session?", "body": "<p>IDK what means your Blog model, if returns Users, or returns Posts, or return a Blog, like multi tenant blog app maybe. I will assume that returns Posts.</p>\n\n<p>If you want control who view something, like the gem that you sent the link, you will need a table to match between session_hash, ip, or user_id and blog_id. Then you should ask to this table if the match exist for this post, if exist don't do anything but if doesn't exist will increase the counter.</p>\n\n<p>Consider for better scalability add an index in the matches table by your user identifier (session, ip, id) and another in the blog_id.</p>\n"}], "owner": {"reputation": 141, "user_id": 10043524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e81c8d061b996ff7555a797692ce7d7?s=128&d=identicon&r=PG&f=1", "display_name": "leafeve", "link": "https://stackoverflow.com/users/10043524/leafeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572443053, "creation_date": 1572430931, "question_id": 58623189, "link": "https://stackoverflow.com/questions/58623189/how-can-i-count-view-number-from-a-model-filtered-by-session", "title": "How can i count view_number from a model filtered by session?", "body": "<p>i was coding a feature about view_number(view count) of Blog.</p>\n\n<p>It's worked when i reload page, however i want count view_number based on session. Maybe it like <a href=\"https://github.com/charlotte-ruby/impressionist\" rel=\"nofollow noreferrer\">Usage #8</a> in this gem</p>\n\n<p>Any solution for this? Thanks you for reading</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Home::UpdateBlogViewNumberWorker\n  include Sidekiq::Worker\n  sidekiq_options queue: 'blogs'\n\n  def perform(*args)\n    blog_id = args.first\n    viewer = Blog.find_by_id(blog_id)\n\n    if viewer.present?\n      view_number = viewer.view_number.to_i + 1\n      viewer.update_attribute(:view_number, view_number)\n    end\n  end\nend\n</code></pre>\n\n<p>and my controller</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Home::BlogsController &lt; Home::BaseController\n  #...\n  def show\n    update_blog_view_number\n  end\n\n  private\n\n  def update_blog_view_number\n    Home::UpdateBlogViewNumberWorker.perform_async(@blog.id)\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "amazon-s3", "amazon-elasticache"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572430337, "post_id": 58622916, "comment_id": 103553974, "body": "You can always run your own redis/memcached"}, {"owner": {"reputation": 155, "user_id": 4821316, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-bKDtq9ba2tk/AAAAAAAAAAI/AAAAAAAAACM/YsMOjzxHSik/photo.jpg?sz=128", "display_name": "11223342124", "link": "https://stackoverflow.com/users/4821316/11223342124"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572430722, "post_id": 58622916, "comment_id": 103554165, "body": "@SergioTulentsev And use S3 as a backup storage? I am aiming for completely web based caching storage"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572430904, "post_id": 58622916, "comment_id": 103554276, "body": "Ah, I see. In this case, google &quot;memcached as a service&quot;, maybe you&#39;ll get a few suggestions."}, {"owner": {"reputation": 155, "user_id": 4821316, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-bKDtq9ba2tk/AAAAAAAAAAI/AAAAAAAAACM/YsMOjzxHSik/photo.jpg?sz=128", "display_name": "11223342124", "link": "https://stackoverflow.com/users/4821316/11223342124"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572431484, "post_id": 58622916, "comment_id": 103554580, "body": "@SergioTulentsev One more question: is there any free memcached service that can be used outside of Rails?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572443716, "post_id": 58626869, "comment_id": 103561413, "body": "&quot;really easy&quot; is an overstatement. <a href=\"https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/GettingStarted.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/&hellip;</a>. It can be much easier."}], "tags": [], "owner": {"reputation": 41, "user_id": 5067874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OF4OQ.png?s=128&g=1", "display_name": "facundo espinosa", "link": "https://stackoverflow.com/users/5067874/facundo-espinosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1572443323, "creation_date": 1572443323, "answer_id": 58626869, "question_id": 58622916, "link": "https://stackoverflow.com/questions/58622916/which-web-service-to-use-as-a-cache-storage/58626869#58626869", "title": "Which web service to use as a cache storage?", "body": "<p>Why do you think that Redis will reduce your work load? Redis is really powerful cache and will save your data really good. Elasticache of AWS can works with redis, should be really easy to setup and you only need control the what you will save there.</p>\n"}], "owner": {"reputation": 155, "user_id": 4821316, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-bKDtq9ba2tk/AAAAAAAAAAI/AAAAAAAAACM/YsMOjzxHSik/photo.jpg?sz=128", "display_name": "11223342124", "link": "https://stackoverflow.com/users/4821316/11223342124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572443323, "creation_date": 1572430057, "question_id": 58622916, "link": "https://stackoverflow.com/questions/58622916/which-web-service-to-use-as-a-cache-storage", "title": "Which web service to use as a cache storage?", "body": "<p>I am creating an application as a practice which will scrape a website. I want to cache scraped results using a web service, but I am not sure which one to use. </p>\n\n<p>I have looked into Amazon's Elasticache and S3. \nElasticache seems like an overkill for this problem, but uses Redis in the background which will reduce my workload (I guess?). \nS3 is not in-memory, but bigger issue for me is that I am not completely sure it is good solution for this kind of problem.</p>\n\n<p>I don't need anything super fancy. I would like something easy to set up, yet efficient if that is possible.</p>\n\n<p>So which one to chose? Are there any better alternatives?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 11130604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CO_the3CoLc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsms9NpCz2z7c10HOSWDClnkEZ9w/mo/photo.jpg?sz=128", "display_name": "Natalia Resende", "link": "https://stackoverflow.com/users/11130604/natalia-resende"}, "edited": false, "score": 0, "creation_date": 1572431888, "post_id": 58622864, "comment_id": 103554783, "body": "thank you so much! Never thought that would be so simple... It was just to insert the variable file = &#39;italian.dic.fc&#39;."}, {"owner": {"reputation": 133, "user_id": 11130604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CO_the3CoLc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsms9NpCz2z7c10HOSWDClnkEZ9w/mo/photo.jpg?sz=128", "display_name": "Natalia Resende", "link": "https://stackoverflow.com/users/11130604/natalia-resende"}, "edited": false, "score": 0, "creation_date": 1572454837, "post_id": 58622864, "comment_id": 103567920, "body": "I don&#39;t understand what is going on, because when I run the script you sent me the output file does not contain the 3 million words that had been compressed, but the entries go as far as 40672. What to do to get the whole file decompressed?"}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "reply_to_user": {"reputation": 133, "user_id": 11130604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CO_the3CoLc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsms9NpCz2z7c10HOSWDClnkEZ9w/mo/photo.jpg?sz=128", "display_name": "Natalia Resende", "link": "https://stackoverflow.com/users/11130604/natalia-resende"}, "edited": false, "score": 0, "creation_date": 1572607764, "post_id": 58622864, "comment_id": 103619915, "body": "This might be the limit of this REPL. When running it on my computer, I correctly get 3 million entries."}], "tags": [], "owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "is_accepted": true, "score": 1, "last_activity_date": 1572429866, "creation_date": 1572429866, "answer_id": 58622864, "question_id": 58622537, "link": "https://stackoverflow.com/questions/58622537/how-to-run-a-ruby-script-to-decompress-a-file/58622864#58622864", "title": "how to run a ruby script to decompress a file?", "body": "<p>If you download the whole repo you mentioned, it's enough to run this in its directory:</p>\n\n<pre><code>ruby dictionary-expand.rb italian.dic.fc\n</code></pre>\n\n<p>No changes to the script required.</p>\n\n<p>If you want to run it in this REPL though, script would look like that:</p>\n\n<pre><code>require 'zlib'\nfile = 'italian.dic.fc'\nZlib::GzipReader.open(file) do |gz|\n  File.open(File.basename(file, '.fc'), 'w') do |out|\n    last = ''\n    until gz.eof\n      counter = gz.getc.ord\n      delta = gz.gets.strip\n      last = last[0, counter] + delta\n      out.puts last\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11130604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CO_the3CoLc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsms9NpCz2z7c10HOSWDClnkEZ9w/mo/photo.jpg?sz=128", "display_name": "Natalia Resende", "link": "https://stackoverflow.com/users/11130604/natalia-resende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58622864, "answer_count": 1, "score": 0, "last_activity_date": 1572429866, "creation_date": 1572428765, "question_id": 58622537, "link": "https://stackoverflow.com/questions/58622537/how-to-run-a-ruby-script-to-decompress-a-file", "title": "how to run a ruby script to decompress a file?", "body": "<p>I need help with a ruby code. I've found an Italian dictionary compressed using a ruby script. As I have no experience with Ruby, I am trying to use the script provided to decompress the file I found here: <a href=\"https://github.com/mircomacrelli/italian-dictionary\" rel=\"nofollow noreferrer\">https://github.com/mircomacrelli/italian-dictionary</a>. </p>\n\n<p>I have already tried to download the dictionary from here: <a href=\"https://github.com/mircomacrelli/italian-dictionary\" rel=\"nofollow noreferrer\">https://github.com/mircomacrelli/italian-dictionary</a></p>\n\n<p>and I've uploaded the dictionary file (italian.dic.fc) to run the script (named dictionary-expand.rb)\nusing the online compiler: <a href=\"https://repl.it/languages/ruby\" rel=\"nofollow noreferrer\">https://repl.it/languages/ruby</a>. The ruby script I am using is below. </p>\n\n<pre><code>  require 'zlib'\nabort 'No input file specified' if ARGV.empty?\n\nZlib::GzipReader.open(ARGV.first) do |gz|\n  File.open(File.basename(ARGV.first, 'italian.dic.fc'), 'w') do |out|\n    last = ''\n   until gz.eof\n      counter = gz.getc.ord\n      delta = gz.gets.strip\n      last = last[0, counter] + delta\n      out.puts last\n    end\n  end\nend\n</code></pre>\n\n<p>I want to open the dictionary. Not sure if what I'm trying to do is what I have to do.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 835, "user_id": 1325887, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5fe8c14c0d29e8c34cfbb3820599d311?s=128&d=identicon&r=PG", "display_name": "Linh Nguyen", "link": "https://stackoverflow.com/users/1325887/linh-nguyen"}, "edited": false, "score": 0, "creation_date": 1572424898, "post_id": 58621353, "comment_id": 103551028, "body": "what key you wanna access?"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "reply_to_user": {"reputation": 835, "user_id": 1325887, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5fe8c14c0d29e8c34cfbb3820599d311?s=128&d=identicon&r=PG", "display_name": "Linh Nguyen", "link": "https://stackoverflow.com/users/1325887/linh-nguyen"}, "edited": false, "score": 0, "creation_date": 1572424961, "post_id": 58621353, "comment_id": 103551060, "body": "I try to access to &quot;value&quot;=&gt;&quot;est ce que j&#39;arrive &#224; te choper&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 10751117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwNem.jpg?s=128&g=1", "display_name": "TheDevGuy Marc", "link": "https://stackoverflow.com/users/10751117/thedevguy-marc"}, "edited": false, "score": 1, "creation_date": 1572425498, "post_id": 58621435, "comment_id": 103551297, "body": "I would choose this too because this is one of the shortest if not the shortest solutions to this problem."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 8, "last_activity_date": 1572424975, "creation_date": 1572424975, "answer_id": 58621435, "question_id": 58621353, "link": "https://stackoverflow.com/questions/58621353/how-can-i-access-value-in-deeply-nested-hash-in-ruby/58621435#58621435", "title": "How can I access value in deeply nested hash in Ruby?", "body": "<p>You can get value with <a href=\"https://ruby-doc.org/core-2.6/Hash.html#method-i-dig\" rel=\"noreferrer\">dig</a></p>\n\n<pre><code>hash.dig('content', 0, 'content', 0, 'value')\n#=&gt; \"est ce que j'arrive \u00e0 te choper\"\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58621435, "answer_count": 1, "score": 1, "last_activity_date": 1572425281, "creation_date": 1572424666, "last_edit_date": 1572425281, "question_id": 58621353, "link": "https://stackoverflow.com/questions/58621353/how-can-i-access-value-in-deeply-nested-hash-in-ruby", "title": "How can I access value in deeply nested hash in Ruby?", "body": "<p>Could someone help me to access <code>\"value\"</code> in this deeply nested hash:</p>\n\n<pre><code>hash = {\n  \"data\" =&gt; {},\n  \"content\" =&gt; [\n    {\n      \"data\" =&gt; {},\n      \"content\" =&gt; [\n        {\n          \"data\" =&gt; {},\n          \"marks\" =&gt; [],\n          \"value\" =&gt; \"est ce que j'arrive \u00e0 te choper\",\n          \"nodeType\" =&gt; \"text\"\n        }\n      ],\n      \"nodeType\" =&gt; \"paragraph\"\n    }\n  ],\n  \"nodeType\" =&gt; \"document\"\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "continuous-integration", "ruby-on-rails-6", "webpacker"], "comments": [{"owner": {"reputation": 367, "user_id": 8789323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FMAPx.png?s=128&g=1", "display_name": "Nsikan Sylvester", "link": "https://stackoverflow.com/users/8789323/nsikan-sylvester"}, "edited": false, "score": 0, "creation_date": 1572432271, "post_id": 58621271, "comment_id": 103554976, "body": "I have encountered such before, there is actually nothing wrong with your code. you could remove that test section."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1572441139, "post_id": 58621271, "comment_id": 103559874, "body": "Most of the times I got that error it was related to json parsing or malformed javascript. What&#39;s on your application layout at line 10?"}, {"owner": {"reputation": 147, "user_id": 8598954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxpJ8.jpg?s=128&g=1", "display_name": "Dmitry Matveyev", "link": "https://stackoverflow.com/users/8598954/dmitry-matveyev"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1572513606, "post_id": 58621271, "comment_id": 103585850, "body": "@arieljuod it&#39;s this line: <code>&lt;link rel=&quot;icon&quot; type=&quot;image&#47;png&quot; sizes=&quot;16x16&quot; href=&quot;&#47;favicon-16x16.png&quot;&gt;</code>"}, {"owner": {"reputation": 147, "user_id": 8598954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxpJ8.jpg?s=128&g=1", "display_name": "Dmitry Matveyev", "link": "https://stackoverflow.com/users/8598954/dmitry-matveyev"}, "reply_to_user": {"reputation": 367, "user_id": 8789323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FMAPx.png?s=128&g=1", "display_name": "Nsikan Sylvester", "link": "https://stackoverflow.com/users/8789323/nsikan-sylvester"}, "edited": false, "score": 0, "creation_date": 1572513936, "post_id": 58621271, "comment_id": 103586015, "body": "@NsikanSylvester removing test section is not going to help, it occurs randomly for any test. My problem is that it fails CI/CD process so I have to restart it."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1572526230, "post_id": 58621271, "comment_id": 103592754, "body": "I guess the error is pointing to the wrong line. I would try removing most of the code from the template and start adding it back again until I found what&#39;s triggering that. I guess it&#39;s some javascript error or json parsing error."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1587613420, "post_id": 58621271, "comment_id": 108581605, "body": "This error is strange for me: i cannot reproduce it on my system. sometimes it fails and other times it suceeds"}, {"owner": {"reputation": 311, "user_id": 1329934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8c9663603344787bfc45628ac0326a?s=128&d=identicon&r=PG", "display_name": "jellymann", "link": "https://stackoverflow.com/users/1329934/jellymann"}, "edited": false, "score": 2, "creation_date": 1591595539, "post_id": 58621271, "comment_id": 110104310, "body": "I&#39;m also getting this randomly in CI/CD. That line <code>app&#47;views&#47;layouts&#47;site&#47;application.html.erb:10</code> generally points to the <code>javascript_pack_tag</code> statement, which leads me to believe that there&#39;s some sort of race condition between the test and webpack"}], "answers": [{"tags": [], "owner": {"reputation": 352, "user_id": 287166, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153933137524460/picture?type=large", "display_name": "duleorlovic", "link": "https://stackoverflow.com/users/287166/duleorlovic"}, "is_accepted": false, "score": 0, "last_activity_date": 1574766731, "creation_date": 1574766731, "answer_id": 59049650, "question_id": 58621271, "link": "https://stackoverflow.com/questions/58621271/actionviewtemplateerror-785-unexpected-token-at/59049650#59049650", "title": "ActionView::Template::Error: 785: unexpected token at &#39;&#39;", "body": "<p>I had the same problem when I used with webmock and VCR.</p>\n\n<p>Solved adding this initializer (some <a href=\"https://github.com/bblimke/webmock/issues/163#issuecomment-37257333\" rel=\"nofollow noreferrer\">hints</a>)</p>\n\n<pre><code># config/initializers/webmock.rb\nif Rails.env.test?\n  require 'webmock'\n  WebMock.disable_net_connect!(allow_localhost: true)\nend\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2935, "user_id": 817496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/WdFnA.jpg?s=128&g=1", "display_name": "RedBassett", "link": "https://stackoverflow.com/users/817496/redbassett"}, "edited": false, "score": 0, "creation_date": 1609299303, "post_id": 63419901, "comment_id": 115804755, "body": "Also seeing the same issue in CI. I already have <code>rake webpacker:compile</code> in the workflow before tests are run. Seeing failure only on some runs. While I think the compile is finished before tests start, @jellymann is right that the occasional failure feels like some sort of race condition between those actions."}, {"owner": {"reputation": 3233, "user_id": 141774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3786bf15c95a8b2b867e0e719898802?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/141774/todd"}, "reply_to_user": {"reputation": 2935, "user_id": 817496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/WdFnA.jpg?s=128&g=1", "display_name": "RedBassett", "link": "https://stackoverflow.com/users/817496/redbassett"}, "edited": false, "score": 0, "creation_date": 1609863759, "post_id": 63419901, "comment_id": 115952134, "body": "Yeah. That sounds like a race condition to me too. FWIW, to others, I have not see this again since I made the above change. \ud83e\udd37\u200d\u2642\ufe0f"}], "tags": [], "owner": {"reputation": 3233, "user_id": 141774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3786bf15c95a8b2b867e0e719898802?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/141774/todd"}, "is_accepted": false, "score": 1, "last_activity_date": 1597438433, "creation_date": 1597438433, "answer_id": 63419901, "question_id": 58621271, "link": "https://stackoverflow.com/questions/58621271/actionviewtemplateerror-785-unexpected-token-at/63419901#63419901", "title": "ActionView::Template::Error: 785: unexpected token at &#39;&#39;", "body": "<p>Like @jellymann I was having this issue on calls to <code>javascript_pack_tag</code>.</p>\n<p>I added <code>bin/rails webpacker:compile</code> before <code>rails test</code> and it seems to have resolved the issue.</p>\n<p>This was happening pretty regularly. In the two days since I made that change, at least a dozen or so builds have gone off without this error.</p>\n"}], "owner": {"reputation": 147, "user_id": 8598954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxpJ8.jpg?s=128&g=1", "display_name": "Dmitry Matveyev", "link": "https://stackoverflow.com/users/8598954/dmitry-matveyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1597438483, "creation_date": 1572424303, "last_edit_date": 1597438483, "question_id": 58621271, "link": "https://stackoverflow.com/questions/58621271/actionviewtemplateerror-785-unexpected-token-at", "title": "ActionView::Template::Error: 785: unexpected token at &#39;&#39;", "body": "<p>This error happens randomly during testing (standard Rails testing toolkit) after running <code>rails test</code>. Failed test can be any test in any file.</p>\n\n<p>This error happens usually in testing environment during CI/CD process. Locally it occurs very rarely.</p>\n\n<p>Here is a full stack trace:</p>\n\n<pre><code>Error:\nSitePositionsControllerTest#test_should_create_position_link:\nActionView::Template::Error: 785: unexpected token at ''\n    app/views/layouts/site/application.html.erb:10\n    test/controllers/site_positions_controller_test.rb:28:in `block (2 levels) in &lt;class:SitePositionsControllerTest&gt;'\n    test/controllers/site_positions_controller_test.rb:27:in `block in &lt;class:SitePositionsControllerTest&gt;'\n    test/test_helper.rb:64:in `block (3 levels) in run'\n    test/test_helper.rb:63:in `block (2 levels) in run'\n    test/test_helper.rb:62:in `block in run'\n    test/test_helper.rb:54:in `run'\n\nrails test test/controllers/site_positions_controller_test.rb:18\n</code></pre>\n"}, {"tags": ["ruby", "graph", "traversal"], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 6708657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe34f136c0e2a6a18dd17783595aba1?s=128&d=identicon&r=PG&f=1", "display_name": "darkash", "link": "https://stackoverflow.com/users/6708657/darkash"}, "is_accepted": false, "score": 1, "last_activity_date": 1572432461, "creation_date": 1572432461, "answer_id": 58623668, "question_id": 58621151, "link": "https://stackoverflow.com/questions/58621151/ruby-finding-all-paths-through-a-graph-from-a-given-starting-point/58623668#58623668", "title": "Ruby - finding all paths through a graph from a given starting point", "body": "<p>I would do it like this, pretty sure this can be optimized further and there maybe an issue with performance too.</p>\n\n<pre><code>require 'set'\n\ndt = {\"1\"=&gt;[\"2\"], \"2\"=&gt;[\"3\", \"7\"], \"3\"=&gt;[\"4\"], \"5\"=&gt;[\"6\", \"2\"], \"6\"=&gt;[\"7\"], \"7\"=&gt;[\"8\", \"4\"]}\n\ndef traverse(initial_hash, key_arrays, traversed_keys = [])\n  value = []\n  key_arrays.map do |key|\n    n = [*traversed_keys, key]\n    value &lt;&lt; n unless n.count == 1 # prevent first key to be added\n    another_keys = initial_hash.fetch(key, nil) # try to load the value, fallback to nil if key not found\n    if another_keys.nil? # stop condition\n      value &lt;&lt; n\n    elsif another_keys.is_a?(Enumerable) # if key found\n      another_keys.map do |ank| # recursive\n        value.concat([*traverse(initial_hash, [ank], n)]) # splat operator to unpack the array\n      end\n    end\n  end\n  value.to_set # only return unique value, can be converted to array if needed\nend\n\ntraverse(dt, [1].map(&amp;:to_s)).map { |val| val.join('') }\n</code></pre>\n\n<p>Sorry, but I have not debugged your code, so I think there's an issue with the temp variable there since the path which can't be expanded anymore is carried over to next iteration.</p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1572438781, "creation_date": 1572438781, "answer_id": 58625491, "question_id": 58621151, "link": "https://stackoverflow.com/questions/58621151/ruby-finding-all-paths-through-a-graph-from-a-given-starting-point/58625491#58625491", "title": "Ruby - finding all paths through a graph from a given starting point", "body": "<p>One way to solve a recursive problem is to first break it down into a single case that is easy to solve and then generalize that one case. Here is an easier case:</p>\n\n<blockquote>\n  <p>Given a graph and path through that graph, determine which nodes can be added to the end of that path without creating a loop.</p>\n</blockquote>\n\n<p>If we can solve this problem we can easily solve the larger problem as well.</p>\n\n<ol>\n<li>Start with a path that is just your starting node</li>\n<li>Find all nodes that can be added to that path without creating a loop</li>\n<li>For each such node, output a path which is your initial path plus that node and...</li>\n<li>Recursively repeat from step 2, using the new path</li>\n</ol>\n\n<p>Note that if no new nodes are found in step 2, the recursive call will terminate because steps 3 and 4 have nothing to do.</p>\n\n<p>Here is how I would solve step 2, I'll leave the recursive part to you</p>\n\n<pre><code>def find_next_nodes graph, path\n  graph[path[-1]].reject { |node| path.include? node }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 8662399, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a0fb144a0aabe92cbcb43b9958edeb83?s=128&d=identicon&r=PG&f=1", "display_name": "erykkk", "link": "https://stackoverflow.com/users/8662399/erykkk"}, "edited": false, "score": 0, "creation_date": 1572452170, "post_id": 58628734, "comment_id": 103566504, "body": "Thanks for your answer. Is there a simple way to get rid of paths of length 1?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 119, "user_id": 8662399, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a0fb144a0aabe92cbcb43b9958edeb83?s=128&d=identicon&r=PG&f=1", "display_name": "erykkk", "link": "https://stackoverflow.com/users/8662399/erykkk"}, "edited": false, "score": 0, "creation_date": 1572452908, "post_id": 58628734, "comment_id": 103566921, "body": "I did an edit. It required only a minor change to the second line of <code>doit</code>. Please edit your question to make clear you don&#39;t want <code>[start]</code> to be one of the paths when the starting node is <code>start</code> (even though it may be implied by your desired return value). I included it initially because <code>[start]</code> is a path beginning at <code>start</code>."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572452762, "last_edit_date": 1572452762, "creation_date": 1572449184, "answer_id": 58628734, "question_id": 58621151, "link": "https://stackoverflow.com/questions/58621151/ruby-finding-all-paths-through-a-graph-from-a-given-starting-point/58628734#58628734", "title": "Ruby - finding all paths through a graph from a given starting point", "body": "<pre><code>def doit(graph, start)\n  return [] unless graph.key?(start)\n  recurse(graph, start).drop(1)\nend\n\ndef recurse(graph, start)\n  (graph[start] || []).each_with_object([[start]]) { |next_node, arr|\n    recurse(graph, next_node).each { |a| arr &lt;&lt; [start, *a] } }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>graph = { 1=&gt;[2], 2=&gt;[3, 7], 3=&gt;[4], 5=&gt;[6, 2], 6=&gt;[7], 7=&gt;[8, 4] }\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>doit(graph, 1)\n  #=&gt; [[1, 2], [1, 2, 3], [1, 2, 3, 4], [1, 2, 7], [1, 2, 7, 8],\n  #    [1, 2, 7, 4]] \ndoit(graph, 2)\n  #=&gt; [[2, 3], [2, 3, 4], [2, 7], [2, 7, 8], [2, 7, 4]] \ndoit(graph, 3)\n  #=&gt; [[3, 4]] \ndoit(graph, 5)\n  #=&gt; [[5, 6], [5, 6, 7], [5, 6, 7, 8], [5, 6, 7, 4], [5, 2],\n  #    [5, 2, 3], [5, 2, 3, 4], [5, 2, 7], [5, 2, 7, 8], [5, 2, 7, 4]] \ndoit(graph, 6)\n  #=&gt; [[6, 7], [6, 7, 8], [6, 7, 4]] \ndoit(graph, 7)\n  #=&gt; [[7, 8], [7, 4]]     \ndoit(graph, 4)\n  #=&gt; [] \ndoit(graph, 99)\n  #=&gt; [] \n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8662399, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a0fb144a0aabe92cbcb43b9958edeb83?s=128&d=identicon&r=PG&f=1", "display_name": "erykkk", "link": "https://stackoverflow.com/users/8662399/erykkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1572457871, "creation_date": 1572423768, "last_edit_date": 1572457871, "question_id": 58621151, "link": "https://stackoverflow.com/questions/58621151/ruby-finding-all-paths-through-a-graph-from-a-given-starting-point", "title": "Ruby - finding all paths through a graph from a given starting point", "body": "<p>The hash map is populated as such:</p>\n\n<pre><code>{\"1\"=&gt;[\"2\"], \"2\"=&gt;[\"3\", \"7\"], \"3\"=&gt;[\"4\"], \"5\"=&gt;[\"6\", \"2\"], \"6\"=&gt;[\"7\"], \"7\"=&gt;[\"8\", \"4\"]}\n</code></pre>\n\n<p>so that each key can have multiple values. These values represent bus stops from a set of routes e.g from bus stop 1 you can get to 2, from bus stop 2 you can get to 3 or 7 and so on. </p>\n\n<p>I am trying to traverse this graph structure and find all possible paths of length greater than 1 from a given starting point. For example, for starting point of 1, the list of all possible paths would be</p>\n\n<pre><code>[[1,2] , [1,2,3] , [1,2,3,4] , [1,2,7] , [1,2,7,8], [1,2,7,4]]\n</code></pre>\n\n<p>I am trying to solve this problem recursively, where I iterate over the children of the current key (the values of that key) and call a function which essentially expands the children of that key. Here is my code so far:</p>\n\n<pre><code>if hash.has_key?(origin.to_s)\n  tmp = origin.to_s\n  tmp &lt;&lt; hash[origin.to_s][0]\n  paths.push(tmp)\n  expand_node(hash,paths,paths.length-1,tmp[tmp.length-1])\nend\n</code></pre>\n\n<p>Origin is the starting point. To start, I add the first path (in this case <code>[1,2]</code>) to an array called <code>paths</code>, then I expand the last value added to the previous path (in this case <code>2</code>).</p>\n\n<pre><code>def expand_node(hash,paths,curr_paths_index,node)\ncurr_node = node\nif hash.has_key?(node.to_s)\n  counter = 0\n  hash[curr_node].each do |child|\n    tmp = paths[curr_paths_index]\n    tmp &lt;&lt; child\n    paths &lt;&lt; tmp\n    curr_paths_index += counter + 1\n    puts paths\n    expand_node(hash,paths,curr_paths_index,child)\n  end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>The argument <code>curr_paths_index</code> keeps track of the path from which I expand.\nThe argument <code>path</code> is the whole list of paths currently found.\nThe argument <code>node</code> is the current value being expanded.</p>\n\n<p>Printing <code>paths</code> after the function finishes yields:</p>\n\n<p><code>123\n123\n1234\n1234\n1234\n12347\n12347\n12347\n12347\n123478\n123478\n123478\n123478\n123478\n1234784\n1234784\n1234784\n1234784\n1234784\n1234784</code></p>\n\n<p>Is there any way to modify this code so that it produces the desired output (shown above)? Is there a better way of solving this problem in general?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["mysql", "ruby", "ruby-on-rails-5.1", "rails-5.1.6"], "answers": [{"comments": [{"owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "edited": false, "score": 0, "creation_date": 1572424361, "post_id": 58621260, "comment_id": 103550800, "body": "yes, it gives error as: ActiveRecord::StatementInvalid: Mysql2::Error: Expression #1 of ORDER BY clause is not in GROUP BY clause and contains nonaggregated column &#39;TukaWeb_development.comments.id&#39; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by: SELECT  jobs.id, users.first_name, users.last_name, users.email, max(comments.created_at) FROM <code>comments</code> left join jobs on jobs.id = comments.job_id left join users on users.id = jobs.user_id GROUP BY jobs.id ORDER BY <code>comments</code>.<code>id</code> DESC LIMIT 11"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "reply_to_user": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "edited": false, "score": 0, "creation_date": 1572424491, "post_id": 58621260, "comment_id": 103550860, "body": "I think that error message is saying to include  <code>comments.id</code> in the group. I sometimes have to play with the ordering of things in the group clause <code>.group(&#39;jobs.id, comments.id&#39;)</code>"}, {"owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "edited": false, "score": 0, "creation_date": 1572425353, "post_id": 58621260, "comment_id": 103551224, "body": "but the output is not correct, it is displaying all the comments on jobs, but the required is the latest comment on the jobs list."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "reply_to_user": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "edited": false, "score": 0, "creation_date": 1572425502, "post_id": 58621260, "comment_id": 103551300, "body": "I think you could take the <code>max(comments.created_at)</code> out of the select and add <code>maximum(comments.created_at)</code> to the query"}, {"owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "edited": false, "score": 0, "creation_date": 1572425821, "post_id": 58621260, "comment_id": 103551442, "body": "It gives follwing error: ActiveRecord::StatementInvalid: Mysql2::Error: FUNCTION TukaWeb_development.maximum does not exist: SELECT jobs.id, users.first_name, users.last_name, users.email, maximum(comments.created_at) FROM <code>comments</code> left join jobs on jobs.id = comments.job_id left join users on users.id = jobs.user_id GROUP BY jobs.id, comments.id ORDER BY <code>comments</code>.<code>id</code> DESC"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "reply_to_user": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "edited": false, "score": 0, "creation_date": 1572429997, "post_id": 58621260, "comment_id": 103553764, "body": "Sorry, I meant to take it out of the select query all together. ActiveRecord has a <code>maximum</code> query helper. So it might look like <code>Comment.joins(...).joins(...).select(jobs.id, users.first_name, users.last_name, users.email).maximum(&#39;comments.created_at&#39;).group(&#39;jobs.id, comments.id&#39;)</code>"}], "tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": true, "score": 3, "last_activity_date": 1572424251, "creation_date": 1572424251, "answer_id": 58621260, "question_id": 58621040, "link": "https://stackoverflow.com/questions/58621040/how-to-get-the-last-entered-record-field-in-rails-with-join-and-group-by/58621260#58621260", "title": "How to get the last entered record field in rails with join and group by?", "body": "<p>I think it's your <code>group_by</code>. That's a vanilla ruby enum. Have you tried <code>.group('jobs.id')</code>? <code>group</code> is an activerecord query helper that will run the sql group by clause</p>\n"}, {"tags": [], "owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "is_accepted": false, "score": 1, "last_activity_date": 1572424708, "creation_date": 1572424708, "answer_id": 58621361, "question_id": 58621040, "link": "https://stackoverflow.com/questions/58621040/how-to-get-the-last-entered-record-field-in-rails-with-join-and-group-by/58621361#58621361", "title": "How to get the last entered record field in rails with join and group by?", "body": "<pre><code>Comment.joins(\"left join jobs on jobs.id = comments.job_id\").joins(\"left join users on users.id = jobs.user_id\").select(\"jobs.id, users.first_name, users.last_name, users.email, max(comments.created_at)\").group(\"jobs.id, comments.id\")\n</code></pre>\n"}], "owner": {"reputation": 2566, "user_id": 1578898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13d8e2260005e30e823d507385019735?s=128&d=identicon&r=PG", "display_name": "vidur punj", "link": "https://stackoverflow.com/users/1578898/vidur-punj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58621260, "answer_count": 2, "score": 2, "last_activity_date": 1572426159, "creation_date": 1572423331, "last_edit_date": 1572426159, "question_id": 58621040, "link": "https://stackoverflow.com/questions/58621040/how-to-get-the-last-entered-record-field-in-rails-with-join-and-group-by", "title": "How to get the last entered record field in rails with join and group by?", "body": "<p>I am using rails 5.1 with ruby 2.4 and I am stuck in rails Active record query, which I have already made it in SQL but not able to replicate it in the rails way. Please suggest the right syntax, thanks in advance.\nThe Sql query is:</p>\n\n<pre><code>select jobs.id, users.first_name, users.last_name, users.email, MAX(comments.created_at) from comments left join jobs on jobs.id = comments.job_id left join users on users.id = jobs.user_id group by jobs.id;\n</code></pre>\n\n<p>The corresponding query made in rails is:</p>\n\n<pre><code>Comment.joins(\"left join jobs on jobs.id = comments.job_id\").joins(\"left join users on users.id = jobs.user_id\").select(\"jobs.id, users.first_name, users.last_name, users.email, max(comments.created_at)\").group_by(\"jobs.id\")\n</code></pre>\n\n<p>which is giving the following error:</p>\n\n<pre><code>Completed 500 Internal Server Error in 151ms (ActiveRecord: 6.1ms)\n\nArgumentError (wrong number of arguments (given 1, expected 0)):\n</code></pre>\n\n<p>The output should be as:</p>\n\n<pre><code>+-------+------------+-----------+------------------------+--------------------------+\n| id    | first_name | last_name | email                  | MAX(comments.created_at) |\n+-------+------------+-----------+------------------------+--------------------------+\n| 63606 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-18 05:19:30      |\n| 63608 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-26 09:22:21      |\n| 63610 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 12:27:24      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 12:15:36      |\n| 63684 | vidur      | punj      | vidur.punj@hotmail.com | 2019-10-15 11:46:45      |\n| 63690 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-12 05:29:04      |\n| 63694 | vidur      | punj      | vidur.punj@hotmail.com | 2019-05-23 04:03:01      |\n| 63700 | vidur      | punj      | vidur.punj@hotmail.com | 2019-05-20 10:55:31      |\n| 63701 | vidur      | punj      | vidur.punj@hotmail.com | 2019-10-19 10:07:42      |\n| 63704 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-13 09:52:50      |\n| 63705 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-11 11:16:35      |\n| 63706 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-11 11:15:21      |\n| 63708 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-13 12:44:19      |\n| 63709 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-11 11:13:48      |\n| 63717 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-17 09:42:35      |\n| 63719 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-17 10:38:51      |\n| 63726 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-20 10:55:44      |\n| 63727 | vidur      | punj      | vidur.punj@hotmail.com | 2019-06-25 04:57:45      |\n| 63741 | vidur      | punj      | vidur.punj@hotmail.com | 2019-07-22 06:51:53      |\n| 63778 | vidur      | punj      | vidur.punj@hotmail.com | 2019-09-13 11:30:56      |\n| 63801 | vidur      | punj      | vidur.punj@hotmail.com | 2019-09-16 06:55:08      |\n| 63802 | vidur      | punj      | vidur.punj@hotmail.com | 2019-09-17 03:56:27      |\n| 63815 | vidur      | punj      | vidur.punj@hotmail.com | 2019-10-30 05:43:07      |\n| 63821 | vidur      | punj      | vidur.punj@hotmail.com | 2019-10-15 10:40:54      |\n| 63839 | vidur      | punj      | vidur.punj@hotmail.com | 2019-09-23 11:07:30      |\n| 63898 | vidur      | punj      | vidur.punj@hotmail.com | 2019-10-29 07:12:15      |\n| 63916 | vidur      | punj      | vidur.punj@hotmail.com | 2019-10-15 12:51:06      |\n+-------+------------+-----------+------------------------+--------------------------+\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>+-------+------------+-----------+------------------------+--------------------------+\n| id    | first_name | last_name | email                  | max(comments.created_at) |\n+-------+------------+-----------+------------------------+--------------------------+\n| 63606 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-18 05:18:27      |\n| 63606 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-18 05:19:30      |\n| 63608 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-18 11:06:48      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 05:33:57      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:04:16      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:49:08      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:49:49      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:50:41      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:51:27      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:52:17      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:52:48      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:53:31      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:53:46      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:54:07      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:54:27      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:54:45      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:55:28      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 06:58:00      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 08:41:57      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 09:08:07      |\n| 63611 | vidur      | punj      | vidur.punj@hotmail.com | 2019-04-22 09:08:34      |\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1572420585, "post_id": 58620393, "comment_id": 103549278, "body": "Are you looking for pagination?"}, {"owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "reply_to_user": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1572420838, "post_id": 58620393, "comment_id": 103549386, "body": "no i just want to know the total size of records in data base , along with the limited record @sureshprasanna70"}, {"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "edited": false, "score": 1, "creation_date": 1572426309, "post_id": 58620393, "comment_id": 103551715, "body": "wouldn&#39;t <code>company.customers.count</code> give you the answer?"}], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 0, "last_activity_date": 1572430608, "creation_date": 1572430608, "answer_id": 58623095, "question_id": 58620393, "link": "https://stackoverflow.com/questions/58620393/how-to-add-count-with-active-record-association/58623095#58623095", "title": "How to add count with active record association?", "body": "<p>I think you should go with straight solution by using 2 queries:</p>\n\n<ul>\n<li>One for select</li>\n<li>One for total count</li>\n</ul>\n\n<p>This is the simplest solution compare to others and it's easy to understand.</p>\n\n<p>Second, I think any pagination will do, but if since you don't use all the features, not worth it.</p>\n\n<p>Not limited to that, you can still do one query, but the count will be linked to each record and the performance is nothing better.</p>\n\n<pre><code># Ref: https://stackoverflow.com/a/17206119/1600046\nrecords = company.public_send(table).joins(:customer).where(customer_id: ids).order(sorting)\nrecords = records.select(\"table_name.*, COUNT(*) OVER () as total\").limit(1)\nrecords.first.try(:total) # in case empty record\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 11697514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QhjgY7Zf-gM/AAAAAAAAAAI/AAAAAAAAAO8/YMtCCMdfz-k/photo.jpg?sz=128", "display_name": "Arianit Gerqina", "link": "https://stackoverflow.com/users/11697514/arianit-gerqina"}, "is_accepted": false, "score": 0, "last_activity_date": 1572448101, "creation_date": 1572448101, "answer_id": 58628395, "question_id": 58620393, "link": "https://stackoverflow.com/questions/58620393/how-to-add-count-with-active-record-association/58628395#58628395", "title": "How to add count with active record association?", "body": "<p>The only way to do it with one query is to use <code>except</code>, which in my opinion is not the cleanest way but does what you need.</p>\n\n<p>So, in your case <code>total_count = records.limit(5).except(:limit).count</code></p>\n"}], "owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572448101, "creation_date": 1572420459, "question_id": 58620393, "link": "https://stackoverflow.com/questions/58620393/how-to-add-count-with-active-record-association", "title": "How to add count with active record association?", "body": "<p>My Requirement is to send the count size of the database with active record association</p>\n\n<p>I am trying to limit the size of record and want to load more options and clicking on load more will give all records</p>\n\n<pre><code>records = company.public_send(table).joins(:customer).where(customer_id: ids).order(sorting)\n#records = records.count(:id) #300\nrecords = records.limit(5)\n</code></pre>\n\n<p>This return me active record, along with this i want to send entire size of record \nHow can i do it</p>\n"}, {"tags": ["ruby", "compilation", "executable", "packaging"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1572420904, "post_id": 58619717, "comment_id": 103549415, "body": "The typical way it to make a gem containing an <a href=\"https://guides.rubygems.org/make-your-own-gem/#adding-an-executable\" rel=\"nofollow noreferrer\">executable</a>. Your users can then install it via <code>gem install</code> and run your executable."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572422619, "post_id": 58619717, "comment_id": 103550070, "body": "@anothermh the OP said <i>&quot;to be run in a *nix operating systems with Ruby versions &gt;= 2.5&quot;</i> so I assumed Ruby to be installed already."}, {"owner": {"reputation": 1075, "user_id": 3788114, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1738862bbad9bd9d43cd5a4bf940ed2e?s=128&d=identicon&r=PG", "display_name": "codematix", "link": "https://stackoverflow.com/users/3788114/codematix"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1572431867, "post_id": 58619717, "comment_id": 103554771, "body": "@Stefan, @anothermh Thanks for the idea of <code>gem install</code>. But the gem I am writing is internal to my organization and we do not have our own RubyGems repository. I would not be able to publish it to public repository. I&#39;d like to understand how they package Vagrant to be a single binary. Any thoughts?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572449907, "post_id": 58619717, "comment_id": 103565139, "body": "Looks like my comment was removed for using the F word. I had essentially said it sounded like OP was asking for a single binary with both the runtime and the gem based on the words &quot;a single binary that contains my Ruby gem along with a Ruby runtime&quot;. If OP could elaborate it would help, but if that&#39;s their goal then it&#39;s probably going to be a nightmare to do based on my past experience of doing the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 1075, "user_id": 3788114, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1738862bbad9bd9d43cd5a4bf940ed2e?s=128&d=identicon&r=PG", "display_name": "codematix", "link": "https://stackoverflow.com/users/3788114/codematix"}, "edited": false, "score": 0, "creation_date": 1572431704, "post_id": 58620836, "comment_id": 103554697, "body": "Any idea what vagrant uses to create a single binary?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 1075, "user_id": 3788114, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1738862bbad9bd9d43cd5a4bf940ed2e?s=128&d=identicon&r=PG", "display_name": "codematix", "link": "https://stackoverflow.com/users/3788114/codematix"}, "edited": false, "score": 1, "creation_date": 1572438245, "post_id": 58620836, "comment_id": 103558176, "body": "I think they have something that does something similar to ruby packer, the go source is here: <a href=\"https://github.com/hashicorp/vagrant-installers/blob/master/substrate/launcher/main.go\" rel=\"nofollow noreferrer\">github.com/hashicorp/vagrant-installers/blob/master/substrat&zwnj;&#8203;e/&hellip;</a>"}, {"owner": {"reputation": 267, "user_id": 499915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cef5911efac4f3efa2d0aa2daf051bca?s=128&d=identicon&r=PG", "display_name": "Vitaly", "link": "https://stackoverflow.com/users/499915/vitaly"}, "edited": false, "score": 0, "creation_date": 1576006519, "post_id": 58620836, "comment_id": 104755508, "body": "Sorry for hijacking this thread, but can tell me is I need 32 or 64 bit Ruby and MS VS versions?  And if rubyc 0.4.0 support Ruby2.6?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 267, "user_id": 499915, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cef5911efac4f3efa2d0aa2daf051bca?s=128&d=identicon&r=PG", "display_name": "Vitaly", "link": "https://stackoverflow.com/users/499915/vitaly"}, "edited": false, "score": 1, "creation_date": 1576230129, "post_id": 58620836, "comment_id": 104839875, "body": "@Vitaly the ruby-packer has been quite unmaintained for a while, i don&#39;t think there&#39;s a ruby 2.6 version. I think you can compile it on a 32bit windows and it should work."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 2, "last_activity_date": 1572422790, "last_edit_date": 1572422790, "creation_date": 1572422348, "answer_id": 58620836, "question_id": 58619717, "link": "https://stackoverflow.com/questions/58619717/single-executable-binary-of-ruby-gem/58620836#58620836", "title": "Single executable binary of Ruby gem", "body": "<p>There's <a href=\"https://github.com/pmq20/ruby-packer\" rel=\"nofollow noreferrer\">ruby-packer</a> but the repo has been dead for a while. There are forks with Ruby 2.5. It can produce binaries for Linux, Mac, Windows and probably some others.</p>\n\n<p>For linux based systems you could use <a href=\"https://appimage.org/\" rel=\"nofollow noreferrer\">AppImage</a> (there are some scripts found on google that put a ruby in the image) or maybe <a href=\"https://snapcraft.io/#ruby\" rel=\"nofollow noreferrer\">Snapcraft</a>.</p>\n\n<p>When you have ruby-packer and the dependencies installed, it's just a matter of <code>rubyc -o binary-name gem-executable-name</code> in the app's directory. Takes about 15 minutes to compile.</p>\n"}], "owner": {"reputation": 1075, "user_id": 3788114, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1738862bbad9bd9d43cd5a4bf940ed2e?s=128&d=identicon&r=PG", "display_name": "codematix", "link": "https://stackoverflow.com/users/3788114/codematix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 58620836, "answer_count": 1, "score": 0, "last_activity_date": 1572422790, "creation_date": 1572416910, "question_id": 58619717, "link": "https://stackoverflow.com/questions/58619717/single-executable-binary-of-ruby-gem", "title": "Single executable binary of Ruby gem", "body": "<p>What options are available to create a single binary that contains my Ruby gem along with a Ruby runtime?</p>\n\n<p>My goal is to be able to share the executable with another developer and they could simply run the executable from their command line passing it required arguments similar to Vagrant.</p>\n\n<p>P.S. The program is intended to be run in a *nix operating systems with Ruby versions >= 2.5.</p>\n"}, {"tags": ["ruby", "xml", "parsing", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572843883, "post_id": 58619442, "comment_id": 103673370, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. We need to see what you tried, not just what you want to have happen. Beyond that, yes, Nokogiri&#39;s documentation is deep, because it&#39;s a complex and complicated tool. It requires time to understand how to use it but warrants the time spent to learn it because it can do a lot. But, &quot;badly documented&quot;? Nope. It&#39;s all there, but you&#39;re going to have to spend time learning it, like you would using Net::HTTP, any good SQL gem, etc."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572844103, "post_id": 58628343, "comment_id": 103673412, "body": "Nokogiri allows you to use either XPath or CSS accessors. Which you chose to use is up to you; Each has its moment. But, really the documentation is very thorough and in depth, but it&#39;s a complex subject and has a definite learning curve, but that&#39;s not Nokogiri&#39;s fault, it&#39;s the result of working with HTML and XML which are not exactly simple subjects. SO is full of examples of how to read and write XML/HTML and parse and munge it using Nokogiri."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572990251, "post_id": 58628343, "comment_id": 103732667, "body": "I&#39;d recommend checking the output file. The output isn&#39;t going to be a valid XML."}, {"owner": {"reputation": 701, "user_id": 1927177, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/kFCrf.jpg?s=128&g=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/1927177/henri"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573070073, "post_id": 58628343, "comment_id": 103765149, "body": "Yes that is true. I had to add the header but it worked great."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573074764, "post_id": 58628343, "comment_id": 103767096, "body": "Properly used, Nokogiri will retain the structure so you won&#39;t have to do that."}], "tags": [], "owner": {"reputation": 701, "user_id": 1927177, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/kFCrf.jpg?s=128&g=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/1927177/henri"}, "is_accepted": false, "score": -1, "last_activity_date": 1572988455, "last_edit_date": 1572988455, "creation_date": 1572447925, "answer_id": 58628343, "question_id": 58619442, "link": "https://stackoverflow.com/questions/58619442/how-to-remove-an-element-from-xml-using-nokogiri/58628343#58628343", "title": "How to remove an element from XML using Nokogiri", "body": "<p>Nokogiri uses XPath and with that I could query the XML file:</p>\n\n<p>It is as easy as this:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = File.open(\"file_with_your.xml\") { |f| Nokogiri::XML(f) }   // load your file with xml content\n\nc = doc.xpath(\"//product[price!=0]\")                             //this is the query\nputs c                                                           // you can print the results\nFile.open(\"myfile.xml\", \"w+\") do |f|                             // and create another file\n  f &lt;&lt; c\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1572989854, "creation_date": 1572989854, "answer_id": 58719843, "question_id": 58619442, "link": "https://stackoverflow.com/questions/58619442/how-to-remove-an-element-from-xml-using-nokogiri/58719843#58719843", "title": "How to remove an element from XML using Nokogiri", "body": "<p>This is more idiomatic Nokogiri and Ruby code:</p>\n\n<pre><code>require 'nokogiri'\n\nxml =&lt;&lt;EOT\n &lt;products&gt;\n    &lt;product&gt;\n      &lt;name&gt; product1 &lt;/name&gt;\n      &lt;price&gt; 21 &lt;/price&gt;\n    &lt;/product&gt;\n    &lt;product&gt;\n      &lt;name&gt; product2 &lt;/name&gt;\n      &lt;price&gt; 0 &lt;/price&gt;\n    &lt;/product&gt;\n        &lt;product&gt;\n      &lt;name&gt; product3 &lt;/name&gt;\n      &lt;price&gt; 10 &lt;/price&gt;\n    &lt;/product&gt;\n  &lt;/products&gt;\nEOT\n\ndoc = Nokogiri::XML(xml)\n\n# strip the offending nodes\ndoc.xpath('//product/price[text()=\" 0 \"]/..').remove\n</code></pre>\n\n<p>At this point the resulting XML looks like:</p>\n\n<pre><code>doc.to_xml\n# =&gt; \"&lt;?xml version=\\\"1.0\\\"?&gt;\\n\" +\n#    \"&lt;products&gt;\\n\" +\n#    \"    &lt;product&gt;\\n\" +\n#    \"      &lt;name&gt; product1 &lt;/name&gt;\\n\" +\n#    \"      &lt;price&gt; 21 &lt;/price&gt;\\n\" +\n#    \"    &lt;/product&gt;\\n\" +\n#    \"    \\n\" +\n#    \"        &lt;product&gt;\\n\" +\n#    \"      &lt;name&gt; product3 &lt;/name&gt;\\n\" +\n#    \"      &lt;price&gt; 10 &lt;/price&gt;\\n\" +\n#    \"    &lt;/product&gt;\\n\" +\n#    \"  &lt;/products&gt;\\n\"\n</code></pre>\n\n<p>Then simply <code>write</code> it:</p>\n\n<pre><code>File.write('myfile.xml', doc.to_xml)\n</code></pre>\n"}], "owner": {"reputation": 701, "user_id": 1927177, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/kFCrf.jpg?s=128&g=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/1927177/henri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58719843, "answer_count": 2, "score": -1, "last_activity_date": 1581290610, "creation_date": 1572414986, "last_edit_date": 1581290610, "question_id": 58619442, "link": "https://stackoverflow.com/questions/58619442/how-to-remove-an-element-from-xml-using-nokogiri", "title": "How to remove an element from XML using Nokogiri", "body": "<p>Given this HTML:</p>\n\n<pre><code> &lt;products&gt;\n    &lt;product&gt;\n      &lt;name&gt; product1 &lt;/name&gt;\n      &lt;price&gt; 21 &lt;/price&gt;\n    &lt;/product&gt;\n    &lt;product&gt;\n      &lt;name&gt; product2 &lt;/name&gt;\n      &lt;price&gt; 0 &lt;/price&gt;\n    &lt;/product&gt;\n        &lt;product&gt;\n      &lt;name&gt; product3 &lt;/name&gt;\n      &lt;price&gt; 10 &lt;/price&gt;\n    &lt;/product&gt;\n  &lt;/products&gt;\n</code></pre>\n\n<p>I want to recreate an XML file using Nokogiri but I want to remove the elements where \"products price = 0\" so it looks like:</p>\n\n<pre><code> &lt;products&gt;\n    &lt;product&gt;\n      &lt;name&gt; product1 &lt;/name&gt;\n      &lt;price&gt; 21 &lt;/price&gt;\n    &lt;/product&gt;\n    &lt;product&gt;\n      &lt;name&gt; product3 &lt;/name&gt;\n      &lt;price&gt; 10 &lt;/price&gt;\n    &lt;/product&gt;\n  &lt;/products&gt;\n</code></pre>\n\n<p>I tried lots of things but nothing seems to work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1572417085, "post_id": 58618629, "comment_id": 103548117, "body": "You tagged your question with <code>ruby-on-rails</code> I wonder why you build that HTML snippet by string concatenation and do not use a view for that?"}, {"owner": {"reputation": 19, "user_id": 12219932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7W7pqQWGlgh6CRr54GiTb2foeG-4vFR-GG3D7=k-s128", "display_name": "Ruchira Bandara", "link": "https://stackoverflow.com/users/12219932/ruchira-bandara"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1572427477, "post_id": 58618629, "comment_id": 103552360, "body": "Hey. This code snippet have been added in the controller itself. I was given this project to work...."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 12219932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7W7pqQWGlgh6CRr54GiTb2foeG-4vFR-GG3D7=k-s128", "display_name": "Ruchira Bandara", "link": "https://stackoverflow.com/users/12219932/ruchira-bandara"}, "edited": false, "score": 0, "creation_date": 1572410427, "post_id": 58618680, "comment_id": 103546587, "body": "Thanks. It worked. I corrected it in this way. (!search.nil? ? link_to(&#39;Clear&#39;, root_path, class: &#39;clearingLink&#39;) : &quot;&quot;) &lt;&lt;"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1572452224, "post_id": 58618680, "comment_id": 103566536, "body": "&quot;Solution: add parentheses to ensure the desired evaluation order.&quot; \u2013 Personally, I prefer the following solution: never use the conditional operator. It is not necessary in Ruby. The conditional operator exists in C, because operators are expressions and <code>if</code> is a statement, so if you want to use a conditional expression, you need the conditional operator. But in Ruby, <code>if</code> is a conditional expression, so there is no need for the conditional operator, it is completely useless. A large amount of questions on <a href=\"https://stackoverflow.com\">Stack Overflow</a> involving the conditional operator in Ruby turn out to be precedence problems, \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1572452348, "post_id": 58618680, "comment_id": 103566607, "body": "\u2026 whereas the conditional expression just has the precedence you would expect it to have: <code>unless search.nil? then link_to(&#39;Clear&#39;, root_path, class: &#39;clearingLink&#39;) else &quot;&quot; &lt;&lt; &#39;&lt;&#47;form&gt;&#39; &lt;&lt; &#39;&lt;&#47;span&gt;&#39; &lt;&lt; form_focus(&#39;search&#39;)) end</code>."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1572409005, "creation_date": 1572409005, "answer_id": 58618680, "question_id": 58618629, "link": "https://stackoverflow.com/questions/58618629/ruby-no-implicit-conversion-of-false-into-string/58618680#58618680", "title": "Ruby - No implicit conversion of false into String", "body": "<p><code>\"str\" &lt;&lt; false</code> is the minimal example for the error you are experiencing. The error is the result of misunderstanding relating to operator precedence. Notably, <code>?:</code> is of lower precedence than <code>&lt;&lt;</code>; so</p>\n\n<pre><code>a &lt;&lt; b ? c : d &lt;&lt; e\n</code></pre>\n\n<p>(where <code>b</code> is your <code>!search.nil?</code>) evaluates as</p>\n\n<pre><code>(a &lt;&lt; b) ? c : (d &lt;&lt; e)\n</code></pre>\n\n<p>while you hoped it would evaluate as</p>\n\n<pre><code>a &lt;&lt; (b ? c : d) &lt;&lt; e\n</code></pre>\n\n<p>Solution: add parentheses to ensure the desired evaluation order.</p>\n"}], "owner": {"reputation": 19, "user_id": 12219932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7W7pqQWGlgh6CRr54GiTb2foeG-4vFR-GG3D7=k-s128", "display_name": "Ruchira Bandara", "link": "https://stackoverflow.com/users/12219932/ruchira-bandara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572409005, "creation_date": 1572408568, "question_id": 58618629, "link": "https://stackoverflow.com/questions/58618629/ruby-no-implicit-conversion-of-false-into-string", "title": "Ruby - No implicit conversion of false into String", "body": "<p>I am getting the following error with the code explained below.\n\"no implicit conversion of false into String\"</p>\n\n<pre><code>  def search_form(target, search)\n    raw(\"&lt;span class='no_print'&gt;\" &lt;&lt;\n            form_tag('/' + target + '/', :method =&gt; :get) &lt;&lt;\n            text_field_tag(:search, search) &lt;&lt;\n            submit_tag('Search', data: { disable_with: \"Searching...\" }) &lt;&lt;\n            !search.nil? ? link_to('Clear', root_path, class: 'clearingLink') : \"\" &lt;&lt;\n            '&lt;/form&gt;' &lt;&lt;\n            '&lt;/span&gt;' &lt;&lt;\n            form_focus('search'))\n  end\n\n!search.nil? ? link_to('Clear', root_path, class: 'clearingLink') : \"\" &lt;&lt;\nThis is the line I have added recently. Can anyone please let me know what is the wrong with this ?\n</code></pre>\n"}, {"tags": ["ruby", "floating-point", "sketchup"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572408416, "post_id": 58618601, "comment_id": 103546188, "body": "Just assign it. They\u2019re integral types, they can\u2019t be cloned."}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572408617, "post_id": 58618601, "comment_id": 103546226, "body": "Not for 1001 times, I&#39;m not...any other ways or is that literally the only way to do it?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572408670, "post_id": 58618601, "comment_id": 103546234, "body": "Why would you need another way to do it than simple assignment?"}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572408750, "post_id": 58618601, "comment_id": 103546250, "body": "As in simply use <code>b=a</code>?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572408768, "post_id": 58618601, "comment_id": 103546252, "body": "Yes, exactly like that"}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572408993, "post_id": 58618601, "comment_id": 103546292, "body": "With Ruby, if <code>b = a</code> I go <code>b += 1</code> we have a problem, because <code>b == 2.1</code> <b>and</b> <code>a == 2.1</code>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1572409172, "post_id": 58618601, "comment_id": 103546331, "body": "@Poyda: That&#39;s not how primitive types work. Try it yourself."}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572409488, "post_id": 58618601, "comment_id": 103546381, "body": "@SamiKuhmonen &amp; Amadan: Thanks for pointing that out. See updated question."}, {"owner": {"reputation": 139290, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1572418642, "post_id": 58618601, "comment_id": 103548584, "body": "@SamiKuhmonen: What do you mean by \u201cThey\u2019re integral types\u201d?"}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572414327, "post_id": 58619202, "comment_id": 103547416, "body": "sorry, I didn&#39;t explain myself very well. This now messes with the x and a values, and I don&#39;t want it to do that."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572414416, "post_id": 58619202, "comment_id": 103547432, "body": "Ah, I didn&#39;t notice <code>a</code> and <code>x</code> were unchanged. Will change in a sec."}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572414992, "post_id": 58619202, "comment_id": 103547572, "body": "Just to let you know I was using Ruby in  Sketchup. Should I close this question because it <i>does</i> work in Ruby, or edit it?"}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572491653, "post_id": 58619202, "comment_id": 103579445, "body": "The second option works in Sketchup, however in both Ruby and Sketchup Ruby, I have the result <code>3.3000000000000003</code> if one of the values is <code>3.3</code>?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572491967, "post_id": 58619202, "comment_id": 103579520, "body": "Yep, not Ruby&#39;s fault: check out <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>. In Ruby you can use <a href=\"https://ruby-doc.org/core-2.5.0/Rational.html\" rel=\"nofollow noreferrer\">other datatypes</a> to overcome it; for example, <code>(1.1r + 2.2r).to_f</code> will give you <code>3.3</code>."}, {"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572826562, "post_id": 58619202, "comment_id": 103670517, "body": "as in change over the floats to rationals, then back again...right, thanks for that"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 0, "last_activity_date": 1572414538, "last_edit_date": 1572414538, "creation_date": 1572412977, "answer_id": 58619202, "question_id": 58618601, "link": "https://stackoverflow.com/questions/58618601/duplicate-a-floating-point-number-with-ruby-in-sketchup/58619202#58619202", "title": "Duplicate a floating point number with Ruby in Sketchup", "body": "<p>I can't see what your updated question has to do with the original one, but here's two ways to do what you wanted:</p>\n\n<pre><code>b = [a.dup, b.dup]\nb[0][1] += 1.1\nb[1][1] += 1.1\n</code></pre>\n\n<p>or</p>\n\n<pre><code>b.map! { |r| r.dup.tap { |r2| r2[1] += 1.1 } }\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 58619202, "answer_count": 1, "score": -2, "last_activity_date": 1572478902, "creation_date": 1572408286, "last_edit_date": 1572466828, "question_id": 58618601, "link": "https://stackoverflow.com/questions/58618601/duplicate-a-floating-point-number-with-ruby-in-sketchup", "title": "Duplicate a floating point number with Ruby in Sketchup", "body": "<p>Is it possible to duplicate a float number array as a variable to a new variable in <strong>ruby with sketchup</strong>? I have tried both .clone and .dup, but no luck (see below).</p>\n\n<pre><code>a = [1.1,2.2,3.3]\nb = [a.dup,a.dup,a.dup] #Returns \"TypeError: can't dup Float\"\nb = [a.clone,a.clone,a.clone] #Returns \"TypeError: can't clone Float\"\n</code></pre>\n\n<p>Any other ways of duplicating an arrayed variable containing floats in <strong>ruby with sketchup</strong>?</p>\n\n<p>EDIT:\nThis is what I am trying to do:</p>\n\n<pre><code>a = [1.1,2.2,3.3]\nx = [4.4,5.5,6.6]\nb = [a,x]\nb[0][1] += 1.1\nb[1][1] += 1.1\n</code></pre>\n\n<p>so that <code>a == [1.1,2.2,3.3]</code>, <code>x == [4.4,5.5,6.6]</code> and <code>b == [[1.1,3.3,3.3],[4.4,6.6,6.6]]</code></p>\n\n<p>I now realise that both .clone and .dup work in Ruby itself (Thanks to Amadan and Sami Kuhmonen)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rubygems", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1106, "user_id": 6454624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-54Cw2TNXh84/AAAAAAAAAAI/AAAAAAAAAC4/Ivxon84Rp4k/photo.jpg?sz=128", "display_name": "Adim", "link": "https://stackoverflow.com/users/6454624/adim"}, "edited": false, "score": 0, "creation_date": 1578992698, "post_id": 58618308, "comment_id": 105610199, "body": "Can we see the contents of your /var/www/myapp/code/config/environments/production.rb:71. From what it appears, you may need to provide the <code>URL_HOST</code> environment variable"}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 8123767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a03359998070fd987e13beb3a55c974?s=128&d=identicon&r=PG&f=1", "display_name": "SBN", "link": "https://stackoverflow.com/users/8123767/sbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1572410634, "creation_date": 1572410634, "answer_id": 58618886, "question_id": 58618308, "link": "https://stackoverflow.com/questions/58618308/rake-dbsetup-shows-rake-aborted-keyerror-key-not-found-url-host-error/58618886#58618886", "title": "rake db:setup shows rake aborted! KeyError: key not found: &quot;URL_HOST&quot; error", "body": "<p>Seems like some config settings for URL_HOST is missing.</p>\n"}], "owner": {"reputation": 21, "user_id": 10620965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tLUud.jpg?s=128&g=1", "display_name": "Karim Chowdhury", "link": "https://stackoverflow.com/users/10620965/karim-chowdhury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572410634, "creation_date": 1572405730, "question_id": 58618308, "link": "https://stackoverflow.com/questions/58618308/rake-dbsetup-shows-rake-aborted-keyerror-key-not-found-url-host-error", "title": "rake db:setup shows rake aborted! KeyError: key not found: &quot;URL_HOST&quot; error", "body": "<p>i have rails app ubuntu 18.04. bundle install run successful but when i run rake db:setup it shows </p>\n\n<p>rake aborted!\nKeyError: key not found: \"URL_HOST\"\n/var/www/myapp/code/config/environments/production.rb:71:in <code>fetch'\n/var/www/myapp/code/config/environments/production.rb:71:in</code>block in '\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/railtie.rb:210:in <code>instance_eval'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/railtie.rb:210:in</code>configure'\n/var/www/myapp/code/config/environments/production.rb:3:in <code>&lt;top (required)&gt;'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:274:in</code>require'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:274:in <code>block in require'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:240:in</code>load_dependency'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:274:in <code>require'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/engine.rb:598:in</code>block (2 levels) in '\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/engine.rb:597:in <code>each'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/engine.rb:597:in</code>block in '\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/initializable.rb:30:in <code>instance_exec'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/initializable.rb:30:in</code>run'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/initializable.rb:55:in <code>block in run_initializers'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/initializable.rb:44:in</code>each'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/initializable.rb:44:in <code>tsort_each_child'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/initializable.rb:54:in</code>run_initializers'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/application.rb:352:in <code>initialize!'\n/var/www/myapp/code/config/environment.rb:5:in</code>'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:274:in <code>require'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:274:in</code>block in require'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:240:in <code>load_dependency'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/activesupport-4.2.11.1/lib/active_support/dependencies.rb:274:in</code>require'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/application.rb:328:in <code>require_environment!'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/railties-4.2.11.1/lib/rails/application.rb:457:in</code>block in run_tasks_blocks'\n/home/myappuser/.rvm/gems/ruby-2.5.0/gems/rake-13.0.0/exe/rake:27:in <code>&lt;top (required)&gt;'\n/home/myappuser/.rvm/gems/ruby-2.5.0/bin/ruby_executable_hooks:24:in</code>eval'\n/home/myappuser/.rvm/gems/ruby-2.5.0/bin/ruby_executable_hooks:24:in `'\nTasks: TOP => db:setup => db:schema:load_if_ruby => environment\n(See full trace by running task with --trace)</p>\n\n<p>Need help</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis", "ruby-on-rails-5", "rspec-rails"], "comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 2, "creation_date": 1572440357, "post_id": 58617727, "comment_id": 103559425, "body": "Why are you updating last name in a job? Also, if you insist (or need to for some reason) to keep this technique, then you should probably test the two things separately. Test the job on its own, and test that the update method in the model calls the job."}, {"owner": {"reputation": 49, "user_id": 10515650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tpv4j6ld-A8/AAAAAAAAAAI/AAAAAAAAAC0/795jKrR-hCU/photo.jpg?sz=128", "display_name": "Miguel Moncada", "link": "https://stackoverflow.com/users/10515650/miguel-moncada"}, "reply_to_user": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 0, "creation_date": 1572456595, "post_id": 58617727, "comment_id": 103568774, "body": "Can you explain me a little bot more? I&#39;m learning about Rspec, how can I set up the second option?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 10515650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tpv4j6ld-A8/AAAAAAAAAAI/AAAAAAAAAC0/795jKrR-hCU/photo.jpg?sz=128", "display_name": "Miguel Moncada", "link": "https://stackoverflow.com/users/10515650/miguel-moncada"}, "edited": false, "score": 0, "creation_date": 1572452635, "post_id": 58627088, "comment_id": 103566784, "body": "please! Can you tell me what I have to do? I&#39;m starting to learn."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572810888, "post_id": 58627088, "comment_id": 103667385, "body": "Why do you assume Sidekiq is being used?"}, {"owner": {"reputation": 2370, "user_id": 201121, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XqkvF.jpg?s=128&g=1", "display_name": "johnnycakes", "link": "https://stackoverflow.com/users/201121/johnnycakes"}, "edited": false, "score": 0, "creation_date": 1573057257, "post_id": 58627088, "comment_id": 103759042, "body": "Ah, good point.  I thought I saw mention of Sidekiq, but it looks there was none."}], "tags": [], "owner": {"reputation": 2370, "user_id": 201121, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XqkvF.jpg?s=128&g=1", "display_name": "johnnycakes", "link": "https://stackoverflow.com/users/201121/johnnycakes"}, "is_accepted": false, "score": 1, "last_activity_date": 1573057389, "last_edit_date": 1573057389, "creation_date": 1572444048, "answer_id": 58627088, "question_id": 58617727, "link": "https://stackoverflow.com/questions/58617727/can-rspec-wait-for-an-answer-from-a-applicationjob/58627088#58627088", "title": "Can Rspec wait for an answer from a ApplicationJob?", "body": "<p>If using Sidekiq, declare <code>Sidekiq::Testing.inline!</code> in your test or in a <code>before</code> block.</p>\n"}, {"comments": [{"owner": {"reputation": 3706, "user_id": 3700798, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LpxP2.png?s=128&g=1", "display_name": "svelandiag", "link": "https://stackoverflow.com/users/3700798/svelandiag"}, "edited": false, "score": 0, "creation_date": 1618777043, "post_id": 58629758, "comment_id": 118699368, "body": "Does it work if you&#39;re using sidekiq with ActiveJob as described here? <a href=\"https://github.com/mperham/sidekiq/wiki/Active-Job\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq/wiki/Active-Job</a>"}], "tags": [], "owner": {"reputation": 49, "user_id": 10515650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tpv4j6ld-A8/AAAAAAAAAAI/AAAAAAAAAC0/795jKrR-hCU/photo.jpg?sz=128", "display_name": "Miguel Moncada", "link": "https://stackoverflow.com/users/10515650/miguel-moncada"}, "is_accepted": false, "score": 1, "last_activity_date": 1572452431, "creation_date": 1572452431, "answer_id": 58629758, "question_id": 58617727, "link": "https://stackoverflow.com/questions/58617727/can-rspec-wait-for-an-answer-from-a-applicationjob/58629758#58629758", "title": "Can Rspec wait for an answer from a ApplicationJob?", "body": "<p>I resolved in this way:</p>\n\n<pre><code>require 'rails_helper'\nRSpec.describe User, type: :model do\n\n  include ActiveJob::TestHelper\n\n  let(:user) { user.create(name: \"Test User Name\",last_name: \"\") }\n\n\n  describe \"existing user instance\" do\n    it \"fetch last name\" do\n      user.update_last_name!\n      # update_last_name! is calling a background job, so the result will not be ready yet.\n      expect(user.last_name).to eq(\"\")\n      # This line is goint to execute the backgound job\n      perform_enqueued_jobs\n      # Models reload with new data\n      user.reload\n      # Will work!\n      expect(user.last_name).to eq(\"Test Last Name\")\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10515650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tpv4j6ld-A8/AAAAAAAAAAI/AAAAAAAAAC0/795jKrR-hCU/photo.jpg?sz=128", "display_name": "Miguel Moncada", "link": "https://stackoverflow.com/users/10515650/miguel-moncada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573057389, "creation_date": 1572400554, "last_edit_date": 1572422114, "question_id": 58617727, "link": "https://stackoverflow.com/questions/58617727/can-rspec-wait-for-an-answer-from-a-applicationjob", "title": "Can Rspec wait for an answer from a ApplicationJob?", "body": "<p>I'm learning about RSpec, and I'm calling a method inside a model, from spec file, but the method have a background job, my questions are; How can I set spec to waiting for a response from the backgroound job? Is it possible?</p>\n\n<p>Thanks for your help!!!! </p>\n\n<p>My Rspec File: user_spec.rb</p>\n\n<pre><code>require 'rails_helper'\nRSpec.describe User, type: :model do\n  let(:user) { user.create(name: \"Test User Name\",last_name: \"\") }\n  describe \"existing user instance\" do\n    it \"fetch last name\" do\n      user.update_last_name!\n      expect(user.last_name).to eq(\"Test Last Name\")\n    end\n  end\nend\n</code></pre>\n\n<p>My Model File: user.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n  def update_last_name!\n    UpdateLastNameJob.perform_later(self.id,\"Test Last Name\")\n  end\n\nend\n</code></pre>\n\n<p>My Background Job Working in reddis: update_last_name_job.rb</p>\n\n<pre><code>class UpdateLastNameJob &lt; ApplicationJob\n  @queue = :default\n  def perform(user_id,last_name)\n    @user = User.find(user_id)\n    @user.last_name = last_name\n    @user.save\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 974, "user_id": 10719564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/389a0f44307d1c137d141f7d7025c009?s=128&d=identicon&r=PG&f=1", "display_name": "mph85", "link": "https://stackoverflow.com/users/10719564/mph85"}, "edited": false, "score": 0, "creation_date": 1572396148, "post_id": 58617252, "comment_id": 103543880, "body": "try flattening it first, <code>flat_arr = arr.flatten</code>, and go from there"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572401832, "post_id": 58617252, "comment_id": 103544926, "body": "Please edit to show your desired result. Is it <code>[[1+5,2,3+5],[4+5,5,6+5],[7+5,8,9+5]]</code> or <code>[[1,2+5,3],[4,5+5,6],[7,8+5,9]]</code> or <code>[[1+5,2,3+5],[4,5+5,6],[7+5,8,9+5]]</code> or something else? Usually when one says &quot;every second element&quot; or &quot;every other element&quot;, it begins with the first element. Since you have stated otherwise, presumably <code>arr</code> can have an arbitrary number of elements (arrays) and each element of <code>arr</code> (an array) can have an arbitrary number of elements."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572396319, "post_id": 58617292, "comment_id": 103543912, "body": "Oooh, righto thanks. I was overthinking the problem \ud83d\ude44 Thanks for the quick reply too!!"}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "reply_to_user": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "edited": false, "score": 0, "creation_date": 1572396539, "post_id": 58617292, "comment_id": 103543961, "body": "If my reply answered your question, please click the check mark next to the answer to indicate that it&#39;s the desired answer. Welcome to Stack Overflow!"}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 2, "last_activity_date": 1572396647, "last_edit_date": 1572396647, "creation_date": 1572396273, "answer_id": 58617292, "question_id": 58617252, "link": "https://stackoverflow.com/questions/58617252/quicker-way-of-adding-x-to-every-second-element-in-all-nested-arrays/58617292#58617292", "title": "Quicker way of adding x to every second element in all nested arrays", "body": "<p>Any time you find yourself writing that kind of code over and over, you should look to use a loop! Ruby commonly uses <a href=\"http://ruby-for-beginners.rubymonstas.org/blocks/iterators.html\" rel=\"nofollow noreferrer\">iterators</a> for performing looping. <a href=\"https://ruby-doc.org/core-2.4.1/Array.html#method-i-each\" rel=\"nofollow noreferrer\">Array#each</a> is an iterator which loops over an Array, and lets you operate on each element one at a time.</p>\n\n<p>Since you know that you want to add x to the second element in each, this is trivially:</p>\n\n<pre><code>arr.each {|e| e[1] += x }\n</code></pre>\n\n<p>This mutates <code>arr</code> (and <code>arr</code>'s subarrays) in place. If you want to return a mutated copy, you would use <code>map</code>, which is like <code>each</code> except the return value is the <em>output</em> of the block, rather than the <em>input</em> to it.</p>\n\n<pre><code># First we clone each subarray with Array#dup, then we iterate the\n# clones, adding x to the second element. Because we're using `map`\n# the result will be a new array, rather than the original arr, leaving\n# the original unmodified.\nnew_arr = arr.map(&amp;:dup).each {|e| e[1] += x }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 2, "last_activity_date": 1572396710, "creation_date": 1572396710, "answer_id": 58617338, "question_id": 58617252, "link": "https://stackoverflow.com/questions/58617252/quicker-way-of-adding-x-to-every-second-element-in-all-nested-arrays/58617338#58617338", "title": "Quicker way of adding x to every second element in all nested arrays", "body": "<p>You're close! You can use <code>map</code> to loop through each sub-array and the ruby <code>+=</code> operator to add <code>x</code> to the second element of each. The trick with <code>map</code> is that you'll need to return the <em>entire sub-array</em> in each loop, which would look like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr.map { |a| a[1] += x; a }\n#=&gt; [[1, 7, 3], [4, 10, 6], [7, 13, 9]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1572419314, "creation_date": 1572419314, "answer_id": 58620169, "question_id": 58617252, "link": "https://stackoverflow.com/questions/58617252/quicker-way-of-adding-x-to-every-second-element-in-all-nested-arrays/58620169#58620169", "title": "Quicker way of adding x to every second element in all nested arrays", "body": "<p>Here's another one:</p>\n\n<pre><code>arr = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nx = 5\n\narr.map { |a, b, c| [a, b + x, c] }\n#=&gt; [[1, 7, 3], [4, 10, 6], [7, 13, 9]]\n</code></pre>\n\n<p>Note that <a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> returns a new array. If you want to modify the existing array,  there's <code>map!</code>.</p>\n"}], "owner": {"reputation": 82, "user_id": 11429491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s3VbvedXWnM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxLjwsdl8yFSya2jWAgnr6QI5wMA/mo/photo.jpg?sz=128", "display_name": "Poyda", "link": "https://stackoverflow.com/users/11429491/poyda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58617292, "answer_count": 3, "score": 1, "last_activity_date": 1572419314, "creation_date": 1572395882, "last_edit_date": 1572407607, "question_id": 58617252, "link": "https://stackoverflow.com/questions/58617252/quicker-way-of-adding-x-to-every-second-element-in-all-nested-arrays", "title": "Quicker way of adding x to every second element in all nested arrays", "body": "<p>I have a nested array in ruby, similar to the one below, but with quite a few more nested arrays.</p>\n\n<pre><code>arr=[[1,2,3],[4,5,6],[7,8,9]]\n</code></pre>\n\n<p>Is there a way to get every second element within the nested array, and add x to that element? I have used the code below, but if there is a quicker way I'd love to know.</p>\n\n<pre><code>x = 5\narr[0][1], arr[1][1], arr[2][1] = arr[0][1]+x, arr[1][1]+x, arr[2][1]+x\n</code></pre>\n\n<p>I <em>have</em> tried to use <code>arr.map!{|f,l| [f, l + 1]}</code>, but I get the result <code>arr == [[1, 3], [4, 6], [7, 9]]</code></p>\n\n<p>EDIT:</p>\n\n<p>So the outcome should be <code>arr == [[1,2+x,3],[4,5+x,6],[7,8+x,9]]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572393127, "post_id": 58616857, "comment_id": 103543261, "body": "I think you want <code>CompanyNameFetcher</code> to receive <code>:call</code> and return <code>1</code>, right? Apparently, <code>new</code> requires some arguments, and you&#39;re not passing them in. Thus, the error, I suppose."}], "answers": [{"tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": true, "score": 3, "last_activity_date": 1572393457, "creation_date": 1572393457, "answer_id": 58616966, "question_id": 58616857, "link": "https://stackoverflow.com/questions/58616857/rspec-mock-service-and-receive-integer/58616966#58616966", "title": "Rspec mock service and receive integer", "body": "<blockquote>\n  <p>I want to mock a service that will returns the integer 1. In an endpoint it's called</p>\n\n<pre><code>CompanyNameFetcher.new(params[:filters][:company_name].downcase).call\n</code></pre>\n  \n  <p>and all of this line I want to mock to receive 1</p>\n</blockquote>\n\n<h1>Option 1 - allow_any_instance_of</h1>\n\n<pre class=\"lang-rb prettyprint-override\"><code>allow_any_instance_of(CompanyNameFetcher).to( \n  receive(:call).and_return(1)\n)\n</code></pre>\n\n<h1>Option 2 - stub the constructor</h1>\n\n<pre class=\"lang-rb prettyprint-override\"><code>mock_fetcher = instance_double(CompanyNameFetcher)\nallow(CompanyNameFetcher).to( \n  receive(:new).and_return(mock_fetcher)\n)\nallow(mock_fetcher).to rececive(:call).and_return(1)\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58616966, "answer_count": 1, "score": 2, "last_activity_date": 1572393457, "creation_date": 1572392630, "last_edit_date": 1592644375, "question_id": 58616857, "link": "https://stackoverflow.com/questions/58616857/rspec-mock-service-and-receive-integer", "title": "Rspec mock service and receive integer", "body": "<p>I want to mock a service that will returns the integer <code>1</code>. In an endpoint it's called</p>\n<pre><code>CompanyNameFetcher.new(params[:filters][:company_name].downcase).call\n</code></pre>\n<p>and all of this line I want to mock to receive <code>1</code></p>\n<p>This is what I have so far:</p>\n<pre><code>      let(:company_name_fetcher) do\n        class_double CompanyNameFetcher\n      end\n      before do\n        allow(company_name_fetcher).to receive(:new).and_return { 1 }\n      end\n</code></pre>\n<p>With error</p>\n<blockquote>\n<p>Failure/Error: allow(company_name_fetcher).to receive(:new).and_return { 1 }</p>\n<p>ArgumentError:\nwrong number of arguments (given 0, expected 1+)</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1572393272, "post_id": 58616810, "comment_id": 103543287, "body": "You should be able to go with <code>Org.includes(:posts).where(posts: {category: :job})</code>, no? And I often use strings with enums, makes things a lot easier to understand outside ActiveRecord."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1572393464, "post_id": 58616810, "comment_id": 103543322, "body": "@muistooshort - Absolutely. I stuck with the way the OP had it &quot;just because&quot;. If it&#39;s really to be hard coded, your way is the right way. I&#39;ll have to think on that bit about using strings instead of integers. It never occurred to me. Perhaps an artifact that I don&#39;t ever live outside ActiveRecord."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1572396474, "post_id": 58616810, "comment_id": 103543952, "body": "I live outside AR all the time and often access databases using multiple tools, hence my distaste for things like <code>serialize</code>, numbered enums, STI, and other &quot;easy&quot; things that tie you to AR."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 3, "last_activity_date": 1572538095, "last_edit_date": 1572538095, "creation_date": 1572392189, "answer_id": 58616810, "question_id": 58616540, "link": "https://stackoverflow.com/questions/58616540/activerecord-how-to-include-another-model-based-on-enum/58616810#58616810", "title": "ActiveRecord: How to include another model based on Enum?", "body": "<p><strong>tl;dr</strong> use</p>\n\n<pre><code>Org.includes(:posts).where(posts: {category: :job})\n</code></pre>\n\n<p><em>The longer answer...</em></p>\n\n<p>I guess it's worth noting that your question doesn't really have anything to do with <code>enums</code>. Nor does it have to do with \"including another model\". What you're really trying to do is <a href=\"https://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-the-joined-tables\" rel=\"nofollow noreferrer\">Specify Conditions on the Joined Tables</a> which you can read more about in the <a href=\"https://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">Active Record Query Interface guide</a>.</p>\n\n<p>The issues is that you've malformed your ActiveRecord Query:</p>\n\n<pre><code>Org.includes(:posts).where(category: Post.categories[:job])\n</code></pre>\n\n<p>The essential form of what you currently have is:</p>\n\n<pre><code>Model.where(attribute: 'value')\n</code></pre>\n\n<p>The:</p>\n\n<pre><code>.includes(:joined_models)\n</code></pre>\n\n<p>...bit doesn't change the essential form. And so, <code>ActiveRecord</code> will return all <code>Model</code> records where <code>attribute</code> has <code>value</code>. Or, in your case, all <code>Org</code> models where <code>category</code> is <code>job</code>.  </p>\n\n<p>But, that's not what you want. You want all <code>Orgs</code> that have <code>Posts</code> where the <code>Post</code> <code>category</code> is <code>job</code>. (Or, I suppose, \"all Orgs with job posts.\")</p>\n\n<p>Which is where the <code>.includes(:joined_models)</code> bit comes in: it lets you specify conditions on <code>joined_models</code>, which in it's essential form looks like: </p>\n\n<pre><code>Model.includes(:joined_models).where(joined_models: {attribute: 'value'})\n                                     ^^^^^^^^^^^^^\n</code></pre>\n\n<p>Or, in your case: </p>\n\n<pre><code>Org.includes(:posts).where(posts: {category: Post.categories[:job]})\n</code></pre>\n\n<p>Or, as mu says in the comments: </p>\n\n<pre><code>Org.includes(:posts).where(posts: {category: :job})\n</code></pre>\n\n<p>Now, I don't know what context you're in, but wherever you are, that above code requires that your context knows a lot about <code>Org</code> and how it relates to <code>Post</code> and the attributes of <code>Post</code> which in general is not great. So, I suggest you add a method to <code>Org</code> which allows you to decouple the knowledge of <code>Org</code> in your context: </p>\n\n<pre><code>class Org &lt; ApplicationRecord \n\n  class &lt;&lt; self\n\n    def with_job_posts\n      includes(:posts).where(posts: {category: :job}})\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>And now you can simply do: </p>\n\n<pre><code>Org.with_job_posts\n</code></pre>\n\n<p>...and get back \"all Orgs with job posts\". And your context needs to know a lot less about <code>Post</code> and its attributes.</p>\n\n<p><code>Post</code> also has a category of <code>conference</code>. So, you could do: </p>\n\n<pre><code>class Org &lt; ApplicationRecord \n\n  class &lt;&lt; self\n\n    def with_job_posts\n      includes(:posts).where(posts: {category: :job}})\n    end\n\n    def with_conference_posts\n      includes(:posts).where(posts: {category: :conference}})\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>But, if your <code>Post</code> <code>categories</code> start to grow, that will become tedious. So, instead do:</p>\n\n<pre><code>class Org &lt; ApplicationRecord \n\n  Post.categories.each do |post_category|\n    define_singleton_method(\"#{post_category}\"_posts) do \n      includes(:posts).where(posts: {category: post_category.to_sym})\n    end\n  end\n\nend\n</code></pre>\n\n<p>And now you'll have any number of methods like:</p>\n\n<pre><code>Org.with_job_posts\nOrg.with_conference_posts\nOrg.with_some_other_type_of_posts\n</code></pre>\n\n<p>Super! Check out <a href=\"https://stackoverflow.com/questions/3487403/how-to-dynamically-define-a-class-method-which-will-refer-to-a-local-variable-ou\">this Q&amp;A</a> for more info from <a href=\"https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag\">J\u00f6rg W Mittag</a>.</p>\n\n<p>BTW, that looks like a potentially unusual way to use <code>enum</code>. In the <a href=\"https://api.rubyonrails.org/v5.2.3/classes/ActiveRecord/Enum.html\" rel=\"nofollow noreferrer\">docs</a>, it says:</p>\n\n<blockquote>\n  <p>Finally, it's also possible to explicitly map the relation between attribute and database integer with a hash:</p>\n</blockquote>\n\n<pre><code>class Conversation &lt; ActiveRecord::Base\n  enum status: { active: 0, archived: 1 }\nend\n</code></pre>\n\n<p>I always figured a mapped enum was meant to use integers as the values, not strings. Interesting.</p>\n"}], "owner": {"reputation": 4730, "user_id": 294260, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/92ba886b03a595085d0410bf2546854c?s=128&d=identicon&r=PG", "display_name": "GN.", "link": "https://stackoverflow.com/users/294260/gn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 58616810, "answer_count": 1, "score": 2, "last_activity_date": 1572538095, "creation_date": 1572390137, "last_edit_date": 1572393283, "question_id": 58616540, "link": "https://stackoverflow.com/questions/58616540/activerecord-how-to-include-another-model-based-on-enum", "title": "ActiveRecord: How to include another model based on Enum?", "body": "<p>Have a Post Model with an Enum</p>\n\n<pre><code>// Post.rb\n\nenum category: {\n   job: 'job',\n   conference: 'conference'\n}\n</code></pre>\n\n<p>and an Org has and belongs to many Posts (via join table)</p>\n\n<p><code>Org.includes(:posts).where(category: Post.categories[:job])</code></p>\n\n<p>appears that its trying to call category on Org. Is there a way to write this to only\nreturn the Org with included post, where the post has an enum of string 'job'?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 4966134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac8233b7e662c05ddd15315dc82db8?s=128&d=identicon&r=PG&f=1", "display_name": "egiurleo", "link": "https://stackoverflow.com/users/4966134/egiurleo"}, "is_accepted": false, "score": 0, "last_activity_date": 1572467969, "creation_date": 1572467969, "answer_id": 58633318, "question_id": 58616171, "link": "https://stackoverflow.com/questions/58616171/mongoid-run-core-mongo-action/58633318#58633318", "title": "Mongoid run core mongo action", "body": "<p>You're right -- because your data is in JSON format, mongoimport is the tool you want to use. Once you've imported your data, you can set up Mongoid document schemas to match the data you've imported.</p>\n\n<p>Here's a <a href=\"https://docs.mongodb.com/guides/server/import/\" rel=\"nofollow noreferrer\">helpful mongoimport tutorial</a> if you want to try it on some sample data.</p>\n\n<p>For the inventory data in this tutorial, you could set up the schema:</p>\n\n<pre><code># JSON data: { \"item\": \"journal\", \"qty\": 25, \"size\": { \"h\": 14, \"w\": 21, \"uom\": \"cm\" }, \"status\": \"A\" }\n\nclass Inventory\n  include Mongoid::Document\n  store_in collection: 'inventory'\n\n  field :item, type: String\n  field :qty, type: Integer\n  field :size, type: Hash\n  field :status, type: String\nend\n</code></pre>\n\n<p>Some things to note here:</p>\n\n<ul>\n<li><p>Make sure that you import your data to the default collection name for the model you want to create (i.e. import to the \"users\" collection for a model called <code>User</code>) <strong>OR</strong> indicate on the model which collection the data is stored in (using the <code>store_in</code> method)</p></li>\n<li><p>When you import data as a Hash, you have some options on how to represent that in Mongoid. I've just used a Hash in this example, but you could also make <code>size</code> its own embedded document.</p></li>\n</ul>\n"}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572467969, "creation_date": 1572387545, "question_id": 58616171, "link": "https://stackoverflow.com/questions/58616171/mongoid-run-core-mongo-action", "title": "Mongoid run core mongo action", "body": "<p>I am using mongoid on a rails project.\nI have an API call that fetches client records in JSON format (array of hashes).</p>\n\n<pre><code>users = api.get_users # Returns JSON\n</code></pre>\n\n<p>To leverage Mongo's search, sort, and pagination, I'd like to store the records I get through API in the database.</p>\n\n<p>Of course I could run over every record in the JSON and do something like User.create(user), but I would like to just import all records at once and create each record in the database. Perhaps using <a href=\"https://docs.mongodb.com/manual/reference/program/mongoimport\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/reference/program/mongoimport</a> ?</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1572387580, "post_id": 58616141, "comment_id": 103541961, "body": "It could be that gemset was corrupted and Bundler got lost trying to resolve dependencies."}], "tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 0, "last_activity_date": 1572387382, "creation_date": 1572387382, "answer_id": 58616141, "question_id": 58616140, "link": "https://stackoverflow.com/questions/58616140/stuck-at-fetching-gem-metadata-from-http-rubygems-org/58616141#58616141", "title": "Stuck at Fetching gem metadata from http://rubygems.org/", "body": "<p>After hours of researching and playing around, I was able to get it work by not using <code>.rvmrc</code>. I removed the file and just keep using the same ruby version without gemset, et voila the <code>bundle install</code> running perfectly.</p>\n\n<p>I still don't understand what is the main issue of this, really appreciate if anyone can explain it.</p>\n"}], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572387382, "creation_date": 1572387382, "question_id": 58616140, "link": "https://stackoverflow.com/questions/58616140/stuck-at-fetching-gem-metadata-from-http-rubygems-org", "title": "Stuck at Fetching gem metadata from http://rubygems.org/", "body": "<p>Today I got a new project to work on:</p>\n\n<ul>\n<li>Ruby 1.9.3</li>\n<li>Rails 3.2.16</li>\n<li>And file <code>.rvmrc</code> with content <code>rvm use 1.9.3@somegemset --create</code></li>\n</ul>\n\n<p>I started <code>bundle install</code> and nothing happen, it's just stuck at <code>Fetching gem metadata from http://rubygems.org/</code> forever. I went through issues on bundler repo, follow many answers on Stackoverflow, but nothing help.</p>\n\n<p>Why it is stuck here?</p>\n\n<blockquote>\n  <p>Fetching gem metadata from <a href=\"http://rubygems.org/\" rel=\"nofollow noreferrer\">http://rubygems.org/</a></p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "bundler", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1572386589, "post_id": 58615650, "comment_id": 103541712, "body": "Do you have the ruby version specified somewhere in the project like a <code>.ruby-version</code> file or the Gemfile?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1572387409, "post_id": 58615650, "comment_id": 103541913, "body": "Shouldn&#39;t <code>bundler update --system</code> be <code>bundle update --bundler</code>? The same for <code>gem install bundler 2.0.2</code> which should be <code>gem install bundler -v 2.0.2</code>."}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1572394338, "post_id": 58615650, "comment_id": 103543488, "body": "I have Ruby version 2.6.5 in my Gem file"}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1572449461, "post_id": 58615650, "comment_id": 103564922, "body": "I&#39;ve tried those commands too. Still the same error. Maybe I need to reinstall Docker. I had this nightmare with trying to deploy to Heroku and AWS as well."}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1572492873, "post_id": 58635883, "comment_id": 103579716, "body": "Oh trust me, I&#39;ve done all that. I&#39;ve been corresponding with one of the developers of Bundler. I&#39;ve uninstalled all versions of Ruby and RVM. I&#39;m using rbenv now. This person suggested a beta version of Bundler they&#39;re working on. Still no luck yet but will report back."}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1572486420, "creation_date": 1572486420, "answer_id": 58635883, "question_id": 58615650, "link": "https://stackoverflow.com/questions/58615650/you-must-use-bundler-2-or-greater-with-this-lockfile-even-with-bundler-2-0-2/58635883#58635883", "title": "&#39;You must use Bundler 2 or greater with this lockfile.&#39; even with Bundler 2.0.2 installed", "body": "<p>At the very bottom of your <code>Gemfile.lock</code> it should say what version of Bundler was used:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Gemfile.lock\n\nBUNDLED WITH\n   2.0.2\n</code></pre>\n\n<p>You can also check what version of Bundler you're currently using in the console with:</p>\n\n<pre><code>bundler -v\n</code></pre>\n\n<p>Make sure both of those have the version you're looking for. If not, delete the <code>Gemfile.lock</code> completely and - barring you have the updated version installed - it should re-bundle with the updated version.</p>\n"}], "owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572486420, "creation_date": 1572384387, "question_id": 58615650, "link": "https://stackoverflow.com/questions/58615650/you-must-use-bundler-2-or-greater-with-this-lockfile-even-with-bundler-2-0-2", "title": "&#39;You must use Bundler 2 or greater with this lockfile.&#39; even with Bundler 2.0.2 installed", "body": "<p>I'm trying to Dockerize my Rails app and constantly getting this warning when running <code>docker build -t tml_portal</code>:</p>\n\n<pre><code>Sending build context to Docker daemon  355.1MB\nStep 1/1 : FROM rails:onbuild\n# Executing 4 build triggers\n ---&gt; Using cache\n ---&gt; Using cache\n ---&gt; Running in 641c1404bf87\nYou must use Bundler 2 or greater with this lockfile.\nThe command '/bin/sh -c bundle install' returned a non-zero code: 20\n\n</code></pre>\n\n<p>I've tried <code>bundler update --system</code>, <code>gem uninstall bundler</code>, <code>gem install bundler 2.0.2</code>, etc. Basically every suggestion on the internet. I will say that I have a problem sometimes where if I switch directories, <code>RVM</code> switches to <code>ruby 2.3.3</code> and I have to <code>rvm use 2.6.5</code>. My system ruby is not the same as local. Not sure if that has anything to do with it but I just can't figure out a solution. I've also made sure to delete the Docker build cache. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1572382824, "post_id": 58615291, "comment_id": 103540469, "body": "&quot;Am I doing this all completely wrong?&quot; - doing what? There is nothing in this question that describes what this code is actually supposed to accomplish."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572387415, "post_id": 58615291, "comment_id": 103541916, "body": "It does seem odd that you&#39;re creating three different classes that are exactly the same. This should be three instances of the same class unless the classes themselves have differences."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572387437, "post_id": 58615291, "comment_id": 103541926, "body": "Hint: <code>names = [ A.new, B.new, C.new ]</code> and <code>random_name = names.sample</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572387452, "post_id": 58615291, "comment_id": 103541928, "body": "Ruby avoids <code>get_</code> and <code>set_</code> prefixes. Instead use <code>attr_accessor</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": true, "score": 0, "last_activity_date": 1572384254, "creation_date": 1572384254, "answer_id": 58615625, "question_id": 58615291, "link": "https://stackoverflow.com/questions/58615291/how-do-i-pull-a-name-from-a-class-in-an-array/58615625#58615625", "title": "How do I pull a name from a class in an Array?", "body": "<blockquote>\n  <p>I then chose one at random and try to puts the name, and it outputs\n  blank.</p>\n</blockquote>\n\n<p>You never called the <code>#set_name</code> method in your code. You can add this:</p>\n\n<pre><code>name_a.set_name\nname_b.set_name\nname_c.set_name\n</code></pre>\n\n<p>Also, you probably want to look into <a href=\"https://www.rubyguides.com/2018/11/attr_accessor/\" rel=\"nofollow noreferrer\"><code>#attr_accessor</code></a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 12293727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4b609758ba8298e943ca4cc816e816?s=128&d=identicon&r=PG&f=1", "display_name": "NoTheOtherMatt", "link": "https://stackoverflow.com/users/12293727/notheothermatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58615625, "answer_count": 1, "score": 1, "last_activity_date": 1572384254, "creation_date": 1572382479, "question_id": 58615291, "link": "https://stackoverflow.com/questions/58615291/how-do-i-pull-a-name-from-a-class-in-an-array", "title": "How do I pull a name from a class in an Array?", "body": "<p>Okay, this is a little hard to explain but I will try (For starters I am only just learning to code so it may be something super simple I'm missing..)</p>\n\n<p>I created a few classes, I put a name in those classes, I put them in an array, I then chose one at random and try to puts the name, and it outputs blank.</p>\n\n<p>Am I doing this all completely wrong? I've been learning ruby for about 3 months now so I'm sure there is a lot I don't know.</p>\n\n<pre><code> class A\n  attr :name\n  def set_name\n    @name = \"Aaa\"\n  end\n\n  def get_name\n    return @name\n  end\nend\n\nclass B\n  attr :name\n  def set_name\n    @name = \"Bbb\"\n  end\n\n  def get_name\n    return @name\n  end\nend\n\nclass C\n  attr :name\n  def set_name\n    @name = \"Ccc\"\n  end\n\n  def get_name\n    return @name\n  end\nend\n\nname_a = A.new\nname_b = B.new\nname_c = C.new\nwhich_name = Array.new\n\nwhich_name[0] = name_a\nwhich_name[1] = name_b\nwhich_name[2] = name_c\n\nroll = rand(max 3)\n\nputs which_name[roll].get_name\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "node.js", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": true, "score": 1, "last_activity_date": 1572381420, "creation_date": 1572381420, "answer_id": 58615066, "question_id": 58614931, "link": "https://stackoverflow.com/questions/58614931/upload-a-rails-project-without-gems-like-nodejs-project-without-modules/58615066#58615066", "title": "Upload a Rails project without gems like NodeJS project without modules", "body": "<p>In Rails usually use <a href=\"https://bundler.io\" rel=\"nofollow noreferrer\">bundler</a>.</p>\n\n<p>All gems are in <code>Gemfile</code>.</p>\n\n<p>When you run <code>bundle</code> it generates <code>Gemfile.lock</code>. <code>Gemfile.lock</code> contains all versions and dependecies of project. So when other user will run <code>bundle</code>, he will get all the neccessary versions of gems.</p>\n\n<p>You can also use <code>Procfile</code> with scripts for your servers like in Node.js.</p>\n"}], "owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58615066, "answer_count": 1, "score": 0, "last_activity_date": 1572385662, "creation_date": 1572380836, "last_edit_date": 1572385662, "question_id": 58614931, "link": "https://stackoverflow.com/questions/58614931/upload-a-rails-project-without-gems-like-nodejs-project-without-modules", "title": "Upload a Rails project without gems like NodeJS project without modules", "body": "<p>I am a little confused about the project upload. I have developed some Ruby on Rails project and want to upload it to google drive(own purposes). However, I am confused regarding the upload step. If you are familiar with NodeJS, we don't upload node_modules into our repository, since once we clone the repository we can issue <code>npm install</code>, and it will install all the modules. Is there similar thing in Rails? Also, in NodeJS we have package.json file where we can include commands to run inside 'script', such as </p>\n\n<pre><code>\"scripts\": {\n    \"devStart\": \"nodemon server.js\"\n  }\n</code></pre>\n\n<p>Is there a similar thing in Ruby on Rails?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572379877, "post_id": 58614668, "comment_id": 103539247, "body": "Does <code>game.home_team_id == team_id</code> or <code>game.away_team_id == team_id</code> return true at least once?"}, {"owner": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572379987, "post_id": 58614668, "comment_id": 103539288, "body": "yes, they are returning &quot;win&quot; / &quot;loss&quot; accordingly"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572380543, "post_id": 58614668, "comment_id": 103539539, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. Your snippet needs to be runnable and demonstrate the problem you&#39;re describing. Without that we have to create all the supporting data and code to make it work which defeats the purpose of SO."}], "answers": [{"comments": [{"owner": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 0, "creation_date": 1572380618, "post_id": 58614772, "comment_id": 103539580, "body": "Thank you, I&#39;ve been working through the pry and it&#39;s not really revealing anything. I updated my question to include the shape of the elements in the array."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 1, "creation_date": 1572380663, "post_id": 58614772, "comment_id": 103539602, "body": "Have you checked the data type of the <code>home_goals</code>? Are you sure its actually an integer? If you compare 2 strings it can always return true in cases: <code>&#39;2&#39; &gt; &#39;1&#39;</code> instead of <code>2 &gt; 1</code>"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 1, "creation_date": 1572380824, "post_id": 58614772, "comment_id": 103539674, "body": "Are you sure you are passing a <code>&#39;6&#39;</code> as a string as the argument of the function, and not <code>6</code>?"}, {"owner": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 0, "creation_date": 1572380937, "post_id": 58614772, "comment_id": 103539713, "body": "Yeah, the data i shared above is a copy/paste from the pry response for <code>game</code>. The goals are ints and the team_ids are strings. Plus the arg is also a string of &quot;6&quot; in this case"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 1, "creation_date": 1572381056, "post_id": 58614772, "comment_id": 103539768, "body": "More than likely it&#39;s something silly that you&#39;re not seeing then. Perhaps restart console, make sure you dont have multiple things running, make sure the file is actually saving or you dont have 3 versions of the file open blah blah blah. If you try my example, does it return the proper output with the version of ruby you&#39;re using? I suspect version of ruby wouldn&#39;t matter (with the ternary) but wouldn&#39;t hurt to check."}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 1, "creation_date": 1572381120, "post_id": 58614772, "comment_id": 103539793, "body": "I notice you&#39;re using a class variable and not an instance variable (which would much be preferred). Are you sure the class variable is not being manipulated somehow from another thread?"}, {"owner": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 0, "creation_date": 1572381433, "post_id": 58614772, "comment_id": 103539919, "body": "It shouldnt be, working off of pry it&#39;s the same input data coming in as expected from my csv parsing. Simply instances of <code>Game</code>. So, everything is behaving as expected.. of course, except for this method. I&#39;ll keep looking at it, maybe take a break for a bit and then come back. I&#39;m worried it may be something super obvious but we&#39;ll see"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "edited": false, "score": 1, "creation_date": 1572381504, "post_id": 58614772, "comment_id": 103539952, "body": "it&#39;s most definitely something &#39;obvious&#39; but we can&#39;t help you find it because you don&#39;t provide working input data. More than likely its a forehead slapper. Make sure its actually returning the wrong output (and not for instance, a long string of &#39;wins&#39; when you thought there were more losses)"}], "tags": [], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "is_accepted": false, "score": 2, "last_activity_date": 1572380442, "last_edit_date": 1572380442, "creation_date": 1572380120, "answer_id": 58614772, "question_id": 58614668, "link": "https://stackoverflow.com/questions/58614668/ruby-conditional-not-triggering-inside-of-reduce-method/58614772#58614772", "title": "Ruby conditional not triggering inside of reduce method", "body": "<p>More than likely the return value of one of your methods is not what you are expecting. You can see from an example without your methods it is properly working. You'd have to provide the original data to be more useful.</p>\n\n<p>Use <code>binding.pry</code> and <code>require 'pry'</code> at top to set a breakpoint. Then inspect the return values. Perhaps one ID is a string and the other is an integer or something like that.</p>\n\n<pre><code>results = [1,2,3].reduce([]) do |accum, game|\n  puts game\n  if true\n    1 &gt; 0 ? accum &lt;&lt; \"win\" : accum &lt;&lt; \"loss\" \n  end\n  if true\n    1 &gt; 0 ? accum &lt;&lt; \"win\" : accum &lt;&lt; \"loss\"\n  end\n  accum\nend\n\nresults\n\n#=&gt; [\"win\", \"win\", \"win\", \"win\", \"win\", \"win\"]\n\nrequire 'pry'\nresults = [1,2,3].reduce([]) do |accum, game|\n  puts game\n  if true\n    0 &gt; 1 ? accum &lt;&lt; \"win\" : accum &lt;&lt; \"loss\" \n  end\n  if false\n    1 &gt; 0 ? accum &lt;&lt; \"win\" : accum &lt;&lt; \"loss\"\n  end\n  accum\nend\n\nresults\n\n#=&gt; [\"loss\", \"loss\", \"loss\"]\n</code></pre>\n"}], "owner": {"reputation": 893, "user_id": 10349152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8dc4776f1d68d822fba0406d9510af?s=128&d=identicon&r=PG&f=1", "display_name": "kevin", "link": "https://stackoverflow.com/users/10349152/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572380542, "creation_date": 1572379715, "last_edit_date": 1572380542, "question_id": 58614668, "link": "https://stackoverflow.com/questions/58614668/ruby-conditional-not-triggering-inside-of-reduce-method", "title": "Ruby conditional not triggering inside of reduce method", "body": "<p>I've been staring at this for a long time and im not sure why my conditional is not triggering. I've stripped out everything and just left it down to the two conditionals and the output. For some reason its returning an entire array of wins / losses for all the data (510 in length), and not <strong>just the wins/losses for that matching team.</strong></p>\n\n<pre><code>  def self.average_win_percentage(team_id)\n    results = @@game_data.reduce([]) do |accum, game|\n      if game.home_team_id == team_id\n        game.home_goals &gt; game.away_goals ? accum &lt;&lt; \"win\" : accum &lt;&lt; \"loss\"\n      end\n      if game.away_team_id == team_id\n        game.away_goals &gt; game.home_goals ? accum &lt;&lt; \"win\" : accum &lt;&lt; \"loss\"\n      end\n      accum\n    end\n    results\n  end\n</code></pre>\n\n<p>Any idea why its not triggering? I feel like its something really obvious but I'm simply not seeing it currently.</p>\n\n<p>Each element in @@game_data looks like this. Since its being parsed from a csv, ill just share one element.</p>\n\n<pre><code> @away_goals=2,\n @away_team_id=\"3\",\n @date_time=\"5/16/13\",\n @game_id=\"2012030221\",\n @home_goals=3,\n @home_team_id=\"6\",\n @season=\"20122013\",\n @type=\"Postseason\",\n @venue=\"Toyota Stadium\",\n @venue_link=\"/api/v1/venues/null\"\n</code></pre>\n\n<p>The team_id being pass in as an argument is also a string type</p>\n"}, {"tags": ["php", "regex", "ruby"], "comments": [{"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572378618, "post_id": 58614401, "comment_id": 103538755, "body": "Not all the content contains those 3 parts. The second line has not part that ends with parenthesis. Try <a href=\"https://regex101.com/r/9EQetr/1\" rel=\"nofollow noreferrer\">regex101.com/r/9EQetr/1</a>"}, {"owner": {"reputation": 3859, "user_id": 873650, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/Br61o.jpg?s=128&g=1", "display_name": "Fernando Fabreti", "link": "https://stackoverflow.com/users/873650/fernando-fabreti"}, "reply_to_user": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "edited": false, "score": 1, "creation_date": 1572380173, "post_id": 58614401, "comment_id": 103539367, "body": "@Emma: almost.  See the second line of the image in my post, there are 3 groups, and parenthesis inside the text belong to the second group"}, {"owner": {"reputation": 3859, "user_id": 873650, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/Br61o.jpg?s=128&g=1", "display_name": "Fernando Fabreti", "link": "https://stackoverflow.com/users/873650/fernando-fabreti"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572380232, "post_id": 58614401, "comment_id": 103539394, "body": "@Thefourthbird, that&#39;s why the title says &quot;optional parenthesis&quot;"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572380427, "post_id": 58614401, "comment_id": 103539488, "body": "@FernandoFabreti Of course, I see. Do you mean that in your example link you only want to match the last 2 lines? <a href=\"https://regex101.com/r/pPlOkn/3\" rel=\"nofollow noreferrer\">regex101.com/r/pPlOkn/3</a> Or do you want to match all lines?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1572380723, "post_id": 58614401, "comment_id": 103539627, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. The regex needs to be in &quot;the question itself&quot; not in an image which forces us to recreate it from the image, or go to another site to copy/paste it just to help you. If you put it into the question we don&#39;t have to do those things. Also, if the link to the image breaks, your question will make no sense."}, {"owner": {"reputation": 3859, "user_id": 873650, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/Br61o.jpg?s=128&g=1", "display_name": "Fernando Fabreti", "link": "https://stackoverflow.com/users/873650/fernando-fabreti"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572381210, "post_id": 58614401, "comment_id": 103539827, "body": "@theTinMan, sorry about that, I have corrected the question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572391411, "post_id": 58614401, "comment_id": 103542864, "body": "When you give an example it&#39;s helpful to assign a variable to all inputs (e.g, <code>str = &quot;art. 3&#186; Esta...individuais. (abc 123)&quot;</code>. That way readers can refer to the variable in answers and comments without having to define it. That also makes it easier for readers to cut and paste. It would also be helpful to explicitly state the rule for determining when the prefix ends and when the meta begins."}], "answers": [{"comments": [{"owner": {"reputation": 3859, "user_id": 873650, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/Br61o.jpg?s=128&g=1", "display_name": "Fernando Fabreti", "link": "https://stackoverflow.com/users/873650/fernando-fabreti"}, "edited": false, "score": 0, "creation_date": 1572381695, "post_id": 58614792, "comment_id": 103540048, "body": "very good one.  Could you explain why a <code>?</code> is inside the second group? It looks like it does the magic."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "reply_to_user": {"reputation": 3859, "user_id": 873650, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/Br61o.jpg?s=128&g=1", "display_name": "Fernando Fabreti", "link": "https://stackoverflow.com/users/873650/fernando-fabreti"}, "edited": false, "score": 0, "creation_date": 1572381766, "post_id": 58614792, "comment_id": 103540079, "body": "@FernandoFabreti that makes the capture non-greedy, without it the second group would capture all the characters to the end of the line. See <a href=\"https://regex101.com/r/pPlOkn/5\" rel=\"nofollow noreferrer\">regex101.com/r/pPlOkn/5</a>"}], "tags": [], "owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "is_accepted": true, "score": 1, "last_activity_date": 1572390568, "last_edit_date": 1572390568, "creation_date": 1572380217, "answer_id": 58614792, "question_id": 58614401, "link": "https://stackoverflow.com/questions/58614401/regexp-to-match-groups-containing-optional-parenthesis-in-the-end-of-line/58614792#58614792", "title": "Regexp to match groups containing optional parenthesis in the end of line", "body": "<p>The problem with your regex is that the forward lookahead in the middle effectively insists on the string having a <code>(...)</code> at the end of the line. By removing that lookahead, and changing the optional group at the end so that it can only match <code>(...)</code> with <em>no</em> intervening <code>)</code>, it should do what you want:</p>\n\n<pre><code>^([aA]rt\\. \\d+\u00ba?)\\s*(.*?)\\s*(\\([^)]*\\))?$\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/pPlOkn/7\" rel=\"nofollow noreferrer\">Demo on regex101</a></p>\n"}, {"comments": [{"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572391362, "post_id": 58616459, "comment_id": 103542857, "body": "I&#39;m not that familiar with ruby, How would you think performance of splitting compares to matching?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572391989, "post_id": 58616459, "comment_id": 103543008, "body": "I doubt it makes a great deal of difference, but I don&#39;t really know. If, however, the prefix always end with <code>&#39;&#186;&#39;</code> there is a much faster way to do it. That&#39;s one reason why it&#39;s important to provide specific rules for where the prefix ends and the meta begins."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572392498, "post_id": 58616459, "comment_id": 103543134, "body": "Out of curiosity what is the faster way?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572394946, "post_id": 58616459, "comment_id": 103543611, "body": "If the prefix always ends with <code>\u2019&#186;\u2019</code>, you could write <code>i1 = str.index(\u2018&#186;\u2018); i2 = str.rindex(\u2018(\u2019); prefix = str[0,..i1]; body = str[i1+1..i2-1].strip; meta = str[i2..-1]</code>. If the prefix may end with a digit, <i>in which case</i> the body may not contain the character <code>\u2019&#186;\u2019</code>, after finding <code>str.index(\u2018&#186;\u2018) #=&gt; nil</code> one could compute <code>i1 = str[&#47;\\D+\\d+&#47;].size-1</code>. this last regular expression matches one or more non-digits (<code>\\D</code>) followed by one or more digits (<code>\\d</code>)..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572394968, "post_id": 58616459, "comment_id": 103543614, "body": "...<code>str[i..j]</code> returns the substring of <code>str</code> that begins at index <code>i</code> and ends at index <code>j</code>. <code>str.index(s)</code> is the index of the start of the first occurrence of the string <code>s\u2019 within the string </code>str<code>. </code>str.rindex(s)` is the same except it starts at the end of the string and works backwards."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572395004, "post_id": 58616459, "comment_id": 103543625, "body": "Ah, makes sense, avoid regex altogether. Thanks."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572395579, "post_id": 58616459, "comment_id": 103543771, "body": "I somehow mixed you up with the author of another question who said they didn\u2019t know Ruby, which is why I included all that basic stuff in my last comment (which I\u2019ll leave for the benefit of newbies)."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572395904, "post_id": 58616459, "comment_id": 103543832, "body": "No worries at all - always interesting to see how other languages express these constructs."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1572396198, "post_id": 58616459, "comment_id": 103543893, "body": "@Nick, all this time I was thinking you were the OP (in part because I\u2019ve been writing these comments on a phone.) Oh, well."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1572391196, "last_edit_date": 1572391196, "creation_date": 1572389579, "answer_id": 58616459, "question_id": 58614401, "link": "https://stackoverflow.com/questions/58614401/regexp-to-match-groups-containing-optional-parenthesis-in-the-end-of-line/58616459#58616459", "title": "Regexp to match groups containing optional parenthesis in the end of line", "body": "<p>I assume that the prefix ends with a digit or with a digit followed by '\u00ba', followed by one or more spaces.</p>\n\n<pre><code>str = \"art. 3\u00ba Esta Consolida\u00e7\u00e3o estatui (teste 123) as normas que regulam as rela\u00e7\u00f5es individuais. (abc 123)\"\n</code></pre>\n\n<p>In this case I find it easier to split the string into three pieces rather than to extract the three strings desired.</p>\n\n<pre><code>prefix, body, meta = str.split(/(?&lt;=\u00ba) +|\\. +(?=\\()/)\n\nprefix #=&gt; \"art. 3\u00ba\" \nbody   #=&gt; \"Esta Consolida\u00e7\u00e3o estatui (teste 123)...individuais\" \nmeta   #=&gt; \"(abc 123)\" \n</code></pre>\n\n<p>The regular expression reads, \"match one or more spaces immediately preceded by <code>'\u00ba'</code>, <em>or</em> (<code>'|'</code>) match a period followed by one or spaces, immediately followed by a left parenthesis. <code>'\u00ba'</code> and <code>'('</code>, being within a <em>positive lookbehind</em> and <em>positive lookahead</em>, respectively, are not part of the matches.</p>\n"}], "owner": {"reputation": 3859, "user_id": 873650, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/Br61o.jpg?s=128&g=1", "display_name": "Fernando Fabreti", "link": "https://stackoverflow.com/users/873650/fernando-fabreti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58614792, "answer_count": 2, "score": -1, "last_activity_date": 1572632021, "creation_date": 1572378454, "last_edit_date": 1572632021, "question_id": 58614401, "link": "https://stackoverflow.com/questions/58614401/regexp-to-match-groups-containing-optional-parenthesis-in-the-end-of-line", "title": "Regexp to match groups containing optional parenthesis in the end of line", "body": "<p>I need to extract a law text in Portuguese with three parts: prefix, body, meta, something like this:</p>\n\n<pre><code>art. 3\u00ba Esta Consolida\u00e7\u00e3o estatui (teste 123) as normas que regulam as rela\u00e7\u00f5es individuais. (abc 123)\n</code></pre>\n\n<pre><code>PREFIX: \"art. 3\u00ba\"\nBODY: \"Esta Consolida\u00e7\u00e3o estatui (teste 123) as normas que regulam as rela\u00e7\u00f5es individuais.\"\nMETA: \"(abc 123)\"\n</code></pre>\n\n<p>I suspect I need something related to look-ahead, but cannot figure it out.</p>\n\n<p>Here it is the regexp:</p>\n\n<pre><code>^([aA]rt\\. \\d+\u00ba?)(.*(?=\\(.*\\)))(\\(.*\\))?$\n</code></pre>\n\n<p>Here are the lines that should match:</p>\n\n<pre><code>art. 3\u00ba Esta Consolida\u00e7\u00e3o estatui as normas que regulam as rela\u00e7\u00f5es individuais. (modificado pela lei 234/98) \nart. 3\u00ba Esta Consolida\u00e7\u00e3o estatui as normas que regulam as rela\u00e7\u00f5es individuais. \nart. 3\u00ba Esta Consolida\u00e7\u00e3o estatui (teste 123) as normas que regulam as rela\u00e7\u00f5es individuais. \nart. 3\u00ba Esta Consolida\u00e7\u00e3o estatui (teste 123) as normas que regulam as rela\u00e7\u00f5es individuais. (abc 123)\n</code></pre>\n\n<p>My efforts are in this link: <a href=\"https://regex101.com/r/pPlOkn/3\" rel=\"nofollow noreferrer\">https://regex101.com/r/pPlOkn/3</a> </p>\n\n<p>I need to match all the variations (the four lines):\n<a href=\"https://i.stack.imgur.com/vll5M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vll5M.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1572380818, "post_id": 58614275, "comment_id": 103539672, "body": "What needs to &quot;be quick&quot;? Us helping you or the code?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572382895, "post_id": 58614275, "comment_id": 103540503, "body": "<code>users.any?</code> returns <code>true</code> or <code>false</code>. Is that what you want? Please edit to show the desired return value for your example. @theTinMan, or both?"}], "answers": [{"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 2, "last_activity_date": 1572380141, "last_edit_date": 1572380141, "creation_date": 1572379106, "answer_id": 58614543, "question_id": 58614275, "link": "https://stackoverflow.com/questions/58614275/how-to-search-in-a-large-json-array-and-find-records-by-multiple-keys/58614543#58614543", "title": "How to search in a large JSON array and find records by multiple keys", "body": "<p>I hope this method works like you want</p>\n\n<pre><code>def search(users, keys, value)\n  users.select do |user|\n    keys.any? do |key|\n      user.dig(*key.split('.').map(&amp;:to_sym)) == value\n    end\n  end\nend\n\nsearch(users, keys, 'NY')\n#=&gt; [{ :username =&gt; \"Bill\", :gender =&gt; \"Male\", :details =&gt; { :city =&gt; \"NY\" } }]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572381086, "post_id": 58614821, "comment_id": 103539781, "body": "For a big dataset this would be MUCH faster."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572381389, "post_id": 58614821, "comment_id": 103539892, "body": "You could clean up the make_index method a bit by using inject."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572381799, "post_id": 58614821, "comment_id": 103540089, "body": "We are not told if multiple searches are to be made for different cities. If so, this would be useful."}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572384135, "post_id": 58614821, "comment_id": 103540955, "body": "@CarySwoveland, good question - i am using it to search a datatable, so there will be, indeed, multiple searches. Testing the solutions here and will try to compare speeds."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572386090, "post_id": 58614821, "comment_id": 103541573, "body": "We need to know what you will be searching for. Presumably it not always a city, as <code>users[:gender]</code> would not give you that. As I said you a comment on your question you need to edit your question to clarify the desired return value. Please also indicate the variety of strings you may be searching for. I really don&#39;t know what you are looking for."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": false, "score": 2, "last_activity_date": 1572383996, "last_edit_date": 1572383996, "creation_date": 1572380334, "answer_id": 58614821, "question_id": 58614275, "link": "https://stackoverflow.com/questions/58614275/how-to-search-in-a-large-json-array-and-find-records-by-multiple-keys/58614821#58614821", "title": "How to search in a large JSON array and find records by multiple keys", "body": "<p>For linear searching, demir's solution is a good one.</p>\n\n<p>For the \"must be quick\" angle, you may find that an O(n) scan through your users array is too slow. To alleviate this, you may want to create an index:</p>\n\n<pre><code>require \"set\"\nclass Index\n  def initialize(dataset)\n    @index = make_index(dataset)\n  end\n\n  def find(conditions = {})\n    conditions.inject(Set.new) { |o, e| o | @index[e.join(\".\")] }.to_a\n  end\n\n  private\n\n  def make_keys(record, prefix = [])\n    record.flat_map do |key, val|\n      case val\n      when Hash\n        make_keys val, [key]\n      else\n        (prefix + [key, val]).join(\".\")\n      end\n    end\n  end\n\n  def make_index(dataset)\n    dataset.each_with_object({}) do |record, index|\n      make_keys(record).each { |key| (index[key] ||= []) &lt;&lt; record }\n    end\n  end\nend\n\nindex = Index.new(users)\np index.find(\"gender\" =&gt; \"Male\", \"details.city\" =&gt; \"NY\")\n# =&gt; [{:username=&gt;\"Bill\", :gender=&gt;\"Male\", :details=&gt;{:city=&gt;\"NY\"}}]\n</code></pre>\n\n<p>This takes O(n) time and costs extra memory to create the index once, but then each search of the dataset should happen in O(1) time. If you perform a bunch of searching after setting up the dataset once, something like this might be an option.</p>\n"}, {"comments": [{"owner": {"reputation": 1349, "user_id": 6163262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f3655350c57cb94195d64808b7ba61?s=128&d=identicon&r=PG&f=1", "display_name": "whodini9", "link": "https://stackoverflow.com/users/6163262/whodini9"}, "edited": false, "score": 0, "creation_date": 1572382760, "post_id": 58614822, "comment_id": 103540443, "body": "<code>hsh.dig(*key)</code> is very nice :)"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1572383964, "last_edit_date": 1572383964, "creation_date": 1572380340, "answer_id": 58614822, "question_id": 58614275, "link": "https://stackoverflow.com/questions/58614275/how-to-search-in-a-large-json-array-and-find-records-by-multiple-keys/58614822#58614822", "title": "How to search in a large JSON array and find records by multiple keys", "body": "<p>You can use traverse the hash dynamically with <code>Hash#dig</code> which was introduced in Ruby 2.3.0:</p>\n\n<pre><code>def select_users(users, conditions)\n  users.select do |user|\n    conditions.select do |key, value|\n      user.dig(*key.to_s.split(\".\").map(&amp;:to_sym)) == value\n    end.length == conditions.length\n  end\nend\n</code></pre>\n\n<p>This assumes that the input for conditions is a hash such as:</p>\n\n<pre><code>{ \"gender\" =&gt; \"Male\", \"details.city\" =&gt; \"NY\" }\n</code></pre>\n\n<p>And is optimized for testing multiple conditions in a single linear pass. You could also support arrays to test for inclusion:</p>\n\n<pre><code>def select_users(users, conditions)\n  users.select do |user|\n    conditions.select do |key, value|\n      actual = user.dig(*key.to_s.split(\".\").map(&amp;:to_sym))\n      if value.is_a?(Array)\n        value.includes?(actual)\n      else\n        actual == value\n      end\n    end.length == conditions.length\n  end\nend\n</code></pre>\n\n<pre><code># get users where city is \"NY\", \"Detroit\" or \"Los Angeles\"\nselect_users(dataset, { \"gender\" =&gt; \"Male\", \"details.city\" =&gt; [\"NY\", \"Detroit\", \"Los Angeles\"] })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1572382505, "last_edit_date": 1572382505, "creation_date": 1572381152, "answer_id": 58615004, "question_id": 58614275, "link": "https://stackoverflow.com/questions/58614275/how-to-search-in-a-large-json-array-and-find-records-by-multiple-keys/58615004#58615004", "title": "How to search in a large JSON array and find records by multiple keys", "body": "<p>The code in the question (<code>any?</code>, in particular) suggests that the object is to determine if, for any hash <code>h</code> in <code>users</code>,</p>\n\n<pre><code>h[:gender] == city #=&gt; true\n</code></pre>\n\n<p>or there exists a hash <code>g</code> for which:</p>\n\n<pre><code>g = h[:details]\ng[:city] == city   #=&gt; true\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def city_present?(users, *key_groups, city)\n  key_arr = key_groups.map { |s| s.split('.').map(&amp;:to_sym) }\n  users.any? { |h| key_arr.any? { |keys| h.dig(*keys) == city } }\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<p>For <code>users</code> given in the question and</p>\n\n<pre><code>city_present?(users, \"gender\", \"details.city\", 'NY') #=&gt; true\ncity_present?(users, \"gender\", \"details.city\", 'LA') #=&gt; true\ncity_present?(users, \"gender\", \"details.city\", 'TO') #=&gt; false\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-dig\" rel=\"nofollow noreferrer\">Hash#dig</a>. <code>key_arr</code> is found to equal:</p>\n\n<pre><code>[[:gender], [:details, :city]]\n</code></pre>\n\n<p><strong>Repeated searches</strong></p>\n\n<p>Taking up @ChrisHeald's suggestion, if <code>users</code> were large and repeated searchers were to be made for different values it would make sense to create a set of the values associated with <code>key_groups</code>. That could be done as follows.</p>\n\n<pre><code>require 'set'\n\ndef values_present(users, *key_groups)\n  key_arr = key_groups.map { |s| s.split('.').map(&amp;:to_sym) }\n  users.each_with_object(Set.new) do |h,set|\n    key_arr.each do |keys|\n      v = h.dig(*keys)\n      set &lt;&lt; v unless v.nil?\n    end\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>values_present(users, \"gender\", \"details.city\")     \n  #=&gt; #&lt;Set: {\"Male\", \"NY\", \"Female\", \"LA\"}&gt;\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1572383996, "creation_date": 1572377807, "last_edit_date": 1572380968, "question_id": 58614275, "link": "https://stackoverflow.com/questions/58614275/how-to-search-in-a-large-json-array-and-find-records-by-multiple-keys", "title": "How to search in a large JSON array and find records by multiple keys", "body": "<p>I have a very large dataset that's organized like this:</p>\n\n<pre><code>users = [\n    {\n        username: \"Bill\",\n        gender: \"Male\",\n        details: {\n            city: \"NY\"\n        }\n    },\n    {\n        username: \"Mary\",\n        gender: \"Female\",\n        details: {\n            city: \"LA\"\n        }\n    }\n]\n</code></pre>\n\n<p>I need a quick way to search for multiple records by multiple values from multiple keys.</p>\n\n<p>I have dot-separated list of keys:</p>\n\n<pre><code>keys = [\"gender\", \"details.city\"]\n</code></pre>\n\n<p>I need to do something like this (written in pseudo code):</p>\n\n<pre><code>my_users = users.any? {|user|\n  keys.each do |key|\n    user.key == \"NY\"\n  end\n}\n</code></pre>\n\n<p>I know this is not going to work. One of the reasons it will not work is that my list of keys is dot-separated, so I could either split it to an array of keys, as in <code>['gender']</code> and <code>['details']['city']</code>, or convert the user hash to a dot-separated object with a method like:</p>\n\n<pre><code>def to_o\n  JSON.parse to_json, object_class: OpenStruct\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested", "simple-form", "nested-forms"], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 5287084, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-stgK_Qk69OM/AAAAAAAAAAI/AAAAAAAAJPY/zgH-naHkAG0/photo.jpg?sz=128", "display_name": "yvoloshin", "link": "https://stackoverflow.com/users/5287084/yvoloshin"}, "edited": false, "score": 0, "creation_date": 1572728316, "post_id": 58613994, "comment_id": 103651707, "body": "Thank you max! This was very helpful. I changed the form and the parent_params as you suggested. I also changed the <code>create</code> method to create a new Parent, get their children (<code>@children = @parent.children</code>), and then iterate over the children and associate a school with each child, where the id of the school is taken from params: <code>@children.each_with_index do |child, index| index = index.to_s; selected_school = School.find(params[:parent][:children_attributes][index][:sc&zwnj;&#8203;hool_id]); child.update(school: selected_school)</code>"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1572382681, "last_edit_date": 1572382681, "creation_date": 1572376440, "answer_id": 58613994, "question_id": 58613415, "link": "https://stackoverflow.com/questions/58613415/how-to-create-triple-nested-objects-in-rails-with-multiple-directional-associati/58613994#58613994", "title": "How to create triple nested objects in Rails with multiple-directional associations", "body": "<p>One of the most common missconceptions/misstakes with nested attributes is to think that you need it to do simple association assignment. You don't. You just need to pass an id to the <code>assocation_name_id=</code> setter.</p>\n\n<p>If fact using nested attributes won't even do what you want at all. It won't create an assocation from an existing record when you do <code>child.school_attributes = [{ id: 1 }]</code> rather it will attempt to create a new record or update an existing school record.</p>\n\n<p>You would only need to accept nested attributes for school if the user is creating a school at the same time. And in that case its probally a better idea to use Ajax rather than stuffing everything into one mega action.</p>\n\n<pre><code>&lt;%= simple_form_for (@parent) do |f| %&gt;\n  &lt;%= f.input :name, label: 'name' %&gt;\n  &lt;%= f.simple_fields_for :children, @children do |child_form| %&gt;\n    &lt;%= child_form.input :name, label: \"Child Name\" %&gt;\n    &lt;%= child_form.associaton :school, \n        collection: @schools, label_method: :name %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<pre><code>def parent_params\n  params.require(:parent).permit( :name, \n    child_attributes: [:id, :name, :age, :school_id]]\n  )\nend\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 5287084, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-stgK_Qk69OM/AAAAAAAAAAI/AAAAAAAAJPY/zgH-naHkAG0/photo.jpg?sz=128", "display_name": "yvoloshin", "link": "https://stackoverflow.com/users/5287084/yvoloshin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 58613994, "answer_count": 1, "score": 0, "last_activity_date": 1572382681, "creation_date": 1572373700, "question_id": 58613415, "link": "https://stackoverflow.com/questions/58613415/how-to-create-triple-nested-objects-in-rails-with-multiple-directional-associati", "title": "How to create triple nested objects in Rails with multiple-directional associations", "body": "<p>An article called <a href=\"https://medium.com/@mindovermiles262/triple-nested-forms-in-rails-dedbcccb5799\" rel=\"nofollow noreferrer\">Triple nested Forms in Rails</a> presents a good description of creating a form for saving three nested objects. The example given is of creating a <code>Show</code> that <code>has_many Seasons</code>, and each <code>Season</code> has_many <code>Episodes</code>. Also, <code>Episode --&gt; belongs_to --&gt; Season --&gt; belongs_to --&gt; Show</code>.\u00a0\nShows are created like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def new\n@show = Show.new\n@show.seasons.build.episodes.build\nend\n</code></pre>\n\n<p>The form looks like this:</p>\n\n<pre><code>&lt;%= form.fields_for :seasons do |s| %&gt;\n\u00a0\u00a0\u00a0 &lt;%= s.label :number %&gt;\n\u00a0\u00a0\u00a0 &lt;%= s.number_field :number %&gt;\u00a0\u00a0\u00a0 &lt;%= s.fields_for :episodes do |e| %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= e.label :title %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= e.text_field :title %&gt;\n\u00a0\u00a0\u00a0 &lt;% end %&gt;\u00a0\n\u00a0&lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This seems straightforward because all the associations run in one direction. I'm trying to do something that's similar, but more complicated. I have a <code>Parent</code> model where each <code>Parent</code> has multiple <code>Children</code> and each <code>Child</code> is enrolled in a <code>School</code>. After specifying that <code>Children</code> is the plural of <code>Child</code>, the association would have to be like this:</p>\n\n<pre><code>Parent has_many Children, accepts_nested_attributes_for :children\nChild belongs_to Parent, belongs_to School, accepts_nested_attributes_for :school\nSchool has_many Children, accepts_nested_attributes_for :children\n</code></pre>\n\n<p>Graphically, it would look like this:</p>\n\n<pre><code>Parent &lt;-- belongs_to &lt;-- Child --&gt; belongs_to --&gt; School\n</code></pre>\n\n<p>Each Parent is also associated with a User, like this:</p>\n\n<pre><code>User has_many :parents\n</code></pre>\n\n<p>The data on Parents, Children, and Schools is entered in the following form (generated using the Simple Form gem), where the\u00a0schools are entered as a dropdown selector populated from the schools table:</p>\n\n<pre><code>@schools = School.all\n\n&lt;%= simple_form_for (@parent) do |f| %&gt;\n\u00a0\u00a0\u00a0\u00a0 &lt;%= f.input :name, label: 'name' %&gt;\n\u00a0\u00a0\u00a0\u00a0 &lt;%= f.simple_fields_for :children, @children do |child_form| %&gt;\n    \u00a0\u00a0\u00a0\u00a0 &lt;%= child_form.input :name, label: \"Child Name\" %&gt;\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;%= child_form.simple_fields_for :school, @school do |school %&gt;\n        \u00a0\u00a0\u00a0\u00a0 &lt;%= school.collection_select :id, @schools, :id, :name, {}, {} %&gt;\n    \u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0&lt;% end %&gt;\n\u00a0\u00a0\u00a0\u00a0 &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I set up the <code>new</code> controller method to create a <code>Parent</code> having three <code>Children</code> enrolled in an existing <code>School</code>. Then I tried to associate the\u00a0<code>Children</code> with a <code>School</code> that already exists in the <code>schools</code> table with id = 1.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def new\n   @parent = Parent.new\n   # creating 3 children\n   @children = Array.new(3) {@parent.children.build}\n   @school = School.find(1)\n   @school.children.build\nend\n</code></pre>\n\n<p>This throws an error\u00a0</p>\n\n<pre><code>Couldn't find School with ID=1 for Child with ID=\n</code></pre>\n\n<p>The error is located in the first line of the create method, which looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n    @parent = Parent.new(parent_params.merge(:user =&gt; current_user))\n    if @parent.save\n        redirect_to root_path\n    else\n        render :new, :status =&gt; :unprocessable_entity\n    end\nend\n\ndef parent_params\n    params.require(:parent).permit(:name, :child_attributes =&gt; [:id, :name, age, :school_attributes =&gt; [:id, :name]])\nend\n</code></pre>\n\n<p>Since the error text\u00a0states <code>\"Child with ID= \"</code>, the error must be thrown before ids for new <code>Children</code> are assigned. Why can a <code>School</code> with ID=1 not be\u00a0found when it exists in the <code>schools</code> table? Or, does this mean that a <code>School</code> record has not been properly associated with an instance of\u00a0<code>Child</code> before an attempt is made to save that instance? If so, how can I fix the association?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572371981, "post_id": 58612975, "comment_id": 103536201, "body": "<code>IN</code> is neither a keyword nor a method. <code>if</code> statements to not have blocks. <code>(:B, :C)</code> is not valid code. <code>A</code> is a constant whose value has not been given. You may want something like <code>if [:B, :C].include?(:A); &lt;do something&gt;; end</code>."}, {"owner": {"reputation": 1684, "user_id": 49077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a3322359c14e123b7cfcdfba970499b7?s=128&d=identicon&r=PG", "display_name": "Edin Omeragic", "link": "https://stackoverflow.com/users/49077/edin-omeragic"}, "edited": false, "score": 0, "creation_date": 1572373099, "post_id": 58612975, "comment_id": 103536658, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/1986386/check-if-a-value-exists-in-an-array-in-ruby\">Check if a value exists in an array in Ruby</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1572388832, "post_id": 58612975, "comment_id": 103542258, "body": "&quot;But it is not working&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1572420240, "post_id": 58612975, "comment_id": 103549150, "body": "<i>&quot;I have a normal if condition&quot;</i> \u2013 it&#39;s anything but normal. Ruby doesn&#39;t use curly braces for <code>if</code> statements. There are no uppercase operators in Ruby, there&#39;s no <code>IN</code> operator and there are no stand-alone <code>(:B, :C)</code> lists in Ruby, either. Maybe you&#39;re coming from another programming language, but you can&#39;t expect some arbitrary syntax to work \u2013 of course it is not working."}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1572374877, "creation_date": 1572374877, "answer_id": 58613647, "question_id": 58612975, "link": "https://stackoverflow.com/questions/58612975/how-to-do-if-condition-check-for-value-a-against-multiple-values-in-ruby-on-rail/58613647#58613647", "title": "How to do if condition check for value A against multiple values in Ruby on Rails?", "body": "<p>Your syntax is not valid ruby code. To check if an item is in a collection, use <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-include-3F\" rel=\"nofollow noreferrer\">Enumerable#.include?</a></p>\n\n<pre><code>if [:B, :C].include?(:A)\n  # do something\nend\n</code></pre>\n"}], "owner": {"reputation": 2913, "user_id": 3705478, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0Rnp5.jpg?s=128&g=1", "display_name": "sofs1", "link": "https://stackoverflow.com/users/3705478/sofs1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1572451767, "creation_date": 1572371594, "last_edit_date": 1572451767, "question_id": 58612975, "link": "https://stackoverflow.com/questions/58612975/how-to-do-if-condition-check-for-value-a-against-multiple-values-in-ruby-on-rail", "title": "How to do if condition check for value A against multiple values in Ruby on Rails?", "body": "<p>What is the correct syntax to check something like this?</p>\n\n<pre><code>if A IN (:B, :C ) {\n do something\n}\n</code></pre>\n\n<p>I get syntax error but what is the proper way to do this in Ruby?</p>\n\n<pre><code>SyntaxError: unexpected ',', expecting ')'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "edited": false, "score": 0, "creation_date": 1572372454, "post_id": 58612985, "comment_id": 103536393, "body": "Oh awesome, that&#39;s what I was looking for."}], "tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": true, "score": 1, "last_activity_date": 1572371658, "creation_date": 1572371658, "answer_id": 58612985, "question_id": 58612857, "link": "https://stackoverflow.com/questions/58612857/build-hash-with-computed-properties-out-of-a-service-class/58612985#58612985", "title": "Build hash with computed properties out of a service class", "body": "<p>You can use metaprogramming like:</p>\n\n<pre><code># the only public method\ndef call\n  %w[adverb_count adverb_density sentiment word_count letter_count].each_with_object({}) do |method_name, result|\n    result[method_name] = send(method_name)\n  end\nend\n\nprivate\n\ndef adverb_count\n  # use pre_analysis and post_analysis to computate this value here\nend\n\ndef adverb_density\n  # use pre_analysis and post_analysis to computate this value here\nend\n\n# and so on...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12212177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58612985, "answer_count": 1, "score": 3, "last_activity_date": 1572371658, "creation_date": 1572371090, "question_id": 58612857, "link": "https://stackoverflow.com/questions/58612857/build-hash-with-computed-properties-out-of-a-service-class", "title": "Build hash with computed properties out of a service class", "body": "<p>I would like help to finish a piece of code. I don't exactly how to explain what I need, so I will show you bit by bit.</p>\n\n<p>I have this model:</p>\n\n<pre><code>class Metric &lt; ApplicationRecord\n  belongs_to: :post\n  after_save: :analysis!\n\n  # The table Metrics has the following columns:\n  # adverb_count\n  # adverb_density\n  # sentiment\n  # word_count\n  # letter_count\n\n  def analysis!\n    res = MetricService.call post.body\n    update! res\n  end\nend\n</code></pre>\n\n<p>Once a metric instance is saved, I need to call an external service that will return a hash containing properties that will help me computate the values <code>adverb_count</code>, <code>adverb_density</code>, <code>sentiment</code>, <code>word_count</code>, and finally <code>letter_count</code>. For that, I've created a <code>MetricService</code> class that encapsulates this logic:</p>\n\n<pre><code>class ApplicationService\n  def self.call(*args, &amp;block)\n    new(*args, &amp;block).call\n  end\nend\n\nclass MetricService &lt; ApplicationService\n  extend Memoist\n\n  def initiaze(text)\n    @text = text\n  end\n\n  # TODO: return the\n  def call\n    pre_analysis\n    # =&gt;\n    #  Hash containing several props\n\n    post_nalysis\n    # =&gt;\n    #  Hash containing sereral props\n  end\n\n  private\n\n  def pre_analysis\n    client.pre_analysis @text\n  end\n  memoize :pre_analysis\n\n  def post_analysis\n    client.post_analysis pre_analysis['id']\n  end\n\n  def client\n    SDK::Service.new ENV['API_KEY']\n  end\n  memoize :client\nend\n</code></pre>\n\n<p>After the instantiation of this class, I call two methods of the <code>client</code>: <code>pre_analysis</code> and <code>post_analyis</code>, and with those two informations I can finally computate the values of properties <code>adverb_count, adverb_density, sentiment, word_count, and letter_count</code> and return it to the <code>Metric</code>. What I would like to do is create for each property a method:</p>\n\n<pre><code>class MetricService &lt; ApplicationService\n\n   # ...\n   def adverb_count\n     # use pre_analysis and post_analysis to computate this value here\n   end\n\n   def adverb_density\n     # use pre_analysis and post_analysis to computate this value here\n   end\n\n   def sentiment\n     # use pre_analysis and post_analysis to computate this value here\n   end\n\n   def word_count\n     # use pre_analysis and post_analysis to computate this value here\n   end\n\n   def letter_count\n     # use pre_analysis and post_analysis to computate this value here\n   end\n   # ...\nend\n</code></pre>\n\n<p>And from the <code>call</code> method I just call them and return the hash.</p>\n\n<p>From what I researched, services on ROR should only contain one public method, so I guess I should keep those properties private. Is this a correct assumption?</p>\n\n<p>Is there a way to build the hash from <code>#call</code> without having to call each one of those methods individually? E.g:</p>\n\n<pre><code>def call\n  {\n    adverb_count: adverb_count\n    # etc\n  }\nend\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572387641, "post_id": 58612582, "comment_id": 103541978, "body": "You can just create an <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/verifying-doubles/using-an-instance-double\" rel=\"nofollow noreferrer\">instance double</a> (<code>notifier = instance_double(&quot;ConsoleNotifier&quot;)</code>) or class double instead of stubbing<code>is_a?</code>."}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572435129, "post_id": 58612582, "comment_id": 103556519, "body": "@max I have no idea, to be honest. The trick is that I need something that identifies as a Watir::Browser because some of the tests will query that instance and be able to determine something from it. I&#39;m actually running into an entirely different problem now which may mean I have to consider something like what you&#39;re talking about."}], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "edited": false, "score": 1, "creation_date": 1572372430, "post_id": 58613093, "comment_id": 103536380, "body": "Do you mean for my second test? I ended up trying this (and comment suck for code): <code>expect { Empiric.quit_browser }.not_to raise_error</code> then I have <code>Empiric.start_browser mock_driver</code> and then I have <code>allow(mock_driver).to receive(:quit)</code>. Is the last one more what you mean? I&#39;m allowing the mock_driver to receive the call. What that in place, I get a different error at least: <code>expected Symbol or Selenium::WebDriver::Driver, got RSpec::Mocks::Double</code>. I still feel like this is just shooting in the dark though."}, {"owner": {"reputation": 49, "user_id": 8184692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3284b0e599c98bcedfa703fc67f2ad11?s=128&d=identicon&r=PG&f=1", "display_name": "Micah Condritch", "link": "https://stackoverflow.com/users/8184692/micah-condritch"}, "reply_to_user": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "edited": false, "score": 0, "creation_date": 1572372549, "post_id": 58613093, "comment_id": 103536434, "body": "Okay, so that error is because of what&#39;s getting passed to your <code>start_browser</code> thing. If I were you I would simply avoid mocks altogether here and just do a series of allow statements for the browser object. I&#39;ll update my answer a bit."}], "tags": [], "owner": {"reputation": 49, "user_id": 8184692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3284b0e599c98bcedfa703fc67f2ad11?s=128&d=identicon&r=PG&f=1", "display_name": "Micah Condritch", "link": "https://stackoverflow.com/users/8184692/micah-condritch"}, "is_accepted": false, "score": 1, "last_activity_date": 1572372744, "last_edit_date": 1572372744, "creation_date": 1572372127, "answer_id": 58613093, "question_id": 58612582, "link": "https://stackoverflow.com/questions/58612582/mocking-a-browser-for-rspec-without-test-doubles-leaking/58613093#58613093", "title": "Mocking a Browser for RSpec, Without Test Doubles Leaking", "body": "<p>I think you have to use <code>allow</code> with the mock and not <code>Watir::Browser</code>.</p>\n\n<p>For example, what happens if you allow the mock browser to receive whatever calls the browser would and have the it return the mock browser?</p>\n\n<p>Right now you're allowing the \"Watir::Browser\" to receive those messages and that's returning an \"Empiric.browser\". Looking at your code, I understand why you put that in there but I think that might be what's screwing you up here.</p>\n\n<p>Mocks in RSpec are horrible things that rarely if ever work correctly in situations like this. I would entirely recommend not using the <code>mock_driver</code> that you have set up. Rather, for each of your tests just do something similar to what you are doing in the <code>mock_driver</code>. My guess is you're including the mock driver as part of a shared context and that, too, is another thing that is <em>very</em> fragile in RSpec. Not recommended.</p>\n\n<p>Instead you might want to use contexts to break up your tests. Then for each context block have a before block. I'm not sure if you should use before:all or before:each given that you're simulating a browser. But that way you can set up the browser in the before and tear it down in an after.</p>\n\n<p>But I would recommend getting it working in each test individually first. Even if it's a lot of code duplication. Then once all tests are passing, refactor to put the browser stuff in those before/after blocks.</p>\n\n<p>But, again, don't use mocks. Don't use shared contexts. It never ends well and honestly it makes your tests harder to reason about.</p>\n"}, {"tags": [], "owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "is_accepted": true, "score": 0, "last_activity_date": 1572376025, "creation_date": 1572376025, "answer_id": 58613906, "question_id": 58612582, "link": "https://stackoverflow.com/questions/58612582/mocking-a-browser-for-rspec-without-test-doubles-leaking/58613906#58613906", "title": "Mocking a Browser for RSpec, Without Test Doubles Leaking", "body": "<p>Given some advice from Micah, I wanted to provide an answer with a solution. I ended up doing this:</p>\n\n<pre><code>  context \"an empiric driver is requested\" do\n    it \"a watir browser is provided\" do\n      allow(Watir::Browser).to receive(:new).and_return(Empiric.browser)\n      allow(Empiric.browser).to receive(:driver).and_return(true)\n      expect { Empiric.start_browser :some_browser }.not_to raise_error\n    end\n\n    it \"the requested watir browser can be shut down\" do\n      allow(Empiric.browser).to receive(:quit)\n      allow(Watir::Browser).to receive(:new).and_return(Empiric.browser)\n      allow(Empiric.browser).to receive(:driver).and_return(true)\n      expect { Empiric.quit_browser }.not_to raise_error\n    end\n  end\n</code></pre>\n\n<p>All of that was needed as it is or I would get some error or other. I removed my mock driver and, per Micah's suggestion, simply tried to incorporate what seemed to work. The above \"contraption\" is what I ended up with as the sweet spot.</p>\n\n<p>This works in the sense of giving coverage of the methods in question. What was interesting was that I had to add this to my RSpec configuration:</p>\n\n<pre><code>RSpec.configure do |config|\n  config.mock_with :rspec do |mocks|\n    mocks.allow_message_expectations_on_nil = true\n  end\nend\n</code></pre>\n\n<p>I needed to do this because RSpec was reporting that I was calling allowing something that was nil to receive a value.</p>\n\n<p>This brought up some interesting things, if you think about it. I have a test that is clearly passing. And it adds to my code coverage. But is it <em>actually</em> testing the quit action on a browser? Well, not really since it was testing a quit action on something that it thought was nil.</p>\n\n<p>But -- it does work. And it must be calling the lines of code in question because the code coverage, as reported my SimpleCov, indicates that the statements in question have been checked.</p>\n"}], "owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 58613906, "answer_count": 2, "score": 1, "last_activity_date": 1572376025, "creation_date": 1572369929, "question_id": 58612582, "link": "https://stackoverflow.com/questions/58612582/mocking-a-browser-for-rspec-without-test-doubles-leaking", "title": "Mocking a Browser for RSpec, Without Test Doubles Leaking", "body": "<p>I find mocking things with RSpec to be entirely problematic and I often don't know how much code to include, in terms of it being diagnostic. So I'll start with the situation I have and the code that I've isolated as causing the problem.</p>\n\n<p>I have tests where I need to mock a browser. I have a mock driver I set up like this:</p>\n\n<pre><code>require \"watir\"\n\ndef mock_driver\n  browser = double(\"watir\")\n  allow(browser).to receive(:is_a?).with(Watir::Browser).and_return(true)\n  allow(browser).to receive(:driver).and_return(true)\n  browser\nend\n</code></pre>\n\n<p>The only problems I have in my test suite are these two tests:</p>\n\n<pre><code>  context \"an empiric driver is requested\" do\n    it \"a watir browser is provided\" do\n      allow(Watir::Browser).to receive(:new).and_return(Empiric.browser)\n      Empiric.set_browser mock_driver\n    end\n\n    it \"the requested watir browser can be shut down\" do\n      #allow(Empiric.browser).to receive(:quit)\n      Empiric.quit_browser\n      #allow(mock_browser).to receive(:new).and_return(Empiric.browser)\n      #Empiric.set_browser mock_driver\n    end\n  end\n</code></pre>\n\n<p>(The commented out bits in the second test are on purpose to illustrate what's going on.)</p>\n\n<p>With that one line in place in the second test, I get the following error on that test:</p>\n\n<pre><code>&lt;Double \"watir\"&gt; was originally created in one example but has leaked into another\nexample and can no longer be used. rspec-mocks' doubles are designed to only last for\none example, and you need to create a new one in each example you wish to use it for.\n</code></pre>\n\n<p>If I entirely comment out the <em>first</em> test above, that error doesn't happen so I know I've isolated the two tests that are interacting with each other.</p>\n\n<p>Okay, now notice the final line of my second test that is commented out. That <em>seems</em> to be what the error is indicating to me. It's saying I need to create a new double in the other. Okay, so I'll change my last test:</p>\n\n<pre><code>    it \"the requested watir browser can be shut down\" do\n      #allow(Empiric.browser).to receive(:quit)\n      Empiric.quit_browser\n      #allow(mock_browser).to receive(:new).and_return(Empiric.browser)\n      Empiric.set_browser mock_driver\n    end\n</code></pre>\n\n<p>So here I've uncommented the last line so I'm establishing the <code>mock_driver</code> in that test and not allowing the code to leak.</p>\n\n<p>That, however, returns exactly the same error on exactly the same test.</p>\n\n<p>I'm not sure if it would help to see the methods that are being called in that test, but here they are. First is <code>set_browser</code>:</p>\n\n<pre><code>def set_browser(app = :chrome, *args)\n  @browser = Watir::Browser.new(app, *args)\n  Empiric.browser = @browser\nend\n</code></pre>\n\n<p>And here is <code>quit_browser</code>:</p>\n\n<pre><code>def quit_browser\n  @browser.quit\nend\n</code></pre>\n\n<p>The fact that RSpec thought one test was \"leaking\" into the other made me think that perhaps my <code>@browser</code> instance was the problem, essentially being what's persisting between the two tests. But I don't see how to get around that. I thought that maybe if I quit the browser in the first test, that would help. So I changed the first test to this:</p>\n\n<pre><code>it \"a watir browser is provided\" do\n  Empiric.quit_browser\n  allow(Watir::Browser).to receive(:new).and_return(Empiric.browser)\n  Empiric.start_browser mock_driver\nend\n</code></pre>\n\n<p>That, however, led to the above error being shown on <em>both</em> tests now.</p>\n\n<p>My more likely accurate guess is that I simply don't know how to provide a mock in this context.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "join"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1572370894, "post_id": 58612549, "comment_id": 103535740, "body": "Have you looked at <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/SpawnMethods.html#method-i-merge\" rel=\"nofollow noreferrer\">merge</a>?"}, {"owner": {"reputation": 795, "user_id": 4833129, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10203781604574761/picture?type=large", "display_name": "Nicholas Hassan", "link": "https://stackoverflow.com/users/4833129/nicholas-hassan"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572371838, "post_id": 58612549, "comment_id": 103536141, "body": "@jvillian this is similar, but it requires the inputs to be in ActiveRecord::Relation format. I don&#39;t see how I can perform grouped calculations while maintaining that format."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572372205, "post_id": 58612549, "comment_id": 103536283, "body": "Can you please show a sample of the two entities (arrays, maybe? or hashes?) you are attempting to combine and what you want the result to look like?"}, {"owner": {"reputation": 795, "user_id": 4833129, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10203781604574761/picture?type=large", "display_name": "Nicholas Hassan", "link": "https://stackoverflow.com/users/4833129/nicholas-hassan"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572373544, "post_id": 58612549, "comment_id": 103536846, "body": "@jvillian sorry upon closer inspection I think this is mostly what I&#39;m looking for but I&#39;ll have to read the documentation to understand better how to use it. Do you know if there&#39;s anything like a &quot;left_merge&quot; though? Similar to a left_join, where it will merge on common values but not omit ones that don&#39;t match?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572374390, "post_id": 58612549, "comment_id": 103537197, "body": "Again, if you show some example data, it&#39;s a lot easier to help. Otherwise, it&#39;s sort of guess work."}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1572382267, "last_edit_date": 1572382267, "creation_date": 1572377942, "answer_id": 58614301, "question_id": 58612549, "link": "https://stackoverflow.com/questions/58612549/ruby-how-to-join-output-from-a-rails-command/58614301#58614301", "title": "Ruby - how to join output from a Rails command?", "body": "<p>You can select aggregates from joined tables and access them in the model by using aliases:</p>\n\n<pre><code>@users = User.joins(:purchases, :discount_usages)\n            .select(\n              \"users.id\", \n              \"MAX(purchases.purchase_date) AS latest_purchase\",\n              \"COUNT(discount_usages.*) AS discount_usages_count\"\n            )\n            .group(\"users.id\")\n</code></pre>\n\n<p>If you want to hydrate the other attributes of the records select <code>users.*</code> instead of just <code>users.id</code>.</p>\n\n<pre><code>&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Id&lt;/th&gt;\n      &lt;th&gt;Latest Purchase&lt;/th&gt;\n      &lt;th&gt;Discount usages&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n    &lt;% @users.each do |user| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= user.id %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= user.latest_purchase %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= user.discount_usages_count %&gt;&lt;/td&gt;   \n    &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<blockquote>\n  <p>I want my final output to be one table though, joined on users.id, but\n  the output from select isn't the right data type to work on with Rails\n  functions.</p>\n</blockquote>\n\n<p>Not sure quite what you mean here. This example will return a collection of user records just like a normal query.\nIf you want a \"raw\" result with just an array of arrays use <code>.pluck</code> instead of <code>.select</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5605783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06093b4935cda4b263c4cba3de6b10d3?s=128&d=identicon&r=PG&f=1", "display_name": "Bricks", "link": "https://stackoverflow.com/users/5605783/bricks"}, "is_accepted": false, "score": 0, "last_activity_date": 1572380325, "creation_date": 1572380325, "answer_id": 58614820, "question_id": 58612549, "link": "https://stackoverflow.com/questions/58612549/ruby-how-to-join-output-from-a-rails-command/58614820#58614820", "title": "Ruby - how to join output from a Rails command?", "body": "<p>I assume a User may not have any purchases and not all purchases use discount codes.</p>\n\n<p>However, you want a full listing of each user with their last purchase date and total discount usages over all purchases. You may need to use a right join.</p>\n\n<p>Something like:</p>\n\n<pre><code>query = User.select('users.id AS user_id', 'MAX(purchases.purchase_date) AS last_purchase_date', 'COUNT(discount_usages.id) AS total_discount_usages')\n  .joins('LEFT JOIN purchases ON purchases.user_id = users.id')\n  .joins('LEFT JOIN discount_usages ON discount_usages.user_id = purchases.user_id')\n  .group('users.id')\n  .to_sql\n</code></pre>\n\n<p>Then in order to grab the fields you could use:</p>\n\n<pre><code>rows = ApplicationRecord.connection.select_all(query).to_hash\n</code></pre>\n\n<p><a href=\"https://guides.rubyonrails.org/active_record_querying.html#select-all\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_querying.html#select-all</a></p>\n\n<p>This will give you an array of hashes with keys: 'user_id', 'last_purchase_date', 'total_discount_usages'.</p>\n\n<pre><code>...\n&lt;% rows.each do |row| %&gt;\n  &lt;% row.symbolize_keys! %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= row[:user_id] %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= row[:last_purchase_date] %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= row[:total_discount_usages] %&gt;&lt;/td&gt;\n  &lt;tr&gt;\n...\n\n</code></pre>\n"}], "owner": {"reputation": 795, "user_id": 4833129, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10203781604574761/picture?type=large", "display_name": "Nicholas Hassan", "link": "https://stackoverflow.com/users/4833129/nicholas-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572382267, "creation_date": 1572369799, "question_id": 58612549, "link": "https://stackoverflow.com/questions/58612549/ruby-how-to-join-output-from-a-rails-command", "title": "Ruby - how to join output from a Rails command?", "body": "<p>There are multiple calculations I'd like to be able to perform on my database, all centred around a user id, but I don't know how to recombine them after.</p>\n\n<p>Let's say I have three tables for <code>User</code>, <code>Purchases</code>, and <code>DiscountUsage</code>. I want to find the last date a user made a purchase and the total number of discounts used. I would run two separate commands:</p>\n\n<pre><code>User.joins(:purchases).group(\"users.id\").select(\"users.id\", \"MAX(purchases.purchase_date)\")\nUser.joins(:discount_usages).group(\"users.id\").select(\"users.id\", \"COUNT(*)\")\n</code></pre>\n\n<p>I want my final output to be one table though, joined on <code>users.id</code>, but the output from <code>select</code> isn't the right data type to work on with Rails functions. How can I represent that the <code>users.id</code> values from both calls are the same and thus join them based on those columns?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 1, "last_activity_date": 1572369328, "creation_date": 1572369328, "answer_id": 58612416, "question_id": 58612194, "link": "https://stackoverflow.com/questions/58612194/how-do-i-get-a-list-of-required-fields-in-a-model-in-rails/58612416#58612416", "title": "How do I get a list of required fields in a model in Rails?", "body": "<blockquote>\n  <p>How do I get a list of required fields in a model in Rails?</p>\n</blockquote>\n\n<p>You can get it by calling:</p>\n\n<pre><code># Refactor if needed\nModel.validators.select{ |v| v.instance_of?(ActiveRecord::Validations::PresenceValidator) }.map{ |v| v.attributes }.flatten\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 3, "last_activity_date": 1572369347, "creation_date": 1572369347, "answer_id": 58612420, "question_id": 58612194, "link": "https://stackoverflow.com/questions/58612194/how-do-i-get-a-list-of-required-fields-in-a-model-in-rails/58612420#58612420", "title": "How do I get a list of required fields in a model in Rails?", "body": "<p>I think <code>validators</code> work, but you must filter for <code>presence</code> validators:</p>\n\n<pre><code>ModelName.\n  validators.                                        \n  grep(ActiveRecord::Validations::PresenceValidator). # only `presence`\n  flat_map(&amp;:attributes)                              # only the attribute names\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 12292743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sy6nI.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/12292743/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 1, "accepted_answer_id": 58612420, "answer_count": 2, "score": 3, "last_activity_date": 1572374972, "creation_date": 1572368451, "question_id": 58612194, "link": "https://stackoverflow.com/questions/58612194/how-do-i-get-a-list-of-required-fields-in-a-model-in-rails", "title": "How do I get a list of required fields in a model in Rails?", "body": "<p>I am using Ruby on Rails and I have a model with many different required fields. Is there a way to retrieve a list of only the fields that are required? \nI don't believe ModelName.validators works because I only want the fields that are required. I have also tried ModelName.column_names but that gives me all the fields.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1572364941, "post_id": 58611128, "comment_id": 103532747, "body": "<code>#include?</code> is what you want"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572371164, "post_id": 58611128, "comment_id": 103535857, "body": "You say &quot;...incomplete params <i>like</i>...&quot;. What do you mean by &quot;like&quot;?  Specifically, what is the <i>rule</i> for determining if a value has been abbreviated, and if it has been, the <i>rule</i> for modifying it? How do we know that  <code>&quot;tregfsd&quot;</code> should not be changed to <code>&quot;tregfsd123&quot;</code>? Is it only the literal <code>&quot;231421&quot;</code> you are looking for as a value? Do you wish to change every value <code>&quot;231421&quot;</code> to  <code>&quot;231421AAAAA company&quot;</code>? Please clarify by editing your answer (rather than elaborating in a comment). Also,  <code>company_name = &quot;231421&quot;</code> should be <code>:company_name =&gt; &quot;231421&quot;</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572381614, "post_id": 58611128, "comment_id": 103540008, "body": "Please see &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572366121, "post_id": 58611192, "comment_id": 103533387, "body": "That&#39;s great, do you know how to show only id for each searched value?"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572366385, "post_id": 58611192, "comment_id": 103533504, "body": "@mr_muscle You can use <code>pluck</code> method:  <code>a.select{ |company| company[:company_name].include?(company_name) }.pluck(:id)</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1572370087, "post_id": 58611192, "comment_id": 103535387, "body": "<code>include?</code> is good, but keep in mind it finds in any position, not just the start."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 1, "last_activity_date": 1572365581, "last_edit_date": 1572365581, "creation_date": 1572364968, "answer_id": 58611192, "question_id": 58611128, "link": "https://stackoverflow.com/questions/58611128/how-to-search-in-an-array-of-hashes-by-each-character/58611192#58611192", "title": "How to search in an array of hashes by each character", "body": "<p>If you want one record:</p>\n\n<pre><code>a.find{ |company| company[:company_name].include?(company_name) }\n#=&gt; { :id =&gt; 51, :company_name =&gt; \"231421AAAAA company\" }\n</code></pre>\n\n<p>If you want more than one match record, use <code>select</code> instead of <code>find</code>:</p>\n\n<pre><code>company_name = 'a'\na.select{ |company| company[:company_name].include?(company_name) }\n#=&gt; [\n#     { :id =&gt; 51, :company_name =&gt; \"231421AAAAA company\" },\n#     { :id =&gt; 53, :company_name =&gt; \"aaaaa\" }\n#   ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1572366444, "creation_date": 1572366444, "answer_id": 58611650, "question_id": 58611128, "link": "https://stackoverflow.com/questions/58611128/how-to-search-in-an-array-of-hashes-by-each-character/58611650#58611650", "title": "How to search in an array of hashes by each character", "body": "<p>I would use <a href=\"https://ruby-doc.org/core-2.6.5/String.html#method-i-start_with-3F\" rel=\"nofollow noreferrer\"><code>String#start_with?</code></a></p>\n\n<pre><code>a.detect { |d| d[:company_name].start_with?('231421') } \n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58611192, "answer_count": 2, "score": 0, "last_activity_date": 1572366444, "creation_date": 1572364768, "question_id": 58611128, "link": "https://stackoverflow.com/questions/58611128/how-to-search-in-an-array-of-hashes-by-each-character", "title": "How to search in an array of hashes by each character", "body": "<p>I've got an array of hashes:</p>\n\n<pre><code>2.6.0 :132 &gt; a = [{:id=&gt;51, :company_name=&gt;\"231421AAAAA company\"},\n{:id=&gt;52, :company_name=&gt;\"tregfsd\"}, {:id=&gt;53, :company_name=&gt;\"aaaaa\"},\n{:id=&gt;54, :company_name=&gt;\"zzzzzz\"}, {:id=&gt;55, :company_name=&gt;\"bbbbb\"}]\n</code></pre>\n\n<p>How to find data in case when user provide incomplete params like <code>company_name = \"231421\"</code> it should return</p>\n\n<pre><code> =&gt; {:id=&gt;51, :company_name=&gt;\"231421AAAAA company\"}\n</code></pre>\n\n<p>I was trying to use <code>a.detect { |d| d[:company_name] == '231421' }</code> but I've got <code>=&gt; nil</code></p>\n\n<p>What should I use to do search it without giving the whole <code>company_name</code> ?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 1, "last_activity_date": 1572365800, "last_edit_date": 1572365800, "creation_date": 1572365275, "answer_id": 58611295, "question_id": 58610588, "link": "https://stackoverflow.com/questions/58610588/killing-shell-processes-when-thread-dies/58611295#58611295", "title": "Killing shell processes when thread dies", "body": "<p>You can't (with a general flag on <code>Thread</code> at least). It's a separate process that you started in a thread. The thread dying doesn't stop the process.</p>\n\n<p>You have to save the pid of the process and terminate it explicitly:</p>\n\n<pre><code>Thread.report_on_exception = false\nThread.abort_on_exception = true\n\npids = []\n\nat_exit do\n  pids.each do |pid|\n    `kill -9 #{pid}`\n  end\nend\n\nThread.new do\n  pids.push Process.spawn('for((i=0; ;++i)); do echo \"$i\"; sleep 1; done')\nend\n\nsleep 5\nraise 'Failure'\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0\n1\n2\n3\n4\nTraceback (most recent call last):\ntest.rb:17:in `&lt;main&gt;': Failure (RuntimeError)\n</code></pre>\n\n<p>Needless to say, don't use this code as is in production.</p>\n"}], "owner": {"reputation": 21271, "user_id": 168143, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/75fb60cc633a994debfe8b3a19eb91cb?s=128&d=identicon&r=PG", "display_name": "John Bachir", "link": "https://stackoverflow.com/users/168143/john-bachir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58611295, "answer_count": 1, "score": 3, "last_activity_date": 1572365800, "creation_date": 1572362986, "question_id": 58610588, "link": "https://stackoverflow.com/questions/58610588/killing-shell-processes-when-thread-dies", "title": "Killing shell processes when thread dies", "body": "<p>I have code like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#! /usr/bin/env ruby\n\nThread.report_on_exception=false\nThread.abort_on_exception=true\n\nThread.new do\n  `shellcommand 1 2 3`\nend\n\ndo_other_stuff\n</code></pre>\n\n<p>If <code>do_other_stuff</code> encounters an exception, it kills the thread and the whole ruby process, which is what I want. But, <code>shellcommand 1 2 3</code> continues running in the background.</p>\n\n<p>How can I have <code>shellcommand 1 2 3</code> also be killed when the ruby process aborts?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model", "controller", "rubygems"], "comments": [{"owner": {"reputation": 1692, "user_id": 9288619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6IK38.jpg?s=128&g=1", "display_name": "code_aks", "link": "https://stackoverflow.com/users/9288619/code-aks"}, "edited": false, "score": 0, "creation_date": 1572359177, "post_id": 58609180, "comment_id": 103529438, "body": "I think you need one more model... like Room Or Conversation which have both fromuser_id  and touser_id and then associate it with Conversation has_many messages and User has many conversations.... etc etc...."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 1692, "user_id": 9288619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6IK38.jpg?s=128&g=1", "display_name": "code_aks", "link": "https://stackoverflow.com/users/9288619/code-aks"}, "edited": false, "score": 1, "creation_date": 1572359408, "post_id": 58609180, "comment_id": 103529575, "body": "@code_aks I don&#39;t think he needs another model, he can just query all messages where <code>fromuser</code> is some id and <code>touser</code> is some id and sort them by <code>created_at</code>. That&#39;s your conversation"}], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1572359523, "post_id": 58609488, "comment_id": 103529665, "body": "You&#39;re, like, two minutes too fast! As always, the bomb."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 6, "last_activity_date": 1572385871, "last_edit_date": 1572385871, "creation_date": 1572359365, "answer_id": 58609488, "question_id": 58609180, "link": "https://stackoverflow.com/questions/58609180/how-denominate-foreign-keys-in-rubyonrails/58609488#58609488", "title": "How denominate foreign-keys in rubyonrails?", "body": "<p>Lets swap the names to <code>sender</code> and <code>recipient</code> which will make this a lot more understandable.</p>\n\n<pre><code>class User\n  has_many :sent_messages,\n     class_name: \"Message\",\n     foreign_key: :sender_id\n  has_many :recieved_messages,\n     class_name: \"Message\",\n     foreign_key: :recipient_id\n\n  def conversation_with(other_user)\n     Message.where(\n       \"(recipient_id = :a AND sender_id = :b) OR (recipient_id = :b AND sender_id = :a)\", \n       a: self.id, b: other_user.id\n     ).order(:created_at)\n  end\nend\n\nclass Message\n  belongs_to :sender, class_name: 'User'\n  belongs_to :recipient, class_name: 'User'\nend\n</code></pre>\n\n<p>See:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1992019/how-can-i-rename-a-database-column-in-a-ruby-on-rails-migration\">How can I rename a database column in a Ruby on Rails migration?</a></li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 3066435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1yCDR.jpg?s=128&g=1", "display_name": "Finn", "link": "https://stackoverflow.com/users/3066435/finn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58609488, "answer_count": 1, "score": 1, "last_activity_date": 1572385871, "creation_date": 1572358398, "question_id": 58609180, "link": "https://stackoverflow.com/questions/58609180/how-denominate-foreign-keys-in-rubyonrails", "title": "How denominate foreign-keys in rubyonrails?", "body": "<p>I explain my problem:</p>\n\n<p>I have 2 models:</p>\n\n<pre><code>- User (id, firstname, lastname, deviceid, email, password);\n- Message (id, fromuser, touser, description)\n</code></pre>\n\n<p>I want foreign-keys:</p>\n\n<pre><code>-: fromuser (Message) -&gt; id (User)\n-: touser (Message) -&gt; id (User)\n</code></pre>\n\n<p>in my model: </p>\n\n<pre><code>USER\n-&gt; has_many :messages\n\nMESSAGE\n-&gt; belongs_to :users\n</code></pre>\n\n<p>in my schema migrations:</p>\n\n<pre><code>create_table \"messages\", force: :cascade do |t|\nt.string \"description\"\nt.integer \"fromuser\"\nt.integer \"touser\"\nt.datetime \"created_at\", precision: 6, null: false\nt.datetime \"updated_at\", precision: 6, null: false\nend\n\ncreate_table \"users\", force: :cascade do |t|\nt.string \"firstname\"\nt.string \"lastname\"\nt.string \"deviceid\"\nt.string \"email\"\nt.string \"password\"\nt.datetime \"created_at\", precision: 6, null: false\nt.datetime \"updated_at\", precision: 6, null: false\nend\n</code></pre>\n\n<p>How can both foreign-key work?\nHow can explain this in my messages_controller.rb?</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572357516, "post_id": 58608352, "comment_id": 103528562, "body": "Are you sure that giving yourself a N+1 query issue is really the answer here? Can you instead provide an example of the data and the desired output? <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1572358603, "post_id": 58608352, "comment_id": 103529139, "body": "<code>if company_name.present?</code> will check also check if <code>company_name</code> might be an empty string"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572358945, "post_id": 58608352, "comment_id": 103529324, "body": "@max updated, is it what you wanted?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1572359128, "post_id": 58608352, "comment_id": 103529411, "body": "@lacostenycoder ok but now instead of <code>id: 1, name: nil</code> I&#39;ve got an array with nil values at the front and then hashes with some data - <code>=&gt; [nil, nil, nil, nil, nil, nil, [{:id=&gt;52, :name=&gt;&quot;tregfsd&quot;}, {:id=&gt;53, :name=&gt;&quot;aaaaa&quot;}]]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572359604, "post_id": 58609404, "comment_id": 103529707, "body": "With this code I&#39;ve <code>TypeError (no implicit conversion of Symbol into Integer)</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572360089, "post_id": 58609404, "comment_id": 103529950, "body": "try just <code>.compact</code> and omit the <code>.select</code>"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572360601, "post_id": 58609404, "comment_id": 103530254, "body": "I&#39;ve mixed up something, it works with and without <code>select</code>. Now I&#39;ve to avoid N+1 somehow."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572362573, "post_id": 58609404, "comment_id": 103531434, "body": "@mr_muscle so is <code>.select</code> needed? I removed it"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1572360535, "last_edit_date": 1572360535, "creation_date": 1572359155, "answer_id": 58609404, "question_id": 58608352, "link": "https://stackoverflow.com/questions/58608352/create-hash-inside-loop-with-query/58609404#58609404", "title": "Create hash inside loop with query", "body": "<p>This type of iteration will need to be optimized to avoid N+1 query problem on large data sets.  But this will probably work for you for now.</p>\n\n<pre><code>Process.all.map do |process|\n  company_name = process.inquiry_field_responses\n                        .joins(:inquiry_field)\n                        .where(inquiry_fields: { name: 'company_name' })\n                        .first&amp;.value\n  if company_name.present?\n    {\n      id: process.id,\n      name: company_name,\n    }\n  end\nend.compact\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1572366681, "creation_date": 1572366681, "answer_id": 58611705, "question_id": 58608352, "link": "https://stackoverflow.com/questions/58608352/create-hash-inside-loop-with-query/58611705#58611705", "title": "Create hash inside loop with query", "body": "<p>Instead of starting the query chain from the <em>Process</em> model you could opt to start from the <em>InquiryField</em> model.</p>\n\n<p>This answer assumes the following model associations:</p>\n\n<pre><code># app/models/process.rb\nclass Process &lt; ApplicationRecord\n  has_many :inquiry_field_responses\nend\n</code></pre>\n\n\n\n<pre><code># app/models/inquiry_field_response.rb\nclass InquiryFieldResponse &lt; ApplicationRecord\n  belongs_to :process\n  belongs_to :inquiry_field\nend\n</code></pre>\n\n\n\n<pre><code># app/models/inquiry_field.rb\nclass InquiryField &lt; ApplicationRecord\n  has_many :inquiry_field_responses\nend\n</code></pre>\n\n<p>With the assumptions out of the way let's get to the answer.</p>\n\n<pre><code>inquiry_field = inquiry_field.find_by!(name: 'company_name')\ninquiry_field_responses = inquiry_field.inquiry_field_responses.where.not(value: '')\n\nfields = %i[process_id value]\nlabels = %i[id name]\n\nfetcher = inquiry_field_responses.pluck(*fields).map { |data| labels.zip(data).to_h }\n</code></pre>\n\n<p>I first fetch the inquiry field that describes the field you want. From there I get the inquiry field responses without empty or <code>NULL</code> value. Get the fields you want using the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-pluck\" rel=\"nofollow noreferrer\"><code>pluck</code></a> method and  <a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a> the resulting array. <a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-zip\" rel=\"nofollow noreferrer\"><code>zip</code></a> the labels to the data and convert the resulting array to a hash using <a href=\"https://ruby-doc.org/core-2.6.5/Array.html#method-i-to_h\" rel=\"nofollow noreferrer\"><code>to_h</code></a>.</p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 58609404, "answer_count": 2, "score": 1, "last_activity_date": 1572366681, "creation_date": 1572355590, "last_edit_date": 1572358683, "question_id": 58608352, "link": "https://stackoverflow.com/questions/58608352/create-hash-inside-loop-with-query", "title": "Create hash inside loop with query", "body": "<p>I want to create a hash from data which are pulled out from db. The hash should looks like</p>\n\n<pre><code>hash { id: process.id,\n       name: company_name }\n</code></pre>\n\n<p>To get company_name I have to do some query which returns an array of strings with company names:</p>\n\n<pre><code>Process.all.map do |process|\n  process.inquiry_field_responses\n         .joins(:inquiry_field)\n         .where(inquiry_fields: { name: 'company_name' })\n         .first&amp;.value\nend\n</code></pre>\n\n<p>To create this hash I thought all I should do is something like:</p>\n\n<pre><code>fetcher = []\n\nProcess.all.map do |process|\n  company_name = process.inquiry_field_responses\n                        .joins(:inquiry_field)\n                        .where(inquiry_fields: { name: 'company_name' })\n                        .first&amp;.value\n  if company_name != nil\n    fetcher &lt;&lt; {\n      id: process.id,\n      name: company_name,\n    }\n  end\nend\n</code></pre>\n\n<p>But in the result I've:</p>\n\n<pre><code>    2.6.0 :318 &gt; fetcher\n =&gt; [{:id=&gt;1, :name=&gt;nil}, {:id=&gt;2, :name=&gt;nil}, {:id=&gt;3, :name=&gt;nil}, \n{:id=&gt;4, :name=&gt;nil}, {:id=&gt;5, :name=&gt;nil}, {:id=&gt;6, :name=&gt;nil}, {:id=&gt;7, \n:name=&gt;nil}, {:id=&gt;8, :name=&gt;nil}, {:id=&gt;9, :name=&gt;nil}, {:id=&gt;10, \n:name=&gt;nil}, {:id=&gt;11, :name=&gt;nil}, {:id=&gt;12, :name=&gt;nil}, {:id=&gt;13, \n:name=&gt;nil}, {:id=&gt;14, :name=&gt;nil}, {:id=&gt;15, :name=&gt;nil}, {:id=&gt;16, \n:name=&gt;nil}, {:id=&gt;17, :name=&gt;nil}, {:id=&gt;18, :name=&gt;nil}, {:id=&gt;19, \n:name=&gt;nil}, {:id=&gt;20, :name=&gt;nil}, {:id=&gt;21, :name=&gt;nil}, {:id=&gt;22, \n:name=&gt;nil}, {:id=&gt;23, :name=&gt;nil}, {:id=&gt;24, :name=&gt;nil}, {:id=&gt;25, \n:name=&gt;nil}, {:id=&gt;26, :name=&gt;nil}, {:id=&gt;27, :name=&gt;nil}, {:id=&gt;28, \n:name=&gt;nil}, {:id=&gt;29, :name=&gt;nil}, {:id=&gt;30, :name=&gt;nil}, {:id=&gt;31, \n:name=&gt;nil}, {:id=&gt;32, :name=&gt;nil}, {:id=&gt;33, :name=&gt;nil}, {:id=&gt;34, \n:name=&gt;nil}, {:id=&gt;35, :name=&gt;nil}, {:id=&gt;36, :name=&gt;nil}, {:id=&gt;37, \n:name=&gt;nil}, {:id=&gt;38, :name=&gt;nil}, {:id=&gt;39, :name=&gt;nil}, {:id=&gt;40, \n:name=&gt;nil}, {:id=&gt;41, :name=&gt;nil}, {:id=&gt;42, :name=&gt;nil}, {:id=&gt;43, \n:name=&gt;nil}, {:id=&gt;44, :name=&gt;nil}, {:id=&gt;45, :name=&gt;nil}, {:id=&gt;46, \n:name=&gt;nil}, {:id=&gt;47, :name=&gt;nil}, {:id=&gt;48, :name=&gt;nil}, {:id=&gt;49, \n:name=&gt;nil}, {:id=&gt;50, :name=&gt;nil}, {:id=&gt;51, :name=&gt;\"231421AAAAA firma\"}, \n{:id=&gt;52, :name=&gt;\"tregfsd\"}, {:id=&gt;53, :name=&gt;\"aaaaa\"}, {:id=&gt;54, \n:name=&gt;\"zzzzzz\"}, {:id=&gt;55, :name=&gt;\"bbbbb\"},\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>2.6.0 :318 &gt; fetcher\n{:id=&gt;52, :name=&gt;\"tregfsd\"}, {:id=&gt;53, :name=&gt;\"aaaaa\"}, {:id=&gt;54, \n:name=&gt;\"zzzzzz\"}, {:id=&gt;55, :name=&gt;\"bbbbb\"},\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1572356637, "creation_date": 1572356637, "answer_id": 58608652, "question_id": 58608296, "link": "https://stackoverflow.com/questions/58608296/rspec-matcher-for-random-number-in-a-hash-value/58608652#58608652", "title": "Rspec matcher for random number in a hash value", "body": "<p>You could remove the random key with:</p>\n\n<pre><code>expect(hash.except(:change_requests )).to eq \n  expected_hash.except(:change_requests)\n</code></pre>\n\n<p>Or stub the method which generates <code>change_requests</code> to make it deterministic.</p>\n"}, {"tags": [], "owner": {"reputation": 1076, "user_id": 5362761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVJG5.jpg?s=128&g=1", "display_name": "Anuj Khandelwal", "link": "https://stackoverflow.com/users/5362761/anuj-khandelwal"}, "is_accepted": false, "score": 1, "last_activity_date": 1572356810, "creation_date": 1572356810, "answer_id": 58608703, "question_id": 58608296, "link": "https://stackoverflow.com/questions/58608296/rspec-matcher-for-random-number-in-a-hash-value/58608703#58608703", "title": "Rspec matcher for random number in a hash value", "body": "<p>Since the value of <code>change_requests</code> is a dynamic one, we basically need to check two things:</p>\n\n<p>1) <code>change_requests</code> is an array which contains two elements</p>\n\n<p>2) The rest of the hash, apart from <code>change_requests</code> is as expected (Here, change_requests is removed from the expected_hash declaration)</p>\n\n<p>We could achieve this by using the <code>reject</code> method on the newly created <code>PriceChangeService</code> object to check all keys and values EXCEPT <code>change_requests</code>. Additionally, we would need to check the <code>change_requests</code> value as mentioned in point (1).</p>\n\n<p>This could be done as follows:</p>\n\n<pre><code>before do\n  expect(PriceChangeService).to receive(:new) do |hash|\n    expect(hash.reject{|k, v| k == : change_requests}).to eq(expected_hash)\n    expect(hash[:change_requests].class).to eq(Array)\n    expect(hash[:change_requests].length).to eq(2)\n    price_change_service\n  end\nend\n\n</code></pre>\n\n<p>You could additionally check for the type of elements that are being expected as well.</p>\n"}], "owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58608652, "answer_count": 2, "score": 1, "last_activity_date": 1572356810, "creation_date": 1572355374, "question_id": 58608296, "link": "https://stackoverflow.com/questions/58608296/rspec-matcher-for-random-number-in-a-hash-value", "title": "Rspec matcher for random number in a hash value", "body": "<p>I'm trying to fix a test, but because we run the tests randomly, the <code>change_requests</code> end up being random, so the expected hash in the before do block always ends up failing. </p>\n\n<p>Error Example:</p>\n\n<pre><code>    Diff:\n       @@ -1,4 +1,4 @@\n       -:change_requests =&gt; [0, 0],\n       +:change_requests =&gt; [23, 24],\n</code></pre>\n\n<p>Test:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    let(:expected_hash) do\n      {\n        from_admin_user: user.first_name,\n        station_id: station.id,\n        ten_minutes_before_reminder: false,\n        one_hour_after_reminder: false,\n        change_requests: [0, 0],\n        one: requests[0][:new_price],\n        two: 'NO CHANGE',\n        three: 'NO CHANGE',\n        four: requests[1][:new_price],\n        price_change_at_time: nil\n      }\n\n    end\n\n    before do\n      expect(PriceChangeService).to receive(:new) do |hash|\n        expect(hash).to eq expected_hash\n        price_change_service\n      end\n    end\n</code></pre>\n\n<p>Is there away to solve this by, for example, adding a random number matcher somehow to the <code>change_requests</code> value?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1572355471, "post_id": 58608086, "comment_id": 103527385, "body": "Your page needs to fire a request to your rails app. During handling of this request, your app will call your method. Rails&#39; <code>button_to</code> could be useful: <a href=\"https://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionView/Helpers/UrlHelper/button_to</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572355712, "post_id": 58608341, "comment_id": 103527530, "body": "I think that the special little sessionID header is a key piece to the puzzle here and the reason he can&#39;t just use a link."}], "tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 3, "last_activity_date": 1572355559, "creation_date": 1572355559, "answer_id": 58608341, "question_id": 58608086, "link": "https://stackoverflow.com/questions/58608086/call-an-action-on-button-click-in-ruby-on-rails/58608341#58608341", "title": "Call an action on button click in ruby on rails", "body": "<p>I know this is confusing when you start developing in rails, but you have to consistently be very aware <em>where</em> your code is running. Your ruby code runs on the server, your html/js runs in the browser. Rails \"prepares\" html/js, but when you click a button, and you have to ask something from the server, you will have to use a <em>url</em> to acces a/any server. </p>\n\n<p>Or you could resort to using javascript on the client directly, to fetch the data. </p>\n\n<p>But since you already have the code in <code>lib</code> you will have to </p>\n\n<ul>\n<li>add an endpoint, aka an action in a controller (add a new controller or add a new action in an existing controller, that is a bit hard with so little background information)</li>\n<li>add a route to that controller/action</li>\n<li>add the controller-code to call your lib function and format the answer in such a way relevant for the user</li>\n</ul>\n\n<p>then add the button as follows: </p>\n\n<pre><code> &lt;%= link_to 'Button', my_action_controller_path(session_id: sessionId, token_document: token_document) %&gt;\n</code></pre>\n\n<p>(the name of the path depends on the names of controller/action, and you can see the names of the routes by running <code>rake routes</code>)</p>\n\n<p><em>However</em>  your code seems to just fetch a page at <code>myurl.com</code>, so you could also just build a link to <code>myurl.com</code> ? </p>\n\n<pre><code>&lt;%= link_to 'Button', 'http://myurl.com', target: '_blank' %&gt;\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11896746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/596186715598a7f6ec103fa0e51d5b68?s=128&d=identicon&r=PG&f=1", "display_name": "john bowlee", "link": "https://stackoverflow.com/users/11896746/john-bowlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572355559, "creation_date": 1572354518, "last_edit_date": 1572355320, "question_id": 58608086, "link": "https://stackoverflow.com/questions/58608086/call-an-action-on-button-click-in-ruby-on-rails", "title": "Call an action on button click in ruby on rails", "body": "<p>I have an action defined in my lib directory. The action is used to send a get request in the server. I want to execute the function on button click. How can I do this? I know this is not the right approach. I am new to rails.</p>\n\n<p>show_document.rb (in lib directory)</p>\n\n<pre><code>class Legaldoc::ShowDocument\n\ndef view_document(sessionID, token_document)\n    require 'rest-client'\n    require 'zip'\n    res = RestClient::Request.execute(\n        :method =&gt; :get,\n        :url =&gt; \"http://myurl.com\",\n        :headers =&gt; {\n            :ldsessionId =&gt; sessionID,\n        }\n    )\n  end\nend\n</code></pre>\n\n<p>in my view file</p>\n\n<pre><code>&lt;%= link_to 'Button', '#', :onclick =&gt; \"view_document(sessionID, token_document)\" %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 1, "creation_date": 1572352511, "post_id": 58607313, "comment_id": 103525884, "body": "In the first step, I&#39;d check what message is attached to the exception with <code>expect { ... }.to raise_error NoMethodError, &quot;No gem loaded for capybara&quot;</code>. Maybe it&#39;s a bug in coverage reporter?"}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1572353061, "post_id": 58607313, "comment_id": 103526142, "body": "Interesting. When I try that I get this from rspec: <code>expected NoMethodError with &quot;No gem loaded for capybara&quot;, got #&lt;NoMethodError: undefined method </code>get_version&#39; for Empiric:Module&gt;`. Which is definitely odd, since I can call that method outside of a test without issue and without adding the exception message, I don&#39;t get this error about the method not being found at all. The coverage tool I&#39;m using is SimpleCov."}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 1, "creation_date": 1572353139, "post_id": 58607313, "comment_id": 103526188, "body": "Heh, it&#39;s <code>get_version</code> vs <code>gem_version</code> ;)"}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "reply_to_user": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1572353242, "post_id": 58607313, "comment_id": 103526239, "body": "AARRRRGHHH! You&#39;re right. Okay, first that&#39;s embarrassing. But that&#39;s also interesting that the only way I found that -- beyond the failure of my mark 1 eyeball -- was to change the test to look for the message as well."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572353813, "post_id": 58607313, "comment_id": 103526542, "body": "Rescuing NoMethodError is not a good idea as its a really good way to mask bugs. Instead you should use <code>Hash#fetch</code> and rescue KeyError or the safe operator <code>.&amp;</code>."}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572354832, "post_id": 58607313, "comment_id": 103527046, "body": "@max, I learned that first lesson in spades so you are certainly correct. However, as to your second point, I don&#39;t see how to put it into use. What hash would I be using? What would the safe operator be applying to in my example? I assume that would go on the following line in my code: <code>Gem.loaded_specs[name].version</code>?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572355165, "post_id": 58607313, "comment_id": 103527225, "body": "Use <code>Gem.loaded_specs.fetch(name).version</code> and <code>rescue KeyError</code> or the safe operator <code>Gem.loaded_specs.fetch(name).&amp;version</code> and check for nil."}, {"owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572357710, "post_id": 58607313, "comment_id": 103528677, "body": "@max Ah, thanks! I tried the safe operator but on that particular logic it gives a runtime error of <code>&#39;version&#39;: stack level too deep (SystemStackError)</code>. However, I did go with the <code>rescue KeyError</code> approach for the simple fact that the exact reason you brought up <i>not</i> to use <code>NoMethodError</code> is exactly what bit me here."}], "answers": [{"tags": [], "owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1572353690, "creation_date": 1572353690, "answer_id": 58607893, "question_id": 58607313, "link": "https://stackoverflow.com/questions/58607313/writing-rspec-test-for-rescued-exception/58607893#58607893", "title": "Writing RSpec Test for Rescued Exception", "body": "<p>Okay, so the answer here was extremely simple (thanks to @katafrakt for pointing it out). I'll put an answer here because I think it's interesting.</p>\n\n<p>The problem is in my test:</p>\n\n<pre><code>it \"indicates if a dependent gem is not found\" do\n  expect {\n    Empiric.get_version(\"capybara\")\n  }.to raise_error NoMethodError\nend\n</code></pre>\n\n<p>Notice I'm calling <code>get_version</code> rather than <code>gem_version</code>. But ... then why didn't the test indicate this? At least by failing, which I would have expected.</p>\n\n<p>The only way I found the issue was by adding in the message that the exception provides. To wit:</p>\n\n<pre><code>...\n.to raise_error NoMethodError, \"No gem loaded for capybara.\"\n</code></pre>\n\n<p>That execution then told me there was no <code>get_version</code> method defined. Specifically I got this:</p>\n\n<pre><code>expected NoMethodError with \"No gem loaded for capybara\",\ngot #&lt;NoMethodError: undefined method `get_version' for Empiric:Module&gt;\n</code></pre>\n\n<p>Obviously fixing the test to call the correct method did the trick. But what's less clear is why the test was originally indicating as passing when I was clearly calling an incorrect method. Not only an incorrect method, but a non-existent one. I have no <code>get_version</code> method in my code at all.</p>\n\n<p>But notice I'm rescuing a \"NoMethodError\" in the first place. So maybe that's the case here? Maybe the fact of <code>get_version</code> itself being a NoMethodError was getting swallowed up by the actions of the test? It was only when I put in a specific message for <em>my</em> exception did that then force RSpec to realize that the <em>actual</em> NoMethodError -- with a different message -- was occurring.</p>\n\n<p>I was tempted to delete the question since I clearly made a bone-headed mistake. But I feel the context of that mistake might be interesting enough for others looking at this. If moderators disagree and feel this should be deleted, no worries. Otherwise, my stupidity can stay enshrined for all to see.</p>\n"}], "owner": {"reputation": 697, "user_id": 1836306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3b6c2d0b2bafdb9ad9cdf782873204d?s=128&d=identicon&r=PG", "display_name": "Jeff Nyman", "link": "https://stackoverflow.com/users/1836306/jeff-nyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 58607893, "answer_count": 1, "score": 0, "last_activity_date": 1572353690, "creation_date": 1572351370, "question_id": 58607313, "link": "https://stackoverflow.com/questions/58607313/writing-rspec-test-for-rescued-exception", "title": "Writing RSpec Test for Rescued Exception", "body": "<p>I have code like this:</p>\n\n<pre><code>module Empiric\n  module_function\n\n  def gem_version(name)\n    Gem.loaded_specs[name].version\n  rescue NoMethodError\n    raise NoMethodError, \"No gem loaded for #{name}\"\n  end\nend\n</code></pre>\n\n<p>This is designed to look for a loaded gem and give the version, if the gem is found. In my project, the Capybara gem, for example, will NOT be there, so this works:</p>\n\n<pre><code>Empiric.gem_version(\"capybara\")\n</code></pre>\n\n<p>When I say it \"works\", I mean it raises the appropriate exception. I'm trying to create an RSpec test for that and I came up with this:</p>\n\n<pre><code>it \"indicates if a dependent gem is not found\" do\n  expect {\n    Empiric.get_version(\"capybara\")\n  }.to raise_error NoMethodError\nend\n</code></pre>\n\n<p>The test passes ... however, test coverage indicates my <code>raise</code> portion is not being covered.</p>\n\n<p>Yet, if I change the above test to instead say <code>.not_to raise_error NoMethodError</code>, the test fails. As it should. Note I changed it to \"not_to\" instead of \"to\". So this shows me the test is, in fact, recognizing that an error was generated.</p>\n\n<p>Does this have to do with the fact that I'm specifically rescuing the error? Because the <code>rescue</code> line shows that it's covered in the test coverage report, but the <code>raise</code> statement is not, even though I've verified that it does in fact occur.</p>\n\n<p>In terms of trying to answer my own question, I did come across this (<a href=\"https://stackoverflow.com/questions/20999426/how-to-write-down-the-rspec-to-test-rescue-block\">How to write down the rspec to test rescue block.?</a>) but that solution didn't seem to work at all for me. I also looked at this (<a href=\"https://stackoverflow.com/questions/32127789/how-do-i-test-the-rescue-block-of-a-method-with-rspec-mocks-3-3\">How do I test the rescue block of a method with rspec mocks 3.3</a>), which also offers little in the way of help for me. Likewise for this (<a href=\"https://stackoverflow.com/questions/6525819/rspec-testing-a-rescue\">Rspec: testing a rescue</a>) and this (<a href=\"https://stackoverflow.com/questions/9829980/using-rspec-how-can-i-test-the-results-of-a-rescue-exception-block\">Using RSpec how can I test the results of a rescue exception block</a>) and this (<a href=\"https://stackoverflow.com/questions/8744494/rspec-test-rescue-block\">Rspec: Test rescue block</a>).</p>\n\n<p>Just to be clear, I'm not operating in a Rails context. This is a standalone gem I'm writing.</p>\n"}, {"tags": ["ruby", "ansible", "vagrant", "vagrantfile"], "answers": [{"comments": [{"owner": {"reputation": 3005, "user_id": 11703358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5pIOl.png?s=128&g=1", "display_name": "ipaleka", "link": "https://stackoverflow.com/users/11703358/ipaleka"}, "edited": false, "score": 0, "creation_date": 1572377882, "post_id": 58612755, "comment_id": 103538482, "body": "Simple as that! :) Thank you!"}], "tags": [], "owner": {"reputation": 17777, "user_id": 9401096, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U3FzEi4xqB8/AAAAAAAAAAI/AAAAAAAADCo/J5YMJMqKA9A/photo.jpg?sz=128", "display_name": "Zeitounator", "link": "https://stackoverflow.com/users/9401096/zeitounator"}, "is_accepted": true, "score": 1, "last_activity_date": 1572370597, "creation_date": 1572370597, "answer_id": 58612755, "question_id": 58607255, "link": "https://stackoverflow.com/questions/58607255/how-to-set-virtualbox-machine-name-to-be-the-same-as-the-hostname-in-multi-machi/58612755#58612755", "title": "How to set VirtualBox machine name to be the same as the hostname in multi-machine Vagrantfile?", "body": "<p>You are running the virtualbox provider on the <code>config</code> global object.</p>\n\n<pre><code>    # Wrong for multivm\n    # This sets a default name for all vms\n    config.vm.provider \"virtualbox\" do |vb|\n      vb.name = \"gnomevm\"\n    end\n</code></pre>\n\n<p>Simply call this on the current vm you are defining (example for <code>gnomevm</code>)</p>\n\n<pre><code>    # Correct\n    # This sets the specific name for this vm only\n    gnomevm.vm.provider \"virtualbox\" do |vb|\n      vb.name = \"gnomevm\"\n    end\n</code></pre>\n"}], "owner": {"reputation": 3005, "user_id": 11703358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5pIOl.png?s=128&g=1", "display_name": "ipaleka", "link": "https://stackoverflow.com/users/11703358/ipaleka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 58612755, "answer_count": 1, "score": 1, "last_activity_date": 1572370597, "creation_date": 1572351134, "question_id": 58607255, "link": "https://stackoverflow.com/questions/58607255/how-to-set-virtualbox-machine-name-to-be-the-same-as-the-hostname-in-multi-machi", "title": "How to set VirtualBox machine name to be the same as the hostname in multi-machine Vagrantfile?", "body": "<p>The following <code>Vagrantfile</code> configuration won't work as the next VM gets the same name as previous one. (BTW, not 100% sure, but I think this used to work in previous Vagrant versions).</p>\n\n<pre><code>Vagrant.configure(2) do |config|\n\n  config.vm.define \"xfcevm\" do |xfcevm|\n    xfcevm.vm.box = \"generic/ubuntu1904\"\n    xfcevm.vm.hostname = \"xfcevm\"\n    config.vm.provider \"virtualbox\" do |vb|\n      vb.name = \"xfcevm\"\n    end\n  end\n\n  config.vm.define \"gnomevm\" do |gnomevm|\n    gnomevm.vm.box = \"generic/fedora30\"\n    gnomevm.vm.hostname = \"gnomevm\"\n    config.vm.provider \"virtualbox\" do |vb|\n      vb.name = \"gnomevm\"\n    end\n  end\n\n  config.vm.provider \"virtualbox\" do |vb|\n    # vb.name = config.vm.hostname\n    vb.gui = true\n    vb.memory = \"3072\"\n    vb.cpus = 1\n    vb.customize [\"modifyvm\", :id, \"--vram\", \"32\"]\n  end\n\n  config.vm.provision \"ansible\" do |ansible|\n    ansible.verbose = \"v\"\n    ansible.compatibility_mode = \"2.0\"\n    ansible.playbook = \"setup.yml\"\n  end\n\n  config.vm.provision \"ansible\", run: 'always' do |ansible|\n    ansible.verbose = \"v\"\n    ansible.compatibility_mode = \"2.0\"\n    ansible.playbook = \"tests.yml\"\n  end\n\nend\n</code></pre>\n\n<p>In the line <code># vb.name = config.vm.hostname</code>, the assignment returns an object (it is printed with <code>puts</code> as <code>#&lt;Object:0x0000000001c191d8&gt;</code>) and I'm not familiar with Ruby and Vagrant enough to get a string attribute from it if that's even possible from that object.</p>\n\n<p>P.S. a workaround (an alternative question to this one) would be to get the running VirtualBox machine name from Ansible playbook, as the goal has been calling <code>VBoxManage</code> on that virtual machine as <code>local_action</code> from inside the Ansible playbook.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "puts"], "comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 2, "creation_date": 1572348669, "post_id": 58606503, "comment_id": 103524040, "body": "try this: <code>e[:fields].first[:description]</code>"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1572351934, "post_id": 58606503, "comment_id": 103525624, "body": "You show <code>e</code> as if it is a hash, is that the case? Or are <code>code</code>, <code>message</code> and <code>fields</code> methods of <code>e</code>? (because that seems more appropriate for an error-object --but it could well be the case."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 8123767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a03359998070fd987e13beb3a55c974?s=128&d=identicon&r=PG&f=1", "display_name": "SBN", "link": "https://stackoverflow.com/users/8123767/sbn"}, "is_accepted": false, "score": 1, "last_activity_date": 1572349206, "creation_date": 1572349206, "answer_id": 58606744, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby/58606744#58606744", "title": "How to print an object element inside an array in ruby", "body": "<pre><code>e[\"fields\"].each do |field|\n puts field[\"description\"]\nend \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 7688667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90329bbda5172a61debceee8b0268649?s=128&d=identicon&r=PG&f=1", "display_name": "Bhagawat", "link": "https://stackoverflow.com/users/7688667/bhagawat"}, "is_accepted": false, "score": 3, "last_activity_date": 1572351507, "creation_date": 1572351507, "answer_id": 58607347, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby/58607347#58607347", "title": "How to print an object element inside an array in ruby", "body": "<p>How about</p>\n\n<p><code>h = {:code=&gt;\"123\", :message=&gt;\"Invalid data.\", :fields=&gt;[{:name=&gt;\"test\", :description=&gt;\"testing\"}]}</code></p>\n\n<p>then </p>\n\n<p><code>h.dig(:fields, 0, :description)</code></p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 12266926, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9qu4sjuSKRiqDY8vjBRebckFmPhR8GxHT0AYxmQ=k-s128", "display_name": "Ameena Shad", "link": "https://stackoverflow.com/users/12266926/ameena-shad"}, "is_accepted": false, "score": 0, "last_activity_date": 1572352071, "creation_date": 1572352071, "answer_id": 58607496, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby/58607496#58607496", "title": "How to print an object element inside an array in ruby", "body": "<p>You can do this - e[:fields][0][:description]</p>\n"}, {"tags": [], "owner": {"reputation": 386, "user_id": 5119169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LV52D.jpg?s=128&g=1", "display_name": "pradeepchauhan_pc", "link": "https://stackoverflow.com/users/5119169/pradeepchauhan-pc"}, "is_accepted": false, "score": 0, "last_activity_date": 1572353643, "creation_date": 1572353643, "answer_id": 58607876, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby/58607876#58607876", "title": "How to print an object element inside an array in ruby", "body": "<p>In your response fields, the key is containing an array object.</p>\n\n<p>If you want to print the specific value then you need to use an index like this <code>e[\"fileds\"][0]</code> then this will print \"testing\".</p>\n\n<p>If you want to print all the description then you should do like this:</p>\n\n<pre><code>e[\"fileds\"].each do |field|\n   puts field[\"description\"]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 0, "last_activity_date": 1572354817, "creation_date": 1572354817, "answer_id": 58608167, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby/58608167#58608167", "title": "How to print an object element inside an array in ruby", "body": "<p>If <code>e</code> is a <code>Hash</code>, as one could deduce from the way you show the contents of <code>e</code>,\nyou could write </p>\n\n<pre><code>e[\"fields\"][0][\"description\"]\n</code></pre>\n\n<p>As usual in Rails there are many ways to achieve the same, and sometimes <em>not</em>. </p>\n\n<p>You could also write <code>e[:fields][0][:description]</code> but only if the <code>Hash</code> <em>has indifferent access</em>, which means you can use strings and symbols interchangeably (that is by default, if you create a hash yourself, <em>not</em> the case). </p>\n\n<p>So to explain the line in more detail: <code>e[\"fields\"]</code> returns an array (of hashes), take the first element: <code>e[\"fields\"][0]</code> or <code>e[\"fields\"].first</code> and then get the value for the key <code>description</code> in the hash. </p>\n\n<p>However, if you created a class that inherited from <code>StandardError</code> which is what is usually thrown on error, you would most likely have to write something like: </p>\n\n<pre><code> e.fields \n</code></pre>\n\n<p>which returns the array of fields. To find the first element, we write, again <code>e.fields[0]</code> or <code>e.fields.first</code>, and then it depends if the array contains hashes, or objects with a method <code>description</code>, so it could either be </p>\n\n<pre><code>e.fields[0].description \n</code></pre>\n\n<p>or </p>\n\n<pre><code>e.fields[0][:description] \n</code></pre>\n\n<p>(I prefer to write the symbol key, but please remember if your Hash has strings as keys and is not a <code>HashWithIndifferentAccess</code> you will have to use the string <code>\"description\"</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 7811, "user_id": 379779, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c3bd8d869b7e1caa45485b0b3e126a4?s=128&d=identicon&r=PG", "display_name": "zawhtut", "link": "https://stackoverflow.com/users/379779/zawhtut"}, "is_accepted": false, "score": 0, "last_activity_date": 1572363191, "creation_date": 1572363191, "answer_id": 58610654, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby/58610654#58610654", "title": "How to print an object element inside an array in ruby", "body": "<p>If you want the comma separated descriptions</p>\n\n<pre><code>descriptions = e[\"fields\"].map{|f| f[\"description\"]}.join(',')\nputs descriptions\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 10327790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESMb7.png?s=128&g=1", "display_name": "AFAF", "link": "https://stackoverflow.com/users/10327790/afaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "answer_count": 6, "score": 1, "last_activity_date": 1572363191, "creation_date": 1572348244, "last_edit_date": 1572348434, "question_id": 58606503, "link": "https://stackoverflow.com/questions/58606503/how-to-print-an-object-element-inside-an-array-in-ruby", "title": "How to print an object element inside an array in ruby", "body": "<p>I have to print in shell the description of my error, and I can't access to the element inside an object inside an array and I'm still learning Ruby.</p>\n\n<p>I've tried </p>\n\n<pre><code>rescue =&gt; e\n  puts e.fields[description]\n...\n</code></pre>\n\n<p>and doesn't work.</p>\n\n<pre><code>{\n  \"code\": \"123\",\n  \"message\": \"Invalid data.\",\n  \"fields\": [\n    {\n      \"name\": \"test\",\n      \"description\": \"testing\"\n    }\n  ]\n}\n</code></pre>\n\n<p>---> I want to print only <code>testing</code></p>\n\n<p>Thank you </p>\n\n<p>so much for your help :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration", "database-migration", "rails-migrations"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572346266, "post_id": 58605252, "comment_id": 103522859, "body": "Please edit the question and include the error message in the text body. This prevents link rot and you shouldn&#39;t expect ppl to have to go somewhere else to get the gist of your question."}, {"owner": {"reputation": 69, "user_id": 10927701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eef80517111079e3b8b8ecf3a347972?s=128&d=identicon&r=PG&f=1", "display_name": "Marshmello", "link": "https://stackoverflow.com/users/10927701/marshmello"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572346764, "post_id": 58605252, "comment_id": 103523094, "body": "Yeah, i know. Thank you. I just can&#39;t insert full error here because of an error too much code&quot;, so posted cutted version of it."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572348882, "post_id": 58605252, "comment_id": 103524142, "body": "It looks like a bug in the database adapter, have you tried updating? Also Ruby 1.87 was EOL:Ed in 2014 and so you definitely need to upgrade."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 10927701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eef80517111079e3b8b8ecf3a347972?s=128&d=identicon&r=PG&f=1", "display_name": "Marshmello", "link": "https://stackoverflow.com/users/10927701/marshmello"}, "is_accepted": false, "score": 0, "last_activity_date": 1572352075, "creation_date": 1572352075, "answer_id": 58607497, "question_id": 58605252, "link": "https://stackoverflow.com/questions/58605252/uninitialized-class-variable-columns-cache-error-during-migration/58607497#58607497", "title": "\u201cuninitialized class variable @@columns_cache\u201d error during migration", "body": "<p>That was an issue with database.</p>\n\n<p>It was used for sessions instead of the cookie-based default because highly confidential information.</p>\n\n<p>So <code>rake db:sessions:create</code> fixed it.</p>\n"}], "owner": {"reputation": 69, "user_id": 10927701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eef80517111079e3b8b8ecf3a347972?s=128&d=identicon&r=PG&f=1", "display_name": "Marshmello", "link": "https://stackoverflow.com/users/10927701/marshmello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572352075, "creation_date": 1572343731, "last_edit_date": 1572346676, "question_id": 58605252, "link": "https://stackoverflow.com/questions/58605252/uninitialized-class-variable-columns-cache-error-during-migration", "title": "\u201cuninitialized class variable @@columns_cache\u201d error during migration", "body": "<p>So i'm having migration to remove unnecessary columns</p>\n\n<pre><code>[:table_name_1, :table_name_2, :table_name_3, :table_name_4].each do |tables|\n  remove_column tables, :column_name_here\nend\n</code></pre>\n\n<p>When i'm using </p>\n\n<pre><code>rake db:migrate --trace\n</code></pre>\n\n<p>I'm getting something like this</p>\n\n<pre><code> ==  RemoveColumntsFromDB: migrating ========================================\n    -- remove_column(:table_name_1, :column_name_here)\n    rake aborted!\n    An error has occurred, all later migrations canceled:\n\n    uninitialized class variable @@columns_cache in ActiveRecord::ConnectionAdapters::OracleEnhancedAdapter\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-oracle_enhanced-adapter-1.2.4/lib/active_record/connection_adapters/oracle_enhanced_adapter.rb:936:in `clear_table_columns_cache'\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-oracle_enhanced-adapter-1.2.4/lib/active_record/connection_adapters/oracle_enhanced_adapter.rb:1143:in `remove_column'\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-2.3.2/lib/active_record/migration.rb:352:in `send'\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-2.3.2/lib/active_record/migration.rb:352:in `method_missing'\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-2.3.2/lib/active_record/migration.rb:328:in `say_with_time'\n    C:/Ruby/Ruby187/lib/ruby/1.8/benchmark.rb:293:in `measure'\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-2.3.2/lib/active_record/migration.rb:328:in `say_with_time'\n    C:/Ruby/Ruby187/lib/ruby/gems/1.8/gems/activerecord-2.3.2/lib/active_record/migration.rb:348:in `method_missing'\n</code></pre>\n\n<p>Does any have idea why?</p>\n"}, {"tags": ["ruby", "http2", "faraday", "typhoeus"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 3, "last_activity_date": 1572377234, "creation_date": 1572377234, "answer_id": 58614167, "question_id": 58605231, "link": "https://stackoverflow.com/questions/58605231/enforcing-faraday-adapter-typhoeus-to-use-http-2-for-requests/58614167#58614167", "title": "enforcing Faraday adapter :typhoeus to use HTTP/2 for requests", "body": "<p>There are two things at play here. The first is that the remote API is lying to you in the response body. Their documentation says:</p>\n\n<blockquote>\n  <p>http2: Possible values are 0 (HTTP/2 was used) and 1 (HTTP/2 was not used).</p>\n</blockquote>\n\n<p>Even though the response body shows <code>'http2': 1</code> indicating that HTTP2 was not used, it <strong>is</strong> being used. You can most easily confirm this using Chrome's dev tools:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R3lOy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R3lOy.png\" alt=\"HTTP2 was used\"></a></p>\n\n<p>So once we know that the API is lying in the response body, how can we independently confirm that Typhoeus is using HTTP2?</p>\n\n<p>(this answer assumes you are using <code>pry</code> as your REPL, not IRB)</p>\n\n<p>First let's confirm that Typhoeus alone will use HTTP2:</p>\n\n<pre><code>require 'typhoeus'\nresponse = Typhoeus.get(\"https://http2.pro/api/v1\", http_version: :httpv2_0)\nresponse.class\n=&gt; Typhoeus::Response &lt; Object\nresponse.body\n=&gt; \"{\\\"http2\\\":1,\\\"protocol\\\":\\\"HTTP\\\\/2.0\\\",\\\"push\\\":0,\\\"user_agent\\\":\\\"Typhoeus - https:\\\\/\\\\/github.com\\\\/typhoeus\\\\/typhoeus\\\"}\" # this is the lying API response\nresponse.http_version\n=&gt; \"2\" # this is what Typhoeus tells us was actually used\n</code></pre>\n\n<p>Now let's test it in Faraday:</p>\n\n<pre><code>require 'faraday'\nrequire 'typhoeus'\nrequire 'typhoeus/adapters/faraday'\n\nconn = Faraday.new do |faraday|\n  faraday.adapter :typhoeus, http_version: :httpv2_0\nend\n\nresponse = conn.get(\"https://http2.pro/api/v1\")\nresponse.body\n=&gt; \"{\\\"http2\\\":1,\\\"protocol\\\":\\\"HTTP\\\\/2.0\\\",\\\"push\\\":0,\\\"user_agent\\\":\\\"Faraday v0.17.0\\\"}\" # again we get the lying API response\n</code></pre>\n\n<p>But how can we confirm it was HTTP2? This doesn't work:</p>\n\n<pre><code>response.http_version\nNoMethodError: undefined method `http_version' for #&lt;Faraday::Response:0x00007f99935519a8&gt;\n</code></pre>\n\n<p>Because <code>response</code> isn't a <code>Typhoeus::Response</code> object, it's a Faraday object:</p>\n\n<pre><code>response.class\n=&gt; Faraday::Response &lt; Object\n</code></pre>\n\n<p>So we need to get into the gem itself to figure out where it's creating the <code>Typhoeus::Response</code> object so we can call <code>.http_version</code> on it manually and confirm it's using the protocol we expect. As it turns out, that's <a href=\"https://github.com/typhoeus/typhoeus/blob/cbab8c9f39167e1ae78ed65e5baeb1dbb53cfbdc/lib/typhoeus/adapters/faraday.rb#L127\" rel=\"nofollow noreferrer\">right here</a>.</p>\n\n<p>Let's take the easy route and stick <code>binding.pry</code> into our local copy of the gem (you'll need to restart pry to pick up the changes to the gem):</p>\n\n<pre><code>  def typhoeus_request(env)\n    opts = {\n      :method =&gt; env[:method],\n      :body =&gt; env[:body],\n      :headers =&gt; env[:request_headers]\n    }.merge(@adapter_options)\n    binding.pry\n    ::Typhoeus::Request.new(env[:url].to_s, opts)\n  end\n</code></pre>\n\n<p>Then re-run the request:</p>\n\n<pre><code>require 'faraday'\nrequire 'typhoeus'\nrequire 'typhoeus/adapters/faraday'\n\nconn = Faraday.new do |faraday|\n  faraday.adapter :typhoeus, http_version: :httpv2_0\nend\n\nresponse = conn.get(\"https://http2.pro/api/v1\")\n</code></pre>\n\n<p>And you'll see:</p>\n\n<pre><code>Frame number: 0/3\n\nFrom: /Users/foo/.rvm/gems/ruby-2.6.3/gems/typhoeus-1.3.1/lib/typhoeus/adapters/faraday.rb @ line 127 Faraday::Adapter::Typhoeus#typhoeus_request:\n\n    120: def typhoeus_request(env)\n    121:   opts = {\n    122:     :method =&gt; env[:method],\n    123:     :body =&gt; env[:body],\n    124:     :headers =&gt; env[:request_headers]\n    125:   }.merge(@adapter_options)\n    126:   binding.pry\n =&gt; 127:   ::Typhoeus::Request.new(env[:url].to_s, opts)\n    128: end\n</code></pre>\n\n<p>Now enter:</p>\n\n<pre><code>response = ::Typhoeus::Request.new(env[:url].to_s, opts).run\n</code></pre>\n\n<p>And confirm it's a <code>Typhoeus::Response</code> object:</p>\n\n<pre><code>response.class\n=&gt; Typhoeus::Response &lt; Object\n</code></pre>\n\n<p>And confirm it's using HTTP2:</p>\n\n<pre><code>response.http_version\n=&gt; \"2\"\n</code></pre>\n\n<p>And confirm the API response body is a dirty liar:</p>\n\n<pre><code>response.body\n=&gt; \"{\\\"http2\\\":1,\\\"protocol\\\":\\\"HTTP\\\\/2.0\\\",\\\"push\\\":0,\\\"user_agent\\\":\\\"Faraday v0.17.0\\\"}\"\n</code></pre>\n\n<p>And that's how you use Typhoeus as a Faraday adapter to make an HTTP2 request.</p>\n"}], "owner": {"reputation": 443, "user_id": 4288922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxPcM.jpg?s=128&g=1", "display_name": "Aleks Boev", "link": "https://stackoverflow.com/users/4288922/aleks-boev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 1, "accepted_answer_id": 58614167, "answer_count": 1, "score": 1, "last_activity_date": 1572377234, "creation_date": 1572343647, "question_id": 58605231, "link": "https://stackoverflow.com/questions/58605231/enforcing-faraday-adapter-typhoeus-to-use-http-2-for-requests", "title": "enforcing Faraday adapter :typhoeus to use HTTP/2 for requests", "body": "<p>How to enforce <code>Faraday</code> adapter <a href=\"https://github.com/typhoeus/typhoeus/blob/master/lib/typhoeus/adapters/faraday.rb\" rel=\"nofollow noreferrer\">typhoeus</a> to use HTTP/2 for requests to servers which supported HTTP/2?\nI have tested this over service <a href=\"https://http2.pro/doc/api\" rel=\"nofollow noreferrer\">https://http2.pro/doc/api</a> and result was like this:</p>\n\n<pre><code>body=\"{\\\"http2\\\":1,\\\"protocol\\\":\\\"HTTP\\\\/2.0\\\",\\\"push\\\":0,\\\"user_agent\\\":\\\"Faraday v0.12.2\\\"}\",\n</code></pre>\n\n<p><code>\\\"http2\\\":1,</code> what means that HTTP/2 not used for request!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1572344087, "post_id": 58604858, "comment_id": 103521774, "body": "<i>&quot;Found this code snippet in a blog&quot;</i> \u2013 in the blog post, was the bug introduced deliberately as a way to circumvent the secret key check? :-)"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1572344555, "post_id": 58604858, "comment_id": 103522025, "body": "<a href=\"https://tech.showmax.com/2019/10/how-ruby-can-surprise-you/\" rel=\"nofollow noreferrer\">Here&#39;s</a> the blog post"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1572344741, "post_id": 58604858, "comment_id": 103522127, "body": "@Viktor thanks for the link. Seems like the OP missed the explanation below the code."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1572345195, "post_id": 58604858, "comment_id": 103522358, "body": "&quot;was the bug introduced deliberately as a way to circumvent the secret key check?&quot; Interesting idea though"}, {"owner": {"reputation": 8377, "user_id": 210273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ9D9.jpg?s=128&g=1", "display_name": "Syed Aslam", "link": "https://stackoverflow.com/users/210273/syed-aslam"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1572345959, "post_id": 58604858, "comment_id": 103522706, "body": "@Stefan yes, I got intrigued and tried before reading the part where this was explained. Actually, good that I didn&#39;t read that in full. Got to learn a few things here in the answer and the links that you posted. Also, realizing that &quot;The warnings come after the spells&quot; :)"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1572359361, "post_id": 58604858, "comment_id": 103529545, "body": "FWIW the four lines in the method can be replaced by <code>secret_key == 1234 &amp;&amp; ALLOWED_TARGETS.include?(target)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572372637, "post_id": 58604858, "comment_id": 103536474, "body": "Considering the potential consequences, I&#39;d suggest a key with at least five digits."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1572343049, "post_id": 58604970, "comment_id": 103521174, "body": "Ah, I hate these problems :)"}, {"owner": {"reputation": 8377, "user_id": 210273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ9D9.jpg?s=128&g=1", "display_name": "Syed Aslam", "link": "https://stackoverflow.com/users/210273/syed-aslam"}, "edited": false, "score": 0, "creation_date": 1572343369, "post_id": 58604970, "comment_id": 103521355, "body": "Ah, that makes sense. Thanks. Pity the people who get asked these kinda questions in interviews :)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1572343596, "post_id": 58604970, "comment_id": 103521484, "body": "On one hand, I want to strangle people who pose trick questions in interviews. On the other hand, I remember helping a fellow student (years ago, in FORTRAN) find the cause of a segfault they couldn&#39;t find for an hour; it was something like <code>X = A[O]</code> (where <code>A[0]</code> was intended). Glyph equivalence is more of a potential problem today than in ASCII (though I&#39;d say not in actual practice), you can still see it in the wild, and should know to debug it."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1572343836, "post_id": 58604970, "comment_id": 103521643, "body": "The proper term seems to be <a href=\"https://en.wikipedia.org/wiki/Homoglyph\" rel=\"nofollow noreferrer\">homoglyph</a>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1572343871, "post_id": 58604970, "comment_id": 103521665, "body": "@Stefan Never heard the term, but makes a ton of sense (by analogy)."}, {"owner": {"reputation": 8377, "user_id": 210273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ9D9.jpg?s=128&g=1", "display_name": "Syed Aslam", "link": "https://stackoverflow.com/users/210273/syed-aslam"}, "edited": false, "score": 0, "creation_date": 1572345629, "post_id": 58604970, "comment_id": 103522550, "body": "@Amadan agree that would be a great story to share among developer friends after figuring out in code. But, I find it not amusing when posed in an interview. What exactly are you testing with such questions in a programming language interview?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 8377, "user_id": 210273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ9D9.jpg?s=128&g=1", "display_name": "Syed Aslam", "link": "https://stackoverflow.com/users/210273/syed-aslam"}, "edited": false, "score": 2, "creation_date": 1572351908, "post_id": 58604970, "comment_id": 103525622, "body": "@SyedAslam <i>&quot;What exactly are you testing with such questions in a programming language interview?&quot;</i> \u2013 how you approach debugging a strange problem maybe? Or to see if you can think &quot;outside the box&quot;."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 8, "last_activity_date": 1572342745, "creation_date": 1572342745, "answer_id": 58604970, "question_id": 58604858, "link": "https://stackoverflow.com/questions/58604858/why-does-this-code-snippet-output-true-when-it-should-return-false/58604970#58604970", "title": "Why does this code snippet output &quot;true&quot; when it should return &quot;false&quot;?", "body": "<p><code>allowed</code> is not <code>\u0430llowed</code>; you have two different variables. Specifically, the first letter is different: the first variable has 'LATIN SMALL LETTER A' (U+0061), the second has 'CYRILLIC SMALL LETTER A' (U+0430). The glyphs are either similar or identical in most (all?) fonts. Your code is thus equivalent to:</p>\n\n<pre><code>ALLOWED_TARGETS = [\"dresden\", \"paris\", \"vienna\"]\n\ndef missile_launch_allowed(target, secret_key)\n  first = true\n  second = false if secret_key != 1234\n  first = false unless ALLOWED_TARGETS.include?(target)\n  first\nend\n\nputs(missile_launch_allowed(\"dresden\", 9999))\n</code></pre>\n\n<p>With variables renamed somewhat more sensibly, it should be obvious why you are getting the result you are.</p>\n"}], "owner": {"reputation": 8377, "user_id": 210273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ9D9.jpg?s=128&g=1", "display_name": "Syed Aslam", "link": "https://stackoverflow.com/users/210273/syed-aslam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58604970, "answer_count": 1, "score": 4, "last_activity_date": 1572342745, "creation_date": 1572342335, "question_id": 58604858, "link": "https://stackoverflow.com/questions/58604858/why-does-this-code-snippet-output-true-when-it-should-return-false", "title": "Why does this code snippet output &quot;true&quot; when it should return &quot;false&quot;?", "body": "<pre><code>ALLOWED_TARGETS = [\"dresden\", \"paris\", \"vienna\"]\n\ndef missile_launch_allowed(target, secret_key)\n  allowed = true\n  \u0430llowed = false if secret_key != 1234\n  allowed = false unless ALLOWED_TARGETS.include?(target)\n  allowed\nend\n\nputs(missile_launch_allowed(\"dresden\", 9999))\n</code></pre>\n\n<p>Found this code snippet in a blog. Tracking the code by hand gives me <code>false</code>, but why does this output true when run?</p>\n\n<p>The part I am not seeing is just not crossing my mind at the moment. Please help me understand Ruby a bit better.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "optimization"], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": true, "score": 1, "last_activity_date": 1572365141, "last_edit_date": 1572365141, "creation_date": 1572330983, "answer_id": 58602433, "question_id": 58601919, "link": "https://stackoverflow.com/questions/58601919/how-to-achieve-optimized-mysql-query-in-ruby-on-rails/58602433#58602433", "title": "How to achieve optimized mysql query in ruby on rails?", "body": "<p>You can use INNER JOIN instead of Rails includes and don't instanciate Resource objects at all.</p>\n\n<pre><code>data = Comment.where(id: [5, 6, 7])\n              .joins(:resource)\n              .select(\n                'comments.id AS comment_id',\n                'resources.id AS r_id',\n                'resources.url AS r_url',\n                'resources.description AS r_desc'\n              )\nhash = Hash[data.map { |e| [e.comment_id, { id: e.r_id, url: e.r_url, desc: e.r_desc }] }]\n</code></pre>\n\n<p>It should give you result like that:</p>\n\n<pre><code>{\n  5 =&gt; { id: 3, url: \"http://url.com\", desc: \"og:description\" },\n  6 =&gt; { id: 4, url: \"http://url.com\", description: \"og:description\" }\n}\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58602433, "answer_count": 1, "score": 0, "last_activity_date": 1576736133, "creation_date": 1572327475, "last_edit_date": 1576736133, "question_id": 58601919, "link": "https://stackoverflow.com/questions/58601919/how-to-achieve-optimized-mysql-query-in-ruby-on-rails", "title": "How to achieve optimized mysql query in ruby on rails?", "body": "<p>Model Structure :\n<code>Comment</code> Model has <code>belongs_to</code> relation \nand <code>Resource</code> Model doesn't have any relation.</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n belongs_to :resource\n\nend\n</code></pre>\n\n<pre><code>Class Resource &lt; ApplicationRecord\n\n#No relation\n\nend\n</code></pre>\n\n<p>This is my query :\n(Hope this is not n+1 as I have used includes)</p>\n\n<pre><code>comments = Comment.where(id: [5,6,7]).includes(:resource)\nHash[comments.map { |comment|\n                          [comment.id, comment.resource] if comment.resource \n                      }]\n</code></pre>\n\n<p>Output that I got is this:\nIn which 5 and 6 are <code>comment_id</code> and other is the <code>resource _attributes</code> </p>\n\n<pre><code> 5=&gt;\n  #&lt;Resource:0x00007fa9b2a93518\n   id: 3,\n   url: \"http://url.com\",\n   description: \"og:description\",\n   title: \"title\",\n   site_name: \"og:site_name\",\n   image_url: \"http://imageurl.com\",\n   video_url: nil,\n   created_at: Mon, 28 Oct 2019 07:44:16 UTC +00:00,\n   updated_at: Mon, 28 Oct 2019 07:44:16 UTC +00:00,\n   embed_html: nil,\n   url_hash: \"df5ac6d4a1313ecb9949312d0258416a248333f68ae39aa1c7acd818e7d997e7\",\n   user_id: nil&gt;,\n 6=&gt;\n  #&lt;Resource:0x00007fa9b2a92fa0\n   id: 4,\n   url: \"http://url.com\",\n   description: \"og:description\",\n   title: \"title\",\n   site_name: \"og:site_name\",\n   image_url: \"http://imageurl.com\",\n   video_url: nil,\n   created_at: Mon, 28 Oct 2019 07:44:16 UTC +00:00,\n   updated_at: Mon, 28 Oct 2019 07:44:16 UTC +00:00,\n   embed_html: nil,\n   url_hash: \"df5ac6d4a1313ecb9949312d0258416a248333f68ae39aa1c7acd818e7d997e7\",\n   user_id: nil&gt;}\n</code></pre>\n\n<p>But I need more optimized query and output should be like: </p>\n\n<pre><code>5=&gt;\n  #&lt;Resource:0x00007fa9b2a93518\n   id: 3,\n   url: \"http://url.com\",\n   description: \"og:description\",\n,\n 6=&gt;\n  #&lt;Resource:0x00007fa9b2a92fa0\n   id: 4,\n   url: \"http://url.com\",\n   description: \"og:description\"\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activestorage"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 7603076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb0e2710c2869edd87c75f180cac5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Mephistt", "link": "https://stackoverflow.com/users/7603076/mephistt"}, "is_accepted": false, "score": 0, "last_activity_date": 1596546247, "last_edit_date": 1596546247, "creation_date": 1573740924, "answer_id": 58858845, "question_id": 58600785, "link": "https://stackoverflow.com/questions/58600785/i-got-nomethoderror-undefined-method-rails-blob-path-when-using-active-storag/58858845#58858845", "title": "I got NoMethodError: undefined method `rails_blob_path` when using active storage", "body": "<p>The <code>include</code> statement and the full path to <code>rails_blob_path</code> method seem to be OK.</p>\n<p>It looks like there is a naming issue.\nYou have created <code>attribute</code> and <code>method</code> with the same name.\nTry to change one of them.</p>\n"}, {"tags": [], "owner": {"reputation": 763, "user_id": 2679301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83c0e9fed62d90353b411bc48b0e0f?s=128&d=identicon&r=PG", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/2679301/guillaume"}, "is_accepted": false, "score": 0, "last_activity_date": 1586304783, "creation_date": 1586304783, "answer_id": 61091417, "question_id": 58600785, "link": "https://stackoverflow.com/questions/58600785/i-got-nomethoderror-undefined-method-rails-blob-path-when-using-active-storag/61091417#61091417", "title": "I got NoMethodError: undefined method `rails_blob_path` when using active storage", "body": "<p>You should do like this :</p>\n\n<pre><code>Rails.application.routes.url_helpers.rails_representation_url(object.original_file(resize: \"300x300\").processed, only_path: true)\n</code></pre>\n\n<p>Source : <a href=\"https://stackoverflow.com/a/53547638/2679301\">https://stackoverflow.com/a/53547638/2679301</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11767841, "user_type": "registered", "profile_image": "https://graph.facebook.com/861124970922292/picture?type=large", "display_name": "Ryo Masuda", "link": "https://stackoverflow.com/users/11767841/ryo-masuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1541, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1596546247, "creation_date": 1572316739, "question_id": 58600785, "link": "https://stackoverflow.com/questions/58600785/i-got-nomethoderror-undefined-method-rails-blob-path-when-using-active-storag", "title": "I got NoMethodError: undefined method `rails_blob_path` when using active storage", "body": "<p>I got a following error when using active storage in rails 6.</p>\n\n<pre><code>NoMethodError: undefined method `rails_blob_path' for #&lt;Module:0x00007fb91cb006a8&gt;\n</code></pre>\n\n<h2>My env</h2>\n\n<ul>\n<li>rails 6.0.0(api mode)</li>\n<li>ruby '2.6.3'</li>\n</ul>\n\n<p>I already installed active storage and execute migrate</p>\n\n<h2>config/environments/development.rb</h2>\n\n<pre class=\"lang-rb prettyprint-override\"><code>config.active_storage.service = :local\n</code></pre>\n\n<h2>Model</h2>\n\n<pre><code>class Contract &lt; ApplicationRecord\n  ...\n  has_one_attached :original_file\nend\n\n</code></pre>\n\n<h2>Serializer</h2>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ContractSerializer &lt; ActiveModel::Serializer\n  include Rails.application.routes.url_helpers\n\n  attributes :id, :original_file\n\n  def original_file\n    Rails.application.routes.default_url_options[:host] = 'localhost:3000'\n    Rails.application.routes.url_helpers.rails_blob_path(object.original_file, only_path: true) if object.original_file.attached?\n  end\nend\n</code></pre>\n\n<p>If you have any tips, Please let me know if you know anything about this.  Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "dictionary", "methods"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572314572, "post_id": 58600413, "comment_id": 103513356, "body": "If you have to call a chain of methods you need to pass a block. Passing a symbol is just a shortcut. Alternatively you can call map twice."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11095681, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aHwFGrXaiq8/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO60tdEXpajqmx4jRd85TrcTV56BA/mo/photo.jpg?sz=128", "display_name": "Javier Andr&#233;s Burgos Rold&#225;n", "link": "https://stackoverflow.com/users/11095681/javier-andr%c3%a9s-burgos-rold%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1572359309, "post_id": 58601552, "comment_id": 103529517, "body": "thanks @TedTran2019, it will be the best solution, thanks"}], "tags": [], "owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "is_accepted": false, "score": 0, "last_activity_date": 1572324524, "creation_date": 1572324524, "answer_id": 58601552, "question_id": 58600413, "link": "https://stackoverflow.com/questions/58600413/pass-a-method-inside-a-symbol-in-map-function/58601552#58601552", "title": "Pass a method inside a symbol in Map function", "body": "<p>Instead of doing </p>\n\n<pre><code>Profile.find(1432).bookings.map(&amp;:venue.kept).uniq\n</code></pre>\n\n<p>Try </p>\n\n<pre><code>Profile.find(1432).bookings.map { |booking| booking.venue.kept }.uniq\n</code></pre>\n\n<p>Testing in Pry with</p>\n\n<pre><code>[\"hi\", \"bye\"].map(&amp;:upcase) -&gt; [\"HI\", \"BYE\"]\n[\"hi\", \"bye\"].map(&amp;:upcase.downcase) -&gt; [\"HI\", \"BYE\"]\n</code></pre>\n\n<p>Remember that </p>\n\n<pre><code>(&amp;:method) is just a shortcut for { |el| el.method }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11095681, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aHwFGrXaiq8/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO60tdEXpajqmx4jRd85TrcTV56BA/mo/photo.jpg?sz=128", "display_name": "Javier Andr&#233;s Burgos Rold&#225;n", "link": "https://stackoverflow.com/users/11095681/javier-andr%c3%a9s-burgos-rold%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572324524, "creation_date": 1572312897, "last_edit_date": 1572321141, "question_id": 58600413, "link": "https://stackoverflow.com/questions/58600413/pass-a-method-inside-a-symbol-in-map-function", "title": "Pass a method inside a symbol in Map function", "body": "<p>someone could explain me, How can I pass a method inside a symbol that give me Map.\nThis is my method </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def visited_venues\n  Profile.find(1432).bookings.map(&amp;:venue).uniq\nend\n</code></pre>\n\n<p>now I want to do something like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def visited_venues\n Profile.find(1432).bookings.map(&amp;:venue.kept).uniq\nend\n</code></pre>\n\n<p>that returns me all undiscarded in my DB, when Im trying to do it, always return me <code>undefined</code> because Venue is a symbol.\nThanks for any help and explanation.</p>\n"}, {"tags": ["ruby", "logic", "rubygame"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572312100, "post_id": 58600165, "comment_id": 103512885, "body": "Suppose player 1 throws <code>p1</code> and player 2 throws <code>p2</code>. We wish to determine if either player wins or if <code>p1 == p2</code>. Let <code>winners = { &quot;paper&quot;=&gt;&quot;rock&quot;, &quot;rock&quot;=&gt;&quot;scissors&quot;, &quot;scissors&quot;=&gt;&quot;paper&quot; }</code>. Then player 1 wins if <code>winners[p1] == p2</code>, player 2 wins if <code>winners[p2] == p1</code>, else <code>p1 == p2</code> and they throw again. You may wish to make use of this result in your code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572319234, "post_id": 58600165, "comment_id": 103514191, "body": "Thanks Cary for your code. I will work on it. :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "edited": false, "score": 0, "creation_date": 1572319455, "post_id": 58600270, "comment_id": 103514235, "body": "Thanks for your explanation. I did not mean to be opinionated at all. I will check getch and will work on my solution. Thanks!"}], "tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": false, "score": 1, "last_activity_date": 1572312592, "last_edit_date": 1572312592, "creation_date": 1572311401, "answer_id": 58600270, "question_id": 58600165, "link": "https://stackoverflow.com/questions/58600165/ruby-player-vs-player-for-rock-paper-scissor-game/58600270#58600270", "title": "Ruby - Player vs Player for Rock, Paper &amp; Scissor Game", "body": "<p>You've asked a very opinionated, open-ended question. This is not the best sort of question for Stack Overflow. But, I'll give it a shot.</p>\n\n<p>Firstly, I'd extract your scoring code into a function. Something like this:</p>\n\n<pre><code>def battle(p1, p2)\n  if p1 == p2\n    'Tie!'\n  elsif p1 == 'paper' &amp;&amp; p2 = 'rock'\n    'Paper smothers Rock...Player 1 wins!\"\n  elsif etc..\nend \n</code></pre>\n\n<p>This will let your main loop get very small...which is almost always a good thing. This will also make your life beautiful when you start writing unit tests for your code. </p>\n\n<p>As for leaning out your end-of-game tests, use <code>||</code> to compare several things at once, such as <code>player1_val == 9 || player2_val == 9</code></p>\n\n<p>I suspect your code will not work as it is currently written. Try running this line-by-line in a debugger...or more simply, put <code>puts \"var is #{var}\"</code> in various places, dumping the values of interesting variables. Either approach will quickly expose any bugs and make the fix obvious. </p>\n\n<p>As for doing things the Ruby way, consider using symbols instead of strings for your options array. Something like <code>[:paper, :rock, :scissors]</code>. Avoid magic numbers in your code. Any time you have a literal number in your code (other than 1 or 0, perhaps), chances are good you have a magic number and should work to make it a constant, symbol, or equation. </p>\n\n<p><code>redo</code> is not a commonly used Ruby command. (I had to go look it up to see what it does!) You've already got a loop...you should not need redo to pull off your mission. </p>\n\n<p>Beyond good coding practices, we can also talk about UX/UI (user experience/user interface). This is a big one for this game...it's essential that players can't see each other's input. Do some research on <code>getch</code>. Also consider giving each player half the keyboard... \"ASD\" for one player's three choices, and \"JKL\" for the other player.</p>\n\n<p>Those are a bunch of ideas that you might use to up your game! Good luck, and feel free to follow up after you've worked through it a bit. </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "edited": false, "score": 0, "creation_date": 1572349894, "post_id": 58606173, "comment_id": 103524639, "body": "Thanks Cavin! I am still going through classes, procs and lambdas. Could I ask you?  In the following code, why choic1 % 3? Is it regex? Why none is included? May I know why you choose proc? <code>winner = proc { |choice1, choice2| %w(none player1 player2)[choice2 - choice1 % 3] }</code> . Thanks again."}, {"owner": {"reputation": 441, "user_id": 3275798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z5Ypg.jpg?s=128&g=1", "display_name": "cavin kwon", "link": "https://stackoverflow.com/users/3275798/cavin-kwon"}, "edited": false, "score": 0, "creation_date": 1572350703, "post_id": 58606173, "comment_id": 103525016, "body": "1) Mathematics. <code>(choice2 - choice1) % 3</code> 2) proc was used to make the test code easier to read. <code>cases.map(&amp;winner)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "edited": false, "score": 0, "creation_date": 1572355105, "post_id": 58606173, "comment_id": 103527181, "body": "Thanks Cavin. Appreciate your explanation! 1) <code>%w[none player1 player2][choice2 - choice1 % 3]</code> . May I know why none is added? 1) <code>[choice2 - choice1 % 3]</code> why % 3? % is modulus? Sorry, if my question are very basic. I am learning theories at the same time. Thanks!"}, {"owner": {"reputation": 441, "user_id": 3275798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z5Ypg.jpg?s=128&g=1", "display_name": "cavin kwon", "link": "https://stackoverflow.com/users/3275798/cavin-kwon"}, "edited": false, "score": 0, "creation_date": 1572356574, "post_id": 58606173, "comment_id": 103528000, "body": "1) player1 winning cases <code>[[0,1], [1, 2], [2,0]]</code>, player2 winning cases <code>[[0,2], [1,0], [2,1]]</code>. apply <code>choice2 - choice1</code>. <code>[1, 1, -2]</code>,<code>[2, -1, -1]</code>. apply <code>%3</code>. <code>[1, 1, 1]</code>, <code>[2,2,2]</code>. so <code>%w(none player1 player2)[(choice2 - choice1) % 3]</code> returns a winner. <code>none</code> is for tie cases <code>[[0,0],[1,1],[2,2]]</code>"}], "tags": [], "owner": {"reputation": 441, "user_id": 3275798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z5Ypg.jpg?s=128&g=1", "display_name": "cavin kwon", "link": "https://stackoverflow.com/users/3275798/cavin-kwon"}, "is_accepted": false, "score": 1, "last_activity_date": 1572346899, "creation_date": 1572346899, "answer_id": 58606173, "question_id": 58600165, "link": "https://stackoverflow.com/questions/58600165/ruby-player-vs-player-for-rock-paper-scissor-game/58606173#58606173", "title": "Ruby - Player vs Player for Rock, Paper &amp; Scissor Game", "body": "<p>You can judge the winner in the following ways:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>choice1, choice2 = (gets.to_i - 1), (gets.to_i - 1)\nwinner = %w(none player1 player2)[choice2 - choice1 % 3]\n</code></pre>\n\n<p>Let's test</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>winner = proc { |choice1, choice2| %w(none player1 player2)[choice2 - choice1 % 3] }\n\ncases = [[0, 0], [0, 1], [0, 2], [1, 2], [2, 0], [2, 1]]\ncases.map(&amp;winner) #=&gt; [\"none\", \"player1\", \"player2\", \"player1\", \"player1\", \"player2\"]\n</code></pre>\n\n<p>In the same way, the output logic can be simplified.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>HOW_TO_WIN = ['Rock blunts scissors',\n              'Scissors cut paper',\n              'Paper covers rock'].freeze\n\ndef player(no: num)\n  # ...\n  choice = (gets.to_i - 1)\n  # ...\nend\n\ndef play\n  choice1, choice2 = [1, 2].map { |num| player(no: num) }\n  winner = %w[none player1 player2][choice2 - choice1 % 3]\n  how_to = HOW_TO_WIN[choice2 - choice1 % 3]\n\n  if winner == 'none'\n    puts 'Tie, next throw please'\n  else\n    puts \"#{how_to}, #{winner} win\"\n  end\nend\n\nplay\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11836193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572346899, "creation_date": 1572310320, "question_id": 58600165, "link": "https://stackoverflow.com/questions/58600165/ruby-player-vs-player-for-rock-paper-scissor-game", "title": "Ruby - Player vs Player for Rock, Paper &amp; Scissor Game", "body": "<p>Apology if I am repeating what others have previously asked. I have gone through other RSP games questions on stackoverflow. Most are about player vs computer. May be I need to read more theories to understand better and modify the code to suit for my purpose which is player one vs player two. </p>\n\n<p>I am attempting Player one vs Player two - Rock scissors and paper game in Ruby. I have got the following questions about the following code. \n- How do I hide each player entry? \n- There are so many repeats in the code, therefore violating DRY principle. How should I refactor this? \n- Is class method the best way to go with this game (most efficient)? \n- Currently, this game is only for rock paper scissors. If I want to add lizard spock later, how should I future proof this? or Add this in most efficient way? \nThanks in advance! </p>\n\n<pre><code>options = [\"rock\", \"scissors\", \"paper\"]\n\nwhile true\n\n    print &lt;&lt;TEXT \n1 - rock\n2 - scissors\n3 - paper\n9 - end game\nTEXT\n\n    puts \"Player 1, choose rock(1), scissors(2), paper(3). To end the game, enter 9.\"\n    player1_val = gets.to_i\n\n    puts \"Player 2, choose rock(1), scissors(2), paper(3). To end the game, enter 9.\"\n    player2_val = gets.to_i\n\n    if player1_val == 9 # I am repeating the same condition for player2. How should I combine? \n        puts \"End\"\n        exit\n    end\n\n    if player2_val == 9 \n        puts \"End\"\n        exit\n    end\n\n    player1 = options[player1_val-1]\n    player2 = options[player2_val-1]\n\n    if player1 == player2\n        puts \"Tie, next throw please\"\n        redo \n    end \n\n    if player1 == 1 and player2 == 2\n        puts \"Rock blunts scissors, you win\"\n\n    elsif player1 == 2 and player2 == 1\n        puts \"Rock blunts scissors, you loose\"\n\n    elsif player1 == 2 and player2 == 3\n        puts \"Scissors cut paper, you win\"\n\n    elsif player1 == 3 and player2 == 2\n        puts \"Scissors cut paper, you loose\"\n\n    elsif player1 == 3 and player2 == 1\n        puts \"Paper covers rock, you win\"\n\n    elsif player1 == 1 and player2 == 3\n        puts \"Paper covers rock, you loose\"\n    end  \nend\n</code></pre>\n"}, {"tags": ["ruby", "documentation-generation", "rdoc"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1572423172, "post_id": 58599460, "comment_id": 103550288, "body": "Maybe just try to write them in lower case?"}], "answers": [{"tags": [], "owner": {"reputation": 2599, "user_id": 12201472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PcsKV9F65CQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repCiEtFeVMa1z1D-JpXuqg5wlw6w/photo.jpg?sz=128", "display_name": "Marian13", "link": "https://stackoverflow.com/users/12201472/marian13"}, "is_accepted": true, "score": 0, "last_activity_date": 1579897960, "last_edit_date": 1579897960, "creation_date": 1573345081, "answer_id": 58784733, "question_id": 58599460, "link": "https://stackoverflow.com/questions/58599460/is-there-a-way-to-force-rdoc-to-not-style-words-which-correspond-to-classes-or/58784733#58784733", "title": "Is there a way to force RDoc to not style words, which correspond to classes or modules?", "body": "<p>All you need to do is just precede your module and class names with a backslash.</p>\n\n<p>So, instead of <code>Native</code> and <code>Facebook</code>, use <code>\\Native</code> and <code>\\Facebook</code>.</p>\n\n<p>Documentation can be found <a href=\"https://ruby.github.io/rdoc/RDoc/Markup.html#class-RDoc::Markup-label-Escaping+Text+Markup\" rel=\"nofollow noreferrer\">here</a>. In <code>Escaping Text Markup</code> section.</p>\n"}], "owner": {"reputation": 2599, "user_id": 12201472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PcsKV9F65CQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repCiEtFeVMa1z1D-JpXuqg5wlw6w/photo.jpg?sz=128", "display_name": "Marian13", "link": "https://stackoverflow.com/users/12201472/marian13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 58784733, "answer_count": 1, "score": 0, "last_activity_date": 1579897960, "creation_date": 1572303826, "question_id": 58599460, "link": "https://stackoverflow.com/questions/58599460/is-there-a-way-to-force-rdoc-to-not-style-words-which-correspond-to-classes-or", "title": "Is there a way to force RDoc to not style words, which correspond to classes or modules?", "body": "<p>I am trying to write documentation to one of my classes using RDoc and I have the following problem: </p>\n\n<p>This is my source:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module Native\n  module Facebook\n    # Service, which starts(schedules) Native Facebook Fetching Jobs for users with Facebook platform.\n    #\n    # *IMPORTANT:* &lt;tt&gt;Native::Facebook::StartFetchingJobs&lt;/tt&gt; is intended to be called only from &lt;tt&gt;config/schedule.rb&lt;/tt&gt;.\n    #\n    # For example:\n    #   # config/schedule.rb\n    #   every :day, at: '7:00 pm' do\n    #     runner 'Native::Facebook::StartFetchingJobs.call'\n    #   end\n    #\n    class StartFetchingJobs &lt; Service\n      # ...\n\n      def call\n        # ...\n      end\n\n      # ...\n    end\n  end\nend\n\n</code></pre>\n\n<p>This is the screenshot of generated doc:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ws5qr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ws5qr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Since <code>Native</code> and <code>Facebook</code> are modules, RDoc highlights <code>Native</code> and <code>Facebook</code> words in the generated doc (by green text).</p>\n\n<p>So, my question - is there a way to force RDoc to not style words, which correspond to classes or modules?  </p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "mysql2"], "comments": [{"owner": {"reputation": 38137, "user_id": 5841306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wwk1C.jpg?s=128&g=1", "display_name": "Barbaros &#214;zhan", "link": "https://stackoverflow.com/users/5841306/barbaros-%c3%96zhan"}, "edited": false, "score": 0, "creation_date": 1572301962, "post_id": 58599210, "comment_id": 103510991, "body": "try to remove quotes within <code>&#39;rails_user&#39;@&#39;localhost&#39;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9708472, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F9lIaiHjlBY/AAAAAAAAAAI/AAAAAAAAE-A/lJSyRq3USCU/photo.jpg?sz=128", "display_name": "Sasindu Avishka", "link": "https://stackoverflow.com/users/9708472/sasindu-avishka"}, "is_accepted": false, "score": 0, "last_activity_date": 1572306377, "last_edit_date": 1572306377, "creation_date": 1572302771, "answer_id": 58599324, "question_id": 58599210, "link": "https://stackoverflow.com/questions/58599210/im-having-a-problem-with-mysql-syntax-while-setting-a-new-user-for-a-rails-appli/58599324#58599324", "title": "Im having a problem with mysql syntax while setting a new user for a rails application in my database. How do i solve it", "body": "<p>You can try:</p>\n\n<pre><code>GRANT ALL ON my_project_development TO rails_user\n</code></pre>\n\n<p>check <a href=\"http://www.mysqltutorial.org/mysql-grant.aspx\" rel=\"nofollow noreferrer\">this site</a> as well..</p>\n"}], "owner": {"reputation": 1, "user_id": 12288402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAAQFdt9DoB6up5O4QJy_-yoGb9BeadXV04RXoF=k-s128", "display_name": "Zahi Ghani", "link": "https://stackoverflow.com/users/12288402/zahi-ghani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572306377, "creation_date": 1572301817, "last_edit_date": 1572302017, "question_id": 58599210, "link": "https://stackoverflow.com/questions/58599210/im-having-a-problem-with-mysql-syntax-while-setting-a-new-user-for-a-rails-appli", "title": "Im having a problem with mysql syntax while setting a new user for a rails application in my database. How do i solve it", "body": "<p>this what i did in mysql command line </p>\n\n<pre><code>mysql&gt; CREATE DATABASE demo_project_development;\nQuery OK, 1 row affected (0.01 sec)\n\nmysql&gt; CREATE DATABASE demo_project_test;\nQuery OK, 1 row affected (0.00 sec)\n\nmysql&gt; GRANT ALL PRIVILEGES ON my_project_development.* TO 'rails_user'@'localhost' \n       IDENTIFIED BY 'secretpassword';\n</code></pre>\n\n<blockquote>\n  <p><strong>ERROR 1064</strong> (<strong>42000</strong>): You have an error in your SQL syntax; check the\n  manual that corresponds to your MySQL server version for the right\n  syntax to use near 'IDENTIFIED BY 'secretpassword'' at line 1</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 2, "last_activity_date": 1572301747, "creation_date": 1572301747, "answer_id": 58599198, "question_id": 58599168, "link": "https://stackoverflow.com/questions/58599168/update-all-props-of-a-model/58599198#58599198", "title": "Update all props of a model", "body": "<p>I believe you can do:</p>\n\n<pre><code>class Metric &lt; ApplicationRecord\n  belongs_to :post\n\n  def analyse!\n    client = ThirdPartyService.new\n    res = client.get_metrics post.body\n    update res\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 5480591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed0c44012e52e7077b08b66948586e0?s=128&d=identicon&r=PG&f=1", "display_name": "s sato", "link": "https://stackoverflow.com/users/5480591/s-sato"}, "is_accepted": false, "score": 0, "last_activity_date": 1573192197, "last_edit_date": 1573192197, "creation_date": 1572325173, "answer_id": 58601636, "question_id": 58599168, "link": "https://stackoverflow.com/questions/58599168/update-all-props-of-a-model/58601636#58601636", "title": "Update all props of a model", "body": "<p>According to the Rails <a href=\"https://guides.rubyonrails.org/active_record_basics.html#update\" rel=\"nofollow noreferrer\">documentation</a>, you can update your model in the following way.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>m = Metric.first\nm.adverbs_percentage= 10\nm.sentiment= 'Positive'\nm.save\n</code></pre>\n\n<p>In the above example, <code>adverbs_percentage=</code>, <code>sentiment=</code>, <code>save</code> are instance method of <code>Metric</code> class.<br>\nYou defined these instance methods by inheriting <code>ApplicationRecord</code>.  </p>\n\n<p>Since they are instance method, you can call these methods in your instance method(<code>analyse!</code>).  </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Metric &lt; ApplicationRecord\n  belongs_to :post\n\n  def analyse!\n    client = ThirdPartyService.new\n    res = client.get_metrics post.body\n\n    self.sentiment = res.sentiment\n    self.adverbs_percentage = res.adverbs_percentage \n    save\n  end\nend\n</code></pre>\n\n<p>Note that <code>adverbs_percentage=</code> and <code>sentiment=</code> needs <code>self.</code>, because ruby need to distinguish them from local variable assignment.<br>\nSee <a href=\"https://stackoverflow.com/questions/44715/why-do-ruby-setters-need-self-qualification-within-the-class\">here</a> for more detail.</p>\n"}], "owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573192197, "creation_date": 1572301508, "question_id": 58599168, "link": "https://stackoverflow.com/questions/58599168/update-all-props-of-a-model", "title": "Update all props of a model", "body": "<p>My app has the following models</p>\n\n<pre><code>class Metric &lt; ApplicationRecord\n  belongs_to :post\n\n  def analyse!\n    client = ThirdPartyService.new\n    res = client.get_metrics post.body\n    # how to update itself here with the result of res?\n  end\nend\n</code></pre>\n\n<pre><code>class Post &lt; ApplicationRecord\n  has_many :metrics\n\n  after_save :start_analysis\n\n  private\n\n  def start_analysis\n    metric = create_metric\n    metric.analysis!\n  end\nend\n</code></pre>\n\n<p>The Metric table has a bunch of metrics, like:</p>\n\n<pre><code>adverbs_percentage\nsentiment\n</code></pre>\n\n<p>and the returning result of calling:</p>\n\n<pre><code>client = ThirdPartyService.new\nres = client.get_metrics post.body\n</code></pre>\n\n<p>is a hash containing those exactly props:</p>\n\n<pre><code>{\n  :adverbs_percentage =&gt; 10\n  :sentiment =&gt; 'Positive'\n}\n</code></pre>\n\n<p>I would like to know how can I update the Metric from the <code>analyse!</code> method, something like:</p>\n\n<pre><code>update_myself(res)\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572307078, "post_id": 58598802, "comment_id": 103512059, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/55386266/getting-error-exit-code-2-for-bootsnap-not-allowing-to-set-up-rails-server\">Getting error (exit code 2) for bootsnap, not allowing to set up Rails Server</a>"}, {"owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572352196, "post_id": 58598802, "comment_id": 103525737, "body": "tried both solutions and it doesn&#39;t solve my issue"}], "answers": [{"tags": [], "owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "is_accepted": false, "score": 0, "last_activity_date": 1572352988, "creation_date": 1572352988, "answer_id": 58607715, "question_id": 58598802, "link": "https://stackoverflow.com/questions/58598802/how-to-fix-failed-to-build-gem-native-extension-error-with-bootsnap-with-wind/58607715#58607715", "title": "How to fix &#39; Failed to build gem native extension&#39; error with bootsnap with Windows", "body": "<p>Actually, Bootsnap won't work on Windows anyway, so I'd recommend just removing it from Gemfile. If you want to leave it for production environment, perhaps you should include it conditionally with something like:</p>\n\n<pre><code>gem 'bootsnap' unless (RbConfig::CONFIG['host_os'] =~ /mswin|mingw|cygwin/)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2638449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d56d7637e0a30501f659bbfff449d77?s=128&d=identicon&r=PG", "display_name": "Ibrahim Abouhashish", "link": "https://stackoverflow.com/users/2638449/ibrahim-abouhashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 645, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572352988, "creation_date": 1572299089, "question_id": 58598802, "link": "https://stackoverflow.com/questions/58598802/how-to-fix-failed-to-build-gem-native-extension-error-with-bootsnap-with-wind", "title": "How to fix &#39; Failed to build gem native extension&#39; error with bootsnap with Windows", "body": "<p>I am using Windows, and I just installed Ruby on Rails, ruby is version 2.6.3p62 (2019-04-16 revision 67580) [x64-mingw32], rails is version 6.0.0.\nWhen running rails new blog (following <a href=\"https://guides.rubyonrails.org/getting_started.html#installing-rails\" rel=\"nofollow noreferrer\">this tutorial</a>) bundle install runs.</p>\n\n<p>I have tried reinstalling Ruby, changing its version, and even removing bootsnap and running something else, but even when trying to install the puma gem I get the same error.</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\nC:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.5/ext/bootsnap\nC:/Ruby26-x64/bin/ruby.exe -I C:/Ruby26-x64/lib/ruby/2.6.0 -r\n./siteconf20191028-6188-1rw29js.rb extconf.rb\ncreating Makefile\n\ncurrent directory:\nC:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.5/ext/bootsnap\nmake \"DESTDIR=\" clean\n\ncurrent directory:\nC:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.5/ext/bootsnap\nmake \"DESTDIR=\"\ngenerating bootsnap-x64-mingw32.def\ncompiling bootsnap.c\nlinking shared-object bootsnap/bootsnap.so\nC:/Ruby26-x64/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/9.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe:\nbootsnap.o:bootsnap.c:(.text+0x557): undefined reference to `__strcat_chk'\nC:/Ruby26-x64/msys64/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/9.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe:\nbootsnap.o:bootsnap.c:(.text+0xa07): undefined reference to `__chk_fail'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [Makefile:261: bootsnap.so] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in\nC:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.5 for inspection.\nResults logged to\nC:/Ruby26-x64/lib/ruby/gems/2.6.0/extensions/x64-mingw32/2.6.0/bootsnap-1.4.5/gem_make.out\n\nAn error occurred while installing bootsnap (1.4.5), and Bundler cannot\ncontinue.\nMake sure that `gem install bootsnap -v '1.4.5' --source\n'https://rubygems.org/'` succeeds before bundling.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 16655, "user_id": 584440, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b5c3b0c74c564105de0415899c0d5999?s=128&d=identicon&r=PG", "display_name": "rubyprince", "link": "https://stackoverflow.com/users/584440/rubyprince"}, "is_accepted": true, "score": 5, "last_activity_date": 1572299521, "creation_date": 1572299521, "answer_id": 58598866, "question_id": 58598793, "link": "https://stackoverflow.com/questions/58598793/using-ruby-send-method-to-create-and-build-a-new-class/58598866#58598866", "title": "Using ruby send method to create and build a new class", "body": "<p>You use <a href=\"https://apidock.com/rails/String/constantize\" rel=\"noreferrer\">constantize</a> from Rails to do it:</p>\n\n<pre><code>klass = \"Sms::Message::#{reminder}ReminderMessage\".constantize\nklass.new(data).build\n</code></pre>\n"}], "owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58598866, "answer_count": 1, "score": 0, "last_activity_date": 1572299521, "creation_date": 1572299018, "last_edit_date": 1572299374, "question_id": 58598793, "link": "https://stackoverflow.com/questions/58598793/using-ruby-send-method-to-create-and-build-a-new-class", "title": "Using ruby send method to create and build a new class", "body": "<p>I have some classes that I want to call dynamiclly:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> Sms::Message::TenMinutesBeforeReminderMessage.new(data).build\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Sms::Message::OneHourAfterReminderMessage.new(data).build\n</code></pre>\n\n<p>I want to be able to do something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>send(\"Sms::Message::#{reminder}ReminderMessage.new(data).build\")\n</code></pre>\n\n<p>Where <code>reminder</code> is a symbol. \nIs this possible? If so I can't seem to figure out the syntax</p>\n"}, {"tags": ["ruby", "rubygems", "jekyll", "bundler", "github-pages"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572299044, "post_id": 58598699, "comment_id": 103510121, "body": "&quot;<i>but they all result in errors</i>&quot; What errors? Please take a moment to read both <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>, then come back and update this question and the one you opened earlier about the same issue."}, {"owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572302997, "post_id": 58598699, "comment_id": 103511231, "body": "@anothermh perhaps the title is not suggestive enough to you understand my questions. So I kindly emphasized what my question is about since perhaps people skip the title of the question."}, {"owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572303241, "post_id": 58598699, "comment_id": 103511280, "body": "seems like the last thing I need to have this work is this <code>Resolving dependencies... Bundler could not find compatible versions for gem &quot;jekyll-feed&quot;:   In Gemfile:     jekyll-feed (~&gt; 0.12)      github-pages (= 202) was resolved to 202, which depends on       jekyll-feed (= 0.11.0)</code> just in case someone knows"}], "answers": [{"comments": [{"owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "edited": false, "score": 0, "creation_date": 1572303185, "post_id": 58599128, "comment_id": 103511268, "body": "seems like the last thing I need to have this work is this <code>Resolving dependencies... Bundler could not find compatible versions for gem &quot;jekyll-feed&quot;:   In Gemfile:     jekyll-feed (~&gt; 0.12)      github-pages (= 202) was resolved to 202, which depends on       jekyll-feed (= 0.11.0)</code> just in case you know."}], "tags": [], "owner": {"reputation": 803, "user_id": 716249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b05198379f4b275d304fd27e6cb09ae?s=128&d=identicon&r=PG", "display_name": "parkr", "link": "https://stackoverflow.com/users/716249/parkr"}, "is_accepted": true, "score": 2, "last_activity_date": 1572301276, "creation_date": 1572301276, "answer_id": 58599128, "question_id": 58598699, "link": "https://stackoverflow.com/questions/58598699/what-is-the-format-for-the-dependency-version-to-install-github-pages-and-jekyll/58599128#58599128", "title": "What is the format for the dependency version to install github pages and jekyll?", "body": "<p>The versions for the github-pages gem are different than for the Jekyll gem.</p>\n\n<p>To look up a gem's versions, use RubyGems.org.</p>\n\n<p>Here are the versions for github-pages: <a href=\"https://rubygems.org/gems/github-pages\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/github-pages</a></p>\n\n<p>The latest version is 202, so you'd put:</p>\n\n<pre><code>gem \"github-pages\", \"202\"\n</code></pre>\n\n<p>With each new release (you can watch <a href=\"https://github.com/github/pages-gem\" rel=\"nofollow noreferrer\">the github/pages-gem repo for releases</a> if you want to be notified when new ones are released), just replace the <code>\"202\"</code> with the new version in quotes.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 58599128, "answer_count": 1, "score": 1, "last_activity_date": 1572302821, "creation_date": 1572298545, "last_edit_date": 1572302821, "question_id": 58598699, "link": "https://stackoverflow.com/questions/58598699/what-is-the-format-for-the-dependency-version-to-install-github-pages-and-jekyll", "title": "What is the format for the dependency version to install github pages and jekyll?", "body": "<p>I was following <a href=\"https://help.github.com/en/github/working-with-github-pages/creating-a-github-pages-site-with-jekyll#creating-your-site\" rel=\"nofollow noreferrer\">the github instructions for jekyll and github</a>. At step 8 &amp; 9 it says:</p>\n\n<blockquote>\n  <p>8) Open the Gemfile that was created and follow the instructions in the\n  Gemfile's comments to use GitHub Pages.</p>\n\n<pre><code># uncomment the line below. To upgrade, run `bundle update github-pages`.\ngem \"github-pages\", group: :jekyll_plugins\n</code></pre>\n  \n  <p>9) Update the gem \"github-pages\" line so that the line looks like this, replacing VERSION with the current dependency version for\n  github-pages. For more information, see \"Dependency versions\" on the\n  GitHub Pages site.</p>\n  \n  <p><code>gem \"github-pages\", \"~&gt; VERSION\", group: :jekyll_plugins</code></p>\n</blockquote>\n\n<p>but I don't understand what goes in <code>VERSION</code></p>\n\n<p>I tried the following:</p>\n\n<pre><code># gem \"github-pages\", \"~&gt; jekyll 3.8.5\", group: :jekyll_plugins\n#gem \"github-pages\", \"~&gt; 3.8.5\", group: :jekyll_plugins\n\n</code></pre>\n\n<p>but they all result in errors. However, its obvious that the errors don't matter because I don't know what is suppose to go in <code>Version</code>. Whats supposed to go in version <code>VERSION</code>?</p>\n\n<hr>\n\n<p>related error:</p>\n\n<ul>\n<li><a href=\"https://talk.jekyllrb.com/t/how-to-install-github-pages-with-jekyll/3510\" rel=\"nofollow noreferrer\">https://talk.jekyllrb.com/t/how-to-install-github-pages-with-jekyll/3510</a></li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572299160, "post_id": 58598620, "comment_id": 103510140, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2567029/how-to-make-nokogiri-transparently-return-un-encoded-html-entities-untouched\">How to make Nokogiri transparently return un/encoded Html entities untouched?</a>"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572299549, "post_id": 58598620, "comment_id": 103510262, "body": "@anothermh see update above. Referred solution does not seem to help. Maybe it&#39;s the <code>.to_html</code> ? If so, what&#39;s the right way?"}, {"owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "edited": false, "score": 0, "creation_date": 1572304333, "post_id": 58598620, "comment_id": 103511520, "body": "Upvoted for scoping the problem and giving a test code that can be run easily \ud83d\udc4d. Can you please update the question with what is the expected output?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572305402, "post_id": 58598620, "comment_id": 103511751, "body": "@Ben Try <code>doc.fragment(html).to_xml</code> =&gt; <code>&quot;&lt;a href=\\&quot;[% hello %]\\&quot;&gt;Hello from [% Us %]&lt;&#47;a&gt;&quot;</code>. Should work because it&#39;s XML, and XML won&#39;t necessarily know about <i>HTML</i> entities."}], "answers": [{"tags": [], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "is_accepted": false, "score": 2, "last_activity_date": 1572317973, "creation_date": 1572317973, "answer_id": 58600902, "question_id": 58598620, "link": "https://stackoverflow.com/questions/58598620/how-to-use-special-characters-in-nokogiri/58600902#58600902", "title": "How to use [% special characters in Nokogiri", "body": "<p>@anothermh actually answered my question (see comments below my question). I ended up using his suggestion (<code>to_xml</code>)</p>\n\n<p>However, I needed more out of the parsing of my code than I decided not to mention. I needed to be able to keep the special characters in the  tags, but also convert self-closing tags to regular tags.</p>\n\n<p>My solution was to use the XHTML format, described here: <a href=\"https://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Node/SaveOptions#FORMAT-constant\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Node/SaveOptions#FORMAT-constant</a></p>\n\n<pre><code>html = \"... my html ...\"    \ndoc = Nokogiri::HTML::Document.new\ndoc.encoding = 'UTF-8'\nfinal = doc.parse(html).to_xml(:save_with =&gt; Nokogiri::XML::Node::SaveOptions::DEFAULT_XHTML)\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1572380368, "creation_date": 1572297995, "last_edit_date": 1572380368, "question_id": 58598620, "link": "https://stackoverflow.com/questions/58598620/how-to-use-special-characters-in-nokogiri", "title": "How to use [% special characters in Nokogiri", "body": "<p>I am using Nokogiri in Rails to parse my HTML and convert self-closing tags to regular ones. That works great, but it also converts our template tags which are <code>[%</code> and <code>%]</code>, so for example: </p>\n\n<pre><code>html = \"&lt;a href='[% hello %]'&gt;Hello from [% Us %]&lt;/a&gt;\"\nNokogiri::HTML::DocumentFragment.parse(html).to_html\n</code></pre>\n\n<p>will convert to:</p>\n\n<pre><code>&lt;a href='%5B%%20hello%20%%5D'&gt;Hello from [% Us %]&lt;/a&gt;\n</code></pre>\n\n<p>How do I avoid it without using <code>gsub</code> after the conversion?</p>\n\n<p>This did not help:</p>\n\n<pre><code>html = \"&lt;a href='[% hello %]'&gt;Hello from [% Us %]&lt;/a&gt;\"\ndoc = Nokogiri::HTML::Document.new\ndoc.encoding = 'UTF-8'\ndoc.fragment(html).to_html\n#=&gt; \"&lt;a href=\\\"%5B%%20hello%20%%5D\\\"&gt;Hello from [% Us %]&lt;/a&gt;\" \n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "sinatra", "sinatra-activerecord"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572297931, "post_id": 58598400, "comment_id": 103509722, "body": "&quot;<i>This will not let me save/persist my data</i>&quot; How did you come to this conclusion? <code>schema.rb</code> is merely a representation of the database schema at the time it was created or last migrated, and is generated by reading the schema from the database. The existence of this file has no impact on your ability to write to your database. If you have a specific error that you&#39;ve received then post that error and exact steps to reproduce it."}, {"owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572301093, "post_id": 58598400, "comment_id": 103510757, "body": "Binding.pry. it creates the record(i.e. User.all.count == 1). Then upon redirect it deleted the record (I.e. force: : delete in the repl  and User.all.count ==0)."}, {"owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572301228, "post_id": 58598400, "comment_id": 103510789, "body": "Sooo. If I delete this file it saves/persists the record. When I run a migration I get the file back and force::Cascade in the repl (pry) with the record being deleted upon redirect."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572304203, "post_id": 58598400, "comment_id": 103511491, "body": "None of what you have said in comments makes much sense. The existence of schema.rb will not cause records not to persist. Additionally, these are not steps to reproduce. If you have a specific error or unexpected result then you must post in your question the <b>exact</b> steps to reproduce it. You don&#39;t even have any <code>User.create</code> or <code>User.new.save</code> code in your example!"}, {"owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572308620, "post_id": 58598400, "comment_id": 103512314, "body": "deletion of schema.rb my program will persist. another migration I get the force::Cascade. The record will not persist. I use a form to create a new user, post uses User.create(params). Then redirect location the record vis no longer there. So when it exists User.all will have it. Then in the redirect User.all is empty. It redirect another action controller &#39;user/:id&#39;. If I delete the file then it will get literally user/1 and everything works like it should. When I delete the schema then you see the :force:Cascade in the relp and the record is then gone in the redirect."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572309862, "post_id": 58598400, "comment_id": 103512532, "body": "I have asked you twice to place in your question the <b>exact</b> steps and the <b>exact</b> code necessary to reproduce this error. The comments you have left are not helpful. Additionally, you are insisting that the problem is the existence of schema.rb and I am telling you that is <b>not the issue</b>. That is <b>not</b> how schema.rb works or why it exists. I have voted to close this question as off-topic because it does not include the code necessary to reproduce the issue. Please read: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "is_accepted": false, "score": 1, "last_activity_date": 1572448215, "last_edit_date": 1572448215, "creation_date": 1572418659, "answer_id": 58620049, "question_id": 58598400, "link": "https://stackoverflow.com/questions/58598400/activerecord-autogenerating-schema-rb-file-with-forcecascade-that-deletes-my-r/58620049#58620049", "title": "ActiveRecord autogenerating Schema.rb file with force::cascade that deletes my records", "body": "<p>I am leaving this for future users who have confusing errors when building a custom Sinatra ActiveRecord app. </p>\n\n<p>The lesson learned is to know exactly what all your gems are doing. In my question the error was coming from the environment file. require_all \"db\" was added because I assumed require_all gave my app access to the files specified. require_all literally will run that file. It's important to note that this environment file is run for every request made to the db. Thus the db folder which contains the file for create_table was run for each get request made. Upon deleting require_all 'db' my app started working perfectly.  </p>\n"}], "owner": {"reputation": 39, "user_id": 10740512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9035455bc3b1332eb87ceba73323f77e?s=128&d=identicon&r=PG&f=1", "display_name": "rTaylor", "link": "https://stackoverflow.com/users/10740512/rtaylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572448215, "creation_date": 1572296639, "question_id": 58598400, "link": "https://stackoverflow.com/questions/58598400/activerecord-autogenerating-schema-rb-file-with-forcecascade-that-deletes-my-r", "title": "ActiveRecord autogenerating Schema.rb file with force::cascade that deletes my records", "body": "<p>I am creating a Sinatra app with ActiveRecord to persist data. When I run rake db:migrate it auto-generates a schema.rb file that contains the table name with force::cascade. This will not let me save/persist my data. If i delete this file I CAN save/persist the data. However every migration makes this schema file. I do not know how to stop this from happening.  </p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :users do |t| \n      t.string :name \n      t.string :email \n      t.string :password_digest \n  end\nend \nend\n</code></pre>\n\n<pre><code>require \"./config/environment\"\nrequire \"./app/models/user\"\nclass UserC &lt; Sinatra::Base\n\n  configure do\n    set :views, \"app/views\"\n    enable :sessions\n    set :session_secret, \"password_security\"\n  end\n\nend\n</code></pre>\n\n<pre><code>\nrequire \"bundler\" \nBundler.require\n\nActiveRecord::Base.establish_connection(\n  :adapter =&gt; \"sqlite3\",\n  :database =&gt; \"development.sqlite\"\n)\n\nrequire_all 'app'\nrequire_all 'db'\n</code></pre>\n\n<pre><code>require_relative './config/environment'\n\nuse Rack::MethodOverride\n#use Rack::Session::Cookie\nrun UserController\n</code></pre>\n\n<pre><code>#gemfile # frozen_string_literal: true\n\nsource \"https://rubygems.org\"\n\ngit_source(:github) {|repo_name| \"https://github.com/#{repo_name}\" }\n\n# gem \"rails\"\ngem 'activerecord', :require =&gt; 'active_record'\n\ngem 'pry'\ngem 'pry-nav'\ngem 'bcrypt'\ngem 'rake'\ngem 'require_all'\ngem 'rack_session_access'\ngem 'shotgun'\ngem 'sinatra'\ngem 'sinatra-activerecord', :require =&gt; 'sinatra/activerecord'\ngem 'sqlite3'\ngem 'thin'\ngem 'tux' \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572298076, "post_id": 58598298, "comment_id": 103509777, "body": "<code>(Date.today..-Date::Infinity.new).to_a</code> is just an empty array."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1572309207, "post_id": 58598298, "comment_id": 103512428, "body": "What&#39;s the use case for this? the range you want is the same as &quot;any date less than today&quot;, what do you want to do what that range? It sounds too complicated and maybe there are better options for whatever you want to do."}], "answers": [{"comments": [{"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "edited": false, "score": 0, "creation_date": 1572296744, "post_id": 58598348, "comment_id": 103509331, "body": "that&#39;s probably what I&#39;m going to end up doing -- my application also needs to be able to distinguish between ranges that start at -infinity vs ones that start at a defined time, and I&#39;d prefer not to have the dependency on the arbitrary 100 year value. It&#39;s not the worst thing, but I was hoping Ruby&#39;s infinite range support would make it possible"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "edited": false, "score": 0, "creation_date": 1572296865, "post_id": 58598348, "comment_id": 103509366, "body": "I get it, but you could do something somewhat arbitrary that still covers your use case.  It might also be helpful if you provide code example of your implementation or spec."}, {"owner": {"reputation": 809, "user_id": 1166645, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/637f6794c0f9f0638234201eb9b07887?s=128&d=identicon&r=PG", "display_name": "Yathi", "link": "https://stackoverflow.com/users/1166645/yathi"}, "edited": false, "score": 1, "creation_date": 1572318119, "post_id": 58598348, "comment_id": 103513990, "body": "I think this is in fact better than negative infinity because I don&#39;t think you will usually want dates from the time of the dinosaurs. This will act as a check to ensure that someone is not trying to enter garbage values. But if your question was merely hypothetical, then I am not sure :)"}, {"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "edited": false, "score": 1, "creation_date": 1572372246, "post_id": 58598348, "comment_id": 103536299, "body": "This answer was the most useful - my insistence on the infinite range was because it seems like it should be possible - it can be done with numbers, why not dates - and because it would have simplified my work. I needed to create a set of date ranges and then &quot;invert&quot; that set elsewhere (create a set of ranges representing the times not covered by the original ranges). A range that starts at 100 years ago inverts to a range from minus infinity to 100 years ago."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1572297441, "last_edit_date": 1572297441, "creation_date": 1572296397, "answer_id": 58598348, "question_id": 58598298, "link": "https://stackoverflow.com/questions/58598298/is-it-possible-to-create-a-date-range-in-ruby-from-negative-infinity/58598348#58598348", "title": "is it possible to create a date range in ruby from negative infinity", "body": "<p>Why do you need infinity? How far back in time do you really need to go? Can't you just do something like this:</p>\n\n<pre><code>[*100.year.ago.to_date...Date.today]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "is_accepted": false, "score": 2, "last_activity_date": 1572305704, "creation_date": 1572305704, "answer_id": 58599706, "question_id": 58598298, "link": "https://stackoverflow.com/questions/58598298/is-it-possible-to-create-a-date-range-in-ruby-from-negative-infinity/58599706#58599706", "title": "is it possible to create a date range in ruby from negative infinity", "body": "<p>Maybe not the best solution, but it can be helpful:</p>\n\n<pre><code>(-Float::INFINITY...Date.today.to_time.to_i).include? Date.yesterday.to_time.to_i\n =&gt; true\n</code></pre>\n"}], "owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 1, "accepted_answer_id": 58598348, "answer_count": 2, "score": 2, "last_activity_date": 1572324478, "creation_date": 1572296172, "question_id": 58598298, "link": "https://stackoverflow.com/questions/58598298/is-it-possible-to-create-a-date-range-in-ruby-from-negative-infinity", "title": "is it possible to create a date range in ruby from negative infinity", "body": "<p>I'm struggling to define a date range in Ruby (2.6.3) that represents the range of dates up to a given date (in my examples it is Date.today):</p>\n\n<p><code>BigDecimal(\"Infinity\")...Date.today</code></p>\n\n<blockquote>\n  <p>*** ArgumentError Exception: bad value for range</p>\n</blockquote>\n\n<p><code>nil...Date.today</code></p>\n\n<blockquote>\n  <p>*** ArgumentError Exception: bad value for range</p>\n</blockquote>\n\n<p><code>Date::Infinity.new...Date.today</code></p>\n\n<blockquote>\n  <p>*** ArgumentError Exception: bad value for range</p>\n</blockquote>\n\n<p><code>(Date.today...-Date::Infinity.new)</code></p>\n\n<blockquote>\n  <p>Fri, 31 May 2019...#</p>\n</blockquote>\n\n<p>this one doesn't break, but also doesn't appear to give me a meaningful date range:</p>\n\n<p><code>(Date.today...-Date::Infinity.new).include? Date.yesterday</code></p>\n\n<blockquote>\n  <p>false</p>\n</blockquote>\n"}, {"tags": ["ruby", "rubygems", "jekyll", "bundler"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572295944, "post_id": 58598084, "comment_id": 103509010, "body": "&quot;<i>but then after I tried to bundle my Gemfile using the command bundle I get the following error</i>&quot; but you pasted the exact same block of text as the previous one showing output from <code>gem install</code>, not from <code>bundle install</code>."}, {"owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572296023, "post_id": 58598084, "comment_id": 103509038, "body": "@anothermh updated, sorry getting confused with all the commands I&#39;m trying. Does that help?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572296105, "post_id": 58598084, "comment_id": 103509072, "body": "No, because you only said &quot;<i>I also ran this bundle install</i>&quot; but did not indicate when you ran it in the sequence of events, and you left in the incorrect information that shows your <code>gem install</code> output twice."}, {"owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572296337, "post_id": 58598084, "comment_id": 103509168, "body": "@anothermh I know this does not help, but I&#39;ve ran many things in lots of orders so I lost track of what I did. I am happy to re-write the question. I will google how to restart the whole process unless you know how I can do that :)"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572296579, "post_id": 58598084, "comment_id": 103509270, "body": "A question that isn&#39;t explicit about how it got to where it is and that asks us to figure it out probably will not be well received."}], "answers": [{"comments": [{"owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "edited": false, "score": 0, "creation_date": 1572297662, "post_id": 58598379, "comment_id": 103509633, "body": "but the instructions here <a href=\"https://help.github.com/en/github/working-with-github-pages/creating-a-github-pages-site-with-jekyll#creating-your-site\" rel=\"nofollow noreferrer\">help.github.com/en/github/working-with-github-pages/&hellip;</a> say to do   <code>&gt; Update the gem &quot;github-pages&quot; line so that the line looks like this, replacing VERSION with the current dependency version for github-pages. For more information, see &quot;Dependency versions&quot; on the GitHub Pages site.</code>  I tried the following but it failed:  <code>gem &quot;github-pages&quot;, &quot;~&gt; 3.8.5&quot;, group: :jekyll_plugins</code>"}, {"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "reply_to_user": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "edited": false, "score": 0, "creation_date": 1572331536, "post_id": 58598379, "comment_id": 103516631, "body": "&quot;github-pages&quot; is at <a href=\"https://rubygems.org/gems/github-pages\" rel=\"nofollow noreferrer\">version 202</a>. And you have no needs to add a version number if you always want the last version."}], "tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": false, "score": 4, "last_activity_date": 1572296578, "creation_date": 1572296578, "answer_id": 58598379, "question_id": 58598084, "link": "https://stackoverflow.com/questions/58598084/how-does-one-downgrade-jekyll-to-work-with-github-pages/58598379#58598379", "title": "How does one downgrade jekyll to work with github pages?", "body": "<p>Your <strong>Gemfile</strong> should look like :</p>\n\n<pre><code>source 'https://rubygems.org'\n\n# will install all gh-pages allowed gems\n# see : https://pages.github.com/versions/\ngem 'github-pages'\n\n# comment out all other gems\n# gem 'jekyll'\n# gem 'jekyll-feed'\n# gem ...\n</code></pre>\n\n<p>Remove <strong>Gemfile.lock</strong></p>\n\n<p>You can now do a <code>bundle</code> and it will install all needed gems to test against actual github-pages version.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 6885157, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oGxmkDbLy9Y/AAAAAAAAAAI/AAAAAAAAKDs/Sx9aR70hfWE/photo.jpg?sz=128", "display_name": "Alex Waibel", "link": "https://stackoverflow.com/users/6885157/alex-waibel"}, "is_accepted": false, "score": 5, "last_activity_date": 1573276426, "creation_date": 1573276426, "answer_id": 58776636, "question_id": 58598084, "link": "https://stackoverflow.com/questions/58598084/how-does-one-downgrade-jekyll-to-work-with-github-pages/58776636#58776636", "title": "How does one downgrade jekyll to work with github pages?", "body": "<p>The current version of github pages requires you set use Jekyll 3.8.5 and github-pages 202. When I set this up, I also had to set a specific version for jekyll feed. Here's the relevant lines you need in your Gemfile:</p>\n\n<pre><code>gem \"jekyll\", \"~&gt; 3.8.5\"\ngem \"github-pages\",\"~&gt; 202\" , group: :jekyll_plugins\n# If you have any plugins, put them here!\ngroup :jekyll_plugins do\n  gem \"jekyll-feed\", \"~&gt; 0.11.0\"\nend\n</code></pre>\n\n<p>After that, try removing your Gemfile.lock and running <code>bundle install</code>.</p>\n\n<p>I have a repo <a href=\"https://github.com/alexwaibel/simple-staticman-site/tree/template-site\" rel=\"noreferrer\">here</a> with a minimal version set up.</p>\n"}], "owner": {"reputation": 13435, "user_id": 1601580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2B6rV.png?s=128&g=1", "display_name": "Charlie Parker", "link": "https://stackoverflow.com/users/1601580/charlie-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2592, "favorite_count": 3, "answer_count": 2, "score": 8, "last_activity_date": 1573276426, "creation_date": 1572295161, "last_edit_date": 1572367796, "question_id": 58598084, "link": "https://stackoverflow.com/questions/58598084/how-does-one-downgrade-jekyll-to-work-with-github-pages", "title": "How does one downgrade jekyll to work with github pages?", "body": "<p>I think my main issue is that jekyll 4 is not support by github pages. That is fine with me, but how do I downgrade jekyll to work regardless?</p>\n\n<p>I tried following the instructions here: <a href=\"https://github.com/github/pages-gem/issues/577\" rel=\"noreferrer\">https://github.com/github/pages-gem/issues/577</a></p>\n\n<p>which basically seem to suggest to use an older version of jekyll. Im fine with doing that but it seems bundle refuses to obey me and I don't know why or I get into a weird loop I can't get out of.</p>\n\n<p>So the main error I get is:</p>\n\n<pre><code>$ bundle\nFetching gem metadata from https://rubygems.org/..........\nFetching gem metadata from https://rubygems.org/.\nYou have requested:\n  jekyll ~&gt; 3.8.5\n\nThe bundle currently has jekyll locked at 4.0.0.\nTry running `bundle update jekyll`\n\nIf you are updating multiple gems in your Gemfile at once,\ntry passing them all to `bundle update`\n</code></pre>\n\n<p>but it seems that I am locked to 4. I tried unlocking but I can't seem to get that to work. My most recent attempt is the following:</p>\n\n<pre><code>$ gem install jekyll -v 3.8.5\nFetching kramdown-1.17.0.gem\nFetching jekyll-3.8.5.gem\nFetching sass-listen-4.0.0.gem\nFetching sass-3.7.4.gem\nFetching jekyll-sass-converter-1.5.2.gem\nFetching i18n-0.9.5.gem\nSuccessfully installed kramdown-1.17.0\nSuccessfully installed sass-listen-4.0.0\n\nRuby Sass has reached end-of-life and should no longer be used.\n\n* If you use Sass as a command-line tool, we recommend using Dart Sass, the new\n  primary implementation: https://sass-lang.com/install\n\n* If you use Sass as a plug-in for a Ruby web framework, we recommend using the\n  sassc gem: https://github.com/sass/sassc-ruby#readme\n\n* For more details, please refer to the Sass blog:\n  https://sass-lang.com/blog/posts/7828841\n\nSuccessfully installed sass-3.7.4\nSuccessfully installed jekyll-sass-converter-1.5.2\nSuccessfully installed i18n-0.9.5\nSuccessfully installed jekyll-3.8.5\nParsing documentation for kramdown-1.17.0\nInstalling ri documentation for kramdown-1.17.0\nParsing documentation for sass-listen-4.0.0\nInstalling ri documentation for sass-listen-4.0.0\nParsing documentation for sass-3.7.4\nInstalling ri documentation for sass-3.7.4\nParsing documentation for jekyll-sass-converter-1.5.2\nInstalling ri documentation for jekyll-sass-converter-1.5.2\nParsing documentation for i18n-0.9.5\nInstalling ri documentation for i18n-0.9.5\nParsing documentation for jekyll-3.8.5\nInstalling ri documentation for jekyll-3.8.5\nDone installing documentation for kramdown, sass-listen, sass, jekyll-sass-converter, i18n, jekyll after 8 seconds\n6 gems installed\n</code></pre>\n\n<p>but then after I tried to bundle my <code>Gemfile</code> using the command <code>bundle</code> I get the following error:</p>\n\n<pre><code>$ gem install jekyll -v 3.8.5\nFetching kramdown-1.17.0.gem\nFetching jekyll-3.8.5.gem\nFetching sass-listen-4.0.0.gem\nFetching sass-3.7.4.gem\nFetching jekyll-sass-converter-1.5.2.gem\nFetching i18n-0.9.5.gem\nSuccessfully installed kramdown-1.17.0\nSuccessfully installed sass-listen-4.0.0\n\nRuby Sass has reached end-of-life and should no longer be used.\n\n* If you use Sass as a command-line tool, we recommend using Dart Sass, the new\n  primary implementation: https://sass-lang.com/install\n\n* If you use Sass as a plug-in for a Ruby web framework, we recommend using the\n  sassc gem: https://github.com/sass/sassc-ruby#readme\n\n* For more details, please refer to the Sass blog:\n  https://sass-lang.com/blog/posts/7828841\n\nSuccessfully installed sass-3.7.4\nSuccessfully installed jekyll-sass-converter-1.5.2\nSuccessfully installed i18n-0.9.5\nSuccessfully installed jekyll-3.8.5\nParsing documentation for kramdown-1.17.0\nInstalling ri documentation for kramdown-1.17.0\nParsing documentation for sass-listen-4.0.0\nInstalling ri documentation for sass-listen-4.0.0\nParsing documentation for sass-3.7.4\nInstalling ri documentation for sass-3.7.4\nParsing documentation for jekyll-sass-converter-1.5.2\nInstalling ri documentation for jekyll-sass-converter-1.5.2\nParsing documentation for i18n-0.9.5\nInstalling ri documentation for i18n-0.9.5\nParsing documentation for jekyll-3.8.5\nInstalling ri documentation for jekyll-3.8.5\nDone installing documentation for kramdown, sass-listen, sass, jekyll-sass-converter, i18n, jekyll after 8 seconds\n6 gems installed\n</code></pre>\n\n<p>ok fine I'll try to update and I do <code>bundle update</code>:</p>\n\n<pre><code>$ bundle update\nFetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies....\nBundler could not find compatible versions for gem \"jekyll\":\n  In Gemfile:\n    github-pages was resolved to 4, which depends on\n      jekyll (= 1.1.2)\n\n    jekyll-feed (~&gt; 0.12) was resolved to 0.12.1, which depends on\n      jekyll (&gt;= 3.7, &lt; 5.0)\n\nBundler could not find compatible versions for gem \"jekyll-feed\":\n  In Gemfile:\n    github-pages was resolved to 36, which depends on\n      jekyll-feed (= 0.2.3)\n\n    minima (~&gt; 2.5) was resolved to 2.5.0, which depends on\n      jekyll-feed (~&gt; 0.9)\n\nBundler could not find compatible versions for gem \"tzinfo\":\n  In Gemfile:\n    tzinfo (~&gt; 1.2)\n\n    tzinfo-data was resolved to 1.2019.3, which depends on\n      tzinfo (&gt;= 1.0.0)\n</code></pre>\n\n<p>which gets me stuck...any ideas what to do?</p>\n\n<p>I also tried to follow the instructions in my <code>Gemfile</code> with no success:</p>\n\n<pre><code>$ bundle update github-pages\nCould not find gem 'github-pages'.\n</code></pre>\n\n<p>by running the command they say, I get the error:</p>\n\n<pre><code>$ bundle update github-pages\nCould not find gem 'github-pages'.\n</code></pre>\n\n<hr>\n\n<p>I also ran this <code>bundle install</code>:</p>\n\n<pre><code>$ bundle install\nFetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/.\nResolving dependencies...\nBundler could not find compatible versions for gem \"jekyll-feed\":\n  In snapshot (Gemfile.lock):\n    jekyll-feed (= 0.12.1)\n\n  In Gemfile:\n    github-pages was resolved to 36, which depends on\n      jekyll-feed (= 0.2.3)\n\n    minima (~&gt; 2.5) was resolved to 2.5.1, which depends on\n      jekyll-feed (~&gt; 0.9)\n\nRunning `bundle update` will rebuild your snapshot from scratch, using only\nthe gems in your Gemfile, which may resolve the conflict.\n\nBundler could not find compatible versions for gem \"kramdown\":\n  In snapshot (Gemfile.lock):\n    kramdown (= 2.1.0)\n\n  In Gemfile:\n    github-pages was resolved to 8, which depends on\n      kramdown (= 1.0.2)\n\n    minima (~&gt; 2.5) was resolved to 2.5.1, which depends on\n      jekyll-feed (~&gt; 0.9) was resolved to 0.12.1, which depends on\n        jekyll (&gt;= 3.7, &lt; 5.0) was resolved to 4.0.0, which depends on\n          kramdown (~&gt; 2.1)\n\nRunning `bundle update` will rebuild your snapshot from scratch, using only\nthe gems in your Gemfile, which may resolve the conflict.\n\nBundler could not find compatible versions for gem \"minima\":\n  In snapshot (Gemfile.lock):\n    minima (= 2.5.1)\n\n  In Gemfile:\n    minima (~&gt; 2.5)\n\n    github-pages was resolved to 94, which depends on\n      minima (= 1.0.1)\n\nRunning `bundle update` will rebuild your snapshot from scratch, using only\nthe gems in your Gemfile, which may resolve the conflict.\n</code></pre>\n\n<hr>\n\n<p>I also did:</p>\n\n<pre><code>gem install github-pages\n</code></pre>\n\n<p>which installed...not sure if this made things worse...</p>\n\n<hr>\n\n<p>Resources I've used to help me:</p>\n\n<ul>\n<li><a href=\"https://github.com/github/pages-gem/issues/577\" rel=\"noreferrer\">https://github.com/github/pages-gem/issues/577</a></li>\n<li><a href=\"https://github.com/github/pages-gem/issues/555\" rel=\"noreferrer\">https://github.com/github/pages-gem/issues/555</a></li>\n<li><a href=\"https://talk.jekyllrb.com/t/unlock-bundle-from-jekyll-version/3508\" rel=\"noreferrer\">https://talk.jekyllrb.com/t/unlock-bundle-from-jekyll-version/3508</a></li>\n<li><a href=\"https://stackoverflow.com/questions/24223567/how-can-i-install-an-older-version-of-jekyll\">How can I install an older version of Jekyll?</a></li>\n<li><a href=\"https://github.com/github/pages-gem/issues/651\" rel=\"noreferrer\">https://github.com/github/pages-gem/issues/651</a></li>\n<li><a href=\"https://help.github.com/en/github/working-with-github-pages/creating-a-github-pages-site-with-jekyll#creating-your-site\" rel=\"noreferrer\">https://help.github.com/en/github/working-with-github-pages/creating-a-github-pages-site-with-jekyll#creating-your-site</a></li>\n</ul>\n\n<p>but none have solved my issue yet.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 512, "user_id": 1852466, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/slLNx.jpg?s=128&g=1", "display_name": "Don", "link": "https://stackoverflow.com/users/1852466/don"}, "is_accepted": false, "score": 0, "last_activity_date": 1573324022, "creation_date": 1573324022, "answer_id": 58782280, "question_id": 58598067, "link": "https://stackoverflow.com/questions/58598067/ascii-incompatible-encoding-with-normal-run-not-in-debug-mode/58782280#58782280", "title": "ASCII incompatible encoding with normal run, not in debug mode", "body": "<p>Have you tried printing the default encoding when you run the file as opposed to when you debug the file? There are 3 ways to set / change the encoding in Ruby (that I'm aware of), so I wonder if it's different between running the file and debugging. You should be able to tell by printing the default encoding: <code>puts Encoding.default_external</code>.</p>\n\n<p>As for actually fixing the issue, I ran into a similar problem and found this answer which said to <a href=\"https://stackoverflow.com/a/30087860/1852466\">add bin mode</a> as an option to the <code>File.open</code> call and it worked for me.</p>\n"}], "owner": {"reputation": 123, "user_id": 1047898, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/75eb154a2d05884a8a6a8e54b6eb3deb?s=128&d=identicon&r=PG", "display_name": "Wayne Brissette", "link": "https://stackoverflow.com/users/1047898/wayne-brissette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573324022, "creation_date": 1572295083, "last_edit_date": 1572301813, "question_id": 58598067, "link": "https://stackoverflow.com/questions/58598067/ascii-incompatible-encoding-with-normal-run-not-in-debug-mode", "title": "ASCII incompatible encoding with normal run, not in debug mode", "body": "<p>I'm really confused on this one, and maybe it's a bug in Ruby 2.6.2. I have files that were written as UTF-8 with BOM, so I'm using the following: </p>\n\n<pre><code>filelist = Dir.entries(@input_dirname).join(' ')\nfilelist = filelist.split(' ').grep(/xml/)\n\nfilelist.each do |indfile|\n  filecontents_tmp = File.read(\"#{@input_dirname}/#{indfile}\", :encoding =&gt;'bom|utf-8')\n  puts filecontents_tmp\nend\n</code></pre>\n\n<p>If I put a debug breakpoint at the puts line, my file is read in properly. If I just run the simple script, I get the following error: </p>\n\n<p>in `read': ASCII incompatible encoding needs binmode (ArgumentError)</p>\n\n<p>I'm confused as to why this would work in debug, but not when run normally. Ideas? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simple-form"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572352529, "post_id": 58597900, "comment_id": 103525894, "body": "Are you sure this is not something that you can handle by using CSS instead? Whats the real problem that you are trying to solve?"}, {"owner": {"reputation": 74, "user_id": 11614813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9758babe08fcbda06bcbfc9834c88611?s=128&d=identicon&r=PG&f=1", "display_name": "L1zardK1ng", "link": "https://stackoverflow.com/users/11614813/l1zardk1ng"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572377869, "post_id": 58597900, "comment_id": 103538476, "body": "I can add the span in HTML, but I&#39;d like to DRY up those files if I can. (I&#39;d like this format for all input fields)"}], "owner": {"reputation": 74, "user_id": 11614813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9758babe08fcbda06bcbfc9834c88611?s=128&d=identicon&r=PG&f=1", "display_name": "L1zardK1ng", "link": "https://stackoverflow.com/users/11614813/l1zardk1ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572294245, "creation_date": 1572294245, "question_id": 58597900, "link": "https://stackoverflow.com/questions/58597900/how-to-add-an-empty-span-to-simple-form-wrapper", "title": "How to add an empty span to Simple Form wrapper", "body": "<p>I would like to build a custom wrapper for my input fields using SimpleForm that has an empty span element beneath the label.</p>\n\n<p>I would like the HTML to end up like this: </p>\n\n<pre><code>&lt;div class=\"custom-input\"&gt;\n  &lt;input /&gt;\n  &lt;label /&gt;\n  &lt;span class=\"bar\"/&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>my <code>initializers/simple_form.rb</code> includes this:</p>\n\n<pre><code>config.wrappers :custom_input, tag: 'div', class: \"custom-input\" do |b|\n    b.use :html5\n    b.optional :placeholder\n    b.optional :maxlength\n    b.optional :minlength\n    b.optional :pattern\n    b.optional :min_max\n    b.optional :readonly\n    b.wrapper tag: 'span', class: 'bar' do |ba|\n      ba.use :input\n      ba.use :label\n    end\n    b.use :error, wrap_with: { tag: 'span', class: 'help-block' }\nend\n</code></pre>\n\n<p>This wraps the input and label in a span, but I would like the span to be below the label. </p>\n\n<p>I have tried building a custom simple form component without any luck.</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["ruby", "puppet"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 2, "creation_date": 1572289594, "post_id": 58596609, "comment_id": 103506589, "body": "Does the regex need to exclude the combinations <code>01a</code> and <code>01b</code> explicitly? Or is the intent to exclude everything that is followed by a letter (<code>01c</code>, <code>04z</code>, <code>10a</code>)? Could you provide a scenario that is not excluded? Are <code>dev-123456-01c.test-cloud.prod.puppet</code> and <code>ev-123456-01.test-cloud.prod.puppet</code> valid for example?"}, {"owner": {"reputation": 39, "user_id": 11610220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa08c713593ad066ae189dd7c5bff6ef?s=128&d=identicon&r=PG&f=1", "display_name": "tafz", "link": "https://stackoverflow.com/users/11610220/tafz"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1572292238, "post_id": 58596609, "comment_id": 103507629, "body": "It is the first case where I only need to exclude 01a or 01b."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572295313, "post_id": 58596609, "comment_id": 103508797, "body": "When addressing questions that seek to clarify the question it is always best to edit your answer, rather than elaborating in comments. For one, not all readers read all comments. Questions should be self-contained. Additional examples would be helpful here. Please show the desired return value for each. &quot;Exclude&quot; is not clear."}, {"owner": {"reputation": 39, "user_id": 11610220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa08c713593ad066ae189dd7c5bff6ef?s=128&d=identicon&r=PG&f=1", "display_name": "tafz", "link": "https://stackoverflow.com/users/11610220/tafz"}, "edited": false, "score": 0, "creation_date": 1572296676, "post_id": 58596609, "comment_id": 103509307, "body": "I have updated my question and hope it is clear now."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572298626, "post_id": 58596609, "comment_id": 103509979, "body": "Note that <code>&quot;de|f&quot;.match?(&#47;[a|b]&#47;) #=&gt; true</code>. You want <code>[ab]</code> or <code>(?:a|b)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1572298322, "post_id": 58598627, "comment_id": 103509867, "body": "I&#39;m not sure what letters are allowed. If only <code>a</code> and <code>b</code> are allowed simply replace <code>[a-z]</code> with <code>[ab]</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572298707, "post_id": 58598627, "comment_id": 103510001, "body": "Good answer. Would you take $50 for the artwork? How did you produce that? (It doesn&#39;t look like a regex site.)"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572301307, "post_id": 58598627, "comment_id": 103510812, "body": "@CarySwoveland <a href=\"https://regexper.com/\" rel=\"nofollow noreferrer\">regexper.com</a> exported a SVG and uploaded it to <a href=\"https://svgshare.com\" rel=\"nofollow noreferrer\">svgshare.com</a> since SO doesn&#39;t allow SVG uploads."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572301990, "post_id": 58598627, "comment_id": 103510997, "body": "I noticed that you can alternatively download files from regexper.com in &quot;.png&quot; format. Those files can be uploaded directly to SO."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572302371, "post_id": 58598627, "comment_id": 103511106, "body": "I know, but I prefer the &quot;.svg&quot; format since it&#39;s rendered on the client machine and therefore should be sharper and scale better with 4k screens. This does bring the risk of the URL eventually being broken, but if/when that happens I can always generate a &quot;.png&quot; and upload it to SO directly."}, {"owner": {"reputation": 39, "user_id": 11610220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa08c713593ad066ae189dd7c5bff6ef?s=128&d=identicon&r=PG&f=1", "display_name": "tafz", "link": "https://stackoverflow.com/users/11610220/tafz"}, "edited": false, "score": 0, "creation_date": 1572353404, "post_id": 58598627, "comment_id": 103526314, "body": "First of all thank you  3limin4t0r for giving such a detailed answer. Your solution is close but as you rightly said my intention was to exclude &#39;00&#39; but not to exclude 20,30,40 etc. In our environment for the time being the machine nomenclature will only include &#39;a&#39; or &#39;b&#39; would be used . So I believe [ab] would suffice."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 39, "user_id": 11610220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa08c713593ad066ae189dd7c5bff6ef?s=128&d=identicon&r=PG&f=1", "display_name": "tafz", "link": "https://stackoverflow.com/users/11610220/tafz"}, "edited": false, "score": 0, "creation_date": 1572357443, "post_id": 58598627, "comment_id": 103528526, "body": "@tafz <code>(?!00|01[ab])\\d{2}[ab]</code> would then meet the requirements. Which excludes <code>00</code>, <code>01a</code> and <code>01b</code>. This replaces the following part of the regex <code>(?!01[ab])[0-9][1-9][a-z]</code>"}, {"owner": {"reputation": 39, "user_id": 11610220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa08c713593ad066ae189dd7c5bff6ef?s=128&d=identicon&r=PG&f=1", "display_name": "tafz", "link": "https://stackoverflow.com/users/11610220/tafz"}, "edited": false, "score": 0, "creation_date": 1572359592, "post_id": 58598627, "comment_id": 103529699, "body": "Ah yes! . Thanks"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 2, "last_activity_date": 1572301675, "last_edit_date": 1572301675, "creation_date": 1572298060, "answer_id": 58598627, "question_id": 58596609, "link": "https://stackoverflow.com/questions/58596609/defining-nodes-adjust-regex-to-exclude-certain-nodes/58598627#58598627", "title": "Defining Nodes. Adjust Regex to exclude certain nodes", "body": "<p>Something like this should do the trick:</p>\n\n<pre><code>/^dev-\\d{6}-(?!01[ab])[0-9][1-9][a-z]\\.test-cloud\\.prod\\.puppet$/\n</code></pre>\n\n<p><a href=\"https://svgshare.com/i/FmK.svg\" rel=\"nofollow noreferrer\"><img src=\"https://svgshare.com/i/FmK.svg\" alt=\"regex graph\"></a></p>\n\n<p>This still allows the generic regex <code>[0-9][1-9][a-z]</code> but exludes <code>01a</code> and <code>01b</code> up front (with <code>(?!01[ab])</code>). Reason for this is to keep the regex relatively clean. The alternative is something like <code>(01[c-z]|(0[2-9]|[1-9][1-9])[a-z])</code> instead of <code>(?!01[ab])[0-9][1-9][a-z]</code> which is a lot harder to maintain.</p>\n\n<p>Note that <code>[0-9][1-9]</code> does exclude <code>00</code> (which I believe is your intention), but also excludes <code>20</code>, <code>30</code>, ... <code>90</code> which might not be your intention.</p>\n"}], "owner": {"reputation": 39, "user_id": 11610220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa08c713593ad066ae189dd7c5bff6ef?s=128&d=identicon&r=PG&f=1", "display_name": "tafz", "link": "https://stackoverflow.com/users/11610220/tafz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58598627, "answer_count": 1, "score": 0, "last_activity_date": 1572301675, "creation_date": 1572287872, "last_edit_date": 1572296378, "question_id": 58596609, "link": "https://stackoverflow.com/questions/58596609/defining-nodes-adjust-regex-to-exclude-certain-nodes", "title": "Defining Nodes. Adjust Regex to exclude certain nodes", "body": "<p>I am making node definitions in puppet. Need little help with regex. Currently this is what I am using </p>\n\n<pre><code>node /^[d][e][v]-\\d{6}-[0-9][1-9][a|b].test-cloud.prod.puppet$/\n</code></pre>\n\n<p>I want puppet not to run its catalog with this cert having the <code>01a</code> or <code>01b</code>. Like the example shown below. </p>\n\n<p>(I don't want Puppet to run on the machines having these certs)</p>\n\n<p><code>dev-123456-01a.test-cloud.prod.puppet</code> \n<code>dev-999999-01b.test-cloud.prod.puppet</code>\n<code>dev-000001-01a.test-cloud.prod.puppet</code> </p>\n\n<p>(Puppet needs to runs on the machines having these certs)</p>\n\n<p><code>dev-123456-02a.test-cloud.prod.puppet</code> \n<code>dev-999999-11b.test-cloud.prod.puppet</code>\n<code>dev-000001-03a.test-cloud.prod.puppet</code> </p>\n\n<p>I hope my explanation is clear now. Probably there is a simple solution to this but can't figure out.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1572287135, "post_id": 58596349, "comment_id": 103505600, "body": "Can you show what kind of data structure is <code>director_data</code>? I would guess that hash keys are not symbols"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 1, "creation_date": 1572287480, "post_id": 58596349, "comment_id": 103505780, "body": "check this url: <a href=\"https://stackoverflow.com/q/58549777/2190621\">stackoverflow.com/q/58549777/2190621</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1572290777, "creation_date": 1572290777, "answer_id": 58597221, "question_id": 58596349, "link": "https://stackoverflow.com/questions/58596349/what-argument-should-pass-to-other-method/58597221#58597221", "title": "What argument should pass to other method", "body": "<p>When you call <code>gross_for_director</code>, you should pass <code>nds[name_index]</code> because it needs something that it can index with <code>:movies</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 2121639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nPhXq.jpg?s=128&g=1", "display_name": "Fitzlegit", "link": "https://stackoverflow.com/users/2121639/fitzlegit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 58597221, "answer_count": 1, "score": 0, "last_activity_date": 1572328529, "creation_date": 1572286751, "last_edit_date": 1572328529, "question_id": 58596349, "link": "https://stackoverflow.com/questions/58596349/what-argument-should-pass-to-other-method", "title": "What argument should pass to other method", "body": "<p>I'm trying to figure out what argument should be passed to the <code>directors_total</code> method in order to return the results of <code>gross_for_director</code>.</p>\n\n<p>I've tried plugging in different parameters with various error results.</p>\n\n<pre><code>require 'directors_database'\nrequire 'pp'\nrequire 'pry'\n\n# Write a method that, given an NDS creates a new Hash\n# The return value should be like:\n#\n# { directorOne =&gt; allTheMoneyTheyMade, ... }\n\ndef directors_totals(nds)\n  result = {}\n  name_index = 0\n  director = nds[name_index][:name]\n  result[director] = 0\n  while name_index &lt; nds.length do\n    result[director] += gross_for_director(gross_total)\n\n    name_index += 1\n  end\n\n  result\nend\n\n# Find a way to accumulate the :worldwide_grosses and return that Integer\n# using director_data as input\ndef gross_for_director(director_data)\n  mov_index = 0\n  gross_total = 0\n  while mov_index &lt; director_data[:movies].length do\n    gross_total += director_data[:movies][mov_index][:worldwide_gross]\n\n    mov_index += 1\n  end\n  gross_total\nend\n\n</code></pre>\n\n<p>The <code>directors_database</code> method can be processed by the <code>directors_totals</code> method which returns a <em>Hash</em> describing director to total.</p>\n\n<pre><code>Failure/Error:\n   while mov_index &lt; director_data[:movies].length do\n     gross_total += director_data[:movies][mov_index][:worldwide_gross]\n\n     mov_index += 1\n   end\n\n TypeError:\n   no implicit conversion of Symbol into Integer\n</code></pre>\n\n<p>director_ data</p>\n\n<pre><code>   {:name=&gt;\"Stephen Spielberg\",\n :movies=&gt;\n  [{:title=&gt;\"Jaws\",\n    :studio=&gt;\"Universal\",\n    :worldwide_gross=&gt;260000000,\n    :release_year=&gt;1975},\n   {:title=&gt;\"Close Encounters of the Third Kind\",\n    :studio=&gt;\"Columbia\",\n    :worldwide_gross=&gt;135189114,\n    :release_year=&gt;1977},\n   {:title=&gt;\"Raiders of the Lost Ark\",\n    :studio=&gt;\"Paramount\",\n    :worldwide_gross=&gt;248159971,\n    :release_year=&gt;1981},\n   {:title=&gt;\"E.T. the Extra-terrestrial\",\n    :studio=&gt;\"Universal\",\n    :worldwide_gross=&gt;435110554,\n    :release_year=&gt;1982},\n   {:title=&gt;\"Schindler's List\",\n    :studio=&gt;\"Universal\",\n    :worldwide_gross=&gt;96898818,\n    :release_year=&gt;1993},\n   {:title=&gt;\"Lincoln\",\n    :studio=&gt;\"Buena Vista\",\n    :worldwide_gross=&gt;182207973,\n    :release_year=&gt;2012}]}\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-6", "zeitwerk"], "answers": [{"comments": [{"owner": {"reputation": 14303, "user_id": 29493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bb15b284510700d32de5a68f190c6dc?s=128&d=identicon&r=PG", "display_name": "Tim Scott", "link": "https://stackoverflow.com/users/29493/tim-scott"}, "edited": false, "score": 0, "creation_date": 1572300435, "post_id": 58595911, "comment_id": 103510572, "body": "I would assume that the same issue will happen for everything in lib. I don&#39;t think I want to move my whole lib into app. There must be a way to autoload from lib, right?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 14303, "user_id": 29493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bb15b284510700d32de5a68f190c6dc?s=128&d=identicon&r=PG", "display_name": "Tim Scott", "link": "https://stackoverflow.com/users/29493/tim-scott"}, "edited": false, "score": 1, "creation_date": 1572302438, "post_id": 58595911, "comment_id": 103511119, "body": "You can add it to the auto-load path but the best approach is to put it into <code>app&#47;</code> where it belongs. The old <code>lib&#47;</code> approach is bound to be deprecated soon and is <a href=\"https://stackoverflow.com/questions/38198668/rails-5-load-lib-files-in-production\">not without problems</a>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1572284635, "creation_date": 1572284635, "answer_id": 58595911, "question_id": 58595865, "link": "https://stackoverflow.com/questions/58595865/rails-6-autoload-not-finding-class/58595911#58595911", "title": "Rails 6 Autoload Not Finding Class", "body": "<p>If you can, locate your auto-loading code in <code>app/</code>. As of Rails 6 everything in there will be automatically part of the auto-load path. Rails 5 was more selective.</p>\n\n<p>In this case call it: <code>app/notifications/notification/auto_thank.rb</code></p>\n\n<p>The first part of the path is ignored. The second (optional) part is the namespace.</p>\n\n<blockquote>\n  <p>Note that to get this to show up in the auto-loader you may need to stop the Spring process with <code>spring stop</code>. This must be done any time you introduce a new <code>app/...</code> path.</p>\n</blockquote>\n"}], "owner": {"reputation": 14303, "user_id": 29493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bb15b284510700d32de5a68f190c6dc?s=128&d=identicon&r=PG", "display_name": "Tim Scott", "link": "https://stackoverflow.com/users/29493/tim-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2112, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1572284635, "creation_date": 1572284452, "question_id": 58595865, "link": "https://stackoverflow.com/questions/58595865/rails-6-autoload-not-finding-class", "title": "Rails 6 Autoload Not Finding Class", "body": "<p>I'm attempting to upgrade from Rails 5 to 6. I did the upgrade steps including adding this:</p>\n\n<pre><code># config/application.rb\nconfig.load_defaults 6.0\n</code></pre>\n\n<p>I have this class:</p>\n\n<pre><code># lib/notification/auto_thank.rb\nmodule Notification\n  class AutoThank\n    def perform\n      # stuff\n    end\n  end\nend\n</code></pre>\n\n<p>Which is used in a task:</p>\n\n<pre><code>namespace :notify do\n  task auto_thank: :environment do\n    Notification::AutoThank.new.perform\n  end\nend\n</code></pre>\n\n<p>When I do <code>puts config.autoload_paths</code>, it's listed, so I expect it to autoload:</p>\n\n<p><code>/my/app/path/lib/notification/auto_thank.rb</code></p>\n\n<p>But when I run the task I get an error:</p>\n\n<blockquote>\n  <p>NameError: uninitialized constant Notification</p>\n</blockquote>\n\n<p>It gets stranger. When I add a require to the task:</p>\n\n<pre><code>task auto_thank: :environment do\n  require '/my/app/path/lib/notification/auto_thank.rb'\n  Notification::AutoThank.new.perform\nend\n</code></pre>\n\n<p>I get a different error:</p>\n\n<blockquote>\n  <p>NameError: expected file /my/app/path/lib/notification/auto_thank.rb to define constant AutoThank, but didn't</p>\n</blockquote>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby", "amazon-web-services"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1572286862, "post_id": 58595808, "comment_id": 103505489, "body": "Did you run <a href=\"https://bundler.io/v2.0/man/bundle-install.1.html\" rel=\"nofollow noreferrer\"><code>bundle install</code></a> to install the gems defined in the Gemfile?"}], "answers": [{"tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": true, "score": 2, "last_activity_date": 1572635279, "last_edit_date": 1572635279, "creation_date": 1572289751, "answer_id": 58596998, "question_id": 58595808, "link": "https://stackoverflow.com/questions/58595808/how-to-use-a-gem-in-aws-with-ruby/58596998#58596998", "title": "How to use a Gem in aws with Ruby?", "body": "<p>Need to bundle non-aws gems into local vendor folder and then zip up those dependencies to be included, i.e.</p>\n\n<pre><code>bundle install --path vendor/bundle  # &lt;-- Note using path\n\nzip -r function.zip lambda_function.rb vendor/ # &lt;-- vendor/ for the dependencies\n\naws lambda update-function-code --function-name myFunction \\\n--zip-file fileb://function.zip --region 'us-east-2' # &lt;= your region\n</code></pre>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 58596998, "answer_count": 1, "score": 2, "last_activity_date": 1572635279, "creation_date": 1572284242, "question_id": 58595808, "link": "https://stackoverflow.com/questions/58595808/how-to-use-a-gem-in-aws-with-ruby", "title": "How to use a Gem in aws with Ruby?", "body": "<p>I want to use gem <code>httparty</code> (as an example)</p>\n\n<p>I added a Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'httparty'\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ARulU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ARulU.png\" alt=\"enter image description here\"></a></p>\n\n<p>My lambda code has:</p>\n\n<pre><code>...\nrequire 'httparty'\n</code></pre>\n\n<p>and I call it with</p>\n\n<pre><code>response = Net::HTTParty.get('example.com', '/index.html')\n</code></pre>\n\n<p>but the initial <code>require</code> is getting</p>\n\n<pre><code>{\n  \"errorMessage\": \"cannot load such file -- httparty\",\n  \"errorType\": \"Init&lt;LoadError&gt;\",\n  \"stackTrace\": [\n    \"/var/lang/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\",\n    \"/var/lang/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\",\n    \"/var/task/lambda_function.rb:3:in `&lt;top (required)&gt;'\",\n    \"/var/lang/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\",\n    \"/var/lang/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\"\n  ]\n}\n</code></pre>\n"}, {"tags": ["ruby", "rails-activestorage"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1572283458, "creation_date": 1572283458, "answer_id": 58595625, "question_id": 58595456, "link": "https://stackoverflow.com/questions/58595456/undefined-method-image-for-nilclass/58595625#58595625", "title": "undefined method &#39;image&#39; for nil:class", "body": "<p>When you do this:</p>\n\n<pre><code>&lt;% @imagelists.each  do |il| %&gt;\n</code></pre>\n\n<p>You are defining a variable <code>il</code> which is available within that <code>each</code> block.</p>\n\n<p>However, in your code you are referencing <code>@il</code> - an instance variable which doesn't exist. Unlike a normal variable, when you reference an instance variable which isn't defined, you just get <code>nil</code>, not a <code>NoMethodError</code>.</p>\n\n<p>So, just use <code>il</code> instead of <code>@il</code> and you'll be fine.</p>\n"}], "owner": {"reputation": 13, "user_id": 6062659, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3cQ_58wo_M/AAAAAAAAAAI/AAAAAAAAAHY/qI-khgcGUfs/photo.jpg?sz=128", "display_name": "Scott M", "link": "https://stackoverflow.com/users/6062659/scott-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 58595625, "answer_count": 1, "score": 0, "last_activity_date": 1572283458, "creation_date": 1572282778, "question_id": 58595456, "link": "https://stackoverflow.com/questions/58595456/undefined-method-image-for-nilclass", "title": "undefined method &#39;image&#39; for nil:class", "body": "<p>Im trying to display all the images from active storage on an index page. Note: The image will display in the show page</p>\n\n<p>Heres what i have on the index page:</p>\n\n<pre><code>&lt;% @imagelists.each  do |il| %&gt;\n &lt;%= image_tag(@il.image) &amp;&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I can do the following which shows the active storage data</p>\n\n<pre><code>&lt;% @imagelists.each  do |il| %&gt;\n &lt;%= @il.image &amp;&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "model", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1572289215, "creation_date": 1572289215, "answer_id": 58596885, "question_id": 58595347, "link": "https://stackoverflow.com/questions/58595347/creating-proper-model-associations/58596885#58596885", "title": "Creating proper model associations", "body": "<p>The guide illustrates setting up a one to many association with this example:</p>\n\n<pre><code># Database schema:\n#  artists            albums\n#   :id   &lt;----\\       :id\n#   :name       \\----- :artist_id \n#                      :name\n\nclass Artist &lt; Sequel::Model\n  one_to_many :albums\nend\n\nclass Album &lt; Sequel::Model\n  many_to_one :artist\nend\n</code></pre>\n\n<p>To be honest I have never used Sequel but from guide it seems like you should be doing something like:</p>\n\n<pre><code>class ItemType &lt; Sequel::Model\n  one_to_many :items\nend\n\nclass ItemValue &lt; Sequel::Model\n  one_to_many :items\nend\n\nclass Item &lt; Sequel::Model\n  many_to_one :type, class: 'ItemType', key: 'item_type_id'\n  many_to_one :value, class: 'ItemValue', key: 'item_value_id'\nend\n</code></pre>\n\n<p>Congratulations. You just ported the <a href=\"https://mikesmithers.wordpress.com/2013/12/22/the-anti-pattern-eavil-database-design/\" rel=\"nofollow noreferrer\">EAV anti-pattern</a> to Sequel.</p>\n"}], "owner": {"reputation": 35, "user_id": 11144586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27e1842fc8e17396b1df0a80197e9c87?s=128&d=identicon&r=PG", "display_name": "Lucky The Rabbit", "link": "https://stackoverflow.com/users/11144586/lucky-the-rabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572289215, "creation_date": 1572282327, "question_id": 58595347, "link": "https://stackoverflow.com/questions/58595347/creating-proper-model-associations", "title": "Creating proper model associations", "body": "<p>Using the ruby <a href=\"https://github.com/jeremyevans/sequel\" rel=\"nofollow noreferrer\">sequel</a> gem, I have a small (sqlite3) database with the following schema:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>db.create_table :item_types do\n  primary_key :id\n  String :name, unique: true, null: false\nend\n\ndb.create_table :item_values do\n  primary_key :id\n  String :name, unique: true, null: false\nend\n\ndb.create_table :items do\n  primary_key :id\n  foreign_key :type, :item_types, key: :id\n  foreign_key :value, :item_values, key: :id\n  String :name, unique: true, null: false\n  String :desc, null: false\nend\n</code></pre>\n\n<p>Ideally, I'd like to be able to be able to use similar to</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>item = Item.first(...)\nputs item.type.name, item.value.name\n</code></pre>\n\n<p>Reading through the <a href=\"https://github.com/jeremyevans/sequel/blob/master/doc/association_basics.rdoc\" rel=\"nofollow noreferrer\">association</a> guide, it looks like I need a <code>one_to_one</code> association in the <code>Item</code> model for <code>item_types</code> and <code>item_values</code>. However, I'm not sure of the proper way to link them. Should the foreign key be passed via the <code>key</code> option, or is there a more appropriate method?</p>\n"}, {"tags": ["ruby", "sorbet"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 11683165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efa4bd57caed2912cf894bb8357c3ad4?s=128&d=identicon&r=PG&f=1", "display_name": "aysamanra", "link": "https://stackoverflow.com/users/11683165/aysamanra"}, "is_accepted": true, "score": 0, "last_activity_date": 1572283486, "creation_date": 1572283486, "answer_id": 58595635, "question_id": 58593924, "link": "https://stackoverflow.com/questions/58593924/sorbet-concrete-type-when-inheriting-from-generic-class/58595635#58595635", "title": "Sorbet - concrete type when inheriting from generic class", "body": "<p>You can use</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Elem = type_member(fixed: String)\n</code></pre>\n\n<p>Re-declaring the parent's type member is already obligatory (which you can see in the error message on your code snippet, which says <code>Type Elem declared by parent Array must be re-declared in NameList</code>) and re-declaring it with the <code>fixed:</code> parameter allows that type parameter to be specified as a concrete type.</p>\n\n<p><a href=\"https://sorbet.run/#%23%20typed%3A%20strict%0A%0A%0Aclass%20NameList%20%3C%20Array%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20Elem%20%3D%20type_member(fixed%3A%20String)%0A%0A%20%20sig%20%7Bparams(names%3A%20T%3A%3AArray%5BString%5D).void%7D%0A%20%20def%20initialize(names)%0A%20%20%20%20names.each%20%7B%20%7Cn%7C%20self%20%3C%3C%20n%7D%0A%20%20end%0A%0A%20%20sig%20%7Breturns(String)%7D%0A%20%20def%20csv%0A%20%20%20%20(map%20%7B%20%7Cn%7C%20n.join(&#39;%2C&#39;)%20%7D).join(%22%5Cn%22)%0A%20%20end%0Aend%0A%0A%0Anl%20%3D%20NameList.new(%5B&#39;Bruce&#39;%2C%20&#39;Clark&#39;%2C%20&#39;Peter&#39;%5D)%0A%0A%23%20Output%20length%20of%20first%20name.%0Aputs(nl.first%26.size)%20%20%23%20String%23size%0Aputs(nl.first%26.sizee)%20%20%23%20misspelled%20size%20-%20should%20be%20an%20error%0A\" rel=\"nofollow noreferrer\">\u2192 View on sorbet.run</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># typed: strict\n\nclass NameList &lt; Array\n  extend T::Sig\n\n  Elem = type_member(fixed: String)\n\n  sig {params(names: T::Array[String]).void}\n  def initialize(names)\n    names.each { |n| self &lt;&lt; n}\n  end\n\n  sig {returns(String)}\n  def csv\n    (map { |n| n.join(',') }).join(\"\\n\")  # Method `join` does not exist on String\n  end\nend\n\n\nnl = NameList.new(['Bruce', 'Clark', 'Peter'])\n\n# Output length of first name.\nputs(nl.first&amp;.size)\nputs(nl.first&amp;.sizee)  # Method `sizee` does not exist on String\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11915326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd470c08bdb0e32b6ce69f549a4641f?s=128&d=identicon&r=PG&f=1", "display_name": "md-work", "link": "https://stackoverflow.com/users/11915326/md-work"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 58595635, "answer_count": 1, "score": 0, "last_activity_date": 1572283486, "creation_date": 1572277109, "question_id": 58593924, "link": "https://stackoverflow.com/questions/58593924/sorbet-concrete-type-when-inheriting-from-generic-class", "title": "Sorbet - concrete type when inheriting from generic class", "body": "<p>How can I specify <code>String</code> for the generic type?</p>\n\n<p><a href=\"https://sorbet.run/#%23%20typed%3A%20strict%0A%0A%0Aclass%20NameList%20%3C%20Array%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Bparams(names%3A%20T%3A%3AArray%5BString%5D).void%7D%0A%20%20def%20initialize(names)%0A%20%20%20%20names.each%20%7B%20%7Cn%7C%20self%20%3C%3C%20n%7D%0A%20%20end%0A%0A%20%20sig%20%7Breturns(String)%7D%0A%20%20def%20csv%0A%20%20%20%20(map%20%7B%20%7Cn%7C%20n.join(&#39;%2C&#39;)%20%7D).join(%22%5Cn%22)%0A%20%20end%0Aend%0A%0A%0Anl%20%3D%20NameList.new(%5B&#39;Bruce&#39;%2C%20&#39;Clark&#39;%2C%20&#39;Peter&#39;%5D)%0A%0A%23%20Output%20length%20of%20first%20name.%0Aputs(nl.first%26.size)%20%20%23%20String%23size%0Aputs(nl.first%26.sizee)%20%20%23%20misspelled%20size%20-%20should%20be%20an%20error%0A\" rel=\"nofollow noreferrer\">\u2192 View on sorbet.run</a></p>\n\n<pre><code># typed: strict\n\n\nclass NameList &lt; Array\n  extend T::Sig\n\n  sig {params(names: T::Array[String]).void}\n  def initialize(names)\n    names.each { |n| self &lt;&lt; n}\n  end\n\n  sig {returns(String)}\n  def csv\n    (map { |n| n.join(',') }).join(\"\\n\")\n  end\nend\n\n\nnl = NameList.new(['Bruce', 'Clark', 'Peter'])\n\n# Output length of first name.\nputs(nl.first&amp;.size)  # String#size\nputs(nl.first&amp;.sizee)  # misspelled size - should be an error\n\n# Sorbet-Static output:\n# editor.rb:4: Type Elem declared by parent Array must be re-declared in NameList https://srb.help/5036\n#      4 |class NameList &lt; Array\n#         ^^^^^^^^^^^^^^^^^^^^^^\n#     https://github.com/sorbet/sorbet/tree/master/rbi/core/array.rbi#L350: Elem declared in parent here\n#      350 |  Elem = type_member(:out)\n#             ^^^^^^^^^^^^^^^^^^^^^^^^\n# Errors: 1\n</code></pre>\n"}, {"tags": ["ruby", "selenium"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3531858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1364070204/picture?type=large", "display_name": "user3531858", "link": "https://stackoverflow.com/users/3531858/user3531858"}, "edited": false, "score": 0, "creation_date": 1572278499, "post_id": 58593699, "comment_id": 103501581, "body": "From what I&#39;m finding online, the [:command, &quot;a&quot;] does not work with a chrome browser.  I tried it with my script and didn&#39;t have any luck either."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 145, "user_id": 3531858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1364070204/picture?type=large", "display_name": "user3531858", "link": "https://stackoverflow.com/users/3531858/user3531858"}, "edited": false, "score": 0, "creation_date": 1572278533, "post_id": 58593699, "comment_id": 103501602, "body": "Oh okay. Then I am sorry, I don&#39;t have any way to check for mac OS."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1572276260, "creation_date": 1572276260, "answer_id": 58593699, "question_id": 58593487, "link": "https://stackoverflow.com/questions/58593487/how-do-i-select-all-in-selenium-using-ruby-on-a-mac/58593699#58593699", "title": "How Do I Select All in Selenium using Ruby on a Mac", "body": "<p>Yes, it's possible.</p>\n\n<p>In windows, I will write the following code</p>\n\n<pre><code>driver.find_element(name: 'q').send_keys 'rajagopalan',[:control,\"a\"]\n</code></pre>\n\n<p><code>[:control,\"a\"]</code> actually select the whole text, likewise, you may try to for mac using <code>[:command,\"a\"]</code></p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572283991, "post_id": 58593703, "comment_id": 103504272, "body": "Selenium is a Ruby scripting environment for the browser. The question is how to emulate what you&#39;re saying, not how to select all text."}], "tags": [], "owner": {"reputation": 3571, "user_id": 11061080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a9089f9f4f8f14b04d3d8dfe51e7c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dipak Bachhav", "link": "https://stackoverflow.com/users/11061080/dipak-bachhav"}, "is_accepted": false, "score": 0, "last_activity_date": 1572345808, "last_edit_date": 1572345808, "creation_date": 1572276274, "answer_id": 58593703, "question_id": 58593487, "link": "https://stackoverflow.com/questions/58593487/how-do-i-select-all-in-selenium-using-ruby-on-a-mac/58593703#58593703", "title": "How Do I Select All in Selenium using Ruby on a Mac", "body": "<p>Use Command (or Cmd) \u2318 -A from your keyboard  to select all text</p>\n"}], "owner": {"reputation": 145, "user_id": 3531858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1364070204/picture?type=large", "display_name": "user3531858", "link": "https://stackoverflow.com/users/3531858/user3531858"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572345808, "creation_date": 1572275411, "last_edit_date": 1572277400, "question_id": 58593487, "link": "https://stackoverflow.com/questions/58593487/how-do-i-select-all-in-selenium-using-ruby-on-a-mac", "title": "How Do I Select All in Selenium using Ruby on a Mac", "body": "<p>Using: Selenium, Ruby, Mac, Chrome</p>\n\n<p>Problem:  I'm trying to do a simple command 'a' to select the text in a field.</p>\n\n<p>Originally I was doing a control 'a', sorry I'm new to mac.  Now that I know it's command 'a', I can't seem to find any ruby code to press the command button.  </p>\n\n<p>If someone can point me to a related issue, or tell me if it's actually possible, I'd appreciate it.</p>\n\n<pre><code> #Example Code \n #Change the value in the First Name Field\n #\n driver.find_element(:name,\"fname\").send_keys 'Bob'\n driver.find_element(:name,\"fname\").send_keys [:command,\"a\"]\n driver.find_element(:name,\"fname\").send_keys 'Tom'\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572274984, "post_id": 58593225, "comment_id": 103499643, "body": "Out of curiosity, did you try deleting your <code>Gemfile.lock</code> and then doing <code>bundle update</code>?"}, {"owner": {"reputation": 1, "user_id": 9859729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jAfzRlIVR6U/AAAAAAAAAAI/AAAAAAAAAAA/3zCAZYXqGTY/photo.jpg?sz=128", "display_name": "Konrad Zdzieba", "link": "https://stackoverflow.com/users/9859729/konrad-zdzieba"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572275972, "post_id": 58593225, "comment_id": 103500208, "body": "Hi, thank you for your comment. Yes, I tried that. Unfortunately both bundle update and bundle update rails showing errors."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572278901, "post_id": 58593225, "comment_id": 103501790, "body": "The problem here is pretty straight forward - your gemfile lists a version of simpleform that is not compatble with Rails 4. &quot;but upgrading to newer versions also doesn&#39;t change much&quot; - be more specific. What exactly did you try and what was the result?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572279294, "post_id": 58593225, "comment_id": 103501983, "body": "SimpleForm 3.5.1 depends on ActionPack &#39;&gt; 4&#39;, &#39;&lt; 5.2&#39; and ActionModel &#39;&gt; 4&#39;, &#39;&lt; 5.2&#39; and should be compatible with Rails 4. You can check this yourself by looking at the <a href=\"https://rubygems.org/gems/simple_form/versions/3.5.1\" rel=\"nofollow noreferrer\">releases on Rubygems.org</a>."}, {"owner": {"reputation": 1, "user_id": 9859729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jAfzRlIVR6U/AAAAAAAAAAI/AAAAAAAAAAA/3zCAZYXqGTY/photo.jpg?sz=128", "display_name": "Konrad Zdzieba", "link": "https://stackoverflow.com/users/9859729/konrad-zdzieba"}, "edited": false, "score": 0, "creation_date": 1572281499, "post_id": 58593225, "comment_id": 103503061, "body": "Hi max ! Thank you for your input. I&#39;ve tried simple_form version 3.1 (I&#39;ve edited my question to show the error I&#39;m receiving when trying to bundle)"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572289733, "post_id": 58593225, "comment_id": 103506642, "body": "This is basically just the dependency hell that occurs when updating Rails. You just have to keep working down the list until you have a bundle that works. This is not really something where Stackoverflow is really that useful as its more just a series of tedius steps and not really a fit for the Q&amp;A format."}, {"owner": {"reputation": 1, "user_id": 9859729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jAfzRlIVR6U/AAAAAAAAAAI/AAAAAAAAAAA/3zCAZYXqGTY/photo.jpg?sz=128", "display_name": "Konrad Zdzieba", "link": "https://stackoverflow.com/users/9859729/konrad-zdzieba"}, "edited": false, "score": 0, "creation_date": 1572290526, "post_id": 58593225, "comment_id": 103506967, "body": "Yes, you&#39;re right. Seems like it take a moment to make this upgrade. Thank you for your help!"}], "owner": {"reputation": 1, "user_id": 9859729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jAfzRlIVR6U/AAAAAAAAAAI/AAAAAAAAAAA/3zCAZYXqGTY/photo.jpg?sz=128", "display_name": "Konrad Zdzieba", "link": "https://stackoverflow.com/users/9859729/konrad-zdzieba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572281409, "creation_date": 1572274561, "last_edit_date": 1572281409, "question_id": 58593225, "link": "https://stackoverflow.com/questions/58593225/rails-upgrade-from-3-2-2-5-to-4-0-0-12-problem", "title": "Rails upgrade from 3.2.2.5 to 4.0.0.12 problem", "body": "<p>I am trying to upgrade Rails from version 3.2.22.5 to version 4.0.12. Unfortunately, without success so far. It seems that the problem is Simple form, but upgrading to newer versions also doesn't change much. The application is not written by me. Any help would be greatly appreciated. Thanks in advance. </p>\n\n<p>I've tried different versions of Simple Form gem but no success so far.</p>\n\n<p>My gemfile : </p>\n\n<pre><code>source 'https://rubygems.org'\n\nruby '2.2.10'\ngem 'rails', '4.0.12'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem 'pg', '0.21'\ngem 'carrierwave'\ngem 'devise', '~&gt; 3.4', '&gt;= 3.4.1'\ngem 'mini_magick'\ngem 'nazca', '~&gt; 0.2.0'\ngem 'whenever'\ngem 'quiet_assets', '~&gt; 1.0', '&gt;= 1.0.3'\ngem 'polish'\ngem 'simple_form', '~&gt; 2.1', '&gt;= 2.1.3'\ngem \"nokogiri\", \"1.5.11\"\ngem \"rails_autolink\"\n\ngem \"capistrano\"\ngem \"capistrano-ext\"\ngem \"capistrano_colors\"\ngem \"rvm-capistrano\", require: false\n\ngem \"therubyracer\"\ngem 'cells', '~&gt; 3.11', '&gt;= 3.11.3'\n\ngem \"omniauth-facebook\"\ngem \"koala\"\ngem \"awesome_print\"\n\ngem 'airbrake'\n\ngem 'ransack', '~&gt; 1.5', '&gt;= 1.5.1'\ngem 'kaminari'\ngem 'kaminari-bootstrap'\ngem 'puma'\ngem 'rails4_upgrade', github: 'alindeman/rails4_upgrade'\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\n\nend\n\ngroup :development, :test do\n  gem 'letter_opener', \"1.1.0\"\n  gem 'rspec-rails'\n  gem 'factory_girl_rails'\n  gem 'capybara'\n  gem 'phantomjs'\n\n  gem 'guard'\n  gem 'guard-spork'\n  gem 'guard-rspec'\n  gem 'guard-passenger'\n  gem 'guard-pow'\n  gem \"spork\", '~&gt; 1.0.0.rc'\n  gem 'spork-rails', '~&gt; 4.0'\n  gem \"rb-fsevent\"\nend\n\ngem 'jquery-rails'\ngem 'test-unit'\n\n\n\ngem 'rails_12factor', group: :production\n\ngem \"fog\", \"~&gt; 1.29.0\"\ngem \"figaro\"\ngem \"rollbar\"\n\n\n</code></pre>\n\n<p>Here's the error I'm seeing : </p>\n\n<pre><code>Bundler could not find compatible versions for gem \"actionpack\":\n  In Gemfile:\n    rails (= 4.0.12) was resolved to 4.0.12, which depends on\n      actionpack (= 4.0.12)\n\n    simple_form (~&gt; 2.1, &gt;= 2.1.3) was resolved to 2.1.3, which depends on\n      actionpack (~&gt; 3.0)\n\nBundler could not find compatible versions for gem \"rails\":\n  In Gemfile:\n    rails (= 4.0.12)\n\n    kaminari-bootstrap was resolved to 0.1.3, which depends on\n      rails\n\n    nazca (~&gt; 0.2.0) was resolved to 0.2.0, which depends on\n      rails (&gt;= 3.0)\n\n    rails_autolink was resolved to 1.1.0, which depends on\n      rails (&gt; 3.1)\n\n    spork-rails (~&gt; 4.0) was resolved to 4.0.0, which depends on\n      rails (&gt;= 3.0.0, &lt; 5)\n</code></pre>\n\n<p>EDIT : \nAfter changing simple form gem to version 3.1 and trying to bundle I see the error : </p>\n\n<pre><code>Bundler could not find compatible versions for gem \"actionpack\":\n  In Gemfile:\n    cells (~&gt; 3.11, &gt;= 3.11.3) was resolved to 3.11.3, which depends on\n      actionpack (&gt;= 3.0)\n\n    rails (= 4.0.12) was resolved to 4.0.12, which depends on\n      actionpack (= 4.0.12)\n\n    ransack (~&gt; 1.5, &gt;= 1.5.1) was resolved to 1.8.10, which depends on\n      actionpack (&gt;= 3.0, &lt; 5.2)\n\n    simple_form (~&gt; 3.1) was resolved to 3.5.1, which depends on\n      actionpack (&gt; 4, &lt; 5.2)\n\nBundler could not find compatible versions for gem \"activerecord\":\n  In Gemfile:\n    rails (= 4.0.12) was resolved to 4.0.12, which depends on\n      activerecord (= 4.0.12)\n\n    ransack (~&gt; 1.5, &gt;= 1.5.1) was resolved to 1.8.10, which depends on\n      activerecord (&gt;= 3.0, &lt; 5.2)\n\nBundler could not find compatible versions for gem \"activesupport\":\n  In Gemfile:\n    carrierwave was resolved to 1.3.1, which depends on\n      activesupport (&gt;= 4.0.0)\n\n    rails (= 4.0.12) was resolved to 4.0.12, which depends on\n      activesupport (= 4.0.12)\n\n    ransack (~&gt; 1.5, &gt;= 1.5.1) was resolved to 1.8.10, which depends on\n      activesupport (&gt;= 3.0, &lt; 5.2)\n\n    rspec-rails was resolved to 3.9.0, which depends on\n      activesupport (&gt;= 3.0)\n\nBundler could not find compatible versions for gem \"capistrano\":\n  In Gemfile:\n    capistrano\n\n    capistrano-ext was resolved to 1.2.1, which depends on\n      capistrano (&gt;= 1.0.0)\n\n    rvm-capistrano was resolved to 1.5.6, which depends on\n      capistrano (~&gt; 2.15.4)\n\nBundler could not find compatible versions for gem \"kaminari\":\n  In Gemfile:\n    kaminari\n\n    kaminari-bootstrap was resolved to 3.0.1, which depends on\n      kaminari (&gt;= 0.13.0)\n\nBundler could not find compatible versions for gem \"nokogiri\":\n  In Gemfile:\n    nokogiri (= 1.5.11)\n\n    capybara was resolved to 2.18.0, which depends on\n      nokogiri (&gt;= 1.3.3)\n\n    fog (~&gt; 1.29.0) was resolved to 1.29.0, which depends on\n      nokogiri (~&gt; 1.5, &gt;= 1.5.11)\n\nBundler could not find compatible versions for gem \"rails\":\n  In Gemfile:\n    rails (= 4.0.12)\n\n    kaminari-bootstrap was resolved to 3.0.1, which depends on\n      rails\n\n    nazca (~&gt; 0.2.0) was resolved to 0.2.0, which depends on\n      rails (&gt;= 3.0)\n\n    rails_autolink was resolved to 1.1.6, which depends on\n      rails (&gt; 3.1)\n\n    spork-rails (~&gt; 4.0) was resolved to 4.0.0, which depends on\n      rails (&gt;= 3.0.0, &lt; 5)\n\nBundler could not find compatible versions for gem \"railties\":\n  In Gemfile:\n    rails (= 4.0.12) was resolved to 4.0.12, which depends on\n      railties (= 4.0.12)\n\n    sass-rails (~&gt; 3.2.3) was resolved to 3.2.3, which depends on\n      railties (~&gt; 3.2.0.beta)\n\nBundler could not find compatible versions for gem \"ruby\":\n  In Gemfile:\n    ruby (~&gt; 2.2.10.0)\n\n    capybara was resolved to 3.15.1, which depends on\n      ruby (&gt;= 2.3.0)\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "shrine"], "answers": [{"tags": [], "owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1572275140, "creation_date": 1572275140, "answer_id": 58593407, "question_id": 58593119, "link": "https://stackoverflow.com/questions/58593119/how-to-define-url-x-amz-expires-in-shrine-configuration/58593407#58593407", "title": "How to define url X-AMZ-Expires in Shrine configuration", "body": "<p>Yes, you can do it via the <code>url_options</code> plugin:</p>\n\n<pre><code>Shrine.plugin :url_options, store: { expires_in: 60*60 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "edited": false, "score": 1, "creation_date": 1580284613, "post_id": 59962251, "comment_id": 106042516, "body": "In Shrine 3, the <code>default_url_options</code> plugin has been renamed to just <code>url_options</code>."}], "tags": [], "owner": {"reputation": 4732, "user_id": 670740, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/rlB3k.jpg?s=128&g=1", "display_name": "Vivek S", "link": "https://stackoverflow.com/users/670740/vivek-s"}, "is_accepted": false, "score": -1, "last_activity_date": 1580282703, "creation_date": 1580282703, "answer_id": 59962251, "question_id": 58593119, "link": "https://stackoverflow.com/questions/58593119/how-to-define-url-x-amz-expires-in-shrine-configuration/59962251#59962251", "title": "How to define url X-AMZ-Expires in Shrine configuration", "body": "<p>Adding to the above answer: This has changed recently to default_url_options:</p>\n\n<pre><code>Shrine.plugin :default_url_options, store: { expires_in: 60*60 }\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 58593407, "answer_count": 2, "score": 0, "last_activity_date": 1580282703, "creation_date": 1572274173, "question_id": 58593119, "link": "https://stackoverflow.com/questions/58593119/how-to-define-url-x-amz-expires-in-shrine-configuration", "title": "How to define url X-AMZ-Expires in Shrine configuration", "body": "<p>When we call the method <code>url</code> the value for <code>X-AMZ-Expires</code> can be defined with the argument <code>expires_in</code>. </p>\n\n<p>Is there a way to define this on Shrine's configuration file or in the uploader so that every time I call <code>url</code> I wouldn't need to give the value of <code>expired_in</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "edited": false, "score": 0, "creation_date": 1572272396, "post_id": 58592417, "comment_id": 103498195, "body": "Which gem did you use?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "edited": false, "score": 1, "creation_date": 1572272763, "post_id": 58592417, "comment_id": 103498392, "body": "Rails doesn&#39;t offer a <code>markdown</code> method by default. So @SamyKacimi assumes that you are using some gem or custom code to get things working."}, {"owner": {"reputation": 1, "user_id": 11882148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fmnhs2_L5kw/AAAAAAAAAAI/AAAAAAAAAAc/WRKPcsgfmfs/photo.jpg?sz=128", "display_name": "Odechie-Williams", "link": "https://stackoverflow.com/users/11882148/odechie-williams"}, "edited": false, "score": 0, "creation_date": 1572297885, "post_id": 58592417, "comment_id": 103509702, "body": "i used &#39;redcarpet&#39;, &#39;~&gt; 3.5&#39; , and looking at the answer below looks like i have to write my own helper"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11882148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fmnhs2_L5kw/AAAAAAAAAAI/AAAAAAAAAAc/WRKPcsgfmfs/photo.jpg?sz=128", "display_name": "Odechie-Williams", "link": "https://stackoverflow.com/users/11882148/odechie-williams"}, "edited": false, "score": 0, "creation_date": 1572298005, "post_id": 58594288, "comment_id": 103509750, "body": "i did use &#39;redcarpet&#39;, &#39;~&gt; 3.5&#39;  but didn&#39;t write any helper, thanks a lot,will let u know if any thing happens"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1, "user_id": 11882148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fmnhs2_L5kw/AAAAAAAAAAI/AAAAAAAAAAc/WRKPcsgfmfs/photo.jpg?sz=128", "display_name": "Odechie-Williams", "link": "https://stackoverflow.com/users/11882148/odechie-williams"}, "edited": false, "score": 0, "creation_date": 1572298629, "post_id": 58594288, "comment_id": 103509982, "body": "You don&#39;t have to use a helper, but writing <code>&lt;%= raw Redcarpet::Markdown.new(Redcarpet::Render::HTML).render(@dis&zwnj;&#8203;cussion.content) %&gt;</code> might be a bit cumbersome, and that&#39;s with the use of default options. If you want to change any render options the line is only getting longer."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1572299703, "last_edit_date": 1572299703, "creation_date": 1572278418, "answer_id": 58594288, "question_id": 58592417, "link": "https://stackoverflow.com/questions/58592417/nomethoderror-in-discussionsshow/58594288#58594288", "title": "NoMethodError in Discussions#show", "body": "<p>Rails doesn't include a <code>markdown</code> method. You'll have to use a gem, write something yourself or a combination of the two. You could for example use the <a href=\"https://github.com/vmg/redcarpet\" rel=\"nofollow noreferrer\">redcarpet</a> gem, or one of the other <a href=\"https://www.ruby-toolbox.com/categories/markup_processors\" rel=\"nofollow noreferrer\">markup processor gems</a>.</p>\n\n<p>Then write your own helper using this using this gem.</p>\n\n<pre><code># app/helpers/markdown_helper.rb\nmodule MarkdownHelper\n  MARKDOWN = Redcarpet::Markdown.new(Redcarpet::Render::HTML)\n\n  def markdown(markdown_string)\n    MARKDOWN.render(markdown_string).html_safe\n  end\nend\n</code></pre>\n\n<p>For usage and possible render configurations checkout out the <a href=\"https://github.com/vmg/redcarpet#and-its-like-really-simple-to-use\" rel=\"nofollow noreferrer\">redcarpet documentation</a>.</p>\n\n<p>With this helper present you can simply do the following in the view:</p>\n\n<pre><code>&lt;%= markdown(@discussion.content) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11882148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fmnhs2_L5kw/AAAAAAAAAAI/AAAAAAAAAAc/WRKPcsgfmfs/photo.jpg?sz=128", "display_name": "Odechie-Williams", "link": "https://stackoverflow.com/users/11882148/odechie-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1572299703, "creation_date": 1572271664, "last_edit_date": 1572272115, "question_id": 58592417, "link": "https://stackoverflow.com/questions/58592417/nomethoderror-in-discussionsshow", "title": "NoMethodError in Discussions#show", "body": "<p>Below is code extract from my file <code>app/views/discussions/show.html.erb</code> where line 16 raised this error:</p>\n\n<blockquote>\n  <pre class=\"lang-none prettyprint-override\"><code>undefined method `markdown' for #&lt;#&lt;Class:0x000000000c94e0d8&gt;:0x000000000c94c6e8&gt;\n</code></pre>\n</blockquote>\n\n<pre class=\"lang-html prettyprint-override\"><code>s&lt;div class=\"columns\"&gt;\n  &lt;div class=\"column is-8\"&gt;\n    &lt;h1 class=\"title is-2 has-text-grey discussion-title\"&gt;&lt;%= @discussion.title %&gt;&lt;/h1&gt;\n    &lt;h3 class=\"subtitle is-5 has-text-grey-lighter\"&gt;by &lt;%= @discussion.user.username %&gt; in &lt;%= link_to @discussion.channel.channel, @discussion.channel %&gt;&lt;/h3&gt;\n    &lt;div class=\"level\"&gt;\n      &lt;div class=\"level-left\"&gt;&lt;/div&gt;\n      &lt;div class=\"level-right\"&gt;\n        &lt;% if  discussion_url(@discussion) %&gt;\n        &lt;div class=\"buttons\"&gt;\n            &lt;%= link_to 'Edit Discussion', edit_discussion_path(@discussion), class:'button'%&gt;\n            &lt;%= link_to 'Delete', discussion_path(@discussion), method: :delete, data: { confirm: \"Delete discussion?\" }, class:'button' %&gt;\n        &lt;/div&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"content\"&gt;&lt;%= markdown (@discussion.content) %&gt;&lt;/div&gt;\n    &lt;!--                     ^^^^^^^^                            --&gt;\n\n    &lt;h2 class=\"subtitle is-5 has-text-grey\"&gt;&lt;%= @discussion.replies.count %&gt; Replies&lt;/h2&gt;\n\n    &lt;div id=\"discussion-replies\"&gt;\n      &lt;%= render @discussion.replies %&gt;\n    &lt;/div&gt;\n\n    &lt;hr/&gt;\n\n    &lt;h3 class=\"subtitle is-3 has-text-grey\"&gt;Leave a reply&lt;/h3&gt;\n    &lt;% if user_signed_in? %&gt;\n      &lt;%= render 'replies/form' %&gt;\n    &lt;% else %&gt;\n    &lt;p&gt;To reply you need to &lt;%= link_to 'login', new_user_session_path %&gt;. Don't have an account?\n      &lt;%= link_to 'Sign up', new_user_registration_path %&gt; for one.&lt;/p&gt;\n    &lt;% end %&gt;\n\n  &lt;/div&gt;\n\n    &lt;%= render 'sidebar' %&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>cant view reply or comment section </p>\n"}, {"tags": ["ruby", "sequel", "bytea"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573077339, "post_id": 58591442, "comment_id": 103768002, "body": "Questions like this are also good candidates for the Sequel IRC channel (irc://irc.freenode.net/sequel) and <a href=\"http://groups.google.com/group/sequel-talk\" rel=\"nofollow noreferrer\">Discussion Forum</a>. The author of Sequel uses PostgreSQL and knows both Sequel and PostgreSQL intimately."}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 4288922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxPcM.jpg?s=128&g=1", "display_name": "Aleks Boev", "link": "https://stackoverflow.com/users/4288922/aleks-boev"}, "is_accepted": false, "score": 1, "last_activity_date": 1573077565, "last_edit_date": 1573077565, "creation_date": 1572274088, "answer_id": 58593094, "question_id": 58591442, "link": "https://stackoverflow.com/questions/58591442/is-there-a-special-postgresql-bytea-data-type-in-sequel/58593094#58593094", "title": "is there a special Postgresql Bytea data type in Sequel?", "body": "<ul>\n<li><p>Yes. Bytea is supported in Sequel: See \"<a href=\"https://github.com/jeremyevans/sequel/blob/67cc4245227a6c01ecb20d0138aaf37b05a5aebc/doc/release_notes/2.2.0.txt\" rel=\"nofollow noreferrer\">The 2.2.0 release_notes</a>.</p></li>\n<li><p>You can change the column <code>col_name</code> type from String to Bytea using: </p>\n\n<pre><code>set_column_type :col_name, :bytea, using: 'col_name::bytea'\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 443, "user_id": 4288922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxPcM.jpg?s=128&g=1", "display_name": "Aleks Boev", "link": "https://stackoverflow.com/users/4288922/aleks-boev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573077565, "creation_date": 1572267743, "question_id": 58591442, "link": "https://stackoverflow.com/questions/58591442/is-there-a-special-postgresql-bytea-data-type-in-sequel", "title": "is there a special Postgresql Bytea data type in Sequel?", "body": "<p>I know that Sequel have <code>BLOB</code> type for byte data, but there is some difference between <code>BLOB</code> and <code>bytea</code>. Is it possible to use <code>bytea</code> directly with Sequel?</p>\n"}, {"tags": ["ruby", "csv", "nested", "ruby-hash"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1572268209, "post_id": 58590271, "comment_id": 103496044, "body": "Why do you use an array for the address but not for the phone numbers? That looks not DRY."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572283373, "post_id": 58590271, "comment_id": 103503996, "body": "Your CSV file always contains just one line after the headers? If it may contain two or more, do you want to return an array of hashes, one hash per line (after the first, containing the headers)? It&#39;s unusual for a CSV to have a comma followed by one space as the field separator. Is that what you want? If you want just the comma please remove the spaces."}, {"owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572329770, "post_id": 58590271, "comment_id": 103516129, "body": "@CarySwoveland I have updated the question to remove the spaces after the comma. it can contain multiple rows."}], "answers": [{"comments": [{"owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 0, "creation_date": 1572265285, "post_id": 58590581, "comment_id": 103494703, "body": "The CSV headers can change. I have updated the question to add that information."}, {"owner": {"reputation": 1407, "user_id": 3859961, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/625444c465d9823afd183cf8f62efa51?s=128&d=identicon&r=PG&f=1", "display_name": "An Nguyen", "link": "https://stackoverflow.com/users/3859961/an-nguyen"}, "reply_to_user": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 0, "creation_date": 1572269512, "post_id": 58590581, "comment_id": 103496697, "body": "How dynamic it can be? Is the number of columns varied? Does the header name follow any format?"}, {"owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 0, "creation_date": 1572270098, "post_id": 58590581, "comment_id": 103497013, "body": "Number of columns can vary. For example, if there is another contact, it would have a header <code>contacts.2.phone_no</code>. The number in the header represents the position in the array"}, {"owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 0, "creation_date": 1572270801, "post_id": 58590581, "comment_id": 103497367, "body": "It can happen to <code>codes</code> field also. There can be other new fields as well. The CSV is completely dynamic."}, {"owner": {"reputation": 1407, "user_id": 3859961, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/625444c465d9823afd183cf8f62efa51?s=128&d=identicon&r=PG&f=1", "display_name": "An Nguyen", "link": "https://stackoverflow.com/users/3859961/an-nguyen"}, "reply_to_user": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 0, "creation_date": 1572271821, "post_id": 58590581, "comment_id": 103497894, "body": "@YedhuKrishnan But you didn&#39;t describe the way to parse it. &quot;Completely dynamic&quot; mean there are headers like &quot;blahblah1&quot; and then how you deal with it? Put it into a hash key, or group it with another &quot;blahbleh&quot;? Is there any principle to deal with it or you are asking us to figure it out?"}, {"owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "reply_to_user": {"reputation": 1407, "user_id": 3859961, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/625444c465d9823afd183cf8f62efa51?s=128&d=identicon&r=PG&f=1", "display_name": "An Nguyen", "link": "https://stackoverflow.com/users/3859961/an-nguyen"}, "edited": false, "score": 0, "creation_date": 1572273473, "post_id": 58590581, "comment_id": 103498785, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201500/discussion-between-yedhu-krishnan-and-firice-nguyen\">continue this discussion in chat</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572283443, "post_id": 58590581, "comment_id": 103504028, "body": "<code>name, *fields = line.split(...)</code> is a nice way of carving out those items."}], "tags": [], "owner": {"reputation": 1407, "user_id": 3859961, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/625444c465d9823afd183cf8f62efa51?s=128&d=identicon&r=PG&f=1", "display_name": "An Nguyen", "link": "https://stackoverflow.com/users/3859961/an-nguyen"}, "is_accepted": false, "score": 1, "last_activity_date": 1572264048, "creation_date": 1572264048, "answer_id": 58590581, "question_id": 58590271, "link": "https://stackoverflow.com/questions/58590271/how-to-create-a-hash-from-a-nested-csv-in-ruby/58590581#58590581", "title": "How to create a Hash from a nested CSV in Ruby?", "body": "<p>Just read and parse it line-by-line. The <code>arr</code> variable in the code below will hold an array of Hash that you need</p>\n\n<pre><code>arr = []\n\nFile.readlines('README.md').drop(1).each do |line|\n  fields = line.split(',').map(&amp;:strip)\n\n  hash = { name: fields[0], contacts: [fields[1], fields[2]], address: [fields[3], fields[4]] }\n  arr.push(hash)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 0, "creation_date": 1572332394, "post_id": 58597275, "comment_id": 103516882, "body": "Thank you for the elaborate answer. Although the second and third assumptions are correct, the first one not correct. There could be multiple fields without dot. That means that it is a top-level key."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "edited": false, "score": 1, "creation_date": 1572369763, "post_id": 58597275, "comment_id": 103535242, "body": "I made what I think are the necessary adjustments in my answer. In addition, I tweaked the code generally."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572369717, "last_edit_date": 1572369717, "creation_date": 1572291047, "answer_id": 58597275, "question_id": 58590271, "link": "https://stackoverflow.com/questions/58590271/how-to-create-a-hash-from-a-nested-csv-in-ruby/58597275#58597275", "title": "How to create a Hash from a nested CSV in Ruby?", "body": "<p>Let's first construct a CSV file.</p>\n\n<pre><code>str = &lt;&lt;~END\nname,contacts.0.phone_no,contacts.1.phone_no,codes.0,IQ,codes.1\nYK,1234,4567,AB001,173,AK002\nER,4321,7654,BA001,81,KA002\nEND\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>FName = 't.csv'\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>File.write(FName, str)\n  #=&gt; 121\n</code></pre>\n\n<p>I have constructed a helper method to construct a <em>pattern</em> that will be used to convert each row of the CSV file (following the first, containing the headers) to an element (hash) of the desired array.</p>\n\n<pre><code>require 'csv'\n\ndef construct_pattern(csv)\n  csv.headers.group_by { |col| col[/[^.]+/] }.\n      transform_values do |arr|\n        case arr.first.count('.')\n        when 0\n          arr.first\n        when 1\n          arr\n        else \n          key = arr.first[/(?&lt;=\\d\\.).*/]\n          arr.map { |v| { key=&gt;v } }\n        end\n      end\nend\n</code></pre>\n\n<p>In the code below, for the example being considered:</p>\n\n<pre><code>construct_pattern(csv)\n  #=&gt; {\"name\"=&gt;\"name\",\n  #    \"contacts\"=&gt;[{\"phone_no\"=&gt;\"contacts.0.phone_no\"},\n  #                 {\"phone_no\"=&gt;\"contacts.1.phone_no\"}],\n  #    \"codes\"=&gt;[\"codes.0\", \"codes.1\"],\n  #    \"IQ\"=&gt;\"IQ\"}\n</code></pre>\n\n<p>By tacking <code>if pattern.empty?</code> onto the above expression we ensure the pattern is constructed only once.</p>\n\n<p>We may now construct the desired array.</p>\n\n<pre><code>pattern = {}\nCSV.foreach(FName, headers: true).map do |csv|\n  pattern = construct_pattern(csv) if pattern.empty?\n  pattern.each_with_object({}) do |(k,v),h|\n    h[k] =\n    case v\n    when Array\n      case v.first\n      when Hash\n        v.map { |g| g.transform_values { |s| csv[s] } }\n      else\n        v.map { |s| csv[s] }\n      end\n    else\n      csv[v]\n    end\n  end\nend\n  #=&gt; [{\"name\"=&gt;\"YK\",\n  #     \"contacts\"=&gt;[{\"phone_no\"=&gt;\"1234\"}, {\"phone_no\"=&gt;\"4567\"}],\n  #     \"codes\"=&gt;[\"AB001\", \"AK002\"],\n  #     \"IQ\"=&gt;\"173\"},\n  #    {\"name\"=&gt;\"ER\",\n  #     \"contacts\"=&gt;[{\"phone_no\"=&gt;\"4321\"}, {\"phone_no\"=&gt;\"7654\"}],\n  #     \"codes\"=&gt;[\"BA001\", \"KA002\"],\n  #     \"IQ\"=&gt;\"81\"}] \n</code></pre>\n\n<p>The CSV methods I've used are documented in <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">CSV</a>. See also <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a>.</p>\n"}], "owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572369717, "creation_date": 1572262708, "last_edit_date": 1572329659, "question_id": 58590271, "link": "https://stackoverflow.com/questions/58590271/how-to-create-a-hash-from-a-nested-csv-in-ruby", "title": "How to create a Hash from a nested CSV in Ruby?", "body": "<p>I have a CSV in the following format:</p>\n\n<pre><code>name,contacts.0.phone_no,contacts.1.phone_no,codes.0,codes.1\nYK,1234,4567,AB001,AK002\n</code></pre>\n\n<p>As you can see, this is a nested structure. The CSV may contain multiple rows. I would like to convert this into an array of hashes like this:</p>\n\n<pre><code>[\n  {\n    name: 'YK',\n    contacts: [\n        {\n            phone_no: '1234'\n        },\n        {\n            phone_no: '4567'\n        }\n    ],\n    codes: ['AB001', 'AK002']\n  }\n]\n</code></pre>\n\n<p>The structure uses numbers in the given format to represent arrays. There can be hashes inside arrays. Is there a simple way to do that in Ruby?</p>\n\n<p>The CSV headers are dynamic. It can change. I will have to create the hash on the fly based on the CSV file. </p>\n\n<p>There is a similar node library called <a href=\"https://www.npmjs.com/package/csvtojson\" rel=\"nofollow noreferrer\">csvtojson</a> to do that for JavaScript. </p>\n"}]