[{"tags": ["ruby", "api", "twitter"], "answers": [{"tags": [], "owner": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "is_accepted": true, "score": 1, "last_activity_date": 1547676518, "creation_date": 1547676518, "answer_id": 54226131, "question_id": 54225557, "link": "https://stackoverflow.com/questions/54225557/twitter-bot-to-likes-some-tweets-using-ruby/54226131#54226131", "title": "Twitter Bot to Likes some tweets using ruby", "body": "<p>There appears to be a \"<a href=\"https://www.rubydoc.info/gems/twitter/Twitter/REST/Favorites#favorite-instance_method\" rel=\"nofollow noreferrer\">favorite</a>\" call that you can make, by passing it a collection of tweets.</p>\n\n<p>Although I can't test it out at the moment, something like this <em>should</em> work:</p>\n\n<pre><code>var tweets = client.search(\"#Hello_World\", result_type: \"recent\").take(20)\n\nclient.favorite(tweets)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10835737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qyx1mYciteo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYbQivn5FXtcQYAsRNLMinrljjjHg/mo/photo.jpg?sz=128", "display_name": "Amine ", "link": "https://stackoverflow.com/users/10835737/amine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 54226131, "answer_count": 1, "score": 1, "last_activity_date": 1571236593, "creation_date": 1547673626, "last_edit_date": 1571236593, "question_id": 54225557, "link": "https://stackoverflow.com/questions/54225557/twitter-bot-to-likes-some-tweets-using-ruby", "title": "Twitter Bot to Likes some tweets using ruby", "body": "<p>I am a Ruby beginner currently working on Twitter API's.</p>\n\n<p>So far I learned how to tweet and look for tweets using twitter bot with <a href=\"https://github.com/sferik/twitter\" rel=\"nofollow noreferrer\">The Twitter Ruby Gem</a>.</p>\n\n<pre><code>def follow_hello(client)\n    client.search(\"#Hello_World\", result_type: \"recent\").take(20).map do |tweet|\n      client.follow(tweet.user)\n    end\nend\n</code></pre>\n\n<p>How can I \"Like\" all the 20 tweets with the <code>#Hello_World</code>?</p>\n\n<p>I tried this, but it doesn't work:</p>\n\n<pre><code>client.search('#Hello_World', result_type: \"recent\").take(25).each do |like|\n</code></pre>\n"}, {"tags": ["ruby", "tdd", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5317996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b30155944b8b7989a89dbc2367f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Werdna", "link": "https://stackoverflow.com/users/5317996/werdna"}, "edited": false, "score": 0, "creation_date": 1547730888, "post_id": 54226128, "comment_id": 95297986, "body": "Thanks very much Thomas! - Looks like the perfect solution :)"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1547678337, "last_edit_date": 1547678337, "creation_date": 1547676511, "answer_id": 54226128, "question_id": 54225475, "link": "https://stackoverflow.com/questions/54225475/tdd-ruby-with-capybara-how-to-use-capybara-to-verify-specific-page-values-withi/54226128#54226128", "title": "TDD Ruby with Capybara: How to use Capybara to verify specific page values within specific page elements", "body": "<p>You just need to expect on the element you wish to check inside - for instance</p>\n\n<pre><code>heading = page.find('li#campaign_1 .media-heading.name')\nexpect(heading).to have_content('Campaign_1')\n</code></pre>\n\n<p>Another option (more useful when you have a few things to check) is the <code>within</code> method which scopes what <code>page</code> refers</p>\n\n<pre><code>within 'li#campaign_1 .media-heading.name' do\n  # here page will refer to the .name element\n  expect(page).to have_content('Campaign_1')\nend\n</code></pre>\n\n<p>Finally, you could just do it all in one expectation using the <code>text</code> or <code>exact_text</code> options</p>\n\n<pre><code>expect(page).to have_css('li#campaign_1 .media-heading.name', text: 'Campaign_1')\n</code></pre>\n\n<p>Combining a couple of those methods together would give</p>\n\n<pre><code>within 'li#campaign_1' do\n  expect(page).to have_css('.media-heading.name', text: 'Campaign_1'\n  expect(page).to have_css('.media-heading.country', text: 'United Kingdom')\nend\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5317996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b30155944b8b7989a89dbc2367f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Werdna", "link": "https://stackoverflow.com/users/5317996/werdna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 54226128, "answer_count": 1, "score": 0, "last_activity_date": 1549011808, "creation_date": 1547673327, "last_edit_date": 1549011808, "question_id": 54225475, "link": "https://stackoverflow.com/questions/54225475/tdd-ruby-with-capybara-how-to-use-capybara-to-verify-specific-page-values-withi", "title": "TDD Ruby with Capybara: How to use Capybara to verify specific page values within specific page elements", "body": "<p>I'm using Capybara to test that my Ruby/Sinatra application renders the pages correctly. </p>\n\n<p>I been able to test that the page contains certain values, with statements like the following:</p>\n\n<p><code>expect(page).to have_content('Campaign_1')</code></p>\n\n<p>However, what I want to do is check that specific elements of the page contain the expected values. </p>\n\n<p>For instance, the various 'child' elements of:</p>\n\n<p><code>&lt;li id=\"campaign_1\" style=\"margin-bottom:25px\"&gt;</code> </p>\n\n<p>such as the 'media-heading name' child element has the value 'Campaign_1', as per the code snippet below:</p>\n\n<p><code>&lt;h6 class=\"media-heading name\"&gt;Campaign_1&lt;/h6&gt;</code></p>\n\n<p>or that the 'media-heading country' child element has the value 'United Kingdom' as per the code snippet below:</p>\n\n<p><code>&lt;h6 class=\"media-heading country\"&gt;United Kingdom&lt;/h6&gt;</code></p>\n\n<p>Below is a copy of the .erb file contents.</p>\n\n<pre><code>  &lt;ul class=\"list-group\" &gt;\n    &lt;% @all_campaigns.each do |campaign| %&gt;\n      &lt;a href=\"/campaign/&lt;%= campaign.name %&gt;\" style=\"text-decoration: none\"&gt;\n        &lt;li id=\"&lt;%= campaign.name.downcase %&gt;\" style=\"margin-bottom:25px\"&gt;\n          &lt;div class=\"media\"&gt;\n            &lt;div class=\"media-left\"&gt;\n              &lt;img src=\"/images/&lt;%= campaign.image %&gt;.jpeg\" class=\"media-object\"&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;br&gt;\n          &lt;div class=\"media-body\"&gt;\n            &lt;h6 class=\"media-heading name\"&gt;&lt;%= campaign.name %&gt;&lt;/h6&gt;\n            &lt;br&gt;\n            &lt;div class=\"left_right_Container\"&gt;\n              &lt;h6 class=\"media-heading country\"&gt;&lt;%= campaign.country %&gt;&lt;/h6&gt;\n              &lt;h6 class=\"media-heading sector\"&gt;&lt;%= campaign.sector %&gt;&lt;/h6&gt;\n            &lt;/div&gt;\n            &lt;br&gt;\n            &lt;br&gt;\n            &lt;h5 class=\"media-heading target_amount\"&gt;Target Amount: \u00a3&lt;%= campaign.target_amount %&gt;&lt;/h5&gt;\n          &lt;/div&gt;\n          &lt;div class=\"progress\"&gt;\n            &lt;div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\"\n            aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:&lt;%= campaign.percentage %&gt;%\"&gt;\n              &lt;span class=\"\"&gt;&lt;%= campaign.percentage %&gt;% Funded&lt;/span&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/li&gt;\n      &lt;/a&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n</code></pre>\n\n<p>The above .erb file results in the HTML below (there's more, this is just a snippet) being created when the app runs:</p>\n\n<pre><code>  &lt;li id=\"campaign_1\" style=\"margin-bottom:25px\"&gt;\n    &lt;div class=\"media\"&gt;\n      &lt;div class=\"media-left\"&gt;\n        &lt;img src=\"/images/Image_1.jpeg\" class=\"media-object\"&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;br&gt;\n    &lt;div class=\"media-body\"&gt;\n      &lt;h6 class=\"media-heading name\"&gt;Campaign_1&lt;/h6&gt;\n      &lt;br&gt;\n      &lt;div class=\"left_right_Container\"&gt;\n        &lt;h6 class=\"media-heading country\"&gt;United Kingdom&lt;/h6&gt;\n        &lt;h6 class=\"media-heading sector\"&gt;Automotive&lt;/h6&gt;\n      &lt;/div&gt;\n      &lt;br&gt;\n      &lt;br&gt;\n      &lt;h5 class=\"media-heading target_amount\"&gt;Target Amount: \u00a31000000&lt;/h5&gt;\n    &lt;/div&gt;\n    &lt;div class=\"progress\"&gt;\n      &lt;div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:93%\"&gt;\n        &lt;span class=\"\"&gt;93% Funded&lt;/span&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/li&gt;\n\n</code></pre>\n"}, {"tags": ["ruby", "inheritance"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547806310, "post_id": 54224858, "comment_id": 95327558, "body": "Worth reading: <a href=\"https://words.steveklabnik.com/beware-subclassing-ruby-core-classes\" rel=\"nofollow noreferrer\">Beware subclassing Ruby core classes</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547671908, "post_id": 54224948, "comment_id": 95276185, "body": "Ok, I understand. But I want to define other methods on my objects MyArray. How i can do that ?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547672963, "post_id": 54224948, "comment_id": 95276640, "body": "@&#181;geek:what do you mean? Just like you define any other method."}, {"owner": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547674225, "post_id": 54224948, "comment_id": 95277241, "body": "Yes i want to define method, for exemple to compare 2 array, or cut array to two other array..."}, {"owner": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547674784, "post_id": 54224948, "comment_id": 95277469, "body": "But I also want to be able to use the methods of arrays"}, {"owner": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547677291, "post_id": 54224948, "comment_id": 95278522, "body": "Do I only have to insert methods in Array class ?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547677625, "post_id": 54224948, "comment_id": 95278689, "body": "@&#181;geek Not sure what you meant by this, but looks like you&#39;ll benefit from proceeding with the  ruby tutorial/book/whatever you&#39;re using, and trying simpler exercises for now (ones not involving subclassing standard classes). If my memory serves, the pickaxe book used an excellent song library app as examples."}, {"owner": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547678121, "post_id": 54224948, "comment_id": 95278869, "body": "Thank you for your advice. I&#39;ll try simpler exercises... Is it really a bad way to add methods to a standard class?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "edited": false, "score": 0, "creation_date": 1547678338, "post_id": 54224948, "comment_id": 95278939, "body": "@&#181;geek: yes, you should refrain from doing that, until you can explain <i>why</i> you need that and why other approaches are not good enough."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1547805980, "post_id": 54224948, "comment_id": 95327362, "body": "<i>&quot;Concatenation operation is defined to return a new Array&quot;</i> \u2013 the documentation just says &quot;array&quot; (lowercase), the class isn&#39;t specified. And other methods like <code>a[1..2]</code> or <code>a * 2</code> which also return a &quot;new array&quot; actually retain the receiver&#39;s class, i.e. they do return <code>MyArray</code> instances.  <i>&quot;Why should it be a MyArray?&quot;</i> \u2013 because it would be less surprising. I think the conversion back to <code>Array</code> is due to optimization rather than OOP consideration."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547845455, "post_id": 54224948, "comment_id": 95346957, "body": "&quot;a[1..2] or a * 2 ... return MyArray instances&quot; - oh wow, totally did not expect this."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1547670871, "creation_date": 1547670871, "answer_id": 54224948, "question_id": 54224858, "link": "https://stackoverflow.com/questions/54224858/ruby-class-and-inheritance/54224948#54224948", "title": "Ruby, class and inheritance", "body": "<blockquote>\n  <p>I don't understand why my array \"a\" is not \"MyArray\" class after add.</p>\n</blockquote>\n\n<p>Why should it (be a <code>MyArray</code>)? Concatenation operation on arrays is defined to return a new <code>Array</code>, so that's what happens here. <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-2B\" rel=\"noreferrer\">https://ruby-doc.org/core-2.5.3/Array.html#method-i-2B</a></p>\n\n<p>If you want, you can override that operation in your class to return an instance of MyArray. Don't forget about all other similar methods.</p>\n\n<p>This is also why it's a bad idea to subclass standard collections. Better to use composition over inheritance here.</p>\n"}, {"tags": [], "owner": {"reputation": 14340, "user_id": 2612259, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/70fec6995fdcaebf6362e10bd501f34f?s=128&d=identicon&r=PG", "display_name": "nPn", "link": "https://stackoverflow.com/users/2612259/npn"}, "is_accepted": false, "score": 3, "last_activity_date": 1547682050, "creation_date": 1547682050, "answer_id": 54227038, "question_id": 54224858, "link": "https://stackoverflow.com/questions/54224858/ruby-class-and-inheritance/54227038#54227038", "title": "Ruby, class and inheritance", "body": "<p>Just to add a bit to Sergio's answer in terms of his comment on using composition over inheritance and the exchange in the comments.</p>\n\n<p>Instead of saying MyArray <em>is</em> an array you can say MyArrayLike <em>has</em> and array.\nThen you can \"forward\" methods that make sense to the underlying array but still add your own functionality that makes sense for your class <strong>without</strong> sub-classing array.</p>\n\n<p>Ruby even has several ways to make this very easy including the <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/forwardable/rdoc/Forwardable.html\" rel=\"nofollow noreferrer\">Forwardable</a> module.</p>\n\n<pre><code>class MyArrayLike \n   attr_reader :arr \n   def initialize( initial_arr )\n      @arr = initial_arr \n   end\n\n   def +(other)\n     result = self.class.new(arr + other.arr)\n     # maybe you want to do more than just concat the underlying array, if so you can do it here\n     result\n   end\n\n   def first\n      # for example maybe you want first to just return the first item in the underlying array.\n      arr.first \n   end    \nend\n\n\na = MyArrayLike.new([1,2,3])\nb = MyArrayLike.new([4,5])\n\nputs \"a.class = #{a.class}\"\n# =&gt; a.class = MyArrayLike\nputs a\n# =&gt; #&lt;MyArrayLike:0x00000000dc4b00&gt;\na += b\nputs \"a.class = #{a.class}\"\n# =&gt; a.class = MyArrayLike\nputs a \n# =&gt; #&lt;MyArrayLike:0x00000000dc4470&gt;\n\nputs a.first \n# =&gt; 1\nputs a.arr \n# =&gt; 1\n#    2\n#    3\n#    4\n#    5 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1547806128, "post_id": 54228848, "comment_id": 95327464, "body": "Alternative implementation: <code>dup.concat(other)</code>"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1547697920, "creation_date": 1547697920, "answer_id": 54228848, "question_id": 54224858, "link": "https://stackoverflow.com/questions/54224858/ruby-class-and-inheritance/54228848#54228848", "title": "Ruby, class and inheritance", "body": "<p>Adding <code>MyArray</code> to <code>MyArray</code> to get <code>Array</code> may be counterintuitive, but a method can be defined to return any class. And in the case of <code>Array#+</code>, which you are calling, it just happens to be defined to return an <code>Array</code>. That's it.</p>\n\n<p>If you want it to return a <code>MyArray</code>, one way to do it is to define <code>MyArray#+</code> as follows:</p>\n\n<pre><code>class MyArray &lt; Array\n  def +other\n    MyArray.new(super)\n  end\nend\n\n(MyArray.new([1, 2, 3]) + MyArray.new([4, 5])).class # =&gt; MyArray\n</code></pre>\n\n<p>By the way, notice that your <code>MyArray#initialize</code> definition is meaningless, and hence redundant.</p>\n"}], "owner": {"reputation": 43, "user_id": 10924476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed13b04a195445c82673fbc4931dbb?s=128&d=identicon&r=PG&f=1", "display_name": "&#181;geek", "link": "https://stackoverflow.com/users/10924476/%c2%b5geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 54224948, "answer_count": 3, "score": 3, "last_activity_date": 1547806647, "creation_date": 1547670402, "last_edit_date": 1547806647, "question_id": 54224858, "link": "https://stackoverflow.com/questions/54224858/ruby-class-and-inheritance", "title": "Ruby, class and inheritance", "body": "<p>I need help understanding inheritance.</p>\n\n<pre><code>class MyArray &lt; Array\nend\n\na = MyArray[1, 2, 3] #=&gt; [1, 2, 3]\nb = MyArray[4, 5]    #=&gt; [4, 5]\nc = a + b            #=&gt; [1, 2, 3, 4, 5]\n\na.class #=&gt; MyArray\nb.class #=&gt; MyArray\nc.class #=&gt; Array\n</code></pre>\n\n<p>I don't understand why the result of the addition is not an instance of <code>MyArray</code> class.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu"], "comments": [{"owner": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "edited": false, "score": 0, "creation_date": 1547681497, "post_id": 54224452, "comment_id": 95279937, "body": "How was Ruby initially installed on the machine? It&#39;s possible that Ruby needs to be installed with the --enable-shared flag set, which varies slightly depending on how Ruby was installed"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1547695923, "post_id": 54224452, "comment_id": 95282749, "body": "What&#39;s the permission on the library file? Probably ok, but make sure you have read access."}, {"owner": {"reputation": 535, "user_id": 4333410, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/l9S2b.png?s=128&g=1", "display_name": "KavitaC", "link": "https://stackoverflow.com/users/4333410/kavitac"}, "reply_to_user": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "edited": false, "score": 1, "creation_date": 1547747163, "post_id": 54224452, "comment_id": 95307459, "body": "@Tennesseej I installed Ruby using rvm install"}, {"owner": {"reputation": 535, "user_id": 4333410, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/l9S2b.png?s=128&g=1", "display_name": "KavitaC", "link": "https://stackoverflow.com/users/4333410/kavitac"}, "edited": false, "score": 1, "creation_date": 1547759715, "post_id": 54224452, "comment_id": 95313312, "body": "I tried this -&gt; rvm reinstall ruby-2.5.3 --enable-shared and still I have the same problem"}, {"owner": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "edited": false, "score": 0, "creation_date": 1547863347, "post_id": 54224452, "comment_id": 95351086, "body": "@KavitaC do you see anything labeled as &#39;not found&#39; when you run this cmd: <code>ldd &#47;home&#47;usermachine&#47;projects&#47;projectname&#47;lib&#47;mapscript.so</code>"}, {"owner": {"reputation": 535, "user_id": 4333410, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/l9S2b.png?s=128&g=1", "display_name": "KavitaC", "link": "https://stackoverflow.com/users/4333410/kavitac"}, "edited": false, "score": 0, "creation_date": 1548886250, "post_id": 54224452, "comment_id": 95709314, "body": "I was finally able to resolve this issue buy building mapserver from Git. Thank you all!"}], "owner": {"reputation": 535, "user_id": 4333410, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/l9S2b.png?s=128&g=1", "display_name": "KavitaC", "link": "https://stackoverflow.com/users/4333410/kavitac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 642, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547668748, "creation_date": 1547668748, "question_id": 54224452, "link": "https://stackoverflow.com/questions/54224452/rails-cannot-open-shared-object-file-no-such-file-or-directory", "title": "Rails: cannot open shared object file: No such file or directory", "body": "<p>Rails: 5\nRuby: 2.5.3\nGem: gem \"ruby_mapscript\" \nError: <code>/home/usermachine/.rvm/gems/ruby-2.5.3/gems/ruby_mapscript-0.3.0/lib/mapscript/mapscript_extensions.rb:3:in require: libruby-2.0.so.2.0: cannot open shared object file: No such file or directory - /home/usermachine/projects/projectname/lib/mapscript.so (LoadError)</code></p>\n\n<p>Hi, when I try to start my rails server with \"rails s\" I get the above error for the ruby_mapscript gem. The file (/home/usermachine/projects/projectname/lib/mapscript.so) is very much present. </p>\n\n<p>I tried <code>sudo /sbin/ldconfig -v</code> but the error remains. </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby", "powershell"], "comments": [{"owner": {"reputation": 1371, "user_id": 5229138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d790a473cbb5bc80aaaea5e30d98f2e?s=128&d=identicon&r=PG", "display_name": "Persistent13", "link": "https://stackoverflow.com/users/5229138/persistent13"}, "edited": false, "score": 4, "creation_date": 1547665147, "post_id": 54223545, "comment_id": 95273092, "body": "I am not an expert with encodings so this may be incorrect, this issue might be that in the Ruby example you are encoding the string in ISO_8859_1 while in the PowerShell example you are encoding the string in UTF8. This could lead to the difference observed but I am not confident enough to be sure! Please see this link <a href=\"https://stackoverflow.com/questions/7048745/what-is-the-difference-between-utf-8-and-iso-8859-1\" title=\"what is the difference between utf 8 and iso 8859 1\">stackoverflow.com/questions/7048745/&hellip;</a>"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1547710422, "post_id": 54223545, "comment_id": 95286834, "body": "Could also be the linefeeds. Windows has <code>\\r\\n</code> and linux has <code>\\n</code>. This, I believe, is not affected by the encoding."}, {"owner": {"reputation": 107, "user_id": 1083273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/875xv.jpg?s=128&g=1", "display_name": "Jigish Thakar", "link": "https://stackoverflow.com/users/1083273/jigish-thakar"}, "edited": false, "score": 0, "creation_date": 1547724450, "post_id": 54223545, "comment_id": 95294493, "body": "Both scripts are running on windows platform."}], "answers": [{"tags": [], "owner": {"reputation": 39264, "user_id": 3905079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54d4c111c4564b116ff1efca8c56788?s=128&d=identicon&r=PG", "display_name": "briantist", "link": "https://stackoverflow.com/users/3905079/briantist"}, "is_accepted": false, "score": 0, "last_activity_date": 1547667101, "creation_date": 1547667101, "answer_id": 54224071, "question_id": 54223545, "link": "https://stackoverflow.com/questions/54223545/different-sha1-hash-result-in-powershell-and-ruby/54224071#54224071", "title": "Different SHA1 hash result in Powershell and Ruby", "body": "<p>As Persistent13 mentioned in a comment, the encoding difference is the most likely reason. The encoding class in .Net has a few static members corresponding to common encodings but ISO-8859-1 isn't one of them. You can see the rest with <code>[System.Text.Encoding]::GetEncodings()</code> and you can get a specific one with <code>[System.Text.Encoding]::GetEncoding()</code> (there are a few overloads). </p>\n\n<p>So for example, try this:</p>\n\n<pre class=\"lang-powershell prettyprint-override\"><code>$bytes = [System.Text.Encoding]::GetEncoding('iso-8859-1').GetBytes($string)\n[System.Security.Cryptography.HashAlgorithm]::Create(\"sha1\").ComputeHash($bytes)\n</code></pre>\n\n<p>Since you can't change the PowerShell part, you can do this just to test the theory in the console.</p>\n\n<p>Or go right to the part of changing Ruby to use UTF8.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>varj_Encoded = varj.encode(Encoding::UTF-8)\nputs Digest::SHA1.hexdigest(varj_Encoded)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39264, "user_id": 3905079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54d4c111c4564b116ff1efca8c56788?s=128&d=identicon&r=PG", "display_name": "briantist", "link": "https://stackoverflow.com/users/3905079/briantist"}, "edited": false, "score": 1, "creation_date": 1547668377, "post_id": 54224286, "comment_id": 95274566, "body": "Good call @cody ! It&#39;s worth mentioning that although encoding wasn&#39;t an issue with <i>this specific data</i>, it would be an issue with other data where UTF-8 and ISO-8859-1 encodings differ."}, {"owner": {"reputation": 107, "user_id": 1083273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/875xv.jpg?s=128&g=1", "display_name": "Jigish Thakar", "link": "https://stackoverflow.com/users/1083273/jigish-thakar"}, "edited": false, "score": 0, "creation_date": 1547724495, "post_id": 54224286, "comment_id": 95294521, "body": "Thanks @cody, I tried with bypassing back slash - result is still different. and space at the start of line was a mistake while posting questions. in my code file both are same. I am not sure how you are getting hash same from both the scripts."}, {"owner": {"reputation": 10314, "user_id": 6124411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3zE.jpg?s=128&g=1", "display_name": "cody", "link": "https://stackoverflow.com/users/6124411/cody"}, "reply_to_user": {"reputation": 107, "user_id": 1083273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/875xv.jpg?s=128&g=1", "display_name": "Jigish Thakar", "link": "https://stackoverflow.com/users/1083273/jigish-thakar"}, "edited": false, "score": 0, "creation_date": 1547725214, "post_id": 54224286, "comment_id": 95294884, "body": "@JigishThakar Hmm, I think your best bet is to compare the byte values of each string to figure out what is different. See my edit."}, {"owner": {"reputation": 107, "user_id": 1083273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/875xv.jpg?s=128&g=1", "display_name": "Jigish Thakar", "link": "https://stackoverflow.com/users/1083273/jigish-thakar"}, "edited": false, "score": 0, "creation_date": 1547729325, "post_id": 54224286, "comment_id": 95297149, "body": "Thanks @cody, let me try that."}], "tags": [], "owner": {"reputation": 10314, "user_id": 6124411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4E3zE.jpg?s=128&g=1", "display_name": "cody", "link": "https://stackoverflow.com/users/6124411/cody"}, "is_accepted": true, "score": 4, "last_activity_date": 1547725152, "last_edit_date": 1547725152, "creation_date": 1547668069, "answer_id": 54224286, "question_id": 54223545, "link": "https://stackoverflow.com/questions/54223545/different-sha1-hash-result-in-powershell-and-ruby/54224286#54224286", "title": "Different SHA1 hash result in Powershell and Ruby", "body": "<p>The encoding makes no difference in this situation, as we're only dealing with ASCII characters, and they both encode ASCII the same way. The problem is </p>\n\n<ol>\n<li><p>Your data is different in both cases, note the spaces preceding <code>Directory</code> and <code>ControlCase</code> in your first example but not present in the second.</p></li>\n<li><p>You need to escape the backslashes in the ruby string, or it interprets them as escape characters</p></li>\n</ol>\n\n<p>Once you resolve these two issues, you will get the same result:</p>\n\n<p>PS:</p>\n\n<pre>\nPS H:\\> $String = \"\n>>\n>>     Directory: D:\\OneDrive -\n>>     ControlCase\\jt-work\\evidance-collection\\evidances-text\\PCI_Evidences_CCIN-CAS-VKAUS\\evidences\n>>\n>>\n>> Mode                LastWriteTime     Length Name\n>> ----                -------------     ------ ----\n>> -a---        2019-01-16   1:14 PM       7073 21_to_calc_hash.ps1\n>> -a---        2019-01-16   1:15 PM       9973 CCIN-CAS-VKAUS_pci_evidence_Q21.txt\n>> -a---        2019-01-15   9:37 PM      67399 CCIN-CAS-VKAUS_pci_evidence_Q23.txt\n>> -a---        2019-01-15   9:37 PM       5055 CCIN-CAS-VKAUS_pci_evidence_Q34.txt\n>> -a---        2019-01-15   9:38 PM      10820 CCIN-CAS-VKAUS_pci_evidence_Q45.txt\n>> -a---        2019-01-15   9:38 PM      13129 CCIN-CAS-VKAUS_pci_evidence_Q50.txt\n>> -a---        2019-01-15   9:38 PM       7163 CCIN-CAS-VKAUS_pci_evidence_Q67.txt\n>> -a---        2019-01-15   9:39 PM       4301 CCIN-CAS-VKAUS_pci_evidence_Q69.txt\n>> -a---        2019-01-15   9:39 PM       2900 CCIN-CAS-VKAUS_pci_evidence_Q81.txt\n>>\n>> \"\nPS H:\\> Get-Hash($string)\n6454c0ecf1700448fb2496037a1e9ce496b185cd\n\n</pre>\n\n<p>Ruby:</p>\n\n<pre>\n>> varj = \" \n..  \n..     Directory: D:\\\\OneDrive - \n..     ControlCase\\\\jt-work\\\\evidance-collection\\\\evidances-text\\\\PCI_Evidences_CCIN-CAS-VKAUS\\\\evidences \n..  \n..  \n.. Mode                LastWriteTime     Length Name \n.. ----                -------------     ------ ---- \n.. -a---        2019-01-16   1:14 PM       7073 21_to_calc_hash.ps1 \n.. -a---        2019-01-16   1:15 PM       9973 CCIN-CAS-VKAUS_pci_evidence_Q21.txt \n.. -a---        2019-01-15   9:37 PM      67399 CCIN-CAS-VKAUS_pci_evidence_Q23.txt \n.. -a---        2019-01-15   9:37 PM       5055 CCIN-CAS-VKAUS_pci_evidence_Q34.txt \n.. -a---        2019-01-15   9:38 PM      10820 CCIN-CAS-VKAUS_pci_evidence_Q45.txt \n.. -a---        2019-01-15   9:38 PM      13129 CCIN-CAS-VKAUS_pci_evidence_Q50.txt \n.. -a---        2019-01-15   9:38 PM       7163 CCIN-CAS-VKAUS_pci_evidence_Q67.txt \n.. -a---        2019-01-15   9:39 PM       4301 CCIN-CAS-VKAUS_pci_evidence_Q69.txt \n.. -a---        2019-01-15   9:39 PM       2900 CCIN-CAS-VKAUS_pci_evidence_Q81.txt \n..  \n.. \"\n>> puts Digest::SHA1.hexdigest(varj.encode(Encoding::UTF_8))\n=> 6454c0ecf1700448fb2496037a1e9ce496b185cd\n>> puts Digest::SHA1.hexdigest(varj.encode(Encoding::ISO_8859_1))\n=> 6454c0ecf1700448fb2496037a1e9ce496b185cd\n</pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>If you're still not able to match, I think the best approach is to compare the byte values of each string to identify differences.</p>\n\n<p>PS:</p>\n\n<pre>\nPS H:\\> $enc = [system.Text.Encoding]::UTF8\nPS H:\\> $enc.GetBytes($String)\n10\n10\n32\n32\n...\n</pre>\n\n<p>Ruby:</p>\n\n<pre>\n>> varj_Encoded.bytes.to_a\n=> [10, 10, 32, 32, ...\n</pre>\n"}], "owner": {"reputation": 107, "user_id": 1083273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/875xv.jpg?s=128&g=1", "display_name": "Jigish Thakar", "link": "https://stackoverflow.com/users/1083273/jigish-thakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 54224286, "answer_count": 2, "score": 2, "last_activity_date": 1547725152, "creation_date": 1547664891, "question_id": 54223545, "link": "https://stackoverflow.com/questions/54223545/different-sha1-hash-result-in-powershell-and-ruby", "title": "Different SHA1 hash result in Powershell and Ruby", "body": "<p>We have script written in powershell to get some information from users terminal. And have created SHA1 of that information, just to verify integrity of result. </p>\n\n<p>On server side where we get these information from multiple terminals, we are verifying each results and this side of script is being written in Ruby.</p>\n\n<p>Now problem, is that both these script are giving different SHA1 hash, and I am not sure where I am making mistake.</p>\n\n<p>Powershell code is as given below.</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>$String = \"\n\n    Directory: D:\\OneDrive -\n    ControlCase\\jt-work\\evidance-collection\\evidances-text\\PCI_Evidences_CCIN-CAS-VKAUS\\evidences\n\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2019-01-16   1:14 PM       7073 21_to_calc_hash.ps1\n-a---        2019-01-16   1:15 PM       9973 CCIN-CAS-VKAUS_pci_evidence_Q21.txt\n-a---        2019-01-15   9:37 PM      67399 CCIN-CAS-VKAUS_pci_evidence_Q23.txt\n-a---        2019-01-15   9:37 PM       5055 CCIN-CAS-VKAUS_pci_evidence_Q34.txt\n-a---        2019-01-15   9:38 PM      10820 CCIN-CAS-VKAUS_pci_evidence_Q45.txt\n-a---        2019-01-15   9:38 PM      13129 CCIN-CAS-VKAUS_pci_evidence_Q50.txt\n-a---        2019-01-15   9:38 PM       7163 CCIN-CAS-VKAUS_pci_evidence_Q67.txt\n-a---        2019-01-15   9:39 PM       4301 CCIN-CAS-VKAUS_pci_evidence_Q69.txt\n-a---        2019-01-15   9:39 PM       2900 CCIN-CAS-VKAUS_pci_evidence_Q81.txt\n\n\"\n\nFunction Get-Hash([String] $String)\n{ \n$StringBuilder = New-Object System.Text.StringBuilder \n[System.Security.Cryptography.HashAlgorithm]::Create(\"sha1\").ComputeHash([System.Text.Encoding]::UTF8.GetBytes($String))|%{ \n[Void]$StringBuilder.Append($_.ToString(\"x2\")) \n} \n$StringBuilder.ToString() \n}\n\nGet-Hash($String)\n</code></pre>\n\n<p>and this the hash we get for above script <code>e7c527068445c52635287b9ecf55566c2564d595</code></p>\n\n<p>below is Ruby script</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'digest'\nvarj = \"\n\nDirectory: D:\\OneDrive -\nControlCase\\jt-work\\evidance-collection\\evidances-text\\PCI_Evidences_CCIN-CAS-VKAUS\\evidences\n\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        2019-01-16   1:14 PM       7073 21_to_calc_hash.ps1\n-a---        2019-01-16   1:15 PM       9973 CCIN-CAS-VKAUS_pci_evidence_Q21.txt\n-a---        2019-01-15   9:37 PM      67399 CCIN-CAS-VKAUS_pci_evidence_Q23.txt\n-a---        2019-01-15   9:37 PM       5055 CCIN-CAS-VKAUS_pci_evidence_Q34.txt\n-a---        2019-01-15   9:38 PM      10820 CCIN-CAS-VKAUS_pci_evidence_Q45.txt\n-a---        2019-01-15   9:38 PM      13129 CCIN-CAS-VKAUS_pci_evidence_Q50.txt\n-a---        2019-01-15   9:38 PM       7163 CCIN-CAS-VKAUS_pci_evidence_Q67.txt\n-a---        2019-01-15   9:39 PM       4301 CCIN-CAS-VKAUS_pci_evidence_Q69.txt\n-a---        2019-01-15   9:39 PM       2900 CCIN-CAS-VKAUS_pci_evidence_Q81.txt\n\n\"\n\nvarj_Encoded = varj.encode(Encoding::ISO_8859_1)\nputs Digest::SHA1.hexdigest(varj_Encoded)\n</code></pre>\n\n<p>and here is the SHA1 has we get from this script. <code>77f7cecb2b75c16b1e929a56b644fad7d7f95965</code></p>\n\n<p>Now condition here is, I can't make/propose any changes in Powershell part. I need to tune ruby code to make it match.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547716197, "post_id": 54223205, "comment_id": 95289657, "body": "Thanks for taking the time to answer, I just don&#39;t see why they removed a method that has obvious uses, various posts on SO make use of it. As you suggest I&#39;ll be going down the route of whitelisted scopes that I check against the scope sent through"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547716565, "post_id": 54223205, "comment_id": 95289863, "body": "Somewhere along the way the behavior of <code>scope</code> changed and scopes and class methods became the same thing. That left no way to differentiate between <code>scope</code>-generated class methods, scopes directly implemented as class methods, and other class methods. The <code>scopes</code> method went away because it became impossible to implement and presumably wasn&#39;t considered important enough to force all scopes to be declared using <code>scope</code>. Whitelisting these things is a good idea anyway."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 1, "last_activity_date": 1547663271, "creation_date": 1547663271, "answer_id": 54223205, "question_id": 54221550, "link": "https://stackoverflow.com/questions/54221550/rails-apply-an-array-of-scopes/54223205#54223205", "title": "Rails - apply an array of scopes", "body": "<p>From the <a href=\"https://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"nofollow noreferrer\">fine guide</a>:</p>\n\n<blockquote>\n  <p><strong>14 Scopes</strong><br>\n  [...]<br>\n  To define a simple scope, we use the scope method inside the class, passing the query that we'd like to run when this scope is called:</p>\n\n<pre><code>class Article &lt; ApplicationRecord\n  scope :published, -&gt; { where(published: true) }\nend\n</code></pre>\n  \n  <p>This is exactly the same as defining a class method, and which you use is a matter of personal preference:</p>\n\n<pre><code>class Article &lt; ApplicationRecord\n  def self.published\n    where(published: true)\n  end\nend\n</code></pre>\n</blockquote>\n\n<p>So <code>scope</code> is mostly just a fancy way of creating a class method that is supposed to have certain behavior (i.e. return a relation) and any class method method that returns a relation is a scope. <code>scope</code> used to be something special but now they're just class methods and all the class methods are copied to relations to support chaining.</p>\n\n<p>There is no way to know if method <code>Model.m</code> is a \"real\" scope that will return a relation or some random class method without running it and checking what it returns or manually examining its source code. The <code>scopes</code> method you seek is gone and will never come back.</p>\n\n<p>You could try to blacklist every class method that you know is bad; this way lies bugs and madness.</p>\n\n<p>The only sane option is to whitelist every class method that you know is good and is something that you want users to be able to call. Then you should filter the <code>scopes</code> array up in the controller and inside <code>AssignableLearningObjectives::Collector</code>. I'd check in both places because you could have different criteria for what is allowed depending on what information is available and what path you're taking through the code; slightly less DRY I suppose but efficiency and robustness aren't friends.</p>\n\n<p>You could apply the scope whitelist in the <code>AssignableLearningObjectives::Collector</code> constructor or in <code>available_objectives</code>.</p>\n\n<hr>\n\n<p>If you want something prettier than:</p>\n\n<pre><code>scopes.each{ |scope| objectives = objectives.send(scope) }\nobjectives\n</code></pre>\n\n<p>then you could use <code>inject</code>:</p>\n\n<pre><code>def available_objectives\n  objectives = assignable_objectives....\n  scopes.inject(objectives) { |objectives, scope| objectives.send(scope) }\nend\n</code></pre>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 54223205, "answer_count": 1, "score": 1, "last_activity_date": 1547663271, "creation_date": 1547656754, "last_edit_date": 1547658275, "question_id": 54221550, "link": "https://stackoverflow.com/questions/54221550/rails-apply-an-array-of-scopes", "title": "Rails - apply an array of scopes", "body": "<p>I have a class that takes an array of scopes and applies them iteratively:</p>\n\n<pre><code>class AssignableLearningObjectives::Collector\n  def initialize(user:, only_self_assignable: false, scopes: [])\n    @user = user\n    @only_self_assignable = only_self_assignable\n    @scopes = scopes\n  end\n\n  .....\n\n  def available_objectives\n    objectives = assignable_objectives.or(manager_assigned_objectives).or(global_objectives).distinct\n    return objectives unless scopes.any?\n\n    scopes.each{ |scope| objectives = objectives.send(scope) }\n    objectives\n  end\n</code></pre>\n\n<p>My issue is with</p>\n\n<pre><code>scopes.each{ |scope| objectives = objectives.send(scope) }\nobjectives\n</code></pre>\n\n<p>Is there a better way of doing this? I was hoping for a rails method apply_scopes or something like that, however can't find anything like that.</p>\n\n<p>My concern is the scopes are sent from the controller, and it is possible for the user to submit a request with a scope of 'destroy_all' or something equally fun.</p>\n\n<p>Is there an easy way for me to let rails handle this? Or will I need to manually check each scope before I apply it to the collection?</p>\n\n<p>Thanks in advance</p>\n\n<p>EDIT:</p>\n\n<p>I'm happy to validate each scope individually if I have to, but even that's causing issues. There is a method in rails which was dropped in 3.0.9 which I could use, Model.scopes :</p>\n\n<p><a href=\"https://apidock.com/rails/v3.0.9/ActiveRecord/NamedScope/ClassMethods/scopes\" rel=\"nofollow noreferrer\">https://apidock.com/rails/v3.0.9/ActiveRecord/NamedScope/ClassMethods/scopes</a></p>\n\n<p>however that's deprecated. Is there any method I can call on a class to list its scopes? I can't believe the feature was there in rails 3 and removed completely...</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1547662316, "post_id": 54220654, "comment_id": 95271768, "body": "Is your data in a table, or are you dealing with an array of arrays (perhaps drawn from a file)?"}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 5641247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MnnpZ.jpg?s=128&g=1", "display_name": "Tori Huang", "link": "https://stackoverflow.com/users/5641247/tori-huang"}, "edited": false, "score": 0, "creation_date": 1547740475, "post_id": 54221070, "comment_id": 95303933, "body": "Wouldn&#39;t this return a single number?"}], "tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": true, "score": 3, "last_activity_date": 1547772786, "last_edit_date": 1547772786, "creation_date": 1547655070, "answer_id": 54221070, "question_id": 54220654, "link": "https://stackoverflow.com/questions/54220654/rails-group-collection-and-sum-certain-fields/54221070#54221070", "title": "Rails group collection and sum certain fields", "body": "<p>if the company and invoice in one table for example your model is Invoice </p>\n\n<pre><code>Invoice.group(:company_name).sum(:total)\n\n# sample implementation how to get data and print the result\n\ndata_result = Invoice.group(:company_name).sum(:total) \n\ndata_result.each do |v|\n  puts \"company #{v[0]} total number #{v[1]}\"\nend\n\n# this will print\n# company Red Roses Inc total number 1700\n# company Blue Birds LLC total number 110\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 5641247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MnnpZ.jpg?s=128&g=1", "display_name": "Tori Huang", "link": "https://stackoverflow.com/users/5641247/tori-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 54221070, "answer_count": 1, "score": 1, "last_activity_date": 1547772786, "creation_date": 1547653586, "last_edit_date": 1547740512, "question_id": 54220654, "link": "https://stackoverflow.com/questions/54220654/rails-group-collection-and-sum-certain-fields", "title": "Rails group collection and sum certain fields", "body": "<p>New to Rails, but I cannot find this feature!</p>\n\n<p>Say you have a collection of invoices that includes an id, company name, and invoice total. For some reason, there are multiple companies with the same name. You want to create a 1xn matrix, where each row contains company data with a unique company name.</p>\n\n<p>How can you group together companies with the same name, and add together their invoice totals. You do not care which id is saved to the row. Is the only way to use Group + Map?</p>\n\n<p>e.g.</p>\n\n<pre><code>[1523, 'Red Roses Inc', 1300.00],\n[4126, 'Blue Birds LLC', 110.00],\n[846, 'Red Roses Inc', 400.00],\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>[1523, 'Red Roses Inc', 1700.00],\n[846, 'Blue Birds LLC', 110.00],\n</code></pre>\n"}, {"tags": ["html", "ruby", "erb"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "edited": false, "score": 0, "creation_date": 1547819858, "post_id": 54222285, "comment_id": 95334846, "body": "Thank @DannyB, that helped. There is another one I am struggling with: <code>type: t(&quot;element_names.#{@data[&#39;consultancy&#39;]}&quot;))</code> . I tried:    <code>&lt;%= type: t(&quot;element_names.&lt;%=@data[&#39;consultancy&#39;]%&gt;&quot;)%&gt;</code> and <code>&lt;% t(&quot;element_names.@data[&#39;consultancy&#39;]&quot;)%&gt;</code> , but looks like it isn&#39;t the right way."}, {"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "reply_to_user": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "edited": false, "score": 0, "creation_date": 1547820440, "post_id": 54222285, "comment_id": 95335141, "body": "I suggest you read a little about slim and a little about ERB, it will eliminate most of the guesswork. I am guessing <code>type</code> is generating an HTML <code>&lt;type&gt;</code> tag when the slim is evaluated? In ERB, you explicitly write your HTML, and just use ERB tags when you want Embedded Ruby: <code>&lt;type&gt;&lt;%= t(...) %&gt;&lt;&#47;type&gt;</code>. See <a href=\"https://stackoverflow.com/questions/7996695/what-is-the-difference-between-and-in-erb-in-rails\">this ERB tags SO question</a>"}], "tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": true, "score": 1, "last_activity_date": 1547659530, "creation_date": 1547659530, "answer_id": 54222285, "question_id": 54220553, "link": "https://stackoverflow.com/questions/54220553/html-slim-to-html-erb-href-reference/54222285#54222285", "title": "HTML.SLIM to HTML.ERB href reference", "body": "<p>Have you tried this?</p>\n\n<pre><code>&lt;a href=\"&lt;%= service_url(id: @data['service_id']) %&gt;\" class=...\n</code></pre>\n\n<p>The automatic string substitution that slim gives you (with the <code>#{var}</code> syntax) is not available in ERB, so you need to use explicit ERB output tags.</p>\n"}], "owner": {"reputation": 57, "user_id": 10192484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvZCXCg8noI/AAAAAAAAAAI/AAAAAAAAAAs/vofhCY8M0MQ/photo.jpg?sz=128", "display_name": "Pandation", "link": "https://stackoverflow.com/users/10192484/pandation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 54222285, "answer_count": 1, "score": 0, "last_activity_date": 1547659530, "creation_date": 1547653273, "last_edit_date": 1547657756, "question_id": 54220553, "link": "https://stackoverflow.com/questions/54220553/html-slim-to-html-erb-href-reference", "title": "HTML.SLIM to HTML.ERB href reference", "body": "<p>Stuck with href when moving content from html.slim to html.erb</p>\n\n<p>slim</p>\n\n<pre><code>a[href=\"#{service_url(id: @data['service_id'])}\"]\n</code></pre>\n\n<p>Tried few in options in .erb - none worked:</p>\n\n<pre><code>&lt;a href=\"#{service_url(id: @data['service_id'])}\" class=...\n\n&lt;ahref=\"#{service_url(id: @data['service_id'])}\" class= ...\n\n&lt;a [href=\"#{service_url(id: @data['service_id'])}\"] class= ...\n\n&lt;a[href=\"#{service_url(id: @data['service_id'])}\"] class= ...\n\n&lt;a :href=\"#{service_url(id: @data['service_id'])}\" class= ...\n</code></pre>\n\n<p>I tried converting the code using methods provided <a href=\"https://stackoverflow.com/questions/28316036/how-can-i-convert-html-slim-files-to-html-or-html-erb\">here</a> but I'm not getting any output.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547649149, "post_id": 54219282, "comment_id": 95264213, "body": "Why is this better than just adding the method to the string class directly?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547650055, "post_id": 54219282, "comment_id": 95264804, "body": "<code>&quot;Charlotte&quot;.extend(MyStringPatch).already_taken?</code> would add the methods to that instance only, leaving the <code>String</code> class unchanged."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547651967, "post_id": 54219282, "comment_id": 95265999, "body": "Sure, but why is including the module better than just adding the already_taken? method directly into the string class? Class String def already_taken? end end"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547662824, "post_id": 54219282, "comment_id": 95272004, "body": "@Mark, this is just my opinion: is cleaner, DRYer, useful for mixin and prevent to override default methods, where both opening the class or <code>String.prepend MyStringPatch</code> do. Here an interesting post: <a href=\"https://stackoverflow.com/questions/4470108/when-monkey-patching-a-method-can-you-call-the-overridden-method-from-the-new-i\" title=\"when monkey patching a method can you call the overridden method from the new i\">stackoverflow.com/questions/4470108/&hellip;</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1547715840, "post_id": 54219282, "comment_id": 95289445, "body": "One reason this is better is that if someone is looking at your code and wondering where this method comes from, they can do something like <code>&#39;Charlotte&#39;.method(:already_taken?).owner #=&gt; MyStringPatch</code>, and it is very clear where the method comes from. Even better if the name of the module were more self-explanatory than just <code>MyStringPatch</code>."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1547649052, "creation_date": 1547649052, "answer_id": 54219282, "question_id": 54219181, "link": "https://stackoverflow.com/questions/54219181/can-i-call-a-custom-method-on-an-object-with-this-notation/54219282#54219282", "title": "Can I call a custom method on an object with this notation?", "body": "<p>You could patch the String class with a custom module:</p>\n\n<pre><code>module MyStringPatch\n\n  def already_taken?\n    'yes'\n  end\n\nend\n\nString.include MyStringPatch\n\n\"Charlotte\".already_taken?\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10111321"}, "edited": false, "score": 0, "creation_date": 1547653078, "post_id": 54219384, "comment_id": 95266656, "body": "Thank you, Danny! This is exactly what I was after. Also, one more question: Is this considered a bad implementation compared to just modifying the String class?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547653742, "post_id": 54219384, "comment_id": 95267086, "body": "@MihkelPajunen in general, you should avoid modifying Ruby&#39;s build-in classes."}, {"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547658927, "post_id": 54219384, "comment_id": 95270063, "body": "Both Refinements and monkey patching have their place. Refinements is a good practice especially when you know you want the method &quot;locally&quot;. Monkey patching (i.e. opening the <code>String</code> class) is NOT considered bad practice if used with caution. For example, in your own projects, if you need a globally available method. But if it is something local, or if you develop a gem for public consumption - I would consider if monkey patching is needed. And I disagree with @Stefan&#39;s comment above - Ruby has open classes for this exact reason and many widely used projects monkey patch everything."}], "tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": true, "score": 1, "last_activity_date": 1547649378, "creation_date": 1547649378, "answer_id": 54219384, "question_id": 54219181, "link": "https://stackoverflow.com/questions/54219181/can-i-call-a-custom-method-on-an-object-with-this-notation/54219384#54219384", "title": "Can I call a custom method on an object with this notation?", "body": "<p>If you want to add methods to any class (<code>String</code> in this case), without monkey-patching it, you should consider using <a href=\"https://ruby-doc.org/core-2.5.0/doc/syntax/refinements_rdoc.html\" rel=\"nofollow noreferrer\">Refinements</a>.</p>\n\n<pre><code>module StringRefinements \n  refine String do\n    def already_taken?\n      puts \"yes!\"\n    end\n  end\nend\n\n# in another file...\nusing StringRefinements\n\"Charlotte\".already_taken?\n</code></pre>\n\n<p>The <code>already_taken?</code> method will only be available in a scope that calls <code>using StringRefinements</code> and nowhere else.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10111321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54219384, "answer_count": 2, "score": 0, "last_activity_date": 1547649378, "creation_date": 1547648739, "question_id": 54219181, "link": "https://stackoverflow.com/questions/54219181/can-i-call-a-custom-method-on-an-object-with-this-notation", "title": "Can I call a custom method on an object with this notation?", "body": "<p>This is an example of what I am after:</p>\n\n<pre><code>def already_taken?\n  # Magic goes here...\nend\n\n\"Charlotte\".already_taken?\n</code></pre>\n\n<p>Would it be possible to construct a method in a way where I can call it directly on a String object, without having to modify the String class itself?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1547646643, "post_id": 54218217, "comment_id": 95262586, "body": "What if when I create the query I just concat the rules using <code>rules.order(:id).each do ...</code>. would that be enough? (asking because it&#39;s hard to test since error appears rarely)"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 1, "creation_date": 1547647050, "post_id": 54218217, "comment_id": 95262854, "body": "That should be enough, if your database assign ids monotonically, i.e. next id is bigger than the previous one."}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1547647087, "post_id": 54218217, "comment_id": 95262876, "body": "Awesome. I will make sure to run it a couple times before marking as answer thank you!"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1547645624, "creation_date": 1547645624, "answer_id": 54218217, "question_id": 54218095, "link": "https://stackoverflow.com/questions/54218095/rspec-assert-that-two-sql-queries-are-the-same/54218217#54218217", "title": "Rspec assert that two sql queries are the same", "body": "<p>It looks that it is related to ordering of your rules in <code>segment.customers</code>. As they are created one just after another, it's possible that their timestamps in <code>created_at</code> are the same.</p>\n\n<p>I would order them explicitly and add data that supports it in the spec, e.g.:</p>\n\n<pre><code>let!(:rule1) do\n  Rule.create!(segment: segment, filter_key: 'generic',\n               attr_name: 'first_name', operator: '=', values: ['john'],\n               created_at: 2.days.ago)\nend\n\nlet!(:rule2) do\n  Rule.create!(segment: segment, filter_key: 'generic',\n               attr_name: 'orders_count', operator: '&gt;=', values: ['3'],\n               created_at: 1.day.ago)\nend\n</code></pre>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 54218217, "answer_count": 1, "score": 1, "last_activity_date": 1547658546, "creation_date": 1547645198, "last_edit_date": 1592644375, "question_id": 54218095, "link": "https://stackoverflow.com/questions/54218095/rspec-assert-that-two-sql-queries-are-the-same", "title": "Rspec assert that two sql queries are the same", "body": "<p>I am using rpsec to assert that a certain method generates the expected query:</p>\n<pre><code>describe '.customers' do\n\n    let(:segment) { create(:segment) }\n    \n    let!(:rule1) do\n      Rule.create!(segment: segment, filter_key: 'generic',\n                   attr_name: 'first_name', operator: '=', values: ['john'])\n    end\n    \n    let!(:rule2) do\n      Rule.create!(segment: segment, filter_key: 'generic',\n                   attr_name: 'orders_count', operator: '&gt;=', values: ['3'])\n    end\n    \n    let(:actual_query) { segment.customers.to_sql }\n    let(:expected_query) do\n      Customer\n        .where('first_name = john')\n        .where('orders_count &gt;= 3')\n        .to_sql\n    end\n    \n    it 'applies all the rules scopes to customer' do\n      expect(actual_query).to eq(expected_query)\n    end\n\nend\n</code></pre>\n<p>It usually passes, the thing is that sometimes (for some reason) the <code>where</code> clauses in one of the sql queries get reordered so, since the <code>to_sql</code> is actually the string of the query to execute, sometimes it fails saying:</p>\n<blockquote>\n<p>Failure/Error: expect(actual_query).to eq(expected_query)</p>\n<pre><code> expected: &quot;SELECT \\&quot;customers\\&quot;.* FROM \\&quot;customers\\&quot; WHERE (orders_count &gt;= '3') AND (first_name = 'john')&quot;\n\n    got: &quot;SELECT \\&quot;customers\\&quot;.* FROM \\&quot;customers\\&quot; WHERE (first_name = 'john') AND (orders_count &gt;= '3')&quot;\n (compared using ==)\n</code></pre>\n</blockquote>\n<p>when they are actually the same in terms of the execution.\n<strong>Any ideas on how else to assert the two queries are the same without having to add test customers to compare the queries after they executed</strong>?</p>\n"}, {"tags": ["ruby", "each", "typeerror"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1547644223, "post_id": 54217484, "comment_id": 95261143, "body": "Seems to be related to <code>graph_nums</code>, why don&#39;t you show how you set / assign it?"}, {"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547644366, "post_id": 54217484, "comment_id": 95261218, "body": "I should have, the array was made using gets, so the numbers were strings."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1547643759, "post_id": 54217605, "comment_id": 95260892, "body": "That&#39;s done it. The array was made using gets, does that always result in strings?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 2, "creation_date": 1547643836, "post_id": 54217605, "comment_id": 95260938, "body": "Yes, <code>gets</code> gives you a string"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1547643574, "creation_date": 1547643574, "answer_id": 54217605, "question_id": 54217484, "link": "https://stackoverflow.com/questions/54217484/using-array-each-x-puts-x-to-draw-a-bar-graph-made-from-multiple-th/54217605#54217605", "title": "Using &#39;array.each { |x| puts x }&#39; to draw a bar graph made from multiple &quot;-&quot;, throws a TypeError", "body": "<p>The solution you posted works:</p>\n\n<pre><code>[4] pry(main)&gt; graph_nums = [1,2,3,4,5,6]\n=&gt; [1, 2, 3, 4, 5, 6]\n[5] pry(main)&gt; graph_nums.each {|x| puts \"-\" * x}\n-\n--\n---\n----\n-----\n------\n=&gt; [1, 2, 3, 4, 5, 6]\n</code></pre>\n\n<p>Most probably <code>graph_nums</code> is an array of strings. You can convert them to integers using <code>String#to_i</code>:</p>\n\n<pre><code>[6] pry(main)&gt; graph_nums = ['1','2','3','4','5','6']\n=&gt; [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\"]\n[7] pry(main)&gt; graph_nums.each {|x| puts \"-\" * x}\nTypeError: no implicit conversion of String into Integer\nfrom (pry):7:in `*'\n[8] pry(main)&gt; graph_nums.each {|x| puts \"-\" * x.to_i}\n-\n--\n---\n----\n-----\n------\n=&gt; [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\"]\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 54217605, "answer_count": 1, "score": 0, "last_activity_date": 1547643574, "creation_date": 1547643150, "question_id": 54217484, "link": "https://stackoverflow.com/questions/54217484/using-array-each-x-puts-x-to-draw-a-bar-graph-made-from-multiple-th", "title": "Using &#39;array.each { |x| puts x }&#39; to draw a bar graph made from multiple &quot;-&quot;, throws a TypeError", "body": "<pre><code>graph_nums.each {|x| puts \"-\" * x}\n</code></pre>\n\n<p>graph_nums is an array of numbers, and I'm trying to represent each number as multiples of \"-\", e.g. 3 would be \"---\".</p>\n\n<pre><code>i = 3\ngraph_nums.each {|x| puts \"-\" * i}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>graph_nums.each {|x| puts \"-\" * 3}\n</code></pre>\n\n<p>Both behave as expected. And</p>\n\n<pre><code>graph_nums.each {|x| puts x}\n</code></pre>\n\n<p>Returns the numbers, but combining these ideas throws an error.</p>\n\n<pre><code>graph_nums.each {|x| puts \"-\" * graph_nums[0]}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>graph_nums.each {|x| puts \"-\" * x}\n</code></pre>\n\n<p>`*': no implicit conversion of String into Integer (TypeError)</p>\n\n<p>For an array of numbers 1-6, I'd expect to see</p>\n\n<pre><code>-\n--\n---\n----\n-----\n------\n</code></pre>\n\n<p>Why does one or the other work, but not both? Is there a solution using this format, or do I need to go the long way round?</p>\n"}, {"tags": ["ruby", "rom-rb", "rom-sql"], "comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1547646299, "post_id": 54217171, "comment_id": 95262368, "body": "Instead of writing <code>does not work</code>, please give us the actual result; what&#39;s the error? or was it silent? what happened?"}, {"owner": {"reputation": 4166, "user_id": 376378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a439d0912d0e079d3a5f8cd44c070b6e?s=128&d=identicon&r=PG", "display_name": "cutalion", "link": "https://stackoverflow.com/users/376378/cutalion"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1547647968, "post_id": 54217171, "comment_id": 95263427, "body": "@TamerShlash question updated. It was an undefined method error from internals of rom-sql."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 2795430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dGFyy.jpg?s=128&g=1", "display_name": "Vasily Kolesnikov", "link": "https://stackoverflow.com/users/2795430/vasily-kolesnikov"}, "is_accepted": false, "score": 1, "last_activity_date": 1552558797, "creation_date": 1552558797, "answer_id": 55160005, "question_id": 54217171, "link": "https://stackoverflow.com/questions/54217171/how-to-pluck-aliased-column-from-joined-tables-in-rom-sql/55160005#55160005", "title": "How to pluck aliased column from joined tables in rom-sql?", "body": "<p>It's impossible to suggest any solution if the version of the used libraries is not specified. For <code>rom-sql 2.4.0</code> it just works:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#!/usr/bin/env ruby\n\n# frozen_string_literal: true\n\nrequire 'bundler/inline'\n\ngemfile(false) do\n  source 'https://rubygems.org'\n\n  gem 'sqlite3'\n  gem 'rom-sql', '2.4.0'\n  gem 'rspec'\nend\n\nrequire 'rspec'\nrequire 'rspec/autorun'\n\nrequire 'dry-types'\nrequire 'rom-sql'\nrequire 'sqlite3'\n\nRSpec.describe do\n  let(:uri) { 'sqlite::memory' }\n  let(:conn) { Sequel.connect(uri) }\n  let(:conf) { ROM::Configuration.new(:sql, conn) }\n  let(:container) { ROM.container(conf) }\n\n  let(:avatars) { container.relations[:avatars] }\n  let(:users) { container.relations[:users] }\n\n  before do\n    conn.create_table(:avatars) do\n      primary_key :id\n      Integer :user_id\n      String :url\n    end\n\n    conn.create_table(:users) { primary_key :id }\n\n    conf.relation(:avatars) do\n      schema(infer: true) do\n        associations do\n          belongs_to :user\n        end\n      end\n    end\n\n    conf.relation(:users) do\n      schema(infer: true) do\n        associations do\n          has_many :avatars\n        end\n      end\n    end\n  end\n\n  subject(:relation) do\n    users.join(:avatars).select { relations[:avatars][:url].as(:avatar_url) }\n  end\n\n  it do\n    users.insert\n    avatars.insert(user_id: 1, url: 'avatars/1')\n    avatars.insert(user_id: 1, url: 'avatars/2')\n\n    expect { relation.pluck(:avatar_url) }.not_to raise_error\n    expect(relation.pluck(:avatar_url)).to eq ['avatars/1', 'avatars/2']\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 4166, "user_id": 376378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a439d0912d0e079d3a5f8cd44c070b6e?s=128&d=identicon&r=PG", "display_name": "cutalion", "link": "https://stackoverflow.com/users/376378/cutalion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552558797, "creation_date": 1547641975, "last_edit_date": 1547647877, "question_id": 54217171, "link": "https://stackoverflow.com/questions/54217171/how-to-pluck-aliased-column-from-joined-tables-in-rom-sql", "title": "How to pluck aliased column from joined tables in rom-sql?", "body": "<p>I cannot find how to pluck aliased column using rom-sql.</p>\n\n<p>Given relations users and avatars (user has many avatars).</p>\n\n<pre><code># works\nusers.join(:avatars).select { |r| r.avatars[:id] }.pluck(:id)\n\n# does not work\nusers.join(:avatars).select { |r| r.avatars[:id].as(:avatar_id) }.pluck(:avatar_id)\n# NoMethodError: undefined method `[]' for nil:NilClass\n# from /usr/local/bundle/gems/rom-core-4.2.1/lib/rom/schema.rb:195:in `[]'\n\n# more examples\nusers.join(:avatars).select{|r| r.avatars[:id].as('avatar_id')}                                           \n#=&gt; #&lt;Persistence::Relations::Users name=ROM::Relation::Name(users) dataset=#&lt;Sequel::Postgres::Dataset: \"SELECT \\\"avatars\\\".\\\"id\\\" AS \\\"avatar_id\\\" FROM \\\"users\\\" INNER JOIN \\\"avatars\\\" ON (\\\"users\\\".\\\"id\\\" = \\\"avatars\\\".\\\"user_id\\\") ORDER BY \\\"users\\\".\\\"id\\\"\"&gt;&gt;\n\nusers.join(:avatars).select{|r| r.avatars[:id].as('avatar_id')}.to_a\n#&gt; Dry::Struct::Error: [Entities::User.new] :avatar_id is missing in Hash input\n\nusers.join(:avatars).select{|r| r.avatars[:id].as('avatar_id')}.with(auto_struct: false).to_a\n#=&gt; [{:avatar_id=&gt;88}, {:avatar_id=&gt;89}]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1176, "user_id": 2750877, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/65fe7528984db6c53fa2e13e9b574708?s=128&d=identicon&r=PG&f=1", "display_name": "bork", "link": "https://stackoverflow.com/users/2750877/bork"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547642225, "post_id": 54216816, "comment_id": 95260016, "body": "No, updated the code in my question"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1547642410, "post_id": 54216816, "comment_id": 95260122, "body": "Do <code>p b[i]</code> instead of <code>puts b[i]</code>. One of your hashes is nil (when you think it isn&#39;t)"}, {"owner": {"reputation": 1176, "user_id": 2750877, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/65fe7528984db6c53fa2e13e9b574708?s=128&d=identicon&r=PG&f=1", "display_name": "bork", "link": "https://stackoverflow.com/users/2750877/bork"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547642758, "post_id": 54216816, "comment_id": 95260303, "body": "Ah, that was the issue, post this as an answer and I&#39;ll accept it!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547644659, "post_id": 54216816, "comment_id": 95261371, "body": "@bork what about the last example with <code>puts b[i]</code> \u2013 how could that possibly work if one of the hashes is in fact <code>nil</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1547641629, "post_id": 54216938, "comment_id": 95259721, "body": "FWIW, <code>with_index</code> accepts an argument for starting index. <code>.with_index(1)</code> allows to avoid nasty <code>#{index + 1</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547642876, "post_id": 54216938, "comment_id": 95260364, "body": "@SergioTulentsev that\u2019s why it has \u201cFWIW\u201d opening :) Turns out I cannot do Ruby anymore, it literally hurts. The language is so stupid :-P"}], "tags": [], "owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "is_accepted": false, "score": 0, "last_activity_date": 1547641099, "creation_date": 1547641099, "answer_id": 54216938, "question_id": 54216816, "link": "https://stackoverflow.com/questions/54216816/how-can-i-print-content-from-an-array-inside-each-with-index-based-on-the-index/54216938#54216938", "title": "How can I print content from an array inside each_with_index based on the index?", "body": "<p>You don't need <code>a</code> array</p>\n\n<pre><code>b.map(&amp;:values).map.with_index {|(item, quantity), index| \n \"#{index + 1}. #{item} #{quantity}\"\n}.join(' ')\n=&gt; \"1. apple 92 2. banana 43 3. kiwi 55\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547643266, "post_id": 54217072, "comment_id": 95260603, "body": "This is not any different from what they&#39;re doing."}], "tags": [], "owner": {"reputation": 5, "user_id": 847903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0066b6e8e6247e6809601acc6e57976?s=128&d=identicon&r=PG", "display_name": "Ali Mujtaba", "link": "https://stackoverflow.com/users/847903/ali-mujtaba"}, "is_accepted": false, "score": 0, "last_activity_date": 1547641614, "creation_date": 1547641614, "answer_id": 54217072, "question_id": 54216816, "link": "https://stackoverflow.com/questions/54216816/how-can-i-print-content-from-an-array-inside-each-with-index-based-on-the-index/54217072#54217072", "title": "How can I print content from an array inside each_with_index based on the index?", "body": "<p>Try following:</p>\n\n<pre><code>a = [1, 2, 3]\nb = [{:item =&gt; 'apple', :quantity =&gt; 92}, {:item =&gt; 'banana', :quantity =&gt; 43}, {:item =&gt; 'kiwi', :quantity =&gt; 55}]\n\na.each_with_index do |a_value, i| \n  puts \"#{a_value}. #{b[i][:item]} #{b[i][:quantity]}\"\nend\n</code></pre>\n\n<p>this will output:</p>\n\n<pre><code>1. apple 92\n2. banana 43\n3. kiwi 55\n</code></pre>\n\n<p>OR if you want to have an output like</p>\n\n<pre><code>1. apple 92 2. banana 43 3. kiwi 55\n</code></pre>\n\n<p>then you can use map with index</p>\n\n<pre><code>output = a.map.with_index do |a_value, i| \n  \"#{a_value}. #{b[i][:item]} #{b[i][:quantity]}\"\nend.join(' ')\nputs output\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1547642942, "creation_date": 1547642942, "answer_id": 54217426, "question_id": 54216816, "link": "https://stackoverflow.com/questions/54216816/how-can-i-print-content-from-an-array-inside-each-with-index-based-on-the-index/54217426#54217426", "title": "How can I print content from an array inside each_with_index based on the index?", "body": "<blockquote>\n  <p>but I can't specify a key inside the hash to print the content of? What's up with that?</p>\n</blockquote>\n\n<p>This doesn't make sense, of course. If you have a hash, you can get its keys/values. The problem here is that you <em>don't</em> have a hash. Instead, one of your <code>b[i]</code> is nil (which triggers the error).</p>\n\n<p>Check this by printing them with <code>p b[i]</code> instead of <code>puts b[i]</code>.</p>\n"}], "owner": {"reputation": 1176, "user_id": 2750877, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/65fe7528984db6c53fa2e13e9b574708?s=128&d=identicon&r=PG&f=1", "display_name": "bork", "link": "https://stackoverflow.com/users/2750877/bork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 54217426, "answer_count": 3, "score": 0, "last_activity_date": 1547642942, "creation_date": 1547640695, "last_edit_date": 1547642202, "question_id": 54216816, "link": "https://stackoverflow.com/questions/54216816/how-can-i-print-content-from-an-array-inside-each-with-index-based-on-the-index", "title": "How can I print content from an array inside each_with_index based on the index?", "body": "<p>I have two arrays:</p>\n\n<pre><code>a = [1, 2, 3]\nb = [{:item =&gt; 'apple', :quantity =&gt; 92}, {:item =&gt; 'banana', :quantity =&gt; 43}, {:item =&gt; 'kiwi', :quantity =&gt; 55}]\n</code></pre>\n\n<p>And I want an output like so:</p>\n\n<pre><code>1. apple 92 2. banana 43 3. kiwi 55\n</code></pre>\n\n<p>Now, as it is important that each item in array <code>b</code> is aligned with the order of the values in array <code>a</code>, I decided to write an <code>each_with_index</code> loop so that I would be able to extract data at the desired position from array <code>b</code>:</p>\n\n<pre><code>a.each_with_index do |a_value, i| \n  puts a_value \n  puts '.' \n  puts b[i][:item] \n  puts b[i][:quantity]\nend\n</code></pre>\n\n<p>But I'm getting this error:</p>\n\n<pre><code>NoMethodError: undefined method `[]' for nil:NilClass\n    from (irb):8:in `block in irb_binding'\n    from (irb):8:in `each'\n    from (irb):8:in `each_with_index'\n    from (irb):8\n    from C:/RailsInstaller/Ruby2.3.3/bin/irb.cmd:19:in `&lt;main&gt;'\n</code></pre>\n\n<p>Which I find rather strange, because the hash at that position isn't empty.</p>\n\n<p>If I print the entire content of the array at that position it works, for example:</p>\n\n<pre><code>a.each_with_index do |a_value, i| \n  puts b[i]\nend\n</code></pre>\n\n<p>Which gives:</p>\n\n<pre><code>{:item =&gt; 'apple', :quantity =&gt; 92} \n{:item =&gt; 'banana', :quantity =&gt; 43} \n{:item =&gt; 'kiwi', :quantity =&gt; 55}\n</code></pre>\n\n<p>but I can't specify a key inside the hash to print the content of? What's up with that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547641357, "creation_date": 1547640061, "question_id": 54216658, "link": "https://stackoverflow.com/questions/54216658/active-record-includes-with-sti-is-not-working", "title": "Active record includes with STI is not working", "body": "<p>I have following models:</p>\n\n<pre><code>class User &lt; ApplicationRecord\nend\n\nclass Employer &lt; User\n  has_many :jobs\n  has_one :profile\nend\n\nclass JobSeeker &lt; User\nend\n\nclass Profile &lt; ApplicationRecord\n  belongs_to :employer\nend\n\nclass Job &lt; ApplicationRecord\n  belongs_to :employer\nend\n</code></pre>\n\n<p>There is a verified attribute on profile of employer. I need to get list of job which have verified profile of employer. For this i tried:</p>\n\n<pre><code>Job.includes(employer: :profile).where(profiles: {verified: true})\n</code></pre>\n\n<p>But this is giving me error</p>\n\n<blockquote>\n  <p>Job::ActiveRecord_Relation:0x3ff5d9d4a878</p>\n</blockquote>\n\n<p>i am not getting what is wrong. Thank you in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1547644157, "post_id": 54216495, "comment_id": 95261110, "body": "Can you please add your routes ?"}, {"owner": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "edited": false, "score": 0, "creation_date": 1547644329, "post_id": 54216495, "comment_id": 95261197, "body": "routes added above"}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 0, "creation_date": 1547644368, "post_id": 54216495, "comment_id": 95261219, "body": "what do you get when you do rake routes for <code>delete_image_attachment</code>"}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "edited": false, "score": 1, "creation_date": 1547644469, "post_id": 54216495, "comment_id": 95261274, "body": "Try with this <code>&lt;%= link_to &#39;remove&#39;,  delete_image_attachment_job_url(image_id: image),  method: :delete, data: { confirm: &#39;Are you sure?&#39; } %&gt;</code>  Also change in controller <code>images</code> -&gt; <code>image</code> <code>params[:id]</code> -&gt; <code>params[:image_id]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "edited": false, "score": 0, "creation_date": 1547645830, "post_id": 54217992, "comment_id": 95262074, "body": "No luck with this solution. I get a NoMethodError in Jobs#photoupload. Error is at line 13 ...link_to &#39;Remove&#39;, delete_image_attachment_job_url(image_id: image)"}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "reply_to_user": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "edited": false, "score": 0, "creation_date": 1547645990, "post_id": 54217992, "comment_id": 95262167, "body": "Please add <code>photoupload</code> method and its view"}, {"owner": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "edited": false, "score": 0, "creation_date": 1547646350, "post_id": 54217992, "comment_id": 95262403, "body": "I have added additional info to your answer"}, {"owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "reply_to_user": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "edited": false, "score": 0, "creation_date": 1547646602, "post_id": 54217992, "comment_id": 95262557, "body": "Please add this info in your question"}], "tags": [], "owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1547646590, "last_edit_date": 1547646590, "creation_date": 1547644891, "answer_id": 54217992, "question_id": 54216495, "link": "https://stackoverflow.com/questions/54216495/ruby-on-rails-active-storage-purge-delete-method-throws-nomethoderror/54217992#54217992", "title": "Ruby On Rails Active Storage purge/delete method throws NoMethodError", "body": "<p>I think problem is in your image loop in view and routes</p>\n\n<p>Some changes in view and iterate through <code>@job.images</code></p>\n\n<blockquote>\n  <p>This is without remote: true</p>\n</blockquote>\n\n<pre><code>&lt;% if @job.images.attached? %&gt;\n  &lt;br/&gt;\n\n  &lt;div class=\"row\"&gt;\n    &lt;% @job.images.each do |image| %&gt;\n    &lt;div class=\"col-md-4\"&gt;\n      &lt;div class=\"panel panel-default\"&gt;\n        &lt;div class=\"panel-heading preview\"&gt;\n          &lt;%= image_tag(image) %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"panel-body\"&gt;\n          &lt;span class=\"pull-right\"&gt;\n            &lt;%=\n            link_to 'Remove', delete_image_attachment_job_url(image_id: image)\n            method: :delete,\n            data: {confirm: \"Are you sure\"} do %&gt;\n              &lt;i class=\"fa fa-trash-o\" aria-hidden=\"true\"&gt;&lt;/i&gt;\n            &lt;% end %&gt;\n          &lt;/span&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>  def delete_image_attachment\n    @image = ActiveStorage::Attachment.find(params[:image_id])\n    @image.purge\n    redirect_back(fallback_location: request.referer)\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1079, "user_id": 9524409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6olWk.jpg?s=128&g=1", "display_name": "Paulo Belo", "link": "https://stackoverflow.com/users/9524409/paulo-belo"}, "is_accepted": false, "score": 0, "last_activity_date": 1547645272, "creation_date": 1547645272, "answer_id": 54218113, "question_id": 54216495, "link": "https://stackoverflow.com/questions/54216495/ruby-on-rails-active-storage-purge-delete-method-throws-nomethoderror/54218113#54218113", "title": "Ruby On Rails Active Storage purge/delete method throws NoMethodError", "body": "<p>Because you are using the block form of <code>link_to</code> you should put the text between do/end:</p>\n\n<pre><code>        &lt;%=\n        link_to delete_image_attachment_job_url(@job.images[image]),\n        remote: true,\n        method: :delete,\n        data: {confirm: \"Are you sure\"} do %&gt;\n          &lt;i class=\"fa fa-trash-o\" aria-hidden=\"true\"&gt;Remove&lt;/i&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>Like in the example from <a href=\"https://api.rubyonrails.org/v5.2.2/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>You can use a block as well if your link target is hard to fit into the name parameter. ERB example:</p>\n</blockquote>\n\n<pre><code>&lt;%= link_to(@profile) do %&gt;\n  &lt;strong&gt;&lt;%= @profile.name %&gt;&lt;/strong&gt; -- &lt;span&gt;Check it out!&lt;/span&gt;\n&lt;% end %&gt;\n# =&gt; &lt;a href=\"/profiles/1\"&gt;\n       &lt;strong&gt;David&lt;/strong&gt; -- &lt;span&gt;Check it out!&lt;/span&gt;\n     &lt;/a&gt;\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547646590, "creation_date": 1547639513, "last_edit_date": 1547644256, "question_id": 54216495, "link": "https://stackoverflow.com/questions/54216495/ruby-on-rails-active-storage-purge-delete-method-throws-nomethoderror", "title": "Ruby On Rails Active Storage purge/delete method throws NoMethodError", "body": "<p>I have a problem with my image purge/delete for images after they have been uploaded via Active Storage. I have tried to follow the instructions and I still get the same error. The error is described in command line as Template Error ::Error (undefined method 'stringify_keys' for ....</p>\n\n<p>Any suggestion would be great</p>\n\n<p><a href=\"https://i.stack.imgur.com/inwD2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/inwD2.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Command Line</strong></p>\n\n<pre><code>ActionView::Template::Error (undefined method `stringify_keys' for \"http://localhost:3000/jobs/21/delete_image_attachment\":String):\n    11:         &lt;div class=\"panel-body\"&gt;\n    12:           &lt;span class=\"pull-right\"&gt;\n    13:             &lt;%=\n    14:             link_to 'Remove', delete_image_attachment_job_url(@job.images[image]),\n    15:             remote: true,\n    16:             method: :delete,\n    17:             data: {confirm: \"Are you sure\"} do %&gt;\n\napp/views/jobs/_photos_list.html.erb:14:in `block in _app_views_jobs__photos_list_html_erb__192211306_83310024'\napp/views/jobs/_photos_list.html.erb:5:in `_app_views_jobs__photos_list_html_erb__192211306_83310024'\napp/views/jobs/photo_upload.html.erb:51:in `_app_views_jobs_photo_upload_html_erb___795227943_83576688'\n</code></pre>\n\n<p><strong>My Model</strong></p>\n\n<pre><code>class Job &lt; ApplicationRecord\n  belongs_to :user\n  has_many_attached :images\n\n  validates :job_category, presence: true\n  validates :job_type, presence: true\n  validates :recurrence, presence: true\n  #validates :job_title, presence: true\n  #validates :job_description, presence: true\n\nend\n</code></pre>\n\n<p><strong>The Controller</strong></p>\n\n<pre><code>class JobsController &lt; ApplicationController\n\n  before_action :set_job , except: [:index, :new, :create, :edit]\n  before_action :authenticate_user!, except: [:show]\n  before_action :is_authorised, only: [:listing, :budget, :description, :photo_upload, :location, :update, :show, :delete ]\n\n  def delete_image_attachment\n    @images = ActiveStorage::Attachment.find(params[:id])\n    @images.purge\n    redirect_back(fallback_location: request.referer)\n  end\n</code></pre>\n\n<p><strong>The View</strong></p>\n\n<pre><code>&lt;% if @job.images.attached? %&gt;\n  &lt;br/&gt;\n\n  &lt;div class=\"row\"&gt;\n    &lt;% (0...@job.images.count).each do |image| %&gt;\n    &lt;div class=\"col-md-4\"&gt;\n      &lt;div class=\"panel panel-default\"&gt;\n        &lt;div class=\"panel-heading preview\"&gt;\n          &lt;%= image_tag(@job.images[image]) %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"panel-body\"&gt;\n          &lt;span class=\"pull-right\"&gt;\n            &lt;%=\n            link_to 'Remove', delete_image_attachment_job_url(@job.images[image]),\n            remote: true,\n            method: :delete,\n            data: {confirm: \"Are you sure\"} do %&gt;\n              &lt;i class=\"fa fa-trash-o\" aria-hidden=\"true\"&gt;&lt;/i&gt;\n            &lt;% end %&gt;\n          &lt;/span&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>My Routes</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'pages#home'\n\n  resources :jobs_devs\n  resources :jobs\n\n  resources :jobs_devs, except: [:placeholder] do\n    member do\n      get 'listing'\n      get 'budget'\n      get 'description'\n      get 'photo_upload'\n      get 'featured'\n      get 'location'\n      get 'update'\n      get 'premium'\n      get 'show'\n      delete :delete_image_attachment\n    end\n  end\n\n  devise_for    :users,\n            :path =&gt; '',\n            :path_names =&gt; {:sign_in =&gt; 'login', :sign_out =&gt; 'logout', :edit =&gt; 'profile', :sign_up =&gt; 'registration'},\n            :controllers =&gt; {:omniauth_callbacks =&gt; 'omniauth_callbacks', :registrations =&gt; 'registrations' }\n\n  resources :users, only: [:show]\n  resources :jobs, except: [:edit] do\n    member do\n      get 'listing'\n      get 'budget'\n      get 'description'\n      get 'photo_upload'\n      get 'featured'\n      get 'location'\n      get 'update'\n      get 'premium'\n      get 'show'\n      delete :delete_image_attachment\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 1, "creation_date": 1547640077, "post_id": 54216456, "comment_id": 95258879, "body": "Would also be interesting to know where the official documentation for this feature is. The <a href=\"https://docs.ruby-lang.org/en/2.5.0/syntax/assignment_rdoc.html#label-Multiple+Assignment\" rel=\"nofollow noreferrer\">multiple assignment</a> documentation does not seem to mention it"}, {"owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 2, "creation_date": 1547646142, "post_id": 54216456, "comment_id": 95262270, "body": "since it does not seem to have a name already, i hereby name it &quot;naked splat&quot;"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1547652970, "post_id": 54216456, "comment_id": 95266592, "body": "The documentation on <a href=\"http://ruby-doc.org/core-2.6/doc/syntax/methods_rdoc.html#label-Array-2FHash+Argument\" rel=\"nofollow noreferrer\">Array/Hash Argument</a> says <i>&quot;bare *&quot;</i> so you might call it a <i>&quot;bare splat&quot;</i>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1547659783, "post_id": 54216456, "comment_id": 95270513, "body": "The unit test is <a href=\"https://github.com/ruby/ruby/blob/5b593e388931490c1e2246d0347c892440167b2c/spec/rubyspec/optional/capi/kernel_spec.rb#L219-L233\" rel=\"nofollow noreferrer\">here</a>. I second the nomination for &quot;lonely splat&quot; (enabling us to sing <a href=\"https://www.youtube.com/watch?v=d5ab8BOu4LE\" rel=\"nofollow noreferrer\">&quot;<code>*</code> is the loneliest splat,...&quot;</a>."}], "owner": {"reputation": 797, "user_id": 8574922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-H7r02ZlEyhE/AAAAAAAAAAI/AAAAAAAAAPc/RiIKejtdmws/photo.jpg?sz=128", "display_name": "Dmitry Dmitriev", "link": "https://stackoverflow.com/users/8574922/dmitry-dmitriev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1547639370, "creation_date": 1547639370, "question_id": 54216456, "link": "https://stackoverflow.com/questions/54216456/correct-naming-of-lonely-no-variable-name-splat-operator-in-ruby-multiple-assi", "title": "Correct naming of lonely (no variable name) splat operator in Ruby multiple assignment expression", "body": "<p>Every entity in development has it's own name, that help developers to communicate.\nThe classical <code>splat operator</code> in <code>multiple assignment</code> in <code>Ruby</code> is a common thing. </p>\n\n<pre><code>a, *rest, z = %w{a the long road z}\np a # \"a\"\np z # \"z\"\np rest # ['the', 'long', 'road']\n</code></pre>\n\n<p>Today I found that it tread as working code by <code>Ruby</code>, when I skip a variable name after a <code>splat operator</code>. Like this:</p>\n\n<pre><code>a, *, z = %w{a the long road z}\np a # \"a\"\np z # \"z\"\n</code></pre>\n\n<p>How this <strong>Lonely splat operator in multiple assignment</strong> correctly called?</p>\n"}, {"tags": ["ruby", "merge", "yaml"], "comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 0, "creation_date": 1547639246, "post_id": 54215882, "comment_id": 95258404, "body": "You are right, it is unreadable. Also there seem to be too many distracting elements here - I suggest cleaning the code first, and providing the most minimal example with a code that we can run, so we can help with the actual problem at hand (for example, seems like we don&#39;t need to talk about YAML here, since the method in question deals with hashes)."}, {"owner": {"reputation": 23, "user_id": 7399260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172001d74ec5f16f2b7123ab2c66e232?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Button", "link": "https://stackoverflow.com/users/7399260/steve-button"}, "reply_to_user": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 0, "creation_date": 1547651945, "post_id": 54215882, "comment_id": 95265990, "body": "Agreed about simplifying. Once I did that it became clear what the problem was, and it was in the YAML. (see answer). I&#39;m not sure if this will be helpful to anyone else, so not sure if I should just delete the whole question (or even if I can do that!?)"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 7399260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172001d74ec5f16f2b7123ab2c66e232?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Button", "link": "https://stackoverflow.com/users/7399260/steve-button"}, "is_accepted": false, "score": 0, "last_activity_date": 1547651837, "creation_date": 1547651837, "answer_id": 54220141, "question_id": 54215882, "link": "https://stackoverflow.com/questions/54215882/ruby-yaml-deep-merge/54220141#54220141", "title": "Ruby yaml deep merge", "body": "<p>OK I found the problem. I had forgotten to add a label to the YAML (annotations:) and as soon as I put that on, it started working again. Should I delete the question?</p>\n"}], "owner": {"reputation": 23, "user_id": 7399260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172001d74ec5f16f2b7123ab2c66e232?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Button", "link": "https://stackoverflow.com/users/7399260/steve-button"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547651837, "creation_date": 1547637419, "question_id": 54215882, "link": "https://stackoverflow.com/questions/54215882/ruby-yaml-deep-merge", "title": "Ruby yaml deep merge", "body": "<p>I'm fairly new to Ruby and I've inherited some code which does a \"deep merge\" of some YAML. Here's the relevant part :-</p>\n\n<pre><code>class ::Hash\n    def deep_merge(second)\n        merger = proc { |key, v1, v2| Hash === v1 &amp;&amp; Hash === v2 ? v1.merge(v2, &amp;merger) : Array === v1 &amp;&amp; Array === v2 ? v1 | v2 : [:undefined, nil, :nil].include?(v2) ? v1 : v2 }\n        self.merge(second.to_h, &amp;merger)\n    end\nend\n</code></pre>\n\n<p>which I found fairly unreadable TBH. It falls over when I pass it the following YAML :-</p>\n\n<pre><code>- {key: nginx.ingress.kubernetes.io/auth-type, value: basic}\n- {key: nginx.ingress.kubernetes.io/auth-secret, value: basic-auth}\n- {key: nginx.ingress.kubernetes.io/auth-realm, value: 'Authentication Required.'}\n</code></pre>\n\n<p>the \"-\" are all indented in the yaml input, but code formatting is messing with that here. </p>\n\n<p>Here's a stripped down version of the YAML I'm trying to merge with (which also fails) </p>\n\n<pre><code>service:\n  container:\n    port: 3000\n</code></pre>\n\n<p>Any ideas? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authorization", "activeadmin", "cancan"], "comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1547649666, "post_id": 54215859, "comment_id": 95264577, "body": "I&#39;d take a look at Pundit over cancan. Both are great but I find Pundit to be easier to apply in situations you need more granular control."}, {"owner": {"reputation": 44, "user_id": 7511701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1393020227374737/picture?type=large", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/7511701/vikas-verma"}, "reply_to_user": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1547703436, "post_id": 54215859, "comment_id": 95284315, "body": "@bkunzi01 -  I would like to go with cacancan at this point"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1547733865, "post_id": 54215859, "comment_id": 95299745, "body": "No problem.  If you repost it for Pundit I can help you.  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 10998231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ex7ivUJ7b2Q/AAAAAAAAAAI/AAAAAAAAAHw/InUnMgXMEkI/photo.jpg?sz=128", "display_name": "Giorgak Buxter", "link": "https://stackoverflow.com/users/10998231/giorgak-buxter"}, "is_accepted": false, "score": 0, "last_activity_date": 1549018201, "creation_date": 1549018201, "answer_id": 54477972, "question_id": 54215859, "link": "https://stackoverflow.com/questions/54215859/how-to-setup-cancan-with-activeadmin-without-any-side-effect/54477972#54477972", "title": "How to setup cancan with activeadmin without any side effect?", "body": "<p>I solved similar thing by creating a custom page and apply cancan ability on that page.Otherwise ability was applied on resource.</p>\n\n<pre><code>ActiveAdmin.register_page \"Summary\" do\n menu parent: \"UserProcess\", label: \"Summary\"\n  content title: \"Summary\" do\n   .......\n   .......\n  end\nend\n</code></pre>\n\n<p>and apply ability on it this way:</p>\n\n<pre><code>class Ability\n include CanCan::Ability\n  def initialize(users)\n   can :manage UserProcess\n   cannot :manage, ActiveAdmin::Page, name: \"Summary\"\n  end\nend\n</code></pre>\n\n<p>If you found by the time another cleaner solution,please edit me!</p>\n"}], "owner": {"reputation": 44, "user_id": 7511701, "user_type": "registered", "profile_image": "https://graph.facebook.com/1393020227374737/picture?type=large", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/7511701/vikas-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549018201, "creation_date": 1547637323, "last_edit_date": 1547638334, "question_id": 54215859, "link": "https://stackoverflow.com/questions/54215859/how-to-setup-cancan-with-activeadmin-without-any-side-effect", "title": "How to setup cancan with activeadmin without any side effect?", "body": "<p>I have an active admin code running which is as below </p>\n\n<pre><code>ActiveAdmin.register UserProcess, as: 'Summary' do\n....\nend\n</code></pre>\n\n<p>active_admin.rb - </p>\n\n<pre><code>config.authorization_adapter = ActiveAdmin::CanCanAdapter\nconfig.cancan_ability_class = \"Ability\"\nconfig.on_unauthorized_access = :access_denied\n</code></pre>\n\n<p>I want to block user from accessing this Summary page without actually blocking his access from UserProcess.</p>\n\n<p>adding <code>cannot :manage, UserProcess</code> works for the page but then it also does not allow the user to access him other pages.</p>\n\n<p>Also my namespace is <code>:actadmin</code></p>\n\n<p>Please let me know the correct thing to write in Ability class</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "devise", "paperclip"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547636634, "post_id": 54215219, "comment_id": 95256860, "body": "Are you using heroku?"}, {"owner": {"reputation": 71, "user_id": 10676790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17e7ae68a443847a36e8b9f0feb0018?s=128&d=identicon&r=PG&f=1", "display_name": "srijan439", "link": "https://stackoverflow.com/users/10676790/srijan439"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1547640807, "post_id": 54215219, "comment_id": 95259298, "body": "No, I&#39;m hosting it on local server."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10676790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17e7ae68a443847a36e8b9f0feb0018?s=128&d=identicon&r=PG&f=1", "display_name": "srijan439", "link": "https://stackoverflow.com/users/10676790/srijan439"}, "edited": false, "score": 0, "creation_date": 1547642770, "post_id": 54215736, "comment_id": 95260309, "body": "Finally it&#39;s working The aws bucket was not public. Secondly the hostname line was missing.  config.paperclip_defaults = {   storage: :s3,     s3_host_name: &quot;s3-#{ENV[&#39;AWS_REGION&#39;]}.amazonaws.com&quot;,     s3_credentials: {       bucket: ENV.fetch(&#39;S3_BUCKET_NAME&#39;),       access_key_id: ENV.fetch(&#39;AWS_ACCESS_KEY_ID&#39;),       secret_access_key: ENV.fetch(&#39;AWS_SECRET_ACCESS_KEY&#39;),       s3_region: ENV.fetch(&#39;AWS_REGION&#39;),     }   }"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 71, "user_id": 10676790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17e7ae68a443847a36e8b9f0feb0018?s=128&d=identicon&r=PG&f=1", "display_name": "srijan439", "link": "https://stackoverflow.com/users/10676790/srijan439"}, "edited": false, "score": 0, "creation_date": 1547647803, "post_id": 54215736, "comment_id": 95263304, "body": "Happy to help :)"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1547636862, "creation_date": 1547636862, "answer_id": 54215736, "question_id": 54215219, "link": "https://stackoverflow.com/questions/54215219/awss3errorsaccessdenied-in-devise/54215736#54215736", "title": "Aws::S3::Errors::AccessDenied in Devise", "body": "<p>Looks like the same issue as: <a href=\"https://railsblogs.rohityadav.in/2018/01/awss3errorsaccessdenied-access-denied.html\" rel=\"nofollow noreferrer\">https://railsblogs.rohityadav.in/2018/01/awss3errorsaccessdenied-access-denied.html</a></p>\n\n<blockquote>\n  <p>If you get this error when trying to upload to S3, you need to assign this IAM User the \u201cAmazonS3FullAccess\u201d Policy.</p>\n</blockquote>\n\n<p>Or it might be an issue with heroku config:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35190087/awss3errorsaccessdenied-cannot-save-to-s3-with-ruby-on-rails\">AWS::S3::Errors::AccessDenied. Cannot save to S3 with Ruby on Rails</a></p>\n\n<blockquote>\n  <p>You need to set your AWS credentials as config variables in heroku (basically environment variables). You can check if they are set with heroku config; if they are not set, you can add them with heroku config:set S3_BUCKET_NAME=something AWS_ACCESS_KEY_ID=whatever AWS_SECRET_ACCESS_KEY=something_secret. More info with heroku config --help</p>\n</blockquote>\n"}], "owner": {"reputation": 71, "user_id": 10676790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17e7ae68a443847a36e8b9f0feb0018?s=128&d=identicon&r=PG&f=1", "display_name": "srijan439", "link": "https://stackoverflow.com/users/10676790/srijan439"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547636862, "creation_date": 1547635057, "last_edit_date": 1547635399, "question_id": 54215219, "link": "https://stackoverflow.com/questions/54215219/awss3errorsaccessdenied-in-devise", "title": "Aws::S3::Errors::AccessDenied in Devise", "body": "<p>I'm trying to store images using AmazonS3 for my blog using paperclip. The blog has devise gem implemented for login/signup [User] and I want to add image for every user by storing them on Amazon S3. Previously I was storing them in Database and it was working perfectly.</p>\n\n<p>I've already searched a lot but couldn't find a fix for this.</p>\n\n<pre><code>        //Development.rb\n    config.paperclip_defaults = {\n      storage: :s3,\n        s3_credentials: {\n          bucket: ENV.fetch('S3_BUCKET_NAME'),\n          access_key_id: ENV.fetch('AWS_ACCESS_KEY_ID'),\n          secret_access_key: ENV.fetch('AWS_SECRET_ACCESS_KEY'),\n          s3_region: ENV.fetch('AWS_REGION'),\n        }\n      }\n\n    //AddAttachment Migration\n    class AddAttachmentImageToUsers &lt; ActiveRecord::Migration[5.2]\n      def self.up\n        change_table :users do |t|\n          t.attachment :image\n        end\n      end\n\n      def self.down\n        remove_attachment :users, :image\n      end\n    end\n\n    //User.rb\n    class User &lt; ActiveRecord::Base\n      # Include default devise modules. Others available are:\n      # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n      devise :database_authenticatable, :registerable,\n             :recoverable, :rememberable, :validatable\n\n      has_many :comments, dependent: :destroy\n      has_many :likes, dependent: :destroy\n      has_many :articles\n\n      has_attached_file :image, :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\"}\n\n      validates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\n    end\n\n    //Application.yml\n    AWS_ACCESS_KEY_ID: -----\n    AWS_SECRET_ACCESS_KEY: ------\n    S3_BUCKET_NAME: -------------\n    AWS_REGION: ap-south-1\n\n    //Application.html.erb\n   &lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt; TheBlog&lt;/title&gt;\n    &lt;%= csrf_meta_tags %&gt;\n    &lt;%= csp_meta_tag %&gt;\n\n    &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n    &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\"&gt;\n    &lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n\n    &lt;nav class=\"navbar navbar-inverse\"&gt;\n  &lt;div class=\"container-fluid\"&gt;\n    &lt;div class=\"navbar-header\"&gt;\n      &lt;a class=\"navbar-brand\" href=\"#\" id=\"logo\"&gt;The Blog&lt;/a&gt;\n    &lt;/div&gt;\n    &lt;ul class=\"nav navbar-nav\"&gt;\n      &lt;li class=\"active\"&gt;\n        &lt;%= link_to 'Home', root_path %&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;%= link_to 'About', about_path %&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n\n    &lt;ul class=\"nav navbar-nav navbar-right\"&gt;\n      &lt;% if user_signed_in? %&gt;\n        &lt;li&gt;  &lt;%= image_tag current_user.image.url, size:\"40x40\" %&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;%= link_to current_user.email, edit_user_registration_path %&gt;&lt;/li&gt;\n        &lt;li&gt;&lt;%= link_to \"Logout\", destroy_user_session_path, method: :delete %&gt;&lt;/li&gt;\n        &lt;% else %&gt;\n      &lt;li&gt;&lt;%= link_to \"Sign Up\", new_user_registration_path %&gt;&lt;/li&gt;\n      &lt;li&gt;&lt;%= link_to \"Login\", new_user_session_path %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n\n    &lt;%= yield %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "nokogiri"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1547634404, "post_id": 54214940, "comment_id": 95255645, "body": "You don&#39;t seem to be changing the name, but stripping the namespaces. <code>doc.remove_namespaces!</code> will do it for you."}, {"owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1547638684, "post_id": 54214940, "comment_id": 95258059, "body": "Yes, it helps. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "is_accepted": true, "score": 0, "last_activity_date": 1558973642, "creation_date": 1558973642, "answer_id": 56329440, "question_id": 54214940, "link": "https://stackoverflow.com/questions/54214940/how-to-change-node-name-in-xml-with-nokogiri/56329440#56329440", "title": "How to change node name in xml with Nokogiri", "body": "<p>Adding doc.remove_namespaces! work for me</p>\n"}], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 56329440, "answer_count": 1, "score": 0, "last_activity_date": 1558973642, "creation_date": 1547634143, "question_id": 54214940, "link": "https://stackoverflow.com/questions/54214940/how-to-change-node-name-in-xml-with-nokogiri", "title": "How to change node name in xml with Nokogiri", "body": "<p>I need to change </p>\n\n<pre><code>  &lt;Bureau xmlns=\"http://www.bbc.com/namespace\" \n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;/Bureau&gt;\n</code></pre>\n\n<p>to </p>\n\n<pre><code> &lt;Bureau&gt;\n   &lt;/Bureau&gt;\n</code></pre>\n\n<p>For this I use nokogiri gem. Also, I get this xml from request.</p>\n\n<p>I tried to make it with different methods:xpath,at_xpath.But can't replace it to node name which I need.</p>\n\n<pre><code>doc = Nokogiri::XML(response)\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "url", "browser"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1547627074, "post_id": 54212836, "comment_id": 95251578, "body": "what is the goal here? You can use a userscript or browser extension much easier"}, {"owner": {"reputation": 11, "user_id": 10921023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4813c3d361c1d13e34b099c30183e89a?s=128&d=identicon&r=PG&f=1", "display_name": "adrian.cpp", "link": "https://stackoverflow.com/users/10921023/adrian-cpp"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1547628237, "post_id": 54212836, "comment_id": 95252128, "body": "I wanted to do it using a locally running program or script. I did not even think about adding a plugin - is there a way to add a google chrome extension to C ++, for example?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1547631093, "post_id": 54212836, "comment_id": 95253628, "body": "no, I mean like a chrome or firefox extension, it&#39;s written in JS"}, {"owner": {"reputation": 11, "user_id": 10921023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4813c3d361c1d13e34b099c30183e89a?s=128&d=identicon&r=PG&f=1", "display_name": "adrian.cpp", "link": "https://stackoverflow.com/users/10921023/adrian-cpp"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1547632723, "post_id": 54212836, "comment_id": 95254666, "body": "I understand, I wonder if I will later have the option to &quot;install&quot; it with, for example, C ++"}, {"owner": {"reputation": 420, "user_id": 5849170, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bdb4b8df45b0ac88464762e5c8a69015?s=128&d=identicon&r=PG&f=1", "display_name": "Neagu V", "link": "https://stackoverflow.com/users/5849170/neagu-v"}, "edited": false, "score": 0, "creation_date": 1547636047, "post_id": 54212836, "comment_id": 95256559, "body": "This is not possible using Selenium , you can check it here: <a href=\"https://github.com/seleniumhq/selenium-google-code-issue-archive/issues/18\" rel=\"nofollow noreferrer\">github.com/seleniumhq/selenium-google-code-issue-archive/iss&zwnj;&#8203;ues/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10921023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4813c3d361c1d13e34b099c30183e89a?s=128&d=identicon&r=PG&f=1", "display_name": "adrian.cpp", "link": "https://stackoverflow.com/users/10921023/adrian-cpp"}, "edited": false, "score": 1, "creation_date": 1547647385, "post_id": 54217838, "comment_id": 95263062, "body": "Ok, thank you for such a detailed explanation."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1547644415, "creation_date": 1547644415, "answer_id": 54217838, "question_id": 54212836, "link": "https://stackoverflow.com/questions/54212836/getting-a-url-from-an-open-browser/54217838#54217838", "title": "Getting a URL from an open browser", "body": "<p>The answer is, you can't attach the existing window(window which was already opened) using Selenium-webdriver. It's possible in WATIR-Classic but it only works for IE, it's not available for firefox or for chrome. But when you use Selenium or WATIR(wrapper around selenium) you can't switch to the new window if new window has been opened as the result of the click in the first window. Or you can open the chrome in the specific portal and that window you can connect with but that's not possible for firefox. But remember what you are asking for is attaching the window which has already been opened and it's not possible in Selenium.</p>\n"}], "owner": {"reputation": 11, "user_id": 10921023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4813c3d361c1d13e34b099c30183e89a?s=128&d=identicon&r=PG&f=1", "display_name": "adrian.cpp", "link": "https://stackoverflow.com/users/10921023/adrian-cpp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1547656268, "answer_count": 1, "score": 1, "last_activity_date": 1547644415, "creation_date": 1547626797, "last_edit_date": 1547632529, "question_id": 54212836, "link": "https://stackoverflow.com/questions/54212836/getting-a-url-from-an-open-browser", "closed_reason": "Needs details or clarity", "title": "Getting a URL from an open browser", "body": "<p>I am trying to get the URL from an active Chrome browser window. I expect output like <code>https://www.google.pl/</code> when I have the Google page enabled. I want to download the address from a browser that is already running.</p>\n\n<p>With C++, I can only search for an active window and its title. It will be easier using Ruby and Selenium, but I can only return a window URL that the script will turn on.</p>\n\n<pre><code>Selenium::WebDriver::Chrome.driver_path=\"drivers/chromedriver.exe\"\ndriver = Selenium::WebDriver.for :chrome\ndriver.get(\"http://www.google.com\") # So, without it.\nputs driver.current_url\n</code></pre>\n\n<p>Can I change it to get a URL from the previously enabled window? Is it possible with Ruby? Or maybe someone has an idea for my problem in another language?</p>\n"}, {"tags": ["ruby", "decorator"], "comments": [{"owner": {"reputation": 486, "user_id": 6144460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3cdffe21fd594a0947298f0f4f1f8?s=128&d=identicon&r=PG", "display_name": "periswon", "link": "https://stackoverflow.com/users/6144460/periswon"}, "edited": false, "score": 0, "creation_date": 1547630571, "post_id": 54212433, "comment_id": 95253336, "body": "I&#39;m not sure I fully understand your problem. You want all instance methods of a class to become class methods of another class? If that&#39;s all, then you could move all instance methods to a module, include it in one class and extend the other class."}, {"owner": {"reputation": 19, "user_id": 10877215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2cdd8e91fe1ff2f4d22b7b64394a17?s=128&d=identicon&r=PG&f=1", "display_name": "kme", "link": "https://stackoverflow.com/users/10877215/kme"}, "reply_to_user": {"reputation": 486, "user_id": 6144460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3cdffe21fd594a0947298f0f4f1f8?s=128&d=identicon&r=PG", "display_name": "periswon", "link": "https://stackoverflow.com/users/6144460/periswon"}, "edited": false, "score": 0, "creation_date": 1547631772, "post_id": 54212433, "comment_id": 95254048, "body": "Thanks for advices. I got same solutions after review module documents"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 10877215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2cdd8e91fe1ff2f4d22b7b64394a17?s=128&d=identicon&r=PG&f=1", "display_name": "kme", "link": "https://stackoverflow.com/users/10877215/kme"}, "is_accepted": true, "score": 0, "last_activity_date": 1547805704, "last_edit_date": 1547805704, "creation_date": 1547632077, "answer_id": 54214274, "question_id": 54212433, "link": "https://stackoverflow.com/questions/54212433/ruby-class-method-with-decorator/54214274#54214274", "title": "ruby class method with decorator", "body": "<p>Got solutions as below</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module ObjReviewModule  ## common methods module\n  def own_methods(obj_)\n    ruby_methods = \" \".methods &amp; 1.methods\n    (obj_.methods - ruby_methods).map { |x| x.to_s }\n  end\n\n  def specific_methods(obj_,existing_=[])\n    self.own_methods(obj_).select { |x| !existing_.include?(x) }\n  end\nend\n\nmodule ObjReviewMethod \n  include ObjReviewModule \n  def get_(obj_)\n    own_methods(obj_).select { |x| x.start_with?(\"get\") }\n  end\n  def to_(obj_)\n    own_methods(obj_).select{ |x| x.start_with?(\"to_\") }\n  end\nend\n\nclass ObjList ## class_method \n  extend ObjReviewModule\n  extend ObjReviewMethod\nend\n\nclass ObjReview ## instance_method \n  include ObjReviewModule\n  include ObjReviewMethod\nend\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10877215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2cdd8e91fe1ff2f4d22b7b64394a17?s=128&d=identicon&r=PG&f=1", "display_name": "kme", "link": "https://stackoverflow.com/users/10877215/kme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 54214274, "answer_count": 1, "score": 0, "last_activity_date": 1547805704, "creation_date": 1547624965, "last_edit_date": 1547627100, "question_id": 54212433, "link": "https://stackoverflow.com/questions/54212433/ruby-class-method-with-decorator", "title": "ruby class method with decorator", "body": "<p>I want to have separate classes with <code>instant_method</code> and <code>class_method</code> as follow:</p>\n\n<pre><code>module ObjReviewModule  ## common methods module\n  def own_methods(obj_)\n    ruby_methods = \" \".methods &amp; 1.methods\n    (obj_.methods - ruby_methods).map { |x| x.to_s }\n  end\n\n  def specific_methods(obj_,existing_=[])\n    self.own_methods(obj_).select { |x| !existing_.include?(x) }\n  end\nend\n\nclass ObjReviewMethod ## instance_method \n  include ObjReviewModule \n\n  def get_(obj_)\n    own_methods(obj_).select { |x| x.start_with?(\"get\") }\n  end\n\n  def to_(obj_)\n    own_methods(obj_).select{ |x| x.start_with?(\"to_\") }\n  end\nend\n\nclass ObjList &lt; OsObjReviewMethod ## class_method \n  extend ObjReviewModule\n\n  def self.get_methods(obj_)\n    # something should be here to make OsObjReviewMethod instance_method became class_method\n  end\nend\n</code></pre>\n\n<p>I got <code>ObjReviewMethod</code> worked as</p>\n\n<pre><code>object_methods = ObjReviewMethod.new\nobject_methods.get_(obj_) =&gt; get \"own_methods\" start with \"get\" using instance_class_method\nObjList.own_methods(obj_) =&gt; get \"own_methods\" with class_method\n</code></pre>\n\n<p>but i could not figure out how to get <code>class_method</code> without rewrite all definitions :</p>\n\n<pre><code>ObjList.get_methods(obj_) =&gt; get all \"own_methods\" start with \"get\" using class_method\n</code></pre>\n\n<p>It would be perfect if  decorator class could use all <code>instance_method</code> of base class as <code>class_method</code></p>\n"}, {"tags": ["ruby", "yaml"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1547623613, "post_id": 54212106, "comment_id": 95250230, "body": "You might reimplement the handlers of YAML parser of your choice to serialize an array that way."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1547623730, "post_id": 54212106, "comment_id": 95250298, "body": "@AlekseiMatiushkin But storing array in YAML will have same format what he got, Is expected look of YAML possible?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1547627168, "post_id": 54212106, "comment_id": 95251621, "body": "@ray both handler and <a href=\"https://ruby-doc.org/stdlib/libdoc/psych/rdoc/Psych/Emitter.html\" rel=\"nofollow noreferrer\"><code>emitter</code></a> are to be reimplemented."}], "owner": {"reputation": 11, "user_id": 5914448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f6252b6ac707bca8e008c84f525508?s=128&d=identicon&r=PG&f=1", "display_name": "Arnis Gustins", "link": "https://stackoverflow.com/users/5914448/arnis-gustins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "closed_date": 1547625263, "answer_count": 0, "score": 0, "last_activity_date": 1547626343, "creation_date": 1547623177, "last_edit_date": 1547626343, "question_id": 54212106, "link": "https://stackoverflow.com/questions/54212106/how-to-save-array-in-hash-into-single-line-yaml-sequence-with-yamlstore", "closed_reason": "Duplicate", "title": "How to save array in hash into single line yaml sequence with YAML::Store", "body": "<p>I'am using <code>YAML::Store</code> to save data in human readable form.</p>\n\n<pre><code>require 'yaml/store'\ndb = YAML::Store.new(\"db.yaml\")\n</code></pre>\n\n<p>Data passed to yaml store is a hash. Some of the values are big arrays. Code example:</p>\n\n<pre><code>hash = {\"foo\" =&gt; \"bar\", \"array\" =&gt; [1,2,3,4,5,6,7,8,9]}\ndb.transaction do\n  db[\"1\"] = hash\nend\n</code></pre>\n\n<p>Yaml store saves arrays with dashes where every value is in new line. Yaml database looks like one huge column of numbers. It looks like this:</p>\n\n<pre><code>---\n'1':\n  foo: bar\n  array:\n  - 1\n  - 2\n  - 3\n  - 4\n  - 5\n  - 6\n  - 7\n  - 8\n  - 9\n</code></pre>\n\n<p>It works fine, but it takes away the readability. I want yaml to look like this:</p>\n\n<pre><code>---\n'1':\n  foo: bar\n  array: [1,2,3,4,5,6,7,8,9]\n</code></pre>\n\n<p>Is there a way to save array in a single line?</p>\n\n<p>Edit: I see that there are options for hash.to_yaml, but how do I implement those into yaml::store. \nThis is what documentation says:</p>\n\n<pre><code>initialize( file_name, yaml_opts = {} )\n</code></pre>\n\n<p>Cannot get it to work. For example this doesn't change anything:</p>\n\n<pre><code>yaml_opts = { :Indent =&gt; 50 }\ndb = YAML::Store.new(\"db.yaml\", yaml_opts)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "format"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1547616644, "post_id": 54210684, "comment_id": 95247816, "body": "Are you using jquery form-validation?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1547671521, "post_id": 54210684, "comment_id": 95276001, "body": "This is a built in feature for html i believe.  When i use something simple like &quot;[0-9]&quot;, it works in validating numbers only.  Is there a certain format needed for this other than the regular regex?"}], "answers": [{"tags": [], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "is_accepted": true, "score": 1, "last_activity_date": 1547671802, "creation_date": 1547671802, "answer_id": 54225162, "question_id": 54210684, "link": "https://stackoverflow.com/questions/54210684/client-side-form-validation-rails/54225162#54225162", "title": "Client side form validation rails", "body": "<p>Using a singly quotation instead of the double seems to do the trick.</p>\n\n<pre><code>&lt;%= form.text_field :twitter_link, \n    class: \"form-control\", \n    required: true, \n    pattern: '^(?:https?:\\/\\/)?(?:(?:www|m)\\.)?twitter\\.com\\/\\w+\\/status\\/\\d+(?:\\/\\/?)?$', \n    title: \"Twitter Comment URL\" %&gt;\n</code></pre>\n\n<p>Not sure why i didn't try this before because i have ran into similar issues in the past with double vs single</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 54225162, "answer_count": 1, "score": 1, "last_activity_date": 1547671802, "creation_date": 1547614793, "last_edit_date": 1547671559, "question_id": 54210684, "link": "https://stackoverflow.com/questions/54210684/client-side-form-validation-rails", "title": "Client side form validation rails", "body": "<p><strong>Issue:</strong> My client side rails form input format validation won't work how the regex is set up to.</p>\n\n<p><strong>I have the following rails form input:</strong></p>\n\n<pre><code>&lt;%= form.text_field :twitter_link, \n    class: \"form-control\", \n    required: true, \n    pattern: \"^(?:https?:\\/\\/)?(?:(?:www|m)\\.)?twitter\\.com\\/\\w+\\/status\\/\\d+(?:\\/\\/?)?$\", \n    title: \"Twitter Comment URL\" %&gt;\n</code></pre>\n\n<p>When i enter the correct format, it won't validate and the \"enter correct format\" message appears.</p>\n\n<p><strong>The following regex in my model validates for the param:</strong></p>\n\n<pre><code>/\\A^(?:https?:\\/\\/)?(?:(?:www|m)\\.)?twitter\\.com\\/\\w+\\/status\\/\\d+(?:\\/\\/?)?\\z/\n</code></pre>\n\n<p>As you can see I have made a few changes from my model side validates to see if it would work.  I have tried a few other things but nothing has solved.</p>\n\n<p>Works fine for my model side validation but won't work client side.  Is there something I need to change for it to work?</p>\n\n<p>I am making a client side validation so I can have a custom message for the single text_field without the need for a flash or redirect.  Any who, since I have a nested form 3 ways deep, I am having issues having the alert appear as a flash.now without needing to reload the page using a plain flash.  Not sure what the issue is but this seems to be a good alternative.</p>\n\n<p>How can I fix this so the regex works with the input text_field?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547660228, "post_id": 54212487, "comment_id": 95270745, "body": "I cannot still receive the parameters from the <b>user_activity_params</b> because the error I am receiving says the parameter values are empty. <b>Field &#39;user_activity_date&#39; doesn&#39;t have a default value: INSERT INTO <code>user_activities</code> (<code>created_at</code>, <code>updated_at</code>, <code>user_id</code>)</b>"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547698431, "post_id": 54212487, "comment_id": 95283187, "body": "@BismarkAttaFrimpong Please show the server logs from your POST request."}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547786306, "post_id": 54212487, "comment_id": 95319893, "body": "Kindly look through the question. I have posted the log and also look at the answer I have provided for more info"}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 1, "last_activity_date": 1547626903, "last_edit_date": 1547626903, "creation_date": 1547625236, "answer_id": 54212487, "question_id": 54210289, "link": "https://stackoverflow.com/questions/54210289/how-to-fix-the-error-of-form-with-tag-not-submitting-an-associative-model-at/54212487#54212487", "title": "How to fix the error of **form_with** tag not submitting an associative model attributes to params in Rails", "body": "<p>The problem is in your strong_parameters method. The API is not the most intuitive. The <code>#require</code> method returns just the value of the key that is required. So when you go to <code>#permit</code> certain attributes, you can't tell it to look for the <code>:user_activity</code> key again. </p>\n\n<p>You might try playing around from the rails console to see what happens. First let's simulate a set of parameters:</p>\n\n<pre><code>&gt;&gt; params = ActionController::Parameters.new(\"user_activity\"=&gt;{\"user_activity_note\"=&gt;\"a test message I place here\"})\n#&gt; &lt;ActionController::Parameters {\"user_activity\"=&gt;{\"user_activity_note\"=&gt;\"a test message I place here\"}} permitted: false&gt;\n</code></pre>\n\n<p><code>require</code> returns an ActionController::Parameters object with just the value of the required key:</p>\n\n<pre><code>&gt;&gt; params.require(:user_activity)\n#&gt; &lt;ActionController::Parameters {\"user_activity_note\"=&gt;\"a test message I place here\"} permitted: false&gt;\n</code></pre>\n\n<p>If we repeat the <code>:user_activity</code> key in our <code>permit</code> action, we get an empty params object back because everything that was in it is determined to be unpermitted. This does not happen silently; if you check your logs you will see that all your attributes were unpermitted.</p>\n\n<pre><code>&gt;&gt; params.require(:user_activity).permit(:user_activity =&gt; [:user_activity_note])\nUnpermitted parameters: :user_activity_note\n#&gt; &lt;ActionController::Parameters {} permitted: true&gt;\n</code></pre>\n\n<p>But if we just list the attributes we need, we get the intended result:</p>\n\n<pre><code>&gt;&gt; params.require(:user_activity).permit(:user_activity_note)\n#&gt; &lt;ActionController::Parameters {\"user_activity_note\"=&gt;\"a test message I place here\"} permitted: true&gt;\n</code></pre>\n\n<p>Change your <code>user_activity_params</code> method to:</p>\n\n<pre><code>def user_activity_params\n  params.require(:user_activity).permit(:activity_id, :user_activity_date, :user_activity_start, :user_activity_end, :user_activity_note)\nend\n</code></pre>\n\n<p>and it should work for you.</p>\n"}, {"comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1547786581, "post_id": 54246705, "comment_id": 95319953, "body": "OK, but your answer would not work if you had not changed your <code>user_activity_params</code> per my answer. I spent significant time helping you here, and you&#39;ve just answered your own question and marked it as correct. That&#39;s not how SO is supposed to work."}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1547824274, "post_id": 54246705, "comment_id": 95337358, "body": "@moveson Please don&#39;t get offended because I have duly acknowledged your efforts by saying <b>I combined your various contributions and together I have been able to solve it</b>. I don&#39;t know how I could have taken your own alone as the answer then. Thanks for understanding"}], "tags": [], "owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "is_accepted": true, "score": -1, "last_activity_date": 1547776376, "last_edit_date": 1547776376, "creation_date": 1547775998, "answer_id": 54246705, "question_id": 54210289, "link": "https://stackoverflow.com/questions/54210289/how-to-fix-the-error-of-form-with-tag-not-submitting-an-associative-model-at/54246705#54246705", "title": "How to fix the error of **form_with** tag not submitting an associative model attributes to params in Rails", "body": "<p>I fixed the errors I was receiving just after trying out most recommendations without solutions. \nI started by going through the model associations and disabling some methods such as inverse_of, accepts_nested_attribute_for, and attr_accessor, one after the other.</p>\n\n<h1>Before</h1>\n\n<pre><code>class UserActivity &lt; ApplicationRecord\n\n    # ----ASSOCIATION OF MODELS----\n\n    # a UserActivity belongs to a User\n    # and UserActivity belongs to an Activity\n    belongs_to :user, inverse_of: :user_activities\n    belongs_to :activity, optional: true, inverse_of: :user_activities \n\n    attr_accessor :user_activity_date, :user_activity_start,  :user_activity_end, :user_activity_note, :activity_id, :user_id\n\n    accepts_nested_attributes_for :activity, :user\n\n    # ----MODEL VALIDATIONS----\n    validates_presence_of :user_activity_end, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_start, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_date, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_note, presence: true, length: { minimum: 10 }, null: false, :message =&gt; \"cannot be empty\"\n\n    validates :user, presence: true\n    validates :activity, presence: true\nend\n</code></pre>\n\n<h1>After</h1>\n\n<pre><code>class UserActivity &lt; ApplicationRecord\n\n    # ----ASSOCIATION OF MODELS----\n\n    # a UserActivity belongs to a User\n    # and UserActivity belongs to an Activity\n    belongs_to :user, inverse_of: :user_activities\n    belongs_to :activity, optional: true, inverse_of: :user_activities \n\n    accepts_nested_attributes_for :activity, :user\n\n    # ----MODEL VALIDATIONS----\n    validates_presence_of :user_activity_end, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_start, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_date, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_note, presence: true, length: { minimum: 10 }, null: false, :message =&gt; \"cannot be empty\"\n\n    validates :user, presence: true\n    validates :activity, presence: true\nend\n</code></pre>\n\n<h1>The Console Results</h1>\n\n<pre><code>Started POST \"/user_activities\" for 127.0.0.1 at 2019-01-18 02:11:27 +0100\nProcessing by UserActivitiesController#create as HTML\n    Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"Z6DP3METaYH2oczN11Mpewy4K4E1Gj+24twDM4NHI0y2abKn1CnW1M9993+u+3+9Gh4Rmz/k9g+/pVIpCltSNQ==\", \"user_activity\"=&gt;{\"activity_id\"=&gt;\"2\", \"user_activity_date\"=&gt;\"2018-12-18\", \"user_activity_start\"=&gt;\"09:56\", \"user_activity_end\"=&gt;\"11:00\", \"user_activity_note\"=&gt;\"still testing for errors in the app\"}, \"commit\"=&gt;\"Create User activity\"}\n   The activity ID which is received is -&gt; 2\n   Date -&gt; 2018-12-18\n   Start Time -&gt; 09:56\n   End Time -&gt; 11:00\n   Activity Note -&gt; still testing for errors in the app\n       User Load (0.7ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n       \u21b3 app/controllers/user_activities_controller.rb:54\n       (0.4ms)  BEGIN\n       \u21b3 app/controllers/user_activities_controller.rb:57\n       UserActivity Create (0.7ms)  INSERT INTO `user_activities` (`user_activity_date`, `user_activity_start`, `user_activity_end`, `user_activity_note`, `created_at`, `updated_at`, `user_id`, `activity_id`) VALUES ('2018-12-18 00:00:00', '09:56:00', '11:00:00', 'still testing for errors in the app', '2019-01-18 01:11:28', '2019-01-18 01:11:28', 1, 2)\n       \u21b3 app/controllers/user_activities_controller.rb:57\n       (0.4ms)  COMMIT\n       \u21b3 app/controllers/user_activities_controller.rb:57\nRedirected to http://localhost:3000/user_activities/7\nCompleted 302 Found in 111ms (ActiveRecord: 4.3ms)\n</code></pre>\n\n<p>I was having the <strong><em>accepts_nested_attribute_for</em></strong> on the <strong>UserActivity</strong> model and the variables used were exactly the same as that of its already set attributes and so they were conflicting.</p>\n\n<p><strong>Right after I disable that, then I was able to save into the database and now everything is working good.</strong></p>\n\n<p>I thank you for your support as they gave me an idea of where to channel my error-finding technique.</p>\n"}], "owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 54246705, "answer_count": 2, "score": -2, "last_activity_date": 1547776376, "creation_date": 1547611710, "last_edit_date": 1547711244, "question_id": 54210289, "link": "https://stackoverflow.com/questions/54210289/how-to-fix-the-error-of-form-with-tag-not-submitting-an-associative-model-at", "title": "How to fix the error of **form_with** tag not submitting an associative model attributes to params in Rails", "body": "<p>I have 3 models of <strong>User</strong>, <strong>UserActivity</strong>, and <strong>Activity</strong>. I have created  an association between them and when I submit values through its form, I can see the values at the back of the console but I get validation errors of empty fields.</p>\n\n<p>I have tried several means including search different forums and trying out the different suggestion but to no avail.</p>\n\n<h1>The Models</h1>\n\n<pre><code>class User &lt; ApplicationRecord\n\n    belongs_to :role #, foreign_key: \"id\"\n\n    has_many :user_activities, inverse_of: :user\n    has_many :activities, through: :user_activities\n\n    accepts_nested_attributes_for :user_activities\nend\n\nclass UserActivity &lt; ApplicationRecord\n\n    belongs_to :user, inverse_of: :user_activities\n    belongs_to :activity, inverse_of: :user_activities, optional: true\n\n    attr_accessor :user_activity_date, :user_activity_start,  :user_activity_end, :user_activity_note, :activity_id, :user_id\n\n    validates_presence_of :user_activity_end, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_start, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_date, presence: true, null: false, :message =&gt; \"cannot be empty\"\n    validates_presence_of :user_activity_note, presence: true, length: { minimum: 10 }, null: false, :message =&gt; \"cannot be empty\"\n\nend\n\nclass Activity &lt; ApplicationRecord\n\n  has_many :user_activities, inverse_of: :activity\n  has_many :users, through: :user_activities\n\n  accepts_nested_attributes_for :user_activities\n\nend\n</code></pre>\n\n<h1>The Controller Methods</h1>\n\n<pre><code>class UserActivitiesController &lt; ApplicationController\n\n   # GET /user_activities/new\n   def new\n        @user_activity = current_user.user_activities.build(activity_id: params[:activity_id])\n\n        @activity = Activity.all\n    end\n  end\n\n     # POST /user_activities\n     # POST /user_activities.json\n     def create\n        @user_activity = current_user.user_activities.build\n        respond_to do |format|\n            if @user_activity.save\n               format.html { redirect_to @user_activity, notice: 'User activity was successfully created.' }\n               format.json { render :show, status: :created, location: @user_activity }\n            else\n                @activities = Activity.all\n                format.html { render :new }\n                format.json { render json: @user_activity.errors, status: :unprocessable_entity }\n            end\n       end\n    end\n\n    def user_activity_params\n        params.require(:user_activity).permit( :user_activity =&gt; [:activity_id, :user_activity_date, :user_activity_start, :user_activity_end, :user_activity_note])\n    end\nend\n</code></pre>\n\n<h1>The View</h1>\n\n<p><strong><em>I have removed some of the fields just to reduce the number line of codes</em></strong></p>\n\n<pre><code>&lt;%= form_with(model: user_activity, local: true) do |frm| %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= frm.label :activity_id %&gt;&lt;br /&gt;\n    &lt;%= collection_select(:user_activity, :activity_id, Activity.all, :id, :activity_name, prompt: true) %&gt;\n    &lt;%#= select(\"user_activity\", \"activity_id\", Activity.all.collect {|a| [ a.activity_name, a.id ] }, {include_blank: 'none'}) %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= frm.label(get_user_activity_date) %&gt;&lt;br /&gt;\n    &lt;%= frm.date_field :user_activity_date, autofocus: true%&gt;\n   &lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<h1>Results on the Console</h1>\n\n<pre><code>Started POST \"/user_activities\" for 127.0.0.1 at 2019-01-16 04:10:28 +0100\nProcessing by UserActivitiesController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"o81mDoZ87/hodGpWaHkH/CDs87Hr2nH+s518GCp8q3GZC650UrRh0hYTCu41ax3vjUhgRC3JkP03ZHbVIYYQJQ==\", \"user_activity\"=&gt;{\"activity_id\"=&gt;\"\", \"user_activity_date\"=&gt;\"\", \"user_activity_start\"=&gt;\"\", \"user_activity_end\"=&gt;\"\", \"user_activity_note\"=&gt;\"a test message I place here\"\"}, \"commit\"=&gt;\"Create User activity\"}\n</code></pre>\n\n<p>I expected that the form data submitted will be passed to the <strong>user_activity_params</strong> in the controller but then it does not as it keeps returning an error message of all the fields in the form been blank. </p>\n\n<h2>The Error Message in FireFox</h2>\n\n<pre><code>4 errors prohibited this user_activity from being saved:\n   User activity end cannot be empty\n   User activity start cannot be empty\n   User activity date cannot be empty\n   User activity note cannot be empty\n</code></pre>\n\n<p>And because of this I cannot save the data into the <strong>user_activities</strong> table in the database.</p>\n\n<h1>Update of the Server Log</h1>\n\n<pre><code>Started POST \"/user_activities\" for 127.0.0.1 at 2019-01-16 21:15:48 +0100\nProcessing by UserActivitiesController#create as HTML\n    Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"7v79xk6TW0IHNjkno+iXwzIYqqBjBMxCSodddPHUmKI/N4C9W6nkFz7qApXaQMEFJL6Qumn6BfsX/gxueMjp2w==\", \"user_activity\"=&gt;{\"activity_id\"=&gt;\"1\", \"user_activity_date\"=&gt;\"2019-01-15\", \"user_activity_start\"=&gt;\"20:14\", \"user_activity_end\"=&gt;\"21:15\", \"user_activity_note\"=&gt;\"testing to see if values can be retrieved\"}, \"commit\"=&gt;\"Create User activity\"}\n    Activity ID -&gt; 1\n    Date -&gt; 2019-01-15\n    Start Time -&gt; 20:14\n    End Time -&gt; 21:15\n    Activity Note -&gt; testing to see if values can be retrieved\n\n        User Load (0.9ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n        \u21b3 app/controllers/user_activities_controller.rb:46\n    (0.5ms)  BEGIN\n        \u21b3 app/controllers/user_activities_controller.rb:46\n        UserActivity Create (3.0ms)  INSERT INTO `user_activities` (`created_at`, `updated_at`, `user_id`) VALUES ('2019-01-16 20:15:49', '2019-01-16 20:15:49', 1)\n        \u21b3 app/controllers/user_activities_controller.rb:46\n        (0.5ms)  ROLLBACK\n        \u21b3 app/controllers/user_activities_controller.rb:46\nCompleted 500 Internal Server Error in 125ms (ActiveRecord: 12.4ms)\n\nActiveRecord::NotNullViolation (Mysql2::Error: Field 'user_activity_date' doesn't have a default value: INSERT INTO `user_activities` (`created_at`, `updated_at`, `user_id`) VALUES ('2019-01-16 20:15:49', '2019-01-16 20:15:49', 1)):\n\napp/controllers/user_activities_controller.rb:46:in `create'\n</code></pre>\n"}, {"tags": ["ruby", "xml", "file", "directory", "nokogiri"], "comments": [{"owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1547631769, "post_id": 54210268, "comment_id": 95254045, "body": "How to best achieve the scenario above? I&#39;v tried a few things, but for some reason the loop is happening for each file and not once, also the second loop for Dir B is not executing:"}], "answers": [{"comments": [{"owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "edited": false, "score": 0, "creation_date": 1547632015, "post_id": 54213329, "comment_id": 95254200, "body": "I guess I won&#39;t be sure the same file is there, thus I wanted to search in the second directory for the same file name"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "edited": false, "score": 1, "creation_date": 1547635272, "post_id": 54213329, "comment_id": 95256143, "body": "Then you can use <code>File.exist?</code>, a lot more efficient than going through the whole directory and checking each file there if they have the same name. I added the check to the answer."}, {"owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "edited": false, "score": 0, "creation_date": 1547647321, "post_id": 54213329, "comment_id": 95263022, "body": "Thank you Kimmo for your help!"}, {"owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "edited": false, "score": 0, "creation_date": 1551391010, "post_id": 54213329, "comment_id": 96634154, "body": "Kimmo, so need to make a change to the script, we have to check if there are any sub dirs in id_dir and ht_dir as part of the check.  I did this:"}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 1, "last_activity_date": 1547635292, "last_edit_date": 1547635292, "creation_date": 1547628790, "answer_id": 54213329, "question_id": 54210268, "link": "https://stackoverflow.com/questions/54210268/opening-same-file-names-in-multiple-directories-using-ruby/54213329#54213329", "title": "Opening same file names in multiple directories using Ruby", "body": "<p>No need to loop through the other dir, just see if a file with the same name exists there.</p>\n\n<pre><code>id_dir = \"#{Dir.pwd}\"+\"/id_responses\"\nht_dir = \"#{Dir.pwd}\"+\"/ht_responses\"\n\nDir.foreach(id_dir) do |id_file|\n  next if id_file == '.' or id_file == '..'\n\n  id_file_path = File.join(id_dir, id_file)\n  ht_file_path = File.join(ht_dir, id_file)\n\n  next unless File.exist?(ht_file_path)\n\n  doc1 = Nokogiri::XML::Document.parse(File.open(id_file_path, 'r'))\n  doc2 = Nokogiri::XML::Document.parse(File.open(ht_file_path, 'r'))\nend\n</code></pre>\n"}], "owner": {"reputation": 1765, "user_id": 1507704, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/785573f088dadbefb15252caa1fcbbfc?s=128&d=identicon&r=PG", "display_name": "Farooq", "link": "https://stackoverflow.com/users/1507704/farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 54213329, "answer_count": 1, "score": -1, "last_activity_date": 1547635292, "creation_date": 1547611528, "question_id": 54210268, "link": "https://stackoverflow.com/questions/54210268/opening-same-file-names-in-multiple-directories-using-ruby", "title": "Opening same file names in multiple directories using Ruby", "body": "<p>Looking to do the following using Ruby:</p>\n\n<ul>\n<li>Directory A and Directory B will have same number of XML files and also same filenames.</li>\n</ul>\n\n<p><strong>Step 1:</strong>\n* Go into directory A (directory A has X number of XML files)\n* Inside directory A, take the first XML file and save the file name and also open the file</p>\n\n<p><strong>Step 2:</strong>\n* Go into directory B (directory B will have same number of XML files with the same filenames as directory A)\n* Inside directory B, open the same XML filename that was saved and opened in directory A.</p>\n\n<p><strong>Step 3: (I've already completed this part) ** \n*</strong> Compare the two files (I've already completed this part)**</p>\n\n<p><strong>Step 4:</strong>\n* Repeat this for ALL XML files in both directories.</p>\n\n<hr>\n\n<p>I've tried a few things, but for some reason the loop is happening for each file and not once, also the second loop for Dir B is not executing:</p>\n\n<pre><code>id_dir = \"#{Dir.pwd}\"+\"/id_responses\"\nht_dir = \"#{Dir.pwd}\"+\"/ht_responses\"\n\nDir.foreach(id_dir) do |id_file|\n  next if id_file == '.' or id_file == '..'\n  id_file = File.open(\"#{id_dir}/#{id_file}\", 'r')\n  doc1 = Nokogiri::XML::Document.parse(File.open(id_file))\n\n  Dir[\"#{Dir.pwd}\"+\"/ht_responses/#{id_file}\"].each do |ht_file|\n    next if id_file == '.' or id_file == '..'\n    doc2 = Nokogiri::XML::Document.parse(File.open(ht_file))\n  end\nend\n</code></pre>\n"}, {"tags": ["css", "ruby", "github", "jekyll", "github-pages"], "comments": [{"owner": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1547611135, "post_id": 54210152, "comment_id": 95246512, "body": "<code>_config.yml</code>, &quot;baseurl: /dark-side&quot; -&gt; &quot;baseurl: /BLOG&quot;"}, {"owner": {"reputation": 31, "user_id": 10920216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbab05edcf47bd3fa33055ef88d9701?s=128&d=identicon&r=PG&f=1", "display_name": "sabre45", "link": "https://stackoverflow.com/users/10920216/sabre45"}, "reply_to_user": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1547618932, "post_id": 54210152, "comment_id": 95248520, "body": "Ah. I changed the name of the repo. The fix had no effect on Jekyll"}], "answers": [{"comments": [{"owner": {"reputation": 8013, "user_id": 632447, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b1df479db226c5cd5ca79af65533b7fb?s=128&d=identicon&r=PG", "display_name": "nikhil", "link": "https://stackoverflow.com/users/632447/nikhil"}, "edited": false, "score": 1, "creation_date": 1561853478, "post_id": 54224460, "comment_id": 100196087, "body": "Thanks, this helped me as well. While testing locally I had never setup the url in _config.yml, this didn&#39;t create an issue until I changed the custom domain. After pushing the change with the right url blog.mydomain.tld the CSS styling works again."}], "tags": [], "owner": {"reputation": 9244, "user_id": 2397550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAb8N.jpg?s=128&g=1", "display_name": "JoostS", "link": "https://stackoverflow.com/users/2397550/joosts"}, "is_accepted": false, "score": 3, "last_activity_date": 1547668792, "creation_date": 1547668792, "answer_id": 54224460, "question_id": 54210152, "link": "https://stackoverflow.com/questions/54210152/github-pages-jekyll-not-loading-css-when-using-custom-domain/54224460#54224460", "title": "Github Pages jekyll not loading CSS when using custom domain", "body": "<p>The problem is, as always, that the CSS path is not set correctly. If you use a custom domain, then please run locally first. If it works on your local machine, it will 99% of the time also work on a custom domain. This is because your custom domain and your local machine both NOT require a <code>baseurl</code>. This <code>baseurl</code> is a concept many people do not fully understand. Especially when it comes to multiple environments with different <code>baseurl</code>s. </p>\n\n<p>Hope this helps you solve/circumvent your problem.</p>\n"}], "owner": {"reputation": 31, "user_id": 10920216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbab05edcf47bd3fa33055ef88d9701?s=128&d=identicon&r=PG&f=1", "display_name": "sabre45", "link": "https://stackoverflow.com/users/10920216/sabre45"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1547668792, "creation_date": 1547610573, "question_id": 54210152, "link": "https://stackoverflow.com/questions/54210152/github-pages-jekyll-not-loading-css-when-using-custom-domain", "title": "Github Pages jekyll not loading CSS when using custom domain", "body": "<p>My Jekyll blog on Github fails to load CSS and other site files when using a custom domain. I can only see the text.</p>\n\n<p>The site works fine when I use the standard github.io domain (username.github.io/BLOG)</p>\n\n<p>Every time I setup the blog's page on Github Pages as blog.domain.com, the site fails to load correctly.</p>\n\n<p>Github repo: <a href=\"https://github.com/sabre45/BLOG\" rel=\"nofollow noreferrer\">https://github.com/sabre45/BLOG</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "heroku"], "answers": [{"tags": [], "owner": {"reputation": 252, "user_id": 1375545, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/73fedd6a827bf17c6b053e815fdf16f3?s=128&d=identicon&r=PG", "display_name": "Dave Olson", "link": "https://stackoverflow.com/users/1375545/dave-olson"}, "is_accepted": false, "score": 0, "last_activity_date": 1547692833, "creation_date": 1547692833, "answer_id": 54228229, "question_id": 54210096, "link": "https://stackoverflow.com/questions/54210096/rails-with-react-only-serving-react-pages-when-deployed-to-heroku-cant-access/54228229#54228229", "title": "Rails with React only serving React pages when deployed to heroku, can&#39;t access any Rails routes", "body": "<p>Solved the problem. It was an issue with not refreshing the browser cache.... duhh</p>\n"}], "owner": {"reputation": 252, "user_id": 1375545, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/73fedd6a827bf17c6b053e815fdf16f3?s=128&d=identicon&r=PG", "display_name": "Dave Olson", "link": "https://stackoverflow.com/users/1375545/dave-olson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547692833, "creation_date": 1547610112, "last_edit_date": 1547611396, "question_id": 54210096, "link": "https://stackoverflow.com/questions/54210096/rails-with-react-only-serving-react-pages-when-deployed-to-heroku-cant-access", "title": "Rails with React only serving React pages when deployed to heroku, can&#39;t access any Rails routes", "body": "<p>I'm working with an existing Rails app that has been refactored as an api for React and a dashboard backend. \nA complete React app (with React Router, Redux and Saga) was built and installed into the client folder in the Rails root. </p>\n\n<p>On my local machine, I start a node server on port 3000 and a rails server on 3001. My package.json in the client folder includes<br>\n<code>\"proxy\": \"http://localhost:3001/\",</code></p>\n\n<p>I can access the React app but it does not get data from the API. I can access the Rails app on 3001. The log error is:</p>\n\n<pre><code>Proxy error: Could not proxy request /api/v1/homedata from localhost:3000 to http://localhost:3001/.\n</code></pre>\n\n<p>My console shows this error: </p>\n\n<pre><code>xhr.js:178 GET http://localhost:3000/api/v1/homedata 500 (Internal Server Error)\n</code></pre>\n\n<p>When I deploy to Heroku, the React App is served at my domain but I am unable to access the Rails dashboard. However, the React app properly accesses the Rails API and shows the data.</p>\n\n<p>I have spent about three days searching everywhere for some idea. My best guess at this point is that there is some issue with the Rails server or routes. However I have no idea anymore where to look. I'll post my routes.rb</p>\n\n<pre><code>    Rails.application.routes.draw do\n\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nroot \"dashboard/home#index\"\n  ### Routing for the dashboard ###\nnamespace :dashboard do\n  resources :home, only: [:index]\n  resources :connect_groups\n  resources :events\n  resources :event_types\n  resources :locations\n  resources :podcasts\n  resources :users\n  get \"/ajax_load_events\", to: \"home#ajax_load_events\"\n  get \"/ajax_load_locations\", to: \"home#ajax_load_locations\"\n  get \"/ajax_load_podcasts\", to: \"home#ajax_load_podcasts\"\n  get \"/ajax_load_connect_groups\", to: \"home#ajax_load_connect_groups\"\n  get \"/ajax_load_users\", to: \"home#ajax_load_users\"\n  get '', to: 'home#index'\n  post \"dashboard/podcasts/upload\", to: \"audio_clips#create\"\nend\n\n  devise_for :users, :controllers =&gt; {:registrations =&gt; \"registrations\"}\n\n  ### Routing for the new API ###\n  namespace :api, defaults: { format: 'json' } do\n    namespace :v1 do\n      resources :locations\n      resources :podcasts\n      resources :events\n      resources :connect_groups\n      resources :messages, only: [ :create]\n      get \"/location/*id\", to: \"locations#get_location\"\n      get \"/event/featured\", to: \"events#featured_events\"\n      get \"/homedata\", to: \"home#index\"\n    end\n  end\n\n\n  mount Shrine.presign_endpoint(:cache) =&gt; \"/presign\"\n\n  match \"/loaderio-0077704941f2bf1a629295ce9fb1a229\", :to =&gt; proc { |env| [200, {}, [\"loaderio-0077704941f2bf1a629295ce9fb1a229\"]] }, via: :get\n\n  get '*path', to: \"application#fallback_index_html\", constraints: -&gt;(request) do\n  !request.xhr? &amp;&amp; request.format.html?\nend\n\nend\n</code></pre>\n\n<p>Any help or some idea where to start would be a huge help. </p>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 8109966, "user_type": "registered", "profile_image": "https://graph.facebook.com/1680046262035880/picture?type=large", "display_name": "Fahim Abdullah", "link": "https://stackoverflow.com/users/8109966/fahim-abdullah"}, "is_accepted": false, "score": -1, "last_activity_date": 1547609211, "creation_date": 1547609211, "answer_id": 54209991, "question_id": 54209918, "link": "https://stackoverflow.com/questions/54209918/ruby-on-rails-why-is-the-layout-not-being-changed-while-loading-css-in-view/54209991#54209991", "title": "ruby on rails Why is the layout not being changed while loading css in view?", "body": "<p>If you are using Rails 5, rename application.css to application.scss and confirm_csv.css to confirm_csv.css.scss. Also add this line in the application.scss <code>@import \"confirm_csv.css\"</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9399531, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V7tey73_Aac/AAAAAAAAAAI/AAAAAAAAABc/N6P8ZsrfH4A/photo.jpg?sz=128", "display_name": "kuri", "link": "https://stackoverflow.com/users/9399531/kuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547609211, "creation_date": 1547608508, "question_id": 54209918, "link": "https://stackoverflow.com/questions/54209918/ruby-on-rails-why-is-the-layout-not-being-changed-while-loading-css-in-view", "title": "ruby on rails Why is the layout not being changed while loading css in view?", "body": "<p>ruby on rails  Why is the layout not being changed while loading css in view?\nThe current code is as follows  </p>\n\n<p><a href=\"https://i.stack.imgur.com/fk2O5.png\" rel=\"nofollow noreferrer\">I will attach a screen shot of the display</a></p>\n\n<p>confirm_csv.html.erb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;%= stylesheet_link_tag \"confirm_csv\", :media =&gt; \"all\" %&gt;\n\u30fb\u30fb\u30fbetc\n</code></pre>\n\n<p>config/initializers/assets.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.config.assets.precompile += %w( confirm_csv.css )\n</code></pre>\n\n<p>app/assets/stylesheets/application.css</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>/*\n*= require_tree .\n*= require_self\n*/\n</code></pre>\n\n<p>app/assets/stylesheets/confirm_csv.css</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>table {\nalign: center;\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activestorage", "rubyzip"], "answers": [{"tags": [], "owner": {"reputation": 234, "user_id": 10637468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8afa27d12df2ee4d3012a2fcee8bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Devchris", "link": "https://stackoverflow.com/users/10637468/devchris"}, "is_accepted": false, "score": 1, "last_activity_date": 1595167895, "creation_date": 1595167895, "answer_id": 62981367, "question_id": 54209861, "link": "https://stackoverflow.com/questions/54209861/rubyzip-unable-to-find-path-of-file-stored-in-active-storage/62981367#62981367", "title": "RubyZip : Unable to find path of file stored in Active Storage", "body": "<p>I just had a similar problem but saw this hasn't been answered yet. Even though it's a little older and you probably already solved this, here is my approach. The trick here was to create a tempfile in between</p>\n<pre><code>def whatever\n    zip_file = Tempfile.new('invoices.zip')\n\n    Zip::File.open(zip_file.path, Zip::File::CREATE) do |zipfile|\n      invoices.each do |invoice|\n        next unless invoice.attachment.attached?\n\n        overlay = Tempfile.new(['overlay', '.pdf'])\n        overlay.binmode\n        overlay.write(invoice.attachment.download)\n        overlay.close\n        overlay.path\n\n        zipfile.add(invoice.filename, File.join(overlay.path))\n      end\n    end\n\n    invoices_zip = File.read(zip_file.path)\n\n    UserMailer.with(user: user).invoice_export(invoices_zip, 'invoices.zip').deliver_now\n  ensure\n    zip_file.close\n    zip_file.unlink\n  end\n</code></pre>\n"}], "owner": {"reputation": 24, "user_id": 8109966, "user_type": "registered", "profile_image": "https://graph.facebook.com/1680046262035880/picture?type=large", "display_name": "Fahim Abdullah", "link": "https://stackoverflow.com/users/8109966/fahim-abdullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1595167895, "creation_date": 1547607932, "last_edit_date": 1547608312, "question_id": 54209861, "link": "https://stackoverflow.com/questions/54209861/rubyzip-unable-to-find-path-of-file-stored-in-active-storage", "title": "RubyZip : Unable to find path of file stored in Active Storage", "body": "<p>I am using Rails 5.2 and ActiveStorage to let my users upload files in my app. I have all the uploaded files displayed in a table and I can choose to select which ones I want to download. After selecting, I will be able to download all of them in a zip file. To zip the files, I am using Rubyzip and I can't get to work properly.</p>\n\n<p>I have tried two ways : <br>\n1 - I tried <a href=\"https://stackoverflow.com/questions/44693925/how-to-download-multiple-files-from-s3-as-zip-format-in-rails-5-x-x-app\">this way</a> and faced this error <br><strong>No such file or directory @ rb_sysopen - /rails/active_storage/blobs/..../2234.py</strong><br>This is my controller : \n <br></p>\n\n<pre><code>def batch_download\n  if params[\"record\"].present?\n    ids = params[\"record\"].to_unsafe_h.map(&amp;:first)\n\n    if ids.present?\n      folder_path = \"#{Rails.root}/public/downloads/\"\n      zipfile_name = \"#{Rails.root}/public/archive.zip\"\n\n      FileUtils.remove_dir(folder_path) if Dir.exist?(folder_path)\n      FileUtils.remove_entry(zipfile_name) if File.exist?(zipfile_name)\n      Dir.mkdir(\"#{Rails.root}/public/downloads\")\n\n      Record.where(id: ids).each do |attachment|\n        open(folder_path + \"#{attachment.file.filename}\", 'wb') do |file|\n          file &lt;&lt; open(\"#{rails_blob_path(attachment.file)}\").read\n        end\n      end\n\n      input_filenames = Dir.entries(folder_path).select {|f| !File.directory? f}\n\n      Zip::File.open(zipfile_name, Zip::File::CREATE) do |zipfile|\n        input_filenames.each do |attachment|\n          zipfile.add(attachment,File.join(folder_path,attachment))\n        end\n      end\n\n      send_file(File.join(\"#{Rails.root}/public/\", 'archive.zip'), :type =&gt; 'application/zip', :filename =&gt; \"#{Time.now.to_date}.zip\")\n    end\n  else\n    redirect_back fallback_location: root_path\n  end\nend\n</code></pre>\n\n<p>2 - Secondly I tried to follow the <a href=\"https://github.com/rubyzip/rubyzip\" rel=\"nofollow noreferrer\">rubyzip documentation</a> and the error was a bit different. <br>\n<strong>No such file or directory @ rb_file_s_lstat - /rails/active_storage/blobs/..../2234.py</strong></p>\n\n<pre><code>if ids.present?\n      folder = []\n      input_filenames = []\n      Record.where(id: ids).each do |attachment| \n        input_filenames.push(\"#{attachment.file.filename}\")\n        pre_path = \"/rails/active_storage/blobs/\"\n        path_find = \"#{rails_blob_path(attachment.file)}\"\n        folder.push(pre_path + path_find.split('/')[4])\n      end\n      container = Hash[folder.zip(input_filenames)]\n\n      zipfile_name = \"/Users/fahimabdullah/Documents/archive.zip\"\n\n      Zip::File.open(zipfile_name, Zip::File::CREATE) do |zipfile|\n        # input_filenames.each do |filename|\n        container.map do |path, filename|\n        zipfile.add(filename, File.join(path, filename))\n        end\n        zipfile.get_output_stream(\"myFile\") { |f| f.write \"myFile contains just this\" }\n      end\n</code></pre>\n\n<p>I expect it to download a zip file containing all the files inside. And this is my first question so please excuse me if the question was too long. Thank you. </p>\n"}, {"tags": ["ruby", "mongoid", "rspec-rails"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9447346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVGx4.png?s=128&g=1", "display_name": "Couentine", "link": "https://stackoverflow.com/users/9447346/couentine"}, "is_accepted": true, "score": 0, "last_activity_date": 1548519303, "creation_date": 1548519303, "answer_id": 54380199, "question_id": 54209839, "link": "https://stackoverflow.com/questions/54209839/mongoid-and-rspec-error-mongoerrornoserveravailable/54380199#54380199", "title": "Mongoid and Rspec error Mongo::Error::NoServerAvailable:", "body": "<p>Found the answer</p>\n\n<p>My config file had mistake  so I change it to :</p>\n\n<p>test:\n  clients:\n    default:\n      database: test\n      hosts:\n        - 127.0.0.1:27017\n      options:\n        read:\n          mode: :primary\n        max_pool_size: 1\n  log_level: :debug</p>\n"}], "owner": {"reputation": 1, "user_id": 9447346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVGx4.png?s=128&g=1", "display_name": "Couentine", "link": "https://stackoverflow.com/users/9447346/couentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 54380199, "answer_count": 1, "score": 0, "last_activity_date": 1548519303, "creation_date": 1547607794, "last_edit_date": 1547608691, "question_id": 54209839, "link": "https://stackoverflow.com/questions/54209839/mongoid-and-rspec-error-mongoerrornoserveravailable", "title": "Mongoid and Rspec error Mongo::Error::NoServerAvailable:", "body": "<p>When I am starting my Rspec test, I get this error:</p>\n\n<pre><code>  1) User checks if the user is created\n     Failure/Error: expect{ @user_test = create(:user) }.to change { User.count }\n\n     Mongo::Error::NoServerAvailable:\n       No server is available matching preference: #&lt;Mongo::ServerSelector::Primary:0x70316515164800 tag_sets=[] max_staleness=nil&gt; using server_selection_timeout=30 and local_threshold=0.015\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongo-2.5.0/lib/mongo/server_selector/selectable.rb:115:in `select_server'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongo-2.5.0/lib/mongo/collection/view/readable.rb:139:in `block in count'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongo-2.5.0/lib/mongo/retryable.rb:44:in `read_with_retry'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongo-2.5.0/lib/mongo/collection/view/readable.rb:138:in `count'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongoid-5.2.1/lib/mongoid/contextual/mongo.rb:70:in `block in count'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongoid-5.2.1/lib/mongoid/contextual/mongo.rb:504:in `try_cache'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongoid-5.2.1/lib/mongoid/contextual/mongo.rb:70:in `count'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongoid-5.2.1/lib/mongoid/contextual.rb:20:in `count'\n     # /Users/aliceguillaume/.rvm/gems/ruby-2.3.4/gems/mongoid-5.2.1/lib/mongoid/findable.rb:55:in `count'\n     # ./spec/models/user_spec.rb:11:in `block (3 levels) in &lt;top (required)&gt;'\n     # ./spec/models/user_spec.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 30.14 seconds (files took 8.39 seconds to load)\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/models/user_spec.rb:10 # User checks if the user is created\n</code></pre>\n\n<p>I am really confused about it.</p>\n\n<p>My mongo server is running too.</p>\n\n<p>My user_spec.rb: </p>\n\n<pre><code>require 'spec_helper'\nrequire 'rails_helper'\nrequire 'database_cleaner'\n\n\nDatabaseCleaner.strategy = :truncation\n\nRSpec.describe User, :type =&gt; :model do\n\n  it \"checks if the user is created\" do\n    expect{ @user_test = create(:user) }.to change { User.count }\n  end\n\nend\n</code></pre>\n\n<p>Any idea why my mongo won't work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "comments": [{"owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "edited": false, "score": 0, "creation_date": 1547619154, "post_id": 54209837, "comment_id": 95248570, "body": "this probably can help you <a href=\"https://stackoverflow.com/a/11352918/938947\">stackoverflow.com/a/11352918/938947</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "edited": false, "score": 0, "creation_date": 1547648981, "post_id": 54210122, "comment_id": 95264088, "body": "I guess I get a little stuck on the &quot;resource&quot; keyword. The routes.rb that I have is probably out of the norm. I believe the &quot;get&quot; and &quot;to&quot; need to be in a loop with an &quot;end&quot; but what would the header line be? The documentation is a little confusing for this case. Thx."}], "tags": [], "owner": {"reputation": 24, "user_id": 8109966, "user_type": "registered", "profile_image": "https://graph.facebook.com/1680046262035880/picture?type=large", "display_name": "Fahim Abdullah", "link": "https://stackoverflow.com/users/8109966/fahim-abdullah"}, "is_accepted": true, "score": 0, "last_activity_date": 1547610305, "creation_date": 1547610305, "answer_id": 54210122, "question_id": 54209837, "link": "https://stackoverflow.com/questions/54209837/how-do-i-create-a-routes-rb-entry-for-a-controller/54210122#54210122", "title": "How do I create a routes.rb entry for a controller?", "body": "<p>You can try to put <code>get \u2018htmlfilename\u2019, to:\u2019test#iframe\u2019</code>in the routes.rb and see if it works. The htmlfilename should be without the extension. And in the url_for you can put the <strong>path</strong> rather than <code>controller: 'test', action: 'iframe'</code>. For more information you can check the Rails <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">routing documentation here</a>.</p>\n"}], "owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54210122, "answer_count": 1, "score": 0, "last_activity_date": 1547610305, "creation_date": 1547607786, "question_id": 54209837, "link": "https://stackoverflow.com/questions/54209837/how-do-i-create-a-routes-rb-entry-for-a-controller", "title": "How do I create a routes.rb entry for a controller?", "body": "<p>I'm trying to populate an iframe with some erb and I can't figure out how to create a route to the new controller.</p>\n\n<pre><code>class TestController &lt; ApplicationController\n  def iframe\n    load_channels\n    render :partial =&gt; \"report\", :layout =&gt; \"test\"\n  end\nend\n</code></pre>\n\n<p>This is in my webpage:</p>\n\n<pre><code>&lt;iframe src=\"&lt;%= url_for controller: 'test', action: 'iframe' %&gt;\" name=\"report\"&gt;&lt;/iframe&gt;\"\n</code></pre>\n\n<p>I created a layout with basic html and erb. </p>\n\n<p>I'm getting \"no route matches\" error. When I look at the routes.rb file it's one of the most confusing config files that I've ever seen. </p>\n\n<p>How do I route to this controller? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1547605047, "post_id": 54209517, "comment_id": 95245284, "body": "Just because <code>@profile</code> is nil. What else is in the code?"}], "answers": [{"tags": [], "owner": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "is_accepted": false, "score": 2, "last_activity_date": 1547605410, "creation_date": 1547605410, "answer_id": 54209565, "question_id": 54209517, "link": "https://stackoverflow.com/questions/54209517/undefined-method-user-for-nilnilclass/54209565#54209565", "title": "-undefined method `user&#39; for nil:NilClass", "body": "<p><code>Profile.find_by</code> is returning <code>nil</code> ie: no user was found.\nSo, when you try <code>@profile.user</code>, you are trying to access <code>user</code> on a <code>nil</code>.</p>\n\n<p>Make sure the profile exists with the <code>user_id</code> matching <code>params[:id]</code> and that <code>params[:id]</code> isn't blank or nil.</p>\n\n<p>A way to get rid of the fatal error would be to check if <code>@profile</code> is nil or not before using it:</p>\n\n<pre><code>def update\n  @profile = Profile.find_by(user_id: params[:id])\n  if @profile.present? \n    if @profile.user == current_user\n      @profile.update(profile_params) \n      flash[:info] = \"Profile successfully updated\" \n    else\n    end\n  else\n    # Profile not found\n  end\nend\n</code></pre>\n\n<p>Or, you could use the bang variation of <code>find_by</code>:</p>\n\n<p><code>Profile.find_by!</code></p>\n\n<p>Which will throw an exception if nothing is found (which you can then rescue from)</p>\n"}], "owner": {"reputation": 1, "user_id": 10918350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae847c04c22a8db3ac7ff11e72b85988?s=128&d=identicon&r=PG&f=1", "display_name": "vjhbr", "link": "https://stackoverflow.com/users/10918350/vjhbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547623367, "creation_date": 1547604975, "last_edit_date": 1547623367, "question_id": 54209517, "link": "https://stackoverflow.com/questions/54209517/undefined-method-user-for-nilnilclass", "title": "-undefined method `user&#39; for nil:NilClass", "body": "<p>On the <code>update</code> controller action, rails returns following error,</p>\n\n<pre><code>undefined method `user' for nil:NilClass\n</code></pre>\n\n<p>Issue is supposed to be in following,</p>\n\n<pre><code>def update\n  @profile = Profile.find_by(user_id: params[:id])\n  if @profile.user == current_user\n    @profile.update(profile_params) \n    flash[:info] = \"Profile successfully updated\" \n  else\n</code></pre>\n\n<p>It doesn't make sense why this is an issue, since I used the exact same code to find profiles in my other actions and they worked perfectly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "dropdown"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1547627326, "post_id": 54209043, "comment_id": 95251697, "body": "How did you add bootstrap to the project? With a gem? If yes, check if you required it in application.js according to gem docs"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1547652782, "post_id": 54209043, "comment_id": 95266470, "body": "yeah i added it with a gem. It has been required in application.js and it is not working still. @Vasilisa"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1547695525, "post_id": 54209043, "comment_id": 95282651, "body": "Do you use turbolinks? If you refresh the page, the dropdown starts to work or still not working? Please, add application.js to the question?"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547634078, "creation_date": 1547600608, "last_edit_date": 1547634078, "question_id": 54209043, "link": "https://stackoverflow.com/questions/54209043/dropdown-is-not-working-bootstrap-ruby-on-rails", "title": "dropdown is not working - bootstrap - ruby on rails", "body": "<p>Part of my navbar code is below, which is supposed to activate when the image is clicked but it is not working.\nI have bootstrap working on my website as if i type <code>class=\"text-primary\"</code> the text will turn blue.\nso im not sure what is wrong, or is it super obvious? thanks</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>     \r\n        &lt;div class=\"dropdown\"&gt;\r\n          &lt;%= image_tag \"https://images.unsplash.com/photo-1507146426996-ef05306b995a?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80\", class: \"avatar dropdown-toggle\", id: \"navbar-wagon-menu\", \"data-toggle\" =&gt; \"dropdown\" %&gt;\r\n          &lt;ul class=\"dropdown-menu dropdown-menu-right navbar-wagon-dropdown-menu\"&gt;\r\n            &lt;li&gt;\r\n              &lt;%= link_to \"#\" do %&gt;\r\n                &lt;i class=\"fa fa-user\"&gt;&lt;/i&gt; &lt;%= t(\".profile\", default: \"Profile\") %&gt;\r\n              &lt;% end %&gt;\r\n            &lt;/li&gt;\r\n            &lt;li&gt;\r\n              &lt;%= link_to \"#\" do %&gt;\r\n                &lt;i class=\"fa fa-cog\"&gt;&lt;/i&gt;  &lt;%= t(\".settings\", default: \"Settings\") %&gt;\r\n              &lt;% end %&gt;\r\n            &lt;/li&gt;\r\n            &lt;li&gt;\r\n              &lt;%= link_to destroy_user_session_path, method: :delete do %&gt;\r\n                &lt;i class=\"fa fa-sign-out\"&gt;&lt;/i&gt;  &lt;%= t(\".sign_out\", default: \"Log out\") %&gt;\r\n              &lt;% end %&gt;\r\n            &lt;/li&gt;\r\n          &lt;/ul&gt;\r\n        &lt;/div&gt;\r\n      </code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1547597102, "post_id": 54208555, "comment_id": 95243712, "body": "you declaring <code>Id = 100 </code>or <code>id = 100</code>, because its different..."}, {"owner": {"reputation": 23, "user_id": 5319324, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VWg_sv_ayNw/AAAAAAAAAAI/AAAAAAAAAAA/qwA8Feb3A9I/photo.jpg?sz=128", "display_name": "Badari Kodegenahalli", "link": "https://stackoverflow.com/users/5319324/badari-kodegenahalli"}, "reply_to_user": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "edited": false, "score": 0, "creation_date": 1547597238, "post_id": 54208555, "comment_id": 95243752, "body": "Sorry, ignore my typo. The variable name in both the files is same.                urls.rb has the folloing $event = &quot;/sendmessage/#{id}&quot;                                      testcase.rb has the following require &#39;urls.rb&#39; id=100 puts $event"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547627951, "post_id": 54208609, "comment_id": 95251995, "body": "Defining <code>id</code> before calling <code>require &#39;urls.rb&#39;</code> results in the same error."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 1, "last_activity_date": 1547597166, "creation_date": 1547597166, "answer_id": 54208609, "question_id": 54208555, "link": "https://stackoverflow.com/questions/54208555/ruby-string-interpolation-not-working-when-called-from-an-included-file/54208609#54208609", "title": "Ruby string interpolation not working when called from an included file", "body": "<p>The problem is that you are attempting to use <code>id</code> in <code>urls.rb</code> before it has been defined by <code>testcase.rb</code>. Your code is functionally equivalent to the following:</p>\n\n<pre><code>$event = \"/sendmessage/#{id}\"\nid = 100\nputs $event\n</code></pre>\n\n<p>This does not work because you are attempting to call <code>id</code> before it has been defined. You must define the variable first:</p>\n\n<pre><code>id = 100\n$event = \"/sendmessage/#{id}\"\nputs $event\n</code></pre>\n\n<p>Here it works because you have defined <code>id</code> <em>before</em> you're trying to call it.</p>\n\n<p>When troubleshooting a problem like this, consider how it would have to work if you were not separating it into different files.</p>\n\n<p>So without knowing more about what you're trying to accomplish, just make sure you have defined a variable <em>before</em> you try to call it.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1547628148, "post_id": 54210543, "comment_id": 95252074, "body": "Or use an object with global scope instead like a constant or global variable instead of a local variable."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 1, "last_activity_date": 1547614519, "last_edit_date": 1547614519, "creation_date": 1547613737, "answer_id": 54210543, "question_id": 54208555, "link": "https://stackoverflow.com/questions/54208555/ruby-string-interpolation-not-working-when-called-from-an-included-file/54210543#54210543", "title": "Ruby string interpolation not working when called from an included file", "body": "<p>Local variables like <code>id</code> cannot be called across files. Their scopes are limited within a file. In order to use it, you have to assign <code>id</code> in the same file as it is used. Furthermore, your assignment of <code>id</code> after requiring <code>'urls.rb'</code> is meaningless.</p>\n"}], "owner": {"reputation": 23, "user_id": 5319324, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VWg_sv_ayNw/AAAAAAAAAAI/AAAAAAAAAAA/qwA8Feb3A9I/photo.jpg?sz=128", "display_name": "Badari Kodegenahalli", "link": "https://stackoverflow.com/users/5319324/badari-kodegenahalli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 54210543, "answer_count": 2, "score": 1, "last_activity_date": 1547614519, "creation_date": 1547596817, "last_edit_date": 1547613554, "question_id": 54208555, "link": "https://stackoverflow.com/questions/54208555/ruby-string-interpolation-not-working-when-called-from-an-included-file", "title": "Ruby string interpolation not working when called from an included file", "body": "<p>I have two files: <code>urls.rb</code> and <code>testcase.rb</code>. <code>urls.rb</code> has the following:</p>\n\n<pre><code>$event = \"/sendmessage/#{id}\"\n</code></pre>\n\n<p>The <code>id</code> in the url is generated in <code>testcase.rb</code>. This is the code in <code>testcase.rb</code>:</p>\n\n<pre><code>require 'urls.rb'\n\nid = 100\nputs $event \n</code></pre>\n\n<p>I am seeing the following error:</p>\n\n<pre><code>undefined local variable or method `id' for main:Object (NameError)\n</code></pre>\n\n<p>How do I resolve this error?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1547594236, "post_id": 54206988, "comment_id": 95243075, "body": "I suspect that <code>@patient = Patient.find_by_id(params[:id])</code> is the problem, as its in the ProvidersController, so I would assume that <code>params[:id]</code> would be the id of the provider. If this is the case then you might get this error, as there it might be provider id = 100 and there might not be a Patient with id = 100. However, I&#39;m also curious why you even have <code>@patient = Patient.find_by_id(params[:id])</code> in there, it doesn&#39;t look to be used in your partial"}, {"owner": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "reply_to_user": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1547596703, "post_id": 54206988, "comment_id": 95243626, "body": "well i have @patient = Patient.find_by_in(params[:id]) becuase im trying to render all the patient first and last names in the view"}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1547598010, "post_id": 54206988, "comment_id": 95243916, "body": "I notice that you edited out the <code>@patient = Patient.find_by_id(params[:id])</code>, are you still having issues?"}], "answers": [{"tags": [], "owner": {"reputation": 589, "user_id": 1758824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e92483a59af1553c65339b92bcbbf4e?s=128&d=identicon&r=PG", "display_name": "Kate Kasinskaya", "link": "https://stackoverflow.com/users/1758824/kate-kasinskaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1547594766, "creation_date": 1547594766, "answer_id": 54208298, "question_id": 54206988, "link": "https://stackoverflow.com/questions/54206988/3-tables-interact-with-eachother-together-but-patient-id-coming-back-nil/54208298#54208298", "title": "3 tables interact with eachother together but patient id coming back nil", "body": "<p>In the view you have a link: <code>&lt;%= link_to patients_path(id: provider.id) %&gt;</code>\nand in the controller <code>@patient = Patient.find_by_id(params[:id])</code> - which is literally equal to <code>@patient = Patient.find_by_id(provider.id)</code> and of course rails can't find such a record. </p>\n\n<p>you should pass <code>patient_id</code> to this action if you want to find some specific patient.</p>\n"}], "owner": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547596983, "creation_date": 1547587298, "last_edit_date": 1547596983, "question_id": 54206988, "link": "https://stackoverflow.com/questions/54206988/3-tables-interact-with-eachother-together-but-patient-id-coming-back-nil", "title": "3 tables interact with eachother together but patient id coming back nil", "body": "<p>So i have three models that associate with each other. I have patients, providers, and lists. patients can have many providers and vice versa. List is the middle man. patients can add providers to list which works perfect and it displays all the providers on the list_id. However on the provider side when i try to render to all the providers patients. I get a error saying \"Couldn't find Patient with \"id\"=\n<a href=\"https://i.stack.imgur.com/s092R.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n\n\n<pre><code>class ProvidersController &lt; ApplicationController\ndef patient_access\n        @provider = current_user.provider\n        @active_patients = @provider.lists.where(soft_delete: false)\n        render \"providers/patient_access\"\n    end\nend\n\n&lt;!-- Here is the patients controller which everything works fine on the patients side of the app as far as displaying all providers that belongs to that patient --&gt;\n\nclass PatientsController &lt; ApplicationController\ndef provider_access\n        flash[:modal] = true\n        @patient = Patient.find(params[:patient_id])\n        @active_providers = @patient.lists.where(soft_delete: false)\n\n    end\nend\n</code></pre>\n\n<p>&lt;-- Here is my patient_access.html.erb file --></p>\n\n<pre><code>&lt;%= render :partial =&gt; 'shared/side_menu' %&gt;\n&lt;div class=\"container-main\"&gt;\n    &lt;br/&gt;\n&lt;div class=\"content-container your-sites\"&gt;\n        &lt;div class=\"header\"&gt;\n            &lt;div class=\"icon-circle\"&gt;&lt;div class=\"icon\"&gt;&lt;%= image_tag \"my-providers-2x.png\" %&gt;&lt;/div&gt;&lt;/div&gt;\n            &lt;div class=\"title\"&gt;Your Patients&lt;/div&gt;\n        &lt;/div&gt;&lt;!--header--&gt;\n        &lt;div class=\"body\"&gt;\n            &lt;div class=\"body\"&gt;\n            &lt;% if @active_patients.count &gt; 0 %&gt;\n                &lt;table&gt;\n                  &lt;thead&gt;\n                    &lt;tr&gt;\n                      &lt;th&gt;Patient Name&lt;/th&gt;\n                      &lt;th&gt;Actions&lt;/th&gt;\n                    &lt;/tr&gt;\n                  &lt;/thead&gt;\n                  &lt;tbody&gt;\n                    &lt;% @active_patients.each do |list| %&gt;\n                      &lt;tr&gt;\n                        &lt;td&gt;&lt;%= list.patient.role.user.first_name %&gt; &lt;%= list.patient.role.user.last_name %&gt;&lt;/td&gt;\n                        &lt;td&gt;\n                            &lt;%= link_to patients_path(patient_id) %&gt;\n                        &lt;/td&gt;\n                      &lt;/tr&gt;\n                    &lt;% end %&gt;\n                  &lt;/tbody&gt;\n                &lt;/table&gt;\n            &lt;% else %&gt;\n                &lt;div class=\"no-records\"&gt;\n                    &lt;%= image_tag \"icon-no-records\", class: \"image\" %&gt;\n                    &lt;div class=\"text\"&gt;You have no patients.&lt;/div&gt;\n                &lt;/div&gt;&lt;!--no-records--&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;&lt;!--body--&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1547587841, "creation_date": 1547587841, "answer_id": 54207110, "question_id": 54206836, "link": "https://stackoverflow.com/questions/54206836/replace-markdown-links-with-text-and-url/54207110#54207110", "title": "Replace markdown links with text and url", "body": "<p>You could use <code>gsub</code> with a regexp like this:</p>\n\n<pre><code>text = \"[text1](https://www.stackoverflow.com) and [text2](https://www.google.com)\"\n\ntext.gsub(/\\[(.*?)\\]\\((.*?)\\)/, \"#{$1} #{$2}\")\n#=&gt; \"text2 https://www.google.com and text2 https://www.google.com\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5806784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870a3235b08fcea4bb7fae815d5e1e28?s=128&d=identicon&r=PG&f=1", "display_name": "MattM", "link": "https://stackoverflow.com/users/5806784/mattm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1547591858, "creation_date": 1547586543, "question_id": 54206836, "link": "https://stackoverflow.com/questions/54206836/replace-markdown-links-with-text-and-url", "title": "Replace markdown links with text and url", "body": "<p>My goal is to turn markdown into text. I am accomplishing this with parsing markdown into HTML using Redcarpet, and then using #strip_tags. My issue is with links, this method only preserves the text of the link and not the link itself.</p>\n\n<p>Ex: I need to preserve the href url after using #strip_tags</p>\n\n<pre><code># current\n&lt;a href=\"http://www.google.com\"&gt;google&lt;/a&gt; =&gt; google\n# desired\n&lt;a href=\"http://www.google.com\"&gt;google&lt;/a&gt; =&gt; http://www.google.com google\n</code></pre>\n\n<p>I think the best way would be to use regex, can anyone help implementing this?</p>\n\n<p>My goal is:</p>\n\n<pre><code>def contents_md\n\n# instantiates Redcarpet\n    @markdown ||= begin\n        options = [autolink: true, fenced_code_blocks: true,     no_intra_emphasis: true, hard_wrap: true, filter_html: true, gh_blockcode: true]\n        renderer = Redcarpet::Render::HTML.new(render_options = {})\n        Redcarpet::Markdown.new(renderer, *options)\n    end\n\n# I need to run contents through a regex before passing to renderer that will turn something like this:\n# [text1](https://www.stackoverflow.com) and [text2](https://www.google.com)\n# into:\n# text1 https://www.stackoverflow.com and text2 https://www.google.com\n\n\n# then ill pass the result here, which will preserve my links that would be held in &lt;a&gt;&lt;/a&gt; instead of losing them \n @markdown.render(contents)\nend\n\n# this will then be ran like:\n&lt;%= strip_tags(value.contents_md) %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1547594604, "post_id": 54206295, "comment_id": 95243159, "body": "It kinda sounds like you might have another copy of bundler installed on your computer, try using <code>which bundler</code> to see where its going when you try and run bundler."}, {"owner": {"reputation": 23, "user_id": 9280879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848ef284786ad14462e27cdfca262453?s=128&d=identicon&r=PG&f=1", "display_name": "Farsight", "link": "https://stackoverflow.com/users/9280879/farsight"}, "reply_to_user": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 1, "creation_date": 1550095335, "post_id": 54206295, "comment_id": 96149153, "body": "Figured it out. The bash profile had a second Path that was overriding the correct path."}], "answers": [{"tags": [], "owner": {"reputation": 4920, "user_id": 846075, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/5muc1.jpg?s=128&g=1", "display_name": "Bijoy Thangaraj", "link": "https://stackoverflow.com/users/846075/bijoy-thangaraj"}, "is_accepted": false, "score": 1, "last_activity_date": 1582610845, "creation_date": 1582610845, "answer_id": 60388424, "question_id": 54206295, "link": "https://stackoverflow.com/questions/54206295/bundler-bad-interpreter-no-such-file-or-directory/60388424#60388424", "title": "bundler: bad interpreter: no such file or directory", "body": "<p>You can try installing bundler to the mentioned location.</p>\n\n<pre><code>sudo gem install -n /usr/local/bin/ bundler\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9280879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848ef284786ad14462e27cdfca262453?s=128&d=identicon&r=PG&f=1", "display_name": "Farsight", "link": "https://stackoverflow.com/users/9280879/farsight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582610845, "creation_date": 1547583773, "question_id": 54206295, "link": "https://stackoverflow.com/questions/54206295/bundler-bad-interpreter-no-such-file-or-directory", "title": "bundler: bad interpreter: no such file or directory", "body": "<p>Trying to get bundler to run, greeted with <code>-bash: /usr/local/bin/bundler: /usr/local/opt/ruby/bin/ruby: bad interpreter: No such file or directory</code>.  Have tried un installing rbenv reinstalling, uninstalling/reinstalling bundler. Nothing seems to fix this. How do I change the path to for installed bundler?</p>\n\n<pre><code>:&gt; gem install bundler\nSuccessfully installed bundler-2.0.1\nParsing documentation for bundler-2.0.1\nDone installing documentation for bundler after 2 seconds\n1 gem installed\n\n</code></pre>\n\n<p>This is my current Current Gem ENV:</p>\n\n<pre><code>:&gt; gem env\nRubyGems Environment:\n  - RUBYGEMS VERSION: 3.0.1\n  - RUBY VERSION: 2.6.0 (2018-12-25 patchlevel 0) [x86_64-darwin18]\n  - INSTALLATION DIRECTORY: /Users/Cherubim/.rbenv/versions/2.6.0/lib/ruby/gems/2.6.0\n  - USER INSTALLATION DIRECTORY: /Users/Cherubim/.gem/ruby/2.6.0\n  - RUBY EXECUTABLE: /Users/Cherubim/.rbenv/versions/2.6.0/bin/ruby\n  - GIT EXECUTABLE: /usr/local/bin/git\n  - EXECUTABLE DIRECTORY: /Users/Cherubim/.rbenv/versions/2.6.0/bin\n  - SPEC CACHE DIRECTORY: /Users/Cherubim/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Users/Cherubim/.rbenv/versions/2.6.0/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-18\n  - GEM PATHS:\n     - /Users/Cherubim/.rbenv/versions/2.6.0/lib/ruby/gems/2.6.0\n     - /Users/Cherubim/.gem/ruby/2.6.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - \"gem\" =&gt; \"--no-ri --no-rdoc\"\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/Cherubim/.rbenv/versions/2.6.0/bin\n     - /usr/local/Cellar/rbenv/1.1.1/libexec\n     - /usr/local/bin\n     - /usr/local/opt/icu4c/sbin\n     - /usr/local/opt/icu4c/bin\n     - /usr/local/opt/sqlite/bin\n     - /Users/Cherubim/.yarn/bin\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1547581351, "post_id": 54205773, "comment_id": 95238224, "body": "Have you tried <code>redirect_to @order, alert: &quot;message here&quot;</code> ? Also what the point of <code>begin</code> ?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1547582284, "post_id": 54205773, "comment_id": 95238613, "body": "That didn&#39;t work, i really think its the <code>valid?</code> - there&#39;s gotta be a way around this.  I&#39;ve tried just about everything i can google.  <code>begin</code> works kind of like a validator.  If the charge isn&#39;t successful, it won&#39;t save, and if it&#39;s not <code>valid</code>, it won&#39;t charge.  at least that&#39;s my logic.  I&#39;ve seen similar code for charging on here so I adopted it"}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1547583426, "post_id": 54205773, "comment_id": 95239104, "body": "Add some debugging to it.  Try adding some puts messages after the valid and save statements to make sure you&#39;re getting that far."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547587241, "post_id": 54206544, "comment_id": 95240594, "body": "I updated the OP and put more code into the create code.  There technically is an <code>else</code> but it&#39;s for the errors.  But other than that, the <code>@order.valid? &amp;&amp; @order.save</code> didn&#39;t do the trick."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547587477, "post_id": 54206544, "comment_id": 95240678, "body": "I did try doing <code>if @order.valid? == false           flash[:notice] = &quot;Tweet link successfully updated.&quot;         elsif @order.valid?</code> but still not appearing anything"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547587633, "post_id": 54206544, "comment_id": 95240733, "body": "@uno i still see no else for the <code>valid?</code>. Fix your indentation it may be more clear"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547588351, "post_id": 54206544, "comment_id": 95241054, "body": "I added an elsif invalid? and it&#39;s showing the error message i created for that but now not saving order."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547589509, "post_id": 54206544, "comment_id": 95241513, "body": "@uno please try and approach this a little more systematically ... update the question with your new attempts, and show exactly what the new errors are. If it&#39;s not saving the order, then you can call <code>valid?</code> and <code>.errors.full_messages</code> to see the error. If you are having a hard time following the flow of your code, a debugger such as <code>pry</code> will be very useful."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547589915, "post_id": 54206544, "comment_id": 95241681, "body": "i think i figured it out.  ill post an answer after more testing"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1547692303, "post_id": 54206544, "comment_id": 95282022, "body": "Actually didn&#39;t get it to work how i wanted.  What i am doing instead is created a front-end validation so people know with a message if the input isn&#39;t valid right away --- as well as using the backend validation so nothing can sneak by"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1547585116, "creation_date": 1547585116, "answer_id": 54206544, "question_id": 54205773, "link": "https://stackoverflow.com/questions/54205773/is-my-valid-is-blocking-my-notice-alerts/54206544#54206544", "title": "Is my .valid? is blocking my notice alerts?", "body": "<p>You have no <code>else</code> block for the <code>if @order.valid?</code> condition. If the record is not valid, the method ends immediately and it tried to render the template with the same name as the controller action (<code>OrdersController#create</code>) which doesn't exist.</p>\n\n<p>Rather you can try this:</p>\n\n<pre><code>    if @order.valid? &amp;&amp; @order.save\n      flash[:notice] = \"successful notice here.\"\n      redirect_to order_confirmation_order_path(@order.order_token)\n    else\n      flash[:alert] = \"failed notice here.  View directions.\"\n      redirect_to @order\n    end\n</code></pre>\n\n<p>The <code>@order.update_column(:order_status, 1)</code> logic should probably be moved to the model later (in a <code>before_save</code> or something, so it doesn't issue an additional database call).</p>\n\n<p>After you call <code>valid?</code> or <code>save</code>, you can get the validation errors from the model layer using <code>.errors.full_messages</code> (maybe you can show these in the error notice).</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547587148, "creation_date": 1547581194, "last_edit_date": 1547587148, "question_id": 54205773, "link": "https://stackoverflow.com/questions/54205773/is-my-valid-is-blocking-my-notice-alerts", "title": "Is my .valid? is blocking my notice alerts?", "body": "<p><strong>Issue:</strong> My notices for my specific controller are not appearing.</p>\n\n<p>It isn't the layout because it works elsewhere with other controllers using it.</p>\n\n<p><strong>Here is the Create method:</strong></p>\n\n<pre><code>  def create\n    @order = Order.new(order_params)\n    @listing = Listing.find(params[:listing_id])\n    @seller = @listing.user\n\n    ....  \n    ....\n    ....\n\n        if @order.valid?\n          begin\n            #stripe_charge_code_is_here\n\n          rescue #stripe_error\n             #code\n          end\n          if #code\n             #flash[:error]\n             #redirect_to\n          else\n\n\n        # respond_to do |format|\n          if @order.save\n            @order.update_column(:order_status, 1)\n            # format.html { redirect_to order_confirmation_order_path(@order.order_token), notice: 'Order was successfully created.' }\n            # format.json { render :show, status: :created, location: @order }\n            flash[:notice] = \"successful notice here.\"\n            redirect_to order_confirmation_order_path(@order.order_token)\n            else\n              # format.html { render :new }\n              # format.json { render json: @order.errors, status: :unprocessable_entity }\n              flash[:alert] = \"failed notice here.  View directions.\"\n              redirect_to @order\n            end\n          end\n        end\n      end\n</code></pre>\n\n<p>Whether I use <code>flash[]</code> or <code>respond_to</code>, no flash message appears for both a successful order or failed order.  I left both on the code above, the <code>respond_to</code> is commented out</p>\n\n<p>I mostly want a message for failed orders because one of the form entries for the order has a validation with a message and it's important for it to show so customers know what is wrong with their entry.  When failed, I get this in the <strong>CMD:</strong></p>\n\n<pre><code>No template found for OrdersController#create, rendering head :no_content\n</code></pre>\n\n<p>Now, the only difference in this controller compared to others that use the same layout, is this create method has a .<code>valid?</code> </p>\n\n<p>I am assuming this is what is stopping the notice from appearing.</p>\n\n<p>How can I have it so the flash message(s) show for both successful creates and failed?</p>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1547580249, "post_id": 54205458, "comment_id": 95237813, "body": "Have you tried putting all that on one line?"}], "answers": [{"tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": true, "score": 4, "last_activity_date": 1548794014, "last_edit_date": 1548794014, "creation_date": 1547580700, "answer_id": 54205665, "question_id": 54205458, "link": "https://stackoverflow.com/questions/54205458/remove-white-space-in-templates-when-using-erb-class-in-ruby/54205665#54205665", "title": "Remove white space in templates when using ERB class in Ruby", "body": "<p>Hay, when you want to use the <code>&lt;%- -%&gt;</code> tag (this prevents the <code>if</code> output) you have to pass <code>-</code> to <code>trim_mode</code> option of <code>ERB.new</code> to use it.</p>\n\n<p>See the following example:</p>\n\n<p>Change you <code>test.erb</code> file to the following code:</p>\n\n<pre><code>Hello\n&lt;% if (@x) -%&gt;\n XXX\n&lt;% end -%&gt;\nGoodbye\n</code></pre>\n\n<p>When you instance <code>ERB</code>, pass the option like this:</p>\n\n<pre><code>renderer = ERB.new(File.read('test.erb'), nil, '-')\n</code></pre>\n\n<p>Now, the <code>&lt;%- -%&gt;</code> tags will works fine, hope this helps!</p>\n"}], "owner": {"reputation": 6220, "user_id": 268847, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2685d5bc8e51e598fcd291189c340f63?s=128&d=identicon&r=PG", "display_name": "rlandster", "link": "https://stackoverflow.com/users/268847/rlandster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 0, "accepted_answer_id": 54205665, "answer_count": 1, "score": 1, "last_activity_date": 1548794014, "creation_date": 1547579798, "question_id": 54205458, "link": "https://stackoverflow.com/questions/54205458/remove-white-space-in-templates-when-using-erb-class-in-ruby", "title": "Remove white space in templates when using ERB class in Ruby", "body": "<p>Here is a simple ERB template:</p>\n\n<pre><code># /tmp/test.erb\nHello\n&lt;% if (@x) %&gt;\nXXX\n&lt;% end %&gt;\nGoodbye\n</code></pre>\n\n<p>Here is my Ruby code to render it:</p>\n\n<pre><code>require 'erb'\n@x = false\nrenderer = ERB.new(File.read('/tmp/test.erb'))\noutput = renderer.result()\nprint output\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>Hello\n\nGoodbye\n</code></pre>\n\n<p>Note the blank line. I cannot seem to get rid of that extra whitespace. The tags <code>&lt;%-</code> and <code>-%&gt;</code> do not work with <code>ERB.new</code> (I get errors).</p>\n\n<p>How do I get rid of the white space with\nI am using Ruby 2.3.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "edited": false, "score": 1, "creation_date": 1547577607, "post_id": 54204370, "comment_id": 95236667, "body": "try @profile = Profile.find_by(user_id: params[:id])"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 3, "creation_date": 1547578655, "post_id": 54204370, "comment_id": 95237117, "body": "<code>@profile</code> is nil because you are searching the <code>profiles</code> table for a record having <code>user_id</code> equal to the symbol <code>:user_id</code>. Check your server logs and show in your question what the parameters look like when the <code>#show</code> action is called. It&#39;s possible you should be using <code>Profile.find_by(user_id: params[:user_id])</code>, but hard to say without knowing what your params look like."}, {"owner": {"reputation": 1, "user_id": 10918350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae847c04c22a8db3ac7ff11e72b85988?s=128&d=identicon&r=PG&f=1", "display_name": "vjhbr", "link": "https://stackoverflow.com/users/10918350/vjhbr"}, "edited": false, "score": 0, "creation_date": 1547587249, "post_id": 54204370, "comment_id": 95240598, "body": "the thing is, it seems to find the record, but will not display the data"}, {"owner": {"reputation": 1, "user_id": 10918350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae847c04c22a8db3ac7ff11e72b85988?s=128&d=identicon&r=PG&f=1", "display_name": "vjhbr", "link": "https://stackoverflow.com/users/10918350/vjhbr"}, "reply_to_user": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "edited": false, "score": 0, "creation_date": 1547588126, "post_id": 54204370, "comment_id": 95240941, "body": "@widjajayd i think that worked. i&#39;m new to rails (this is a project)- do you mind helping me understand why this worked while my original solution didn&#39;t?"}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1547595281, "post_id": 54204370, "comment_id": 95243317, "body": "@vjhbr not OP but in ruby there are strings like in most languages, but there are also symbols (denoted like <code>:symbol_name</code>). Symbols are similar to strings (see this for the differences <a href=\"https://reactive.io/tips/2009/01/11/the-difference-between-ruby-symbols-and-strings\" rel=\"nofollow noreferrer\">reactive.io/tips/2009/01/11/&hellip;</a>), but in this case the difference is that your telling rails to find a profile with a user id of symbol <code>:user_id</code>. Then rails goes to your db and looks for a profile with a user_id of <code>:user_id</code>. It doens&#39;t find any because your ids are probably ints."}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "reply_to_user": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "edited": false, "score": 0, "creation_date": 1547595285, "post_id": 54204370, "comment_id": 95243318, "body": "The way how @widjajayd&#39;s solution works is that it calls the param method (remember that you can exclude parenthesis in ruby methods) which is essentially a hash with some extra stuff, so you can access it like a normal ruby hash using <code>[]</code> notation. Rails does some magic to populate the hash with things you might want like headers, path params, query params, and some other stuff. <code>params[:user_id]</code> is essentially, i passed in this thing called <code>user_id</code>, and I want to get the value of it in my code."}], "owner": {"reputation": 1, "user_id": 10918350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae847c04c22a8db3ac7ff11e72b85988?s=128&d=identicon&r=PG&f=1", "display_name": "vjhbr", "link": "https://stackoverflow.com/users/10918350/vjhbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547578451, "creation_date": 1547574773, "last_edit_date": 1547578451, "question_id": 54204370, "link": "https://stackoverflow.com/questions/54204370/profile-views-do-not-display-usernames-details", "title": "Profile views do not display usernames/details", "body": "<p>I am making a function to display the profile details of a user on my Rails app. However, when I try to view the profile of a user, it displays this error.</p>\n\n<pre><code>undefined method `username' for nil:NilClass\n</code></pre>\n\n<p>Here's the controller snippet for the show action:</p>\n\n<pre><code>def show\n  @profile = Profile.find_by(user_id: :user_id)\nend\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;p&gt;\n  &lt;strong&gt;Username:&lt;/strong&gt;\n  &lt;%= @profile.username %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>I know I should be using [:id], but I switched to using :user_id after an issue happened where the profile would not be found due to Rails passing the current user's ID as the profile ID, which threw things off.</p>\n"}, {"tags": ["ios", "ruby", "react-native", "rubygems", "cocoapods"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1547576622, "post_id": 54204169, "comment_id": 95236266, "body": "Are you sure that Cocoapods actually supports running on Windows? It appears that they only support macOS right now."}, {"owner": {"reputation": 217, "user_id": 3653863, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36939287d68c205a44d0b91cd71e4dc8?s=128&d=identicon&r=PG&f=1", "display_name": "user3653863", "link": "https://stackoverflow.com/users/3653863/user3653863"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1547584568, "post_id": 54204169, "comment_id": 95239559, "body": "@HolgerJust No, I&#39;m not sure of that. I was following the install instructions for this: <a href=\"https://www.npmjs.com/package/react-native-photo-editor\" rel=\"nofollow noreferrer\">npmjs.com/package/react-native-photo-editor</a>. I thought I could develop RN apps on windows, even though I had to build on mac for the final iOS push?"}], "answers": [{"tags": [], "owner": {"reputation": 3483, "user_id": 1138710, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d251c2ca213505721db9667cfdfd5469?s=128&d=identicon&r=PG&f=1", "display_name": "Laurent S", "link": "https://stackoverflow.com/users/1138710/laurent-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1561459770, "creation_date": 1561459770, "answer_id": 56752342, "question_id": 54204169, "link": "https://stackoverflow.com/questions/54204169/errnoenoent-no-such-file-or-directory-env-u-git-config-git-c-coc/56752342#56752342", "title": "Errno::ENOENT - No such file or directory - env -u GIT_CONFIG git -C &quot;[...]/.cocoapods/repos/master&quot; config --get remote.origin.url (Windows 10)", "body": "<p>It's probably a bit late, but just in case, I hit the same error running the same command on linux, with cocoapods versions <code>1.5.3</code> and <code>1.7.2</code>.</p>\n\n<p>The only solution I found was to run it on mac. The missing file <code>sw_vers</code> seems to be an apple specific utility that <a href=\"https://ss64.com/osx/sw_vers.html\" rel=\"nofollow noreferrer\">returns the version of the OS</a>.</p>\n\n<p>Cocoapods <a href=\"https://guides.cocoapods.org/using/getting-started.html#getting-started\" rel=\"nofollow noreferrer\">docs</a> also mention:</p>\n\n<blockquote>\n  <p>CocoaPods manages library dependencies for your Xcode projects.</p>\n</blockquote>\n\n<p>and although there is no clear mention of it anywhere on the site, it doesn't seem to run properly outside of macOS.</p>\n"}], "owner": {"reputation": 217, "user_id": 3653863, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36939287d68c205a44d0b91cd71e4dc8?s=128&d=identicon&r=PG&f=1", "display_name": "user3653863", "link": "https://stackoverflow.com/users/3653863/user3653863"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561459770, "creation_date": 1547573899, "last_edit_date": 1547576396, "question_id": 54204169, "link": "https://stackoverflow.com/questions/54204169/errnoenoent-no-such-file-or-directory-env-u-git-config-git-c-coc", "title": "Errno::ENOENT - No such file or directory - env -u GIT_CONFIG git -C &quot;[...]/.cocoapods/repos/master&quot; config --get remote.origin.url (Windows 10)", "body": "<p>I'm trying to do a 'pod install' in a ReactNative plugin folder but am getting the error seen in the title. I am running this on Windows 10. Error template below:</p>\n\n<h3>Command</h3>\n\n<pre><code>C:/Ruby25-x64/bin/pod install\n</code></pre>\n\n<h3>Report</h3>\n\n<ul>\n<li><p>What did you do?</p></li>\n<li><p>What did you expect to happen?</p></li>\n<li><p>What happened instead?</p></li>\n</ul>\n\n<h3>Stack</h3>\n\n<pre><code>   CocoaPods : 1.5.3\n        Ruby : ruby 2.5.3p105 (2018-10-18 revision 65156) [x64-mingw32]\n    RubyGems : 3.0.2\n        Host : Unable to find an executable (No such file or directory - sw_vers)  ()\n       Xcode : -version) ()\n         Git : git version 2.15.0.windows.1\nRuby lib dir : C:/Ruby25-x64/lib\nRepositories : master - https://github.com/CocoaPods/Specs.git @ f403c4e44587a5045a9ed48ddca2ea6fc108b66b\n</code></pre>\n\n<h3>Plugins</h3>\n\n<pre><code>cocoapods-deintegrate : 1.0.2\ncocoapods-plugins     : 1.0.0\ncocoapods-search      : 1.0.0\ncocoapods-stats       : 1.0.0\ncocoapods-trunk       : 1.3.1\ncocoapods-try         : 1.1.0\n</code></pre>\n\n<h3>Podfile</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Uncomment the next line to define a global platform for your project\nplatform :ios, '9.0'\nuse_frameworks!\n\ntarget 'RNPhotoEditor' do\n  # Uncomment the next line if you're using Swift or would like to use dynamic frameworks\n  # use_frameworks!\n\n  # Pods for RNPhotoEditor\n  pod 'iOSPhotoEditor', :git =&gt; 'https://github.com/prscX/photo-editor'\n\n  post_install do |installer|\n    installer.pods_project.targets.each do |target|\n      if target.name.include?('iOSPhotoEditor')\n        target.build_configurations.each do |config|\n          config.build_settings['SWIFT_VERSION'] = '4.1'\n        end\n      end\n    end\n  end\n\nend\n</code></pre>\n\n<h3>Error</h3>\n\n<pre><code>Errno::ENOENT - No such file or directory - env -u GIT_CONFIG git -C \"C:/Users/Owner/.cocoapods/repos/master\" config --get remote.origin.url\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source.rb:448:in ``'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source.rb:448:in `repo_git'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source.rb:46:in `url'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source/manager.rb:347:in `block in source_with_url'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source/manager.rb:346:in `each'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source/manager.rb:346:in `find'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-core-1.5.3/lib/cocoapods-core/source/manager.rb:346:in `source_with_url'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/sources_manager.rb:18:in `find_or_create_source_with_url'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer/analyzer.rb:873:in `block in sources'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer/analyzer.rb:872:in `map'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer/analyzer.rb:872:in `sources'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer/analyzer.rb:780:in `block in resolve_dependencies'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/user_interface.rb:64:in `section'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer/analyzer.rb:779:in `resolve_dependencies'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer/analyzer.rb:88:in `analyze'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer.rb:243:in `analyze'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer.rb:154:in `block in resolve_dependencies'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/user_interface.rb:64:in `section'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer.rb:153:in `resolve_dependencies'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/installer.rb:116:in `install!'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/command/install.rb:41:in `run'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/claide-1.0.2/lib/claide/command.rb:334:in `run'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/lib/cocoapods/command.rb:52:in `run'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/cocoapods-1.5.3/bin/pod:55:in `&lt;top (required)&gt;'\nC:/Ruby25-x64/bin/pod:23:in `load'\nC:/Ruby25-x64/bin/pod:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>If I go to that line I find the following:</p>\n\n<pre><code>def repo_git(args, include_error: false)\n  command = \"env -u GIT_CONFIG git -C \\\"#{repo}\\\" \" &lt;&lt; args.join(' ')\n  command &lt;&lt; ' 2&gt;&amp;1' if include_error\n  (`#{command}` || '').strip #&lt;--this line here\nend\n</code></pre>\n\n<p>If I just run 'ruby env' I get the following back:</p>\n\n<pre><code>Traceback (most recent call last):\nruby: No such file or directory -- env (LoadError)\n</code></pre>\n\n<p>Plus if I run just 'env' I get expected not found error message: ''env' is not recognized as an internal or external command,\noperable program or batch file.'. So I think this means that the system doesn't recognize the env command, however it seems to be necessary to run 'pod install'.</p>\n\n<p>I've done some googling on getting env to work on windows but am pretty sure I'm not googling my problem correctly as I am finding no results. I think so far I have installed ruby, ruby gems, and cocoapods trying to get some RN plugin working.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "templating"], "answers": [{"comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 2, "creation_date": 1547573542, "post_id": 54203629, "comment_id": 95234852, "body": "Why do you need all this? Just using <code>&lt;% my_param ||= &#39;default value&#39; %&gt;</code> works."}, {"owner": {"reputation": 535, "user_id": 766301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10372fa185fe953f9546de18cc3ef0c?s=128&d=identicon&r=PG", "display_name": "Goulven", "link": "https://stackoverflow.com/users/766301/goulven"}, "reply_to_user": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 1, "creation_date": 1547587484, "post_id": 54203629, "comment_id": 95240682, "body": "@DannyB Damnit, you&#39;re absolutely right! Why didn&#39;t I think of that? If you want to submit an answer instead of a comment I&#39;ll be happy to vote it up :-)"}, {"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 0, "creation_date": 1547623607, "post_id": 54203629, "comment_id": 95250227, "body": "Cool, glad I could help."}], "tags": [], "owner": {"reputation": 535, "user_id": 766301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10372fa185fe953f9546de18cc3ef0c?s=128&d=identicon&r=PG", "display_name": "Goulven", "link": "https://stackoverflow.com/users/766301/goulven"}, "is_accepted": false, "score": 2, "last_activity_date": 1547571881, "creation_date": 1547571881, "answer_id": 54203629, "question_id": 54203628, "link": "https://stackoverflow.com/questions/54203628/how-to-provide-defaults-value-for-partial-parameters-in-rails/54203629#54203629", "title": "How to provide defaults value for partial parameters in Rails?", "body": "<p>After reading the docs, and some head scratching, I was able to define default values for parameters not passed to the template.</p>\n\n<pre><code># in views/shared/template.html.erb\n&lt;% my_param = 'default_value' unless binding.local_variable_defined?(:my_param) %&gt;\n# Now you can call the partial with or without setting `my_param`\n\n# Now you can call the partial without parameters...\n&lt;%= render 'shared/my_template' %&gt;\n# ...or with parameters\n&lt;%= render 'shared/my_template', my_param: 'non-default value' %&gt;\n</code></pre>\n\n<p>Tested with Ruby 2.3.1 and upwards.</p>\n"}, {"tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": true, "score": 5, "last_activity_date": 1547623555, "creation_date": 1547623555, "answer_id": 54212181, "question_id": 54203628, "link": "https://stackoverflow.com/questions/54203628/how-to-provide-defaults-value-for-partial-parameters-in-rails/54212181#54212181", "title": "How to provide defaults value for partial parameters in Rails?", "body": "<p>This should do the trick:</p>\n\n<pre><code>&lt;% my_param ||= 'default value' %&gt;\n</code></pre>\n\n<p>A partial that contains this can be rendered with or without providing <code>my_param</code>.</p>\n"}], "owner": {"reputation": 535, "user_id": 766301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10372fa185fe953f9546de18cc3ef0c?s=128&d=identicon&r=PG", "display_name": "Goulven", "link": "https://stackoverflow.com/users/766301/goulven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "accepted_answer_id": 54212181, "answer_count": 2, "score": 2, "last_activity_date": 1547623555, "creation_date": 1547571881, "question_id": 54203628, "link": "https://stackoverflow.com/questions/54203628/how-to-provide-defaults-value-for-partial-parameters-in-rails", "title": "How to provide defaults value for partial parameters in Rails?", "body": "<p>I need to render a shared partial which can receive a few parameters from several views, but I don't want to pass all parameters everytime. If I call the template without all parameters, I get an error.</p>\n\n<p>Is there a way to define default values for parameters, only if they haven't been defined when calling <code>render 'name_of_partial</code>?</p>\n"}, {"tags": ["ruby", "rspec", "yaml", "erb", "vcr"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "is_accepted": true, "score": 4, "last_activity_date": 1547571721, "creation_date": 1547571721, "answer_id": 54203591, "question_id": 54203590, "link": "https://stackoverflow.com/questions/54203590/how-do-i-dynamically-generate-multiple-http-mock-responses-with-vcr-for-ruby-rsp/54203591#54203591", "title": "how do I dynamically generate multiple HTTP mock responses with VCR for Ruby/RSpec?", "body": "<p>You can use <a href=\"https://relishapp.com/vcr/vcr/v/3-0-3/docs/cassettes/dynamic-erb-cassettes\" rel=\"nofollow noreferrer\">Dynamic ERB Cassettes</a> with VCR, you just have to pass in the <code>:erb</code> option which can have a value of <code>true</code> or a hash containing the template variables to be passed to the cassette:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>ids = [0, 1, 2, 3]\nVCR.use_cassette('dynamic_generated_requests', :erb =&gt; { :ids =&gt; ids }) do\n  # Make HTTP Requests\nend\n</code></pre>\n\n<h2>YAML File with ERB</h2>\n\n<p>And your YAML file would look like this:</p>\n\n<pre class=\"lang-yaml prettyprint-override\"><code>---\nhttp_interactions:\n&lt;% ids.each do |id| %&gt;\n- request:\n    method: post\n    uri: https://api.example.com/path/to/rest_api/&lt;%= id %&gt;/method\n    body:\n      encoding: UTF-8\n    headers:\n      content-type:\n      - application/json\n  response:\n    status:\n      code: 200\n      message: OK\n    headers:\n      cache-control:\n      - no-cache, no-store\n      content-type:\n      - application/json\n      connection:\n      - Close\n    body:\n      encoding: UTF-8\n      string: '{\"status_code\": &lt;%= id %&gt;}'\n    http_version: '1.1'\n  recorded_at: Tue, 15 Jan 2019 16:14:14 GMT\n&lt;% end %&gt;\nrecorded_with: VCR 3.0.0\n</code></pre>\n\n<p><em>Note: the <code>.yml</code> file extension is still used because VCR handles the ERB processing through the <code>:erb</code> option.</em></p>\n\n<h1>Debugging: <code>raw_cassette_bytes</code></h1>\n\n<p>If you want to debug this and make sure the YAML file looks good, you can print out the rendered YAML file with the <a href=\"https://github.com/vcr/vcr/blob/v3.0.0/lib/vcr/cassette.rb#L231-L233\" rel=\"nofollow noreferrer\">raw_cassette_bytes</a> method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>puts VCR.current_cassette.send(:raw_cassette_bytes)\n</code></pre>\n\n<p>Use that within the VCR.use_cassette block:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>VCR.use_cassette('dynamic_generated_requests', :erb =&gt; { :ids =&gt; ids }) do\n  puts VCR.current_cassette.send(:raw_cassette_bytes)\n  # Make HTTP Requests\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9903"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 54203591, "answer_count": 1, "score": 3, "last_activity_date": 1547571721, "creation_date": 1547571721, "question_id": 54203590, "link": "https://stackoverflow.com/questions/54203590/how-do-i-dynamically-generate-multiple-http-mock-responses-with-vcr-for-ruby-rsp", "title": "how do I dynamically generate multiple HTTP mock responses with VCR for Ruby/RSpec?", "body": "<p>I'm hitting an API and for each request, there was a recorded request/response in the cassette YAML file. However, the only difference between the requests was the <code>id</code> in the query parameters.</p>\n\n<p>How do I shrink my YAML file so that URLs are dynamically generated for each request?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "aasm"], "comments": [{"owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "edited": false, "score": 0, "creation_date": 1547991483, "post_id": 54203548, "comment_id": 95375896, "body": "here is a crazy question, are you using mongoid?"}, {"owner": {"reputation": 908, "user_id": 2045598, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/57259f4186074d903a890276da27e5de?s=128&d=identicon&r=PG", "display_name": "Siraris", "link": "https://stackoverflow.com/users/2045598/siraris"}, "reply_to_user": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "edited": false, "score": 0, "creation_date": 1548111929, "post_id": 54203548, "comment_id": 95418376, "body": "@Oshanz Nope, we&#39;re Postgres"}, {"owner": {"reputation": 1377, "user_id": 3011280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mkyAT.jpg?s=128&g=1", "display_name": "Oshan Wisumperuma", "link": "https://stackoverflow.com/users/3011280/oshan-wisumperuma"}, "edited": false, "score": 0, "creation_date": 1548173003, "post_id": 54203548, "comment_id": 95444287, "body": "can you share the code of this intermediate steps"}], "owner": {"reputation": 908, "user_id": 2045598, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/57259f4186074d903a890276da27e5de?s=128&d=identicon&r=PG", "display_name": "Siraris", "link": "https://stackoverflow.com/users/2045598/siraris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547571588, "creation_date": 1547571588, "question_id": 54203548, "link": "https://stackoverflow.com/questions/54203548/adding-a-default-ordering-to-a-has-many-association-prevents-state-transitions-o", "title": "Adding a default ordering to a has_many association prevents state transitions on model using AASM", "body": "<p>So this is a very strange issue, and I have no idea what's going on. Based on an issue in our app, we wanted a has_many association to be returned with a default ordering applied to it every time you read the association from the database. I recommended to the developer working on the issue that they add the following to the association (which they did):</p>\n\n<pre><code>has_many :shipment_items, -&gt; { order(product_id: :desc) }, dependent: :destroy\n</code></pre>\n\n<p>That seems to be ok, right? I guess not. I noticed that a few of our tests broke. I have a method in our shipment model that sets a property on the model based on the state of the status that it's in at a particular time. When I log the state of the status in tests, with the ordering applied, it stays in the default state as I manually move it to subsequent states using bang methods.</p>\n\n<p>So I did more investigating, and found that the actual feature is now broken as well. If I log the state using the same process I am testing, it stays in the default state and logging it in the culprit method shows it that way, yet when it actually completes the request and redirects to the expected completion page, the object in the database is in the correct state that I would expect it to be in.  There are some intermediate steps that depend on a particular state, and those steps also produce the wrong result with the lambda on the association.</p>\n\n<p>If I remove the default ordering lambda from the association, this issue disappears. I've eliminated the possibility that the ordering of the results of the association has anything to do with it (the ordering of the objects should have no bearing on the outcome) so I get the sense this is a very strange bug in AASM. Any help would be appreciated!</p>\n"}, {"tags": ["ruby", "environment-variables", "homebrew"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1547632494, "post_id": 54203517, "comment_id": 95254523, "body": "how have you defined the env var? Is it exported?"}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1547651488, "post_id": 54203517, "comment_id": 95265736, "body": "yes (see my edit)"}], "answers": [{"comments": [{"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1547573489, "post_id": 54203602, "comment_id": 95234828, "body": "I removed it but it didn&#39;t work so I edited my question"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1547589834, "post_id": 54203602, "comment_id": 95241643, "body": "Do you have it in your shell when you do <code>echo $GITLAB_HOMEBREW_TOKEN</code>?"}, {"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 0, "creation_date": 1547632241, "post_id": 54203602, "comment_id": 95254356, "body": "yes of course I checked (I just edit my question to precise that)"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1547571763, "creation_date": 1547571763, "answer_id": 54203602, "question_id": 54203517, "link": "https://stackoverflow.com/questions/54203517/make-an-environment-variable-accessible-from-a-formula/54203602#54203602", "title": "Make an environment variable accessible from a formula", "body": "<p>Remove the <code>$</code> from the env variable name</p>\n\n<pre><code>system \"echo\", ENV[\"GITLAB_HOMEBREW_TOKEN\"]\n</code></pre>\n\n<p>See:</p>\n\n<pre><code>[1] pry(main)&gt; ENV['LC_NAME']\n=&gt; \"pl_PL.UTF-8\"\n[2] pry(main)&gt; ENV['$LC_NAME']\n=&gt; nil\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "edited": false, "score": 1, "creation_date": 1550227368, "post_id": 54701328, "comment_id": 96200738, "body": "Thanks I ignored the second level of filtering!"}], "tags": [], "owner": {"reputation": 7001, "user_id": 1048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501208006a9fb58f4fa72a2d1ab46c00?s=128&d=identicon&r=PG", "display_name": "davidjb", "link": "https://stackoverflow.com/users/1048705/davidjb"}, "is_accepted": true, "score": 5, "last_activity_date": 1551068240, "last_edit_date": 1551068240, "creation_date": 1550192485, "answer_id": 54701328, "question_id": 54203517, "link": "https://stackoverflow.com/questions/54203517/make-an-environment-variable-accessible-from-a-formula/54701328#54701328", "title": "Make an environment variable accessible from a formula", "body": "<p>Homebrew has multiple levels of environment variable filtering.  The first that gets encountered relates to the previous version of your question where you had the variable <code>GITLAB_HOMEBREW_TOKEN</code>.  Homebrew's <a href=\"https://brew.sh/2017/12/11/homebrew-1.4.0/\" rel=\"nofollow noreferrer\">initial filtering</a> allows only <a href=\"https://github.com/Homebrew/brew/blob/master/bin/brew#L79-L83\" rel=\"nofollow noreferrer\">specific environment variables</a> to get passed through to <code>brew</code> commands to avoid contaminating the build environment.  So, <code>GITLAB_HOMEBREW_TOKEN</code> wouldn't get passed because it didn't start with <code>HOMEBREW_</code> (or match any other whitelisted variables).</p>\n\n<p>The second level of filtering is the one you're currently hitting where \"sensitive\" environment variables <a href=\"https://github.com/Homebrew/brew/blob/4897ec02d0f00c37a21ddaa0bebff6b83b27d027/Library/Homebrew/extend/ENV.rb#L32\" rel=\"nofollow noreferrer\">get filtered</a> if they match the following Ruby regular expression:</p>\n\n<pre><code>/(cookie|key|token|password)/i\n</code></pre>\n\n<p>Because your variable has the keyword <code>TOKEN</code> in the variable name it gets filtered out before it reaches your Formula.  </p>\n\n<p>In short, you need to use a different environment variable name that <em>starts</em> with <code>HOMEBREW_</code>, such as:</p>\n\n<pre><code>HOMEBREW_GITLAB_SECRET=secretsquirrel brew install Pouet\n</code></pre>\n\n<p>and you'll have access to this in your Formula's Ruby code.</p>\n\n<p>See also <a href=\"https://docs.brew.sh/Formula-Cookbook#using-environment-variables\" rel=\"nofollow noreferrer\">https://docs.brew.sh/Formula-Cookbook#using-environment-variables</a> for the background on the types of environment variable filtering that exists.</p>\n"}], "owner": {"reputation": 9249, "user_id": 118125, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/617e5dd459d1527261644fb4adf3a41f?s=128&d=identicon&r=PG", "display_name": "Martin Delille", "link": "https://stackoverflow.com/users/118125/martin-delille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 3, "accepted_answer_id": 54701328, "answer_count": 2, "score": 3, "last_activity_date": 1551068240, "creation_date": 1547571501, "last_edit_date": 1547657109, "question_id": 54203517, "link": "https://stackoverflow.com/questions/54203517/make-an-environment-variable-accessible-from-a-formula", "title": "Make an environment variable accessible from a formula", "body": "<p>I try to write a private homebrew tap for gitlab thanks to this article: <a href=\"https://wheniwork.engineering/creating-a-private-homebrew-tap-with-gitlab-8800c453d893\" rel=\"nofollow noreferrer\">https://wheniwork.engineering/creating-a-private-homebrew-tap-with-gitlab-8800c453d893</a></p>\n\n<p>Here is my formula:</p>\n\n<pre><code>class Pouet &lt; Formula\n  desc \"Pouet command line utility\"\n  homepage \"https://gitlab.mycompany.com/martin/Pouet\"\n  url \"https://gitlab.mycompany.com/api/v4/projects/0000017/repository/archive?private_token=#{ENV['HOMEBREW_GITLAB_TOKEN']}\"\n  version \"1.0\"\n  sha256 \"ffdb029ada6d03fe3fa323577693cc233ef3d2300784a8d79077cecf6df7a470\"\ndef install\n    system \"echo\", ENV[\"HOMEBREW_GITLAB_TOKEN\"]\n  end\n  test do\n    pouet --help\n  end\nend\n</code></pre>\n\n<p>I defined <code>HOMEBREW_GITLAB_TOKEN</code> in my environment so it is accessible from the shell from which I launch the <code>brew</code> command.</p>\n\n<p>Unfortunately the download fails because the <code>HOMEBREW_GITLAB_TOKEN</code> variable is not known from the <code>brew</code> process.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1547570379, "post_id": 54203169, "comment_id": 95233259, "body": "what is the primary key of this table?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1547570872, "post_id": 54203169, "comment_id": 95233498, "body": "@mrzasa how does it matter (I am not even mentioning table might have <i>no</i> PK at all)?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1547571032, "post_id": 54203169, "comment_id": 95233577, "body": "My idea is to find first repetition and then delete the rest of them distinguishing them by PK that must be unique."}, {"owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 1, "creation_date": 1547571266, "post_id": 54203169, "comment_id": 95233719, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14124212/remove-duplicate-records-based-on-multiple-columns\">Remove duplicate records based on multiple columns?</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1547571284, "post_id": 54203169, "comment_id": 95233727, "body": "<code>ALTER IGNORE TABLE your_table_name ADD UNIQUE INDEX unique_columns_index (user_id, value)</code> should work. Later you might remove this index, if not needed."}, {"owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "edited": false, "score": 0, "creation_date": 1547571303, "post_id": 54203169, "comment_id": 95233734, "body": "Sorry! Updated with PK"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "edited": false, "score": 0, "creation_date": 1547571356, "post_id": 54203169, "comment_id": 95233758, "body": "@UmeshMalhotra OMG, what if the table contains 1B records?"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1547581522, "post_id": 54203169, "comment_id": 95238285, "body": "If you have a lot of records to process, you should <a href=\"http://www.postgresqltutorial.com/how-to-delete-duplicate-rows-in-postgresql/\" rel=\"nofollow noreferrer\">let the database do this work for you</a>. This could make the difference between the process taking seconds versus minutes."}], "answers": [{"tags": [], "owner": {"reputation": 921, "user_id": 4276844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f448f2372792762904abfe0dd26366ce?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/4276844/cam"}, "is_accepted": false, "score": 0, "last_activity_date": 1547584073, "creation_date": 1547584073, "answer_id": 54206349, "question_id": 54203169, "link": "https://stackoverflow.com/questions/54203169/rails-how-to-delete-all-but-one-record-that-meet-a-condition/54206349#54206349", "title": "Rails - How to delete all but one record that meet a condition", "body": "<p>Agree with moveson that the best approach would be to define an index within the database to either enforce distinct records or allow you to add a <a href=\"https://stackoverflow.com/questions/34424154/rails-validate-uniqueness-of-two-columns-together\">uniqueness validator to the model</a>.</p>\n\n<p>Another option would be to intercept the ActiveRecord create method call to prevent duplicates:</p>\n\n<pre><code>class Example &lt; ApplicationRecord\n  def self.create( attributes = nil, &amp;block )\n    attributes.each {|attr| self.create(attr, &amp;block) } if attributes.is_a? Array\n    return if find_by attributes\n    super attributes, &amp;block\n  end\nend\n</code></pre>\n\n<p>The basic idea here is to abort if you already see a record with the same attribute values in the database...  but then let ActiveRecord continue to do all the heavy lifting by calling it with super.</p>\n\n<p>If there's a situation where for some reason you can't exercise control over the database to prevent duplicates from being entered, you could try an approach where you create a class method to periodically purge the duplicates from the system.</p>\n\n<p>Here's an example of a method that would iterate over the entire recordset and use a hash to track whether it has seen the values before, removing them if so:</p>\n\n<pre><code>class Example &lt; ApplicationRecord\n  def self.dedup\n    distinct = {}\n    all.each do |row|\n      if distinct[row.user_id] &amp;&amp; distinct[row.user_id] == row.value\n        row.delete\n      else\n        distinct[row.user_id] = row.value\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>You could then call it like so: <code>Example.dedup</code> whenever you wished to purge the duplicate records.</p>\n\n<p>For those looking to follow along at home, you can use the following migration:</p>\n\n<pre><code>rails g model example user_id:integer value:string\n</code></pre>\n\n<p>and seed file:</p>\n\n<pre><code>examples = Example.create([\n  {user_id: 1, value: 'A'},\n  {user_id: 1, value: 'A'},\n  {user_id: 1, value: 'A'},\n  {user_id: 1, value: 'A'},\n  {user_id: 1, value: 'A'},\n  {user_id: 1, value: 'A'},\n  {user_id: 1, value: 'A'},\n  {user_id: 2, value: 'B'},\n  {user_id: 2, value: 'B'},\n  {user_id: 3, value: 'C'},\n])\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5585324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c8aad3bd128b9b9f8d5607a84346620?s=128&d=identicon&r=PG&f=1", "display_name": "John Gringus", "link": "https://stackoverflow.com/users/5585324/john-gringus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547584073, "creation_date": 1547570310, "last_edit_date": 1547571292, "question_id": 54203169, "link": "https://stackoverflow.com/questions/54203169/rails-how-to-delete-all-but-one-record-that-meet-a-condition", "title": "Rails - How to delete all but one record that meet a condition", "body": "<p>Suppose I have a table as such</p>\n\n<pre><code>    id user_id  value\n     1   1       A\n     2   1        A\n     3   1       A\n     4   1       A\n     5   1       A\n     6   1       A\n     7   2       B\n     8   2       B\n     9   3       C\n</code></pre>\n\n<p>As you can see, there are many duplicates in this table. For each duplicate, I want to be able to delete all but one of them, such that I am still left with one record for each of the duplicated records. For example, for the duplicate records with <code>user_id = 1</code> and <code>value = A</code>, I want to be able to delete all but one of these so that I am still left with one record with the values of <code>user_id = 1</code> and <code>value = A</code></p>\n"}, {"tags": ["ruby", "watir"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1547594256, "post_id": 54203102, "comment_id": 95243079, "body": "Try to <code>xvfb-run chrome</code> from bash and see what it says. You&#39;re probably missing dependencies."}], "answers": [{"comments": [{"owner": {"reputation": 808, "user_id": 9160022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cce1edae0e83895af88da976cb4c0170?s=128&d=identicon&r=PG&f=1", "display_name": "menfon", "link": "https://stackoverflow.com/users/9160022/menfon"}, "edited": false, "score": 0, "creation_date": 1547571331, "post_id": 54203166, "comment_id": 95233746, "body": "Tried this way, sadly it leads to the exactly same error :(."}, {"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "reply_to_user": {"reputation": 808, "user_id": 9160022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cce1edae0e83895af88da976cb4c0170?s=128&d=identicon&r=PG&f=1", "display_name": "menfon", "link": "https://stackoverflow.com/users/9160022/menfon"}, "edited": false, "score": 0, "creation_date": 1547571407, "post_id": 54203166, "comment_id": 95233782, "body": "@menfon  Sorry it didn&#39;t help. Did you try upgrade chrome or downgrade chromedriver?"}, {"owner": {"reputation": 808, "user_id": 9160022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cce1edae0e83895af88da976cb4c0170?s=128&d=identicon&r=PG&f=1", "display_name": "menfon", "link": "https://stackoverflow.com/users/9160022/menfon"}, "edited": false, "score": 0, "creation_date": 1547578819, "post_id": 54203166, "comment_id": 95237199, "body": "No need to apologize, you did steer me to right direction (how to actually pass arguments). I am using CentOS as well (not VPS though, ancient hw running at other room). I managed to make it running after adding a bunch of more arguments: <code>args = %w[headless disable-gpu disable-dev-shm-usage disable-software-rasterizer no-sandbox]</code>. If you update the answer, please ping me and I&#39;ll accept it ;)."}, {"owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "reply_to_user": {"reputation": 808, "user_id": 9160022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cce1edae0e83895af88da976cb4c0170?s=128&d=identicon&r=PG&f=1", "display_name": "menfon", "link": "https://stackoverflow.com/users/9160022/menfon"}, "edited": false, "score": 0, "creation_date": 1547614347, "post_id": 54203166, "comment_id": 95247264, "body": "@menfon  Updated :)"}], "tags": [], "owner": {"reputation": 4739, "user_id": 5403468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZJ8BE.jpg?s=128&g=1", "display_name": "Tiw", "link": "https://stackoverflow.com/users/5403468/tiw"}, "is_accepted": true, "score": 5, "last_activity_date": 1547614333, "last_edit_date": 1547614333, "creation_date": 1547570309, "answer_id": 54203166, "question_id": 54203102, "link": "https://stackoverflow.com/questions/54203102/chrome-not-starting-using-watir/54203166#54203166", "title": "Chrome not starting using Watir", "body": "<p>Combined with your own discovery, you can pass args like this:</p>\n\n<pre><code>args = %w[headless disable-gpu disable-dev-shm-usage disable-software-rasterizer no-sandbox]\nb = Watir::Browser.new :chrome, args: args\n</code></pre>\n\n<p><code>shm</code> is short for <a href=\"http://en.wikipedia.org/wiki/Shared_memory\" rel=\"noreferrer\">shared memory</a>.<br>\nAbout the <a href=\"https://chromium.googlesource.com/chromium/src/+/master/docs/design/sandbox.md\" rel=\"noreferrer\">sandbox</a>.  </p>\n\n<p>If you are using remote chromdriver, then above simple way of passing args won't work, then:</p>\n\n<pre><code>b = Watir::Browser.new :chrome, {url: \"http://127.0.0.1:9515\", chromeOptions: {args: args}}\n</code></pre>\n\n<p><code>http://127.0.0.1:9515</code> is an example of remote chromedriver server.  </p>\n\n<p>Note <code>no-sandbox</code> is not recommended if you have other solution.<br>\nSo it's better to fix it or change to use other browser instead.<br>\nLike <code>firefox</code> also has <code>headless</code> mode now, combined with <a href=\"https://github.com/mozilla/geckodriver/releases\" rel=\"noreferrer\">geckodriver</a> is a good option too.</p>\n"}], "owner": {"reputation": 808, "user_id": 9160022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cce1edae0e83895af88da976cb4c0170?s=128&d=identicon&r=PG&f=1", "display_name": "menfon", "link": "https://stackoverflow.com/users/9160022/menfon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 54203166, "answer_count": 1, "score": 1, "last_activity_date": 1547614333, "creation_date": 1547570069, "question_id": 54203102, "link": "https://stackoverflow.com/questions/54203102/chrome-not-starting-using-watir", "title": "Chrome not starting using Watir", "body": "<p>The script works locally, but not on a server.</p>\n\n<pre><code>b = Watir::Browser.new :chrome, headless: true\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>response.rb:69:in `assert_ok': unknown error: Chrome failed to start: exited abnormally (Selenium::WebDriver::Error::UnknownError)\n  (unknown error: DevToolsActivePort file doesn't exist)\n  (The process started from chrome location /usr/bin/google-chrome is no longer running, so ChromeDriver is assuming that Chrome has crashed.)\n  (Driver info: chromedriver=2.45.615279 (12b89733300bd268cff3b78fc76cb8f3a7cc44e5),platform=Linux 4.9.75-29.el7.x86_64 x86_64)\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/response.rb:32:in `initialize'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/common.rb:84:in `new'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/common.rb:84:in `create_response'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/default.rb:104:in `request'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/common.rb:62:in `call'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/bridge.rb:166:in `execute'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/bridge.rb:99:in `create_session'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/bridge.rb:53:in `handshake'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/chrome/driver.rb:49:in `initialize'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/common/driver.rb:44:in `new'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/common/driver.rb:44:in `for'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver.rb:86:in `for'\n        from /root/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/watir-6.16.5/lib/watir/browser.rb:46:in `initialize'\n        from rebooter.rb:9:in `new'\n        from rebooter.rb:9:in `&lt;main&gt;'\n</code></pre>\n\n<p>I found few answers mentioning <code>--disable-dev-shm-usage</code>, but I don't really know how to pass it.</p>\n\n<p>I tried without success:</p>\n\n<pre><code>Watir::Browser.new :chrome, headless: true, disableDevShmUsage: true\n</code></pre>\n\n<p>I am not really sure what shm is, but df is showing I have 0% usage of it:</p>\n\n<pre><code># df -h | grep -Ei 'shm|use%'\nFilesystem                      Size  Used Avail Use% Mounted on\ntmpfs                           962M     0  962M   0% /dev/shm\n</code></pre>\n\n<p><strong>How to modify the script to run also on a server? Why is it working locally, but not on a server?</strong></p>\n"}, {"tags": ["json", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 4247605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dbc3aeea7d3b1879f1e4806ecdeb81a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii Brytiuk", "link": "https://stackoverflow.com/users/4247605/sergii-brytiuk"}, "edited": false, "score": 0, "creation_date": 1547571986, "post_id": 54203288, "comment_id": 95234070, "body": "poorly formulated the question. thanks, for sharing deep knowledge about &quot;off-topic questions\u201d. now it&#39;s only left to find out how many possible preparations need to be done. is gsub(/\\^/, &quot;\\\\u005e&quot;)) the only possible issue?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 195, "user_id": 4247605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dbc3aeea7d3b1879f1e4806ecdeb81a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii Brytiuk", "link": "https://stackoverflow.com/users/4247605/sergii-brytiuk"}, "edited": false, "score": 0, "creation_date": 1547572897, "post_id": 54203288, "comment_id": 95234529, "body": "I have no idea."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1547570724, "creation_date": 1547570724, "answer_id": 54203288, "question_id": 54203084, "link": "https://stackoverflow.com/questions/54203084/ojparseerror-not-a-valid-id-number-rc/54203288#54203288", "title": "Oj::ParseError: not a valid ID number - &quot;^rc&quot;", "body": "<p><code>Oj</code> is pretty much completely written in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> so I am not going to reverse-engineer it to answer on the off-topic question \u201cwhy is not code working.\u201d</p>\n\n<p>Some reverse-engineering of its <em>behaviour</em> is fine, though.</p>\n\n<pre><code>\u25b6 Oj.dump(foo: \"^bar\")\n#\u21d2 \"{\\\":foo\\\":\\\"^bar\\\"}\"\n\u25b6 Oj.dump(foo: \"^rar\")\n#\u21d2 \"{\\\":foo\\\":\\\"\\\\u005erar\\\"}\"\n</code></pre>\n\n<p>That said, it <em>knows something</em> about <code>^r</code>. To overcome this issue, prepare your load:</p>\n\n<pre><code>\u25b6 Oj.load(\"{\\\"s\\\":{\\\"s\\\":[\\\"^rc\\\"]}}\".gsub(/\\^/, \"\\\\u005e\"))\n#\u21d2 {\"s\"=&gt;{\"s\"=&gt;[\"^rc\"]}}\n</code></pre>\n\n<p>FWIW, latest <code>Oj</code> on my machine parses pretty fine your input as is without a glitch.</p>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 4247605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dbc3aeea7d3b1879f1e4806ecdeb81a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii Brytiuk", "link": "https://stackoverflow.com/users/4247605/sergii-brytiuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1547649047, "creation_date": 1547649047, "answer_id": 54219280, "question_id": 54203084, "link": "https://stackoverflow.com/questions/54203084/ojparseerror-not-a-valid-id-number-rc/54219280#54219280", "title": "Oj::ParseError: not a valid ID number - &quot;^rc&quot;", "body": "<p>Read the doc before asking. Oj doc is clear: <a href=\"https://github.com/ohler55/oj/blob/master/pages/Encoding.md\" rel=\"nofollow noreferrer\">https://github.com/ohler55/oj/blob/master/pages/Encoding.md</a></p>\n"}], "owner": {"reputation": 195, "user_id": 4247605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dbc3aeea7d3b1879f1e4806ecdeb81a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii Brytiuk", "link": "https://stackoverflow.com/users/4247605/sergii-brytiuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547649047, "creation_date": 1547570023, "last_edit_date": 1547637786, "question_id": 54203084, "link": "https://stackoverflow.com/questions/54203084/ojparseerror-not-a-valid-id-number-rc", "title": "Oj::ParseError: not a valid ID number - &quot;^rc&quot;", "body": "<p>Why the error raised when parsing json string(with Oj parser) that contains \"^r\" in combination with other character? </p>\n\n<p>Error - \"^r\":</p>\n\n<pre><code>Oj.load(\"{\\\"s\\\":{\\\"s\\\":[\\\"^rc\\\"]}}\")\n=&gt; Oj::ParseError: not a valid ID number at line 1, column 15 \n</code></pre>\n\n<p>No error - \"^b\" or \"^r\":</p>\n\n<pre><code>Oj.load(\"{\\\"s\\\":{\\\"s\\\":[\\\"^bc\\\"]}}\")\n=&gt; {\"s\"=&gt;{\"s\"=&gt;[\"^bc\"]}}\n\nOj.load(\"{\\\"s\\\":{\\\"s\\\":[\\\"^r\\\"]}}\")\n=&gt; {\"s\"=&gt;{\"s\"=&gt;[\"^r\"]}}\n</code></pre>\n\n<p><strong>UPD</strong>\nHow to know what are possible symbol combinations that can cause the error <code>Oj::ParseError: not a valid ID number</code>. \n<code>Oj::ParseError</code> is to broad to be rescued - <code>An Exception that is raised as a result of a parse error while parsing a JSON document.</code></p>\n"}, {"tags": ["ruby", "xcode", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 681, "user_id": 6109034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f3f2c0b24667eb16283523b05e00b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mimu Saha Tishan", "link": "https://stackoverflow.com/users/6109034/mimu-saha-tishan"}, "is_accepted": true, "score": 2, "last_activity_date": 1548254110, "creation_date": 1548254110, "answer_id": 54329599, "question_id": 54202718, "link": "https://stackoverflow.com/questions/54202718/how-to-solve-xcpretty-uncaught-exception/54329599#54329599", "title": "How to solve xcpretty uncaught Exception", "body": "<p>After a quality time research I did not get any solution but below code which I customize is working fine for me.</p>\n\n<pre><code>sudo gem install -n /usr/local/bin xcpretty\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4815, "user_id": 928191, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-vdq7KZueF-4/AAAAAAAAAAI/AAAAAAAAAQg/qpGTedu5fXE/photo.jpg?sz=128", "display_name": "monfresh", "link": "https://stackoverflow.com/users/928191/monfresh"}, "is_accepted": false, "score": 0, "last_activity_date": 1609451655, "last_edit_date": 1609451655, "creation_date": 1609435774, "answer_id": 65523923, "question_id": 54202718, "link": "https://stackoverflow.com/questions/54202718/how-to-solve-xcpretty-uncaught-exception/65523923#65523923", "title": "How to solve xcpretty uncaught Exception", "body": "<p>You <a href=\"https://www.moncefbelyamani.com/why-you-should-never-use-sudo-to-install-ruby-gems/\" rel=\"nofollow noreferrer\">should never use sudo to install gems</a>, no matter how many times you see it as an accepted answer on Stack Overflow.</p>\n<p>This &quot;write permissions&quot; error comes up over and over, and is due to an improperly configured Ruby environment. The safe way to install gems on a Mac with a proper Ruby development environment involves six steps at a high level:</p>\n<ol>\n<li>Install Homebrew (which also installs the prerequisite Apple command line tools)</li>\n<li>Install a Ruby manager (such as chruby, rbenv, asdf, RVM) - most of these can be installed with Homebrew</li>\n<li>Configure the Ruby manager by adding the appropriate lines to your shell file (<code>~/.bash_profile</code> or <code>~/.zshrc</code>) - each manager will have instructions for doing this, and this is a typical step that people miss</li>\n<li>Restart the terminal (or open a new tab) for the shell changes to take effect - another step that is often overlooked</li>\n<li>Install a specific version of Ruby using the Ruby manager</li>\n<li>Switch to that version of Ruby using the Ruby manager</li>\n</ol>\n<p>My personal preference is <a href=\"https://github.com/postmodern/chruby\" rel=\"nofollow noreferrer\">chruby</a> with <a href=\"https://github.com/postmodern/ruby-install\" rel=\"nofollow noreferrer\">ruby-install</a>. For more details and a script that can automate this whole process, check out my answer here:\n<a href=\"https://stackoverflow.com/a/54873916/928191\">https://stackoverflow.com/a/54873916/928191</a></p>\n"}], "owner": {"reputation": 681, "user_id": 6109034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f3f2c0b24667eb16283523b05e00b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mimu Saha Tishan", "link": "https://stackoverflow.com/users/6109034/mimu-saha-tishan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 54329599, "answer_count": 2, "score": 1, "last_activity_date": 1609451655, "creation_date": 1547568790, "last_edit_date": 1547630103, "question_id": 54202718, "link": "https://stackoverflow.com/questions/54202718/how-to-solve-xcpretty-uncaught-exception", "title": "How to solve xcpretty uncaught Exception", "body": "<p>I have been trying to solve this issue during 3-4 hours but do not get any answer yet.</p>\n\n<p><strong>run : $gem install xcpretty</strong></p>\n\n<p><strong>it shows below error:</strong></p>\n\n<p><strong>ERROR:</strong>  While executing gem ... (Errno::EACCES)\n    Permission denied @ rb_sysopen - /Library/Ruby/Gems/2.3.0/gems/rouge-2.0.7/Gemfile</p>\n\n<p>and getting <strong>ruby upgrade issue</strong>, then installed ruby newly with updated version.</p>\n\n<p><strong>run : $sudo gem install xcpretty</strong></p>\n\n<p><strong>then it shows below error :</strong> </p>\n\n<p>Fetching: rouge-2.0.7.gem (100%)</p>\n\n<p><strong>ERROR:</strong>  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory.</p>\n\n<p>then <strong>getting gem upgrade issue</strong>, and solved with upgrading gem.</p>\n\n<p>tried again as well as with below command also\n<strong>run : sudo gem install xcpretty --verbose</strong></p>\n\n<p>even though used <strong>'sudo chmod -R 777' also into my /usr/bin directory</strong></p>\n\n<p><strong>But still getting :</strong> </p>\n\n<p>Fetching: rouge-2.0.7.gem (100%)</p>\n\n<p><strong>ERROR:</strong>  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /usr/bin directory.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1547567911, "post_id": 54202326, "comment_id": 95231932, "body": "how are you passing data attributes to user_activity, i see build with no params called. Also user_activity_params method exist in user_activity_controller?. The model code looks fine, while creating a user_activity in controller make sure activity id and user id exists."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1547569120, "post_id": 54202326, "comment_id": 95232594, "body": "Please <b>do not post images</b>, post the formatted text instead."}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547569729, "post_id": 54202326, "comment_id": 95232901, "body": "&lt;div class=&quot;field&quot;&gt;     &lt;%= frm.label :activity_id %&gt;&lt;br /&gt;     &lt;%= select(user_activities, &quot;activity_id&quot;, Activity.all.collect {|a| [ a.activity_name, a.id ] }, {include_blank: &#39;none&#39;}) %&gt; &lt;/div&gt;"}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "reply_to_user": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1547588151, "post_id": 54202326, "comment_id": 95240951, "body": "@Bijendra please the create and user_activity_params methods are all inside the UserActivity controller. I am using the above html to pass the <b>Activity</b> object id (activity_id) to the controller."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1547613750, "post_id": 54202326, "comment_id": 95247106, "body": "@BismarkAttaFrimpong you are passing activity_id to controller, now you need to make sure activity_id is passed to database from controller. That part of code is missing. Open Rails console, and execute the below code to get some understanding. 1&gt;user = User.last  2&gt; obj1 = user.user_activities.build 3&gt; obj1.save  what is the error? Now try 4&gt; obj2 = user.user_activities.build(activity_id: Activity.last.id) 5&gt; obj2.save  what is the o/p here?  sorry about the formatting."}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "reply_to_user": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1547619248, "post_id": 54202326, "comment_id": 95248596, "body": "@Bijendra I have updated as you requested. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547589094, "post_id": 54202441, "comment_id": 95241327, "body": "Please what do you mean by providing <b>activity_id</b> to new <b>user_activity</b>? I have tried your solution but still getting the error message of &quot;<b>Activity must exist</b>&quot;."}], "tags": [], "owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "is_accepted": false, "score": 0, "last_activity_date": 1547567839, "creation_date": 1547567839, "answer_id": 54202441, "question_id": 54202326, "link": "https://stackoverflow.com/questions/54202326/object-or-attribute-must-exist-rails-5-2-2/54202441#54202441", "title": "Object or Attribute Must Exist - Rails 5.2.2", "body": "<p>You can try to provide <code>activity_id</code> to new <code>user_activity</code></p>\n\n<pre><code>@user_activity = current_user.user_activities.build(activity_id: params[:activity_id])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547617902, "post_id": 54210991, "comment_id": 95248193, "body": "<b>@Bijindra</b> I have gone through the test results and I have a similar thing just as <b>@andriy-baran</b> suggested but I have realized that the selected activity id from the form is not passed to the params in the controller even though I can see it from the rails server console"}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "reply_to_user": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547618147, "post_id": 54210991, "comment_id": 95248265, "body": "update your question with html form code and post the params received from server logs @BismarkAttaFrimpong"}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "reply_to_user": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547632155, "post_id": 54210991, "comment_id": 95254298, "body": "@BismarkAttaFrimpong i can see activity_id being passed in params which you have shared, use that in .build(activity_id: params[:activity_id] as suggested"}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547659271, "post_id": 54210991, "comment_id": 95270262, "body": "I am still not able to pass the parameters to <b>user_activity_params</b> in the controller. Or I may be doing something wrong?   This is how my new method is called        def new         @user_activity = UserActivity.new         #user_activity = current_user.user_activities.build(user_activity_params)       end  Kindly help me check between the two, which one is appropriate. Thanks"}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547674571, "post_id": 54210991, "comment_id": 95277370, "body": "<b>activity_id =user_activity_params[:activity_id]</b>   <b>@user_activity = current_user.user_activities.new(activity_id: activity_id)</b>  works but then it keeps throwing the error of the other parameters being empty"}], "tags": [], "owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1547617689, "last_edit_date": 1547617689, "creation_date": 1547617043, "answer_id": 54210991, "question_id": 54202326, "link": "https://stackoverflow.com/questions/54202326/object-or-attribute-must-exist-rails-5-2-2/54210991#54210991", "title": "Object or Attribute Must Exist - Rails 5.2.2", "body": "<pre><code>#user.rb\n\nclass User &lt; ApplicationRecord\n  has_many :user_activities\n  has_many :activities, through: :user_activities\nend\n\n#activity.rb\n\nclass Activity &lt; ApplicationRecord\n  has_many :user_activities\n  has_many :users, through: :user_activities\nend\n\n#user_activity.rb\n\nclass UserActivity &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :activity\nend\n</code></pre>\n\n<p>I replicated your models into a small application and tried the operations from Rails console. This should give you a better understanding</p>\n\n<pre><code>Loading development environment (Rails 5.2.2)\n2.4.1 :002 &gt; Activity.last\n   (0.3ms)  SET NAMES utf8,  @@SESSION.sql_mode = CONCAT(CONCAT(@@sql_mode, ',STRICT_ALL_TABLES'), ',NO_AUTO_VALUE_ON_ZERO'),  @@SESSION.sql_auto_is_null = 0, @@SESSION.wait_timeout = 2147483\n  Activity Load (0.2ms)  SELECT  `activities`.* FROM `activities` ORDER BY `activities`.`id` DESC LIMIT 1\n =&gt; nil \n2.4.1 :004 &gt; obj = Activity.new(name: \"Cricket\", activity_type: \"Sports\")\n =&gt; #&lt;Activity id: nil, name: \"Cricket\", created_at: nil, updated_at: nil, activity_type: \"Sports\"&gt; \n2.4.1 :005 &gt; obj.save\n   (0.2ms)  BEGIN\n  Activity Create (0.4ms)  INSERT INTO `activities` (`name`, `created_at`, `updated_at`, `activity_type`) VALUES ('Cricket', '2019-01-16 05:20:10', '2019-01-16 05:20:10', 'Sports')\n   (6.4ms)  COMMIT\n =&gt; true \n2.4.1 :007 &gt; obj1 = User.new(name: \"user1\",city: \"city1\") \n =&gt; #&lt;User id: nil, name: \"user1\", role_id: nil, created_at: nil, updated_at: nil, city: \"city1\"&gt; \n2.4.1 :008 &gt; obj1.save\n   (0.2ms)  BEGIN\n  User Create (0.4ms)  INSERT INTO `users` (`name`, `created_at`, `updated_at`, `city`) VALUES ('user1', '2019-01-16 05:20:59', '2019-01-16 05:20:59', 'city1')\n   (5.9ms)  COMMIT\n =&gt; true\n</code></pre>\n\n<p>So i created some background data before the below operations,</p>\n\n<pre><code>2.4.1 :001 &gt; user = User.last\n(0.3ms)  SET NAMES utf8,  @@SESSION.sql_mode = CONCAT(CONCAT(@@sql_mode, ',STRICT_ALL_TABLES'), ',NO_AUTO_VALUE_ON_ZERO'),  @@SESSION.sql_auto_is_null = 0, @@SESSION.wait_timeout = 2147483\n    User Load (0.3ms)  SELECT  `users`.* FROM `users` ORDER BY `users`.`id` DESC LIMIT 1\n   =&gt; #&lt;User id: 1, name: \"user1\", role_id: nil, created_at: \"2019-01-16 05:20:59\", updated_at: \"2019-01-16 05:20:59\", city: \"city1\"&gt; \n  2.4.1 :002 &gt; obj1 = user.user_activities.build\n   =&gt; #&lt;UserActivity id: nil, user_id: \"1\", activity_id: nil, created_at: nil, updated_at: nil&gt; \n  2.4.1 :003 &gt; obj1.save\n     (0.3ms)  BEGIN\n     (0.2ms)  ROLLBACK\n   =&gt; false \n  2.4.1 :004 &gt; obj1.errors.full_messages\n   =&gt; [\"Activity must exist\"] \n  2.4.1 :005 &gt; obj1 = user.user_activities.build(activity_id: Activity.last.id)\n    Activity Load (0.3ms)  SELECT  `activities`.* FROM `activities` ORDER BY `activities`.`id` DESC LIMIT 1\n   =&gt; #&lt;UserActivity id: nil, user_id: \"1\", activity_id: \"1\", created_at: nil, updated_at: nil&gt; \n  2.4.1 :006 &gt; obj1.save\n     (0.2ms)  BEGIN\n    Activity Load (0.3ms)  SELECT  `activities`.* FROM `activities` WHERE `activities`.`id` = 1 LIMIT 1\n    UserActivity Create (0.2ms)  INSERT INTO `user_activities` (`user_id`, `activity_id`, `created_at`, `updated_at`) VALUES ('1', '1', '2019-01-16 05:23:32', '2019-01-16 05:23:32')\n     (5.6ms)  COMMIT\n   =&gt; true \n</code></pre>\n\n<p>[\"Activity must exist\"], look for this error in console and reason being activity_id was not passed to user_activity object. Now update your code in controller      </p>\n\n<pre><code>activity_id = #fetch this value from params as it comes\n@user_activity = current_user.user_activities.new(activity_id: activity_id)\n</code></pre>\n\n<p>I see you have user_activity_params method with multiple attributes, once above code works, test that with new line if required.</p>\n\n<pre><code> @user_activity = current_user.user_activities.new(user_activity_params)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547658859, "post_id": 54216243, "comment_id": 95270019, "body": "I have tried out your solution and still, the controller is not receiving the parameter through <b>user_activity_params</b> even though I can see them passed to it in the server log"}, {"owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "reply_to_user": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547703441, "post_id": 54216243, "comment_id": 95284320, "body": "Are user_actitvity_params and create method in same controller?"}, {"owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "edited": false, "score": 0, "creation_date": 1547710620, "post_id": 54216243, "comment_id": 95286930, "body": "Yes. They are all in the UserActivity controller"}], "tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1547638561, "creation_date": 1547638561, "answer_id": 54216243, "question_id": 54202326, "link": "https://stackoverflow.com/questions/54202326/object-or-attribute-must-exist-rails-5-2-2/54216243#54216243", "title": "Object or Attribute Must Exist - Rails 5.2.2", "body": "<p>As per the description mentioned in the post and related log images posted, it seems like the activity_id is being passed over to the controller but in the wrong sequence as declared in the controller params.</p>\n\n<p>Modify the code as below</p>\n\n<p><strong>For HTML</strong></p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%#= frm.label :activity_id %&gt;&lt;br /&gt;\n    &lt;%= select_tag 'user_activity[activity_id]', options_for_select(Activity.all.collect{ |u| [u.activity_name, u.id] }) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>For Controller</strong></p>\n\n<pre><code>def create\n    @user_activity = current_user.user_activities.build(user_activity_params)\nend\n</code></pre>\n\n<p>Now the activity_id will be passed inside the user_activity and thus params will be parsed as mentioned in activity_params method.</p>\n"}], "owner": {"reputation": 71, "user_id": 6077124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EmuxFRFcMIU/AAAAAAAAAAI/AAAAAAAAACo/Nxi6BqlS9go/photo.jpg?sz=128", "display_name": "bafrimpong", "link": "https://stackoverflow.com/users/6077124/bafrimpong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1548088920, "creation_date": 1547567458, "last_edit_date": 1548088920, "question_id": 54202326, "link": "https://stackoverflow.com/questions/54202326/object-or-attribute-must-exist-rails-5-2-2", "title": "Object or Attribute Must Exist - Rails 5.2.2", "body": "<p>I am creating a small project for my students and I am facing an error message I have tried all possible solutions but no headway out.</p>\n\n<p><a href=\"https://i.stack.imgur.com/U9My8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9My8.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/nSuSj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nSuSj.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ImbM2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ImbM2.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oZlC6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oZlC6.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/uvsEv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uvsEv.png\" alt=\"enter image description here\"></a></p>\n\n<p>The images are the various models and how I implemented the respective associations. And also the controller method of Create and the permitted parameters.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LXwlj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LXwlj.png\" alt=\"enter image description here\"></a>\nI can clearly see from my server activities that all the attributes values are been captured but your I receive an error which says <strong>\"Activity must exist\"</strong>.</p>\n\n<p>I would be glad if anyone help me out.</p>\n\n<p>Thanks in advance</p>\n\n<h1>Update to the Question</h1>\n\n<h1>The HTML Form</h1>\n\n<pre><code>&lt;%= form_with(model: user_activity, local: true) do |frm| %&gt;\n\n    &lt;div class=\"field\"&gt;\n        &lt;%#= frm.label :activity_id %&gt;&lt;br /&gt;\n        &lt;%= select_tag 'activity_id', options_for_select(Activity.all.collect{ |u| [u.activity_name, u.id] }) %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n        &lt;%= frm.label(get_user_activity_date) %&gt;&lt;br /&gt;\n        &lt;%= frm.date_field :user_activity_date, autofocus: true%&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n        &lt;%= frm.label(get_user_activity_start_time) %&gt;&lt;br /&gt;\n        &lt;%= frm.time_field :user_activity_start, autofocus: true %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n        &lt;%= frm.label(get_user_activity_end_time) %&gt;&lt;br /&gt;\n        &lt;%= frm.time_field :user_activity_end, autofocus: true, autocomplete: \"age\" %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field\"&gt;\n        &lt;%= frm.label(get_user_activity_note) %&gt;&lt;br /&gt;\n        &lt;%= frm.text_area :user_activity_note, autofocus: true %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"actions\"&gt;\n        &lt;%= frm.submit %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<h1>The Server Log</h1>\n\n<pre><code>Started POST \"/user_activities\" for 127.0.0.1 at 2019-01-16 06:45:44 +0100\nProcessing by UserActivitiesController#create as HTML\n    Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"qfcYksfgoAzNaO4ZQ6rsG9WFV6waUywbsaOCTePsjpV4PmXp0tofWfS01as6ArrdwyNtthCt5aLs2tNXavD/7A==\", \"activity_id\"=&gt;\"3\", \"user_activity\"=&gt;{\"user_activity_date\"=&gt;\"2018-12-31\", \"user_activity_start\"=&gt;\"12:02\", \"user_activity_end\"=&gt;\"22:02\", \"user_activity_note\"=&gt;\"Record User Activity\"}\n</code></pre>\n\n<h1>Still Trying to Solve the Problem</h1>\n\n<p>I have tried most of your suggestions but still no headway but when I tried the following as indicated in the below code, I get a strange result and yet cannot be inserted into the database</p>\n\n<pre><code>def new\n    @user_activity = UserActivity.new\nend\n\ndef create\n    # @user_activity = UserActivity.new(user_activity_params)\n    activity_id = user_activity_params[:activity_id] #fetch this value from params as it comes\n\n    puts \"The activity ID which is received is -&gt; #{activity_id.to_i}\"\n    # puts current_user.user_id\n\n    user_activity_date = user_activity_params[:user_activity_date]\n    puts \"Date -&gt; #{user_activity_date}\"\n\n    user_activity_start = user_activity_params[:user_activity_start]\n    puts \"Start Time -&gt; #{user_activity_start}\"\n\n    user_activity_end = user_activity_params[:user_activity_end]\n    puts \"End Time -&gt; #{user_activity_end}\"\n\n    user_activity_note = user_activity_params[:user_activity_note]\n    puts \"Activity Note -&gt; #{user_activity_note}\"\n\n    @user_activity = current_user.user_activities.new(activity_id:activity_id.to_i, user_activity_date: user_activity_date.to_date,user_activity_start: user_activity_start.to_time,user_activity_end: user_activity_end.to_time,                            user_activity_note: user_activity_note )\nend\n</code></pre>\n\n<h1>Parameters</h1>\n\n<pre><code>def user_activity_params\n\n    params.require(:user_activity).permit(:activity_id, :user_activity_date, :user_activity_start, :user_activity_end, :user_activity_note)\n\n    # params.fetch(:user_activity, {}).permit(:user_id, :activity_id, user_activity: [:user_activity_date, :user_activity_start, :user_activity_end, :user_activity_note])\n\n    # params.permit(:user_id, :activity_id, :user_activity_date, :user_activity_start, :user_activity_end, :user_activity_note)\n\nend\n</code></pre>\n\n<h1>Server Log</h1>\n\n<pre><code>Started POST \"/user_activities\" for 127.0.0.1 at 2019-01-16 21:15:48 +0100\nProcessing by UserActivitiesController#create as HTML\n    Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"7v79xk6TW0IHNjkno+iXwzIYqqBjBMxCSodddPHUmKI/N4C9W6nkFz7qApXaQMEFJL6Qumn6BfsX/gxueMjp2w==\", \"user_activity\"=&gt;{\"activity_id\"=&gt;\"1\", \"user_activity_date\"=&gt;\"2019-01-15\", \"user_activity_start\"=&gt;\"20:14\", \"user_activity_end\"=&gt;\"21:15\", \"user_activity_note\"=&gt;\"testing to see if values can be retrieved\"}, \"commit\"=&gt;\"Create User activity\"}\n    Activity ID -&gt; 1\n    Date -&gt; 2019-01-15\n    Start Time -&gt; 20:14\n    End Time -&gt; 21:15\n    Activity Note -&gt; testing to see if values can be retrieved\n\n        User Load (0.9ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 ORDER BY `users`.`id` ASC LIMIT 1\n        \u21b3 app/controllers/user_activities_controller.rb:46\n        (0.5ms)  BEGIN\n        \u21b3 app/controllers/user_activities_controller.rb:46\n        UserActivity Create (3.0ms)  INSERT INTO `user_activities` (`created_at`, `updated_at`, `user_id`) VALUES ('2019-01-16 20:15:49', '2019-01-16 20:15:49', 1)\n        \u21b3 app/controllers/user_activities_controller.rb:46\n        (0.5ms)  ROLLBACK\n        \u21b3 app/controllers/user_activities_controller.rb:46\nCompleted 500 Internal Server Error in 125ms (ActiveRecord: 12.4ms)\n\nActiveRecord::NotNullViolation (Mysql2::Error: Field 'user_activity_date' doesn't have a default value: INSERT INTO `user_activities` (`created_at`, `updated_at`, `user_id`) VALUES ('2019-01-16 20:15:49', '2019-01-16 20:15:49', 1)):\n\napp/controllers/user_activities_controller.rb:46:in `create'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1547568971, "post_id": 54201922, "comment_id": 95232515, "body": "I believe <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/OutputSafetyHelper.html#method-i-raw\" rel=\"nofollow noreferrer\"><code>ActionView::Helpers::OutputSafetyHelper#raw</code></a> would do."}], "answers": [{"tags": [], "owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "is_accepted": true, "score": 1, "last_activity_date": 1549463848, "last_edit_date": 1549463848, "creation_date": 1549461719, "answer_id": 54555408, "question_id": 54201922, "link": "https://stackoverflow.com/questions/54201922/how-to-add-html-file-into-active-admin-page-and-make-it-a-part-of-page/54555408#54555408", "title": "How to add html file into active admin page and make it a part of page?", "body": "<p>Am not sure, but try this:</p>\n\n<pre><code>document = Nokogiri::XML(request)\ntemplate = Nokogiri::XSLT(File.read('stylesheet.xslt'))\nhtmltable_out = template.transform(document)\ndiv(id: 'response_xml_into_html', class: 'collapse') do\n  htmltable_out.html_safe\nend\n</code></pre>\n\n<p>Also make sure to start a <code>rails console</code> en see whether the transformation indeed works. Good luck!</p>\n"}], "owner": {"reputation": 37, "user_id": 9666666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ed71c3130105680c568b459935d58c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u043d\u044f \u0421\u043a\u043e\u0446\u0438\u043a", "link": "https://stackoverflow.com/users/9666666/%d0%92%d0%b0%d0%bd%d1%8f-%d0%a1%d0%ba%d0%be%d1%86%d0%b8%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 54555408, "answer_count": 1, "score": 0, "last_activity_date": 1549463848, "creation_date": 1547566057, "question_id": 54201922, "link": "https://stackoverflow.com/questions/54201922/how-to-add-html-file-into-active-admin-page-and-make-it-a-part-of-page", "title": "How to add html file into active admin page and make it a part of page?", "body": "<p>Now I have information in XML format, I need to convert it with stylesheet.xslt to receive HTML table. I try to put this  HTML table into my admin page(I use active admin), but get text of my html file. However I would like to see a table after converting</p>\n\n<p>I tried to put it into different tags(div/pre), don't help</p>\n\n<pre><code>pre id: 'response_xml_into_html', class: 'collapse' do\ndocument = Nokogiri::XML(request)\ntemplate = Nokogiri::XSLT(File.read('stylesheet.xslt'))\ntemplate.transform(document)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "iframe"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1547565722, "post_id": 54201288, "comment_id": 95230519, "body": "have your tried using an actual route as the source rather than a file? e.g. <code>src=&quot;www.example.com&#47;test&quot;</code> where test routes through a controller and renders that file."}, {"owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1547761339, "post_id": 54201288, "comment_id": 95313936, "body": "Yea I wrote a controller but the routing has me all confused I put the details in another question <a href=\"https://stackoverflow.com/questions/54209837/how-do-i-create-a-routes-rb-entry-for-a-controller\" title=\"how do i create a routes rb entry for a controller\">stackoverflow.com/questions/54209837/&hellip;</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1547761630, "post_id": 54201288, "comment_id": 95314042, "body": "I have to assume you are very new to rails. Maybe try a tutorial to get a better understanding; Michael Hartl&#39;s tutorials are excellent (and free) <a href=\"https://www.railstutorial.org/\" rel=\"nofollow noreferrer\">railstutorial.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "edited": false, "score": 0, "creation_date": 1547737126, "post_id": 54201997, "comment_id": 95301728, "body": "I tried to implement this but I can&#39;t get the routes code working to test it. I opened a second question for it. <a href=\"https://stackoverflow.com/questions/54209837/how-do-i-create-a-routes-rb-entry-for-a-controller\" title=\"how do i create a routes rb entry for a controller\">stackoverflow.com/questions/54209837/&hellip;</a>"}], "tags": [], "owner": {"reputation": 98, "user_id": 7414049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19bef12ddd886966347afec33046e7f?s=128&d=identicon&r=PG&f=1", "display_name": "govind_unnikrishnan", "link": "https://stackoverflow.com/users/7414049/govind-unnikrishnan"}, "is_accepted": false, "score": 1, "last_activity_date": 1547566295, "creation_date": 1547566295, "answer_id": 54201997, "question_id": 54201288, "link": "https://stackoverflow.com/questions/54201288/how-do-i-load-erb-into-an-iframe/54201997#54201997", "title": "How do I load ERB into an iframe?", "body": "<p>You can actually render a partial inside the iframe. You  can apply the same result  of this question. <a href=\"https://stackoverflow.com/questions/22810287/rails-partial-iframe-missing-assets\">Rails partial iframe missing assets</a>. All you have to do is specify the controller name and action inside the iframe tag and render the partial inside the controller action.</p>\n"}], "owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1547566295, "creation_date": 1547563863, "question_id": 54201288, "link": "https://stackoverflow.com/questions/54201288/how-do-i-load-erb-into-an-iframe", "title": "How do I load ERB into an iframe?", "body": "<p>I'm running Ruby on rails and I want to load up an erb file into an iframe. The initial page loading up the iframe works fine with loading up variables, but the iframe doesn't have access to the ruby variables and just prints \"Print &lt;%= some-ruby-variable %>\". </p>\n\n<p>Webpage loading the iframe</p>\n\n<pre><code>&lt;iframe src=\"../test.html.erb\"&gt;&lt;/iframe&gt;\n</code></pre>\n\n<p>file test.html.erb</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;Print &lt;%= some-ruby-variable %&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I'm thinking I'm just doing a file read with this iframe call and I'm bypassing the ruby processing. </p>\n\n<p>How do I tell test.html.erb to evaluate the erb before loading to browser? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1879832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6acdab540f4564160409129f531ae10f?s=128&d=identicon&r=PG", "display_name": "fitchMitch", "link": "https://stackoverflow.com/users/1879832/fitchmitch"}, "edited": false, "score": 0, "creation_date": 1547571955, "post_id": 54201917, "comment_id": 95234052, "body": "I&#39;ve edited and added the deliver_now! method call that was missing in my first  description. Sorry about that, and thank you for having me clarifying."}], "tags": [], "owner": {"reputation": 1509, "user_id": 3052463, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3w2GR.jpg?s=128&g=1", "display_name": "Abundance", "link": "https://stackoverflow.com/users/3052463/abundance"}, "is_accepted": false, "score": 0, "last_activity_date": 1547566039, "creation_date": 1547566039, "answer_id": 54201917, "question_id": 54201265, "link": "https://stackoverflow.com/questions/54201265/in-production-only-sidekiq-launches-delayed-job-but-does-not-send-emails/54201917#54201917", "title": "In production only, Sidekiq launches delayed job but does not send emails", "body": "<p>Might seem silly but did you try putting a <code>deliver_now</code> after the <code>mail</code> method?</p>\n\n<pre><code>mail(\n  to: poll.owner.prefered_email,\n  subject: I18n.t('polls.mails.reminder.end_subject')\n).deliver_now\n</code></pre>\n\n<p>The <code>mail</code> method only creates the message and renders the template.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1879832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6acdab540f4564160409129f531ae10f?s=128&d=identicon&r=PG", "display_name": "fitchMitch", "link": "https://stackoverflow.com/users/1879832/fitchmitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1550050529, "creation_date": 1550050529, "answer_id": 54666793, "question_id": 54201265, "link": "https://stackoverflow.com/questions/54201265/in-production-only-sidekiq-launches-delayed-job-but-does-not-send-emails/54666793#54666793", "title": "In production only, Sidekiq launches delayed job but does not send emails", "body": "<p>The solution came from <a href=\"https://nicholaide.github.io/sidekiq/2016/11/06/sidekiq-service.html\" rel=\"nofollow noreferrer\">https://nicholaide.github.io/sidekiq/2016/11/06/sidekiq-service.html</a> mentioning Environment variables had to be set inside systemd service description since env variables were not taken from user's bash settings : </p>\n\n<p><em>/lib/systemd/system/sidekiq.service</em> </p>\n\n<pre><code>[Service]\nType=simple\nWorkingDirectory=/var/www/show_caster/code\nExecStart=/bin/bash -lc '/usr/local/rvm/gems/ruby-2.2.7/bin/bundler exec sidekiq -e production -q mailers -C config/sidekiq.yml -L log/sidekiq.log'\nEnvironment=RAILS_ENV=production\nEnvironment=SMTP_SERVER=&lt;your_smtp_server&gt;\nEnvironment=SMTP_EMAIL=&lt;email_adress&gt;\nEnvironment=SMTP_PASSWORD=&lt;password&gt;\nUser=sesame\nGroup=sesame\nUMask=0002\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 1879832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6acdab540f4564160409129f531ae10f?s=128&d=identicon&r=PG", "display_name": "fitchMitch", "link": "https://stackoverflow.com/users/1879832/fitchmitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550051462, "creation_date": 1547563757, "last_edit_date": 1550051462, "question_id": 54201265, "link": "https://stackoverflow.com/questions/54201265/in-production-only-sidekiq-launches-delayed-job-but-does-not-send-emails", "title": "In production only, Sidekiq launches delayed job but does not send emails", "body": "<p>It's been days and I still wonder what possibly can be misconfigured: </p>\n\n<p><strong>Knowing</strong> </p>\n\n<ul>\n<li>Delayed jobs sending the emails leave traces in log showing that the method is performed</li>\n<li>Delayed jobs sending emails do fire these emails in the development environment. </li>\n<li>Other emails sent with deliver_now method are fired correctly in production env.</li>\n</ul>\n\n<p>My production platform: </p>\n\n<ul>\n<li>Linux  4.9.0-5-686-pae #1 SMP Debian 4.9.65-3+deb9u2 (2018-01-04) i686 GNU/Linux</li>\n<li>Sidekiq 5.2</li>\n<li>Rails 5.0.6</li>\n<li>In both cases each environment run a redis-server on the same server</li>\n</ul>\n\n<p><em>/lib/systemd/system/sidekiq.service</em></p>\n\n<pre><code>[Unit]\nDescription=sidekiq\nAfter=syslog.target network.target redis-server.service\n\n[Service]\nType=simple\nWorkingDirectory=/var/www/show_caster/code\nExecStart=/bin/bash -lc '/usr/local/rvm/gems/ruby-2.2.7/wrappers/bundler exec sidekiq -e production -q default -q mailers -C config/sidekiq.yml -L log/sidekiq.log'\nUser=sesame\nGroup=sesame\nUMask=0002\n\nEnvironment=MALLOC_ARENA_MAX=2\n\n# if we crash, restart\nRestartSec=4\n#Restart=on-failure\nRestart=always\n\n# output goes to /var/log/syslog\nStandardOutput=syslog\nStandardError=syslog\n</code></pre>\n\n<p><em>notification_filter.rb excerpt</em></p>\n\n<pre><code>class NotificationFilter &lt; Notification\n\n # .../...\n\n  def self.poll_end_reminder_mailing(poll_id)\n    poll = Poll.find_by(id: poll_id)\n    return nil if poll.nil?\n\n    PollMailer.poll_end_reminder_mail(poll).deliver_now!\n  rescue StandardError =&gt; e\n    # Bugsnag.notify(e)\n    Rails.logger.error(\"poll_end_reminder_mailing failure: #{e}\")\n    raise e\n  end\nend\n</code></pre>\n\n<p><em>poll_mailer.rb excerpt</em></p>\n\n<pre><code>  def poll_end_reminder_mail(poll)\n    @url = get_polls_url\n    @url_login = url_login\n    @poll = poll\n    Rails.logger.debug('------ poll_end_reminder_mail -------')\n    Rails.logger.debug(\"subject: #{I18n.t('polls.mails.reminder.end_subject')}\")\n    Rails.logger.debug('-----------------------------')\n    mail(\n      to: poll.owner.prefered_email,\n      subject: I18n.t('polls.mails.reminder.end_subject')\n    )\n  rescue StandardError =&gt; e\n    Bugsnag.notify(e)\n    Rails.logger.error(\"poll_end_reminder_mail failure: #{e}\")\n  end\n</code></pre>\n\n<p><em>production.log</em></p>\n\n<pre><code>I, [2019-01-15T15:21:05.563191 #543]  INFO -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] Performing ReminderPollEndJob from Sidekiq(mailers) with arguments: 21\nD, [2019-01-15T15:21:05.567424 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84]   Poll Load (0.9ms)  SELECT  \"polls\".* FROM \"polls\" WHERE \"polls\".\"id\" = $1 ORDER BY expiration_date ASC LIMIT $2  [[\"id\", 21], [\"LIMIT\", 1]]\nD, [2019-01-15T15:21:05.568475 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] NotificationService.poll_end_reminder_mailing\nD, [2019-01-15T15:21:05.570448 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84]   CACHE (0.0ms)  SELECT  \"polls\".* FROM \"polls\" WHERE \"polls\".\"id\" = $1 ORDER BY expiration_date ASC LIMIT $2  [[\"id\", 21], [\"LIMIT\", 1]]\nD, [2019-01-15T15:21:05.571754 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] ------ poll_end_reminder_mail -------\nD, [2019-01-15T15:21:05.572080 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] subject: You can share poll result with the voters !\nD, [2019-01-15T15:21:05.572170 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] -----------------------------\nD, [2019-01-15T15:21:05.578484 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84]   User Load (1.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT $2  [[\"id\", 2], [\"LIMIT\", 1]]\nD, [2019-01-15T15:21:05.587189 #543] DEBUG -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] PollMailer#poll_end_reminder_mail: processed outbound mail in 15.7ms\nI, [2019-01-15T15:21:05.817170 #543]  INFO -- : [ActiveJob] [ReminderPollEndJob] [0bda6e97-fc35-4803-9a54-8a5607393e84] Performed ReminderPollEndJob from Sidekiq(mailers) in 253.32ms\n</code></pre>\n\n<p><em>sidekiq.log</em></p>\n\n<pre><code>2019-01-15T14:19:26.396Z 543 TID-431lf INFO: See LICENSE and the LGPL-3.0 for licensing details.\n2019-01-15T14:19:26.396Z 543 TID-431lf INFO: Upgrade to Sidekiq Pro for more features and support: http://sidekiq.org\n2019-01-15T14:19:26.411Z 543 TID-431lf DEBUG: Client Middleware: \n2019-01-15T14:19:26.411Z 543 TID-431lf DEBUG: Server Middleware: Bugsnag::Sidekiq\n2019-01-15T14:19:26.412Z 543 TID-431lf INFO: Starting processing, hit Ctrl-C to stop\n2019-01-15T14:19:26.413Z 543 TID-431lf DEBUG: {:queues=&gt;[\"mailers\"], :labels=&gt;[], :concurrency=&gt;5, :require=&gt;\".\", :environment=&gt;\"production\", :timeout=&gt;8, :poll_interval_average=&gt;nil, :average_scheduled_poll_interval=&gt;5, :error_handlers=&gt;[#&lt;Sidekiq::ExceptionHandler::Logger:0x180b438&gt;, #&lt;Proc:0x1bbf214@/var/www/show_caster/code/vendor/bundle/ruby/2.2.0/gems/bugsnag-6.10.0/lib/bugsnag/integrations/sidekiq.rb:52&gt;], :death_handlers=&gt;[], :lifecycle_events=&gt;{:startup=&gt;[], :quiet=&gt;[], :shutdown=&gt;[], :heartbeat=&gt;[]}, :dead_max_jobs=&gt;10000, :dead_timeout_in_seconds=&gt;15552000, :reloader=&gt;#&lt;Sidekiq::Rails::Reloader @app=ShowCaster::Application&gt;, :verbose=&gt;true, :pidfile=&gt;\"tmp/pids/sidekiq.pid\", :strict=&gt;false, :config_file=&gt;\"config/sidekiq.yml\", :logfile=&gt;\"log/sidekiq.log\", :tag=&gt;\"code\", :identity=&gt;\"SESAMES:543:6312f82779d5\"}\n2019-01-15T14:20:22.573Z 543 TID-iniex ReminderPollEndJob JID-f0d23068cf072b94820cca98 INFO: start\n2019-01-15T14:20:24.299Z 543 TID-iniex ReminderPollEndJob JID-f0d23068cf072b94820cca98 INFO: done: 1.726 sec\n</code></pre>\n\n<p><strong>EDIT</strong>\nWhen not using the daemon but launching sidekiq manually, with the provided ExecStart command with 'sesame' user, it all works allright -> something is wrong with systemd here, but I do not know what.</p>\n"}, {"tags": ["c", "ruby", "ffi"], "comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1547591618, "post_id": 54200630, "comment_id": 95242292, "body": "<code>INT2NUM</code> and other conversion macros return their argument encoded. If you want to use <code>printf</code> to print the original value then you need to convert it back with <code>NUM2INT</code>, etc."}, {"owner": {"reputation": 21, "user_id": 8804133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259497929ccf8b48a404a08c553a08eb?s=128&d=identicon&r=PG&f=1", "display_name": "Ninjacop", "link": "https://stackoverflow.com/users/8804133/ninjacop"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1547644821, "post_id": 54200630, "comment_id": 95261457, "body": "Thank you! I forgot about converting it back from a Ruby VALUE."}], "owner": {"reputation": 21, "user_id": 8804133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259497929ccf8b48a404a08c553a08eb?s=128&d=identicon&r=PG&f=1", "display_name": "Ninjacop", "link": "https://stackoverflow.com/users/8804133/ninjacop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547561596, "creation_date": 1547561596, "question_id": 54200630, "link": "https://stackoverflow.com/questions/54200630/ruby-c-api-macros-such-as-int2num-return-store-different-numbers-than-expected", "title": "Ruby C API macros such as INT2NUM() return/store different numbers than expected", "body": "<p>Currently I am using the Ruby C API and I am having trouble defining global Ruby variables. </p>\n\n<p>Ruby values are stored in C as VALUE, or an <code>unsigned long</code>. The Ruby version I am using is v2.6.0p0, and I've tried using macros such as INT2NUM(), DBL2NUM() and INT2FIX() and the inputted number is always stored like so:</p>\n\n<p>value * 2 + 1 -- if it's a whole number </p>\n\n<p>value * 2     -- if it's a floating point number/double</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>#include &lt;Ruby/ruby.h&gt;\n\nint main() {\n    ruby_init();\n\n    /* Test with no Ruby variables, just to see what it outputs \n       using INT2NUM() */\n    VALUE x = INT2NUM(3);\n    printf(\"%lu\", x);\n\n    /* Test storing y in a Ruby variable, then calling it using\n       INT2FIX() */\n    VALUE y = INT2FIX(4.5);\n    rb_gv_set(\"$y\", y);\n    printf(\"%lu\", rb_gv_get(\"$y\"));\n\n    /* Test storing z in a Ruby variable then calling it using \n       DBL2NUM() */\n    VALUE z = DBL2NUM(6);\n    rb_gv_set(\"$z\", z);\n    printf(\"%lu\", rb_gv_get(\"$z\"));\n\n    ruby_cleanup(0);\n    return 0;\n}\n</code></pre>\n\n<p>For the first test, the output should be <code>3</code>, but it is printed out as <code>7</code> and the second test the output should be <code>4.5</code>, but it is printed out as <code>9</code>. The last test should be printed out as <code>6</code> but it prints out as <code>54043195528445954</code>, presumably the address where it's stored.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1670, "user_id": 188256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cXJkr.png?s=128&g=1", "display_name": "snipsnipsnip", "link": "https://stackoverflow.com/users/188256/snipsnipsnip"}, "edited": false, "score": 5, "creation_date": 1547563095, "post_id": 54200591, "comment_id": 95228822, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10046710/are-begin-and-end-reserved-words-or-not\">Are &quot;begin&quot; and &quot;end&quot; reserved words or not?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547589887, "post_id": 54201870, "comment_id": 95241667, "body": "<code>def</code> can be used dynamically if used with <code>class_eval</code> (or <code>eval</code>): <code>class K; end; K.class_eval &quot;def end; &#39;K&#39;; end&quot;; K.new.end #=&gt; &quot;K&quot;</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1548067348, "post_id": 54201870, "comment_id": 95397128, "body": "True @CarySwoveland, but I would consider that a bit of an edge case since you are changing the identifier before parsing the code."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 3, "last_activity_date": 1548067900, "last_edit_date": 1548067900, "creation_date": 1547565849, "answer_id": 54201870, "question_id": 54200591, "link": "https://stackoverflow.com/questions/54200591/how-can-a-class-have-a-method-named-end/54201870#54201870", "title": "How can a class have a method named end", "body": "<blockquote>\n  <p>How does Ruby deal with this method name to not conflict with the\n  protected keyword marking the blockend (eg if \u2026 end)?</p>\n</blockquote>\n\n<p>When using <code>def</code> the parser assumes that what follows is an identifier (a symbol of sorts) delimited by parens or whitespace.  You can't dynamically assign method names with def (without using some form of <code>eval</code>).</p>\n\n<p><code>define_method(:end){}</code> takes a symbol (or a string) so there is no problem with using a reserved word here either. </p>\n\n<p>But the methods can not be called with an implicit receiver as commonly done inside a class:</p>\n\n<pre><code># ok\nclass Foo\n  def end\n  end\n\n  def test\n    # not ambiguous \n    self.end \n  end\nend\n</code></pre>\n\n<hr>\n\n<pre><code># syntax error, unexpected keyword_end, expecting end-of-input\nclass Bar\n  def end\n  end\n\n  def test\n    end \n  end\nend\n</code></pre>\n\n<p>You can call the method  with an explicit reciever:</p>\n\n<pre><code>Foo.new.end\n</code></pre>\n\n<p>Or use dynamic calling with <a href=\"https://ruby-doc.org/core-2.6/Object.html#method-i-send\" rel=\"nofollow noreferrer\"><code>send</code></a> or <a href=\"https://ruby-doc.org/core-2.6/Method.html#method-i-call\" rel=\"nofollow noreferrer\"><code>call</code></a>.</p>\n\n<pre><code>class Foo\n  def end\n  end\n\n  def test\n    send(:end)\n    method(:end).call\n  end\nend\n</code></pre>\n\n<p>You can also use keywords in instance (@end), class (@@end) and global ($end) variable names, as the sigil tells the parser that we are dealing with a variable but not for local variables which have no sigil.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1547662276, "creation_date": 1547662276, "answer_id": 54222963, "question_id": 54200591, "link": "https://stackoverflow.com/questions/54200591/how-can-a-class-have-a-method-named-end/54222963#54222963", "title": "How can a class have a method named end", "body": "<blockquote>\n  <p>How does Ruby deal with this method name to not conflict with the protected keyword</p>\n</blockquote>\n\n<p>Easy: they aren't protected keywords. They are documented as keywords, but actually, in the parser, they aren't really. They are more like what C\u266f calls \"contextual keywords\", i.e. they are only treated specially within a certain context.</p>\n"}], "owner": {"reputation": 31, "user_id": 10907692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff79c9b8faba50196a75d921de3d634d?s=128&d=identicon&r=PG", "display_name": "Alan Matthews", "link": "https://stackoverflow.com/users/10907692/alan-matthews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1548067900, "creation_date": 1547561470, "last_edit_date": 1547562967, "question_id": 54200591, "link": "https://stackoverflow.com/questions/54200591/how-can-a-class-have-a-method-named-end", "title": "How can a class have a method named end", "body": "<p>In Sketchup ruby, the class <em>Edge</em> has a method named \"<em>end</em>\".</p>\n\n<p>How does Ruby deal with this method name to not conflict with the protected keyword marking the blockend (eg <code>if \u2026 end</code>) ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547560363, "creation_date": 1547560363, "question_id": 54200266, "link": "https://stackoverflow.com/questions/54200266/how-to-load-instance-variable-on-ajax-success-request-after-page-load-in-rails", "title": "How to load instance variable on ajax success request after page load in rails?", "body": "<p>I have a method in api that returns json object of vehicles. </p>\n\n<pre><code>class TestApi\n def test_method\n  @vehicle = Vehicle.where(owner_id: current_user.id)\n  respond_to do |format|\n   format.json { render json: @vehicle }\n  end\n end\nend\n</code></pre>\n\n<p>I have a view page from where I do the get request to test_method to get the @vehicle object. How can I keep changing @vehicle object using ajax on success and populate in my view so that on different user view I get the dynamic @vehicle object?</p>\n\n<pre><code>.container\n  - @vehicle.each do |v|\n   %p v.name\n\n:js\n  $(window).on('load', function() {\n    $.ajax({\n      url: \"/api/v1/vehicle/test_method\" + rv_id,\n      success: function(result){\n        console.log('Got the result', html);\n      }\n    })\n  })\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "edited": false, "score": 1, "creation_date": 1547560460, "post_id": 54199558, "comment_id": 95227112, "body": "Thanks again Rajagopalan! Works perfectly! =D"}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": true, "score": 1, "last_activity_date": 1547557969, "creation_date": 1547557969, "answer_id": 54199558, "question_id": 54199141, "link": "https://stackoverflow.com/questions/54199141/text-exception-click-ruby-selenium-webdriver/54199558#54199558", "title": "Text Exception Click (Ruby/Selenium Webdriver)", "body": "<p>You are extrapolating the string in a wrong way</p>\n\n<pre><code>a=23\nCorrect one: \"something'#{a}'is correct\"\nwrong one  : 'something\"#{a}\"is correct'\n</code></pre>\n\n<p>So use this one</p>\n\n<pre><code>[\"GOLD\", \"STANDARD\", \"ELO\", \"DIGITAL\"].each do |var|\n  begin\n    browser.find_element(:xpath =&gt; \"//td[.='#{var}']\")\n    el3 = browser.find_element(:xpath =&gt; \"//td[.='#{var}']\")\n    browser.action.double_click(el3).perform\n    break\n  rescue Selenium::WebDriver::Error::NoSuchElementError\n  end\nend\n</code></pre>\n\n<p>You better use <code>normalize-space(.)</code> which will strip the leading and trailing space</p>\n\n<pre><code>[\"GOLD\", \"STANDARD\", \"ELO\", \"DIGITAL\"].each do |var|\n  begin\n    browser.find_element(:xpath =&gt; \"//td[normalize-space(.)='#{var}']\")\n    el3 = browser.find_element(:xpath =&gt; \"//td[normalize-space(.)='#{var}']\")\n    browser.action.double_click(el3).perform\n    break\n  rescue Selenium::WebDriver::Error::NoSuchElementError\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 10802314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4snMgcSZjWo/AAAAAAAAAAI/AAAAAAAANxM/1lc6gCj10mc/photo.jpg?sz=128", "display_name": "holyonline", "link": "https://stackoverflow.com/users/10802314/holyonline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 54199558, "answer_count": 1, "score": 1, "last_activity_date": 1547557969, "creation_date": 1547556277, "question_id": 54199141, "link": "https://stackoverflow.com/questions/54199141/text-exception-click-ruby-selenium-webdriver", "title": "Text Exception Click (Ruby/Selenium Webdriver)", "body": "<p>I'm trying to use each do to find texts now. When the object <code>&lt;td align=\"left\"&gt;GOLD&lt;/td&gt;</code> don't show, Ruby will try to click on <code>&lt;td align=\"left\"&gt;STANDARD&lt;/td&gt;</code> and he continue to find one after another until he succeed to find and click . On my last question, Rajagopalan helped me with this code:</p>\n\n<pre><code>[\"04\", \"08\", \"10\", \"12\"].each do |num|\n  begin\n    browser.find_element(:id, \"ctl00_ContentPlaceHolder1_ucCancBloqRem_gridListCartoes_ctl00_ctl06_Detail10_ctl#{num}_btnCancelarOn\").click\n    el3 = browser.find_element(:id, \"ctl00_ContentPlaceHolder1_ucCancBloqRem_gridListCartoes_ctl00_ctl04_GECBtnExpandColumn\")\n    browser.action.double_click(el3).perform\n    break\n  rescue\n  end\nend\n</code></pre>\n\n<p>So I tried to put text instead of numbers (this is really possible?):</p>\n\n<pre><code>[\"GOLD\", \"STANDARD\", \"ELO\", \"DIGITAL\"].each do |var|\n        begin\n          browser.find_element(:xpath =&gt; '//td[.=\"{var}\"]')\n          el3 = browser.find_element(:xpath =&gt; '//td[.=\"{var}\"]')\n          browser.action.double_click(el3).perform\n        break\n      rescue Selenium::WebDriver::Error::NoSuchElementError\n     end\n    end\n</code></pre>\n\n<p>And got a error:</p>\n\n<pre><code>C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/response.rb:69:in `assert_ok': no such element: Unable to locate element: {\"method\":\"id\",\"selector\":\"ctl00_ContentPlaceHolder1_ucInfoCliente_lblCpf\"} (Selenium::WebDriver::Error::NoSuchElementError)\n  (Session info: chrome=71.0.3578.98)\n  (Driver info: chromedriver=2.44.609538 (b655c5a60b0b544917107a59d4153d4bf78e1b90),platform=Windows NT 6.1.7601 SP1 x86_64)\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/response.rb:32:in `initialize'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/common.rb:84:in `new'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/common.rb:84:in `create_response'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/default.rb:104:in `request'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/http/common.rb:62:in `call'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/bridge.rb:166:in `execute'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/oss/bridge.rb:584:in `execute'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/oss/bridge.rb:552:in `find_element_by'\n    from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/common/search_context.rb:60:in `find_element'\n    from C:/test/normaliza conta.rb:58:in `&lt;main&gt;'\n[Finished in 47.5s with exit code 1]\n[shell_cmd: ruby \"C:\\test\\normaliza conta.rb\"]\n[dir: C:\\test]\n[path: C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files\\Microsoft SQL Server\\Client SDK\\ODBC\\110\\Tools\\Binn\\;C:\\Program Files (x86)\\Microsoft SQL Server\\120\\Tools\\Binn\\ManagementStudio\\;C:\\Program Files (x86)\\Microsoft SQL Server\\120\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\120\\Tools\\Binn\\;C:\\Program Files (x86)\\Microsoft SQL Server\\120\\DTS\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\120\\DTS\\Binn\\;C:\\Ruby25-x64\\bin]\n</code></pre>\n\n<p>I tried to make more exceptions too, but got error in these code too</p>\n\n<pre><code>begin \n    browser.find_element(:xpath =&gt; '//td[.=\"DIGITAL\"]').click\n    el = browser.find_element(:xpath =&gt; '//td[.=\"STANDARD\"]')\n    browser.action.double_click(el).perform     \nrescue Selenium::WebDriver::Error::NoSuchElementError\n    browser.find_element(:xpath =&gt; '//td[.=\"ELO\"]').click\n    el20 = browser.find_element(:xpath =&gt; '//td[.=\"ELO\"]')\n    browser.action.double_click(el20).perform   \nrescue Selenium::WebDriver::Error::NoSuchElementError\n    browser.find_element(:xpath =&gt; '//td[.=\"STANDARD\"]').click\n    el21 = browser.find_element(:xpath =&gt; '//td[.=\"STANDARD\"]')\n    browser.action.double_click(el21).perform       \nrescue Selenium::WebDriver::Error::NoSuchElementError\n    browser.find_element(:xpath =&gt; '//td[.=\"GOLD\"]').click\n    el22 = browser.find_element(:xpath =&gt; '//td[.=\"GOLD\"]')\n    browser.action.double_click(el22).perform\nend\n</code></pre>\n\n<p>In this case, he stops on second element (\"ELO\") and don't reach the third (\"STANDARD\") and forth (\"GOLD\"). (Trying to pass through ELO and DIGITAL to reach STANDARD, which is present in my test.)</p>\n\n<pre><code>*** WARNING: You must use ANSICON 1.31 or higher (https://github.com/adoxa/ansicon/) to get coloured output on Windows\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/selenium-webdriver-3.141.0/lib/selenium/webdriver/remote/response.rb:69:in `assert_ok': no such element: Unable to locate element: {\"method\":\"xpath\",\"selector\":\"//td[.=\"ELO\"]\"} (Selenium::WebDriver::Error::NoSuchElementError)\n</code></pre>\n\n<p>But got this error too. Any hints about what I can do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activemodel"], "comments": [{"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1547556601, "post_id": 54199100, "comment_id": 95225043, "body": "in your form try <code>goods_purchase_create_message_path</code> and in your routes: <code>post &quot;goods_purchase&#47;create_message&quot;, to: &quot;post &quot;goods_purchase#create_message&quot; </code>"}, {"owner": {"reputation": 101, "user_id": 9880298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996c6ed0857a4c87eba9a3292ec25227?s=128&d=identicon&r=PG&f=1", "display_name": "Litrein", "link": "https://stackoverflow.com/users/9880298/litrein"}, "reply_to_user": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "edited": false, "score": 0, "creation_date": 1547557657, "post_id": 54199100, "comment_id": 95225580, "body": "Thanks, I  found a mistake. I forgot to write in the main controller before_action -&gt;{ @goods = ::GoodsPurchase.new }"}], "owner": {"reputation": 101, "user_id": 9880298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996c6ed0857a4c87eba9a3292ec25227?s=128&d=identicon&r=PG&f=1", "display_name": "Litrein", "link": "https://stackoverflow.com/users/9880298/litrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547556111, "creation_date": 1547556111, "question_id": 54199100, "link": "https://stackoverflow.com/questions/54199100/activemodel-first-argument-in-form-cannot-contain-nil", "title": "ActiveModel first argument in form cannot contain nil", "body": "<p>I want to create form without using Active Record, I'm following the Ruby on Rails tutorial, and use Active Model, so I have a model</p>\n\n<pre><code>class GoodsPurchase\n\n  include ActiveModel::Validations\n  include ActiveModel::Conversion\n  include ActiveModel::Model\n  extend ActiveModel::Naming\n\n  attr_accessor :phone, :name, :email\n\n  validates_presence_of :phone\n  validates_presence_of :name\n  validates_format_of :email, :with =&gt;  /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i\n\n  def initialize(attributes = {})\n    super\n    attributes.each do |name, value|\n      send(\"#{name}=\", value)\n    end\n  end\n\n  def persisted?\n    false\n  end\nend\n</code></pre>\n\n<p>then I have controller</p>\n\n<pre><code>class Market::Desktop::Vision::GoodsPurchaseController &lt; CatalogController\n\n  domain_layout 'page_screen'\n\n  def create_message\n    @goods = GoodsPurchase.new message_params\n    if @goods.valid?\n      flash[:notice] = \"Message sent! Thank you for contacting us.\"\n      redirect_to root_url\n    else\n      render :action =&gt; 'new'\n    end\n  end\n\n  private\n\n  def message_params\n    params.require(:goods).permit(:phone, :name, :email)\n  end\nend\n</code></pre>\n\n<p>And view</p>\n\n<pre><code>&lt;%= form_for @goods, url: goods_purchase_create_message_url, method: :post, remote: true do |f| %&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;%= f.label :Phone, class: \"label\" %&gt;\n                &lt;%= f.text_field :phone, class: \"int\", placeholder: \"+7 (   ) 123-45-67\", :required =&gt; true %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;%= f.label :Name, class: \"label\" %&gt;\n                &lt;%= f.text_field :name, class: \"int\", placeholder: \"Oleg Petrov\", :required =&gt; true %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;%= f.label :Email, class: \"label\" %&gt;\n                &lt;%= f.text_field :email, class: \"int\", placeholder: \"example@example.ru\", :required =&gt; true %&gt;\n            &lt;/div&gt;\n            &lt;input type=\"hidden\" name=\"articul_for_order\" class=\"js_articul_for_order\"&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;%= recaptcha_tags %&gt;\n            &lt;/div&gt;\n            &lt;button type=\"\" class=\"btn btn_middle btn_blue2\"&gt;Order callback`enter code here`&lt;/button&gt;\n            &lt;%= f.submit \"Callback\", class: 'btn btn_middle btn_blue2' %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>And in route.rb I wrote <code>post \"goods_purchase/create_message\"</code>\nAnd after that I have this error <code>first argument in form cannot contain nil</code> I don't know why and what I have to do with it</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 2, "creation_date": 1547554913, "post_id": 54198565, "comment_id": 95224161, "body": "Why don&#39;t you use SQL from the first place to prepare the data, I mean in the action doing something like this <code>@permissions = Permission.joins(document: {workstream: {id: current_user.workstream.id}})</code>, then this will will return permissions that belongs to the work sheet of that user, and you can count them with <code>.count</code> method, hope it helps."}, {"owner": {"reputation": 378, "user_id": 4267804, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e1036d3e728f3bb865307cf6eaf92b8?s=128&d=identicon&r=PG", "display_name": "Priince Abalogu", "link": "https://stackoverflow.com/users/4267804/priince-abalogu"}, "reply_to_user": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 0, "creation_date": 1547555770, "post_id": 54198565, "comment_id": 95224619, "body": "it throws an ActiveRecord::ConfigurationError"}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 0, "creation_date": 1547558129, "post_id": 54198565, "comment_id": 95225825, "body": "Could you update the question with the models argued in the question? and put the error message too, please."}, {"owner": {"reputation": 378, "user_id": 4267804, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e1036d3e728f3bb865307cf6eaf92b8?s=128&d=identicon&r=PG", "display_name": "Priince Abalogu", "link": "https://stackoverflow.com/users/4267804/priince-abalogu"}, "reply_to_user": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 0, "creation_date": 1547559750, "post_id": 54198565, "comment_id": 95226691, "body": "thanks for the reply and updated my question"}, {"owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "edited": false, "score": 1, "creation_date": 1547560259, "post_id": 54198565, "comment_id": 95227002, "body": "Try this one, <code>Permission.joins(document: :workstream).where(&#39;workstreams.id = ?&#39;, current_user.workstream.id)</code>, I believe it is going to work, hope it helps."}], "owner": {"reputation": 378, "user_id": 4267804, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7e1036d3e728f3bb865307cf6eaf92b8?s=128&d=identicon&r=PG", "display_name": "Priince Abalogu", "link": "https://stackoverflow.com/users/4267804/priince-abalogu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547559600, "creation_date": 1547554205, "last_edit_date": 1547559600, "question_id": 54198565, "link": "https://stackoverflow.com/questions/54198565/segmenting-returns-from-each-method-rails-using-children-conditions", "title": "Segmenting returns from .each method rails using children conditions", "body": "<p>I have a permissions table that belongs to document.rb and document belongs to workstream.rb </p>\n\n<pre><code>&lt;% @permissions.each do |p| %&gt;\n  &lt;% if current_user.workstream === p.document.workstream %&gt;\n     # all the values that are true to this condition should be captured in an array or .where sort of return array           \n  &lt;% end  %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>please how can I capture the values that are true to the if condition in an array and count the values. </p>\n\n<p>so store all permissions that have the same document in the current users workstream in an array and count</p>\n\n<pre><code>class Permission &lt; ApplicationRecord\n extend FriendlyId\n friendly_id :id, use: :slugged\n belongs_to :user\n belongs_to :document\n enum status: [:request, :approved, :rejected]\nend   \n\nclass Document &lt; ApplicationRecord\n extend FriendlyId\n friendly_id :doc_uuid, use: :slugged\n mount_uploader :doc_resource_url, DocumentUploader\n before_save :generate_token\n belongs_to :workstream\n has_one :document_meta\n belongs_to :state\n has_many :permissions\nend\n\nclass Workstream &lt; ApplicationRecord\n  extend FriendlyId\n  friendly_id :fullname, use: :slugged\n  belongs_to :unit\n  belongs_to :state\n  belongs_to :project\n  has_many :documents\n  has_many :user_workstreams\n  has_many :users, through: :user_workstreams\n  validates_uniqueness_of :workstream_code\nend\n</code></pre>\n\n<p>error message</p>\n\n<pre><code>2.4.0 :026 &gt; Permission.joins(document: {workstream: {id: 1}})\nActiveRecord::ConfigurationError: 1\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:70:in `walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:67:in `block in walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:65:in `each'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:65:in `walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:67:in `block in walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:65:in `each'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:65:in `walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:67:in `block in walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:65:in `each'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:65:in `walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:62:in `block in walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:61:in `each'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:61:in `walk_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:52:in `make_tree'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/associations/join_dependency.rb:97:in `initialize'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activerecord-5.0.7/lib/active_record/relation/query_methods.rb:1071:in `new'\n... 9 levels...\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/railties-5.0.7/lib/rails/commands/console_helper.rb:9:in `start'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/railties-5.0.7/lib/rails/commands/commands_tasks.rb:78:in `console'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/railties-5.0.7/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/railties-5.0.7/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:293:in `block in require'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:293:in `require'\n    from /Users/chineduabalogu/work/HSDF_DHUB/bin/rails:9:in `&lt;top (required)&gt;'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:287:in `load'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:287:in `block in load'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:259:in `load_dependency'\n    from /Users/chineduabalogu/.rvm/gems/ruby-2.4.0/gems/activesupport-5.0.7/lib/active_support/dependencies.rb:287:in `load'\n    from /Users/chineduabalogu/.rvm/rubies/ruby-2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /Users/chineduabalogu/.rvm/rubies/ruby-2.4.0/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from -e:1:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "while-loop"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1547552811, "post_id": 54198178, "comment_id": 95223093, "body": "Your <code>gets_var</code> contains a newline at the end. And so it can&#39;t be equal to <code>&quot;stop&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1547553149, "post_id": 54198234, "comment_id": 95223261, "body": "That&#39;s done it, many thanks."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1547554787, "post_id": 54198234, "comment_id": 95224083, "body": "My IRB shows <code>#=&gt; &quot;test\\n&quot;</code> right away, there&#39;s no need for <code>pp</code>"}], "tags": [], "owner": {"reputation": 1606, "user_id": 3137698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1819a8d2ac84a22c29b910b38dd4686f?s=128&d=identicon&r=PG", "display_name": "zinovyev", "link": "https://stackoverflow.com/users/3137698/zinovyev"}, "is_accepted": true, "score": 4, "last_activity_date": 1547553252, "last_edit_date": 1547553252, "creation_date": 1547552956, "answer_id": 54198234, "question_id": 54198178, "link": "https://stackoverflow.com/questions/54198178/ruby-loop-failing-to-break-when-using-gets/54198234#54198234", "title": "Ruby Loop failing to break when using gets", "body": "<p>Just use the <code>String#chomp</code> method which will return the string without the new line separator:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\ngets_var.chomp == \"stop\"\n\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-chomp\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.2.0/String.html#method-i-chomp</a></p>\n\n<p>You can check it out manually in <code>irb</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\nirb(main):011:0&gt; gets_var = gets\ntest\n=&gt; test\n\nirb(main):012:0&gt; pp gets_var\n\"test\\n\"\n=&gt; test\n\n</code></pre>\n\n<p>There's a new line (<code>\\n</code>) character at the end of the string. It appears always when you're using <code>gets</code>.</p>\n"}], "owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "closed_date": 1570618571, "accepted_answer_id": 54198234, "answer_count": 1, "score": 2, "last_activity_date": 1547553252, "creation_date": 1547552662, "last_edit_date": 1547553066, "question_id": 54198178, "link": "https://stackoverflow.com/questions/54198178/ruby-loop-failing-to-break-when-using-gets", "closed_reason": "Duplicate", "title": "Ruby Loop failing to break when using gets", "body": "<p>My code should prompt the user to input numbers until they type 'stop', when it returns the total of the numbers entered. I've written this program two ways, both of which fail to break the loop when 'stop' is entered.</p>\n\n<p>My first attempt was with an until loop, although I feel the control flow doesn't work as well. My second uses 'until true' and 'break'.\nI'm storing the result of gets in a variable so that I can convert it to an integer, and I've tested removing the variable in case 'stop' was being converted.</p>\n\n<pre><code># 2nd attempt\ntotal = 0\n\nwhile true\n  puts \"Give me a number\"\n  gets_var = gets\n  if gets_var == \"stop\"\n    break\n  else\n    total += gets_var.to_i\n  end\nend\n\nputs total\n\n\n# 1st attempt\ntotal = 0\ngets_var = 0\n\nuntil gets_var == \"stop\"\n  puts \"Give me a number\"\n  gets_var = gets\n  total += gets_var.to_i\nend\n\nputs total\n</code></pre>\n\n<p>I expect inputting 'stop' when prompted to end the loop and return the total. In no case does 'stop' break the loop.</p>\n\n<p>Why is my loop failing to break?</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "edited": false, "score": 0, "creation_date": 1547549438, "post_id": 54196794, "comment_id": 95221400, "body": "why are there apostrophes around that line? that way rails thinks this line is a text, try removing them. (and another thing, rails will ALLWAYS think that text surrounded by apostrophes is a string, and won&#39;t evaluate the value of the variables. If you need to evaluate some value you need to use quotation marks! (use &quot;&quot; instead of &#39;&#39;, unless you need text)"}, {"owner": {"reputation": 1, "user_id": 10916260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f452f67a0418679c577e094772b2d139?s=128&d=identicon&r=PG&f=1", "display_name": "Louie Ormston", "link": "https://stackoverflow.com/users/10916260/louie-ormston"}, "reply_to_user": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "edited": false, "score": 0, "creation_date": 1547550108, "post_id": 54196794, "comment_id": 95221733, "body": "I was trying many different things to see if any would pass something through the param. The message I am left with everytime is still: Couldn&#39;t find Product without an ID. No matter the format of the hidden field tag or whether it is in apostrophes. Thanks for the help though :)"}, {"owner": {"reputation": 1145, "user_id": 3262916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91abfd08a0e41f2c1b292d233100e5a4?s=128&d=identicon&r=PG", "display_name": "Ziv Galili", "link": "https://stackoverflow.com/users/3262916/ziv-galili"}, "edited": false, "score": 0, "creation_date": 1547555689, "post_id": 54196794, "comment_id": 95224577, "body": "try passing the parameter to your partial: &lt;%= render partial: &#39;shared/stripe_checkout_button, locals: {product: @product}&#39;%&gt;. And then in the partial use product without the @ to access the var"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10916260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f452f67a0418679c577e094772b2d139?s=128&d=identicon&r=PG&f=1", "display_name": "Louie Ormston", "link": "https://stackoverflow.com/users/10916260/louie-ormston"}, "is_accepted": false, "score": 0, "last_activity_date": 1547674999, "creation_date": 1547674999, "answer_id": 54225848, "question_id": 54196794, "link": "https://stackoverflow.com/questions/54196794/parameters-are-not-passing-anything-or-passing-null/54225848#54225848", "title": "Parameters are not passing anything or passing null", "body": "<p>Okay the solution me and my mentor found was to change the value to a non dynamic value. I did not understand why this worked but it did:</p>\n\n\n\n\n<p>Thanks for everyone that helped on the way</p>\n"}], "owner": {"reputation": 1, "user_id": 10916260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f452f67a0418679c577e094772b2d139?s=128&d=identicon&r=PG&f=1", "display_name": "Louie Ormston", "link": "https://stackoverflow.com/users/10916260/louie-ormston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547674999, "creation_date": 1547547339, "last_edit_date": 1547555019, "question_id": 54196794, "link": "https://stackoverflow.com/questions/54196794/parameters-are-not-passing-anything-or-passing-null", "title": "Parameters are not passing anything or passing null", "body": "<p>Payments Controller:</p>\n\n<pre><code>class PaymentsController &lt; ApplicationController\n  before_action :authenticate_user!\n  def show\n    @user = current_user\n    @orders = Order.where(user_id: @user.email)\n    @products = Product.all\n  end\n\n  def create\n    @product = Product.find(params[:product_id])\n    token = params[:stripeToken]\n    # Create the charge on Stripe's servers - this will charge the user's card\n    price = @product.avgprice.to_i*100\n    @user = current_user\n    begin\n      charge = Stripe::Charge.create(\n        amount: price,\n        currency: \"gbp\",\n        source: token,\n        description: params[:stripeEmail],\n        reciept_email: @user.email\n      )\n\n      if charge.paid\n        Order.create(product_id: @product.id, user_id: @user.email, total: price)\n      end\n    rescue Stripe::CardError =&gt; e\n      #The card has been declined\n      body = e.json_body\n      err = body[:error]\n      flash[:error] = \"Unfortunately, there was an error processing your payment: #{err[:message]}\"\n    end\n    redirect_to(payments_show_path)\n  end\nend\n</code></pre>\n\n<p>_stripe_checkout_button.html:</p>\n\n<pre><code>&lt;%price = @product.avgprice.to_i * 100%&gt;\n&lt;form action=\"your-server-side-code\" method=\"POST\"&gt;\n  &lt;script\n    src=\"https://checkout.stripe.com/checkout.js\" class=\"stripe-button\"\n    data-key=\"&lt;%= Rails.configuration.stripe[:publishable_key] %&gt;\"\n\n    data-amount=\"&lt;%=price%&gt;\"\n    data-name= \"&lt;%=@product.name%&gt;\"\n    data-description=\"&lt;%=@product.description%&gt;\"\n    data-image=\"https://stripe.com/img/documentation/checkout/marketplace.png\"\n    data-locale=\"auto\"\n    data-currency=\"gbp\"&gt;\n\n  &lt;/script&gt;\n  &lt;%= hidden_field_tag(:product_id, @product.id)%&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Show.html.erb:</p>\n\n<pre><code>&lt;%= form_with(url: '/payments/create') do |form| %&gt;\n&lt;%= render partial: 'shared/stripe_checkout_button'%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I expected the &lt;%= hidden_field_tag(:product_id, @product.id)%> to pass the product id to the payment controller at <code>@product = Product.find(params[:product_id])</code>. But it does not seem to be working. Any help? An error I am getting from this is:\nActiveRecord::RecordNotFound in PaymentsController#create\nCouldn't find Product without an ID</p>\n"}, {"tags": ["ruby", "string"], "answers": [{"tags": [], "owner": {"reputation": 1933, "user_id": 317275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6148dea2ea49459ba992c2e8ddd97f54?s=128&d=identicon&r=PG", "display_name": "SirLenz0rlot", "link": "https://stackoverflow.com/users/317275/sirlenz0rlot"}, "is_accepted": false, "score": 2, "last_activity_date": 1547545510, "last_edit_date": 1547545510, "creation_date": 1547545209, "answer_id": 54196201, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore/54196201#54196201", "title": "Splitting the string with last underscore", "body": "<p>Do you really need to split? How about just replacing the <code>_</code> with a space? e.g. using <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-rindex\" rel=\"nofollow noreferrer\"><code>rindex</code></a> and <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\"><code>[]=</code></a></p>\n\n<pre><code>a[a.rindex('_')] = ' '\n</code></pre>\n\n<p>I didn't do a benchmark, but <code>split</code> creates a new array, which typically requires more resources, at least in other languages.</p>\n\n<p>EDIT: as the question was edited, its now clear the OP is asking for a list instead of a string output</p>\n"}, {"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 37744, "user_id": 578411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qj33e.png?s=128&g=1", "display_name": "rene", "link": "https://stackoverflow.com/users/578411/rene"}, "edited": false, "score": 0, "creation_date": 1547615366, "post_id": 54196212, "comment_id": 95247514, "body": "@rene Quite same reason, but I know it due to some famous question, or can get with little research <a href=\"https://stackoverflow.com/q/12839645/10522579\">stackoverflow.com/q/12839645/10522579</a>"}], "tags": [], "owner": {"reputation": 136, "user_id": 2505985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6643e3e713d46c09c411a44a08fb404?s=128&d=identicon&r=PG", "display_name": "mi0", "link": "https://stackoverflow.com/users/2505985/mi0"}, "is_accepted": false, "score": 2, "last_activity_date": 1547630316, "last_edit_date": 1547630316, "creation_date": 1547545264, "answer_id": 54196212, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore/54196212#54196212", "title": "Splitting the string with last underscore", "body": "<p>Split it with regex:</p>\n\n<pre><code>a.split(/_(?=[^_]+$)/)\n</code></pre>\n\n<p>Explanation:</p>\n\n<blockquote>\n  <p>matches the character _ with positive Lookahead (?=[^_]+$)</p>\n  \n  <p>Match a single character not present in the list below [^_]+ and \n  $ asserts position at the end of the string, or before the line terminator right at the end of the string (if any)</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 7, "last_activity_date": 1547545695, "last_edit_date": 1547545695, "creation_date": 1547545307, "answer_id": 54196227, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore/54196227#54196227", "title": "Splitting the string with last underscore", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-rpartition\" rel=\"noreferrer\"><code>String#rpartition</code></a> that searches for a given pattern form the right end of the string and splits when it finds it.</p>\n\n<pre><code>'a_b_c_d_e'.rpartition(/_/)\n=&gt; [\"a_b_c_d\", \"_\", \"e\"]\n\ns = 'a_b_c_d_e'\nparts = s.rpartition(/_/)\n[parts.first, parts.last]\n=&gt; [\"a_b_c_d\", \"e\"]\n</code></pre>\n\n<p>EDIT: applying advices from the comments:</p>\n\n<pre><code>'a_b_c_d_e'.rpartition('_').values_at(0,2)\n=&gt; [\"a_b_c_d\", \"e\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 3, "creation_date": 1547545570, "post_id": 54196252, "comment_id": 95219330, "body": "it works only if the part after the last <code>_</code> has lenght of one."}], "tags": [], "owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "is_accepted": false, "score": -1, "last_activity_date": 1547545395, "creation_date": 1547545395, "answer_id": 54196252, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore/54196252#54196252", "title": "Splitting the string with last underscore", "body": "<p>Assuming you know this string follows this format:</p>\n\n<pre><code>str = 'a_b_c_d_e'\n# Remainder\nstr[0...-2]    # -&gt; 'a_b_c_d'\n\n# Last symbol\nstr[-1]        # -&gt; 'e'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1547549095, "creation_date": 1547549095, "answer_id": 54197290, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore/54197290#54197290", "title": "Splitting the string with last underscore", "body": "<p>You can also get values as below,</p>\n\n<pre><code>&gt; a = a.split('_')\n&gt; a[0..-2].join('_')\n# =&gt; \"a_b_c_d\" \n&gt; a[-1]\n# =&gt; \"e\" \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1547587568, "creation_date": 1547587568, "answer_id": 54207051, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore/54207051#54207051", "title": "Splitting the string with last underscore", "body": "<pre><code>'a_b_c_d_e'.split /_(?!.*_)/\n  #=&gt; [\"a_b_c_d\", \"e\"]\n</code></pre>\n\n<p>The negative lookahead <code>(?!.*_)</code> requires that following the match of the underscore there is no other underscore in the string.</p>\n"}], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 54196227, "answer_count": 6, "score": 1, "last_activity_date": 1568837823, "creation_date": 1547544944, "last_edit_date": 1568837823, "question_id": 54196113, "link": "https://stackoverflow.com/questions/54196113/splitting-the-string-with-last-underscore", "title": "Splitting the string with last underscore", "body": "<p>I have a string like <code>\"a_b_c\"</code> or <code>\"a_b_c_d\"</code> or <code>\"a_b_c_d_e\"</code>. I want to split the string at the last underscore.</p>\n\n<pre><code>**input**\n'a_b_c'\n**output**\na_b\nc\n\n**input**\n'a_b_c_d'\n**output**\na_b_c\nd\n</code></pre>\n\n<p>I have done the following:</p>\n\n<pre><code>a='a_b_c'\na=a.split('_')\nlast=a.pop\na.delete(last)\np a.join(\"_\")\np last\n</code></pre>\n\n<p>and achieved the result, but I don't think this should be done this way. I hope there is some regular expression to achieve this. Is there anyone who can help me with this?</p>\n"}, {"tags": ["ruby", "bash", "shell", "curl"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5606712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854ca33c439ef7ccf4d56de750b750a2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/5606712/angelo"}, "edited": false, "score": 0, "creation_date": 1547536437, "post_id": 54194046, "comment_id": 95215359, "body": "hello @Aleksei, thank you so much for your response however It is still not outputting the whole json object. It just adds a double quote from my previous output"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 111, "user_id": 5606712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854ca33c439ef7ccf4d56de750b750a2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/5606712/angelo"}, "edited": false, "score": 1, "creation_date": 1547536521, "post_id": 54194046, "comment_id": 95215392, "body": "Sure it does. You must check it on the input you provided for us. If your input is more complicated and contains spaces (which is most likely the case,) you should surround the whole string with single quotes before passing it to shell."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 111, "user_id": 5606712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854ca33c439ef7ccf4d56de750b750a2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/5606712/angelo"}, "edited": false, "score": 1, "creation_date": 1547537769, "post_id": 54194046, "comment_id": 95215842, "body": "@Noel : You did not show the code of <code>ruby_to_bash</code>, but for your concrete example string, I guess that <code>cmd = &quot;ruby_to_bash &#39;#{param}&quot;&#39;</code> will work. Of course it won&#39;t work in general (for every JSON) string, and the whole idea of building up a command line and running it with <code>exec</code> is flawed. It would be much better if  you would pass the arguments to your script individually; see the documentation for the <i>exec</i> method."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1547537951, "post_id": 54194046, "comment_id": 95215912, "body": "@user1934428 also a subshell with <a href=\"https://ruby-doc.org/core-2.6/Kernel.html#method-i-system\" rel=\"nofollow noreferrer\"><code>Kernel#system</code></a> is magnitudes of order better than replacing the current process with <code>Kernel#exec</code>."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1547553268, "post_id": 54194046, "comment_id": 95223331, "body": "Well, I guess the OP <i>wants</i> to replace his process; otherwise he would not have used <code>exec</code>. Indeed, if passing the control to the script is the last action to perform, I don&#39;t see why he should not do it in his way."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1547536785, "last_edit_date": 1547536785, "creation_date": 1547535631, "answer_id": 54194046, "question_id": 54193931, "link": "https://stackoverflow.com/questions/54193931/how-to-pass-a-json-body-from-ruby-to-bash-script/54194046#54194046", "title": "How to pass a json body from ruby to bash script", "body": "<p>Both bash and ruby treat double quotes in a kinda special way: double-quoted strings are <em>interpolated</em> before passed to the receiver. I strongly encourage you to start with learning somewhat one in the first place instead of doing zero progress in both due to induced errors.</p>\n\n<p>Answering the question stated, one must escape double quotes when passing back and forth since both ruby and bash treat them as <em>content delimiters</em> and discard when the content is already parsed in the resulting string.</p>\n\n<p>This would work:</p>\n\n<pre><code>exec %|ruby_to_bash #{param.gsub('\"', '\\\"')}|\n</code></pre>\n\n<p>I use <code>%|</code> and <code>|</code> as string delimiters to avoid clashes against inner quotes.</p>\n\n<hr>\n\n<p><em>Sidenote:</em> the above won\u2019t work for the input containing spaces, but I purposely avoid to show how to deal with spaces since it leads to the dead end; once handled spaces with surrounding the interpolated <code>param</code> with single quotes, we are prone to be screwed up with <em>inner single quotes</em> in JSON object and so forth.</p>\n\n<p>The code above is not someone should ever produce in production.</p>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 1, "last_activity_date": 1547540885, "creation_date": 1547540885, "answer_id": 54195103, "question_id": 54193931, "link": "https://stackoverflow.com/questions/54193931/how-to-pass-a-json-body-from-ruby-to-bash-script/54195103#54195103", "title": "How to pass a json body from ruby to bash script", "body": "<p>I think your best bet is, as usual in such cases, not to involve a shell at all.</p>\n\n<p>When you say this:</p>\n\n<pre><code>cmd = \"ruby_to_bash #{param}\"\nexec cmd\n</code></pre>\n\n<p>Your <code>exec</code> call is invoking a shell which parses <code>cmd</code> and then runs <code>ruby_to_bash</code> so you're doing this:</p>\n\n<ol>\n<li>Build a command line.</li>\n<li>Replace the current process with <code>/bin/sh</code>.</li>\n<li><code>/bin/sh</code> parses the command line that you should mashed together. This is where you need to worry about quoting and escaping to get past the shell.</li>\n<li><code>/bin/sh</code> exec's <code>ruby_to_bash</code>.</li>\n</ol>\n\n<p>You could bypass the whole problem by using the multi-argument form of <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-exec\" rel=\"nofollow noreferrer\"><code>Kernel#exec</code></a>:</p>\n\n<blockquote>\n  <p><strong>exec(cmdname, arg1, ...)</strong><br>\n  command name and one or more arguments (no shell)</p>\n</blockquote>\n\n<p>which doesn't bother with a shell at all. If you say:</p>\n\n<pre><code>exec 'ruby_to_bash', param\n</code></pre>\n\n<p>You won't involve a shell and the quotes or spacing in <code>param</code> won't matter to anyone other than <code>ruby_to_bash</code>.</p>\n"}], "owner": {"reputation": 111, "user_id": 5606712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854ca33c439ef7ccf4d56de750b750a2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/5606712/angelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 1, "accepted_answer_id": 54194046, "answer_count": 2, "score": 1, "last_activity_date": 1547540885, "creation_date": 1547534925, "question_id": 54193931, "link": "https://stackoverflow.com/questions/54193931/how-to-pass-a-json-body-from-ruby-to-bash-script", "title": "How to pass a json body from ruby to bash script", "body": "<p>I am trying to study both bash and ruby and I am trying to pass a variable that contains a JSON object from ruby to be printed using a bash script.</p>\n\n<p>I tried storing the JSON object in a variable then used that variable as an argument for my bash script but I am not getting the result that I wanted.</p>\n\n<p>so in my ruby code I have this:</p>\n\n<pre><code>param = request.body\ncmd = \"ruby_to_bash #{param}\"\nexec cmd\n</code></pre>\n\n<p>and in my bash script, I am simply outputting the value of the argument:</p>\n\n<pre><code>echo $1\n</code></pre>\n\n<p>For example I have this JSON:</p>\n\n<pre><code>{\"first\":\"one\",\"second\":\"two\",\"third\":\"three\"}\n</code></pre>\n\n<p>my code only gives me this output:</p>\n\n<pre><code>{first:\n</code></pre>\n\n<p>I want to display the whole JSON object. How can I do this? Any kind of help will be much appreciated.</p>\n"}, {"tags": ["ruby", "initialization", "instance-variables"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 3, "creation_date": 1547526340, "post_id": 54192677, "comment_id": 95212920, "body": "Doesn&#39;t matter. Do what makes sense. You were under the wrong impression if you think it should only happen in initialize. Read <a href=\"https://stackoverflow.com/q/4370960/3784008\">this</a> for more info on use of instance variables outside initialize."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547526439, "post_id": 54192677, "comment_id": 95212945, "body": "@anothermh I was.  And the question was definitely lingering at the back of my head..."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1547528739, "post_id": 54192677, "comment_id": 95213431, "body": "To be able to access across instance methods, that is the whole point of instance variables."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547530952, "post_id": 54192677, "comment_id": 95213949, "body": "@anothermh lol, I literally forgot or missed <code>attr_accessor</code>. Thanks!"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1547534171, "post_id": 54192677, "comment_id": 95214719, "body": "It&#39;s a nice convention, but just that. You can actually declare instance variables from anywhere using <code>instance_variable_set</code> (but I wouldn&#39;t advise doing that unless you must for metaprogramming)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1547535991, "post_id": 54192677, "comment_id": 95215240, "body": "@maxpleaner for <i>dynamic</i> programming actually, which is not mandatory <i>meta</i> :)"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547536639, "post_id": 54192677, "comment_id": 95215427, "body": "<a href=\"https://ruby-doc.org/core-2.6/Object.html#method-i-instance_variable_set\" rel=\"nofollow noreferrer\">Mandatory reading</a> for anyone considering using <code>instance_variable_set</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1547662377, "post_id": 54192677, "comment_id": 95271802, "body": "If you were only allowed to assign to instance variables inside <code>initialize</code>, then you could never, ever change them, except by calling <code>initialize</code> again. Who told you that? Also, <code>initialize</code> is just a method like any other method, so if you weren&#39;t allowed to assign to instance variables in methods, then you couldn&#39;t assign them in <code>initialize</code> either. The fact that you can assign them in <code>initialize</code> already proves that you can assign them in methods, because <code>initialize</code> is a method. This entire statement makes no sense."}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 6, "last_activity_date": 1547542121, "creation_date": 1547542121, "answer_id": 54195397, "question_id": 54192677, "link": "https://stackoverflow.com/questions/54192677/declaring-an-instance-variable-outside-of-initialize-method/54195397#54195397", "title": "Declaring an instance variable outside of `initialize` method", "body": "<blockquote>\n  <p>I have been taught to declare my instance variables with def initialize</p>\n</blockquote>\n\n<p>Since <code>initialize</code> is the first instance method call in an object's life cycle, you typically declare your instance variables right there in order to ensure properly initialized variables. It's also the first place I'd expect instance variables to be defined when reading code.</p>\n\n<blockquote>\n  <p>I have been under the impression that I could declare instance variables only within my initialize methods.</p>\n</blockquote>\n\n<p>There's no such restriction. You can declare instance variable anywhere within your instance.</p>\n\n<p>A common use is <a href=\"https://en.wikipedia.org/wiki/Memoization\" rel=\"noreferrer\">memoization</a>:</p>\n\n<pre><code>class FooBar\n  def foo\n    @foo ||= expensive_operation\n  end\nend\n</code></pre>\n\n<p>On the first call, this would evaluate <code>expensive_operation</code> and assign the result to <code>@foo</code>. On subsequent calls, <code>@foo</code> is returned.</p>\n\n<p>Another popular example is Rails which uses instance variables to pass data from the controller to its view:</p>\n\n<pre><code>class FooController &lt; ApplicationController\n  def index\n    @foos = Foo.all\n  end\nend\n</code></pre>\n\n<blockquote>\n  <p>is there a best practices rule I should follow, regarding where to declare instance variables</p>\n</blockquote>\n\n<p>It depends on their purpose (see above examples). As a general rule, declare them in a way that avoids undefined variables (<code>nil</code> errors) and structure your code so it is easy to read / follow.</p>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 5, "last_activity_date": 1547542747, "creation_date": 1547542747, "answer_id": 54195560, "question_id": 54192677, "link": "https://stackoverflow.com/questions/54192677/declaring-an-instance-variable-outside-of-initialize-method/54195560#54195560", "title": "Declaring an instance variable outside of `initialize` method", "body": "<p>Just to add to Stefan's excellent answer</p>\n\n<blockquote>\n  <p>I have been taught to declare my instance variables with <code>def initialize</code></p>\n</blockquote>\n\n<p>A common mistake that ruby newbies make is something like this:</p>\n\n<pre><code>class Person\n  @name = \"John\"\n\n  def introduce\n    puts \"Hi, my name is #{@name}\"\n  end\nend\n</code></pre>\n\n<p>And then they wonder why their names are not printed. To make this work, one can set the variable <code>@name</code> in the initializer, just as the instruction says.</p>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1547569748, "post_id": 54202765, "comment_id": 95232913, "body": "* well unless you are talking about Javascript which is a very special snowflake."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1547576023, "post_id": 54202765, "comment_id": 95236005, "body": "<i>&quot;access instance variables which have not been set without error&quot;</i> \u2013 there will be a warning, though (if enabled)."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1547637582, "last_edit_date": 1547637582, "creation_date": 1547568928, "answer_id": 54202765, "question_id": 54192677, "link": "https://stackoverflow.com/questions/54192677/declaring-an-instance-variable-outside-of-initialize-method/54202765#54202765", "title": "Declaring an instance variable outside of `initialize` method", "body": "<p>Lets start with the biggest misnomer -  in Ruby there is no separate step of declaring variables -  Variables are declared as you set them. </p>\n\n<p>What the difference? Look at Java for example:</p>\n\n<pre><code>public class Bicycle {\n\n    private int cadence;\n    private int gear;\n    private int speed;\n\n    public Bicycle(int startCadence, int startSpeed, int startGear) {\n        gear = startGear;\n        cadence = startCadence;\n        speed = startSpeed;\n    }\n}\n</code></pre>\n\n<p>We have to declare all the instance variables before we set them in the initializer (Bicycle). The same code in Ruby reads:</p>\n\n<pre><code>class Bicycle\n  def initialize(cadence, speed, gear)\n    @cadence = cadence\n    @speed = speed\n    @gear = gear\n  end\nend\n</code></pre>\n\n<p>There is no declaration - only assignment. Ruby will even let you access instance variables which have not been set without error. </p>\n\n<pre><code>irb(main):003:0&gt; @not_set\n=&gt; nil\n</code></pre>\n\n<p>You can't do that (generally) in languages where variables must be defined*.</p>\n\n<blockquote>\n  <p>I have been taught to declare my instance variables with def\n  initialize. I have been under the impression that I could declare\n  instance variables only within my initialize methods.</p>\n</blockquote>\n\n<p><strong>Nonsense.</strong> You can assign instance variables anywhere. Its commonly done in everything from setters and mutators (methods that alter an object) to factory methods (class methods that return an instance) or anywhere that you are altering the state of an object.</p>\n\n<pre><code>class Book \n\n  def initialize(title, author)\n    @title = title\n    self.author = author # calls the setter.\n  end\n\n  # A factory method\n  def create_from_csv(filename)\n    # ...\n  end\n\n  # A very contrived setter\n  def author=(author)\n    @author = \"#{author.forename.upcase}. #{author.surname}\"\n  end\n\n  # a mutator\n  def out_of_print!\n    @out_of_print = true\n    @last_printed = Date.today\n  end\nend\n</code></pre>\n\n<p>However the <code>initialize</code> method is where you should handle initializing your objects (duuh) and is thus the obvious place to set initial values. </p>\n"}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2307, "favorite_count": 1, "accepted_answer_id": 54195397, "answer_count": 3, "score": 4, "last_activity_date": 1547637582, "creation_date": 1547526269, "last_edit_date": 1547529015, "question_id": 54192677, "link": "https://stackoverflow.com/questions/54192677/declaring-an-instance-variable-outside-of-initialize-method", "title": "Declaring an instance variable outside of `initialize` method", "body": "<p>I have been taught to declare my instance variables with <code>def initialize</code>. I have been under the impression that I could declare instance variables only within my <code>initialize</code> methods.</p>\n\n<p>Nevertheless, I declared an instance variable <code>@foo</code> outside my <code>initialize</code> method, and made it work as I intended:</p>\n\n<pre><code>class FooBar\n    def initialize(bar)\n        @bar = bar\n    end\n\n    def foo_as_instance_var\n        @foo = @bar.split(' ')\n        @foo\n    end\nend\n\nx = \"something wicked this way comes\"\ny = FooBar.new(x)\nputs y.foo_as_instance_var\n</code></pre>\n\n<p>Why am I able to declare an instance variable outside of <code>initialize</code> method?  Since I can declare instance variables in any method, is there a best practices rule I should follow, regarding where to declare instance variables (i.e., declare them within <code>initialize</code>) or does it not matter?</p>\n"}, {"tags": ["ruby", "math", "pi"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1547524804, "post_id": 54192497, "comment_id": 95212568, "body": "Not clear what you mean. How can a constant PI depend on a variable x? And what does x represent in the first place?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547524850, "post_id": 54192497, "comment_id": 95212579, "body": "Change <code>sin(num)</code> to <code>Math.sum(num)</code>. See <a href=\"http://ruby-doc.org/core-2.5.1/Math.html#method-c-sin\" rel=\"nofollow noreferrer\">Math::sim</a>. I have not checked for other mistakes."}, {"owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547525267, "post_id": 54192497, "comment_id": 95212678, "body": "@CarySwoveland, how <code>sum</code> is related to this question at all? The question is obviously about the sine trigonometric function"}, {"owner": {"reputation": 25, "user_id": 7422610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77869c14da7bbb70331b2f69656ce63?s=128&d=identicon&r=PG&f=1", "display_name": "Blair Lane", "link": "https://stackoverflow.com/users/7422610/blair-lane"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1547525322, "post_id": 54192497, "comment_id": 95212695, "body": "@sawa x is imputed by the user. I got the equation from <a href=\"https://www.wikihow.com/Calculate-Pi\" rel=\"nofollow noreferrer\">wikihow.com/Calculate-Pi</a>  Method #4"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1547525461, "post_id": 54192497, "comment_id": 95212727, "body": "@SergGr, I thought I had corrected that before posting. I meant to just make the point that <code>sin</code> is a module method of <code>Math</code>."}, {"owner": {"reputation": 1105, "user_id": 8408461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRqhA.jpg?s=128&g=1", "display_name": "Bob Jacobsen", "link": "https://stackoverflow.com/users/8408461/bob-jacobsen"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1547525568, "post_id": 54192497, "comment_id": 95212747, "body": "@sawa it\u2019s a mathematical identity that sin(x)/x goes to 1 as x goes to infinity, where sin() is the usual radians function. This is the somewhat different case where sin expects degrees, hence is pi/180 different."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1105, "user_id": 8408461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRqhA.jpg?s=128&g=1", "display_name": "Bob Jacobsen", "link": "https://stackoverflow.com/users/8408461/bob-jacobsen"}, "edited": false, "score": 0, "creation_date": 1547526682, "post_id": 54192497, "comment_id": 95213003, "body": "@Bob, I am hesitant to question a professor at my alma mater (go, Bears!), but don&#39;t you mean <code>x*sin(1&#47;x)</code> approaches <code>1</code> as <code>x -&gt;  \u221e</code>?"}, {"owner": {"reputation": 1105, "user_id": 8408461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRqhA.jpg?s=128&g=1", "display_name": "Bob Jacobsen", "link": "https://stackoverflow.com/users/8408461/bob-jacobsen"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547527093, "post_id": 54192497, "comment_id": 95213097, "body": "@CarySwoveland good catch, thanks. I actually intended as x-&gt; 0, which is the OPs case."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547527214, "post_id": 54192497, "comment_id": 95213126, "body": "Blair, you don&#39;t need to <code>include Math</code>, at least in MRI. (It&#39;s part of the Ruby core.)"}, {"owner": {"reputation": 25, "user_id": 7422610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77869c14da7bbb70331b2f69656ce63?s=128&d=identicon&r=PG&f=1", "display_name": "Blair Lane", "link": "https://stackoverflow.com/users/7422610/blair-lane"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547527618, "post_id": 54192497, "comment_id": 95213201, "body": "@CarySwoveland Okay sweet thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7422610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77869c14da7bbb70331b2f69656ce63?s=128&d=identicon&r=PG&f=1", "display_name": "Blair Lane", "link": "https://stackoverflow.com/users/7422610/blair-lane"}, "edited": false, "score": 0, "creation_date": 1547525619, "post_id": 54192566, "comment_id": 95212755, "body": "Thanks so much for explaining. I never knew the angle had to be in radians."}], "tags": [], "owner": {"reputation": 1105, "user_id": 8408461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRqhA.jpg?s=128&g=1", "display_name": "Bob Jacobsen", "link": "https://stackoverflow.com/users/8408461/bob-jacobsen"}, "is_accepted": true, "score": 3, "last_activity_date": 1547534874, "last_edit_date": 1547534874, "creation_date": 1547525122, "answer_id": 54192566, "question_id": 54192497, "link": "https://stackoverflow.com/questions/54192497/calculate-the-value-of-pi-using-pi-x-sin180-x/54192566#54192566", "title": "Calculate the value of PI using `pi = x * sin(180 / x)`", "body": "<p>Your equation is for a calculation of the sin of an angle in degrees.</p>\n\n<p>Most, maybe all, computer language sin() functions expect the angle to be in radians. </p>\n\n<p>Unfortunately, you need to have a value for pi to convert from one to another, so unless you can find a sin-in-degrees implementation you\u2019re somewhat stuck. </p>\n\n<p>This is because your formula comes from the 2\u00d7\u03c0/360 or \u03c0/180 conversion between radians and degrees. </p>\n"}], "owner": {"reputation": 25, "user_id": 7422610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77869c14da7bbb70331b2f69656ce63?s=128&d=identicon&r=PG&f=1", "display_name": "Blair Lane", "link": "https://stackoverflow.com/users/7422610/blair-lane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 54192566, "answer_count": 1, "score": 0, "last_activity_date": 1547534874, "creation_date": 1547524552, "last_edit_date": 1547525576, "question_id": 54192497, "link": "https://stackoverflow.com/questions/54192497/calculate-the-value-of-pi-using-pi-x-sin180-x", "title": "Calculate the value of PI using `pi = x * sin(180 / x)`", "body": "<p>I have a problem using <code>sin</code>. I did:</p>\n\n<pre><code>include Math\n\nputs sin(5) # =&gt; -0.9589242746631385\n</code></pre>\n\n<p>But when I type <code>sin(5)</code> into my calculator, it outputs <code>0.087155742</code>. Likewise, I tried to calculate the value of PI using the equation pi = x * sin(180 / x) and got a problem although I got the value of PI with it on my calculator.</p>\n\n<pre><code>include Math\n\nputs \"Enter the value of x\"\nx = gets.to_f\nnum = 180 / x\n\npie = x * sin(num)\nputs pie\n</code></pre>\n\n<p>Thanks if anyone can help.</p>\n"}, {"tags": ["ruby", "curl", "sinatra", "gzip", "zlib"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 3, "last_activity_date": 1547535978, "last_edit_date": 1547535978, "creation_date": 1547533656, "answer_id": 54193713, "question_id": 54192368, "link": "https://stackoverflow.com/questions/54192368/how-to-read-a-gzip-payload-in-ruby-sinatra/54193713#54193713", "title": "How to read a GZIP payload in Ruby Sinatra", "body": "<p>Assuming a YAML sample like the following:</p>\n\n<pre><code>martin:\n    name: Martin D'vloper\n    job: Developer\n    skill: Elite\n</code></pre>\n\n<p>You don't need all the excess <code>StringIO</code> stuff. <code>request.body</code> is already a <code>StringIO</code> instance, so converting it to a string then converting that to a <code>StringIO</code> is unnecessary:</p>\n\n<pre><code>require 'sinatra'\nrequire 'zlib'\n\npost '/last_run_report' do\n  gz = Zlib::GzipReader.new(request.body).read\n  puts YAML.load(gz)\nend\n</code></pre>\n\n<p>Now make your request:</p>\n\n<pre><code>curl -i localhost:4567/last_run_report -H \"Content-Type: application/xml\" -H \"Content-Encoding: gzip\" --data-binary @test.gz\n</code></pre>\n\n<p>And view the sinatra output:</p>\n\n<pre><code>== Sinatra (v2.0.4) has taken the stage on 4567 for development with backup from Thin\nThin web server (v1.7.2 codename Bachmanity)\nMaximum connections set to 1024\nListening on localhost:4567, CTRL+C to stop\n{\"martin\"=&gt;{\"name\"=&gt;\"Martin D'vloper\", \"job\"=&gt;\"Developer\", \"skill\"=&gt;\"Elite\"}}\n::1 - - [14/Jan/2019:23:24:28 -0700] \"POST /last_run_report HTTP/1.1\" 200 - 0.0048\n</code></pre>\n\n<p>Note that <code>puts</code> has written <code>{\"martin\"=&gt;{\"name\"=&gt;\"Martin D'vloper\", \"job\"=&gt;\"Developer\", \"skill\"=&gt;\"Elite\"}}</code> to the console.</p>\n\n<p>I should point out that in your example the following code does not work the way you expect:</p>\n\n<pre><code>sio = StringIO.new(request.body.to_s)\n</code></pre>\n\n<p>You expect to be able to call <code>sio.read</code> and get something like this:</p>\n\n<pre><code>\\x1F\\x8B\\b\\b\\xA7z=\\\\\\x00\\x03test.yaml\\x00SVp\\xCCSH\\xCD-\\xC8\\xC9\\xAFLMU(JM\\xCE/J\\xE1\\xCAM,*\\xC9\\xCC\\xB3\\xE2R\\x00\\x82\\xBC\\xC4\\xDCT+\\x05_\\xB0\\x88\\x82\\x8BzYN~Aj\\x11X&amp;+?\\xC9J\\xC1%\\xB5,\\x15!T\\x9C\\x9D\\x99\\x93c\\xA5\\xE0\\x9A\\x93Y\\x92\\n\\x00\\xFC\\xA0\\x83yZ\\x00\\x00\\x00\n</code></pre>\n\n<p>What you in fact get is this:</p>\n\n<pre><code>#&lt;StringIO:0x00007ffd8184bdf0&gt;\n</code></pre>\n\n<p>Note that this is the literal string \"<code>#&lt;StringIO:0x00007ffd8184bdf0&gt;</code>\" and not a reference to a <code>StringIO</code> object, because that is what is returned when calling <code>.to_s</code> on a <code>StringIO</code> object like <code>request.body</code>, so any subsequent call to <code>sio.read</code> (which is implicit in the call to <code>Zlib::GzipReader.new</code>) will return that literal string and will not return the gzipped data that you expect it to return, which leads to the error <code>Zlib::GzipFile::Error: not in gzip format</code>.</p>\n\n<p>When you want to return the string representation of a <code>StringIO</code> you should call <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/stringio/rdoc/StringIO.html#method-i-string\" rel=\"nofollow noreferrer\"><code>.string</code></a> or <a href=\"https://ruby-doc.org/core-2.6/IO.html#method-i-read\" rel=\"nofollow noreferrer\"><code>.read</code></a>, not <code>.to_s</code>. With that in mind, the minimal change required to make your first example work is to change this:</p>\n\n<pre><code>sio = StringIO.new(request.body.to_s)\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>sio = StringIO.new(request.body.string)\n</code></pre>\n\n<p>But again, this is an unnecessary conversion of a <code>StringIO</code> to a string and back to a <code>StringIO</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 54193713, "answer_count": 1, "score": 1, "last_activity_date": 1547535978, "creation_date": 1547523384, "question_id": 54192368, "link": "https://stackoverflow.com/questions/54192368/how-to-read-a-gzip-payload-in-ruby-sinatra", "title": "How to read a GZIP payload in Ruby Sinatra", "body": "<p>On a remote host I have a bash script sending a simple gzipped YAML file to my Ruby Sinatra endpoint:</p>\n\n<pre><code>#!/bin/bash\n\n/bin/gzip -c /tmp/test.yaml &gt; /tmp/test.gz\n\ncurl -i &lt;hostname&gt;:&lt;port&gt;/last_run_report -H \"Content-Type: application/xml\" -H \"Content-Encoding: gzip\" --data-binary @/tmp/test.gz\n</code></pre>\n\n<p>My sample Ruby app is:</p>\n\n<pre><code>require 'sinatra'\nrequire 'zlib'\nrequire 'stringio'\n\nset :port, &lt;port&gt;\nset :bind, \"&lt;ip&gt;\"\n\npost '/last_run_report' do\n  sio = StringIO.new(request.body.to_s)\n  gz = Zlib::GzipReader.new(sio).read\n  test_yaml = YAML.load(gz)\nend\n</code></pre>\n\n<p>This gives me the following error:</p>\n\n<pre><code>Zlib::GzipFile::Error: not in gzip format\n</code></pre>\n\n<p>If I require 'base64' and change the endpoint definition to:</p>\n\n<pre><code>post '/last_run_report' do\n  raw = Base64.decode64(request.body)\n  sio = StringIO.new(raw)\n  gz = Zlib::GzipReader.new(sio).read\n  test_yaml = YAML.load(gz)\nend\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>NoMethodError: undefined method `unpack1' for #&lt;StringIO:0x000055713e2d51b8&gt;\n</code></pre>\n\n<p>I can't figure out if I'm sending the data wrong or reading it wrong. Please help. </p>\n"}, {"tags": ["ruby", "regex"], "answers": [{"tags": [], "owner": {"reputation": 2960, "user_id": 8089674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29551894f595eb07cf3e8d4c27b36626?s=128&d=identicon&r=PG&f=1", "display_name": "Robo Mop", "link": "https://stackoverflow.com/users/8089674/robo-mop"}, "is_accepted": true, "score": 0, "last_activity_date": 1547528275, "last_edit_date": 1547528275, "creation_date": 1547527862, "answer_id": 54192836, "question_id": 54192280, "link": "https://stackoverflow.com/questions/54192280/how-to-extract-a-text-from-a-large-string-and-change-it/54192836#54192836", "title": "How to extract a text from a large string and change it", "body": "<p>You can try this out:</p>\n\n<pre><code>---(?:[\\n\\r]|.)*?(?&lt;=title: )([^\\n\\r]+)(?:[\\n\\r]|.)*?---\n</code></pre>\n\n<p>As demonstrated here: <strong><a href=\"https://regex101.com/r/9O99Fz/1/\" rel=\"nofollow noreferrer\">https://regex101.com/r/9O99Fz/1/</a></strong></p>\n\n<h1>Explanation -</h1>\n\n<p><code>(?:[\\n\\r]|.)*?</code> - after matching '---', the regex matches all characters until the next condition in the regex:<br>\n<code>(?&lt;=title: )</code> - this is a positive lookbehind that tells the regex to match the text which is preceded by <code>title:</code><br>\n<code>([^\\n\\r]+)</code> - since the title will be one sentence, this group matches the actual title you want by saying that it should not have a newline or carriage-return (this is the <strong>capturing group 1</strong>)<br>\n<code>(?:[\\n\\r]|.)*?---</code> just matches the last part of the 'details' section</p>\n\n<p><hr>\nAlso, in the substitution part, <code>\\1</code> is replaced by the title in the <strong>capturing group 1</strong>, and so the code should execute correctly :)</p>\n"}, {"tags": [], "owner": {"reputation": 60165, "user_id": 836330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fd5f542a64b8b2dac00112a4829de8?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/836330/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1547530863, "creation_date": 1547530863, "answer_id": 54193274, "question_id": 54192280, "link": "https://stackoverflow.com/questions/54192280/how-to-extract-a-text-from-a-large-string-and-change-it/54193274#54193274", "title": "How to extract a text from a large string and change it", "body": "<pre><code>---[\\s\\S]*?title:([^\\r\\n]*)[\\s\\S]*?---\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/SS3Orn/4\" rel=\"nofollow noreferrer\">https://regex101.com/r/SS3Orn/4</a></p>\n\n<ol>\n<li>1st capture group <code>([^\\r\\n]*)</code> : all characters up to newline after \"title:\"</li>\n<li><p>[\\s\\S]* all characters, including newlines, up to \"---\"</p></li>\n<li><p>Even works with multiple sample input on same page.</p></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 9698288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679d2f081484998b1b507bd1ebfbb791?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Gutierrez", "link": "https://stackoverflow.com/users/9698288/sebastian-gutierrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 54192836, "answer_count": 2, "score": -1, "last_activity_date": 1547530863, "creation_date": 1547522602, "last_edit_date": 1547524709, "question_id": 54192280, "link": "https://stackoverflow.com/questions/54192280/how-to-extract-a-text-from-a-large-string-and-change-it", "title": "How to extract a text from a large string and change it", "body": "<p>I have a lot of markdown files that have some front matter data. This is the content of one such file (layout, title, etc aren't always in the same order):</p>\n\n<pre><code>---\nlayout: post\ntitle: An awesome title\ndate: 2019-01-11 00:00:00\ndescription: My description goes here.\n---\n\nA lot of paraghaps bellow...\n</code></pre>\n\n<p>I need to change the format and keep only the title. I need this:</p>\n\n<pre><code># An awesome title\n\nA lot of paraghaps bellow...\n</code></pre>\n\n<p>I tried a few regex methods, but I can't make them work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "view", "devise", "edit"], "comments": [{"owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1547523605, "post_id": 54192264, "comment_id": 95212361, "body": "Yeah, I also tried that, it shows this following error:   &quot;undefined method `user_path&#39; for #&lt;#&lt;Class:0x007f50ec165488&gt;:0x007f50fe208e78&gt; Did you mean?  users_path&quot;"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1547524581, "post_id": 54192264, "comment_id": 95212525, "body": "Your controller"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1547525166, "post_id": 54192264, "comment_id": 95212649, "body": "post your controller"}, {"owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "edited": false, "score": 0, "creation_date": 1547525371, "post_id": 54192264, "comment_id": 95212707, "body": "controller given"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1547525971, "post_id": 54192264, "comment_id": 95212835, "body": "Your controller name?"}, {"owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "edited": false, "score": 0, "creation_date": 1547526180, "post_id": 54192264, "comment_id": 95212884, "body": "class Users::RegistrationsController &lt; Devise::RegistrationsController"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1547526927, "post_id": 54192264, "comment_id": 95213055, "body": "i am posted answer  its helpful?"}, {"owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "reply_to_user": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 1, "creation_date": 1547527464, "post_id": 54192264, "comment_id": 95213169, "body": "Checking bro. After finishing, I will give you an upvote and also mark your answer as accepted. Don&#39;t worry"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 1, "creation_date": 1547527559, "post_id": 54192264, "comment_id": 95213191, "body": "ok bro but its working me!..Ask me if your facing any error?"}, {"owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "reply_to_user": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1547528182, "post_id": 54192264, "comment_id": 95213314, "body": "ok bro, I had to moderate something for my code. But, thanks a lot, your code."}, {"owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "reply_to_user": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1547529698, "post_id": 54192264, "comment_id": 95213682, "body": "By the way bro, If I want to pass some parameter with this, do you know, how to do it?"}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1548914348, "post_id": 54192709, "comment_id": 95716601, "body": "<i>Its helpful pls up-vote!</i> ? Do not beg for votes ever in answer where you are not assured whether it helped OP or not also."}], "tags": [], "owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "is_accepted": true, "score": 1, "last_activity_date": 1548914441, "last_edit_date": 1548914441, "creation_date": 1547526622, "answer_id": 54192709, "question_id": 54192264, "link": "https://stackoverflow.com/questions/54192264/how-to-update-a-record-from-index-in-rails/54192709#54192709", "title": "How to update a record from index in rails", "body": "<p>In your controller, create two methods <code>activate</code> and <code>deactivate</code>.</p>\n\n<p>In controller,</p>\n\n<pre><code> def activate\n    @user = User.find_by(:id=&gt;params[:id])\n    @user.update(:closed=&gt;false)\n    redirect_to #your path\n  end\n\n  def deactivate\n    @user = User.find_by(:id=&gt;params[:id])\n    @user.update(:closed=&gt;true)\n    redirect_to #your path\n  end\n</code></pre>\n\n<p>Set your routes as,</p>\n\n<pre><code>patch '#yourcontroller/:id/activate',to:'#yourcontroller#activate' , as: :activate\npatch '#yourcontroller/:id/deactivate',to:'#yourcontroller#deactivate' ,as: :deactivate\n</code></pre>\n\n<p>and finally do changes in your view as,</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n           &lt;tr&gt;\n             &lt;td&gt; &lt;%= user.last_name %&gt;&lt;/td&gt;\n             &lt;td&gt; &lt;%= user.telephone %&gt;&lt;/td&gt;\n             &lt;td&gt; &lt;%if user.closed?%&gt;\n                  &lt;%= link_to 'activate',activate_path(id:user.id), method: :patch%&gt;\n                 &lt;%else%&gt;  \n                  &lt;%= link_to 'deactivate',deactivate_path(id:user.id), method: :patch%&gt;\n                  &lt;% end -%&gt; &lt;/td&gt;\n                  &lt;%= link_to 'Remove', user_destroy_path(user), method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n              &lt;% end %&gt;\n</code></pre>\n\n<p>Its helpful pls up-vote! </p>\n"}], "owner": {"reputation": 771, "user_id": 4464547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SU8yD.jpg?s=128&g=1", "display_name": "Tazwar Utshas", "link": "https://stackoverflow.com/users/4464547/tazwar-utshas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 54192709, "answer_count": 1, "score": 2, "last_activity_date": 1548914441, "creation_date": 1547522397, "last_edit_date": 1547525343, "question_id": 54192264, "link": "https://stackoverflow.com/questions/54192264/how-to-update-a-record-from-index-in-rails", "title": "How to update a record from index in rails", "body": "<p>I was trying to update a User record (only the \"closed\" named column) from the user index's view. This is what I tried. But, it is not working. I used Devise gem to generate views and controllers. But, whatever, How can I update a records one particular value, directly from index(without going to edit's view). It would be very helpful, if someone would help me.</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n                &lt;tr&gt;\n                  &lt;td&gt; &lt;%= user.last_name %&gt;&lt;/td&gt;\n                  &lt;td&gt; &lt;%= user.telephone %&gt;&lt;/td&gt;\n                  &lt;td&gt; &lt;%= form_for user do |f| %&gt;\n                    &lt;% if user.closed %&gt;\n                      &lt;%= f.hidden_field :closed, value: false %&gt;\n                      &lt;%= f.submit \"Activate\" %&gt;\n                      &lt;% else %&gt;\n                        &lt;%= f.hidden_field :closed, value: true %&gt;\n                        &lt;%= f.submit \"Deactivate\" %&gt;\n                      &lt;% end %&gt;\n                  &lt;% end %&gt; &lt;/td&gt;\n                      &lt;%= link_to 'Remove', user_destroy_path(user), method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n              &lt;% end %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>def user_index\n    if current_user.admin?\n      if params[:user_search].present?\n        @users = User.search_user(params[:user_search]).super_admin\n      else\n        @users = User.super_admin\n      end\n    else\n      if params[:user_search].present?\n        @users = User.search_user(params[:user_search]).admin\n      else\n        @users = User.admin\n      end\n    end\n    respond_to do |format|\n      format.html\n      format.csv { send_data User.to_csv, type: 'text/csv', filename: \"users.csv\" }\n    end\n  end\n</code></pre>\n\n<p>here is my controller. Actually there is also something done to search the users</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 2, "creation_date": 1547520486, "post_id": 54192058, "comment_id": 95211817, "body": "when I execute your code, I see <code>h4</code> in my output"}, {"owner": {"reputation": 23, "user_id": 3355226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66426009b8a0d90d6184850184ba856b?s=128&d=identicon&r=PG&f=1", "display_name": "tomoyuki-kosaka", "link": "https://stackoverflow.com/users/3355226/tomoyuki-kosaka"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1547525916, "post_id": 54192058, "comment_id": 95212818, "body": "Uhh. I see. Year, previous try I also get such kind of results. Which version of ruby and CSV gem using in your computer? I&#39;m using ruby 2.6.0 and CSV 3.0.2."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1547526609, "post_id": 54192058, "comment_id": 95212981, "body": "ruby 2.5.3p105 and CSV 1.0.0"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1547532379, "post_id": 54192058, "comment_id": 95214269, "body": "I am using lower version than what @LeninRajRajasekaran is using, worked properly! If it is really bug then you should raise it on github."}, {"owner": {"reputation": 23, "user_id": 3355226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66426009b8a0d90d6184850184ba856b?s=128&d=identicon&r=PG&f=1", "display_name": "tomoyuki-kosaka", "link": "https://stackoverflow.com/users/3355226/tomoyuki-kosaka"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1547534770, "post_id": 54192058, "comment_id": 95214869, "body": "Thank you @ray. I&#39;ll try to raise a pull request."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547540316, "post_id": 54192058, "comment_id": 95216848, "body": "The last version that worked as expected was version 3.0.0. Consider reviewing <a href=\"https://github.com/ruby/csv/compare/153d261...1176a56\" rel=\"nofollow noreferrer\">the commits between 3.0.0 and 3.0.1</a>."}, {"owner": {"reputation": 23, "user_id": 3355226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66426009b8a0d90d6184850184ba856b?s=128&d=identicon&r=PG&f=1", "display_name": "tomoyuki-kosaka", "link": "https://stackoverflow.com/users/3355226/tomoyuki-kosaka"}, "edited": false, "score": 1, "creation_date": 1547544626, "post_id": 54192058, "comment_id": 95218819, "body": "I raise this as <a href=\"https://github.com/ruby/csv/issues/71\" rel=\"nofollow noreferrer\">issue #71</a>."}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1547870825, "creation_date": 1547870825, "answer_id": 54263970, "question_id": 54192058, "link": "https://stackoverflow.com/questions/54192058/how-to-refresh-the-headers-of-csvtable/54263970#54263970", "title": "How to refresh the headers of CSV::Table?", "body": "<p>Your <a href=\"https://github.com/ruby/csv/issues/71\" rel=\"nofollow noreferrer\">GitHub issue</a> has been resolved by the author. You can install the gem from GitHub and it will work the way you expect.</p>\n\n<p>The problem is that you can't easily install the gem with <code>gem install</code>. (unless you clone the repo and build the gem and install the gem from your filesystem, but that is not a portable solution) And if you can't use <code>gem install</code> then you can't use <code>require 'csv'</code> because that will just use the bugged version that you already have installed. (similarly, cloning the repo and using <code>require '/path/to/csv-3.0.4'</code> is not a portable solution)</p>\n\n<p>A workaround is to use bundler to install the fixed gem into your bundle path:</p>\n\n<pre><code># Gemfile\ngem 'csv', git: 'https://github.com/ruby/csv.git', ref: '7ede8e84a2b8'\n</code></pre>\n\n<p>Then run <code>bundle install</code>:</p>\n\n<pre><code>Fetching https://github.com/ruby/csv.git\nResolving dependencies...\nUsing bundler 1.17.2\nUsing csv 3.0.4 from https://github.com/ruby/csv.git (at 7ede8e8@7ede8e8)\nBundle complete! 1 Gemfile dependency, 2 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n</code></pre>\n\n<p>And run <code>bundle info csv</code> to confirm:</p>\n\n<pre><code>bundle info csv\n  * csv (3.0.4 7ede8e8)\n    Summary: CSV Reading and Writing\n    Homepage: https://github.com/ruby/csv\n    Path: /Users/foo/.rvm/gems/ruby-2.6.0/bundler/gems/csv-7ede8e84a2b8\n</code></pre>\n\n<p>Next, change your script to use bundler to load the gems and specify the version of the gem you want to use:</p>\n\n<pre><code># test.rb\nrequire 'bundler/setup'\nBundler.require :default\ngem 'csv', '=3.0.4'\n\nputs CSV::VERSION\n</code></pre>\n\n<p>(you don't call <code>require 'csv'</code>; bundler does this for you)</p>\n\n<p>Then run <code>ruby test.rb</code> and verify it's using the version of the gem you expect:</p>\n\n<pre><code>3.0.4\n</code></pre>\n\n<p>Now modify <code>test.rb</code> to include your original code:</p>\n\n<pre><code>require 'bundler/setup'\nBundler.require :default\ngem 'csv', '=3.0.4'\n\ntxt =&lt;&lt;TXT\n\"h1\",\"h2\",\"h3\"\n1,\"test\",3\n2,\"test\",6\n3,\"test\",9\nTXT\n\ntable = CSV::parse(txt, headers: true)\n\nputs table.to_csv + \"\\n\"\n\ntable.each do |row|\n  row &lt;&lt; {\"h4\" =&gt; \"additional\"}\nend\n\nputs table.to_csv\n</code></pre>\n\n<p>And run with <code>ruby test.rb</code>:</p>\n\n<pre><code>h1,h2,h3\n1,test,3\n2,test,6\n3,test,9\n\nh1,h2,h3,h4\n1,test,3,additional\n2,test,6,additional\n3,test,9,additional\n</code></pre>\n\n<p>Now you have a portable solution that will run on any system and load the gem from the git repo at the commit where this fix was implemented.</p>\n"}], "owner": {"reputation": 23, "user_id": 3355226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66426009b8a0d90d6184850184ba856b?s=128&d=identicon&r=PG&f=1", "display_name": "tomoyuki-kosaka", "link": "https://stackoverflow.com/users/3355226/tomoyuki-kosaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547870825, "creation_date": 1547520368, "last_edit_date": 1547537371, "question_id": 54192058, "link": "https://stackoverflow.com/questions/54192058/how-to-refresh-the-headers-of-csvtable", "title": "How to refresh the headers of CSV::Table?", "body": "<p>Is there any good way for refreshment of headers in CSV::Table object?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'csv'\n\ntxt =&lt;&lt;TXT\n\"h1\",\"h2\",\"h3\"\n1,\"test\",3\n2,\"test\",6\n3,\"test\",9\nTXT\n\ntable = CSV::parse(txt, headers: true)\ntable.each do |row|\n  row &lt;&lt; {\"h4\" =&gt; \"additional\"}\nend\nputs table.to_csv\n</code></pre>\n\n<p><strong>actual</strong></p>\n\n<pre><code>h1, h2,   h3  \n1,  test, 3,  additional  \n2,  test, 6,  additional  \n3,  test, 9,  additional  \n</code></pre>\n\n<p><strong>expected</strong></p>\n\n<pre><code>h1, h2,   h3, h4  \n1,  test, 3,  additional  \n2,  test, 6,  additional  \n3,  test, 9,  additional  \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 0, "creation_date": 1547515145, "post_id": 54191443, "comment_id": 95210748, "body": "When you say &quot;nothing shows up&quot; do you mean just the part where you call <code>will_paginate &quot;teams&quot;</code> or the entire view in general?"}, {"owner": {"reputation": 87, "user_id": 10686438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mDlr5ba1iuE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSPgmEAs1DoxxJETccLcvn6iUPDQ/mo/photo.jpg?sz=128", "display_name": "kevin lopez", "link": "https://stackoverflow.com/users/10686438/kevin-lopez"}, "reply_to_user": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 0, "creation_date": 1547515286, "post_id": 54191443, "comment_id": 95210771, "body": "just the part where i call the will_paginate function the rest of the view renders fine"}, {"owner": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 0, "creation_date": 1547515702, "post_id": 54191443, "comment_id": 95210852, "body": "Have you tried running the query in the rails console:  <code>CareTeam.all.order(&#39;created_at ASC&#39;).paginate(page: params[:page], per_page: 10)</code>  Replace <code>params[:page]</code> with what is being passed in by the controller."}, {"owner": {"reputation": 87, "user_id": 10686438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mDlr5ba1iuE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSPgmEAs1DoxxJETccLcvn6iUPDQ/mo/photo.jpg?sz=128", "display_name": "kevin lopez", "link": "https://stackoverflow.com/users/10686438/kevin-lopez"}, "reply_to_user": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 0, "creation_date": 1547515792, "post_id": 54191443, "comment_id": 95210875, "body": "Yes i ran it and return &quot;undefined local variable or method `params&#39; for main:Object&quot;"}, {"owner": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 0, "creation_date": 1547515849, "post_id": 54191443, "comment_id": 95210891, "body": "Sorry, made a ninja edit, replace <code>params[:page]</code> with what is being passed in by the controller."}, {"owner": {"reputation": 87, "user_id": 10686438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mDlr5ba1iuE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSPgmEAs1DoxxJETccLcvn6iUPDQ/mo/photo.jpg?sz=128", "display_name": "kevin lopez", "link": "https://stackoverflow.com/users/10686438/kevin-lopez"}, "reply_to_user": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 0, "creation_date": 1547515992, "post_id": 54191443, "comment_id": 95210932, "body": "how would i know whats being passed in by the controller ? im a little confused"}, {"owner": {"reputation": 87, "user_id": 10686438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mDlr5ba1iuE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSPgmEAs1DoxxJETccLcvn6iUPDQ/mo/photo.jpg?sz=128", "display_name": "kevin lopez", "link": "https://stackoverflow.com/users/10686438/kevin-lopez"}, "reply_to_user": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "edited": false, "score": 1, "creation_date": 1547516886, "post_id": 54191443, "comment_id": 95211103, "body": "SOLVED will paginate assumes there are more than 1 records in your DB, i created more records and it works fine"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1547540249, "post_id": 54191443, "comment_id": 95216822, "body": "will_paginate works fine with no records, one records or more than one records, so your &quot;SOLVED&quot; is accidental and nothing to do with the number of records."}], "owner": {"reputation": 87, "user_id": 10686438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mDlr5ba1iuE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gSPgmEAs1DoxxJETccLcvn6iUPDQ/mo/photo.jpg?sz=128", "display_name": "kevin lopez", "link": "https://stackoverflow.com/users/10686438/kevin-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547537327, "creation_date": 1547514863, "last_edit_date": 1547537327, "question_id": 54191443, "link": "https://stackoverflow.com/questions/54191443/pagination-ruby-on-rails-with-will-paginate", "title": "pagination ruby on rails with will_paginate", "body": "<p>Hey guys I am trying to implement pagination using the <code>will_paginate</code> gem, and it doesn't seem to be working. I have added the gem to my <code>Gemfile</code> and tried the code below:</p>\n\n<p><strong>controller</strong></p>\n\n<pre><code> def team_search  \n   @teams = CareTeam.all.order('created_at ASC').paginate(page:params[:page], per_page: 10)\n end\n</code></pre>\n\n<p><strong>view</strong></p>\n\n<pre><code>    &lt;h1&gt;Search for a team&lt;/h1&gt;\n    &lt;p&gt;search for a team by team name&lt;/p&gt;\n    &lt;%= form_tag search_team_results_path, :method =&gt; 'get' do %&gt;\n      &lt;%= text_field_tag :search, params[:search], placeholder: \n      \"Search Teams By name\", required: true %&gt;\n     &lt;%= submit_tag \"Search\", :name =&gt; nil %&gt;\n   &lt;% end %&gt;\n\n   &lt;%= will_paginate @teams %&gt;\n</code></pre>\n\n<p><strong>model</strong></p>\n\n<pre><code>   def self.search(team_name)\n      if team_name\n        team_name.downcase!\n        self.where('LOWER(team_name) LIKE ?', \"%#{team_name}%\").order('created_at ASC')\n      else\n        CareTeam.all.order('created_at ASC')\n       end\n    end\n</code></pre>\n\n<p>When I navigate to my view, nothing shows up. Does anyone analyse from above what could be wrong?</p>\n"}, {"tags": ["ruby", "yaml"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547514580, "post_id": 54191271, "comment_id": 95210659, "body": "According to the YAML structure you can&#39;t just access it with <code>0</code> as a key, the only key defined is <code>&#39;guess_array&#39;</code>. You can&#39;t access <code>guess_array</code> as a method call, or any of those other things since those methods don&#39;t exist."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1547514897, "post_id": 54191271, "comment_id": 95210702, "body": "Seconding tadman, this script you show will not produce the output you claim"}, {"owner": {"reputation": 35, "user_id": 10297925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad24845ff29f129446a6176863a26f69?s=128&d=identicon&r=PG&f=1", "display_name": "zackclan", "link": "https://stackoverflow.com/users/10297925/zackclan"}, "edited": false, "score": 0, "creation_date": 1547514997, "post_id": 54191271, "comment_id": 95210718, "body": "So you&#39;re comment led me to the solution, the variables that were interpreting wrong had class methods with the same name, as soon as I changed the name of the class methods everything was interpreted correctly."}], "owner": {"reputation": 35, "user_id": 10297925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad24845ff29f129446a6176863a26f69?s=128&d=identicon&r=PG&f=1", "display_name": "zackclan", "link": "https://stackoverflow.com/users/10297925/zackclan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547513353, "creation_date": 1547513353, "question_id": 54191271, "link": "https://stackoverflow.com/questions/54191271/yaml-load-is-not-interpreting-every-variable-correctly", "title": "YAML load is not interpreting every variable correctly", "body": "<p>I have some code trying to load some variables to a hangman game i'm making</p>\n\n<pre><code>begin\n    yaml = YAML.load_file(\"./hangman.yml\")\n    print yaml[0].guess_array               \n    print yaml[0].turn_count                \n    print yaml[0].guessed_letters                \n    print yaml[0].check_word                \n    print yaml[0].word\nend\n</code></pre>\n\n<p>but for some reason it's incorrectly loading a few variables\nthe guess_array yaml is</p>\n\n<pre><code>guess_array:\n- p\n- a\n- n\n- e\n- _\n- _\n- _\n- _ \n</code></pre>\n\n<p>but when it prints out in the file I get</p>\n\n<pre><code>[\"_\", \"_\", \"_\", \"_\", \"_\", \"_\", \"_\", \"_\"]\n</code></pre>\n\n<p>It's also incorrectly interpreting a couple more but I'm hoping there's a mistake i'm making that will fix all of these.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1547519447, "post_id": 54190974, "comment_id": 95211640, "body": "Do you see any thing wrong with my code that could possibily lead to why :provider_id is coming back nil? I also update my code to what i recently have right now. There is also a image of the error"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "edited": false, "score": 0, "creation_date": 1547517348, "post_id": 54191124, "comment_id": 95211205, "body": "Thanks for the response. I have checked my routes and i have tried using params[:id] in my patient_access method in the controller but it&#39;s still coming back as nil"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "edited": false, "score": 0, "creation_date": 1547550267, "post_id": 54191124, "comment_id": 95221809, "body": "Can you show us the incoming parameters by placing <code>byebug</code> as the first line of your <i>index</i> method? Then when the execution stops type <code>params</code>. Copy the output here in the comments, or add it to the question. To continue execution type <code>c</code>."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "edited": false, "score": 0, "creation_date": 1547564607, "post_id": 54191124, "comment_id": 95229848, "body": "I also noticed you edited the question and changed the routes, so I&#39;m not sure if this answer still applies. From the <a href=\"https://i.stack.imgur.com/6YMwt.png\" rel=\"nofollow noreferrer\">image</a> that you provided you can tell that <code>@provider</code> isn&#39;t set. That&#39;s whats raises the current error."}, {"owner": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "edited": false, "score": 0, "creation_date": 1547571151, "post_id": 54191124, "comment_id": 95233647, "body": "the same answer still applies. I trying to see if it was something with my route but i guess it&#39;s not. here is the output of when i select params &quot;&lt;ActionController::Parameters {&quot;controller&quot;=&gt;&quot;patients&quot;, &quot;action&quot;=&gt;&quot;index&quot;} permitted: false&gt;&quot;"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "edited": false, "score": 0, "creation_date": 1547579449, "post_id": 54191124, "comment_id": 95237471, "body": "I didn&#39;t notice the image attached to the question when writing the answer. From what is shown it seems like you don&#39;t set <code>@provider</code> correctly in <b><i>PatientsController#index</i></b>. Could you add the contents of the method to the question? You are currently showing the content of <i>PatientAccessController#index</i>."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 2, "last_activity_date": 1547513561, "last_edit_date": 1547513561, "creation_date": 1547511934, "answer_id": 54191124, "question_id": 54190974, "link": "https://stackoverflow.com/questions/54190974/cant-find-params-id/54191124#54191124", "title": "Cant find params (id)", "body": "<p>With those routes set up the path is going to be:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/providers/:id/patient_access(.format)\n</code></pre>\n\n<p>For this reason <code>params[:provider_id]</code> returns <code>nil</code> since it isn't provided, however <code>params[:id]</code> should return the correct value.</p>\n\n<p>You can check your routes by visiting a non-existent URL/route in the development environment. For example <a href=\"http://localhost:3000/asdf\" rel=\"nofollow noreferrer\">http://localhost:3000/asdf</a>. Or you can output them into the terminal using the command:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>bundle exec rails routes\n</code></pre>\n\n<p>For more details about routing check the guide <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">Rails Routing from the Outside In</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10914502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16142499d9bb2c0fb5a2a0b21801bec5?s=128&d=identicon&r=PG&f=1", "display_name": "manny steele", "link": "https://stackoverflow.com/users/10914502/manny-steele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547579152, "creation_date": 1547510567, "last_edit_date": 1547579152, "question_id": 54190974, "link": "https://stackoverflow.com/questions/54190974/cant-find-params-id", "title": "Cant find params (id)", "body": "<p>Not really sure what going on or why the the provider id is comming back nil and it only comes back nil when trying to render provider_patient_access_path. I add a new pages to providers so the way it should be is localhost:3000/providers/id/patient_access </p>\n\n<p><a href=\"https://i.stack.imgur.com/6YMwt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6YMwt.png\" alt=\"error message\"></a></p>\n\n<pre><code>   &lt;!-- PROVIDERS SIDE MENU --&gt;\n\n    &lt;%= link_to provider_patient_access_index_path(@provider.id) do %&gt;\n        &lt;div class=\"side-menu-item\"&gt;\n        &lt;div class=\"side-menu-icon\" data-id=\"&lt;%= @provider.id %&gt;\"&gt;&lt;div id=\"side-menu-icon-search\"&gt;&lt;/div&gt;&lt;/div&gt;\n        &lt;div id=\"side-menu-item-text-patient-profiles\" class=\"side-menu-item-text\"&gt;Patient Access&lt;/div&gt;\n        &lt;/div&gt;&lt;!--side-menu-item--&gt;\n    &lt;% end %&gt;\n\n    &lt;!-- ROUTES --&gt;\n    resources :providers do \n        resources :patient_access, only: [:index]\n    end\n\n    &lt;!-- PROVIDERS_CONTROLLER --&gt;\n   class PatientAccessController &lt; ApplicationController\n\n    def index\n        @provider = Provider.find(params[:provider_id])\n        @active_patients = @provider.lists\n        authorize @provider\n    end\nend\n    end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1547508538, "post_id": 54190642, "comment_id": 95209422, "body": "Maybe give this a shot: <a href=\"https://github.com/kaminari/kaminari\" rel=\"nofollow noreferrer\">github.com/kaminari/kaminari</a>"}, {"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "reply_to_user": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1547509333, "post_id": 54190642, "comment_id": 95209618, "body": "Yep that could work.. thanks! I also saw this.. <a href=\"https://stackoverflow.com/questions/16326855/rails-kaminari-how-to-order-a-paginated-array\" title=\"rails kaminari how to order a paginated array\">stackoverflow.com/questions/16326855/&hellip;</a> which sorts ALL the data before passing to Kaminari.. I&#39;ll try that!"}, {"owner": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1547509469, "post_id": 54190642, "comment_id": 95209643, "body": "Yep. Kaminari is really good. Enjoy coding. :)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547514750, "post_id": 54190642, "comment_id": 95210685, "body": "Don&#39;t pass in things like <code>sort_by</code> directly as interpolated strings. Instead: <code>sort_by =&gt; sort_order</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "edited": false, "score": 0, "creation_date": 1547740848, "post_id": 54198799, "comment_id": 95304113, "body": "datatables won&#39;t help at all to sort 100k elements, because it would need to have all the records downloaded to the browser."}, {"owner": {"reputation": 13, "user_id": 10289668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-abK3kRPyMQM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNQMwLAVnMNsisE24ocCHoz8zNu9A/mo/photo.jpg?sz=128", "display_name": "Rust Gold", "link": "https://stackoverflow.com/users/10289668/rust-gold"}, "reply_to_user": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "edited": false, "score": 0, "creation_date": 1547741349, "post_id": 54198799, "comment_id": 95304390, "body": "Guys, why did you down voted answer.You can get data using ajax also and don&#39;t need load data to browser. It gives you flexibility of sorting, filtering and downloading of files. You can refer below links for data tables using ajax  <a href=\"https://github.com/jbox-web/ajax-datatables-rails\" rel=\"nofollow noreferrer\">github.com/jbox-web/ajax-datatables-rails</a>"}, {"owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "edited": false, "score": 0, "creation_date": 1547741544, "post_id": 54198799, "comment_id": 95304477, "body": "The OP does not know how to apply sorting in DB. Even with datatables, you can set up an ajax endpoint, and you still need to provide your sorted <i>and</i> paginated results on the ajax response. The OP question is how to <i>actually</i> sort and paginate at the same time."}], "tags": [], "owner": {"reputation": 13, "user_id": 10289668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-abK3kRPyMQM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNQMwLAVnMNsisE24ocCHoz8zNu9A/mo/photo.jpg?sz=128", "display_name": "Rust Gold", "link": "https://stackoverflow.com/users/10289668/rust-gold"}, "is_accepted": false, "score": -1, "last_activity_date": 1547632943, "last_edit_date": 1547632943, "creation_date": 1547555022, "answer_id": 54198799, "question_id": 54190642, "link": "https://stackoverflow.com/questions/54190642/ruby-paginate-and-sort-across-a-large-number-of-records/54198799#54198799", "title": "Ruby: Paginate and sort across a large number of records", "body": "<p>You can resolve sorting and paginate issue using Data Tables library, which is client side. It's a Jquery library. Using this you need to load all data into page, then it would work very well.\nBelow are the references please check.\n<a href=\"https://datatables.net/\" rel=\"nofollow noreferrer\">Data tables jquery libray</a></p>\n\n<p><a href=\"https://github.com/rweng/jquery-datatables-rails\" rel=\"nofollow noreferrer\">Data tables gem for rails</a></p>\n\n<p>You can try these, they will work very well. You can customise it as well</p>\n\n<p>If the answer is helpful, you can accept it.</p>\n"}, {"tags": [], "owner": {"reputation": 14511, "user_id": 384417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966d07471c4adb05fed0e12d31e36584?s=128&d=identicon&r=PG", "display_name": "rewritten", "link": "https://stackoverflow.com/users/384417/rewritten"}, "is_accepted": false, "score": 0, "last_activity_date": 1547741433, "creation_date": 1547741433, "answer_id": 54239944, "question_id": 54190642, "link": "https://stackoverflow.com/questions/54190642/ruby-paginate-and-sort-across-a-large-number-of-records/54239944#54239944", "title": "Ruby: Paginate and sort across a large number of records", "body": "<p>You should actually sort at the model/query level, not at the ruby level.</p>\n\n<p>The difference is basically:</p>\n\n<pre><code># sort in ruby\nrelation.sort_by { |item| foo(item) }\n\n# sort in database - composes with pagination\nrelation.order('column_name ASC/DESC')\n</code></pre>\n\n<p>In the first case, the relation is implicitly executed, enumerated and converted to array <em>before</em> calling <code>sort_by</code>. If you did pagination (manually or with kaminari), you will get just that page of data.</p>\n\n<p>In the second case, you are actually composing the <code>limit</code>, <code>offset</code> and <code>where</code> (<code>limit</code> and <code>offset</code> are anyways used under the hood by kaminari, <code>where</code> is implicit when you use associations) with a <code>order</code> so your database would execute</p>\n\n<pre><code>SELECT `customers`.`*` FROM `customers`\n  WHERE ...\n  OFFSET ...\n  LIMIT ...\n  ORDER BY ...\n</code></pre>\n\n<p>which will return the correct data.</p>\n\n<p>A good option is to define scopes in the model, like</p>\n\n<pre><code>class Customer &lt; ApplicationRecord\n  scope :sorted_by_email, -&gt;(ascending = true) { order(\"email #{ascending ? 'ASC' : 'DESC'}\") }\nend\n\n# in controller\ncustomers = current_shop.customers.\n  limit(records_limit).\n  offset(records_offset).\n  sorted_by_email(false)\n</code></pre>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547741433, "creation_date": 1547508176, "question_id": 54190642, "link": "https://stackoverflow.com/questions/54190642/ruby-paginate-and-sort-across-a-large-number-of-records", "title": "Ruby: Paginate and sort across a large number of records", "body": "<p>When simply displaying large amounts of data (over 100k records) my code works well, and I paginate on the server.</p>\n\n<p>However, when I need to sort this data I'm stuck. I'm only sorting on the page, and NOT sorting on ALL the records related to this one customer.</p>\n\n<p>How can I paginate but also sort across all the records of my customer and NOT simply sort the records returned from the server side pagination?</p>\n\n<p>I'm also using <a href=\"https://bootstrap-table.wenzhixin.net.cn/\" rel=\"nofollow noreferrer\">BootStrap Table</a> to display all my data.</p>\n\n<p>Here is my code that gets all the customers:</p>\n\n<pre><code>  def get_customers\n    @data_to_return = []\n    @currency = current_shop.country_currency\n    customers = current_shop.customers.limit(records_limit).offset(records_offset)#.order(\"#{sort_by}\" \" \" \"#{sort_order}\")\n    customers.each do |customer|\n      @data_to_return.push(\n      state: false,\n      id: customer.id,\n      email: customer.email,\n      accepts_marketing: customer.accepts_marketing,\n      customer_status: customer.customer_status,\n      tags: customer.tags)\n    end\n    sort_customers\n  end\n</code></pre>\n\n<p>And then this is the <code>sort_customers</code> method:</p>\n\n<pre><code>  def sort_customers\n    fixed_data = data_to_return.sort_by {|hsh| hsh[sort_by]}\n    customer_size = current_shop.customers.length\n    if sort_order == \"ASC\"\n      fixed_data\n    else\n      fixed_data.reverse!\n    end\n    render json: {\"total\": customer_size, \"rows\": fixed_data}\n  end\n</code></pre>\n\n<p>In the above code you can see that <code>data_to_return</code> is coming from <code>get_customers</code> and its limited. But I don't want to return ALL the customers for many reasons.</p>\n\n<p>How can I sort across all the records, but only return the paginated subset?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 163297, "user_id": 418556, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/yOfDr.png?s=128&g=1", "display_name": "Andrew Thompson", "link": "https://stackoverflow.com/users/418556/andrew-thompson"}, "edited": false, "score": 0, "creation_date": 1615967757, "post_id": 54190247, "comment_id": 117852731, "body": "Please <a href=\"http://meta.stackexchange.com/a/5235/155831\">accept an answer</a> if it helped solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1547509151, "creation_date": 1547509151, "answer_id": 54190784, "question_id": 54190247, "link": "https://stackoverflow.com/questions/54190247/counting-number-of-string-occurrences-in-a-string-array/54190784#54190784", "title": "Counting number of string occurrences in a string/array", "body": "<p>You've already found the most frequent</p>\n\n<pre><code>greatest_frequency = frequency.max_by {|_, v| v }\n</code></pre>\n\n<p>Let's use it to found all the words which have this frequency</p>\n\n<pre><code>most_frequent_words = frequency.select { |_, v| v == greatest_frequency }.keys\nputs \"The words with the most frequencies are #{most_frequent_words.join(', ')} with a frequency of #{greatest_frequency}.\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1547517628, "last_edit_date": 1547517628, "creation_date": 1547510208, "answer_id": 54190921, "question_id": 54190247, "link": "https://stackoverflow.com/questions/54190247/counting-number-of-string-occurrences-in-a-string-array/54190921#54190921", "title": "Counting number of string occurrences in a string/array", "body": "<p>Try this.</p>\n\n<pre><code>t1 = \"This is a really really really cool cool cool\"\n</code></pre>\n\n<p><strong>Step 1: Break your string into an array of words</strong></p>\n\n<pre><code>words = t1.split\n  #=&gt; [\"This\", \"is\", \"a\", \"really\", \"really\", \"really\", \"cool\", \"cool\", \"cool\"] \n</code></pre>\n\n<p><strong>Step 2: Compute your frequency hash</strong></p>\n\n<pre><code>frequency = Hash.new(0) \nwords.each { |word| frequency[word.downcase] += 1 } \nfrequency\n  ##=&gt; {\"this\"=&gt;1, \"is\"=&gt;1, \"a\"=&gt;1, \"really\"=&gt;3, \"cool\"=&gt;3} \n</code></pre>\n\n<p><strong>Step 3: Determine the maximum frequency</strong></p>\n\n<pre><code>arr = frequency.max_by { |k, v| v }\n  #=&gt; [\"really\", 3]\nmax_frequency = arr.last\n  #=&gt; 3\n</code></pre>\n\n<p><strong>Step 4: Create an array containing words having a frequency of <code>max_frequency</code></strong></p>\n\n<pre><code>arr = frequency.select { |k, v| v == max_frequency }\n  #=&gt; {\"really\"=&gt;3, \"cool\"=&gt;3} \narr.map { |k, v| k }\n  #=&gt; [\"really\", \"cool\"] \n</code></pre>\n\n<p><strong>Conventional way of writing this in Ruby</strong></p>\n\n<pre><code>words = t1.split\n  #=&gt; [\"This\", \"is\", \"a\", \"really\", \"really\", \"really\", \"cool\", \"cool\", \"cool\"] \nfrequency = words.each_with_object(Hash.new(0)) do |word, f|\n   f[word.downcase] += 1\nend\n  #=&gt; {\"this\"=&gt;1, \"is\"=&gt;1, \"a\"=&gt;1, \"really\"=&gt;3, \"cool\"=&gt;3} \nmax_frequency = frequency.max_by(&amp;:last).last\n  #=&gt; 3 \nfrequency.select { |k, v| v == max_frequency }.map(&amp;:first)\n  #=&gt; [\"really\", \"cool\"]\n</code></pre>\n\n<p><strong>Notes</strong></p>\n\n<ol>\n<li><code>e = [1,2,3].map #=&gt; #&lt;Enumerator: [1, 2, 3]:map&gt;</code>. This tells us that  <code>frequency.map.max_by { |k,v| v }</code> is the same as <code>frequency.max_by { |k,v| v }</code>.</li>\n<li>In <code>frequency = frequency.map.max_by {|k, v| v }</code>, <code>frequency</code> on the right is a hash; <code>frequency</code> on the left is an array. It's generally consider bad practice to reuse variables in that way.</li>\n<li>Often <code>frequency.max_by { |k,v| v }</code> is written <code>frequency.max_by { |_,v| v }</code> or <code>frequency.max_by { |_k,v| v }</code>, mainly to signal to the reader that the first block variable is not used in the block calculation. (As I indicated above, this statement would generally be written  <code>frequency.max_by(&amp;:last)</code>.) Note <code>_</code> is a valid local variable.</li>\n<li><code>frequency.max_by { |k, v| v }.last</code> could instead be written <code>frequency.map { |k, v| v }.max</code> but that has the disadvantage that <code>map</code> produces an intermediate array of <code>frequence.size</code> elements, whereas the former produces an intermediate array of two elements.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 0, "last_activity_date": 1547515824, "last_edit_date": 1547515824, "creation_date": 1547510254, "answer_id": 54190928, "question_id": 54190247, "link": "https://stackoverflow.com/questions/54190247/counting-number-of-string-occurrences-in-a-string-array/54190928#54190928", "title": "Counting number of string occurrences in a string/array", "body": "<pre><code>string = 'This is is a really a really a really cool cool experiment a cool cool really'\n</code></pre>\n\n<p>1). Separate string into array of words</p>\n\n<pre><code>words = string.split.map(&amp;:downcase)\n</code></pre>\n\n<p>2). Calculate maximum frequency based on unique words</p>\n\n<pre><code>max_frequency = words.uniq.map { |i| words.count(i) }.max\n</code></pre>\n\n<p>3). Find combinations of word and frequency</p>\n\n<pre><code>combos = words.group_by { |e| e }.map { |k, v| [k, v.size] }.to_h\n</code></pre>\n\n<p>4). Select most frequent words</p>\n\n<pre><code>most_frequent_words = combos.select { |_, v| v == max_frequency }.keys\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>puts \"The words with the most frequencies are '#{most_frequent_words.join(', ')}' with a frequency of #{max_frequency}.\"\n#=&gt; The words with the most frequencies are 'a, really, cool' with a frequency of 4.\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10887626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Ah5gk0cfQY/AAAAAAAAAAI/AAAAAAAAADY/CfjCrplmxnc/photo.jpg?sz=128", "display_name": "TruthIZ", "link": "https://stackoverflow.com/users/10887626/truthiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "answer_count": 3, "score": -4, "last_activity_date": 1547539100, "creation_date": 1547505535, "last_edit_date": 1547539100, "question_id": 54190247, "link": "https://stackoverflow.com/questions/54190247/counting-number-of-string-occurrences-in-a-string-array", "title": "Counting number of string occurrences in a string/array", "body": "<p>I'm expecting to return all words with the max occurrences in a given string. The following code is expected to do so:</p>\n\n<pre><code>t1 = \"This is a really really really cool experiment cool really \"\n\nfrequency = Hash.new(0)\nwords = t1.split\nwords.each { |word| frequency[word.downcase] += 1 }\nfrequency = frequency.map.max_by { |k, v| v }\nputs \"The words with the most frequencies is '#{frequency[0]}' with \n a frequency of #{frequency[1]}.\"\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>The words with the most frequencies is 'really' with \na frequency of 4.\n</code></pre>\n\n<p>However, it does not work if there are, for example two strings that equal to the max. For example, if I add three <code>cool</code>s to the text, it would still return the same output even though the count of <code>cool</code> is also equal to four.</p>\n\n<p>It would be nice if you could tell me if those method would work on an array too instead of a string.</p>\n"}, {"tags": ["ruby", "regex", "markdown"], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1547505936, "creation_date": 1547505936, "answer_id": 54190320, "question_id": 54190231, "link": "https://stackoverflow.com/questions/54190231/parse-markdown-that-is-separated-by-with-regex-pattern/54190320#54190320", "title": "Parse Markdown that is separated by `#` with regex pattern", "body": "<p>You may match a line starting with <code>#</code> not followed with another <code>#</code> and any amount of subsequent lines that do not start with such a standalone <code>#</code> char:</p>\n\n<pre><code>.scan(/^#(?!#).*(?:\\R(?!#(?!#)).*)*/)\n</code></pre>\n\n<p>See the <a href=\"https://ideone.com/TORjdi\" rel=\"nofollow noreferrer\">Ruby demo online</a>.</p>\n\n<p><strong>Pattern details</strong></p>\n\n<ul>\n<li><code>^</code> - start of a line</li>\n<li><code>#(?!#)</code> - a <code>#</code> not followed with <code>#</code></li>\n<li><code>.*</code> - the rest of the line</li>\n<li><code>(?:\\R(?!#(?!#)).*)*</code> - zero or more consecutive occurrences of:\n\n<ul>\n<li><code>\\R(?!#(?!#))</code> - any line break sequence (use <code>\\n</code> for old Ruby versions) that is not followed with a standalone <code>#</code></li>\n<li><code>.*</code> - the rest of the line.</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 493, "user_id": 10321213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a2865913e792d0b1f0b591bdabe568?s=128&d=identicon&r=PG&f=1", "display_name": "k23j4", "link": "https://stackoverflow.com/users/10321213/k23j4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 54190320, "answer_count": 1, "score": 2, "last_activity_date": 1547505936, "creation_date": 1547505458, "question_id": 54190231, "link": "https://stackoverflow.com/questions/54190231/parse-markdown-that-is-separated-by-with-regex-pattern", "title": "Parse Markdown that is separated by `#` with regex pattern", "body": "<p>I'd like to parse Markdown that is separated by <code>#</code> (single hash).\nI've been try to that with Ruby.</p>\n\n<p>Below code outputs <code>[\"# Bob's markdown header 1\\n\\nsomething here.\\n\\n\", \"#\", \"# kitty's header 1\\n\\nmeow.\\n\\n\"]</code></p>\n\n<pre><code>p \\\narrayobj = &lt;&lt;-EOS.scan(/^#[^#]*/m)\n\n# Bob's markdown header 1\n\nsomething here.\n\n## this is markdown header 2\n\nyeah.\n\n# kitty's header 1\n\nmeow.\n\nEOS\n</code></pre>\n\n<p>However what I wanted is below.</p>\n\n<pre><code>[\"# Bob's markdown header 1\\n\\nsomething here.\\n\\n## this is markdown header 2\\n\\nyeah.\\n\\n\", \"# kitty's header 1\\n\\nmeow.\\n\\n\"]\n</code></pre>\n\n<p>In that case, how do you parse the Markdown?</p>\n"}, {"tags": ["ruby", "unit-testing", "rspec"], "comments": [{"owner": {"reputation": 950, "user_id": 721065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/edc3679b79541a9ab4e861e716ebef9c?s=128&d=identicon&r=PG&f=1", "display_name": "cdmo", "link": "https://stackoverflow.com/users/721065/cdmo"}, "edited": false, "score": 0, "creation_date": 1584737813, "post_id": 54190150, "comment_id": 107538652, "body": "Ever figure out why <code>allow(YAML).to receive(:load_file).with(&#39;b.txt&#39;).and_return(&#39;b_data&#39;)</code> does not isolate as you&#39;d expect. I had the same expectations and <code>and_call_original</code> solved it for me too."}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 6144460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3cdffe21fd594a0947298f0f4f1f8?s=128&d=identicon&r=PG", "display_name": "periswon", "link": "https://stackoverflow.com/users/6144460/periswon"}, "is_accepted": true, "score": 7, "last_activity_date": 1547506597, "creation_date": 1547506597, "answer_id": 54190439, "question_id": 54190150, "link": "https://stackoverflow.com/questions/54190150/rspec-how-to-stub-only-one-of-multiple-calls-to-same-method/54190439#54190439", "title": "RSpec: How to Stub Only One of Multiple Calls to Same Method", "body": "<p>There is a <code>and_call_original</code> option (see <a href=\"https://relishapp.com/rspec/rspec-mocks/v/3-8/docs/configuring-responses/calling-the-original-implementation#%60and-call-original%60-can-configure-a-default-response-that-can-be-overridden-for-specific-args\" rel=\"noreferrer\">rspec docs</a>).</p>\n\n<p>Applied to your example, this should do what you are looking for:</p>\n\n<pre><code>before do\n  allow(YAML).to receive(:load_file).and_call_original\n  allow(YAML).to receive(:load_file).with('b.txt').and_return('b_data')\nend\n</code></pre>\n"}], "owner": {"reputation": 12925, "user_id": 361833, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/CqdAB.jpg?s=128&g=1", "display_name": "doremi", "link": "https://stackoverflow.com/users/361833/doremi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3139, "favorite_count": 0, "accepted_answer_id": 54190439, "answer_count": 1, "score": 2, "last_activity_date": 1547506597, "creation_date": 1547505022, "question_id": 54190150, "link": "https://stackoverflow.com/questions/54190150/rspec-how-to-stub-only-one-of-multiple-calls-to-same-method", "title": "RSpec: How to Stub Only One of Multiple Calls to Same Method", "body": "<p>I'm having trouble figuring out how to stub only one of two calls to a method. Here's an example:</p>\n\n<pre><code>class Example\n  def self.foo\n    { a: YAML.load_file('a.txt'),   # don't stub - let it load\n      b: YAML.load_file('b.txt') }  # stub this one\n  end\nend\n\nRSpec.describe Example do\n  describe '.foo' do\n    before do\n      allow(YAML).to receive(:load_file).with('b.txt').and_return('b_data')\n    end\n\n    it 'returns correct hash' do\n      expect(described_class.foo).to eq(a: 'a_data', b: 'b_data')\n    end\n  end\nend\n</code></pre>\n\n<p>The test fails because I have stubbed a call to <code>YAML.load_file</code> with the args for the second call (<code>'b.txt'</code>), not the first one it encounters(<code>'a.txt'</code>). I thought argument matching would address this but it does not.</p>\n\n<pre><code>Failures:\n\n  1) Example.foo returns correct hash\n     Failure/Error:\n       { a: YAML.load_file('a.txt'),\n         b: YAML.load_file('b.txt') }\n\n       Psych received :load_file with unexpected arguments\n         expected: (\"b.txt\")\n              got: (\"a.txt\")\n        Please stub a default value first if message might be received with other args as well.  \n</code></pre>\n\n<p>Is there a way I can allow the first call to <code>YAML.load_file</code> to go through but only stub the second call? How would I do this? </p>\n"}, {"tags": ["ruby", "unit-testing", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 6144460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3cdffe21fd594a0947298f0f4f1f8?s=128&d=identicon&r=PG", "display_name": "periswon", "link": "https://stackoverflow.com/users/6144460/periswon"}, "is_accepted": false, "score": 1, "last_activity_date": 1547509803, "creation_date": 1547509803, "answer_id": 54190878, "question_id": 54190059, "link": "https://stackoverflow.com/questions/54190059/rspec-typeerror-when-stubbing-custom-exception/54190878#54190878", "title": "RSpec: TypeError When Stubbing Custom Exception", "body": "<p>I guess the instance double of <code>Custom::Error</code> is an <code>InstanceDouble</code> object and not an <code>Exception</code> object so when you raise the double it causes the <code>TypeError</code>.</p>\n\n<p>You could replace the double</p>\n\n<pre><code> let(:custom_error_double) { instance_double(Custom::Error) }\n</code></pre>\n\n<p>with a real <code>Custom::Error</code> object</p>\n\n<pre><code> let(:custom_error) { Custom::Error.new }\n</code></pre>\n\n<p>to avoid that.</p>\n"}, {"tags": [], "owner": {"reputation": 1761, "user_id": 3741320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10222536/picture?type=large", "display_name": "James Milani", "link": "https://stackoverflow.com/users/3741320/james-milani"}, "is_accepted": true, "score": 0, "last_activity_date": 1547509968, "creation_date": 1547509968, "answer_id": 54190895, "question_id": 54190059, "link": "https://stackoverflow.com/questions/54190059/rspec-typeerror-when-stubbing-custom-exception/54190895#54190895", "title": "RSpec: TypeError When Stubbing Custom Exception", "body": "<p>I believe that you have it exactly right that the exception vs. the double is the issue. The error specifically is <code>received :error with unexpected arguments</code>, and the comparison is that the double does not match the <code>TypeError</code>. In this case, the blind <code>rescue =&gt; e</code> then calls <code>Custom::Alert.error(e, {foo: :bar})</code> (which has the <code>TypeError</code> as the argument <code>e</code>), but in your test the <code>.with()</code> is expecting the double.</p>\n\n<p>This will work:</p>\n\n<pre><code>RSpec.describe Custom::Runner do\n  describe '.run' do\n    let(:custom_error) { Custom::Error.new }\n\n    before do\n      allow(Custom::Error).to receive(:new).with('test').and_return(custom_error, 'test')\n    end\n\n    it 'fires a custom alert' do\n      expect(Custom::Alert).to receive(:error).with(custom_error, foo: :bar)\n\n      described_class.run\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 12925, "user_id": 361833, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/CqdAB.jpg?s=128&g=1", "display_name": "doremi", "link": "https://stackoverflow.com/users/361833/doremi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 54190895, "answer_count": 2, "score": 1, "last_activity_date": 1547509968, "creation_date": 1547504508, "question_id": 54190059, "link": "https://stackoverflow.com/questions/54190059/rspec-typeerror-when-stubbing-custom-exception", "title": "RSpec: TypeError When Stubbing Custom Exception", "body": "<p>I'd like to test that <code>Custom::Runner.run</code> rescues all <code>StandardErrors</code> and fires an alert with the exception.</p>\n\n<p>I'm having some trouble figuring out how to stub the call to my custom error class, <code>Custom::Error</code>, and expecting that <code>Custom::Alert.error</code> was received with the double as an argument.</p>\n\n<p>Here's a complete test case to demonstrate the issue:</p>\n\n<pre><code>module Custom\n  class Error &lt; StandardError\n  end\nend\n\nmodule Custom\n  class Alert\n    def self.error(exception, context = {})\n    end\n  end\nend\n\nmodule Custom\n  class Runner\n    def self.run\n      request\n    rescue =&gt; e\n      Custom::Alert.error(e, { foo: :bar })\n    end\n\n    class &lt;&lt; self\n      def request\n        raise Custom::Error.new('test')\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Here's the test:</p>\n\n<pre><code>RSpec.describe Custom::Runner do\n  describe '.run' do\n    let(:custom_error_double) { instance_double(Custom::Error) }\n\n    before do\n      # could this be the culprit?\n      allow(Custom::Error).to receive(:new)\n        .with('test')\n        .and_return(custom_error_double, 'test')\n    end\n\n    it 'fires a custom alert' do\n      expect(Custom::Alert).to receive(:error)\n        .with(custom_error_double, foo: :bar)\n\n      described_class.run\n    end\n  end\nend\n</code></pre>\n\n<p>The test fails:</p>\n\n<pre><code>Failures:                                                                                                                                                    \n                                                                                                                                                                1) Custom::Runner.run fires a custom alert\n     Failure/Error: Custom::Alert.error(e, { foo: :bar })                                                                                                    \n\n       #&lt;Custom::Alert (class)&gt; received :error with unexpected arguments                                                                                    \n         expected: (#&lt;InstanceDouble(Custom::Error) (anonymous)&gt;, {:foo=&gt;:bar})                                                                              \n              got: (#&lt;TypeError: exception class/object expected&gt;, {:foo=&gt;:bar})\n       Diff:             \n       @@ -1,2 +1,2 @@\n       -[#&lt;InstanceDouble(Custom::Error) (anonymous)&gt;, {:foo=&gt;:bar}]\n       +[#&lt;TypeError: exception class/object expected&gt;, {:foo=&gt;:bar}]\n</code></pre>\n\n<p>I believe this is because <code>rescue</code> requires an exception and I'm returning a double. I've tried raising <code>.and_raise(custom_error_double)</code>, but I continue to get the same <code>TypeError: exception class/object expected</code>. </p>\n\n<p>There must be something I'm missing here. Any advice would be appreciated.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547503421, "post_id": 54189545, "comment_id": 95207855, "body": "Remember that with Ruby the <code>{ ... }</code> braces are optional for hash-only argument lists. Like instead of <code>User.create({ name: &#39;...&#39; })</code> you can do <code>User.create(name: &#39;...&#39;)</code> which is a lot more concise. That might also address some of the really wonky indentation here."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1547520810, "post_id": 54189545, "comment_id": 95211894, "body": "Try calling create! On both and see if an error is raised"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 10890504, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fTUfT2CgENg/AAAAAAAAAAI/AAAAAAAAAGc/-JkRnuuvs4c/photo.jpg?sz=128", "display_name": "Danodemo", "link": "https://stackoverflow.com/users/10890504/danodemo"}, "is_accepted": false, "score": 0, "last_activity_date": 1547502453, "creation_date": 1547502453, "answer_id": 54189670, "question_id": 54189545, "link": "https://stackoverflow.com/questions/54189545/rails-seed-not-creating-instances-in-databases-while-dbseed/54189670#54189670", "title": "Rails seed not creating instances in databases while db:seed", "body": "<p>Have you tried adding a foreign key via migrations and seeing what the result is?</p>\n\n<p><code>rails g migration AddForeignKeyToShoppingCart</code></p>\n\n<p>Then in the new migration file, add this:</p>\n\n<pre><code>def change\n  add_foreign_key :shopping_carts, :users\nend\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 7717578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0HbkmqP4BP0/AAAAAAAAAAI/AAAAAAAADmQ/1mMLv4bVaW4/photo.jpg?sz=128", "display_name": "Etienne Berube", "link": "https://stackoverflow.com/users/7717578/etienne-berube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547502453, "creation_date": 1547501861, "question_id": 54189545, "link": "https://stackoverflow.com/questions/54189545/rails-seed-not-creating-instances-in-databases-while-dbseed", "title": "Rails seed not creating instances in databases while db:seed", "body": "<p>I'm trying to create a small e-commerce like API. I'm trying to create mock users with Faker and creating an instance of a Shopping cart attahced with it as a foreign key during the seed (Each user should have a shopping cart). I tried two different methods</p>\n\n<p>These fils are in the seed.rb file in the db folder\nTry 1:\n    5.times do\n      Product.create({\n                         title: Faker::Commerce.product_name,\n                         price: Faker::Commerce.price,\n                         inventory_count: Faker::Number.number(2)\n                     })</p>\n\n<pre><code>end\n\n3.times do\n  ShoppingCart.create({\n                                 total_price: 0\n                             }) do |t|\n\n\n  User.create({\n                  name: Faker::Name.name,\n                  shopping_carts_id: t.id\n              })\n    end\nend\n</code></pre>\n\n<p>try 2: (Identical creation of products)</p>\n\n<p>3.times do\n      cart = ShoppingCart.create({\n                                     total_price: 0\n                                 }) </p>\n\n<pre><code>  User.create({\n                  name: Faker::Name.name,\n                  shopping_carts_id: cart.id\n              })\n    end\nend\n</code></pre>\n\n<p>Here is the model</p>\n\n<pre><code>class ShoppingCart &lt; ApplicationRecord\n  belongs_to :users\n  has_many :products\nend\n</code></pre>\n\n<p>When I run the seed, the users are created fine but no Shopping carts are there. There should be a foreign key from user to it's shopping cart. I'm very new to rails and am having a hard time understanding the db relationships.</p>\n"}, {"tags": ["ruby", "regex", "bash"], "comments": [{"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 1, "creation_date": 1547502156, "post_id": 54189421, "comment_id": 95207354, "body": "<code>.*?</code> is non-greedy and part of PCRE, but not supported by Bash regular expressions, which are ERE only."}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 1, "creation_date": 1547502202, "post_id": 54189421, "comment_id": 95207371, "body": "You should be able to use <code>\\[([^]]*)\\]</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "is_accepted": true, "score": 4, "last_activity_date": 1547507604, "last_edit_date": 1547507604, "creation_date": 1547502813, "answer_id": 54189761, "question_id": 54189421, "link": "https://stackoverflow.com/questions/54189421/regex-in-bash-returns-different-results-than-ruby/54189761#54189761", "title": "regex in bash returns different results than ruby", "body": "<p>Several issues:</p>\n\n<ol>\n<li>There is no global match in Bash;</li>\n<li>You need to manually loop over multiple matches in Bash and manually manage the string index;</li>\n<li>There is no non greedy quantifier in ERE used in Bash regex, so <code>.*?</code> does not work the same as in Ruby.</li>\n</ol>\n\n<p>You can use this as a start:</p>\n\n<pre><code>while read line; do\n    while [[ $line =~ ([^\\[]*)\\[([^\\]]*)\\] ]]; do \n        i=${#BASH_REMATCH}\n        line=${line:i}\n        echo \"${BASH_REMATCH[2]}\"\n    done\ndone &lt; file \n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code> Code128 \n this_is_a_test \n 12ms \n 385B \n http://barcodeapi.org/index.html \n 1.2.3.4 \n 5.6.7.8 \n</code></pre>\n\n<p>And you will have <em>way</em> less headache if you just use Perl / GNU grep / Ruby / etc to create the list of matches and then use Bash to loop over <em>that</em>:</p>\n\n<pre><code>while read m; do\n    echo \"Match: $m\"\ndone &lt; &lt;(ggrep -oP '(?&lt;=\\[)(.*?)(?=\\])' file)  # GNU grep is ggrep here\n</code></pre>\n\n<p>If your code has to positively be POSIX, use <code>awk</code>:</p>\n\n<pre><code>$ awk -v RS=[ -v FS=] 'NR&gt;1{print $1}' file\n</code></pre>\n"}], "owner": {"reputation": 24739, "user_id": 1790644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f1a2a40ddbc52508d5b53e9879961251?s=128&d=identicon&r=PG", "display_name": "Matt Clark", "link": "https://stackoverflow.com/users/1790644/matt-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 54189761, "answer_count": 1, "score": 2, "last_activity_date": 1547507660, "creation_date": 1547501184, "last_edit_date": 1547507660, "question_id": 54189421, "link": "https://stackoverflow.com/questions/54189421/regex-in-bash-returns-different-results-than-ruby", "title": "regex in bash returns different results than ruby", "body": "<p>I am trying to extract match groups from a string - I've used <a href=\"https://rubular.com/r/OY3JfqbQQwinEH\" rel=\"nofollow noreferrer\">Rubular</a> to come up with a pattern:</p>\n\n<pre><code>\\[(.*?)\\]\n</code></pre>\n\n<p>Which in ruby, seems to extract the expected groups for the following string:</p>\n\n<blockquote>\n  <p>1547156981784 : Served [ Code128 ] with [ this_is_a_test ] in [ 12ms ] size [ 385B ] using [ <a href=\"http://barcodeapi.org/index.html\" rel=\"nofollow noreferrer\">http://barcodeapi.org/index.html</a> ] for [ 1.2.3.4 ] via [ 5.6.7.8 ]</p>\n</blockquote>\n\n<pre><code>1: Code128\n2: this_is_a_test\n3: 12ms\n4: 385B\n5: http://barcodeapi.org/index.html\n6: 1.2.3.4\n7: 5.6.7.8\n</code></pre>\n\n<p>However this issue is that I am trying to implement this regex in a Bash script to parse a log file:</p>\n\n<pre><code>reg='\\[(.*?)\\]'\nwhile read line; do\n  if [[ $line =~ $reg ]]; then\n    echo ${BASH_REMATCH[1]};\n  fi\ndone &lt; $log\n</code></pre>\n\n<p>But the results are not the same as ruby / rubular; in Bash, match group #1 contains the whole string, minus the very first and very last brackets; for the same log line, bash returns only a single match:</p>\n\n<pre><code>1: Code128 ] with [ this_is_a_test ] in [ 12ms ] size [ 385B ] using [ http://barcodeapi.org/index.html ] for [ 1.2.3.4 ] via [ 5.6.7.8\n</code></pre>\n\n<p>Question being,</p>\n\n<p>Why do the two engines give different results? How can I separate the groups properly using Bash? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1547507645, "post_id": 54189347, "comment_id": 95209173, "body": "Can you post your User model? When you say User has_many Subscription; I am hoping you have it something like this in <code>User</code> model: <code>has_many :subscriptions</code>. Also, you say you aren&#39;t getting active subs; are you getting any subs? You aren&#39;t using that function you defined in the model."}], "answers": [{"comments": [{"owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "edited": false, "score": 0, "creation_date": 1547512675, "post_id": 54190834, "comment_id": 95210260, "body": "But this returns a subscription. I need to return a list of ordered User objects, ordered by their <code>active_subscription.type_name</code>"}, {"owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "reply_to_user": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "edited": false, "score": 0, "creation_date": 1547519868, "post_id": 54190834, "comment_id": 95211707, "body": "I just add another information , please see my answer above"}], "tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": false, "score": 0, "last_activity_date": 1547519840, "last_edit_date": 1547519840, "creation_date": 1547509513, "answer_id": 54190834, "question_id": 54189347, "link": "https://stackoverflow.com/questions/54189347/how-to-sort-rails-model-by-has-many-last-active-field/54190834#54190834", "title": "How to sort rails model by has_many last active field?", "body": "<p>using scope probably can help, below is sample for your problem</p>\n\n<pre><code>class Subscription &lt; ApplicationRecord\n\n  scope :active_subscription, lambda { where('active = ?',true)}\n  scope :type_name_order,     lambda { |q| order(\"type_name :q\", q: \"#{q}\") }\n\nend\n\nUser.subscriptions.active_subscription.type_name_order('DESC').last\n\n@users = Subscription.joins(:user).active_subscription.type_name_order('DESC').select('users.username','subscriptions.*')\n\n@users.first.username # you will get first username\n\n# you can also combine with last \n\n@users = Subscription.joins(:user).active_subscription.type_name_order('DESC').select('users.*','subscriptions.*').last(10)\n\n# in my above example i'm using * to select all column of table users\n# for example your table users has gender column you can use\n\nputs @users.first.gender \n\n# if table users and subscriptions have same column name for example subscriptions.active and users.active then you should use alias 'AS' in select\n</code></pre>\n"}], "owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547519840, "creation_date": 1547500707, "question_id": 54189347, "link": "https://stackoverflow.com/questions/54189347/how-to-sort-rails-model-by-has-many-last-active-field", "title": "How to sort rails model by has_many last active field?", "body": "<p>I have two models:</p>\n\n<p><code>User</code> has_many <code>Subscription</code>.</p>\n\n<p>My user model has a function called <code>active_subscription</code>.</p>\n\n<pre><code>def active_subscription\n  subscriptions.where(active: true).last\nend\n</code></pre>\n\n<p>I would like to be able to sort my user's by this active subscription's <code>type_name</code> field. I need to use the active subscription because only the last active subscription is rendered in my views.</p>\n\n<p>I have this written:</p>\n\n<pre><code>includes(:subscriptions).order(\"subscriptions.type_name #{sort_order}\")\n</code></pre>\n\n<p>But, this isn't taking into account the active subscription.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "jekyll", "liquid"], "comments": [{"owner": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1547508459, "post_id": 54189226, "comment_id": 95209401, "body": "This should help you: <a href=\"https://github.com/Anthony-Gaudino/jekyll-multiple-languages-plugin\" rel=\"nofollow noreferrer\">github.com/Anthony-Gaudino/jekyll-multiple-languages-plugin</a>"}, {"owner": {"reputation": 647, "user_id": 1753525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/586deea6b453c89ffbb7daf32e939c46?s=128&d=identicon&r=PG", "display_name": "Samer", "link": "https://stackoverflow.com/users/1753525/samer"}, "reply_to_user": {"reputation": 694, "user_id": 6481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881dc5adac4bec55f445d812f2e32505?s=128&d=identicon&r=PG&f=1", "display_name": "Aaditya Maheshwari", "link": "https://stackoverflow.com/users/6481767/aaditya-maheshwari"}, "edited": false, "score": 0, "creation_date": 1547538418, "post_id": 54189226, "comment_id": 95216104, "body": "Not really. My question is not related to which plugin could help me. I want to know how to propagate a subdirectory of posts as part of the blog&#39;s URL."}], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 1753525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/586deea6b453c89ffbb7daf32e939c46?s=128&d=identicon&r=PG", "display_name": "Samer", "link": "https://stackoverflow.com/users/1753525/samer"}, "edited": false, "score": 0, "creation_date": 1547546031, "post_id": 54195852, "comment_id": 95219594, "body": "This did the trick! Is there any downside to this approach? I assume I&#39;ll have to create another default for type: &quot;pages&quot; and duplicate all of them, right?"}, {"owner": {"reputation": 221, "user_id": 9048343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4ef89de1c8a74acb84e2e9959f06ff?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Buchberger", "link": "https://stackoverflow.com/users/9048343/robert-buchberger"}, "reply_to_user": {"reputation": 647, "user_id": 1753525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/586deea6b453c89ffbb7daf32e939c46?s=128&d=identicon&r=PG", "display_name": "Samer", "link": "https://stackoverflow.com/users/1753525/samer"}, "edited": false, "score": 0, "creation_date": 1547548265, "post_id": 54195852, "comment_id": 95220794, "body": "It&#39;s worth reading the docs I linked. Anything you can set by frontmatter, you can set a default value for. No downsides, this is exactly the sort of thing it was made for!"}, {"owner": {"reputation": 647, "user_id": 1753525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/586deea6b453c89ffbb7daf32e939c46?s=128&d=identicon&r=PG", "display_name": "Samer", "link": "https://stackoverflow.com/users/1753525/samer"}, "edited": false, "score": 0, "creation_date": 1547549097, "post_id": 54195852, "comment_id": 95221241, "body": "Thanks Robert! Accepting your solution."}], "tags": [], "owner": {"reputation": 221, "user_id": 9048343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4ef89de1c8a74acb84e2e9959f06ff?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Buchberger", "link": "https://stackoverflow.com/users/9048343/robert-buchberger"}, "is_accepted": true, "score": 4, "last_activity_date": 1547544029, "creation_date": 1547544029, "answer_id": 54195852, "question_id": 54189226, "link": "https://stackoverflow.com/questions/54189226/include-subdirectory-as-part-of-jekylls-post-url/54195852#54195852", "title": "Include subdirectory as part of Jekyll&#39;s post URL", "body": "<p>You could set a <a href=\"https://jekyllrb.com/docs/configuration/front-matter-defaults/\" rel=\"nofollow noreferrer\">frontmatter default</a> for your english pages.</p>\n\n<pre><code># _config.yml\n\ndefaults:\n-\n    scope:\n      locale: \"en\" # To sort by locale. You could also sort by path.\n      type: \"posts\"\n    values:\n      permalink: en/:categories/:year/:month/:title/\n</code></pre>\n"}], "owner": {"reputation": 647, "user_id": 1753525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/586deea6b453c89ffbb7daf32e939c46?s=128&d=identicon&r=PG", "display_name": "Samer", "link": "https://stackoverflow.com/users/1753525/samer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 54195852, "answer_count": 1, "score": 5, "last_activity_date": 1547648070, "creation_date": 1547500133, "last_edit_date": 1547648070, "question_id": 54189226, "link": "https://stackoverflow.com/questions/54189226/include-subdirectory-as-part-of-jekylls-post-url", "title": "Include subdirectory as part of Jekyll&#39;s post URL", "body": "<p>I am building a blog in both English and Spanish languages. My intention is to access the default content, in Spanish, directly from the base url: <code>http://blog/</code> and the English content from <code>http://blog/en</code>. </p>\n\n<p>I already have all the code to loop through posts only in English or Spanish when paginating by checking the <code>locale</code> variable that I set in every post front matter. Although my blog posts don't have the same filename, I link them using another variable in the front matter called <code>ref</code>.</p>\n\n<p>So for post A, in Spanish, and post B, in English, I'll have something like this:</p>\n\n<p>2018-01-01-post-A.md</p>\n\n<pre><code>---\nlocale: en\nref: my-ref\n---\nfoo\n</code></pre>\n\n<p>2019-01-04-post-B.md:</p>\n\n<pre><code>---\nlocale: es\nref: my-ref\n---\nbar\n</code></pre>\n\n<p>My question is: where do I put my English posts so that they can be accessed through <code>http://blog/en/post-name/</code>?</p>\n\n<p>Those posts already have their categories apart from their language, so putting them inside <code>/en/_posts</code> wouldn't work, as when specifying the permalink in <code>_config.yml</code> to something like <code>permalink: /:categories/:year/:month/:title/</code> would make the url look like <code>http://blog/en/category-1/category-2/post-name</code>.</p>\n\n<p>Defining a permalink in each English post is also not an option, since I'd like them to be generated from the post data (date and title).</p>\n\n<p>Is there something that I'm missing that would let me use <code>/en/</code> as part of the URL as I want?</p>\n\n<p>Both the menu language selector and the pagination work, displaying only posts in the selected language. However, when hovering over the posts in english, although I put them inside <code>_posts/en</code>, the subfolder doesn't become part of the url. The same happens when I try the opposite, creating a new folder in the project root named <code>en</code> and adding all the English posts inside it, leaving me with something like <code>en/_posts/</code></p>\n"}, {"tags": ["ruby", "floating-point"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1547500486, "post_id": 54189110, "comment_id": 95206697, "body": "Welcome to the wild world of floating point math."}, {"owner": {"reputation": 139290, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547550135, "post_id": 54189110, "comment_id": 95221744, "body": "@SergioTulentsev: How do you figure this is a duplicate of that question? In <code>86.26.to_d</code>, the <code>86.26</code> ought to be converted to binary floating-point (as a literal in source code) and then converted to decimal (by the <code>to_d</code> operation). When this decimal value is compared with the <code>86.26</code> on the right, that <code>86.26</code> is implicitly converted to decimal. Regardless of floating-point issues, the same result should be obtained, since the same operations have been performed. However, I may not understand Ruby semantics\u2014are the operations different than I have described?"}, {"owner": {"reputation": 139290, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547550228, "post_id": 54189110, "comment_id": 95221787, "body": "@SergioTulentsev: Some other Stack Overflow answers indicate there are <a href=\"https://stackoverflow.com/a/3003750/298225\">bugs in older implementations of <code>to_d</code></a> that cause this behavior. Alternately, if that is not the cause, the question you gave as the original does not explain the Ruby semantics, which are necessary to understand how any floating-point behaviors apply, so this is not a duplicate."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547554526, "post_id": 54189110, "comment_id": 95223938, "body": "if I&#39;m reading the source code correctly, <code>BigDecimalCmp</code> converts both self and the operand to rational numbers and compares those. <code>86.25.to_d.to_r</code> and <code>85.25.to_r</code> give the same result. Not so in the other case..."}, {"owner": {"reputation": 139290, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547558469, "post_id": 54189110, "comment_id": 95225989, "body": "@SergioTulentsev: Thanks. Where does the difference arise? I would expect the literal <code>86.26</code> to produce the value 86.2600000000000051159076974727213382720947265625. Then does <code>86.26.to_d</code> produce that exact value in decimal or something else? And does <code>86.26.to_d.to_r</code> produce that same value as a rational or something else? And, finally, does <code>86.26.to_r</code> produce the same value or something else? One of the three must produce a different value, yes? That would be the answer to OP\u2019s question."}], "owner": {"reputation": 319, "user_id": 2365597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a411871cb78e0dfada4073af149f9516?s=128&d=identicon&r=PG", "display_name": "SDp", "link": "https://stackoverflow.com/users/2365597/sdp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547554405, "creation_date": 1547499655, "last_edit_date": 1547519917, "question_id": 54189110, "link": "https://stackoverflow.com/questions/54189110/comparison-problem-in-ruby-86-26-86-26", "title": "Comparison problem in ruby: 86.26 != 86.26", "body": "<p>How could the following be?</p>\n\n<pre><code>require \"bigdecimal/util\"\n\n86.26.to_d == 86.26\n# =&gt; false\n86.25.to_d == 86.25\n# =&gt; true\n</code></pre>\n"}, {"tags": ["r", "ruby", "permissions", "homebrew"], "comments": [{"owner": {"reputation": 239581, "user_id": 1855677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ufQP.png?s=128&g=1", "display_name": "IRTFM", "link": "https://stackoverflow.com/users/1855677/irtfm"}, "edited": false, "score": 0, "creation_date": 1553189090, "post_id": 54189076, "comment_id": 97301897, "body": "Did you misspell doctor as docker in the last sentence?"}], "answers": [{"tags": [], "owner": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1547663155, "creation_date": 1547663155, "answer_id": 54223172, "question_id": 54189076, "link": "https://stackoverflow.com/questions/54189076/homebrew-lack-permissions-when-installing/54223172#54223172", "title": "Homebrew: lack permissions when installing", "body": "<p>Figured it out - there's a sandbox (<code>sandbox-exec</code>, I think) in place that restricts writing to the filesystem outside the prefix directory:</p>\n\n<p><a href=\"https://discourse.brew.sh/t/potential-permission-issues-in-a-formula-im-writing/3707\" rel=\"nofollow noreferrer\">https://discourse.brew.sh/t/potential-permission-issues-in-a-formula-im-writing/3707</a></p>\n\n<p>I'll need to figure out the correct way to write files to <code>/usr/local/lib/R/3.5/site-library</code>, or symlink them to there from the Cellar directory, or whatever it is.</p>\n"}], "owner": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547663155, "creation_date": 1547499471, "question_id": 54189076, "link": "https://stackoverflow.com/questions/54189076/homebrew-lack-permissions-when-installing", "title": "Homebrew: lack permissions when installing", "body": "<p>I'm trying to write my first formula, for the <code>Rserve</code> package in R: <a href=\"https://www.rforge.net/Rserve/\" rel=\"nofollow noreferrer\">https://www.rforge.net/Rserve/</a> .</p>\n\n<p>So far I have this:</p>\n\n<pre><code># Documentation: https://docs.brew.sh/Formula-Cookbook\n#                https://www.rubydoc.info/github/Homebrew/brew/master/Formula\nclass Rserve &lt; Formula\n  desc \"Rserve acts as a socket server (TCP/IP or local sockets) which allows binary requests to be sent to R.\"\n  homepage \"http://www.rforge.net/Rserve/\"\n  url \"https://cran.r-project.org/src/contrib/Rserve_1.7-3.tar.gz\"\n  sha256 \"f6d636c736c3f16487d9987e54554fe0c55257b9bc0671b43e536d832e513027\"\n\n  depends_on \"r\"\n  depends_on \"gettext\"\n\n  def install\n    system(\"whoami\")\n    system(\"#{HOMEBREW_PREFIX}/bin/R CMD install --configure-args=\\\"CPPFLAGS=-L#{HOMEBREW_PREFIX}/opt/gettext/lib LDFLAGS=-I#{HOMEBREW_PREFIX}/opt/gettext/include\\\" .\")\n  end\n\n  test do\n    # `test do` will create, run in and delete a temporary directory.\n    #\n    # This test will fail and we won't accept that! For Homebrew/homebrew-core\n    # this will need to be a test that verifies the functionality of the\n    # software. Run the test with `brew test Rserve`. Options passed\n    # to `brew install` such as `--HEAD` also need to be provided to `brew test`.\n    #\n    # The installed folder is not in the path, so use the entire path to any\n    # executables being tested: `system \"#{bin}/program\", \"do\", \"something\"`.\n    system \"false\"\n  end\nend\n</code></pre>\n\n<p>The error I get is:</p>\n\n<pre><code>==&gt; Downloading https://cran.r-project.org/src/contrib/Rserve_1.7-3.tar.gz\nAlready downloaded: /Users/kwilliams/Library/Caches/Homebrew/downloads/690e0934dcba3770ba80b743f7b2c9cee0250434ed17cc7949bc1eee74d5b170--Rserve_1.7-3.tar.gz\n==&gt; Verifying 690e0934dcba3770ba80b743f7b2c9cee0250434ed17cc7949bc1eee74d5b170--Rserve_1.7-3.tar.gz checksum\ntar xf /Users/kwilliams/Library/Caches/Homebrew/downloads/690e0934dcba3770ba80b743f7b2c9cee0250434ed17cc7949bc1eee74d5b170--Rserve_1.7-3.tar.gz -C /private/tmp/d20190114-99089-11isfza\ncp -pR /private/tmp/d20190114-99089-11isfza/Rserve/. /private/tmp/rserve-20190114-99089-b57ji6/Rserve\nchmod -Rf +w /private/tmp/d20190114-99089-11isfza\n==&gt; whoami\nkwilliams\n==&gt; /usr/local/bin/R CMD install --configure-args=\"CPPFLAGS=-L/usr/local/opt/gettext/lib LDFLAGS=-I/usr/local/opt/gettext/include\" .\n* installing to library \u2018/usr/local/lib/R/3.5/site-library\u2019\nError: ERROR: no permission to install to directory \u2018/usr/local/lib/R/3.5/site-library\u2019\n\n==&gt; Formula\nPath: /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/rserve.rb\n==&gt; Configuration\nHOMEBREW_VERSION: 1.9.2-5-g44f4f36\nORIGIN: https://github.com/Homebrew/brew\nHEAD: 44f4f36c0db693000410fe664b250a90325f4e32\nLast commit: 4 hours ago\nCore tap ORIGIN: https://github.com/Homebrew/homebrew-core\nCore tap HEAD: de1ecc1d981de9d5165ea9e96242c32023d14d7c\nCore tap last commit: 4 hours ago\nHOMEBREW_PREFIX: /usr/local\nHOMEBREW_DEV_CMD_RUN: 1\nHOMEBREW_ENABLE_AUTO_UPDATE_MIGRATION: 1\nHOMEBREW_LOGS: /Users/kwilliams/Library/Logs/Homebrew\nCPU: octa-core 64-bit kabylake\nHomebrew Ruby: 2.3.7 =&gt; /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby\nClang: 10.0 build 1000\nGit: 2.17.2 =&gt; /Library/Developer/CommandLineTools/usr/bin/git\nCurl: 7.54.0 =&gt; /usr/bin/curl\nJava: 11.0.1, 1.8.0_192\nmacOS: 10.13.6-x86_64\nCLT: 10.1.0.0.1.1539992718\nXcode: 10.1\nXQuartz: 2.7.11 =&gt; /opt/X11\n</code></pre>\n\n<p>The permissions on <code>/usr/local/lib/R/3.5/site-library</code> should allow me to install there, though:</p>\n\n<pre><code>% ls -al /usr/local/lib/R/3.5/site-library\ntotal 0\ndrwxr-xr-x  2 kwilliams  admin  64 Jan 14 13:38 ./\ndrwxr-xr-x  3 kwilliams  admin  96 Jan 14 13:38 ../\n</code></pre>\n\n<p>If I put myself in a directory where the <code>Rserve</code> tarball has been freshly expanded, then manually run the command <code>/usr/local/bin/R CMD install --configure-args=\"CPPFLAGS=-L/usr/local/opt/gettext/lib LDFLAGS=-I/usr/local/opt/gettext/include\" .</code>, I don't get the error about \"no permission to install to directory\".</p>\n\n<p>What's different about the environment that Homebrew is running that command, compared to me running it in a shell, that causes it to fail when run automatically?</p>\n\n<p>My <code>brew doctor</code> output is clean, except for a warning that my <code>docker</code> keg is unlinked, which I assume is unrelated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5", "rspec-rails"], "comments": [{"owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "edited": false, "score": 0, "creation_date": 1547558985, "post_id": 54188942, "comment_id": 95226251, "body": "are <code>whatever_class_spec.rb</code> and <code>calculate.rb</code> empty?"}], "answers": [{"comments": [{"owner": {"reputation": 7909, "user_id": 6439240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ff73af17f0d84241181f067b95538d4?s=128&d=identicon&r=PG", "display_name": "wscourge", "link": "https://stackoverflow.com/users/6439240/wscourge"}, "edited": false, "score": 0, "creation_date": 1547563503, "post_id": 54199897, "comment_id": 95229100, "body": "Hi there. It is my bad that I passed the wrong path in my question, it was set up as you write here and it still did not work. I am going to edit my question now, with the path you gave here. Here&#39;s an upvote for you, for trying.   What I did (and it worked, but I don&#39;t like it) was adding <code>include WhateverModule::WhateverClass</code> on top of the <code>whatever_class_spec.rb</code> file. Rubocop went nuts about it and I don&#39;t think it is the correct solution."}], "tags": [], "owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "is_accepted": true, "score": 1, "last_activity_date": 1547632381, "last_edit_date": 1547632381, "creation_date": 1547559149, "answer_id": 54199897, "question_id": 54188942, "link": "https://stackoverflow.com/questions/54188942/nameerror-unitialized-constant-servicename-with-default-rspec-configuration/54199897#54199897", "title": "NameError: unitialized constant ServiceName with default rspec configuration", "body": "<p><s>Your spec file should be in </p>\n\n<p><code>spec/services/distamce/whatever_class_spec.rb</code>.</p>\n\n<p>In you case rspec tries to find the WhateverModule because of <code>/whatever_module/</code> in your pathing for the spec file. You can try this to change to <code>spec/services/foo_bar/whatever_class_spec.rb</code> and you will get the missing FooBarModule error.</s></p>\n\n<p>I think I figured out what you missed.</p>\n\n<p>Rspec does not automatically require your app folder and so there are no modules or classes available from the app folder initially.</p>\n\n<p>When you check <a href=\"https://github.com/rspec/rspec-rails#installation\" rel=\"nofollow noreferrer\">https://github.com/rspec/rspec-rails#installation</a> @2 then you can see you have to add some boilerplate files for rspec like <code>rails_helper.rb</code> and <code>spec_helper.rb</code> with <code>rails generate rspec:install</code>. These are responsible for all rspec related settings and the require of the app folder.</p>\n\n<p>Also its required to add <code>require 'rails_helper'</code> on top of each spec file.</p>\n\n<p>After you have done all this and you get the error <code>Unable to autoload constant WhateverModule::WhateverClass</code> then your <code>whatever_class.rb</code> has to look like this</p>\n\n<pre><code>module WhateverModule\n  class WhateverClass\n  end\nend\n</code></pre>\n\n<p>Or you define the module in a file besides the <code>whatever_module</code> folder.</p>\n"}], "owner": {"reputation": 7909, "user_id": 6439240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ff73af17f0d84241181f067b95538d4?s=128&d=identicon&r=PG", "display_name": "wscourge", "link": "https://stackoverflow.com/users/6439240/wscourge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 54199897, "answer_count": 1, "score": 0, "last_activity_date": 1547632381, "creation_date": 1547498877, "last_edit_date": 1547563464, "question_id": 54188942, "link": "https://stackoverflow.com/questions/54188942/nameerror-unitialized-constant-servicename-with-default-rspec-configuration", "title": "NameError: unitialized constant ServiceName with default rspec configuration", "body": "<p>I created <code>rails new --api whatever</code> with:</p>\n\n<pre><code>gem 'rspec-rails', '~&gt; 3.8'\n</code></pre>\n\n<p>in my <code>Gemfile</code>. Then, I created:</p>\n\n<pre><code>app/services/whatever_module/whatever_class.rb\n</code></pre>\n\n<p>and corresponding spec file:</p>\n\n<pre><code>spec/services/whatever_module/whatever_class_spec.rb \n</code></pre>\n\n<p>Now, when I run:</p>\n\n<pre><code>rspec services\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>NameError: uninitialized constant WhateverModule</p>\n</blockquote>\n\n<p>How do I tell rspec to recognize the module by its spec path?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1161, "user_id": 2056117, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/93f3bba48b2683a41e9a2625934e6148?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2056117/dan"}, "edited": false, "score": 0, "creation_date": 1547499623, "post_id": 54188619, "comment_id": 95206327, "body": "Look into the <code>.select()</code> ActiveRecord method. It let&#39;s you specify the fields you want to return and they can be from a joined table. If your columns are ambiguous you&#39;ll need to prefix them with the table name."}, {"owner": {"reputation": 33, "user_id": 10891188, "user_type": "registered", "profile_image": "https://graph.facebook.com/740723306305213/picture?type=large", "display_name": "Maxime", "link": "https://stackoverflow.com/users/10891188/maxime"}, "reply_to_user": {"reputation": 1161, "user_id": 2056117, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/93f3bba48b2683a41e9a2625934e6148?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2056117/dan"}, "edited": false, "score": 0, "creation_date": 1547546320, "post_id": 54188619, "comment_id": 95219749, "body": "Thanks Dan for your answer, i tried with .select() and i don&#39;t have access to columns of the associate table :-/"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10891188, "user_type": "registered", "profile_image": "https://graph.facebook.com/740723306305213/picture?type=large", "display_name": "Maxime", "link": "https://stackoverflow.com/users/10891188/maxime"}, "edited": false, "score": 0, "creation_date": 1547543732, "post_id": 54188842, "comment_id": 95218339, "body": "Thanks for your answer ! in my view, i have a loop like this :  @sellers.each do |sellers|  puts seller.name  puts seller.country  puts seller.old_price  puts seller.price end  is it possible to do this with includes in my controller ?"}, {"owner": {"reputation": 33, "user_id": 10891188, "user_type": "registered", "profile_image": "https://graph.facebook.com/740723306305213/picture?type=large", "display_name": "Maxime", "link": "https://stackoverflow.com/users/10891188/maxime"}, "edited": false, "score": 0, "creation_date": 1547548253, "post_id": 54188842, "comment_id": 95220786, "body": "i switch to this : @sellers = Seller.includes(:stocks).where(stocks: { sneaker_id: params[:id] }) But i still can&#39;t access to stocks column ( except foreign key ) :-/"}], "tags": [], "owner": {"reputation": 5037, "user_id": 4231110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7525da44a40ab0d4e5e88a6e6d0b55de?s=128&d=identicon&r=PG", "display_name": "Justin Howard", "link": "https://stackoverflow.com/users/4231110/justin-howard"}, "is_accepted": true, "score": 2, "last_activity_date": 1547498329, "creation_date": 1547498329, "answer_id": 54188842, "question_id": 54188619, "link": "https://stackoverflow.com/questions/54188619/rails-5-access-to-another-column-than-foreign-key-in-associate-table/54188842#54188842", "title": "Rails 5 - Access to another column than foreign key in associate table", "body": "<p>In Rails, <code>joins</code> is used only for filtering, not for accessing associated records. To include the associated records in your results, use <code>includes</code>.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@sellers = Seller.includes(:stocks).where(stocks: { sneaker_id: params[:id] })\n</code></pre>\n\n<p>Then you can access the stocks using the methods you're used to.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@sellers.first.stocks.first.old_price\n</code></pre>\n\n<p><a href=\"http://blog.scoutapp.com/articles/2017/01/24/activerecord-includes-vs-joins-vs-preload-vs-eager_load-when-and-where\" rel=\"nofollow noreferrer\">This article</a> provides some useful details and performance considerations for <code>includes</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 10891188, "user_type": "registered", "profile_image": "https://graph.facebook.com/740723306305213/picture?type=large", "display_name": "Maxime", "link": "https://stackoverflow.com/users/10891188/maxime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54188842, "answer_count": 1, "score": 1, "last_activity_date": 1547498329, "creation_date": 1547497275, "question_id": 54188619, "link": "https://stackoverflow.com/questions/54188619/rails-5-access-to-another-column-than-foreign-key-in-associate-table", "title": "Rails 5 - Access to another column than foreign key in associate table", "body": "<p>I have 3 models : </p>\n\n<pre><code>class Sneaker &lt; ApplicationRecord \n    has_many :stocks\n    has_many :sellers, through: :stocks\nend\n\n\nclass Seller &lt; ApplicationRecord\n    has_many :stocks\n    has_many :sneakers, through: :stocks\nend\n\n\nclass Stock &lt; ApplicationRecord\n    belongs_to :sneaker\n    belongs_to :seller\nend\n</code></pre>\n\n<p>I have 3 tables :</p>\n\n<ul>\n<li>sneakers : id / brand / color </li>\n<li>sellers : id / name / country /  </li>\n<li>stocks : id / sneaker_id / seller_id / old_price / price / offer_link</li>\n</ul>\n\n<p>In a view, I try to display a list of sellers and their stocks of a sneaker (id of the sneaker in params[:id] )</p>\n\n<p>In my controler, i have this : </p>\n\n<pre><code>@sellers = Seller.joins(:stocks).where(stocks: { sneaker_id: params[:id] })\n</code></pre>\n\n<p>But i only have access to the foreign key (sneaker_id) in the stocks table, and i want to access to other columns ( old_price, price, offer_link ).</p>\n\n<p>I don't find how to write a proper query... ( maybe joins isn't the good way ? )</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "image", "imagemagick", "minimagick"], "comments": [{"owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "edited": false, "score": 0, "creation_date": 1547595953, "post_id": 54188501, "comment_id": 95243479, "body": "I ended up using <a href=\"https://stackoverflow.com/a/26182303/3491653\">this</a> answer as it gave me the best/desired behavior"}], "answers": [{"tags": [], "owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "is_accepted": false, "score": 3, "last_activity_date": 1547506310, "creation_date": 1547506310, "answer_id": 54190387, "question_id": 54188501, "link": "https://stackoverflow.com/questions/54188501/minimagick-wrap-text-on-image/54190387#54190387", "title": "MiniMagick wrap text on image", "body": "<p>Sorry, I do not know Minimagick. But in ImageMagick command line there is label: that automatically fits text to some dimension such as the image width. See <a href=\"https://imagemagick.org/Usage/text/#label\" rel=\"nofollow noreferrer\">https://imagemagick.org/Usage/text/#label</a>. If MiniMagick does not support that directly, then perhaps you could use Ruby/Rmagick commands. See <a href=\"https://github.com/minimagick/minimagick\" rel=\"nofollow noreferrer\">https://github.com/minimagick/minimagick</a> (methods section), assuming RMagick supports a label: like method. Note that with label: and caption: you have to create a new image with with your text on a transparent background and then composite it over your original image.</p>\n\n<p>Here is an example:</p>\n\n<p>Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/esF9W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/esF9W.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>convert image.png \\( -size 639x -background none -font Arial -fill black label:\"The quick brown fox jumps over the lazy dog\" \\) -gravity center -compose over -composite result.png\n</code></pre>\n\n<p><br>\n<a href=\"https://i.stack.imgur.com/qc5Ce.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qc5Ce.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8021316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VYzjn.jpg?s=128&g=1", "display_name": "Michael Wiltbank", "link": "https://stackoverflow.com/users/8021316/michael-wiltbank"}, "is_accepted": false, "score": 0, "last_activity_date": 1586844269, "last_edit_date": 1586844269, "creation_date": 1586839431, "answer_id": 61200829, "question_id": 54188501, "link": "https://stackoverflow.com/questions/54188501/minimagick-wrap-text-on-image/61200829#61200829", "title": "MiniMagick wrap text on image", "body": "<p>You need to use Convert with MiniMagick and the syntax is a little tricky because there isn't many examples with Ruby for it.</p>\n\n<pre><code>caption_string = \"caption: #{top_txt}\"\n\nMiniMagick::Tool::Convert.new do |img|\n  img.gravity 'north'\n  img.stroke '#000000'\n  img.strokewidth 1\n  img.fill '#FFFFFF'\n  img.size \"#{img_width}x\"\n  img.pointsize '40' #don't add this if you want it to adjust according to size\n  img.font \"#{Rails.root.join('public', 'font',\n    'Franklin_Gothic_Heavy_Regular.ttf')}\"\n  img &lt;&lt; caption_string\n  img &lt;&lt; url_for(@post.image)\nend\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594431833, "creation_date": 1547496753, "last_edit_date": 1547502257, "question_id": 54188501, "link": "https://stackoverflow.com/questions/54188501/minimagick-wrap-text-on-image", "title": "MiniMagick wrap text on image", "body": "<p>On Rails 5.2.1, I am attempting to use MiniMagick to write text on an image. The problem is, it overflows beyond the bounds of the image's width for long texts.</p>\n\n<p>I have attempted to use <code>draw</code>, <code>label</code>, <code>annotation</code> and <code>caption</code> methods from <a href=\"https://www.imagemagick.org/Usage/text/#caption\" rel=\"nofollow noreferrer\">here</a> but none give me the right result. <code>caption</code> does not even add the text to the image.</p>\n\n<p>This is my code:</p>\n\n<pre><code>      temp_img = MiniMagick::Image.open(url_for(@post.image))\n      img_width = temp_img[:width]\n\n      temp_img.combine_options do |c|\n        c.gravity 'North'\n        c.draw \"text 0, 0 '#{top_txt}'\"\n        #c.annotate '0,0', \"'#{top_txt}'\" (same result)\n        #c.caption \"'#{top_txt}'\" (same result)\n        #c.label \"'#{top_txt}'\" (same result)\n        c.gravity 'South'\n        c.draw \"text 0, 0 '#{bot_txt}'\"\n        #c.annotate '0,0', \"'#{bot_txt}'\" (same result)\n        #c.caption \"'#{bot_txt}'\" (same result)\n        #c.label \"'#{bot_txt}'\" (same result)\n        c.stroke('#000000')\n        c.strokewidth 1\n        c.fill('#FFFFFF')\n        c.size \"#{img_width}x\"\n        c.pointsize '40'\n        c.font \"#{Rails.root.join('public', 'font',\n        'Franklin_Gothic_Heavy_Regular.ttf')}\"\n      end\n</code></pre>\n\n<p>This is my result:\n<a href=\"https://i.stack.imgur.com/kLFH0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kLFH0.png\" alt=\"enter image description here\"></a>\nThe closest I have seen to a solution is <a href=\"https://stackoverflow.com/a/26182303/3491653\">this</a> but is too messy. </p>\n\n<p>Could there be a better way?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1547490971, "post_id": 54186860, "comment_id": 95202745, "body": "Is your goal for the code not to write to a <code>.bin</code> file?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1547492043, "post_id": 54186860, "comment_id": 95203131, "body": "Why are you writing to files in the first place? Why not a database?"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547498582, "post_id": 54186860, "comment_id": 95205896, "body": "Like @tadman said, if you\u2019re making an MMORPG and not using databases then you\u2019re doing it wrong in every way. If you don\u2019t understand why then you\u2019re woefully ill-equipped to undertake the task at all, and I would recommend studying how existing systems work (for months or years) before attempting a project like this."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547498881, "post_id": 54186860, "comment_id": 95206010, "body": "Another thing to note here that&#39;s really important is, and I&#39;m bolding for emphasis, <b>NEVER, EVER STORE USER PASSWORDS AS PLAIN TEXT</b>. Always, and I mean <b>always</b> use a password-specific hashing method like <a href=\"https://en.wikipedia.org/wiki/Bcrypt\" rel=\"nofollow noreferrer\">Bcrypt</a>, something that&#39;s available as a <a href=\"https://rubygems.org/gems/bcrypt/versions/3.1.12\" rel=\"nofollow noreferrer\">Ruby gem</a> and is really easy to use. If this data leaks out and it has plain-text passwords in it you&#39;re endangering your users. If you leak properly hashed passwords you at least protect people from password attacks."}], "owner": {"user_type": "does_not_exist", "display_name": "user10913298"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1547488912, "creation_date": 1547488912, "question_id": 54186860, "link": "https://stackoverflow.com/questions/54186860/how-to-take-binary-encryption-from-this-script", "title": "How to take binary encryption from this script", "body": "<p>Hellom, me and my friends are creating an MMORPG, and the base that we're using have this script on database.rb. </p>\n\n<p>I'm doing a registration system for the website, but I need to make the server and game create files without having binary in the middle of the reading.</p>\n\n<pre><code>def self.create_account(user, pass, email)\n        registro = Binary_Writer.new\n        registro.write_string(pass)\n        registro.write_string(email)\n        registro.write_byte(Constants::GROUP_STANDARD)\n        # In that part, makes the save in binary.\n        file = File.open(\"Data/Accounts/#{user}.bin\", mode: 'wb')\n        file.write(registro.to_s)\n        file.close\n    end\n</code></pre>\n\n<p>I tried to learn and find where i need to change to doesn't use binary, i think, that is in the part that i commented on script.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "xml", "csv", "nokogiri", "export-to-csv"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547488264, "post_id": 54186558, "comment_id": 95201666, "body": "It&#39;s not clear what the problem is here. As always, try and break down this big problem into smaller ones so the solutions are simpler."}, {"owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547491805, "post_id": 54186558, "comment_id": 95203039, "body": "I am trying to parse the column header into the first row, and iterate the data from each of the node/record lining down like a traditional excel spreadsheet. As you can see from the screenshot, each of the record : column and data being extracted out from the code horizontally which its not what I am looking for. please advise."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547491992, "post_id": 54186558, "comment_id": 95203112, "body": "The CSV works in <code>csv &lt;&lt; row</code> form, so you may need to create a row incrementally before stuffing it into the <code>csv</code>. You should complete the row before adding it, not add bits and pieces as you go."}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1547497275, "post_id": 54186558, "comment_id": 95205333, "body": "It would help if you clarify the expected output - eg what CSV would you expect for this XML sample? I&#39;m guessing that you want each &quot;Put_Job_Profile_Request&quot; to be a row. However, I&#39;m not quite sure what the expect column headings are - specifically those in the &quot;Job_Profile_Basic_Data&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "edited": false, "score": 0, "creation_date": 1547519413, "post_id": 54189225, "comment_id": 95211628, "body": "oh wow... thanks alot! thats it! So looks like there is no need to use the library of CSV? I need to learn what else &quot;set&quot; do. You are amazing!"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "edited": false, "score": 0, "creation_date": 1547647138, "post_id": 54189225, "comment_id": 95262914, "body": "you always need to decide if you really need that extra dependency or not, in this case it seems not necessary, though rewriting parts of the CSV gem if you need more functionality would be bad also. If you need more info on a Set see here <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/set/rdoc/Set.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.5.3/libdoc/set/rdoc/Set.html</a>"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1547500128, "creation_date": 1547500128, "answer_id": 54189225, "question_id": 54186558, "link": "https://stackoverflow.com/questions/54186558/xml-to-csv-ruby/54189225#54189225", "title": "XML to CSV ruby", "body": "<p>You need to first build an array of hashes and extract the keys as headers and then put the values in the right column, all nodes flattened to columns, ignoring the root and record keys.</p>\n\n<p>Something like this</p>\n\n<pre><code>require 'nokogiri'\nrequire 'set'\n\nfile    = File.read('jobProfile.xml')\ndoc     = Nokogiri::XML(file)\nrecord  = {}\nkeys    = Set.new\nrecords = []\ncsv     = \"\"\n\ndoc.traverse do |node| \n  value = node.text.gsub(/\\n +/, '')\n  if node.name\n    if node.name != \"text\" # skip these nodes\n      if value.length &gt; 0 # skip empty nodes\n        key = node.name.gsub(/sd:/,'').to_sym\n        # if a new and not empty record, add to our records collection\n        if key == :Job_Profile_Data &amp;&amp; !record.empty?\n          records &lt;&lt; record\n          record = {}\n        elsif key[/Job_Profile|^root$|^document$/]\n          # neglect these keys\n        else\n          key = node.name.gsub(/sd:/,'').to_sym\n          # in case our value is html instead of text\n          record[key] = Nokogiri::HTML.parse(value).text\n          # add to our key set only if not allready in the set\n          keys &lt;&lt; key\n        end\n      end\n    end\n  end\nend\n\n# build our csv\nFile.open('./xmloutput.csv', 'w') do |file|\n  file.puts %Q{\"#{keys.to_a.join('\",\"')}\"}\n  records.each do |record|\n    keys.each do |key|\n      file.write %Q{\"#{record[key]}\",}\n    end\n    file.write \"\\n\"\n  end\nend\n</code></pre>\n\n<p>Which gives in our csv file the following</p>\n\n<pre><code>\"Job_Code\",\"Effective_Date\",\"Job_Title\",\"Inactive\",\"Include_Job_Code_in_Name\",\"Job_Description\",\"Additional_Job_Description\",\"Work_Shift_Required\",\"Public_Job\"\n\"30000\",\"1900-01-01\",\"Chief Executive Officer\",\"\",\"\",\"\",\"\",\"\",\"\",\n\"30100\",\"1900-01-01\",\"Administrator Job Profile\",\"\",\"\",\"\",\"\",\"\",\"\",\n\"30200\",\"1900-01-01\",\"Facilities &amp; Grounds Maintenance Attendant\",\"0\",\"0\",\"Job Description rich text!\",\"Additional Job Description rich text!\",\"0\",\"1\",\n\"30300\",\"1900-01-01\",\"Sample_Job_Title\",\"0\",\"0\",\"Sample Job Description\",\"Sample Additional Job Description\",\"1\",\"\",\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 54189225, "answer_count": 1, "score": 1, "last_activity_date": 1547500128, "creation_date": 1547487542, "last_edit_date": 1547492037, "question_id": 54186558, "link": "https://stackoverflow.com/questions/54186558/xml-to-csv-ruby", "title": "XML to CSV ruby", "body": "<p>I have multiple XML sample files and I would like to convert them in CSV, but there will be multiple of different attributes/nodes for different XML files therefore I dont want to hard code the different attributes. I would like the output to show column header as the first row, then each of the node/record being display vertically like a traditional column and row spreadsheet. \nHere is one the sample XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;sd:root xmlns:wd=\"urn:com.sample/bsvc\" sd:version=\"v31.0\"&gt;\n  &lt;sd:Put_Job_Profile_Request sd:Add_Only=\"0\"&gt;\n    &lt;sd:Job_Profile_Data&gt;\n      &lt;sd:Job_Code&gt;30000&lt;/sd:Job_Code&gt;\n      &lt;sd:Effective_Date&gt;1900-01-01&lt;/sd:Effective_Date&gt;\n      &lt;sd:Job_Profile_Basic_Data&gt;\n        &lt;sd:Job_Title&gt;Chief Executive Officer&lt;/sd:Job_Title&gt;\n      &lt;/sd:Job_Profile_Basic_Data&gt;\n    &lt;/sd:Job_Profile_Data&gt;\n  &lt;/sd:Put_Job_Profile_Request&gt;\n  &lt;sd:Put_Job_Profile_Request sd:Add_Only=\"0\"&gt;\n    &lt;sd:Job_Profile_Data&gt;\n      &lt;sd:Job_Code&gt;30100&lt;/sd:Job_Code&gt;\n      &lt;sd:Effective_Date&gt;1900-01-01&lt;/sd:Effective_Date&gt;\n      &lt;sd:Job_Profile_Basic_Data&gt;\n        &lt;sd:Job_Title&gt;Administrator Job Profile&lt;/sd:Job_Title&gt;\n      &lt;/sd:Job_Profile_Basic_Data&gt;\n    &lt;/sd:Job_Profile_Data&gt;\n  &lt;/sd:Put_Job_Profile_Request&gt;\n  &lt;sd:Put_Job_Profile_Request sd:Add_Only=\"0\"&gt;\n    &lt;sd:Job_Profile_Data&gt;\n      &lt;sd:Job_Code&gt;30200&lt;/sd:Job_Code&gt;\n      &lt;sd:Effective_Date&gt;1900-01-01&lt;/sd:Effective_Date&gt;\n      &lt;sd:Job_Profile_Basic_Data&gt;\n        &lt;sd:Inactive&gt;0&lt;/sd:Inactive&gt;\n        &lt;sd:Job_Title&gt;Facilities &amp;amp; Grounds Maintenance Attendant&lt;/sd:Job_Title&gt;\n        &lt;sd:Include_Job_Code_in_Name&gt;0&lt;/sd:Include_Job_Code_in_Name&gt;\n        &lt;sd:Job_Profile_Private_Title&gt;Maintenance Job Title&lt;/sd:Job_Profile_Private_Title&gt;\n        &lt;sd:Job_Profile_Summary&gt;Maintain cleanliness of the campus building throughout the day and fulfill special requests as needed.&lt;/sd:Job_Profile_Summary&gt;\n        &lt;sd:Job_Description&gt;&amp;lt;p&gt;Job Description&amp;lt;b&gt; rich text!&amp;lt;/b&gt;&amp;lt;/p&gt;&lt;/sd:Job_Description&gt;\n        &lt;sd:Additional_Job_Description&gt;&amp;lt;p&gt;&amp;lt;b&gt;&amp;lt;i&gt;&amp;lt;span class=\"emphasis-2\"&gt;&amp;lt;u&gt;Additional&amp;lt;/u&gt;&amp;lt;/span&gt;&amp;lt;/i&gt;&amp;lt;/b&gt; Job Description&amp;lt;b&gt; rich text!&amp;lt;/b&gt;&amp;lt;/p&gt;&lt;/sd:Additional_Job_Description&gt;\n        &lt;sd:Work_Shift_Required&gt;0&lt;/sd:Work_Shift_Required&gt;\n        &lt;sd:Public_Job&gt;1&lt;/sd:Public_Job&gt;    \n      &lt;/sd:Job_Profile_Basic_Data&gt;\n    &lt;/sd:Job_Profile_Data&gt;\n  &lt;/sd:Put_Job_Profile_Request&gt;\n  &lt;sd:Put_Job_Profile_Request sd:Add_Only=\"0\"&gt;\n    &lt;sd:Job_Profile_Data&gt;\n      &lt;sd:Job_Code&gt;30300&lt;/sd:Job_Code&gt;\n      &lt;sd:Effective_Date&gt;1900-01-01&lt;/sd:Effective_Date&gt;\n      &lt;sd:Job_Profile_Basic_Data&gt;\n        &lt;sd:Inactive&gt;0&lt;/sd:Inactive&gt;\n        &lt;sd:Job_Title&gt;Sample_Job_Title&lt;/sd:Job_Title&gt;\n        &lt;sd:Include_Job_Code_in_Name&gt;0&lt;/sd:Include_Job_Code_in_Name&gt;\n        &lt;sd:Job_Profile_Summary&gt;Sample Job Profile Summary&lt;/sd:Job_Profile_Summary&gt;\n        &lt;sd:Job_Description&gt;Sample Job Description&lt;/sd:Job_Description&gt;\n        &lt;sd:Additional_Job_Description&gt;Sample Additional Job Description&lt;/sd:Additional_Job_Description&gt;\n        &lt;sd:Work_Shift_Required&gt;1&lt;/sd:Work_Shift_Required&gt;\n      &lt;/sd:Job_Profile_Basic_Data&gt;\n    &lt;/sd:Job_Profile_Data&gt;\n  &lt;/sd:Put_Job_Profile_Request&gt;\n&lt;/sd:root&gt;\n</code></pre>\n\n<p>The code I used but come out incorrectly:</p>\n\n<pre><code>require 'csv'\nrequire 'nokogiri'\n\nfile = File.read('jobProfile.xml')\ndoc = Nokogiri::XML(file)\na = []\n\nCSV.open('xmloutput.csv', 'wb') do |csv|\n  csv &lt;&lt; doc.at('.').search('*').map(&amp;:name)\n  doc.search('.').each do |x|\n    csv &lt;&lt; x.search('*').map(&amp;:text)\n  end\nend\n</code></pre>\n\n<p>Each set of record with its column headers and data being set horizontally. But I would like to iterate the data and keep one row of column headers. I am not sure how to do that without hard coding each of the attributes :/\nPlease help as I am still new to programming, and I have tried to find solution for a week :(</p>\n\n<p><a href=\"https://i.stack.imgur.com/pXmx6.png\" rel=\"nofollow noreferrer\">screenshot showing the csv output</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 380, "user_id": 4781518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jtiKY.jpg?s=128&g=1", "display_name": "ydaniju", "link": "https://stackoverflow.com/users/4781518/ydaniju"}, "edited": false, "score": 0, "creation_date": 1547485715, "post_id": 54186085, "comment_id": 95200581, "body": "Please let&#39;s know your Rails version"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1547488198, "post_id": 54186085, "comment_id": 95201645, "body": "This sounds more like something that is in your views and which is not part of the framework. For example for the scaffolded views Rails adds: <code>&lt;h2&gt;&lt;%= pluralize(post.errors.count, &quot;error&quot;) %&gt; prohibited this post from being saved:&lt;&#47;h2&gt;</code>. This is application code and has nothing to do with ActiveModel::Errors."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1547488944, "post_id": 54186085, "comment_id": 95201950, "body": "It could also be a flash message which again has nothing to with ActiveModel::Errors. The Rails framework does not set any flash messages by default so if its not set in the the controller this might be from a gem such as Responders or Devise."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1547489076, "post_id": 54186085, "comment_id": 95202010, "body": "Please share how you display errors at the moment. Do you use a gem or a plugin? Or self-written views? Or do you use the <code>error_messages_for</code> view helper that came with old versions of Rails? Did you grep your project for the string <code>Correct the following errors</code>?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1547489125, "post_id": 54186085, "comment_id": 95202030, "body": "@spickermann Ah I forgot about that old trainwreck. :D"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1547488483, "post_id": 54186274, "comment_id": 95201758, "body": "Not sure this answers the question at all given <i>&quot;I&#39;m not asking how to change the (per-field) validation messages themselves...&quot;</i> in the original post. This seems to have to do with the view representation"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1547488127, "last_edit_date": 1547488127, "creation_date": 1547486289, "answer_id": 54186274, "question_id": 54186085, "link": "https://stackoverflow.com/questions/54186085/in-rails-how-can-i-change-the-text-before-validation-messages-correct-the-foll/54186274#54186274", "title": "In Rails, how can I change the text before validation messages &quot;Correct the following errors&quot;?", "body": "<p>For example #1</p>\n\n<pre><code>  validates :name,\n            presence: true,\n            length: { maximum: 70 },\n            format: { message: 'Please Correct the following errors' }\n</code></pre>\n\n<p>For example #2</p>\n\n<pre><code>   validate :custom_validation\n\n   def custom_validation\n     #validation stuffs\n     errors.add(:base, 'Please Correct the following errors')\n   end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 1483341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dccab126b0f5b7cc32138db594910a?s=128&d=identicon&r=PG", "display_name": "Nahrae", "link": "https://stackoverflow.com/users/1483341/nahrae"}, "is_accepted": false, "score": 0, "last_activity_date": 1547490792, "creation_date": 1547490792, "answer_id": 54187249, "question_id": 54186085, "link": "https://stackoverflow.com/questions/54186085/in-rails-how-can-i-change-the-text-before-validation-messages-correct-the-foll/54187249#54187249", "title": "In Rails, how can I change the text before validation messages &quot;Correct the following errors&quot;?", "body": "<p>This question is <strong>not reasonable</strong> one since Rails itself works like this.</p>\n\n<pre><code>lib/rails/generators/erb/scaffold/templates/_form.html.erb.tt:\n  1  &lt;%%= form_with(model: &lt;%= model_resource_name %&gt;, local: true) do |form| %&gt;\n  2    &lt;%% if &lt;%= singular_table_name %&gt;.errors.any? %&gt;\n  3      &lt;div id=\"error_explanation\"&gt;\n  4        &lt;h2&gt;&lt;%%= pluralize(&lt;%= singular_table_name %&gt;.errors.count, \"error\") %&gt;\n            prohibited this &lt;%= singular_table_name %&gt; from being saved:&lt;/h2&gt;\n</code></pre>\n"}], "owner": {"reputation": 17747, "user_id": 241142, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/dc690e6057d0756358e2d80409a945b1?s=128&d=identicon&r=PG", "display_name": "iconoclast", "link": "https://stackoverflow.com/users/241142/iconoclast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547501974, "creation_date": 1547485537, "last_edit_date": 1547501974, "question_id": 54186085, "link": "https://stackoverflow.com/questions/54186085/in-rails-how-can-i-change-the-text-before-validation-messages-correct-the-foll", "title": "In Rails, how can I change the text before validation messages &quot;Correct the following errors&quot;?", "body": "<p>I'm not asking how to change the (per-field) validation messages themselves&mdash;which is easy and well-documented&mdash;but the text that appears before them.  In the version of Rails I'm currently dealing with, this is \"Correct the following errors\".  I would like to add the word \"please\", to make the tone a little less demanding.  I've been unable to find anything in the Rails guides or by searching.  How do I do this?</p>\n\n<p>This current app is stuck at Rails 4.2.10 because of a gem not compatible with Rails 5.</p>\n\n<p>And yes, I searched the codebase several times for the string (and parts of it) that is appearing above the error messages. </p>\n"}, {"tags": ["c#", ".net", "ruby", "cryptography"], "comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 1, "creation_date": 1547487875, "post_id": 54185143, "comment_id": 95201507, "body": "What is the size of the ruby PBKDF2 key and iv? After <code>Base64.encode64()</code> the outputs are not the correct lengths. <code>OTIxODYxNzkxMjc=</code> is 13 bytes hex: <code>3932313836313739313237</code> which is not a correct length, the key is similarly incorrect. 1. The lengths are wrong: figure out why. 2. It looks like the Base64 decoded is double hex encoded which explains the non-random appearance: There are entirely to many <code>M</code> characters in the Base64. Anytime you start seeing patterns in random data there is a problem. it seems the problem is in the <code>join</code> and <code>encode</code> statements."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1547550500, "post_id": 54185143, "comment_id": 95221934, "body": "@zaph It&#39;s not hex, it looks just decimals. The PBKDF2 function by default only returned the hash length as well. If I&#39;m not mistaken <code>bytes[0, 15]</code> first retrieves the bytes and <i>then</i> splices the result (giving 15 bytes :) ). See my answer for more info."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1547555404, "post_id": 54185143, "comment_id": 95224405, "body": "Yeah, it looked like decimal but that just seemed to crazy."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1547555612, "post_id": 54185143, "comment_id": 95224537, "body": "Getting the decimal string representation of the bytes, then joining them and then interpreting them again as bytes <b>is crazy</b> but there you have it. Long live strong typing, if you ask me; languages that perform tricks like these should magic themselves out of existence (\\rant)."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1547555982, "post_id": 54185143, "comment_id": 95224736, "body": "Strong typing, worth the typing IMO. With hex I can see things that just aren&#39;t as apparent in decimal represented bytes."}], "answers": [{"comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1547546440, "post_id": 54196541, "comment_id": 95219804, "body": "Note that I&#39;m not a Ruby developer. All this is performed by just making sure that the functions do what you expect them to do. To develop any kind of secure code, you should be more vigilant. Double check."}, {"owner": {"reputation": 1568, "user_id": 53242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a13064c6c0caa41b1673abe51887c11f?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/53242/fred"}, "edited": false, "score": 0, "creation_date": 1547552479, "post_id": 54196541, "comment_id": 95222943, "body": "Thanks for your input Maarten, I&#39;ve updated my question"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 1568, "user_id": 53242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a13064c6c0caa41b1673abe51887c11f?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/53242/fred"}, "edited": false, "score": 1, "creation_date": 1547552786, "post_id": 54196541, "comment_id": 95223076, "body": "@Fred Never ever do that, you invalidate my answer by updating the question that way; it would not make sense to anybody else."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 1568, "user_id": 53242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a13064c6c0caa41b1673abe51887c11f?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/53242/fred"}, "edited": false, "score": 0, "creation_date": 1547553260, "post_id": 54196541, "comment_id": 95223324, "body": "@Fred There is only one parameter that is different from the Ruby PBKDF2 constructor and the constructor in the C# code. Actually, it is missing entirely. Can you find it and see what&#39;s wrong? Feel free to edit it into my answer."}, {"owner": {"reputation": 1568, "user_id": 53242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a13064c6c0caa41b1673abe51887c11f?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/53242/fred"}, "edited": false, "score": 0, "creation_date": 1547553737, "post_id": 54196541, "comment_id": 95223544, "body": "Thanks for editing my question. I don&#39;t see any diff : string and salt are the same, iterations is 1000 as the default for the c# class, I set sha1 as hash func like the one used bye the c# class and I specify 32 as key length because, from what I understand, calling GetBytes(16) twice is the same as calling GetBytes(32)"}], "tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": true, "score": 2, "last_activity_date": 1547554685, "last_edit_date": 1547554685, "creation_date": 1547546415, "answer_id": 54196541, "question_id": 54185143, "link": "https://stackoverflow.com/questions/54185143/translate-rfc2898derivebytes-in-ruby/54196541#54196541", "title": "Translate Rfc2898DeriveBytes in ruby", "body": "<p>There are at least 3 - [edit: now 4] - mistakes in the code:</p>\n\n<ul>\n<li><p>Most importantly and interestingly for StackOverflow, PBKDF2 is defined in Ruby to output the output size of the hash function in bytes to ensure it only runs once. However, SHA-1 outputs 160 bits while you (try to) ask for 2 * 16 = 32 bytes or 256 bits. So your IV runs out of bits.</p></li>\n<li><p>Secondly the encoding is wrong; <code>join</code> will simply concatenate the decimal value of the bytes it seems - I don't see why it is needed <em>at all</em>.</p></li>\n<li><p>When looking up how Ruby is doing the slicing, it seems that it uses <code>ary[start, length]</code> \u2192 <code>new_ary</code> or <code>nil</code>.</p></li>\n<li><p>Finally, your Ruby code specifies <code>10000</code> (better written as <code>10_000</code> to avoid stupid mistakes like these) instead of 1000 as iteration count (the badly defined and way too low C# default). Better update and indicate the iteration count in the C# code as well.</p></li>\n</ul>\n\n<p>It may be required to set the length and call <code>.bytes</code> just once on the result, and split it <em>afterwards</em> (as the bytes seem to differ it seems that the PKBDF2 implementation is smart enough to calculate the required result only once though - personally I don't like to be dependent on implementation specifics such as these).</p>\n"}], "owner": {"reputation": 1568, "user_id": 53242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a13064c6c0caa41b1673abe51887c11f?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/53242/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54196541, "answer_count": 1, "score": 1, "last_activity_date": 1547554685, "creation_date": 1547482294, "last_edit_date": 1547552746, "question_id": 54185143, "link": "https://stackoverflow.com/questions/54185143/translate-rfc2898derivebytes-in-ruby", "title": "Translate Rfc2898DeriveBytes in ruby", "body": "<p>I'm trying to translate a crypto algorithm from c# in ruby.</p>\n\n<p>First step is to create a key and an iv with a key derivation function:</p>\n\n<pre><code>    string myTestString = \"my_test_string\";\n\n    Rfc2898DeriveBytes rfcDb = new Rfc2898DeriveBytes(myTestString, System.Text.Encoding.UTF8.GetBytes(myTestString));\n\n    byte[] key = rfcDb.GetBytes(16);\n    byte[] iv = rfcDb.GetBytes(16);\n\n    Console.WriteLine(\"key =&gt; \" + Convert.ToBase64String(key)); \n    Console.WriteLine(\"iv =&gt;  \" + Convert.ToBase64String(iv));\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>key =&gt; rI9LR/UyZz5UuLQm1ujqDA==\niv =&gt;  DDBRWmlgAdOxIkVhvgluRA==\n</code></pre>\n\n<p>In ruby I use PBKDF2 gem and try to produce same values :</p>\n\n<pre><code>    my_test_string = \"my_test_string\";\n    rfc_db = PBKDF2.new(password: my_test_string, salt: my_test_string, iterations: 10000, hash_function: :sha1).bin_string\n\n    key = rfc_db.bytes[0, 15].join\n    iv = rfc_db.bytes[16, 32].join\n\n    puts \"key =&gt; \" + Base64.encode64(key)\n    puts \"iv =&gt; \" + Base64.encode64(iv)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>key =&gt; NjgxNzMxNjYxNDUyMDIxMjAxNjMxOTExOTEzMjYyMTYyMTQzMTkyMTc3\niv =&gt; OTIxODYxNzkxMjc=\n</code></pre>\n\n<hr>\n\n<p>Update according to answer, however the results still differ:</p>\n\n<pre><code>string myTestString = \"my_test_string\";\n\nRfc2898DeriveBytes rfcDb = new Rfc2898DeriveBytes(myTestString, System.Text.Encoding.UTF8.GetBytes(myTestString));\n\nbyte[] key = rfcDb.GetBytes(16);\nbyte[] iv = rfcDb.GetBytes(16);\n\nConsole.WriteLine(\"key =&gt; \" + OutputBytesArray(key));   \nConsole.WriteLine(\"iv =&gt;  \" + OutputBytesArray(iv));    \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>key =&gt; 172 143 75 71 245 50 103 62 84 184 180 38 214 232 234 12 \niv =&gt;  12 48 81 90 105 96 1 211 177 34 69 97 190 9 110 68\n</code></pre>\n\n<p>And for the Ruby code:</p>\n\n<pre><code>my_test_string = \"my_test_string\";\n\nrfc_db = PBKDF2.new(password: my_test_string, salt: my_test_string, iterations: 10000, hash_function: :sha1, key_length: 32).bin_string\n\nkey = rfc_db.bytes[0, 16]\niv = rfc_db.bytes[16, 16]\n\nputs \"key =&gt; \" + key.inspect\nputs \"iv =&gt; \" + iv.inspect\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>key =&gt; [68, 173, 166, 145, 202, 120, 163, 191, 191, 32, 62, 162, 143, 192, 177, 104]\niv =&gt; [92, 186, 179, 127, 42, 221, 74, 182, 148, 87, 217, 167, 109, 62, 54, 22]\n</code></pre>\n\n<hr>\n\n<p>Can someone explain me what I'm doing wrong ?</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1547484563, "creation_date": 1547484563, "answer_id": 54185813, "question_id": 54184447, "link": "https://stackoverflow.com/questions/54184447/how-do-i-call-the-capybara-input-set-method-on-the-seleniumwebdriverelem/54185813#54185813", "title": "How do I call the Capybara input `.set` method on the &quot;Selenium::WebDriver::Element&quot; instance returned from &quot;execute_script&quot;?", "body": "<p>You shouldn\u2019t be using <code>execute_script</code> to return things. If you instead use <code>evaluate_script</code> when returning items they should get wrapped automatically  </p>\n"}], "owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 54185813, "answer_count": 1, "score": 0, "last_activity_date": 1547484563, "creation_date": 1547479868, "question_id": 54184447, "link": "https://stackoverflow.com/questions/54184447/how-do-i-call-the-capybara-input-set-method-on-the-seleniumwebdriverelem", "title": "How do I call the Capybara input `.set` method on the &quot;Selenium::WebDriver::Element&quot; instance returned from &quot;execute_script&quot;?", "body": "<p>I use Capybara.<br>\nI call the <code>execute_script</code> to execute the JS code that returns some data including DOM nodes.<br>\nSome of these nodes are <code>&lt;input&gt;</code>s and I need to call the <code>.set</code> on them like I usually do when I search for them like <code>find(\"input\")</code>.</p>\n\n<p>But I get the</p>\n\n<pre><code>NoMethodError Exception: undefined method `set' for #&lt;Selenium::WebDriver::Element:\n</code></pre>\n\n<p>because it's not the <code>Capybara::Node::Element</code> class.</p>\n\n<p>Can I somehow cast the element to <code>Capybara::Node::Element</code> class to be able to call the method or should I do something else?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 4, "creation_date": 1547479183, "post_id": 54184249, "comment_id": 95196857, "body": "Please, show us what you tried."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1547480143, "post_id": 54184249, "comment_id": 95197441, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5006198/how-to-remove-all-elements-that-satisfy-a-condition-in-array-in-ruby\">How to remove all elements that satisfy a condition in array in Ruby?</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1547499289, "post_id": 54184249, "comment_id": 95206206, "body": "Sharp, one problem with your statement of the question was your choice of example. By making the array <code>[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]</code> readers might conclude you wanted to remove every third element rather than every element that equals a multiple of <code>3</code>. Also, always make it clear whether you want to return a new object and leave the original object unchanged, or modify (<i>mutate</i>) the original object."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1547512372, "post_id": 54184249, "comment_id": 95210193, "body": "Readers: if you believe the edited question is now clear, please consider voting to reopen. Note that the answer given by the OP is consistent with the current statement of the question."}], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 1, "creation_date": 1547479811, "post_id": 54184383, "comment_id": 95197252, "body": "This works. You might also want to look into the <code>reject!</code> method, which modifies the array variable."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1547661993, "post_id": 54184383, "comment_id": 95271608, "body": "It does not modify the array variable. It modifies the array. That is completely different. A thing and a name of a thing are two different things."}], "tags": [], "owner": {"reputation": 129, "user_id": 10890009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/he09E.jpg?s=128&g=1", "display_name": "Sharp_Ness", "link": "https://stackoverflow.com/users/10890009/sharp-ness"}, "is_accepted": false, "score": 7, "last_activity_date": 1547479638, "creation_date": 1547479638, "answer_id": 54184383, "question_id": 54184249, "link": "https://stackoverflow.com/questions/54184249/removing-elements-of-an-array-that-are-evenly-divisible-by-3/54184383#54184383", "title": "Removing elements of an array that are evenly divisible by 3", "body": "<p>Just found it:</p>\n\n<pre><code>array.reject{|a| a % 3 == 0}\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 10890009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/he09E.jpg?s=128&g=1", "display_name": "Sharp_Ness", "link": "https://stackoverflow.com/users/10890009/sharp-ness"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 1, "closed_date": 1547480143, "answer_count": 1, "score": -2, "last_activity_date": 1547487135, "creation_date": 1547479135, "last_edit_date": 1547487135, "question_id": 54184249, "link": "https://stackoverflow.com/questions/54184249/removing-elements-of-an-array-that-are-evenly-divisible-by-3", "closed_reason": "Needs more focus", "title": "Removing elements of an array that are evenly divisible by 3", "body": "<p>How can I remove elements from a given array of integers that are evenly divisible by 3? A new array should be returned and the original array should not be altered.</p>\n\n<p>For example, if</p>\n\n<pre><code>array = [1,2,3,4,1,5,2,6,7,8,9,10,7,11,12,13,14,15]\n</code></pre>\n\n<p>the array</p>\n\n<pre><code>[1, 2, 4, 1, 5, 2, 7, 8, 10, 7, 11, 13, 14]\n</code></pre>\n\n<p>should be returned.     </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1547482602, "post_id": 54184225, "comment_id": 95198898, "body": "Your problem is with naming and file location. Please edit your question to include the location of your <code>DataSource</code> and <code>RegisterKeycard</code> files."}, {"owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1547484179, "post_id": 54184225, "comment_id": 95199798, "body": "there are both in app/entities/keycard_generator/ folder @jvillian"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1547479275, "creation_date": 1547479275, "answer_id": 54184296, "question_id": 54184225, "link": "https://stackoverflow.com/questions/54184225/rails-autoload-dont-load-module/54184296#54184296", "title": "Rails autoload don&#39;t load module", "body": "<p>Mark the included module as global by prefixing the name with <code>::</code></p>\n\n<pre><code>class RegisterKeycard\n  include ::DataSource\n...\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "edited": false, "score": 0, "creation_date": 1547539701, "post_id": 54186208, "comment_id": 95216593, "body": "thank you for your answer. Is it always mandatory to use that convention ? Is there a way to avoid the nested &quot;module &gt; module &gt; module&quot; if there is a deep folder hierarchy ?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "edited": false, "score": 1, "creation_date": 1547571032, "post_id": 54186208, "comment_id": 95233576, "body": "If you want rails&#39; autoload to work correctly and you want to avoid <code>uninitialized constant</code> errors, then you are well advised to follow the convention. It is not, however, entirely required. You might want to take a look at <a href=\"https://urbanautomaton.com/blog/2013/08/27/rails-autoloading-hell/\" rel=\"nofollow noreferrer\">this article</a> or google around as I am confident there are many others."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1547486033, "creation_date": 1547486033, "answer_id": 54186208, "question_id": 54184225, "link": "https://stackoverflow.com/questions/54184225/rails-autoload-dont-load-module/54186208#54186208", "title": "Rails autoload don&#39;t load module", "body": "<p>Given that you have: </p>\n\n<pre><code>app/entities/keycard_generator/data_source.rb\n</code></pre>\n\n<p>Then the content of that file, by convention, should be: </p>\n\n<pre><code>module KeycardGenerator\n  module DataSource\n    ...\n  end\nend\n</code></pre>\n\n<p>Because rails essentially ignores the directory name under <code>app</code> (here, <code>entities</code>) in terms of naming: </p>\n\n<pre><code>app/entities/keycard_generator/data_source.rb\n    ^^^^^^^^\n</code></pre>\n\n<p>But expects the directory name under the directory under app (here, <code>keycard_generator</code>) to be a module name:</p>\n\n<pre><code>app/entities/keycard_generator/data_source.rb\n             ^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>And given that you have: </p>\n\n<pre><code>app/entities/keycard_generator/register_keycard.rb\n</code></pre>\n\n<p>Then the content of that file, by convention, should be: </p>\n\n<pre><code>module KeycardGenerator\n  class RegisterKeycard \n    include DataSource\n  end\nend\n</code></pre>\n\n<p>When following the convention, you do not need: </p>\n\n<pre><code>Dir[Rails.root.join('app/entities/keycard_generator/**/*.rb')].each(&amp;method(:require))\n</code></pre>\n\n<p>Personally, I like to append the type (here, indicated by <code>entities</code>) to the files and modules/classes, like: </p>\n\n<pre><code>app/entities/keycard_generator/data_source_entity.rb\nmodule KeycardGenerator\n  module DataSourceEntity\n    ...\n  end\nend\n</code></pre>\n\n<p>Which is how rails often (e.g., with <code>controller</code>) but not always (e.g., with <code>model</code>) does it.</p>\n\n<p>In which case you would also do:</p>\n\n<pre><code>app/entities/keycard_generator/register_keycard_entity.rb\nmodule KeycardGenerator\n  class RegisterKeycardEntity\n    include DataSourceEntity\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1547486033, "creation_date": 1547479047, "last_edit_date": 1547481241, "question_id": 54184225, "link": "https://stackoverflow.com/questions/54184225/rails-autoload-dont-load-module", "title": "Rails autoload don&#39;t load module", "body": "<p>In my rails app, I have a custom directory in <code>app/entities/keycard_generator/</code></p>\n\n<p>I have a data_source.rb (a module) and register_keycard.rb (a class)</p>\n\n<pre><code>module DataSource\n  ...\nend\n\nclass RegisterKeycard\n  include DataSource\n...\nend\n</code></pre>\n\n<p>I have added this line in my application.rb, to autoload the path.</p>\n\n<pre><code>Dir[Rails.root.join('app/entities/keycard_generator/**/*.rb')].each(&amp;method(:require))\n</code></pre>\n\n<p>But I get this errors (cannot run rails) :</p>\n\n<pre><code>uninitialized constant RegisterKeycard::DataSource (NameError)\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>I think that the issue is only with modules</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 2492, "user_id": 5085788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bWlXI.jpg?s=128&g=1", "display_name": "luisenrike", "link": "https://stackoverflow.com/users/5085788/luisenrike"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1547483590, "post_id": 54184768, "comment_id": 95199468, "body": "Thanks @SRack, I didn&#39;t know if he wanted to shuffle the elements per block, it does add more randomness to the array. In respect to the <code>upto</code>, it doesn&#39;t need an <code>each</code> (<a href=\"https://ruby-doc.org/core-2.2.0/Integer.html#method-i-upto\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/Integer.html#method-i-upto</a>)"}, {"owner": {"reputation": 143, "user_id": 10905099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6945145041be856e182858a158cffe5?s=128&d=identicon&r=PG&f=1", "display_name": "Gdebrig", "link": "https://stackoverflow.com/users/10905099/gdebrig"}, "edited": false, "score": 0, "creation_date": 1547490643, "post_id": 54184768, "comment_id": 95202620, "body": "Thank you so much for the effort! Works great"}], "tags": [], "owner": {"reputation": 2492, "user_id": 5085788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bWlXI.jpg?s=128&g=1", "display_name": "luisenrike", "link": "https://stackoverflow.com/users/5085788/luisenrike"}, "is_accepted": false, "score": 3, "last_activity_date": 1547483760, "last_edit_date": 1547483760, "creation_date": 1547480976, "answer_id": 54184768, "question_id": 54184131, "link": "https://stackoverflow.com/questions/54184131/how-to-give-an-order-to-some-values-in-a-multiple-class-array-in-rails/54184768#54184768", "title": "How to give an order to some values in a multiple Class array in Rails?", "body": "<p>You could do something like:</p>\n\n<pre><code>@streams = custom_order(Products.all, Lists.all, Posts.all)\n\ndef custom_order(products, lists, posts)\n  products_blocks = products.in_groups_of(20, false)\n  lists_blocks = lists.in_groups_of(2, false)\n  posts_blocks = posts.in_groups_of(1, false)\n\n  result = []\n\n  biggest_array = [products_blocks.length, lists_blocks.length, posts_blocks.length].max\n\n  1.upto(biggest_array) do |_|\n    # here we're pushing the blocks, result will be something like [[product, product .. product] [list, list] [posts]]\n    result &lt;&lt; products_blocks.shift\n    result &lt;&lt; lists_blocks.shift\n    result &lt;&lt; posts_blocks.shift\n    # is ok if one of the blocks is nil, we'll use compact later\n  end\n\n  # result =&gt; [[product product product] [list list] [post] [product product] [list] nil]\n  # compact to remove the nils\n  # result =&gt; [[product product product] [list list] [post] [product product] [list]]\n  # after flatten\n  # result =&gt; [product product product list list post product product list]\n  result.compact.flatten\nend\n</code></pre>\n\n<p><strong>EDIT:</strong> changed compact and flatten</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 10905099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6945145041be856e182858a158cffe5?s=128&d=identicon&r=PG&f=1", "display_name": "Gdebrig", "link": "https://stackoverflow.com/users/10905099/gdebrig"}, "edited": false, "score": 0, "creation_date": 1547490664, "post_id": 54184847, "comment_id": 95202624, "body": "Thank Aleksei, it&#39;s perfectly dry and elegant."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 143, "user_id": 10905099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6945145041be856e182858a158cffe5?s=128&d=identicon&r=PG&f=1", "display_name": "Gdebrig", "link": "https://stackoverflow.com/users/10905099/gdebrig"}, "edited": false, "score": 0, "creation_date": 1547491360, "post_id": 54184847, "comment_id": 95202889, "body": "It would probably make sense to calculate ratios dynamically."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1547482153, "last_edit_date": 1547482153, "creation_date": 1547481255, "answer_id": 54184847, "question_id": 54184131, "link": "https://stackoverflow.com/questions/54184131/how-to-give-an-order-to-some-values-in-a-multiple-class-array-in-rails/54184847#54184847", "title": "How to give an order to some values in a multiple Class array in Rails?", "body": "<p>I would use probabilities and a native ruby enumerator:</p>\n\n<pre><code>@streams =\n  [Product, List, Post].map(&amp;:all).map(&amp;:shuffle)\n\ntype =\n  case rand 23\n  when 0..19 then 0\n  when 20..21 then 1\n  else 2\n  end\n\n@streams[type].pop # pop one element from the respective array\n</code></pre>\n\n<p>This has a drawback one type might end before others and you probably will need to explicitly check for this and use <em>still non-exhausted</em> types, but it seems to be better than an explicit 1-per-2-per-20 because it still has a pseudo-random order to some extent.</p>\n"}], "owner": {"reputation": 143, "user_id": 10905099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6945145041be856e182858a158cffe5?s=128&d=identicon&r=PG&f=1", "display_name": "Gdebrig", "link": "https://stackoverflow.com/users/10905099/gdebrig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54184847, "answer_count": 2, "score": 2, "last_activity_date": 1547483760, "creation_date": 1547478726, "question_id": 54184131, "link": "https://stackoverflow.com/questions/54184131/how-to-give-an-order-to-some-values-in-a-multiple-class-array-in-rails", "title": "How to give an order to some values in a multiple Class array in Rails?", "body": "<p>I have an Array, composed by multiple Class objects, sorted by shuffle :</p>\n\n<pre><code>@streams = (Product.all + List.all + Post.all).shuffle\n</code></pre>\n\n<p>In a feed page (like the timeline page on Facebook), the content of the object is displayed with .each, and on each Class, a specific partial is applied :</p>\n\n<pre><code>@streams.each do |stream|\n  &lt;% if stream.is_a?(Product) %&gt;\n   &lt;%= render 'product_partial', object: stream %&gt;\n  &lt;% elsif stream.is_a?(List) %&gt;\n   &lt;%= render 'list_partial', object: stream %&gt;\n  &lt;% end %&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>Goal : because there is in the app a lot of Products (e.g : 200), and less Posts (100) and even less Lists (10), I want to give an order to each content, with the Class. With this, the Posts &amp; Lists will not be drowned on Products.</p>\n\n<p>In one sentence : for 20 products, show 2 posts, 1 list.</p>\n\n<p>Any ideas ?\nMany thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "syntax-error", "spree"], "answers": [{"tags": [], "owner": {"reputation": 2492, "user_id": 5085788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bWlXI.jpg?s=128&g=1", "display_name": "luisenrike", "link": "https://stackoverflow.com/users/5085788/luisenrike"}, "is_accepted": true, "score": 0, "last_activity_date": 1547478969, "creation_date": 1547478969, "answer_id": 54184207, "question_id": 54183869, "link": "https://stackoverflow.com/questions/54183869/why-am-i-gettingsyntaxerror-in-spreeusersessionscontrollernew-when-install-sp/54184207#54184207", "title": "Why am I gettingSyntaxError in Spree::UserSessionsController#new when install spree?", "body": "<p>The problem is that the line #5 is using the old syntax and you're probably using a newer version of ruby.</p>\n\n<pre><code>prepend_before_filter only: [:create, :destroy] { request.env[\"devise.skip_timeout\"] = true }\n</code></pre>\n\n<p>It should be (notice the <code>()</code>)</p>\n\n<pre><code>prepend_before_filter(only: [:create, :destroy]) { request.env[\"devise.skip_timeout\"] = true }\n</code></pre>\n\n<p>devise change it here:</p>\n\n<p><a href=\"https://github.com/plataformatec/devise/commit/53957d921b01e993222def6c051901bb4cbe4be9\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/commit/53957d921b01e993222def6c051901bb4cbe4be9</a></p>\n"}], "owner": {"reputation": 63, "user_id": 10658300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6f164d3ffc4a040412c552ed693bc0?s=128&d=identicon&r=PG&f=1", "display_name": "pfc", "link": "https://stackoverflow.com/users/10658300/pfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 54184207, "answer_count": 1, "score": 1, "last_activity_date": 1547478969, "creation_date": 1547477864, "question_id": 54183869, "link": "https://stackoverflow.com/questions/54183869/why-am-i-gettingsyntaxerror-in-spreeusersessionscontrollernew-when-install-sp", "title": "Why am I gettingSyntaxError in Spree::UserSessionsController#new when install spree?", "body": "<p>I have one old rails app which I reopen nowadays and want to figure out why am I getting this syntax error. I'm convinced that it's have some connections with ruby or rails version</p>\n\n<pre><code>gem 'spree', '3.0.0'\ngem 'spree_gateway', github: 'spree/spree_gateway', branch: '3-0-stable'\ngem 'spree_auth_devise', github: 'spree/spree_auth_devise', branch: '3-0-stable'\ngem 'spree_static_content', github: 'spree-contrib/spree_static_content', branch: '3-0-stable'\n</code></pre>\n\n<p>It works until try to login or try to go to admin panel. Everytime got same error: </p>\n\n<blockquote>\n  <p>SyntaxError in Spree::UserSessionsController#new</p>\n  \n  <p>MyProjects/vendor/bundle/gems/devise-3.5.10/app/controllers/devise/sessions_controller.rb:5:\n  syntax error, unexpected '}', expecting keyword_end\n  ...\"devise.skip_timeout\"] = true } ... ^</p>\n</blockquote>\n\n<p>sessions_controller.rb</p>\n\n<pre><code>class Devise::SessionsController &lt; DeviseController\n  prepend_before_filter :require_no_authentication, only: [:new, :create]\n  prepend_before_filter :allow_params_authentication!, only: :create\n  prepend_before_filter :verify_signed_out_user, only: :destroy\n  prepend_before_filter only: [:create, :destroy] { request.env[\"devise.skip_timeout\"] = true }\n\n  # GET /resource/sign_in\n  def new\n    self.resource = resource_class.new(sign_in_params)\n    clean_up_passwords(resource)\n    yield resource if block_given?\n    respond_with(resource, serialize_options(resource))\n  end\n\n  # POST /resource/sign_in\n  def create\n    self.resource = warden.authenticate!(auth_options)\n    set_flash_message(:notice, :signed_in) if is_flashing_format?\n    sign_in(resource_name, resource)\n    yield resource if block_given?\n    respond_with resource, location: after_sign_in_path_for(resource)\n  end\n\n  # DELETE /resource/sign_out\n  def destroy\n    signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name))\n    set_flash_message :notice, :signed_out if signed_out &amp;&amp; is_flashing_format?\n    yield if block_given?\n    respond_to_on_destroy\n  end\n\n  protected\n\n  def sign_in_params\n    devise_parameter_sanitizer.sanitize(:sign_in)\n  end\n\n  def serialize_options(resource)\n    methods = resource_class.authentication_keys.dup\n    methods = methods.keys if methods.is_a?(Hash)\n    methods &lt;&lt; :password if resource.respond_to?(:password)\n    { methods: methods, only: [:password] }\n  end\n\n  def auth_options\n    { scope: resource_name, recall: \"#{controller_path}#new\" }\n  end\n\n  def translation_scope\n    'devise.sessions'\n  end\n\n  private\n\n  # Check if there is no signed in user before doing the sign out.\n  #\n  # If there is no signed in user, it will set the flash message and redirect\n  # to the after_sign_out path.\n  def verify_signed_out_user\n    if all_signed_out?\n      set_flash_message :notice, :already_signed_out if is_flashing_format?\n\n      respond_to_on_destroy\n    end\n  end\n\n  def all_signed_out?\n    users = Devise.mappings.keys.map { |s| warden.user(scope: s, run_callbacks: false) }\n\n    users.all?(&amp;:blank?)\n  end\n\n  def respond_to_on_destroy\n    # We actually need to hardcode this as Rails default responder doesn't\n    # support returning empty response on GET request\n    respond_to do |format|\n      format.all { head :no_content }\n      format.any(*navigational_formats) { redirect_to after_sign_out_path_for(resource_name) }\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1547488016, "post_id": 54183832, "comment_id": 95201572, "body": "<code>@klass</code> should be an actual class, not just a name. <code>@klass</code> is set in a couple other classes/modules that are extended/included into <code>ActiveRecord::Base</code> so hunt around the whole directory for &quot;klass&quot;, set some breakpoints in likely places, and step through the code in a debugger. There is a lot of action-at-a-distince in the Rails source and it is rather complex, good luck."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1547490181, "post_id": 54183832, "comment_id": 95202430, "body": "@muistooshort is spot on. That module is the holy grail of brain melting meta-magic."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1547491983, "post_id": 54183832, "comment_id": 95203110, "body": "@max Don&#39;t you mean <a href=\"https://www.youtube.com/watch?v=YcR9k8o4I0w\" rel=\"nofollow noreferrer\">&quot;ark&quot;</a>? Whatever you do, don&#39;t look at it!"}], "owner": {"reputation": 6329, "user_id": 178728, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WEcsM.jpg?s=128&g=1", "display_name": "kstratis", "link": "https://stackoverflow.com/users/178728/kstratis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1547477734, "creation_date": 1547477734, "question_id": 54183832, "link": "https://stackoverflow.com/questions/54183832/whats-klass-inside-activerecorddelegation-module", "title": "What&#39;s @klass inside ActiveRecord::Delegation module?", "body": "<p>With respect to this post: \n<a href=\"https://stackoverflow.com/questions/21681107/how-can-an-activerecordrelation-object-call-class-methods\">How can an ActiveRecord::Relation object call class methods</a>,</p>\n\n<p>I was skimming through the code of the <code>ActiveRecord::Delegation</code> <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/delegation.rb\" rel=\"nofollow noreferrer\">module</a> but still can't figure out what <code>@klass</code> refers to inside the nested module <code>ClassSpecificRelation</code>. </p>\n\n<p>I'm suspecting it's the class name of my model (Person, Job, whatever) but can't be sure. And where does it come from?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1547477930, "post_id": 54183819, "comment_id": 95196136, "body": "Maybe it is because <code>:show</code> does not <code>:set_job</code>? See <code>before_action :set_job, except: [:index, :new, :create, :show]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "edited": false, "score": 0, "creation_date": 1547479960, "post_id": 54183966, "comment_id": 95197332, "body": "I have added as per your suggestion and updated my code above but still no luck ?"}], "tags": [], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "is_accepted": false, "score": 1, "last_activity_date": 1547478211, "creation_date": 1547478211, "answer_id": 54183966, "question_id": 54183819, "link": "https://stackoverflow.com/questions/54183819/ruby-on-rails-nomethoderror-in-my-controller-undefined-method-user-id-for-nil/54183966#54183966", "title": "Ruby-on-Rails NoMethodError in my controller undefined method `user_id&#39; for nil:NilClass", "body": "<p>Make sure you set_job for listing actiton</p>\n\n<p>You may need to add to the listing action directly</p>\n\n<pre><code>@job = current_user.job\n</code></pre>\n\n<p>or the better way to add it to before action of listing action and take order into consideration </p>\n"}, {"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1547483806, "creation_date": 1547483806, "answer_id": 54185597, "question_id": 54183819, "link": "https://stackoverflow.com/questions/54183819/ruby-on-rails-nomethoderror-in-my-controller-undefined-method-user-id-for-nil/54185597#54185597", "title": "Ruby-on-Rails NoMethodError in my controller undefined method `user_id&#39; for nil:NilClass", "body": "<p>Looks like your <code>is_authorised</code> method is looking for <code>@job</code>, which isn't set in your controller; rather, you assign <code>@jobs_dev</code>.</p>\n\n<p>Update the method to the following:</p>\n\n<pre><code>def is_authorised\n  redirect_to root_path, alert: \"You don't have permission...\" unless current_user.id == @jobs_dev.user_id\nend\n</code></pre>\n\n<p>I'm not sure that's sufficient, as you're skipping setting this in your <code>before_action</code>:</p>\n\n<pre><code>before_action :set_jobs_dev , except: [:index, :new, :create, :show, :edit, :listing]\n</code></pre>\n\n<p>It looks as if you'll need to remove <code>:listing</code> from the <code>except</code> clause there.</p>\n\n<p>Try both of these things and it should work again. Let me know if you've any questions or have any issues with this :)</p>\n"}], "owner": {"reputation": 209, "user_id": 10455122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157728488209348/picture?type=large", "display_name": "project_kingz", "link": "https://stackoverflow.com/users/10455122/project-kingz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547483806, "creation_date": 1547477666, "last_edit_date": 1547479836, "question_id": 54183819, "link": "https://stackoverflow.com/questions/54183819/ruby-on-rails-nomethoderror-in-my-controller-undefined-method-user-id-for-nil", "title": "Ruby-on-Rails NoMethodError in my controller undefined method `user_id&#39; for nil:NilClass", "body": "<p>My ruby application is throwing an error which has appeared all of a sudden. the error thrown is NoMethodError in JobsDevsController # listing=> undefined method `user_id' for nil:NilClass</p>\n\n<p>The part of my code that throws this error in my controller is </p>\n\n<pre><code>def is_authorised\n      redirect_to root_path, alert: \"You don't have permission...\" unless current_user.id == @job.user_id\n    end\n</code></pre>\n\n<p>My Controller </p>\n\n<pre><code>class JobsDevsController &lt; ApplicationController\n  before_action :set_jobs_dev , except: [:index, :new, :create, :show, :edit, :listing]\n  before_action :authenticate_user!, except: [:show, :listing]\n  before_action :is_authorised, only: [:listing, :budget, :description, :photo_upload, :location, :update, :show ]\n\n  # GET /jobs_devs\n  def index\n    @jobs_devs = JobsDev.all\n  end\n\n  # GET /jobs_devs/1\n  def show\n  end\n\n  # GET /jobs_devs/new\n  def new\n    @jobs_dev = current_user.jobs_devs.build\n  end\n\n  # def listing\n  #   @jobs_dev = current_user.jobs_dev\n  # end\n\n  # GET /jobs_devs/1/edit\n  def edit\n  end\n\n  def budget\n  end\n\n  # POST /jobs_devs\n  def create\n    @jobs_dev = current_user.jobs_devs.build(jobs_dev_params)\n\n    if @jobs_dev.save!\n      redirect_to listing_jobs_dev_path(@jobs_dev), notice: 'Jobs dev was successfully created.'\n    else\n      render :new\n    end\n  end\n\n  # PATCH/PUT /jobs_devs/1\n  # def update\n  #   if @jobs_dev.update(jobs_dev_params)\n  #     redirect_to @jobs_dev, notice: 'Jobs dev was successfully updated.'\n  #   else\n  #     render :edit\n  #   end\n  # end\n\n  def update\n  respond_to do |format|\n    if @jobs_dev.update(jobs_dev_params)\n      format.html { redirect_to @jobs_dev, notice: 'Post was successfully updated.' }\n      format.json { render :show, status: :ok, location: @jobs_dev }\n    else\n      format.html { render :edit }\n      format.json { render json: @jobs_dev.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\n  # DELETE /jobs_devs/1\n  def destroy\n    @jobs_dev.destroy\n    redirect_to jobs_devs_url, notice: 'Jobs dev was successfully destroyed.'\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_jobs_dev\n      @jobs_dev = JobsDev.find(params[:id])\n    end\n\n    def is_authorised\n      redirect_to root_path, alert: \"You don't have permission...\" unless current_user.id == @jobs_dev.user_id\n    end\n\n\n    # Only allow a trusted parameter \"white list\" through.\n    def jobs_dev_params\n      params.require(:jobs_dev).permit(:job_category, :job_type, :job_title, :job_description, :recurrence,\n                                        :budget, images: []\n      )\n    end\nend\n</code></pre>\n\n<p>Please can you help with this senario</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 4899057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ocrp7ClEgE0/AAAAAAAAAAI/AAAAAAAAAGc/ZRb4SBwuPWw/photo.jpg?sz=128", "display_name": "Evan Ross", "link": "https://stackoverflow.com/users/4899057/evan-ross"}, "edited": false, "score": 0, "creation_date": 1547478889, "post_id": 54183845, "comment_id": 95196702, "body": "unfortunately it doesn&#39;t work for me because I use a little bit more complicated structure and I need to send an argument <code>car</code> to the <code>CarChecker.new(car)</code> constructor on every iteration"}], "tags": [], "owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "is_accepted": false, "score": 1, "last_activity_date": 1547479239, "last_edit_date": 1547479239, "creation_date": 1547477776, "answer_id": 54183845, "question_id": 54183774, "link": "https://stackoverflow.com/questions/54183774/what-is-the-best-way-for-caching-database-query-for-the-service-object-inside-th/54183845#54183845", "title": "What is the best way for caching database query for the Service Object inside the iterations?", "body": "<p>You often see methods assigning to instance variables for caching like this.</p>\n\n<pre><code>def list_of_available_cars\n  @allcars ||= AvailableCar.all.map { ... }\nend\n</code></pre>\n\n<p>The first time <code>list_of_available_cars</code> is called, <code>AvailableCars.all...</code> will be executed, and the result stored in an instance variable. Subsequent times, the stored value will be returned.</p>\n\n<p>For it to work this way, you would need to be reusing the same instance of the service class.</p>\n\n<pre><code>checker = CarChecker.new\ncars.each do |car|\n  checker.car_is_available?(car)\nend\n</code></pre>\n\n<p>If you must use a new instance of <code>CarChecker</code> each time, then you can use a class variable instead of an instance variable (i.e. use <code>@@</code> instead of <code>@</code>):</p>\n\n<pre><code>def list_of_available_cars\n  @@allcars ||= AvailableCar.all.map { ... }\nend\n</code></pre>\n\n<p>As long as your <code>AvailableCar.all.map { ... }</code> is always going to return the same result, that should be fine.</p>\n"}], "owner": {"reputation": 685, "user_id": 4899057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ocrp7ClEgE0/AAAAAAAAAAI/AAAAAAAAAGc/ZRb4SBwuPWw/photo.jpg?sz=128", "display_name": "Evan Ross", "link": "https://stackoverflow.com/users/4899057/evan-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547479239, "creation_date": 1547477496, "question_id": 54183774, "link": "https://stackoverflow.com/questions/54183774/what-is-the-best-way-for-caching-database-query-for-the-service-object-inside-th", "title": "What is the best way for caching database query for the Service Object inside the iterations?", "body": "<p>I have a rails Service Object - CarChecker and model AvailableCar:</p>\n\n<pre><code>class CarChecker\n  def car_is_available?(car)\n    list_of_available_cars.include?(car)\n  end\n\n  def list_of_available_cars\n    AvailableCar.all.map { ... }\n  end\nend\n</code></pre>\n\n<p>Then I check every car somewhere in controller</p>\n\n<pre><code>cars.each do |car|\n  CarChecker.new().car_is_available?(car)\nend\n</code></pre>\n\n<p>How can I avoid of sending request <code>AvailableCar.all</code> for every iteration and send it only once? What is the best way for caching such kind of behavior?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547481521, "post_id": 54182926, "comment_id": 95198268, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2515931/how-can-i-download-a-file-from-a-url-and-save-it-in-rails\">How can I download a file from a URL and save it in Rails?</a>"}, {"owner": {"reputation": 1, "user_id": 10911608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ah64iCZWPP0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbAKPtFerbdSSNm6aKmkpyaauMq8w/mo/photo.jpg?sz=128", "display_name": "adarsh kl", "link": "https://stackoverflow.com/users/10911608/adarsh-kl"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1547537283, "post_id": 54182926, "comment_id": 95215640, "body": "@tadman need help pls"}, {"owner": {"reputation": 1, "user_id": 10911608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ah64iCZWPP0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbAKPtFerbdSSNm6aKmkpyaauMq8w/mo/photo.jpg?sz=128", "display_name": "adarsh kl", "link": "https://stackoverflow.com/users/10911608/adarsh-kl"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547539616, "post_id": 54182926, "comment_id": 95216562, "body": "@anothermh need help pls"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1547540452, "post_id": 54182926, "comment_id": 95216903, "body": "Welcome to stackoverflow. If you need help then you need to ask a specific question. It&#39;s not enough to say you&#39;re confused and post a bunch of code. Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">this</a>."}, {"owner": {"reputation": 1, "user_id": 10911608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ah64iCZWPP0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbAKPtFerbdSSNm6aKmkpyaauMq8w/mo/photo.jpg?sz=128", "display_name": "adarsh kl", "link": "https://stackoverflow.com/users/10911608/adarsh-kl"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1547557589, "post_id": 54182926, "comment_id": 95225550, "body": "@anothermh i edit my question ,pls need help"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10911608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ah64iCZWPP0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbAKPtFerbdSSNm6aKmkpyaauMq8w/mo/photo.jpg?sz=128", "display_name": "adarsh kl", "link": "https://stackoverflow.com/users/10911608/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1547537004, "post_id": 54185936, "comment_id": 95215554, "body": "i install activestorage using(rails active_storage:install) and then give a form to add url &lt;%= form_for(@download, url: downloads_path) do |f| %&gt; &lt;%= f.text_field :image_url %&gt; &lt;%=f.submit%&gt; &lt;% end %&gt; but it not storing image,It storing only image data  tanks for help me, but i want image should store local dick(computer)."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 1, "user_id": 10911608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ah64iCZWPP0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbAKPtFerbdSSNm6aKmkpyaauMq8w/mo/photo.jpg?sz=128", "display_name": "adarsh kl", "link": "https://stackoverflow.com/users/10911608/adarsh-kl"}, "edited": false, "score": 0, "creation_date": 1547559319, "post_id": 54185936, "comment_id": 95226448, "body": "<a href=\"https://guides.rubyonrails.org/active_storage_overview.html#disk-service\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1547489463, "last_edit_date": 1547489463, "creation_date": 1547485057, "answer_id": 54185936, "question_id": 54182926, "link": "https://stackoverflow.com/questions/54182926/how-can-i-download-an-internet-image-from-a-url-and-save-it-in-locally-in-rails/54185936#54185936", "title": "How can I download an internet image from a URL and save it in locally in Rails?", "body": "<p>If you are using <a href=\"https://guides.rubyonrails.org/active_storage_overview.html\" rel=\"nofollow noreferrer\">ActiveStorage</a> (which I would recommend) you can use <a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#attaching-file-io-objects\" rel=\"nofollow noreferrer\"><code>.attach</code></a> to attach an IO stream to a record.</p>\n\n<p>given:</p>\n\n<pre><code>class Download &lt; ApplicationRecord\n  has_one_attached :image\nend\n</code></pre>\n\n<p>From the rails console you can download a file and attach it with:</p>\n\n<pre><code>require 'open-uri'\nuri = 'http://www.shopprod.com/assets/photos/ishop-718755d2bc62956994c867681b2622e77b4c9af3d1ecd6fa856127b704a459b2.png'\ndownload = Download.new\ndownload.image.attach(io: open(uri), filename: uri.split('/').last)\n</code></pre>\n\n<p>However you can't just toss it whilly-nilly into your model class and expect it to work. The class body is executed when the class is read.</p>\n\n<p>Instead you need to put it into a method and call it at the correct point.</p>\n\n<pre><code>class Download &lt; ApplicationRecord\n  has_one_attached :image\n  def download_image!\n    require 'open-uri'\n    image.attach(\n      io: open(self.image_url), \n      filename: self.image_url.split('/').last\n    )\n  end\nend\n</code></pre>\n\n<hr>\n\n<pre><code>class DownloadsController &lt; ApplicationController\n  def create\n    @download = Download.new(download_params)\n    if !@download.image.attached? &amp;&amp; @download.image_url\n      @download.download_image!\n      # @todo handle errors \n    end\n    if @download.save\n      redirect_to @download\n    else \n      render :new\n    end\n  end\n\n  def download_params\n    params.require(:download)\n          .permit(:image, :image_url)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10911608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ah64iCZWPP0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbAKPtFerbdSSNm6aKmkpyaauMq8w/mo/photo.jpg?sz=128", "display_name": "adarsh kl", "link": "https://stackoverflow.com/users/10911608/adarsh-kl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1547557539, "creation_date": 1547474320, "last_edit_date": 1547557539, "question_id": 54182926, "link": "https://stackoverflow.com/questions/54182926/how-can-i-download-an-internet-image-from-a-url-and-save-it-in-locally-in-rails", "title": "How can I download an internet image from a URL and save it in locally in Rails?", "body": "<p>How can I download an internet image from a URL and save it in locally in Rails?</p>\n\n<p>i give a form to add image url <a href=\"https://i.stack.imgur.com/qrEBQ.png\" rel=\"nofollow noreferrer\">form link</a> if i submit that form i want to download image to computer local disk (Home/Documents/food_img) </p>\n\n<p>pls need help</p>\n\n<p>in downloads controller</p>\n\n<pre><code>class DownloadsController &lt; ApplicationController\n    def index\n        @downloads = Download.all\n        @download = Download.new\n    end\n\n    def create\n        @download = Download.create(user_params)\n    end\n\n    private\n\n    def user_params\n        params.require(:download).permit(:image,:image_url)\n    end\nend\n</code></pre>\n\n<p>in view/index.html.erb</p>\n\n<pre><code>&lt;%= form_for(@download, url: downloads_path) do |f| %&gt;\n&lt;%= f.text_field :image_url %&gt;\n&lt;%=f.submit%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>in model</p>\n\n<pre><code>class Download &lt; ApplicationRecord\n    has_attached_file :image, styles: { medium: \"300x300&gt;\", thumb: \"100x100&gt;\" }, default_url: \"/images/:style/missing.png\"\n    validates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\n\n    require 'open-uri'\n    download = open('http://www.shopprod.com/assets/photos/ishop-718755d2bc62956994c867681b2622e77b4c9af3d1ecd6fa856127b704a459b2.png')\n    IO.copy_stream(download, \"~/#{download.base_uri.to_s.split('/')[-1]}\")\nend\n</code></pre>\n\n<p>in db</p>\n\n<pre><code>t.string: image_url\n</code></pre>\n"}]